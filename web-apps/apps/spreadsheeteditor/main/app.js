/*!
 * Copyright (c) Ascensio System SIA 2024. All rights reserved
 * Version: 7.4.1 (build:1)
 */
function getUrlParams(){function t(t){return decodeURIComponent(t.replace(i," "))}for(var e,i=/\+/g,s=/([^&=]+)=?([^&]*)/g,o=window.location.search.substring(1),n={};e=s.exec(o);)n[t(e[1])]=t(e[2]);return n}function encodeUrlParam(t){return t.replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}define("spreadsheeteditor/main/locale/zh.json",{cancelButtonText:"取消","Common.Controllers.Chat.notcriticalErrorTitle":"警告","Common.Controllers.Chat.textEnterMessage":"在这里输入你的信息","Common.Controllers.History.notcriticalErrorTitle":"警告","Common.define.chartData.textArea":"面积图","Common.define.chartData.textAreaStacked":"堆积面积图","Common.define.chartData.textAreaStackedPer":"百分比堆积面积图","Common.define.chartData.textBar":"条形图","Common.define.chartData.textBarNormal":"簇状柱形图","Common.define.chartData.textBarNormal3d":"三维簇状柱形图","Common.define.chartData.textBarNormal3dPerspective":"三维柱形图","Common.define.chartData.textBarStacked":"堆积柱形图","Common.define.chartData.textBarStacked3d":"三维堆积柱形图","Common.define.chartData.textBarStackedPer":"百分比堆积柱形图","Common.define.chartData.textBarStackedPer3d":"三维百分比堆积柱形图","Common.define.chartData.textCharts":"流程图","Common.define.chartData.textColumn":"柱形图","Common.define.chartData.textColumnSpark":"柱形图","Common.define.chartData.textCombo":"组合图","Common.define.chartData.textComboAreaBar":"堆积面积图 - 簇状柱形图","Common.define.chartData.textComboBarLine":"簇状柱形图 - 折线图","Common.define.chartData.textComboBarLineSecondary":"簇状柱形图 - 次坐标轴上的折线图","Common.define.chartData.textComboCustom":"自定义组合","Common.define.chartData.textDoughnut":"圆环图​​","Common.define.chartData.textHBarNormal":"簇状条形图","Common.define.chartData.textHBarNormal3d":"三维簇状条形图","Common.define.chartData.textHBarStacked":"堆积条形图","Common.define.chartData.textHBarStacked3d":"三维堆积条形图","Common.define.chartData.textHBarStackedPer":"百分比堆积条形图","Common.define.chartData.textHBarStackedPer3d":"三维百分比堆积条形图","Common.define.chartData.textLine":"折线图","Common.define.chartData.textLine3d":"三维折线图","Common.define.chartData.textLineMarker":"带数据标记的折线图","Common.define.chartData.textLineSpark":"折线图","Common.define.chartData.textLineStacked":"堆积折线图","Common.define.chartData.textLineStackedMarker":"带数据标记的堆积折线图","Common.define.chartData.textLineStackedPer":"百分比堆积折线图","Common.define.chartData.textLineStackedPerMarker":"带数据标记的百分比堆积折线图","Common.define.chartData.textPie":"饼图","Common.define.chartData.textPie3d":"三维饼图","Common.define.chartData.textPoint":"散点图","Common.define.chartData.textRadar":"雷达图","Common.define.chartData.textRadarFilled":"填充雷达图","Common.define.chartData.textRadarMarker":"带数据标记的雷达图","Common.define.chartData.textScatter":"散点图​​","Common.define.chartData.textScatterLine":"带直线的散点图","Common.define.chartData.textScatterLineMarker":"带直线和数据标记的散点图","Common.define.chartData.textScatterSmooth":"带平滑线的散点图","Common.define.chartData.textScatterSmoothMarker":"带平滑线和数据标记的散点图","Common.define.chartData.textSparks":"迷你","Common.define.chartData.textStock":"股价图","Common.define.chartData.textSurface":"平面","Common.define.chartData.textWinLossSpark":"赢亏","Common.define.conditionalData.exampleText":"AaBbCcYyZz","Common.define.conditionalData.noFormatText":"无设定格式","Common.define.conditionalData.text1Above":"标准偏差高于1","Common.define.conditionalData.text1Below":"标准偏差低于1","Common.define.conditionalData.text2Above":"标准偏差高于2","Common.define.conditionalData.text2Below":"标准偏差低于2","Common.define.conditionalData.text3Above":"标准偏差高于3","Common.define.conditionalData.text3Below":"标准偏差低于3","Common.define.conditionalData.textAbove":"高于","Common.define.conditionalData.textAverage":"平均值","Common.define.conditionalData.textBegins":"始于","Common.define.conditionalData.textBelow":"低于","Common.define.conditionalData.textBetween":"介于","Common.define.conditionalData.textBlank":"空白","Common.define.conditionalData.textBlanks":"包含空白","Common.define.conditionalData.textBottom":"后","Common.define.conditionalData.textContains":"包含","Common.define.conditionalData.textDataBar":"数据条","Common.define.conditionalData.textDate":"日期","Common.define.conditionalData.textDuplicate":"重复","Common.define.conditionalData.textEnds":"止于","Common.define.conditionalData.textEqAbove":"等于或高于","Common.define.conditionalData.textEqBelow":"等于或低于","Common.define.conditionalData.textEqual":"等于","Common.define.conditionalData.textError":"错误","Common.define.conditionalData.textErrors":"包含错误","Common.define.conditionalData.textFormula":"公式","Common.define.conditionalData.textGreater":"大于","Common.define.conditionalData.textGreaterEq":"大于或等于","Common.define.conditionalData.textIconSets":"图标集","Common.define.conditionalData.textLast7days":"最近 7 天","Common.define.conditionalData.textLastMonth":"上月","Common.define.conditionalData.textLastWeek":"上周","Common.define.conditionalData.textLess":"小于","Common.define.conditionalData.textLessEq":"小于或等于","Common.define.conditionalData.textNextMonth":"下月","Common.define.conditionalData.textNextWeek":"下周","Common.define.conditionalData.textNotBetween":"不介于","Common.define.conditionalData.textNotBlanks":"不包含空白","Common.define.conditionalData.textNotContains":"不包含","Common.define.conditionalData.textNotEqual":"不等于","Common.define.conditionalData.textNotErrors":"不包含错误","Common.define.conditionalData.textText":"文本","Common.define.conditionalData.textThisMonth":"本月","Common.define.conditionalData.textThisWeek":"本周","Common.define.conditionalData.textToday":"今天","Common.define.conditionalData.textTomorrow":"明天","Common.define.conditionalData.textTop":"前","Common.define.conditionalData.textUnique":"唯一","Common.define.conditionalData.textValue":"值","Common.define.conditionalData.textYesterday":"昨天","Common.define.smartArt.textAccentedPicture":"重音图片","Common.define.smartArt.textAccentProcess":"重点流程","Common.define.smartArt.textAlternatingFlow":"交替流","Common.define.smartArt.textAlternatingHexagons":"交替六边形","Common.define.smartArt.textAlternatingPictureBlocks":"交替图片块","Common.define.smartArt.textAlternatingPictureCircles":"交替图片圆形","Common.define.smartArt.textArchitectureLayout":"结构布局","Common.define.smartArt.textArrowRibbon":"带形箭头","Common.define.smartArt.textAscendingPictureAccentProcess":"升序图片重点流程","Common.define.smartArt.textBalance":"平衡","Common.define.smartArt.textBasicBendingProcess":"基本蛇形流程","Common.define.smartArt.textBasicBlockList":"基本列表","Common.define.smartArt.textBasicChevronProcess":"基本 V 形流程","Common.define.smartArt.textBasicCycle":"基本循环","Common.define.smartArt.textBasicMatrix":"基本矩阵","Common.define.smartArt.textBasicPie":"基本饼图","Common.define.smartArt.textBasicProcess":"基本流程","Common.define.smartArt.textBasicPyramid":"基本棱锥图","Common.define.smartArt.textBasicRadial":"基本射线图","Common.define.smartArt.textBasicTarget":"基本目标图","Common.define.smartArt.textBasicTimeline":"基本时间线","Common.define.smartArt.textBasicVenn":"基本维恩图","Common.define.smartArt.textBendingPictureAccentList":"蛇形图片重点列表","Common.define.smartArt.textBendingPictureBlocks":"蛇形图片块","Common.define.smartArt.textBendingPictureCaption":"蛇形图片题注","Common.define.smartArt.textBendingPictureCaptionList":"蛇形图片题注列表","Common.define.smartArt.textBendingPictureSemiTranparentText":"蛇形图片半透明文本","Common.define.smartArt.textBlockCycle":"块循环","Common.define.smartArt.textBubblePictureList":"气泡图片列表","Common.define.smartArt.textCaptionedPictures":"题注图片","Common.define.smartArt.textChevronAccentProcess":"V 形重点流程","Common.define.smartArt.textChevronList":"V 型列表","Common.define.smartArt.textCircleAccentTimeline":"圆形重点日程表","Common.define.smartArt.textCircleArrowProcess":"圆箭头流程","Common.define.smartArt.textCirclePictureHierarchy":"圆形图片层次结构","Common.define.smartArt.textCircleProcess":"循环流程","Common.define.smartArt.textCircleRelationship":"循环关系","Common.define.smartArt.textCircularBendingProcess":"环状蛇形流程","Common.define.smartArt.textCircularPictureCallout":"圆形图片标注","Common.define.smartArt.textClosedChevronProcess":"闭合 V 形流程","Common.define.smartArt.textContinuousArrowProcess":"连续箭头流程","Common.define.smartArt.textContinuousBlockProcess":"连续块状流程","Common.define.smartArt.textContinuousCycle":"连续循环","Common.define.smartArt.textContinuousPictureList":"连续图片列表","Common.define.smartArt.textConvergingArrows":"汇聚箭头","Common.define.smartArt.textConvergingRadial":"聚合射线","Common.define.smartArt.textConvergingText":"聚合文本","Common.define.smartArt.textCounterbalanceArrows":"平衡箭头","Common.define.smartArt.textCycle":"循环","Common.define.smartArt.textCycleMatrix":"循环矩阵","Common.define.smartArt.textDescendingBlockList":"降序块列表","Common.define.smartArt.textDescendingProcess":"降序流程","Common.define.smartArt.textDetailedProcess":"详细流程","Common.define.smartArt.textDivergingArrows":"分叉箭头","Common.define.smartArt.textDivergingRadial":"分离射线","Common.define.smartArt.textEquation":"公式","Common.define.smartArt.textFramedTextPicture":"带框架的文本图片","Common.define.smartArt.textFunnel":"漏斗","Common.define.smartArt.textGear":"齿轮","Common.define.smartArt.textGridMatrix":"网格矩阵","Common.define.smartArt.textGroupedList":"分组列表","Common.define.smartArt.textHalfCircleOrganizationChart":"半圆组织结构图","Common.define.smartArt.textHexagonCluster":"六边形群集","Common.define.smartArt.textHexagonRadial":"放射状六边形","Common.define.smartArt.textHierarchy":"层次结构","Common.define.smartArt.textHierarchyList":"层次结构列表","Common.define.smartArt.textHorizontalBulletList":"水平项目符号列表","Common.define.smartArt.textHorizontalHierarchy":"水平层次结构","Common.define.smartArt.textHorizontalLabeledHierarchy":"水平标记的层次结构","Common.define.smartArt.textHorizontalMultiLevelHierarchy":"水平多层层次结构","Common.define.smartArt.textHorizontalOrganizationChart":"水平组织结构图","Common.define.smartArt.textHorizontalPictureList":"水平图片列表","Common.define.smartArt.textIncreasingArrowProcess":"递增箭头流程","Common.define.smartArt.textIncreasingCircleProcess":"递增循环流程","Common.define.smartArt.textInterconnectedBlockProcess":"互联块流程","Common.define.smartArt.textInterconnectedRings":"互联环","Common.define.smartArt.textInvertedPyramid":"倒棱锥图","Common.define.smartArt.textLabeledHierarchy":"标记的层次结构","Common.define.smartArt.textLinearVenn":"线性维恩图","Common.define.smartArt.textLinedList":"线型列表","Common.define.smartArt.textList":"列表","Common.define.smartArt.textMatrix":"矩阵","Common.define.smartArt.textMultidirectionalCycle":"多向循环","Common.define.smartArt.textNameAndTitleOrganizationChart":"姓名和职务组织结构图","Common.define.smartArt.textNestedTarget":"嵌套目标图","Common.define.smartArt.textNondirectionalCycle":"不定向循环","Common.define.smartArt.textOpposingArrows":"反向箭头","Common.define.smartArt.textOpposingIdeas":"对立观点","Common.define.smartArt.textOrganizationChart":"组织结构图","Common.define.smartArt.textOther":"其他","Common.define.smartArt.textPhasedProcess":"分阶段流程","Common.define.smartArt.textPicture":"图片","Common.define.smartArt.textPictureAccentBlocks":"图片重点块","Common.define.smartArt.textPictureAccentList":"图片重点列表","Common.define.smartArt.textPictureAccentProcess":"图片重点流程","Common.define.smartArt.textPictureCaptionList":"图片题注列表","Common.define.smartArt.textPictureFrame":"图片框","Common.define.smartArt.textPictureGrid":"图片网格","Common.define.smartArt.textPictureLineup":"图片排列","Common.define.smartArt.textPictureOrganizationChart":"图片组织结构图","Common.define.smartArt.textPictureStrips":"图片条纹","Common.define.smartArt.textPieProcess":"饼图流程","Common.define.smartArt.textPlusAndMinus":"加号和减号","Common.define.smartArt.textProcess":"流程","Common.define.smartArt.textProcessArrows":"流程箭头","Common.define.smartArt.textProcessList":"流程列表","Common.define.smartArt.textPyramid":"棱锥型","Common.define.smartArt.textPyramidList":"棱锥型列表","Common.define.smartArt.textRadialCluster":"射线群集","Common.define.smartArt.textRadialCycle":"射线循环","Common.define.smartArt.textRadialList":"射线列表","Common.define.smartArt.textRadialPictureList":"放射状图片列表","Common.define.smartArt.textRadialVenn":"射线维恩图","Common.define.smartArt.textRandomToResultProcess":"随机至结果流程","Common.define.smartArt.textRelationship":"关系","Common.define.smartArt.textRepeatingBendingProcess":"重复蛇形流程","Common.define.smartArt.textReverseList":"反转列表","Common.define.smartArt.textSegmentedCycle":"分段循环","Common.define.smartArt.textSegmentedProcess":"分段流程","Common.define.smartArt.textSegmentedPyramid":"分段棱锥图","Common.define.smartArt.textSnapshotPictureList":"快照图片列表","Common.define.smartArt.textSpiralPicture":"螺旋图","Common.define.smartArt.textSquareAccentList":"方形重点列表","Common.define.smartArt.textStackedList":"堆叠列表","Common.define.smartArt.textStackedVenn":"堆叠维恩图","Common.define.smartArt.textStaggeredProcess":"交错流程","Common.define.smartArt.textStepDownProcess":"步骤下移流程","Common.define.smartArt.textStepUpProcess":"升级流程","Common.define.smartArt.textSubStepProcess":"子步骤流程","Common.define.smartArt.textTabbedArc":"拱状","Common.define.smartArt.textTableHierarchy":"表层次结构","Common.define.smartArt.textTableList":"表格列表","Common.define.smartArt.textTabList":"选项卡列表","Common.define.smartArt.textTargetList":"目标图列表","Common.define.smartArt.textTextCycle":"文本循环","Common.define.smartArt.textThemePictureAccent":"主题图片重点","Common.define.smartArt.textThemePictureAlternatingAccent":"主题图片交替重点","Common.define.smartArt.textThemePictureGrid":"主题图片网格","Common.define.smartArt.textTitledMatrix":"带标题的矩阵","Common.define.smartArt.textTitledPictureAccentList":"标题图片重点列表","Common.define.smartArt.textTitledPictureBlocks":"标题图片块","Common.define.smartArt.textTitlePictureLineup":"标题图片排列","Common.define.smartArt.textTrapezoidList":"梯形列表","Common.define.smartArt.textUpwardArrow":"向上箭头","Common.define.smartArt.textVaryingWidthList":"不同宽度列表","Common.define.smartArt.textVerticalAccentList":"垂直重点列表","Common.define.smartArt.textVerticalArrowList":"垂直箭头列表","Common.define.smartArt.textVerticalBendingProcess":"垂直蛇形流程","Common.define.smartArt.textVerticalBlockList":"垂直块列表","Common.define.smartArt.textVerticalBoxList":"垂直框列表","Common.define.smartArt.textVerticalBracketList":"垂直括弧列表","Common.define.smartArt.textVerticalBulletList":"垂直项目符号列表","Common.define.smartArt.textVerticalChevronList":"垂直 V 形列表","Common.define.smartArt.textVerticalCircleList":"垂直圆形列表","Common.define.smartArt.textVerticalCurvedList":"垂直曲形列表","Common.define.smartArt.textVerticalEquation":"垂直公式","Common.define.smartArt.textVerticalPictureAccentList":"垂直图片重点列表","Common.define.smartArt.textVerticalPictureList":"垂直图片列表","Common.define.smartArt.textVerticalProcess":"垂直流程","Common.Translation.textMoreButton":"更多","Common.Translation.tipFileLocked":"文件被锁定，无法编辑。您可以进行修改并将其另存为本地副本。","Common.Translation.tipFileReadOnly":"该文件具有只读权限。若要保存，请重新命名或在不同的位置保存该文件。","Common.Translation.warnFileLocked":"另一个应用程序正在编辑本文件。你可以继续编辑，并另存为副本。","Common.Translation.warnFileLockedBtnEdit":"创建副本","Common.Translation.warnFileLockedBtnView":"打开以查看","Common.UI.ButtonColored.textAutoColor":"自动","Common.UI.ButtonColored.textEyedropper":"取色器","Common.UI.ButtonColored.textNewColor":"更多颜色","Common.UI.ComboBorderSize.txtNoBorders":"无边框","Common.UI.ComboBorderSizeEditable.txtNoBorders":"无边框","Common.UI.ComboDataView.emptyComboText":"没有风格","Common.UI.ExtendedColorDialog.addButtonText":"确定","Common.UI.ExtendedColorDialog.textCurrent":"当前","Common.UI.ExtendedColorDialog.textHexErr":"输入的值不正确。<br>请输入000000和FFFFFF之间的值。","Common.UI.ExtendedColorDialog.textNew":"新增","Common.UI.ExtendedColorDialog.textRGBErr":"输入的值不正确。<br>请输入介于0和255之间的数值。","Common.UI.HSBColorPicker.textNoColor":"没有颜色","Common.UI.InputFieldBtnPassword.textHintHidePwd":"隐藏密码","Common.UI.InputFieldBtnPassword.textHintShowPwd":"显示密码","Common.UI.SearchBar.textFind":"查找内容","Common.UI.SearchBar.tipCloseSearch":"关闭搜索","Common.UI.SearchBar.tipNextResult":"下一个","Common.UI.SearchBar.tipOpenAdvancedSettings":"打开高级设置","Common.UI.SearchBar.tipPreviousResult":"上一个","Common.UI.SearchDialog.textHighlight":"高亮效果","Common.UI.SearchDialog.textMatchCase":"区分大小写","Common.UI.SearchDialog.textReplaceDef":"输入替换文字","Common.UI.SearchDialog.textSearchStart":"在这里输入你的文字","Common.UI.SearchDialog.textTitle":"查找和替换","Common.UI.SearchDialog.textTitle2":"查找","Common.UI.SearchDialog.textWholeWords":"只有整个字","Common.UI.SearchDialog.txtBtnHideReplace":"隐藏替换","Common.UI.SearchDialog.txtBtnReplace":"替换","Common.UI.SearchDialog.txtBtnReplaceAll":"全部替换","Common.UI.SynchronizeTip.textDontShow":"不要再显示此消息","Common.UI.SynchronizeTip.textSynchronize":"该文档已被其他用户更改。<br>请点击保存更改并重新加载更新。","Common.UI.ThemeColorPalette.textRecentColors":"最近的颜色","Common.UI.ThemeColorPalette.textStandartColors":"标准色","Common.UI.ThemeColorPalette.textThemeColors":"主题颜色","Common.UI.Themes.txtThemeClassicLight":"经典浅色","Common.UI.Themes.txtThemeContrastDark":"深色对比","Common.UI.Themes.txtThemeDark":"深色","Common.UI.Themes.txtThemeLight":"浅色","Common.UI.Themes.txtThemeSystem":"和系统一致","Common.UI.Window.cancelButtonText":"取消","Common.UI.Window.closeButtonText":"关闭","Common.UI.Window.noButtonText":"否","Common.UI.Window.okButtonText":"确定","Common.UI.Window.textConfirmation":"确认","Common.UI.Window.textDontShow":"不要再显示此消息","Common.UI.Window.textError":"错误","Common.UI.Window.textInformation":"信息","Common.UI.Window.textWarning":"警告","Common.UI.Window.yesButtonText":"是","Common.Utils.Metric.txtCm":"厘米","Common.Utils.Metric.txtPt":"像素","Common.Utils.String.textAlt":"Alt","Common.Utils.String.textCtrl":"Ctrl","Common.Utils.String.textShift":"Shift","Common.Utils.ThemeColor.txtaccent":"强调","Common.Utils.ThemeColor.txtAqua":"水绿色","Common.Utils.ThemeColor.txtbackground":"背景","Common.Utils.ThemeColor.txtBlack":"黑色","Common.Utils.ThemeColor.txtBlue":"蓝色","Common.Utils.ThemeColor.txtBrightGreen":"鲜绿色","Common.Utils.ThemeColor.txtBrown":"棕色","Common.Utils.ThemeColor.txtDarkBlue":"深蓝色","Common.Utils.ThemeColor.txtDarker":"深色","Common.Utils.ThemeColor.txtDarkGray":"深灰色","Common.Utils.ThemeColor.txtDarkGreen":"深绿色","Common.Utils.ThemeColor.txtDarkPurple":"深紫色","Common.Utils.ThemeColor.txtDarkRed":"深红色","Common.Utils.ThemeColor.txtDarkTeal":"深青色","Common.Utils.ThemeColor.txtDarkYellow":"深黄色","Common.Utils.ThemeColor.txtGold":"金色","Common.Utils.ThemeColor.txtGray":"灰色","Common.Utils.ThemeColor.txtGreen":"绿色","Common.Utils.ThemeColor.txtIndigo":"靛蓝色","Common.Utils.ThemeColor.txtLavender":"淡紫色","Common.Utils.ThemeColor.txtLightBlue":"浅蓝色","Common.Utils.ThemeColor.txtLighter":"淡色","Common.Utils.ThemeColor.txtLightGray":"浅灰色","Common.Utils.ThemeColor.txtLightGreen":"浅绿色","Common.Utils.ThemeColor.txtLightOrange":"浅橙色","Common.Utils.ThemeColor.txtLightYellow":"浅黄色","Common.Utils.ThemeColor.txtOrange":"橙色","Common.Utils.ThemeColor.txtPink":"粉色","Common.Utils.ThemeColor.txtPurple":"紫色","Common.Utils.ThemeColor.txtRed":"红色","Common.Utils.ThemeColor.txtRose":"玫瑰色","Common.Utils.ThemeColor.txtSkyBlue":"天蓝色","Common.Utils.ThemeColor.txtTeal":"青色","Common.Utils.ThemeColor.txttext":"文本","Common.Utils.ThemeColor.txtTurquosie":"青绿色","Common.Utils.ThemeColor.txtViolet":"紫罗兰色","Common.Utils.ThemeColor.txtWhite":"白色","Common.Utils.ThemeColor.txtYellow":"黄色","Common.Views.About.txtAddress":"地址：","Common.Views.About.txtLicensee":"被许可人","Common.Views.About.txtLicensor":"许可","Common.Views.About.txtMail":"电子邮件：","Common.Views.About.txtPoweredBy":"技术支持","Common.Views.About.txtTel":"电话：","Common.Views.About.txtVersion":"版本","Common.Views.AutoCorrectDialog.textAdd":"新增","Common.Views.AutoCorrectDialog.textApplyAsWork":"工作时应用","Common.Views.AutoCorrectDialog.textAutoCorrect":"自动更正","Common.Views.AutoCorrectDialog.textAutoFormat":"输入时自动调整格式","Common.Views.AutoCorrectDialog.textBy":"依据","Common.Views.AutoCorrectDialog.textDelete":"删除","Common.Views.AutoCorrectDialog.textHyperlink":"互联网和网络路径含有超链接","Common.Views.AutoCorrectDialog.textMathCorrect":"数学自动修正","Common.Views.AutoCorrectDialog.textNewRowCol":"表格中包含新的行和列","Common.Views.AutoCorrectDialog.textRecognized":"可识别的函数","Common.Views.AutoCorrectDialog.textRecognizedDesc":"以下表达式被识别为数学公式。它们不会被自动设为斜体。","Common.Views.AutoCorrectDialog.textReplace":"替换","Common.Views.AutoCorrectDialog.textReplaceText":"键入时替换","Common.Views.AutoCorrectDialog.textReplaceType":"输入时自动替换文字","Common.Views.AutoCorrectDialog.textReset":"重置","Common.Views.AutoCorrectDialog.textResetAll":"重置为默认","Common.Views.AutoCorrectDialog.textRestore":"恢复","Common.Views.AutoCorrectDialog.textTitle":"自动修正","Common.Views.AutoCorrectDialog.textWarnAddRec":"识别的函数只能包含字母A到Z，大写或小写。","Common.Views.AutoCorrectDialog.textWarnResetRec":"由您新增的表达式将被移除，由您移除的将被恢复。是否继续？","Common.Views.AutoCorrectDialog.warnReplace":"％1的自动更正条目已存在。您要更换吗？","Common.Views.AutoCorrectDialog.warnReset":"即将移除对自动更正功能所做的自定义设置，并恢复默认值。是否继续？","Common.Views.AutoCorrectDialog.warnRestore":"％1的自动更正条目将被重置为其原始值。你想继续吗？","Common.Views.Chat.textSend":"发送","Common.Views.Comments.mniAuthorAsc":"作者 A到Z","Common.Views.Comments.mniAuthorDesc":"作者 Z到A","Common.Views.Comments.mniDateAsc":"最旧","Common.Views.Comments.mniDateDesc":"最新","Common.Views.Comments.mniFilterGroups":"按组筛选","Common.Views.Comments.mniPositionAsc":"从顶部","Common.Views.Comments.mniPositionDesc":"从底部","Common.Views.Comments.textAdd":"添加","Common.Views.Comments.textAddComment":"添加批注","Common.Views.Comments.textAddCommentToDoc":"添加批注到文档","Common.Views.Comments.textAddReply":"添加回复","Common.Views.Comments.textAll":"所有","Common.Views.Comments.textAnonym":"游客","Common.Views.Comments.textCancel":"取消","Common.Views.Comments.textClose":"关闭","Common.Views.Comments.textClosePanel":"关闭批注","Common.Views.Comments.textComments":"批注","Common.Views.Comments.textEdit":"确定","Common.Views.Comments.textEnterCommentHint":"在此输入您的批注","Common.Views.Comments.textHintAddComment":"添加批注","Common.Views.Comments.textOpenAgain":"再次打开","Common.Views.Comments.textReply":"回复","Common.Views.Comments.textResolve":"解决","Common.Views.Comments.textResolved":"已解决","Common.Views.Comments.textSort":"评论排序","Common.Views.Comments.textViewResolved":"您没有重开评论的权限","Common.Views.Comments.txtEmpty":"工作表中没有任何评论。","Common.Views.CopyWarningDialog.textDontShow":"不要再显示此消息","Common.Views.CopyWarningDialog.textMsg":"使用编辑器工具栏按钮和上下文菜单操作复制，剪切和粘贴操作将仅在此编辑器选项卡中执行。<br> <br>要在编辑器选项卡之外复制或粘贴到应用程序，请使用以下键盘组合：","Common.Views.CopyWarningDialog.textTitle":"复制，剪切和粘贴操作","Common.Views.CopyWarningDialog.textToCopy":"复制","Common.Views.CopyWarningDialog.textToCut":"剪切","Common.Views.CopyWarningDialog.textToPaste":"粘贴","Common.Views.DocumentAccessDialog.textLoading":"载入中……","Common.Views.DocumentAccessDialog.textTitle":"共享设置","Common.Views.Draw.hintEraser":"橡皮擦","Common.Views.Draw.hintSelect":"选择","Common.Views.Draw.txtEraser":"橡皮擦","Common.Views.Draw.txtHighlighter":"荧光笔","Common.Views.Draw.txtMM":"mm","Common.Views.Draw.txtPen":"笔","Common.Views.Draw.txtSelect":"选择","Common.Views.Draw.txtSize":"大小","Common.Views.EditNameDialog.textLabel":"标签：","Common.Views.EditNameDialog.textLabelError":"标签不能空","Common.Views.Header.labelCoUsersDescr":"正在编辑文件的用户：","Common.Views.Header.textAddFavorite":"标记为收藏项","Common.Views.Header.textAdvSettings":"高级设置","Common.Views.Header.textBack":"打开文件所在位置","Common.Views.Header.textCompactView":"查看紧凑工具栏","Common.Views.Header.textHideLines":"隐藏标尺","Common.Views.Header.textHideStatusBar":"合并工作表和状态栏","Common.Views.Header.textReadOnly":"只读","Common.Views.Header.textRemoveFavorite":"从收藏夹中删除","Common.Views.Header.textSaveBegin":"正在保存...","Common.Views.Header.textSaveChanged":"已修改","Common.Views.Header.textSaveEnd":"所有更改已保存","Common.Views.Header.textSaveExpander":"所有更改已保存","Common.Views.Header.textShare":"共享","Common.Views.Header.textZoom":"放大","Common.Views.Header.tipAccessRights":"管理文档访问权限","Common.Views.Header.tipDownload":"下载文件","Common.Views.Header.tipGoEdit":"编辑当前文件","Common.Views.Header.tipPrint":"打印","Common.Views.Header.tipPrintQuick":"快速打印","Common.Views.Header.tipRedo":"重做","Common.Views.Header.tipSave":"保存","Common.Views.Header.tipSearch":"搜索","Common.Views.Header.tipUndo":"复原","Common.Views.Header.tipUndock":"打开单独的窗口","Common.Views.Header.tipUsers":"查看用户","Common.Views.Header.tipViewSettings":"视图设置","Common.Views.Header.tipViewUsers":"查看用户和管理文档访问权限","Common.Views.Header.txtAccessRights":"更改访问权限","Common.Views.Header.txtRename":"重命名","Common.Views.History.textCloseHistory":"关闭历史记录","Common.Views.History.textHide":"折叠","Common.Views.History.textHideAll":"隐藏详细更改","Common.Views.History.textRestore":"还原","Common.Views.History.textShow":"展开","Common.Views.History.textShowAll":"显示详细的更改","Common.Views.History.textVer":"版本","Common.Views.ImageFromUrlDialog.textUrl":"粘贴图片网址：","Common.Views.ImageFromUrlDialog.txtEmpty":"必填项","Common.Views.ImageFromUrlDialog.txtNotUrl":"该字段应该是“http://www.example.com”格式的URL","Common.Views.ListSettingsDialog.textBulleted":"已添加项目符号","Common.Views.ListSettingsDialog.textFromFile":"从文件导入","Common.Views.ListSettingsDialog.textFromStorage":"来自存储设备","Common.Views.ListSettingsDialog.textFromUrl":"从URL","Common.Views.ListSettingsDialog.textNumbering":"标号","Common.Views.ListSettingsDialog.textSelect":"选择","Common.Views.ListSettingsDialog.tipChange":"修改项目点","Common.Views.ListSettingsDialog.txtBullet":"项目符号","Common.Views.ListSettingsDialog.txtColor":"颜色","Common.Views.ListSettingsDialog.txtImage":"图片","Common.Views.ListSettingsDialog.txtImport":"导入","Common.Views.ListSettingsDialog.txtNewBullet":"添加一个新的项目点","Common.Views.ListSettingsDialog.txtNewImage":"新图片","Common.Views.ListSettingsDialog.txtNone":"无","Common.Views.ListSettingsDialog.txtOfText":"文本的%","Common.Views.ListSettingsDialog.txtSize":"大小","Common.Views.ListSettingsDialog.txtStart":"开始","Common.Views.ListSettingsDialog.txtSymbol":"符号","Common.Views.ListSettingsDialog.txtTitle":"列表设置","Common.Views.ListSettingsDialog.txtType":"类型","Common.Views.OpenDialog.closeButtonText":"关闭文件","Common.Views.OpenDialog.textInvalidRange":"无效的单元格范围","Common.Views.OpenDialog.textSelectData":"选择数据","Common.Views.OpenDialog.txtAdvanced":"高级","Common.Views.OpenDialog.txtColon":"冒号","Common.Views.OpenDialog.txtComma":"逗号","Common.Views.OpenDialog.txtDelimiter":"字段分隔符","Common.Views.OpenDialog.txtDestData":"选择此数据的放置位置","Common.Views.OpenDialog.txtEmpty":"此字段是必需的","Common.Views.OpenDialog.txtEncoding":"编码","Common.Views.OpenDialog.txtIncorrectPwd":"密码错误","Common.Views.OpenDialog.txtOpenFile":"输入密码来打开文件","Common.Views.OpenDialog.txtOther":"其他","Common.Views.OpenDialog.txtPassword":"密码","Common.Views.OpenDialog.txtPreview":"预览","Common.Views.OpenDialog.txtProtected":"在您输入密码和打开文件后，该文件的当前密码将被重置。","Common.Views.OpenDialog.txtSemicolon":"分号","Common.Views.OpenDialog.txtSpace":"空格","Common.Views.OpenDialog.txtTab":"标签","Common.Views.OpenDialog.txtTitle":"选择%1个选项","Common.Views.OpenDialog.txtTitleProtected":"受保护的文件","Common.Views.PasswordDialog.txtDescription":"设置密码以保护此文档","Common.Views.PasswordDialog.txtIncorrectPwd":"确认密码不一致","Common.Views.PasswordDialog.txtPassword":"密码","Common.Views.PasswordDialog.txtRepeat":"重复输入密码","Common.Views.PasswordDialog.txtTitle":"设置密码","Common.Views.PasswordDialog.txtWarning":"警告: 如果丢失或忘记密码，则无法将其恢复。将其保存在安全位置。","Common.Views.PluginDlg.textLoading":"载入中","Common.Views.Plugins.groupCaption":"插件","Common.Views.Plugins.strPlugins":"插件","Common.Views.Plugins.textClosePanel":"关闭插件","Common.Views.Plugins.textLoading":"载入中","Common.Views.Plugins.textStart":"开始","Common.Views.Plugins.textStop":"停止","Common.Views.Protection.hintAddPwd":"使用密码加密","Common.Views.Protection.hintDelPwd":"删除密码","Common.Views.Protection.hintPwd":"修改或删除密码","Common.Views.Protection.hintSignature":"添加数字签名或签名行","Common.Views.Protection.txtAddPwd":"添加密码","Common.Views.Protection.txtChangePwd":"修改密码","Common.Views.Protection.txtDeletePwd":"删除密码","Common.Views.Protection.txtEncrypt":"加密","Common.Views.Protection.txtInvisibleSignature":"添加数字签名","Common.Views.Protection.txtSignature":"签名","Common.Views.Protection.txtSignatureLine":"添加签名行","Common.Views.RecentFiles.txtOpenRecent":"最近打开","Common.Views.RenameDialog.textName":"文件名","Common.Views.RenameDialog.txtInvalidName":"文件名不能包含以下任何字符：","Common.Views.ReviewChanges.hintNext":"下一个变化","Common.Views.ReviewChanges.hintPrev":"以前的变化","Common.Views.ReviewChanges.strFast":"自动","Common.Views.ReviewChanges.strFastDesc":"自动共同编辑模式，自动保存修改痕迹。","Common.Views.ReviewChanges.strStrict":"手动","Common.Views.ReviewChanges.strStrictDesc":"使用“保存”按钮同步你和其他人的修改。","Common.Views.ReviewChanges.tipAcceptCurrent":"接受此修订","Common.Views.ReviewChanges.tipCoAuthMode":"设置共同编辑模式","Common.Views.ReviewChanges.tipCommentRem":"移除批注","Common.Views.ReviewChanges.tipCommentRemCurrent":"移除当前批注","Common.Views.ReviewChanges.tipCommentResolve":"解决评论","Common.Views.ReviewChanges.tipCommentResolveCurrent":"解决当前评论","Common.Views.ReviewChanges.tipHistory":"显示历史版本","Common.Views.ReviewChanges.tipRejectCurrent":"拒绝此修订","Common.Views.ReviewChanges.tipReview":"跟踪变化","Common.Views.ReviewChanges.tipReviewView":"选择您希望显示更改的模式","Common.Views.ReviewChanges.tipSetDocLang":"设置文档语言","Common.Views.ReviewChanges.tipSetSpelling":"拼写检查","Common.Views.ReviewChanges.tipSharing":"管理文档访问权限","Common.Views.ReviewChanges.txtAccept":"接受","Common.Views.ReviewChanges.txtAcceptAll":"接受所有修订","Common.Views.ReviewChanges.txtAcceptChanges":"接受更改","Common.Views.ReviewChanges.txtAcceptCurrent":"接受此修订","Common.Views.ReviewChanges.txtChat":"聊天","Common.Views.ReviewChanges.txtClose":"关闭","Common.Views.ReviewChanges.txtCoAuthMode":"共同编辑模式","Common.Views.ReviewChanges.txtCommentRemAll":"移除所有批注","Common.Views.ReviewChanges.txtCommentRemCurrent":"移除当前批注","Common.Views.ReviewChanges.txtCommentRemMy":"移除我的批注","Common.Views.ReviewChanges.txtCommentRemMyCurrent":"移除我的当前批注","Common.Views.ReviewChanges.txtCommentRemove":"删除","Common.Views.ReviewChanges.txtCommentResolve":"解决","Common.Views.ReviewChanges.txtCommentResolveAll":"解决所有评论","Common.Views.ReviewChanges.txtCommentResolveCurrent":"解决当前评论","Common.Views.ReviewChanges.txtCommentResolveMy":"解决我的评论","Common.Views.ReviewChanges.txtCommentResolveMyCurrent":"解决我当前的评论","Common.Views.ReviewChanges.txtDocLang":"语言","Common.Views.ReviewChanges.txtFinal":"已接受所有修订（预览）","Common.Views.ReviewChanges.txtFinalCap":"最终版","Common.Views.ReviewChanges.txtHistory":"版本历史","Common.Views.ReviewChanges.txtMarkup":"所有更改（编辑）","Common.Views.ReviewChanges.txtMarkupCap":"标记","Common.Views.ReviewChanges.txtNext":"下一个变化","Common.Views.ReviewChanges.txtOriginal":"已拒绝所有修订（预览）","Common.Views.ReviewChanges.txtOriginalCap":"原始版","Common.Views.ReviewChanges.txtPrev":"以前的变化","Common.Views.ReviewChanges.txtReject":"拒绝","Common.Views.ReviewChanges.txtRejectAll":"拒绝所有修订","Common.Views.ReviewChanges.txtRejectChanges":"拒绝更改","Common.Views.ReviewChanges.txtRejectCurrent":"拒绝此修订","Common.Views.ReviewChanges.txtSharing":"分享","Common.Views.ReviewChanges.txtSpelling":"拼写检查","Common.Views.ReviewChanges.txtTurnon":"跟踪变化","Common.Views.ReviewChanges.txtView":"显示模式","Common.Views.ReviewPopover.textAdd":"添加","Common.Views.ReviewPopover.textAddReply":"添加回复","Common.Views.ReviewPopover.textCancel":"取消","Common.Views.ReviewPopover.textClose":"关闭","Common.Views.ReviewPopover.textEdit":"确定","Common.Views.ReviewPopover.textEnterComment":"在这里输入您的评论","Common.Views.ReviewPopover.textMention":"+提供访问文档和发送电子邮件的权限","Common.Views.ReviewPopover.textMentionNotify":"+通知将通过电子邮件通知用户","Common.Views.ReviewPopover.textOpenAgain":"再次打开","Common.Views.ReviewPopover.textReply":"回复","Common.Views.ReviewPopover.textResolve":"解决","Common.Views.ReviewPopover.textViewResolved":"您没有重开评论的权限","Common.Views.ReviewPopover.txtDeleteTip":"删除","Common.Views.ReviewPopover.txtEditTip":"编辑","Common.Views.SaveAsDlg.textLoading":"载入中","Common.Views.SaveAsDlg.textTitle":"保存文件夹","Common.Views.SearchPanel.textByColumns":"按列","Common.Views.SearchPanel.textByRows":"按行","Common.Views.SearchPanel.textCaseSensitive":"区分大小写","Common.Views.SearchPanel.textCell":"单元格","Common.Views.SearchPanel.textCloseSearch":"关闭搜索","Common.Views.SearchPanel.textContentChanged":"文件已更改。","Common.Views.SearchPanel.textFind":"查找内容","Common.Views.SearchPanel.textFindAndReplace":"查找和替换","Common.Views.SearchPanel.textFormula":"公式","Common.Views.SearchPanel.textFormulas":"公式","Common.Views.SearchPanel.textItemEntireCell":"单元格匹配","Common.Views.SearchPanel.textItemsSuccessfullyReplaced":"{0}项已替换成功。","Common.Views.SearchPanel.textLookIn":"查找范围","Common.Views.SearchPanel.textMatchUsingRegExp":"正则匹配","Common.Views.SearchPanel.textName":"名称","Common.Views.SearchPanel.textNoMatches":"找不到匹配信息","Common.Views.SearchPanel.textNoSearchResults":"找不到搜索结果","Common.Views.SearchPanel.textPartOfItemsNotReplaced":"{0}/{1}项已替换成功。剩余的{2}项被其他用户锁定。","Common.Views.SearchPanel.textReplace":"替换","Common.Views.SearchPanel.textReplaceAll":"全部替换","Common.Views.SearchPanel.textReplaceWith":"替换为","Common.Views.SearchPanel.textSearch":"搜索","Common.Views.SearchPanel.textSearchAgain":"{0}进行新的搜索{1}以获得准确结果。","Common.Views.SearchPanel.textSearchHasStopped":"搜索已停止","Common.Views.SearchPanel.textSearchOptions":"搜索选项","Common.Views.SearchPanel.textSearchResults":"搜索结果：{0}/{1}","Common.Views.SearchPanel.textSelectDataRange":"选择数据范围","Common.Views.SearchPanel.textSheet":"工作表","Common.Views.SearchPanel.textSpecificRange":"指定的范围","Common.Views.SearchPanel.textTooManyResults":"这里显示的结果太多了","Common.Views.SearchPanel.textValue":"值","Common.Views.SearchPanel.textValues":"值","Common.Views.SearchPanel.textWholeWords":"全字匹配","Common.Views.SearchPanel.textWithin":"范围","Common.Views.SearchPanel.textWorkbook":"工作簿","Common.Views.SearchPanel.tipNextResult":"下一个","Common.Views.SearchPanel.tipPreviousResult":"上一个","Common.Views.SelectFileDlg.textLoading":"载入中","Common.Views.SelectFileDlg.textTitle":"选择数据源","Common.Views.SignDialog.textBold":"加粗","Common.Views.SignDialog.textCertificate":"证书","Common.Views.SignDialog.textChange":"修改","Common.Views.SignDialog.textInputName":"输入签名者姓名","Common.Views.SignDialog.textItalic":"斜体","Common.Views.SignDialog.textNameError":"签名者名称不能为空","Common.Views.SignDialog.textPurpose":"签署本文档的目的","Common.Views.SignDialog.textSelect":"请选择","Common.Views.SignDialog.textSelectImage":"选择图片","Common.Views.SignDialog.textSignature":"签名类似","Common.Views.SignDialog.textTitle":"签署文件","Common.Views.SignDialog.textUseImage":"或单击“选择图片”将图片用作签名","Common.Views.SignDialog.textValid":"从%1到%2有效","Common.Views.SignDialog.tipFontName":"字体名称","Common.Views.SignDialog.tipFontSize":"字体大小","Common.Views.SignSettingsDialog.textAllowComment":"允许签名者在签名对话框中添加批注","Common.Views.SignSettingsDialog.textDefInstruction":"在签署本文件之前，请确保您所签署的内容是正确。","Common.Views.SignSettingsDialog.textInfoEmail":"建议签署人电邮","Common.Views.SignSettingsDialog.textInfoName":"建议签署人","Common.Views.SignSettingsDialog.textInfoTitle":"建议签署人职务","Common.Views.SignSettingsDialog.textInstructions":"给签名者的说明","Common.Views.SignSettingsDialog.textShowDate":"在签名行中显示签名日期","Common.Views.SignSettingsDialog.textTitle":"签名设置","Common.Views.SignSettingsDialog.txtEmpty":"必填项","Common.Views.SymbolTableDialog.textCharacter":"字符","Common.Views.SymbolTableDialog.textCode":"Unicode十六进制值","Common.Views.SymbolTableDialog.textCopyright":"版权所有标识","Common.Views.SymbolTableDialog.textDCQuote":"后双引号","Common.Views.SymbolTableDialog.textDOQuote":"前双引号","Common.Views.SymbolTableDialog.textEllipsis":"横向省略号","Common.Views.SymbolTableDialog.textEmDash":"破折号","Common.Views.SymbolTableDialog.textEmSpace":"全角空格","Common.Views.SymbolTableDialog.textEnDash":"半破折号","Common.Views.SymbolTableDialog.textEnSpace":"半角空格","Common.Views.SymbolTableDialog.textFont":"字体 ","Common.Views.SymbolTableDialog.textNBHyphen":"不换行连词符","Common.Views.SymbolTableDialog.textNBSpace":"不换行空格","Common.Views.SymbolTableDialog.textPilcrow":"段落标识","Common.Views.SymbolTableDialog.textQEmSpace":"1/4全角空格","Common.Views.SymbolTableDialog.textRange":"子集","Common.Views.SymbolTableDialog.textRecent":"最近使用的符号","Common.Views.SymbolTableDialog.textRegistered":"注册商标标识","Common.Views.SymbolTableDialog.textSCQuote":"后单引号","Common.Views.SymbolTableDialog.textSection":"章节标识","Common.Views.SymbolTableDialog.textShortcut":"快捷键","Common.Views.SymbolTableDialog.textSHyphen":"软连词符","Common.Views.SymbolTableDialog.textSOQuote":"前单引号","Common.Views.SymbolTableDialog.textSpecial":"特殊字符","Common.Views.SymbolTableDialog.textSymbols":"符号","Common.Views.SymbolTableDialog.textTitle":"符号","Common.Views.SymbolTableDialog.textTradeMark":"商标标识","Common.Views.UserNameDialog.textDontShow":"不再询问我","Common.Views.UserNameDialog.textLabel":"标签：","Common.Views.UserNameDialog.textLabelError":"标签不能空","SSE.Controllers.DataTab.strSheet":"工作表","SSE.Controllers.DataTab.textAddExternalData":'通往外部来源的链接已被添加。您可以在"数据"选项卡中更新此类链接。',"SSE.Controllers.DataTab.textColumns":"列","SSE.Controllers.DataTab.textDontUpdate":"不要更新","SSE.Controllers.DataTab.textEmptyUrl":"你必须指定URL。","SSE.Controllers.DataTab.textRows":"行","SSE.Controllers.DataTab.textUpdate":"更新","SSE.Controllers.DataTab.textWizard":"文本分列向导","SSE.Controllers.DataTab.txtDataValidation":"数据验证","SSE.Controllers.DataTab.txtErrorExternalLink":"错误：更新失败","SSE.Controllers.DataTab.txtExpand":"扩展选定区域","SSE.Controllers.DataTab.txtExpandRemDuplicates":"所选内容旁边的数据将不会被删除。您要扩展选择范围以包括相邻数据还是仅继续使用当前选定的单元格？","SSE.Controllers.DataTab.txtExtendDataValidation":"选定区域中的某些单元格尚未设置“数据有效性”。<br> 是否将“数据有效性”设置扩展到这些单元格?","SSE.Controllers.DataTab.txtImportWizard":"文本导入向导","SSE.Controllers.DataTab.txtRemDuplicates":"删除重复值","SSE.Controllers.DataTab.txtRemoveDataValidation":"选定区域含有多种类型的数据有效性。<br> 是否清除当前设置并继续?","SSE.Controllers.DataTab.txtRemSelected":"当前选定区域","SSE.Controllers.DataTab.txtUrlTitle":"粘贴URL数据","SSE.Controllers.DataTab.warnUpdateExternalData":"本工作簿包含一个或多个可能不安全的外部来源的链接。<br>如果您信任这些链接，请更新它们以获得最新的数据。","SSE.Controllers.DocumentHolder.alignmentText":"对齐","SSE.Controllers.DocumentHolder.centerText":"中心","SSE.Controllers.DocumentHolder.deleteColumnText":"删除列","SSE.Controllers.DocumentHolder.deleteRowText":"删除行","SSE.Controllers.DocumentHolder.deleteText":"删除","SSE.Controllers.DocumentHolder.errorInvalidLink":"链接引用不存在。请修改或删除链接。","SSE.Controllers.DocumentHolder.guestText":"游客","SSE.Controllers.DocumentHolder.insertColumnLeftText":"列的左右","SSE.Controllers.DocumentHolder.insertColumnRightText":"右列","SSE.Controllers.DocumentHolder.insertRowAboveText":"上面的行","SSE.Controllers.DocumentHolder.insertRowBelowText":"下面的行","SSE.Controllers.DocumentHolder.insertText":"插入","SSE.Controllers.DocumentHolder.leftText":"左","SSE.Controllers.DocumentHolder.notcriticalErrorTitle":"警告","SSE.Controllers.DocumentHolder.rightText":"右","SSE.Controllers.DocumentHolder.textAutoCorrectSettings":"自动更正选项","SSE.Controllers.DocumentHolder.textChangeColumnWidth":"列宽{0}符号（{1}像素）","SSE.Controllers.DocumentHolder.textChangeRowHeight":"行高{0}分（{1}个像素）","SSE.Controllers.DocumentHolder.textCtrlClick":"单击链接打开，或单击并按住鼠标选择单元格。","SSE.Controllers.DocumentHolder.textInsertLeft":"左侧插入列","SSE.Controllers.DocumentHolder.textInsertTop":"上面插入行","SSE.Controllers.DocumentHolder.textPasteSpecial":"选择性粘贴","SSE.Controllers.DocumentHolder.textStopExpand":"停止自动扩展表","SSE.Controllers.DocumentHolder.textSym":"字符","SSE.Controllers.DocumentHolder.tipIsLocked":"此元素正在被其他用户编辑。","SSE.Controllers.DocumentHolder.txtAboveAve":"平均水平以上","SSE.Controllers.DocumentHolder.txtAddBottom":"添加下边框","SSE.Controllers.DocumentHolder.txtAddFractionBar":"添加分数栏","SSE.Controllers.DocumentHolder.txtAddHor":"在相同样式的段落之间添加间隔","SSE.Controllers.DocumentHolder.txtAddLB":"添加左下线","SSE.Controllers.DocumentHolder.txtAddLeft":"添加左边框","SSE.Controllers.DocumentHolder.txtAddLT":"添加左上线","SSE.Controllers.DocumentHolder.txtAddRight":"添加右边框","SSE.Controllers.DocumentHolder.txtAddTop":"添加上边框","SSE.Controllers.DocumentHolder.txtAddVer":"添加垂直线","SSE.Controllers.DocumentHolder.txtAlignToChar":"字符对齐","SSE.Controllers.DocumentHolder.txtAll":"（全部）","SSE.Controllers.DocumentHolder.txtAllTableHint":"返回表格或指定表格列的全部内容，包括列标题、数据和总行数","SSE.Controllers.DocumentHolder.txtAnd":"和","SSE.Controllers.DocumentHolder.txtBegins":"开头为","SSE.Controllers.DocumentHolder.txtBelowAve":"在平均值以下","SSE.Controllers.DocumentHolder.txtBlanks":"(空白)","SSE.Controllers.DocumentHolder.txtBorderProps":"边框属性","SSE.Controllers.DocumentHolder.txtBottom":"底部","SSE.Controllers.DocumentHolder.txtByField":"%1/%2","SSE.Controllers.DocumentHolder.txtColumn":"列","SSE.Controllers.DocumentHolder.txtColumnAlign":"列对齐","SSE.Controllers.DocumentHolder.txtContains":"包含","SSE.Controllers.DocumentHolder.txtCopySuccess":"链接被复制到剪贴板上","SSE.Controllers.DocumentHolder.txtDataTableHint":"返回表格或指定表格列的数据单元格","SSE.Controllers.DocumentHolder.txtDecreaseArg":"减少大小参数","SSE.Controllers.DocumentHolder.txtDeleteArg":"删除参数","SSE.Controllers.DocumentHolder.txtDeleteBreak":"删除手动的断点","SSE.Controllers.DocumentHolder.txtDeleteChars":"删除包围字符","SSE.Controllers.DocumentHolder.txtDeleteCharsAndSeparators":"删除封闭字符和分隔符","SSE.Controllers.DocumentHolder.txtDeleteEq":"删除公式","SSE.Controllers.DocumentHolder.txtDeleteGroupChar":"删除字符","SSE.Controllers.DocumentHolder.txtDeleteRadical":"彻底删除","SSE.Controllers.DocumentHolder.txtEnds":"结束于","SSE.Controllers.DocumentHolder.txtEquals":"等于","SSE.Controllers.DocumentHolder.txtEqualsToCellColor":"等于单元格颜色","SSE.Controllers.DocumentHolder.txtEqualsToFontColor":"等于字体颜色","SSE.Controllers.DocumentHolder.txtExpand":"展开和排序","SSE.Controllers.DocumentHolder.txtExpandSort":"选择旁边的数据将不会被排序。要扩展选择以包括相邻数据还是继续排序当前选定的单元格？","SSE.Controllers.DocumentHolder.txtFilterBottom":"底部","SSE.Controllers.DocumentHolder.txtFilterTop":"顶部","SSE.Controllers.DocumentHolder.txtFractionLinear":"改为线性分数","SSE.Controllers.DocumentHolder.txtFractionSkewed":"改为倾斜分数","SSE.Controllers.DocumentHolder.txtFractionStacked":"改为堆积分数","SSE.Controllers.DocumentHolder.txtGreater":"大于","SSE.Controllers.DocumentHolder.txtGreaterEquals":"大于或等于","SSE.Controllers.DocumentHolder.txtGroupCharOver":"字符在文字上","SSE.Controllers.DocumentHolder.txtGroupCharUnder":"文字下的Char","SSE.Controllers.DocumentHolder.txtHeadersTableHint":"返回表格或指定表格列的列头","SSE.Controllers.DocumentHolder.txtHeight":"高度","SSE.Controllers.DocumentHolder.txtHideBottom":"隐藏下边框","SSE.Controllers.DocumentHolder.txtHideBottomLimit":"隐藏下限","SSE.Controllers.DocumentHolder.txtHideCloseBracket":"隐藏右括号","SSE.Controllers.DocumentHolder.txtHideDegree":"隐藏学位","SSE.Controllers.DocumentHolder.txtHideHor":"隐藏水平线","SSE.Controllers.DocumentHolder.txtHideLB":"隐藏左侧底线","SSE.Controllers.DocumentHolder.txtHideLeft":"隐藏左边框","SSE.Controllers.DocumentHolder.txtHideLT":"隐藏左顶线","SSE.Controllers.DocumentHolder.txtHideOpenBracket":"隐藏开放支架","SSE.Controllers.DocumentHolder.txtHidePlaceholder":"隐藏占位符","SSE.Controllers.DocumentHolder.txtHideRight":"隐藏右边框","SSE.Controllers.DocumentHolder.txtHideTop":"隐藏上边框","SSE.Controllers.DocumentHolder.txtHideTopLimit":"隐藏上限","SSE.Controllers.DocumentHolder.txtHideVer":"隐藏垂直线","SSE.Controllers.DocumentHolder.txtImportWizard":"文本导入向导","SSE.Controllers.DocumentHolder.txtIncreaseArg":"增加参数大小","SSE.Controllers.DocumentHolder.txtInsertArgAfter":"插入参数","SSE.Controllers.DocumentHolder.txtInsertArgBefore":"之前插入参数","SSE.Controllers.DocumentHolder.txtInsertBreak":"插入手动中断","SSE.Controllers.DocumentHolder.txtInsertEqAfter":"插入公式后","SSE.Controllers.DocumentHolder.txtInsertEqBefore":"之前插入公式","SSE.Controllers.DocumentHolder.txtItems":"项","SSE.Controllers.DocumentHolder.txtKeepTextOnly":"只保留文本","SSE.Controllers.DocumentHolder.txtLess":"小于","SSE.Controllers.DocumentHolder.txtLessEquals":"小于或等于","SSE.Controllers.DocumentHolder.txtLimitChange":"更改限制位置","SSE.Controllers.DocumentHolder.txtLimitOver":"限制文字","SSE.Controllers.DocumentHolder.txtLimitUnder":"在文本限制","SSE.Controllers.DocumentHolder.txtLockSort":"在选择区附近找到数据，但是你没有足够的权限修改这些单元格。<br>你希望继续操作当前选择区吗？","SSE.Controllers.DocumentHolder.txtMatchBrackets":"匹配括号到参数高度","SSE.Controllers.DocumentHolder.txtMatrixAlign":"矩阵对齐","SSE.Controllers.DocumentHolder.txtNoChoices":"填充单元格没有选择。<br>只能选择列中的文本值进行替换。","SSE.Controllers.DocumentHolder.txtNotBegins":"不起始于","SSE.Controllers.DocumentHolder.txtNotContains":"不含","SSE.Controllers.DocumentHolder.txtNotEnds":"不结束于","SSE.Controllers.DocumentHolder.txtNotEquals":"不等于","SSE.Controllers.DocumentHolder.txtOr":"或","SSE.Controllers.DocumentHolder.txtOverbar":"文本上一条","SSE.Controllers.DocumentHolder.txtPaste":"粘贴","SSE.Controllers.DocumentHolder.txtPasteBorders":"无边框","SSE.Controllers.DocumentHolder.txtPasteColWidths":"保留源列宽","SSE.Controllers.DocumentHolder.txtPasteDestFormat":"匹配目标格式","SSE.Controllers.DocumentHolder.txtPasteFormat":"仅粘贴格式","SSE.Controllers.DocumentHolder.txtPasteFormulaNumFormat":"公式+数字格式","SSE.Controllers.DocumentHolder.txtPasteFormulas":"仅粘贴公式","SSE.Controllers.DocumentHolder.txtPasteKeepSourceFormat":"保留源格式","SSE.Controllers.DocumentHolder.txtPasteLink":"粘贴链接","SSE.Controllers.DocumentHolder.txtPasteLinkPicture":"链接图片","SSE.Controllers.DocumentHolder.txtPasteMerge":"合并条件格式","SSE.Controllers.DocumentHolder.txtPastePicture":"图片","SSE.Controllers.DocumentHolder.txtPasteSourceFormat":"保留源格式","SSE.Controllers.DocumentHolder.txtPasteTranspose":"转置","SSE.Controllers.DocumentHolder.txtPasteValFormat":"值+所有格式","SSE.Controllers.DocumentHolder.txtPasteValNumFormat":"值+数字格式","SSE.Controllers.DocumentHolder.txtPasteValues":"仅粘贴值","SSE.Controllers.DocumentHolder.txtPercent":"百分比","SSE.Controllers.DocumentHolder.txtRedoExpansion":"恢复表自动扩展","SSE.Controllers.DocumentHolder.txtRemFractionBar":"删除分数线","SSE.Controllers.DocumentHolder.txtRemLimit":"删除限制","SSE.Controllers.DocumentHolder.txtRemoveAccentChar":"删除重音字符","SSE.Controllers.DocumentHolder.txtRemoveBar":"删除栏","SSE.Controllers.DocumentHolder.txtRemoveWarning":"您想删除此签名吗? <br>这一操作无法被撤销。","SSE.Controllers.DocumentHolder.txtRemScripts":"删除上下标","SSE.Controllers.DocumentHolder.txtRemSubscript":"删除标","SSE.Controllers.DocumentHolder.txtRemSuperscript":"除去上标","SSE.Controllers.DocumentHolder.txtRowHeight":"行高","SSE.Controllers.DocumentHolder.txtScriptsAfter":"文字后的上下标","SSE.Controllers.DocumentHolder.txtScriptsBefore":"文字前的脚本","SSE.Controllers.DocumentHolder.txtShowBottomLimit":"显示下限","SSE.Controllers.DocumentHolder.txtShowCloseBracket":"显示关闭括号","SSE.Controllers.DocumentHolder.txtShowDegree":"显示学位","SSE.Controllers.DocumentHolder.txtShowOpenBracket":"显示开放支架","SSE.Controllers.DocumentHolder.txtShowPlaceholder":"显示占位符","SSE.Controllers.DocumentHolder.txtShowTopLimit":"显示上限","SSE.Controllers.DocumentHolder.txtSorting":"排序","SSE.Controllers.DocumentHolder.txtSortSelected":"排序选择","SSE.Controllers.DocumentHolder.txtStretchBrackets":"拉伸支架","SSE.Controllers.DocumentHolder.txtThisRowHint":"仅选择指定列的这一行","SSE.Controllers.DocumentHolder.txtTop":"顶部","SSE.Controllers.DocumentHolder.txtTotalsTableHint":"返回表格或指定表格列的总行数","SSE.Controllers.DocumentHolder.txtUnderbar":"在文本栏","SSE.Controllers.DocumentHolder.txtUndoExpansion":"撤消表自动扩展","SSE.Controllers.DocumentHolder.txtUseTextImport":"使用文本导入向导","SSE.Controllers.DocumentHolder.txtWarnUrl":"点击该链接可能会损害你的设备或数据。<br>你确定要继续吗？","SSE.Controllers.DocumentHolder.txtWidth":"宽度","SSE.Controllers.DocumentHolder.warnFilterError":"为了使筛选器生效，你至少需要一个值位于值区域中。","SSE.Controllers.FormulaDialog.sCategoryAll":"全部","SSE.Controllers.FormulaDialog.sCategoryCube":"立方体","SSE.Controllers.FormulaDialog.sCategoryDatabase":"数据库","SSE.Controllers.FormulaDialog.sCategoryDateAndTime":"日期和时间","SSE.Controllers.FormulaDialog.sCategoryEngineering":"工程","SSE.Controllers.FormulaDialog.sCategoryFinancial":"财务","SSE.Controllers.FormulaDialog.sCategoryInformation":"信息","SSE.Controllers.FormulaDialog.sCategoryLast10":"常用函数","SSE.Controllers.FormulaDialog.sCategoryLogical":"逻辑","SSE.Controllers.FormulaDialog.sCategoryLookupAndReference":"查找与引用","SSE.Controllers.FormulaDialog.sCategoryMathematic":"数学和三角学","SSE.Controllers.FormulaDialog.sCategoryStatistical":"统计","SSE.Controllers.FormulaDialog.sCategoryTextAndData":"文本和数据","SSE.Controllers.LeftMenu.newDocumentTitle":"未命名的电子表格","SSE.Controllers.LeftMenu.textByColumns":"通过列","SSE.Controllers.LeftMenu.textByRows":"按行","SSE.Controllers.LeftMenu.textFormulas":"公式","SSE.Controllers.LeftMenu.textItemEntireCell":"整个单元格内容","SSE.Controllers.LeftMenu.textLoadHistory":"载入版本历史记录中...","SSE.Controllers.LeftMenu.textLookin":"在看","SSE.Controllers.LeftMenu.textNoTextFound":"您搜索的数据无法找到。请调整您的搜索选项。","SSE.Controllers.LeftMenu.textReplaceSkipped":"已经更换了。{0}次跳过。","SSE.Controllers.LeftMenu.textReplaceSuccess":"他的搜索已经完成。发生次数：{0}","SSE.Controllers.LeftMenu.textSave":"保存","SSE.Controllers.LeftMenu.textSearch":"搜索","SSE.Controllers.LeftMenu.textSheet":"表格","SSE.Controllers.LeftMenu.textValues":"值","SSE.Controllers.LeftMenu.textWarning":"警告","SSE.Controllers.LeftMenu.textWithin":"里边","SSE.Controllers.LeftMenu.textWorkbook":"工作簿","SSE.Controllers.LeftMenu.txtUntitled":"无标题","SSE.Controllers.LeftMenu.warnDownloadAs":"如果您继续以此格式保存，除文本之外的所有功能将丢失。<br>您确定要继续吗？","SSE.Controllers.LeftMenu.warnDownloadCsvSheets":'CSV 格式不支持保存多表文件。<br>如果要保持所选的格式并只保存当前的表格，请按 "保存"。<br>如果要保存当前的电子表格，请点击“取消”并将它另存为其他格式。',"SSE.Controllers.Main.confirmAddCellWatches":"此操作将会添加 {0} 个单元格监视。<br>是否继续?","SSE.Controllers.Main.confirmAddCellWatchesMax":"此操作将只会添加 {0} 个单元格监视以节省内存。<br>是否继续?","SSE.Controllers.Main.confirmMaxChangesSize":'行动的大小超过了对您服务器设置的限制。<br>按 "撤消"取消您的最后一次行动，或按"继续"在本地保留该行动（您需要下载文件或复制其内容以确保没有任何损失）。',"SSE.Controllers.Main.confirmMoveCellRange":"目的地小区范围可以包含数据。继续操作？","SSE.Controllers.Main.confirmPutMergeRange":"源数据包含合并的单元格。<br>它们在粘贴到表格之前已经被取消了。","SSE.Controllers.Main.confirmReplaceFormulaInTable":"表头里的公式将会被删除，并转换成普通文本。<br>要继续吗？","SSE.Controllers.Main.confirmReplaceHFPicture":"标题的每个部分只能插入一张图片<br>按“替换”替换现有图片<br>按“保留”以保留现有图片。","SSE.Controllers.Main.convertationTimeoutText":"转换超时","SSE.Controllers.Main.criticalErrorExtText":"按“确定”返回该文件列表。","SSE.Controllers.Main.criticalErrorTitle":"错误","SSE.Controllers.Main.downloadErrorText":"下载失败","SSE.Controllers.Main.downloadTextText":"正在下载试算表...","SSE.Controllers.Main.downloadTitleText":"下载电子表格","SSE.Controllers.Main.errNoDuplicates":"未找重复值。","SSE.Controllers.Main.errorAccessDeny":"您正在尝试执行您没有权限的操作。<br>请联系您的文档服务器管理员。","SSE.Controllers.Main.errorArgsRange":"此公式有问题。<br>使用不正确的参数范围。","SSE.Controllers.Main.errorAutoFilterChange":"不允许操作，因为它正在尝试在工作表上的表格中移动单元格。","SSE.Controllers.Main.errorAutoFilterChangeFormatTable":"无法对所选单元格进行操作，因为您无法移动表格的一部分。<br>选择其他数据范围，以便整个表格被移动并重试。","SSE.Controllers.Main.errorAutoFilterDataRange":"所选单元格区域无法进行操作。<br>选择与现有单元格不同的统一数据范围，然后重试。","SSE.Controllers.Main.errorAutoFilterHiddenRange":"无法执行操作，因为该区域包含已筛选的单元格。<br>请取消隐藏已筛选的元素，然后重试。","SSE.Controllers.Main.errorBadImageUrl":"图片地址不正确","SSE.Controllers.Main.errorCannotPasteImg":"我们无法从剪贴板上粘贴这个图片，但您可以把它保存到您的设备上并从那里插入。或者您可以复制不包含文字的图片，然后将它粘贴到电子表格中。","SSE.Controllers.Main.errorCannotUngroup":"无法解组。若要开始轮廓，请选择详细信息行或列并对其进行分组。","SSE.Controllers.Main.errorCannotUseCommandProtectedSheet":"受保护的工作表不允许进行该操作。要进行该操作，请先取消工作表的保护。<br>您可能需要输入密码。","SSE.Controllers.Main.errorChangeArray":"您无法更改部分阵列。","SSE.Controllers.Main.errorChangeFilteredRange":"这将更改工作表原有的筛选范围。<br>要完成此操作，请移除“自动筛选”。","SSE.Controllers.Main.errorChangeOnProtectedSheet":"尝试更改的单元格或图表位于受保护的工作表上。 <br>如要更改请把工作表解锁。会有可能要修您输入簿密码。","SSE.Controllers.Main.errorCoAuthoringDisconnect":"服务器连接丢失。该文档现在无法编辑","SSE.Controllers.Main.errorConnectToServer":"这份文件无法保存。请检查连接设置或联系您的管理员。<br>当你点击“OK”按钮,系统将提示您下载文档。","SSE.Controllers.Main.errorConvertXml":"该文件具有不支持的格式。<br>只有XML Spreadsheet 2003格式可以使用。","SSE.Controllers.Main.errorCopyMultiselectArea":"该命令不能与多个选择一起使用。<br>选择一个范围，然后重试。","SSE.Controllers.Main.errorCountArg":"此公式有问题。<br><br>请输入正确的参数。","SSE.Controllers.Main.errorCountArgExceed":"此函数输入的参数太多。","SSE.Controllers.Main.errorCreateDefName":"无法编辑现有的命名范围，因此无法在其中编辑新的范围。","SSE.Controllers.Main.errorCreateRange":"现有的范围不能编辑，新的范围也不能创建<br>，表格中一些范围正在被编辑。","SSE.Controllers.Main.errorDatabaseConnection":"外部错误。<br>数据库连接错误。如果错误仍然存​​在，请联系支持人员。","SSE.Controllers.Main.errorDataEncrypted":"加密更改已收到，无法对其解密。","SSE.Controllers.Main.errorDataRange":"数据范围不正确","SSE.Controllers.Main.errorDataValidate":"您输入的值无效。<br>用户具有可输入此单元格的限制值。","SSE.Controllers.Main.errorDefaultMessage":"错误代码：%1","SSE.Controllers.Main.errorDeleteColumnContainsLockedCell":"您正试图删除包含有锁定单元格的列。工作表受保护时无法删除锁定单元格。 <br> 若要删除锁定单元格，请先把工作表解锁。可能会提示您输入密码。","SSE.Controllers.Main.errorDeleteRowContainsLockedCell":"您正试图删除包含有锁定单元格的行。工作表受保护时无法删除锁定单元格。 <br> 若要删除锁定单元格，请先把工作表解锁。可能会提示您输入密码。","SSE.Controllers.Main.errorDependentsNoFormulas":"“追踪从属单元格”命令未发现引用活动单元格的公式。","SSE.Controllers.Main.errorDirectUrl":"请验证指向文档的链接。<br>此链接必须是指向要下载的文件的直接链接。","SSE.Controllers.Main.errorEditingDownloadas":"在处理文档期间发生错误。<br>使用“另存为”选项将文件备份复制到您的计算机硬盘中。","SSE.Controllers.Main.errorEditingSaveas":"在处理文档期间发生错误。<br>使用“另存为…”选项将文件备份复制到计算机硬盘中。","SSE.Controllers.Main.errorEditView":"由于其中一些正在被编辑，因此目前无法编辑现有工作表视图，也无法创建新工作表视图。","SSE.Controllers.Main.errorEmailClient":"未找到电子邮件客户端。","SSE.Controllers.Main.errorFilePassProtect":"该文档受密码保护，无法被打开。","SSE.Controllers.Main.errorFileRequest":"外部错误。<br>文件请求错误。如果错误仍然存​​在，请联系支持人员。","SSE.Controllers.Main.errorFileSizeExceed":"文件大小超出了为服务器设置的限制.<br>有关详细信息，请与文档服务器管理员联系。","SSE.Controllers.Main.errorFileVKey":"外部错误。<br>安全密钥错误。如果错误仍然存​​在，请联系支持人员。","SSE.Controllers.Main.errorFillRange":"无法填充所选范围的单元格。<br>所有合并的单元格的大小必须相同。","SSE.Controllers.Main.errorForceSave":"保存文件时发生错误请使用“另存为”选项将文件保存到计算机硬盘中或稍后重试。","SSE.Controllers.Main.errorFormulaName":"此公式有问题。<br>正确使用公式名称。","SSE.Controllers.Main.errorFormulaParsing":"解析公式时出现内部错误。","SSE.Controllers.Main.errorFrmlMaxLength":"公式不得超过8192个字符。<br>请编辑后重试。","SSE.Controllers.Main.errorFrmlMaxReference":"无法输入此公式，因为它包含太多值、 <br> 单元格引用和/或名称。","SSE.Controllers.Main.errorFrmlMaxTextLength":"公式中的文本值限制为255个字符。<br>使用连接函数或连接运算符（&）。","SSE.Controllers.Main.errorFrmlWrongReferences":"该功能是指不存在的工作表。<br>请检查数据，然后重试。","SSE.Controllers.Main.errorFTChangeTableRangeError":"所选单元格范围无法完成操作。<br>选择一个范围，使第一个表行位于同一行<br>上，并将生成的表与当前的列重叠。","SSE.Controllers.Main.errorFTRangeIncludedOtherTables":"所选单元格范围无法完成操作。<br>选择不包括其他表格的范围。","SSE.Controllers.Main.errorInconsistentExt":"在打开文件时发生了错误。<br> 该文件的扩展名不一致：%1。","SSE.Controllers.Main.errorInconsistentExtDocx":"在打开文件时发生了错误。<br>文件内容对应于文本文档（如 docx），但该文件的扩展名不一致：%1。","SSE.Controllers.Main.errorInconsistentExtPdf":"在打开文件时发生了错误。<br>文件内容对应于以下格式之一：pdf/djvu/xps/oxps，但该文件的扩展名不一致：%1。","SSE.Controllers.Main.errorInconsistentExtPptx":"在打开文件时发生了错误。<br>文件内容对应于演示文稿（如 pptx），但该文件的扩展名不一致：%1。","SSE.Controllers.Main.errorInconsistentExtXlsx":"在打开文件时发生了错误。<br>文件内容对应于电子表格（如 xlsx），但该文件的扩展名不一致：%1。","SSE.Controllers.Main.errorInvalidRef":"输入选择的正确名称或有效参考。","SSE.Controllers.Main.errorKeyEncrypt":"未知密钥描述","SSE.Controllers.Main.errorKeyExpire":"密钥过期","SSE.Controllers.Main.errorLabledColumnsPivot":"创建数据透视表时，必须使用组合为带有标志列列表的数据。","SSE.Controllers.Main.errorLoadingFont":"字体未加载。<br>请联系文档服务器管理员。","SSE.Controllers.Main.errorLocationOrDataRangeError":"引用的位置或数据范围是非法的。","SSE.Controllers.Main.errorLockedAll":"由于工作表被其他用户锁定，因此无法进行操作。","SSE.Controllers.Main.errorLockedCellPivot":"您无法更改透视表中的数据。","SSE.Controllers.Main.errorLockedWorksheetRename":"此时由于其他用户重命名该表单，因此无法重命名该表","SSE.Controllers.Main.errorMaxPoints":"每个图表序列的最大点值为4096。","SSE.Controllers.Main.errorMoveRange":"不能改变合并单元的一部分","SSE.Controllers.Main.errorMoveSlicerError":"无法将表切片器从一个工作簿复制到另一工作簿。 <br> 通过选择整个表和切片器，再试一遍。","SSE.Controllers.Main.errorMultiCellFormula":"表格中不允许使用多单元格数组公式。","SSE.Controllers.Main.errorNoDataToParse":"未选定要分析的数据。","SSE.Controllers.Main.errorOpenWarning":"其中一个文件公式超过了8192个字符的限制。 <br> 该公式已被删除。","SSE.Controllers.Main.errorOperandExpected":"该公式缺少左括号或右括号。","SSE.Controllers.Main.errorPasswordIsNotCorrect":"你提供的密码不正确。<br>确保大小写切换键处于关闭状态，以输入正确的大小写。","SSE.Controllers.Main.errorPasteMaxRange":"复制和粘贴区域不匹配。<br>请选择相同尺寸的区域，或单击一行中的第一个单元格以粘贴复制的单元格。","SSE.Controllers.Main.errorPasteMultiSelect":"无法在多个范围选择上完成此操作。<br> 请选择单个范围，然后重试。","SSE.Controllers.Main.errorPasteSlicerError":"表切片器无法从一个工作簿复制到另一工作簿。","SSE.Controllers.Main.errorPivotGroup":"选定区域不能分组。","SSE.Controllers.Main.errorPivotOverlap":"透视表报告不能与表格重叠","SSE.Controllers.Main.errorPivotWithoutUnderlying":"数据透视表没有与下层数据共同保存。<br> 请使用“更新”按钮更新数据透视表。","SSE.Controllers.Main.errorPrecedentsNoValidRef":"“追踪引用单元格”命令要求活动单元格中包含使用有效引用的公式。","SSE.Controllers.Main.errorPrintMaxPagesCount":"不支持打印超过100页。","SSE.Controllers.Main.errorProcessSaveResult":"保存失败","SSE.Controllers.Main.errorProtectedRange":"这个范围无法编辑。","SSE.Controllers.Main.errorServerVersion":"该编辑版本已经更新。该页面将被重新加载以应用更改。","SSE.Controllers.Main.errorSessionAbsolute":"文档编辑会话已过期。请重新加载页面。","SSE.Controllers.Main.errorSessionIdle":"该文件尚未编辑相当长的时间。请重新加载页面。","SSE.Controllers.Main.errorSessionToken":"与服务器的连接已中断。请重新加载页面。","SSE.Controllers.Main.errorSetPassword":"无法设置密码","SSE.Controllers.Main.errorSingleColumnOrRowError":"由于单元格都不在同一列或行中，所以超链接非活动。 <br> 选择同一个列或行中的单元格。","SSE.Controllers.Main.errorStockChart":"行顺序不正确。建立股票图表将数据按照以下顺序放置在表格上：<br>开盘价，最高价格，最低价格，收盘价。","SSE.Controllers.Main.errorToken":"文档安全令牌未正确形成。<br>请与您的文件服务器管理员联系。","SSE.Controllers.Main.errorTokenExpire":"文档安全令牌已过期。<br>请与您的文档服务器管理员联系。","SSE.Controllers.Main.errorUnexpectedGuid":"外部错误。<br>意外GUID。如果错误仍然存​​在，请联系支持人员。","SSE.Controllers.Main.errorUpdateVersion":"该文件版本已经改变了。该页面将被重新加载。","SSE.Controllers.Main.errorUpdateVersionOnDisconnect":"网络连接已恢复，文件版本已变更。<br>在继续工作之前，需要下载文件或复制其内容以避免丢失数据，然后重新加载此页。","SSE.Controllers.Main.errorUserDrop":"该文件现在无法访问。","SSE.Controllers.Main.errorUsersExceed":"超过了定价计划允许的用户数","SSE.Controllers.Main.errorViewerDisconnect":"连接丢失了。您仍然可以查看文档，<br>但在连接恢复并页面被重新加载之前无法下载或打印。","SSE.Controllers.Main.errorWrongBracketsCount":"此公式有问题。<br>用括号打错了。","SSE.Controllers.Main.errorWrongOperator":"公式输入发生错误。操作不当，请改正！","SSE.Controllers.Main.errorWrongPassword":"你提供的密码不正确。","SSE.Controllers.Main.errRemDuplicates":"发现重复值: {0}, 已经删除。 只留下唯一的值: {1}.","SSE.Controllers.Main.leavePageText":"您在本电子表格中有未保存的更改。点击“留在这个页面”，然后点击“保存”保存。点击“离开此页面”，放弃所有未保存的更改。","SSE.Controllers.Main.leavePageTextOnClose":"将丢失表格里所有的未保存更改。<br> 单击“取消”然后“保存”以保存好更改。单击“确定”以放弃所有未保存的更改。","SSE.Controllers.Main.loadFontsTextText":"数据加载中…","SSE.Controllers.Main.loadFontsTitleText":"数据加载中","SSE.Controllers.Main.loadFontTextText":"数据加载中…","SSE.Controllers.Main.loadFontTitleText":"数据加载中","SSE.Controllers.Main.loadImagesTextText":"图片加载中…","SSE.Controllers.Main.loadImagesTitleText":"图片加载中","SSE.Controllers.Main.loadImageTextText":"图片加载中…","SSE.Controllers.Main.loadImageTitleText":"图片加载中","SSE.Controllers.Main.loadingDocumentTitleText":"正在打开文档…","SSE.Controllers.Main.notcriticalErrorTitle":"警告","SSE.Controllers.Main.openErrorText":"打开文件时出现错误","SSE.Controllers.Main.openTextText":"打开电子表格...","SSE.Controllers.Main.openTitleText":"打开电子表格","SSE.Controllers.Main.pastInMergeAreaError":"不能改变合并单元的一部分","SSE.Controllers.Main.printTextText":"打印电子表格...","SSE.Controllers.Main.printTitleText":"打印电子表格","SSE.Controllers.Main.reloadButtonText":"重新加载页面","SSE.Controllers.Main.requestEditFailedMessageText":"有人正在编辑此文档。请稍后再试。","SSE.Controllers.Main.requestEditFailedTitleText":"访问被拒绝","SSE.Controllers.Main.saveErrorText":"保存文件时发生错误","SSE.Controllers.Main.saveErrorTextDesktop":"无法保存或创建此文件。<br>可能的原因是：<br> 1.此文件是只读的。 <br> 2.此文件正在由其他用户编辑。 <br> 3.磁盘已满或损坏。","SSE.Controllers.Main.saveTextText":"正在保存电子表格...","SSE.Controllers.Main.saveTitleText":"保存电子表格","SSE.Controllers.Main.scriptLoadError":"连接速度过慢，部分组件无法被加载。请重新加载页面。","SSE.Controllers.Main.textAnonymous":"匿名","SSE.Controllers.Main.textApplyAll":"应用于所有公式","SSE.Controllers.Main.textBuyNow":"访问网站","SSE.Controllers.Main.textChangesSaved":"所有更改已保存","SSE.Controllers.Main.textClose":"关闭","SSE.Controllers.Main.textCloseTip":"点击关闭提示","SSE.Controllers.Main.textConfirm":"确认","SSE.Controllers.Main.textContactUs":"联系销售","SSE.Controllers.Main.textContinue":"发送","SSE.Controllers.Main.textConvertEquation":"该公式是使用不再受支持的公式编辑器的旧版本创建的。要对其进行编辑，请将公式转换为Office Math ML格式。 <br> 立即转换？","SSE.Controllers.Main.textCustomLoader":"请注意，根据许可条款您无权更改加载程序。<br>请联系我们的销售部门获取报价。","SSE.Controllers.Main.textDisconnect":"网络连接已断开。","SSE.Controllers.Main.textFillOtherRows":"填充其他行","SSE.Controllers.Main.textFormulaFilledAllRows":"公式填充的 {0} 个行有数据。填充其他空行可能需要几分钟的时间。","SSE.Controllers.Main.textFormulaFilledAllRowsWithEmpty":"公式填充了前 {0} 个行。填充其他空行可能需要几分钟的时间。","SSE.Controllers.Main.textFormulaFilledFirstRowsOtherHaveData":"由于节省内存的原因，公式只填充了前 {0} 个有数据的行。该表中还有 {1} 个有数据的行。您可以手动填充。","SSE.Controllers.Main.textFormulaFilledFirstRowsOtherIsEmpty":"由于节省内存的原因，公式只填充了前 {0} 个行。该表中的其他行没有数据。","SSE.Controllers.Main.textGuest":"来宾","SSE.Controllers.Main.textHasMacros":"这个文件带有自动宏。<br> 是否要运行宏？","SSE.Controllers.Main.textKeep":"保持","SSE.Controllers.Main.textLearnMore":"了解更多","SSE.Controllers.Main.textLoadingDocument":"正在加载电子表格","SSE.Controllers.Main.textLongName":"请键入少于128个字符的名称。","SSE.Controllers.Main.textNeedSynchronize":"您有更新","SSE.Controllers.Main.textNo":"否","SSE.Controllers.Main.textNoLicenseTitle":"已达到许可证限制。","SSE.Controllers.Main.textPaidFeature":"付费功能","SSE.Controllers.Main.textPleaseWait":"该操作可能需要比预期的更多的时间。请稍候...","SSE.Controllers.Main.textReconnect":"连接已恢复","SSE.Controllers.Main.textRemember":"针对所有的文件记住我的选择","SSE.Controllers.Main.textRememberMacros":"为所有的宏记住我的选择","SSE.Controllers.Main.textRenameError":"用户名不能为空。","SSE.Controllers.Main.textRenameLabel":"输入名称，可用于协作。","SSE.Controllers.Main.textReplace":"取代","SSE.Controllers.Main.textRequestMacros":"宏发起一个请求至URL。你是否允许请求到％1？","SSE.Controllers.Main.textShape":"形状","SSE.Controllers.Main.textStrict":"手动模式","SSE.Controllers.Main.textText":"文本","SSE.Controllers.Main.textTryQuickPrint":"您已经选择了快速打印：整个文件将用最新选定的打印机或默认的打印机被打印。<br>您想继续吗？","SSE.Controllers.Main.textTryUndoRedo":"对于自动的协同编辑模式，取消/重做功能是禁用的。<br>单击“手动模式”按钮切换到手动协同编辑模式，这样，编辑该文件时只有您保存修改之后，其他用户才能访问这些修改。您可以使用编辑器高级设置易于切换编辑模式。","SSE.Controllers.Main.textTryUndoRedoWarn":"自动共同编辑模式下，撤销/重做功能被禁用。","SSE.Controllers.Main.textUndo":"撤消","SSE.Controllers.Main.textYes":"是","SSE.Controllers.Main.titleLicenseExp":"许可证过期","SSE.Controllers.Main.titleLicenseNotActive":"许可证未激活","SSE.Controllers.Main.titleServerVersion":"编辑器已更新","SSE.Controllers.Main.txtAccent":"着色","SSE.Controllers.Main.txtAll":"(全部)","SSE.Controllers.Main.txtMultipleItems":"(多项)","SSE.Controllers.Main.txtSum":"求和","SSE.Controllers.Main.txtCount":"计数","SSE.Controllers.Main.txtAverage":"平均值","SSE.Controllers.Main.txtMax":"最大值","SSE.Controllers.Main.txtMin":"最小值","SSE.Controllers.Main.txtProduct":"乘积","SSE.Controllers.Main.txtCountNums":"数值计数","SSE.Controllers.Main.txtStdDev":"标准偏差","SSE.Controllers.Main.txtStdDevp":"总体标准偏差","SSE.Controllers.Main.txtVar":"方差","SSE.Controllers.Main.txtVarp":"总体方差","SSE.Controllers.Main.txtArt":"你的文本在此","SSE.Controllers.Main.txtBasicShapes":"基本形状","SSE.Controllers.Main.txtBlank":"(空白)","SSE.Controllers.Main.txtButtons":"按钮","SSE.Controllers.Main.txtByField":"%1项:%2","SSE.Controllers.Main.txtCallouts":"标注","SSE.Controllers.Main.txtCharts":"流程图","SSE.Controllers.Main.txtClearFilter":"清除筛选器","SSE.Controllers.Main.txtColLbls":"列标签","SSE.Controllers.Main.txtColumn":"列","SSE.Controllers.Main.txtConfidential":"机密","SSE.Controllers.Main.txtDate":"日期","SSE.Controllers.Main.txtDays":"天","SSE.Controllers.Main.txtDiagramTitle":"图表标题","SSE.Controllers.Main.txtEditingMode":"设置编辑模式..","SSE.Controllers.Main.txtErrorLoadHistory":"历史记录的加载失败","SSE.Controllers.Main.txtFiguredArrows":"箭头汇总","SSE.Controllers.Main.txtFile":"文件","SSE.Controllers.Main.txtGrandTotal":"合计","SSE.Controllers.Main.txtGroup":"组合","SSE.Controllers.Main.txtHours":"小时","SSE.Controllers.Main.txtInfo":"信息","SSE.Controllers.Main.txtLines":"线条","SSE.Controllers.Main.txtMath":"公式形状","SSE.Controllers.Main.txtMinutes":"分钟","SSE.Controllers.Main.txtMonths":"月","SSE.Controllers.Main.txtMultiSelect":"多选模式","SSE.Controllers.Main.txtNone":"无","SSE.Controllers.Main.txtOr":"%1或%2","SSE.Controllers.Main.txtPage":"页面","SSE.Controllers.Main.txtPageOf":"第%1页，共%2页","SSE.Controllers.Main.txtPages":"页面","SSE.Controllers.Main.txtPicture":"图片","SSE.Controllers.Main.txtPreparedBy":"编制人","SSE.Controllers.Main.txtPrintArea":"Print_Area","SSE.Controllers.Main.txtQuarter":"季度","SSE.Controllers.Main.txtQuarters":"季度","SSE.Controllers.Main.txtRectangles":"矩形","SSE.Controllers.Main.txtRow":"行","SSE.Controllers.Main.txtRowLbls":"行标签","SSE.Controllers.Main.txtSeconds":"秒","SSE.Controllers.Main.txtSeries":"系列","SSE.Controllers.Main.txtShape_accentBorderCallout1":"线形标注1（边框和强调线）","SSE.Controllers.Main.txtShape_accentBorderCallout2":"线形标注2（边框和强调线）","SSE.Controllers.Main.txtShape_accentBorderCallout3":"线形标注3（边框和强调线）","SSE.Controllers.Main.txtShape_accentCallout1":"线形标注1（强调线）","SSE.Controllers.Main.txtShape_accentCallout2":"线形标注2（强调线）","SSE.Controllers.Main.txtShape_accentCallout3":"线形标注3（强调线）","SSE.Controllers.Main.txtShape_actionButtonBackPrevious":"后退或上一个按钮","SSE.Controllers.Main.txtShape_actionButtonBeginning":"开始按钮","SSE.Controllers.Main.txtShape_actionButtonBlank":"空白按钮","SSE.Controllers.Main.txtShape_actionButtonDocument":"文件按钮","SSE.Controllers.Main.txtShape_actionButtonEnd":"结束按钮","SSE.Controllers.Main.txtShape_actionButtonForwardNext":"转发或下一个按钮","SSE.Controllers.Main.txtShape_actionButtonHelp":"帮助按钮","SSE.Controllers.Main.txtShape_actionButtonHome":"开始按钮","SSE.Controllers.Main.txtShape_actionButtonInformation":"信息按钮","SSE.Controllers.Main.txtShape_actionButtonMovie":"视频按钮","SSE.Controllers.Main.txtShape_actionButtonReturn":"返回按钮","SSE.Controllers.Main.txtShape_actionButtonSound":"声音按钮","SSE.Controllers.Main.txtShape_arc":"弧","SSE.Controllers.Main.txtShape_bentArrow":"圆角右箭头","SSE.Controllers.Main.txtShape_bentConnector5":"肘形连接符","SSE.Controllers.Main.txtShape_bentConnector5WithArrow":"肘形箭头连接符","SSE.Controllers.Main.txtShape_bentConnector5WithTwoArrows":"肘形双箭头连接符","SSE.Controllers.Main.txtShape_bentUpArrow":"直角上箭头","SSE.Controllers.Main.txtShape_bevel":"棱台","SSE.Controllers.Main.txtShape_blockArc":"空心弧","SSE.Controllers.Main.txtShape_borderCallout1":"线形标注1","SSE.Controllers.Main.txtShape_borderCallout2":"线形标注2","SSE.Controllers.Main.txtShape_borderCallout3":"线形标注3","SSE.Controllers.Main.txtShape_bracePair":"双大括号","SSE.Controllers.Main.txtShape_callout1":"线形标注1（无边框）","SSE.Controllers.Main.txtShape_callout2":"线形标注2（无边框）","SSE.Controllers.Main.txtShape_callout3":"线形标注3（无边框）","SSE.Controllers.Main.txtShape_can":"圆柱","SSE.Controllers.Main.txtShape_chevron":"V形","SSE.Controllers.Main.txtShape_chord":"弦形","SSE.Controllers.Main.txtShape_circularArrow":"环形箭头","SSE.Controllers.Main.txtShape_cloud":"云形","SSE.Controllers.Main.txtShape_cloudCallout":"云形标注","SSE.Controllers.Main.txtShape_corner":"角","SSE.Controllers.Main.txtShape_cube":"正方体","SSE.Controllers.Main.txtShape_curvedConnector3":"曲线连接符","SSE.Controllers.Main.txtShape_curvedConnector3WithArrow":"曲线箭头连接符","SSE.Controllers.Main.txtShape_curvedConnector3WithTwoArrows":"曲线双箭头连接符","SSE.Controllers.Main.txtShape_curvedDownArrow":"下弧形箭头","SSE.Controllers.Main.txtShape_curvedLeftArrow":"左弧形箭头","SSE.Controllers.Main.txtShape_curvedRightArrow":"右弧形箭头","SSE.Controllers.Main.txtShape_curvedUpArrow":"上弧形箭头","SSE.Controllers.Main.txtShape_decagon":"十边形","SSE.Controllers.Main.txtShape_diagStripe":"斜纹","SSE.Controllers.Main.txtShape_diamond":"菱形","SSE.Controllers.Main.txtShape_dodecagon":"十二边形","SSE.Controllers.Main.txtShape_donut":"环形","SSE.Controllers.Main.txtShape_doubleWave":"双波形","SSE.Controllers.Main.txtShape_downArrow":"下箭头","SSE.Controllers.Main.txtShape_downArrowCallout":"下箭头标注","SSE.Controllers.Main.txtShape_ellipse":"椭圆","SSE.Controllers.Main.txtShape_ellipseRibbon":"下凸弯带形","SSE.Controllers.Main.txtShape_ellipseRibbon2":"上凸弯带形","SSE.Controllers.Main.txtShape_flowChartAlternateProcess":"流程图：可选流程","SSE.Controllers.Main.txtShape_flowChartCollate":"流程图：对照","SSE.Controllers.Main.txtShape_flowChartConnector":"流程图：接点","SSE.Controllers.Main.txtShape_flowChartDecision":"流程图：决策","SSE.Controllers.Main.txtShape_flowChartDelay":"流程图：延迟","SSE.Controllers.Main.txtShape_flowChartDisplay":"流程图：展示","SSE.Controllers.Main.txtShape_flowChartDocument":"流程图：文档","SSE.Controllers.Main.txtShape_flowChartExtract":"流程图：摘录","SSE.Controllers.Main.txtShape_flowChartInputOutput":"流程图：数据","SSE.Controllers.Main.txtShape_flowChartInternalStorage":"流程图：内部贮存","SSE.Controllers.Main.txtShape_flowChartMagneticDisk":"流程图：磁盘","SSE.Controllers.Main.txtShape_flowChartMagneticDrum":"流程图：直接访问存储器","SSE.Controllers.Main.txtShape_flowChartMagneticTape":"流程图：顺序访问存储器","SSE.Controllers.Main.txtShape_flowChartManualInput":"流程图：手动输入","SSE.Controllers.Main.txtShape_flowChartManualOperation":"流程图：手动操作","SSE.Controllers.Main.txtShape_flowChartMerge":"流程图：合并","SSE.Controllers.Main.txtShape_flowChartMultidocument":"流程图：多文档 ","SSE.Controllers.Main.txtShape_flowChartOffpageConnector":"流程图：离页连接符","SSE.Controllers.Main.txtShape_flowChartOnlineStorage":"流程图：存储数据","SSE.Controllers.Main.txtShape_flowChartOr":"流程图：或","SSE.Controllers.Main.txtShape_flowChartPredefinedProcess":"流程图：预定义过程","SSE.Controllers.Main.txtShape_flowChartPreparation":"流程图：准备","SSE.Controllers.Main.txtShape_flowChartProcess":"流程图：过程","SSE.Controllers.Main.txtShape_flowChartPunchedCard":"流程图：卡片","SSE.Controllers.Main.txtShape_flowChartPunchedTape":"流程图：资料带","SSE.Controllers.Main.txtShape_flowChartSort":"流程图：分类","SSE.Controllers.Main.txtShape_flowChartSummingJunction":"流程图：汇总连接","SSE.Controllers.Main.txtShape_flowChartTerminator":"流程图：终止","SSE.Controllers.Main.txtShape_foldedCorner":"折角形","SSE.Controllers.Main.txtShape_frame":"框架","SSE.Controllers.Main.txtShape_halfFrame":"半闭框","SSE.Controllers.Main.txtShape_heart":"心形","SSE.Controllers.Main.txtShape_heptagon":"七边形","SSE.Controllers.Main.txtShape_hexagon":"六边形","SSE.Controllers.Main.txtShape_homePlate":"五边形","SSE.Controllers.Main.txtShape_horizontalScroll":"横卷形","SSE.Controllers.Main.txtShape_irregularSeal1":"爆炸形1","SSE.Controllers.Main.txtShape_irregularSeal2":"爆炸形2","SSE.Controllers.Main.txtShape_leftArrow":"左箭头","SSE.Controllers.Main.txtShape_leftArrowCallout":"左箭头标注","SSE.Controllers.Main.txtShape_leftBrace":"左括号","SSE.Controllers.Main.txtShape_leftBracket":"左中括号","SSE.Controllers.Main.txtShape_leftRightArrow":"左右箭头","SSE.Controllers.Main.txtShape_leftRightArrowCallout":"左右箭头标注","SSE.Controllers.Main.txtShape_leftRightUpArrow":"丁字箭头","SSE.Controllers.Main.txtShape_leftUpArrow":"左上箭头","SSE.Controllers.Main.txtShape_lightningBolt":"闪电形","SSE.Controllers.Main.txtShape_line":"线","SSE.Controllers.Main.txtShape_lineWithArrow":"箭头","SSE.Controllers.Main.txtShape_lineWithTwoArrows":"双箭头","SSE.Controllers.Main.txtShape_mathDivide":"除","SSE.Controllers.Main.txtShape_mathEqual":"平等","SSE.Controllers.Main.txtShape_mathMinus":"减去","SSE.Controllers.Main.txtShape_mathMultiply":"乘","SSE.Controllers.Main.txtShape_mathNotEqual":"不等于","SSE.Controllers.Main.txtShape_mathPlus":"加","SSE.Controllers.Main.txtShape_moon":"月形","SSE.Controllers.Main.txtShape_noSmoking":"“NO”符号","SSE.Controllers.Main.txtShape_notchedRightArrow":"燕尾形箭头","SSE.Controllers.Main.txtShape_octagon":"八边形","SSE.Controllers.Main.txtShape_parallelogram":"平行四边形","SSE.Controllers.Main.txtShape_pentagon":"五边形","SSE.Controllers.Main.txtShape_pie":"饼图","SSE.Controllers.Main.txtShape_plaque":"符号","SSE.Controllers.Main.txtShape_plus":"加","SSE.Controllers.Main.txtShape_polyline1":"自由曲线","SSE.Controllers.Main.txtShape_polyline2":"任意多边形","SSE.Controllers.Main.txtShape_quadArrow":"十字箭头","SSE.Controllers.Main.txtShape_quadArrowCallout":"十字箭头标注","SSE.Controllers.Main.txtShape_rect":"矩形","SSE.Controllers.Main.txtShape_ribbon":"下凸带形","SSE.Controllers.Main.txtShape_ribbon2":"上凸带形","SSE.Controllers.Main.txtShape_rightArrow":"右箭头","SSE.Controllers.Main.txtShape_rightArrowCallout":"右箭头标注","SSE.Controllers.Main.txtShape_rightBrace":"右括号","SSE.Controllers.Main.txtShape_rightBracket":"右中括号","SSE.Controllers.Main.txtShape_round1Rect":"单圆角矩形","SSE.Controllers.Main.txtShape_round2DiagRect":"对角圆角矩形","SSE.Controllers.Main.txtShape_round2SameRect":"同侧圆角矩形","SSE.Controllers.Main.txtShape_roundRect":"圆角矩形","SSE.Controllers.Main.txtShape_rtTriangle":"直角三角形","SSE.Controllers.Main.txtShape_smileyFace":"笑脸","SSE.Controllers.Main.txtShape_snip1Rect":"剪去单角的矩形","SSE.Controllers.Main.txtShape_snip2DiagRect":"剪去对角的矩形","SSE.Controllers.Main.txtShape_snip2SameRect":"剪去同侧角的矩形","SSE.Controllers.Main.txtShape_snipRoundRect":"剪去单圆角的矩形","SSE.Controllers.Main.txtShape_spline":"曲线","SSE.Controllers.Main.txtShape_star10":"十角星","SSE.Controllers.Main.txtShape_star12":"十二角星","SSE.Controllers.Main.txtShape_star16":"十六角星","SSE.Controllers.Main.txtShape_star24":"二十四角星","SSE.Controllers.Main.txtShape_star32":"三十二角星","SSE.Controllers.Main.txtShape_star4":"四角星","SSE.Controllers.Main.txtShape_star5":"五角星","SSE.Controllers.Main.txtShape_star6":"六角星","SSE.Controllers.Main.txtShape_star7":"七角星","SSE.Controllers.Main.txtShape_star8":"八角星","SSE.Controllers.Main.txtShape_stripedRightArrow":"虚尾箭头","SSE.Controllers.Main.txtShape_sun":"太阳形","SSE.Controllers.Main.txtShape_teardrop":"泪珠形","SSE.Controllers.Main.txtShape_textRect":"文本框","SSE.Controllers.Main.txtShape_trapezoid":"梯形","SSE.Controllers.Main.txtShape_triangle":"三角形","SSE.Controllers.Main.txtShape_upArrow":"上箭头","SSE.Controllers.Main.txtShape_upArrowCallout":"上箭头标注","SSE.Controllers.Main.txtShape_upDownArrow":"上下箭头","SSE.Controllers.Main.txtShape_uturnArrow":"手杖形箭头","SSE.Controllers.Main.txtShape_verticalScroll":"竖卷形","SSE.Controllers.Main.txtShape_wave":"波浪线","SSE.Controllers.Main.txtShape_wedgeEllipseCallout":"椭圆形标注","SSE.Controllers.Main.txtShape_wedgeRectCallout":"矩形标注","SSE.Controllers.Main.txtShape_wedgeRoundRectCallout":"圆角矩形标注","SSE.Controllers.Main.txtSheet":"Sheet","SSE.Controllers.Main.txtSlicer":"切片器","SSE.Controllers.Main.txtStarsRibbons":"星星和旗帜","SSE.Controllers.Main.txtStyle_Bad":"差","SSE.Controllers.Main.txtStyle_Calculation":"计算","SSE.Controllers.Main.txtStyle_Check_Cell":"检查单元格","SSE.Controllers.Main.txtStyle_Comma":"千位分隔","SSE.Controllers.Main.txtStyle_Currency":"货币","SSE.Controllers.Main.txtStyle_Explanatory_Text":"解释性文本","SSE.Controllers.Main.txtStyle_Good":"好","SSE.Controllers.Main.txtStyle_Heading_1":"标题1","SSE.Controllers.Main.txtStyle_Heading_2":"标题2","SSE.Controllers.Main.txtStyle_Heading_3":"标题3","SSE.Controllers.Main.txtStyle_Heading_4":"标题4","SSE.Controllers.Main.txtStyle_Input":"输入","SSE.Controllers.Main.txtStyle_Linked_Cell":"链接单元格","SSE.Controllers.Main.txtStyle_Neutral":"适中","SSE.Controllers.Main.txtStyle_Normal":"常规","SSE.Controllers.Main.txtStyle_Note":"注释","SSE.Controllers.Main.txtStyle_Output":"输出","SSE.Controllers.Main.txtStyle_Percent":"百分比","SSE.Controllers.Main.txtStyle_Title":"标题","SSE.Controllers.Main.txtStyle_Total":"汇总","SSE.Controllers.Main.txtStyle_Warning_Text":"警告文本","SSE.Controllers.Main.txtTab":"标签","SSE.Controllers.Main.txtTable":"表格","SSE.Controllers.Main.txtTime":"时间","SSE.Controllers.Main.txtUnlock":"解锁","SSE.Controllers.Main.txtUnlockRange":"解锁区域","SSE.Controllers.Main.txtUnlockRangeDescription":"请输入密码以更改此范围:","SSE.Controllers.Main.txtUnlockRangeWarning":"您尝试更改的区域有密码保护。","SSE.Controllers.Main.txtValues":"值","SSE.Controllers.Main.txtXAxis":"X轴","SSE.Controllers.Main.txtYAxis":"Y轴","SSE.Controllers.Main.txtYears":"年","SSE.Controllers.Main.unknownErrorText":"未知错误","SSE.Controllers.Main.unsupportedBrowserErrorText":"你的浏览器不支持","SSE.Controllers.Main.uploadDocExtMessage":"未知的文档格式。","SSE.Controllers.Main.uploadDocFileCountMessage":"没有上载的文档","SSE.Controllers.Main.uploadDocSizeMessage":"超过最大文档大小限制。","SSE.Controllers.Main.uploadImageExtMessage":"未知图片格式","SSE.Controllers.Main.uploadImageFileCountMessage":"没有图片上传","SSE.Controllers.Main.uploadImageSizeMessage":"图片太大。最大的大小为25MB。","SSE.Controllers.Main.uploadImageTextText":"上传图片...","SSE.Controllers.Main.uploadImageTitleText":"图片上传中","SSE.Controllers.Main.waitText":"请稍候...","SSE.Controllers.Main.warnBrowserIE9":"该应用程序在IE9上的功能很差。使用IE10或更高版本","SSE.Controllers.Main.warnBrowserZoom":"您的浏览器当前缩放设置不完全支持。请按Ctrl + 0重设为默认缩放。","SSE.Controllers.Main.warnLicenseAnonymous":"拒绝匿名用户的访问。<br>本文档将以仅查看模式而打开。","SSE.Controllers.Main.warnLicenseBefore":"许可证未激活。<br>请联系管理员。","SSE.Controllers.Main.warnLicenseExceeded":"您已达到同时连接%1编辑器的限制。该文档将被打开仅供查看。<br>请联系您的管理员以了解更多。","SSE.Controllers.Main.warnLicenseExp":"您的许可证已过期。<br>请更新您的许可证并刷新页面。","SSE.Controllers.Main.warnLicenseLimitedNoAccess":"授权过期<br>您不具备文件编辑功能的授权<br>请联系管理员。","SSE.Controllers.Main.warnLicenseLimitedRenewed":"授权需更新<br>您只有文件编辑功能的部分权限<br>请联系管理员以取得完整权限。","SSE.Controllers.Main.warnLicenseUsersExceeded":"您已达到%1编辑器的用户限制。请联系您的管理员以了解更多。","SSE.Controllers.Main.warnNoLicense":"您已达到同时连接%1编辑器的限制。该文档将被打开仅供查看。<br>请联系%1销售团队以了解个人升级条款。","SSE.Controllers.Main.warnNoLicenseUsers":"您已达到%1编辑器的用户限制。请联系%1销售团队以了解个人升级条款。","SSE.Controllers.Main.warnProcessRightsChange":"您被拒绝编辑文件的权限。","SSE.Controllers.PivotTable.strSheet":"Sheet","SSE.Controllers.Print.strAllSheets":"所有表格","SSE.Controllers.Print.textFirstCol":"第一列","SSE.Controllers.Print.textFirstRow":"第一行","SSE.Controllers.Print.textFrozenCols":"固定列","SSE.Controllers.Print.textFrozenRows":"固定行","SSE.Controllers.Print.textInvalidRange":"失败！单元格范围无效","SSE.Controllers.Print.textNoRepeat":"不重复","SSE.Controllers.Print.textRepeat":"重复...","SSE.Controllers.Print.textSelectRange":"选取范围","SSE.Controllers.Print.textWarning":"警告","SSE.Controllers.Print.txtCustom":"自定义","SSE.Controllers.Print.warnCheckMargings":"边距不正确","SSE.Controllers.Search.textInvalidRange":"错误！无效的单元格范围","SSE.Controllers.Search.textNoTextFound":"您搜索的数据无法找到。请调整您的搜索选项。","SSE.Controllers.Search.textReplaceSkipped":"替换已完成。 {0}处跳过。","SSE.Controllers.Search.textReplaceSuccess":"搜索完成。{0}处已被替换","SSE.Controllers.Statusbar.errorLastSheet":"工作簿必须至少有一个可见的工作表","SSE.Controllers.Statusbar.errorRemoveSheet":"不能删除工作表","SSE.Controllers.Statusbar.strSheet":"Sheet","SSE.Controllers.Statusbar.textDisconnect":"<b>连接失败</b><br>正在尝试连接。请检查连接设置。","SSE.Controllers.Statusbar.textSheetViewTip":"您处于“表视图”模式。筛选器和排序仅对您和仍处于此视图的用户可见。","SSE.Controllers.Statusbar.textSheetViewTipFilters":"您处于“表视图”模式。筛选器仅对您和仍处于此视图的用户可见。","SSE.Controllers.Statusbar.warnDeleteSheet":"所选定的工作表可能包含数据。您确定要继续吗？","SSE.Controllers.Statusbar.zoomText":"缩放{0}%","SSE.Controllers.Toolbar.confirmAddFontName":"您要保存的字体在当前设备上不可用。<br>使用其中一种系统字体显示文本样式，当可用时将使用保存的字体。<br>是否要继续？","SSE.Controllers.Toolbar.errorComboSeries":"若要创建组合图，请选择至少两个数据系列。","SSE.Controllers.Toolbar.errorMaxPoints":"每个图表序列的最大点值为4096。","SSE.Controllers.Toolbar.errorMaxRows":"错误！每个图表的最大数据系列数为255","SSE.Controllers.Toolbar.errorStockChart":"行顺序不正确。建立股票图表将数据按照以下顺序放置在表格上：<br>开盘价，最高价格，最低价格，收盘价。","SSE.Controllers.Toolbar.textAccent":"导数符号","SSE.Controllers.Toolbar.textBracket":"括号","SSE.Controllers.Toolbar.textDirectional":"方向","SSE.Controllers.Toolbar.textFontSizeErr":"输入的值不正确。<br>请输入1到409之间的数值","SSE.Controllers.Toolbar.textFraction":"分数","SSE.Controllers.Toolbar.textFunction":"三角函数","SSE.Controllers.Toolbar.textIndicator":"标记","SSE.Controllers.Toolbar.textInsert":"插入","SSE.Controllers.Toolbar.textIntegral":"积分","SSE.Controllers.Toolbar.textLargeOperator":"大型运算符","SSE.Controllers.Toolbar.textLimitAndLog":"极限和对数","SSE.Controllers.Toolbar.textLongOperation":"长操作","SSE.Controllers.Toolbar.textMatrix":"矩阵","SSE.Controllers.Toolbar.textOperator":"运算符","SSE.Controllers.Toolbar.textPivot":"数据透视表","SSE.Controllers.Toolbar.textRadical":"根式","SSE.Controllers.Toolbar.textRating":"等级","SSE.Controllers.Toolbar.textRecentlyUsed":"最近使用","SSE.Controllers.Toolbar.textScript":"上下标","SSE.Controllers.Toolbar.textShapes":"形状","SSE.Controllers.Toolbar.textSymbols":"符号","SSE.Controllers.Toolbar.textWarning":"警告","SSE.Controllers.Toolbar.txtAccent_Accent":"急性","SSE.Controllers.Toolbar.txtAccent_ArrowD":"右上方的箭头在上方","SSE.Controllers.Toolbar.txtAccent_ArrowL":"向左箭头","SSE.Controllers.Toolbar.txtAccent_ArrowR":"向右箭头上方","SSE.Controllers.Toolbar.txtAccent_Bar":"条","SSE.Controllers.Toolbar.txtAccent_BarBot":"下划线","SSE.Controllers.Toolbar.txtAccent_BarTop":"划线","SSE.Controllers.Toolbar.txtAccent_BorderBox":"盒装配方（带占位符)","SSE.Controllers.Toolbar.txtAccent_BorderBoxCustom":"盒装配方（示例）","SSE.Controllers.Toolbar.txtAccent_Check":"检查","SSE.Controllers.Toolbar.txtAccent_CurveBracketBot":"Underbrace","SSE.Controllers.Toolbar.txtAccent_CurveBracketTop":"过度","SSE.Controllers.Toolbar.txtAccent_Custom_1":"A的矢量","SSE.Controllers.Toolbar.txtAccent_Custom_2":"ABC带横杠","SSE.Controllers.Toolbar.txtAccent_Custom_3":"x XOR y With Overbar","SSE.Controllers.Toolbar.txtAccent_DDDot":"三个点","SSE.Controllers.Toolbar.txtAccent_DDot":"双点","SSE.Controllers.Toolbar.txtAccent_Dot":"点","SSE.Controllers.Toolbar.txtAccent_DoubleBar":"双重横杠","SSE.Controllers.Toolbar.txtAccent_Grave":"严重","SSE.Controllers.Toolbar.txtAccent_GroupBot":"分组字符下面","SSE.Controllers.Toolbar.txtAccent_GroupTop":"分组字符以上","SSE.Controllers.Toolbar.txtAccent_HarpoonL":"向左鱼叉以上","SSE.Controllers.Toolbar.txtAccent_HarpoonR":"向右上方的鱼叉","SSE.Controllers.Toolbar.txtAccent_Hat":"帽子","SSE.Controllers.Toolbar.txtAccent_Smile":"短音符","SSE.Controllers.Toolbar.txtAccent_Tilde":"波浪号","SSE.Controllers.Toolbar.txtBracket_Angle":"括号","SSE.Controllers.Toolbar.txtBracket_Angle_Delimiter_2":"带分隔符的方括号","SSE.Controllers.Toolbar.txtBracket_Angle_Delimiter_3":"带分隔符的方括号","SSE.Controllers.Toolbar.txtBracket_Angle_NoneOpen":"单括号","SSE.Controllers.Toolbar.txtBracket_Angle_OpenNone":"单括号","SSE.Controllers.Toolbar.txtBracket_Curve":"括号","SSE.Controllers.Toolbar.txtBracket_Curve_Delimiter_2":"带分隔符的方括号","SSE.Controllers.Toolbar.txtBracket_Curve_NoneOpen":"单括号","SSE.Controllers.Toolbar.txtBracket_Curve_OpenNone":"单括号","SSE.Controllers.Toolbar.txtBracket_Custom_1":"案件（两个条件）","SSE.Controllers.Toolbar.txtBracket_Custom_2":"案件（三个条件）","SSE.Controllers.Toolbar.txtBracket_Custom_3":"堆栈对象","SSE.Controllers.Toolbar.txtBracket_Custom_4":"堆栈对象","SSE.Controllers.Toolbar.txtBracket_Custom_5":"案例示例","SSE.Controllers.Toolbar.txtBracket_Custom_6":"二项系数","SSE.Controllers.Toolbar.txtBracket_Custom_7":"二项系数","SSE.Controllers.Toolbar.txtBracket_Line":"括号","SSE.Controllers.Toolbar.txtBracket_Line_NoneOpen":"单括号","SSE.Controllers.Toolbar.txtBracket_Line_OpenNone":"单括号","SSE.Controllers.Toolbar.txtBracket_LineDouble":"括号","SSE.Controllers.Toolbar.txtBracket_LineDouble_NoneOpen":"单括号","SSE.Controllers.Toolbar.txtBracket_LineDouble_OpenNone":"单括号","SSE.Controllers.Toolbar.txtBracket_LowLim":"括号","SSE.Controllers.Toolbar.txtBracket_LowLim_NoneNone":"单括号","SSE.Controllers.Toolbar.txtBracket_LowLim_OpenNone":"单括号","SSE.Controllers.Toolbar.txtBracket_Round":"括号","SSE.Controllers.Toolbar.txtBracket_Round_Delimiter_2":"带分隔符的方括号","SSE.Controllers.Toolbar.txtBracket_Round_NoneOpen":"单括号","SSE.Controllers.Toolbar.txtBracket_Round_OpenNone":"单括号","SSE.Controllers.Toolbar.txtBracket_Square":"括号","SSE.Controllers.Toolbar.txtBracket_Square_CloseClose":"括号","SSE.Controllers.Toolbar.txtBracket_Square_CloseOpen":"括号","SSE.Controllers.Toolbar.txtBracket_Square_NoneOpen":"单括号","SSE.Controllers.Toolbar.txtBracket_Square_OpenNone":"单括号","SSE.Controllers.Toolbar.txtBracket_Square_OpenOpen":"括号","SSE.Controllers.Toolbar.txtBracket_SquareDouble":"括号","SSE.Controllers.Toolbar.txtBracket_SquareDouble_NoneOpen":"单括号","SSE.Controllers.Toolbar.txtBracket_SquareDouble_OpenNone":"单括号","SSE.Controllers.Toolbar.txtBracket_UppLim":"括号","SSE.Controllers.Toolbar.txtBracket_UppLim_NoneOpen":"单括号","SSE.Controllers.Toolbar.txtBracket_UppLim_OpenNone":"单括号","SSE.Controllers.Toolbar.txtDeleteCells":"删除单元格","SSE.Controllers.Toolbar.txtExpand":"扩展选定区域","SSE.Controllers.Toolbar.txtExpandSort":"选定区域旁边还有数据。该数据未被选择，将不参加排序。","SSE.Controllers.Toolbar.txtFractionDiagonal":"倾斜分数","SSE.Controllers.Toolbar.txtFractionDifferential_1":"微分","SSE.Controllers.Toolbar.txtFractionDifferential_2":"微分","SSE.Controllers.Toolbar.txtFractionDifferential_3":"微分","SSE.Controllers.Toolbar.txtFractionDifferential_4":"微分","SSE.Controllers.Toolbar.txtFractionHorizontal":"线性分数","SSE.Controllers.Toolbar.txtFractionPi_2":"π/ 2","SSE.Controllers.Toolbar.txtFractionSmall":"小分数","SSE.Controllers.Toolbar.txtFractionVertical":"堆积分数","SSE.Controllers.Toolbar.txtFunction_1_Cos":"反余弦","SSE.Controllers.Toolbar.txtFunction_1_Cosh":"双曲反余弦函数","SSE.Controllers.Toolbar.txtFunction_1_Cot":"反余切","SSE.Controllers.Toolbar.txtFunction_1_Coth":"双曲反正弦函数","SSE.Controllers.Toolbar.txtFunction_1_Csc":"反余割","SSE.Controllers.Toolbar.txtFunction_1_Csch":"双曲逆乘功能","SSE.Controllers.Toolbar.txtFunction_1_Sec":"反正割","SSE.Controllers.Toolbar.txtFunction_1_Sech":"双曲线逆分割函数","SSE.Controllers.Toolbar.txtFunction_1_Sin":"反正弦","SSE.Controllers.Toolbar.txtFunction_1_Sinh":"双曲反正弦函数","SSE.Controllers.Toolbar.txtFunction_1_Tan":"反切线","SSE.Controllers.Toolbar.txtFunction_1_Tanh":"双曲反正切函数","SSE.Controllers.Toolbar.txtFunction_Cos":"余弦","SSE.Controllers.Toolbar.txtFunction_Cosh":"双曲余弦函数","SSE.Controllers.Toolbar.txtFunction_Cot":"余切","SSE.Controllers.Toolbar.txtFunction_Coth":"双曲正交函数","SSE.Controllers.Toolbar.txtFunction_Csc":"余割","SSE.Controllers.Toolbar.txtFunction_Csch":"双曲余弦函数","SSE.Controllers.Toolbar.txtFunction_Custom_1":"正弦θ","SSE.Controllers.Toolbar.txtFunction_Custom_2":"Cos 2x","SSE.Controllers.Toolbar.txtFunction_Custom_3":"切线公式","SSE.Controllers.Toolbar.txtFunction_Sec":"正割","SSE.Controllers.Toolbar.txtFunction_Sech":"双曲正割函数","SSE.Controllers.Toolbar.txtFunction_Sin":"正弦函数","SSE.Controllers.Toolbar.txtFunction_Sinh":"双曲正弦函数","SSE.Controllers.Toolbar.txtFunction_Tan":"切线","SSE.Controllers.Toolbar.txtFunction_Tanh":"双曲正切函数","SSE.Controllers.Toolbar.txtGroupCell_Custom":"自定义","SSE.Controllers.Toolbar.txtGroupCell_DataAndModel":"数据和模型","SSE.Controllers.Toolbar.txtGroupCell_GoodBadAndNeutral":"好、差和适中","SSE.Controllers.Toolbar.txtGroupCell_NoName":"无名称","SSE.Controllers.Toolbar.txtGroupCell_NumberFormat":"数字格式","SSE.Controllers.Toolbar.txtGroupCell_ThemedCallStyles":"主题单元格样式","SSE.Controllers.Toolbar.txtGroupCell_TitlesAndHeadings":"标题","SSE.Controllers.Toolbar.txtGroupTable_Custom":"自定义","SSE.Controllers.Toolbar.txtGroupTable_Dark":"深色","SSE.Controllers.Toolbar.txtGroupTable_Light":"浅色","SSE.Controllers.Toolbar.txtGroupTable_Medium":"中等深浅","SSE.Controllers.Toolbar.txtInsertCells":"插入单元格","SSE.Controllers.Toolbar.txtIntegral":"积分","SSE.Controllers.Toolbar.txtIntegral_dtheta":"差分θ","SSE.Controllers.Toolbar.txtIntegral_dx":"差分x","SSE.Controllers.Toolbar.txtIntegral_dy":"差分y","SSE.Controllers.Toolbar.txtIntegralCenterSubSup":"积分","SSE.Controllers.Toolbar.txtIntegralDouble":"双积分","SSE.Controllers.Toolbar.txtIntegralDoubleCenterSubSup":"双积分","SSE.Controllers.Toolbar.txtIntegralDoubleSubSup":"双积分","SSE.Controllers.Toolbar.txtIntegralOriented":"轮廓积分","SSE.Controllers.Toolbar.txtIntegralOrientedCenterSubSup":"轮廓积分","SSE.Controllers.Toolbar.txtIntegralOrientedDouble":"曲面积分","SSE.Controllers.Toolbar.txtIntegralOrientedDoubleCenterSubSup":"曲面积分","SSE.Controllers.Toolbar.txtIntegralOrientedDoubleSubSup":"曲面积分","SSE.Controllers.Toolbar.txtIntegralOrientedSubSup":"轮廓积分","SSE.Controllers.Toolbar.txtIntegralOrientedTriple":"体积积分","SSE.Controllers.Toolbar.txtIntegralOrientedTripleCenterSubSup":"体积积分","SSE.Controllers.Toolbar.txtIntegralOrientedTripleSubSup":"体积积分","SSE.Controllers.Toolbar.txtIntegralSubSup":"积分","SSE.Controllers.Toolbar.txtIntegralTriple":"三重积分","SSE.Controllers.Toolbar.txtIntegralTripleCenterSubSup":"三重积分","SSE.Controllers.Toolbar.txtIntegralTripleSubSup":"三重积分","SSE.Controllers.Toolbar.txtInvalidRange":"错误！无效的单元格范围","SSE.Controllers.Toolbar.txtLargeOperator_Conjunction":"楔","SSE.Controllers.Toolbar.txtLargeOperator_Conjunction_CenterSub":"楔","SSE.Controllers.Toolbar.txtLargeOperator_Conjunction_CenterSubSup":"楔","SSE.Controllers.Toolbar.txtLargeOperator_Conjunction_Sub":"楔","SSE.Controllers.Toolbar.txtLargeOperator_Conjunction_SubSup":"楔","SSE.Controllers.Toolbar.txtLargeOperator_CoProd":"副积","SSE.Controllers.Toolbar.txtLargeOperator_CoProd_CenterSub":"副积","SSE.Controllers.Toolbar.txtLargeOperator_CoProd_CenterSubSup":"副积","SSE.Controllers.Toolbar.txtLargeOperator_CoProd_Sub":"副积","SSE.Controllers.Toolbar.txtLargeOperator_CoProd_SubSup":"副积","SSE.Controllers.Toolbar.txtLargeOperator_Custom_1":"合计","SSE.Controllers.Toolbar.txtLargeOperator_Custom_2":"合计","SSE.Controllers.Toolbar.txtLargeOperator_Custom_3":"合计","SSE.Controllers.Toolbar.txtLargeOperator_Custom_4":"乘积","SSE.Controllers.Toolbar.txtLargeOperator_Custom_5":"并集","SSE.Controllers.Toolbar.txtLargeOperator_Disjunction":"三角","SSE.Controllers.Toolbar.txtLargeOperator_Disjunction_CenterSub":"三角","SSE.Controllers.Toolbar.txtLargeOperator_Disjunction_CenterSubSup":"三角","SSE.Controllers.Toolbar.txtLargeOperator_Disjunction_Sub":"三角","SSE.Controllers.Toolbar.txtLargeOperator_Disjunction_SubSup":"三角","SSE.Controllers.Toolbar.txtLargeOperator_Intersection":"交集","SSE.Controllers.Toolbar.txtLargeOperator_Intersection_CenterSub":"交集","SSE.Controllers.Toolbar.txtLargeOperator_Intersection_CenterSubSup":"交集","SSE.Controllers.Toolbar.txtLargeOperator_Intersection_Sub":"交集","SSE.Controllers.Toolbar.txtLargeOperator_Intersection_SubSup":"交集","SSE.Controllers.Toolbar.txtLargeOperator_Prod":"乘积","SSE.Controllers.Toolbar.txtLargeOperator_Prod_CenterSub":"乘积","SSE.Controllers.Toolbar.txtLargeOperator_Prod_CenterSubSup":"乘积","SSE.Controllers.Toolbar.txtLargeOperator_Prod_Sub":"乘积","SSE.Controllers.Toolbar.txtLargeOperator_Prod_SubSup":"乘积","SSE.Controllers.Toolbar.txtLargeOperator_Sum":"合计","SSE.Controllers.Toolbar.txtLargeOperator_Sum_CenterSub":"合计","SSE.Controllers.Toolbar.txtLargeOperator_Sum_CenterSubSup":"合计","SSE.Controllers.Toolbar.txtLargeOperator_Sum_Sub":"合计","SSE.Controllers.Toolbar.txtLargeOperator_Sum_SubSup":"合计","SSE.Controllers.Toolbar.txtLargeOperator_Union":"并集","SSE.Controllers.Toolbar.txtLargeOperator_Union_CenterSub":"并集","SSE.Controllers.Toolbar.txtLargeOperator_Union_CenterSubSup":"并集","SSE.Controllers.Toolbar.txtLargeOperator_Union_Sub":"并集","SSE.Controllers.Toolbar.txtLargeOperator_Union_SubSup":"并集","SSE.Controllers.Toolbar.txtLimitLog_Custom_1":"极限示例","SSE.Controllers.Toolbar.txtLimitLog_Custom_2":"最大范例","SSE.Controllers.Toolbar.txtLimitLog_Lim":"极限","SSE.Controllers.Toolbar.txtLimitLog_Ln":"自然对数","SSE.Controllers.Toolbar.txtLimitLog_Log":"对数","SSE.Controllers.Toolbar.txtLimitLog_LogBase":"对数","SSE.Controllers.Toolbar.txtLimitLog_Max":"最大值","SSE.Controllers.Toolbar.txtLimitLog_Min":"最小值","SSE.Controllers.Toolbar.txtLockSort":"在选择区附近找到数据，但是你没有足够的权限修改这些单元格。<br>你希望继续操作当前选择区吗？","SSE.Controllers.Toolbar.txtMatrix_1_2":"1x2空矩阵","SSE.Controllers.Toolbar.txtMatrix_1_3":"1x3空矩阵","SSE.Controllers.Toolbar.txtMatrix_2_1":"2x1空矩阵","SSE.Controllers.Toolbar.txtMatrix_2_2":"2x2空矩阵","SSE.Controllers.Toolbar.txtMatrix_2_2_DLineBracket":"空矩阵与支架","SSE.Controllers.Toolbar.txtMatrix_2_2_LineBracket":"空矩阵与支架","SSE.Controllers.Toolbar.txtMatrix_2_2_RoundBracket":"空矩阵与支架","SSE.Controllers.Toolbar.txtMatrix_2_2_SquareBracket":"空矩阵与支架","SSE.Controllers.Toolbar.txtMatrix_2_3":"2x3空矩阵","SSE.Controllers.Toolbar.txtMatrix_3_1":"3x1空矩阵","SSE.Controllers.Toolbar.txtMatrix_3_2":"3x2空矩阵","SSE.Controllers.Toolbar.txtMatrix_3_3":"3x3空矩阵","SSE.Controllers.Toolbar.txtMatrix_Dots_Baseline":"基线点","SSE.Controllers.Toolbar.txtMatrix_Dots_Center":"中线点","SSE.Controllers.Toolbar.txtMatrix_Dots_Diagonal":"对角点","SSE.Controllers.Toolbar.txtMatrix_Dots_Vertical":"垂直点","SSE.Controllers.Toolbar.txtMatrix_Flat_Round":"稀疏矩阵","SSE.Controllers.Toolbar.txtMatrix_Flat_Square":"稀疏矩阵","SSE.Controllers.Toolbar.txtMatrix_Identity_2":"2x2个性矩阵","SSE.Controllers.Toolbar.txtMatrix_Identity_2_NoZeros":"3x3个性矩阵","SSE.Controllers.Toolbar.txtMatrix_Identity_3":"3x3个性矩阵","SSE.Controllers.Toolbar.txtMatrix_Identity_3_NoZeros":"3x3个性矩阵","SSE.Controllers.Toolbar.txtOperator_ArrowD_Bot":"右左箭头下面","SSE.Controllers.Toolbar.txtOperator_ArrowD_Top":"右上方的箭头在上方","SSE.Controllers.Toolbar.txtOperator_ArrowL_Bot":"向左箭头","SSE.Controllers.Toolbar.txtOperator_ArrowL_Top":"向左箭头","SSE.Controllers.Toolbar.txtOperator_ArrowR_Bot":"下面箭头向右","SSE.Controllers.Toolbar.txtOperator_ArrowR_Top":"向右箭头上方","SSE.Controllers.Toolbar.txtOperator_ColonEquals":"冒号相等","SSE.Controllers.Toolbar.txtOperator_Custom_1":"统一","SSE.Controllers.Toolbar.txtOperator_Custom_2":"三角形区域","SSE.Controllers.Toolbar.txtOperator_Definition":"相等于定义","SSE.Controllers.Toolbar.txtOperator_DeltaEquals":"数据相当于","SSE.Controllers.Toolbar.txtOperator_DoubleArrowD_Bot":"右左箭头下面","SSE.Controllers.Toolbar.txtOperator_DoubleArrowD_Top":"右上方的箭头在上方","SSE.Controllers.Toolbar.txtOperator_DoubleArrowL_Bot":"向左箭头","SSE.Controllers.Toolbar.txtOperator_DoubleArrowL_Top":"向左箭头","SSE.Controllers.Toolbar.txtOperator_DoubleArrowR_Bot":"下面箭头向右","SSE.Controllers.Toolbar.txtOperator_DoubleArrowR_Top":"向右箭头上方","SSE.Controllers.Toolbar.txtOperator_EqualsEquals":"等号等号","SSE.Controllers.Toolbar.txtOperator_MinusEquals":"减号相等","SSE.Controllers.Toolbar.txtOperator_PlusEquals":"加上等于","SSE.Controllers.Toolbar.txtOperator_UnitOfMeasure":"被测量","SSE.Controllers.Toolbar.txtRadicalCustom_1":"部首","SSE.Controllers.Toolbar.txtRadicalCustom_2":"部首","SSE.Controllers.Toolbar.txtRadicalRoot_2":"平方根","SSE.Controllers.Toolbar.txtRadicalRoot_3":"立方根","SSE.Controllers.Toolbar.txtRadicalRoot_n":"带有次数的根式","SSE.Controllers.Toolbar.txtRadicalSqrt":"平方根","SSE.Controllers.Toolbar.txtScriptCustom_1":"脚本","SSE.Controllers.Toolbar.txtScriptCustom_2":"脚本","SSE.Controllers.Toolbar.txtScriptCustom_3":"脚本","SSE.Controllers.Toolbar.txtScriptCustom_4":"脚本","SSE.Controllers.Toolbar.txtScriptSub":"下标","SSE.Controllers.Toolbar.txtScriptSubSup":"下标","SSE.Controllers.Toolbar.txtScriptSubSupLeft":"左标-标注","SSE.Controllers.Toolbar.txtScriptSup":"上标","SSE.Controllers.Toolbar.txtSorting":"排序","SSE.Controllers.Toolbar.txtSortSelected":"以当前选定区域排序","SSE.Controllers.Toolbar.txtSymbol_about":"大约","SSE.Controllers.Toolbar.txtSymbol_additional":"补集","SSE.Controllers.Toolbar.txtSymbol_aleph":"阿列夫","SSE.Controllers.Toolbar.txtSymbol_alpha":"Alpha","SSE.Controllers.Toolbar.txtSymbol_approx":"几乎相等","SSE.Controllers.Toolbar.txtSymbol_ast":"星号运算符","SSE.Controllers.Toolbar.txtSymbol_beta":"测试版","SSE.Controllers.Toolbar.txtSymbol_beth":"打赌","SSE.Controllers.Toolbar.txtSymbol_bullet":"加重号运算符","SSE.Controllers.Toolbar.txtSymbol_cap":"交集","SSE.Controllers.Toolbar.txtSymbol_cbrt":"立方根","SSE.Controllers.Toolbar.txtSymbol_cdots":"中线水平省略号","SSE.Controllers.Toolbar.txtSymbol_celsius":"摄氏度","SSE.Controllers.Toolbar.txtSymbol_chi":"驰","SSE.Controllers.Toolbar.txtSymbol_cong":"大致相等","SSE.Controllers.Toolbar.txtSymbol_cup":"并集","SSE.Controllers.Toolbar.txtSymbol_ddots":"向右对角线省略号","SSE.Controllers.Toolbar.txtSymbol_degree":"度","SSE.Controllers.Toolbar.txtSymbol_delta":"参加","SSE.Controllers.Toolbar.txtSymbol_div":"除号","SSE.Controllers.Toolbar.txtSymbol_downarrow":"向下箭头","SSE.Controllers.Toolbar.txtSymbol_emptyset":"空集","SSE.Controllers.Toolbar.txtSymbol_epsilon":"小量","SSE.Controllers.Toolbar.txtSymbol_equals":"平等","SSE.Controllers.Toolbar.txtSymbol_equiv":"相同","SSE.Controllers.Toolbar.txtSymbol_eta":"和","SSE.Controllers.Toolbar.txtSymbol_exists":"有存在","SSE.Controllers.Toolbar.txtSymbol_factorial":"阶乘","SSE.Controllers.Toolbar.txtSymbol_fahrenheit":"华氏度","SSE.Controllers.Toolbar.txtSymbol_forall":"全部","SSE.Controllers.Toolbar.txtSymbol_gamma":"Gamma","SSE.Controllers.Toolbar.txtSymbol_geq":"大于或等于","SSE.Controllers.Toolbar.txtSymbol_gg":"远大于","SSE.Controllers.Toolbar.txtSymbol_greater":"大于","SSE.Controllers.Toolbar.txtSymbol_in":"元素","SSE.Controllers.Toolbar.txtSymbol_inc":"增量","SSE.Controllers.Toolbar.txtSymbol_infinity":"无限","SSE.Controllers.Toolbar.txtSymbol_iota":"Iota","SSE.Controllers.Toolbar.txtSymbol_kappa":"卡帕","SSE.Controllers.Toolbar.txtSymbol_lambda":"Lambda","SSE.Controllers.Toolbar.txtSymbol_leftarrow":"左箭头","SSE.Controllers.Toolbar.txtSymbol_leftrightarrow":"左右箭头","SSE.Controllers.Toolbar.txtSymbol_leq":"小于或等于","SSE.Controllers.Toolbar.txtSymbol_less":"小于","SSE.Controllers.Toolbar.txtSymbol_ll":"远小于","SSE.Controllers.Toolbar.txtSymbol_minus":"减去","SSE.Controllers.Toolbar.txtSymbol_mp":"减号加","SSE.Controllers.Toolbar.txtSymbol_mu":"亩","SSE.Controllers.Toolbar.txtSymbol_nabla":"微分算符","SSE.Controllers.Toolbar.txtSymbol_neq":"不等于","SSE.Controllers.Toolbar.txtSymbol_ni":"包含作为成员","SSE.Controllers.Toolbar.txtSymbol_not":"未签名","SSE.Controllers.Toolbar.txtSymbol_notexists":"没有存在","SSE.Controllers.Toolbar.txtSymbol_nu":"Nu","SSE.Controllers.Toolbar.txtSymbol_o":"奥米克","SSE.Controllers.Toolbar.txtSymbol_omega":"欧米茄","SSE.Controllers.Toolbar.txtSymbol_partial":"偏微分","SSE.Controllers.Toolbar.txtSymbol_percent":"百分比","SSE.Controllers.Toolbar.txtSymbol_phi":"Phi","SSE.Controllers.Toolbar.txtSymbol_pi":"Pi","SSE.Controllers.Toolbar.txtSymbol_plus":"加","SSE.Controllers.Toolbar.txtSymbol_pm":"加减","SSE.Controllers.Toolbar.txtSymbol_propto":"成比例","SSE.Controllers.Toolbar.txtSymbol_psi":"PSI","SSE.Controllers.Toolbar.txtSymbol_qdrt":"第四根","SSE.Controllers.Toolbar.txtSymbol_qed":"审校结束","SSE.Controllers.Toolbar.txtSymbol_rddots":"向右对角线省略号","SSE.Controllers.Toolbar.txtSymbol_rho":"Rho","SSE.Controllers.Toolbar.txtSymbol_rightarrow":"右箭头","SSE.Controllers.Toolbar.txtSymbol_sigma":"适马","SSE.Controllers.Toolbar.txtSymbol_sqrt":"根号","SSE.Controllers.Toolbar.txtSymbol_tau":"战斗","SSE.Controllers.Toolbar.txtSymbol_therefore":"因此","SSE.Controllers.Toolbar.txtSymbol_theta":"西塔","SSE.Controllers.Toolbar.txtSymbol_times":"乘法符号","SSE.Controllers.Toolbar.txtSymbol_uparrow":"向上箭头","SSE.Controllers.Toolbar.txtSymbol_upsilon":"Upsilon","SSE.Controllers.Toolbar.txtSymbol_varepsilon":"Epsilon变体","SSE.Controllers.Toolbar.txtSymbol_varphi":"Phi 变量","SSE.Controllers.Toolbar.txtSymbol_varpi":"π变量","SSE.Controllers.Toolbar.txtSymbol_varrho":"Rho 变量","SSE.Controllers.Toolbar.txtSymbol_varsigma":"Sigma变量","SSE.Controllers.Toolbar.txtSymbol_vartheta":"西塔","SSE.Controllers.Toolbar.txtSymbol_vdots":"垂直省略号","SSE.Controllers.Toolbar.txtSymbol_xsi":"粒子","SSE.Controllers.Toolbar.txtSymbol_zeta":"Zeta","SSE.Controllers.Toolbar.txtTable_TableStyleDark":"表样式黑暗","SSE.Controllers.Toolbar.txtTable_TableStyleLight":"表样式光","SSE.Controllers.Toolbar.txtTable_TableStyleMedium":"表样式中等","SSE.Controllers.Toolbar.warnLongOperation":"您即将执行的操作可能需要相当长的时间才能完成。<br>您确定要继续吗？","SSE.Controllers.Toolbar.warnMergeLostData":"只有来自左上方单元格的数据将保留在合并的单元格中。<br>您确定要继续吗？","SSE.Controllers.Toolbar.warnNoRecommended":"要创建图表，请选择包含你想要使用的数据的单元格。<br>如果行和列具有名称，并且你想要将它们用作标签，请将它们包含在所选内容中。","SSE.Controllers.Viewport.textFreezePanes":"冻结窗格","SSE.Controllers.Viewport.textFreezePanesShadow":"显示冻结窗格的阴影","SSE.Controllers.Viewport.textHideFBar":"隐藏编辑栏","SSE.Controllers.Viewport.textHideGridlines":"隐藏网格线","SSE.Controllers.Viewport.textHideHeadings":"隐藏标题","SSE.Views.AdvancedSeparatorDialog.strDecimalSeparator":"小数分隔符","SSE.Views.AdvancedSeparatorDialog.strThousandsSeparator":"千位分隔符","SSE.Views.AdvancedSeparatorDialog.textLabel":"用于识别数值数据的设置","SSE.Views.AdvancedSeparatorDialog.textQualifier":"文本限定符","SSE.Views.AdvancedSeparatorDialog.textTitle":"高级设置","SSE.Views.AdvancedSeparatorDialog.txtNone":"（无）","SSE.Views.AutoFilterDialog.btnCustomFilter":"自定义筛选","SSE.Views.AutoFilterDialog.textAddSelection":"将当前所选内容添加到筛选器","SSE.Views.AutoFilterDialog.textEmptyItem":"空白","SSE.Views.AutoFilterDialog.textSelectAll":"全选","SSE.Views.AutoFilterDialog.textSelectAllResults":"选择所有搜索结果","SSE.Views.AutoFilterDialog.textWarning":"警告","SSE.Views.AutoFilterDialog.txtAboveAve":"平均水平以上","SSE.Views.AutoFilterDialog.txtAfter":"之后...","SSE.Views.AutoFilterDialog.txtAllDatesInThePeriod":"期间中的所有日期","SSE.Views.AutoFilterDialog.txtApril":"四月","SSE.Views.AutoFilterDialog.txtAugust":"八月","SSE.Views.AutoFilterDialog.txtBefore":"之前...","SSE.Views.AutoFilterDialog.txtBegins":"开头是...","SSE.Views.AutoFilterDialog.txtBelowAve":"低于平均值","SSE.Views.AutoFilterDialog.txtBetween":"介于...","SSE.Views.AutoFilterDialog.txtClear":"清除","SSE.Views.AutoFilterDialog.txtContains":"包含...","SSE.Views.AutoFilterDialog.txtDateFilter":"日期筛选器","SSE.Views.AutoFilterDialog.txtEmpty":"输入单元格过滤器","SSE.Views.AutoFilterDialog.txtEnds":"结尾是...","SSE.Views.AutoFilterDialog.txtEquals":"等于...","SSE.Views.AutoFilterDialog.txtFebruary":"二月","SSE.Views.AutoFilterDialog.txtFilterCellColor":"按单元格颜色筛选","SSE.Views.AutoFilterDialog.txtFilterFontColor":"按字体颜色筛选","SSE.Views.AutoFilterDialog.txtGreater":"大于...","SSE.Views.AutoFilterDialog.txtGreaterEquals":"大于或等于...","SSE.Views.AutoFilterDialog.txtJanuary":"一月","SSE.Views.AutoFilterDialog.txtJuly":"七月","SSE.Views.AutoFilterDialog.txtJune":"六月","SSE.Views.AutoFilterDialog.txtLabelFilter":"标签筛选","SSE.Views.AutoFilterDialog.txtLastMonth":"上个月","SSE.Views.AutoFilterDialog.txtLastQuarter":"上个季度","SSE.Views.AutoFilterDialog.txtLastWeek":"上周","SSE.Views.AutoFilterDialog.txtLastYear":"去年","SSE.Views.AutoFilterDialog.txtLess":"小于...","SSE.Views.AutoFilterDialog.txtLessEquals":"小于或等于...","SSE.Views.AutoFilterDialog.txtMarch":"三月","SSE.Views.AutoFilterDialog.txtMay":"五月","SSE.Views.AutoFilterDialog.txtNextMonth":"下个月","SSE.Views.AutoFilterDialog.txtNextQuarter":"下季度","SSE.Views.AutoFilterDialog.txtNextWeek":"下周","SSE.Views.AutoFilterDialog.txtNextYear":"下一年","SSE.Views.AutoFilterDialog.txtNotBegins":"不以...开头","SSE.Views.AutoFilterDialog.txtNotBetween":"不介于...","SSE.Views.AutoFilterDialog.txtNotContains":"不包含...","SSE.Views.AutoFilterDialog.txtNotEnds":"不以...结尾","SSE.Views.AutoFilterDialog.txtNotEquals":"不等于...","SSE.Views.AutoFilterDialog.txtNovember":"十一月","SSE.Views.AutoFilterDialog.txtNumFilter":"数字筛选","SSE.Views.AutoFilterDialog.txtOctober":"十月","SSE.Views.AutoFilterDialog.txtQuarter1":"一季度","SSE.Views.AutoFilterDialog.txtQuarter2":"一季度","SSE.Views.AutoFilterDialog.txtQuarter3":"一季度","SSE.Views.AutoFilterDialog.txtQuarter4":"一季度","SSE.Views.AutoFilterDialog.txtReapply":"重新应用","SSE.Views.AutoFilterDialog.txtSeptember":"九月","SSE.Views.AutoFilterDialog.txtSortCellColor":"按单元格颜色排序","SSE.Views.AutoFilterDialog.txtSortFontColor":"按字体颜色排序","SSE.Views.AutoFilterDialog.txtSortHigh2Low":"降序","SSE.Views.AutoFilterDialog.txtSortLow2High":"升序","SSE.Views.AutoFilterDialog.txtSortOption":"其它排序选项...","SSE.Views.AutoFilterDialog.txtTextFilter":"文字筛选","SSE.Views.AutoFilterDialog.txtThisMonth":"这个月","SSE.Views.AutoFilterDialog.txtThisQuarter":"本季度","SSE.Views.AutoFilterDialog.txtThisWeek":"本周","SSE.Views.AutoFilterDialog.txtThisYear":"今年","SSE.Views.AutoFilterDialog.txtTitle":"筛选","SSE.Views.AutoFilterDialog.txtToday":"今天","SSE.Views.AutoFilterDialog.txtTomorrow":"明天","SSE.Views.AutoFilterDialog.txtTop10":"前10项","SSE.Views.AutoFilterDialog.txtValueFilter":"按值筛选","SSE.Views.AutoFilterDialog.txtYearToDate":"年初至今","SSE.Views.AutoFilterDialog.txtYesterday":"昨天","SSE.Views.AutoFilterDialog.warnFilterError":"为了使筛选器生效，你至少需要一个值位于值区域中。","SSE.Views.AutoFilterDialog.warnNoSelected":"您必须至少选择一个值","SSE.Views.CellEditor.textManager":"名称管理","SSE.Views.CellEditor.tipFormula":"插入函数","SSE.Views.CellRangeDialog.errorMaxRows":"错误！每个图表的最大数据系列数为255","SSE.Views.CellRangeDialog.errorStockChart":"行顺序不正确。建立股票图表将数据按照以下顺序放置在表格上：<br>开盘价，最高价格，最低价格，收盘价。","SSE.Views.CellRangeDialog.txtEmpty":"必填项","SSE.Views.CellRangeDialog.txtInvalidRange":"错误！无效的单元格范围","SSE.Views.CellRangeDialog.txtTitle":"选择数据范围","SSE.Views.CellSettings.strShrink":"缩小字体填充","SSE.Views.CellSettings.strWrap":"自动换行","SSE.Views.CellSettings.textAngle":"角度","SSE.Views.CellSettings.textBackColor":"背景颜色","SSE.Views.CellSettings.textBackground":"背景颜色","SSE.Views.CellSettings.textBorderColor":"颜色","SSE.Views.CellSettings.textBorders":"边框","SSE.Views.CellSettings.textClearRule":"清除规则","SSE.Views.CellSettings.textColor":"纯色填充","SSE.Views.CellSettings.textColorScales":"色阶","SSE.Views.CellSettings.textCondFormat":"条件格式","SSE.Views.CellSettings.textControl":"文本控制","SSE.Views.CellSettings.textDataBars":"数据条","SSE.Views.CellSettings.textDirection":"方向","SSE.Views.CellSettings.textFill":"填充","SSE.Views.CellSettings.textForeground":"前景色","SSE.Views.CellSettings.textGradient":"渐变点","SSE.Views.CellSettings.textGradientColor":"颜色","SSE.Views.CellSettings.textGradientFill":"渐变填充","SSE.Views.CellSettings.textIndent":"缩进","SSE.Views.CellSettings.textItems":"条","SSE.Views.CellSettings.textLinear":"线性","SSE.Views.CellSettings.textManageRule":"管理规则","SSE.Views.CellSettings.textNewRule":"新建规则","SSE.Views.CellSettings.textNoFill":"无填充","SSE.Views.CellSettings.textOrientation":"文字方向","SSE.Views.CellSettings.textPattern":"模式","SSE.Views.CellSettings.textPatternFill":"图案填充","SSE.Views.CellSettings.textPosition":"位置","SSE.Views.CellSettings.textRadial":"径向","SSE.Views.CellSettings.textSelectBorders":"选择您要更改应用样式的边框","SSE.Views.CellSettings.textSelection":"清除所选单元格的规则","SSE.Views.CellSettings.textThisPivot":"清除此数据透视表的规则","SSE.Views.CellSettings.textThisSheet":"清除整个工作表的规则","SSE.Views.CellSettings.textThisTable":"清除此表的规则","SSE.Views.CellSettings.tipAddGradientPoint":"新增渐变点","SSE.Views.CellSettings.tipAll":"所有边框","SSE.Views.CellSettings.tipBottom":"仅设置外下边框","SSE.Views.CellSettings.tipDiagD":"设置对角下边框","SSE.Views.CellSettings.tipDiagU":"设置对角上边框","SSE.Views.CellSettings.tipInner":"内部框线","SSE.Views.CellSettings.tipInnerHor":"内部横框线","SSE.Views.CellSettings.tipInnerVert":"内部竖框线","SSE.Views.CellSettings.tipLeft":"仅设置左外边框","SSE.Views.CellSettings.tipNone":"无边框","SSE.Views.CellSettings.tipOuter":"仅设置外边框","SSE.Views.CellSettings.tipRemoveGradientPoint":"删除渐变点","SSE.Views.CellSettings.tipRight":"仅设置外边框","SSE.Views.CellSettings.tipTop":"仅限外边框","SSE.Views.ChartDataDialog.errorInFormula":"您输入的公式中存在错误。","SSE.Views.ChartDataDialog.errorInvalidReference":"引用是非法的。引用必须指向一个已打开的工作表。","SSE.Views.ChartDataDialog.errorMaxPoints":"每个图表最多可以包含4096个点。","SSE.Views.ChartDataDialog.errorMaxRows":"每个图表最多可以包含255个数据序列。","SSE.Views.ChartDataDialog.errorNoSingleRowCol":"该引用无效。标题，值，大小或数据标签的引用必须是单个单元格，行或列。","SSE.Views.ChartDataDialog.errorNoValues":"若要创建图表，系列中必须至少包含一个值。","SSE.Views.ChartDataDialog.errorStockChart":"行顺序不正确，建立股票图表应将数据按照以下顺序放置在表格上：<br>开盘价，最高价格，最低价格，收盘价。","SSE.Views.ChartDataDialog.textAdd":"添加","SSE.Views.ChartDataDialog.textCategory":"水平(分类)轴标签","SSE.Views.ChartDataDialog.textData":"图表数据区域","SSE.Views.ChartDataDialog.textDelete":"删除","SSE.Views.ChartDataDialog.textDown":"下","SSE.Views.ChartDataDialog.textEdit":"编辑","SSE.Views.ChartDataDialog.textInvalidRange":"无效的单元格范围","SSE.Views.ChartDataDialog.textSelectData":"选择数据","SSE.Views.ChartDataDialog.textSeries":"图例项(系列)","SSE.Views.ChartDataDialog.textSwitch":"切换行/列","SSE.Views.ChartDataDialog.textTitle":"图表数据","SSE.Views.ChartDataDialog.textUp":"上","SSE.Views.ChartDataRangeDialog.errorInFormula":"您输入的公式中存在错误。","SSE.Views.ChartDataRangeDialog.errorInvalidReference":"引用是非法的。引用必须指向一个已打开的工作表。","SSE.Views.ChartDataRangeDialog.errorMaxPoints":"每个图表最多可以包含4096个点。","SSE.Views.ChartDataRangeDialog.errorMaxRows":"每个图表最多可以包含255个数据序列。","SSE.Views.ChartDataRangeDialog.errorNoSingleRowCol":"该引用无效。标题，值，大小或数据标签的引用必须是单个单元格，行或列。","SSE.Views.ChartDataRangeDialog.errorNoValues":"若要创建图表，系列中必须至少包含一个值。","SSE.Views.ChartDataRangeDialog.errorStockChart":"行顺序不正确，建立股票图表应将数据按照以下顺序放置在表格上：<br>开盘价，最高价格，最低价格，收盘价。","SSE.Views.ChartDataRangeDialog.textInvalidRange":"无效的单元格范围","SSE.Views.ChartDataRangeDialog.textSelectData":"选择数据","SSE.Views.ChartDataRangeDialog.txtAxisLabel":"轴标签区域","SSE.Views.ChartDataRangeDialog.txtChoose":"选择范围","SSE.Views.ChartDataRangeDialog.txtSeriesName":"系列名称","SSE.Views.ChartDataRangeDialog.txtTitleCategory":"坐标轴标题","SSE.Views.ChartDataRangeDialog.txtTitleSeries":"编辑​​系列","SSE.Views.ChartDataRangeDialog.txtValues":"值","SSE.Views.ChartDataRangeDialog.txtXValues":"X 值","SSE.Views.ChartDataRangeDialog.txtYValues":"Y 值","SSE.Views.ChartSettings.errorMaxRows":"每个图表最多可以包含255个数据序列。","SSE.Views.ChartSettings.strLineWeight":"线宽","SSE.Views.ChartSettings.strSparkColor":"颜色","SSE.Views.ChartSettings.strTemplate":"样式","SSE.Views.ChartSettings.text3dDepth":"深度(原始深度百分比)","SSE.Views.ChartSettings.text3dHeight":"高度(原始高度百分比)","SSE.Views.ChartSettings.text3dRotation":"三维旋转","SSE.Views.ChartSettings.textAdvanced":"显示高级设置","SSE.Views.ChartSettings.textAutoscale":"自动缩放","SSE.Views.ChartSettings.textBorderSizeErr":"输入的值不正确。<br>请输入介于0 pt和1584 pt之间的值。","SSE.Views.ChartSettings.textChangeType":"更改图表类型","SSE.Views.ChartSettings.textChartType":"更改图表类型","SSE.Views.ChartSettings.textDefault":"默认旋转","SSE.Views.ChartSettings.textDown":"向下","SSE.Views.ChartSettings.textEditData":"编辑数据和位置","SSE.Views.ChartSettings.textFirstPoint":"首点","SSE.Views.ChartSettings.textHeight":"高度","SSE.Views.ChartSettings.textHighPoint":"高点","SSE.Views.ChartSettings.textKeepRatio":"锁定纵横比","SSE.Views.ChartSettings.textLastPoint":"尾点","SSE.Views.ChartSettings.textLeft":"向左","SSE.Views.ChartSettings.textLowPoint":"低点","SSE.Views.ChartSettings.textMarkers":"标记","SSE.Views.ChartSettings.textNarrow":"缩小视野","SSE.Views.ChartSettings.textNegativePoint":"负点","SSE.Views.ChartSettings.textPerspective":"透视","SSE.Views.ChartSettings.textRanges":"数据范围","SSE.Views.ChartSettings.textRight":"向右","SSE.Views.ChartSettings.textRightAngle":"直角坐标轴","SSE.Views.ChartSettings.textSelectData":"选择数据","SSE.Views.ChartSettings.textShow":"显示","SSE.Views.ChartSettings.textSize":"大小","SSE.Views.ChartSettings.textStyle":"样式","SSE.Views.ChartSettings.textSwitch":"切换行/列","SSE.Views.ChartSettings.textType":"类型","SSE.Views.ChartSettings.textUp":"向上","SSE.Views.ChartSettings.textWiden":"扩大视野","SSE.Views.ChartSettings.textWidth":"宽度","SSE.Views.ChartSettings.textX":"X 旋转","SSE.Views.ChartSettings.textY":"Y 旋转","SSE.Views.ChartSettingsDlg.errorMaxPoints":"错误！每个图表序列的最大点值为4096。","SSE.Views.ChartSettingsDlg.errorMaxRows":"错误！每个图表的最大数据系列数为255","SSE.Views.ChartSettingsDlg.errorStockChart":"行顺序不正确。建立股票图表将数据按照以下顺序放置在表格上：<br>开盘价，最高价格，最低价格，收盘价。","SSE.Views.ChartSettingsDlg.textAbsolute":"大小和位置均固定","SSE.Views.ChartSettingsDlg.textAlt":"替换文字","SSE.Views.ChartSettingsDlg.textAltDescription":"描述","SSE.Views.ChartSettingsDlg.textAltTip":"视觉对象信息的替代基于文本的表示法，将要向有视觉或认知障碍人阅读，以帮助他们更好地了解图片、自选图形、图表或表格中的那些信息。","SSE.Views.ChartSettingsDlg.textAltTitle":"标题","SSE.Views.ChartSettingsDlg.textAuto":"自动","SSE.Views.ChartSettingsDlg.textAutoEach":"自动调整","SSE.Views.ChartSettingsDlg.textAxisCrosses":"轴十字架","SSE.Views.ChartSettingsDlg.textAxisOptions":"轴的选择","SSE.Views.ChartSettingsDlg.textAxisPos":"坐标轴位置","SSE.Views.ChartSettingsDlg.textAxisSettings":"轴设置","SSE.Views.ChartSettingsDlg.textAxisTitle":"标题","SSE.Views.ChartSettingsDlg.textBase":"底数","SSE.Views.ChartSettingsDlg.textBetweenTickMarks":"刻度线之间","SSE.Views.ChartSettingsDlg.textBillions":"十亿","SSE.Views.ChartSettingsDlg.textBottom":"靠下","SSE.Views.ChartSettingsDlg.textCategoryName":"类别名称","SSE.Views.ChartSettingsDlg.textCenter":"居中","SSE.Views.ChartSettingsDlg.textChartElementsLegend":"图表元素＆图表图例","SSE.Views.ChartSettingsDlg.textChartTitle":"图表标题","SSE.Views.ChartSettingsDlg.textCross":"交叉","SSE.Views.ChartSettingsDlg.textCustom":"自定义","SSE.Views.ChartSettingsDlg.textDataColumns":"在列中","SSE.Views.ChartSettingsDlg.textDataLabels":"数据标签","SSE.Views.ChartSettingsDlg.textDataRows":"在行","SSE.Views.ChartSettingsDlg.textDisplayLegend":"显示图例","SSE.Views.ChartSettingsDlg.textEmptyCells":"隐藏和空白的单元格","SSE.Views.ChartSettingsDlg.textEmptyLine":"用线连接数据点","SSE.Views.ChartSettingsDlg.textFit":"最佳匹配","SSE.Views.ChartSettingsDlg.textFixed":"固定","SSE.Views.ChartSettingsDlg.textFormat":"标签格式","SSE.Views.ChartSettingsDlg.textGaps":"间隙","SSE.Views.ChartSettingsDlg.textGridLines":"网格线","SSE.Views.ChartSettingsDlg.textGroup":"组合迷你图","SSE.Views.ChartSettingsDlg.textHide":"隐藏","SSE.Views.ChartSettingsDlg.textHideAxis":"隐藏轴","SSE.Views.ChartSettingsDlg.textHigh":"高","SSE.Views.ChartSettingsDlg.textHorAxis":"水平轴","SSE.Views.ChartSettingsDlg.textHorAxisSec":"次要横坐标轴","SSE.Views.ChartSettingsDlg.textHorizontal":"水平","SSE.Views.ChartSettingsDlg.textHundredMil":"100 000 000","SSE.Views.ChartSettingsDlg.textHundreds":"百","SSE.Views.ChartSettingsDlg.textHundredThousands":"100 000","SSE.Views.ChartSettingsDlg.textIn":"内部","SSE.Views.ChartSettingsDlg.textInnerBottom":"轴内侧","SSE.Views.ChartSettingsDlg.textInnerTop":"数据标签内","SSE.Views.ChartSettingsDlg.textInvalidRange":"错误！无效的单元格范围","SSE.Views.ChartSettingsDlg.textLabelDist":"与坐标轴的距离","SSE.Views.ChartSettingsDlg.textLabelInterval":"标签间隔 ","SSE.Views.ChartSettingsDlg.textLabelOptions":"标签选项","SSE.Views.ChartSettingsDlg.textLabelPos":"标签位置","SSE.Views.ChartSettingsDlg.textLayout":"图表元素","SSE.Views.ChartSettingsDlg.textLeft":"靠左","SSE.Views.ChartSettingsDlg.textLeftOverlay":"左叠加","SSE.Views.ChartSettingsDlg.textLegendBottom":"底部","SSE.Views.ChartSettingsDlg.textLegendLeft":"左侧","SSE.Views.ChartSettingsDlg.textLegendPos":"图例位置","SSE.Views.ChartSettingsDlg.textLegendRight":"右侧","SSE.Views.ChartSettingsDlg.textLegendTop":"顶部","SSE.Views.ChartSettingsDlg.textLines":"线条","SSE.Views.ChartSettingsDlg.textLocationRange":"位置范围","SSE.Views.ChartSettingsDlg.textLogScale":"对数刻度","SSE.Views.ChartSettingsDlg.textLow":"低","SSE.Views.ChartSettingsDlg.textMajor":"主要","SSE.Views.ChartSettingsDlg.textMajorMinor":"主要和次要","SSE.Views.ChartSettingsDlg.textMajorType":"主要类型","SSE.Views.ChartSettingsDlg.textManual":"手动更改","SSE.Views.ChartSettingsDlg.textMarkers":"标记","SSE.Views.ChartSettingsDlg.textMarksInterval":"刻度线间隔","SSE.Views.ChartSettingsDlg.textMaxValue":"最大值","SSE.Views.ChartSettingsDlg.textMillions":"百万","SSE.Views.ChartSettingsDlg.textMinor":"次要","SSE.Views.ChartSettingsDlg.textMinorType":"次要类型","SSE.Views.ChartSettingsDlg.textMinValue":"最小值","SSE.Views.ChartSettingsDlg.textNextToAxis":"轴旁","SSE.Views.ChartSettingsDlg.textNone":"无","SSE.Views.ChartSettingsDlg.textNoOverlay":"图表上方","SSE.Views.ChartSettingsDlg.textOneCell":"大小固定，位置随单元格而变","SSE.Views.ChartSettingsDlg.textOnTickMarks":"刻度标记","SSE.Views.ChartSettingsDlg.textOut":"外部","SSE.Views.ChartSettingsDlg.textOuterTop":"数据标签外","SSE.Views.ChartSettingsDlg.textOverlay":"居中覆盖","SSE.Views.ChartSettingsDlg.textReverse":"逆序刻度值","SSE.Views.ChartSettingsDlg.textReverseOrder":"相反的顺序","SSE.Views.ChartSettingsDlg.textRight":"靠右","SSE.Views.ChartSettingsDlg.textRightOverlay":"右叠加","SSE.Views.ChartSettingsDlg.textRotated":"旋转","SSE.Views.ChartSettingsDlg.textSameAll":"全都相同","SSE.Views.ChartSettingsDlg.textSelectData":"选择数据","SSE.Views.ChartSettingsDlg.textSeparator":"数据标签分隔符","SSE.Views.ChartSettingsDlg.textSeriesName":"系列名称","SSE.Views.ChartSettingsDlg.textShow":"显示","SSE.Views.ChartSettingsDlg.textShowBorders":"显示图表边框","SSE.Views.ChartSettingsDlg.textShowData":"以隐藏的行和列显示数据","SSE.Views.ChartSettingsDlg.textShowEmptyCells":"显示空单元格","SSE.Views.ChartSettingsDlg.textShowSparkAxis":"显示轴","SSE.Views.ChartSettingsDlg.textShowValues":"显示图表值","SSE.Views.ChartSettingsDlg.textSingle":"单一的迷你图","SSE.Views.ChartSettingsDlg.textSmooth":"平滑","SSE.Views.ChartSettingsDlg.textSnap":"大小和位置","SSE.Views.ChartSettingsDlg.textSparkRanges":"迷你图范围","SSE.Views.ChartSettingsDlg.textStraight":"直线","SSE.Views.ChartSettingsDlg.textStyle":"类型","SSE.Views.ChartSettingsDlg.textTenMillions":"10 000 000","SSE.Views.ChartSettingsDlg.textTenThousands":"10 000","SSE.Views.ChartSettingsDlg.textThousands":"千","SSE.Views.ChartSettingsDlg.textTickOptions":"刻度线","SSE.Views.ChartSettingsDlg.textTitle":"图表 - 高级设置","SSE.Views.ChartSettingsDlg.textTitleSparkline":"迷你图 - 高级设置","SSE.Views.ChartSettingsDlg.textTop":"靠上","SSE.Views.ChartSettingsDlg.textTrillions":"万亿","SSE.Views.ChartSettingsDlg.textTwoCell":"大小和位置随单元格而变","SSE.Views.ChartSettingsDlg.textType":"类型","SSE.Views.ChartSettingsDlg.textTypeData":"类型和数据","SSE.Views.ChartSettingsDlg.textUnits":"显示单位","SSE.Views.ChartSettingsDlg.textValue":"值","SSE.Views.ChartSettingsDlg.textPercent":"百分比","SSE.Views.ChartSettingsDlg.textVertAxis":"垂直轴","SSE.Views.ChartSettingsDlg.textVertAxisSec":"次要纵坐标轴","SSE.Views.ChartSettingsDlg.textXAxisTitle":"X轴标题","SSE.Views.ChartSettingsDlg.textYAxisTitle":"Y轴标题","SSE.Views.ChartSettingsDlg.textZero":"零","SSE.Views.ChartSettingsDlg.txtEmpty":"必填项","SSE.Views.ChartTypeDialog.errorComboSeries":"若要创建组合图，请选择至少两个数据系列。","SSE.Views.ChartTypeDialog.errorSecondaryAxis":"所选图表类型需要现有图表使用的次坐标轴。请选择其他图表类型。","SSE.Views.ChartTypeDialog.textSecondary":"次坐标轴","SSE.Views.ChartTypeDialog.textSeries":"系列","SSE.Views.ChartTypeDialog.textStyle":"样式","SSE.Views.ChartTypeDialog.textTitle":"图表类型","SSE.Views.ChartTypeDialog.textType":"类型","SSE.Views.ChartWizardDialog.errorComboSeries":"若要创建组合图表，请至少选择两个系列的数据。","SSE.Views.ChartWizardDialog.errorMaxPoints":"每个图表的最大串联点数为4096。","SSE.Views.ChartWizardDialog.errorMaxRows":"每个图表的最大数据序列数为255。","SSE.Views.ChartWizardDialog.errorSecondaryAxis":"所选图表类型需要现有图表正在使用的辅助轴。选择其他图表类型。","SSE.Views.ChartWizardDialog.errorStockChart":"行顺序不正确。要创建股票图表，请按以下顺序将数据放在工作表上：开盘价、最高价格、最低价格、收盘价。","SSE.Views.ChartWizardDialog.textRecommended":"推荐的图表","SSE.Views.ChartWizardDialog.textSecondary":"副轴","SSE.Views.ChartWizardDialog.textSeries":"系列","SSE.Views.ChartWizardDialog.textTitle":"插入图表","SSE.Views.ChartWizardDialog.textTitleChange":"更改图表类型","SSE.Views.ChartWizardDialog.textType":"类型","SSE.Views.ChartWizardDialog.txtSeriesDesc":"选择数据系列的图表类型和轴","SSE.Views.CreatePivotDialog.textDataRange":"源数据区域","SSE.Views.CreatePivotDialog.textDestination":"选择安放表格的位置","SSE.Views.CreatePivotDialog.textExist":"已有的工作表","SSE.Views.CreatePivotDialog.textInvalidRange":"无效的单元格范围","SSE.Views.CreatePivotDialog.textNew":"新建工作表","SSE.Views.CreatePivotDialog.textSelectData":"选择数据","SSE.Views.CreatePivotDialog.textTitle":"创建数据透视表","SSE.Views.CreatePivotDialog.txtEmpty":"必填项","SSE.Views.CreateSparklineDialog.textDataRange":"源数据区域","SSE.Views.CreateSparklineDialog.textDestination":"选择放置迷你图表的位置。","SSE.Views.CreateSparklineDialog.textInvalidRange":"无效的单元格范围","SSE.Views.CreateSparklineDialog.textSelectData":"选择数据","SSE.Views.CreateSparklineDialog.textTitle":"创建迷你图","SSE.Views.CreateSparklineDialog.txtEmpty":"此字段是必需的","SSE.Views.DataTab.capBtnGroup":"组合","SSE.Views.DataTab.capBtnTextCustomSort":"自定义排序","SSE.Views.DataTab.capBtnTextDataValidation":"数据验证","SSE.Views.DataTab.capBtnTextRemDuplicates":"删除重复值","SSE.Views.DataTab.capBtnTextToCol":"文本分列向导","SSE.Views.DataTab.capBtnUngroup":"取消组合","SSE.Views.DataTab.capDataExternalLinks":"外部链接","SSE.Views.DataTab.capDataFromText":"获取数据","SSE.Views.DataTab.mniFromFile":"来自本地TXT/CSV","SSE.Views.DataTab.mniFromUrl":"从网络地址导入TEXT/CSV","SSE.Views.DataTab.mniFromXMLFile":"来自本地的 XML 文件","SSE.Views.DataTab.textBelow":"详细信息下的摘要行","SSE.Views.DataTab.textClear":"清除分级显示","SSE.Views.DataTab.textColumns":"取消列组合","SSE.Views.DataTab.textGroupColumns":"组合列","SSE.Views.DataTab.textGroupRows":"组合行","SSE.Views.DataTab.textRightOf":"详细信息右侧的摘要列","SSE.Views.DataTab.textRows":"取消行组合","SSE.Views.DataTab.tipCustomSort":"自定义排序","SSE.Views.DataTab.tipDataFromText":"从文本/CSV文件中获取数据","SSE.Views.DataTab.tipDataValidation":"数据验证","SSE.Views.DataTab.tipExternalLinks":"查看本电子表格链接的其他文件","SSE.Views.DataTab.tipGroup":"单元组范围","SSE.Views.DataTab.tipRemDuplicates":"删除工作表中的重复行","SSE.Views.DataTab.tipToColumns":"将单元格文本分隔成列","SSE.Views.DataTab.tipUngroup":"取消单元格范围分组","SSE.Views.DataValidationDialog.errorFormula":"该值当前包含错误。是否继续?","SSE.Views.DataValidationDialog.errorInvalid":'输入的 "{0}" 值无效。',"SSE.Views.DataValidationDialog.errorInvalidDate":"您为字段 “{0}” 输入的日期无效。","SSE.Views.DataValidationDialog.errorInvalidList":"列表源必须是定界列表，或者是对单行或单列的引用。","SSE.Views.DataValidationDialog.errorInvalidTime":'输入到 "{0}" 的时间无效。',"SSE.Views.DataValidationDialog.errorMinGreaterMax":"“{1}”字段必须大于或等于“{0}”字段。","SSE.Views.DataValidationDialog.errorMustEnterBothValues":"你必须输入在字段“{0}”和字段“{1}”都输入输入一个值。","SSE.Views.DataValidationDialog.errorMustEnterValue":'您必须在"{0}"字段中输入值。',"SSE.Views.DataValidationDialog.errorNamedRange":"找不到指定的命名区域。","SSE.Views.DataValidationDialog.errorNegativeTextLength":'负值不能用在条件"{0}"中。',"SSE.Views.DataValidationDialog.errorNotNumeric":"字段“{0}”必须为一个数字，数字表达式，或者引用一个含数字的单元格。","SSE.Views.DataValidationDialog.strError":"出错警告","SSE.Views.DataValidationDialog.strInput":"输入信息","SSE.Views.DataValidationDialog.strSettings":"设置","SSE.Views.DataValidationDialog.textAlert":"提示","SSE.Views.DataValidationDialog.textAllow":"允许","SSE.Views.DataValidationDialog.textApply":"将这些变化应用于所有其他具有相同设置的单元格","SSE.Views.DataValidationDialog.textCellSelected":"选定单元格时显示下列输入信息：","SSE.Views.DataValidationDialog.textCompare":"相比于","SSE.Views.DataValidationDialog.textData":"数据","SSE.Views.DataValidationDialog.textEndDate":"结束日期","SSE.Views.DataValidationDialog.textEndTime":"结束时间","SSE.Views.DataValidationDialog.textError":"错误信息","SSE.Views.DataValidationDialog.textFormula":"公式","SSE.Views.DataValidationDialog.textIgnore":"忽略空值","SSE.Views.DataValidationDialog.textInput":"输入信息","SSE.Views.DataValidationDialog.textMax":"最大值","SSE.Views.DataValidationDialog.textMessage":"信息","SSE.Views.DataValidationDialog.textMin":"最小值","SSE.Views.DataValidationDialog.textSelectData":"选择数据","SSE.Views.DataValidationDialog.textShowDropDown":"在单元格中显示下拉列表","SSE.Views.DataValidationDialog.textShowError":"输入无效数据时显示出错警告","SSE.Views.DataValidationDialog.textShowInput":"选定单元格时显示输入信息","SSE.Views.DataValidationDialog.textSource":"来源","SSE.Views.DataValidationDialog.textStartDate":"开始日期","SSE.Views.DataValidationDialog.textStartTime":"开始时间","SSE.Views.DataValidationDialog.textStop":"停止","SSE.Views.DataValidationDialog.textStyle":"样式","SSE.Views.DataValidationDialog.textTitle":"标题","SSE.Views.DataValidationDialog.textUserEnters":"用户输入无效数据时显示下列出错警告：","SSE.Views.DataValidationDialog.txtAny":"任何值","SSE.Views.DataValidationDialog.txtBetween":"介于","SSE.Views.DataValidationDialog.txtDate":"日期","SSE.Views.DataValidationDialog.txtDecimal":"小数","SSE.Views.DataValidationDialog.txtElTime":"运行时间","SSE.Views.DataValidationDialog.txtEndDate":"结束日期","SSE.Views.DataValidationDialog.txtEndTime":"结束时间","SSE.Views.DataValidationDialog.txtEqual":"等于","SSE.Views.DataValidationDialog.txtGreaterThan":"大于","SSE.Views.DataValidationDialog.txtGreaterThanOrEqual":"大于或等于","SSE.Views.DataValidationDialog.txtLength":"长度","SSE.Views.DataValidationDialog.txtLessThan":"小于","SSE.Views.DataValidationDialog.txtLessThanOrEqual":"小于或等于","SSE.Views.DataValidationDialog.txtList":"列表","SSE.Views.DataValidationDialog.txtNotBetween":"不介于","SSE.Views.DataValidationDialog.txtNotEqual":"不等于","SSE.Views.DataValidationDialog.txtOther":"其他","SSE.Views.DataValidationDialog.txtStartDate":"开始日期","SSE.Views.DataValidationDialog.txtStartTime":"开始时间","SSE.Views.DataValidationDialog.txtTextLength":"文本长度","SSE.Views.DataValidationDialog.txtTime":"时间","SSE.Views.DataValidationDialog.txtWhole":"整数","SSE.Views.DigitalFilterDialog.capAnd":"与","SSE.Views.DigitalFilterDialog.capCondition1":"等于","SSE.Views.DigitalFilterDialog.capCondition10":"不结束于","SSE.Views.DigitalFilterDialog.capCondition11":"包含","SSE.Views.DigitalFilterDialog.capCondition12":"不含","SSE.Views.DigitalFilterDialog.capCondition2":"不等于","SSE.Views.DigitalFilterDialog.capCondition3":"大于","SSE.Views.DigitalFilterDialog.capCondition30":"在之后","SSE.Views.DigitalFilterDialog.capCondition4":"大于或等于","SSE.Views.DigitalFilterDialog.capCondition40":"在之后或等于","SSE.Views.DigitalFilterDialog.capCondition5":"小于","SSE.Views.DigitalFilterDialog.capCondition50":"在之前","SSE.Views.DigitalFilterDialog.capCondition6":"小于或等于","SSE.Views.DigitalFilterDialog.capCondition60":"在之前或等于","SSE.Views.DigitalFilterDialog.capCondition7":"以...开始","SSE.Views.DigitalFilterDialog.capCondition8":"不起始于","SSE.Views.DigitalFilterDialog.capCondition9":"结束","SSE.Views.DigitalFilterDialog.capOr":"或","SSE.Views.DigitalFilterDialog.textNoFilter":" ","SSE.Views.DigitalFilterDialog.textShowRows":"显示行：","SSE.Views.DigitalFilterDialog.textUse1":"使用 ？呈现任何单个字符","SSE.Views.DigitalFilterDialog.textUse2":"使用*来呈现任何一系列的角色","SSE.Views.DigitalFilterDialog.txtSelectDate":"选择日期","SSE.Views.DigitalFilterDialog.txtTitle":"自定义筛选","SSE.Views.DocumentHolder.advancedEquationText":"公式设置","SSE.Views.DocumentHolder.advancedImgText":"图片高级设置","SSE.Views.DocumentHolder.advancedShapeText":"形状高级设置","SSE.Views.DocumentHolder.advancedSlicerText":"切片器高级设置","SSE.Views.DocumentHolder.allLinearText":"全部 - 线性","SSE.Views.DocumentHolder.allProfText":"全部 - 专业","SSE.Views.DocumentHolder.bottomCellText":"底端对齐","SSE.Views.DocumentHolder.bulletsText":"符号和编号","SSE.Views.DocumentHolder.centerCellText":"垂直居中","SSE.Views.DocumentHolder.chartDataText":"选择图标数据","SSE.Views.DocumentHolder.chartText":"图表高级设置","SSE.Views.DocumentHolder.chartTypeText":"更改图表类型","SSE.Views.DocumentHolder.currLinearText":"当前 - 线性","SSE.Views.DocumentHolder.currProfText":"当前 - 专业","SSE.Views.DocumentHolder.deleteColumnText":"列","SSE.Views.DocumentHolder.deleteRowText":"行","SSE.Views.DocumentHolder.deleteTableText":"表格","SSE.Views.DocumentHolder.direct270Text":"向上旋转文字","SSE.Views.DocumentHolder.direct90Text":"向下旋转文字","SSE.Views.DocumentHolder.directHText":"水平","SSE.Views.DocumentHolder.directionText":"文字方向","SSE.Views.DocumentHolder.editChartText":"编辑数据","SSE.Views.DocumentHolder.editHyperlinkText":"编辑超链接","SSE.Views.DocumentHolder.hideEqToolbar":"隐藏公式工具栏","SSE.Views.DocumentHolder.insertColumnLeftText":"在左侧插入列","SSE.Views.DocumentHolder.insertColumnRightText":"在右侧插入列","SSE.Views.DocumentHolder.insertRowAboveText":"在上方插入行","SSE.Views.DocumentHolder.insertRowBelowText":"在下方插入行","SSE.Views.DocumentHolder.latexText":"LaTeX","SSE.Views.DocumentHolder.originalSizeText":"实际大小","SSE.Views.DocumentHolder.removeHyperlinkText":"删除超链接","SSE.Views.DocumentHolder.selectColumnText":"列","SSE.Views.DocumentHolder.selectDataText":"列数据","SSE.Views.DocumentHolder.selectRowText":"行","SSE.Views.DocumentHolder.selectTableText":"表格","SSE.Views.DocumentHolder.showEqToolbar":"显示公式工具栏","SSE.Views.DocumentHolder.strDelete":"删除签名","SSE.Views.DocumentHolder.strDetails":"签名详情","SSE.Views.DocumentHolder.strSetup":"签名设置","SSE.Views.DocumentHolder.strSign":"符号","SSE.Views.DocumentHolder.textAlign":"对齐方式","SSE.Views.DocumentHolder.textArrange":"排列","SSE.Views.DocumentHolder.textArrangeBack":"置于底层","SSE.Views.DocumentHolder.textArrangeBackward":"下移一层","SSE.Views.DocumentHolder.textArrangeForward":"上移一层","SSE.Views.DocumentHolder.textArrangeFront":"置于顶层","SSE.Views.DocumentHolder.textAverage":"平均值","SSE.Views.DocumentHolder.textBullets":"项目符号","SSE.Views.DocumentHolder.textCount":"计数","SSE.Views.DocumentHolder.textCrop":"裁剪","SSE.Views.DocumentHolder.textCropFill":"填充","SSE.Views.DocumentHolder.textCropFit":"最佳","SSE.Views.DocumentHolder.textEditPoints":"编辑顶点","SSE.Views.DocumentHolder.textEntriesList":"从下拉列表中选择","SSE.Views.DocumentHolder.textFlipH":"水平翻转","SSE.Views.DocumentHolder.textFlipV":"垂直翻转","SSE.Views.DocumentHolder.textFreezePanes":"冻结窗格","SSE.Views.DocumentHolder.textFromFile":"从文件导入","SSE.Views.DocumentHolder.textFromStorage":"来自存储设备","SSE.Views.DocumentHolder.textFromUrl":"从URL","SSE.Views.DocumentHolder.textListSettings":"列表设置","SSE.Views.DocumentHolder.textMacro":"指定宏","SSE.Views.DocumentHolder.textMax":"最大值","SSE.Views.DocumentHolder.textMin":"最小值","SSE.Views.DocumentHolder.textMore":"其他函数","SSE.Views.DocumentHolder.textMoreFormats":"更多格式","SSE.Views.DocumentHolder.textNone":"无","SSE.Views.DocumentHolder.textNumbering":"编号","SSE.Views.DocumentHolder.textReplace":"更改图片","SSE.Views.DocumentHolder.textRotate":"旋转","SSE.Views.DocumentHolder.textRotate270":"逆时针旋转90°","SSE.Views.DocumentHolder.textRotate90":"顺时针旋转90°","SSE.Views.DocumentHolder.textSaveAsPicture":"另存为图片","SSE.Views.DocumentHolder.textShapeAlignBottom":"底端对齐","SSE.Views.DocumentHolder.textShapeAlignCenter":"居中","SSE.Views.DocumentHolder.textShapeAlignLeft":"左对齐","SSE.Views.DocumentHolder.textShapeAlignMiddle":"垂直居中","SSE.Views.DocumentHolder.textShapeAlignRight":"右对齐","SSE.Views.DocumentHolder.textShapeAlignTop":"顶端对齐","SSE.Views.DocumentHolder.textStdDev":"标准差","SSE.Views.DocumentHolder.textSum":"合计","SSE.Views.DocumentHolder.textUndo":"复原","SSE.Views.DocumentHolder.textUnFreezePanes":"取消冻结窗格","SSE.Views.DocumentHolder.textVar":"方差","SSE.Views.DocumentHolder.tipMarkersArrow":"箭头项目符号","SSE.Views.DocumentHolder.tipMarkersCheckmark":"选中标记项目符号","SSE.Views.DocumentHolder.tipMarkersDash":"划线项目符号","SSE.Views.DocumentHolder.tipMarkersFRhombus":"实心菱形项目符号","SSE.Views.DocumentHolder.tipMarkersFRound":"实心圆形项目符号","SSE.Views.DocumentHolder.tipMarkersFSquare":"实心方形项目符号","SSE.Views.DocumentHolder.tipMarkersHRound":"空心圆形项目符号","SSE.Views.DocumentHolder.tipMarkersStar":"星形项目符号","SSE.Views.DocumentHolder.topCellText":"顶端对齐","SSE.Views.DocumentHolder.txtAccounting":"会计专用","SSE.Views.DocumentHolder.txtAddComment":"添加批注","SSE.Views.DocumentHolder.txtAddNamedRange":"定义名称","SSE.Views.DocumentHolder.txtArrange":"排列","SSE.Views.DocumentHolder.txtAscending":"升序","SSE.Views.DocumentHolder.txtAutoColumnWidth":"自动调整列宽","SSE.Views.DocumentHolder.txtAutoRowHeight":"自动调整行距","SSE.Views.DocumentHolder.txtAverage":"平均值","SSE.Views.DocumentHolder.txtClear":"清除","SSE.Views.DocumentHolder.txtClearAll":"全部清除","SSE.Views.DocumentHolder.txtClearComments":"清除批注","SSE.Views.DocumentHolder.txtClearFormat":"清除格式","SSE.Views.DocumentHolder.txtClearHyper":"清除超链接","SSE.Views.DocumentHolder.txtClearPivotField":"清除以下来源中的筛选器：","SSE.Views.DocumentHolder.txtClearSparklineGroups":"清除所选的Sparkline组","SSE.Views.DocumentHolder.txtClearSparklines":"清除所选的迷你曲","SSE.Views.DocumentHolder.txtClearText":"清除内容","SSE.Views.DocumentHolder.txtColumn":"整列","SSE.Views.DocumentHolder.txtColumnWidth":"设置列宽","SSE.Views.DocumentHolder.txtCondFormat":"条件格式","SSE.Views.DocumentHolder.txtCopy":"复制","SSE.Views.DocumentHolder.txtCount":"计数","SSE.Views.DocumentHolder.txtCurrency":"货币","SSE.Views.DocumentHolder.txtCustomColumnWidth":"自定义列宽","SSE.Views.DocumentHolder.txtCustomRowHeight":"自定义行高度","SSE.Views.DocumentHolder.txtCustomSort":"自定义排序","SSE.Views.DocumentHolder.txtCut":"剪切","SSE.Views.DocumentHolder.txtDateLong":"完整日期","SSE.Views.DocumentHolder.txtDateShort":"简写日期","SSE.Views.DocumentHolder.txtDelete":"删除","SSE.Views.DocumentHolder.txtDelField":"删除","SSE.Views.DocumentHolder.txtDescending":"降序","SSE.Views.DocumentHolder.txtDifference":"差异","SSE.Views.DocumentHolder.txtDistribHor":"水平分布","SSE.Views.DocumentHolder.txtDistribVert":"垂直分布","SSE.Views.DocumentHolder.txtEditComment":"编辑批注","SSE.Views.DocumentHolder.txtFieldSettings":"字段设置","SSE.Views.DocumentHolder.txtFilter":"筛选","SSE.Views.DocumentHolder.txtFilterCellColor":"按所选单元格的颜色筛选","SSE.Views.DocumentHolder.txtFilterFontColor":"按所选单元格的字体颜色筛选","SSE.Views.DocumentHolder.txtFilterValue":"按所选单元格的值筛选","SSE.Views.DocumentHolder.txtFormula":"插入函数","SSE.Views.DocumentHolder.txtFraction":"分数","SSE.Views.DocumentHolder.txtGeneral":"常规","SSE.Views.DocumentHolder.txtGetLink":"获取该范围的链接","SSE.Views.DocumentHolder.txtGrandTotal":"总计","SSE.Views.DocumentHolder.txtGroup":"组合","SSE.Views.DocumentHolder.txtHide":"隐藏","SSE.Views.DocumentHolder.txtIndex":"索引","SSE.Views.DocumentHolder.txtInsert":"插入","SSE.Views.DocumentHolder.txtInsHyperlink":"超链接","SSE.Views.DocumentHolder.txtInsImage":"插入图片","SSE.Views.DocumentHolder.txtInsImageUrl":"插入在线图片","SSE.Views.DocumentHolder.txtLabelFilter":"标签筛选","SSE.Views.DocumentHolder.txtMax":"最大","SSE.Views.DocumentHolder.txtMin":"最小","SSE.Views.DocumentHolder.txtMoreOptions":"更多选项","SSE.Views.DocumentHolder.txtNormal":"无计算","SSE.Views.DocumentHolder.txtNumber":"数值","SSE.Views.DocumentHolder.txtNumFormat":"设置单元格格式","SSE.Views.DocumentHolder.txtPaste":"粘贴","SSE.Views.DocumentHolder.txtPercent":"百分比","SSE.Views.DocumentHolder.txtPercentage":"百分比","SSE.Views.DocumentHolder.txtPercentDiff":"差异百分比","SSE.Views.DocumentHolder.txtPercentOfCol":"列汇总百分比","SSE.Views.DocumentHolder.txtPercentOfGrand":"总计百分比","SSE.Views.DocumentHolder.txtPercentOfParent":"父级汇总的百分比","SSE.Views.DocumentHolder.txtPercentOfParentCol":"父列汇总百分比","SSE.Views.DocumentHolder.txtPercentOfParentRow":"父行汇总百分比","SSE.Views.DocumentHolder.txtPercentOfRunTotal":"按某一字段汇总的百分比","SSE.Views.DocumentHolder.txtPercentOfTotal":"行汇总百分比","SSE.Views.DocumentHolder.txtPivotSettings":"数据透视表设置","SSE.Views.DocumentHolder.txtProduct":"乘积","SSE.Views.DocumentHolder.txtRankAscending":"升序排列","SSE.Views.DocumentHolder.txtRankDescending":"降序排列","SSE.Views.DocumentHolder.txtReapply":"重新应用","SSE.Views.DocumentHolder.txtRefresh":"刷新","SSE.Views.DocumentHolder.txtRow":"整行","SSE.Views.DocumentHolder.txtRowHeight":"设置行高","SSE.Views.DocumentHolder.txtRunTotal":"按某一字段汇总","SSE.Views.DocumentHolder.txtScientific":"科学记数","SSE.Views.DocumentHolder.txtSelect":"选择","SSE.Views.DocumentHolder.txtShiftDown":"活动单元格下移","SSE.Views.DocumentHolder.txtShiftLeft":"右侧单元格左移","SSE.Views.DocumentHolder.txtShiftRight":"活动单元格右移","SSE.Views.DocumentHolder.txtShiftUp":"下方单元格上移","SSE.Views.DocumentHolder.txtShow":"显示","SSE.Views.DocumentHolder.txtShowAs":"值显示方式","SSE.Views.DocumentHolder.txtShowComment":"显示批注","SSE.Views.DocumentHolder.txtShowDetails":"显示详细资料","SSE.Views.DocumentHolder.txtSort":"排序","SSE.Views.DocumentHolder.txtSortCellColor":"将所选单元格颜色放在最前面","SSE.Views.DocumentHolder.txtSortFontColor":"将所选字体颜色放在最前面","SSE.Views.DocumentHolder.txtSortOption":"更多排序选项","SSE.Views.DocumentHolder.txtSparklines":"迷你","SSE.Views.DocumentHolder.txtSubtotalField":"小计","SSE.Views.DocumentHolder.txtSum":"求和","SSE.Views.DocumentHolder.txtSummarize":"值汇总方式：","SSE.Views.DocumentHolder.txtText":"文本","SSE.Views.DocumentHolder.txtTextAdvanced":"段落高级设置","SSE.Views.DocumentHolder.txtTime":"时间","SSE.Views.DocumentHolder.txtTop10":"前十位","SSE.Views.DocumentHolder.txtUngroup":"取消组合","SSE.Views.DocumentHolder.txtValueFieldSettings":"值字段设置","SSE.Views.DocumentHolder.txtValueFilter":"值筛选","SSE.Views.DocumentHolder.txtWidth":"宽度","SSE.Views.DocumentHolder.unicodeText":"Unicode","SSE.Views.DocumentHolder.vertAlignText":"垂直对齐","SSE.Views.ExternalLinksDlg.closeButtonText":"关闭","SSE.Views.ExternalLinksDlg.textChange":"更改来源","SSE.Views.ExternalLinksDlg.textDelete":"断开链接","SSE.Views.ExternalLinksDlg.textDeleteAll":"断开所有链接","SSE.Views.ExternalLinksDlg.textOk":"OK","SSE.Views.ExternalLinksDlg.textOpen":"开源","SSE.Views.ExternalLinksDlg.textSource":"来源","SSE.Views.ExternalLinksDlg.textStatus":"状态","SSE.Views.ExternalLinksDlg.textUnknown":"未知","SSE.Views.ExternalLinksDlg.textUpdate":"更新值","SSE.Views.ExternalLinksDlg.textUpdateAll":"全部更新","SSE.Views.ExternalLinksDlg.textUpdating":"更新中。。。","SSE.Views.ExternalLinksDlg.txtTitle":"外部链接","SSE.Views.FieldSettingsDialog.strLayout":"布局","SSE.Views.FieldSettingsDialog.strSubtotals":"分类汇总","SSE.Views.FieldSettingsDialog.textNumFormat":"数字格式","SSE.Views.FieldSettingsDialog.textReport":"报告","SSE.Views.FieldSettingsDialog.textTitle":"域设置","SSE.Views.FieldSettingsDialog.txtAverage":"平均值","SSE.Views.FieldSettingsDialog.txtBlank":"在每一项后面插入一个空行","SSE.Views.FieldSettingsDialog.txtBottom":"在群组底部显示","SSE.Views.FieldSettingsDialog.txtCompact":"紧致","SSE.Views.FieldSettingsDialog.txtCount":"计数","SSE.Views.FieldSettingsDialog.txtCountNums":"计数","SSE.Views.FieldSettingsDialog.txtCustomName":"自定义名称","SSE.Views.FieldSettingsDialog.txtEmpty":"显示无数据的项目","SSE.Views.FieldSettingsDialog.txtMax":"最大值","SSE.Views.FieldSettingsDialog.txtMin":"最小值","SSE.Views.FieldSettingsDialog.txtOutline":"大纲","SSE.Views.FieldSettingsDialog.txtProduct":"乘积","SSE.Views.FieldSettingsDialog.txtRepeat":"在每行重复标记项目","SSE.Views.FieldSettingsDialog.txtShowSubtotals":"显示分类汇总","SSE.Views.FieldSettingsDialog.txtSourceName":"源名称：","SSE.Views.FieldSettingsDialog.txtStdDev":"标准差","SSE.Views.FieldSettingsDialog.txtStdDevp":"总体标准偏差","SSE.Views.FieldSettingsDialog.txtSum":"合计","SSE.Views.FieldSettingsDialog.txtSummarize":"用于小计的函数","SSE.Views.FieldSettingsDialog.txtTabular":"表格","SSE.Views.FieldSettingsDialog.txtTop":"在群组顶部显示","SSE.Views.FieldSettingsDialog.txtVar":"方差","SSE.Views.FieldSettingsDialog.txtVarp":"总体方差","SSE.Views.FileMenu.btnBackCaption":"打开文件所在位置","SSE.Views.FileMenu.btnCloseMenuCaption":"关闭菜单","SSE.Views.FileMenu.btnCreateNewCaption":"新建","SSE.Views.FileMenu.btnDownloadCaption":"另存为","SSE.Views.FileMenu.btnExitCaption":"关闭","SSE.Views.FileMenu.btnExportToPDFCaption":"导出为PDF","SSE.Views.FileMenu.btnFileOpenCaption":"打开","SSE.Views.FileMenu.btnHelpCaption":"帮助","SSE.Views.FileMenu.btnHistoryCaption":"版本历史","SSE.Views.FileMenu.btnInfoCaption":"表格信息","SSE.Views.FileMenu.btnPrintCaption":"打印","SSE.Views.FileMenu.btnProtectCaption":"保护","SSE.Views.FileMenu.btnRecentFilesCaption":"最近打开","SSE.Views.FileMenu.btnRenameCaption":"改名","SSE.Views.FileMenu.btnReturnCaption":"回到电子表格","SSE.Views.FileMenu.btnRightsCaption":"访问权","SSE.Views.FileMenu.btnSaveAsCaption":"另存为","SSE.Views.FileMenu.btnSaveCaption":"保存","SSE.Views.FileMenu.btnSaveCopyAsCaption":"将副本另存为","SSE.Views.FileMenu.btnSettingsCaption":"高级设置","SSE.Views.FileMenu.btnSetDefaultCaption":"设为默认应用","SSE.Views.FileMenu.btnFeedbackCaption":"反馈","SSE.Views.FileMenu.btnUnInstallCaption":"卸载","SSE.Views.FileMenu.btnEnableOnlineCaption":"开启在线表格预览/编辑","SSE.Views.FileMenu.btnDisableOnlineCaption":"关闭在线表格预览/编辑","SSE.Views.FileMenu.btnDownloadOnlineCaption":"下载文档","SSE.Views.FileMenu.btnToEditCaption":"编辑电子表格","SSE.Views.FileMenuPanels.CreateNew.txtBlank":"空白表格","SSE.Views.FileMenuPanels.CreateNew.txtCreateNew":"新建","SSE.Views.FileMenuPanels.DocumentInfo.okButtonText":"应用","SSE.Views.FileMenuPanels.DocumentInfo.txtAddAuthor":"添加作者","SSE.Views.FileMenuPanels.DocumentInfo.txtAddText":"添加文本","SSE.Views.FileMenuPanels.DocumentInfo.txtAppName":"应用","SSE.Views.FileMenuPanels.DocumentInfo.txtAuthor":"作者","SSE.Views.FileMenuPanels.DocumentInfo.txtBtnAccessRights":"更改访问权限","SSE.Views.FileMenuPanels.DocumentInfo.txtComment":"批注","SSE.Views.FileMenuPanels.DocumentInfo.txtCreated":"已创建","SSE.Views.FileMenuPanels.DocumentInfo.txtModifyBy":"上次修改者","SSE.Views.FileMenuPanels.DocumentInfo.txtModifyDate":"上次修改时间","SSE.Views.FileMenuPanels.DocumentInfo.txtOwner":"创建者","SSE.Views.FileMenuPanels.DocumentInfo.txtPlacement":"位置","SSE.Views.FileMenuPanels.DocumentInfo.txtRights":"有权利的人","SSE.Views.FileMenuPanels.DocumentInfo.txtSpreadsheetInfo":"表格信息","SSE.Views.FileMenuPanels.DocumentInfo.txtSubject":"主题","SSE.Views.FileMenuPanels.DocumentInfo.txtTags":"标签","SSE.Views.FileMenuPanels.DocumentInfo.txtTitle":"标题","SSE.Views.FileMenuPanels.DocumentInfo.txtUploaded":"上载","SSE.Views.FileMenuPanels.DocumentRights.txtAccessRights":"访问权限","SSE.Views.FileMenuPanels.DocumentRights.txtBtnAccessRights":"更改访问权限","SSE.Views.FileMenuPanels.DocumentRights.txtRights":"有权利的人","SSE.Views.FileMenuPanels.MainSettingsGeneral.okButtonText":"应用","SSE.Views.FileMenuPanels.MainSettingsGeneral.strCoAuthMode":"共同编辑模式","SSE.Views.FileMenuPanels.MainSettingsGeneral.strDateFormat1904":"使用1904年日期系统","SSE.Views.FileMenuPanels.MainSettingsGeneral.strDecimalSeparator":"小数分隔符","SSE.Views.FileMenuPanels.MainSettingsGeneral.strDictionaryLanguage":"词典语言","SSE.Views.FileMenuPanels.MainSettingsGeneral.strFast":"自动","SSE.Views.FileMenuPanels.MainSettingsGeneral.strFontRender":"字体微调方式","SSE.Views.FileMenuPanels.MainSettingsGeneral.strFuncLocale":"公式语言","SSE.Views.FileMenuPanels.MainSettingsGeneral.strFuncLocaleEx":"例：SUM; MIN; MAX; COUNT","SSE.Views.FileMenuPanels.MainSettingsGeneral.strIgnoreWordsInUPPERCASE":"忽略大写单词","SSE.Views.FileMenuPanels.MainSettingsGeneral.strIgnoreWordsWithNumbers":"忽略带数字的单词","SSE.Views.FileMenuPanels.MainSettingsGeneral.strMacrosSettings":"宏设置","SSE.Views.FileMenuPanels.MainSettingsGeneral.strPasteButton":"粘贴内容时显示“粘贴选项”按钮","SSE.Views.FileMenuPanels.MainSettingsGeneral.strReferenceStyle":"R1C1参考样式","SSE.Views.FileMenuPanels.MainSettingsGeneral.strRegSettings":"区域设置","SSE.Views.FileMenuPanels.MainSettingsGeneral.strRegSettingsEx":"例： ","SSE.Views.FileMenuPanels.MainSettingsGeneral.strShowComments":"在表格中显示注释","SSE.Views.FileMenuPanels.MainSettingsGeneral.strShowOthersChanges":"显示其他用户的更改","SSE.Views.FileMenuPanels.MainSettingsGeneral.strShowResolvedComments":"显示已解决的注释","SSE.Views.FileMenuPanels.MainSettingsGeneral.strStrict":"手动","SSE.Views.FileMenuPanels.MainSettingsGeneral.strTheme":"界面主题","SSE.Views.FileMenuPanels.MainSettingsGeneral.strThousandsSeparator":"千位分隔符","SSE.Views.FileMenuPanels.MainSettingsGeneral.strUnit":"测量单位","SSE.Views.FileMenuPanels.MainSettingsGeneral.strUseSeparatorsBasedOnRegionalSettings":"根据区域设置使用分隔符","SSE.Views.FileMenuPanels.MainSettingsGeneral.strZoom":"默认缩放比率","SSE.Views.FileMenuPanels.MainSettingsGeneral.text10Minutes":"每10分钟","SSE.Views.FileMenuPanels.MainSettingsGeneral.text30Minutes":"每30分钟","SSE.Views.FileMenuPanels.MainSettingsGeneral.text5Minutes":"每5分钟","SSE.Views.FileMenuPanels.MainSettingsGeneral.text60Minutes":"每隔一小时","SSE.Views.FileMenuPanels.MainSettingsGeneral.textAutoRecover":"自动恢复","SSE.Views.FileMenuPanels.MainSettingsGeneral.textAutoSave":"自动保存","SSE.Views.FileMenuPanels.MainSettingsGeneral.textDisabled":"已禁用","SSE.Views.FileMenuPanels.MainSettingsGeneral.textForceSave":"在保存中间版本","SSE.Views.FileMenuPanels.MainSettingsGeneral.textMinute":"每一分钟","SSE.Views.FileMenuPanels.MainSettingsGeneral.textRefStyle":"参考风格","SSE.Views.FileMenuPanels.MainSettingsGeneral.txtAdvancedSettings":"高级设置","SSE.Views.FileMenuPanels.MainSettingsGeneral.txtAutoCorrect":"自动修正选项...","SSE.Views.FileMenuPanels.MainSettingsGeneral.txtBe":"白俄罗斯文","SSE.Views.FileMenuPanels.MainSettingsGeneral.txtBg":"保加利亚文","SSE.Views.FileMenuPanels.MainSettingsGeneral.txtCa":"加泰罗尼亚语","SSE.Views.FileMenuPanels.MainSettingsGeneral.txtCacheMode":"默认缓存模式","SSE.Views.FileMenuPanels.MainSettingsGeneral.txtCalculating":"计算","SSE.Views.FileMenuPanels.MainSettingsGeneral.txtCm":"厘米","SSE.Views.FileMenuPanels.MainSettingsGeneral.txtCollaboration":"协作","SSE.Views.FileMenuPanels.MainSettingsGeneral.txtCs":"捷克语","SSE.Views.FileMenuPanels.MainSettingsGeneral.txtDa":"丹麦语","SSE.Views.FileMenuPanels.MainSettingsGeneral.txtDe":"德语","SSE.Views.FileMenuPanels.MainSettingsGeneral.txtEditingSaving":"编辑并保存","SSE.Views.FileMenuPanels.MainSettingsGeneral.txtEl":"希腊语","SSE.Views.FileMenuPanels.MainSettingsGeneral.txtEn":"英语","SSE.Views.FileMenuPanels.MainSettingsGeneral.txtEs":"西班牙语","SSE.Views.FileMenuPanels.MainSettingsGeneral.txtFastTip":"实时协同编辑。所有修改自动保存","SSE.Views.FileMenuPanels.MainSettingsGeneral.txtFi":"芬兰语","SSE.Views.FileMenuPanels.MainSettingsGeneral.txtFr":"法语","SSE.Views.FileMenuPanels.MainSettingsGeneral.txtHu":"匈牙利语","SSE.Views.FileMenuPanels.MainSettingsGeneral.txtHy":"亚美尼亚语","SSE.Views.FileMenuPanels.MainSettingsGeneral.txtId":"印度尼西亚语","SSE.Views.FileMenuPanels.MainSettingsGeneral.txtInch":"寸","SSE.Views.FileMenuPanels.MainSettingsGeneral.txtIt":"意大利语","SSE.Views.FileMenuPanels.MainSettingsGeneral.txtJa":"日语","SSE.Views.FileMenuPanels.MainSettingsGeneral.txtKo":"韩语","SSE.Views.FileMenuPanels.MainSettingsGeneral.txtLastUsed":"上次使用","SSE.Views.FileMenuPanels.MainSettingsGeneral.txtLo":"老挝语","SSE.Views.FileMenuPanels.MainSettingsGeneral.txtLv":"拉脱维亚语","SSE.Views.FileMenuPanels.MainSettingsGeneral.txtMac":"仿照 OS X","SSE.Views.FileMenuPanels.MainSettingsGeneral.txtNative":"本机系统原生","SSE.Views.FileMenuPanels.MainSettingsGeneral.txtNb":"挪威语","SSE.Views.FileMenuPanels.MainSettingsGeneral.txtNl":"荷兰语","SSE.Views.FileMenuPanels.MainSettingsGeneral.txtPl":"抛光","SSE.Views.FileMenuPanels.MainSettingsGeneral.txtProofing":"校对","SSE.Views.FileMenuPanels.MainSettingsGeneral.txtPt":"点","SSE.Views.FileMenuPanels.MainSettingsGeneral.txtPtbr":"葡萄牙语(巴西)","SSE.Views.FileMenuPanels.MainSettingsGeneral.txtPtlang":"葡萄牙语(葡萄牙)","SSE.Views.FileMenuPanels.MainSettingsGeneral.txtQuickPrint":"在编辑器标题中显示快速打印按钮","SSE.Views.FileMenuPanels.MainSettingsGeneral.txtQuickPrintTip":"文件将用最新选定的打印机或默认的打印机被打印出来。","SSE.Views.FileMenuPanels.MainSettingsGeneral.txtRegion":"地区","SSE.Views.FileMenuPanels.MainSettingsGeneral.txtRo":"罗马尼亚语","SSE.Views.FileMenuPanels.MainSettingsGeneral.txtRu":"俄语","SSE.Views.FileMenuPanels.MainSettingsGeneral.txtRunMacros":"启动所有项目","SSE.Views.FileMenuPanels.MainSettingsGeneral.txtRunMacrosDesc":"启动所有不带通知的宏","SSE.Views.FileMenuPanels.MainSettingsGeneral.txtSk":"斯洛伐克语","SSE.Views.FileMenuPanels.MainSettingsGeneral.txtSl":"斯洛文尼亚语","SSE.Views.FileMenuPanels.MainSettingsGeneral.txtStopMacros":"解除所有项目","SSE.Views.FileMenuPanels.MainSettingsGeneral.txtStopMacrosDesc":"解除所有不带通知的宏","SSE.Views.FileMenuPanels.MainSettingsGeneral.txtStrictTip":'使用“保存"按钮同步你和其他人的修改',"SSE.Views.FileMenuPanels.MainSettingsGeneral.txtSv":"瑞典语","SSE.Views.FileMenuPanels.MainSettingsGeneral.txtTr":"土耳其语","SSE.Views.FileMenuPanels.MainSettingsGeneral.txtUk":"乌克兰语","SSE.Views.FileMenuPanels.MainSettingsGeneral.txtUseAltKey":"使用键盘上的Alt键导航至用户界面","SSE.Views.FileMenuPanels.MainSettingsGeneral.txtUseOptionKey":"使用键盘上的Option键导航至用户界面","SSE.Views.FileMenuPanels.MainSettingsGeneral.txtVi":"越南语","SSE.Views.FileMenuPanels.MainSettingsGeneral.txtWarnMacros":"显示通知","SSE.Views.FileMenuPanels.MainSettingsGeneral.txtWarnMacrosDesc":"解除所有带通知的宏","SSE.Views.FileMenuPanels.MainSettingsGeneral.txtWin":"仿照 Windows","SSE.Views.FileMenuPanels.MainSettingsGeneral.txtWorkspace":"工作空间","SSE.Views.FileMenuPanels.MainSettingsGeneral.txtZh":"中文","SSE.Views.FileMenuPanels.ProtectDoc.notcriticalErrorTitle":"警告","SSE.Views.FileMenuPanels.ProtectDoc.strEncrypt":"使用密码","SSE.Views.FileMenuPanels.ProtectDoc.strProtect":"保护电子表格","SSE.Views.FileMenuPanels.ProtectDoc.strSignature":"使用签名","SSE.Views.FileMenuPanels.ProtectDoc.txtAddedSignature":"有效的签名已被添加到电子表格中。<br>电子表格受保护，无法编辑。","SSE.Views.FileMenuPanels.ProtectDoc.txtAddSignature":"<br>添加一个不可见的数字签名可确保电子表格的完整性","SSE.Views.FileMenuPanels.ProtectDoc.txtEdit":"编辑电子表格","SSE.Views.FileMenuPanels.ProtectDoc.txtEditWarning":"编辑将删除电子表格中的签名。<br>您确定要继续吗？","SSE.Views.FileMenuPanels.ProtectDoc.txtEncrypted":"此电子表格受密码保护","SSE.Views.FileMenuPanels.ProtectDoc.txtProtectSpreadsheet":"对该电子表格进行密码加密","SSE.Views.FileMenuPanels.ProtectDoc.txtRequestedSignatures":"此电子表格需要签名。","SSE.Views.FileMenuPanels.ProtectDoc.txtSigned":"有效签名已添加到电子表格中。该电子表格已限制编辑。","SSE.Views.FileMenuPanels.ProtectDoc.txtSignedInvalid":"电子表格中的某些数字签名无效或无法验证。该电子表格已限制编辑。","SSE.Views.FileMenuPanels.ProtectDoc.txtView":"查看签名","SSE.Views.FileMenuPanels.RecentFiles.txtOpenRecent":"打开最近文件","SSE.Views.FileMenuPanels.ViewSaveAs.textDownloadAs":"另存为","SSE.Views.FileMenuPanels.ViewSaveCopy.textSaveCopyAs":"将副本另存为","SSE.Views.FillSeriesDialog.textAuto":"自动填充","SSE.Views.FillSeriesDialog.textCols":"列","SSE.Views.FillSeriesDialog.textDate":"日期","SSE.Views.FillSeriesDialog.textDateUnit":"日期单位","SSE.Views.FillSeriesDialog.textDay":"日","SSE.Views.FillSeriesDialog.textGrowth":"等比序列","SSE.Views.FillSeriesDialog.textLinear":"等差序列","SSE.Views.FillSeriesDialog.textMonth":"月","SSE.Views.FillSeriesDialog.textRows":"行","SSE.Views.FillSeriesDialog.textSeries":"序列产生在","SSE.Views.FillSeriesDialog.textStep":"步长值","SSE.Views.FillSeriesDialog.textStop":"终止值","SSE.Views.FillSeriesDialog.textTitle":"序列","SSE.Views.FillSeriesDialog.textTrend":"预测趋势","SSE.Views.FillSeriesDialog.textType":"类型","SSE.Views.FillSeriesDialog.textWeek":"星期","SSE.Views.FillSeriesDialog.textYear":"年","SSE.Views.FillSeriesDialog.txtErrorNumber":"您的启动项无法使用。可能需要整数或十进制数。","SSE.Views.FormatRulesEditDlg.fillColor":"填充颜色","SSE.Views.FormatRulesEditDlg.notcriticalErrorTitle":"警告","SSE.Views.FormatRulesEditDlg.text2Scales":"双色刻度","SSE.Views.FormatRulesEditDlg.text3Scales":"三色刻度","SSE.Views.FormatRulesEditDlg.textAllBorders":"所有边框","SSE.Views.FormatRulesEditDlg.textAppearance":"条形图外观","SSE.Views.FormatRulesEditDlg.textApply":"应用于范围","SSE.Views.FormatRulesEditDlg.textAutomatic":"自动","SSE.Views.FormatRulesEditDlg.textAxis":"轴","SSE.Views.FormatRulesEditDlg.textBarDirection":"条形图方向","SSE.Views.FormatRulesEditDlg.textBold":"粗体","SSE.Views.FormatRulesEditDlg.textBorder":"边框","SSE.Views.FormatRulesEditDlg.textBordersColor":"边框颜色","SSE.Views.FormatRulesEditDlg.textBordersStyle":"边框样式","SSE.Views.FormatRulesEditDlg.textBottomBorders":"下边框","SSE.Views.FormatRulesEditDlg.textCannotAddCF":"无法添加条件格式","SSE.Views.FormatRulesEditDlg.textCellMidpoint":"单元格中点值","SSE.Views.FormatRulesEditDlg.textCenterBorders":"内部垂直边框","SSE.Views.FormatRulesEditDlg.textClear":"清除","SSE.Views.FormatRulesEditDlg.textColor":"文本颜色","SSE.Views.FormatRulesEditDlg.textContext":"上下文","SSE.Views.FormatRulesEditDlg.textCustom":"自定义","SSE.Views.FormatRulesEditDlg.textDiagDownBorder":"斜下框线","SSE.Views.FormatRulesEditDlg.textDiagUpBorder":"斜上框线","SSE.Views.FormatRulesEditDlg.textEmptyFormula":"请输入一个有效公式。","SSE.Views.FormatRulesEditDlg.textEmptyFormulaExt":"你输入的公式不能求值出数字，日期，时间或字符串。","SSE.Views.FormatRulesEditDlg.textEmptyText":"输入某一值。","SSE.Views.FormatRulesEditDlg.textEmptyValue":"输入的值不是有效的数字、日期、时间或字符串","SSE.Views.FormatRulesEditDlg.textErrorGreater":"{0} 值必须大于 {1} 值。","SSE.Views.FormatRulesEditDlg.textErrorTop10Between":"输入{0}到{1}之间的数字。","SSE.Views.FormatRulesEditDlg.textFill":"填充","SSE.Views.FormatRulesEditDlg.textFormat":"格式","SSE.Views.FormatRulesEditDlg.textFormula":"公式","SSE.Views.FormatRulesEditDlg.textGradient":"渐变","SSE.Views.FormatRulesEditDlg.textIconLabel":"时间 {0} {1}和","SSE.Views.FormatRulesEditDlg.textIconLabelFirst":"时间 {0} {1}","SSE.Views.FormatRulesEditDlg.textIconLabelLast":"当值是","SSE.Views.FormatRulesEditDlg.textIconsOverlap":"一个或多个图标数据区域重叠。<br> 请调整图标数据区域值，以使区域不再重叠。","SSE.Views.FormatRulesEditDlg.textIconStyle":"图标样式","SSE.Views.FormatRulesEditDlg.textInsideBorders":"内边框","SSE.Views.FormatRulesEditDlg.textInvalid":"无效的数据范围。","SSE.Views.FormatRulesEditDlg.textInvalidRange":"错误！单元格范围无效。","SSE.Views.FormatRulesEditDlg.textItalic":"斜体","SSE.Views.FormatRulesEditDlg.textItem":"项目","SSE.Views.FormatRulesEditDlg.textLeft2Right":"从左到右","SSE.Views.FormatRulesEditDlg.textLeftBorders":"左边框","SSE.Views.FormatRulesEditDlg.textLongBar":"最长数据条","SSE.Views.FormatRulesEditDlg.textMaximum":"最大值","SSE.Views.FormatRulesEditDlg.textMaxpoint":"最大值点","SSE.Views.FormatRulesEditDlg.textMiddleBorders":"内部水平边框","SSE.Views.FormatRulesEditDlg.textMidpoint":"中点","SSE.Views.FormatRulesEditDlg.textMinimum":"最小值","SSE.Views.FormatRulesEditDlg.textMinpoint":"最小值点","SSE.Views.FormatRulesEditDlg.textNegative":"负","SSE.Views.FormatRulesEditDlg.textNewColor":"更多颜色","SSE.Views.FormatRulesEditDlg.textNoBorders":"无边框","SSE.Views.FormatRulesEditDlg.textNone":"无","SSE.Views.FormatRulesEditDlg.textNotValidPercentage":"一个或多个指定值不是有效的百分比。","SSE.Views.FormatRulesEditDlg.textNotValidPercentageExt":"指定的 {0} 值为无效的百分数。","SSE.Views.FormatRulesEditDlg.textNotValidPercentile":"一个或多个指定值不是有效的百分位。","SSE.Views.FormatRulesEditDlg.textNotValidPercentileExt":"指定的 {0} 值为无效的百分点值。","SSE.Views.FormatRulesEditDlg.textOutBorders":"外边框","SSE.Views.FormatRulesEditDlg.textPercent":"百分比","SSE.Views.FormatRulesEditDlg.textPercentile":"百分点值","SSE.Views.FormatRulesEditDlg.textPosition":"位置","SSE.Views.FormatRulesEditDlg.textPositive":"正","SSE.Views.FormatRulesEditDlg.textPresets":"预置","SSE.Views.FormatRulesEditDlg.textPreview":"预览","SSE.Views.FormatRulesEditDlg.textRelativeRef":"在用于色阶、数据条和图标设置的格式条件中不能使用相对引用。","SSE.Views.FormatRulesEditDlg.textReverse":"倒转图标顺序","SSE.Views.FormatRulesEditDlg.textRight2Left":"从右到左","SSE.Views.FormatRulesEditDlg.textRightBorders":"右边框","SSE.Views.FormatRulesEditDlg.textRule":"规则","SSE.Views.FormatRulesEditDlg.textSameAs":"与正值相同","SSE.Views.FormatRulesEditDlg.textSelectData":"选择数据","SSE.Views.FormatRulesEditDlg.textShortBar":"最短数据条","SSE.Views.FormatRulesEditDlg.textShowBar":"仅显示数据条","SSE.Views.FormatRulesEditDlg.textShowIcon":"仅显示图标","SSE.Views.FormatRulesEditDlg.textSingleRef":"无法在条件格式公式中使用此引用类型。<br> 更改单个单元格的引用，或使用带工作表函数的引用，例如 =SUM(A1:B5)。","SSE.Views.FormatRulesEditDlg.textSolid":"实线","SSE.Views.FormatRulesEditDlg.textStrikeout":"删除线","SSE.Views.FormatRulesEditDlg.textSubscript":"下标","SSE.Views.FormatRulesEditDlg.textSuperscript":"上标","SSE.Views.FormatRulesEditDlg.textTopBorders":"上边框","SSE.Views.FormatRulesEditDlg.textUnderline":"下划线","SSE.Views.FormatRulesEditDlg.tipBorders":"边框","SSE.Views.FormatRulesEditDlg.tipNumFormat":"数字格式","SSE.Views.FormatRulesEditDlg.txtAccounting":"核算","SSE.Views.FormatRulesEditDlg.txtCurrency":"货币","SSE.Views.FormatRulesEditDlg.txtDate":"日期","SSE.Views.FormatRulesEditDlg.txtDateLong":"完整日期","SSE.Views.FormatRulesEditDlg.txtDateShort":"简写日期","SSE.Views.FormatRulesEditDlg.txtEmpty":"此字段是必需的","SSE.Views.FormatRulesEditDlg.txtFraction":"分数","SSE.Views.FormatRulesEditDlg.txtGeneral":"常规","SSE.Views.FormatRulesEditDlg.txtNoCellIcon":"无图标","SSE.Views.FormatRulesEditDlg.txtNumber":"数字","SSE.Views.FormatRulesEditDlg.txtPercentage":"百分比","SSE.Views.FormatRulesEditDlg.txtScientific":"科学型","SSE.Views.FormatRulesEditDlg.txtText":"文本","SSE.Views.FormatRulesEditDlg.txtTime":"时间","SSE.Views.FormatRulesEditDlg.txtTitleEdit":"编辑格式规则","SSE.Views.FormatRulesEditDlg.txtTitleNew":"新建格式规则","SSE.Views.FormatRulesManagerDlg.guestText":"来宾","SSE.Views.FormatRulesManagerDlg.lockText":"锁定","SSE.Views.FormatRulesManagerDlg.text1Above":"标准偏差高于平均值1","SSE.Views.FormatRulesManagerDlg.text1Below":"标准偏差低于平均值1","SSE.Views.FormatRulesManagerDlg.text2Above":"标准偏差高于平均值2","SSE.Views.FormatRulesManagerDlg.text2Below":"标准偏差低于平均值2","SSE.Views.FormatRulesManagerDlg.text3Above":"标准偏差高于平均值3","SSE.Views.FormatRulesManagerDlg.text3Below":"标准偏差低于平均值3","SSE.Views.FormatRulesManagerDlg.textAbove":"高于平均值","SSE.Views.FormatRulesManagerDlg.textApply":"应用于","SSE.Views.FormatRulesManagerDlg.textBeginsWith":"单元格值开头是","SSE.Views.FormatRulesManagerDlg.textBelow":"低于平均值","SSE.Views.FormatRulesManagerDlg.textBetween":"介于{0}到{1}之间","SSE.Views.FormatRulesManagerDlg.textCellValue":"单元格值","SSE.Views.FormatRulesManagerDlg.textColorScale":"渐变颜色刻度","SSE.Views.FormatRulesManagerDlg.textContains":"单元格值包含","SSE.Views.FormatRulesManagerDlg.textContainsBlank":"单元格包含空值","SSE.Views.FormatRulesManagerDlg.textContainsError":"单元格包含错误","SSE.Views.FormatRulesManagerDlg.textDelete":"删除","SSE.Views.FormatRulesManagerDlg.textDown":"下移规则","SSE.Views.FormatRulesManagerDlg.textDuplicate":"重复值","SSE.Views.FormatRulesManagerDlg.textEdit":"编辑","SSE.Views.FormatRulesManagerDlg.textEnds":"单元格值结尾是","SSE.Views.FormatRulesManagerDlg.textEqAbove":"等于或高于平均值","SSE.Views.FormatRulesManagerDlg.textEqBelow":"等于或低于平均值","SSE.Views.FormatRulesManagerDlg.textFormat":"格式","SSE.Views.FormatRulesManagerDlg.textIconSet":"图标集","SSE.Views.FormatRulesManagerDlg.textNew":"新建","SSE.Views.FormatRulesManagerDlg.textNotBetween":"不介于{0}到{1}之间","SSE.Views.FormatRulesManagerDlg.textNotContains":"单元格值不包含","SSE.Views.FormatRulesManagerDlg.textNotContainsBlank":"单元格不包含空值","SSE.Views.FormatRulesManagerDlg.textNotContainsError":"单元格不包含错误","SSE.Views.FormatRulesManagerDlg.textRules":"规则","SSE.Views.FormatRulesManagerDlg.textScope":"显示其格式规则","SSE.Views.FormatRulesManagerDlg.textSelectData":"选择数据","SSE.Views.FormatRulesManagerDlg.textSelection":"当前选择","SSE.Views.FormatRulesManagerDlg.textThisPivot":"当前数据透视表","SSE.Views.FormatRulesManagerDlg.textThisSheet":"当前工作表","SSE.Views.FormatRulesManagerDlg.textThisTable":"当前表格","SSE.Views.FormatRulesManagerDlg.textUnique":"唯一值","SSE.Views.FormatRulesManagerDlg.textUp":"上移规则","SSE.Views.FormatRulesManagerDlg.tipIsLocked":"该元素正在由另一个用户编辑。","SSE.Views.FormatRulesManagerDlg.txtTitle":"条件格式规则管理器","SSE.Views.FormatSettingsDialog.textCategory":"分类","SSE.Views.FormatSettingsDialog.textDecimal":"小数位数","SSE.Views.FormatSettingsDialog.textFormat":"格式","SSE.Views.FormatSettingsDialog.textLinked":"链接到源","SSE.Views.FormatSettingsDialog.textSeparator":"使用千位分隔符","SSE.Views.FormatSettingsDialog.textSymbols":"符号","SSE.Views.FormatSettingsDialog.textTitle":"设置单元格格式","SSE.Views.FormatSettingsDialog.txtAccounting":"会计专用","SSE.Views.FormatSettingsDialog.txtAs10":"十分钟","SSE.Views.FormatSettingsDialog.txtAs100":"百分之一百","SSE.Views.FormatSettingsDialog.txtAs16":"十六点","SSE.Views.FormatSettingsDialog.txtAs2":"一半","SSE.Views.FormatSettingsDialog.txtAs4":"四（2/4）","SSE.Views.FormatSettingsDialog.txtAs8":"第八，八分之一的","SSE.Views.FormatSettingsDialog.txtCurrency":"货币","SSE.Views.FormatSettingsDialog.txtCustom":"自定义","SSE.Views.FormatSettingsDialog.txtCustomWarning":"请仔细输入自定义数字格式。电子表格编辑器不检查自定义格式的错误，可能会影响xlsx的文件。","SSE.Views.FormatSettingsDialog.txtDate":"日期","SSE.Views.FormatSettingsDialog.txtFraction":"分数","SSE.Views.FormatSettingsDialog.txtGeneral":"常规","SSE.Views.FormatSettingsDialog.txtNone":"无","SSE.Views.FormatSettingsDialog.txtNumber":"数值","SSE.Views.FormatSettingsDialog.txtPercentage":"百分比","SSE.Views.FormatSettingsDialog.txtSample":"示例：","SSE.Views.FormatSettingsDialog.txtScientific":"科学记数","SSE.Views.FormatSettingsDialog.txtText":"文本","SSE.Views.FormatSettingsDialog.txtTime":"时间","SSE.Views.FormatSettingsDialog.txtUpto1":"最多一位数（1/3）","SSE.Views.FormatSettingsDialog.txtUpto2":"最多两位数（12/25）","SSE.Views.FormatSettingsDialog.txtUpto3":"最多三位数（131/135）","SSE.Views.FormulaDialog.sDescription":"描述","SSE.Views.FormulaDialog.textGroupDescription":"选择函数类别","SSE.Views.FormulaDialog.textListDescription":"选择函数","SSE.Views.FormulaDialog.txtRecommended":"推荐","SSE.Views.FormulaDialog.txtSearch":"搜索","SSE.Views.FormulaDialog.txtTitle":"插入函数","SSE.Views.FormulaTab.capBtnRemoveArr":"移去箭头","SSE.Views.FormulaTab.capBtnTraceDep":"追踪从属单元格","SSE.Views.FormulaTab.capBtnTracePrec":"追踪引用单元格","SSE.Views.FormulaTab.textAutomatic":"自动的","SSE.Views.FormulaTab.textCalculateCurrentSheet":"计算当前工作表","SSE.Views.FormulaTab.textCalculateWorkbook":"计算工作簿","SSE.Views.FormulaTab.textManual":"手动更改","SSE.Views.FormulaTab.tipCalculate":"计算","SSE.Views.FormulaTab.tipCalculateTheEntireWorkbook":"计算整个工作簿","SSE.Views.FormulaTab.tipRemoveArr":"删除所有箭头","SSE.Views.FormulaTab.tipShowFormulas":"在每个单元格中显示公式，而不是结果值。","SSE.Views.FormulaTab.tipTraceDep":"显示箭头，用于指明影响当前所选单元格值的单元格。","SSE.Views.FormulaTab.tipTracePrec":"显示箭头，用户指明受当前所选单元格值影响的单元格。","SSE.Views.FormulaTab.tipWatch":"将单元格添加到监视窗口列表","SSE.Views.FormulaTab.txtAdditional":"更多","SSE.Views.FormulaTab.txtAutosum":"自动求和","SSE.Views.FormulaTab.txtAutosumTip":"求和","SSE.Views.FormulaTab.txtCalculation":"计算","SSE.Views.FormulaTab.txtFormula":"插入函数","SSE.Views.FormulaTab.txtFormulaTip":"插入函数","SSE.Views.FormulaTab.txtMore":"其他函数","SSE.Views.FormulaTab.txtRecent":"最近使用","SSE.Views.FormulaTab.txtRemDep":"移去从属单元格追踪箭头","SSE.Views.FormulaTab.txtRemPrec":"移去引用单元格追踪箭头","SSE.Views.FormulaTab.txtShowFormulas":"显示公式","SSE.Views.FormulaTab.txtWatch":"监视窗口","SSE.Views.FormulaWizard.textAny":"任何","SSE.Views.FormulaWizard.textArgument":"参数","SSE.Views.FormulaWizard.textFunction":"函数","SSE.Views.FormulaWizard.textFunctionRes":"函数值","SSE.Views.FormulaWizard.textHelp":"关于此函数的帮助","SSE.Views.FormulaWizard.textLogical":"逻辑值","SSE.Views.FormulaWizard.textNoArgs":"此函数无参数","SSE.Views.FormulaWizard.textNumber":"数值","SSE.Views.FormulaWizard.textRef":"引用","SSE.Views.FormulaWizard.textText":"文本","SSE.Views.FormulaWizard.textTitle":"函数参数","SSE.Views.FormulaWizard.textValue":"公式结果","SSE.Views.HeaderFooterDialog.textAlign":"与页边距对齐","SSE.Views.HeaderFooterDialog.textAll":"所有页面","SSE.Views.HeaderFooterDialog.textBold":"加粗","SSE.Views.HeaderFooterDialog.textCenter":"中心","SSE.Views.HeaderFooterDialog.textColor":"文字颜色","SSE.Views.HeaderFooterDialog.textDate":"日期","SSE.Views.HeaderFooterDialog.textDiffFirst":"首页不同","SSE.Views.HeaderFooterDialog.textDiffOdd":"奇偶页不同","SSE.Views.HeaderFooterDialog.textEven":"偶数页","SSE.Views.HeaderFooterDialog.textFileName":"文件名","SSE.Views.HeaderFooterDialog.textFirst":"首页","SSE.Views.HeaderFooterDialog.textFooter":"页脚","SSE.Views.HeaderFooterDialog.textHeader":"页眉","SSE.Views.HeaderFooterDialog.textImage":"图片","SSE.Views.HeaderFooterDialog.textInsert":"插入","SSE.Views.HeaderFooterDialog.textItalic":"斜体","SSE.Views.HeaderFooterDialog.textLeft":"左","SSE.Views.HeaderFooterDialog.textMaxError":"您输入的文本字符串太长。减少使用的字符数。","SSE.Views.HeaderFooterDialog.textNewColor":"更多颜色","SSE.Views.HeaderFooterDialog.textOdd":"奇数页","SSE.Views.HeaderFooterDialog.textPageCount":"页数","SSE.Views.HeaderFooterDialog.textPageNum":"页码","SSE.Views.HeaderFooterDialog.textPresets":"预设","SSE.Views.HeaderFooterDialog.textRight":"右","SSE.Views.HeaderFooterDialog.textScale":"按文档缩放","SSE.Views.HeaderFooterDialog.textSheet":"工作表名称","SSE.Views.HeaderFooterDialog.textStrikeout":"删除线","SSE.Views.HeaderFooterDialog.textSubscript":"下标","SSE.Views.HeaderFooterDialog.textSuperscript":"上标","SSE.Views.HeaderFooterDialog.textTime":"时间","SSE.Views.HeaderFooterDialog.textTitle":"页眉/页脚设置","SSE.Views.HeaderFooterDialog.textUnderline":"下划线","SSE.Views.HeaderFooterDialog.tipFontName":"字体 ","SSE.Views.HeaderFooterDialog.tipFontSize":"字号","SSE.Views.HyperlinkSettingsDialog.strDisplay":"要显示的文字","SSE.Views.HyperlinkSettingsDialog.strLinkTo":"链接到","SSE.Views.HyperlinkSettingsDialog.strRange":"范围","SSE.Views.HyperlinkSettingsDialog.strSheet":"表格","SSE.Views.HyperlinkSettingsDialog.textCopy":"拷贝","SSE.Views.HyperlinkSettingsDialog.textDefault":"选择范围","SSE.Views.HyperlinkSettingsDialog.textEmptyDesc":"在这里输入标题","SSE.Views.HyperlinkSettingsDialog.textEmptyLink":"在这里输入链接","SSE.Views.HyperlinkSettingsDialog.textEmptyTooltip":"在这里输入工具提示","SSE.Views.HyperlinkSettingsDialog.textExternalLink":"外部链接","SSE.Views.HyperlinkSettingsDialog.textGetLink":"获取链接","SSE.Views.HyperlinkSettingsDialog.textInternalLink":"本文档中的位置","SSE.Views.HyperlinkSettingsDialog.textInvalidRange":"错误！无效的单元格范围","SSE.Views.HyperlinkSettingsDialog.textNames":"已定义名称","SSE.Views.HyperlinkSettingsDialog.textSelectData":"选择数据","SSE.Views.HyperlinkSettingsDialog.textSheets":"表单","SSE.Views.HyperlinkSettingsDialog.textTipText":"屏幕提示文字","SSE.Views.HyperlinkSettingsDialog.textTitle":"插入超链接","SSE.Views.HyperlinkSettingsDialog.txtEmpty":"必填项","SSE.Views.HyperlinkSettingsDialog.txtNotUrl":"该字段应该是“http://www.example.com”格式的URL","SSE.Views.HyperlinkSettingsDialog.txtSizeLimit":"此栏位限2083字符","SSE.Views.ImageSettings.textAdvanced":"显示高级设置","SSE.Views.ImageSettings.textCrop":"裁剪","SSE.Views.ImageSettings.textCropFill":"填充","SSE.Views.ImageSettings.textCropFit":"最佳","SSE.Views.ImageSettings.textCropToShape":"裁剪为形状","SSE.Views.ImageSettings.textEdit":"修改","SSE.Views.ImageSettings.textEditObject":"编辑对象","SSE.Views.ImageSettings.textFlip":"翻转","SSE.Views.ImageSettings.textFromFile":"从文件导入","SSE.Views.ImageSettings.textFromStorage":"来自存储设备","SSE.Views.ImageSettings.textFromUrl":"从URL","SSE.Views.ImageSettings.textHeight":"高度","SSE.Views.ImageSettings.textHint270":"逆时针旋转90°","SSE.Views.ImageSettings.textHint90":"顺时针旋转90°","SSE.Views.ImageSettings.textHintFlipH":"水平翻转","SSE.Views.ImageSettings.textHintFlipV":"垂直翻转","SSE.Views.ImageSettings.textInsert":"更改图片","SSE.Views.ImageSettings.textKeepRatio":"锁定纵横比","SSE.Views.ImageSettings.textOriginalSize":"实际大小","SSE.Views.ImageSettings.textRecentlyUsed":"最近使用的","SSE.Views.ImageSettings.textRotate90":"旋转90°","SSE.Views.ImageSettings.textRotation":"旋转","SSE.Views.ImageSettings.textSize":"大小","SSE.Views.ImageSettings.textWidth":"宽度","SSE.Views.ImageSettingsAdvanced.textAbsolute":"大小和位置均固定","SSE.Views.ImageSettingsAdvanced.textAlt":"替换文字","SSE.Views.ImageSettingsAdvanced.textAltDescription":"描述","SSE.Views.ImageSettingsAdvanced.textAltTip":"视觉对象信息的替代基于文本的表示法，将要向有视觉或认知障碍人阅读，以帮助他们更好地了解图片、自选图形、图表或表格中的那些信息。","SSE.Views.ImageSettingsAdvanced.textAltTitle":"标题","SSE.Views.ImageSettingsAdvanced.textAngle":"角度","SSE.Views.ImageSettingsAdvanced.textFlipped":"翻转","SSE.Views.ImageSettingsAdvanced.textHorizontally":"水平","SSE.Views.ImageSettingsAdvanced.textOneCell":"大小固定，位置随单元格而变","SSE.Views.ImageSettingsAdvanced.textRotation":"旋转","SSE.Views.ImageSettingsAdvanced.textSnap":"大小和位置","SSE.Views.ImageSettingsAdvanced.textTitle":"图片 - 高级设置","SSE.Views.ImageSettingsAdvanced.textTwoCell":"大小和位置随单元格而变","SSE.Views.ImageSettingsAdvanced.textVertically":"垂直","SSE.Views.ImportFromXmlDialog.textDestination":"选择将数据放在哪里","SSE.Views.ImportFromXmlDialog.textExist":"已有的工作表","SSE.Views.ImportFromXmlDialog.textInvalidRange":"无效的单元格范围","SSE.Views.ImportFromXmlDialog.textNew":"新建工作表","SSE.Views.ImportFromXmlDialog.textSelectData":"选择数据","SSE.Views.ImportFromXmlDialog.textTitle":"导入数据","SSE.Views.ImportFromXmlDialog.txtEmpty":"必填字段","SSE.Views.LeftMenu.tipAbout":"关于","SSE.Views.LeftMenu.tipChat":"聊天","SSE.Views.LeftMenu.tipComments":"批注","SSE.Views.LeftMenu.tipFile":"文件","SSE.Views.LeftMenu.tipPlugins":"插件","SSE.Views.LeftMenu.tipSearch":"搜索","SSE.Views.LeftMenu.tipSpellcheck":"拼写检查","SSE.Views.LeftMenu.tipSupport":"反馈和支持","SSE.Views.LeftMenu.txtDeveloper":"开发者模式","SSE.Views.LeftMenu.txtEditor":"表格编辑器","SSE.Views.LeftMenu.txtLimit":"限制访问","SSE.Views.LeftMenu.txtTrial":"试用模式","SSE.Views.LeftMenu.txtTrialDev":"试用开发者模式","SSE.Views.MacroDialog.textMacro":"宏名称","SSE.Views.MacroDialog.textTitle":"指定宏","SSE.Views.MainSettingsPrint.okButtonText":"保存","SSE.Views.MainSettingsPrint.strBottom":"底部","SSE.Views.MainSettingsPrint.strLandscape":"横向","SSE.Views.MainSettingsPrint.strLeft":"左","SSE.Views.MainSettingsPrint.strMargins":"边距","SSE.Views.MainSettingsPrint.strPortrait":"纵向","SSE.Views.MainSettingsPrint.strPrint":"打印","SSE.Views.MainSettingsPrint.strPrintTitles":"打印标题","SSE.Views.MainSettingsPrint.strRight":"右","SSE.Views.MainSettingsPrint.strTop":"顶部","SSE.Views.MainSettingsPrint.textActualSize":"实际大小","SSE.Views.MainSettingsPrint.textCustom":"自定义","SSE.Views.MainSettingsPrint.textCustomOptions":"自定义选项","SSE.Views.MainSettingsPrint.textFitCols":"将所有列适合一页","SSE.Views.MainSettingsPrint.textFitPage":"在一页上安装工作表","SSE.Views.MainSettingsPrint.textFitRows":"适合一页上的所有行","SSE.Views.MainSettingsPrint.textPageOrientation":"页面方向","SSE.Views.MainSettingsPrint.textPageScaling":"缩放","SSE.Views.MainSettingsPrint.textPageSize":"页面大小","SSE.Views.MainSettingsPrint.textPrintGrid":"打印网格线","SSE.Views.MainSettingsPrint.textPrintHeadings":"打印行和列标题","SSE.Views.MainSettingsPrint.textRepeat":"重复...","SSE.Views.MainSettingsPrint.textRepeatLeft":"在左侧重复一列","SSE.Views.MainSettingsPrint.textRepeatTop":"在顶部重复一行","SSE.Views.MainSettingsPrint.textSettings":"设置","SSE.Views.NamedRangeEditDlg.errorCreateDefName":"无法编辑现有的命名范围，因此无法在其中编辑新的范围。","SSE.Views.NamedRangeEditDlg.namePlaceholder":"定义名称","SSE.Views.NamedRangeEditDlg.notcriticalErrorTitle":"警告","SSE.Views.NamedRangeEditDlg.strWorkbook":"工作簿","SSE.Views.NamedRangeEditDlg.textDataRange":"引用位置","SSE.Views.NamedRangeEditDlg.textExistName":"此名称已存在","SSE.Views.NamedRangeEditDlg.textInvalidName":"名称必须以字母或下划线开头，不能包含无效字符。","SSE.Views.NamedRangeEditDlg.textInvalidRange":"错误！无效的单元格范围","SSE.Views.NamedRangeEditDlg.textIsLocked":"错误！此元素正在被其他用户编辑。","SSE.Views.NamedRangeEditDlg.textName":"名称","SSE.Views.NamedRangeEditDlg.textReservedName":"您尝试使用的名称已在单元格公式中引用。请使用其他名称。","SSE.Views.NamedRangeEditDlg.textScope":"范围","SSE.Views.NamedRangeEditDlg.textSelectData":"选择数据","SSE.Views.NamedRangeEditDlg.txtEmpty":"必填项","SSE.Views.NamedRangeEditDlg.txtTitleEdit":"编辑名称","SSE.Views.NamedRangeEditDlg.txtTitleNew":"新建名称","SSE.Views.NamedRangePasteDlg.textNames":"命名范围","SSE.Views.NamedRangePasteDlg.txtTitle":"粘贴名称","SSE.Views.NameManagerDlg.closeButtonText":"关闭","SSE.Views.NameManagerDlg.guestText":"游客","SSE.Views.NameManagerDlg.lockText":"锁定","SSE.Views.NameManagerDlg.textDataRange":"引用位置","SSE.Views.NameManagerDlg.textDelete":"删除","SSE.Views.NameManagerDlg.textEdit":"编辑","SSE.Views.NameManagerDlg.textEmpty":"没有创建名称。<br>创建至少一个名称，它将显示在此字段中。","SSE.Views.NameManagerDlg.textFilter":"筛选","SSE.Views.NameManagerDlg.textFilterAll":"所有","SSE.Views.NameManagerDlg.textFilterDefNames":"定义名称","SSE.Views.NameManagerDlg.textFilterSheet":"名称范围为表格","SSE.Views.NameManagerDlg.textFilterTableNames":"表名","SSE.Views.NameManagerDlg.textFilterWorkbook":"名称范围到工作簿","SSE.Views.NameManagerDlg.textNew":"新建","SSE.Views.NameManagerDlg.textnoNames":"没有找到与您的筛选器匹配的名称","SSE.Views.NameManagerDlg.textRanges":"名称","SSE.Views.NameManagerDlg.textScope":"范围","SSE.Views.NameManagerDlg.textWorkbook":"工作簿","SSE.Views.NameManagerDlg.tipIsLocked":"此元素正在被其他用户编辑。","SSE.Views.NameManagerDlg.txtTitle":"名称管理器","SSE.Views.NameManagerDlg.warnDelete":"确定要删除名称 {0} ？","SSE.Views.PageMarginsDialog.textBottom":"下","SSE.Views.PageMarginsDialog.textLeft":"左","SSE.Views.PageMarginsDialog.textRight":"右","SSE.Views.PageMarginsDialog.textTitle":"页边距","SSE.Views.PageMarginsDialog.textTop":"上","SSE.Views.PageMarginsDialog.textWarning":"警告","SSE.Views.PageMarginsDialog.warnCheckMargings":"边距不正确","SSE.Views.ParagraphSettings.strLineHeight":"行间距","SSE.Views.ParagraphSettings.strParagraphSpacing":"段落间距","SSE.Views.ParagraphSettings.strSpacingAfter":"段后","SSE.Views.ParagraphSettings.strSpacingBefore":"段前","SSE.Views.ParagraphSettings.textAdvanced":"显示高级设置","SSE.Views.ParagraphSettings.textAt":"在","SSE.Views.ParagraphSettings.textAtLeast":"至少","SSE.Views.ParagraphSettings.textAuto":"多倍行距","SSE.Views.ParagraphSettings.textExact":"精确地","SSE.Views.ParagraphSettings.txtAutoText":"自动","SSE.Views.ParagraphSettingsAdvanced.noTabs":"指定的选项卡将显示在此字段中","SSE.Views.ParagraphSettingsAdvanced.strAllCaps":"全部大写字母","SSE.Views.ParagraphSettingsAdvanced.strDoubleStrike":"双删除线","SSE.Views.ParagraphSettingsAdvanced.strIndent":"缩进","SSE.Views.ParagraphSettingsAdvanced.strIndentsLeftText":"左侧","SSE.Views.ParagraphSettingsAdvanced.strIndentsLineSpacing":"行间距","SSE.Views.ParagraphSettingsAdvanced.strIndentsRightText":"右侧","SSE.Views.ParagraphSettingsAdvanced.strIndentsSpacingAfter":"段后","SSE.Views.ParagraphSettingsAdvanced.strIndentsSpacingBefore":"段前","SSE.Views.ParagraphSettingsAdvanced.strIndentsSpecial":"特殊格式","SSE.Views.ParagraphSettingsAdvanced.strIndentsSpecialBy":"由","SSE.Views.ParagraphSettingsAdvanced.strParagraphFont":"字体","SSE.Views.ParagraphSettingsAdvanced.strParagraphIndents":"缩进和间距","SSE.Views.ParagraphSettingsAdvanced.strSmallCaps":"小型大写字母","SSE.Views.ParagraphSettingsAdvanced.strSpacing":"间距","SSE.Views.ParagraphSettingsAdvanced.strStrike":"删除线","SSE.Views.ParagraphSettingsAdvanced.strSubscript":"下标","SSE.Views.ParagraphSettingsAdvanced.strSuperscript":"上标","SSE.Views.ParagraphSettingsAdvanced.strTabs":"制表位","SSE.Views.ParagraphSettingsAdvanced.textAlign":"对齐方式","SSE.Views.ParagraphSettingsAdvanced.textAuto":"多倍行距","SSE.Views.ParagraphSettingsAdvanced.textCharacterSpacing":"字符间距","SSE.Views.ParagraphSettingsAdvanced.textDefault":"默认选项","SSE.Views.ParagraphSettingsAdvanced.textEffects":"效果","SSE.Views.ParagraphSettingsAdvanced.textExact":"固定值","SSE.Views.ParagraphSettingsAdvanced.textFirstLine":"首行缩进","SSE.Views.ParagraphSettingsAdvanced.textHanging":"悬挂缩进","SSE.Views.ParagraphSettingsAdvanced.textJustified":"两端对齐","SSE.Views.ParagraphSettingsAdvanced.textNoneSpecial":"（无）","SSE.Views.ParagraphSettingsAdvanced.textRemove":"删除","SSE.Views.ParagraphSettingsAdvanced.textRemoveAll":"删除所有","SSE.Views.ParagraphSettingsAdvanced.textSet":"指定","SSE.Views.ParagraphSettingsAdvanced.textTabCenter":"居中对齐","SSE.Views.ParagraphSettingsAdvanced.textTabLeft":"左对齐","SSE.Views.ParagraphSettingsAdvanced.textTabPosition":"制表位位置","SSE.Views.ParagraphSettingsAdvanced.textTabRight":"右对齐","SSE.Views.ParagraphSettingsAdvanced.textTitle":"段落 - 高级设置","SSE.Views.ParagraphSettingsAdvanced.txtAutoText":"自动","SSE.Views.PivotDigitalFilterDialog.capCondition1":"等于","SSE.Views.PivotDigitalFilterDialog.capCondition10":"不结束于","SSE.Views.PivotDigitalFilterDialog.capCondition11":"包含","SSE.Views.PivotDigitalFilterDialog.capCondition12":"不含","SSE.Views.PivotDigitalFilterDialog.capCondition13":"介于","SSE.Views.PivotDigitalFilterDialog.capCondition14":"不介于","SSE.Views.PivotDigitalFilterDialog.capCondition2":"不等于","SSE.Views.PivotDigitalFilterDialog.capCondition3":"大于","SSE.Views.PivotDigitalFilterDialog.capCondition4":"大于或等于","SSE.Views.PivotDigitalFilterDialog.capCondition5":"小于","SSE.Views.PivotDigitalFilterDialog.capCondition6":"小于或等于","SSE.Views.PivotDigitalFilterDialog.capCondition7":"开头为","SSE.Views.PivotDigitalFilterDialog.capCondition8":"不起始于","SSE.Views.PivotDigitalFilterDialog.capCondition9":"结束于","SSE.Views.PivotDigitalFilterDialog.textShowLabel":"显示标签如下的项目：","SSE.Views.PivotDigitalFilterDialog.textShowValue":"显示符合以下条件的项目:","SSE.Views.PivotDigitalFilterDialog.textUse1":"使用 ? 表示任何单个字符","SSE.Views.PivotDigitalFilterDialog.textUse2":"使用 * 表示任何系列字符","SSE.Views.PivotDigitalFilterDialog.txtAnd":"且","SSE.Views.PivotDigitalFilterDialog.txtTitleLabel":"标签筛选器","SSE.Views.PivotDigitalFilterDialog.txtTitleValue":"按值筛选","SSE.Views.PivotGroupDialog.textAuto":"自动","SSE.Views.PivotGroupDialog.textBy":"依据","SSE.Views.PivotGroupDialog.textDays":"天","SSE.Views.PivotGroupDialog.textEnd":"终止于","SSE.Views.PivotGroupDialog.textError":"此字段必须为数值。","SSE.Views.PivotGroupDialog.textGreaterError":"结尾数必须大于开始数","SSE.Views.PivotGroupDialog.textHour":"小时","SSE.Views.PivotGroupDialog.textMin":"分钟","SSE.Views.PivotGroupDialog.textMonth":"月","SSE.Views.PivotGroupDialog.textNumDays":"天数","SSE.Views.PivotGroupDialog.textQuart":"季度","SSE.Views.PivotGroupDialog.textSec":"秒","SSE.Views.PivotGroupDialog.textStart":"起始于","SSE.Views.PivotGroupDialog.textYear":"年","SSE.Views.PivotGroupDialog.txtTitle":"组合","SSE.Views.PivotSettings.textAdvanced":"显示高级设置","SSE.Views.PivotSettings.textColumns":"列","SSE.Views.PivotSettings.textFields":"选择字段","SSE.Views.PivotSettings.textFilters":"筛选","SSE.Views.PivotSettings.textRows":"行","SSE.Views.PivotSettings.textValues":"值","SSE.Views.PivotSettings.txtAddColumn":"添加到列","SSE.Views.PivotSettings.txtAddFilter":"添加到筛选","SSE.Views.PivotSettings.txtAddRow":"添加到行","SSE.Views.PivotSettings.txtAddValues":"添加到值","SSE.Views.PivotSettings.txtFieldSettings":"值字段设置","SSE.Views.PivotSettings.txtMoveBegin":"移至开头","SSE.Views.PivotSettings.txtMoveColumn":"移至列","SSE.Views.PivotSettings.txtMoveDown":"下移","SSE.Views.PivotSettings.txtMoveEnd":"移动到末尾","SSE.Views.PivotSettings.txtMoveFilter":"移至筛选器","SSE.Views.PivotSettings.txtMoveRow":"移至行","SSE.Views.PivotSettings.txtMoveUp":"上移","SSE.Views.PivotSettings.txtMoveValues":"移至值","SSE.Views.PivotSettings.txtRemove":"删除字段","SSE.Views.PivotSettingsAdvanced.strLayout":"名称和布局","SSE.Views.PivotSettingsAdvanced.textAlt":"替代文本","SSE.Views.PivotSettingsAdvanced.textAltDescription":"说明","SSE.Views.PivotSettingsAdvanced.textAltTip":"视觉对象信息的替代基于文本的表示形式，将向有视力或认知障碍的人读取，以帮助他们更好地理解图片，自动成型，图表或表格中包含的信息。","SSE.Views.PivotSettingsAdvanced.textAltTitle":"标题","SSE.Views.PivotSettingsAdvanced.textAutofitColWidth":"更新时自动调整列宽","SSE.Views.PivotSettingsAdvanced.textDataRange":"数据范围","SSE.Views.PivotSettingsAdvanced.textDataSource":"数据来源","SSE.Views.PivotSettingsAdvanced.textDisplayFields":"解除筛选器位置的域","SSE.Views.PivotSettingsAdvanced.textDown":"先下再上","SSE.Views.PivotSettingsAdvanced.textGrandTotals":"总计","SSE.Views.PivotSettingsAdvanced.textHeaders":"域的题头","SSE.Views.PivotSettingsAdvanced.textInvalidRange":"失败！单元格范围无效","SSE.Views.PivotSettingsAdvanced.textOver":"先上再下","SSE.Views.PivotSettingsAdvanced.textSelectData":"选择数据","SSE.Views.PivotSettingsAdvanced.textShowCols":"显示列总计","SSE.Views.PivotSettingsAdvanced.textShowHeaders":"显示行和列的字段标题","SSE.Views.PivotSettingsAdvanced.textShowRows":"显示行总计","SSE.Views.PivotSettingsAdvanced.textTitle":"数据透视表 - 高级设置","SSE.Views.PivotSettingsAdvanced.textWrapCol":"报告每列的筛选域","SSE.Views.PivotSettingsAdvanced.textWrapRow":"报告每行的筛选域","SSE.Views.PivotSettingsAdvanced.txtEmpty":"必填项","SSE.Views.PivotSettingsAdvanced.txtName":"名称","SSE.Views.PivotTable.capBlankRows":"空行","SSE.Views.PivotTable.capGrandTotals":"总计","SSE.Views.PivotTable.capLayout":"报表布局","SSE.Views.PivotTable.capSubtotals":"分类汇总","SSE.Views.PivotTable.mniBottomSubtotals":"在组的底部显示所有分类汇总","SSE.Views.PivotTable.mniInsertBlankLine":"在每个项目后插入空行","SSE.Views.PivotTable.mniLayoutCompact":"以紧凑形式显示","SSE.Views.PivotTable.mniLayoutNoRepeat":"不重复项目标签","SSE.Views.PivotTable.mniLayoutOutline":"以大纲形式显示","SSE.Views.PivotTable.mniLayoutRepeat":"重复所有项目标签","SSE.Views.PivotTable.mniLayoutTabular":"以表格形式显示","SSE.Views.PivotTable.mniNoSubtotals":"不显示分类汇总","SSE.Views.PivotTable.mniOffTotals":"对行和列禁用","SSE.Views.PivotTable.mniOnColumnsTotals":"仅对列启用","SSE.Views.PivotTable.mniOnRowsTotals":"仅对行启用","SSE.Views.PivotTable.mniOnTotals":"对行和列启用","SSE.Views.PivotTable.mniRemoveBlankLine":"删除每个项目后的空行","SSE.Views.PivotTable.mniTopSubtotals":"在组的顶部显示所有分类汇总","SSE.Views.PivotTable.textColBanded":"镶边列","SSE.Views.PivotTable.textColHeader":"列标题","SSE.Views.PivotTable.textRowBanded":"镶边行","SSE.Views.PivotTable.textRowHeader":"行标题","SSE.Views.PivotTable.tipCreatePivot":"插入透视表","SSE.Views.PivotTable.tipGrandTotals":"显示或隐藏总计","SSE.Views.PivotTable.tipRefresh":"更新数据源中的信息","SSE.Views.PivotTable.tipRefreshCurrent":"从数据源更新当前表的信息","SSE.Views.PivotTable.tipSelect":"选择整张透视表","SSE.Views.PivotTable.tipSubtotals":"显示或隐藏分类汇总","SSE.Views.PivotTable.txtCreate":"插入表","SSE.Views.PivotTable.txtGroupPivot_Custom":"自定义","SSE.Views.PivotTable.txtGroupPivot_Dark":"深色","SSE.Views.PivotTable.txtGroupPivot_Light":"浅色","SSE.Views.PivotTable.txtGroupPivot_Medium":"中等深浅","SSE.Views.PivotTable.txtPivotTable":"数据透视表","SSE.Views.PivotTable.txtRefresh":"刷新","SSE.Views.PivotTable.txtRefreshAll":"全部刷新","SSE.Views.PivotTable.txtSelect":"选择","SSE.Views.PivotTable.txtTable_PivotStyleDark":"数据透视表样式深色","SSE.Views.PivotTable.txtTable_PivotStyleLight":"数据透视表样式浅色","SSE.Views.PivotTable.txtTable_PivotStyleMedium":"数据透视表样式中等深浅","SSE.Views.PrintSettings.btnDownload":"保存并下载","SSE.Views.PrintSettings.btnExport":"保存和导出","SSE.Views.PrintSettings.btnPrint":"保存并打印","SSE.Views.PrintSettings.strBottom":"底部","SSE.Views.PrintSettings.strLandscape":"横向","SSE.Views.PrintSettings.strLeft":"左","SSE.Views.PrintSettings.strMargins":"边距","SSE.Views.PrintSettings.strPortrait":"纵向","SSE.Views.PrintSettings.strPrint":"打印","SSE.Views.PrintSettings.strPrintTitles":"打印标题","SSE.Views.PrintSettings.strRight":"右","SSE.Views.PrintSettings.strShow":"显示","SSE.Views.PrintSettings.strTop":"顶部","SSE.Views.PrintSettings.textActiveSheets":"活动工作表","SSE.Views.PrintSettings.textActualSize":"实际大小","SSE.Views.PrintSettings.textAllSheets":"所有表格","SSE.Views.PrintSettings.textCurrentSheet":"当前工作表","SSE.Views.PrintSettings.textCustom":"自定义","SSE.Views.PrintSettings.textCustomOptions":"自定义选项","SSE.Views.PrintSettings.textFitCols":"将所有列适合一页","SSE.Views.PrintSettings.textFitPage":"在一页上安装工作表","SSE.Views.PrintSettings.textFitRows":"适合一页上的所有行","SSE.Views.PrintSettings.textHideDetails":"隐藏细节","SSE.Views.PrintSettings.textIgnore":"忽略打印区域","SSE.Views.PrintSettings.textLayout":"布局","SSE.Views.PrintSettings.textMarginsNarrow":"狭窄","SSE.Views.PrintSettings.textMarginsNormal":"正常","SSE.Views.PrintSettings.textMarginsWide":"宽","SSE.Views.PrintSettings.textPageOrientation":"页面方向","SSE.Views.PrintSettings.textPages":"页面：","SSE.Views.PrintSettings.textPageScaling":"缩放","SSE.Views.PrintSettings.textPageSize":"页面大小","SSE.Views.PrintSettings.textPrintGrid":"打印网格线","SSE.Views.PrintSettings.textPrintHeadings":"打印行和列标题","SSE.Views.PrintSettings.textPrintRange":"打印范围","SSE.Views.PrintSettings.textRange":"范围","SSE.Views.PrintSettings.textRepeat":"重复...","SSE.Views.PrintSettings.textRepeatLeft":"在左侧重复一列","SSE.Views.PrintSettings.textRepeatTop":"在顶部重复一行","SSE.Views.PrintSettings.textSelection":"选择","SSE.Views.PrintSettings.textSettings":"工作表设置","SSE.Views.PrintSettings.textShowDetails":"显示详细资料","SSE.Views.PrintSettings.textShowGrid":"显示网格线","SSE.Views.PrintSettings.textShowHeadings":"显示行和列标题","SSE.Views.PrintSettings.textTitle":"打印设置","SSE.Views.PrintSettings.textTitlePDF":"PDF设置","SSE.Views.PrintSettings.textTo":"到","SSE.Views.PrintSettings.txtMarginsLast":"上次自定义","SSE.Views.PrintTitlesDialog.textFirstCol":"第一列","SSE.Views.PrintTitlesDialog.textFirstRow":"第一行","SSE.Views.PrintTitlesDialog.textFrozenCols":"固定列","SSE.Views.PrintTitlesDialog.textFrozenRows":"固定行","SSE.Views.PrintTitlesDialog.textInvalidRange":"失败！单元格范围无效","SSE.Views.PrintTitlesDialog.textLeft":"在左侧重复一列","SSE.Views.PrintTitlesDialog.textNoRepeat":"不重复","SSE.Views.PrintTitlesDialog.textRepeat":"重复...","SSE.Views.PrintTitlesDialog.textSelectRange":"选取范围","SSE.Views.PrintTitlesDialog.textTitle":"打印标题","SSE.Views.PrintTitlesDialog.textTop":"在顶部重复一行","SSE.Views.PrintWithPreview.txtActiveSheets":"活动工作表","SSE.Views.PrintWithPreview.txtActualSize":"实际大小","SSE.Views.PrintWithPreview.txtAllSheets":"全部工作表","SSE.Views.PrintWithPreview.txtApplyToAllSheets":"应用到所有工作表","SSE.Views.PrintWithPreview.txtBothSides":"双面打印","SSE.Views.PrintWithPreview.txtBothSidesLongDesc":"翻转长边的页面","SSE.Views.PrintWithPreview.txtBothSidesShortDesc":"翻转短边的页面","SSE.Views.PrintWithPreview.txtBottom":"下","SSE.Views.PrintWithPreview.txtCopies":"份数","SSE.Views.PrintWithPreview.txtCurrentSheet":"当前工作表","SSE.Views.PrintWithPreview.txtCustom":"自定义","SSE.Views.PrintWithPreview.txtCustomOptions":"自定义选项","SSE.Views.PrintWithPreview.txtEmptyTable":"找不到要打印的任何内容。","SSE.Views.PrintWithPreview.txtFirstPageNumber":"第一页编号：","SSE.Views.PrintWithPreview.txtFitCols":"将所有列调整为一页","SSE.Views.PrintWithPreview.txtFitPage":"将工作表调整为一页","SSE.Views.PrintWithPreview.txtFitRows":"将所有行调整为一页","SSE.Views.PrintWithPreview.txtGridlinesAndHeadings":"网格线和标题","SSE.Views.PrintWithPreview.txtHeaderFooterSettings":"页眉/页脚设置","SSE.Views.PrintWithPreview.txtIgnore":"忽略打印区域","SSE.Views.PrintWithPreview.txtLandscape":"横向","SSE.Views.PrintWithPreview.txtLeft":"左","SSE.Views.PrintWithPreview.txtMargins":"页边距","SSE.Views.PrintWithPreview.txtMarginsLast":"上次自定义","SSE.Views.PrintWithPreview.txtMarginsNarrow":"狭窄","SSE.Views.PrintWithPreview.txtMarginsNormal":"正常","SSE.Views.PrintWithPreview.txtMarginsWide":"宽","SSE.Views.PrintWithPreview.txtOf":"/ {0}","SSE.Views.PrintWithPreview.txtOneSide":"单面打印","SSE.Views.PrintWithPreview.txtOneSideDesc":"只打印一侧的页面","SSE.Views.PrintWithPreview.txtPage":"页面","SSE.Views.PrintWithPreview.txtPageNumInvalid":"页码无效","SSE.Views.PrintWithPreview.txtPageOrientation":"页面方向","SSE.Views.PrintWithPreview.txtPages":"页面：","SSE.Views.PrintWithPreview.txtPageSize":"页面大小","SSE.Views.PrintWithPreview.txtPortrait":"纵向","SSE.Views.PrintWithPreview.txtPrint":"打印","SSE.Views.PrintWithPreview.txtPrintGrid":"打印网格线","SSE.Views.PrintWithPreview.txtPrintHeadings":"打印行和列标题","SSE.Views.PrintWithPreview.txtPrintRange":"打印范围","SSE.Views.PrintWithPreview.txtPrintSides":"双面打印","SSE.Views.PrintWithPreview.txtPrintTitles":"打印标题","SSE.Views.PrintWithPreview.txtPrintToPDF":"打印为 PDF 格式","SSE.Views.PrintWithPreview.txtRepeat":"重复...","SSE.Views.PrintWithPreview.txtRepeatColumnsAtLeft":"在左侧重复一列","SSE.Views.PrintWithPreview.txtRepeatRowsAtTop":"在顶部重复一行","SSE.Views.PrintWithPreview.txtRight":"右","SSE.Views.PrintWithPreview.txtSave":"保存","SSE.Views.PrintWithPreview.txtScaling":"缩放","SSE.Views.PrintWithPreview.txtSelection":"选定区域","SSE.Views.PrintWithPreview.txtSettingsOfSheet":"工作表设置","SSE.Views.PrintWithPreview.txtSheet":"工作表：{0}","SSE.Views.PrintWithPreview.txtTo":"到","SSE.Views.PrintWithPreview.txtTop":"上","SSE.Views.ProtectDialog.textExistName":"错误！一个有此标题的区域已经存在","SSE.Views.ProtectDialog.textInvalidName":"范围标准必须为字母起头而只能包含数字、字母和空格。","SSE.Views.ProtectDialog.textInvalidRange":"错误！单元格范围无效。","SSE.Views.ProtectDialog.textSelectData":"选择数据","SSE.Views.ProtectDialog.txtAllow":"允许该表的所有用户","SSE.Views.ProtectDialog.txtAllowDescription":"您可以解锁特定范围以进行编辑。","SSE.Views.ProtectDialog.txtAllowRanges":"允许编辑范围","SSE.Views.ProtectDialog.txtAutofilter":"使用自动筛选","SSE.Views.ProtectDialog.txtDelCols":"删除列","SSE.Views.ProtectDialog.txtDelRows":"删除行​​","SSE.Views.ProtectDialog.txtEmpty":"此字段是必需的","SSE.Views.ProtectDialog.txtFormatCells":"设置单元格格式","SSE.Views.ProtectDialog.txtFormatCols":"设置列格式","SSE.Views.ProtectDialog.txtFormatRows":"设置行格式","SSE.Views.ProtectDialog.txtIncorrectPwd":"确认的密码与先前输入的不一致。","SSE.Views.ProtectDialog.txtInsCols":"插入列","SSE.Views.ProtectDialog.txtInsHyper":"插入超链接","SSE.Views.ProtectDialog.txtInsRows":"插入行","SSE.Views.ProtectDialog.txtObjs":"编辑对象","SSE.Views.ProtectDialog.txtOptional":"可选","SSE.Views.ProtectDialog.txtPassword":"密码","SSE.Views.ProtectDialog.txtPivot":"使用数据透视表和数据透视图","SSE.Views.ProtectDialog.txtProtect":"保护","SSE.Views.ProtectDialog.txtRange":"区域","SSE.Views.ProtectDialog.txtRangeName":"标题","SSE.Views.ProtectDialog.txtRepeat":"重复输入密码","SSE.Views.ProtectDialog.txtScen":"编辑方案","SSE.Views.ProtectDialog.txtSelLocked":"选定锁定的单元格","SSE.Views.ProtectDialog.txtSelUnLocked":"选择未锁定的单元格","SSE.Views.ProtectDialog.txtSheetDescription":"通过限制他人的编辑能力，防止他人进行不必要的修改。","SSE.Views.ProtectDialog.txtSheetTitle":"保护工作表","SSE.Views.ProtectDialog.txtSort":"排序","SSE.Views.ProtectDialog.txtWarning":"警告: 如果丢失或忘记密码，则无法将其恢复。请妥善保存。","SSE.Views.ProtectDialog.txtWBDescription":"为防止其他用户查看隐藏的工作表，添加、移动、删除或隐藏工作表和重命名工作表，您可以设定密码保护工作表架构。","SSE.Views.ProtectDialog.txtWBTitle":"保护工作簿结构","SSE.Views.ProtectedRangesEditDlg.textAnonymous":"匿名用户","SSE.Views.ProtectedRangesEditDlg.textInvalidName":"范围标准必须为字母起头而只能包含数字、字母和空格。","SSE.Views.ProtectedRangesEditDlg.textInvalidRange":"错误！单元格范围无效","SSE.Views.ProtectedRangesEditDlg.textSelectData":"选择数据","SSE.Views.ProtectedRangesEditDlg.textTipAdd":"添加用户","SSE.Views.ProtectedRangesEditDlg.textTipDelete":"删除用户","SSE.Views.ProtectedRangesEditDlg.textYou":"您","SSE.Views.ProtectedRangesEditDlg.txtEmpty":"必填字段","SSE.Views.ProtectedRangesEditDlg.txtProtect":"保护","SSE.Views.ProtectedRangesEditDlg.txtRange":"范围","SSE.Views.ProtectedRangesEditDlg.txtRangeName":"名称","SSE.Views.ProtectedRangesEditDlg.txtWhoCanEdit":"谁可以进行编辑","SSE.Views.ProtectedRangesEditDlg.txtYouCanEdit":"只有您能编辑这个范围","SSE.Views.ProtectedRangesEditDlg.userPlaceholder":"开始键入姓名或电子邮件","SSE.Views.ProtectedRangesManagerDlg.guestText":"访客","SSE.Views.ProtectedRangesManagerDlg.lockText":"锁定","SSE.Views.ProtectedRangesManagerDlg.textDelete":"删除","SSE.Views.ProtectedRangesManagerDlg.textEdit":"编辑","SSE.Views.ProtectedRangesManagerDlg.textEmpty":"尚未创建任何受保护的范围。<br>至少创建一个受保护的范围，它将出现在这个领域中。","SSE.Views.ProtectedRangesManagerDlg.textFilter":"筛选","SSE.Views.ProtectedRangesManagerDlg.textFilterAll":"全部","SSE.Views.ProtectedRangesManagerDlg.textNew":"新建","SSE.Views.ProtectedRangesManagerDlg.textProtect":"保护工作表","SSE.Views.ProtectedRangesManagerDlg.textRange":"范围","SSE.Views.ProtectedRangesManagerDlg.textRangesDesc":"您可以为选定的人限制范围编辑","SSE.Views.ProtectedRangesManagerDlg.textTitle":"名称","SSE.Views.ProtectedRangesManagerDlg.textYouCan":"您可以","SSE.Views.ProtectedRangesManagerDlg.tipIsLocked":"该元素正在由另一个用户编辑。","SSE.Views.ProtectedRangesManagerDlg.txtEdit":"编辑","SSE.Views.ProtectedRangesManagerDlg.txtEditRange":"编辑范围","SSE.Views.ProtectedRangesManagerDlg.txtNewRange":"新范围","SSE.Views.ProtectedRangesManagerDlg.txtTitle":"受保护范围","SSE.Views.ProtectedRangesManagerDlg.txtView":"视图","SSE.Views.ProtectedRangesManagerDlg.warnDelete":"您确定要删除受保护的范围{0}吗？<br>任何对电子表格有编辑权限的人都将能编辑该范围内的内容。","SSE.Views.ProtectedRangesManagerDlg.warnDeleteRanges":"您确定要删除受保护的范围吗？<br>任何对电子表格有编辑权限的人都将能够编辑这些范围内的内容。","SSE.Views.ProtectRangesDlg.guestText":"来宾","SSE.Views.ProtectRangesDlg.lockText":"锁定","SSE.Views.ProtectRangesDlg.textDelete":"删除","SSE.Views.ProtectRangesDlg.textEdit":"编辑","SSE.Views.ProtectRangesDlg.textEmpty":"没有可编辑的区域。","SSE.Views.ProtectRangesDlg.textNew":"新建","SSE.Views.ProtectRangesDlg.textProtect":"保护工作表","SSE.Views.ProtectRangesDlg.textPwd":"密码","SSE.Views.ProtectRangesDlg.textRange":"区域","SSE.Views.ProtectRangesDlg.textRangesDesc":"工作表受保护时，范围为密码解锁 (只适用于锁定的单元格)","SSE.Views.ProtectRangesDlg.textTitle":"标题","SSE.Views.ProtectRangesDlg.tipIsLocked":"该元素正在由另一个用户编辑。","SSE.Views.ProtectRangesDlg.txtEditRange":"编辑范围","SSE.Views.ProtectRangesDlg.txtNewRange":"新区域","SSE.Views.ProtectRangesDlg.txtNo":"否","SSE.Views.ProtectRangesDlg.txtTitle":"允许用户编辑范围","SSE.Views.ProtectRangesDlg.txtYes":"是","SSE.Views.ProtectRangesDlg.warnDelete":"您确定要删除{0}这个名字吗？","SSE.Views.RemoveDuplicatesDialog.textColumns":"列","SSE.Views.RemoveDuplicatesDialog.textDescription":"若要删除重复值，请选择一个或多个包含重复值的列。","SSE.Views.RemoveDuplicatesDialog.textHeaders":"数据包含标题","SSE.Views.RemoveDuplicatesDialog.textSelectAll":"全选","SSE.Views.RemoveDuplicatesDialog.txtTitle":"删除重复值","SSE.Views.RightMenu.txtCellSettings":"单元格设置","SSE.Views.RightMenu.txtChartSettings":"图表设置","SSE.Views.RightMenu.txtImageSettings":"图片设置","SSE.Views.RightMenu.txtParagraphSettings":"段落设置","SSE.Views.RightMenu.txtPivotSettings":"数据透视表设置","SSE.Views.RightMenu.txtSettings":"通用设置","SSE.Views.RightMenu.txtShapeSettings":"形状设置","SSE.Views.RightMenu.txtSignatureSettings":"签名设置","SSE.Views.RightMenu.txtSlicerSettings":"切片器设置","SSE.Views.RightMenu.txtSparklineSettings":"迷你图设置","SSE.Views.RightMenu.txtTableSettings":"表格设置","SSE.Views.RightMenu.txtTextArtSettings":"艺术字设置","SSE.Views.ScaleDialog.textAuto":"自动","SSE.Views.ScaleDialog.textError":"输入的值不正确。","SSE.Views.ScaleDialog.textFewPages":"页面","SSE.Views.ScaleDialog.textFitTo":"适应于","SSE.Views.ScaleDialog.textHeight":"高度","SSE.Views.ScaleDialog.textManyPages":"页面","SSE.Views.ScaleDialog.textOnePage":"页面","SSE.Views.ScaleDialog.textScaleTo":"缩放到","SSE.Views.ScaleDialog.textTitle":"缩放设置","SSE.Views.ScaleDialog.textWidth":"宽度","SSE.Views.SetValueDialog.txtMaxText":"该字段的最大值为{0}","SSE.Views.SetValueDialog.txtMinText":"该字段的最小值为{0}","SSE.Views.ShapeSettings.strBackground":"背景色","SSE.Views.ShapeSettings.strChange":"更改自动形状","SSE.Views.ShapeSettings.strColor":"颜色","SSE.Views.ShapeSettings.strFill":"填充","SSE.Views.ShapeSettings.strForeground":"前景色","SSE.Views.ShapeSettings.strPattern":"图案","SSE.Views.ShapeSettings.strShadow":"显示阴影","SSE.Views.ShapeSettings.strSize":"大小","SSE.Views.ShapeSettings.strStroke":"线条","SSE.Views.ShapeSettings.strTransparency":"透明度","SSE.Views.ShapeSettings.strType":"类型","SSE.Views.ShapeSettings.textAdvanced":"显示高级设置","SSE.Views.ShapeSettings.textAngle":"角度","SSE.Views.ShapeSettings.textBorderSizeErr":"输入的值不正确。<br>请输入介于0 pt和1584 pt之间的值。","SSE.Views.ShapeSettings.textColor":"纯色填充","SSE.Views.ShapeSettings.textDirection":"方向","SSE.Views.ShapeSettings.textEditPoints":"编辑顶点","SSE.Views.ShapeSettings.textEditShape":"编辑形状","SSE.Views.ShapeSettings.textEmptyPattern":"无图案","SSE.Views.ShapeSettings.textFlip":"翻转","SSE.Views.ShapeSettings.textFromFile":"从文件导入","SSE.Views.ShapeSettings.textFromStorage":"来自存储设备","SSE.Views.ShapeSettings.textFromUrl":"从URL","SSE.Views.ShapeSettings.textGradient":"渐变点","SSE.Views.ShapeSettings.textGradientFill":"渐变填充","SSE.Views.ShapeSettings.textHint270":"逆时针旋转90°","SSE.Views.ShapeSettings.textHint90":"顺时针旋转90°","SSE.Views.ShapeSettings.textHintFlipH":"水平翻转","SSE.Views.ShapeSettings.textHintFlipV":"垂直翻转","SSE.Views.ShapeSettings.textImageTexture":"图片或纹理","SSE.Views.ShapeSettings.textLinear":"线性","SSE.Views.ShapeSettings.textNoFill":"无填充","SSE.Views.ShapeSettings.textOriginalSize":"原始尺寸","SSE.Views.ShapeSettings.textPatternFill":"图案填充","SSE.Views.ShapeSettings.textPosition":"位置","SSE.Views.ShapeSettings.textRadial":"径向","SSE.Views.ShapeSettings.textRecentlyUsed":"最近使用的","SSE.Views.ShapeSettings.textRotate90":"旋转90°","SSE.Views.ShapeSettings.textRotation":"旋转","SSE.Views.ShapeSettings.textSelectImage":"选取图片","SSE.Views.ShapeSettings.textSelectTexture":"选择","SSE.Views.ShapeSettings.textStretch":"拉伸","SSE.Views.ShapeSettings.textStyle":"类型","SSE.Views.ShapeSettings.textTexture":"从纹理","SSE.Views.ShapeSettings.textTile":"平铺","SSE.Views.ShapeSettings.tipAddGradientPoint":"新增渐变点","SSE.Views.ShapeSettings.tipRemoveGradientPoint":"删除渐变点","SSE.Views.ShapeSettings.txtBrownPaper":"牛皮纸","SSE.Views.ShapeSettings.txtCanvas":"画布","SSE.Views.ShapeSettings.txtCarton":"纸板","SSE.Views.ShapeSettings.txtDarkFabric":"深色织物","SSE.Views.ShapeSettings.txtGrain":"颗粒","SSE.Views.ShapeSettings.txtGranite":"花岗岩","SSE.Views.ShapeSettings.txtGreyPaper":"灰纸","SSE.Views.ShapeSettings.txtKnit":"针织","SSE.Views.ShapeSettings.txtLeather":"皮革","SSE.Views.ShapeSettings.txtNoBorders":"无线条","SSE.Views.ShapeSettings.txtPapyrus":"纸莎草","SSE.Views.ShapeSettings.txtWood":"木头","SSE.Views.ShapeSettingsAdvanced.strColumns":"分栏","SSE.Views.ShapeSettingsAdvanced.strMargins":"边距","SSE.Views.ShapeSettingsAdvanced.textAbsolute":"大小和位置均固定","SSE.Views.ShapeSettingsAdvanced.textAlt":"替换文字","SSE.Views.ShapeSettingsAdvanced.textAltDescription":"描述","SSE.Views.ShapeSettingsAdvanced.textAltTip":"视觉对象信息的替代基于文本的表示法，将要向有视觉或认知障碍人阅读，以帮助他们更好地了解图片、自选图形、图表或表格中的那些信息。","SSE.Views.ShapeSettingsAdvanced.textAltTitle":"标题","SSE.Views.ShapeSettingsAdvanced.textAngle":"角度","SSE.Views.ShapeSettingsAdvanced.textArrows":"箭头","SSE.Views.ShapeSettingsAdvanced.textAutofit":"自动适应","SSE.Views.ShapeSettingsAdvanced.textBeginSize":"前端大小","SSE.Views.ShapeSettingsAdvanced.textBeginStyle":"前端类型","SSE.Views.ShapeSettingsAdvanced.textBevel":"棱台","SSE.Views.ShapeSettingsAdvanced.textBottom":"下","SSE.Views.ShapeSettingsAdvanced.textCapType":"端点类型","SSE.Views.ShapeSettingsAdvanced.textColNumber":"列数","SSE.Views.ShapeSettingsAdvanced.textEndSize":"末端大小","SSE.Views.ShapeSettingsAdvanced.textEndStyle":"末端类型","SSE.Views.ShapeSettingsAdvanced.textFlat":"平面","SSE.Views.ShapeSettingsAdvanced.textFlipped":"翻转","SSE.Views.ShapeSettingsAdvanced.textHeight":"高度","SSE.Views.ShapeSettingsAdvanced.textHorizontally":"水平","SSE.Views.ShapeSettingsAdvanced.textJoinType":"联接类型","SSE.Views.ShapeSettingsAdvanced.textKeepRatio":"锁定纵横比","SSE.Views.ShapeSettingsAdvanced.textLeft":"左","SSE.Views.ShapeSettingsAdvanced.textLineStyle":"线条","SSE.Views.ShapeSettingsAdvanced.textMiter":"斜接","SSE.Views.ShapeSettingsAdvanced.textOneCell":"大小固定，位置随单元格而变","SSE.Views.ShapeSettingsAdvanced.textOverflow":"允许文本溢出形状","SSE.Views.ShapeSettingsAdvanced.textResizeFit":"根据文字调整形状大小","SSE.Views.ShapeSettingsAdvanced.textRight":"右","SSE.Views.ShapeSettingsAdvanced.textRotation":"旋转","SSE.Views.ShapeSettingsAdvanced.textRound":"圆形","SSE.Views.ShapeSettingsAdvanced.textSize":"大小","SSE.Views.ShapeSettingsAdvanced.textSnap":"大小和位置","SSE.Views.ShapeSettingsAdvanced.textSpacing":"列之间的间距","SSE.Views.ShapeSettingsAdvanced.textSquare":"正方形","SSE.Views.ShapeSettingsAdvanced.textTextBox":"文本框","SSE.Views.ShapeSettingsAdvanced.textTitle":"形状 - 高级设置","SSE.Views.ShapeSettingsAdvanced.textTop":"上","SSE.Views.ShapeSettingsAdvanced.textTwoCell":"大小和位置随单元格而变","SSE.Views.ShapeSettingsAdvanced.textVertically":"垂直","SSE.Views.ShapeSettingsAdvanced.textWeightArrows":"线条和箭头","SSE.Views.ShapeSettingsAdvanced.textWidth":"宽度","SSE.Views.SignatureSettings.notcriticalErrorTitle":"警告","SSE.Views.SignatureSettings.strDelete":"删除签名","SSE.Views.SignatureSettings.strDetails":"签名详情","SSE.Views.SignatureSettings.strInvalid":"签名无效","SSE.Views.SignatureSettings.strRequested":"请求的签名","SSE.Views.SignatureSettings.strSetup":"签名设置","SSE.Views.SignatureSettings.strSign":"符号","SSE.Views.SignatureSettings.strSignature":"签名","SSE.Views.SignatureSettings.strSigner":"签名者","SSE.Views.SignatureSettings.strValid":"有效签名","SSE.Views.SignatureSettings.txtContinueEditing":"继续编辑","SSE.Views.SignatureSettings.txtEditWarning":"编辑将删除电子表格中的签名。<br>您确定要继续吗？","SSE.Views.SignatureSettings.txtRemoveWarning":"您想删除此签名吗? <br>这一操作无法被撤销。","SSE.Views.SignatureSettings.txtRequestedSignatures":"此电子表格需要签名。","SSE.Views.SignatureSettings.txtSigned":"有效签名已添加到电子表格中。该电子表格已限制编辑。","SSE.Views.SignatureSettings.txtSignedInvalid":"电子表格中的某些数字签名无效或无法验证。该电子表格已限制编辑。","SSE.Views.SlicerAddDialog.textColumns":"列","SSE.Views.SlicerAddDialog.txtTitle":"插入切片器","SSE.Views.SlicerSettings.strHideNoData":"隐藏没有数据的项目","SSE.Views.SlicerSettings.strIndNoData":"直观地指示空数据项","SSE.Views.SlicerSettings.strShowDel":"显示从数据源中删除的项目","SSE.Views.SlicerSettings.strShowNoData":"最后显示空数据项","SSE.Views.SlicerSettings.strSorting":"排序和筛选","SSE.Views.SlicerSettings.textAdvanced":"显示高级设置","SSE.Views.SlicerSettings.textAsc":"升序","SSE.Views.SlicerSettings.textAZ":"A到Z","SSE.Views.SlicerSettings.textButtons":"按钮","SSE.Views.SlicerSettings.textColumns":"列","SSE.Views.SlicerSettings.textDesc":"降序","SSE.Views.SlicerSettings.textHeight":"高度","SSE.Views.SlicerSettings.textHor":"横向的","SSE.Views.SlicerSettings.textKeepRatio":"恒同比例","SSE.Views.SlicerSettings.textLargeSmall":"由大到小","SSE.Views.SlicerSettings.textLock":"解除移动或改变大小的功能","SSE.Views.SlicerSettings.textNewOld":"由新到旧","SSE.Views.SlicerSettings.textOldNew":"由旧到新","SSE.Views.SlicerSettings.textPosition":"位置","SSE.Views.SlicerSettings.textSize":"大小","SSE.Views.SlicerSettings.textSmallLarge":"升序","SSE.Views.SlicerSettings.textStyle":"样式","SSE.Views.SlicerSettings.textVert":"垂直","SSE.Views.SlicerSettings.textWidth":"宽度","SSE.Views.SlicerSettings.textZA":"Z到A","SSE.Views.SlicerSettingsAdvanced.strButtons":"按钮","SSE.Views.SlicerSettingsAdvanced.strColumns":"分栏","SSE.Views.SlicerSettingsAdvanced.strHeight":"高度","SSE.Views.SlicerSettingsAdvanced.strHideNoData":"隐藏没有数据的项目","SSE.Views.SlicerSettingsAdvanced.strIndNoData":"直观地指示空数据项","SSE.Views.SlicerSettingsAdvanced.strReferences":"引用","SSE.Views.SlicerSettingsAdvanced.strShowDel":"显示从数据源中删除的项目","SSE.Views.SlicerSettingsAdvanced.strShowHeader":"显示题头","SSE.Views.SlicerSettingsAdvanced.strShowNoData":"最后显示空数据项","SSE.Views.SlicerSettingsAdvanced.strSize":"大小","SSE.Views.SlicerSettingsAdvanced.strSorting":"排序和筛选","SSE.Views.SlicerSettingsAdvanced.strStyle":"样式","SSE.Views.SlicerSettingsAdvanced.strStyleSize":"样式和尺寸","SSE.Views.SlicerSettingsAdvanced.strWidth":"宽度","SSE.Views.SlicerSettingsAdvanced.textAbsolute":"大小和位置均固定","SSE.Views.SlicerSettingsAdvanced.textAlt":"替代文本","SSE.Views.SlicerSettingsAdvanced.textAltDescription":"说明","SSE.Views.SlicerSettingsAdvanced.textAltTip":"视觉对象信息的替代基于文本的表示形式，将向有视力或认知障碍的人读取，以帮助他们更好地理解图片，自动成型，图表或表格中包含的信息。","SSE.Views.SlicerSettingsAdvanced.textAltTitle":"标题","SSE.Views.SlicerSettingsAdvanced.textAsc":"升序","SSE.Views.SlicerSettingsAdvanced.textAZ":"A到Z","SSE.Views.SlicerSettingsAdvanced.textDesc":"降序","SSE.Views.SlicerSettingsAdvanced.textFormulaName":"用在公式里的名称","SSE.Views.SlicerSettingsAdvanced.textHeader":"题头","SSE.Views.SlicerSettingsAdvanced.textKeepRatio":"恒同比例","SSE.Views.SlicerSettingsAdvanced.textLargeSmall":"由大到小","SSE.Views.SlicerSettingsAdvanced.textName":"名称","SSE.Views.SlicerSettingsAdvanced.textNewOld":"由新到旧","SSE.Views.SlicerSettingsAdvanced.textOldNew":"由旧到新","SSE.Views.SlicerSettingsAdvanced.textOneCell":"大小固定，位置随单元格而变","SSE.Views.SlicerSettingsAdvanced.textSmallLarge":"升序","SSE.Views.SlicerSettingsAdvanced.textSnap":"大小和位置","SSE.Views.SlicerSettingsAdvanced.textSort":"排序","SSE.Views.SlicerSettingsAdvanced.textSourceName":"源名称","SSE.Views.SlicerSettingsAdvanced.textTitle":"切片器 - 高级设置","SSE.Views.SlicerSettingsAdvanced.textTwoCell":"大小和位置随单元格而变","SSE.Views.SlicerSettingsAdvanced.textZA":"Z到A","SSE.Views.SlicerSettingsAdvanced.txtEmpty":"必填项","SSE.Views.SortDialog.errorEmpty":"所有排序条件都必须指定列或行。","SSE.Views.SortDialog.errorMoreOneCol":"选择了多个列。","SSE.Views.SortDialog.errorMoreOneRow":"选择了多行。","SSE.Views.SortDialog.errorNotOriginalCol":"选定的列不在原始选定范围内。","SSE.Views.SortDialog.errorNotOriginalRow":"选定的行不在原始选定范围内。","SSE.Views.SortDialog.errorSameColumnColor":"%1多次按同一颜色排序。<br>删除重复的排序条件，然后重试。","SSE.Views.SortDialog.errorSameColumnValue":"%1多次按值排序。<br>删除重复的排序条件，然后重试。","SSE.Views.SortDialog.textAsc":"升序","SSE.Views.SortDialog.textAuto":"自动","SSE.Views.SortDialog.textAZ":"升序","SSE.Views.SortDialog.textBelow":"下面","SSE.Views.SortDialog.textBtnCopy":"复制条件","SSE.Views.SortDialog.textBtnDelete":"删除条件","SSE.Views.SortDialog.textBtnNew":"添加条件","SSE.Views.SortDialog.textCellColor":"单元格颜色","SSE.Views.SortDialog.textColumn":"列","SSE.Views.SortDialog.textDesc":"降序","SSE.Views.SortDialog.textDown":"层下移","SSE.Views.SortDialog.textFontColor":"字体颜色","SSE.Views.SortDialog.textLeft":"左","SSE.Views.SortDialog.textLevels":" ","SSE.Views.SortDialog.textMoreCols":"（其他列…）","SSE.Views.SortDialog.textMoreRows":"（其他行…）","SSE.Views.SortDialog.textNone":"无","SSE.Views.SortDialog.textOptions":"选项","SSE.Views.SortDialog.textOrder":"次序","SSE.Views.SortDialog.textRight":"右","SSE.Views.SortDialog.textRow":"行","SSE.Views.SortDialog.textSort":"排序依据","SSE.Views.SortDialog.textSortBy":"排序依据","SSE.Views.SortDialog.textThenBy":"次要关键字","SSE.Views.SortDialog.textTop":"顶部","SSE.Views.SortDialog.textUp":"层上移","SSE.Views.SortDialog.textValues":"单元格值","SSE.Views.SortDialog.textZA":"降序","SSE.Views.SortDialog.txtInvalidRange":"无效的单元格区域。","SSE.Views.SortDialog.txtTitle":"排序","SSE.Views.SortFilterDialog.textAsc":"升序 (A 到 Z) 依据","SSE.Views.SortFilterDialog.textDesc":"降序 (Z 到 A) 依据","SSE.Views.SortFilterDialog.txtTitle":"排序","SSE.Views.SortFilterDialog.txtTitleValue":"按值排序","SSE.Views.SortOptionsDialog.textCase":"区分大小写","SSE.Views.SortOptionsDialog.textHeaders":"数据包含标题","SSE.Views.SortOptionsDialog.textLeftRight":"按行排序","SSE.Views.SortOptionsDialog.textOrientation":"方向","SSE.Views.SortOptionsDialog.textTitle":"排序选项","SSE.Views.SortOptionsDialog.textTopBottom":"按列排序","SSE.Views.SpecialPasteDialog.textAdd":"加","SSE.Views.SpecialPasteDialog.textAll":"全部","SSE.Views.SpecialPasteDialog.textBlanks":"跳过空单元","SSE.Views.SpecialPasteDialog.textColWidth":"列宽","SSE.Views.SpecialPasteDialog.textComments":"批注","SSE.Views.SpecialPasteDialog.textDiv":"除","SSE.Views.SpecialPasteDialog.textFFormat":"公式 & 排版","SSE.Views.SpecialPasteDialog.textFNFormat":"公式 & 编号格式","SSE.Views.SpecialPasteDialog.textFormats":"格式","SSE.Views.SpecialPasteDialog.textFormulas":"公式","SSE.Views.SpecialPasteDialog.textFWidth":"公式 & 列宽度","SSE.Views.SpecialPasteDialog.textMult":"乘","SSE.Views.SpecialPasteDialog.textNone":"无","SSE.Views.SpecialPasteDialog.textOperation":"运算","SSE.Views.SpecialPasteDialog.textPaste":"粘贴","SSE.Views.SpecialPasteDialog.textSub":"减","SSE.Views.SpecialPasteDialog.textTitle":"选择性粘贴","SSE.Views.SpecialPasteDialog.textTranspose":"转置","SSE.Views.SpecialPasteDialog.textValues":"数值","SSE.Views.SpecialPasteDialog.textVFormat":"值和格式","SSE.Views.SpecialPasteDialog.textVNFormat":"值和数字格式","SSE.Views.SpecialPasteDialog.textWBorders":"除边框外的所有元素","SSE.Views.Spellcheck.noSuggestions":"没有拼写建议","SSE.Views.Spellcheck.textChange":"修改","SSE.Views.Spellcheck.textChangeAll":"全部更改","SSE.Views.Spellcheck.textIgnore":"忽视","SSE.Views.Spellcheck.textIgnoreAll":"忽略所有","SSE.Views.Spellcheck.txtAddToDictionary":"添加到词典","SSE.Views.Spellcheck.txtClosePanel":"关闭拼写检查","SSE.Views.Spellcheck.txtComplete":"拼写检查已完成","SSE.Views.Spellcheck.txtDictionaryLanguage":"词典语言","SSE.Views.Spellcheck.txtNextTip":"转到下一个单词","SSE.Views.Spellcheck.txtSpelling":"拼字","SSE.Views.Statusbar.CopyDialog.itemCopyToEnd":"复制到末尾","SSE.Views.Statusbar.CopyDialog.itemMoveToEnd":"移动到末尾","SSE.Views.Statusbar.CopyDialog.textCopyBefore":"粘贴到工作表前面","SSE.Views.Statusbar.CopyDialog.textMoveBefore":"在纸张之前移动","SSE.Views.Statusbar.filteredRecordsText":"{0}个记录的{1}已筛选","SSE.Views.Statusbar.filteredText":"筛选器模式","SSE.Views.Statusbar.itemAverage":"平均值","SSE.Views.Statusbar.itemCopy":"复制","SSE.Views.Statusbar.itemCount":"计数","SSE.Views.Statusbar.itemDelete":"删除","SSE.Views.Statusbar.itemHidden":"取消隐藏","SSE.Views.Statusbar.itemHide":"隐藏","SSE.Views.Statusbar.itemInsert":"插入","SSE.Views.Statusbar.itemMaximum":"最大值","SSE.Views.Statusbar.itemMinimum":"最小值","SSE.Views.Statusbar.itemMove":"移动","SSE.Views.Statusbar.itemProtect":"保护","SSE.Views.Statusbar.itemRename":"重命名","SSE.Views.Statusbar.itemStatus":"在保存状态","SSE.Views.Statusbar.itemSum":"合计","SSE.Views.Statusbar.itemTabColor":"标签颜色","SSE.Views.Statusbar.itemUnProtect":"取消保护","SSE.Views.Statusbar.RenameDialog.errNameExists":"具有这样一个名称的工作表已经存在。","SSE.Views.Statusbar.RenameDialog.errNameWrongChar":"表格名字中不能保护以下符号：\\/*?[]:","SSE.Views.Statusbar.RenameDialog.labelSheetName":"工作表名称","SSE.Views.Statusbar.selectAllSheets":"选择所有工作表","SSE.Views.Statusbar.sheetIndexText":"第{1}页的第{0}页","SSE.Views.Statusbar.textAverage":"平均值","SSE.Views.Statusbar.textCount":"计数","SSE.Views.Statusbar.textMax":"最大值","SSE.Views.Statusbar.textMin":"最小值","SSE.Views.Statusbar.textNewColor":"更多颜色","SSE.Views.Statusbar.textNoColor":"没有颜色","SSE.Views.Statusbar.textSum":"求和","SSE.Views.Statusbar.tipAddTab":"添加工作表","SSE.Views.Statusbar.tipFirst":"滚动到第一张","SSE.Views.Statusbar.tipLast":"滚动到最后一张","SSE.Views.Statusbar.tipListOfSheets":"工作表列表","SSE.Views.Statusbar.tipNext":"滚动表列表对","SSE.Views.Statusbar.tipPrev":"向左滚动表单","SSE.Views.Statusbar.tipZoomFactor":"缩放","SSE.Views.Statusbar.tipZoomIn":"放大","SSE.Views.Statusbar.tipZoomOut":"缩小","SSE.Views.Statusbar.ungroupSheets":"取消工作表分组","SSE.Views.Statusbar.zoomText":"缩放{0}%","SSE.Views.TableOptionsDialog.errorAutoFilterDataRange":"所选单元格区域无法进行操作。<br>选择与现有单元格不同的统一数据范围，然后重试。","SSE.Views.TableOptionsDialog.errorFTChangeTableRangeError":"所选单元格范围无法完成操作。<br>选择一个范围，使第一个表行位于同一行<br>上，并将生成的表与当前的列重叠。","SSE.Views.TableOptionsDialog.errorFTRangeIncludedOtherTables":"所选单元格范围无法完成操作。<br>选择不包括其他表格的范围。","SSE.Views.TableOptionsDialog.errorMultiCellFormula":"表格中不允许使用多单元格数组公式。","SSE.Views.TableOptionsDialog.txtEmpty":"必填项","SSE.Views.TableOptionsDialog.txtFormat":"创建表格","SSE.Views.TableOptionsDialog.txtInvalidRange":"错误！无效的单元格范围","SSE.Views.TableOptionsDialog.txtNote":"标头必须保留在同一行中，并且结果表范围必须与原始表范围重叠。","SSE.Views.TableOptionsDialog.txtTitle":"包含标题","SSE.Views.TableSettings.deleteColumnText":"删除列","SSE.Views.TableSettings.deleteRowText":"删除行","SSE.Views.TableSettings.deleteTableText":"删除表格","SSE.Views.TableSettings.insertColumnLeftText":"在左侧插入列","SSE.Views.TableSettings.insertColumnRightText":"在右侧插入列","SSE.Views.TableSettings.insertRowAboveText":"在上方插入行","SSE.Views.TableSettings.insertRowBelowText":"在下方插入行","SSE.Views.TableSettings.notcriticalErrorTitle":"警告","SSE.Views.TableSettings.selectColumnText":"选择列","SSE.Views.TableSettings.selectDataText":"选择列数据","SSE.Views.TableSettings.selectRowText":"选择行","SSE.Views.TableSettings.selectTableText":"选择表格","SSE.Views.TableSettings.textActions":"表操作","SSE.Views.TableSettings.textAdvanced":"显示高级设置","SSE.Views.TableSettings.textBanded":"镶边行","SSE.Views.TableSettings.textColBanded":"镶边列","SSE.Views.TableSettings.textColumns":"列","SSE.Views.TableSettings.textConvertRange":"转换到范围","SSE.Views.TableSettings.textEdit":"行和列","SSE.Views.TableSettings.textEmptyTemplate":"没有模板","SSE.Views.TableSettings.textExistName":"错误！具有这种名称的范围已经存在","SSE.Views.TableSettings.textFilter":"筛选按钮","SSE.Views.TableSettings.textFirst":"第一列","SSE.Views.TableSettings.textHeader":"标题行","SSE.Views.TableSettings.textInvalidName":"错误！表名无效","SSE.Views.TableSettings.textIsLocked":"此元素正在被其他用户编辑。","SSE.Views.TableSettings.textLast":"最后一列","SSE.Views.TableSettings.textLongOperation":"长操作","SSE.Views.TableSettings.textPivot":"插入透视表","SSE.Views.TableSettings.textRemDuplicates":"移除重复的元素","SSE.Views.TableSettings.textReservedName":"您尝试使用的名称已在单元格公式中引用。请使用其他名称。","SSE.Views.TableSettings.textResize":"调整表大小","SSE.Views.TableSettings.textRows":"行","SSE.Views.TableSettings.textSelectData":"选择数据","SSE.Views.TableSettings.textSlicer":"插入切片器","SSE.Views.TableSettings.textTableName":"表名称","SSE.Views.TableSettings.textTemplate":"表格样式","SSE.Views.TableSettings.textTotal":"汇总行","SSE.Views.TableSettings.txtGroupTable_Custom":"自定义","SSE.Views.TableSettings.txtGroupTable_Dark":"深色","SSE.Views.TableSettings.txtGroupTable_Light":"浅色","SSE.Views.TableSettings.txtGroupTable_Medium":"中等深浅","SSE.Views.TableSettings.txtTable_TableStyleDark":"表格样式深色","SSE.Views.TableSettings.txtTable_TableStyleLight":"表格样式浅色","SSE.Views.TableSettings.txtTable_TableStyleMedium":"表格样式中等深浅","SSE.Views.TableSettings.warnLongOperation":"您即将执行的操作可能需要相当长的时间才能完成。<br>您确定要继续吗？","SSE.Views.TableSettingsAdvanced.textAlt":"替换文字","SSE.Views.TableSettingsAdvanced.textAltDescription":"描述","SSE.Views.TableSettingsAdvanced.textAltTip":"视觉对象信息的替代的基于文本的表示，将被视为具有视觉或认知障碍的人阅读，以帮助他们更好地了解图片，自动图片，图表或表中的哪些信息。","SSE.Views.TableSettingsAdvanced.textAltTitle":"标题","SSE.Views.TableSettingsAdvanced.textTitle":"表格 - 高级设置","SSE.Views.TextArtSettings.strBackground":"背景色","SSE.Views.TextArtSettings.strColor":"颜色","SSE.Views.TextArtSettings.strFill":"文本填充","SSE.Views.TextArtSettings.strForeground":"前景色","SSE.Views.TextArtSettings.strPattern":"图案","SSE.Views.TextArtSettings.strSize":"宽度","SSE.Views.TextArtSettings.strStroke":"文本轮廓","SSE.Views.TextArtSettings.strTransparency":"透明度","SSE.Views.TextArtSettings.strType":"类型","SSE.Views.TextArtSettings.textAngle":"角度","SSE.Views.TextArtSettings.textBorderSizeErr":"输入的值不正确。<br>请输入介于0 pt和1584 pt之间的值。","SSE.Views.TextArtSettings.textColor":"纯色填充","SSE.Views.TextArtSettings.textDirection":"方向","SSE.Views.TextArtSettings.textEmptyPattern":"无图案","SSE.Views.TextArtSettings.textFromFile":"从文件导入","SSE.Views.TextArtSettings.textFromUrl":"从URL","SSE.Views.TextArtSettings.textGradient":"渐变点","SSE.Views.TextArtSettings.textGradientFill":"渐变填充","SSE.Views.TextArtSettings.textImageTexture":"图片或纹理","SSE.Views.TextArtSettings.textLinear":"线性","SSE.Views.TextArtSettings.textNoFill":"无填充","SSE.Views.TextArtSettings.textPatternFill":"图案填充","SSE.Views.TextArtSettings.textPosition":"位置","SSE.Views.TextArtSettings.textRadial":"径向","SSE.Views.TextArtSettings.textSelectTexture":"选择","SSE.Views.TextArtSettings.textStretch":"拉伸","SSE.Views.TextArtSettings.textStyle":"类型","SSE.Views.TextArtSettings.textTemplate":"样式","SSE.Views.TextArtSettings.textTexture":"从纹理","SSE.Views.TextArtSettings.textTile":"平铺","SSE.Views.TextArtSettings.textTransform":"跟随路径","SSE.Views.TextArtSettings.tipAddGradientPoint":"新增渐变点","SSE.Views.TextArtSettings.tipRemoveGradientPoint":"删除渐变点","SSE.Views.TextArtSettings.txtBrownPaper":"牛皮纸","SSE.Views.TextArtSettings.txtCanvas":"画布","SSE.Views.TextArtSettings.txtCarton":"纸板","SSE.Views.TextArtSettings.txtDarkFabric":"深色织物","SSE.Views.TextArtSettings.txtGrain":"颗粒","SSE.Views.TextArtSettings.txtGranite":"花岗岩","SSE.Views.TextArtSettings.txtGreyPaper":"灰纸","SSE.Views.TextArtSettings.txtKnit":"针织","SSE.Views.TextArtSettings.txtLeather":"皮革","SSE.Views.TextArtSettings.txtNoBorders":"无线条","SSE.Views.TextArtSettings.txtPapyrus":"纸莎草","SSE.Views.TextArtSettings.txtWood":"木头","SSE.Views.Toolbar.capBtnAddComment":"添加批注","SSE.Views.Toolbar.capBtnColorSchemas":"配色方案","SSE.Views.Toolbar.capBtnComment":"批注","SSE.Views.Toolbar.capBtnInsHeader":"页眉/页脚","SSE.Views.Toolbar.capBtnInsSlicer":"切片器","SSE.Views.Toolbar.capBtnInsSmartArt":"SmartArt","SSE.Views.Toolbar.capBtnInsSymbol":"符号","SSE.Views.Toolbar.capBtnMargins":"页边距","SSE.Views.Toolbar.capBtnPageBreak":"分隔符","SSE.Views.Toolbar.capBtnPageOrient":"纸张方向","SSE.Views.Toolbar.capBtnPageSize":"纸张大小","SSE.Views.Toolbar.capBtnPrintArea":"打印区域","SSE.Views.Toolbar.capBtnPrintTitles":"打印标题","SSE.Views.Toolbar.capBtnScale":"按比例调整","SSE.Views.Toolbar.capImgAlign":"对齐","SSE.Views.Toolbar.capImgBackward":"下移一层","SSE.Views.Toolbar.capImgForward":"上移一层","SSE.Views.Toolbar.capImgGroup":"分组","SSE.Views.Toolbar.capInsertChart":"图表","SSE.Views.Toolbar.capInsertChartRecommend":"推荐的图表","SSE.Views.Toolbar.capInsertEquation":"公式","SSE.Views.Toolbar.capInsertHyperlink":"超链接","SSE.Views.Toolbar.capInsertImage":"图片","SSE.Views.Toolbar.capInsertShape":"形状","SSE.Views.Toolbar.capInsertSpark":"迷你图","SSE.Views.Toolbar.capInsertTable":"表格","SSE.Views.Toolbar.capInsertText":"文本框","SSE.Views.Toolbar.capInsertTextart":"艺术字","SSE.Views.Toolbar.mniCapitalizeWords":"每个单词首字母大写","SSE.Views.Toolbar.mniImageFromFile":"本地图片","SSE.Views.Toolbar.mniImageFromStorage":"图片来自存储","SSE.Views.Toolbar.mniImageFromUrl":"在线URL","SSE.Views.Toolbar.mniLowerCase":"小写","SSE.Views.Toolbar.mniSentenceCase":"句首字母大写","SSE.Views.Toolbar.mniToggleCase":"切换大小写","SSE.Views.Toolbar.mniUpperCase":"大写","SSE.Views.Toolbar.textAddPrintArea":"添加到打印区域","SSE.Views.Toolbar.textAlignBottom":"底端对齐","SSE.Views.Toolbar.textAlignCenter":"居中对齐","SSE.Views.Toolbar.textAlignJust":"两端对齐","SSE.Views.Toolbar.textAlignLeft":"左对齐","SSE.Views.Toolbar.textAlignMiddle":"垂直居中","SSE.Views.Toolbar.textAlignRight":"右对齐","SSE.Views.Toolbar.textAlignTop":"顶端对齐","SSE.Views.Toolbar.textAllBorders":"所有边框","SSE.Views.Toolbar.textAlpha":"希腊文小字母阿尔法","SSE.Views.Toolbar.textAuto":"自动","SSE.Views.Toolbar.textAutoColor":"自动","SSE.Views.Toolbar.textBetta":"希腊文小字母贝塔","SSE.Views.Toolbar.textBlackHeart":"黑心","SSE.Views.Toolbar.textBold":"加粗","SSE.Views.Toolbar.textBordersColor":"边框颜色","SSE.Views.Toolbar.textBordersStyle":"边框风格","SSE.Views.Toolbar.textBottom":"下： ","SSE.Views.Toolbar.textBottomBorders":"下边框","SSE.Views.Toolbar.textBullet":"项目符号","SSE.Views.Toolbar.textCenterBorders":"内部垂直边框","SSE.Views.Toolbar.textClearPrintArea":"清除打印区域","SSE.Views.Toolbar.textClearRule":"清除规则","SSE.Views.Toolbar.textClockwise":"顺时针角度","SSE.Views.Toolbar.textColorScales":"色阶","SSE.Views.Toolbar.textCopyright":"版权符号","SSE.Views.Toolbar.textCounterCw":"逆时针角度","SSE.Views.Toolbar.textCustom":"自定义","SSE.Views.Toolbar.textDataBars":"数据条","SSE.Views.Toolbar.textDegree":"度数符号","SSE.Views.Toolbar.textDelLeft":"右侧单元格左移","SSE.Views.Toolbar.textDelPageBreak":"删除分页符","SSE.Views.Toolbar.textDelta":"希腊文小字母得尔塔","SSE.Views.Toolbar.textDelUp":"下方单元格上移","SSE.Views.Toolbar.textDiagDownBorder":"斜下框线","SSE.Views.Toolbar.textDiagUpBorder":"斜上框线","SSE.Views.Toolbar.textDivision":"除号","SSE.Views.Toolbar.textDollar":"美元符号","SSE.Views.Toolbar.textDone":"完成","SSE.Views.Toolbar.textDown":"向下","SSE.Views.Toolbar.textEditVA":"编辑可见区域","SSE.Views.Toolbar.textEntireCol":"整列","SSE.Views.Toolbar.textEntireRow":"整行","SSE.Views.Toolbar.textEuro":"欧元符号","SSE.Views.Toolbar.textFewPages":"页面","SSE.Views.Toolbar.textFillLeft":"向左","SSE.Views.Toolbar.textFillRight":"向右","SSE.Views.Toolbar.textGreaterEqual":"大于等于","SSE.Views.Toolbar.textHeight":"高度","SSE.Views.Toolbar.textHideVA":"隐藏可见区域","SSE.Views.Toolbar.textHorizontal":"水平文本","SSE.Views.Toolbar.textInfinity":"无限","SSE.Views.Toolbar.textInsDown":"活动单元格下移","SSE.Views.Toolbar.textInsideBorders":"内边框","SSE.Views.Toolbar.textInsPageBreak":"插入分页符","SSE.Views.Toolbar.textInsRight":"活动单元格右移","SSE.Views.Toolbar.textItalic":"斜体","SSE.Views.Toolbar.textItems":"条","SSE.Views.Toolbar.textLandscape":"横向","SSE.Views.Toolbar.textLeft":"左： ","SSE.Views.Toolbar.textLeftBorders":"左边框","SSE.Views.Toolbar.textLessEqual":"小于或等于","SSE.Views.Toolbar.textLetterPi":"希腊文小字母 Pi","SSE.Views.Toolbar.textManageRule":"管理规则","SSE.Views.Toolbar.textManyPages":"页面","SSE.Views.Toolbar.textMarginsLast":"最后自定义","SSE.Views.Toolbar.textMarginsNarrow":"窄","SSE.Views.Toolbar.textMarginsNormal":"常规","SSE.Views.Toolbar.textMarginsWide":"宽","SSE.Views.Toolbar.textMiddleBorders":"水平边框","SSE.Views.Toolbar.textMoreFormats":"其他数字格式","SSE.Views.Toolbar.textMorePages":"更多页","SSE.Views.Toolbar.textMoreSymbols":"更多符号","SSE.Views.Toolbar.textNewColor":"更多颜色","SSE.Views.Toolbar.textNewRule":"新建规则","SSE.Views.Toolbar.textNoBorders":"无边框","SSE.Views.Toolbar.textNotEqualTo":"不等于","SSE.Views.Toolbar.textOneHalf":"普通分数一半","SSE.Views.Toolbar.textOnePage":"页面","SSE.Views.Toolbar.textOneQuarter":"普通分数四分之一","SSE.Views.Toolbar.textOutBorders":"外边框","SSE.Views.Toolbar.textPageMarginsCustom":"自定义页边距","SSE.Views.Toolbar.textPortrait":"纵向","SSE.Views.Toolbar.textPrint":"打印","SSE.Views.Toolbar.textPrintGridlines":"打印网格线","SSE.Views.Toolbar.textPrintHeadings":"打印标题","SSE.Views.Toolbar.textPrintOptions":"打印设置","SSE.Views.Toolbar.textRegistered":"注册标志","SSE.Views.Toolbar.textResetPageBreak":"重设所有分页符","SSE.Views.Toolbar.textRight":"右： ","SSE.Views.Toolbar.textRightBorders":"右边框","SSE.Views.Toolbar.textRotateDown":"向下旋转文字","SSE.Views.Toolbar.textRotateUp":"向上旋转文字","SSE.Views.Toolbar.textScale":"缩放","SSE.Views.Toolbar.textScaleCustom":"自定义","SSE.Views.Toolbar.textSection":"章节标志","SSE.Views.Toolbar.textSelection":"清除所选单元格的规则","SSE.Views.Toolbar.textSeries":"序列","SSE.Views.Toolbar.textSetPrintArea":"设置打印区域","SSE.Views.Toolbar.textShowVA":"显示可见的区域","SSE.Views.Toolbar.textSmile":"白色笑脸","SSE.Views.Toolbar.textSquareRoot":"平方根","SSE.Views.Toolbar.textStrikeout":"删除线","SSE.Views.Toolbar.textSubscript":"下标","SSE.Views.Toolbar.textSubSuperscript":"下标/上标","SSE.Views.Toolbar.textSuperscript":"上标","SSE.Views.Toolbar.textTabCollaboration":"审阅","SSE.Views.Toolbar.textTabData":"数据","SSE.Views.Toolbar.textTabDraw":"绘图","SSE.Views.Toolbar.textTabFile":"文件","SSE.Views.Toolbar.textTabFormula":"公式","SSE.Views.Toolbar.textTabHome":"开始","SSE.Views.Toolbar.textTabInsert":"插入","SSE.Views.Toolbar.textTabLayout":"布局","SSE.Views.Toolbar.textTabProtect":"保护","SSE.Views.Toolbar.textTabView":"视图","SSE.Views.Toolbar.textThisPivot":"清除此数据透视表的规则","SSE.Views.Toolbar.textThisSheet":"清除整个工作表的规则","SSE.Views.Toolbar.textThisTable":"清除此表的规则","SSE.Views.Toolbar.textTop":"上： ","SSE.Views.Toolbar.textTopBorders":"上边框","SSE.Views.Toolbar.textTradeMark":"商标标志","SSE.Views.Toolbar.textUnderline":"下划线","SSE.Views.Toolbar.textUp":"向上","SSE.Views.Toolbar.textVertical":"垂直文本","SSE.Views.Toolbar.textWidth":"宽度","SSE.Views.Toolbar.textYen":"日元符号","SSE.Views.Toolbar.textRmb":"人民币符号","SSE.Views.Toolbar.textZoom":"放大","SSE.Views.Toolbar.tipAlignBottom":"底端对齐","SSE.Views.Toolbar.tipAlignCenter":"水平居中","SSE.Views.Toolbar.tipAlignJust":"两端对齐","SSE.Views.Toolbar.tipAlignLeft":"左对齐","SSE.Views.Toolbar.tipAlignMiddle":"垂直居中","SSE.Views.Toolbar.tipAlignRight":"右对齐","SSE.Views.Toolbar.tipAlignTop":"顶端对齐","SSE.Views.Toolbar.tipAutofilter":"排序和筛选","SSE.Views.Toolbar.tipBack":"返回","SSE.Views.Toolbar.tipBorders":"边框","SSE.Views.Toolbar.tipCellStyle":"单元格样式","SSE.Views.Toolbar.tipChangeCase":"更改大小写","SSE.Views.Toolbar.tipChangeChart":"更改图表类型","SSE.Views.Toolbar.tipClearStyle":"清除","SSE.Views.Toolbar.tipColorSchemas":"更改配色方案","SSE.Views.Toolbar.tipCondFormat":"条件格式","SSE.Views.Toolbar.tipCopy":"复制","SSE.Views.Toolbar.tipCopyStyle":"格式刷","SSE.Views.Toolbar.tipCut":"剪切","SSE.Views.Toolbar.tipDecDecimal":"减少小数位数","SSE.Views.Toolbar.tipDecFont":"减小字号","SSE.Views.Toolbar.tipDeleteOpt":"删除单元格","SSE.Views.Toolbar.tipDigStyleAccounting":"会计数字格式","SSE.Views.Toolbar.tipDigStyleCurrency":"货币风格","SSE.Views.Toolbar.tipDigStylePercent":"百分比样式","SSE.Views.Toolbar.tipEditChart":"编辑图表","SSE.Views.Toolbar.tipEditChartData":"选择数据","SSE.Views.Toolbar.tipEditChartType":"更改图表类型","SSE.Views.Toolbar.tipEditHeader":"编辑页眉或页脚","SSE.Views.Toolbar.tipFontColor":"字体颜色","SSE.Views.Toolbar.tipFontName":"字体 ","SSE.Views.Toolbar.tipFontSize":"字体大小","SSE.Views.Toolbar.tipHAlighOle":"水平对齐","SSE.Views.Toolbar.tipImgAlign":"对齐对象","SSE.Views.Toolbar.tipImgGroup":"组合对象","SSE.Views.Toolbar.tipIncDecimal":"增加小数位数","SSE.Views.Toolbar.tipIncFont":"增大字号","SSE.Views.Toolbar.tipInsertChart":"插入图表","SSE.Views.Toolbar.tipInsertChartRecommend":"插入推荐的图表","SSE.Views.Toolbar.tipInsertChartSpark":"插入图表","SSE.Views.Toolbar.tipInsertEquation":"插入公式","SSE.Views.Toolbar.tipInsertHorizontalText":"插入横排文本框","SSE.Views.Toolbar.tipInsertHyperlink":"添加超链接","SSE.Views.Toolbar.tipInsertImage":"插入图片","SSE.Views.Toolbar.tipInsertOpt":"插入单元格","SSE.Views.Toolbar.tipInsertShape":"自动插入形状","SSE.Views.Toolbar.tipInsertSlicer":"插入切片器","SSE.Views.Toolbar.tipInsertSmartArt":"插入 SmartArt","SSE.Views.Toolbar.tipInsertSpark":"插入迷你图","SSE.Views.Toolbar.tipInsertSymbol":"插入符号","SSE.Views.Toolbar.tipInsertTable":"插入表格","SSE.Views.Toolbar.tipInsertText":"插入文字","SSE.Views.Toolbar.tipInsertTextart":"插入艺术字","SSE.Views.Toolbar.tipInsertVerticalText":"插入竖排文本框","SSE.Views.Toolbar.tipMerge":"合并后居中","SSE.Views.Toolbar.tipNone":"无","SSE.Views.Toolbar.tipNumFormat":"数字格式","SSE.Views.Toolbar.tipPageBreak":"在打印副本的新页开始位置添加分页符。","SSE.Views.Toolbar.tipPageMargins":"调整页边距","SSE.Views.Toolbar.tipPageOrient":"更改页面方向","SSE.Views.Toolbar.tipPageSize":"选择页面大小","SSE.Views.Toolbar.tipPaste":"粘贴","SSE.Views.Toolbar.tipPrColor":"填充颜色","SSE.Views.Toolbar.tipPrint":"打印","SSE.Views.Toolbar.tipPrintArea":"打印区域","SSE.Views.Toolbar.tipPrintQuick":"快速打印","SSE.Views.Toolbar.tipPrintTitles":"打印标题","SSE.Views.Toolbar.tipRedo":"重做","SSE.Views.Toolbar.tipSave":"保存","SSE.Views.Toolbar.tipSaveCoauth":"保存您的更改以供其他用户查看","SSE.Views.Toolbar.tipScale":"按比例调整","SSE.Views.Toolbar.tipSelectAll":"全选","SSE.Views.Toolbar.tipSendBackward":"下移一层","SSE.Views.Toolbar.tipSendForward":"上移一层","SSE.Views.Toolbar.tipSynchronize":"该文档已被其他用户更改。请点击保存更改和重新加载更新。","SSE.Views.Toolbar.tipTextFormatting":"更多格式化工具","SSE.Views.Toolbar.tipTextOrientation":"方向","SSE.Views.Toolbar.tipUndo":"复原","SSE.Views.Toolbar.tipVAlighOle":"垂直对齐","SSE.Views.Toolbar.tipVisibleArea":"可见区域","SSE.Views.Toolbar.tipWrap":"自动换行","SSE.Views.Toolbar.txtAccounting":"会计专用","SSE.Views.Toolbar.txtAdditional":"其他函数","SSE.Views.Toolbar.txtAscending":"升序","SSE.Views.Toolbar.txtAutosumTip":"求和","SSE.Views.Toolbar.txtCellStyle":"单元格样式","SSE.Views.Toolbar.txtClearAll":"全部清除","SSE.Views.Toolbar.txtClearComments":"清除批注","SSE.Views.Toolbar.txtClearFilter":"清除筛选","SSE.Views.Toolbar.txtClearFormat":"清除格式","SSE.Views.Toolbar.txtClearFormula":"功能","SSE.Views.Toolbar.txtClearHyper":"清除超链接","SSE.Views.Toolbar.txtClearText":"清除内容","SSE.Views.Toolbar.txtCurrency":"货币","SSE.Views.Toolbar.txtCustom":"自定义","SSE.Views.Toolbar.txtDate":"日期","SSE.Views.Toolbar.txtDateLong":"完整日期","SSE.Views.Toolbar.txtDateShort":"简写日期","SSE.Views.Toolbar.txtDateTime":"日期和时间","SSE.Views.Toolbar.txtDescending":"降序","SSE.Views.Toolbar.txtDollar":"美元","SSE.Views.Toolbar.txtEuro":"欧元","SSE.Views.Toolbar.txtExp":"指数","SSE.Views.Toolbar.txtFillNum":"填充","SSE.Views.Toolbar.txtFilter":"筛选","SSE.Views.Toolbar.txtFormula":"插入函数","SSE.Views.Toolbar.txtFraction":"分数","SSE.Views.Toolbar.txtFranc":"瑞士法郎","SSE.Views.Toolbar.txtGeneral":"常规","SSE.Views.Toolbar.txtInteger":"整数","SSE.Views.Toolbar.txtManageRange":"名称管理器","SSE.Views.Toolbar.txtMergeAcross":"跨越合并","SSE.Views.Toolbar.txtMergeCells":"合并单元格","SSE.Views.Toolbar.txtMergeCenter":"合并后居中","SSE.Views.Toolbar.txtNamedRange":"名称管理","SSE.Views.Toolbar.txtNewRange":"定义名称","SSE.Views.Toolbar.txtNoBorders":"无边框","SSE.Views.Toolbar.txtNumber":"数值","SSE.Views.Toolbar.txtPasteRange":"粘贴名称","SSE.Views.Toolbar.txtPercentage":"百分比","SSE.Views.Toolbar.txtPound":"英镑","SSE.Views.Toolbar.txtRouble":"卢布","SSE.Views.Toolbar.txtScheme1":"公司地址","SSE.Views.Toolbar.txtScheme10":"中位数","SSE.Views.Toolbar.txtScheme11":"组件","SSE.Views.Toolbar.txtScheme12":"组件","SSE.Views.Toolbar.txtScheme13":"富裕的","SSE.Views.Toolbar.txtScheme14":"奥丽尔","SSE.Views.Toolbar.txtScheme15":"原来的","SSE.Views.Toolbar.txtScheme16":"纸","SSE.Views.Toolbar.txtScheme17":"冬至","SSE.Views.Toolbar.txtScheme18":"技术","SSE.Views.Toolbar.txtScheme19":"行进","SSE.Views.Toolbar.txtScheme2":"灰度","SSE.Views.Toolbar.txtScheme20":"城市的","SSE.Views.Toolbar.txtScheme21":"气势","SSE.Views.Toolbar.txtScheme22":"新Office","SSE.Views.Toolbar.txtScheme3":"顶点","SSE.Views.Toolbar.txtScheme4":"方面","SSE.Views.Toolbar.txtScheme5":"公民","SSE.Views.Toolbar.txtScheme6":"中央大厅","SSE.Views.Toolbar.txtScheme7":"公平","SSE.Views.Toolbar.txtScheme8":"流动","SSE.Views.Toolbar.txtScheme9":"发现","SSE.Views.Toolbar.txtScientific":"科学记数","SSE.Views.Toolbar.txtSearch":"搜索","SSE.Views.Toolbar.txtSort":"排序","SSE.Views.Toolbar.txtSortAZ":"升序","SSE.Views.Toolbar.txtSortZA":"降序","SSE.Views.Toolbar.txtSpecial":"特殊格式","SSE.Views.Toolbar.txtTableTemplate":"套用表格格式","SSE.Views.Toolbar.txtText":"文本","SSE.Views.Toolbar.txtTime":"时间","SSE.Views.Toolbar.txtUnmerge":"取消合并单元格","SSE.Views.Toolbar.txtYuan":"人民币","SSE.Views.Top10FilterDialog.textType":"显示","SSE.Views.Top10FilterDialog.txtBottom":"底部","SSE.Views.Top10FilterDialog.txtBy":"依据","SSE.Views.Top10FilterDialog.txtItems":"项目","SSE.Views.Top10FilterDialog.txtPercent":"百分","SSE.Views.Top10FilterDialog.txtSum":"合计","SSE.Views.Top10FilterDialog.txtTitle":"前十位自动筛选","SSE.Views.Top10FilterDialog.txtTop":"顶部","SSE.Views.Top10FilterDialog.txtValueTitle":"前10个筛选器","SSE.Views.ValueFieldSettingsDialog.textNext":"(下一个）","SSE.Views.ValueFieldSettingsDialog.textNumFormat":"数字格式","SSE.Views.ValueFieldSettingsDialog.textPrev":"（上一个）","SSE.Views.ValueFieldSettingsDialog.textTitle":"值字段设置","SSE.Views.ValueFieldSettingsDialog.txtAverage":"平均值","SSE.Views.ValueFieldSettingsDialog.txtBaseField":"基本字段","SSE.Views.ValueFieldSettingsDialog.txtBaseItem":"基本项","SSE.Views.ValueFieldSettingsDialog.txtByField":"%1项:%2","SSE.Views.ValueFieldSettingsDialog.txtCount":"计数","SSE.Views.ValueFieldSettingsDialog.txtCountNums":"数值计数","SSE.Views.ValueFieldSettingsDialog.txtCustomName":"自定义名称","SSE.Views.ValueFieldSettingsDialog.txtDifference":"不同于","SSE.Views.ValueFieldSettingsDialog.txtIndex":"索引","SSE.Views.ValueFieldSettingsDialog.txtMax":"最大值","SSE.Views.ValueFieldSettingsDialog.txtMin":"最小值","SSE.Views.ValueFieldSettingsDialog.txtNormal":"无计算","SSE.Views.ValueFieldSettingsDialog.txtPercent":"百分比","SSE.Views.ValueFieldSettingsDialog.txtPercentDiff":"百分差","SSE.Views.ValueFieldSettingsDialog.txtPercentOfCol":"占所有列的百分比","SSE.Views.ValueFieldSettingsDialog.txtPercentOfGrand":"总计百分比","SSE.Views.ValueFieldSettingsDialog.txtPercentOfParent":"父级汇总的百分比","SSE.Views.ValueFieldSettingsDialog.txtPercentOfParentCol":"父列汇总百分比","SSE.Views.ValueFieldSettingsDialog.txtPercentOfParentRow":"父行汇总百分比","SSE.Views.ValueFieldSettingsDialog.txtPercentOfRunTotal":"按某一字段汇总的百分比","SSE.Views.ValueFieldSettingsDialog.txtPercentOfTotal":"占所有行的百分比","SSE.Views.ValueFieldSettingsDialog.txtProduct":"乘积","SSE.Views.ValueFieldSettingsDialog.txtRankAscending":"升序排列","SSE.Views.ValueFieldSettingsDialog.txtRankDescending":"降序排列","SSE.Views.ValueFieldSettingsDialog.txtRunTotal":"总运行","SSE.Views.ValueFieldSettingsDialog.txtShowAs":"值显示方式","SSE.Views.ValueFieldSettingsDialog.txtSourceName":"源名称：","SSE.Views.ValueFieldSettingsDialog.txtStdDev":"标准偏差","SSE.Views.ValueFieldSettingsDialog.txtStdDevp":"总体标准偏差","SSE.Views.ValueFieldSettingsDialog.txtSum":"求和","SSE.Views.ValueFieldSettingsDialog.txtSummarize":"值汇总方式","SSE.Views.ValueFieldSettingsDialog.txtVar":"方差","SSE.Views.ValueFieldSettingsDialog.txtVarp":"总体方差","SSE.Views.ViewManagerDlg.closeButtonText":"关闭","SSE.Views.ViewManagerDlg.guestText":"游客","SSE.Views.ViewManagerDlg.lockText":"锁定","SSE.Views.ViewManagerDlg.textDelete":"删除","SSE.Views.ViewManagerDlg.textDuplicate":"重复","SSE.Views.ViewManagerDlg.textEmpty":"目前没有创建视图。","SSE.Views.ViewManagerDlg.textGoTo":"转到视图","SSE.Views.ViewManagerDlg.textLongName":"请键入少于128个字符的名称。","SSE.Views.ViewManagerDlg.textNew":"新建","SSE.Views.ViewManagerDlg.textRename":"重命名","SSE.Views.ViewManagerDlg.textRenameError":"视图名称不得为空。","SSE.Views.ViewManagerDlg.textRenameLabel":"重命名视图","SSE.Views.ViewManagerDlg.textViews":"工作表视图","SSE.Views.ViewManagerDlg.tipIsLocked":"此元素正在被其他用户编辑。","SSE.Views.ViewManagerDlg.txtTitle":"工作表视图的管理器","SSE.Views.ViewManagerDlg.warnDeleteView":"您正在尝试删除当前启用的视图'％1'。 <br> 关闭并删除此视图吗？","SSE.Views.ViewTab.capBtnFreeze":"冻结窗格","SSE.Views.ViewTab.capBtnSheetView":"工作表视图","SSE.Views.ViewTab.textAlwaysShowToolbar":"始终显示工具栏","SSE.Views.ViewTab.textClose":"关闭","SSE.Views.ViewTab.textCombineSheetAndStatusBars":"合并工作表和状态栏","SSE.Views.ViewTab.textCreate":"新建","SSE.Views.ViewTab.textDefault":"默认","SSE.Views.ViewTab.textFormula":"公式栏","SSE.Views.ViewTab.textFreezeCol":"冻结首列","SSE.Views.ViewTab.textFreezeRow":"冻结首行","SSE.Views.ViewTab.textGridlines":"网格线","SSE.Views.ViewTab.textHeadings":"标题","SSE.Views.ViewTab.textInterfaceTheme":"界面主题","SSE.Views.ViewTab.textLeftMenu":"左面板","SSE.Views.ViewTab.textManager":"查看管理器","SSE.Views.ViewTab.textRightMenu":"右面板","SSE.Views.ViewTab.textShowFrozenPanesShadow":"显示冻结窗格的阴影","SSE.Views.ViewTab.textUnFreeze":"取消冻结窗格","SSE.Views.ViewTab.textZeros":"显示零","SSE.Views.ViewTab.textZoom":"缩放","SSE.Views.ViewTab.tipClose":"关闭工作表视图","SSE.Views.ViewTab.tipCreate":"创建工作表视图","SSE.Views.ViewTab.tipFreeze":"冻结窗格","SSE.Views.ViewTab.tipInterfaceTheme":"界面主题","SSE.Views.ViewTab.tipSheetView":"工作表视图","SSE.Views.ViewTab.tipViewNormal":"在正常视图中查看您的文档","SSE.Views.ViewTab.tipViewPageBreak":"在打印文档前预览分页","SSE.Views.ViewTab.txtViewNormal":"正常","SSE.Views.ViewTab.txtViewPageBreak":"分页预览","SSE.Views.WatchDialog.closeButtonText":"关闭","SSE.Views.WatchDialog.textAdd":"添加监视","SSE.Views.WatchDialog.textBook":"工作簿","SSE.Views.WatchDialog.textCell":"单元格","SSE.Views.WatchDialog.textDelete":"删除监视","SSE.Views.WatchDialog.textDeleteAll":"删除全部","SSE.Views.WatchDialog.textFormula":"公式","SSE.Views.WatchDialog.textName":"姓名","SSE.Views.WatchDialog.textSheet":"工作表","SSE.Views.WatchDialog.textValue":"值","SSE.Views.WatchDialog.txtTitle":"监视窗口","SSE.Views.WBProtection.hintAllowRanges":"允许编辑范围","SSE.Views.WBProtection.hintProtectRange":"保护范围","SSE.Views.WBProtection.hintProtectSheet":"保护工作表","SSE.Views.WBProtection.hintProtectWB":"保护工作簿​​","SSE.Views.WBProtection.txtAllowRanges":"允许编辑范围","SSE.Views.WBProtection.txtHiddenFormula":"隐藏公式","SSE.Views.WBProtection.txtLockedCell":"锁定的单元格","SSE.Views.WBProtection.txtLockedShape":"形状锁定了","SSE.Views.WBProtection.txtLockedText":"锁定文本","SSE.Views.WBProtection.txtProtectRange":"保护范围","SSE.Views.WBProtection.txtProtectSheet":"保护工作表","SSE.Views.WBProtection.txtProtectWB":"保护工作簿​​","SSE.Views.WBProtection.txtSheetUnlockDescription":"输入密码解除保护","SSE.Views.WBProtection.txtSheetUnlockTitle":"取消工作表保护","SSE.Views.WBProtection.txtWBUnlockDescription":"输入密码解除保护","SSE.Views.WBProtection.txtWBUnlockTitle":"取消工作簿保护"});var params=getUrlParams(),lang=(params.lang||"en").split(/[\-\_]/)[0],logo=params.headerlogo?encodeUrlParam(params.headerlogo):null,logoDark=params.headerlogodark?encodeUrlParam(params.headerlogodark):null,checkLocalStorage=(window.frameEditorId=params.frameEditorId,window.parentOrigin=params.parentOrigin,!function(){window.uitheme||(window.uitheme={}),window.uitheme.set_id=function(t){"theme-system"==t?this.adapt_to_system_theme():this.id=t},window.uitheme.is_theme_system=function(){return"theme-system"==this.id},window.uitheme.adapt_to_system_theme=function(){this.id="theme-system",this.type=this.is_system_theme_dark()?"dark":"light"},window.uitheme.relevant_theme_id=function(){return this.is_theme_system()?this.is_system_theme_dark()?"theme-dark":"theme-classic-light":this.id},window.uitheme.is_system_theme_dark||(window.uitheme.is_system_theme_dark=function(){return window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches}),window.uitheme.id||window.uitheme.set_id(localStorage.getItem("ui-theme-id")),window.uitheme.iscontentdark="dark"==localStorage.getItem("content-theme");let t=window.uitheme.colors?window.uitheme:localStorage.getItem("ui-theme");if(t=t&&("string"==typeof t&&t.startsWith("{")&&t.endsWith("}")?JSON.parse(t):t))if(window.uitheme.id&&window.uitheme.id!=t.id)localStorage.removeItem("ui-theme"),!window.uitheme.type&&/-dark/.test(window.uitheme.id)&&(window.uitheme.type="dark");else if(window.uitheme.cache=t,!window.uitheme.type&&t.type&&(window.uitheme.type=t.type),t.colors){var e,i=[];for(e in t.colors)"toolbar-header-presentation"==e&&"#aa5252"==t.colors[e]&&(t.colors[e]="#BE664F"),i.push("--"+e+":"+t.colors[e]);var s=document.createElement("style");s.type="text/css",s.innerHTML="."+t.id+"{"+i.join(";")+";}",document.getElementsByTagName("head")[0].appendChild(s)}}(),define("themeinit",function(){}),function(){try{window.localStorage;return!0}catch(t){return!1}}()),Common,Common,Common,Common,Common,Common,Common,Common,Common,Common;checkLocalStorage&&"1"===localStorage.getItem("ui-rtl")&&(document.body.setAttribute("dir","rtl"),document.body.classList.add("rtl"));const isIE=/msie|trident/i.test(navigator.userAgent);function checkScaling(){var t,e={"pixel-ratio__1_25":"screen and (-webkit-min-device-pixel-ratio: 1.25) and (-webkit-max-device-pixel-ratio: 1.49), screen and (min-resolution: 1.25dppx) and (max-resolution: 1.49dppx)","pixel-ratio__1_5":"screen and (-webkit-min-device-pixel-ratio: 1.5) and (-webkit-max-device-pixel-ratio: 1.74), screen and (min-resolution: 1.5dppx) and (max-resolution: 1.74dppx)","pixel-ratio__1_75":"screen and (-webkit-min-device-pixel-ratio: 1.75) and (-webkit-max-device-pixel-ratio: 1.99), screen and (min-resolution: 1.75dppx) and (max-resolution: 1.99dppx)"};for(t in e)if(window.matchMedia(e[t]).matches){document.body.classList.add(t);break}if(!isIE)for(var i in e={"pixel-ratio__2_5":"screen and (-webkit-min-device-pixel-ratio: 2.25), screen and (min-resolution: 2.25dppx)"})if(window.matchMedia(e[i]).matches){document.body.classList.add(i),Common.Utils.injectSvgIcons();break}}let svg_icons=["./resources/img/iconssmall@2.5x.svg","./resources/img/iconsbig@2.5x.svg","./resources/img/iconshuge@2.5x.svg"];if(window.Common={Utils:{injectSvgIcons:function(){}}},checkScaling(),params.uitheme&&("default-dark"==params.uitheme?(params.uitheme="theme-dark",params.uithemetype="dark"):"default-light"==params.uitheme?(params.uitheme="theme-classic-light",params.uithemetype="light"):params.uitheme),!window.uitheme.id&&params.uitheme&&(window.uitheme.id=params.uitheme),window.uitheme.id?!window.uitheme.type&&params.uitheme&&(window.uitheme.type=params.uithemetype):window.uitheme.adapt_to_system_theme(),document.body.classList.add(window.uitheme.relevant_theme_id()),"dark"==window.uitheme.type&&(document.body.classList.add("theme-type-dark"),checkLocalStorage&&"dark"==localStorage.getItem("content-theme")&&document.body.classList.add("content-theme-dark")),window.is_system_theme_dark||delete window.is_system_theme_dark,define("htmlutils",function(){}),!function(){function r(o,n){return n=null==n?o.length-1:+n,function(){for(var t=Math.max(arguments.length-n,0),e=Array(t),i=0;i<t;i++)e[i]=arguments[i+n];switch(n){case 0:return o.call(this,e);case 1:return o.call(this,arguments[0],e);case 2:return o.call(this,arguments[0],arguments[1],e)}for(var s=Array(n+1),i=0;i<n;i++)s[i]=arguments[i];return s[n]=e,o.apply(this,s)}}function t(e){return function(t){return null==t?void 0:t[e]}}function a(t,e){for(var i=e.length,s=0;s<i;s++){if(null==t)return;t=t[e[s]]}return i?t:void 0}function e(p){return function(t,e,i,s){var o=3<=arguments.length,n=t,a=k(e,s,4),l=i,r=!V(n)&&T.keys(n),c=(r||n).length,d=0<p?0:c-1;for(o||(l=n[r?r[d]:d],d+=p);0<=d&&d<c;d+=p){var h=r?r[d]:d;l=a(l,n[h],h,n)}return l}}function i(n,e){return function(i,s,t){var o=e?[[],[]]:{};return s=E(s,t),T.each(i,function(t,e){e=s(t,e,i);n(o,t,e)}),o}}function s(n){return function(t,e,i){e=E(e,i);for(var s=D(t),o=0<n?0:s-1;0<=o&&o<s;o+=n)if(e(t[o],o,t))return o;return-1}}function o(n,a,l){return function(t,e,i){var s=0,o=D(t);if("number"==typeof i)0<n?s=0<=i?i:Math.max(i+o,s):o=0<=i?Math.min(i+1,o):i+o+1;else if(l&&i&&o)return t[i=l(t,e)]===e?i:-1;if(e!=e)return 0<=(i=a(S.call(t,s,o),T.isNaN))?i+s:-1;for(i=0<n?s:o-1;0<=i&&i<o;i+=n)if(t[i]===e)return i;return-1}}function c(t,e,i,s,o){return s instanceof e?(s=I(t.prototype),e=t.apply(s,o),T.isObject(e)?e:s):t.apply(i,o)}function n(t,e){var i=M.length,s=t.constructor,o=T.isFunction(s)&&s.prototype||C,n="constructor";for(T.has(t,n)&&!T.contains(e,n)&&e.push(n);i--;)(n=M[i])in t&&t[n]!==o[n]&&!T.contains(e,n)&&e.push(n)}function l(r,c){return function(t){var e=arguments.length;if(c&&(t=Object(t)),!(e<2||null==t))for(var i=1;i<e;i++)for(var s=arguments[i],o=r(s),n=o.length,a=0;a<n;a++){var l=o[a];c&&void 0!==t[l]||(t[l]=s[l])}return t}}function U(t,e,i){return e in i}function d(e){function i(t){return e[t]}var t="(?:"+T.keys(e).join("|")+")",s=RegExp(t),o=RegExp(t,"g");return function(t){return s.test(t=null==t?"":""+t)?t.replace(o,i):t}}function L(t){return"\\"+z[t]}function h(t,e){return t._chain?T(e).chain():e}var p,m,u,g="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global||this||{},B=g._,b=Array.prototype,C=Object.prototype,f="undefined"!=typeof Symbol?Symbol.prototype:null,H=b.push,S=b.slice,v=C.toString,w=C.hasOwnProperty,_=Array.isArray,x=Object.keys,y=Object.create,A=function(){},T=function(t){return t instanceof T?t:this instanceof T?void(this._wrapped=t):new T(t)},k=("undefined"==typeof exports||exports.nodeType?g._=T:(exports="undefined"!=typeof module&&!module.nodeType&&module.exports?module.exports=T:exports)._=T,T.VERSION="1.8.3",function(o,n,t){if(void 0===n)return o;switch(t){case 1:return function(t){return o.call(n,t)};case null:case 3:return function(t,e,i){return o.call(n,t,e,i)};case 4:return function(t,e,i,s){return o.call(n,t,e,i,s)}}return function(){return o.apply(n,arguments)}}),E=function(t,e,i){return T.iteratee!==p?T.iteratee(t,e):null==t?T.identity:T.isFunction(t)?k(t,e,i):T.isObject(t)&&!T.isArray(t)?T.matcher(t):T.property(t)},I=(T.iteratee=p=function(t,e){return E(t,e,1/0)},function(t){if(!T.isObject(t))return{};if(y)return y(t);A.prototype=t;t=new A;return A.prototype=null,t}),O=Math.pow(2,53)-1,D=t("length"),V=function(t){t=D(t);return"number"==typeof t&&0<=t&&t<=O},N=(T.each=T.forEach=function(t,e,i){if(e=k(e,i),V(t))for(o=0,n=t.length;o<n;o++)e(t[o],o,t);else for(var s=T.keys(t),o=0,n=s.length;o<n;o++)e(t[s[o]],s[o],t);return t},T.map=T.collect=function(t,e,i){e=E(e,i);for(var s=!V(t)&&T.keys(t),o=(s||t).length,n=Array(o),a=0;a<o;a++){var l=s?s[a]:a;n[a]=e(t[l],l,t)}return n},T.reduce=T.foldl=T.inject=e(1),T.reduceRight=T.foldr=e(-1),T.find=T.detect=function(t,e,i){e=(V(t)?T.findIndex:T.findKey)(t,e,i);if(void 0!==e&&-1!==e)return t[e]},T.filter=T.select=function(t,s,e){var o=[];return s=E(s,e),T.each(t,function(t,e,i){s(t,e,i)&&o.push(t)}),o},T.reject=function(t,e,i){return T.filter(t,T.negate(E(e)),i)},T.every=T.all=function(t,e,i){e=E(e,i);for(var s=!V(t)&&T.keys(t),o=(s||t).length,n=0;n<o;n++){var a=s?s[n]:n;if(!e(t[a],a,t))return!1}return!0},T.some=T.any=function(t,e,i){e=E(e,i);for(var s=!V(t)&&T.keys(t),o=(s||t).length,n=0;n<o;n++){var a=s?s[n]:n;if(e(t[a],a,t))return!0}return!1},T.contains=T.includes=T.include=function(t,e,i,s){return V(t)||(t=T.values(t)),0<=T.indexOf(t,e,i="number"==typeof i&&!s?i:0)},T.invoke=r(function(t,i,s){var o,n;return T.isFunction(i)?n=i:T.isArray(i)&&(o=i.slice(0,-1),i=i[i.length-1]),T.map(t,function(t){var e=n;if(!e){if(null==(t=o&&o.length?a(t,o):t))return;e=t[i]}return null==e?e:e.apply(t,s)})}),T.pluck=function(t,e){return T.map(t,T.property(e))},T.where=function(t,e){return T.filter(t,T.matcher(e))},T.findWhere=function(t,e){return T.find(t,T.matcher(e))},T.max=function(t,s,e){var i,o,n=-1/0,a=-1/0;if(null==s||"number"==typeof s&&"object"!=typeof t[0]&&null!=t)for(var l=0,r=(t=V(t)?t:T.values(t)).length;l<r;l++)null!=(i=t[l])&&n<i&&(n=i);else s=E(s,e),T.each(t,function(t,e,i){o=s(t,e,i),(a<o||o===-1/0&&n===-1/0)&&(n=t,a=o)});return n},T.min=function(t,s,e){var i,o,n=1/0,a=1/0;if(null==s||"number"==typeof s&&"object"!=typeof t[0]&&null!=t)for(var l=0,r=(t=V(t)?t:T.values(t)).length;l<r;l++)null!=(i=t[l])&&i<n&&(n=i);else s=E(s,e),T.each(t,function(t,e,i){((o=s(t,e,i))<a||o===1/0&&n===1/0)&&(n=t,a=o)});return n},T.shuffle=function(t){return T.sample(t,1/0)},T.sample=function(t,e,i){if(null==e||i)return(t=V(t)?t:T.values(t))[T.random(t.length-1)];for(var s=V(t)?T.clone(t):T.values(t),i=D(s),o=(e=Math.max(Math.min(e,i),0),i-1),n=0;n<e;n++){var a=T.random(n,o),l=s[n];s[n]=s[a],s[a]=l}return s.slice(0,e)},T.sortBy=function(t,s,e){var o=0;return s=E(s,e),T.pluck(T.map(t,function(t,e,i){return{value:t,index:o++,criteria:s(t,e,i)}}).sort(function(t,e){var i=t.criteria,s=e.criteria;if(i!==s){if(s<i||void 0===i)return 1;if(i<s||void 0===s)return-1}return t.index-e.index}),"value")},T.groupBy=i(function(t,e,i){T.has(t,i)?t[i].push(e):t[i]=[e]}),T.indexBy=i(function(t,e,i){t[i]=e}),T.countBy=i(function(t,e,i){T.has(t,i)?t[i]++:t[i]=1}),/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g),P=(T.toArray=function(t){return t?T.isArray(t)?S.call(t):T.isString(t)?t.match(N):V(t)?T.map(t,T.identity):T.values(t):[]},T.size=function(t){return null==t?0:(V(t)?t:T.keys(t)).length},T.partition=i(function(t,e,i){t[i?0:1].push(e)},!0),T.first=T.head=T.take=function(t,e,i){if(!(null==t||t.length<1))return null==e||i?t[0]:T.initial(t,t.length-e)},T.initial=function(t,e,i){return S.call(t,0,Math.max(0,t.length-(null==e||i?1:e)))},T.last=function(t,e,i){if(!(null==t||t.length<1))return null==e||i?t[t.length-1]:T.rest(t,Math.max(0,t.length-e))},T.rest=T.tail=T.drop=function(t,e,i){return S.call(t,null==e||i?1:e)},T.compact=function(t){return T.filter(t,Boolean)},function(t,e,i,s){for(var o=(s=s||[]).length,n=0,a=D(t);n<a;n++){var l=t[n];if(V(l)&&(T.isArray(l)||T.isArguments(l)))if(e)for(var r=0,c=l.length;r<c;)s[o++]=l[r++];else P(l,e,i,s),o=s.length;else i||(s[o++]=l)}return s}),F=(T.flatten=function(t,e){return P(t,e,!1)},T.without=r(function(t,e){return T.difference(t,e)}),T.uniq=T.unique=function(t,e,i,s){T.isBoolean(e)||(s=i,i=e,e=!1),null!=i&&(i=E(i,s));for(var o=[],n=[],a=0,l=D(t);a<l;a++){var r=t[a],c=i?i(r,a,t):r;e?(a&&n===c||o.push(r),n=c):i?T.contains(n,c)||(n.push(c),o.push(r)):T.contains(o,r)||o.push(r)}return o},T.union=r(function(t){return T.uniq(P(t,!0,!0))}),T.intersection=function(t){for(var e=[],i=arguments.length,s=0,o=D(t);s<o;s++){var n=t[s];if(!T.contains(e,n)){for(var a=1;a<i&&T.contains(arguments[a],n);a++);a===i&&e.push(n)}}return e},T.difference=r(function(t,e){return e=P(e,!0,!0),T.filter(t,function(t){return!T.contains(e,t)})}),T.unzip=function(t){for(var e=t&&T.max(t,D).length||0,i=Array(e),s=0;s<e;s++)i[s]=T.pluck(t,s);return i},T.zip=r(T.unzip),T.object=function(t,e){for(var i={},s=0,o=D(t);s<o;s++)e?i[t[s]]=e[s]:i[t[s][0]]=t[s][1];return i},T.findIndex=s(1),T.findLastIndex=s(-1),T.sortedIndex=function(t,e,i,s){for(var o=(i=E(i,s,1))(e),n=0,a=D(t);n<a;){var l=Math.floor((n+a)/2);i(t[l])<o?n=l+1:a=l}return n},T.indexOf=o(1,T.findIndex,T.sortedIndex),T.lastIndexOf=o(-1,T.findLastIndex),T.range=function(t,e,i){null==e&&(e=t||0,t=0),i=i||(e<t?-1:1);for(var s=Math.max(Math.ceil((e-t)/i),0),o=Array(s),n=0;n<s;n++,t+=i)o[n]=t;return o},T.chunk=function(t,e){if(null==e||e<1)return[];for(var i=[],s=0,o=t.length;s<o;)i.push(S.call(t,s,s+=e));return i},T.bind=r(function(e,i,s){var o;if(T.isFunction(e))return o=r(function(t){return c(e,o,i,this,s.concat(t))});throw new TypeError("Bind must be called on a function")}),T.partial=r(function(o,n){function a(){for(var t=0,e=n.length,i=Array(e),s=0;s<e;s++)i[s]=n[s]===l?arguments[t++]:n[s];for(;t<arguments.length;)i.push(arguments[t++]);return c(o,a,this,this,i)}var l=T.partial.placeholder;return a}),(T.partial.placeholder=T).bindAll=r(function(t,e){var i=(e=P(e,!1,!1)).length;if(i<1)throw new Error("bindAll must be passed function names");for(;i--;){var s=e[i];t[s]=T.bind(t[s],t)}}),T.memoize=function(s,o){function n(t){var e=n.cache,i=""+(o?o.apply(this,arguments):t);return T.has(e,i)||(e[i]=s.apply(this,arguments)),e[i]}return n.cache={},n},T.delay=r(function(t,e,i){return setTimeout(function(){return t.apply(null,i)},e)}),T.defer=T.partial(T.delay,T,1),T.throttle=function(i,s,o){function n(){d=!1===o.leading?0:T.now(),a=null,c=i.apply(l,r),a||(l=r=null)}function t(){var t=T.now(),e=(d||!1!==o.leading||(d=t),s-(t-d));return l=this,r=arguments,e<=0||s<e?(a&&(clearTimeout(a),a=null),d=t,c=i.apply(l,r),a||(l=r=null)):a||!1===o.trailing||(a=setTimeout(n,e)),c}var a,l,r,c,d=0;o=o||{};return t.cancel=function(){clearTimeout(a),d=0,a=l=r=null},t},T.debounce=function(i,s,o){function n(t,e){a=null,e&&(l=i.apply(t,e))}var a,l,t=r(function(t){var e;return a&&clearTimeout(a),o?(e=!a,a=setTimeout(n,s),e&&(l=i.apply(this,t))):a=T.delay(n,s,this,t),l});return t.cancel=function(){clearTimeout(a),a=null},t},T.wrap=function(t,e){return T.partial(e,t)},T.negate=function(t){return function(){return!t.apply(this,arguments)}},T.compose=function(){var i=arguments,s=i.length-1;return function(){for(var t=s,e=i[s].apply(this,arguments);t--;)e=i[t].call(this,e);return e}},T.after=function(t,e){return function(){if(--t<1)return e.apply(this,arguments)}},T.before=function(t,e){var i;return function(){return 0<--t&&(i=e.apply(this,arguments)),t<=1&&(e=null),i}},T.once=T.partial(T.before,2),T.restArgs=r,!{toString:null}.propertyIsEnumerable("toString")),M=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],_=(T.keys=function(t){if(!T.isObject(t))return[];if(x)return x(t);var e,i=[];for(e in t)T.has(t,e)&&i.push(e);return F&&n(t,i),i},T.allKeys=function(t){if(!T.isObject(t))return[];var e,i=[];for(e in t)i.push(e);return F&&n(t,i),i},T.values=function(t){for(var e=T.keys(t),i=e.length,s=Array(i),o=0;o<i;o++)s[o]=t[e[o]];return s},T.mapObject=function(t,e,i){e=E(e,i);for(var s=T.keys(t),o=s.length,n={},a=0;a<o;a++){var l=s[a];n[l]=e(t[l],l,t)}return n},T.pairs=function(t){for(var e=T.keys(t),i=e.length,s=Array(i),o=0;o<i;o++)s[o]=[e[o],t[e[o]]];return s},T.invert=function(t){for(var e={},i=T.keys(t),s=0,o=i.length;s<o;s++)e[t[i[s]]]=i[s];return e},T.functions=T.methods=function(t){var e,i=[];for(e in t)T.isFunction(t[e])&&i.push(e);return i.sort()},T.extend=l(T.allKeys),T.extendOwn=T.assign=l(T.keys),T.findKey=function(t,e,i){e=E(e,i);for(var s,o=T.keys(t),n=0,a=o.length;n<a;n++)if(e(t[s=o[n]],s,t))return s},T.pick=r(function(t,e){var i={},s=e[0];if(null!=t){T.isFunction(s)?(1<e.length&&(s=k(s,e[1])),e=T.allKeys(t)):(s=U,e=P(e,!1,!1),t=Object(t));for(var o=0,n=e.length;o<n;o++){var a=e[o],l=t[a];s(l,a,t)&&(i[a]=l)}}return i}),T.omit=r(function(t,i){var e,s=i[0];return T.isFunction(s)?(s=T.negate(s),1<i.length&&(e=i[1])):(i=T.map(P(i,!1,!1),String),s=function(t,e){return!T.contains(i,e)}),T.pick(t,s,e)}),T.defaults=l(T.allKeys,!0),T.create=function(t,e){t=I(t);return e&&T.extendOwn(t,e),t},T.clone=function(t){return T.isObject(t)?T.isArray(t)?t.slice():T.extend({},t):t},T.tap=function(t,e){return e(t),t},T.isMatch=function(t,e){var i=T.keys(e),s=i.length;if(null==t)return!s;for(var o=Object(t),n=0;n<s;n++){var a=i[n];if(e[a]!==o[a]||!(a in o))return!1}return!0},m=function(t,e,i,s){var o;return t===e?0!==t||1/t==1/e:null!=t&&null!=e&&(t!=t?e!=e:("function"==(o=typeof t)||"object"==o||"object"==typeof e)&&u(t,e,i,s))},u=function(t,e,i,s){t instanceof T&&(t=t._wrapped),e instanceof T&&(e=e._wrapped);var o=v.call(t);if(o!==v.call(e))return!1;switch(o){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!=+t?+e!=+e:0==+t?1/+t==1/e:+t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object Symbol]":return f.valueOf.call(t)===f.valueOf.call(e)}o="[object Array]"===o;if(!o){if("object"!=typeof t||"object"!=typeof e)return!1;var n=t.constructor,a=e.constructor;if(n!==a&&!(T.isFunction(n)&&n instanceof n&&T.isFunction(a)&&a instanceof a)&&"constructor"in t&&"constructor"in e)return!1}s=s||[];for(var l=(i=i||[]).length;l--;)if(i[l]===t)return s[l]===e;if(i.push(t),s.push(e),o){if((l=t.length)!==e.length)return!1;for(;l--;)if(!m(t[l],e[l],i,s))return!1}else{var r,c=T.keys(t),l=c.length;if(T.keys(e).length!==l)return!1;for(;l--;)if(r=c[l],!T.has(e,r)||!m(t[r],e[r],i,s))return!1}return i.pop(),s.pop(),!0},T.isEqual=function(t,e){return m(t,e)},T.isEmpty=function(t){return null==t||(V(t)&&(T.isArray(t)||T.isString(t)||T.isArguments(t))?0===t.length:0===T.keys(t).length)},T.isElement=function(t){return!(!t||1!==t.nodeType)},T.isArray=_||function(t){return"[object Array]"===v.call(t)},T.isObject=function(t){var e=typeof t;return"function"==e||"object"==e&&!!t},T.each(["Arguments","Function","String","Number","Date","RegExp","Error","Symbol","Map","WeakMap","Set","WeakSet"],function(e){T["is"+e]=function(t){return v.call(t)==="[object "+e+"]"}}),T.isArguments(arguments)||(T.isArguments=function(t){return T.has(t,"callee")}),g.document&&g.document.childNodes),_=("function"!=typeof/./&&"object"!=typeof Int8Array&&"function"!=typeof _&&(T.isFunction=function(t){return"function"==typeof t||!1}),T.isFinite=function(t){return!T.isSymbol(t)&&isFinite(t)&&!isNaN(parseFloat(t))},T.isNaN=function(t){return T.isNumber(t)&&isNaN(t)},T.isBoolean=function(t){return!0===t||!1===t||"[object Boolean]"===v.call(t)},T.isNull=function(t){return null===t},T.isUndefined=function(t){return void 0===t},T.has=function(t,e){if(!T.isArray(e))return null!=t&&w.call(t,e);for(var i=e.length,s=0;s<i;s++){var o=e[s];if(null==t||!w.call(t,o))return!1;t=t[o]}return!!i},T.noConflict=function(){return g._=B,this},T.identity=function(t){return t},T.constant=function(t){return function(){return t}},T.noop=function(){},T.property=function(e){return T.isArray(e)?function(t){return a(t,e)}:t(e)},T.propertyOf=function(e){return null==e?function(){}:function(t){return T.isArray(t)?a(e,t):e[t]}},T.matcher=T.matches=function(e){return e=T.extendOwn({},e),function(t){return T.isMatch(t,e)}},T.times=function(t,e,i){var s=Array(Math.max(0,t));e=k(e,i,1);for(var o=0;o<t;o++)s[o]=e(o);return s},T.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},T.now=Date.now||function(){return(new Date).getTime()},{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"}),$=T.invert(_),G=(T.escape=d(_),T.unescape=d($),T.result=function(t,e,i){var s=(e=T.isArray(e)?e:[e]).length;if(!s)return T.isFunction(i)?i.call(t):i;for(var o=0;o<s;o++){var n=null==t?void 0:t[e[o]];void 0===n&&(n=i,o=s),t=T.isFunction(n)?n.call(t):n}return t},0),R=(T.uniqueId=function(t){var e=++G+"";return t?t+e:e},T.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},/(.)^/),z={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},W=/\\|'|\r|\n|\u2028|\u2029/g;T.template=function(n,t,e){t=T.defaults({},t=!t&&e?e:t,T.templateSettings);var i,e=RegExp([(t.escape||R).source,(t.interpolate||R).source,(t.evaluate||R).source].join("|")+"|$","g"),a=0,l="__p+='";n.replace(e,function(t,e,i,s,o){return l+=n.slice(a,o).replace(W,L),a=o+t.length,e?l+="'+\n((__t=("+e+"))==null?'':_.escape(__t))+\n'":i?l+="'+\n((__t=("+i+"))==null?'':__t)+\n'":s&&(l+="';\n"+s+"\n__p+='"),t}),l+="';\n",l="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+(l=t.variable?l:"with(obj||{}){\n"+l+"}\n")+"return __p;\n";try{i=new Function(t.variable||"obj","_",l)}catch(t){throw t.source=l,t}function s(t){return i.call(this,t,T)}e=t.variable||"obj";return s.source="function("+e+"){\n"+l+"}",s},T.chain=function(t){t=T(t);return t._chain=!0,t};T.mixin=function(i){return T.each(T.functions(i),function(t){var e=T[t]=i[t];T.prototype[t]=function(){var t=[this._wrapped];return H.apply(t,arguments),h(this,e.apply(T,t))}}),T},T.mixin(T),T.each(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var i=b[e];T.prototype[e]=function(){var t=this._wrapped;return i.apply(t,arguments),"shift"!==e&&"splice"!==e||0!==t.length||delete t[0],h(this,t)}}),T.each(["concat","join","slice"],function(t){var e=b[t];T.prototype[t]=function(){return h(this,e.apply(this._wrapped,arguments))}}),T.prototype.value=function(){return this._wrapped},T.prototype.valueOf=T.prototype.toJSON=T.prototype.value,T.prototype.toString=function(){return String(this._wrapped)},"function"==typeof define&&define.amd&&define("underscore",[],function(){return T})}(),!function(t,e){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=t.document?e(t,!0):function(t){if(t.document)return e(t);throw new Error("jQuery requires a window with a document")}:e(t)}("undefined"!=typeof window?window:this,function(w,U){"use strict";function f(t){return"function"==typeof t&&"number"!=typeof t.nodeType}function g(t){return null!=t&&t===t.window}var e=[],L=Object.getPrototypeOf,l=e.slice,B=e.flat?function(t){return e.flat.call(t)}:function(t){return e.concat.apply([],t)},H=e.push,O=e.indexOf,N={},$=N.toString,G=N.hasOwnProperty,z=G.toString,W=z.call(Object),b={},_=w.document,j={type:!0,src:!0,nonce:!0,noModule:!0};function q(t,e,i){var s,o,n=(i=i||_).createElement("script");if(n.text=t,e)for(s in j)(o=e[s]||e.getAttribute&&e.getAttribute(s))&&n.setAttribute(s,o);i.head.appendChild(n).parentNode.removeChild(n)}function u(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?N[$.call(t)]||"object":typeof t}var x=function(t,e){return new x.fn.init(t,e)};function K(t){var e=!!t&&"length"in t&&t.length,i=u(t);return!f(t)&&!g(t)&&("array"===i||0===e||"number"==typeof e&&0<e&&e-1 in t)}x.fn=x.prototype={jquery:"3.5.1",constructor:x,length:0,toArray:function(){return l.call(this)},get:function(t){return null==t?l.call(this):t<0?this[t+this.length]:this[t]},pushStack:function(t){t=x.merge(this.constructor(),t);return t.prevObject=this,t},each:function(t){return x.each(this,t)},map:function(i){return this.pushStack(x.map(this,function(t,e){return i.call(t,e,t)}))},slice:function(){return this.pushStack(l.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(x.grep(this,function(t,e){return(e+1)%2}))},odd:function(){return this.pushStack(x.grep(this,function(t,e){return e%2}))},eq:function(t){var e=this.length,t=+t+(t<0?e:0);return this.pushStack(0<=t&&t<e?[this[t]]:[])},end:function(){return this.prevObject||this.constructor()},push:H,sort:e.sort,splice:e.splice},x.extend=x.fn.extend=function(){var t,e,i,s,o,n=arguments[0]||{},a=1,l=arguments.length,r=!1;for("boolean"==typeof n&&(r=n,n=arguments[a]||{},a++),"object"==typeof n||f(n)||(n={}),a===l&&(n=this,a--);a<l;a++)if(null!=(t=arguments[a]))for(e in t)i=t[e],"__proto__"!==e&&n!==i&&(r&&i&&(x.isPlainObject(i)||(s=Array.isArray(i)))?(o=n[e],o=s&&!Array.isArray(o)?[]:s||x.isPlainObject(o)?o:{},s=!1,n[e]=x.extend(r,o,i)):void 0!==i&&(n[e]=i));return n},x.extend({expando:"jQuery"+("3.5.1"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isPlainObject:function(t){return!(!t||"[object Object]"!==$.call(t))&&(!(t=L(t))||"function"==typeof(t=G.call(t,"constructor")&&t.constructor)&&z.call(t)===W)},isEmptyObject:function(t){for(var e in t)return!1;return!0},globalEval:function(t,e,i){q(t,{nonce:e&&e.nonce},i)},each:function(t,e){var i,s=0;if(K(t))for(i=t.length;s<i&&!1!==e.call(t[s],s,t[s]);s++);else for(s in t)if(!1===e.call(t[s],s,t[s]))break;return t},makeArray:function(t,e){e=e||[];return null!=t&&(K(Object(t))?x.merge(e,"string"==typeof t?[t]:t):H.call(e,t)),e},inArray:function(t,e,i){return null==e?-1:O.call(e,t,i)},merge:function(t,e){for(var i=+e.length,s=0,o=t.length;s<i;s++)t[o++]=e[s];return t.length=o,t},grep:function(t,e,i){for(var s=[],o=0,n=t.length,a=!i;o<n;o++)!e(t[o],o)!=a&&s.push(t[o]);return s},map:function(t,e,i){var s,o,n=0,a=[];if(K(t))for(s=t.length;n<s;n++)null!=(o=e(t[n],n,i))&&a.push(o);else for(n in t)null!=(o=e(t[n],n,i))&&a.push(o);return B(a)},guid:1,support:b}),"function"==typeof Symbol&&(x.fn[Symbol.iterator]=e[Symbol.iterator]),x.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(t,e){N["[object "+e+"]"]=e.toLowerCase()});function s(t,e,i){for(var s=[],o=void 0!==i;(t=t[e])&&9!==t.nodeType;)if(1===t.nodeType){if(o&&x(t).is(i))break;s.push(t)}return s}function Y(t,e){for(var i=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&i.push(t);return i}var t=function(U){function h(t,e){return t="0x"+t.slice(1)-65536,e||(t<0?String.fromCharCode(65536+t):String.fromCharCode(t>>10|55296,1023&t|56320))}function L(t,e){return e?"\0"===t?"�":t.slice(0,-1)+"\\"+t.charCodeAt(t.length-1).toString(16)+" ":"\\"+t}function B(){_()}var t,p,v,n,H,m,O,N,w,r,c,_,x,i,y,u,s,o,g,A="sizzle"+ +new Date,d=U.document,T=0,$=0,G=V(),z=V(),W=V(),b=V(),j=function(t,e){return t===e&&(c=!0),0},q={}.hasOwnProperty,e=[],K=e.pop,Y=e.push,k=e.push,X=e.slice,f=function(t,e){for(var i=0,s=t.length;i<s;i++)if(t[i]===e)return i;return-1},J="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",a="[\\x20\\t\\r\\n\\f]",l="(?:\\\\[\\da-fA-F]{1,6}"+a+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",Z="\\["+a+"*("+l+")(?:"+a+"*([*^$|!~]?=)"+a+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+l+"))|)"+a+"*\\]",Q=":("+l+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+Z+")*)|.*)\\)|)",tt=new RegExp(a+"+","g"),C=new RegExp("^"+a+"+|((?:^|[^\\\\])(?:\\\\.)*)"+a+"+$","g"),et=new RegExp("^"+a+"*,"+a+"*"),it=new RegExp("^"+a+"*([>+~]|"+a+")"+a+"*"),st=new RegExp(a+"|>"),ot=new RegExp(Q),nt=new RegExp("^"+l+"$"),S={ID:new RegExp("^#("+l+")"),CLASS:new RegExp("^\\.("+l+")"),TAG:new RegExp("^("+l+"|[*])"),ATTR:new RegExp("^"+Z),PSEUDO:new RegExp("^"+Q),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+a+"*(even|odd|(([+-]|)(\\d*)n|)"+a+"*(?:([+-]|)"+a+"*(\\d+)|))"+a+"*\\)|)","i"),bool:new RegExp("^(?:"+J+")$","i"),needsContext:new RegExp("^"+a+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+a+"*((?:-\\d)?\\d*)"+a+"*\\)|)(?=[^-]|$)","i")},at=/HTML$/i,lt=/^(?:input|select|textarea|button)$/i,rt=/^h\d$/i,E=/^[^{]+\{\s*\[native \w/,ct=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,dt=/[+~]/,I=new RegExp("\\\\[\\da-fA-F]{1,6}"+a+"?|\\\\([^\\r\\n\\f])","g"),ht=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,pt=ft(function(t){return!0===t.disabled&&"fieldset"===t.nodeName.toLowerCase()},{dir:"parentNode",next:"legend"});try{k.apply(e=X.call(d.childNodes),d.childNodes),e[d.childNodes.length].nodeType}catch(t){k={apply:e.length?function(t,e){Y.apply(t,X.call(e))}:function(t,e){for(var i=t.length,s=0;t[i++]=e[s++];);t.length=i-1}}}function D(e,t,i,s){var o,n,a,l,r,c,d=t&&t.ownerDocument,h=t?t.nodeType:9;if(i=i||[],"string"!=typeof e||!e||1!==h&&9!==h&&11!==h)return i;if(!s&&(_(t),t=t||x,y)){if(11!==h&&(l=ct.exec(e)))if(o=l[1]){if(9===h){if(!(c=t.getElementById(o)))return i;if(c.id===o)return i.push(c),i}else if(d&&(c=d.getElementById(o))&&g(t,c)&&c.id===o)return i.push(c),i}else{if(l[2])return k.apply(i,t.getElementsByTagName(e)),i;if((o=l[3])&&p.getElementsByClassName&&t.getElementsByClassName)return k.apply(i,t.getElementsByClassName(o)),i}if(p.qsa&&!b[e+" "]&&!(u&&u.test(e)||1===h&&"object"===t.nodeName.toLowerCase())){if(c=e,d=t,1===h&&(st.test(e)||it.test(e))){for((d=dt.test(e)&&bt(t.parentNode)||t)===t&&p.scope||((a=t.getAttribute("id"))?a=a.replace(ht,L):t.setAttribute("id",a=A)),n=(r=m(e)).length;n--;)r[n]=(a?"#"+a:":scope")+" "+R(r[n]);c=r.join(",")}try{return k.apply(i,d.querySelectorAll(c)),i}catch(t){b(e,!0)}finally{a===A&&t.removeAttribute("id")}}}return N(e.replace(C,"$1"),t,i,s)}function V(){var i=[];function s(t,e){return i.push(t+" ")>v.cacheLength&&delete s[i.shift()],s[t+" "]=e}return s}function P(t){return t[A]=!0,t}function F(t){var e=x.createElement("fieldset");try{return!!t(e)}catch(t){return!1}finally{e.parentNode&&e.parentNode.removeChild(e)}}function mt(t,e){for(var i=t.split("|"),s=i.length;s--;)v.attrHandle[i[s]]=e}function ut(t,e){var i=e&&t,s=i&&1===t.nodeType&&1===e.nodeType&&t.sourceIndex-e.sourceIndex;if(s)return s;if(i)for(;i=i.nextSibling;)if(i===e)return-1;return t?1:-1}function gt(e){return function(t){return"form"in t?t.parentNode&&!1===t.disabled?"label"in t?"label"in t.parentNode?t.parentNode.disabled===e:t.disabled===e:t.isDisabled===e||t.isDisabled!==!e&&pt(t)===e:t.disabled===e:"label"in t&&t.disabled===e}}function M(a){return P(function(n){return n=+n,P(function(t,e){for(var i,s=a([],t.length,n),o=s.length;o--;)t[i=s[o]]&&(t[i]=!(e[i]=t[i]))})})}function bt(t){return t&&void 0!==t.getElementsByTagName&&t}for(t in p=D.support={},H=D.isXML=function(t){var e=t.namespaceURI,t=(t.ownerDocument||t).documentElement;return!at.test(e||t&&t.nodeName||"HTML")},_=D.setDocument=function(t){var t=t?t.ownerDocument||t:d;return t!=x&&9===t.nodeType&&t.documentElement&&(i=(x=t).documentElement,y=!H(x),d!=x&&(t=x.defaultView)&&t.top!==t&&(t.addEventListener?t.addEventListener("unload",B,!1):t.attachEvent&&t.attachEvent("onunload",B)),p.scope=F(function(t){return i.appendChild(t).appendChild(x.createElement("div")),void 0!==t.querySelectorAll&&!t.querySelectorAll(":scope fieldset div").length}),p.attributes=F(function(t){return t.className="i",!t.getAttribute("className")}),p.getElementsByTagName=F(function(t){return t.appendChild(x.createComment("")),!t.getElementsByTagName("*").length}),p.getElementsByClassName=E.test(x.getElementsByClassName),p.getById=F(function(t){return i.appendChild(t).id=A,!x.getElementsByName||!x.getElementsByName(A).length}),p.getById?(v.filter.ID=function(t){var e=t.replace(I,h);return function(t){return t.getAttribute("id")===e}},v.find.ID=function(t,e){if(void 0!==e.getElementById&&y)return(e=e.getElementById(t))?[e]:[]}):(v.filter.ID=function(t){var e=t.replace(I,h);return function(t){t=void 0!==t.getAttributeNode&&t.getAttributeNode("id");return t&&t.value===e}},v.find.ID=function(t,e){if(void 0!==e.getElementById&&y){var i,s,o,n=e.getElementById(t);if(n){if((i=n.getAttributeNode("id"))&&i.value===t)return[n];for(o=e.getElementsByName(t),s=0;n=o[s++];)if((i=n.getAttributeNode("id"))&&i.value===t)return[n]}return[]}}),v.find.TAG=p.getElementsByTagName?function(t,e){return void 0!==e.getElementsByTagName?e.getElementsByTagName(t):p.qsa?e.querySelectorAll(t):void 0}:function(t,e){var i,s=[],o=0,n=e.getElementsByTagName(t);if("*"!==t)return n;for(;i=n[o++];)1===i.nodeType&&s.push(i);return s},v.find.CLASS=p.getElementsByClassName&&function(t,e){if(void 0!==e.getElementsByClassName&&y)return e.getElementsByClassName(t)},s=[],u=[],(p.qsa=E.test(x.querySelectorAll))&&(F(function(t){var e;i.appendChild(t).innerHTML="<a id='"+A+"'></a><select id='"+A+"-\r\\' msallowcapture=''><option selected=''></option></select>",t.querySelectorAll("[msallowcapture^='']").length&&u.push("[*^$]="+a+"*(?:''|\"\")"),t.querySelectorAll("[selected]").length||u.push("\\["+a+"*(?:value|"+J+")"),t.querySelectorAll("[id~="+A+"-]").length||u.push("~="),(e=x.createElement("input")).setAttribute("name",""),t.appendChild(e),t.querySelectorAll("[name='']").length||u.push("\\["+a+"*name"+a+"*="+a+"*(?:''|\"\")"),t.querySelectorAll(":checked").length||u.push(":checked"),t.querySelectorAll("a#"+A+"+*").length||u.push(".#.+[+~]"),t.querySelectorAll("\\\f"),u.push("[\\r\\n\\f]")}),F(function(t){t.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var e=x.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),t.querySelectorAll("[name=d]").length&&u.push("name"+a+"*[*^$|!~]?="),2!==t.querySelectorAll(":enabled").length&&u.push(":enabled",":disabled"),i.appendChild(t).disabled=!0,2!==t.querySelectorAll(":disabled").length&&u.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),u.push(",.*:")})),(p.matchesSelector=E.test(o=i.matches||i.webkitMatchesSelector||i.mozMatchesSelector||i.oMatchesSelector||i.msMatchesSelector))&&F(function(t){p.disconnectedMatch=o.call(t,"*"),o.call(t,"[s!='']:x"),s.push("!=",Q)}),u=u.length&&new RegExp(u.join("|")),s=s.length&&new RegExp(s.join("|")),t=E.test(i.compareDocumentPosition),g=t||E.test(i.contains)?function(t,e){var i=9===t.nodeType?t.documentElement:t,e=e&&e.parentNode;return t===e||!(!e||1!==e.nodeType||!(i.contains?i.contains(e):t.compareDocumentPosition&&16&t.compareDocumentPosition(e)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},j=t?function(t,e){var i;return t===e?(c=!0,0):(i=!t.compareDocumentPosition-!e.compareDocumentPosition)||(1&(i=(t.ownerDocument||t)==(e.ownerDocument||e)?t.compareDocumentPosition(e):1)||!p.sortDetached&&e.compareDocumentPosition(t)===i?t==x||t.ownerDocument==d&&g(d,t)?-1:e==x||e.ownerDocument==d&&g(d,e)?1:r?f(r,t)-f(r,e):0:4&i?-1:1)}:function(t,e){if(t===e)return c=!0,0;var i,s=0,o=t.parentNode,n=e.parentNode,a=[t],l=[e];if(!o||!n)return t==x?-1:e==x?1:o?-1:n?1:r?f(r,t)-f(r,e):0;if(o===n)return ut(t,e);for(i=t;i=i.parentNode;)a.unshift(i);for(i=e;i=i.parentNode;)l.unshift(i);for(;a[s]===l[s];)s++;return s?ut(a[s],l[s]):a[s]==d?-1:l[s]==d?1:0}),x},D.matches=function(t,e){return D(t,null,null,e)},D.matchesSelector=function(t,e){if(_(t),p.matchesSelector&&y&&!b[e+" "]&&!(s&&s.test(e)||u&&u.test(e)))try{var i=o.call(t,e);if(i||p.disconnectedMatch||t.document&&11!==t.document.nodeType)return i}catch(t){b(e,!0)}return 0<D(e,x,null,[t]).length},D.contains=function(t,e){return(t.ownerDocument||t)!=x&&_(t),g(t,e)},D.attr=function(t,e){(t.ownerDocument||t)!=x&&_(t);var i=v.attrHandle[e.toLowerCase()],i=i&&q.call(v.attrHandle,e.toLowerCase())?i(t,e,!y):void 0;return void 0!==i?i:p.attributes||!y?t.getAttribute(e):(i=t.getAttributeNode(e))&&i.specified?i.value:null},D.escape=function(t){return(t+"").replace(ht,L)},D.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},D.uniqueSort=function(t){var e,i=[],s=0,o=0;if(c=!p.detectDuplicates,r=!p.sortStable&&t.slice(0),t.sort(j),c){for(;e=t[o++];)e===t[o]&&(s=i.push(o));for(;s--;)t.splice(i[s],1)}return r=null,t},n=D.getText=function(t){var e,i="",s=0,o=t.nodeType;if(o){if(1===o||9===o||11===o){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)i+=n(t)}else if(3===o||4===o)return t.nodeValue}else for(;e=t[s++];)i+=n(e);return i},(v=D.selectors={cacheLength:50,createPseudo:P,match:S,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(I,h),t[3]=(t[3]||t[4]||t[5]||"").replace(I,h),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||D.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&D.error(t[0]),t},PSEUDO:function(t){var e,i=!t[6]&&t[2];return S.CHILD.test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":i&&ot.test(i)&&(e=(e=m(i,!0))&&i.indexOf(")",i.length-e)-i.length)&&(t[0]=t[0].slice(0,e),t[2]=i.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(I,h).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=G[t+" "];return e||(e=new RegExp("(^|"+a+")"+t+"("+a+"|$)"))&&G(t,function(t){return e.test("string"==typeof t.className&&t.className||void 0!==t.getAttribute&&t.getAttribute("class")||"")})},ATTR:function(e,i,s){return function(t){t=D.attr(t,e);return null==t?"!="===i:!i||(t+="","="===i?t===s:"!="===i?t!==s:"^="===i?s&&0===t.indexOf(s):"*="===i?s&&-1<t.indexOf(s):"$="===i?s&&t.slice(-s.length)===s:"~="===i?-1<(" "+t.replace(tt," ")+" ").indexOf(s):"|="===i&&(t===s||t.slice(0,s.length+1)===s+"-"))}},CHILD:function(u,t,e,g,b){var C="nth"!==u.slice(0,3),f="last"!==u.slice(-4),S="of-type"===t;return 1===g&&0===b?function(t){return!!t.parentNode}:function(t,e,i){var s,o,n,a,l,r,c=C!=f?"nextSibling":"previousSibling",d=t.parentNode,h=S&&t.nodeName.toLowerCase(),p=!i&&!S,m=!1;if(d){if(C){for(;c;){for(a=t;a=a[c];)if(S?a.nodeName.toLowerCase()===h:1===a.nodeType)return!1;r=c="only"===u&&!r&&"nextSibling"}return!0}if(r=[f?d.firstChild:d.lastChild],f&&p){for(m=(l=(s=(o=(n=(a=d)[A]||(a[A]={}))[a.uniqueID]||(n[a.uniqueID]={}))[u]||[])[0]===T&&s[1])&&s[2],a=l&&d.childNodes[l];a=++l&&a&&a[c]||(m=l=0,r.pop());)if(1===a.nodeType&&++m&&a===t){o[u]=[T,l,m];break}}else if(!1===(m=p?l=(s=(o=(n=(a=t)[A]||(a[A]={}))[a.uniqueID]||(n[a.uniqueID]={}))[u]||[])[0]===T&&s[1]:m))for(;(a=++l&&a&&a[c]||(m=l=0,r.pop()))&&((S?a.nodeName.toLowerCase()!==h:1!==a.nodeType)||!++m||(p&&((o=(n=a[A]||(a[A]={}))[a.uniqueID]||(n[a.uniqueID]={}))[u]=[T,m]),a!==t)););return(m-=b)===g||m%g==0&&0<=m/g}}},PSEUDO:function(t,n){var e,a=v.pseudos[t]||v.setFilters[t.toLowerCase()]||D.error("unsupported pseudo: "+t);return a[A]?a(n):1<a.length?(e=[t,t,"",n],v.setFilters.hasOwnProperty(t.toLowerCase())?P(function(t,e){for(var i,s=a(t,n),o=s.length;o--;)t[i=f(t,s[o])]=!(e[i]=s[o])}):function(t){return a(t,0,e)}):a}},pseudos:{not:P(function(t){var s=[],o=[],l=O(t.replace(C,"$1"));return l[A]?P(function(t,e,i,s){for(var o,n=l(t,null,s,[]),a=t.length;a--;)(o=n[a])&&(t[a]=!(e[a]=o))}):function(t,e,i){return s[0]=t,l(s,null,i,o),s[0]=null,!o.pop()}}),has:P(function(e){return function(t){return 0<D(e,t).length}}),contains:P(function(e){return e=e.replace(I,h),function(t){return-1<(t.textContent||n(t)).indexOf(e)}}),lang:P(function(i){return nt.test(i||"")||D.error("unsupported lang: "+i),i=i.replace(I,h).toLowerCase(),function(t){var e;do{if(e=y?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(e=e.toLowerCase())===i||0===e.indexOf(i+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var e=U.location&&U.location.hash;return e&&e.slice(1)===t.id},root:function(t){return t===i},focus:function(t){return t===x.activeElement&&(!x.hasFocus||x.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:gt(!1),disabled:gt(!0),checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,!0===t.selected},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!v.pseudos.empty(t)},header:function(t){return rt.test(t.nodeName)},input:function(t){return lt.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(t=t.getAttribute("type"))||"text"===t.toLowerCase())},first:M(function(){return[0]}),last:M(function(t,e){return[e-1]}),eq:M(function(t,e,i){return[i<0?i+e:i]}),even:M(function(t,e){for(var i=0;i<e;i+=2)t.push(i);return t}),odd:M(function(t,e){for(var i=1;i<e;i+=2)t.push(i);return t}),lt:M(function(t,e,i){for(var s=i<0?i+e:e<i?e:i;0<=--s;)t.push(s);return t}),gt:M(function(t,e,i){for(var s=i<0?i+e:i;++s<e;)t.push(s);return t})}}).pseudos.nth=v.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})v.pseudos[t]=function(e){return function(t){return"input"===t.nodeName.toLowerCase()&&t.type===e}}(t);for(t in{submit:!0,reset:!0})v.pseudos[t]=function(i){return function(t){var e=t.nodeName.toLowerCase();return("input"===e||"button"===e)&&t.type===i}}(t);function Ct(){}function R(t){for(var e=0,i=t.length,s="";e<i;e++)s+=t[e].value;return s}function ft(a,t,e){var l=t.dir,r=t.next,c=r||l,d=e&&"parentNode"===c,h=$++;return t.first?function(t,e,i){for(;t=t[l];)if(1===t.nodeType||d)return a(t,e,i);return!1}:function(t,e,i){var s,o,n=[T,h];if(i){for(;t=t[l];)if((1===t.nodeType||d)&&a(t,e,i))return!0}else for(;t=t[l];)if(1===t.nodeType||d)if(o=(o=t[A]||(t[A]={}))[t.uniqueID]||(o[t.uniqueID]={}),r&&r===t.nodeName.toLowerCase())t=t[l]||t;else{if((s=o[c])&&s[0]===T&&s[1]===h)return n[2]=s[2];if((o[c]=n)[2]=a(t,e,i))return!0}return!1}}function St(o){return 1<o.length?function(t,e,i){for(var s=o.length;s--;)if(!o[s](t,e,i))return!1;return!0}:o[0]}function vt(t,e,i,s,o){for(var n,a=[],l=0,r=t.length,c=null!=e;l<r;l++)!(n=t[l])||i&&!i(n,s,o)||(a.push(n),c&&e.push(l));return a}function wt(m,u,g,b,C,t){return b&&!b[A]&&(b=wt(b)),C&&!C[A]&&(C=wt(C,t)),P(function(t,e,i,s){var o,n,a,l=[],r=[],c=e.length,d=t||function(t,e,i){for(var s=0,o=e.length;s<o;s++)D(t,e[s],i);return i}(u||"*",i.nodeType?[i]:i,[]),h=!m||!t&&u?d:vt(d,l,m,i,s),p=g?C||(t?m:c||b)?[]:e:h;if(g&&g(h,p,i,s),b)for(o=vt(p,r),b(o,[],i,s),n=o.length;n--;)(a=o[n])&&(p[r[n]]=!(h[r[n]]=a));if(t){if(C||m){if(C){for(o=[],n=p.length;n--;)(a=p[n])&&o.push(h[n]=a);C(null,p=[],o,s)}for(n=p.length;n--;)(a=p[n])&&-1<(o=C?f(t,a):l[n])&&(t[o]=!(e[o]=a))}}else p=vt(p===e?p.splice(c,p.length):p),C?C(null,e,p,s):k.apply(e,p)})}function _t(b,C){function t(t,e,i,s,o){var n,a,l,r=0,c="0",d=t&&[],h=[],p=w,m=t||S&&v.find.TAG("*",o),u=T+=null==p?1:Math.random()||.1,g=m.length;for(o&&(w=e==x||e||o);c!==g&&null!=(n=m[c]);c++){if(S&&n){for(a=0,e||n.ownerDocument==x||(_(n),i=!y);l=b[a++];)if(l(n,e||x,i)){s.push(n);break}o&&(T=u)}f&&((n=!l&&n)&&r--,t&&d.push(n))}if(r+=c,f&&c!==r){for(a=0;l=C[a++];)l(d,h,e,i);if(t){if(0<r)for(;c--;)d[c]||h[c]||(h[c]=K.call(s));h=vt(h)}k.apply(s,h),o&&!t&&0<h.length&&1<r+C.length&&D.uniqueSort(s)}return o&&(T=u,w=p),d}var f=0<C.length,S=0<b.length;return f?P(t):t}return Ct.prototype=v.filters=v.pseudos,v.setFilters=new Ct,m=D.tokenize=function(t,e){var i,s,o,n,a,l,r,c=z[t+" "];if(c)return e?0:c.slice(0);for(a=t,l=[],r=v.preFilter;a;){for(n in i&&!(s=et.exec(a))||(s&&(a=a.slice(s[0].length)||a),l.push(o=[])),i=!1,(s=it.exec(a))&&(i=s.shift(),o.push({value:i,type:s[0].replace(C," ")}),a=a.slice(i.length)),v.filter)!(s=S[n].exec(a))||r[n]&&!(s=r[n](s))||(i=s.shift(),o.push({value:i,type:n,matches:s}),a=a.slice(i.length));if(!i)break}return e?a.length:a?D.error(t):z(t,l).slice(0)},O=D.compile=function(t,e){var i,s=[],o=[],n=W[t+" "];if(!n){for(i=(e=e||m(t)).length;i--;)((n=function t(e){for(var s,i,o,n=e.length,a=v.relative[e[0].type],l=a||v.relative[" "],r=a?1:0,c=ft(function(t){return t===s},l,!0),d=ft(function(t){return-1<f(s,t)},l,!0),h=[function(t,e,i){return t=!a&&(i||e!==w)||((s=e).nodeType?c:d)(t,e,i),s=null,t}];r<n;r++)if(i=v.relative[e[r].type])h=[ft(St(h),i)];else{if((i=v.filter[e[r].type].apply(null,e[r].matches))[A]){for(o=++r;o<n&&!v.relative[e[o].type];o++);return wt(1<r&&St(h),1<r&&R(e.slice(0,r-1).concat({value:" "===e[r-2].type?"*":""})).replace(C,"$1"),i,r<o&&t(e.slice(r,o)),o<n&&t(e=e.slice(o)),o<n&&R(e))}h.push(i)}return St(h)}(e[i]))[A]?s:o).push(n);(n=W(t,_t(o,s))).selector=t}return n},N=D.select=function(t,e,i,s){var o,n,a,l,r,c="function"==typeof t&&t,d=!s&&m(t=c.selector||t);if(i=i||[],1===d.length){if(2<(n=d[0]=d[0].slice(0)).length&&"ID"===(a=n[0]).type&&9===e.nodeType&&y&&v.relative[n[1].type]){if(!(e=(v.find.ID(a.matches[0].replace(I,h),e)||[])[0]))return i;c&&(e=e.parentNode),t=t.slice(n.shift().value.length)}for(o=S.needsContext.test(t)?0:n.length;o--&&(a=n[o],!v.relative[l=a.type]);)if((r=v.find[l])&&(s=r(a.matches[0].replace(I,h),dt.test(n[0].type)&&bt(e.parentNode)||e))){if(n.splice(o,1),t=s.length&&R(n))break;return k.apply(i,s),i}}return(c||O(t,d))(s,e,!y,i,!e||dt.test(t)&&bt(e.parentNode)||e),i},p.sortStable=A.split("").sort(j).join("")===A,p.detectDuplicates=!!c,_(),p.sortDetached=F(function(t){return 1&t.compareDocumentPosition(x.createElement("fieldset"))}),F(function(t){return t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href")})||mt("type|href|height|width",function(t,e,i){if(!i)return t.getAttribute(e,"type"===e.toLowerCase()?1:2)}),p.attributes&&F(function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")})||mt("value",function(t,e,i){if(!i&&"input"===t.nodeName.toLowerCase())return t.defaultValue}),F(function(t){return null==t.getAttribute("disabled")})||mt(J,function(t,e,i){if(!i)return!0===t[e]?e.toLowerCase():(i=t.getAttributeNode(e))&&i.specified?i.value:null}),D}(w),X=(x.find=t,x.expr=t.selectors,x.expr[":"]=x.expr.pseudos,x.uniqueSort=x.unique=t.uniqueSort,x.text=t.getText,x.isXMLDoc=t.isXML,x.contains=t.contains,x.escapeSelector=t.escape,x.expr.match.needsContext);function r(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()}var J=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function Z(t,i,s){return f(i)?x.grep(t,function(t,e){return!!i.call(t,e,t)!==s}):i.nodeType?x.grep(t,function(t){return t===i!==s}):"string"!=typeof i?x.grep(t,function(t){return-1<O.call(i,t)!==s}):x.filter(i,t,s)}x.filter=function(t,e,i){var s=e[0];return i&&(t=":not("+t+")"),1===e.length&&1===s.nodeType?x.find.matchesSelector(s,t)?[s]:[]:x.find.matches(t,x.grep(e,function(t){return 1===t.nodeType}))},x.fn.extend({find:function(t){var e,i,s=this.length,o=this;if("string"!=typeof t)return this.pushStack(x(t).filter(function(){for(e=0;e<s;e++)if(x.contains(o[e],this))return!0}));for(i=this.pushStack([]),e=0;e<s;e++)x.find(t,o[e],i);return 1<s?x.uniqueSort(i):i},filter:function(t){return this.pushStack(Z(this,t||[],!1))},not:function(t){return this.pushStack(Z(this,t||[],!0))},is:function(t){return!!Z(this,"string"==typeof t&&X.test(t)?x(t):t||[],!1).length}});var Q,tt=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/,et=((x.fn.init=function(t,e,i){if(t){if(i=i||Q,"string"!=typeof t)return t.nodeType?(this[0]=t,this.length=1,this):f(t)?void 0!==i.ready?i.ready(t):t(x):x.makeArray(t,this);if(!(s="<"===t[0]&&">"===t[t.length-1]&&3<=t.length?[null,t,null]:tt.exec(t))||!s[1]&&e)return(!e||e.jquery?e||i:this.constructor(e)).find(t);if(s[1]){if(e=e instanceof x?e[0]:e,x.merge(this,x.parseHTML(s[1],e&&e.nodeType?e.ownerDocument||e:_,!0)),J.test(s[1])&&x.isPlainObject(e))for(var s in e)f(this[s])?this[s](e[s]):this.attr(s,e[s])}else(i=_.getElementById(s[2]))&&(this[0]=i,this.length=1)}return this}).prototype=x.fn,Q=x(_),/^(?:parents|prev(?:Until|All))/),it={children:!0,contents:!0,next:!0,prev:!0};function st(t,e){for(;(t=t[e])&&1!==t.nodeType;);return t}x.fn.extend({has:function(t){var e=x(t,this),i=e.length;return this.filter(function(){for(var t=0;t<i;t++)if(x.contains(this,e[t]))return!0})},closest:function(t,e){var i,s=0,o=this.length,n=[],a="string"!=typeof t&&x(t);if(!X.test(t))for(;s<o;s++)for(i=this[s];i&&i!==e;i=i.parentNode)if(i.nodeType<11&&(a?-1<a.index(i):1===i.nodeType&&x.find.matchesSelector(i,t))){n.push(i);break}return this.pushStack(1<n.length?x.uniqueSort(n):n)},index:function(t){return t?"string"==typeof t?O.call(x(t),this[0]):O.call(this,t.jquery?t[0]:t):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(x.uniqueSort(x.merge(this.get(),x(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),x.each({parent:function(t){t=t.parentNode;return t&&11!==t.nodeType?t:null},parents:function(t){return s(t,"parentNode")},parentsUntil:function(t,e,i){return s(t,"parentNode",i)},next:function(t){return st(t,"nextSibling")},prev:function(t){return st(t,"previousSibling")},nextAll:function(t){return s(t,"nextSibling")},prevAll:function(t){return s(t,"previousSibling")},nextUntil:function(t,e,i){return s(t,"nextSibling",i)},prevUntil:function(t,e,i){return s(t,"previousSibling",i)},siblings:function(t){return Y((t.parentNode||{}).firstChild,t)},children:function(t){return Y(t.firstChild)},contents:function(t){return null!=t.contentDocument&&L(t.contentDocument)?t.contentDocument:(r(t,"template")&&(t=t.content||t),x.merge([],t.childNodes))}},function(s,o){x.fn[s]=function(t,e){var i=x.map(this,o,t);return(e="Until"!==s.slice(-5)?t:e)&&"string"==typeof e&&(i=x.filter(e,i)),1<this.length&&(it[s]||x.uniqueSort(i),et.test(s)&&i.reverse()),this.pushStack(i)}});var y=/[^\x20\t\r\n\f]+/g;function d(t){return t}function ot(t){throw t}function nt(t,e,i,s){var o;try{t&&f(o=t.promise)?o.call(t).done(e).fail(i):t&&f(o=t.then)?o.call(t,e,i):e.apply(void 0,[t].slice(s))}catch(t){i.apply(void 0,[t])}}x.Callbacks=function(s){var t,i;s="string"==typeof s?(t=s,i={},x.each(t.match(y)||[],function(t,e){i[e]=!0}),i):x.extend({},s);function o(){for(l=l||s.once,a=n=!0;c.length;d=-1)for(e=c.shift();++d<r.length;)!1===r[d].apply(e[0],e[1])&&s.stopOnFalse&&(d=r.length,e=!1);s.memory||(e=!1),n=!1,l&&(r=e?[]:"")}var n,e,a,l,r=[],c=[],d=-1,h={add:function(){return r&&(e&&!n&&(d=r.length-1,c.push(e)),function i(t){x.each(t,function(t,e){f(e)?s.unique&&h.has(e)||r.push(e):e&&e.length&&"string"!==u(e)&&i(e)})}(arguments),e&&!n&&o()),this},remove:function(){return x.each(arguments,function(t,e){for(var i;-1<(i=x.inArray(e,r,i));)r.splice(i,1),i<=d&&d--}),this},has:function(t){return t?-1<x.inArray(t,r):0<r.length},empty:function(){return r=r&&[],this},disable:function(){return l=c=[],r=e="",this},disabled:function(){return!r},lock:function(){return l=c=[],e||n||(r=e=""),this},locked:function(){return!!l},fireWith:function(t,e){return l||(e=[t,(e=e||[]).slice?e.slice():e],c.push(e),n||o()),this},fire:function(){return h.fireWith(this,arguments),this},fired:function(){return!!a}};return h},x.extend({Deferred:function(t){var n=[["notify","progress",x.Callbacks("memory"),x.Callbacks("memory"),2],["resolve","done",x.Callbacks("once memory"),x.Callbacks("once memory"),0,"resolved"],["reject","fail",x.Callbacks("once memory"),x.Callbacks("once memory"),1,"rejected"]],o="pending",a={state:function(){return o},always:function(){return l.done(arguments).fail(arguments),this},catch:function(t){return a.then(null,t)},pipe:function(){var o=arguments;return x.Deferred(function(s){x.each(n,function(t,e){var i=f(o[e[4]])&&o[e[4]];l[e[1]](function(){var t=i&&i.apply(this,arguments);t&&f(t.promise)?t.promise().progress(s.notify).done(s.resolve).fail(s.reject):s[e[0]+"With"](this,i?[t]:arguments)})}),o=null}).promise()},then:function(e,i,s){var r=0;function c(o,n,a,l){return function(){function t(){var t,e;if(!(o<r)){if((t=a.apply(i,s))===n.promise())throw new TypeError("Thenable self-resolution");e=t&&("object"==typeof t||"function"==typeof t)&&t.then,f(e)?l?e.call(t,c(r,n,d,l),c(r,n,ot,l)):(r++,e.call(t,c(r,n,d,l),c(r,n,ot,l),c(r,n,d,n.notifyWith))):(a!==d&&(i=void 0,s=[t]),(l||n.resolveWith)(i,s))}}var i=this,s=arguments,e=l?t:function(){try{t()}catch(t){x.Deferred.exceptionHook&&x.Deferred.exceptionHook(t,e.stackTrace),r<=o+1&&(a!==ot&&(i=void 0,s=[t]),n.rejectWith(i,s))}};o?e():(x.Deferred.getStackHook&&(e.stackTrace=x.Deferred.getStackHook()),w.setTimeout(e))}}return x.Deferred(function(t){n[0][3].add(c(0,t,f(s)?s:d,t.notifyWith)),n[1][3].add(c(0,t,f(e)?e:d)),n[2][3].add(c(0,t,f(i)?i:ot))}).promise()},promise:function(t){return null!=t?x.extend(t,a):a}},l={};return x.each(n,function(t,e){var i=e[2],s=e[5];a[e[1]]=i.add,s&&i.add(function(){o=s},n[3-t][2].disable,n[3-t][3].disable,n[0][2].lock,n[0][3].lock),i.add(e[3].fire),l[e[0]]=function(){return l[e[0]+"With"](this===l?void 0:this,arguments),this},l[e[0]+"With"]=i.fireWith}),a.promise(l),t&&t.call(l,l),l},when:function(t){function e(e){return function(t){o[e]=this,n[e]=1<arguments.length?l.call(arguments):t,--i||a.resolveWith(o,n)}}var i=arguments.length,s=i,o=Array(s),n=l.call(arguments),a=x.Deferred();if(i<=1&&(nt(t,a.done(e(s)).resolve,a.reject,!i),"pending"===a.state()||f(n[s]&&n[s].then)))return a.then();for(;s--;)nt(n[s],e(s),a.reject);return a.promise()}});var at=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/,lt=(x.Deferred.exceptionHook=function(t,e){w.console&&w.console.warn&&t&&at.test(t.name)&&w.console.warn("jQuery.Deferred exception: "+t.message,t.stack,e)},x.readyException=function(t){w.setTimeout(function(){throw t})},x.Deferred());function rt(){_.removeEventListener("DOMContentLoaded",rt),w.removeEventListener("load",rt),x.ready()}x.fn.ready=function(t){return lt.then(t).catch(function(t){x.readyException(t)}),this},x.extend({isReady:!1,readyWait:1,ready:function(t){(!0===t?--x.readyWait:x.isReady)||(x.isReady=!0)!==t&&0<--x.readyWait||lt.resolveWith(_,[x])}}),x.ready.then=lt.then,"complete"===_.readyState||"loading"!==_.readyState&&!_.documentElement.doScroll?w.setTimeout(x.ready):(_.addEventListener("DOMContentLoaded",rt),w.addEventListener("load",rt));function h(t,e,i,s,o,n,a){var l=0,r=t.length,c=null==i;if("object"===u(i))for(l in o=!0,i)h(t,e,l,i[l],!0,n,a);else if(void 0!==s&&(o=!0,f(s)||(a=!0),e=c?a?(e.call(t,s),null):(c=e,function(t,e,i){return c.call(x(t),i)}):e))for(;l<r;l++)e(t[l],i,a?s:s.call(t[l],l,e(t[l],i)));return o?t:c?e.call(t):r?e(t[0],i):n}var ct=/^-ms-/,dt=/-([a-z])/g;function ht(t,e){return e.toUpperCase()}function S(t){return t.replace(ct,"ms-").replace(dt,ht)}function C(t){return 1===t.nodeType||9===t.nodeType||!+t.nodeType}function pt(){this.expando=x.expando+pt.uid++}pt.uid=1,pt.prototype={cache:function(t){var e=t[this.expando];return e||(e={},C(t)&&(t.nodeType?t[this.expando]=e:Object.defineProperty(t,this.expando,{value:e,configurable:!0}))),e},set:function(t,e,i){var s,o=this.cache(t);if("string"==typeof e)o[S(e)]=i;else for(s in e)o[S(s)]=e[s];return o},get:function(t,e){return void 0===e?this.cache(t):t[this.expando]&&t[this.expando][S(e)]},access:function(t,e,i){return void 0===e||e&&"string"==typeof e&&void 0===i?this.get(t,e):(this.set(t,e,i),void 0!==i?i:e)},remove:function(t,e){var i,s=t[this.expando];if(void 0!==s){if(void 0!==e){i=(e=Array.isArray(e)?e.map(S):(e=S(e))in s?[e]:e.match(y)||[]).length;for(;i--;)delete s[e[i]]}void 0!==e&&!x.isEmptyObject(s)||(t.nodeType?t[this.expando]=void 0:delete t[this.expando])}},hasData:function(t){t=t[this.expando];return void 0!==t&&!x.isEmptyObject(t)}};var v=new pt,c=new pt,mt=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,ut=/[A-Z]/g;function gt(t,e,i){var s,o;if(void 0===i&&1===t.nodeType)if(s="data-"+e.replace(ut,"-$&").toLowerCase(),"string"==typeof(i=t.getAttribute(s))){try{i="true"===(o=i)||"false"!==o&&("null"===o?null:o===+o+""?+o:mt.test(o)?JSON.parse(o):o)}catch(t){}c.set(t,e,i)}else i=void 0;return i}x.extend({hasData:function(t){return c.hasData(t)||v.hasData(t)},data:function(t,e,i){return c.access(t,e,i)},removeData:function(t,e){c.remove(t,e)},_data:function(t,e,i){return v.access(t,e,i)},_removeData:function(t,e){v.remove(t,e)}}),x.fn.extend({data:function(i,t){var e,s,o,n=this[0],a=n&&n.attributes;if(void 0!==i)return"object"==typeof i?this.each(function(){c.set(this,i)}):h(this,function(t){var e;if(n&&void 0===t)return void 0!==(e=c.get(n,i))||void 0!==(e=gt(n,i))?e:void 0;this.each(function(){c.set(this,i,t)})},null,t,1<arguments.length,null,!0);if(this.length&&(o=c.get(n),1===n.nodeType&&!v.get(n,"hasDataAttrs"))){for(e=a.length;e--;)a[e]&&0===(s=a[e].name).indexOf("data-")&&(s=S(s.slice(5)),gt(n,s,o[s]));v.set(n,"hasDataAttrs",!0)}return o},removeData:function(t){return this.each(function(){c.remove(this,t)})}}),x.extend({queue:function(t,e,i){var s;if(t)return s=v.get(t,e=(e||"fx")+"queue"),i&&(!s||Array.isArray(i)?s=v.access(t,e,x.makeArray(i)):s.push(i)),s||[]},dequeue:function(t,e){e=e||"fx";var i=x.queue(t,e),s=i.length,o=i.shift(),n=x._queueHooks(t,e);"inprogress"===o&&(o=i.shift(),s--),o&&("fx"===e&&i.unshift("inprogress"),delete n.stop,o.call(t,function(){x.dequeue(t,e)},n)),!s&&n&&n.empty.fire()},_queueHooks:function(t,e){var i=e+"queueHooks";return v.get(t,i)||v.access(t,i,{empty:x.Callbacks("once memory").add(function(){v.remove(t,[e+"queue",i])})})}}),x.fn.extend({queue:function(e,i){var t=2;return"string"!=typeof e&&(i=e,e="fx",t--),arguments.length<t?x.queue(this[0],e):void 0===i?this:this.each(function(){var t=x.queue(this,e,i);x._queueHooks(this,e),"fx"===e&&"inprogress"!==t[0]&&x.dequeue(this,e)})},dequeue:function(t){return this.each(function(){x.dequeue(this,t)})},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){function i(){--o||n.resolveWith(a,[a])}var s,o=1,n=x.Deferred(),a=this,l=this.length;for("string"!=typeof t&&(e=t,t=void 0),t=t||"fx";l--;)(s=v.get(a[l],t+"queueHooks"))&&s.empty&&(o++,s.empty.add(i));return i(),n.promise(e)}});function bt(t,e){return"none"===(t=e||t).style.display||""===t.style.display&&T(t)&&"none"===x.css(t,"display")}var t=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,Ct=new RegExp("^(?:([+-])=|)("+t+")([a-z%]*)$","i"),p=["Top","Right","Bottom","Left"],A=_.documentElement,T=function(t){return x.contains(t.ownerDocument,t)},ft={composed:!0};A.getRootNode&&(T=function(t){return x.contains(t.ownerDocument,t)||t.getRootNode(ft)===t.ownerDocument});function St(t,e,i,s){var o,n,a=20,l=s?function(){return s.cur()}:function(){return x.css(t,e,"")},r=l(),c=i&&i[3]||(x.cssNumber[e]?"":"px"),d=t.nodeType&&(x.cssNumber[e]||"px"!==c&&+r)&&Ct.exec(x.css(t,e));if(d&&d[3]!==c){for(c=c||d[3],d=+(r/=2)||1;a--;)x.style(t,e,d+c),(1-n)*(1-(n=l()/r||.5))<=0&&(a=0),d/=n;x.style(t,e,(d*=2)+c),i=i||[]}return i&&(d=+d||+r||0,o=i[1]?d+(i[1]+1)*i[2]:+i[2],s&&(s.unit=c,s.start=d,s.end=o)),o}var vt={};function k(t,e){for(var i,s,o,n,a,l=[],r=0,c=t.length;r<c;r++)(s=t[r]).style&&(i=s.style.display,e?("none"===i&&(l[r]=v.get(s,"display")||null,l[r]||(s.style.display="")),""===s.style.display&&bt(s)&&(l[r]=(a=n=void 0,n=(o=s).ownerDocument,o=o.nodeName,(a=vt[o])||(n=n.body.appendChild(n.createElement(o)),a=x.css(n,"display"),n.parentNode.removeChild(n),vt[o]=a="none"===a?"block":a),a))):"none"!==i&&(l[r]="none",v.set(s,"display",i)));for(r=0;r<c;r++)null!=l[r]&&(t[r].style.display=l[r]);return t}x.fn.extend({show:function(){return k(this,!0)},hide:function(){return k(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each(function(){bt(this)?x(this).show():x(this).hide()})}});var wt=/^(?:checkbox|radio)$/i,_t=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,xt=/^$|^module$|\/(?:java|ecma)script/i,E=(P=_.createDocumentFragment().appendChild(_.createElement("div")),(a=_.createElement("input")).setAttribute("type","radio"),a.setAttribute("checked","checked"),a.setAttribute("name","t"),P.appendChild(a),b.checkClone=P.cloneNode(!0).cloneNode(!0).lastChild.checked,P.innerHTML="<textarea>x</textarea>",b.noCloneChecked=!!P.cloneNode(!0).lastChild.defaultValue,P.innerHTML="<option></option>",b.option=!!P.lastChild,{thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]});function I(t,e){var i=void 0!==t.getElementsByTagName?t.getElementsByTagName(e||"*"):void 0!==t.querySelectorAll?t.querySelectorAll(e||"*"):[];return void 0===e||e&&r(t,e)?x.merge([t],i):i}function yt(t,e){for(var i=0,s=t.length;i<s;i++)v.set(t[i],"globalEval",!e||v.get(e[i],"globalEval"))}E.tbody=E.tfoot=E.colgroup=E.caption=E.thead,E.th=E.td,b.option||(E.optgroup=E.option=[1,"<select multiple='multiple'>","</select>"]);var At=/<|&#?\w+;/;function Tt(t,e,i,s,o){for(var n,a,l,r,c,d=e.createDocumentFragment(),h=[],p=0,m=t.length;p<m;p++)if((n=t[p])||0===n)if("object"===u(n))x.merge(h,n.nodeType?[n]:n);else if(At.test(n)){for(a=a||d.appendChild(e.createElement("div")),l=(_t.exec(n)||["",""])[1].toLowerCase(),l=E[l]||E._default,a.innerHTML=l[1]+x.htmlPrefilter(n)+l[2],c=l[0];c--;)a=a.lastChild;x.merge(h,a.childNodes),(a=d.firstChild).textContent=""}else h.push(e.createTextNode(n));for(d.textContent="",p=0;n=h[p++];)if(s&&-1<x.inArray(n,s))o&&o.push(n);else if(r=T(n),a=I(d.appendChild(n),"script"),r&&yt(a),i)for(c=0;n=a[c++];)xt.test(n.type||"")&&i.push(n);return d}var kt=/^key/,Et=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,It=/^([^.]*)(?:\.(.+)|)/;function i(){return!0}function m(){return!1}function Dt(t,e){return t===function(){try{return _.activeElement}catch(t){}}()==("focus"===e)}function Vt(t,e,i,s,o,n){var a,l;if("object"==typeof e){for(l in"string"!=typeof i&&(s=s||i,i=void 0),e)Vt(t,l,i,s,e[l],n);return t}if(null==s&&null==o?(o=i,s=i=void 0):null==o&&("string"==typeof i?(o=s,s=void 0):(o=s,s=i,i=void 0)),!1===o)o=m;else if(!o)return t;return 1===n&&(a=o,(o=function(t){return x().off(t),a.apply(this,arguments)}).guid=a.guid||(a.guid=x.guid++)),t.each(function(){x.event.add(this,e,o,s,i)})}function Pt(t,o,n){n?(v.set(t,o,!1),x.event.add(t,o,{namespace:!1,handler:function(t){var e,i,s=v.get(this,o);if(1&t.isTrigger&&this[o]){if(s.length)(x.event.special[o]||{}).delegateType&&t.stopPropagation();else if(s=l.call(arguments),v.set(this,o,s),e=n(this,o),this[o](),s!==(i=v.get(this,o))||e?v.set(this,o,!1):i={},s!==i)return t.stopImmediatePropagation(),t.preventDefault(),i.value}else s.length&&(v.set(this,o,{value:x.event.trigger(x.extend(s[0],x.Event.prototype),s.slice(1),this)}),t.stopImmediatePropagation())}})):void 0===v.get(t,o)&&x.event.add(t,o,i)}x.event={global:{},add:function(e,t,i,s,o){var n,a,l,r,c,d,h,p,m,u=v.get(e);if(C(e))for(i.handler&&(i=(n=i).handler,o=n.selector),o&&x.find.matchesSelector(A,o),i.guid||(i.guid=x.guid++),l=(l=u.events)||(u.events=Object.create(null)),a=(a=u.handle)||(u.handle=function(t){return void 0!==x&&x.event.triggered!==t.type?x.event.dispatch.apply(e,arguments):void 0}),r=(t=(t||"").match(y)||[""]).length;r--;)h=m=(p=It.exec(t[r])||[])[1],p=(p[2]||"").split(".").sort(),h&&(c=x.event.special[h]||{},h=(o?c.delegateType:c.bindType)||h,c=x.event.special[h]||{},m=x.extend({type:h,origType:m,data:s,handler:i,guid:i.guid,selector:o,needsContext:o&&x.expr.match.needsContext.test(o),namespace:p.join(".")},n),(d=l[h])||((d=l[h]=[]).delegateCount=0,c.setup&&!1!==c.setup.call(e,s,p,a)||e.addEventListener&&e.addEventListener(h,a)),c.add&&(c.add.call(e,m),m.handler.guid||(m.handler.guid=i.guid)),o?d.splice(d.delegateCount++,0,m):d.push(m),x.event.global[h]=!0)},remove:function(t,e,i,s,o){var n,a,l,r,c,d,h,p,m,u,g,b=v.hasData(t)&&v.get(t);if(b&&(r=b.events)){for(c=(e=(e||"").match(y)||[""]).length;c--;)if(m=g=(l=It.exec(e[c])||[])[1],u=(l[2]||"").split(".").sort(),m){for(h=x.event.special[m]||{},p=r[m=(s?h.delegateType:h.bindType)||m]||[],l=l[2]&&new RegExp("(^|\\.)"+u.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=n=p.length;n--;)d=p[n],!o&&g!==d.origType||i&&i.guid!==d.guid||l&&!l.test(d.namespace)||s&&s!==d.selector&&("**"!==s||!d.selector)||(p.splice(n,1),d.selector&&p.delegateCount--,h.remove&&h.remove.call(t,d));a&&!p.length&&(h.teardown&&!1!==h.teardown.call(t,u,b.handle)||x.removeEvent(t,m,b.handle),delete r[m])}else for(m in r)x.event.remove(t,m+e[c],i,s,!0);x.isEmptyObject(r)&&v.remove(t,"handle events")}},dispatch:function(t){var e,i,s,o,n,a=new Array(arguments.length),l=x.event.fix(t),t=(v.get(this,"events")||Object.create(null))[l.type]||[],r=x.event.special[l.type]||{};for(a[0]=l,e=1;e<arguments.length;e++)a[e]=arguments[e];if(l.delegateTarget=this,!r.preDispatch||!1!==r.preDispatch.call(this,l)){for(n=x.event.handlers.call(this,l,t),e=0;(s=n[e++])&&!l.isPropagationStopped();)for(l.currentTarget=s.elem,i=0;(o=s.handlers[i++])&&!l.isImmediatePropagationStopped();)l.rnamespace&&!1!==o.namespace&&!l.rnamespace.test(o.namespace)||(l.handleObj=o,l.data=o.data,void 0!==(o=((x.event.special[o.origType]||{}).handle||o.handler).apply(s.elem,a))&&!1===(l.result=o)&&(l.preventDefault(),l.stopPropagation()));return r.postDispatch&&r.postDispatch.call(this,l),l.result}},handlers:function(t,e){var i,s,o,n,a,l=[],r=e.delegateCount,c=t.target;if(r&&c.nodeType&&!("click"===t.type&&1<=t.button))for(;c!==this;c=c.parentNode||this)if(1===c.nodeType&&("click"!==t.type||!0!==c.disabled)){for(n=[],a={},i=0;i<r;i++)void 0===a[o=(s=e[i]).selector+" "]&&(a[o]=s.needsContext?-1<x(o,this).index(c):x.find(o,this,null,[c]).length),a[o]&&n.push(s);n.length&&l.push({elem:c,handlers:n})}return c=this,r<e.length&&l.push({elem:c,handlers:e.slice(r)}),l},addProp:function(e,t){Object.defineProperty(x.Event.prototype,e,{enumerable:!0,configurable:!0,get:f(t)?function(){if(this.originalEvent)return t(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[e]},set:function(t){Object.defineProperty(this,e,{enumerable:!0,configurable:!0,writable:!0,value:t})}})},fix:function(t){return t[x.expando]?t:new x.Event(t)},special:{load:{noBubble:!0},click:{setup:function(t){t=this||t;return wt.test(t.type)&&t.click&&r(t,"input")&&Pt(t,"click",i),!1},trigger:function(t){t=this||t;return wt.test(t.type)&&t.click&&r(t,"input")&&Pt(t,"click"),!0},_default:function(t){t=t.target;return wt.test(t.type)&&t.click&&r(t,"input")&&v.get(t,"click")||r(t,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}}},x.removeEvent=function(t,e,i){t.removeEventListener&&t.removeEventListener(e,i)},x.Event=function(t,e){if(!(this instanceof x.Event))return new x.Event(t,e);t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&!1===t.returnValue?i:m,this.target=t.target&&3===t.target.nodeType?t.target.parentNode:t.target,this.currentTarget=t.currentTarget,this.relatedTarget=t.relatedTarget):this.type=t,e&&x.extend(this,e),this.timeStamp=t&&t.timeStamp||Date.now(),this[x.expando]=!0},x.Event.prototype={constructor:x.Event,isDefaultPrevented:m,isPropagationStopped:m,isImmediatePropagationStopped:m,isSimulated:!1,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=i,t&&!this.isSimulated&&t.preventDefault()},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=i,t&&!this.isSimulated&&t.stopPropagation()},stopImmediatePropagation:function(){var t=this.originalEvent;this.isImmediatePropagationStopped=i,t&&!this.isSimulated&&t.stopImmediatePropagation(),this.stopPropagation()}},x.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(t){var e=t.button;return null==t.which&&kt.test(t.type)?null!=t.charCode?t.charCode:t.keyCode:!t.which&&void 0!==e&&Et.test(t.type)?1&e?1:2&e?3:4&e?2:0:t.which}},x.event.addProp),x.each({focus:"focusin",blur:"focusout"},function(t,e){x.event.special[t]={setup:function(){return Pt(this,t,Dt),!1},trigger:function(){return Pt(this,t),!0},delegateType:e}}),x.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(t,o){x.event.special[t]={delegateType:o,bindType:o,handle:function(t){var e,i=t.relatedTarget,s=t.handleObj;return i&&(i===this||x.contains(this,i))||(t.type=s.origType,e=s.handler.apply(this,arguments),t.type=o),e}}}),x.fn.extend({on:function(t,e,i,s){return Vt(this,t,e,i,s)},one:function(t,e,i,s){return Vt(this,t,e,i,s,1)},off:function(t,e,i){var s,o;if(t&&t.preventDefault&&t.handleObj)s=t.handleObj,x(t.delegateTarget).off(s.namespace?s.origType+"."+s.namespace:s.origType,s.selector,s.handler);else{if("object"!=typeof t)return!1!==e&&"function"!=typeof e||(i=e,e=void 0),!1===i&&(i=m),this.each(function(){x.event.remove(this,t,i,e)});for(o in t)this.off(o,e,t[o])}return this}});var Ft=/<script|<style|<link/i,Mt=/checked\s*(?:[^=]|=\s*.checked.)/i,Rt=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function Ut(t,e){return r(t,"table")&&r(11!==e.nodeType?e:e.firstChild,"tr")&&x(t).children("tbody")[0]||t}function Lt(t){return t.type=(null!==t.getAttribute("type"))+"/"+t.type,t}function Bt(t){return"true/"===(t.type||"").slice(0,5)?t.type=t.type.slice(5):t.removeAttribute("type"),t}function Ht(t,e){var i,s,o,n;if(1===e.nodeType){if(v.hasData(t)&&(n=v.get(t).events))for(o in v.remove(e,"handle events"),n)for(i=0,s=n[o].length;i<s;i++)x.event.add(e,o,n[o][i]);c.hasData(t)&&(t=c.access(t),t=x.extend({},t),c.set(e,t))}}function D(i,s,o,n){s=B(s);var t,e,a,l,r,c,d=0,h=i.length,p=h-1,m=s[0],u=f(m);if(u||1<h&&"string"==typeof m&&!b.checkClone&&Mt.test(m))return i.each(function(t){var e=i.eq(t);u&&(s[0]=m.call(this,t,e.html())),D(e,s,o,n)});if(h&&(e=(t=Tt(s,i[0].ownerDocument,!1,i,n)).firstChild,1===t.childNodes.length&&(t=e),e||n)){for(l=(a=x.map(I(t,"script"),Lt)).length;d<h;d++)r=t,d!==p&&(r=x.clone(r,!0,!0),l&&x.merge(a,I(r,"script"))),o.call(i[d],r,d);if(l)for(c=a[a.length-1].ownerDocument,x.map(a,Bt),d=0;d<l;d++)r=a[d],xt.test(r.type||"")&&!v.access(r,"globalEval")&&x.contains(c,r)&&(r.src&&"module"!==(r.type||"").toLowerCase()?x._evalUrl&&!r.noModule&&x._evalUrl(r.src,{nonce:r.nonce||r.getAttribute("nonce")},c):q(r.textContent.replace(Rt,""),r,c))}return i}function Ot(t,e,i){for(var s,o=e?x.filter(e,t):t,n=0;null!=(s=o[n]);n++)i||1!==s.nodeType||x.cleanData(I(s)),s.parentNode&&(i&&T(s)&&yt(I(s,"script")),s.parentNode.removeChild(s));return t}x.extend({htmlPrefilter:function(t){return t},clone:function(t,e,i){var s,o,n,a,l,r,c,d=t.cloneNode(!0),h=T(t);if(!(b.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||x.isXMLDoc(t)))for(a=I(d),s=0,o=(n=I(t)).length;s<o;s++)l=n[s],r=a[s],c=void 0,"input"===(c=r.nodeName.toLowerCase())&&wt.test(l.type)?r.checked=l.checked:"input"!==c&&"textarea"!==c||(r.defaultValue=l.defaultValue);if(e)if(i)for(n=n||I(t),a=a||I(d),s=0,o=n.length;s<o;s++)Ht(n[s],a[s]);else Ht(t,d);return 0<(a=I(d,"script")).length&&yt(a,!h&&I(t,"script")),d},cleanData:function(t){for(var e,i,s,o=x.event.special,n=0;void 0!==(i=t[n]);n++)if(C(i)){if(e=i[v.expando]){if(e.events)for(s in e.events)o[s]?x.event.remove(i,s):x.removeEvent(i,s,e.handle);i[v.expando]=void 0}i[c.expando]&&(i[c.expando]=void 0)}}}),x.fn.extend({detach:function(t){return Ot(this,t,!0)},remove:function(t){return Ot(this,t)},text:function(t){return h(this,function(t){return void 0===t?x.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=t)})},null,t,arguments.length)},append:function(){return D(this,arguments,function(t){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||Ut(this,t).appendChild(t)})},prepend:function(){return D(this,arguments,function(t){var e;1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(e=Ut(this,t)).insertBefore(t,e.firstChild)})},before:function(){return D(this,arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this)})},after:function(){return D(this,arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)})},empty:function(){for(var t,e=0;null!=(t=this[e]);e++)1===t.nodeType&&(x.cleanData(I(t,!1)),t.textContent="");return this},clone:function(t,e){return t=null!=t&&t,e=null==e?t:e,this.map(function(){return x.clone(this,t,e)})},html:function(t){return h(this,function(t){var e=this[0]||{},i=0,s=this.length;if(void 0===t&&1===e.nodeType)return e.innerHTML;if("string"==typeof t&&!Ft.test(t)&&!E[(_t.exec(t)||["",""])[1].toLowerCase()]){t=x.htmlPrefilter(t);try{for(;i<s;i++)1===(e=this[i]||{}).nodeType&&(x.cleanData(I(e,!1)),e.innerHTML=t);e=0}catch(t){}}e&&this.empty().append(t)},null,t,arguments.length)},replaceWith:function(){var i=[];return D(this,arguments,function(t){var e=this.parentNode;x.inArray(this,i)<0&&(x.cleanData(I(this)),e&&e.replaceChild(t,this))},i)}}),x.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(t,a){x.fn[t]=function(t){for(var e,i=[],s=x(t),o=s.length-1,n=0;n<=o;n++)e=n===o?this:this.clone(!0),x(s[n])[a](e),H.apply(i,e.get());return this.pushStack(i)}});function Nt(t){var e=t.ownerDocument.defaultView;return(e=e&&e.opener?e:w).getComputedStyle(t)}function $t(t,e,i){var s,o={};for(s in e)o[s]=t.style[s],t.style[s]=e[s];for(s in i=i.call(t),e)t.style[s]=o[s];return i}var Gt,zt,Wt,jt,qt,Kt,Yt,o,Xt=new RegExp("^("+t+")(?!px)[a-z%]+$","i"),Jt=new RegExp(p.join("|"),"i");function Zt(){var t;o&&(Yt.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",o.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",A.appendChild(Yt).appendChild(o),t=w.getComputedStyle(o),Gt="1%"!==t.top,Kt=12===Qt(t.marginLeft),o.style.right="60%",jt=36===Qt(t.right),zt=36===Qt(t.width),o.style.position="absolute",Wt=12===Qt(o.offsetWidth/3),A.removeChild(Yt),o=null)}function Qt(t){return Math.round(parseFloat(t))}function te(t,e,i){var s,o,n=t.style;return(i=i||Nt(t))&&(""!==(o=i.getPropertyValue(e)||i[e])||T(t)||(o=x.style(t,e)),!b.pixelBoxStyles()&&Xt.test(o)&&Jt.test(e)&&(t=n.width,e=n.minWidth,s=n.maxWidth,n.minWidth=n.maxWidth=n.width=o,o=i.width,n.width=t,n.minWidth=e,n.maxWidth=s)),void 0!==o?o+"":o}function ee(t,e){return{get:function(){if(!t())return(this.get=e).apply(this,arguments);delete this.get}}}Yt=_.createElement("div"),(o=_.createElement("div")).style&&(o.style.backgroundClip="content-box",o.cloneNode(!0).style.backgroundClip="",b.clearCloneStyle="content-box"===o.style.backgroundClip,x.extend(b,{boxSizingReliable:function(){return Zt(),zt},pixelBoxStyles:function(){return Zt(),jt},pixelPosition:function(){return Zt(),Gt},reliableMarginLeft:function(){return Zt(),Kt},scrollboxSize:function(){return Zt(),Wt},reliableTrDimensions:function(){var t,e,i;return null==qt&&(t=_.createElement("table"),e=_.createElement("tr"),i=_.createElement("div"),t.style.cssText="position:absolute;left:-11111px",e.style.height="1px",i.style.height="9px",A.appendChild(t).appendChild(e).appendChild(i),i=w.getComputedStyle(e),qt=3<parseInt(i.height),A.removeChild(t)),qt}}));var ie=["Webkit","Moz","ms"],se=_.createElement("div").style,oe={};function ne(t){var e=x.cssProps[t]||oe[t];return e||(t in se?t:oe[t]=function(t){for(var e=t[0].toUpperCase()+t.slice(1),i=ie.length;i--;)if((t=ie[i]+e)in se)return t}(t)||t)}var ae=/^(none|table(?!-c[ea]).+)/,le=/^--/,re={position:"absolute",visibility:"hidden",display:"block"},ce={letterSpacing:"0",fontWeight:"400"};function de(t,e,i){var s=Ct.exec(e);return s?Math.max(0,s[2]-(i||0))+(s[3]||"px"):e}function he(t,e,i,s,o,n){var a="width"===e?1:0,l=0,r=0;if(i===(s?"border":"content"))return 0;for(;a<4;a+=2)"margin"===i&&(r+=x.css(t,i+p[a],!0,o)),s?("content"===i&&(r-=x.css(t,"padding"+p[a],!0,o)),"margin"!==i&&(r-=x.css(t,"border"+p[a]+"Width",!0,o))):(r+=x.css(t,"padding"+p[a],!0,o),"padding"!==i?r+=x.css(t,"border"+p[a]+"Width",!0,o):l+=x.css(t,"border"+p[a]+"Width",!0,o));return!s&&0<=n&&(r+=Math.max(0,Math.ceil(t["offset"+e[0].toUpperCase()+e.slice(1)]-n-r-l-.5))||0),r}function pe(t,e,i){var s=Nt(t),o=(!b.boxSizingReliable()||i)&&"border-box"===x.css(t,"boxSizing",!1,s),n=o,a=te(t,e,s),l="offset"+e[0].toUpperCase()+e.slice(1);if(Xt.test(a)){if(!i)return a;a="auto"}return(!b.boxSizingReliable()&&o||!b.reliableTrDimensions()&&r(t,"tr")||"auto"===a||!parseFloat(a)&&"inline"===x.css(t,"display",!1,s))&&t.getClientRects().length&&(o="border-box"===x.css(t,"boxSizing",!1,s),(n=l in t)&&(a=t[l])),(a=parseFloat(a)||0)+he(t,e,i||(o?"border":"content"),n,s,a)+"px"}function n(t,e,i,s,o){return new n.prototype.init(t,e,i,s,o)}x.extend({cssHooks:{opacity:{get:function(t,e){if(e)return""===(e=te(t,"opacity"))?"1":e}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(t,e,i,s){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var o,n,a,l=S(e),r=le.test(e),c=t.style;if(r||(e=ne(l)),a=x.cssHooks[e]||x.cssHooks[l],void 0===i)return a&&"get"in a&&void 0!==(o=a.get(t,!1,s))?o:c[e];"string"===(n=typeof i)&&(o=Ct.exec(i))&&o[1]&&(i=St(t,e,o),n="number"),null!=i&&i==i&&("number"!==n||r||(i+=o&&o[3]||(x.cssNumber[l]?"":"px")),b.clearCloneStyle||""!==i||0!==e.indexOf("background")||(c[e]="inherit"),a&&"set"in a&&void 0===(i=a.set(t,i,s))||(r?c.setProperty(e,i):c[e]=i))}},css:function(t,e,i,s){var o,n=S(e);return le.test(e)||(e=ne(n)),"normal"===(o=void 0===(o=(n=x.cssHooks[e]||x.cssHooks[n])&&"get"in n?n.get(t,!0,i):o)?te(t,e,s):o)&&e in ce&&(o=ce[e]),(""===i||i)&&(n=parseFloat(o),!0===i||isFinite(n))?n||0:o}}),x.each(["height","width"],function(t,a){x.cssHooks[a]={get:function(t,e,i){if(e)return!ae.test(x.css(t,"display"))||t.getClientRects().length&&t.getBoundingClientRect().width?pe(t,a,i):$t(t,re,function(){return pe(t,a,i)})},set:function(t,e,i){var s=Nt(t),o=!b.scrollboxSize()&&"absolute"===s.position,n=(o||i)&&"border-box"===x.css(t,"boxSizing",!1,s),i=i?he(t,a,i,n,s):0;return n&&o&&(i-=Math.ceil(t["offset"+a[0].toUpperCase()+a.slice(1)]-parseFloat(s[a])-he(t,a,"border",!1,s)-.5)),i&&(n=Ct.exec(e))&&"px"!==(n[3]||"px")&&(t.style[a]=e,e=x.css(t,a)),de(0,e,i)}}}),x.cssHooks.marginLeft=ee(b.reliableMarginLeft,function(t,e){if(e)return(parseFloat(te(t,"marginLeft"))||t.getBoundingClientRect().left-$t(t,{marginLeft:0},function(){return t.getBoundingClientRect().left}))+"px"}),x.each({margin:"",padding:"",border:"Width"},function(o,n){x.cssHooks[o+n]={expand:function(t){for(var e=0,i={},s="string"==typeof t?t.split(" "):[t];e<4;e++)i[o+p[e]+n]=s[e]||s[e-2]||s[0];return i}},"margin"!==o&&(x.cssHooks[o+n].set=de)}),x.fn.extend({css:function(t,e){return h(this,function(t,e,i){var s,o,n={},a=0;if(Array.isArray(e)){for(s=Nt(t),o=e.length;a<o;a++)n[e[a]]=x.css(t,e[a],!1,s);return n}return void 0!==i?x.style(t,e,i):x.css(t,e)},t,e,1<arguments.length)}}),((x.Tween=n).prototype={constructor:n,init:function(t,e,i,s,o,n){this.elem=t,this.prop=i,this.easing=o||x.easing._default,this.options=e,this.start=this.now=this.cur(),this.end=s,this.unit=n||(x.cssNumber[i]?"":"px")},cur:function(){var t=n.propHooks[this.prop];return(t&&t.get?t:n.propHooks._default).get(this)},run:function(t){var e,i=n.propHooks[this.prop];return this.options.duration?this.pos=e=x.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):this.pos=e=t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),(i&&i.set?i:n.propHooks._default).set(this),this}}).init.prototype=n.prototype,(n.propHooks={_default:{get:function(t){return 1!==t.elem.nodeType||null!=t.elem[t.prop]&&null==t.elem.style[t.prop]?t.elem[t.prop]:(t=x.css(t.elem,t.prop,""))&&"auto"!==t?t:0},set:function(t){x.fx.step[t.prop]?x.fx.step[t.prop](t):1!==t.elem.nodeType||!x.cssHooks[t.prop]&&null==t.elem.style[ne(t.prop)]?t.elem[t.prop]=t.now:x.style(t.elem,t.prop,t.now+t.unit)}}}).scrollTop=n.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},x.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2},_default:"swing"},x.fx=n.prototype.init,x.fx.step={};var V,me,a,P,ue=/^(?:toggle|show|hide)$/,ge=/queueHooks$/;function be(){me&&(!1===_.hidden&&w.requestAnimationFrame?w.requestAnimationFrame(be):w.setTimeout(be,x.fx.interval),x.fx.tick())}function Ce(){return w.setTimeout(function(){V=void 0}),V=Date.now()}function fe(t,e){var i,s=0,o={height:t};for(e=e?1:0;s<4;s+=2-e)o["margin"+(i=p[s])]=o["padding"+i]=t;return e&&(o.opacity=o.width=t),o}function Se(t,e,i){for(var s,o=(F.tweeners[e]||[]).concat(F.tweeners["*"]),n=0,a=o.length;n<a;n++)if(s=o[n].call(i,e,t))return s}function F(o,t,e){var i,n,s,a,l,r,c,d=0,h=F.prefilters.length,p=x.Deferred().always(function(){delete m.elem}),m=function(){if(!n){for(var t=V||Ce(),t=Math.max(0,u.startTime+u.duration-t),e=1-(t/u.duration||0),i=0,s=u.tweens.length;i<s;i++)u.tweens[i].run(e);if(p.notifyWith(o,[u,e,t]),e<1&&s)return t;s||p.notifyWith(o,[u,1,0]),p.resolveWith(o,[u])}return!1},u=p.promise({elem:o,props:x.extend({},t),opts:x.extend(!0,{specialEasing:{},easing:x.easing._default},e),originalProperties:t,originalOptions:e,startTime:V||Ce(),duration:e.duration,tweens:[],createTween:function(t,e){e=x.Tween(o,u.opts,t,e,u.opts.specialEasing[t]||u.opts.easing);return u.tweens.push(e),e},stop:function(t){var e=0,i=t?u.tweens.length:0;if(!n){for(n=!0;e<i;e++)u.tweens[e].run(1);t?(p.notifyWith(o,[u,1,0]),p.resolveWith(o,[u,t])):p.rejectWith(o,[u,t])}return this}}),g=u.props,b=g,C=u.opts.specialEasing;for(s in b)if(l=C[a=S(s)],r=b[s],Array.isArray(r)&&(l=r[1],r=b[s]=r[0]),s!==a&&(b[a]=r,delete b[s]),(c=x.cssHooks[a])&&"expand"in c)for(s in r=c.expand(r),delete b[a],r)s in b||(b[s]=r[s],C[s]=l);else C[a]=l;for(;d<h;d++)if(i=F.prefilters[d].call(u,o,g,u.opts))return f(i.stop)&&(x._queueHooks(u.elem,u.opts.queue).stop=i.stop.bind(i)),i;return x.map(g,Se,u),f(u.opts.start)&&u.opts.start.call(o,u),u.progress(u.opts.progress).done(u.opts.done,u.opts.complete).fail(u.opts.fail).always(u.opts.always),x.fx.timer(x.extend(m,{elem:o,anim:u,queue:u.opts.queue})),u}x.Animation=x.extend(F,{tweeners:{"*":[function(t,e){var i=this.createTween(t,e);return St(i.elem,t,Ct.exec(e),i),i}]},tweener:function(t,e){for(var i,s=0,o=(t=f(t)?(e=t,["*"]):t.match(y)).length;s<o;s++)i=t[s],F.tweeners[i]=F.tweeners[i]||[],F.tweeners[i].unshift(e)},prefilters:[function(t,e,i){var s,o,n,a,l,r,c,d="width"in e||"height"in e,h=this,p={},m=t.style,u=t.nodeType&&bt(t),g=v.get(t,"fxshow");for(s in i.queue||(null==(a=x._queueHooks(t,"fx")).unqueued&&(a.unqueued=0,l=a.empty.fire,a.empty.fire=function(){a.unqueued||l()}),a.unqueued++,h.always(function(){h.always(function(){a.unqueued--,x.queue(t,"fx").length||a.empty.fire()})})),e)if(o=e[s],ue.test(o)){if(delete e[s],n=n||"toggle"===o,o===(u?"hide":"show")){if("show"!==o||!g||void 0===g[s])continue;u=!0}p[s]=g&&g[s]||x.style(t,s)}if((r=!x.isEmptyObject(e))||!x.isEmptyObject(p))for(s in d&&1===t.nodeType&&(i.overflow=[m.overflow,m.overflowX,m.overflowY],null==(c=g&&g.display)&&(c=v.get(t,"display")),"none"===(d=x.css(t,"display"))&&(c?d=c:(k([t],!0),c=t.style.display||c,d=x.css(t,"display"),k([t]))),("inline"===d||"inline-block"===d&&null!=c)&&"none"===x.css(t,"float")&&(r||(h.done(function(){m.display=c}),null==c&&(d=m.display,c="none"===d?"":d)),m.display="inline-block")),i.overflow&&(m.overflow="hidden",h.always(function(){m.overflow=i.overflow[0],m.overflowX=i.overflow[1],m.overflowY=i.overflow[2]})),r=!1,p)r||(g?"hidden"in g&&(u=g.hidden):g=v.access(t,"fxshow",{display:c}),n&&(g.hidden=!u),u&&k([t],!0),h.done(function(){for(s in u||k([t]),v.remove(t,"fxshow"),p)x.style(t,s,p[s])})),r=Se(u?g[s]:0,s,h),s in g||(g[s]=r.start,u&&(r.end=r.start,r.start=0))}],prefilter:function(t,e){e?F.prefilters.unshift(t):F.prefilters.push(t)}}),x.speed=function(t,e,i){var s=t&&"object"==typeof t?x.extend({},t):{complete:i||!i&&e||f(t)&&t,duration:t,easing:i&&e||e&&!f(e)&&e};return x.fx.off?s.duration=0:"number"!=typeof s.duration&&(s.duration in x.fx.speeds?s.duration=x.fx.speeds[s.duration]:s.duration=x.fx.speeds._default),null!=s.queue&&!0!==s.queue||(s.queue="fx"),s.old=s.complete,s.complete=function(){f(s.old)&&s.old.call(this),s.queue&&x.dequeue(this,s.queue)},s},x.fn.extend({fadeTo:function(t,e,i,s){return this.filter(bt).css("opacity",0).show().end().animate({opacity:e},t,i,s)},animate:function(e,t,i,s){function o(){var t=F(this,x.extend({},e),a);(n||v.get(this,"finish"))&&t.stop(!0)}var n=x.isEmptyObject(e),a=x.speed(t,i,s);return o.finish=o,n||!1===a.queue?this.each(o):this.queue(a.queue,o)},stop:function(o,t,n){function a(t){var e=t.stop;delete t.stop,e(n)}return"string"!=typeof o&&(n=t,t=o,o=void 0),t&&this.queue(o||"fx",[]),this.each(function(){var t=!0,e=null!=o&&o+"queueHooks",i=x.timers,s=v.get(this);if(e)s[e]&&s[e].stop&&a(s[e]);else for(e in s)s[e]&&s[e].stop&&ge.test(e)&&a(s[e]);for(e=i.length;e--;)i[e].elem!==this||null!=o&&i[e].queue!==o||(i[e].anim.stop(n),t=!1,i.splice(e,1));!t&&n||x.dequeue(this,o)})},finish:function(a){return!1!==a&&(a=a||"fx"),this.each(function(){var t,e=v.get(this),i=e[a+"queue"],s=e[a+"queueHooks"],o=x.timers,n=i?i.length:0;for(e.finish=!0,x.queue(this,a,[]),s&&s.stop&&s.stop.call(this,!0),t=o.length;t--;)o[t].elem===this&&o[t].queue===a&&(o[t].anim.stop(!0),o.splice(t,1));for(t=0;t<n;t++)i[t]&&i[t].finish&&i[t].finish.call(this);delete e.finish})}}),x.each(["toggle","show","hide"],function(t,s){var o=x.fn[s];x.fn[s]=function(t,e,i){return null==t||"boolean"==typeof t?o.apply(this,arguments):this.animate(fe(s,!0),t,e,i)}}),x.each({slideDown:fe("show"),slideUp:fe("hide"),slideToggle:fe("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(t,s){x.fn[t]=function(t,e,i){return this.animate(s,t,e,i)}}),x.timers=[],x.fx.tick=function(){var t,e=0,i=x.timers;for(V=Date.now();e<i.length;e++)(t=i[e])()||i[e]!==t||i.splice(e--,1);i.length||x.fx.stop(),V=void 0},x.fx.timer=function(t){x.timers.push(t),x.fx.start()},x.fx.interval=13,x.fx.start=function(){me||(me=!0,be())},x.fx.stop=function(){me=null},x.fx.speeds={slow:600,fast:200,_default:400},x.fn.delay=function(s,t){return s=x.fx&&x.fx.speeds[s]||s,this.queue(t=t||"fx",function(t,e){var i=w.setTimeout(t,s);e.stop=function(){w.clearTimeout(i)}})},a=_.createElement("input"),P=_.createElement("select").appendChild(_.createElement("option")),a.type="checkbox",b.checkOn=""!==a.value,b.optSelected=P.selected,(a=_.createElement("input")).value="t",a.type="radio",b.radioValue="t"===a.value;var ve,we=x.expr.attrHandle,_e=(x.fn.extend({attr:function(t,e){return h(this,x.attr,t,e,1<arguments.length)},removeAttr:function(t){return this.each(function(){x.removeAttr(this,t)})}}),x.extend({attr:function(t,e,i){var s,o,n=t.nodeType;if(3!==n&&8!==n&&2!==n)return void 0===t.getAttribute?x.prop(t,e,i):(1===n&&x.isXMLDoc(t)||(o=x.attrHooks[e.toLowerCase()]||(x.expr.match.bool.test(e)?ve:void 0)),void 0!==i?null===i?void x.removeAttr(t,e):o&&"set"in o&&void 0!==(s=o.set(t,i,e))?s:(t.setAttribute(e,i+""),i):!(o&&"get"in o&&null!==(s=o.get(t,e)))&&null==(s=x.find.attr(t,e))?void 0:s)},attrHooks:{type:{set:function(t,e){var i;if(!b.radioValue&&"radio"===e&&r(t,"input"))return i=t.value,t.setAttribute("type",e),i&&(t.value=i),e}}},removeAttr:function(t,e){var i,s=0,o=e&&e.match(y);if(o&&1===t.nodeType)for(;i=o[s++];)t.removeAttribute(i)}}),ve={set:function(t,e,i){return!1===e?x.removeAttr(t,i):t.setAttribute(i,i),i}},x.each(x.expr.match.bool.source.match(/\w+/g),function(t,e){var a=we[e]||x.find.attr;we[e]=function(t,e,i){var s,o,n=e.toLowerCase();return i||(o=we[n],we[n]=s,s=null!=a(t,e,i)?n:null,we[n]=o),s}}),/^(?:input|select|textarea|button)$/i),xe=/^(?:a|area)$/i;function M(t){return(t.match(y)||[]).join(" ")}function R(t){return t.getAttribute&&t.getAttribute("class")||""}function ye(t){return Array.isArray(t)?t:"string"==typeof t&&t.match(y)||[]}x.fn.extend({prop:function(t,e){return h(this,x.prop,t,e,1<arguments.length)},removeProp:function(t){return this.each(function(){delete this[x.propFix[t]||t]})}}),x.extend({prop:function(t,e,i){var s,o,n=t.nodeType;if(3!==n&&8!==n&&2!==n)return 1===n&&x.isXMLDoc(t)||(e=x.propFix[e]||e,o=x.propHooks[e]),void 0!==i?o&&"set"in o&&void 0!==(s=o.set(t,i,e))?s:t[e]=i:o&&"get"in o&&null!==(s=o.get(t,e))?s:t[e]},propHooks:{tabIndex:{get:function(t){var e=x.find.attr(t,"tabindex");return e?parseInt(e,10):_e.test(t.nodeName)||xe.test(t.nodeName)&&t.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),b.optSelected||(x.propHooks.selected={get:function(t){t=t.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null},set:function(t){t=t.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),x.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){x.propFix[this.toLowerCase()]=this}),x.fn.extend({addClass:function(e){var t,i,s,o,n,a,l=0;if(f(e))return this.each(function(t){x(this).addClass(e.call(this,t,R(this)))});if((t=ye(e)).length)for(;i=this[l++];)if(a=R(i),s=1===i.nodeType&&" "+M(a)+" "){for(n=0;o=t[n++];)s.indexOf(" "+o+" ")<0&&(s+=o+" ");a!==(a=M(s))&&i.setAttribute("class",a)}return this},removeClass:function(e){var t,i,s,o,n,a,l=0;if(f(e))return this.each(function(t){x(this).removeClass(e.call(this,t,R(this)))});if(!arguments.length)return this.attr("class","");if((t=ye(e)).length)for(;i=this[l++];)if(a=R(i),s=1===i.nodeType&&" "+M(a)+" "){for(n=0;o=t[n++];)for(;-1<s.indexOf(" "+o+" ");)s=s.replace(" "+o+" "," ");a!==(a=M(s))&&i.setAttribute("class",a)}return this},toggleClass:function(o,e){var n=typeof o,a="string"==n||Array.isArray(o);return"boolean"==typeof e&&a?e?this.addClass(o):this.removeClass(o):f(o)?this.each(function(t){x(this).toggleClass(o.call(this,t,R(this),e),e)}):this.each(function(){var t,e,i,s;if(a)for(e=0,i=x(this),s=ye(o);t=s[e++];)i.hasClass(t)?i.removeClass(t):i.addClass(t);else void 0!==o&&"boolean"!=n||((t=R(this))&&v.set(this,"__className__",t),this.setAttribute&&this.setAttribute("class",!t&&!1!==o&&v.get(this,"__className__")||""))})},hasClass:function(t){for(var e,i=0,s=" "+t+" ";e=this[i++];)if(1===e.nodeType&&-1<(" "+M(R(e))+" ").indexOf(s))return!0;return!1}});function Ae(t){t.stopPropagation()}var Te=/\r/g,ke=(x.fn.extend({val:function(e){var i,t,s,o=this[0];return arguments.length?(s=f(e),this.each(function(t){1===this.nodeType&&(null==(t=s?e.call(this,t,x(this).val()):e)?t="":"number"==typeof t?t+="":Array.isArray(t)&&(t=x.map(t,function(t){return null==t?"":t+""})),(i=x.valHooks[this.type]||x.valHooks[this.nodeName.toLowerCase()])&&"set"in i&&void 0!==i.set(this,t,"value")||(this.value=t))})):o?(i=x.valHooks[o.type]||x.valHooks[o.nodeName.toLowerCase()])&&"get"in i&&void 0!==(t=i.get(o,"value"))?t:"string"==typeof(t=o.value)?t.replace(Te,""):null==t?"":t:void 0}}),x.extend({valHooks:{option:{get:function(t){var e=x.find.attr(t,"value");return null!=e?e:M(x.text(t))}},select:{get:function(t){for(var e,i=t.options,s=t.selectedIndex,o="select-one"===t.type,n=o?null:[],a=o?s+1:i.length,l=s<0?a:o?s:0;l<a;l++)if(((e=i[l]).selected||l===s)&&!(e.disabled||e.parentNode.disabled&&r(e.parentNode,"optgroup"))){if(e=x(e).val(),o)return e;n.push(e)}return n},set:function(t,e){for(var i,s,o=t.options,n=x.makeArray(e),a=o.length;a--;)((s=o[a]).selected=-1<x.inArray(x.valHooks.option.get(s),n))&&(i=!0);return i||(t.selectedIndex=-1),n}}}}),x.each(["radio","checkbox"],function(){x.valHooks[this]={set:function(t,e){if(Array.isArray(e))return t.checked=-1<x.inArray(x(t).val(),e)}},b.checkOn||(x.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})}),b.focusin="onfocusin"in w,/^(?:focusinfocus|focusoutblur)$/),Ee=(x.extend(x.event,{trigger:function(t,e,i,s){var o,n,a,l,r,c,d,h=[i||_],p=G.call(t,"type")?t.type:t,m=G.call(t,"namespace")?t.namespace.split("."):[],u=d=n=i=i||_;if(3!==i.nodeType&&8!==i.nodeType&&!ke.test(p+x.event.triggered)&&(-1<p.indexOf(".")&&(p=(m=p.split(".")).shift(),m.sort()),l=p.indexOf(":")<0&&"on"+p,(t=t[x.expando]?t:new x.Event(p,"object"==typeof t&&t)).isTrigger=s?2:3,t.namespace=m.join("."),t.rnamespace=t.namespace?new RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=i),e=null==e?[t]:x.makeArray(e,[t]),c=x.event.special[p]||{},s||!c.trigger||!1!==c.trigger.apply(i,e))){if(!s&&!c.noBubble&&!g(i)){for(a=c.delegateType||p,ke.test(a+p)||(u=u.parentNode);u;u=u.parentNode)h.push(u),n=u;n===(i.ownerDocument||_)&&h.push(n.defaultView||n.parentWindow||w)}for(o=0;(u=h[o++])&&!t.isPropagationStopped();)d=u,t.type=1<o?a:c.bindType||p,(r=(v.get(u,"events")||Object.create(null))[t.type]&&v.get(u,"handle"))&&r.apply(u,e),(r=l&&u[l])&&r.apply&&C(u)&&(t.result=r.apply(u,e),!1===t.result&&t.preventDefault());return t.type=p,s||t.isDefaultPrevented()||c._default&&!1!==c._default.apply(h.pop(),e)||!C(i)||l&&f(i[p])&&!g(i)&&((n=i[l])&&(i[l]=null),x.event.triggered=p,t.isPropagationStopped()&&d.addEventListener(p,Ae),i[p](),t.isPropagationStopped()&&d.removeEventListener(p,Ae),x.event.triggered=void 0,n&&(i[l]=n)),t.result}},simulate:function(t,e,i){i=x.extend(new x.Event,i,{type:t,isSimulated:!0});x.event.trigger(i,null,e)}}),x.fn.extend({trigger:function(t,e){return this.each(function(){x.event.trigger(t,e,this)})},triggerHandler:function(t,e){var i=this[0];if(i)return x.event.trigger(t,e,i,!0)}}),b.focusin||x.each({focus:"focusin",blur:"focusout"},function(i,s){function o(t){x.event.simulate(s,t.target,x.event.fix(t))}x.event.special[s]={setup:function(){var t=this.ownerDocument||this.document||this,e=v.access(t,s);e||t.addEventListener(i,o,!0),v.access(t,s,(e||0)+1)},teardown:function(){var t=this.ownerDocument||this.document||this,e=v.access(t,s)-1;e?v.access(t,s,e):(t.removeEventListener(i,o,!0),v.remove(t,s))}}}),w.location),Ie={guid:Date.now()},De=/\?/,Ve=(x.parseXML=function(t){var e;if(!t||"string"!=typeof t)return null;try{e=(new w.DOMParser).parseFromString(t,"text/xml")}catch(t){e=void 0}return e&&!e.getElementsByTagName("parsererror").length||x.error("Invalid XML: "+t),e},/\[\]$/),Pe=/\r?\n/g,Fe=/^(?:submit|button|image|reset|file)$/i,Me=/^(?:input|select|textarea|keygen)/i;x.param=function(t,e){function i(t,e){e=f(e)?e():e,o[o.length]=encodeURIComponent(t)+"="+encodeURIComponent(null==e?"":e)}var s,o=[];if(null==t)return"";if(Array.isArray(t)||t.jquery&&!x.isPlainObject(t))x.each(t,function(){i(this.name,this.value)});else for(s in t)!function i(s,t,o,n){if(Array.isArray(t))x.each(t,function(t,e){o||Ve.test(s)?n(s,e):i(s+"["+("object"==typeof e&&null!=e?t:"")+"]",e,o,n)});else if(o||"object"!==u(t))n(s,t);else for(var e in t)i(s+"["+e+"]",t[e],o,n)}(s,t[s],e,i);return o.join("&")},x.fn.extend({serialize:function(){return x.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var t=x.prop(this,"elements");return t?x.makeArray(t):this}).filter(function(){var t=this.type;return this.name&&!x(this).is(":disabled")&&Me.test(this.nodeName)&&!Fe.test(t)&&(this.checked||!wt.test(t))}).map(function(t,e){var i=x(this).val();return null==i?null:Array.isArray(i)?x.map(i,function(t){return{name:e.name,value:t.replace(Pe,"\r\n")}}):{name:e.name,value:i.replace(Pe,"\r\n")}}).get()}});var Re=/%20/g,Ue=/#.*$/,Le=/([?&])_=[^&]*/,Be=/^(.*?):[ \t]*([^\r\n]*)$/gm,He=/^(?:GET|HEAD)$/,Oe=/^\/\//,Ne={},$e={},Ge="*/".concat("*"),ze=_.createElement("a");function We(n){return function(t,e){"string"!=typeof t&&(e=t,t="*");var i,s=0,o=t.toLowerCase().match(y)||[];if(f(e))for(;i=o[s++];)"+"===i[0]?(i=i.slice(1)||"*",(n[i]=n[i]||[]).unshift(e)):(n[i]=n[i]||[]).push(e)}}function je(e,s,o,n){var a={},l=e===$e;function r(t){var i;return a[t]=!0,x.each(e[t]||[],function(t,e){e=e(s,o,n);return"string"!=typeof e||l||a[e]?l?!(i=e):void 0:(s.dataTypes.unshift(e),r(e),!1)}),i}return r(s.dataTypes[0])||!a["*"]&&r("*")}function qe(t,e){var i,s,o=x.ajaxSettings.flatOptions||{};for(i in e)void 0!==e[i]&&((o[i]?t:s=s||{})[i]=e[i]);return s&&x.extend(!0,t,s),t}ze.href=Ee.href,x.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Ee.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(Ee.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Ge,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":x.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?qe(qe(t,x.ajaxSettings),e):qe(x.ajaxSettings,t)},ajaxPrefilter:We(Ne),ajaxTransport:We($e),ajax:function(t,e){"object"==typeof t&&(e=t,t=void 0);var r,c,d,i,h,p,m,s,u=x.ajaxSetup({},e=e||{}),g=u.context||u,b=u.context&&(g.nodeType||g.jquery)?x(g):x.event,C=x.Deferred(),f=x.Callbacks("once memory"),S=u.statusCode||{},o={},n={},a="canceled",v={readyState:0,getResponseHeader:function(t){var e;if(p){if(!i)for(i={};e=Be.exec(d);)i[e[1].toLowerCase()+" "]=(i[e[1].toLowerCase()+" "]||[]).concat(e[2]);e=i[t.toLowerCase()+" "]}return null==e?null:e.join(", ")},getAllResponseHeaders:function(){return p?d:null},setRequestHeader:function(t,e){return null==p&&(t=n[t.toLowerCase()]=n[t.toLowerCase()]||t,o[t]=e),this},overrideMimeType:function(t){return null==p&&(u.mimeType=t),this},statusCode:function(t){if(t)if(p)v.always(t[v.status]);else for(var e in t)S[e]=[S[e],t[e]];return this},abort:function(t){t=t||a;return r&&r.abort(t),l(0,t),this}};if(C.promise(v),u.url=((t||u.url||Ee.href)+"").replace(Oe,Ee.protocol+"//"),u.type=e.method||e.type||u.method||u.type,u.dataTypes=(u.dataType||"*").toLowerCase().match(y)||[""],null==u.crossDomain){t=_.createElement("a");try{t.href=u.url,t.href=t.href,u.crossDomain=ze.protocol+"//"+ze.host!=t.protocol+"//"+t.host}catch(t){u.crossDomain=!0}}if(u.data&&u.processData&&"string"!=typeof u.data&&(u.data=x.param(u.data,u.traditional)),je(Ne,u,e,v),!p){for(s in(m=x.event&&u.global)&&0==x.active++&&x.event.trigger("ajaxStart"),u.type=u.type.toUpperCase(),u.hasContent=!He.test(u.type),c=u.url.replace(Ue,""),u.hasContent?u.data&&u.processData&&0===(u.contentType||"").indexOf("application/x-www-form-urlencoded")&&(u.data=u.data.replace(Re,"+")):(t=u.url.slice(c.length),u.data&&(u.processData||"string"==typeof u.data)&&(c+=(De.test(c)?"&":"?")+u.data,delete u.data),!1===u.cache&&(c=c.replace(Le,"$1"),t=(De.test(c)?"&":"?")+"_="+Ie.guid+++t),u.url=c+t),u.ifModified&&(x.lastModified[c]&&v.setRequestHeader("If-Modified-Since",x.lastModified[c]),x.etag[c]&&v.setRequestHeader("If-None-Match",x.etag[c])),(u.data&&u.hasContent&&!1!==u.contentType||e.contentType)&&v.setRequestHeader("Content-Type",u.contentType),v.setRequestHeader("Accept",u.dataTypes[0]&&u.accepts[u.dataTypes[0]]?u.accepts[u.dataTypes[0]]+("*"!==u.dataTypes[0]?", "+Ge+"; q=0.01":""):u.accepts["*"]),u.headers)v.setRequestHeader(s,u.headers[s]);if(u.beforeSend&&(!1===u.beforeSend.call(g,v,u)||p))return v.abort();if(a="abort",f.add(u.complete),v.done(u.success),v.fail(u.error),r=je($e,u,e,v)){if(v.readyState=1,m&&b.trigger("ajaxSend",[v,u]),p)return v;u.async&&0<u.timeout&&(h=w.setTimeout(function(){v.abort("timeout")},u.timeout));try{p=!1,r.send(o,l)}catch(t){if(p)throw t;l(-1,t)}}else l(-1,"No Transport")}return v;function l(t,e,i,s){var o,n,a,l=e;p||(p=!0,h&&w.clearTimeout(h),r=void 0,d=s||"",v.readyState=0<t?4:0,s=200<=t&&t<300||304===t,i&&(a=function(t,e,i){for(var s,o,n,a,l=t.contents,r=t.dataTypes;"*"===r[0];)r.shift(),void 0===s&&(s=t.mimeType||e.getResponseHeader("Content-Type"));if(s)for(o in l)if(l[o]&&l[o].test(s)){r.unshift(o);break}if(r[0]in i)n=r[0];else{for(o in i){if(!r[0]||t.converters[o+" "+r[0]]){n=o;break}a=a||o}n=n||a}if(n)return n!==r[0]&&r.unshift(n),i[n]}(u,v,i)),!s&&-1<x.inArray("script",u.dataTypes)&&(u.converters["text script"]=function(){}),a=function(t,e,i,s){var o,n,a,l,r,c={},d=t.dataTypes.slice();if(d[1])for(a in t.converters)c[a.toLowerCase()]=t.converters[a];for(n=d.shift();n;)if(t.responseFields[n]&&(i[t.responseFields[n]]=e),!r&&s&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),r=n,n=d.shift())if("*"===n)n=r;else if("*"!==r&&r!==n){if(!(a=c[r+" "+n]||c["* "+n]))for(o in c)if((l=o.split(" "))[1]===n&&(a=c[r+" "+l[0]]||c["* "+l[0]])){!0===a?a=c[o]:!0!==c[o]&&(n=l[0],d.unshift(l[1]));break}if(!0!==a)if(a&&t.throws)e=a(e);else try{e=a(e)}catch(t){return{state:"parsererror",error:a?t:"No conversion from "+r+" to "+n}}}return{state:"success",data:e}}(u,a,v,s),s?(u.ifModified&&((i=v.getResponseHeader("Last-Modified"))&&(x.lastModified[c]=i),(i=v.getResponseHeader("etag"))&&(x.etag[c]=i)),204===t||"HEAD"===u.type?l="nocontent":304===t?l="notmodified":(l=a.state,o=a.data,s=!(n=a.error))):(n=l,!t&&l||(l="error",t<0&&(t=0))),v.status=t,v.statusText=(e||l)+"",s?C.resolveWith(g,[o,l,v]):C.rejectWith(g,[v,l,n]),v.statusCode(S),S=void 0,m&&b.trigger(s?"ajaxSuccess":"ajaxError",[v,u,s?o:n]),f.fireWith(g,[v,l]),m&&(b.trigger("ajaxComplete",[v,u]),--x.active||x.event.trigger("ajaxStop")))}},getJSON:function(t,e,i){return x.get(t,e,i,"json")},getScript:function(t,e){return x.get(t,void 0,e,"script")}}),x.each(["get","post"],function(t,o){x[o]=function(t,e,i,s){return f(e)&&(s=s||i,i=e,e=void 0),x.ajax(x.extend({url:t,type:o,dataType:s,data:e,success:i},x.isPlainObject(t)&&t))}}),x.ajaxPrefilter(function(t){for(var e in t.headers)"content-type"===e.toLowerCase()&&(t.contentType=t.headers[e]||"")}),x._evalUrl=function(t,e,i){return x.ajax({url:t,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(t){x.globalEval(t,e,i)}})},x.fn.extend({wrapAll:function(t){return this[0]&&(f(t)&&(t=t.call(this[0])),t=x(t,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var t=this;t.firstElementChild;)t=t.firstElementChild;return t}).append(this)),this},wrapInner:function(i){return f(i)?this.each(function(t){x(this).wrapInner(i.call(this,t))}):this.each(function(){var t=x(this),e=t.contents();e.length?e.wrapAll(i):t.append(i)})},wrap:function(e){var i=f(e);return this.each(function(t){x(this).wrapAll(i?e.call(this,t):e)})},unwrap:function(t){return this.parent(t).not("body").each(function(){x(this).replaceWith(this.childNodes)}),this}}),x.expr.pseudos.hidden=function(t){return!x.expr.pseudos.visible(t)},x.expr.pseudos.visible=function(t){return!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)},x.ajaxSettings.xhr=function(){try{return new w.XMLHttpRequest}catch(t){}};var Ke={0:200,1223:204},Ye=x.ajaxSettings.xhr(),Xe=(b.cors=!!Ye&&"withCredentials"in Ye,b.ajax=Ye=!!Ye,x.ajaxTransport(function(o){var n,a;if(b.cors||Ye&&!o.crossDomain)return{send:function(t,e){var i,s=o.xhr();if(s.open(o.type,o.url,o.async,o.username,o.password),o.xhrFields)for(i in o.xhrFields)s[i]=o.xhrFields[i];for(i in o.mimeType&&s.overrideMimeType&&s.overrideMimeType(o.mimeType),o.crossDomain||t["X-Requested-With"]||(t["X-Requested-With"]="XMLHttpRequest"),t)s.setRequestHeader(i,t[i]);n=function(t){return function(){n&&(n=a=s.onload=s.onerror=s.onabort=s.ontimeout=s.onreadystatechange=null,"abort"===t?s.abort():"error"===t?"number"!=typeof s.status?e(0,"error"):e(s.status,s.statusText):e(Ke[s.status]||s.status,s.statusText,"text"!==(s.responseType||"text")||"string"!=typeof s.responseText?{binary:s.response}:{text:s.responseText},s.getAllResponseHeaders()))}},s.onload=n(),a=s.onerror=s.ontimeout=n("error"),void 0!==s.onabort?s.onabort=a:s.onreadystatechange=function(){4===s.readyState&&w.setTimeout(function(){n&&a()})},n=n("abort");try{s.send(o.hasContent&&o.data||null)}catch(t){if(n)throw t}},abort:function(){n&&n()}}}),x.ajaxPrefilter(function(t){t.crossDomain&&(t.contents.script=!1)}),x.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(t){return x.globalEval(t),t}}}),x.ajaxPrefilter("script",function(t){void 0===t.cache&&(t.cache=!1),t.crossDomain&&(t.type="GET")}),x.ajaxTransport("script",function(i){var s,o;if(i.crossDomain||i.scriptAttrs)return{send:function(t,e){s=x("<script>").attr(i.scriptAttrs||{}).prop({charset:i.scriptCharset,src:i.url}).on("load error",o=function(t){s.remove(),o=null,t&&e("error"===t.type?404:200,t.type)}),_.head.appendChild(s[0])},abort:function(){o&&o()}}}),[]),Je=/(=)\?(?=&|$)|\?\?/,Ze=(x.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=Xe.pop()||x.expando+"_"+Ie.guid++;return this[t]=!0,t}}),x.ajaxPrefilter("json jsonp",function(t,e,i){var s,o,n,a=!1!==t.jsonp&&(Je.test(t.url)?"url":"string"==typeof t.data&&0===(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&Je.test(t.data)&&"data");if(a||"jsonp"===t.dataTypes[0])return s=t.jsonpCallback=f(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,a?t[a]=t[a].replace(Je,"$1"+s):!1!==t.jsonp&&(t.url+=(De.test(t.url)?"&":"?")+t.jsonp+"="+s),t.converters["script json"]=function(){return n||x.error(s+" was not called"),n[0]},t.dataTypes[0]="json",o=w[s],w[s]=function(){n=arguments},i.always(function(){void 0===o?x(w).removeProp(s):w[s]=o,t[s]&&(t.jsonpCallback=e.jsonpCallback,Xe.push(s)),n&&f(o)&&o(n[0]),n=o=void 0}),"script"}),b.createHTMLDocument=((t=_.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===t.childNodes.length),x.parseHTML=function(t,e,i){var s;return"string"!=typeof t?[]:("boolean"==typeof e&&(i=e,e=!1),e||(b.createHTMLDocument?((s=(e=_.implementation.createHTMLDocument("")).createElement("base")).href=_.location.href,e.head.appendChild(s)):e=_),s=!i&&[],(i=J.exec(t))?[e.createElement(i[1])]:(i=Tt([t],e,s),s&&s.length&&x(s).remove(),x.merge([],i.childNodes)))},x.fn.load=function(t,e,i){var s,o,n,a=this,l=t.indexOf(" ");return-1<l&&(s=M(t.slice(l)),t=t.slice(0,l)),f(e)?(i=e,e=void 0):e&&"object"==typeof e&&(o="POST"),0<a.length&&x.ajax({url:t,type:o||"GET",dataType:"html",data:e}).done(function(t){n=arguments,a.html(s?x("<div>").append(x.parseHTML(t)).find(s):t)}).always(i&&function(t,e){a.each(function(){i.apply(this,n||[t.responseText,e,t])})}),this},x.expr.pseudos.animated=function(e){return x.grep(x.timers,function(t){return e===t.elem}).length},x.offset={setOffset:function(t,e,i){var s,o,n,a,l=x.css(t,"position"),r=x(t),c={};"static"===l&&(t.style.position="relative"),n=r.offset(),s=x.css(t,"top"),a=x.css(t,"left"),l=("absolute"===l||"fixed"===l)&&-1<(s+a).indexOf("auto")?(o=(l=r.position()).top,l.left):(o=parseFloat(s)||0,parseFloat(a)||0),null!=(e=f(e)?e.call(t,i,x.extend({},n)):e).top&&(c.top=e.top-n.top+o),null!=e.left&&(c.left=e.left-n.left+l),"using"in e?e.using.call(t,c):("number"==typeof c.top&&(c.top+="px"),"number"==typeof c.left&&(c.left+="px"),r.css(c))}},x.fn.extend({offset:function(e){var t,i;return arguments.length?void 0===e?this:this.each(function(t){x.offset.setOffset(this,e,t)}):(i=this[0])?i.getClientRects().length?(t=i.getBoundingClientRect(),i=i.ownerDocument.defaultView,{top:t.top+i.pageYOffset,left:t.left+i.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var t,e,i,s=this[0],o={top:0,left:0};if("fixed"===x.css(s,"position"))e=s.getBoundingClientRect();else{for(e=this.offset(),i=s.ownerDocument,t=s.offsetParent||i.documentElement;t&&(t===i.body||t===i.documentElement)&&"static"===x.css(t,"position");)t=t.parentNode;t&&t!==s&&1===t.nodeType&&((o=x(t).offset()).top+=x.css(t,"borderTopWidth",!0),o.left+=x.css(t,"borderLeftWidth",!0))}return{top:e.top-o.top-x.css(s,"marginTop",!0),left:e.left-o.left-x.css(s,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent;t&&"static"===x.css(t,"position");)t=t.offsetParent;return t||A})}}),x.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,o){var n="pageYOffset"===o;x.fn[e]=function(t){return h(this,function(t,e,i){var s;if(g(t)?s=t:9===t.nodeType&&(s=t.defaultView),void 0===i)return s?s[o]:t[e];s?s.scrollTo(n?s.pageXOffset:i,n?i:s.pageYOffset):t[e]=i},e,t,arguments.length)}}),x.each(["top","left"],function(t,i){x.cssHooks[i]=ee(b.pixelPosition,function(t,e){if(e)return e=te(t,i),Xt.test(e)?x(t).position()[i]+"px":e})}),x.each({Height:"height",Width:"width"},function(a,l){x.each({padding:"inner"+a,content:l,"":"outer"+a},function(s,n){x.fn[n]=function(t,e){var i=arguments.length&&(s||"boolean"!=typeof t),o=s||(!0===t||!0===e?"margin":"border");return h(this,function(t,e,i){var s;return g(t)?0===n.indexOf("outer")?t["inner"+a]:t.document.documentElement["client"+a]:9===t.nodeType?(s=t.documentElement,Math.max(t.body["scroll"+a],s["scroll"+a],t.body["offset"+a],s["offset"+a],s["client"+a])):void 0===i?x.css(t,e,o):x.style(t,e,i,o)},l,i?t:void 0,i)}})}),x.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(t,e){x.fn[e]=function(t){return this.on(e,t)}}),x.fn.extend({bind:function(t,e,i){return this.on(t,null,e,i)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,i,s){return this.on(e,t,i,s)},undelegate:function(t,e,i){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",i)},hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)}}),x.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(t,i){x.fn[i]=function(t,e){return 0<arguments.length?this.on(i,null,t,e):this.trigger(i)}}),/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g),Qe=(x.proxy=function(t,e){var i,s;if("string"==typeof e&&(s=t[e],e=t,t=s),f(t))return i=l.call(arguments,2),(s=function(){return t.apply(e||this,i.concat(l.call(arguments)))}).guid=t.guid=t.guid||x.guid++,s},x.holdReady=function(t){t?x.readyWait++:x.ready(!0)},x.isArray=Array.isArray,x.parseJSON=JSON.parse,x.nodeName=r,x.isFunction=f,x.isWindow=g,x.camelCase=S,x.type=u,x.now=Date.now,x.isNumeric=function(t){var e=x.type(t);return("number"===e||"string"===e)&&!isNaN(t-parseFloat(t))},x.trim=function(t){return null==t?"":(t+"").replace(Ze,"")},"function"==typeof define&&define.amd&&define("jquery",[],function(){return x}),w.jQuery),ti=w.$;return x.noConflict=function(t){return w.$===x&&(w.$=ti),t&&w.jQuery===x&&(w.jQuery=Qe),x},void 0===U&&(w.jQuery=w.$=x),x}),!function(){var t=this,e=t.Backbone,i=[],o=i.slice,a="undefined"!=typeof exports?exports:t.Backbone={},w=(a.VERSION="1.1.0",t._),n=(w||"undefined"==typeof require||(w=require("underscore")),a.$=t.jQuery||t.Zepto||t.ender||t.$,a.noConflict=function(){return t.Backbone=e,this},a.emulateHTTP=!1,a.emulateJSON=!1,a.Events={on:function(t,e,i){return h(this,"on",t,[e,i])&&e&&(this._events||(this._events={}),(this._events[t]||(this._events[t]=[])).push({callback:e,context:i,ctx:i||this})),this},once:function(t,e,i){var s,o;return h(this,"once",t,[e,i])&&e?(s=this,(o=w.once(function(){s.off(t,o),e.apply(this,arguments)}))._callback=e,this.on(t,o,i)):this},off:function(t,e,i){var s,o,n,a,l,r,c,d;if(this._events&&h(this,"off",t,[e,i]))if(t||e||i){for(l=0,r=(a=t?[t]:w.keys(this._events)).length;l<r;l++)if(t=a[l],n=this._events[t]){if(this._events[t]=s=[],e||i)for(c=0,d=n.length;c<d;c++)o=n[c],(e&&e!==o.callback&&e!==o.callback._callback||i&&i!==o.context)&&s.push(o);s.length||delete this._events[t]}}else this._events={};return this},trigger:function(t){var e,i,s;return this._events&&(e=o.call(arguments,1),h(this,"trigger",t,e)&&(i=this._events[t],s=this._events.all,i&&l(i,e),s&&l(s,arguments))),this},stopListening:function(t,e,i){var s=this._listeningTo;if(s){var o,n=!e&&!i;for(o in i||"object"!=typeof e||(i=this),t&&((s={})[t._listenId]=t),s)(t=s[o]).off(e,i,this),(n||w.isEmpty(t._events))&&delete this._listeningTo[o]}return this}}),r=/\s+/,h=function(t,e,i,s){if(i){if("object"==typeof i){for(var o in i)t[e].apply(t,[o,i[o]].concat(s));return!1}if(r.test(i)){for(var n=i.split(r),a=0,l=n.length;a<l;a++)t[e].apply(t,[n[a]].concat(s));return!1}}return!0},l=function(t,e){var i,s=-1,o=t.length,n=e[0],a=e[1],l=e[2];switch(e.length){case 0:for(;++s<o;)(i=t[s]).callback.call(i.ctx);return;case 1:for(;++s<o;)(i=t[s]).callback.call(i.ctx,n);return;case 2:for(;++s<o;)(i=t[s]).callback.call(i.ctx,n,a);return;case 3:for(;++s<o;)(i=t[s]).callback.call(i.ctx,n,a,l);return;default:for(;++s<o;)(i=t[s]).callback.apply(i.ctx,e)}},_=(w.each({listenTo:"on",listenToOnce:"once"},function(s,t){n[t]=function(t,e,i){return((this._listeningTo||(this._listeningTo={}))[t._listenId||(t._listenId=w.uniqueId("l"))]=t)[s](e,i=i||"object"!=typeof e?i:this,this),this}}),n.bind=n.on,n.unbind=n.off,w.extend(a,n),a.Model=function(t,e){var i=t||{};e=e||{},this.cid=w.uniqueId("c"),this.attributes={},e.collection&&(this.collection=e.collection),e.parse&&(i=this.parse(i,e)||{}),i=w.defaults({},i,w.result(this,"defaults")),this.set(i,e),this.changed={},this.initialize.apply(this,arguments)}),c=(w.extend(_.prototype,n,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(t){return w.clone(this.attributes)},sync:function(){return a.sync.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(t){return w.escape(this.get(t))},has:function(t){return null!=this.get(t)},set:function(t,e,i){var s,o,n,a,l,r,c;if(null!=t){if("object"==typeof t?(o=t,i=e):(o={})[t]=e,!this._validate(o,i=i||{}))return!1;for(s in n=i.unset,t=i.silent,a=[],l=this._changing,this._changing=!0,l||(this._previousAttributes=w.clone(this.attributes),this.changed={}),c=this.attributes,r=this._previousAttributes,this.idAttribute in o&&(this.id=o[this.idAttribute]),o)e=o[s],w.isEqual(c[s],e)||a.push(s),w.isEqual(r[s],e)?delete this.changed[s]:this.changed[s]=e,n?delete c[s]:c[s]=e;if(!t){a.length&&(this._pending=!0);for(var d=0,h=a.length;d<h;d++)this.trigger("change:"+a[d],this,c[a[d]],i)}if(!l){if(!t)for(;this._pending;)this._pending=!1,this.trigger("change",this,i);this._pending=!1,this._changing=!1}}return this},unset:function(t,e){return this.set(t,void 0,w.extend({},e,{unset:!0}))},clear:function(t){var e,i={};for(e in this.attributes)i[e]=void 0;return this.set(i,w.extend({},t,{unset:!0}))},hasChanged:function(t){return null==t?!w.isEmpty(this.changed):w.has(this.changed,t)},changedAttributes:function(t){if(!t)return!!this.hasChanged()&&w.clone(this.changed);var e,i,s=!1,o=this._changing?this._previousAttributes:this.attributes;for(i in t)w.isEqual(o[i],e=t[i])||((s=s||{})[i]=e);return s},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return w.clone(this._previousAttributes)},fetch:function(e){void 0===(e=e?w.clone(e):{}).parse&&(e.parse=!0);var i=this,s=e.success;return e.success=function(t){if(!i.set(i.parse(t,e),e))return!1;s&&s(i,t,e),i.trigger("sync",i,t,e)},D(this,e),this.sync("read",this,e)},save:function(t,e,i){var s,o=this.attributes;if(null==t||"object"==typeof t?(s=t,i=e):(s={})[t]=e,i=w.extend({validate:!0},i),s&&!i.wait){if(!this.set(s,i))return!1}else if(!this._validate(s,i))return!1;s&&i.wait&&(this.attributes=w.extend({},o,s)),void 0===i.parse&&(i.parse=!0);var n=this,a=i.success;return i.success=function(t){n.attributes=o;var e=n.parse(t,i);if(i.wait&&(e=w.extend(s||{},e)),w.isObject(e)&&!n.set(e,i))return!1;a&&a(n,t,i),n.trigger("sync",n,t,i)},D(this,i),"patch"==(t=this.isNew()?"create":i.patch?"patch":"update")&&(i.attrs=s),e=this.sync(t,this,i),s&&i.wait&&(this.attributes=o),e},destroy:function(e){e=e?w.clone(e):{};function i(){s.trigger("destroy",s,s.collection,e)}var s=this,o=e.success;if(e.success=function(t){(e.wait||s.isNew())&&i(),o&&o(s,t,e),s.isNew()||s.trigger("sync",s,t,e)},this.isNew())return e.success(),!1;D(this,e);var t=this.sync("delete",this,e);return e.wait||i(),t},url:function(){var t=w.result(this,"urlRoot")||w.result(this.collection,"url")||I();return this.isNew()?t:t+("/"===t.charAt(t.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(t,e){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},isValid:function(t){return this._validate({},w.extend(t||{},{validate:!0}))},_validate:function(t,e){if(!e.validate||!this.validate)return!0;t=w.extend({},this.attributes,t);t=this.validationError=this.validate(t,e)||null;return!t||(this.trigger("invalid",this,t,w.extend(e,{validationError:t})),!1)}}),w.each(["keys","values","pairs","invert","pick","omit"],function(e){_.prototype[e]=function(){var t=o.call(arguments);return t.unshift(this.attributes),w[e].apply(w,t)}}),a.Collection=function(t,e){(e=e||{}).model&&(this.model=e.model),void 0!==e.comparator&&(this.comparator=e.comparator),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,w.extend({silent:!0},e))}),x={add:!0,remove:!0,merge:!0},s={add:!0,remove:!1},i=(w.extend(c.prototype,n,{model:_,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return a.sync.apply(this,arguments)},add:function(t,e){return this.set(t,w.extend({merge:!1},e,s))},remove:function(t,e){var i,s,o,n,a=!w.isArray(t);for(e=e||{},i=0,s=(t=a?[t]:w.clone(t)).length;i<s;i++)(n=t[i]=this.get(t[i]))&&(delete this._byId[n.id],delete this._byId[n.cid],o=this.indexOf(n),this.models.splice(o,1),this.length--,e.silent||(e.index=o,n.trigger("remove",n,this,e)),this._removeReference(n));return a?t[0]:t},set:function(t,e){(e=w.defaults({},e,x)).parse&&(t=this.parse(t,e));var i,s,o,n,a=!w.isArray(t),l=(t=a?t?[t]:[]:w.clone(t),e.at),r=this.model,c=this.comparator&&null==l&&!1!==e.sort,d=w.isString(this.comparator)?this.comparator:null,h=[],p=[],m={},u=e.add,g=e.merge,b=e.remove,C=!(c||!u||!b)&&[];for(S=0,v=t.length;S<v;S++){if(o=(s=t[S])instanceof _?i=s:s[r.prototype.idAttribute],o=this.get(o))b&&(m[o.cid]=!0),g&&(s=s===i?i.attributes:s,e.parse&&(s=o.parse(s,e)),o.set(s,e),c&&!n&&o.hasChanged(d)&&(n=!0)),t[S]=o;else if(u){if(!(i=t[S]=this._prepareModel(s,e)))continue;h.push(i),i.on("all",this._onModelEvent,this),null!=(this._byId[i.cid]=i).id&&(this._byId[i.id]=i)}C&&C.push(o||i)}if(b){for(S=0,v=this.length;S<v;++S)m[(i=this.models[S]).cid]||p.push(i);p.length&&this.remove(p,e)}if(h.length||C&&C.length)if(c&&(n=!0),this.length+=h.length,null!=l)for(S=0,v=h.length;S<v;S++)this.models.splice(l+S,0,h[S]);else{C&&(this.models.length=0);for(var f=C||h,S=0,v=f.length;S<v;S++)this.models.push(f[S])}if(n&&this.sort({silent:!0}),!e.silent){for(S=0,v=h.length;S<v;S++)(i=h[S]).trigger("add",i,this,e);(n||C&&C.length)&&this.trigger("sort",this,e)}return a?t[0]:t},reset:function(t,e){e=e||{};for(var i=0,s=this.models.length;i<s;i++)this._removeReference(this.models[i]);return e.previousModels=this.models,this._reset(),t=this.add(t,w.extend({silent:!0},e)),e.silent||this.trigger("reset",this,e),t},push:function(t,e){return this.add(t,w.extend({at:this.length},e))},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t),e},unshift:function(t,e){return this.add(t,w.extend({at:0},e))},shift:function(t){var e=this.at(0);return this.remove(e,t),e},slice:function(){return o.apply(this.models,arguments)},get:function(t){if(null!=t)return this._byId[t.id]||this._byId[t.cid]||this._byId[t]},at:function(t){return this.models[t]},where:function(i,t){return w.isEmpty(i)?t?void 0:[]:this[t?"find":"filter"](function(t){for(var e in i)if(i[e]!==t.get(e))return!1;return!0})},findWhere:function(t){return this.where(t,!0)},sort:function(t){if(this.comparator)return t=t||{},w.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(w.bind(this.comparator,this)),t.silent||this.trigger("sort",this,t),this;throw new Error("Cannot sort a set without a comparator")},pluck:function(t){return w.invoke(this.models,"get",t)},fetch:function(i){void 0===(i=i?w.clone(i):{}).parse&&(i.parse=!0);var s=i.success,o=this;return i.success=function(t){var e=i.reset?"reset":"set";o[e](t,i),s&&s(o,t,i),o.trigger("sync",o,t,i)},D(this,i),this.sync("read",this,i)},create:function(t,e){if(e=e?w.clone(e):{},!(t=this._prepareModel(t,e)))return!1;e.wait||this.add(t,e);var s=this,o=e.success;return e.success=function(t,e,i){i.wait&&s.add(t,i),o&&o(t,e,i)},t.save(null,e),t},parse:function(t,e){return t},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(t,e){return t instanceof _?(t.collection||(t.collection=this),t):(t=new((e=e?w.clone(e):{}).collection=this).model(t,e)).validationError?(this.trigger("invalid",this,t.validationError,e),!1):t},_removeReference:function(t){this===t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,i,s){("add"!==t&&"remove"!==t||i===this)&&("destroy"===t&&this.remove(e,s),e&&t==="change:"+e.idAttribute&&(delete this._byId[e.previous(e.idAttribute)],null!=e.id&&(this._byId[e.id]=e)),this.trigger.apply(this,arguments))}}),w.each(["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain"],function(e){c.prototype[e]=function(){var t=o.call(arguments);return t.unshift(this.models),w[e].apply(w,t)}}),w.each(["groupBy","countBy","sortBy"],function(s){c.prototype[s]=function(e,t){var i=w.isFunction(e)?e:function(t){return t.get(e)};return w[s](this.models,i,t)}}),a.View=function(t){this.cid=w.uniqueId("view"),w.extend(this,w.pick(t=t||{},p)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()}),d=/^(\S+)\s*(.*)$/,p=["model","collection","el","id","attributes","className","tagName","events"],m=(w.extend(i.prototype,n,{tagName:"div",$:function(t){return this.$el.find(t)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(t,e){return this.$el&&this.undelegateEvents(),this.$el=t instanceof a.$?t:a.$(t),this.el=this.$el[0],!1!==e&&this.delegateEvents(),this},delegateEvents:function(t){if(t=t||w.result(this,"events"))for(var e in this.undelegateEvents(),t){var i,s=t[e];(s=w.isFunction(s)?s:this[t[e]])&&(i=(e=e.match(d))[1],e=e[2],s=w.bind(s,this),i+=".delegateEvents"+this.cid,""===e?this.$el.on(i,s):this.$el.on(i,e,s))}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){var t;this.el?this.setElement(w.result(this,"el"),!1):(t=w.extend({},w.result(this,"attributes")),this.id&&(t.id=w.result(this,"id")),this.className&&(t.class=w.result(this,"className")),t=a.$("<"+w.result(this,"tagName")+">").attr(t),this.setElement(t,!1))}}),a.sync=function(t,e,i){var s,o=u[t],n=(w.defaults(i=i||{},{emulateHTTP:a.emulateHTTP,emulateJSON:a.emulateJSON}),{type:o,dataType:"json"}),t=(i.url||(n.url=w.result(e,"url")||I()),null!=i.data||!e||"create"!==t&&"update"!==t&&"patch"!==t||(n.contentType="application/json",n.data=JSON.stringify(i.attrs||e.toJSON(i))),i.emulateJSON&&(n.contentType="application/x-www-form-urlencoded",n.data=n.data?{model:n.data}:{}),!i.emulateHTTP||"PUT"!==o&&"DELETE"!==o&&"PATCH"!==o||(n.type="POST",i.emulateJSON&&(n.data._method=o),s=i.beforeSend,i.beforeSend=function(t){if(t.setRequestHeader("X-HTTP-Method-Override",o),s)return s.apply(this,arguments)}),"GET"===n.type||i.emulateJSON||(n.processData=!1),"PATCH"===n.type&&m&&(n.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")}),i.xhr=a.ajax(w.extend(n,i)));return e.trigger("request",e,t,i),t},!("undefined"==typeof window||!window.ActiveXObject||window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent)),u={create:"POST",update:"PUT",patch:"PATCH",delete:"DELETE",read:"GET"},g=(a.ajax=function(){return a.$.ajax.apply(a.$,arguments)},a.Router=function(t){(t=t||{}).routes&&(this.routes=t.routes),this._bindRoutes(),this.initialize.apply(this,arguments)}),b=/\((.*?)\)/g,C=/(\(\?)?:\w+/g,f=/\*\w+/g,S=/[\-{}\[\]+?.,\\\^$|#\s]/g,v=(w.extend(g.prototype,n,{initialize:function(){},route:function(e,i,s){w.isRegExp(e)||(e=this._routeToRegExp(e)),w.isFunction(i)&&(s=i,i=""),s=s||this[i];var o=this;return a.history.route(e,function(t){t=o._extractParameters(e,t);s&&s.apply(o,t),o.trigger.apply(o,["route:"+i].concat(t)),o.trigger("route",i,t),a.history.trigger("route",o,i,t)}),this},navigate:function(t,e){return a.history.navigate(t,e),this},_bindRoutes:function(){if(this.routes){this.routes=w.result(this,"routes");for(var t,e=w.keys(this.routes);null!=(t=e.pop());)this.route(t,this.routes[t])}},_routeToRegExp:function(t){return t=t.replace(S,"\\$&").replace(b,"(?:$1)?").replace(C,function(t,e){return e?t:"([^/]+)"}).replace(f,"(.*?)"),new RegExp("^"+t+"$")},_extractParameters:function(t,e){t=t.exec(e).slice(1);return w.map(t,function(t){return t?decodeURIComponent(t):null})}}),a.History=function(){this.handlers=[],w.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)}),y=/^[#\/]|\s+$/g,A=/^\/+|\/+$/g,T=/msie [\w.]+/,k=/\/$/,E=/[?#].*$/,I=(v.started=!1,w.extend(v.prototype,n,{interval:50,getHash:function(t){t=(t||this).location.href.match(/#(.*)$/);return t?t[1]:""},getFragment:function(t,e){return null==t&&(this._hasPushState||!this._wantsHashChange||e?(t=this.location.pathname,e=this.root.replace(k,""),t.indexOf(e)||(t=t.slice(e.length))):t=this.getHash()),t.replace(y,"")},start:function(t){if(v.started)throw new Error("Backbone.history has already been started");v.started=!0,this.options=w.extend({root:"/"},this.options,t),this.root=this.options.root,this._wantsHashChange=!1!==this.options.hashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var t=this.getFragment(),e=document.documentMode,e=T.exec(navigator.userAgent.toLowerCase())&&(!e||e<=7),e=(this.root=("/"+this.root+"/").replace(A,"/"),e&&this._wantsHashChange&&(this.iframe=a.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(t)),this._hasPushState?a.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!e?a.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=t,this.location),t=e.pathname.replace(/[^\/]$/,"$&/")===this.root;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!t)return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0;this._hasPushState&&t&&e.hash&&(this.fragment=this.getHash().replace(y,""),this.history.replaceState({},document.title,this.root+this.fragment+e.search))}if(!this.options.silent)return this.loadUrl()},stop:function(){a.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),v.started=!1},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(t){var e=this.getFragment();if((e=e===this.fragment&&this.iframe?this.getFragment(this.getHash(this.iframe)):e)===this.fragment)return!1;this.iframe&&this.navigate(e),this.loadUrl()},loadUrl:function(e){return e=this.fragment=this.getFragment(e),w.any(this.handlers,function(t){if(t.route.test(e))return t.callback(e),!0})},navigate:function(t,e){if(!v.started)return!1;e&&!0!==e||(e={trigger:!!e});var i=this.root+(t=this.getFragment(t||""));if(t=t.replace(E,""),this.fragment!==t){if(""===(this.fragment=t)&&"/"!==i&&(i=i.slice(0,-1)),this._hasPushState)this.history[e.replace?"replaceState":"pushState"]({},document.title,i);else{if(!this._wantsHashChange)return this.location.assign(i);this._updateHash(this.location,t,e.replace),this.iframe&&t!==this.getFragment(this.getHash(this.iframe))&&(e.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,t,e.replace))}return e.trigger?this.loadUrl(t):void 0}},_updateHash:function(t,e,i){i?(i=t.href.replace(/(javascript:|#).*$/,""),t.replace(i+"#"+e)):t.hash="#"+e}}),a.history=new v,_.extend=c.extend=g.extend=i.extend=v.extend=function(t,e){function i(){this.constructor=o}var s=this,o=t&&w.has(t,"constructor")?t.constructor:function(){return s.apply(this,arguments)};w.extend(o,s,e);return i.prototype=s.prototype,o.prototype=new i,t&&w.extend(o.prototype,t),o.__super__=s.prototype,o},function(){throw new Error('A "url" property or function must be specified')}),D=function(e,i){var s=i.error;i.error=function(t){s&&s(e,t,i),e.trigger("error",e,t,i)}}}.call(this),define("backbone",["underscore","jquery"],function(t){return function(){return t.Backbone}}(this)),"undefined"==typeof jQuery)throw new Error("Bootstrap's JavaScript requires jQuery");function _extend_object(t,e){return"undefined"!=typeof _?_.extend({},t,e):Object?Object.assign({},t,e):e}!function(){"use strict";var t=jQuery.fn.jquery.split(" ")[0].split(".");if(t[0]<2&&t[1]<9||1==t[0]&&9==t[1]&&t[2]<1||3<t[0])throw new Error("Bootstrap's JavaScript requires jQuery version 1.9.1 or higher, but lower than version 4")}(),!function(s){"use strict";s.fn.emulateTransitionEnd=function(t){var e=!1,i=this;s(this).one("bsTransitionEnd",function(){e=!0});return setTimeout(function(){e||s(i).trigger(s.support.transition.end)},t),this},s(function(){s.support.transition=function(){var t,e=document.createElement("bootstrap"),i={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(t in i)if(void 0!==e.style[t])return{end:i[t]};return!1}(),s.support.transition&&(s.event.special.bsTransitionEnd={bindType:s.support.transition.end,delegateType:s.support.transition.end,handle:function(t){if(s(t.target).is(this))return t.handleObj.handler.apply(this,arguments)}})})}(jQuery),!function(n){"use strict";function a(t){n(t).on("click",e,this.close)}var e='[data-dismiss="alert"]';a.VERSION="3.4.1",a.TRANSITION_DURATION=150,a.prototype.close=function(t){var e=n(this),i=e.attr("data-target"),s=(i="#"===(i=i||(i=e.attr("href"))&&i.replace(/.*(?=#[^\s]*$)/,""))?[]:i,n(document).find(i));function o(){s.detach().trigger("closed.bs.alert").remove()}t&&t.preventDefault(),(s=s.length?s:e.closest(".alert")).trigger(t=n.Event("close.bs.alert")),t.isDefaultPrevented()||(s.removeClass("in"),n.support.transition&&s.hasClass("fade")?s.one("bsTransitionEnd",o).emulateTransitionEnd(a.TRANSITION_DURATION):o())};var t=n.fn.alert;n.fn.alert=function(i){return this.each(function(){var t=n(this),e=t.data("bs.alert");e||t.data("bs.alert",e=new a(this)),"string"==typeof i&&e[i].call(t)})},n.fn.alert.Constructor=a,n.fn.alert.noConflict=function(){return n.fn.alert=t,this},n(document).on("click.bs.alert.data-api",e,a.prototype.close)}(jQuery),!function(n){"use strict";function s(t,e){this.$element=n(t),this.options=n.extend({},s.DEFAULTS,e),this.isLoading=!1}function i(i){return this.each(function(){var t=n(this),e=t.data("bs.button");e||t.data("bs.button",e=new s(this,"object"==typeof i&&i)),"toggle"==i?e.toggle():i&&e.setState(i)})}s.VERSION="3.4.1",s.DEFAULTS={loadingText:"loading..."},s.prototype.setState=function(t){var e="disabled",i=this.$element,s=i.is("input")?"val":"html",o=i.data();t+="Text",null==o.resetText&&i.data("resetText",i[s]()),setTimeout(n.proxy(function(){i[s]((null==o[t]?this.options:o)[t]),"loadingText"==t?(this.isLoading=!0,i.addClass(e).attr(e,e).prop(e,!0)):this.isLoading&&(this.isLoading=!1,i.removeClass(e).removeAttr(e).prop(e,!1))},this),0)},s.prototype.toggle=function(){var t,e=!0,i=this.$element.closest('[data-toggle="buttons"]');i.length?("radio"==(t=this.$element.find("input")).prop("type")?(t.prop("checked")&&(e=!1),i.find(".active").removeClass("active"),this.$element.addClass("active")):"checkbox"==t.prop("type")&&(t.prop("checked")!==this.$element.hasClass("active")&&(e=!1),this.$element.toggleClass("active")),t.prop("checked",this.$element.hasClass("active")),e&&t.trigger("change")):(this.$element.attr("aria-pressed",!this.$element.hasClass("active")),this.$element.toggleClass("active"))};var t=n.fn.button;n.fn.button=i,n.fn.button.Constructor=s,n.fn.button.noConflict=function(){return n.fn.button=t,this},n(document).on("click.bs.button.data-api",'[data-toggle^="button"]',function(t){var e=n(t.target).closest(".btn");i.call(e,"toggle"),n(t.target).is('input[type="radio"], input[type="checkbox"]')||(t.preventDefault(),(e.is("input,button")?e:e.find("input:visible,button:visible").first()).trigger("focus"))}).on("focus.bs.button.data-api blur.bs.button.data-api",'[data-toggle^="button"]',function(t){n(t.target).closest(".btn").toggleClass("focus",/^focus(in)?$/.test(t.type))})}(jQuery),!function(c){"use strict";function d(t,e){this.$element=c(t),this.$indicators=this.$element.find(".carousel-indicators"),this.options=e,this.paused=null,this.sliding=null,this.interval=null,this.$active=null,this.$items=null,this.options.keyboard&&this.$element.on("keydown.bs.carousel",c.proxy(this.keydown,this)),"hover"!=this.options.pause||"ontouchstart"in document.documentElement||this.$element.on("mouseenter.bs.carousel",c.proxy(this.pause,this)).on("mouseleave.bs.carousel",c.proxy(this.cycle,this))}function o(o){return this.each(function(){var t=c(this),e=t.data("bs.carousel"),i=c.extend({},d.DEFAULTS,t.data(),"object"==typeof o&&o),s="string"==typeof o?o:i.slide;e||t.data("bs.carousel",e=new d(this,i)),"number"==typeof o?e.to(o):s?e[s]():i.interval&&e.pause().cycle()})}d.VERSION="3.4.1",d.TRANSITION_DURATION=600,d.DEFAULTS={interval:5e3,pause:"hover",wrap:!0,keyboard:!0},d.prototype.keydown=function(t){if(!/input|textarea/i.test(t.target.tagName)){switch(t.which){case 37:this.prev();break;case 39:this.next();break;default:return}t.preventDefault()}},d.prototype.cycle=function(t){return t||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(c.proxy(this.next,this),this.options.interval)),this},d.prototype.getItemIndex=function(t){return this.$items=t.parent().children(".item"),this.$items.index(t||this.$active)},d.prototype.getItemForDirection=function(t,e){var i=this.getItemIndex(e);return("prev"==t&&0===i||"next"==t&&i==this.$items.length-1)&&!this.options.wrap?e:(e=(i+("prev"==t?-1:1))%this.$items.length,this.$items.eq(e))},d.prototype.to=function(t){var e=this,i=this.getItemIndex(this.$active=this.$element.find(".item.active"));if(!(t>this.$items.length-1||t<0))return this.sliding?this.$element.one("slid.bs.carousel",function(){e.to(t)}):i==t?this.pause().cycle():this.slide(i<t?"next":"prev",this.$items.eq(t))},d.prototype.pause=function(t){return t||(this.paused=!0),this.$element.find(".next, .prev").length&&c.support.transition&&(this.$element.trigger(c.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},d.prototype.next=function(){if(!this.sliding)return this.slide("next")},d.prototype.prev=function(){if(!this.sliding)return this.slide("prev")},d.prototype.slide=function(t,e){var i,s,o,n=this.$element.find(".item.active"),a=e||this.getItemForDirection(t,n),e=this.interval,l="next"==t?"left":"right",r=this;return a.hasClass("active")?this.sliding=!1:(i=a[0],s=c.Event("slide.bs.carousel",{relatedTarget:i,direction:l}),this.$element.trigger(s),s.isDefaultPrevented()?void 0:(this.sliding=!0,e&&this.pause(),this.$indicators.length&&(this.$indicators.find(".active").removeClass("active"),(s=c(this.$indicators.children()[this.getItemIndex(a)]))&&s.addClass("active")),o=c.Event("slid.bs.carousel",{relatedTarget:i,direction:l}),c.support.transition&&this.$element.hasClass("slide")?(a.addClass(t),"object"==typeof a&&a.length&&a[0].offsetWidth,n.addClass(l),a.addClass(l),n.one("bsTransitionEnd",function(){a.removeClass([t,l].join(" ")).addClass("active"),n.removeClass(["active",l].join(" ")),r.sliding=!1,setTimeout(function(){r.$element.trigger(o)},0)}).emulateTransitionEnd(d.TRANSITION_DURATION)):(n.removeClass("active"),a.addClass("active"),this.sliding=!1,this.$element.trigger(o)),e&&this.cycle(),this))};function t(t){var e,i=c(this),s=(s=i.attr("href"))&&s.replace(/.*(?=#[^\s]+$)/,""),s=i.attr("data-target")||s;(s=c(document).find(s)).hasClass("carousel")&&(e=c.extend({},s.data(),i.data()),(i=i.attr("data-slide-to"))&&(e.interval=!1),o.call(s,e),i&&s.data("bs.carousel").to(i),t.preventDefault())}var e=c.fn.carousel;c.fn.carousel=o,c.fn.carousel.Constructor=d,c.fn.carousel.noConflict=function(){return c.fn.carousel=e,this};c(document).on("click.bs.carousel.data-api","[data-slide]",t).on("click.bs.carousel.data-api","[data-slide-to]",t),c(window).on("load",function(){c('[data-ride="carousel"]').each(function(){var t=c(this);o.call(t,t.data())})})}(jQuery),!function(o){"use strict";function n(t,e){this.$element=o(t),this.options=o.extend({},n.DEFAULTS,e),this.$trigger=o('[data-toggle="collapse"][href="#'+t.id+'"],[data-toggle="collapse"][data-target="#'+t.id+'"]'),this.transitioning=null,this.options.parent?this.$parent=this.getParent():this.addAriaAndCollapsedClass(this.$element,this.$trigger),this.options.toggle&&this.toggle()}function i(t){t=t.attr("data-target")||(t=t.attr("href"))&&t.replace(/.*(?=#[^\s]+$)/,"");return o(document).find(t)}function a(s){return this.each(function(){var t=o(this),e=t.data("bs.collapse"),i=o.extend({},n.DEFAULTS,t.data(),"object"==typeof s&&s);!e&&i.toggle&&/show|hide/.test(s)&&(i.toggle=!1),e||t.data("bs.collapse",e=new n(this,i)),"string"==typeof s&&e[s]()})}n.VERSION="3.4.1",n.TRANSITION_DURATION=350,n.DEFAULTS={toggle:!0},n.prototype.dimension=function(){return this.$element.hasClass("width")?"width":"height"},n.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var t=this.$parent&&this.$parent.children(".panel").children(".in, .collapsing");if(!(t&&t.length&&(s=t.data("bs.collapse"))&&s.transitioning)){var e=o.Event("show.bs.collapse");if(this.$element.trigger(e),!e.isDefaultPrevented()){t&&t.length&&(a.call(t,"hide"),s||t.data("bs.collapse",null));var i=this.dimension(),e=(this.$element.removeClass("collapse").addClass("collapsing")[i](0).attr("aria-expanded",!0),this.$trigger.removeClass("collapsed").attr("aria-expanded",!0),this.transitioning=1,function(){this.$element.removeClass("collapsing").addClass("collapse in")[i](""),this.transitioning=0,this.$element.trigger("shown.bs.collapse")});if(!o.support.transition)return e.call(this);var s=o.camelCase(["scroll",i].join("-"));this.$element.one("bsTransitionEnd",o.proxy(e,this)).emulateTransitionEnd(n.TRANSITION_DURATION)[i](this.$element[0][s])}}}},n.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var t=o.Event("hide.bs.collapse");if(this.$element.trigger(t),!t.isDefaultPrevented()){var t=this.dimension(),e=(this.$element[t](this.$element[t]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse in").attr("aria-expanded",!1),this.$trigger.addClass("collapsed").attr("aria-expanded",!1),this.transitioning=1,function(){this.transitioning=0,this.$element.removeClass("collapsing").addClass("collapse").trigger("hidden.bs.collapse")});if(!o.support.transition)return e.call(this);this.$element[t](0).one("bsTransitionEnd",o.proxy(e,this)).emulateTransitionEnd(n.TRANSITION_DURATION)}}},n.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()},n.prototype.getParent=function(){return o(document).find(this.options.parent).find('[data-toggle="collapse"][data-parent="'+this.options.parent+'"]').each(o.proxy(function(t,e){e=o(e);this.addAriaAndCollapsedClass(i(e),e)},this)).end()},n.prototype.addAriaAndCollapsedClass=function(t,e){var i=t.hasClass("in");t.attr("aria-expanded",i),e.toggleClass("collapsed",!i).attr("aria-expanded",i)};var t=o.fn.collapse;o.fn.collapse=a,o.fn.collapse.Constructor=n,o.fn.collapse.noConflict=function(){return o.fn.collapse=t,this},o(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(t){var e=o(this),t=(e.attr("data-target")||t.preventDefault(),i(e)),e=t.data("bs.collapse")?"toggle":e.data();a.call(t,e)})}(jQuery),!function(o){"use strict";function s(t){o(t).on("click.bs.dropdown",this.toggle)}var n='[data-toggle="dropdown"]';function a(t){var e=t.attr("data-target"),e="#"!==(e=e||(e=t.attr("href"))&&/#[A-Za-z]/.test(e)&&e.replace(/.*(?=#[^\s]*$)/,""))?o(document).find(e):null;return e&&e.length?e:t.parent()}function l(s){s&&3===s.which||(o(".dropdown-backdrop").remove(),o(n).each(function(){var t=o(this),e=a(t),i={relatedTarget:this};!e.hasClass("open")||s&&"click"==s.type&&/input|textarea/i.test(s.target.tagName)&&o.contains(e[0],s.target)||(e.trigger(s=o.Event("hide.bs.dropdown",i)),s.isDefaultPrevented()||(t.attr("aria-expanded","false"),e.removeClass("open").trigger(o.Event("hidden.bs.dropdown",i))))}))}s.VERSION="3.4.1",s.prototype.toggle=function(t){var e=o(this);if(!e.is(".disabled, :disabled")){var i=a(e),s=i.hasClass("open");if(l(),!s){"ontouchstart"in document.documentElement&&!i.closest(".navbar-nav").length&&o(document.createElement("div")).addClass("dropdown-backdrop").insertAfter(o(this)).on("click",l);s={relatedTarget:this};if(i.trigger(t=o.Event("show.bs.dropdown",s)),t.isDefaultPrevented())return;e.trigger("focus").attr("aria-expanded","true"),i.toggleClass("open").trigger(o.Event("shown.bs.dropdown",s))}return!1}},s.prototype.keydown=function(t){if(/(38|40|27|32)/.test(t.which)&&!/input|textarea/i.test(t.target.tagName)){var e=o(this);if(t.preventDefault(),t.stopPropagation(),!e.is(".disabled, :disabled")){var i=a(e),s=i.hasClass("open");if(!s&&27!=t.which||s&&27==t.which)return 27==t.which&&i.find(n).trigger("focus"),e.trigger("click");s=i.find(".dropdown-menu li:not(.disabled):visible a");s.length&&(e=s.index(t.target),38==t.which&&0<e&&e--,40==t.which&&e<s.length-1&&e++,s.eq(e=~e?e:0).trigger("focus"))}}};var t=o.fn.dropdown;o.fn.dropdown=function(i){return this.each(function(){var t=o(this),e=t.data("bs.dropdown");e||t.data("bs.dropdown",e=new s(this)),"string"==typeof i&&e[i].call(t)})},o.fn.dropdown.Constructor=s,o.fn.dropdown.noConflict=function(){return o.fn.dropdown=t,this},o(document).on("click.bs.dropdown.data-api",l).on("click.bs.dropdown.data-api",".dropdown form",function(t){t.stopPropagation()}).on("click.bs.dropdown.data-api",n,s.prototype.toggle).on("keydown.bs.dropdown.data-api",n,s.prototype.keydown).on("keydown.bs.dropdown.data-api",".dropdown-menu",s.prototype.keydown)}(jQuery),!function(n){"use strict";function a(t,e){this.options=e,this.$body=n(document.body),this.$element=n(t),this.$dialog=this.$element.find(".modal-dialog"),this.$backdrop=null,this.isShown=null,this.originalBodyPad=null,this.scrollbarWidth=0,this.ignoreBackdropClick=!1,this.fixedContent=".navbar-fixed-top, .navbar-fixed-bottom",this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,n.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))}function l(s,o){return this.each(function(){var t=n(this),e=t.data("bs.modal"),i=n.extend({},a.DEFAULTS,t.data(),"object"==typeof s&&s);e||t.data("bs.modal",e=new a(this,i)),"string"==typeof s?e[s](o):i.show&&e.show(o)})}a.VERSION="3.4.1",a.TRANSITION_DURATION=300,a.BACKDROP_TRANSITION_DURATION=150,a.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},a.prototype.toggle=function(t){return this.isShown?this.hide():this.show(t)},a.prototype.show=function(i){var s=this,t=n.Event("show.bs.modal",{relatedTarget:i});this.$element.trigger(t),this.isShown||t.isDefaultPrevented()||(this.isShown=!0,this.checkScrollbar(),this.setScrollbar(),this.$body.addClass("modal-open"),this.escape(),this.resize(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',n.proxy(this.hide,this)),this.$dialog.on("mousedown.dismiss.bs.modal",function(){s.$element.one("mouseup.dismiss.bs.modal",function(t){n(t.target).is(s.$element)&&(s.ignoreBackdropClick=!0)})}),this.backdrop(function(){var t=n.support.transition&&s.$element.hasClass("fade"),e=(s.$element.parent().length||s.$element.appendTo(s.$body),s.$element.show().scrollTop(0),s.adjustDialog(),t&&s.$element[0].offsetWidth,s.$element.addClass("in"),s.enforceFocus(),n.Event("shown.bs.modal",{relatedTarget:i}));t?s.$dialog.one("bsTransitionEnd",function(){s.$element.trigger("focus").trigger(e)}).emulateTransitionEnd(a.TRANSITION_DURATION):s.$element.trigger("focus").trigger(e)}))},a.prototype.hide=function(t){t&&t.preventDefault(),t=n.Event("hide.bs.modal"),this.$element.trigger(t),this.isShown&&!t.isDefaultPrevented()&&(this.isShown=!1,this.escape(),this.resize(),n(document).off("focusin.bs.modal"),this.$element.removeClass("in").off("click.dismiss.bs.modal").off("mouseup.dismiss.bs.modal"),this.$dialog.off("mousedown.dismiss.bs.modal"),n.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",n.proxy(this.hideModal,this)).emulateTransitionEnd(a.TRANSITION_DURATION):this.hideModal())},a.prototype.enforceFocus=function(){n(document).off("focusin.bs.modal").on("focusin.bs.modal",n.proxy(function(t){document===t.target||this.$element[0]===t.target||this.$element.has(t.target).length||this.$element.trigger("focus")},this))},a.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keydown.dismiss.bs.modal",n.proxy(function(t){27==t.which&&this.hide()},this)):this.isShown||this.$element.off("keydown.dismiss.bs.modal")},a.prototype.resize=function(){this.isShown?n(window).on("resize.bs.modal",n.proxy(this.handleUpdate,this)):n(window).off("resize.bs.modal")},a.prototype.hideModal=function(){var t=this;this.$element.hide(),this.backdrop(function(){t.$body.removeClass("modal-open"),t.resetAdjustments(),t.resetScrollbar(),t.$element.trigger("hidden.bs.modal")})},a.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},a.prototype.backdrop=function(t){var e,i=this,s=this.$element.hasClass("fade")?"fade":"";this.isShown&&this.options.backdrop?(e=n.support.transition&&s,this.$backdrop=n(document.createElement("div")).addClass("modal-backdrop "+s).appendTo(this.$body),this.$element.on("click.dismiss.bs.modal",n.proxy(function(t){this.ignoreBackdropClick?this.ignoreBackdropClick=!1:t.target===t.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus():this.hide())},this)),e&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),t&&(e?this.$backdrop.one("bsTransitionEnd",t).emulateTransitionEnd(a.BACKDROP_TRANSITION_DURATION):t())):!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),s=function(){i.removeBackdrop(),t&&t()},n.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",s).emulateTransitionEnd(a.BACKDROP_TRANSITION_DURATION):s()):t&&t()},a.prototype.handleUpdate=function(){this.adjustDialog()},a.prototype.adjustDialog=function(){var t=this.$element[0].scrollHeight>document.documentElement.clientHeight;this.$element.css({paddingLeft:!this.bodyIsOverflowing&&t?this.scrollbarWidth:"",paddingRight:this.bodyIsOverflowing&&!t?this.scrollbarWidth:""})},a.prototype.resetAdjustments=function(){this.$element.css({paddingLeft:"",paddingRight:""})},a.prototype.checkScrollbar=function(){var t,e=window.innerWidth;e||(e=(t=document.documentElement.getBoundingClientRect()).right-Math.abs(t.left)),this.bodyIsOverflowing=document.body.clientWidth<e,this.scrollbarWidth=this.measureScrollbar()},a.prototype.setScrollbar=function(){var t=parseInt(this.$body.css("padding-right")||0,10),o=(this.originalBodyPad=document.body.style.paddingRight||"",this.scrollbarWidth);this.bodyIsOverflowing&&(this.$body.css("padding-right",t+o),n(this.fixedContent).each(function(t,e){var i=e.style.paddingRight,s=n(e).css("padding-right");n(e).data("padding-right",i).css("padding-right",parseFloat(s)+o+"px")}))},a.prototype.resetScrollbar=function(){this.$body.css("padding-right",this.originalBodyPad),n(this.fixedContent).each(function(t,e){var i=n(e).data("padding-right");n(e).removeData("padding-right"),e.style.paddingRight=i||""})},a.prototype.measureScrollbar=function(){var t=document.createElement("div"),e=(t.className="modal-scrollbar-measure",this.$body.append(t),t.offsetWidth-t.clientWidth);return this.$body[0].removeChild(t),e};var t=n.fn.modal;n.fn.modal=l,n.fn.modal.Constructor=a,n.fn.modal.noConflict=function(){return n.fn.modal=t,this},n(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(t){var e=n(this),i=e.attr("href"),s=e.attr("data-target")||i&&i.replace(/.*(?=#[^\s]+$)/,""),o=n(document).find(s),s=o.data("bs.modal")?"toggle":n.extend({remote:!/#/.test(i)&&i},o.data(),e.data());e.is("a")&&t.preventDefault(),o.one("show.bs.modal",function(t){t.isDefaultPrevented()||o.one("hidden.bs.modal",function(){e.is(":visible")&&e.trigger("focus")})}),l.call(o,s,this)})}(jQuery),!function(m){"use strict";var s=["sanitize","whiteList","sanitizeFn"],u=["background","cite","href","itemtype","longdesc","poster","src","xlink:href"],t={"*":["class","dir","id","lang","role",/^aria-[\w-]*$/i],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],div:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},g=/^(?:(?:https?|mailto|ftp|tel|file):|[^&:/?#]*(?:[/?#]|$))/gi,b=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+/]+=*$/i;function o(t,e,i){if(0===t.length)return t;if(i&&"function"==typeof i)return i(t);if(!document.implementation||!document.implementation.createHTMLDocument)return t;for(var i=document.implementation.createHTMLDocument("sanitization"),s=(i.body.innerHTML=t,m.map(e,function(t,e){return e})),o=m(i.body).find("*"),n=0,a=o.length;n<a;n++){var l=o[n],r=l.nodeName.toLowerCase();if(-1===m.inArray(r,s))l.parentNode.removeChild(l);else for(var c=m.map(l.attributes,function(t){return t}),d=[].concat(e["*"]||[],e[r]||[]),h=0,p=c.length;h<p;h++)!function(t,e){var i=t.nodeName.toLowerCase();if(-1!==m.inArray(i,e))return-1===m.inArray(i,u)||Boolean(t.nodeValue.match(g)||t.nodeValue.match(b));for(var s=m(e).filter(function(t,e){return e instanceof RegExp}),o=0,n=s.length;o<n;o++)if(i.match(s[o]))return 1}(c[h],d)&&l.removeAttribute(c[h].nodeName)}return i.body.innerHTML}function r(t,e){this.type=null,this.options=null,this.enabled=null,this.timeout=null,this.hoverState=null,this.$element=null,this.inState=null,this.init("tooltip",t,e)}r.VERSION="3.4.1",r.TRANSITION_DURATION=150,r.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0},sanitize:!0,sanitizeFn:null,whiteList:t},r.prototype.init=function(t,e,i){if(this.enabled=!0,this.type=t,this.$element=m(e),this.options=this.getOptions(i),this.$viewport=this.options.viewport&&m(document).find(m.isFunction(this.options.viewport)?this.options.viewport.call(this,this.$element):this.options.viewport.selector||this.options.viewport),this.inState={click:!1,hover:!1,focus:!1},this.$element[0]instanceof document.constructor&&!this.options.selector)throw new Error("`selector` option must be specified when initializing "+this.type+" on the window.document object!");for(var s=this.options.trigger.split(" "),o=s.length;o--;){var n,a=s[o];"click"==a?this.$element.on("click."+this.type,this.options.selector,m.proxy(this.toggle,this)):"manual"!=a&&(n="hover"==a?"mouseleave":"focusout",this.$element.on(("hover"==a?"mouseenter":"focusin")+"."+this.type,this.options.selector,m.proxy(this.enter,this)),this.$element.on(n+"."+this.type,this.options.selector,m.proxy(this.leave,this)))}this.options.selector?this._options=m.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},r.prototype.getDefaults=function(){return r.DEFAULTS},r.prototype.getOptions=function(t){var e,i=this.$element.data();for(e in i)i.hasOwnProperty(e)&&-1!==m.inArray(e,s)&&delete i[e];return(t=m.extend({},this.getDefaults(),i,t)).delay&&"number"==typeof t.delay&&(t.delay={show:t.delay,hide:t.delay}),t.sanitize&&(t.template=o(t.template,t.whiteList,t.sanitizeFn)),t},r.prototype.getDelegateOptions=function(){var i={},s=this.getDefaults();return this._options&&m.each(this._options,function(t,e){s[t]!=e&&(i[t]=e)}),i},r.prototype.enter=function(t){var e=t instanceof this.constructor?t:m(t.currentTarget).data("bs."+this.type);if(e||(e=new this.constructor(t.currentTarget,this.getDelegateOptions()),m(t.currentTarget).data("bs."+this.type,e)),t instanceof m.Event&&(e.inState["focusin"==t.type?"focus":"hover"]=!0),e.tip().hasClass("in")||"in"==e.hoverState)e.hoverState="in";else{if(clearTimeout(e.timeout),e.hoverState="in",!e.options.delay||!e.options.delay.show)return e.show();e.timeout=setTimeout(function(){"in"==e.hoverState&&e.show()},e.options.delay.show)}},r.prototype.isInStateTrue=function(){for(var t in this.inState)if(this.inState[t])return!0;return!1},r.prototype.leave=function(t){var e=t instanceof this.constructor?t:m(t.currentTarget).data("bs."+this.type);if(e||(e=new this.constructor(t.currentTarget,this.getDelegateOptions()),m(t.currentTarget).data("bs."+this.type,e)),t instanceof m.Event&&(e.inState["focusout"==t.type?"focus":"hover"]=!1),!e.isInStateTrue()){if(clearTimeout(e.timeout),e.hoverState="out",!e.options.delay||!e.options.delay.hide)return e.hide();e.timeout=setTimeout(function(){"out"==e.hoverState&&e.hide()},e.options.delay.hide)}},r.prototype.show=function(){var e,t,i,s,o,n,a,l=m.Event("show.bs."+this.type);this.hasContent()&&this.enabled&&(this.$element.trigger(l),o=m.contains(this.$element[0].ownerDocument.documentElement,this.$element[0]),!l.isDefaultPrevented()&&o&&(l=(e=this).tip(),o=this.getUID(this.type),this.setContent(),l.attr("id",o),this.$element.attr("aria-describedby",o),this.options.animation&&l.addClass("fade"),o="function"==typeof this.options.placement?this.options.placement.call(this,l[0],this.$element[0]):this.options.placement,(a=(t=/\s?auto?\s?/i).test(o))&&(o=o.replace(t,"")||"top"),l.detach().css({top:0,left:0,display:"block"}).addClass(o).data("bs."+this.type,this),this.options.container?l.appendTo(m(document).find(this.options.container)):l.insertAfter(this.$element),this.$element.trigger("inserted.bs."+this.type),t=this.getPosition(),i=l[0].offsetWidth,s=l[0].offsetHeight,a&&(a=o,n=this.getPosition(this.$viewport),o="bottom"==o&&t.bottom+s>n.bottom?"top":"top"==o&&t.top-s<n.top?"bottom":"right"==o&&t.right+i>n.width?"left":"left"==o&&t.left-i<n.left?"right":o,l.removeClass(a).addClass(o)),n=this.getCalculatedOffset(o,t,i,s),this.applyPlacement(n,o),a=function(){var t=e.hoverState;e.$element.trigger("shown.bs."+e.type),e.hoverState=null,"out"==t&&e.leave(e)},m.support.transition&&this.$tip.hasClass("fade")?l.one("bsTransitionEnd",a).emulateTransitionEnd(r.TRANSITION_DURATION):a()))},r.prototype.applyPlacement=function(t,e){var i=this.tip(),s=i[0].offsetWidth,o=i[0].offsetHeight,n=parseInt(i.css("margin-top"),10),a=parseInt(i.css("margin-left"),10),n=(isNaN(n)&&(n=0),isNaN(a)&&(a=0),t.top+=n,t.left+=a,m.offset.setOffset(i[0],m.extend({using:function(t){i.css({top:Math.round(t.top),left:Math.round(t.left)})}},t),0),i.addClass("in"),i[0].offsetWidth),a=i[0].offsetHeight,l=("top"==e&&a!=o&&(t.top=t.top+o-a),this.getViewportAdjustedDelta(e,t,n,a)),e=(l.left?t.left+=l.left:t.top+=l.top,/top|bottom/.test(e)),s=e?2*l.left-s+n:2*l.top-o+a,n=e?"offsetWidth":"offsetHeight";i.offset(t),this.replaceArrow(s,i[0][n],e)},r.prototype.replaceArrow=function(t,e,i){this.arrow().css(i?"left":"top",50*(1-t/e)+"%").css(i?"top":"left","")},r.prototype.setContent=function(){var t=this.tip(),e=this.getTitle();this.options.html?(this.options.sanitize&&(e=o(e,this.options.whiteList,this.options.sanitizeFn)),t.find(".tooltip-inner").html(e)):t.find(".tooltip-inner").text(e),t.removeClass("fade in top bottom left right")},r.prototype.hide=function(t){var e=this,i=m(this.$tip),s=m.Event("hide.bs."+this.type);function o(){"in"!=e.hoverState&&i.detach(),e.$element&&e.$element.removeAttr("aria-describedby").trigger("hidden.bs."+e.type),t&&t()}if(this.$element.trigger(s),!s.isDefaultPrevented())return i.removeClass("in"),m.support.transition&&i.hasClass("fade")?i.one("bsTransitionEnd",o).emulateTransitionEnd(r.TRANSITION_DURATION):o(),this.hoverState=null,this},r.prototype.fixTitle=function(){var t=this.$element;!t.attr("title")&&"string"==typeof t.attr("data-original-title")||t.attr("data-original-title",t.attr("title")||"").attr("title","")},r.prototype.hasContent=function(){return this.getTitle()},r.prototype.getPosition=function(t){var e=(t=t||this.$element)[0],i="BODY"==e.tagName,s=e.getBoundingClientRect(),e=(null==s.width&&(s=m.extend({},s,{width:s.right-s.left,height:s.bottom-s.top})),window.SVGElement&&e instanceof window.SVGElement),e=i?{top:0,left:0}:e?null:t.offset(),t={scroll:i?document.documentElement.scrollTop||document.body.scrollTop:t.scrollTop()},i=i?{width:m(window).width(),height:m(window).height()}:null;return m.extend({},s,t,i,e)},r.prototype.getCalculatedOffset=function(t,e,i,s){return"bottom"==t?{top:e.top+e.height,left:e.left+e.width/2-i/2}:"top"==t?{top:e.top-s,left:e.left+e.width/2-i/2}:"left"==t?{top:e.top+e.height/2-s/2,left:e.left-i}:{top:e.top+e.height/2-s/2,left:e.left+e.width}},r.prototype.getViewportAdjustedDelta=function(t,e,i,s){var o,n,a={top:0,left:0};return this.$viewport&&(o=this.options.viewport&&this.options.viewport.padding||0,n=this.getPosition(this.$viewport),/right|left/.test(t)?(t=e.top-o-n.scroll,s=e.top+o-n.scroll+s,t<n.top?a.top=n.top-t:s>n.top+n.height&&(a.top=n.top+n.height-s)):(t=e.left-o,s=e.left+o+i,t<n.left?a.left=n.left-t:s>n.right&&(a.left=n.left+n.width-s))),a},r.prototype.getTitle=function(){var t=this.$element,e=this.options;return t.attr("data-original-title")||("function"==typeof e.title?e.title.call(t[0]):e.title)},r.prototype.getUID=function(t){for(;t+=~~(1e6*Math.random()),document.getElementById(t););return t},r.prototype.tip=function(){if(this.$tip||(this.$tip=m(this.options.template),1==this.$tip.length))return this.$tip;throw new Error(this.type+" `template` option must consist of exactly 1 top-level element!")},r.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},r.prototype.enable=function(){this.enabled=!0},r.prototype.disable=function(){this.enabled=!1},r.prototype.toggleEnabled=function(){this.enabled=!this.enabled},r.prototype.toggle=function(t){var e=this;t&&!(e=m(t.currentTarget).data("bs."+this.type))&&(e=new this.constructor(t.currentTarget,this.getDelegateOptions()),m(t.currentTarget).data("bs."+this.type,e)),t?(e.inState.click=!e.inState.click,e.isInStateTrue()?e.enter(e):e.leave(e)):e.tip().hasClass("in")?e.leave(e):e.enter(e)},r.prototype.destroy=function(){var t=this;clearTimeout(this.timeout),this.hide(function(){t.$element.off("."+t.type).removeData("bs."+t.type),t.$tip&&t.$tip.detach(),t.$tip=null,t.$arrow=null,t.$viewport=null,t.$element=null})},r.prototype.sanitizeHtml=function(t){return o(t,this.options.whiteList,this.options.sanitizeFn)};var e=m.fn.tooltip;m.fn.tooltip=function(s){return this.each(function(){var t=m(this),e=t.data("bs.tooltip"),i="object"==typeof s&&s;!e&&/destroy|hide/.test(s)||(e||t.data("bs.tooltip",e=new r(this,i)),"string"==typeof s&&e[s]())})},m.fn.tooltip.Constructor=r,m.fn.tooltip.noConflict=function(){return m.fn.tooltip=e,this}}(jQuery),!function(o){"use strict";function n(t,e){this.init("popover",t,e)}if(!o.fn.tooltip)throw new Error("Popover requires tooltip.js");n.VERSION="3.4.1",n.DEFAULTS=o.extend({},o.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),((n.prototype=o.extend({},o.fn.tooltip.Constructor.prototype)).constructor=n).prototype.getDefaults=function(){return n.DEFAULTS},n.prototype.setContent=function(){var t,e=this.tip(),i=this.getTitle(),s=this.getContent();this.options.html?(t=typeof s,this.options.sanitize&&(i=this.sanitizeHtml(i),"string"==t&&(s=this.sanitizeHtml(s))),e.find(".popover-title").html(i),e.find(".popover-content").children().detach().end()["string"==t?"html":"append"](s)):(e.find(".popover-title").text(i),e.find(".popover-content").children().detach().end().text(s)),e.removeClass("fade top bottom left right in"),e.find(".popover-title").html()||e.find(".popover-title").hide()},n.prototype.hasContent=function(){return this.getTitle()||this.getContent()},n.prototype.getContent=function(){var t=this.$element,e=this.options;return t.attr("data-content")||("function"==typeof e.content?e.content.call(t[0]):e.content)},n.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")};var t=o.fn.popover;o.fn.popover=function(s){return this.each(function(){var t=o(this),e=t.data("bs.popover"),i="object"==typeof s&&s;!e&&/destroy|hide/.test(s)||(e||t.data("bs.popover",e=new n(this,i)),"string"==typeof s&&e[s]())})},o.fn.popover.Constructor=n,o.fn.popover.noConflict=function(){return o.fn.popover=t,this}}(jQuery),!function(o){"use strict";function s(t,e){this.$body=o(document.body),this.$scrollElement=o(t).is(document.body)?o(window):o(t),this.options=o.extend({},s.DEFAULTS,e),this.selector=(this.options.target||"")+" .nav li > a",this.offsets=[],this.targets=[],this.activeTarget=null,this.scrollHeight=0,this.$scrollElement.on("scroll.bs.scrollspy",o.proxy(this.process,this)),this.refresh(),this.process()}function e(i){return this.each(function(){var t=o(this),e=t.data("bs.scrollspy");e||t.data("bs.scrollspy",e=new s(this,"object"==typeof i&&i)),"string"==typeof i&&e[i]()})}s.VERSION="3.4.1",s.DEFAULTS={offset:10},s.prototype.getScrollHeight=function(){return this.$scrollElement[0].scrollHeight||Math.max(this.$body[0].scrollHeight,document.documentElement.scrollHeight)},s.prototype.refresh=function(){var t=this,i="offset",s=0;this.offsets=[],this.targets=[],this.scrollHeight=this.getScrollHeight(),o.isWindow(this.$scrollElement[0])||(i="position",s=this.$scrollElement.scrollTop()),this.$body.find(this.selector).map(function(){var t=o(this),t=t.data("target")||t.attr("href"),e=/^#./.test(t)&&o(t);return e&&e.length&&e.is(":visible")?[[e[i]().top+s,t]]:null}).sort(function(t,e){return t[0]-e[0]}).each(function(){t.offsets.push(this[0]),t.targets.push(this[1])})},s.prototype.process=function(){var t,e=this.$scrollElement.scrollTop()+this.options.offset,i=this.getScrollHeight(),s=this.options.offset+i-this.$scrollElement.height(),o=this.offsets,n=this.targets,a=this.activeTarget;if(this.scrollHeight!=i&&this.refresh(),s<=e)return a!=(t=n[n.length-1])&&this.activate(t);if(a&&e<o[0])return this.activeTarget=null,this.clear();for(t=o.length;t--;)a!=n[t]&&e>=o[t]&&(void 0===o[t+1]||e<o[t+1])&&this.activate(n[t])},s.prototype.activate=function(t){this.activeTarget=t,this.clear();t=this.selector+'[data-target="'+t+'"],'+this.selector+'[href="'+t+'"]',t=o(t).parents("li").addClass("active");(t=t.parent(".dropdown-menu").length?t.closest("li.dropdown").addClass("active"):t).trigger("activate.bs.scrollspy")},s.prototype.clear=function(){o(this.selector).parentsUntil(this.options.target,".active").removeClass("active")};var t=o.fn.scrollspy;o.fn.scrollspy=e,o.fn.scrollspy.Constructor=s,o.fn.scrollspy.noConflict=function(){return o.fn.scrollspy=t,this},o(window).on("load.bs.scrollspy.data-api",function(){o('[data-spy="scroll"]').each(function(){var t=o(this);e.call(t,t.data())})})}(jQuery),!function(a){"use strict";function l(t){this.element=a(t)}function e(i){return this.each(function(){var t=a(this),e=t.data("bs.tab");e||t.data("bs.tab",e=new l(this)),"string"==typeof i&&e[i]()})}l.VERSION="3.4.1",l.TRANSITION_DURATION=150,l.prototype.show=function(){var t,e,i,s=this.element,o=s.closest("ul:not(.dropdown-menu)"),n=(n=s.data("target"))||(n=s.attr("href"))&&n.replace(/.*(?=#[^\s]*$)/,"");s.parent("li").hasClass("active")||(t=o.find(".active:last a"),e=a.Event("hide.bs.tab",{relatedTarget:s[0]}),i=a.Event("show.bs.tab",{relatedTarget:t[0]}),t.trigger(e),s.trigger(i),i.isDefaultPrevented()||e.isDefaultPrevented()||(i=a(document).find(n),this.activate(s.closest("li"),o),this.activate(i,i.parent(),function(){t.trigger({type:"hidden.bs.tab",relatedTarget:s[0]}),s.trigger({type:"shown.bs.tab",relatedTarget:t[0]})})))},l.prototype.activate=function(t,e,i){var s=e.find("> .active"),o=i&&a.support.transition&&(s.length&&s.hasClass("fade")||!!e.find("> .fade").length);function n(){s.removeClass("active").find("> .dropdown-menu > .active").removeClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!1),t.addClass("active").find('[data-toggle="tab"]').attr("aria-expanded",!0),o?(t[0].offsetWidth,t.addClass("in")):t.removeClass("fade"),t.parent(".dropdown-menu").length&&t.closest("li.dropdown").addClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!0),i&&i()}s.length&&o?s.one("bsTransitionEnd",n).emulateTransitionEnd(l.TRANSITION_DURATION):n(),s.removeClass("in")};function t(t){t.preventDefault(),e.call(a(this),"show")}var i=a.fn.tab;a.fn.tab=e,a.fn.tab.Constructor=l,a.fn.tab.noConflict=function(){return a.fn.tab=i,this};a(document).on("click.bs.tab.data-api",'[data-toggle="tab"]',t).on("click.bs.tab.data-api",'[data-toggle="pill"]',t)}(jQuery),!function(a){"use strict";function l(t,e){this.options=a.extend({},l.DEFAULTS,e),e=this.options.target===l.DEFAULTS.target?a(this.options.target):a(document).find(this.options.target),this.$target=e.on("scroll.bs.affix.data-api",a.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",a.proxy(this.checkPositionWithEventLoop,this)),this.$element=a(t),this.affixed=null,this.unpin=null,this.pinnedOffset=null,this.checkPosition()}function i(i){return this.each(function(){var t=a(this),e=t.data("bs.affix");e||t.data("bs.affix",e=new l(this,"object"==typeof i&&i)),"string"==typeof i&&e[i]()})}l.VERSION="3.4.1",l.RESET="affix affix-top affix-bottom",l.DEFAULTS={offset:0,target:window},l.prototype.getState=function(t,e,i,s){var o,n=this.$target.scrollTop(),a=this.$element.offset(),l=this.$target.height();return null!=i&&"top"==this.affixed?n<i&&"top":"bottom"==this.affixed?null!=i?!(n+this.unpin<=a.top)&&"bottom":!(n+l<=t-s)&&"bottom":(a=(o=null==this.affixed)?n:a.top,null!=i&&n<=i?"top":null!=s&&t-s<=a+(o?l:e)&&"bottom")},l.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(l.RESET).addClass("affix");var t=this.$target.scrollTop(),e=this.$element.offset();return this.pinnedOffset=e.top-t},l.prototype.checkPositionWithEventLoop=function(){setTimeout(a.proxy(this.checkPosition,this),1)},l.prototype.checkPosition=function(){if(this.$element.is(":visible")){var t=this.$element.height(),e=this.options.offset,i=e.top,s=e.bottom,o=Math.max(a(document).height(),a(document.body).height()),e=("object"!=typeof e&&(s=i=e),"function"==typeof i&&(i=e.top(this.$element)),"function"==typeof s&&(s=e.bottom(this.$element)),this.getState(o,t,i,s));if(this.affixed!=e){null!=this.unpin&&this.$element.css("top","");var i="affix"+(e?"-"+e:""),n=a.Event(i+".bs.affix");if(this.$element.trigger(n),n.isDefaultPrevented())return;this.affixed=e,this.unpin="bottom"==e?this.getPinnedOffset():null,this.$element.removeClass(l.RESET).addClass(i).trigger(i.replace("affix","affixed")+".bs.affix")}"bottom"==e&&this.$element.offset({top:o-t-s})}};var t=a.fn.affix;a.fn.affix=i,a.fn.affix.Constructor=l,a.fn.affix.noConflict=function(){return a.fn.affix=t,this},a(window).on("load",function(){a('[data-spy="affix"]').each(function(){var t=a(this),e=t.data();e.offset=e.offset||{},null!=e.offsetBottom&&(e.offset.bottom=e.offsetBottom),null!=e.offsetTop&&(e.offset.top=e.offsetTop),i.call(t,e)})})}(jQuery),define("bootstrap",["jquery"],function(){}),void 0===Common&&(Common={}),define("notification",["backbone"],function(t){"use strict";function e(){}if(_.extend(e.prototype,t.Events),void 0!==Common.NotificationCenter)throw"Native Common.NotificationCenter instance already defined.";e.extend=t.Model.extend,Common.NotificationCenter=new e}),!function(){function o(t,e){for(var i=t.split("."),s=e||window,o=0,n=i.length;o<n;o++)s=s[i[o]]||{};return s}function t(t){_.extend(this,t||{}),this.eventbus=new i({application:this}),this.createApplicationNamespace(),this.initialize.apply(this,arguments),!1!==this.autoCreate&&$($.proxy(this.onReady,this))}if(_.extend(t.prototype,{nameSpace:"Application",models:{},collections:{},controllers:{},allocationMap:{model:"Models",collection:"Collections",controller:"Controllers",view:"Views"},createApplicationNamespace:function(){var t=window;this.nameSpace&&void 0===t[this.nameSpace]&&(t[this.nameSpace]={}),t[this.nameSpace]=this,_.each(this.allocationMap,function(t,e){this[t]=this[t]||{}},this)},initialize:function(){},onReady:function(){this.start()},start:function(){this.initializeControllers(this.controllers||{}),this.launchControllers(),this.launch.call(this)},getClasseRefs:function(t,e){var i={},s=this[this.allocationMap[t]];return _.each(e,function(t){i[t]=o(t,-1<t.indexOf(".")?window:s)},this),i},initializeControllers:function(t){this.controllers={},_.each(t,function(t){var e=-1<t.indexOf(".")?window:this[this.allocationMap.controller],e=o(t,e),e=(t.split(".").pop(),new e({id:t,application:this}));e.views=this.getClasseRefs("view",e.views||[]),_.extend(this.models,this.getClasseRefs("model",e.models||[])),_.extend(this.collections,this.getClasseRefs("collection",e.collections||{})),this.buildCollections(),this.controllers[t]=e},this)},launchControllers:function(){_.each(this.controllers,function(t,e){t.onLaunch(this)},this)},launch:function(){},addListeners:function(t,e){this.eventbus.addListeners(t,e)},getController:function(t){return this.controllers[t]},getModel:function(t){this._modelsCache=this._modelsCache||{};var e=this._modelsCache[t],i=this.getModelConstructor(t);return!e&&i&&(e=this.createModel(t),this._modelsCache[t]=e),e||null},getModelConstructor:function(t){return this.models[t]},createModel:function(t,e){var t=this.getModelConstructor(t),i=null;return i=t?new t(_.extend(e||{})):i},getCollection:function(t){this._collectionsCache=this._collectionsCache||{};var e=this._collectionsCache[t],i=this.getCollectionConstructor(t);return!e&&i&&(e=this.createCollection(t),this._collectionsCache[t]=e),e||null},getCollectionConstructor:function(t){return this.collections[t]},createCollection:function(t){var t=this.getCollectionConstructor(t),e=null;return e=t?new t:e},buildCollections:function(){_.each(this.collections,function(t,e){this.getCollection(e)},this)}}),void 0!==Backbone.Application)throw"Native Backbone.Application instance already defined.";Backbone.Application=t,Backbone.Application.extend=Backbone.Model.extend;function e(t){_.extend(this,t||{}),this.initialize.apply(this,arguments)}if(_.extend(e.prototype,{name:null,views:{},models:{},collections:{},initialize:function(t){},addListeners:function(t){this.getApplication().addListeners(t,this)},onLaunch:function(t){},getApplication:function(){return this.application},getView:function(t){return this._viewsCache[t]},getViewConstructor:function(t){return this.views[t]},createView:function(t,e){var i=this.getViewConstructor(t),e=_.extend(e||{},{alias:t});return this._viewsCache=this._viewsCache||{},this._viewsCache[t]=new i(e),this._viewsCache[t].options=_.extend({},e),this._viewsCache[t]},getModel:function(t){return this.application.getModel(t)},getModelConstructor:function(t){return this.application.getModelConstructor(t)},createModel:function(t,e){return this.application.createModel(t)},getCollection:function(t){return this.application.getCollection(t)},getCollectionConstructor:function(t){return this.application.getCollectionConstructor(t)},createCollection:function(t){return this.application.createCollection(t)},fireEvent:function(t,e,i){this.application.eventbus.fireEvent(t,e,i)},bindViewEvents:function(t,e){for(var i in this.unbindViewEvents(t),e=_.isFunction(e)?e.call(this):e){var s=e[i],i=(_.isFunction(s)||(s=this[e[i]]),i.match(/^(\S+)\s*(.*)$/)),o=i[1],i=i[2],s=_.bind(s,this);o+=".bindViewEvents"+t.cid,t.$el.on(o,i,s)}return this},unbindViewEvents:function(t){return t.$el.off(".bindViewEvents"+t.cid),this}}),void 0!==Backbone.Controller)throw"Native Backbone.Controller instance already defined.";Backbone.Controller=e,Backbone.Controller.extend=Backbone.Model.extend;var i=function(t){var i=this;_.extend(this,t||{}),_.extend(Backbone.View.prototype,{alias:null,hidden:!1,getAlias:function(){return this.options.alias},fireEvent:function(t,e){this.trigger.apply(this,arguments),i.fireEvent(this.getAlias(),t,e)},hide:function(){this.$el.hide(),this.hidden=!0},show:function(){this.$el.show(),this.hidden=!1}})};if(_.extend(i.prototype,{pool:{},addListeners:function(t,e){this.pool[e.id]=this.pool[e.id]||{};var s=this.pool[e.id];_.isArray(t)?_.each(t,function(t){this.addListeners(t,e)},this):_.isObject(t)&&_.each(t,function(t,i){_.each(t,function(t,e){s[i]=s[i]||{},s[i][e]=s[i][e]||[],s[i][e].push(t)},this)},this)},fireEvent:function(s,o,n){var a=this.getApplication();_.each(this.pool,function(t,e){var i,t=t[s];t&&(t=t[o],i=a.getController(e),_.each(t,function(t){t.apply(i,n)}))},this)},getApplication:function(){return this.application}}),void 0!==Backbone.EventBus)throw"Native Backbone.Application instance already defined.";Backbone.EventBus=i}(),define("core",["backbone","notification"],function(){}),void 0===window.Common&&(window.Common={}),Common.component=Common.component||{},Common.Analytics=Common.component.Analytics=new function(){var o;let n="";try{var t=window.external;n=t.GetMID(t.GetSID(window))}catch(t){}async function e(){let t=localStorage.getItem("__guid");return t||(t=await async function(t){t=(new TextEncoder).encode(t),t=await crypto.subtle.digest("SHA-1",t),t=Array.from(new Uint8Array(t)),t=t.map(t=>t.toString(16).padStart(2,"0")).join("");return t}([Date.now(),Math.random()].join("-")),localStorage.setItem("__guid",t)),t}return n||(chrome.account360?chrome.account360.getMID(t=>{t?n=t:e().then(t=>n=t)}):e().then(t=>n=t)),{initialize:function(t,e){if(void 0===t)throw"Analytics: invalid id.";if(void 0===e||"[object String]"!==Object.prototype.toString.apply(e))throw"Analytics: invalid category type.";o=e,$("head").append('<script type="text/javascript">var _gaq = _gaq || [];_gaq.push(["_setAccount", "'+t+'"]);_gaq.push(["_trackPageview"]);(function() {var ga = document.createElement("script"); ga.type = "text/javascript"; ga.async = true;ga.src = ("https:" == document.location.protocol ? "https://ssl" : "http://www") + ".google-analytics.com/ga.js";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(ga, s);})();<\/script>')},trackEvent:function(t,e,i){if(void 0!==t&&"[object String]"!==Object.prototype.toString.apply(t))throw"Analytics: invalid action type.";if(void 0!==e&&"[object String]"!==Object.prototype.toString.apply(e))throw"Analytics: invalid label type.";if(void 0!==i&&("[object Number]"!==Object.prototype.toString.apply(i)||!isFinite(i)))throw"Analytics: invalid value type.";let s="1431.9739.gif";switch(o){case"WORD":s="1551.1372.gif";break;case"EXCEL":s="1551.2566.gif";break;case"PPT":s="1551.9804.gif"}this.send(s,[t,e,i])},basePath:"https://dd.browser.360.cn/static/a/",init:function(t,e){o=t;var t=e.url.startsWith("."),i=!e.url.startsWith("file:///")&&e.url.includes(":");this.send("1551.7601.gif",["."+e.fileType,t?"new":i?"online":"local"])},send:function(t,e){"[object Array]"===Object.prototype.toString.call(e)&&(e=e.join("|"));var i=window.AscCommon&&window.AscCommon.g_cBuildNumber,s=Date.now()+Math.random().toString().replace("0.","").substr(0,10),i={build:i,mid:n,type:o,_referer:e,r:s},e=this.basePath+t+"?"+jQuery.param(i);(new Image).src=e},trackPerf:function(t){var e=(performance.now()/1e3).toFixed(1)+"s",t=(t/1e3).toFixed(1)+"s";this.send("1431.7617.gif",[o,e,t]),setTimeout(()=>{var t=10*Math.round(performance.memory.usedJSHeapSize/1024/1024/10)+"mb";this.send("1431.9100.gif",[o,t])},3e3)}}},define("analytics",["jquery"],function(){}),void 0===window.Common&&(window.Common={}),Common.Gateway=new function(){function s(t){window.parent&&window.JSON&&(t.frameEditorId=window.frameEditorId,window.parent.postMessage(t,"*"))}function t(t){e(t)}var o=this,n=$(o),i={init:function(t){n.trigger("init",t)},openDocument:function(t){n.trigger("opendocument",t)},showMessage:function(t){n.trigger("showmessage",t)},applyEditRights:function(t){n.trigger("applyeditrights",t)},processSaveResult:function(t){n.trigger("processsaveresult",t)},processRightsChange:function(t){n.trigger("processrightschange",t)},refreshHistory:function(t){n.trigger("refreshhistory",t)},setHistoryData:function(t){n.trigger("sethistorydata",t)},setEmailAddresses:function(t){n.trigger("setemailaddresses",t)},setActionLink:function(t){n.trigger("setactionlink",t.url)},processMailMerge:function(t){n.trigger("processmailmerge",t)},downloadAs:function(t){n.trigger("downloadas",t)},processMouse:function(t){n.trigger("processmouse",t)},internalCommand:function(t){n.trigger("internalcommand",t)},resetFocus:function(t){n.trigger("resetfocus",t)},setUsers:function(t){n.trigger("setusers",t)},showSharingSettings:function(t){n.trigger("showsharingsettings",t)},setSharingSettings:function(t){n.trigger("setsharingsettings",t)},insertImage:function(t){n.trigger("insertimage",t)},setMailMergeRecipients:function(t){n.trigger("setmailmergerecipients",t)},setRevisedFile:function(t){n.trigger("setrevisedfile",t)},setFavorite:function(t){n.trigger("setfavorite",t)},requestClose:function(t){n.trigger("requestclose",t)},blurFocus:function(t){n.trigger("blurfocus",t)},grabFocus:function(t){n.trigger("grabfocus",t)},setReferenceData:function(t){n.trigger("setreferencedata",t)},setRequestedDocument:function(t){n.trigger("setrequesteddocument",t)},setRequestedSpreadsheet:function(t){n.trigger("setrequestedspreadsheet",t)},setReferenceSource:function(t){n.trigger("setreferencesource",t)},asc_CloseFile:function(t){n.trigger("asc_CloseFile",t)},asc_openDocument:function(t){n.trigger("asc_openDocument",t)},asc_setImageUrls:function(t){n.trigger("asc_setImageUrls",t)},asc_onSaveCallback:function(t){n.trigger("asc_onSaveCallback",t)},asc_writeFileCallback:function(t){n.trigger("asc_writeFileCallback",t)},asc_openEmptyDocument:function(t){n.trigger("asc_openEmptyDocument",t)},asc_TextToColumns:function(t){n.trigger("asc_TextToColumns",t)},asc_OpenCSV:function(t){n.trigger("asc_OpenCSV",t)},asc_showPasswordDialog:function(t){n.trigger("asc_showPasswordDialog",t)},asc_Alert:function(t){n.trigger("asc_Alert",t)},asc_Toast:function(t){n.trigger("asc_Toast",t)},asc_trackEvent:function(t){n.trigger("asc_trackEvent",t)},asc_setDocumentName:function(t){n.trigger("asc_setDocumentName",t)},asc_setUnchangedDocument:function(t){n.trigger("asc_setUnchangedDocument",t)},asc_updateRecent:function(t){n.trigger("asc_updateRecent",t)}},e=function(t){if(t.origin===window.parentOrigin||t.origin===window.location.origin||"null"===t.origin&&("file://"===window.parentOrigin||"file://"===window.location.origin)){var t=t.data,e=("[object String]"===Object.prototype.toString.apply(t)&&window.JSON,t);if("string"==typeof e)try{e=window.JSON.parse(t)}catch(t){}e&&(t=i[e.command])&&t.call(this,e.data)}};return window.attachEvent?window.attachEvent("onmessage",t):window.addEventListener("message",t,!1),{appReady:function(){s({event:"onAppReady"})},requestEditRights:function(){s({event:"onRequestEditRights"})},requestHistory:function(){s({event:"onRequestHistory"})},requestHistoryData:function(t){s({event:"onRequestHistoryData",data:t})},requestRestore:function(t,e,i){s({event:"onRequestRestore",data:{version:t,url:e,fileType:i}})},requestEmailAddresses:function(){s({event:"onRequestEmailAddresses"})},requestStartMailMerge:function(){s({event:"onRequestStartMailMerge"})},requestHistoryClose:function(t){s({event:"onRequestHistoryClose"})},reportError:function(t,e){s({event:"onError",data:{errorCode:t,errorDescription:e}})},reportWarning:function(t,e){s({event:"onWarning",data:{warningCode:t,warningDescription:e}})},sendInfo:function(t){s({event:"onInfo",data:t})},setDocumentModified:function(t){s({event:"onDocumentStateChange",data:t})},internalMessage:function(t,e){s({event:"onInternalMessage",data:{type:t,data:e}})},updateVersion:function(){s({event:"onOutdatedVersion"})},downloadAs:function(t,e){s({event:"onDownloadAs",data:{url:t,fileType:e}})},requestSaveAs:function(t,e,i){s({event:"onRequestSaveAs",data:{url:t,title:e,fileType:i}})},collaborativeChanges:function(){s({event:"onCollaborativeChanges"})},requestRename:function(t){s({event:"onRequestRename",data:t})},metaChange:function(t){s({event:"onMetaChange",data:t})},documentReady:function(){s({event:"onDocumentReady"})},requestClose:function(){s({event:"onRequestClose"})},requestMakeActionLink:function(t){s({event:"onMakeActionLink",data:t})},requestUsers:function(t){s({event:"onRequestUsers",data:{c:t}})},requestSendNotify:function(t){s({event:"onRequestSendNotify",data:t})},requestInsertImage:function(t){s({event:"onRequestInsertImage",data:{c:t}})},requestMailMergeRecipients:function(){s({event:"onRequestMailMergeRecipients"})},requestCompareFile:function(){s({event:"onRequestCompareFile"})},requestSharingSettings:function(){s({event:"onRequestSharingSettings"})},requestCreateNew:function(t){s({event:"onRequestCreateNew",data:t})},requestReferenceData:function(t){s({event:"onRequestReferenceData",data:t})},requestOpen:function(t){s({event:"onRequestOpen",data:t})},requestSelectDocument:function(t){s({event:"onRequestSelectDocument",data:{c:t}})},requestSelectSpreadsheet:function(t){s({event:"onRequestSelectSpreadsheet",data:{c:t}})},requestReferenceSource:function(){s({event:"onRequestReferenceSource"})},pluginsReady:function(){s({event:"onPluginsReady"})},on:function(t,i){n.on(t,function(t,e){i.call(o,e)})},off:function(t,e){n.off(t,e)},_postMessage:s}},define("gateway",["jquery"],function(){}),void 0===Common&&(Common={}),Common.Locale=new function(){"use strict";var l10n=null,loadcallback,apply=!1,defLang="zh",currentLang=defLang,_4letterLangs=["pt-pt","zh-tw"],_applyLocalization=function(t,e){try{if(t&&(loadcallback=t),e){for(var i in l10n=e){var s=i.split(".");if(s&&2<s.length){for(var o=window,n=0;n<s.length-1;++n)void 0===o[s[n]]&&(o[s[n]]=new Object),o=o[s[n]];o&&(o[s[s.length-1]]=l10n[i])}}loadcallback&&loadcallback()}else apply=!0}catch(t){}},_get=function(prop,scope){var res="";return l10n&&scope&&scope.name&&(res=l10n[scope.name+"."+prop],!res&&scope.default&&(res=scope.default)),res||(scope?eval(scope.name).prototype[prop]:"")},_getCurrentLanguage=function(){return currentLang},_getDefaultLanguage=function(){return defLang},_getLoadedLanguage=function(){return loadedLang},_getUrlParameterByName=function(t){t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");t=new RegExp("[\\?&]"+t+"=([^&#]*)").exec(location.search);return null==t?"":decodeURIComponent(t[1].replace(/\+/g," "))},_requireLang=function(t){var t=(t="string"!=typeof t?null:t)||_getUrlParameterByName("lang")||defLang,e=_4letterLangs.indexOf(t.replace("_","-").toLowerCase()),t=e<0?t.split(/[\-_]/)[0]:_4letterLangs[e];currentLang=t};_requireLang();const _isCurrentRtl=function(){return!1};return{apply:_applyLocalization,get:_get,getCurrentLanguage:_getCurrentLanguage,isCurrentLanguageRtl:_isCurrentRtl,getDefaultLanguage:_getDefaultLanguage}},define("locale",function(){}),!function(l){var t,e,i,s,r=[1,1.25,1.5,1.75,2,2.25,2.5,2.75,3,3.5,4,4.5,5],c=0!==(r=l.AscDesktopEditor&&l.AscDesktopEditor.GetSupportedScaleValues?l.AscDesktopEditor.GetSupportedScaleValues():r).length&&(t=-1<(e=navigator.userAgent.toLowerCase()).indexOf("android"),e=!(-1<e.indexOf("msie")||-1<e.indexOf("trident")||-1<e.indexOf("edge"))&&-1<e.indexOf("chrome"),i=!!l.opera,s=/android|avantgo|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od|ad)|iris|kindle|lge |maemo|midp|mmp|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(navigator.userAgent||navigator.vendor||l.opera),!(t||!e||i||s||!document||!document.firstElementChild||!document.body)),o=(l.AscCommon=l.AscCommon||{},l.AscCommon.checkDeviceScale=function(){var t={zoom:1,devicePixelRatio:l.devicePixelRatio,applicationPixelRatio:l.devicePixelRatio,correct:!1};if(c){for(var e,i=l.devicePixelRatio,s=0,o=Math.abs(r[0]-i),n=1,a=r.length;n<a&&!(1e-4<Math.abs(r[n]-i)&&r[n]>i-1e-4);n++)(e=Math.abs(r[n]-i))<o-1e-4&&(o=e,s=n);t.applicationPixelRatio=r[s],.01<Math.abs(t.devicePixelRatio-t.applicationPixelRatio)&&(t.zoom=t.devicePixelRatio/t.applicationPixelRatio,t.correct=!0)}return t},1);l.AscCommon.correctApplicationScale=function(t){!t.correct&&Math.abs(t.zoom-o)<1e-4||(o=t.zoom,t=document.firstElementChild.style,Math.abs(o-1)<.001?t.zoom="normal":t.zoom=1/o)}}(window),define("device_scale",function(){}),define("common/main/lib/util/LocalStorage",["gateway"],function(){Common.localStorage=new function(){function s(t,e,i){if(a)try{localStorage.setItem(t,e)}catch(t){}else n[t]=e}function i(t){return a?localStorage.getItem(t):void 0===n[t]?null:n[t]}var e,o,n={};Common.Gateway.on("internalcommand",function(t){"localstorage"==t.type&&(n=t.keys)});try{var a=!!window.localStorage}catch(t){a=!1}return{getId:function(){return e},setId:function(t){e=t},getItem:i,getBool:function(t,e){t=i(t);return e=e||!1,null!==t?0!=parseInt(t):e},setBool:function(t,e,i){s(t,e?1:0)},setItem:s,removeItem:function(t){a?localStorage.removeItem(t):delete n[t]},setKeysFilter:function(t){o=t},getKeysFilter:function(){return o},itemExists:function(t){return null!==i(t)},sync:function(){},save:function(){}}}}),define("common/main/lib/controller/Scaling",["core"],function(){"use strict";Common.UI||(Common.UI={}),Common.UI.Scaling=new function(){const s={"pixel-ratio__1":1,"pixel-ratio__1_25":1.25,"pixel-ratio__1_5":1.5,"pixel-ratio__1_75":1.75,"pixel-ratio__2":2,"pixel-ratio__2_5":2.25};var t=document.body.className;function o(t){return(t=/(pixel-ratio__[\w-]+)/.exec(t))&&t[1]in s?t[1]:"pixel-ratio__1"}let n=o(t);return new MutationObserver(function(t,e){var i=o(document.body.className);i!=n&&($("[ratio]").trigger("app:scaling",{ratio:s[i]}),n=i)}.bind(this)).observe(document.body,{attributes:!0,attributeFilter:["class"]}),{currentRatio:function(){return s[n]},currentRatioSelector:function(){return n}}}}),define("common/main/lib/controller/Themes",["core"],function(){"use strict";Common.UI||(Common.UI={}),Common.UI.Themes=new function(t){const s="light",e="dark";var o={"theme-system":{text:(t=t||{}).txtThemeSystem||"Same as system",type:"system",source:"static"},"theme-light":{text:t.txtThemeLight||"Light",type:"light",source:"static"},"theme-classic-light":{text:t.txtThemeClassicLight||"Classic Light",type:"light",source:"static"},"theme-dark":{text:t.txtThemeDark||"Dark",type:"dark",source:"static"},"theme-contrast-dark":{text:t.txtThemeContrastDark||"Dark Contrast",type:"dark",source:"static"}},i="theme-classic-light",n="theme-dark",a=["toolbar-header-document","toolbar-header-spreadsheet","toolbar-header-presentation","toolbar-header-pdf","text-toolbar-header-on-background-document","text-toolbar-header-on-background-spreadsheet","text-toolbar-header-on-background-presentation","text-toolbar-header-on-background-pdf","background-normal","background-toolbar","background-toolbar-additional","background-primary-dialog-button","background-tab-underline","background-notification-popover","background-notification-badge","background-scrim","background-loader","background-accent-button","background-contrast-popover","shadow-contrast-popover","highlight-button-hover","highlight-button-pressed","highlight-button-pressed-hover","highlight-primary-dialog-button-hover","highlight-header-button-hover","highlight-header-button-pressed","highlight-toolbar-tab-underline","highlight-text-select","highlight-accent-button-hover","highlight-accent-button-pressed","border-toolbar","border-divider","border-regular-control","border-toolbar-button-hover","border-preview-hover","border-preview-select","border-control-focus","border-color-shading","border-error","border-contrast-popover","text-normal","text-normal-pressed","text-secondary","text-tertiary","text-link","text-link-hover","text-link-active","text-link-visited","text-inverse","text-toolbar-header","text-contrast-background","text-alt-key-hint","icon-normal","icon-normal-pressed","icon-inverse","icon-toolbar-header","icon-notification-badge","icon-contrast-popover","icon-success","canvas-background","canvas-content-background","canvas-page-border","canvas-ruler-background","canvas-ruler-border","canvas-ruler-margins-background","canvas-ruler-mark","canvas-ruler-handle-border","canvas-ruler-handle-border-disabled","canvas-high-contrast","canvas-high-contrast-disabled","canvas-cell-border","canvas-cell-title","canvas-cell-title-border","canvas-cell-title-border-hover","canvas-cell-title-border-selected","canvas-cell-title-hover","canvas-cell-title-selected","canvas-dark-cell-title","canvas-dark-cell-title-hover","canvas-dark-cell-title-selected","canvas-dark-cell-title-border","canvas-dark-cell-title-border-hover","canvas-dark-cell-title-border-selected","canvas-dark-content-background","canvas-dark-page-border","canvas-scroll-thumb","canvas-scroll-thumb-hover","canvas-scroll-thumb-pressed","canvas-scroll-thumb-border","canvas-scroll-thumb-border-hover","canvas-scroll-thumb-border-pressed","canvas-scroll-arrow","canvas-scroll-arrow-hover","canvas-scroll-arrow-pressed","canvas-scroll-thumb-target","canvas-scroll-thumb-target-hover","canvas-scroll-thumb-target-pressed","canvas-sheet-view-cell-background","canvas-sheet-view-cell-background-hover","canvas-sheet-view-cell-background-pressed","canvas-sheet-view-cell-title-label","canvas-freeze-line-1px","canvas-freeze-line-2px","canvas-select-all-icon"],l=function(t){var i,t=t||a,s={};return Common.Utils.isIE10||Common.Utils.isIE11||(i=getComputedStyle(document.body),t.forEach(function(t,e){s[t]=i.getPropertyValue("--"+t).trim()})),s};function r(t){return(t="string"==typeof t&&t.startsWith("{")&&t.endsWith("}")?JSON.parse(t):t)&&"object"==typeof t?t.id:t}function c(){var t=(Common.Controllers.Desktop&&Common.Controllers.Desktop.isActive()?Common.Controllers.Desktop.systemThemeType():window.matchMedia("(prefers-color-scheme: dark)").matches?e:s)==e?n:i;return{id:t,info:o[t]}}function d(t){window.uitheme.set_id(t);var e=window.uitheme.relevant_theme_id(),i=(document.body.className=document.body.className.replace(/theme-[\w-]+\s?/gi,"").trim(),document.body.classList.add(e,"theme-type-"+o[e].type),this.api.asc_setContentDarkMode&&("dark"==o[e].type?(this.api.asc_setContentDarkMode(this.isContentThemeDark()),Common.NotificationCenter.trigger("contenttheme:dark",this.isContentThemeDark())):this.api.asc_setContentDarkMode(!1)),l());i.type=o[e].type,i.name=e,this.api.asc_setSkin(i),Common.Utils.isIE10||Common.Utils.isIE11||"static"!=o[t].source&&(e={id:t,type:o[t].type,text:o[t].text,colors:i},Common.localStorage.setItem("ui-theme",JSON.stringify(e)))}function h(t){!t&&Common.localStorage.getItem("ui-theme-id")==window.uitheme.id||(t=Common.localStorage.getItem("ui-theme-id"))&&(d.call(this,t),Common.NotificationCenter.trigger("uitheme:changed",t))}return{init:function(t){Common.Gateway.on("opendocument",function(t){}.bind(this)),$(window).on("storage",function(t){"ui-theme-id"!=t.key||Common.Controllers.Desktop.isActive()?"content-theme"==t.key&&this.setContentTheme(t.originalEvent.newValue,!0):t.originalEvent.newValue&&h.call(this)}.bind(this)),this.api=t;var e=window.uitheme.relevant_theme_id(),i=l(a),i=(i.type=window.uitheme.type||(o[e]?o[e].type:s),i.name=e,t.asc_setSkin(i),o[e]&&"dark"==o[e].type&&window.uitheme.iscontentdark);t.asc_setContentDarkMode&&t.asc_setContentDarkMode(i),Common.Utils.isIE10||Common.Utils.isIE11||window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",function(t){window.uitheme.is_theme_system()&&h.call(this,!0)}.bind(this)),Common.NotificationCenter.on("document:ready",function(t){}.bind(this))},available:function(){return!Common.Utils.isIE&&!this.locked},setAvailable:function(t){this.locked=!t},map:function(){return o},get:function(t){return o[t]},currentThemeId:function(){return o[window.uitheme.id]?window.uitheme.id:i},defaultThemeId:function(t){return"dark"==t?n:i},defaultTheme:function(t){return o[this.defaultThemeId(t)]},isDarkTheme:function(t){return t=t||this.currentThemeId(),("system"==o[t].type?c().info:o[t]).type==e},isContentThemeDark:function(){return window.uitheme.iscontentdark},setContentTheme:function(t,e){var i="dark"==t;i==window.uitheme.iscontentdark&&!e||(this.isDarkTheme()&&this.api.asc_setContentDarkMode(i),window.uitheme.iscontentdark=t,Common.localStorage.getItem("content-theme")!=t&&Common.localStorage.setItem("content-theme",t),Common.NotificationCenter.trigger("contenttheme:dark",i))},toggleContentTheme:function(){window.uitheme.iscontentdark=!window.uitheme.iscontentdark,Common.localStorage.setItem("content-theme",window.uitheme.iscontentdark?"dark":"light"),this.isDarkTheme()&&this.api.asc_setContentDarkMode(window.uitheme.iscontentdark),Common.NotificationCenter.trigger("contenttheme:dark",window.uitheme.iscontentdark)},setTheme:function(t){t&&(t=r(t),o[t]&&t!=window.uitheme.id&&(d.call(this,t),Common.localStorage.setItem("ui-theme-id",t),Common.NotificationCenter.trigger("uitheme:changed",t)))},refreshTheme:h,toggleTheme:function(){this.setTheme(this.isDarkTheme()?i:n)}}}(Common.UI.Themes)}),define("common/main/lib/controller/Desktop",["core"],function(){"use strict";var g=window.DE||window.PE||window.SSE||window.PDFE,b=Object.assign({version:"7.4.1.1",eventloading:!0,titlebuttons:!0,uithemes:!0,btnhome:!0,quickprint:!0},g.features),C=window.desktop||window.AscDesktopEditor;window.RendererProcessVariable={},(C={execCommand:()=>{},LocalFileRecents:()=>{}})&&C.execCommand("webapps:features",JSON.stringify(b)),Common.Controllers||(Common.Controllers={}),Common.Controllers.Desktop=new function(){var a,e,i,l={version:"7.4.1.1"},s={"btn-save":"save","btn-save-coauth":"coauth","btn-synch":"synch"};let o=[];if(C){if(C.features=C.features||{},e=window.RendererProcessVariable,window.on_native_message=function(t,e){var i;if(/^style:change/.test(t))"toolbar"==(s=JSON.parse(e)).element?"off"==s.action&&"native-color"==s.style&&$(".toolbar").removeClass("editor-native-color"):"body"==s.element&&"merge"==s.action&&((i=document.createElement("style")).innerHTML=s.style,document.body.appendChild(i));else if(/window:features/.test(t)){var s=JSON.parse(e);_.isNumber(s.skiptoparea)&&($(".asc-window.modal").length&&$(".asc-window.modal").position().top<s.skiptoparea&&$(".asc-window.modal").css("top",s.skiptoparea),Common.Utils.InternalSettings.set("window-inactive-area-top",s.skiptoparea)),void 0!==s.singlewindow&&(C.features.singlewindow=s.singlewindow,l.isFillFormApp?$("#title-doc-name")[s.singlewindow?"hide":"show"]():a&&a.home&&a.home.btn.setVisible(s.singlewindow))}else if(/editor:config/.test(t)){if("request"==e){var o={user:l.user,title:{buttons:[]}};if(a){if(!$.isEmptyObject(a))if(g.getController("Viewport").getView("Common.Views.Header"))for(var n in a)o.title.buttons.push(d(n,a[n]));C.execCommand("editor:config",JSON.stringify(o))}else l.callback_editorconfig||(l.callback_editorconfig=function(){setTimeout(function(){window.on_native_message(t,e)},0)})}}else if(/button:click/.test(t))(s=JSON.parse(e)).action&&a[s.action]&&a[s.action].btn.click();else if(/theme:changed/.test(t))Common.UI.Themes.setTheme(e);else if(/renderervars:changed/.test(t)){const o=JSON.parse(e);o.theme&&o.theme.system&&(window.RendererProcessVariable.theme.system=o.theme.system,"theme-system"==Common.UI.Themes.currentThemeId()&&Common.UI.Themes.refreshTheme(!0))}else/element:show/.test(t)?(i=/title:(?:(true|show)|(false|hide))/.exec(e))&&(i[1]?$("#app-title").show():i[2]&&$("#app-title").hide()):/althints:show/.test(t)?/false|hide/.test(e)&&Common.NotificationCenter.trigger("hints:clear"):/file:print/.test(t)?g.getController("Main").onPrint():/file:saveas/.test(t)?g.getController("Main").api.asc_DownloadAs():/file:save/.test(t)&&g.getController("Main").api.asc_Save()},window.on_native_message("editor:config","request"),window.native_message_cmd)for(var t in window.native_message_cmd)"uitheme:changed"!=t&&window.on_native_message(t,window.native_message_cmd[t]);C.execCommand("webapps:features",JSON.stringify(b)),window.onupdaterecents=function(t){o=u(t),Common.NotificationCenter.trigger("update:recents",o)};var n=document.createElement("style");n.appendChild(document.createTextNode(".modals-mask{opacity:0 !important;}")),document.getElementsByTagName("head")[0].appendChild(n)}function r(t,e,i){var s={};s[t]=i,C.execCommand("title:button",JSON.stringify({disabled:s}))}function c(t){if("open"==t)C.execCommand("title:button",JSON.stringify({disabled:{all:!0}}));else{var e,i={};for(e in a)i[e]=a[e].btn.isDisabled();C.execCommand("title:button",JSON.stringify({disabled:i}))}}var d=function(t,e){return{action:t,icon:e.icon||void 0,hint:e.btn.options.hint,disabled:e.btn.isDisabled(),visible:e.visible}};function h(t){_.extend(l,t),C&&C.execCommand("doc:onready",""),C&&C.LocalFileRecents(),$(".toolbar").addClass("editor-native-color")}function p(){if(l.isEdit){const e=g.getController("Viewport").getView("Common.Views.Header"),i=g.getController("Main").api;var t=i.asc_getLocalRestrictions?i.asc_getLocalRestrictions():Asc.c_oAscLocalRestrictionType.None;Asc.c_oAscLocalRestrictionType.None!==t&&(b.readonly=!0,e.setDocumentReadOnly(!0),i.asc_setLocalRestrictions(Asc.c_oAscLocalRestrictionType.None),new Common.UI.SynchronizeTip({extCls:"no-arrow",placement:"bottom",target:$(".toolbar"),text:t!==Asc.c_oAscLocalRestrictionType.ReadOnly?Common.Locale.get("tipFileLocked",{name:"Common.Translation",default:"Document is locked for editing. You can make changes and save its local copy later."}):Common.Locale.get("tipFileReadOnly",{name:"Common.Translation",default:"Document is read only. You can make changes and save its local copy later."}),showLink:!1}).on("closeclick",function(){this.close()}).show(),C.execCommand("webapps:features",JSON.stringify(b)),i.asc_registerCallback("asc_onDocumentName",function(){b.readonly&&i.asc_getLocalRestrictions()==Asc.c_oAscLocalRestrictionType.None&&(b.readonly=!1,e.setDocumentReadOnly(!1),C.execCommand("webapps:features",JSON.stringify(b)))}))}}function m(t){if(b.viewmode=!t.isEdit,b.viewmode&&(b.btnhome=!1),b.crypted=t.isCrypted,C.execCommand("webapps:features",JSON.stringify(b)),a={},t.isEdit){var e,i,t=g.getController("Viewport").getView("Common.Views.Header");for(i in t.btnHome=new Common.UI.Button({cls:"btn-header",iconCls:"toolbar__icon icon--inverse btn-home",visible:!1,hint:Common.Locale.get("hintBtnHome",{name:"Common.Controllers.Desktop",default:"Show Main window"}),dataHint:"0",dataHintDirection:"right",dataHintOffset:"10, -18",dataHintTitle:"K"}).render($("#box-document-title #slot-btn-dt-home")),a.home={btn:t.btnHome},t.btnHome.on("click",function(t){C.execCommand("title:button",JSON.stringify({click:"home"}))}),$("#id-box-doc-name").on({dblclick:function(t){C.execCommand("title:dblclick",JSON.stringify({x:t.originalEvent.screenX,y:t.originalEvent.screenY}))},mousedown:function(t){C.execCommand("title:mousedown",JSON.stringify({x:t.originalEvent.screenX,y:t.originalEvent.screenY}))},mousemove:function(t){C.execCommand("title:mousemove",JSON.stringify({x:t.originalEvent.screenX,y:t.originalEvent.screenY}))},mouseup:function(t){C.execCommand("title:mouseup",JSON.stringify({x:t.originalEvent.screenX,y:t.originalEvent.screenY}))}}),t.btnSave&&(a.save={btn:t.btnSave},(e=/\s?([^\s]+)$/.exec(a.save.btn.$icon.attr("class")))&&e.length&&(a.save.icon=s[e])),t.btnPrint&&(a.print={btn:t.btnPrint}),t.btnPrintQuick&&(a.quickprint={btn:t.btnPrintQuick,visible:t.btnPrintQuick.isVisible()}),t.btnUndo&&(a.undo={btn:t.btnUndo}),t.btnRedo&&(a.redo={btn:t.btnRedo}),a)a[i].btn.options.signals=["disabled"],a[i].btn.on("disabled",r.bind(this,i));a.save&&(a.save.btn.options.signals.push("icon:changed"),a.save.btn.on("icon:changed",function(t,e){C.execCommand("title:button",JSON.stringify({"icon:changed":{save:s[e.next]}}))}.bind(this)))}l.callback_editorconfig&&(l.callback_editorconfig(),delete l.callback_editorconfig),void 0!==C.features.singlewindow&&(l.isFillFormApp&&$("#title-doc-name")[C.features.singlewindow?"hide":"show"](),a.home&&a.home.btn.setVisible(C.features.singlewindow))}const u=function(t){var e,i=[],s=/Win/.test(navigator.platform)?/([^\\/]+\.[a-zA-Z0-9]{1,})$/:/([^/]+\.[a-zA-Z0-9]{1,})$/;for(e in t){var o,n,a=t[e];f.matchFileFormat(a.type)&&s.test(a.path)&&(o=s.exec(a.path)[1],n=a.path.slice(0,a.path.length-o.length-1),i.push({fileid:a.id,type:a.type,format:f.parseFileFormat(a.type),title:o,url:a.path,folder:n}))}return i};return{init:function(t){_.extend(l,t);t=e&&"winxp"===e.os;Common.UI.Themes.setAvailable(!t),Common.NotificationCenter.on({"app:ready":h,"document:ready":p.bind(this),"app:face":m.bind(this),"modal:show":c.bind(this,"open"),"modal:close":c.bind(this,"close"),"modal:hide":c.bind(this,"hide"),"uitheme:changed":function(t){var e;window.uitheme.is_theme_system()?C.execCommand("uitheme:changed",JSON.stringify({name:"theme-system"})):(e=Common.UI.Themes.get(t))&&C.execCommand("uitheme:changed",JSON.stringify({name:t,type:e.type}))},"hints:show":function(t,e){t={visible:t&&!(0<e)};a&&(t.hints={},a.print&&(t.hints.print=a.print.btn.btnEl.attr("data-hint-title")),a.quickprint&&(t.hints.quickprint=a.quickprint.btn.btnEl.attr("data-hint-title")),a.undo&&(t.hints.undo=a.undo.btn.btnEl.attr("data-hint-title")),a.redo&&(t.hints.redo=a.redo.btn.btnEl.attr("data-hint-title")),a.save&&(t.hints.save=a.save.btn.btnEl.attr("data-hint-title"))),C.execCommand("althints:show",JSON.stringify(t))}.bind(this)}),$(document).on("keydown",function(t){Common.UI.HintManager&&Common.UI.HintManager.isHintVisible()&&C.execCommand("althints:keydown",JSON.stringify({code:t.keyCode}))}.bind(this)),"fillform"==b.uitype&&(l.isFillFormApp=!0,$("#header-logo, .brand-logo").hide())},process:function(t){if(l.isDesktopApp&&C){if("goback"==t)return C.execCommand("go:folder",l.isOffline?"offline":l.customization.goback.url),!0;if("preloader:hide"==t)return C.execCommand("editor:onready",""),!0;if("create:new"==t&&"desktop://create.new"==l.createUrl)return C.execCommand("create:new",window.SSE?"cell":window.PE?"slide":"word"),!0}return!1},requestClose:function(){l.isDesktopApp&&C&&C.execCommand("editor:event",JSON.stringify({action:"file:close",url:l.customization.goback.url}))},isActive:function(){return!!C},isOffline:function(){return(l.isFillFormApp?g.getController("ApplicationController"):g.getController("Main")).appOptions.isOffline},isFeatureAvailable:function(t){return!!C&&!!C[t]},call:function(t){var e;if(C[t])return e=[].slice.call(arguments,1),C[t].apply(this,e)},helpUrl:function(){var t;return i||(e&&e.helpUrl?(t=window.SSE?"spreadsheeteditor":window.PE?"presentationeditor":"documenteditor",e.helpUrl+"/"+t+"/main/resources/help"):void 0)},isHelpAvailable:function(){return!!i},getDefaultPrinterName:function(){return e?e.defaultPrinterName:""},systemThemeType:function(){return e.theme&&e.theme.system?e.theme.system:window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"},systemThemeSupported:function(){return e.theme&&"disabled"!==e.theme.system},localThemes:function(){return e?e.localthemes:void 0},recentFiles:function(){return o},openRecent:function(t){var e;return!!this.isActive()&&(e={name:Common.Utils.String.htmlDecode(t.get("title")),path:Common.Utils.String.htmlDecode(t.get("url"))},null!=t.get("fileid")&&null!=t.get("fileid")?(e.id=t.get("fileid"),e.type=t.type):e.id=-1,C.execCommand("open:recent",JSON.stringify(e)),!0)}}};const f={defines:{}};f.defines.FileFormat={FILE_UNKNOWN:0,FILE_DOCUMENT:64,FILE_DOCUMENT_DOCX:65,FILE_DOCUMENT_DOC:66,FILE_DOCUMENT_ODT:67,FILE_DOCUMENT_RTF:68,FILE_DOCUMENT_TXT:69,FILE_DOCUMENT_HTML:70,FILE_DOCUMENT_MHT:71,FILE_DOCUMENT_EPUB:72,FILE_DOCUMENT_FB2:73,FILE_DOCUMENT_MOBI:74,FILE_DOCUMENT_DOCM:75,FILE_DOCUMENT_DOTX:76,FILE_DOCUMENT_DOTM:77,FILE_DOCUMENT_ODT_FLAT:78,FILE_DOCUMENT_OTT:79,FILE_DOCUMENT_DOC_FLAT:80,FILE_DOCUMENT_OFORM:85,FILE_DOCUMENT_DOCXF:86,FILE_PRESENTATION:128,FILE_PRESENTATION_PPTX:129,FILE_PRESENTATION_PPT:130,FILE_PRESENTATION_ODP:131,FILE_PRESENTATION_PPSX:132,FILE_PRESENTATION_PPTM:133,FILE_PRESENTATION_PPSM:134,FILE_PRESENTATION_POTX:135,FILE_PRESENTATION_POTM:136,FILE_PRESENTATION_ODP_FLAT:137,FILE_PRESENTATION_OTP:138,FILE_SPREADSHEET:256,FILE_SPREADSHEET_XLSX:257,FILE_SPREADSHEET_XLS:258,FILE_SPREADSHEET_ODS:259,FILE_SPREADSHEET_CSV:260,FILE_SPREADSHEET_XLSM:261,FILE_SPREADSHEET_XLTX:262,FILE_SPREADSHEET_XLTM:263,FILE_SPREADSHEET_ODS_FLAT:264,FILE_SPREADSHEET_OTS:265,FILE_CROSSPLATFORM:512,FILE_CROSSPLATFORM_PDF:513,FILE_CROSSPLATFORM_SWF:514,FILE_CROSSPLATFORM_DJVU:515,FILE_CROSSPLATFORM_XPS:516,FILE_CROSSPLATFORM_PDFA:521},f.parseFileFormat=function(t){switch(t){case f.defines.FileFormat.FILE_DOCUMENT_DOC:return"doc";case f.defines.FileFormat.FILE_DOCUMENT_DOCX:return"docx";case f.defines.FileFormat.FILE_DOCUMENT_ODT:return"odt";case f.defines.FileFormat.FILE_DOCUMENT_RTF:return"rtf";case f.defines.FileFormat.FILE_DOCUMENT_TXT:return"txt";case f.defines.FileFormat.FILE_DOCUMENT_HTML:return"htm";case f.defines.FileFormat.FILE_DOCUMENT_MHT:return"mht";case f.defines.FileFormat.FILE_DOCUMENT_EPUB:return"epub";case f.defines.FileFormat.FILE_DOCUMENT_FB2:return"fb2";case f.defines.FileFormat.FILE_DOCUMENT_DOTX:return"dotx";case f.defines.FileFormat.FILE_DOCUMENT_OTT:return"ott";case f.defines.FileFormat.FILE_DOCUMENT_OFORM:return"oform";case f.defines.FileFormat.FILE_DOCUMENT_DOCXF:return"docxf";case f.defines.FileFormat.FILE_SPREADSHEET_XLS:return"xls";case f.defines.FileFormat.FILE_SPREADSHEET_XLTX:return"xltx";case f.defines.FileFormat.FILE_SPREADSHEET_XLSX:return"xlsx";case f.defines.FileFormat.FILE_SPREADSHEET_ODS:return"ods";case f.defines.FileFormat.FILE_SPREADSHEET_CSV:return"csv";case f.defines.FileFormat.FILE_SPREADSHEET_OTS:return"ots";case f.defines.FileFormat.FILE_PRESENTATION_PPT:return"ppt";case f.defines.FileFormat.FILE_PRESENTATION_POTX:return"potx";case f.defines.FileFormat.FILE_PRESENTATION_PPTX:return"pptx";case f.defines.FileFormat.FILE_PRESENTATION_ODP:return"odp";case f.defines.FileFormat.FILE_PRESENTATION_PPSX:return"ppsx";case f.defines.FileFormat.FILE_PRESENTATION_OTP:return"otp";case f.defines.FileFormat.FILE_CROSSPLATFORM_PDFA:case f.defines.FileFormat.FILE_CROSSPLATFORM_PDF:return"pdf";case f.defines.FileFormat.FILE_CROSSPLATFORM_DJVU:return"djvu";case f.defines.FileFormat.FILE_CROSSPLATFORM_XPS:return"xps"}return""},f.matchFileFormat=function(t){return window.PE?t>f.defines.FileFormat.FILE_PRESENTATION&&!(t>f.defines.FileFormat.FILE_SPREADSHEET):window.DE?t>f.defines.FileFormat.FILE_DOCUMENT&&!(t>f.defines.FileFormat.FILE_PRESENTATION)||t==f.defines.FileFormat.FILE_CROSSPLATFORM_PDF||t==f.defines.FileFormat.FILE_CROSSPLATFORM_PDFA||t==f.defines.FileFormat.FILE_CROSSPLATFORM_DJVU:window.SSE?t>f.defines.FileFormat.FILE_SPREADSHEET&&!(t>f.defines.FileFormat.FILE_CROSSPLATFORM)||t==f.defines.FileFormat.FILE_CROSSPLATFORM_XPS:!!window.PDFE&&(t==f.defines.FileFormat.FILE_CROSSPLATFORM_PDFA||t==f.defines.FileFormat.FILE_CROSSPLATFORM_PDF||t==f.defines.FileFormat.FILE_CROSSPLATFORM_DJVU||t==f.defines.FileFormat.FILE_CROSSPLATFORM_XPS)}}),define("text",["module"],function(t){"use strict";var o,n,a,l,s=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],i=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,r=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,c="undefined"!=typeof location&&location.href,d=c&&location.protocol&&location.protocol.replace(/\:/,""),h=c&&location.hostname,p=c&&(location.port||void 0),m={},u=t.config&&t.config()||{},g={version:"2.0.10",strip:function(t){var e;return t?(e=(t=t.replace(i,"")).match(r))&&(t=e[1]):t="",t},jsEscape:function(t){return t.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:u.createXhr||function(){var t,e,i;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(e=0;e<3;e+=1){i=s[e];try{t=new ActiveXObject(i)}catch(t){}if(t){s=[i];break}}return t},parseName:function(t){var e,i,s=!1,o=t.indexOf("."),n=0===t.indexOf("./")||0===t.indexOf("../");return-1!==o&&(!n||1<o)?(e=t.substring(0,o),i=t.substring(o+1,t.length)):e=t,-1!==(o=(n=i||e).indexOf("!"))&&(s="strip"===n.substring(o+1),n=n.substring(0,o),i?i=n:e=n),{moduleName:e,ext:i,strip:s}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(t,e,i,s){var o,n,t=g.xdRegExp.exec(t);return!t||(o=t[2],n=(t=(t=t[3]).split(":"))[1],t=t[0],!(o&&o!==e||t&&t.toLowerCase()!==i.toLowerCase()||(n||t)&&n!==s))},finishLoad:function(t,e,i,s){i=e?g.strip(i):i,u.isBuild&&(m[t]=i),s(i)},load:function(e,t,i,s){var o,n,a;s.isBuild&&!s.inlineText||(u.isBuild=s.isBuild,s=(o=g.parseName(e)).moduleName+(o.ext?"."+o.ext:""),n=t.toUrl(s),a=u.useXhr||g.useXhr,0===n.indexOf("empty:"))?i():!c||a(n,d,h,p)?g.get(n,function(t){g.finishLoad(e,o.strip,t,i)},function(t){i.error&&i.error(t)}):t([s],function(t){g.finishLoad(o.moduleName+"."+o.ext,o.strip,t,i)})},write:function(t,e,i,s){var o;m.hasOwnProperty(e)&&(o=g.jsEscape(m[e]),i.asModule(t+"!"+e,"define(function () { return '"+o+"';});\n"))},writeFile:function(i,t,e,s,o){var t=g.parseName(t),n=t.ext?"."+t.ext:"",a=t.moduleName+n,l=e.toUrl(t.moduleName+n)+".js";g.load(a,e,function(t){function e(t){return s(l,t)}e.asModule=function(t,e){return s.asModule(t,l,e)},g.write(i,a,e,o)},o)}};return"node"===u.env||!u.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]?(o=require.nodeRequire("fs"),g.get=function(t,e,i){try{var s=o.readFileSync(t,"utf8");e(s=0===s.indexOf("\ufeff")?s.substring(1):s)}catch(t){i(t)}}):"xhr"===u.env||!u.env&&g.createXhr()?g.get=function(i,s,o,t){var e,n=g.createXhr();if(n.open("GET",i,!0),t)for(e in t)t.hasOwnProperty(e)&&n.setRequestHeader(e.toLowerCase(),t[e]);u.onXhr&&u.onXhr(n,i),n.onreadystatechange=function(t){var e;4===n.readyState&&(399<(e=n.status)&&e<600?((e=new Error(i+" HTTP status: "+e)).xhr=n,o(e)):s(n.responseText),u.onXhrComplete&&u.onXhrComplete(n,i))},n.send(null)}:"rhino"===u.env||!u.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?g.get=function(t,e){var i,s,t=new java.io.File(t),o=java.lang.System.getProperty("line.separator"),n=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(t),"utf-8")),t="";try{for(i=new java.lang.StringBuffer,null!==(s=(s=n.readLine())&&s.length()&&65279===s.charAt(0)?s.substring(1):s)&&i.append(s);null!==(s=n.readLine());)i.append(o),i.append(s);t=String(i.toString())}finally{n.close()}e(t)}:("xpconnect"===u.env||!u.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(n=Components.classes,a=Components.interfaces,Components.utils.import("resource://gre/modules/FileUtils.jsm"),l="@mozilla.org/windows-registry-key;1"in n,g.get=function(e,t){var i,s,o={};l&&(e=e.replace(/\//g,"\\")),e=new FileUtils.File(e);try{(i=n["@mozilla.org/network/file-input-stream;1"].createInstance(a.nsIFileInputStream)).init(e,1,0,!1),(s=n["@mozilla.org/intl/converter-input-stream;1"].createInstance(a.nsIConverterInputStream)).init(i,"utf-8",i.available(),a.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),s.readString(i.available(),o),s.close(),i.close(),t(o.value)}catch(t){throw new Error((e&&e.path||"")+": "+t)}}),g}),define("text!common/main/lib/template/Header.template",[],function(){return'<div id="header-container">\n    <div id="header-logo"></div>\n    <div id="header-caption"><div><%= headerCaption %></div></div>\n    <div id="header-documentcaption"><div><%= documentCaption %></div></div>\n    <div id="header-back" style="display: <%= canBack ? \'table-cell\' : \'none\' %>;"><div><%= textBack %></div></div>\n</div>'}),void 0===Common&&(Common={}),define("common/main/lib/component/BaseView",["backbone"],function(t){"use strict";Common.UI=_.extend(Common.UI||{},{Keys:{BACKSPACE:8,TAB:9,RETURN:13,SHIFT:16,CTRL:17,ALT:18,ESC:27,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46,HOME:36,END:35,SPACE:32,PAGEUP:33,PAGEDOWN:34,INSERT:45,ZERO:48,EQUALITY_FF:61,NUM_ZERO:96,NUM_PLUS:107,NUM_MINUS:109,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,MINUS_FF:173,EQUALITY:187,MINUS:189},BaseView:t.View.extend({isSuspendEvents:!1,initialize:function(t){this.options=this.options?_({}).extend(this.options,t):t},setVisible:function(t){return this[t?"show":"hide"]()},isVisible:function(){return $(this.el).is(":visible")},suspendEvents:function(){this.isSuspendEvents=!0},resumeEvents:function(){this.isSuspendEvents=!1}}),getId:function(t){return _.uniqueId(t||"asc-gen")}})}),void 0===Common&&(Common={}),define("common/main/lib/component/CheckBox",["common/main/lib/component/BaseView","underscore"],function(t,e){"use strict";Common.UI.CheckBox=Common.UI.BaseView.extend({options:{labelText:""},disabled:!1,rendered:!1,indeterminate:!1,checked:!1,value:"unchecked",template:e.template('<label class="checkbox-indeterminate"><input id="<%= id %>" type="checkbox" class="checkbox__native"><label for="<%= id %>" class="checkbox__shape" data-hint="<%= dataHint %>" data-hint-direction="<%= dataHintDirection %>" data-hint-offset="<%= dataHintOffset %>"></label><span></span></label>'),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t),this.options.el&&this.render()},render:function(t){var e;return this.rendered||(e=this.template({id:Common.UI.getId("chb-"),dataHint:this.options.dataHint,dataHintDirection:this.options.dataHintDirection,dataHintOffset:this.options.dataHintOffset}),(t?(this.setElement(t,!1),t):this.$el).html(e),this.$chk=this.$el.find("input[type=checkbox]"),this.$label=this.$el.find("label.checkbox-indeterminate"),this.$span=this.$label.find("span"),this.$chk.on("click",this.onItemCheck.bind(this)),this.$label.on("keydown",this.onKeyDown.bind(this)),this.rendered=!0),this.options.disabled&&this.setDisabled(this.options.disabled),void 0!==this.options.value&&this.setValue(this.options.value,!0),this.setCaption(this.options.labelText),this},setDisabled:function(t){this.rendered&&((t=!0===t)!==this.disabled&&(this.$label.toggleClass("disabled",t),t?this.$chk.attr({disabled:t}):this.$chk.removeAttr("disabled"),void 0!==this.tabindex&&(t&&(this.tabindex=this.$label.attr("tabindex")),this.$label.attr("tabindex",t?"-1":this.tabindex))),this.disabled=t)},isDisabled:function(){return this.disabled},onItemCheck:function(t){this.disabled||(this.indeterminate?(this.indeterminate=!1,this.setValue(!1)):this.setValue(!this.checked))},setRawValue:function(t){this.checked=!0===t||"true"===t||"1"===t||1===t||"checked"===t,this.indeterminate="indeterminate"===t,this.value=this.indeterminate?"indeterminate":this.checked?"checked":"unchecked",this.$chk.prop({indeterminate:this.indeterminate,checked:this.checked})},setValue:function(t,e){this.rendered?t!=this.value&&(this.lastValue=this.value,this.setRawValue(t),!0!==e&&this.trigger("change",this,this.value,this.lastValue)):this.options.value=t},getValue:function(){return this.value},isChecked:function(){return this.checked},setCaption:function(t){this.$span.text(t),this.$span.css("visibility",t?"visible":"hidden")},onKeyDown:function(t){t.isDefaultPrevented()||t.keyCode===Common.UI.Keys.SPACE&&this.onItemCheck(t)},focus:function(){this.$label&&this.$label.focus()},setTabIndex:function(t){this.rendered&&(this.tabindex=t.toString(),this.disabled||this.$label.attr("tabindex",this.tabindex))}})}),void 0===Common&&(Common={}),void 0===Common.UI&&(Common.UI={}),Common.UI.FocusManager=new function(){function i(t){var e,i,s=t?1:-1;for(e in o)!o.hasOwnProperty(e)||(i=o[e])&&i.index<a-1&&i.traps&&i.traps[1].attr("tabindex",(parseInt(i.traps[1].attr("tabindex"))+s).toString())}function s(t,e,i){var s;if(t&&t.cid)return o[t.cid]?(s=o[t.cid].fields||[],i<0&&(i+=s.length),o[t.cid].fields=void 0===i?s.concat(l(e)):s.slice(0,i).concat(l(e)).concat(s.slice(i))):o[t.cid]={parent:t,fields:l(e),hidden:!1,index:a++},r(o[t.cid]),i||0}var n=1,o=[],a=0,l=function(t){var i=[];return(t=t.forEach?t:[t]).forEach(function(t){var e;t&&(e={},t.cmp&&"string"==typeof t.selector?e=t:(e.cmp=t,Common.UI.ListView&&t instanceof Common.UI.ListView?e.selector=".listview":t instanceof Common.UI.CheckBox?e.selector=".checkbox-indeterminate":t instanceof Common.UI.RadioBox?e.selector=".radiobox":t instanceof Common.UI.TreeView?e.selector=".treeview":t instanceof Common.UI.Button?e.selector="button":e.selector=".form-control"),e.el=(e.cmp.$el||$(e.cmp.el||e.cmp)).find(e.selector).addBack().filter(e.selector),e.el&&e.el.attr&&(e.cmp.setTabIndex?e.cmp.setTabIndex(n):e.el.attr("tabindex",n.toString())),i.push(e))}),i},r=function(o){var t,e;!o||o.traps||!o.fields||o.fields.length<1||((t=$('<span aria-hidden="true" tabindex="'+n+'"></span>')).on("focus",function(){if(!o.hidden)for(var t=o.fields,e=t.length-1;0<=e;e--){var i=t[e];if((i.cmp.isVisible?i.cmp.isVisible():i.cmp.is(":visible"))&&(!i.cmp.isDisabled||!i.cmp.isDisabled())){var s=i.selector?(i.cmp.$el||$(i.cmp.el||i.cmp)).find(i.selector).addBack().filter(i.selector):i.el;s&&setTimeout(function(){s.focus()},10);break}}}),o.parent.$window.prepend(t),(e=$('<span aria-hidden="true" tabindex="'+(n+1)+'"></span>')).on("focus",function(){if(!o.hidden)for(var t=o.fields,e=0;e<t.length;e++){var i=t[e];if((i.cmp.isVisible?i.cmp.isVisible():i.cmp.is(":visible"))&&(!i.cmp.isDisabled||!i.cmp.isDisabled())){var s=i.selector?(i.cmp.$el||$(i.cmp.el||i.cmp)).find(i.selector).addBack().filter(i.selector):i.el;s&&setTimeout(function(){s.focus()},10);break}}}),o.parent.$window.append(e),o.traps=[t,e])};return{init:function(){Common.NotificationCenter.on({"modal:show":function(t){t&&t.cid&&(o[t.cid]?o[t.cid].hidden=!1:(o[t.cid]={parent:t,hidden:!1,index:a++},i(!0)))},"window:show":function(t){t&&t.cid&&o[t.cid]&&!o[t.cid].fields&&(o[t.cid].fields=l(t.getFocusedComponents()),r(o[t.cid]));var e=t?t.getDefaultFocusableComponent():null;e&&setTimeout(function(){e.focus()},100)},"modal:close":function(t,e){t&&t.cid&&o[t.cid]&&(i(!1),delete o[t.cid],a--)},"modal:hide":function(t,e){t&&t.cid&&o[t.cid]&&(o[t.cid].hidden=!0)}})},add:function(t,e){s(t,e)},insert:s,remove:function(t,e,i){t&&t.cid&&o[t.cid]&&o[t.cid].fields&&void 0!==e&&((t=o[t.cid].fields.splice(e,i))&&t.forEach(function(t){t.el&&t.el.attr&&(t.cmp.setTabIndex?t.cmp.setTabIndex(-1):t.el.attr("tabindex","-1"))}))}}},define("common/main/lib/controller/FocusManager",function(){}),void 0===Common&&(Common={}),define("common/main/lib/component/Window",["common/main/lib/component/BaseView","common/main/lib/component/CheckBox","common/main/lib/controller/FocusManager"],function(){"use strict";function n(){var t=$(".modals-mask");return 0==t.length&&(t=$("<div class='modals-mask'>").appendTo(document.body).hide()).attr("counter",0),t}function e(t){if(!this.isLocked()&&this.isVisible()&&this.initConfig.enableKeyEvents&&!1!==this.pauseKeyEvents)switch(t.keyCode){case Common.UI.Keys.ESC:if($(".asc-loadmask").length<1)return t.preventDefault(),t.stopPropagation(),!1!==this.initConfig.closable&&(this.initConfig.toolcallback?this.initConfig.toolcallback.call(this):"hide"==this.initConfig.toolclose?this.hide():this.close()),!1;break;case Common.UI.Keys.RETURN:if(this.$window.find(".btn.primary").length&&$(".asc-loadmask").length<1&&!1===(this.initConfig.onprimary||this.onPrimary).call(this))return t.preventDefault(),!1}}function l(){var t,e=null==window.innerHeight?(t=document.documentElement.offsetWidth,document.documentElement.offsetHeight):(t=Common.Utils.innerWidth(),Common.Utils.innerHeight());return{width:t,height:e-=Common.Utils.InternalSettings.get("window-inactive-area-top"),top:Common.Utils.InternalSettings.get("window-inactive-area-top")}}function a(t){return{"-webkit-transition":"0.3s opacity","-moz-transition":"0.3s opacity","-ms-transition":"0.3s opacity","-o-transition":"0.3s opacity",opacity:t}}function i(t){var e,i;$(t.target).hasClass("close")||$(t.target).hasClass("help")||(Common.UI.Menu.Manager.hideAll(),e=t instanceof jQuery.Event?Common.Utils.zoom():1,this.dragging.enabled=!0,this.dragging.initx=t.pageX*e-this.getLeft(),this.dragging.inity=t.pageY*e-this.getTop(),e=(t=l()).width,i=t.height,this.dragging.maxx=e-this.getWidth(),this.dragging.maxy=i-this.getHeight(),this.dragging.maxy<0&&(this.dragging.maxy=0),this.dragging.maxy+=t.top,$(document).on("mousemove",this.binding.drag),$(document).on("mouseup",this.binding.dragStop),this.fireEvent("drag",[this,"start"]))}function s(){$(document).off("mousemove",this.binding.drag),$(document).off("mouseup",this.binding.dragStop),this.dragging.enabled=!1,this.fireEvent("drag",[this,"end"])}function r(t){var e,i;this.dragging.enabled&&(i=t instanceof jQuery.Event?Common.Utils.zoom():1,e=t.pageX*i-this.dragging.initx,t=t.pageY*i-this.dragging.inity,i=Common.Utils.InternalSettings.get("window-inactive-area-top"),e<0?e=0:e>this.dragging.maxx&&(e=this.dragging.maxx),t<i?t=i:t>this.dragging.maxy&&(t=this.dragging.maxy),this.$window.css({left:e,top:t}))}function c(t){"mouseup"==t.type&&this.dragging.enabled&&s.call(this)}function d(){var t=l(),e=t.width,t=t.height,i=this.getHeight(),s=this.getWidth(),o=this.getTop(),n=this.getLeft();this.$window.css({left:(n=e<n+s?e-s:n)<0?0:n,top:(o=t<o+i?t-i:o)<0?0:o})}function o(t){Common.UI.Menu.Manager.hideAll();var e=$(t.target),i=this.getLeft(),s=this.getTop(),t=(this.resizing.enabled=!0,this.resizing.initpage_x=t.pageX*Common.Utils.zoom(),this.resizing.initpage_y=t.pageY*Common.Utils.zoom(),this.resizing.initx=this.resizing.initpage_x-i,this.resizing.inity=this.resizing.initpage_y-s,this.resizing.initw=this.getWidth(),this.resizing.inith=this.getHeight(),this.resizing.type=[e.hasClass("left")?-1:e.hasClass("right")?1:0,e.hasClass("top")?-1:e.hasClass("bottom")?1:0],l()),o=t.width,t=t.height,n=this.initConfig.maxwidth||o,a=this.initConfig.maxheight||t;this.resizing.minw=this.initConfig.minwidth,this.resizing.maxw=0<this.resizing.type[0]?Math.min(o-i,n):Math.min(i+this.resizing.initw,n),this.resizing.minh=this.initConfig.minheight,this.resizing.maxh=0<this.resizing.type[1]?Math.min(t-s,a):Math.min(s+this.resizing.inith,a),$(document.body).css("cursor",e.css("cursor")),this.$window.find(".resize-border").addClass("resizing"),this.$window.find(".header").addClass("resizing"),$(document).on("mousemove",this.binding.resize),$(document).on("mouseup",this.binding.resizeStop),this.fireEvent("resize",[this,"start"])}function h(t){var e,i,s;this.resizing.enabled&&(e=!1,i=t instanceof jQuery.Event?Common.Utils.zoom():1,s=t.pageX*i,t=t.pageY*i,this.resizing.type[0]&&((i=this.resizing.initw+(s-this.resizing.initpage_x)*this.resizing.type[0])>this.resizing.maxw?(s-=(i-this.resizing.maxw)*this.resizing.type[0],i=this.resizing.maxw):i<this.resizing.minw&&(s-=(i-this.resizing.minw)*this.resizing.type[0],i=this.resizing.minw),this.resizing.type[0]<0&&this.$window.css({left:s-this.resizing.initx}),this.setWidth(i),e=!0),this.resizing.type[1]&&((s=this.resizing.inith+(t-this.resizing.initpage_y)*this.resizing.type[1])>this.resizing.maxh?(t-=(s-this.resizing.maxh)*this.resizing.type[1],s=this.resizing.maxh):s<this.resizing.minh&&(t-=(s-this.resizing.minh)*this.resizing.type[1],s=this.resizing.minh),this.resizing.type[1]<0&&this.$window.css({top:t-this.resizing.inity}),this.setHeight(s),e=!0),e&&this.fireEvent("resizing"))}function p(){$(document).off("mousemove",this.binding.resize),$(document).off("mouseup",this.binding.resizeStop),$(document.body).css("cursor","auto"),this.$window.find(".resize-border").removeClass("resizing"),this.$window.find(".header").removeClass("resizing"),this.resizing.enabled=!1,this.fireEvent("resize",[this,"end"])}var t;Common.UI.Window=Common.UI.BaseView.extend(_.extend((t={closable:!0,header:!0,modal:!0,width:"auto",height:"auto",title:"Title",alias:"Window",cls:"",toolclose:"close",help:!1,maxwidth:void 0,maxheight:void 0,minwidth:0,minheight:0,enableKeyEvents:!0,automove:!0},Common.UI.alert=function(h){this.Window.prototype;h.buttons||(h.buttons=["ok"]),h.dontshow=h.dontshow||!1,h.width||(h.width="auto");var t='<div class="info-box"><% if (typeof iconCls !== "undefined") { %><div class="icon <%= iconCls %>"></div><% } %><div class="text" <% if (typeof iconCls == "undefined") { %> style="padding-'+(Common.UI.isRTL()?"right":"left")+':10px;"<% } %>><span><%= msg %></span><% if (dontshow) { %><div class="dont-show-checkbox"></div><% } %></div></div><% if (dontshow) { %><div class="separator horizontal" style="width: 100%;"></div><% } %>',p=(_.extend(h,{cls:"alert",onprimary:function(t){return u({currentTarget:p.getChild(".footer .dlg-btn")[0]}),!1},tpl:_.template(t)(h)}),new Common.UI.Window(h)),m=null;function u(t){h.callback&&h.callback.call(p,t.currentTarget.attributes.result.value,!!m&&"checked"==m.getValue()),p.close(!0)}return p.on({"render:after":function(t){var e,i,s,o,n,a,l,r,c,d=t.getChild(".footer");h.dontshow&&d.addClass("dontshow"),d.find(".dlg-btn").on("click",u),m=new Common.UI.CheckBox({el:p.$window.find(".dont-show-checkbox"),labelText:h.textDontShow||p.textDontShow}),t=(d=t).getChild(".info-box"),s=d.getChild(".info-box .text > span"),o=d.getChild(".footer"),n=d.getChild(".header"),a=d.getChild(".body"),l=0<(r=d.getChild(".icon")).length?r.height():0,r=0<r.length?$(r).outerWidth(!0):0,c=d.getChild(".info-box .dont-show-checkbox"),h.dontshow||a.css("padding-bottom","10px"),h.maxwidth&&"auto"==h.width&&(i=Common.UI.isRTL()?parseInt(t.css("padding-right"))+r+s.width()+parseInt(t.css("padding-left")):s.position().left+s.width()+parseInt(t.css("padding-right")))>h.maxwidth&&(h.width=h.maxwidth),"auto"==h.width?(t.height(Math.max(s.height(),l)+(0<c.length?c.height()+parseInt(c.css("margin-top")):0)),a.height(parseInt(t.css("height"))+parseInt(o.css("height"))),e=c.find("span"),i=Common.UI.isRTL()?parseInt(t.css("padding-right"))+r+parseInt(t.css("padding-left"))+Math.max(s.width(),0<c.length?$(c).find(".checkbox-indeterminate").outerWidth(!0):0):Math.max(s.width(),0<e.length?e.position().left+e.width():0)+s.position().left+parseInt(t.css("padding-right")),d.setSize(i,parseInt(a.css("height"))+parseInt(n.css("height")))):(s.css("white-space","normal"),d.setWidth(h.width),t.height(Math.max(s.height(),l)+(0<c.length?c.height()+parseInt(c.css("margin-top")):0)),a.height(parseInt(t.css("height"))+parseInt(o.css("height"))),d.setHeight(parseInt(a.css("height"))+parseInt(n.css("height")))),s.height()<l/2&&s.css({"vertical-align":"baseline","line-height":l+"px"})},show:function(t){t.getChild(".footer .dlg-btn").focus()},close:function(){h.callback&&h.callback.call(p,"close")}}),p.show(),p},Common.UI.error=function(t){return(t=t||{}).title||(t.title=this.Window.prototype.textError),Common.UI.alert(_.extend(t,{iconCls:"error"}))},Common.UI.confirm=function(t){return(t=t||{}).title||(t.title=this.Window.prototype.textConfirmation),Common.UI.alert(_.extend(t,{iconCls:"confirm"}))},Common.UI.info=function(t){return(t=t||{}).title||(t.title=this.Window.prototype.textInformation),Common.UI.alert(_.extend(t,{iconCls:"info"}))},{$window:void 0,$lastmodal:void 0,dragging:{enabled:!(Common.UI.warning=function(t){return(t=t||{}).title||(t.title=this.Window.prototype.textWarning),Common.UI.alert(_.extend(t,{iconCls:"warn"}))})},resizing:{enabled:!1},initialize:function(e){this.initConfig={},this.binding={};var i,s={ok:this.okButtonText,cancel:this.cancelButtonText,yes:this.yesButtonText,no:this.noButtonText,close:this.closeButtonText};e.buttons&&_.isArray(e.buttons)&&(null==e.primary&&(e.primary="ok"),i={},_.each(e.buttons,function(t){"object"==typeof t?void 0!==t.value&&(i[t.value]={text:t.caption,cls:"custom"+(t.primary||e.primary==t.value?" primary":"")}):void 0!==t&&(i[t]={text:"custom"==t?e.customButtonText:s[t],cls:e.primary==t||-1<_.indexOf(e.primary,t)?"primary":""},"custom"==t&&(i[t].cls+=" custom"))}),e.buttons=i,e.footerCls=e.footerCls||"center"),_.extend(this.initConfig,t,e||{}),this.initConfig.id||(this.initConfig.id="window-"+this.cid),this.initConfig.tpl||(this.initConfig.tpl=""),Common.UI.BaseView.prototype.initialize.call(this,this.initConfig)},render:function(){var t=this.initConfig.renderTo||document.body,o=($(t).append(_.template('<div class="asc-window<%= modal?" modal":"" %><%= cls?" "+cls:"" %>" id="<%= id %>" style="width:<%= width %>px;"><% if (header==true) { %><div class="header"><div class="tools"><% if (closable!==false) %><div class="tool close"></div><% %><% if (help===true) %><div class="tool help">?</div><% %></div><div class="title"><%= title %></div> </div><% } %><div class="body"><%= tpl %><% if (typeof (buttons) !== "undefined" && _.size(buttons) > 0) { %><div class="footer"><% for(var bt in buttons) { %><button class="btn normal dlg-btn <%= buttons[bt].cls %>" result="<%= bt %>"><%= buttons[bt].text %></button><% } %></div><% } %></div></div>')(this.initConfig)),this.$window=$("#"+this.initConfig.id),Common.Locale.getCurrentLanguage()&&"en"!==Common.Locale.getCurrentLanguage()&&this.$window.attr("applang",Common.Locale.getCurrentLanguage()),this.binding.keydown=_.bind(e,this),this.initConfig.header?(this.binding.drag=_.bind(r,this),this.binding.dragStop=_.bind(s,this),this.binding.dragStart=_.bind(i,this),this.$window.find(".header").on("mousedown",this.binding.dragStart),this.$window.find(".tool.close").on("click",_.bind(function(){this.$window.find(".tool.close").hasClass("disabled")||(this.initConfig.toolcallback?this.initConfig.toolcallback.call(this):"hide"==this.initConfig.toolclose?this.hide():this.close())},this)),this.$window.find(".tool.help").on("click",_.bind(function(){this.$window.find(".tool.help").hasClass("disabled")||this.fireEvent("help",this)},this)),this.initConfig.modal||Common.Gateway.on("processmouse",_.bind(c,this))):this.$window.find(".body").css({top:0,"border-radius":"5px"}),"auto"!==this.initConfig.height&&this.$window.css("height",this.initConfig.height),this.initConfig.resizable&&this.setResizable(this.initConfig.resizable),this);return this.binding.winclose=function(t){o.$window&&o.isVisible()&&o.$window==t.$window&&o.close()},Common.NotificationCenter.on("window:close",this.binding.winclose),this.initConfig.footerCls&&this.$window.find(".footer").addClass(this.initConfig.footerCls),this.menuAddAlign=function(t,e,i){var s=this;o.$window.hasClass("notransform")?(t.css({left:e,top:i}),s.options.additionalAlign=null):(o.$window.addClass("notransform"),t.addClass("hidden"),setTimeout(function(){t.removeClass("hidden"),t.css({left:e,top:i}),s.options.additionalAlign=null},300))},this.fireEvent("render:after",this),this},show:function(t,e){this.initConfig.modal&&(i=n(),!1===this.options.animate||this.options.animate&&!1===this.options.animate.mask?(i.attr("counter",parseInt(i.attr("counter"))+1),i.show()):(s=$(":root").css("--modal-window-mask-opacity"),i.css("opacity",0),i.attr("counter",parseInt(i.attr("counter"))+1),i.show(),setTimeout(function(){i.css(a(s))},1)),Common.NotificationCenter.trigger("modal:show",this),this.$lastmodal=$(".asc-window.modal:not(.dethrone):visible").first().addClass("dethrone")),this.$window?this.$window.is(":visible")||(this.$window.css({opacity:0}),function(){var t=l(),e=t.width,i=t.height;this.getLeft()+this.getWidth()>e&&this.$window.css("left",e-this.getWidth()),this.getTop()<t.top?this.$window.css("top",t.top):this.getTop()+this.getHeight()>i&&(i-this.getHeight()<0?this.$window.css("top",t.top):this.$window.css("top",t.top+i-this.getHeight()))}.call(this),this.$window.show()):(this.render(),function(){var t;"auto"==this.initConfig.height&&(t=Math.ceil(parseFloat(this.$window.find("> .body").css("height"))),this.initConfig.header&&(t+=parseInt(this.$window.find("> .header").css("height"))),this.$window.height(t))}.call(this),_.isNumber(t)&&_.isNumber(e)?(this.$window.css("left",Math.floor(t)),this.$window.css("top",Math.floor(e))):function(){var t,e=(o=l()).width,i=o.height,s=("auto"==this.initConfig.height?(t=parseInt(this.$window.find(".body").css("height")),this.initConfig.header&&(t+=parseInt(this.$window.find(".header").css("height")))):i<(t=this.initConfig.height)&&(t=i),"auto"==this.initConfig.width?parseInt(this.$window.find(".body").css("width")):this.initConfig.width),o=o.top+Math.floor((parseInt(i)-parseInt(t))/2),i=Math.floor((parseInt(e)-parseInt(s))/2);this.$window.css({left:i<0?0:i,top:o<0?0:o})}.call(this)),$(document).on("keydown."+this.cid,this.binding.keydown),this.initConfig.automove&&(this.binding.windowresize=_.bind(d,this),$(window).on("resize",this.binding.windowresize));var i,s,o=this;setTimeout(function(){o.fireEvent("animate:before",o)},10),!1!==this.options.animate?(this.$window.css({"-webkit-transform":"scale(0.8)","-moz-transform":"scale(0.8)","-ms-transform":"scale(0.8)","-o-transform":"scale(0.8)",opacity:0}),setTimeout(function(){o.$window.css({"-webkit-transition":"0.2s opacity, 0.2s -webkit-transform","-webkit-transform":"scale(1)","-moz-transition":"0.2s opacity, 0.2s -moz-transform","-moz-transform":"scale(1)","-ms-transition":"0.2s opacity, 0.2s -ms-transform","-ms-transform":"scale(1)","-o-transition":"0.2s opacity, 0.2s -o-transform","-o-transform":"scale(1)",opacity:"1"}),setTimeout(function(){o.fireEvent("animate:after",o)},210)},1),setTimeout(function(){o.$window.addClass("notransform"),o.fireEvent("show",o)},this.initConfig.modal?1e3:350)):(this.$window.css({opacity:1}),this.$window.addClass("notransform"),this.fireEvent("show",this),setTimeout(function(){o.fireEvent("animate:after",o)},10)),Common.NotificationCenter.trigger("window:show",this)},close:function(t){var e,i,s;$(document).off("keydown."+this.cid),this.initConfig.automove&&$(window).off("resize",this.binding.windowresize),this.initConfig.header&&this.$window.find(".header").off("mousedown",this.binding.dragStart),Common.NotificationCenter.off({"window:close":this.binding.winclose}),this.initConfig.modal&&(i=!0,(e=n()).attr("counter",parseInt(e.attr("counter"))-1),0<this.$lastmodal.length&&(this.$lastmodal.removeClass("dethrone"),i=!(this.$lastmodal.hasClass("modal")&&this.$lastmodal.is(":visible"))),i&&(!1!==this.options.animate?(s=$(":root").css("--modal-window-mask-opacity"),e.css(a(0)),setTimeout(function(){parseInt(e.attr("counter"))<1&&(e.css("opacity",s),e.hide(),e.attr("counter",0))},300)):parseInt(e.attr("counter"))<1&&(e.hide(),e.attr("counter",0))),Common.NotificationCenter.trigger("modal:close",this,i&&parseInt(e.attr("counter"))<1)),this.$window.remove(),!0!==t&&this.fireEvent("close",this)},hide:function(){var t,e,i;$(document).off("keydown."+this.cid),this.initConfig.automove&&$(window).off("resize",this.binding.windowresize),this.$window&&(this.initConfig.modal&&(e=!0,(t=n()).attr("counter",parseInt(t.attr("counter"))-1),0<this.$lastmodal.length&&(this.$lastmodal.removeClass("dethrone"),e=!(this.$lastmodal.hasClass("modal")&&this.$lastmodal.is(":visible"))),e&&(!1!==this.options.animate?(i=$(":root").css("--modal-window-mask-opacity"),t.css(a(0)),setTimeout(function(){parseInt(t.attr("counter"))<1&&(t.css("opacity",i),t.hide(),t.attr("counter",0))},300)):parseInt(t.attr("counter"))<1&&(t.hide(),t.attr("counter",0))),Common.NotificationCenter.trigger("modal:hide",this,e&&parseInt(t.attr("counter"))<1)),this.$window.hide(),this.$window.removeClass("notransform"),this.fireEvent("hide",this))},isLocked:function(){return this.$window.hasClass("dethrone")||!this.initConfig.modal&&this.$window.parent().find(".asc-window.modal:visible").length},getChild:function(t){return t?this.$window.find(t):this.$window},setWidth:function(t){var e;0<=t&&(t<(e=parseInt(this.$window.css("min-width")))&&(t=e),t-=parseInt(this.$window.css("border-left-width"))+parseInt(this.$window.css("border-right-width")),this.$window.width(t))},getWidth:function(){return parseInt(this.$window.css("width"))},setHeight:function(t){var e;0<=t&&(t<(e=parseInt(this.$window.css("min-height")))&&(t=e),t-=parseInt(this.$window.css("border-bottom-width"))+parseInt(this.$window.css("border-top-width")),this.$window.height(t),this.initConfig.header&&(t-=parseInt(this.$window.find("> .header").css("height"))),this.$window.find("> .body").css("height",t))},getHeight:function(){return parseInt(this.$window.css("height"))},setSize:function(t,e){this.setWidth(t),this.setHeight(e)},getSize:function(){return[this.getWidth(),this.getHeight()]},setTitle:function(t){this.$window.find("> .header > .title").text(t)},getTitle:function(){return this.$window.find("> .header > .title").text()},getLeft:function(){return parseInt(this.$window.css("left"))},getTop:function(){return parseInt(this.$window.css("top"))},isVisible:function(){return this.$window&&this.$window.is(":visible")},setResizable:function(t,e,i){var s;t!==this.resizable?(t?(s='<div class="resize-border left" style="top:'+(this.initConfig.header?"33":"5")+'px; bottom: 5px; height: auto; border-right-style: solid; cursor: w-resize;"></div><div class="resize-border left bottom" style="border-bottom-left-radius: 5px; cursor: sw-resize;"></div><div class="resize-border bottom" style="left: 4px; right: 4px; width: auto; z-index: 2; border-top-style: solid; cursor: s-resize;"></div><div class="resize-border right bottom" style="border-bottom-right-radius: 5px; cursor: se-resize;"></div><div class="resize-border right" style="top:'+(this.initConfig.header?"33":"5")+'px; bottom: 5px; height: auto; border-left-style: solid; cursor: e-resize;"></div><div class="resize-border left top" style="border-top-left-radius: 5px; cursor: nw-resize;"></div><div class="resize-border top" style="left: 4px; right: 4px; width: auto; z-index: 2; border-bottom-style:'+(this.initConfig.header?"none":"solid")+'; cursor: n-resize;"></div><div class="resize-border right top" style="border-top-right-radius: 5px; cursor: ne-resize;"></div>',this.initConfig.header&&(s+='<div class="resize-border left" style="top: 5px; height: 28px; cursor: w-resize;"></div><div class="resize-border right" style="top: 5px; height: 28px; cursor: e-resize;"></div>'),this.$window.append(_.template(s)),this.binding.resize=_.bind(h,this),this.binding.resizeStop=_.bind(p,this),this.binding.resizeStart=_.bind(o,this),e&&1<e.length&&(this.initConfig.minwidth=e[0]),e&&1<e.length&&(this.initConfig.minheight=e[1]),i&&1<i.length&&(this.initConfig.maxwidth=i[0]),i&&1<i.length&&(this.initConfig.maxheight=i[1]),this.$window.find(".resize-border").on("mousedown",this.binding.resizeStart)):this.$window.find(".resize-border").remove(),this.resizable=t):t&&(e&&1<e.length&&(this.initConfig.minwidth=e[0]),e&&1<e.length&&(this.initConfig.minheight=e[1]),i&&1<i.length&&(this.initConfig.maxwidth=i[0]),i&&1<i.length&&(this.initConfig.maxheight=i[1]))},suspendKeyEvents:function(){this.pauseKeyEvents=!1},resumeKeyEvents:function(){this.initConfig.enableKeyEvents&&(this.pauseKeyEvents=!0)},onPrimary:function(){},getFocusedComponents:function(){return[]},getDefaultFocusableComponent:function(){},getFooterButtons:function(){var i;return this.footerButtons||(i=[],this.$window.find(".dlg-btn").each(function(t,e){i.push(new Common.UI.Button({el:$(e)}))}),this.footerButtons=i),this.footerButtons},cancelButtonText:"Cancel",okButtonText:"OK",yesButtonText:"Yes",noButtonText:"No",closeButtonText:"Close",textWarning:"Warning",textError:"Error",textConfirmation:"Confirmation",textInformation:"Information",textDontShow:"Don't show this message again"}),Common.UI.Window||{}))}),define("common/main/lib/view/RenameDialog",["common/main/lib/component/Window"],function(){"use strict";Common.Views.RenameDialog=Common.UI.Window.extend(_.extend({options:{width:330,header:!1,cls:"modal-dlg",filename:"",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,t||{}),this.template=['<div class="box">','<div class="input-row">',"<label>"+this.textName+"</label>","</div>",'<div id="id-dlg-newname" class="input-row"></div>',"</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var e=this,t=(e.inputName=new Common.UI.InputField({el:$("#id-dlg-newname"),style:"width: 100%;",validateOnBlur:!1,maxLength:e.options.maxLength,validation:function(t){return!/[\t*\+:\"<>?|\\\\/]/gim.test(t)||e.txtInvalidName+'*+:"<>?|/'}}),this.getChild());t.find(".btn").on("click",_.bind(this.onBtnClick,this)),e.inputNameEl=t.find("input")},show:function(){Common.UI.Window.prototype.show.apply(this,arguments);var t=this,e=t.options.filename.lastIndexOf(".");0<e&&(t.options.filename=t.options.filename.substring(0,e)),_.delay(function(){t.inputName.setValue(t.options.filename),t.inputNameEl.focus().select()},100)},onPrimary:function(t){return this._handleInput("ok"),!1},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},_handleInput:function(t){if(this.options.handler){if("ok"==t&&!0!==this.inputName.checkValidate())return void this.inputNameEl.focus();this.options.handler.call(this,t,this.inputName.getValue())}this.close()}},Common.Views.RenameDialog||{}))}),void 0===Common&&(Common={}),Common.Views=Common.Views||{},define("common/main/lib/view/Header",["backbone","text!common/main/lib/template/Header.template","core","common/main/lib/view/RenameDialog"],function(t,e){"use strict";Common.Views.Header=t.View.extend(_.extend(function(){var s,o,n,l,r,c=!1,d=!!window.PDFE;_.template("<ul><% for (originalId in users) { %><%= usertpl({user: users[originalId][0], fnEncode: fnEncode, len: users[originalId].length}) %><% } %></ul>");function i(){c=!0,this.btnShare&&this.btnShare.setVisible(!1),a(s)}function a(t){var e,i,s,o,n;r&&t&&(e=r.parent(),t.isEdit?t.customization&&t.customization.compactHeader||(s=e.position().left,o=e.next().outerWidth(),n=r.outerWidth(),.1<(i=(i=r[0].style.width)?parseFloat(i):n)-n?(e.css("padding-left",s<o?Math.max(2,e.outerWidth()-2-i):2),e.css("padding-right",s<o?2:Math.max(2,e.outerWidth()-2-i))):(e.css("padding-left",s<o?Math.max(2,Math.min(o-s+2,e.outerWidth()-2-i)):2),e.css("padding-right",s<o?2:Math.max(2,Math.min(s-o+2,e.outerWidth()-2-i))))):(s=e.position().left,o=e.next().outerWidth(),e.css("padding-left",s<o?Math.max(2,o-s):2),e.css("padding-right",s<o?2:Math.max(2,s-o))),t.customization&&t.customization.toolbarHideFileName||!(!t.isEdit||t.customization&&t.customization.compactHeader)||(n=parseFloat(e.css("padding-left")||0)+parseFloat(e.css("padding-right")||0)+parseInt(r.css("min-width")||50),t.isCrypted&&(n+=20),e.css("flex-basis",Math.ceil(n)+"px"),e.closest(".extra.right").css("flex-basis",Math.ceil(n)+e.next().outerWidth()+"px"),Common.NotificationCenter.trigger("tab:resize")))}function h(t){var e=this;t=t||s,e.btnPDFMode&&t&&(e.btnPDFMode.setIconCls("toolbar__icon icon--inverse "+(t.isPDFEdit?"btn-edit":t.isPDFAnnotate?"btn-menu-comments":"btn-sheet-view")),e.btnPDFMode.setCaption(t.isPDFEdit?e.textEdit:t.isPDFAnnotate?e.textComment:e.textView),e.btnPDFMode.updateHint(t.isPDFEdit?e.tipEdit:t.isPDFAnnotate?e.tipComment:e.tipView))}function p(){!s||!s.isEdit||s.customization&&s.customization.compactHeader||a(s)}function m(t){r&&(t.isCrypted&&(r.before('<div class="inner-box-icon crypted hidden"><svg class="icon"><use xlink:href="#svg-icon-crypted"></use></svg></div>'),this.imgCrypted=r.parent().find(".crypted"),this._showImgCrypted=!0),a(t))}function u(t){s=t;var e,i=this;i.btnGoBack.on("click",function(t){Common.NotificationCenter.trigger("goback")}),i.btnFavorite.on("click",function(t){Common.NotificationCenter.trigger("markfavorite",!i.options.favorite)}),i.btnShare&&(i.btnShare.on("click",function(t){Common.NotificationCenter.trigger("collaboration:sharing")}),i.btnShare.updateHint(i.tipAccessRights),i.btnShare.setVisible(!c&&s&&(s.sharingSettingsUrl&&s.sharingSettingsUrl.length||s.canRequestSharingSettings)),a(s)),s.user.guest&&s.canRenameAnonymous&&i.btnUserName&&i.btnUserName.on("click",function(t){Common.NotificationCenter.trigger("user:rename")}),i.btnPrint&&(i.btnPrint.updateHint(i.tipPrint+Common.Utils.String.platformKey("Ctrl+P")),i.btnPrint.on("click",function(t){i.fireEvent("print",i)})),i.btnPrintQuick&&(i.btnPrintQuick.updateHint(i.tipPrintQuick),i.btnPrintQuick.on("click",function(t){i.fireEvent("print-quick",i)})),i.btnSave&&(i.btnSave.updateHint(i.tipSave+(d?"":Common.Utils.String.platformKey("Ctrl+S"))),i.btnSave.on("click",function(t){i.fireEvent("save",i)})),i.btnUndo&&(i.btnUndo.updateHint(i.tipUndo+Common.Utils.String.platformKey("Ctrl+Z")),i.btnUndo.on("click",function(t){i.fireEvent("undo",i)})),i.btnRedo&&(i.btnRedo.updateHint(i.tipRedo+Common.Utils.String.platformKey("Ctrl+Y")),i.btnRedo.on("click",function(t){i.fireEvent("redo",i)})),i.btnDownload&&(i.btnDownload.updateHint(i.tipDownload),i.btnDownload.on("click",function(t){i.fireEvent("download")})),t.isEdit||(i.btnDownload&&(i.btnDownload.updateHint(i.tipDownload),i.btnDownload.on("click",function(t){i.fireEvent("downloadas",["original"])})),i.btnEdit&&(i.btnEdit.updateHint(i.tipGoEdit),i.btnEdit.on("click",function(t){i.fireEvent("go:editor",i)}))),i.btnSearch&&i.btnSearch.updateHint(i.tipSearch+Common.Utils.String.platformKey("Ctrl+F")),i.btnPDFMode&&(t=_.template('<a id="<%= id %>" tabindex="-1" type="menuitem"><div><% if (!_.isEmpty(iconCls)) { %><span class="menu-item-icon <%= iconCls %>"></span><% } %><b><%= caption %></b></div><% if (options.description !== null) { %><label class="margin-left-10 description"><%= options.description %></label><% } %></a>'),e=[],s.canPDFEdit&&e.push({caption:i.textEdit,iconCls:"menu__icon btn-edit",template:t,description:i.textEditDesc,value:"edit"}),e.push({caption:i.textComment,iconCls:"menu__icon btn-menu-comments",template:t,description:i.textCommentDesc,value:"comment",disabled:!s.canPDFAnnotate}),e.push({caption:i.textView,iconCls:"menu__icon btn-sheet-view",template:t,description:i.textViewDesc,value:"view"}),i.btnPDFMode.setMenu(new Common.UI.Menu({cls:"ppm-toolbar",style:"width: 220px;",menuAlign:"tr-br",items:e})),i.btnPDFMode.menu.on("item:click",function(t,e){Common.NotificationCenter.trigger("pdf:mode",e.value,_.bind(h,i))})),!s.isEdit||s.customization&&s.customization.compactHeader||Common.NotificationCenter.on("window:resize",p)}return{options:{branding:{},documentCaption:"",canBack:!1,wopi:!1},el:"#header",template:_.template(e),events:{},initialize:function(t){var e=this;this.options=this.options?_.extend(this.options,t):t,this.documentCaption=this.options.documentCaption,this.branding=this.options.customization,this.isModified=!1,e.btnGoBack=new Common.UI.Button({id:"btn-go-back",cls:"btn-header",iconCls:"toolbar__icon icon--inverse btn-goback",dataHint:"0",dataHintDirection:"bottom",dataHintOffset:"big"}),e.btnSearch=new Common.UI.Button({cls:"btn-header no-caret",iconCls:"toolbar__icon icon--inverse btn-menu-search",enableToggle:!0,dataHint:"0",dataHintDirection:"bottom",dataHintOffset:"big"}),e.btnFavorite=new Common.UI.Button({id:"id-btn-favorite",cls:"btn-header",iconCls:"toolbar__icon icon--inverse btn-favorite",dataHint:"0",dataHintDirection:"bottom",dataHintOffset:"big"}),Common.NotificationCenter.on({"app:ready":function(t){Common.Utils.asyncCall(u,e,t)},"app:face":function(t){Common.Utils.asyncCall(m,e,t)},"tab:visible":function(){Common.Utils.asyncCall(a,e,s)},"collaboration:sharingdeny":function(t){Common.Utils.asyncCall(i,e,t)}}),Common.NotificationCenter.on("uitheme:changed",this.changeLogo.bind(this))},render:function(t,e){return $(t).html(this.getPanel(e)),this},getPanel:function(t,a){var e,i=this;function s(t,e,i,s,o,n){return new Common.UI.Button({cls:"btn-header",iconCls:t,disabled:!0===i,dataHint:"0",dataHintDirection:s||(a.isDesktopApp?"right":"left"),dataHintOffset:o||(a.isDesktopApp?"10, -18":"10, 10"),dataHintTitle:n}).render(e)}return"left"!=t||a&&a.isDesktopApp?"right"==t?(e=$(_.template('<section><section id="box-doc-name"><input id="rib-doc-name" autofill="off" autocomplete="off"/></input></section><section style="display: inherit;"><div class="hedset"><div class="btn-slot" id="slot-hbtn-edit"></div><div class="btn-slot" id="slot-hbtn-print"></div><div class="btn-slot" id="slot-hbtn-print-quick"></div><div class="btn-slot" id="slot-hbtn-download"></div></div><div class="hedset" data-layout-name="header-users"><section id="tlb-box-users" class="box-cousers dropdown"><div class="btn-users dropdown-toggle" data-toggle="dropdown" data-hint="0" data-hint-direction="bottom" data-hint-offset="big"><div class="inner-box-icon"><svg class=""><use xlink:href="#svg-icon-users"></use></svg></div><label class="caption"></label></div><div class="cousers-menu dropdown-menu"><label id="tlb-users-menu-descr"><%= tipUsers %></label><div class="cousers-list"></div></div></section></div><div class="hedset"><div class="btn-slot" id="slot-btn-share"></div></div><div class="hedset"><div class="btn-slot" id="slot-btn-pdf-mode"></div></div><div class="hedset"><div class="btn-slot" id="slot-btn-mode"></div><div class="btn-slot" id="slot-btn-back"></div><div class="btn-slot" id="slot-btn-favorite"></div><div class="btn-slot" id="slot-btn-search"></div></div></section></section>')({tipUsers:this.labelCoUsersDescr,textShare:this.textShare})),r?e.find("#rib-doc-name").hide():(r=e.find("#rib-doc-name"),i.documentCaption&&setTimeout(function(){i.setDocTitle(i.documentCaption)},50)),this.setCanRename(!!this.options.canRename),!0===this.options.canBack?i.btnGoBack.render(e.find("#slot-btn-back")):e.find("#slot-btn-back").hide(),void 0!==this.options.favorite&&null!==this.options.favorite?(i.btnFavorite.render(e.find("#slot-btn-favorite")),i.btnFavorite.changeIcon(i.options.favorite?{next:"btn-in-favorite",curr:"btn-favorite"}:{next:"btn-favorite",curr:"btn-in-favorite"}),i.btnFavorite.updateHint(i.options.favorite?i.textRemoveFavorite:i.textAddFavorite)):e.find("#slot-btn-favorite").hide(),a.isEdit||(!a.canDownload&&!a.canDownloadOrigin||a.isOffline||(this.btnDownload=s("toolbar__icon icon--inverse btn-download",e.findById("#slot-hbtn-download"),void 0,"bottom","big")),a.canPrint&&(this.btnPrint=s("toolbar__icon icon--inverse btn-print",e.findById("#slot-hbtn-print"),void 0,"bottom","big","P")),a.canQuickPrint&&(this.btnPrintQuick=s("toolbar__icon icon--inverse btn-quick-print",e.findById("#slot-hbtn-print-quick"),void 0,"bottom","big","Q")),a.canEdit&&a.canRequestEditRights&&!d&&(this.btnEdit=s("toolbar__icon icon--inverse btn-edit",e.findById("#slot-hbtn-edit"),void 0,"bottom","big"))),i.btnSearch.render(e.find("#slot-btn-search")),(!a.isEdit||a.customization&&a.customization.compactHeader)&&((a.user.guest&&a.canRenameAnonymous?(i.btnUserName=new Common.UI.Button({el:e.findById(".slot-btn-user-name"),cls:"btn-header",dataHint:"0",dataHintDirection:"bottom",dataHintOffset:"big",visible:!0}),i.btnUserName.cmpEl):(i.elUserName=e.find(".btn-current-user"),i.elUserName)).removeClass("hidden"),l=e.find(".color-user-name"),i.setUserName(i.options.userName)),!c&&a&&(a.sharingSettingsUrl&&a.sharingSettingsUrl.length||a.canRequestSharingSettings)?(i.btnShare=new Common.UI.Button({cls:"btn-header btn-header-share",iconCls:"toolbar__icon icon--inverse btn-users-share",caption:i.textShare,dataHint:"0",dataHintDirection:"bottom",dataHintOffset:"big"}),i.btnShare.render(e.find("#slot-btn-share"))):e.find("#slot-btn-share").hide(),d&&a.isEdit&&!a.isOffline&&a.canSwitchMode?(i.btnPDFMode=new Common.UI.Button({cls:"btn-header btn-header-pdf-mode no-caret",iconCls:"toolbar__icon icon--inverse btn-sheet-view",caption:i.textView,menu:!0,dataHint:"0",dataHintDirection:"bottom",dataHintOffset:"big"}),i.btnPDFMode.render(e.find("#slot-btn-pdf-mode")),h.call(i,a)):e.find("#slot-btn-pdf-mode").hide(),e.find(".cousers-list"),(o=e.find(".box-cousers")).hide(),e):"title"==t?(e=$(_.template('<section id="box-document-title"><div class="extra"></div><div class="hedset"><div class="btn-slot" id="slot-btn-dt-home"></div><div class="btn-slot" id="slot-btn-dt-save" data-layout-name="header-save"></div><div class="btn-slot" id="slot-btn-dt-print"></div><div class="btn-slot" id="slot-btn-dt-print-quick"></div><div class="btn-slot" id="slot-btn-dt-download"></div><div class="btn-slot" id="slot-btn-dt-undo"></div><div class="btn-slot" id="slot-btn-dt-redo"></div></div><div class="lr-separator" id="id-box-doc-name"><input id="title-doc-name" autofill="off" autocomplete="off"/></input></div></section>')()),r&&r.hide().off(),r=e.find("#title-doc-name"),setTimeout(function(){i.setDocTitle(i.documentCaption)},50),i.options.wopi&&r.attr("maxlength",i.options.wopi.FileNameMaxLength),(a.user.guest&&a.canRenameAnonymous?(i.btnUserName=new Common.UI.Button({el:e.findById(".slot-btn-user-name"),cls:"btn-header",dataHint:"0",dataHintDirection:"bottom",dataHintOffset:"big",visible:!0}),i.btnUserName.cmpEl):(i.elUserName=e.find(".btn-current-user"),i.elUserName)).removeClass("hidden"),l=e.find(".color-user-name"),a.canPrint&&a.isEdit&&(i.btnPrint=s("toolbar__icon icon--inverse btn-print",e.findById("#slot-btn-dt-print"),!0,void 0,void 0,"P")),a.canQuickPrint&&a.isEdit&&(i.btnPrintQuick=s("toolbar__icon icon--inverse btn-quick-print",e.findById("#slot-btn-dt-print-quick"),!0,void 0,void 0,"Q")),!a.document.url.startsWith("file:///")&&a.document.url.includes(":")&&(i.btnDownload=s("toolbar__icon icon--inverse btn-download",e.findById("#slot-btn-dt-download"),!1,void 0,void 0,"D")),i.btnSave=s("toolbar__icon icon--inverse btn-save",e.findById("#slot-btn-dt-save"),!0,void 0,void 0,"S"),i.btnUndo=s("toolbar__icon icon--inverse btn-undo",e.findById("#slot-btn-dt-undo"),!0,void 0,void 0,"Z"),i.btnRedo=s("toolbar__icon icon--inverse btn-redo",e.findById("#slot-btn-dt-redo"),!0,void 0,void 0,"Y"),e):void 0:$("")},setVisible:function(t){},setBranding:function(t){var e,i;(this.branding=t)&&t.logo&&(t.logo.image||t.logo.imageDark)&&(e=Common.UI.Themes.isDarkTheme()?t.logo.imageDark||t.logo.image:t.logo.image||t.logo.imageDark,(i=$("#header-logo"))&&(i.html('<img src="'+e+'" style="max-width:100px; max-height:20px; margin: 0;"/>'),i.css({"background-image":"none",width:"auto"}),!t.logo.url&&void 0!==t.logo.url||i.addClass("link")))},changeLogo:function(){var t=this.branding;t&&t.logo&&t.logo.image&&t.logo.imageDark&&t.logo.image!==t.logo.imageDark&&(t=Common.UI.Themes.isDarkTheme()?t.logo.imageDark||t.logo.image:t.logo.image||t.logo.imageDark,$("#header-logo img").attr("src",t))},setDocumentCaption:function(t){this.documentCaption=t=t||"";var e=this.documentCaption.lastIndexOf(".");return 0<e&&(this.fileExtention=this.documentCaption.substring(e)),this.isModified&&(t+="*"),this.readOnly&&(t+=" ("+this.textReadOnly+")"),r&&this.setDocTitle(t),t},getDocumentCaption:function(){return this.documentCaption},setDocumentChanged:function(t){this.isModified=t;var e=this.documentCaption;t&&(e+="*"),this.setDocTitle(e)},setCanBack:function(t,e){return this.options.canBack=t,this.btnGoBack[t?"show":"hide"](),t&&this.btnGoBack.updateHint(e&&"string"==typeof e?e:this.textBack),a(s),this},getCanBack:function(){return this.options.canBack},setFavorite:function(t){return this.options.favorite=t,this.btnFavorite[null!=t?"show":"hide"](),this.btnFavorite.changeIcon(t?{next:"btn-in-favorite",curr:"btn-favorite"}:{next:"btn-favorite",curr:"btn-in-favorite"}),this.btnFavorite.updateHint(t?this.textRemoveFavorite:this.textAddFavorite),a(s),this},getFavorite:function(){return this.options.favorite},setWopi:function(t){this.options.wopi=t},setCanRename:function(t){var e,i,s=this;s.options.canRename=t,r&&(e=r,t?(e.removeAttr("disabled").tooltip({title:s.txtRename,placement:"cursor"}),e.on({keydown:function(t){var e=this,i=r.val();t.keyCode==Common.UI.Keys.RETURN?(i=i.trim(),_.isEmpty(i)||e.cutDocName(e.documentCaption)===i?Common.NotificationCenter.trigger("edit:complete",e):(e.isSaveDocName=!0,/[\t*\+:\"<>?|\\\\/]/gim.test(i)?_.defer(function(){Common.UI.error({msg:(new Common.Views.RenameDialog).txtInvalidName+'*+:"<>?|/',callback:function(){_.delay(function(){r.focus(),e.isSaveDocName=!0},50)}})}):e.withoutExt&&(i=e.cutDocName(i),e.fireEvent("rename",[i]),i+=e.fileExtention,e.withoutExt=!1,e.setDocTitle(i),Common.NotificationCenter.trigger("edit:complete",e)))):t.keyCode==Common.UI.Keys.ESC?Common.NotificationCenter.trigger("edit:complete",this):_.delay(function(){e.setDocTitle()},10)}.bind(this),focus:function(t){var e,i=this;i.imgCrypted&&i.imgCrypted.toggleClass("hidden",!0),i.isSaveDocName=!1,i.withoutExt||(e=i.cutDocName(r.val()),i.withoutExt=!0,_.delay(function(){i.setDocTitle(e),r.select()},100))}.bind(this),blur:function(t){s.imgCrypted&&s.imgCrypted.toggleClass("hidden",!1),Common.Utils.isGecko&&(e[0].selectionStart=e[0].selectionEnd=0),s.isSaveDocName||(s.withoutExt=!1,s.setDocTitle(s.documentCaption))},paste:function(t){setTimeout(function(){var t=s.cutDocName(r.val());s.setDocTitle(t)})}})):(e.off(),e.attr("disabled",!0),(i=e.data("bs.tooltip"))&&(i.options.title="",i.setContent())),e.attr("data-can-copy",t))},cutDocName:function(t){var e;return!(t.length<=this.fileExtention.length)&&(e=t.length-this.fileExtention.length,t.substring(e)==this.fileExtention)?t.substring(0,e):t},setDocTitle:function(t){var e=this.getTextWidth(t||r.val())+10;0<=e&&r.width(e),t&&0<=e&&r.val(t),this._showImgCrypted&&0<=e&&(this.imgCrypted.toggleClass("hidden",!1),this._showImgCrypted=!1),0<=e&&p()},getTextWidth:function(t){var e,i;return this._testCanvas||(e=(r.css("font-size")+" "+r.css("font-family")).trim())&&(i=document.createElement("canvas"),this._testCanvas=i.getContext("2d"),this._testCanvas.font=e),this._testCanvas?void 0!==(i=this._testCanvas.measureText(t)).actualBoundingBoxLeft?Math.ceil(Math.abs(i.actualBoundingBoxLeft)+Math.abs(i.actualBoundingBoxRight))+1:i.width?Math.ceil(i.width)+2:0:-1},setUserName:function(t){return this.options.userName=t,this.btnUserName?this.btnUserName.updateHint(t):this.elUserName&&this.elUserName.tooltip({title:Common.Utils.String.htmlEncode(t),placement:"cursor",html:!0}),l&&l.text(this.getInitials(t)),this},getButton:function(t){return"save"==t?this.btnSave:"users"==t?o:"share"==t?this.btnShare:void 0},lockHeaderBtns:function(t,e){if("users"==t)e?n.addClass("disabled").attr("disabled","disabled"):n.removeClass("disabled").removeAttr("disabled"),this.btnShare&&this.btnShare.setDisabled(e);else if("rename-user"==t)this.btnUserName&&this.btnUserName.setDisabled(e);else{var i=function(t){t&&(e?(t.keepState={disabled:t.isDisabled()},t.setDisabled(!0)):(t.setDisabled(t.keepState&&t.keepState.disabled||e),delete t.keepState))};switch(t){case"undo":i(this.btnUndo);break;case"redo":i(this.btnRedo)}}},getInitials:function(t){for(var e=t.split(" "),i=e[0].substring(0,1).toUpperCase(),s=e.length-1;0<s;s--)if("("!==e[s][0]&&")"!==e[s][0]){i+=e[s].substring(0,1).toUpperCase();break}return i},setDocumentReadOnly:function(t){this.readOnly=t,this.setDocumentCaption(this.documentCaption)}}}(),Common.Views.Header||{}))}),void 0===Common&&(Common={}),define("common/main/lib/component/ToggleManager",["common/main/lib/component/BaseView"],function(){"use strict";var n={};function i(t,e){var i,s,o;if(e)for(s=0,o=(i=n[t.toggleGroup]).length;s<o;s++)i[s]===t||i[s].isActive&&!i[s].isActive()||i[s].toggle(!1)}Common.UI.ToggleManager={register:function(t){t.toggleGroup&&((n[t.toggleGroup]||(n[t.toggleGroup]=[])).push(t),t.on("toggle",i))},unregister:function(t){var e;!t.toggleGroup||(e=n[t.toggleGroup])&&(_.without(e,t),t.off("toggle",i))},getToggled:function(t){var e,i=n[t],s=0;if(i)for(e=i.length;s<e;s++)if(!0===i[s].pressed||!0===i[s].checked)return i[s];return null}}}),void 0===Common&&(Common={}),define("common/main/lib/component/Button",["common/main/lib/component/BaseView","common/main/lib/component/ToggleManager"],function(){"use strict";window.createButtonSet=function(){function t(t){}t.prototype=new Array;var e,i=!1,s=((t.prototype.constructor=t).prototype.add=function(t){t.setDisabled(i),this.push(t)},t.prototype.setDisabled=function(e){i=e,this.forEach(function(t){t.setDisabled(e)})},t.prototype.toggle=function(e,i){this.forEach(function(t){t.toggle(e,i)})},t.prototype.pressed=function(){return this.some(function(t){return t.pressed})},t.prototype.contains=function(e){return this.some(function(t){return t.id==e})},t.prototype.concat=function(){var t=Array.prototype.slice.call(arguments),e=Array.prototype.slice.call(this);return t.forEach(function(t){t instanceof Array?Array.prototype.push.apply(e,t):t&&e.push(t)}),e},Object.create(t.prototype));for(e in arguments)s.add(arguments[e]);return s};function r(t){var e=document.createElement("span"),t=(e.style.fontSize=document.documentElement.style.getPropertyValue("--font-size-base-app-custom")||"11px",e.style.fontFamily='Arial, Helvetica, "Helvetica Neue", sans-serif',e.style.position="absolute",e.style.top="-1000px",e.style.left="-1000px",e.innerHTML=t,document.body.appendChild(e),e.offsetWidth);return document.body.removeChild(e),t}function c(t,e){for(var i=t.length-1,s=t;r(s)>e;)s=t.slice(0,i).trim()+"...",i--;return s}Common.UI.Button=Common.UI.BaseView.extend({options:{id:null,hint:!1,enableToggle:!1,allowDepress:!0,toggleGroup:null,cls:"",iconCls:"",caption:"",menu:null,disabled:!1,pressed:!1,split:!1,visible:!0,dataHint:"",dataHintDirection:"",dataHintOffset:"0, 0",scaling:!1},template:_.template(["<% var applyicon = function() { %>","<% if (iconImg) { print('<img src=\"' + iconImg + '\">'); } else { %>",'<% if (iconCls != "") {  if (/svgicon/.test(iconCls)) {print(\'<svg class="icon uni-scale"><use class="zoom-int" xlink:href="#\' + /svgicon\\s(\\S+)/.exec(iconCls)[1] + \'"></use></svg>\');} else print(\'<i class="icon \' + iconCls + \'">&nbsp;</i>\'); }} %>',"<% } %>","<% if ( !menu ) { %>",'<button type="button" class="btn <%= cls %>" id="<%= id %>" style="<%= style %>" data-hint="<%= dataHint %>" data-hint-direction="<%= dataHintDirection %>" data-hint-offset="<%= dataHintOffset %>" <% if (dataHintTitle) { %> data-hint-title="<%= dataHintTitle %>" <% } %>>',"<% applyicon() %>",'<span class="caption"><%= caption %></span>',"</button>","<% } else if (split == false) {%>",'<div class="btn-group" id="<%= id %>" style="<%= style %>">','<button type="button" class="btn dropdown-toggle <%= cls %>" data-toggle="dropdown" data-hint="<%= dataHint %>" data-hint-direction="<%= dataHintDirection %>" data-hint-offset="<%= dataHintOffset %>" <% if (dataHintTitle) { %> data-hint-title="<%= dataHintTitle %>" <% } %>>',"<% applyicon() %>",'<span class="caption"><%= caption %></span>','<span class="inner-box-caret"><i class="caret"></i></span>',"</button>","</div>","<% } else { %>",'<div class="btn-group split" id="<%= id %>" style="<%= style %>">','<button type="button" class="btn <%= cls %>">',"<% applyicon() %>",'<span class="caption"><%= caption %></span>',"</button>",'<button type="button" class="btn <%= cls %> dropdown-toggle" data-toggle="dropdown" data-hint="<%= dataHint %>" data-hint-direction="<%= dataHintDirection %>" data-hint-offset="<%= dataHintOffset %>" <% if (dataHintTitle) { %> data-hint-title="<%= dataHintTitle %>" <% } %>>','<i class="caret"></i>','<span class="sr-only"></span>',"</button>","</div>","<% } %>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);t=this;t.id=t.options.id||Common.UI.getId(),t.hint=t.options.hint,t.enableToggle=t.options.enableToggle,t.allowDepress=t.options.allowDepress,t.cls=t.options.cls,t.iconCls=t.options.iconCls,t.menu=t.options.menu,t.split=t.options.split,t.toggleGroup=t.options.toggleGroup,t.disabled=t.options.disabled,t.visible=t.options.visible,t.pressed=t.options.pressed,t.caption=t.options.caption,t.template=t.options.template||t.template,t.style=t.options.style,(t.rendered=!1)===t.options.scaling&&t.options.iconCls&&(t.iconCls=t.options.iconCls+" scaling-off"),t.options.el?t.render():t.options.parentEl&&t.render(t.options.parentEl)},getCaptionWithBreaks:function(t){var e=t.split(" "),i=null,s=156,o=e.indexOf("&");if(-1<o&&(e[o-1]+=" &",e.splice(o,1)),1<e.length)if(s=this.menu||!0===this.split?s-10:s,e.length<3)e[0]=c(e[0],this.menu?s+10:s),e[1]=c(e[1],s),i=e[0]+"<br>"+e[1];else{var n="";if(r(e[0]+" "+e[1])<s){for(var a=2;a<e.length;a++)n+=e[a]+" ";i=2*r(n+(this.menu?10:0))<r(e[0]+" "+e[1])?(n=c((e[1]+" "+n).trim(),s),e[0]+"<br>"+n):(n=c(n.trim(),s),e[0]+" "+e[1]+"<br>"+n)}else{for(var l=1;l<e.length;l++)n+=e[l]+" ";n=c(n.trim(),s),i=e[0]+"<br>"+n}}else{i=r(t)<s?t:c(t,s);!this.menu&&!0!==this.split||(i+="<br>")}return i},render:function(t){var o,e,n,i,s,a,l,r,c=this;return c.trigger("render:before",c),c.cmpEl=c.$el||$(c.el),t&&(c.setElement(t,!1),c.rendered||(/icon-top/.test(c.cls)&&c.caption&&/huge/.test(c.cls)&&(!0===c.split?(c.cls&&(c.cls=c.cls.replace(/\s?(?:x-huge|icon-top)/g,"")),this.template=_.template('<div class="btn-group x-huge split icon-top" id="<%= id %>" style="<%= style %>"><button type="button" class="btn <%= cls %> inner-box-icon"><span class="btn-fixflex-hcenter"><% if ( iconImg ) { %><img src="<%= iconImg %>"><% } else { %><% if (/svgicon/.test(iconCls)) {print(\'<svg class="icon uni-scale"><use class="zoom-int" xlink:href="#\' + /svgicon\\s(\\S+)/.exec(iconCls)[1] + \'"></use></svg>\');} else print(\'<i class="icon \' + iconCls + \'">&nbsp;</i>\'); %><% } %></span></button><button type="button" class="btn <%= cls %> inner-box-caption dropdown-toggle" data-toggle="dropdown" data-hint="<%= dataHint %>" data-hint-direction="<%= dataHintDirection %>" data-hint-offset="<%= dataHintOffset %>" <% if (dataHintTitle) { %> data-hint-title="<%= dataHintTitle %>" <% } %>><span class="btn-fixflex-vcenter"><span class="caption"><%= caption %><i class="caret"></i></span><i class="caret compact-caret"></i></span></button></div>')):c.menu?this.template=_.template('<div class="btn-group icon-top" id="<%= id %>" style="<%= style %>"><button type="button" class="btn dropdown-toggle <%= cls %>" data-toggle="dropdown" data-hint="<%= dataHint %>" data-hint-direction="<%= dataHintDirection %>" data-hint-offset="<%= dataHintOffset %>" <% if (dataHintTitle) { %> data-hint-title="<%= dataHintTitle %>" <% } %>><div class="inner-box-icon"><% if ( iconImg ) { %><img src="<%= iconImg %>"><% } else { %><% if (/svgicon/.test(iconCls)) {print(\'<svg class="icon uni-scale"><use class="zoom-int" xlink:href="#\' + /svgicon\\s(\\S+)/.exec(iconCls)[1] + \'"></use></svg>\');} else print(\'<i class="icon \' + iconCls + \'">&nbsp;</i>\'); %><% } %></div><div class="inner-box-caption"><span class="caption"><%= caption %><i class="caret"></i></span><i class="caret compact-caret"></i></div></button></div>'):this.template=_.template('<button type="button" class="btn <%= cls %>" id="<%= id %>" data-hint="<%= dataHint %>" data-hint-direction="<%= dataHintDirection %>" data-hint-offset="<%= dataHintOffset %>" <% if (dataHintTitle) { %> data-hint-title="<%= dataHintTitle %>" <% } %>> <div class="inner-box-icon"><% if ( iconImg ) { %><img src="<%= iconImg %>"><% } else { %><% if (/svgicon/.test(iconCls)) {print(\'<svg class="icon uni-scale"><use class="zoom-int" xlink:href="#\' + /svgicon\\s(\\S+)/.exec(iconCls)[1] + \'"></use></svg>\');} else print(\'<i class="icon \' + iconCls + \'">&nbsp;</i>\'); %><% } %></div><div class="inner-box-caption"><span class="caption"><%= caption %></span></div></button>'),(e=this.getCaptionWithBreaks(this.caption))&&(c.caption=e)),c.cmpEl=$(this.template({id:c.id,cls:c.cls,iconCls:c.iconCls,iconImg:c.options.iconImg,menu:c.menu,split:c.split,disabled:c.disabled,pressed:c.pressed,caption:c.caption,style:c.style,dataHint:c.options.dataHint,dataHintDirection:c.options.dataHintDirection,dataHintOffset:c.options.dataHintOffset,dataHintTitle:c.options.dataHintTitle})),c.menu&&_.isObject(c.menu)&&_.isFunction(c.menu.render)&&c.menu.render(c.cmpEl),t.html(c.cmpEl),c.$icon=c.$el.find(".icon"))),c.rendered||(e=(o=c.cmpEl).hasClass("btn-group"),n=o.hasClass("split"),c.options.hint&&(i=c.cmpEl.closest(".asc-window"),"object"==typeof c.options.hint&&1<c.options.hint.length&&0<$("button",o).length?(t=$("button",o),c.btnEl=$(t[0]),c.btnMenuEl=$(t[1])):(c.btnEl=c.cmpEl,c.btnEl.attr("data-toggle","tooltip")),c.btnEl.tooltip({title:"string"==typeof c.options.hint?c.options.hint:c.options.hint[0],placement:c.options.hintAnchor||"cursor"}),c.btnMenuEl&&c.btnMenuEl.tooltip({title:c.options.hint[1],placement:c.options.hintAnchor||"cursor"}),0<i.length&&(c.btnEl.data("bs.tooltip").tip().css("z-index",parseInt(i.css("z-index"))+10),c.btnMenuEl&&c.btnMenuEl.data("bs.tooltip").tip().css("z-index",parseInt(i.css("z-index"))+10),s=function(t){i[0]===t.$window[0]&&((t=c.btnEl.data("bs.tooltip"))&&(void 0===t.dontShow&&(t.dontShow=!0),t.hide()),Common.NotificationCenter.off({"modal:close":s}))},Common.NotificationCenter.on({"modal:close":s}))),_.isString(c.toggleGroup)&&(c.enableToggle=!0),t=function(t){var e;c.disabled||1!=t.which||(c.doToggle(),c.options.hint&&(e=c.btnEl.data("bs.tooltip"))&&(void 0===e.dontShow&&(e.dontShow=!0),e.hide()),c.trigger("click",c,t))},a=function(t,e,i){var s;if(t||(s=!1,$("button",o).each(function(t,e){if($(e).is(":hover"))return!(s=!0)}),s||(o.removeClass("over"),$("button",o).removeClass("over"))),"button"==e){if(!t&&c.enableToggle&&c.allowDepress&&c.pressed)return;if(t&&!n&&c.enableToggle&&c.allowDepress&&!c.pressed)return void i.preventDefault();$("button:first",o).toggleClass("active",t)}else $("[data-toggle^=dropdown]",o).toggleClass("active",t);o.toggleClass("active",t)},r=function(t){a(!1,l,t),$(document).off("mouseup",r)},(e?(n&&($("[data-toggle^=dropdown]",o).on("mousedown",_.bind(function(t){var e;c.disabled||1!=t.which||n&&(c.options.hint&&(e=(c.btnMenuEl||c.btnEl).data("bs.tooltip"))&&(void 0===e.dontShow&&(e.dontShow=!0),e.hide()),e=o.hasClass("open"),a(!e,"arrow",t))},this)),$("button",o).on("mousedown",_.bind(function(t){l=t.currentTarget.className.match(/dropdown/)?"arrow":"button",a(!0,l,t),$(document).on("mouseup",r)},this)),0<c.options.width&&$("button:first",o).css("width",c.options.width-$("[data-toggle^=dropdown]",o).outerWidth())),o.on("hide.bs.dropdown",_.bind(a,c,!1,"arrow")),o.on("show.bs.dropdown",_.bind(a,c,!0,"arrow")),o.on("hidden.bs.dropdown",_.bind(function(t,e){c.cmpEl.find(".dropdown-toggle").blur(),c.cmpEl.hasClass("active")!==c.pressed&&c.cmpEl.trigger("button.internal.active",[c.pressed])},c)),$("button:first",o)):o).on("click",t),o.on("button.internal.active",_.bind(function(t,e){n?a(e,"button",t):(o.toggleClass("active",e),$("button",o).toggleClass("active",e))},c)),o.on("mouseover",function(t){c.disabled||(c.cmpEl.addClass("over"),c.trigger("mouseover",c,t))}),o.on("mouseout",function(t){c.cmpEl.removeClass("over"),c.disabled||c.trigger("mouseout",c,t)}),Common.UI.ToggleManager.register(c),!1!==c.options.scaling&&(o.attr("ratio","ratio"),c.applyScaling(Common.UI.Scaling.currentRatio()),o.on("app:scaling",function(t,e){c.options.scaling!=e.ratio&&c.applyScaling(e.ratio)}))),c.rendered=!0,c.pressed&&c.toggle(c.pressed,!0),c.disabled&&c.setDisabled(!(c.disabled=!1)),c.visible||c.setVisible(c.visible),c.trigger("render:after",c),this},doToggle:function(){!this.enableToggle||!1===this.allowDepress&&this.pressed||this.toggle()},toggle:function(t,e){t=void 0===t?!this.pressed:!!t;this.pressed=t,this.cmpEl&&this.cmpEl.trigger("button.internal.active",[t]),e||this.trigger("toggle",this,t)},click:function(t){this.disabled||(this.doToggle(),this.trigger("click",this,t))},isActive:function(){return this.enableToggle?this.pressed:this.cmpEl.hasClass("active")},setDisabled:function(e){var t,i,s,o;this.rendered&&this.disabled!=e&&(o=(t=this.cmpEl).hasClass("btn-group"),i=this,(e=!0===e)!==t.hasClass("disabled")&&((s=function(t){t.toggleClass("disabled",e),i.options.allowMouseEventsOnDisabled||(e?t.attr({disabled:e}):t.removeAttr("disabled"))})(t),o&&s(t.children("button"))),!e&&Common.Utils.isGecko||!this.options.hint||((o=this.btnEl.data("bs.tooltip"))&&(e&&o.hide(),Common.Utils.isGecko||(o.enabled=!e)),this.btnMenuEl&&(o=this.btnMenuEl.data("bs.tooltip"))&&(e&&o.hide(),Common.Utils.isGecko||(o.enabled=!e))),e&&this.menu&&_.isObject(this.menu)&&this.menu.rendered&&this.menu.isVisible()&&setTimeout(function(){i.menu.hide()},1),!i.options.signals||i.options.signals.indexOf("disabled")<0||i.trigger("disabled",i,e)),this.disabled=e},isDisabled:function(){return this.disabled},setIconCls:function(t){var e,i=$(this.el).find(".icon"),s=this.iconCls,o=i.find("use.zoom-int");this.iconCls=t,/svgicon/.test(this.iconCls)?(e=/svgicon\s(\S+)/.exec(this.iconCls),o.attr("xlink:href",e&&1<e.length?"#"+e[1]:"")):o.length?(e=/btn-[^\s]+/.exec(this.iconCls),o.attr("href",e?"#"+e[0]:"")):(i.removeClass(s),i.addClass(t||""),!1===this.options.scaling&&i.addClass("scaling-off"))},changeIcon:function(t){var e,i=$(this.el).find(".icon");t&&(t.curr||t.next)&&i&&(e=i.find("use.zoom-int"),t.curr&&i.removeClass(t.curr),t.next&&!i.hasClass(t.next)&&i.addClass(t.next),e.length&&t.next&&e.attr("href","#"+t.next),!this.options.signals||this.options.signals.indexOf("icon:changed")<0||this.trigger("icon:changed",this,t))},hasIcon:function(t){return this.$icon.hasClass(t)},setVisible:function(t){this.cmpEl&&this.cmpEl.toggleClass("hidden",!t),this.visible=t},isVisible:function(){return(this.cmpEl||$(this.el)).is(":visible")},updateHint:function(t,e){var i,s,o;this.options.hint=t,this.rendered&&(s=(i=this.cmpEl).closest(".asc-window"),this.btnEl||("object"==typeof this.options.hint&&1<this.options.hint.length&&0<$("button",i).length?(o=$("button",i),this.btnEl=$(o[0]),this.btnMenuEl=$(o[1])):(this.btnEl=i,this.btnEl.attr("data-toggle","tooltip"))),this.btnEl.data("bs.tooltip")&&this.btnEl.removeData("bs.tooltip"),this.btnMenuEl&&this.btnMenuEl.data("bs.tooltip")&&this.btnMenuEl.removeData("bs.tooltip"),this.btnEl.tooltip({html:!!e,title:"string"==typeof t?t:t[0],placement:this.options.hintAnchor||"cursor"}),this.btnMenuEl&&this.btnMenuEl.tooltip({html:!!e,title:t[1],placement:this.options.hintAnchor||"cursor"}),0<s.length&&(this.btnEl.data("bs.tooltip").tip().css("z-index",parseInt(s.css("z-index"))+10),this.btnMenuEl&&this.btnMenuEl.data("bs.tooltip").tip().css("z-index",parseInt(s.css("z-index"))+10)),!this.disabled&&Common.Utils.isGecko||((o=this.btnEl.data("bs.tooltip"))&&(this.disabled&&o.hide(),Common.Utils.isGecko||(o.enabled=!this.disabled)),this.btnMenuEl&&(o=this.btnMenuEl.data("bs.tooltip"))&&(this.disabled&&o.hide(),Common.Utils.isGecko||(o.enabled=!this.disabled))))},setCaption:function(t){var e;this.caption!=t&&(/icon-top/.test(this.cls)&&this.caption&&/huge/.test(this.cls)?(e=this.getCaptionWithBreaks(t),this.caption=e||t):this.caption=t,this.rendered&&(0<(e=this.cmpEl.find(".caption")).length?e:this.cmpEl.find("button:first").addBack().filter("button")).html(this.caption))},setMenu:function(t){t&&_.isObject(t)&&_.isFunction(t.render)&&(this.menu=t,this.rendered&&this.menu.render(this.cmpEl))},applyScaling:function(t){this.options.scaling!=t&&(2<(this.options.scaling=t)?this.$el.find("svg.icon").length||(t=this.iconCls||this.$el.find("i.icon").attr("class"),t=(t=/btn-[^\s]+/.exec(t))?t[0]:"null",t='<svg class="icon"><use class="zoom-int" href="#%iconname"></use></svg>'.replace("%iconname",t),this.$el.find("i.icon").after(t)):this.$el.find("i.icon")||(t='<i class="icon %cls">&nbsp;</i>'.replace("%cls",this.iconCls),this.$el.find("svg.icon").after(t)))},focus:function(){this.$el&&this.$el.find("button").addBack().filter("button").focus()}})}),define("common/main/lib/view/SearchBar",["common/main/lib/component/Window","common/main/lib/component/Button"],function(){"use strict";Common.UI.SearchBar=Common.UI.Window.extend(_.extend({options:{modal:!1,width:328,height:54,header:!1,cls:"search-bar",alias:"SearchBar",showOpenPanel:!0,toolclose:"hide",automove:!1},initialize:function(t){_.extend(this.options,t||{}),this.template=['<div class="box">','<div class="search-input-group">','<input type="text" id="search-bar-text" class="input-field form-control" maxlength="255" placeholder="'+this.textFind+'" autocomplete="off">','<div id="search-bar-results">0/0</div>',"</div>",'<div class="tools">','<div id="search-bar-back"></div>','<div id="search-bar-next"></div>',this.options.showOpenPanel?'<div id="search-bar-open-panel"></div>':"",'<div id="search-bar-close"></div>',"</div>","</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),this.iconType=this.options.iconType,Common.UI.Window.prototype.initialize.call(this,this.options),Common.NotificationCenter.on("layout:changed",_.bind(this.onLayoutChanged,this)),$(window).on("resize",_.bind(this.onLayoutChanged,this))},render:function(){Common.UI.Window.prototype.render.call(this),this.inputSearch=this.$window.find("#search-bar-text"),this.inputSearch.on("input",_.bind(function(){this.disableNavButtons(),this.fireEvent("search:input",[this.inputSearch.val()])},this)).on("keydown",_.bind(function(t){this.fireEvent("search:keydown",[this.inputSearch.val(),t])},this));var t="svg"===this.iconType;return this.btnBack=new Common.UI.Button({parentEl:$("#search-bar-back"),cls:"btn-toolbar",iconCls:t?"svg-icon search-arrow-up":"toolbar__icon btn-arrow-up",hint:this.tipPreviousResult,scaling:!t}),this.btnBack.on("click",_.bind(this.onBtnNextClick,this,"back")),this.btnNext=new Common.UI.Button({parentEl:$("#search-bar-next"),cls:"btn-toolbar",iconCls:t?"svg-icon search-arrow-down":"toolbar__icon btn-arrow-down",hint:this.tipNextResult,scaling:!t}),this.btnNext.on("click",_.bind(this.onBtnNextClick,this,"next")),this.options.showOpenPanel&&(this.btnOpenPanel=new Common.UI.Button({parentEl:$("#search-bar-open-panel"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-more-vertical",hint:this.tipOpenAdvancedSettings}),this.btnOpenPanel.on("click",_.bind(this.onOpenPanel,this))),this.btnClose=new Common.UI.Button({parentEl:$("#search-bar-close"),cls:"btn-toolbar",iconCls:t?"svg-icon search-close":"toolbar__icon btn-close",hint:this.tipCloseSearch,scaling:!t}),this.btnClose.on("click",_.bind(function(){this.hide()},this)),this.searchResults=$("#search-bar-results"),this.on("animate:before",_.bind(this.focus,this)),Common.NotificationCenter.on("search:updateresults",_.bind(function(t,e){this.disableNavButtons(t,e),this.updateResultsNumber(t,e)},this)),this},show:function(t){var e=(0<$("#app-title").length?$("#app-title").height():0)+$("#toolbar").height()+2,i=Common.UI.isRTL()?($("#right-menu").is(":visible")?$("#right-menu").width():0)+32:Common.Utils.innerWidth()-($("#right-menu").is(":visible")?$("#right-menu").width():0)-this.options.width-32;Common.UI.Window.prototype.show.call(this,i,e),this.disableNavButtons(),t?(this.inputSearch.val(t),this.fireEvent("search:input",[t])):(this.inputSearch.val(""),window.SSE&&this.fireEvent("search:input",["",!0])),this.focus()},focus:function(){var t=this;setTimeout(function(){t.inputSearch.focus(),t.inputSearch.select()},10)},setText:function(t){this.inputSearch.val(t),this.fireEvent("search:input",[t])},getSettings:function(){return{}},onLayoutChanged:function(){var t=$("#app-title").height()+$("#toolbar").height()+2,e=Common.UI.isRTL()?($("#right-menu").is(":visible")?$("#right-menu").width():0)+32:Common.Utils.innerWidth()-($("#right-menu").is(":visible")?$("#right-menu").width():0)-this.options.width-32;this.$window.css({left:e,top:t})},onBtnNextClick:function(t){this.fireEvent("search:"+t,[this.inputSearch.val(),!1])},onOpenPanel:function(){this.hide(),this.fireEvent("search:show",[!0,this.inputSearch.val()])},disableNavButtons:function(t,e){e=""===this.inputSearch.val()&&!window.SSE||!e;this.btnBack.setDisabled(e),this.btnNext.setDisabled(e)},updateResultsNumber:function(t,e){this.searchResults.text(!e||""===this.inputSearch.val()&&!window.SSE?"0/0":Common.UI.isRTL()?e+"/"+(t+1):t+1+"/"+e),this.inputSearch.css(Common.UI.isRTL()?"padding-left":"padding-right",this.searchResults.outerWidth()+"px")}},Common.UI.SearchBar||{}))}),define("text!spreadsheeteditor/main/app/template/Viewport.template",[],function(){return'<div class="layout-region">\n    <div id="viewport-vbox-layout" class="layout-ct vbox">\n        <section class="layout-ct">\n            <div id="file-menu-panel" class="toolbar-fullview-panel hint-section" style="display:none;"></div>\n        </section>\n        <section id="app-title" class="layout-item"></section>\n        <div id="toolbar" class="layout-item hint-section" data-layout-name="toolbar"></div>\n        <div class="layout-item">\n            <div id="viewport-hbox-layout" class="layout-ct hbox">\n                <div id="left-menu" class="layout-item hint-section" data-layout-name="leftMenu" style="width: 40px;"></div>\n                <div id="about-menu-panel" class="left-menu-full-ct" style="display:none;"></div>\n                <div class="layout-item">\n                    <div class="layout-ct vbox">\n                        <div id="cell-editing-box" class="layout-item" style="height:18px;"></div>\n                        <div id="editor_sdk" class="layout-item" style="min-height: 100px;"></div>\n                    </div>\n                </div>\n                <div id="right-menu" class="layout-item hint-section" data-layout-name="rightMenu"></div>\n                <div id="left-panel-history" class="layout-item hint-section"></div>\n            </div>\n        </div>\n        <div id="statusbar" class="layout-item" data-layout-name="statusBar"></div>\n    </div>\n</div>\n'}),void 0===Common&&(Common={}),define("common/main/lib/component/Layout",["backbone"],function(){"use strict";function e(t){this.box=null,this.panels=[],this.splitters=[],_.extend(this,t||{})}function o(){return{width:null,height:null,resize:!1,stretch:!1,rely:!1}}_.extend(e.prototype,Backbone.Events,{initialize:function(t){this.$parent=this.box.parent();this.resize={eventMove:_.bind(this.resizeMove,this),eventStop:_.bind(this.resizeStop,this)};this.freeze=t.freeze,this.changeLayout(t.items)},doLayout:function(){},changeLayout:function(t){var e,i,s=!1;this.splitters&&this.splitters.forEach(function(t){t.resizer&&t.resizer.el.remove()},this),this.splitters=[],this.panels=[],t.forEach(function(t){t.el instanceof HTMLElement&&(t.el=$(t.el)),(e=_.extend(new o,t)).stretch&&(s=!0,e.rely=!1,e.resize=!1),this.panels.push(e),e.resize&&(i={isresizer:!0,minpos:e.resize.min||0,maxpos:e.resize.max||0,fmin:e.resize.fmin,fmax:e.resize.fmax,behaviour:e.behaviour,index:this.splitters.length,offset:e.resize.offset||0,multiply:e.resize.multiply},s?(e.resize.el=i.el=e.el.before('<div class="layout-resizer before"></div>').prev(),this.panels.splice(this.panels.length-1,0,i)):(e.resize.el=i.el=e.el.after('<div class="layout-resizer after"></div>').next(),this.panels.push(i)),this.splitters.push({resizer:i}),e.resize.hidden&&i.el.hide(),Common.Gateway.on("processmouse",this.resize.eventStop))},this),this.freezePanels(this.freeze)},getElementHeight:function(t){return parseInt(t.css("height"))},getElementWidth:function(t){return parseInt(t.css("width"))},getItem:function(t){for(var e in this.panels){e=this.panels[e];if(e.alias==t)return e}},onSelectStart:function(t){return t.preventDefault&&t.preventDefault(),!1},addHandler:function(t,e,i){t.addEventListener?t.addEventListener(e,i):t.attachEvent?t.attachEvent("on"+e,i):t["on"+e]=i},removeHandler:function(t,e,i){t.removeEventListener?t.removeEventListener(e,i):t.detachEvent?t.detachEvent("on"+e,i):t["on"+e]=null},clearSelection:function(){var t;window.getSelection?(t=window.getSelection()).empty?t.empty():t.removeAllRanges&&t.removeAllRanges():document.selection&&document.selection.empty()},resizeStart:function(t){var e;this.freeze||(this.clearSelection(),this.addHandler(window.document,"selectstart",this.onSelectStart),$(document).on({mousemove:this.resize.eventMove,mouseup:this.resize.eventStop}),Common.NotificationCenter.on({"frame:mousemove":this.resize.eventMove,"frame:mouseup":this.resize.eventStop}),e=t.data.panel,this.resize.type=t.data.type,this.resize.$el=e.el,this.resize.min=0<e.minpos?e.minpos:this.resize.$el.parent().width()+e.minpos,this.resize.fmin=e.fmin,this.resize.fmax=e.fmax,this.resize.behaviour=e.behaviour,this.resize.multiply=e.multiply,this.resize.$el.addClass("move"),"vertical"==t.data.type?(this.resize.height=parseInt(this.resize.$el.css("height")),this.resize.max=(0<e.maxpos?e.maxpos:this.resize.$el.parent().height()+e.maxpos)-this.resize.height,this.resize.inity=t.pageY*Common.Utils.zoom()-parseInt(t.currentTarget.style.top)):"horizontal"==t.data.type&&(this.resize.width=parseInt(this.resize.$el.css("width")),this.resize.max=(0<e.maxpos?e.maxpos:this.resize.$el.parent().width()+e.maxpos)-this.resize.width,this.resize.initx=t.pageX*Common.Utils.zoom()-parseInt(t.currentTarget.style.left)),this.resize.multiply&&this.resize.multiply.koeff&&(this.resize.max=Math.floor(this.resize.max/this.resize.multiply.koeff)*this.resize.multiply.koeff+(this.resize.multiply.offset||0)),Common.NotificationCenter.trigger("layout:resizestart"))},resizeMove:function(t){var e,i,s,o=t instanceof jQuery.Event?Common.Utils.zoom():1;"vertical"==this.resize.type?(e="top",s=t.pageY*o-this.resize.inity):"horizontal"==this.resize.type&&(e="left",s=t.pageX*o-this.resize.initx),this.resize.multiply&&this.resize.multiply.koeff&&(o=s/(t=this.resize.multiply.koeff),i=Math.floor(o)*t+(this.resize.multiply.offset||0),o=Math.ceil(o)*t+(this.resize.multiply.offset||0),s=i+t/2<s?o:i),this.resize.fmin&&this.resize.fmax?s<this.resize.fmin()||s>this.resize.fmax()||(this.resize.$el[0].style[e]=s+"px"):s<this.resize.min||s>this.resize.max||(this.resize.$el[0].style[e]=s+"px")},resizeStop:function(t){var e,i,s,o;this.removeHandler(window.document,"selectstart",this.onSelectStart),$(document).off({mousemove:this.resize.eventMove,mouseup:this.resize.eventStop}),Common.NotificationCenter.off({"frame:mousemove":this.resize.eventMove,"frame:mouseup":this.resize.eventStop}),this.resize.$el&&(s=t instanceof jQuery.Event?Common.Utils.zoom():1,t instanceof jQuery.Event||void 0!==t.pageY&&void 0!==t.pageX||(t.pageY=t.y,t.pageX=t.x),"vertical"==this.resize.type?(e="height",i=t.pageY*s-this.resize.inity):"horizontal"==this.resize.type&&(e="width",i=t.pageX*s-this.resize.initx),this.resize.multiply&&this.resize.multiply.koeff&&(s=i/(t=this.resize.multiply.koeff),o=Math.floor(s)*t+(this.resize.multiply.offset||0),s=Math.ceil(s)*t+(this.resize.multiply.offset||0),i=o+t/2<i?s:o),this.resize.fmin&&this.resize.fmax?(i=i<this.resize.fmin()?this.resize.fmin():i)>this.resize.fmax()&&(i=this.resize.fmax()):(i=i<this.resize.min?this.resize.min:i)>this.resize.max&&(i=this.resize.max),s=t=null,o=0,this.resize.$el.hasClass("after")?(t=this.resize.$el.prev(),s=this.resize.$el.next(),o=parseInt(t.css(e))):(t=this.resize.$el.next(),s=this.resize.$el.prev(),o=parseInt(t.css(e)),i=t.parent()[e]()-(i+this.resize[e])),"vertical"==this.resize.type&&(i-=t.position().top),t.css(e,i+"px"),this.resize.behaviour&&s.css(e,parseInt(s.css(e))-(i-o)),this.resize.$el.removeClass("move"),delete this.resize.$el,this.resize.value!=i&&(this.doLayout(),this.trigger("layout:resizedrag",this)),Common.NotificationCenter.trigger("layout:resizestop"))},freezePanels:function(e){this.panels.forEach(function(t){!t.stretch&&t.resize&&$(t.resize.el).css("cursor",e?"default":"")}),this.freeze=e},setResizeValue:function(t,e){var i,s,o,n;return t>=this.splitters.length?(this.doLayout(),!1):(s=i=null,o=0,n="height",(e=e<(t=this.splitters[t].resizer).fmin()?t.fmin():e)>t.fmax()&&(e=t.fmax()),o=(s=(t.el.hasClass("after")?i=t.el.prev():e=(i=t.el.next()).parent()[n]()-(e+t[n]),t.el.next()),parseInt(i.css(n))),e-=i.position().top,i.css(n,e+"px"),t.behaviour&&s.css(n,parseInt(s.css(n))-(e-o)),t.value!=e&&this.doLayout(),.99<Math.abs(o-e))}}),Common.UI||(Common.UI={}),Common.UI.VBoxLayout=function(t){e.apply(this,arguments),this.initialize.apply(this,arguments)},Common.UI.VBoxLayout.prototype=_.extend(new e,{initialize:function(t){e.prototype.initialize.call(this,t)},doLayout:function(){var e,i,s=0;this.panels.forEach(function(t){t.stretch?e=t:((i=t.el.is(":visible"))&&(s+=!0!==t.rely?t.height:this.getElementHeight(t.el)),t.resize&&!1!==t.resize.autohide&&t.resize.el&&(i?(t.resize.el.show(),e&&(s+=t.resize.height)):(t.resize.el.hide(),e&&(s-=t.resize.height))))},this),e&&(e.height=this.$parent.height()-s),s=0,this.panels.forEach(function(t){t.el.is(":visible")&&(i={top:s},!0!==t.rely&&(i.height=t.height),t.el.css(i),s+=i.height||this.getElementHeight(t.el))},this)},changeLayout:function(t){e.prototype.changeLayout.call(this,t),this.panels.forEach(function(t){t.stretch||t.height||(t.height=this.getElementHeight(t.el)),t.isresizer&&t.el.on("mousedown",{type:"vertical",panel:t},_.bind(this.resizeStart,this))},this),this.doLayout.call(this)}}),Common.UI.HBoxLayout=function(t){e.apply(this,arguments),this.initialize.apply(this,arguments)},Common.UI.HBoxLayout.prototype=_.extend(new e,{initialize:function(t){e.prototype.initialize.call(this,t)},doLayout:function(t){var e,i,s=0;this.panels.forEach(function(t){t.stretch?e=t:((i=t.el.is(":visible"))&&(t.isresizer?s+=t.offset:s+=!0!==t.rely?t.width:this.getElementWidth(t.el)),t.resize&&!1!==t.resize.autohide&&t.resize.el&&(i?t.resize.el.show():t.resize.el.hide(),e&&(s-=t.resize.width)))},this),e&&(e.width=this.$parent.width()-s),s=0,this.panels.forEach(function(t){t.el.is(":visible")&&(i={left:s-(t.isresizer?t.width:0)},!0!==t.rely&&(i.width=t.width),t.el.css(i),t.isresizer?s+=t.offset:s+=this.getElementWidth(t.el))},this)},changeLayout:function(t){e.prototype.changeLayout.call(this,t),this.panels.forEach(function(t){t.stretch||t.width||(t.width=this.getElementWidth(t.el)),t.isresizer&&t.el.on("mousedown",{type:"horizontal",panel:t},_.bind(this.resizeStart,this))},this),this.doLayout.call(this)}}),Common.UI.VBoxLayout.prototype.constructor=Common.UI.VBoxLayout,Common.UI.HBoxLayout.prototype.constructor=Common.UI.HBoxLayout}),define("spreadsheeteditor/main/app/view/Viewport",["text!spreadsheeteditor/main/app/template/Viewport.template","jquery","underscore","backbone","common/main/lib/component/BaseView","common/main/lib/component/Layout"],function(t,s,i,e){"use strict";SSE.Views.Viewport=e.View.extend({el:"#viewport",template:i.template(t),events:{},initialize:function(){},render:function(){var t=s(this.el),e=(t.html(this.template({})),Common.Utils.isSafari?(s("body").addClass("safari"),s("body").mousewheel(function(t){t.preventDefault(),t.stopPropagation()})):Common.Utils.isChrome&&s("body").addClass("chrome"),s("#viewport-vbox-layout",t)),i=e.find(" > .layout-item"),t=(this.vlayout=new Common.UI.VBoxLayout({box:e,items:[{el:e.find("> .layout-item#app-title").hide(),alias:"title",height:Common.Utils.InternalSettings.get("document-title-height")},{el:i[1],alias:"toolbar",height:Common.localStorage.getBool("sse-compact-toolbar")?Common.Utils.InternalSettings.get("toolbar-height-compact"):Common.Utils.InternalSettings.get("toolbar-height-normal")},{el:i[2],stretch:!0},{el:i[3],alias:"statusbar",height:Common.localStorage.getBool("sse-compact-statusbar",!0)?25:50}]}),[{el:(i=(e=s("#viewport-hbox-layout",t)).find(" > .layout-item"))[0],rely:!0,alias:"left",resize:{hidden:!0,autohide:!1,min:300,max:600,offset:4}},{el:i[3],rely:!0,alias:"history",resize:{hidden:!0,autohide:!1,min:300,max:600}},{el:i[1],stretch:!0},{el:s(i[2]).hide(),rely:!0}]);return Common.UI.isRTL()&&([t[0].resize.min,t[0].resize.max]=[-600,-300],[t[1].resize.min,t[1].resize.max]=[-600,-300],[t[0],t[3]]=[t[3],t[0]],[t[1],t[2]]=[t[2],t[1]]),this.hlayout=new Common.UI.HBoxLayout({box:e,items:t}),i=(e=e.find(".layout-ct.vbox")).find(" > .layout-item"),this.celayout=new Common.UI.VBoxLayout({box:e,items:[{el:i[0],rely:!0,resize:{min:19,max:-100,multiply:{koeff:18,offset:2}}},{el:i[1],stretch:!0}]}),this},applyEditorMode:function(){var t=SSE.getController("RightMenu").getView("RightMenu"),t=(this._rightMenu=t.render(this.mode),Common.UI.LayoutManager.getInitValue("rightMenu"));Common.localStorage.getBool("sse-hidden-rightmenu",void 0!==t&&!t)&&this._rightMenu.hide()},applyCommonMode:function(){var t=Common.UI.LayoutManager.getInitValue("leftMenu");Common.localStorage.getBool("sse-hidden-leftmenu",void 0!==t&&!t)&&SSE.getController("LeftMenu").getView("LeftMenu").hide()},setMode:function(t,e){t.isDisconnected?(i.isUndefined(this.mode)&&(this.mode={}),this.mode.canCoAuthoring=!1):(this.mode=t,this.vlayout&&t.isDesktopApp&&!t.isEdit&&this.vlayout.items[1].el.css("display","block"))}})}),define("spreadsheeteditor/main/app/controller/Viewport",["core","common/main/lib/view/Header","common/main/lib/view/SearchBar","spreadsheeteditor/main/app/view/Viewport"],function(t){"use strict";SSE.Controllers.Viewport=Backbone.Controller.extend(_.assign({models:[],collections:[],views:["Viewport","Common.Views.Header"],initialize:function(){var i=this;this.addListeners({FileMenu:{"menu:hide":i.onFileMenu.bind(i,"hide"),"menu:show":i.onFileMenu.bind(i,"show"),"settings:apply":i.applySettings.bind(i)},Statusbar:{"view:compact":function(t,e){i.viewport.vlayout.getItem("statusbar").height=e?25:50}},Toolbar:{"render:before":function(t){var e=SSE.getController("Main").appOptions,e=(e.isEditDiagram||e.isEditMailMerge||e.isEditOle||t.setExtra("right",i.header.getPanel("right",e)),(!e.isEdit||e.customization&&e.customization.compactHeader)&&t.setExtra("left",i.header.getPanel("left",e)),!i.appConfig||!i.appConfig.isEdit||e.customization&&e.customization.compactHeader||!t.btnCollabChanges||(t.btnCollabChanges=i.header.btnSave),Common.localStorage.getBool("sse-settings-quick-print-button",!0));Common.Utils.InternalSettings.set("sse-settings-quick-print-button",e),i.header&&i.header.btnPrintQuick&&i.header.btnPrintQuick[e?"show":"hide"]()},"view:compact":function(t,e){i.viewport.vlayout.getItem("toolbar").height=e?Common.Utils.InternalSettings.get("toolbar-height-compact"):Common.Utils.InternalSettings.get("toolbar-height-normal")},"undo:disabled":function(t){i.header.btnUndo&&(i.header.btnUndo.keepState?i.header.btnUndo.keepState.disabled=t:i.header.btnUndo.setDisabled(t))},"redo:disabled":function(t){i.header.btnRedo&&(i.header.btnRedo.keepState?i.header.btnRedo.keepState.disabled=t:i.header.btnRedo.setDisabled(t))},"print:disabled":function(t){i.header.btnPrint&&i.header.btnPrint.setDisabled(t),i.header.btnPrintQuick&&i.header.btnPrintQuick.setDisabled(t)},"save:disabled":function(t){i.header.btnSave&&i.header.btnSave.setDisabled(t)}}}),Common.NotificationCenter.on("app:face",this.onAppShowed.bind(this)),Common.NotificationCenter.on("app:ready",this.onAppReady.bind(this))},setApi:function(t){this.api=t,this.api.asc_registerCallback("asc_onCoAuthoringDisconnect",this.onApiCoAuthoringDisconnect.bind(this)),Common.NotificationCenter.on("api:disconnect",this.onApiCoAuthoringDisconnect.bind(this))},getApi:function(){return this.api},onAppShowed:function(t){var e,i=this,s=(i.appConfig=t,Common.Utils.InternalSettings),o=$(".toolbar-fullview-panel");o.css("top",Common.UI.LayoutManager.isElementVisible("toolbar")?s.get("toolbar-height-tabs"):0),i.viewport.$el.attr("applang",i.appConfig.lang.split(/[\-_]/)[0]),!t.isEdit||!Common.localStorage.itemExists("sse-compact-toolbar")&&t.customization&&t.customization.compactToolbar?i.viewport.vlayout.getItem("toolbar").height=s.get("toolbar-height-compact"):(t.isEditDiagram||t.isEditMailMerge||t.isEditOle)&&(i.viewport.vlayout.getItem("toolbar").height=41),!t.isEdit||t.isEditDiagram||t.isEditMailMerge||t.isEditOle||t.customization&&t.customization.compactHeader||((e=i.viewport.vlayout.getItem("title").el).html(i.header.getPanel("title",t)).show(),e.find(".extra").html(i.header.getPanel("left",t)),(e=i.viewport.vlayout.getItem("toolbar")).el.addClass("top-title"),e.height-=s.get("toolbar-height-tabs")-s.get("toolbar-height-tabs-top-title"),e=s.get("toolbar-height-tabs-top-title"),s.set("toolbar-height-tabs",e),s.set("toolbar-height-compact",e),s.set("toolbar-height-normal",e+s.get("toolbar-height-controls")),o.css("top",(Common.UI.LayoutManager.isElementVisible("toolbar")?e:0)+s.get("document-title-height"))),t.customization&&(t.customization.toolbarNoTabs&&i.viewport.vlayout.getItem("toolbar").el.addClass("style-off-tabs"),t.customization.toolbarHideFileName&&i.viewport.vlayout.getItem("toolbar").el.addClass("style-skip-docname")),i.header.btnSearch.on("toggle",i.onSearchToggle.bind(this))},onAppReady:function(t){},onLaunch:function(){log.debug("Viewport","onLaunch"),this.viewport=this.createView("Viewport").render(),this.getApplication().getController("CellEditor").createView("CellEditor",{el:"#cell-editing-box"}).render(),this.api=new Asc.spreadsheet_api({"id-view":"editor_sdk","id-input":"ce-cell-content",translate:this.getApplication().getController("Main").translationTable}),this.header=this.createView("Common.Views.Header",{headerCaption:"Spreadsheet Editor",storeUsers:SSE.getCollection("Common.Collections.Users")}),Common.NotificationCenter.on("layout:changed",_.bind(this.onLayoutChanged,this)),$(window).on("resize",_.bind(this.onWindowResize,this)),this.viewport.celayout.on("layout:resizedrag",function(){this.viewport.fireEvent("layout:resizedrag",[this,"cell:edit"]),this.api.asc_Resize()},this);var t=$("#left-menu"),e=$("#left-panel-history");this.viewport.hlayout.on("layout:resizedrag",function(){this.api.asc_Resize(),Common.localStorage.setItem("sse-mainmenu-width",e.is(":visible")?e.width()+SCALE_MIN:t.width())},this),this.boxSdk=$("#editor_sdk"),this.boxFormula=$("#cell-editing-box"),this.boxSdk.css("border-left","none"),this.boxFormula.css("border-left","none"),Common.NotificationCenter.on("search:show",_.bind(this.onSearchShow,this))},onLayoutChanged:function(t){switch(t){default:this.viewport.vlayout.doLayout(),this.viewport.celayout.doLayout();case"rightmenu":this.viewport.hlayout.doLayout();break;case"history":(e=this.viewport.hlayout.getItem("history")).resize.el&&(this.boxSdk.css("border-left",""),e.resize.el.show()),this.viewport.hlayout.doLayout();break;case"leftmenu":var e;(e=this.viewport.hlayout.getItem("left")).resize.el&&(40<e.el.width()?(this.boxSdk.css("border-left",""),this.boxFormula.css("border-left",""),e.resize.el.show()):(e.resize.el.hide(),this.boxSdk.css("border-left","none"),this.boxFormula.css("border-left","none"))),this.viewport.hlayout.doLayout();break;case"header":case"toolbar":case"status":this.viewport.vlayout.doLayout(),this.viewport.celayout.doLayout();break;case"celleditor":arguments[1]&&this.boxSdk.css("border-top","hidden"==arguments[1]?"none":""),this.viewport.celayout.doLayout()}this.api.asc_Resize()},onWindowResize:function(t){this.onLayoutChanged("window"),Common.NotificationCenter.trigger("window:resize")},onFileMenu:function(t){t="show"==t;this.header.lockHeaderBtns("undo",t),this.header.lockHeaderBtns("redo",t)},applySettings:function(){var t=Common.localStorage.getBool("sse-settings-quick-print-button",!0);Common.Utils.InternalSettings.set("sse-settings-quick-print-button",t),this.header&&this.header.btnPrintQuick&&this.header.btnPrintQuick[t?"show":"hide"]()},onApiCoAuthoringDisconnect:function(t){this.header&&(this.header.btnDownload&&!t&&this.header.btnDownload.hide(),this.header.btnPrint&&!t&&this.header.btnPrint.hide(),this.header.btnEdit&&this.header.btnEdit.hide(),this.header.btnPrintQuick&&!t&&this.header.btnPrintQuick.hide())},SetDisabled:function(t){},onSearchShow:function(){this.header.btnSearch&&this.header.btnSearch.toggle(!0)},onSearchToggle:function(){var t,e,i=this.getApplication().getController("LeftMenu");i.isSearchPanelVisible()?(this.header.btnSearch.toggle(!1,!0),i.getView("LeftMenu").panelSearch.focus()):(this.searchBar||(i=this.appConfig.canBrandingExt&&(!Common.UI.LayoutManager.isElementVisible("leftMenu")||this.appConfig.customization&&!1===this.appConfig.customization.leftMenu),this.searchBar=new Common.UI.SearchBar(i?{showOpenPanel:!1,width:303}:{}),this.searchBar.on("hide",_.bind(function(){this.header.btnSearch.toggle(!1,!0),Common.NotificationCenter.trigger("edit:complete")},this))),this.header.btnSearch.pressed?(i=this.api.asc_GetSelectedText(),e=(t=this.getApplication().getController("Search")).getResultsNumber(),this.searchBar.show(i&&i.trim()||t.getSearchText()),this.searchBar.updateResultsNumber(e[0],e[1])):this.searchBar.hide())},isSearchBarVisible:function(){return this.searchBar&&this.searchBar.isVisible()},textHideFBar:"Hide Formula Bar",textHideHeadings:"Hide Headings",textHideGridlines:"Hide Gridlines",textFreezePanes:"Freeze Panes",textFreezePanesShadow:"Show Freezed Panes Shadow"},SSE.Controllers.Viewport))}),window.compareVersions=!0,void 0===window.Common&&(window.Common={}),void 0===Common.Utils&&(Common.Utils={});var utils=new function(){function t(t){return t.test(s)}function e(t,e){return t&&(t=e.exec(s))?parseFloat(t[1]):0}function i(){var t={},e=(window.AscCommon&&window.AscCommon.checkDeviceScale?(t=window.AscCommon.checkDeviceScale(),AscCommon.correctApplicationScale(t)):(window.matchMedia("screen and (-webkit-min-device-pixel-ratio: 1.25) and (-webkit-max-device-pixel-ratio: 1.49), screen and (min-resolution: 1.25dppx) and (max-resolution: 1.49dppx)").matches||window.matchMedia("screen and (-webkit-min-device-pixel-ratio: 1.5) and (-webkit-max-device-pixel-ratio: 1.74), screen and (min-resolution: 1.5dppx) and (max-resolution: 1.74dppx)").matches?t.devicePixelRatio=1.5:window.matchMedia("screen and (-webkit-min-device-pixel-ratio: 1.75) and (-webkit-max-device-pixel-ratio: 1.99), screen and (min-resolution: 1.75dppx) and (max-resolution: 1.99dppx)").matches?t.devicePixelRatio=1.75:window.matchMedia("screen and (-webkit-min-device-pixel-ratio: 2), screen and (min-resolution: 2dppx), screen and (min-resolution: 192dpi)").matches?t.devicePixelRatio=2:t.devicePixelRatio=1,window.matchMedia("screen and (-webkit-min-device-pixel-ratio: 2.25), screen and (min-resolution: 2.25dppx), screen and (min-resolution: 216dpi)").matches&&(t.devicePixelRatio=2.25)),$(document.body),document.body.className),i=e.replace(/pixel-ratio__[\w-]+/gi,"").trim();t.devicePixelRatio<1.25?/pixel-ratio__/.test(e)&&(document.body.className=i):t.devicePixelRatio<1.5?/pixel-ratio__1_25/.test(e)||(document.body.className=i+" pixel-ratio__1_25"):t.devicePixelRatio<1.75?/pixel-ratio__1_5/.test(e)||(document.body.className=i+" pixel-ratio__1_5"):!(t.devicePixelRatio<1.75)&&t.devicePixelRatio<2?/pixel-ratio__1_75/.test(e)||(document.body.className=i+" pixel-ratio__1_75"):!(t.devicePixelRatio<2)&&t.devicePixelRatio<2.25?/pixel-ratio__2\b/.test(e)||(document.body.className=i+" pixel-ratio__2"):/pixel-ratio__2_5/.test(e)||(document.body.className=i+" pixel-ratio__2_5"),R.zoom=t.correct?t.zoom:1,R.innerWidth=window.innerWidth*R.zoom,R.innerHeight=window.innerHeight*R.zoom,R.applicationPixelRatio=t.applicationPixelRatio||t.devicePixelRatio}var s=navigator.userAgent.toLowerCase(),o="CSS1Compat"==document.compatMode,n=document.documentMode,a=(t(/edge/),t(/opera/)),l=a&&t(/version\/10\.5/),r=!a&&(t(/msie/)||t(/trident/)||t(/edge/)),c=r&&(t(/msie 7/)&&8!=n&&9!=n&&10!=n||7==n),d=r&&(t(/msie 8/)&&7!=n&&9!=n&&10!=n||8==n),h=r&&(t(/msie 9/)&&7!=n&&8!=n&&10!=n||9==n),p=r&&(t(/msie 10/)&&7!=n&&8!=n&&9!=n||10==n),n=r&&(t(/trident\/7\.0/)&&7!=n&&8!=n&&9!=n&&10!=n||11==n),m=r&&t(/msie 6/),u=!r&&t(/\bchrome\b/),g=!r&&t(/webkit/),b=!r&&!u&&t(/safari/),C=b&&t(/applewebkit\/4/),f=b&&t(/version\/3/),S=b&&t(/version\/4/),v=b&&t(/version\/5\.0/),w=b&&t(/version\/5/),_=!g&&!r&&t(/gecko/),x=_&&t(/rv:1\.9/),y=_&&t(/rv:2\.0/),A=_&&t(/rv:5\./),T=_&&t(/rv:10\./),k=x&&t(/rv:1\.9\.0/),E=x&&t(/rv:1\.9\.1/),I=x&&t(/rv:1\.9\.2/),D=t(/windows|win32/),V=t(/macintosh|mac os x/),P=t(/linux/),F=e(!0,/\bchrome\/(\d+\.\d+)/),M=e(!0,/\bfirefox\/(\d+\.\d+)/),U=e(r,/msie (\d+\.\d+)/),L=e(a,/version\/(\d+\.\d+)/),B=e(b,/version\/(\d+\.\d+)/),H=e(g,/webkit\/(\d+\.\d+)/),O=/^https/i.test(window.location.protocol),R=(/android|avantgo|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od|ad)|iris|kindle|lge |maemo|midp|mmp|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(navigator.userAgent||navigator.vendor||window.opera),this);return checkSizeIE=function(){R.innerWidth=window.innerWidth,R.innerHeight=window.innerHeight},R.zoom=1,R.applicationPixelRatio=1,R.innerWidth=window.innerWidth,R.innerHeight=window.innerHeight,r?($(document.body).addClass("ie"),$(window).on("resize",checkSizeIE)):(i(),$(window).on("resize",i)),{checkSize:i,userAgent:s,isStrict:o,isIEQuirks:r&&!o&&(m||c||d||h),isOpera:a,isOpera10_5:l,isWebKit:g,isChrome:u,isSafari:b,isSafari3:f,isSafari4:S,isSafari5:w,isSafari5_0:v,isSafari2:C,isIE:r,isIE6:m,isIE7:c,isIE7m:m||c,isIE7p:r&&!m,isIE8:d,isIE8m:m||c||d,isIE8p:r&&!(m||c),isIE9:h,isIE9m:m||c||d||h,isIE9p:r&&!(m||c||d),isIE10:p,isIE10m:m||c||d||h||p,isIE10p:r&&!(m||c||d||h),isIE11:n,isIE11m:m||c||d||h||p||n,isIE11p:r&&!(m||c||d||h||p),isGecko:_,isGecko3:x,isGecko4:y,isGecko5:A,isGecko10:T,isFF3_0:k,isFF3_5:E,isFF3_6:I,isFF4:4<=M&&M<5,isFF5:5<=M&&M<6,isFF10:10<=M&&M<11,isLinux:P,isWindows:D,isMac:V,chromeVersion:F,firefoxVersion:M,ieVersion:U,operaVersion:L,safariVersion:B,webKitVersion:H,isSecure:O,emailRe:/^(mailto:)?([a-z0-9'\._-]+@[a-z0-9\.-]+\.[a-z0-9]{2,4})([a-яё0-9\._%+-=\? :&]*)/i,ipRe:/^(((https?)|(ftps?)):\/\/)?([\-\wа-яё]*:?[\-\wа-яё]*@)?(((1[0-9]{2}|2[0-4][0-9]|25[0-5]|[1-9][0-9]|[0-9])\.){3}(1[0-9]{2}|2[0-4][0-9]|25[0-5]|[1-9][0-9]|[0-9]))(:\d+)?(\/[%\-\wа-яё]*(\.[\wа-яё]{2,})?(([\wа-яё\-\.\?\\\/+@&#;:`~=%!,\(\)]*)(\.[\wа-яё]{2,})?)*)*\/?/i,hostnameRe:/^(((https?)|(ftps?)):\/\/)?([\-\wа-яё]*:?[\-\wа-яё]*@)?(([\-\wа-яё]+\.)+[\wа-яё\-]{2,}(:\d+)?(\/[%\-\wа-яё]*(\.[\wа-яё]{2,})?(([\wа-яё\-\.\?\\\/\+@&#;:`'~=%!,\(\)]*)(\.[\wа-яё]{2,})?)*)*\/?)/i,localRe:/^(((https?)|(ftps?)):\/\/)([\-\wа-яё]*:?[\-\wа-яё]*@)?(([\-\wа-яё]+)(:\d+)?(\/[%\-\wа-яё]*(\.[\wа-яё]{2,})?(([\wа-яё\-\.\?\\\/\+@&#;:`'~=%!,\(\)]*)(\.[\wа-яё]{2,})?)*)*\/?)/i,emailStrongRe:/(mailto:)?([a-z0-9'\._-]+@[a-z0-9\.-]+\.[a-z0-9]{2,4})([a-яё0-9\._%+-=\?:&]*)/gi,emailAddStrongRe:/(mailto:|\s[@]|\s[+])?([a-z0-9'\._-]+@[a-z0-9\.-]+\.[a-z0-9]{2,4})([a-яё0-9\._%\+-=\?:&]*)/gi,ipStrongRe:/(((https?)|(ftps?)):\/\/([\-\wа-яё]*:?[\-\wа-яё]*@)?)(((1[0-9]{2}|2[0-4][0-9]|25[0-5]|[1-9][0-9]|[0-9])\.){3}(1[0-9]{2}|2[0-4][0-9]|25[0-5]|[1-9][0-9]|[0-9]))(:\d+)?(\/[%\-\wа-яё]*(\.[\wа-яё]{2,})?(([\wа-яё\-\.\?\\\/\+@&#;:`~=%!,\(\)]*)(\.[\wа-яё]{2,})?)*)*\/?/gi,hostnameStrongRe:/((((https?)|(ftps?)):\/\/([\-\wа-яё]*:?[\-\wа-яё]*@)?)|(([\-\wа-яё]*:?[\-\wа-яё]*@)?www\.))((([\-\wа-яё]+\.)+[\wа-яё\-]{2,}|([\-\wа-яё]+))(:\d+)?(\/[%\-\wа-яё]*(\.[\wа-яё]{2,})?(([\wа-яё\-\.\?\\\/\+@&#;:`~=%!,\(\)]*)(\.[\wа-яё]{2,})?)*)*\/?)/gi,documentSettingsType:{Paragraph:0,Table:1,Header:2,TextArt:3,Shape:4,Image:5,Slide:6,Chart:7,MailMerge:8,Signature:9,Pivot:10,Cell:11,Slicer:12,Form:13},importTextType:{DRM:0,CSV:1,TXT:2,Paste:3,Columns:4,Data:5},zoom:function(){return R.zoom},applicationPixelRatio:function(){return R.applicationPixelRatio},topOffset:0,innerWidth:function(){return R.innerWidth},innerHeight:function(){return R.innerHeight},croppedGeometry:function(){return{left:0,top:Common.Utils.InternalSettings.get("window-inactive-area-top"),width:R.innerWidth,height:R.innerHeight-Common.Utils.InternalSettings.get("window-inactive-area-top")}}}},themecolor=(Common.Utils=_extend_object(Common.Utils,utils),new function(){var h=!0;return{txtBlack:"Black",txtWhite:"White",txtRed:"Red",txtGreen:"Green",txtBlue:"Blue",txtYellow:"Yellow",txtPurple:"Purple",txtAqua:"Aqua",txtDarkRed:"Dark red",txtDarkGreen:"Dark green",txtDarkBlue:"Dark blue",txtDarkYellow:"Dark yellow",txtDarkPurple:"Dark purple",txtDarkTeal:"Dark teal",txtLightGray:"Light gray",txtGray:"Gray",txtLightBlue:"Light blue",txtPink:"Pink",txtLightYellow:"Light yellow",txtSkyBlue:"Sky blue",txtRose:"Rose",txtTurquosie:"Turquosie",txtLightGreen:"Light green",txtLavender:"Lavender",txtLightOrange:"Light orange",txtTeal:"Teal",txtGold:"Gold",txtOrange:"Orange",txtIndigo:"Indigo",txtBrown:"Brown",txtDarkGray:"Dark gray",txtbackground:"Background",txttext:"Text",txtaccent:"Accent",txtDarker:"Darker",txtLighter:"Lighter",txtBrightGreen:"Bright green",txtViolet:"Violet",ThemeValues:[6,15,7,16,0,1,2,3,4,5],getTranslation:function(t){return t?this["txt"+t.replace(" ","")]||t:""},getEffectTranslation:function(t){return 0!==(t=parseInt(100*t))?(0<t?this.txtLighter:this.txtDarker)+" "+Math.abs(t)+"%":""},setColors:function(t,e){if(h){for(var i=1;i<3;i++)this["txtbackground"+i]=this.txtbackground+" "+i,this["txttext"+i]=this.txttext+" "+i;for(i=1;i<7;i++)this["txtaccent"+i]=this.txtaccent+" "+i;h=!1}var s,o;if(e&&0<e.length){var n=[];for(i=0;i<e.length;i++)o={color:this.getHexColor(e[i].get_r(),e[i].get_g(),e[i].get_b()),tip:this.getTranslation(e[i].asc_getName())},n.push(o);this.standartcolors=n}var a=[];for(i=0;i<6;i++)for(s=0;s<10;s++){var l=i+6*s,r=this.getTranslation(t[l].asc_getName()),c=this.getTranslation(t[l].asc_getNameInColorScheme()),d=this.getEffectTranslation(t[l].asc_getEffectValue());r&&(c&&(r+=", "+c),d&&(r+=", "+d)),o={color:this.getHexColor(t[l].get_r(),t[l].get_g(),t[l].get_b()),effectId:l,effectValue:this.ThemeValues[s],tip:r},a.push(o)}this.effectcolors=a},getEffectColors:function(){return this.effectcolors},getStandartColors:function(){return this.standartcolors},getHexColor:function(t,e,i){return t=t.toString(16),e=e.toString(16),i=i.toString(16),(t=1==t.length?"0"+t:t)+(e=1==e.length?"0"+e:e)+(i=1==i.length?"0"+i:i)},getRgbColor:function(t){var e="object"==typeof t?t.color:t,i=(3==(e=e.replace(/#/,"")).length&&(e=e.replace(/(.)/g,"$1$1")),e=parseInt(e,16),new Asc.asc_CColor);return i.put_type("object"==typeof t&&void 0!==t.effectId?Asc.c_oAscColor.COLOR_TYPE_SCHEME:Asc.c_oAscColor.COLOR_TYPE_SRGB),i.put_r(e>>16),i.put_g((65280&e)>>8),i.put_b(255&e),i.put_a(255),void 0!==t.effectId&&i.put_value(t.effectId),i},colorValue2EffectId:function(t){if("object"==typeof t&&t&&void 0!==t.effectValue&&this.effectcolors)for(var e=0;e<this.effectcolors.length;e++)if(this.effectcolors[e].effectValue===t.effectValue&&t.color.toUpperCase()===this.effectcolors[e].color.toUpperCase()){t.effectId=this.effectcolors[e].effectId;break}return t}}}),metrics=(Common.Utils.ThemeColor=_extend_object(themecolor,Common.Utils.ThemeColor),new function(){var e=this;return e.c_MetricUnits={cm:0,pt:1,inch:2},e.currentMetric=e.c_MetricUnits.pt,e.metricName=["Cm","Pt","Inch"],e.defaultMetric=e.c_MetricUnits.cm,{c_MetricUnits:e.c_MetricUnits,txtCm:"cm",txtPt:"pt",txtInch:'"',setCurrentMetric:function(t){e.currentMetric=t},getCurrentMetric:function(){return e.currentMetric},getCurrentMetricName:function(){return this["txt"+e.metricName[e.currentMetric]]},getMetricName:function(t){return this["txt"+e.metricName[void 0!==t?t:0]]},setDefaultMetric:function(t){e.defaultMetric=t},getDefaultMetric:function(){return e.defaultMetric},fnRecalcToMM:function(t){if(null!=t)switch(e.currentMetric){case e.c_MetricUnits.cm:return 10*t;case e.c_MetricUnits.pt:return 25.4*t/72;case e.c_MetricUnits.inch:return 25.4*t}return t},fnRecalcFromMM:function(t){switch(e.currentMetric){case e.c_MetricUnits.cm:return parseFloat((t/10).toFixed(4));case e.c_MetricUnits.pt:return parseFloat((72*t/25.4).toFixed(3));case e.c_MetricUnits.inch:return parseFloat((t/25.4).toFixed(3))}return t}}}),utilsString=(Common.Utils.Metric=_extend_object(metrics,Common.Utils.Metric),Common.Utils.RGBColor=function(t){t=(t=(t="#"==t.charAt(0)?t.substr(1,6):t).replace(/ /g,"")).toLowerCase();for(var e=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,process:function(t){return[parseInt(t[1]),parseInt(t[2]),parseInt(t[3])]}},{re:/^hsb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,process:function(t){var e,i={},s=Math.round(t[1]),o=Math.round(255*t[2]/100),t=Math.round(255*t[3]/100);return 0==o?i.r=i.g=i.b=t:(t=s%60*((e=t)-(o=(255-o)*t/255))/60,(s=360==s?0:s)<60?(i.r=e,i.b=o,i.g=o+t):s<120?(i.g=e,i.b=o,i.r=e-t):s<180?(i.g=e,i.r=o,i.b=o+t):s<240?(i.b=e,i.r=o,i.g=e-t):s<300?(i.b=e,i.g=o,i.r=o+t):s<360?(i.r=e,i.g=o,i.b=e-t):(i.r=0,i.g=0,i.b=0)),[Math.round(i.r),Math.round(i.g),Math.round(i.b)]}},{re:/^(\w{2})(\w{2})(\w{2})$/,process:function(t){return[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,process:function(t){return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)]}}],i=0;i<e.length;i++){var s,o,n,a=e[i].re,l=e[i].process,a=a.exec(t);a&&(l=l(a),s=l[0],o=l[1],n=l[2])}s=s<0||isNaN(s)?0:255<s?255:s,o=o<0||isNaN(o)?0:255<o?255:o,n=n<0||isNaN(n)?0:255<n?255:n;return{r:s,g:o,b:n,isEqual:function(t){return s==t.r&&o==t.g&&n==t.b},toRGB:function(){return"rgb("+s+", "+o+", "+n+")"},toRGBA:function(t){return"rgba("+s+", "+o+", "+n+", "+(t=void 0===t?1:t)+")"},toHex:function(){var t=s.toString(16),e=o.toString(16),i=n.toString(16);return"#"+(t=1==t.length?"0"+t:t)+(e=1==e.length?"0"+e:e)+(i=1==i.length?"0"+i:i)},toHSB:function(){var t={h:0,s:0,b:0},e=Math.min(s,o,n),i=Math.max(s,o,n),e=i-e;return t.b=i,t.s=0!=i?255*e/i:0,t.h=0!=t.s?s==i?0+(o-n)/e:o==i?2+(n-s)/e:4+(s-o)/e:0,t.h*=60,t.h<0&&(t.h+=360),t.s*=100/255,t.b*=100/255,t.h=parseInt(t.h),t.s=parseInt(t.s),t.b=parseInt(t.b),t}}},new function(){return{textCtrl:"Ctrl",textShift:"Shift",textAlt:"Alt",format:function(t){var i=_.toArray(arguments).slice(1);return i.length&&"object"==typeof i[0]&&(i=i[0]),t.replace(/\{(\d+)\}/g,function(t,e){return i[e]})},htmlEncode:function(t){return"undefined"!=typeof _?_.escape(t):t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")},htmlDecode:function(t){return _.unescape(t)},ellipsis:function(t,e,i){if(t&&t.length>e){if(i){var i=t.substr(0,e-2),s=Math.max(i.lastIndexOf(" "),i.lastIndexOf("."),i.lastIndexOf("!"),i.lastIndexOf("?"));if(-1!==s&&e-15<=s)return i.substr(0,s)+"..."}return t.substr(0,e-3)+"..."}return t},platformKey:function(t,e,i){return _.isEmpty(e)&&(e=" ({0})"),Common.Utils.isMac?(_.isFunction(i)&&(t=i.call(this,t)),Common.Utils.String.format(e,t.replace(/\+(?=\S)/g,"").replace(/Ctrl|ctrl/g,"⌘").replace(/Alt|alt/g,"⌥").replace(/Shift|shift/g,"⇧"))):Common.Utils.String.format(e,t.replace(/Ctrl|ctrl/g,this.textCtrl).replace(/Alt|alt/g,this.textAlt).replace(/Shift|shift/g,this.textShift))},parseFloat:function(t){return"string"==typeof t&&(t=t.replace(",",".")),parseFloat(t)},encodeSurrogateChar:function(t){var e;return t<65536?String.fromCharCode(t):(e=56320|1023&(t-=65536),String.fromCharCode(55296|t>>10)+String.fromCharCode(e))},fixedDigits:function(t,e,i){void 0===i&&(i="0");for(var s="",t=t.toString(),o=t.length;o<e;o++)s+=i;return s+t}}}),Common,Common,Common,Common,Common,Common,Common,Common,Common,Common,Common,Common,Common,Common,Common,Common,Common,Common,Common,Common,Common,Common,Common;function onDropDownKeyDown(t){var e=$(this),i=e.parent(),s=jQuery.Event("keydown.before.bs.dropdown",{keyCode:t.keyCode}),o=jQuery.Event("keydown.after.bs.dropdown",{keyCode:t.keyCode});i.trigger(s),i.hasClass("no-stop-propagate")?(1<arguments.length&&arguments[1]instanceof KeyboardEvent&&(t=arguments[1]),!/^(38|40|27|13|9|37|39)$/.test(t.keyCode)||t.ctrlKey||t.altKey||(patchDropDownKeyDownAdditional.call(this,t),/(37|39)/.test(t.keyCode)||(t.preventDefault(),t.stopPropagation()))):e.hasClass("move-focus")&&(/^(13|9|32)/.test(t.keyCode)||27===t.keyCode&&!i.hasClass("open"))&&!t.ctrlKey&&!t.altKey||(patchDropDownKeyDown.call(this,t),t.preventDefault(),t.stopPropagation()),i.trigger(o)}function checkFocusedItem(t,e){var i=t.innerHeight(),s=(i-t.height())/2,o=e.position().top,e=e.outerHeight();o<0?t.scrollTop(t.scrollTop()+o-s):i<o+e&&t.scrollTop(t.scrollTop()+o+e-i+s)}function patchDropDownKeyDown(t){if(/(38|40|27|37|39)/.test(t.keyCode)){var e=$(this);if(t.preventDefault(),t.stopPropagation(),!e.is(".disabled, :disabled")){var i=getParent(e),s=i.hasClass("open")||i.hasClass("over");if(!s||27==t.keyCode){if(27==t.which){if((n=$("[role=menu] li.dropdown-submenu.over:visible",i)).length)return n.eq(n.length-1).removeClass("over"),!1;(i.hasClass("dropdown-submenu")&&i.hasClass("over")?(i.removeClass("over"),i.find("> a")):i.find("[data-toggle=dropdown]")).focus()}return s?e.click():void 0}var o,n=$("> [role=menu] > li:not(.divider):not(.disabled):visible",i).find("> a");n.length&&(s=n.index(n.filter(":focus")),39==t.keyCode?s<0||(o=n.eq(s).parent()).hasClass("dropdown-submenu")&&!o.hasClass("over")&&(o.mouseenter(),o.addClass("focused-submenu"),_.delay(function(){var t=$("> [role=menu]",o),e=t.find("> li:not(.divider):not(.disabled):visible > a"),i=t.find("> li:not(.divider):not(.disabled):visible .dataview"),s=t.find("> li:not(.divider):not(.disabled):visible .theme-colorpalette.focused"),t=t.find("> li:not(.divider):not(.disabled):visible ul.internal-menu");0<e.length&&i.length<1&&t.length<1&&s.length<1&&e.index(e.filter(":focus"))<0&&e.eq(0).focus()},250)):37==t.keyCode?i.hasClass("dropdown-submenu")&&i.hasClass("over")&&(i.removeClass("over"),i.find("> a").focus()):(38==t.keyCode?0<s?s--:s=e.hasClass("no-cyclic")?0:n.length-1:40==t.keyCode&&(s<n.length-1?s++:s=e.hasClass("no-cyclic")?n.length-1:0),~s||(s=0),i.hasClass("dropdown-submenu")&&i.hasClass("over")&&i.addClass("focused-submenu"),checkFocusedItem(e,n.eq(s)),n.eq(s).focus()))}}}function patchDropDownKeyDownAdditional(t){if(/(38|40|27|37|39)/.test(t.keyCode)){var e=$(this);if(/(37|39)/.test(t.keyCode)||(t.preventDefault(),t.stopPropagation()),!e.is(".disabled, :disabled")){var i=getParent(e),s=i.hasClass("open")||i.hasClass("over");if(!s||27==t.keyCode||37==t.keyCode||39==t.keyCode)return s?e.click():void 0;var o,s=$("> [role=menu] > li:not(.divider):not(.disabled):visible",i).find("> a");s.length&&(o=i=s.index(s.filter(".focus")),38==t.keyCode?0<i?i--:i=e.hasClass("no-cyclic")?0:s.length-1:40==t.keyCode&&(i<s.length-1?i++:i=e.hasClass("no-cyclic")?s.length-1:0),~i||(i=0),s.removeClass("focus"),s.eq(i).addClass("focus"),o!==i&&((t=s.eq(o).parent().data("bs.tooltip"))&&t.hide(),(t=s.eq(i).parent().data("bs.tooltip"))&&t.show()))}}}function getParent(t){var e=t.attr("data-target"),e=(e=e||(e=t.attr("href"))&&/#/.test(e)&&e.replace(/.*(?=#[^\s]*$)/,""))&&$(e);return e&&e.length?e:t.parent()}function clearMenus(i){$(".dropdown-toggle").each(function(t){var e=$(this).parent();e.hasClass("open")&&("prevent-canvas-click"==e.attr("data-value")?e.attr("data-value",""):(e.trigger(t=$.Event("hide.bs.dropdown")),t.isDefaultPrevented()||e.removeClass("open").trigger("hidden.bs.dropdown",i)))})}function toggle(){$(".dropdown-backdrop").remove()}Common.Utils.String=_extend_object(utilsString,Common.Utils.String),Common.Utils.isBrowserSupported=function(){return!(0!=Common.Utils.ieVersion&&Common.Utils.ieVersion<10||0!=Common.Utils.safariVersion&&Common.Utils.safariVersion<5||0!=Common.Utils.firefoxVersion&&Common.Utils.firefoxVersion<4||0!=Common.Utils.chromeVersion&&Common.Utils.chromeVersion<7||0!=Common.Utils.operaVersion&&Common.Utils.operaVersion<10.5)},Common.Utils.showBrowserRestriction=function(){var t,e;document.getElementsByClassName&&0<document.getElementsByClassName("app-error-panel").length||(t=window.DE?"Document":window.SSE?"Spreadsheet":window.PE?"Presentation":window.PDFE?"PDF":"that",(e=document.createElement("div")).innerHTML='<div class="app-error-panel"><div class="message-block"><div class="message-inner"><div class="title">Your browser is not supported.</div><div class="text">Sorry, '+t+' Editor is currently only supported in the latest versions of the Chrome, Firefox, Safari or Internet Explorer web browsers.</div></div></div><div class="message-auxiliary"></div></div>',document.body.appendChild(e),$("#loading-mask").hide().remove(),$("#viewport").hide().remove())},Common.Utils.applyCustomization=function(t,e){for(var i in t){var s;e[i]&&(s=$(e[i])).length&&(!1===(i=t[i])||!1===i.visible||(i.text&&s.text(i.text),!1===i.visible))&&s.hide()}},Common.Utils.applyCustomizationPlugins=function(plugins){var _createXMLHTTPObject,_getPluginCode;!plugins||plugins.length<1||(_createXMLHTTPObject=function(){var e;if("undefined"!=typeof XMLHttpRequest)e=new XMLHttpRequest;else try{e=new ActiveXObject("Msxml2.XMLHTTP")}catch(t){try{e=new ActiveXObject("Microsoft.XMLHTTP")}catch(t){e=!1}}return e},_getPluginCode=function(url){if(!url)return"";try{var xhrObj=_createXMLHTTPObject();xhrObj&&url&&(xhrObj.open("GET",url,!1),xhrObj.send(""),200==xhrObj.status&&eval(xhrObj.responseText))}catch(e){}return null},plugins.forEach(function(t){t&&_getPluginCode(t)}))},Common.Utils.fillUserInfo=function(t,e,i,s){t=t||{};return t.anonymous=!t.id,t.id||(t.id=s),t.fullname=t.name||i,t.group&&(t.fullname=t.group.toString()+AscCommon.UserInfoParser.getSeparator()+t.fullname),t.guest=!t.name,t},Common.Utils.createXhr=function(){var e;if("undefined"!=typeof XMLHttpRequest)e=new XMLHttpRequest;else try{e=new ActiveXObject("Msxml2.XMLHTTP")}catch(t){try{e=new ActiveXObject("Microsoft.XMLHTTP")}catch(t){e=!1}}return e},Common.Utils.getConfigJson=function(t){if(t)try{var e=Common.Utils.createXhr();if(e)return e.open("GET",t,!1),e.send(""),JSON.parse(e.responseText)}catch(t){}return null},Common.Utils.loadConfig=function(t,e){fetch(t,{method:"get",headers:{Accept:"application/json"}}).then(function(t){return t.ok?t.json():"error"}).then(function(t){e(t)}).catch(function(t){e("error")})},Common.Utils.asyncCall=function(t,e,i){new Promise(function(t,e){t()}).then(function(){t.call(e,i)})},String.prototype.strongMatch=function(t){return!!(t&&t instanceof RegExp)&&!!((t=this.toString().match(t))&&0<t.length&&t[0].length==this.length)},Common.Utils.InternalSettings=new function(){var i={};return{get:function(t){return i[t]},set:function(t,e){i[t]=e}}},Common.Utils.lockControls=function(t,s,i,e){var o=(i=i||{}).array||e;function n(t,e){var i;t&&t.options&&_.contains(t.options.lock,e)&&(i=t.keepState.indexOf(e),s?i<0&&t.keepState.push(e):i<0||t.keepState.splice(i,1))}i.merge&&(o=_.union(e,o)),_.each(o,function(e){e&&_.isFunction(e.setDisabled)&&(e.keepState||(e.keepState=[]),i.clear&&0<i.clear.length&&0<e.keepState.length&&(e.keepState=_.difference(e.keepState,i.clear)),_.isArray(t)?_.each(t,function(t){n(e,t)}):n(e,t),0<e.keepState.length?e.isDisabled()||e.setDisabled(!0):e.isDisabled()&&e.setDisabled(!1))})},Common.Utils.injectButtons=function(s,o,n,a,l,r,c,d,h,p,m,u){var g=createButtonSet();return g.setDisabled(!0),o=o||"id-toolbar-"+n,s.each(function(t,e){var i="btn-toolbar",e=(/x-huge/.test(e.className)&&(i+=" x-huge icon-top"),new Common.UI.Button({parentEl:s.eq(t),id:o+t,cls:i,iconCls:n,caption:a,split:r||!1,menu:c||!1,enableToggle:d||!1,lock:l,disabled:!0,dataHint:h,dataHintDirection:p,dataHintOffset:m,dataHintTitle:u}));g.add(e)}),g},Common.Utils.injectComponent=function(t,e){e&&t.length&&(e.rendered?t.append(e.$el):e.render(t))},Common.Utils.warningDocumentIsLocked=function(e){e.disablefunc&&e.disablefunc(!0);var i=window.DE||window.PE||window.SSE||window.PDFE;Common.UI.warning({msg:Common.Locale.get("warnFileLocked",{name:"Common.Translation",default:"You can't edit this file. Document is in use by another application."}),buttons:[{value:"view",caption:Common.Locale.get("warnFileLockedBtnView",{name:"Common.Translation",default:"Open for viewing"})},{value:"edit",caption:Common.Locale.get("warnFileLockedBtnEdit",{name:"Common.Translation",default:"Create a copy"})}],primary:"view",callback:function(t){"edit"==t&&(e.disablefunc&&e.disablefunc(!1),i.getController("Main").api.asc_setLocalRestrictions(Asc.c_oAscLocalRestrictionType.None))}})},jQuery.fn.extend({elementById:function(i,t){var s=document.getElementById(i.substring(1));if(!s)if((t=t||this)&&0<t.length)t.each(function(t,e){if(e.querySelectorAll)if(0==(s=e.querySelectorAll(i)).length){if("#"+e.id==i)return s=e,!1}else if(s.length)return s=s[0],!1});else if(t&&t.querySelectorAll&&(s=t.querySelectorAll(i))&&s.length)return s[0];return s},findById:function(t,e){var i=$.fn.elementById.apply(this,arguments);return i?$(i):$()}}),Common.Utils.InternalSettings.set("toolbar-height-tabs",32),Common.Utils.InternalSettings.set("toolbar-height-tabs-top-title",28),Common.Utils.InternalSettings.set("toolbar-height-controls",67),Common.Utils.InternalSettings.set("document-title-height",28),Common.Utils.InternalSettings.set("window-inactive-area-top",0),Common.Utils.InternalSettings.set("toolbar-height-compact",Common.Utils.InternalSettings.get("toolbar-height-tabs")),Common.Utils.InternalSettings.set("toolbar-height-normal",Common.Utils.InternalSettings.get("toolbar-height-tabs")+Common.Utils.InternalSettings.get("toolbar-height-controls")),Common.Utils.ModalWindow=new function(){var t=0;return{show:function(){t++},close:function(){t--},isVisible:function(){return 0<t}}},Common.Utils.UserInfoParser=new function(){var o=!1,n=String.fromCharCode(160);return{setParser:function(t){o=!!t},getSeparator:function(){return n},getParsedName:function(t){return o&&t?t.substring(t.indexOf(n)+1):t},getParsedGroups:function(t){if(o&&t){for(var e=t.indexOf(n),i=-1<e?t.substring(0,e).split(","):[],s=0;s<i.length;s++)i[s]=i[s].trim();return i}}}},Common.Utils.getKeyByValue=function(t,e){for(var i in t)if(t.hasOwnProperty(i)&&t[i]===e)return i},Common.UI||(Common.UI={}),Common.UI.isRTL=function(){return null==window.isrtl&&(window.isrtl=Common.localStorage.itemExists("ui-rtl")?Common.localStorage.getBool("ui-rtl"):Common.Locale.isCurrentLanguageRtl()),window.isrtl},define("common/main/lib/util/utils",function(){}),!function(e){for(var r,c,d={},h={16:!1,18:!1,17:!1,91:!1},i="all",p={"⇧":16,shift:16,"⌥":18,alt:18,option:18,"⌃":17,ctrl:17,control:17,"⌘":91,command:91},s={backspace:8,tab:9,clear:12,enter:13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,home:36,end:35,pageup:33,pagedown:34,",":188,".":190,"/":191,"`":192,"-":189,"=":187,";":186,"'":222,"[":219,"]":221,"\\":220,"ff-":173,"ff=":61,numplus:107,numminus:109,0:48},m=function(t){return s[t]||t.toUpperCase().charCodeAt(0)},u=[],g=1;g<20;g++)s["f"+g]=111+g;function b(t,e){for(var i=t.length;i--;)if(t[i]===e)return i;return-1}function C(t,e){if(t.length==e.length){for(var i=0;i<t.length;i++)if(t[i]!==e[i])return;return 1}}var f={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey"};function o(t){var e,i,s,o,n,a=t.keyCode;if(Common.UI.HintManager&&Common.UI.HintManager.isHintVisible())if(112===a)Common.UI.HintManager.clearHints();else if(27!==a)return;if(-1==b(u,a)&&u.push(a),(a=93!=a&&224!=a?a:91)in h)for(i in h[a]=!0,p)p[i]==a&&(S[i]=!0);else{var l=t;for(g in h)h[g]=l[f[g]];if(S.filter.call(this,t)&&a in d)for(n=v(),s=0;s<d[a].length;s++)if((e=d[a][s]).scope==n||"all"==e.scope){for(i in o=0<e.mods.length,h)(!h[i]&&-1<b(e.mods,+i)||h[i]&&-1==b(e.mods,+i))&&(o=!1);(0!=e.mods.length||h[16]||h[18]||h[17]||h[91])&&!o||!0!==r&&!e.locked&&!1!==e.method(t,e)||!0===r&&c||e.locked&&e.propagate||(t.preventDefault?t.preventDefault():t.returnValue=!1,t.stopPropagation&&t.stopPropagation(),t.cancelBubble&&(t.cancelBubble=!0))}}}function S(t,e,i){var s,o=w(t);void 0===i&&(i=e,e="all");for(var n=0;n<o.length;n++)s=[],1<(t=o[n].split("+")).length&&(s=_(t),t=[t[t.length-1]]),t=t[0],(t=m(t))in d||(d[t]=[]),d[t].push({shortcut:o[n],scope:e,method:i,key:o[n],mods:s})}for(g in p)S[g]=!1;function v(){return i||"all"}function w(t){return""==(t=(t=t.replace(/\s/g,"")).split(","))[t.length-1]&&(t[t.length-2]+=","),t}function _(t){for(var e=t.slice(0,t.length-1),i=0;i<e.length;i++)e[i]=p[e[i]];return e}function t(t,e,i){t.addEventListener?t.addEventListener(e,i,!1):t.attachEvent&&t.attachEvent("on"+e,function(){i(window.event)})}t(document,"keydown",function(t){o(t)}),t(document,"keyup",function(t){var e,i=t.keyCode;if(0<=(t=b(u,i))&&u.splice(t,1),(i=93!=i&&224!=i?i:91)in h)for(e in h[i]=!1,p)p[e]==i&&(S[e]=!1)}),t(window,"focus",function(){for(g in h)h[g]=!1;for(g in p)S[g]=!1});var n=e.key;function a(t,e,i,s){for(var o,n,a,l=[],r=w(t),c=r.length;c--;)if(1<(o=r[c].split("+")).length&&(l=_(o)),0<o.length&&(t=o[o.length-1]),t=m(t),void 0===e&&(e=v()),d[t])for(n in d[t])(a=d[t][n]).scope===e&&C(a.mods,l)&&(d[t][n][i]=s)}e.key=S,e.key.setScope=function(t){i=t||"all"},e.key.getScope=v,e.key.deleteScope=function(t){var e,i,s;for(e in d)for(i=d[e],s=0;s<i.length;)i[s].scope===t?i.splice(s,1):s++},e.key.filter=function(t){return!("INPUT"==(t=(t.target||t.srcElement).tagName)||"SELECT"==t||"TEXTAREA"==t)},e.key.isPressed=function(t){return"string"==typeof t&&(t=m(t)),-1!=b(u,t)},e.key.getPressedKeyCodes=function(){return u.slice(0)},e.key.noConflict=function(){var t=e.key;return e.key=n,t},e.key.unbind=function(t,e){for(var i,s,o,n=[],a=w(t),l=0;l<a.length;l++){if(1<(i=a[l].split("+")).length&&(n=_(i)),0<i.length&&(t=i[i.length-1]),t=m(t),void 0===e&&(e=v()),!d[t])return;for(s in d[t])(o=d[t][s]).scope===e&&C(o.mods,n)&&(d[t][s]={})}},e.key.suspend=function(t,e,i){t?(a(t,e,"locked",!0),i&&a(t,e,"propagate",!0)):(r=!0,i&&(c=!0))},e.key.resume=function(t,e){t?(a(t,e,"locked",!1),a(t,e,"propagate",!1)):r=c=!1},"undefined"!=typeof module&&(module.exports=key)}(this),define("keymaster",function(){}),void 0===Common&&(Common={}),Common.util=Common.util||{},define("common/main/lib/util/Shortcuts",["backbone","keymaster"],function(t){"use strict";function e(t){return this.cid=_.uniqueId("shortcuts"),this.initialize.apply(this,arguments),this}_.extend(e.prototype,t.Events,{initialize:function(){window.key.filter=function(t){return!0},Common.NotificationCenter.on({"modal:show":function(t){window.key.suspend()},"modal:close":function(t,e){e&&window.key.resume()},"modal:hide":function(t,e){e&&window.key.resume()}})},delegateShortcuts:function(t){if(t&&t.shortcuts){this.removeShortcuts(t);var e,i,s,o,n=[];for(s in t.shortcuts){if(i=t.shortcuts[s],_.isFunction(i))e=i;else if(!(e=t[i]))throw new Error("Method "+i+" does not exist");o=(i=s.match(/^(\S+)\s*(.*)$/))[1],i=i[2].length?i[2]:"all",e=_.bind(e,this),n.push(window.key(o,i,e))}}},removeShortcuts:function(t){if(t&&t.shortcuts){var e,i,s;for(i in t.shortcuts)s=(e=i.match(/^(\S+)\s*(.*)$/))[1],e=e[2].length?e[2]:"all",window.key.unbind(s,e)}},suspendEvents:function(t,e,i){window.key.suspend(t,e,i)},resumeEvents:function(t,e){window.key.resume(t,e)}}),e.extend=t.View.extend,Common.util.Shortcuts=new e}),void 0===Common&&(Common={}),define("common/main/lib/view/CopyWarningDialog",["common/main/lib/component/Window"],function(){"use strict";Common.Views.CopyWarningDialog=Common.UI.Window.extend(_.extend({options:{width:500,height:325,cls:"modal-dlg copy-warning",buttons:["ok"]},initialize:function(t){_.extend(this.options,{title:this.textTitle,buttons:["ok"]},t||{}),this.template=['<div class="box">','<p class="message">'+this.textMsg+"</p>",'<div class="hotkeys">',"<div>",'<p class="hotkey">'+Common.Utils.String.platformKey("Ctrl+C","{0}")+"</p>",'<p class="message">'+this.textToCopy+"</p>","</div>","<div>",'<p class="hotkey">'+Common.Utils.String.platformKey("Ctrl+X","{0}")+"</p>",'<p class="message">'+this.textToCut+"</p>","</div>","<div>",'<p class="hotkey">'+Common.Utils.String.platformKey("Ctrl+V","{0}")+"</p>",'<p class="message">'+this.textToPaste+"</p>","</div>","</div>",'<div id="copy-warning-checkbox" class="text-align-left" style="margin-top: 20px;"></div>',"</div>",'<div class="separator horizontal"></div>'].join(""),this.options.tpl=_.template(this.template)(this.options),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this),this.chDontShow=new Common.UI.CheckBox({el:$("#copy-warning-checkbox"),labelText:this.textDontShow}),this.getChild().find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.autoSize()},autoSize:function(){var t=this.getChild(".box"),e=this.getChild(".footer"),i=this.getChild(".header"),s=this.getChild(".body");s.height(parseInt(t.height())+parseInt(e.css("height"))),this.setHeight(parseInt(s.css("height"))+parseInt(i.css("height")))},onBtnClick:function(t){this.options.handler&&this.options.handler.call(this,"checked"==this.chDontShow.getValue()),this.close()},onKeyPress:function(t){t.keyCode==Common.UI.Keys.RETURN&&(this.options.handler&&this.options.handler.call(this,"checked"==this.chDontShow.getValue()),this.close())},getSettings:function(){return"checked"==this.chDontShow.getValue()}},Common.Views.CopyWarningDialog||{}))}),define("common/main/lib/view/OpenDialog",["common/main/lib/component/Window"],function(){"use strict";Common.Views.OpenDialog=Common.UI.Window.extend(_.extend({applyFunction:void 0,initialize:function(t){var e,i,s=this,o={};if(t.preview)e=414,i=t.type==Common.Utils.importTextType.Data?385:277;else switch(e=t.type!==Common.Utils.importTextType.DRM?340:t.warning?420:280,t.type){case Common.Utils.importTextType.CSV:case Common.Utils.importTextType.Paste:case Common.Utils.importTextType.Columns:i=190;break;case Common.Utils.importTextType.Data:i=245;break;default:i=t.warning?187:147}_.extend(o,{closable:!1,preview:t.preview,warning:t.warning,codepages:t.codepages,warningMsg:t.warningMsg,width:e,height:i,header:!0,cls:"open-dlg",contentTemplate:"",toolcallback:_.bind(s.onToolClose,s),closeFile:!1},t),this.txtOpenFile=t.txtOpenFile||this.txtOpenFile,this.template=t.template||['<div class="box" style="height:'+(o.height-85)+'px;">','<div class="content-panel" >',"<% if (type == Common.Utils.importTextType.DRM) { %>","<% if (warning) { %>","<div>",'<div class="icon warn"></div>','<div class="padding-left-50"><div style="font-size: 12px;">'+("string"==typeof o.warningMsg?o.warningMsg:s.txtProtected)+"</div>",'<label class="header" style="margin-top: 15px;">'+s.txtPassword+"</label>",'<div id="id-password-txt" style="width: 290px;"></div></div>',"</div>","<% } else { %>","<div>",'<label class="">'+s.txtOpenFile+"</label>",'<div id="id-password-txt"></div>',"</div>","<% } %>","<% } else { %>","<% if (codepages && codepages.length>0) { %>",'<div <% if (!!preview && (type == Common.Utils.importTextType.CSV || type == Common.Utils.importTextType.Paste || type == Common.Utils.importTextType.Columns)) { %> class="margin-right-10" style="width: 230px;display: inline-block;margin-bottom:15px;" <% } else { %> style="width: 100%;margin-bottom:15px;"<% } %> >','<label class="header">'+s.txtEncoding+"</label>","<div>",'<div id="id-codepages-combo" class="input-group-nr" style="width: 100%; display: inline-block; vertical-align: middle;"></div>',"</div>","</div>","<% } %>","<% if (type == Common.Utils.importTextType.CSV) { %>",'<div style="display: inline-block; margin-bottom:15px;">','<label class="header">'+s.txtDelimiter+"</label>","<div>",'<div id="id-delimiters-combo" class="input-group-nr" style="max-width: 100px;display: inline-block; vertical-align: middle;"></div>','<div id="id-delimiter-other" class="input-row margin-left-10" style="display: inline-block; vertical-align: middle;"></div>',"</div>","</div>","<% } %>","<% if (type == Common.Utils.importTextType.Paste || type == Common.Utils.importTextType.Columns || type == Common.Utils.importTextType.Data) { %>",'<div style="display: inline-block; margin-bottom:15px;width: 100%;">','<label class="header">'+s.txtDelimiter+"</label>","<div>",'<div id="id-delimiters-combo" class="input-group-nr" style="max-width: 100px;display: inline-block; vertical-align: middle;"></div>','<div id="id-delimiter-other" class="input-row margin-left-10" style="display: inline-block; vertical-align: middle;"></div>','<button type="button" class="btn auto btn-text-default float-right" id="id-delimiters-advanced" style="min-width:100px; display: inline-block;">'+s.txtAdvanced+"</button>","</div>","</div>","<% } %>","<% if (!!preview) { %>",'<div style="">','<label class="header">'+s.txtPreview+"</label>",'<div style="position: relative;">','<div style="width: 100%;">','<div id="id-preview">',"<div>",'<div style="position: absolute; top: 0;"><div id="id-preview-data"></div></div>',"</div>","</div>","</div>","</div>","</div>","<% } %>","<% if (type == Common.Utils.importTextType.Data) { %>",'<label class="header" style="margin-top:15px;">'+s.txtDestData+"</label>",'<div id="id-open-data-range" class="input-row" style="width: 100%;"></div>',"<% } %>","<% } %>","</div>","</div>",'<div class="footer center">','<button class="btn normal dlg-btn primary" result="ok">'+s.okButtonText+"</button>","<% if (closeFile) { %>",'<button class="btn normal dlg-btn custom margin-left-10" result="cancel">'+s.closeButtonText+"</button>","<% } %>","<% if (closable) { %>",'<button class="btn normal dlg-btn custom margin-left-10" result="cancel">'+s.cancelButtonText+"</button>","<% } %>","</div>"].join(""),this.handler=o.handler,this.type=o.type,this.preview=o.preview,this.previewData=o.previewData,this.warning=o.warning||!1,this.closable=o.closable,this.codepages=o.codepages,this.settings=o.settings,this.api=o.api,this.validatePwd=o.validatePwd||!1,o.tpl=_.template(this.template)(o),this._previewTdWidth=[],this._previewTdMaxLength=0,Common.UI.Window.prototype.initialize.call(this,o)},render:function(){var e;Common.UI.Window.prototype.render.call(this),this.$window&&((e=this).closable||this.$window.find(".tool").hide(),this.$window.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.previewPanel=this.$window.find("#id-preview-data"),this.previewParent=this.previewPanel.parent(),this.previewScrolled=this.$window.find("#id-preview"),this.previewInner=this.previewScrolled.find("> div:first-child"),this.type==Common.Utils.importTextType.DRM?this.inputPwd=new Common.UI.InputFieldBtnPassword({el:$("#id-password-txt"),type:"password",showCls:("svg"===this.options.iconType?"svg-icon":"toolbar__icon")+" btn-sheet-view",hideCls:"svg"===this.options.iconType?"svg-icon hide-password":"toolbar__icon btn-hide-password",maxLength:this.options.maxPasswordLength,validateOnBlur:!1,showPwdOnClick:!0,validation:function(t){return e.txtIncorrectPwd}}):(this.initCodePages(),this.preview&&(this.previewData?this.previewCallback(this.previewData):this.updatePreview())),this.type==Common.Utils.importTextType.Data&&(this.txtDestRange=new Common.UI.InputFieldBtn({el:$("#id-open-data-range"),name:"range",style:"width: 100%;",btnHint:this.textSelectData,allowBlank:!0,validateOnChange:!0,validateOnBlur:!1}),this.txtDestRange.on("button:click",_.bind(this.onSelectData,this)),this.dataDestValid=this.api.asc_getActiveRangeStr(Asc.referenceType.A,!0),this.txtDestRange.setValue(this.dataDestValid)),this.onPrimary=function(){return e._handleInput("ok"),!1})},getFocusedComponents:function(){var t=[];return this.inputPwd&&t.push(this.inputPwd),this.cmbEncoding&&t.push(this.cmbEncoding),this.cmbDelimiter&&t.push(this.cmbDelimiter),this.inputDelimiter&&t.push(this.inputDelimiter),this.btnAdvanced&&t.push(this.btnAdvanced),this.txtDestRange&&t.push(this.txtDestRange),t},show:function(){Common.UI.Window.prototype.show.apply(this,arguments);var t,e=this;this.type==Common.Utils.importTextType.DRM?setTimeout(function(){e.inputPwd.focus(),e.validatePwd&&e.inputPwd.checkValidate()},500):(t=e.txtDestRange||e.cmbEncoding||e.cmbDelimiter)&&setTimeout(function(){t.focus()},500)},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onToolClose:function(){this._handleInput("cancel")},_handleInput:function(t){if(this.handler)if(this.type==Common.Utils.importTextType.DRM)this.handler.call(this,t,{drmOptions:new Asc.asc_CDRMAdvancedOptions(this.inputPwd.getValue())});else{if(this.type==Common.Utils.importTextType.Data&&"ok"==t&&!this.isRangeValid())return;var e=this.cmbEncoding&&!this.cmbEncoding.isDisabled()?this.cmbEncoding.getValue():this.settings&&this.settings.asc_getCodePage()?this.settings.asc_getCodePage():0,i=this.cmbDelimiter?this.cmbDelimiter.getValue():null,s=-1==i?this.inputDelimiter.getValue():null,o=(-1==i&&(i=null),this.closable||this.type!=Common.Utils.importTextType.TXT||Common.localStorage.setItem("de-settings-open-encoding",e),this.type===Common.Utils.importTextType.CSV&&(Common.localStorage.setItem("sse-settings-csv-delimiter",null===i?-1:i),Common.localStorage.setItem("sse-settings-csv-delimiter-char",s||""),Common.localStorage.setItem("sse-settings-csv-encoding",e)),this.separatorOptions?this.separatorOptions.decimal:void 0),n=this.separatorOptions?this.separatorOptions.thousands:void 0,a=this.separatorOptions?this.separatorOptions.qualifier:'"',e=new Asc.asc_CTextOptions(e,i,s);o&&e.asc_setNumberDecimalSeparator(o),n&&e.asc_setNumberGroupSeparator(n),a&&e.asc_setTextQualifier(a),this.handler.call(this,t,{textOptions:e,range:this.txtDestRange?this.txtDestRange.getValue():"",data:this.data})}this.close()},initCodePages:function(){var t,e,i,s,o=[],n=[],a=0;if(this.codepages){for(o=[],t=0;t<this.codepages.length;++t)i=this.codepages[t],(e=[])[0]=i.asc_getCodePage(),e[1]=i.asc_getCodePageName(),e[2]=i.asc_getLcid(),o.push(e);a=50}if(s=o.length){for(t=0;t<s;++t)n.push({value:o[t][0],displayValue:Common.Utils.String.htmlEncode(o[t][1]),lcid:o[t][2]||""});var l,a=_.template(["<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%= item.value %>"><a tabindex="-1" type="menuitem">','<div style="display: inline-block;"><%= item.displayValue %></div>','<label class="text-align-right" style="width:'+a+'px;"><%= item.lcid %></label>',"</a></li>","<% }); %>"].join("")),a=(this.cmbEncoding=new Common.UI.ComboBox({el:$("#id-codepages-combo",this.$window),style:"width: 100%;",menuStyle:"min-width: 100%; max-height: 200px;",cls:"input-group-nr",menuCls:"scrollable-menu",data:n,editable:!1,disabled:!0,search:!0,itemsTemplate:a,takeFocusOnClose:!0}),this.cmbEncoding.setDisabled(!1),this.settings&&this.settings.asc_getCodePage()?this.settings.asc_getCodePage():o[0][0]),a=(this.closable||this.type!=Common.Utils.importTextType.TXT?this.type===Common.Utils.importTextType.CSV&&(l=Common.localStorage.getItem("sse-settings-csv-encoding"))&&(a=parseInt(l)):(l=Common.localStorage.getItem("de-settings-open-encoding"))&&(a=parseInt(l)),this.cmbEncoding.setValue(a),this.preview&&this.cmbEncoding.on("selected",_.bind(this.onCmbEncodingSelect,this)),this.cmbEncoding.cmpEl.find("ul")),r=a.find("li:nth(0) a"),r=a.width()-parseInt(r.css("padding-left"))-parseInt(r.css("padding-right"))-50;a.find("li div").width(r)}this.type!=Common.Utils.importTextType.CSV&&this.type!=Common.Utils.importTextType.Paste&&this.type!=Common.Utils.importTextType.Columns&&this.type!=Common.Utils.importTextType.Data||(a=this.settings&&this.settings.asc_getDelimiter()?this.settings.asc_getDelimiter():4,r=this.settings&&this.settings.asc_getDelimiterChar()?this.settings.asc_getDelimiterChar():"",this.type==Common.Utils.importTextType.CSV&&(l=Common.localStorage.getItem("sse-settings-csv-delimiter"))&&(l=parseInt(l),isNaN(l)||-1===(a=l)&&(r=Common.localStorage.getItem("sse-settings-csv-delimiter-char")||"")),this.cmbDelimiter=new Common.UI.ComboBox({el:$("#id-delimiters-combo",this.$window),style:"width: 100px;",menuStyle:"min-width: 100px;",cls:"input-group-nr",data:[{value:4,displayValue:this.txtComma},{value:2,displayValue:this.txtSemicolon},{value:3,displayValue:this.txtColon},{value:1,displayValue:this.txtTab},{value:5,displayValue:this.txtSpace},{value:-1,displayValue:this.txtOther}],editable:!1,takeFocusOnClose:!0}),this.cmbDelimiter.setValue(a),this.cmbDelimiter.on("selected",_.bind(this.onCmbDelimiterSelect,this)),this.inputDelimiter=new Common.UI.InputField({el:$("#id-delimiter-other"),style:"width: 30px;",maxLength:1,validateOnChange:!0,validateOnBlur:!1,value:r}),this.inputDelimiter.setVisible(-1===a),this.preview&&this.inputDelimiter.on("changing",_.bind(this.updatePreview,this)),this.type!=Common.Utils.importTextType.Paste&&this.type!=Common.Utils.importTextType.Columns&&this.type!=Common.Utils.importTextType.Data||(this.btnAdvanced=new Common.UI.Button({el:$("#id-delimiters-advanced")}),this.btnAdvanced.on("click",_.bind(this.onAdvancedClick,this))))},updatePreview:function(){this._previewTdWidth=[],this._previewTdMaxLength=0;var t=this.cmbEncoding&&!this.cmbEncoding.isDisabled()?this.cmbEncoding.getValue():this.settings&&this.settings.asc_getCodePage()?this.settings.asc_getCodePage():0,e=this.cmbDelimiter?this.cmbDelimiter.getValue():null,i=-1==e?this.inputDelimiter.getValue():null,s=(-1==e&&(e=null),new Asc.asc_CTextOptions(t,e,i));switch(this.separatorOptions&&(s.asc_setNumberDecimalSeparator(this.separatorOptions.decimal),s.asc_setNumberGroupSeparator(this.separatorOptions.thousands),s.asc_setTextQualifier(this.separatorOptions.qualifier)),this.type){case Common.Utils.importTextType.CSV:case Common.Utils.importTextType.TXT:case Common.Utils.importTextType.Data:this.api.asc_decodeBuffer(this.preview,s,_.bind(this.previewCallback,this));break;case Common.Utils.importTextType.Paste:case Common.Utils.importTextType.Columns:this.api.asc_TextImport(s,_.bind(this.previewCallback,this),this.type==Common.Utils.importTextType.Paste)}},previewCallback:function(t){t&&t.length&&(this.data=t,this.previewInner.height(17*t.length),this.scrollerY||(this.scrollerY=new Common.UI.Scroller({el:this.previewScrolled,minScrollbarLength:20,alwaysVisibleY:!0,alwaysVisibleX:!0,onChange:_.bind(function(){var t,e,i;this.scrollerY&&(t=this.scrollerY.getScrollTop(),(i=(e=Math.floor(t/17+.5))+Math.min(6,this.data.length))>this.data.length&&(i=this.data.length,t=17*(e=this.data.length-6)),this.previewParent.height(108),this.previewParent.css({top:t}),this.previewDataBlock(this.data.slice(e,i)))},this)})),this.scrollerY.update(),this.scrollerY.scrollTop(0))},previewDataBlock:function(t){if(_.isUndefined(this.scrollerX)||(this.scrollerX.destroy(),delete this.scrollerX),this.type==Common.Utils.importTextType.CSV||this.type==Common.Utils.importTextType.Paste||this.type==Common.Utils.importTextType.Columns||this.type==Common.Utils.importTextType.Data){for(var e=0,i=0;i<t.length;i++)(o=t[i]||"").length>e&&(e=o.length);this._previewTdMaxLength=Math.max(this._previewTdMaxLength,e);for(var s="<table>",i=0;i<t.length;i++){var o=t[i]||"";s+='<tr style="vertical-align: top;">';for(var n=0;n<o.length;n++){var a="";s+="<td "+(a=0==i&&this._previewTdWidth[n]?'style="min-width:'+this._previewTdWidth[n]+'px;"':a)+">"+Common.Utils.String.htmlEncode(o[n])+"</td>"}for(n=o.length;n<this._previewTdMaxLength;n++){a="";s+="<td "+(a=0==i&&this._previewTdWidth[n]?'style="min-width:'+this._previewTdWidth[n]+'px;"':a)+"></td>"}s+="</tr>"}}else for(s="<table>",i=0;i<t.length;i++){o=t[i]||"";s+='<tr style="vertical-align: top;"><td>'+Common.Utils.String.htmlEncode(o)+"</td></tr>"}var l;this.previewPanel.html(s+="</table>"),0<t.length&&(0===(l=this)._previewTdWidth.length&&this.previewScrolled.scrollLeft(0),this.previewPanel.find("tr:first td").each(function(t,e){l._previewTdWidth[t]=Math.max(Math.max(Math.ceil($(e).outerWidth()),30),l._previewTdWidth[t]||0)})),this.scrollerX=new Common.UI.Scroller({el:this.previewPanel,suppressScrollY:!0,alwaysVisibleX:!0,minScrollbarLength:20})},onCmbDelimiterSelect:function(t,e){this.inputDelimiter.setVisible(-1==e.value);var i=this;-1==e.value&&setTimeout(function(){i.inputDelimiter.focus()},10),this.preview&&this.updatePreview()},onCmbEncodingSelect:function(t,e){this.updatePreview()},onAdvancedClick:function(){var i,s,o,t;SSE&&(s=(i=this).separatorOptions?this.separatorOptions.decimal:this.api.asc_getDecimalSeparator(),o=this.separatorOptions?this.separatorOptions.thousands:this.api.asc_getGroupSeparator(),t=this.separatorOptions?this.separatorOptions.qualifier:(this.settings||new Asc.asc_CTextOptions).asc_getTextQualifier(),new SSE.Views.AdvancedSeparatorDialog({props:{decimal:s,thousands:o,qualifier:t},handler:function(t,e){"ok"==t&&(i.separatorOptions={decimal:0<e.decimal.length?e.decimal:s,thousands:0<e.thousands.length?e.thousands:o,qualifier:e.qualifier},i.preview&&i.updatePreview())}}).show())},onSelectData:function(t){var e,i,s=this,o=s.txtDestRange;s.api&&(e=new SSE.Views.CellRangeDialog({handler:function(t,e){"ok"==e&&(e=t.getSettings(),s.dataDestValid=e,o.setValue(e),o.checkValidate())}}).on("close",function(){s.show(),_.delay(function(){o.focus()},1)}),i=s.$window.offset(),s.hide(),e.show(i.left+160,i.top+125),e.setSettings({api:s.api,range:_.isEmpty(o.getValue())||1!=o.checkValidate()?s.dataDestValid:o.getValue(),type:Asc.c_oAscSelectionDialogType.Chart}))},isRangeValid:function(){var t=!0,e="";return _.isEmpty(this.txtDestRange.getValue())?(t=!1,e=this.txtEmpty):(t=(t=this.api.asc_checkDataRange(Asc.c_oAscSelectionDialogType.Chart,this.txtDestRange.getValue()))==Asc.c_oAscError.ID.No)||(e=this.textInvalidRange),t||(this.txtDestRange.showError([e]),this.txtDestRange.focus()),t}},Common.Views.OpenDialog||{}))}),void 0===Common&&(Common={}),define("common/main/lib/component/MetricSpinner",["common/main/lib/component/BaseView"],function(){"use strict";Common.UI.MetricSpinner=Common.UI.BaseView.extend({options:{minValue:0,maxValue:100,step:1,defaultUnit:"px",allowAuto:!1,autoText:"Auto",hold:!0,speed:"medium",width:90,allowDecimal:!0,dataHint:"",dataHintDirection:"",dataHintOffset:""},disabled:!1,value:"0 px",rendered:!1,template:'<input type="text" class="form-control" spellcheck="false" data-hint="<%= dataHint %>" data-hint-direction="<%= dataHintDirection %>" data-hint-offset="<%= dataHintOffset %>"><div class="spinner-buttons"><button type="button" class="spinner-up"><i class="arrow"></i></button><button type="button" class="spinner-down"><i class="arrow"></i></button></div>',initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);var e=this,t=e.$el||$(this.el);t.addClass("spinner"),t.on("mousedown",".spinner-up",_.bind(this.onMouseDown,this,!0)),t.on("mousedown",".spinner-down",_.bind(this.onMouseDown,this,!1)),t.on("mouseup",".spinner-up",_.bind(this.onMouseUp,this,!0)),t.on("mouseup",".spinner-down",_.bind(this.onMouseUp,this,!1)),t.on("mouseover",".spinner-up, .spinner-down",_.bind(this.onMouseOver,this)),t.on("mouseout",".spinner-up, .spinner-down",_.bind(this.onMouseOut,this)),t.on("keydown",".form-control",_.bind(this.onKeyDown,this)),t.on("keyup",".form-control",_.bind(this.onKeyUp,this)),t.on("blur",".form-control",_.bind(this.onBlur,this)),t.on("input",".form-control",_.bind(this.onInput,this)),this.options.allowDecimal||t.on("keypress",".form-control",_.bind(this.onKeyPress,this)),t.on("focus","input.form-control",function(t){setTimeout(function(){e.$input&&(e.$input[0].selectionStart=0,e.$input[0].selectionEnd=e.$input.val().length)},1)}),Common.Utils.isGecko&&t.on("blur","input.form-control",function(){setTimeout(function(){e.$input&&(e.$input[0].selectionStart=e.$input[0].selectionEnd=0)},1)}),this.switches={count:1,enabled:!0,fromKeyDown:!1},"medium"===this.options.speed?this.switches.speed=300:"fast"===this.options.speed?this.switches.speed=100:this.switches.speed=500,this.render(),this.options.disabled&&this.setDisabled(this.options.disabled),void 0!==this.options.value&&(this.value=this.options.value),this.setRawValue(this.value),this.options.width&&t.width(this.options.width),void 0===this.options.defaultValue&&(this.options.defaultValue=this.options.minValue),this.oldValue=this.options.minValue,this.lastValue=null},render:function(){var t=this.$el||$(this.el),e=_.template(this.template);return t.html($(e({dataHint:this.options.dataHint,dataHintDirection:this.options.dataHintDirection,dataHintOffset:this.options.dataHintOffset}))),this.$input=t.find(".form-control"),this.rendered=!0,null!=this.options.tabindex&&this.$input.attr("tabindex",this.options.tabindex),this},setDisabled:function(t){t=!!t;var e=this.$el||$(this.el);t!==this.disabled&&(e.find("button").toggleClass("disabled",t),e.toggleClass("disabled",t),t?this.$input.attr({disabled:t}):this.$input.removeAttr("disabled")),this.disabled=t},isDisabled:function(){return this.disabled},setDefaultUnit:function(t){var e;this.options.defaultUnit!=t&&(e=this.options.defaultUnit,this.options.defaultUnit=t,this.setMinValue(this._recalcUnits(this.options.minValue,e)),this.setMaxValue(this._recalcUnits(this.options.maxValue,e)),this.setValue(this._recalcUnits(this.getNumberValue(),e),!0))},setMinValue:function(t){this.options.minValue=t},setMaxValue:function(t){this.options.maxValue=t},setStep:function(t){this.options.step=t},getMinValue:function(){return this.options.minValue},getMaxValue:function(){return this.options.maxValue},getNumberValue:function(){return this.checkAutoText(this.value)?-1:parseFloat(this.value)},getUnitValue:function(){return this.options.defaultUnit},getValue:function(){return this.value},setRawValue:function(t){this.$input&&this.$input.val(t)},getRawValue:function(){return this.$input.val()},setValue:function(t,e){var i,s,o=!1;this._fromKeyDown=!1,this.lastValue=this.value,void 0===t||""===t?this.value="":this.options.allowAuto&&(Math.abs(Common.Utils.String.parseFloat(t)+1)<1e-4||this.checkAutoText(t))?this.value=this.options.autoText:(i=this._add(Common.Utils.String.parseFloat(t),0,this.options.allowDecimal?3:0),void 0!==t&&!isNaN(i)||(i=this.oldValue,o=!0),s=this.options.defaultUnit,void 0!==t.match&&null!==(t=t.match(/(px|em|%|en|ex|pt|"|cm|mm|pc|s|ms|см|мм|пт|сек|мс)$/i))&&"undefined"!==t[0]&&(s=t[0].toLowerCase()),(i=this.options.defaultUnit===s||o?i:this._recalcUnits(i,s))>this.options.maxValue&&(i=this.options.maxValue,o=!0),i<this.options.minValue&&(i=this.options.minValue,o=!0),this.value=(i+" "+this.options.defaultUnit).trim(),this.oldValue=i),!0!==e&&this.lastValue!==this.value&&this.trigger("change",this,this.value,this.lastValue),!0!==e&&o&&this.trigger("inputerror",this,this.value),this.rendered?this.setRawValue(this.value):this.options.value=this.value},setMask:function(t){this.options.maskExp=t},onMouseDown:function(t,e){this.disabled||(e&&$(e.currentTarget).addClass("active"),this.options.hold&&(this.switches.fromKeyDown=!1,this._startSpin(t,e)))},onMouseUp:function(t,e){this.disabled||($(e.currentTarget).removeClass("active"),this.options.hold?this._stopSpin():this._step(t))},onMouseOver:function(t){this.disabled||$(t.currentTarget).addClass("over")},onMouseOut:function(t){this.disabled||($(t.currentTarget).removeClass("active over"),this.options.hold&&this._stopSpin())},onKeyDown:function(t){if(!this.disabled){if(!this.options.hold||t.keyCode!=Common.UI.Keys.UP&&t.keyCode!=Common.UI.Keys.DOWN)if(t.keyCode==Common.UI.Keys.RETURN)if(this.options.defaultUnit&&this.options.defaultUnit.length){var e=this.getRawValue();if(this.value!=e)return this.onEnterValue(),this.trigger("inputleave",this),this.value==e}else this.onEnterValue();else this._fromKeyDown=!0;else t.preventDefault(),t.stopPropagation(),void 0===this.switches.timeout&&(this.switches.fromKeyDown=!0,this._startSpin(t.keyCode==Common.UI.Keys.UP,t));t.keyCode==Common.UI.Keys.ESC&&this.setRawValue(this.value),t.keyCode!=Common.UI.Keys.RETURN&&t.keyCode!=Common.UI.Keys.ESC||this.trigger("inputleave",this)}},onKeyUp:function(t){this.disabled||t.keyCode!=Common.UI.Keys.UP&&t.keyCode!=Common.UI.Keys.DOWN||(t.stopPropagation(),t.preventDefault(),this.options.hold?this._stopSpin():this._step(t.keyCode==Common.UI.Keys.UP))},onKeyPress:function(t){var e;this.disabled||("."!=(e=String.fromCharCode(t.charCode))&&","!=e&&(!this.options.maskExp||this.options.maskExp.test(e)||t.ctrlKey||t.keyCode===Common.UI.Keys.RETURN)||(t.preventDefault(),t.stopPropagation()))},onInput:function(t,e){this.disabled||t.isDefaultPrevented()||this.trigger("changing",this,$(t.target).val(),t)},onEnterValue:function(){var t;this.$input&&(t=this.getRawValue(),this.setValue(""===t?this.value:t),this.trigger("entervalue",this))},onBlur:function(t){var e;this.$input&&(e=this.getRawValue(),this.setValue(""===e?this.value:e),this.options.hold&&this.switches.fromKeyDown&&this._stopSpin())},_startSpin:function(t,e){var i;this.disabled||(i=1===(i=this.switches.count)?(this._step(t,!0),1):i<3?1.5:i<8?2.5:6,this.switches.timeout=setTimeout($.proxy(function(){this._step(t,!0),this._startSpin(t)},this),this.switches.speed/i),this.switches.count++)},_stopSpin:function(t){void 0!==this.switches.timeout&&(clearTimeout(this.switches.timeout),this.switches.timeout=void 0,this.switches.count=1,this.trigger("change",this,this.value,this.lastValue))},_increase:function(t){var e,i=this;i.readOnly||(e=i.options.step,i._fromKeyDown?(e=this.getRawValue(),e=_.isEmpty(e)?i.oldValue:Common.Utils.String.parseFloat(e)):""!==i.getValue()?(e=i.checkAutoText(i.getValue())?i.options.defaultValue-i.options.step:Common.Utils.String.parseFloat(i.getValue()),isNaN(e)&&(e=this.oldValue)):e=i.options.defaultValue-i.options.step,i.setValue((this._add(e,i.options.step,i.options.allowDecimal?3:0)+" "+this.options.defaultUnit).trim(),t))},_decrease:function(t){var e=this;if(!e.readOnly){var i=e.options.step;if(e._fromKeyDown)i=this.getRawValue(),i=_.isEmpty(i)?e.oldValue:Common.Utils.String.parseFloat(i);else if(""!==e.getValue()){if(i=e.checkAutoText(e.getValue())?e.options.minValue:Common.Utils.String.parseFloat(e.getValue()),isNaN(i)&&(i=this.oldValue),e.options.allowAuto&&this._add(i,-e.options.step,e.options.allowDecimal?3:0)<e.options.minValue)return void e.setValue(e.options.autoText,!0)}else i=e.options.defaultValue;e.setValue((this._add(i,-e.options.step,e.options.allowDecimal?3:0)+" "+this.options.defaultUnit).trim(),t)}},_step:function(t,e){t?this._increase(e):this._decrease(e),this.options.hold&&this.switches.fromKeyDown&&this.$input&&this.$input.select()},_add:function(t,e,i){i=Math.pow(10,i||this.options.allowDecimal?2:0);return(Math.round(t*i)+Math.round(e*i))/i},_recalcUnits:function(t,e){var i;return e.match(/(s|ms|сек|мс)$/i)&&this.options.defaultUnit.match(/(s|ms|сек|мс)$/i)?(i=t,"ms"!=e&&"мс"!=e||(i=parseFloat((i/1e3).toFixed(6))),"ms"!=this.options.defaultUnit&&"мс"!=this.options.defaultUnit?i:parseFloat((1e3*i).toFixed(6))):null===e.match(/(pt|"|cm|mm|pc|см|мм|пт)$/i)||null===this.options.defaultUnit.match(/(pt|"|cm|mm|pc|см|мм|пт)$/i)?t:(i=t,"cm"==e||"см"==e?i*=10:"pt"==e||"пт"==e?i=25.4*i/72:'"'==e?i*=25.4:"pc"==e&&(i=25.4*i/6),"cm"==this.options.defaultUnit||"см"==this.options.defaultUnit?i=parseFloat((i/10).toFixed(6)):"pt"==this.options.defaultUnit||"пт"==this.options.defaultUnit?i=parseFloat((72*i/25.4).toFixed(3)):'"'==this.options.defaultUnit?i=parseFloat((i/25.4).toFixed(3)):"pc"==this.options.defaultUnit&&(i=parseFloat((6*i/25.4).toFixed(6))),i)},focus:function(){this.$input&&this.$input.focus()},setDefaultValue:function(t){this.options.defaultValue=t},checkAutoText:function(t){return!(!this.options.allowAuto||"string"!=typeof t)&&((t=t.toLowerCase())==this.options.autoText.toLowerCase()||"auto"==t)}}),Common.UI.CustomSpinner=Common.UI.MetricSpinner.extend(_.extend({initialize:function(t){this.options.toCustomFormat=t.toCustomFormat||function(t){return t},this.options.fromCustomFormat=t.fromCustomFormat||function(t){return t},Common.UI.MetricSpinner.prototype.initialize.call(this,t)},setRawValue:function(t){this.$input&&this.$input.val(this.options.toCustomFormat(t))},getRawValue:function(){return this.options.fromCustomFormat(this.$input.val())}},Common.UI.CustomSpinner||{}))}),define("text!common/main/lib/template/ExtendedColorDialog.template",[],function(){return'<div class="color-box">\n    <div id="id-hsb-colorpicker" style="vertical-align:top;">\n    </div>\n    <div class="color-info" style="">\n        <div class="margin-left-15">\n            <label class="color-label"><%= txtNew %></label>\n            <div id="field-new-color" class="color-cnt top"></div>\n            <div id="field-start-color" class="color-cnt bottom"></div>\n            <label class="color-label"><%= txtCurrent %></label>\n        </div>\n        <div style="padding:13px 0 2px 0;">\n            <label class="input-label">R:</label>\n            <div id="extended-spin-r" class="color-spin"></div>\n        </div>\n        <div style="padding:2px 0;">\n            <label class="input-label">G:</label>\n            <div id="extended-spin-g" class="color-spin"></div>\n        </div>\n        <div style="padding:2px 0;">\n            <label class="input-label">B:</label>\n            <div id="extended-spin-b" class="color-spin"></div>\n        </div>\n        <div style="padding:11px 0 0 0;">\n            <label class="input-label" style="width:12px;">#:</label>\n            <input id="extended-text-color" type="text" role="textbox" style="width:62px; height: 22px;">\n        </div>\n    </div>\n</div>\n<div class="footer center">\n    <button class="btn normal dlg-btn primary" result="1"><%= txtAdd %></button>\n    <button class="btn normal dlg-btn" result="0"><%= txtCancel %></button>\n</div>\n'}),void 0===Common&&(Common={}),define("common/main/lib/component/HSBColorPicker",["common/main/lib/component/BaseView","common/main/lib/util/utils"],function(){"use strict";Common.UI.HSBColorPicker=Common.UI.BaseView.extend({template:_.template('<div class="hsb-colorpicker"><% if (this.showCurrentColor) { %><div class="top-panel"><span class="color-value"><span class="transparent-color img-colorpicker"></span></span><div class="color-text"></div></div><% } %><div><div class="cnt-hb img-colorpicker"><div class="cnt-hb-arrow"></div></div><% if (this.changeSaturation) { %><div class="cnt-root"><div class="cnt-sat img-colorpicker"><div class="cnt-sat-arrow img-colorpicker"></div></div></div><% } %></div><% if (this.allowEmptyColor) { %><div class="empty-color"><%= this.textNoColor %></div><% } %></div>'),color:"#ff0000",options:{allowEmptyColor:!1,changeSaturation:!0,showCurrentColor:!0},initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);var s,o,n,a,i,l,r,c,d=this,h=(d.$el||$(this.el),0),p=100,m=100,u=(d.allowEmptyColor=d.options.allowEmptyColor,d.changeSaturation=d.options.changeSaturation,d.showCurrentColor=d.options.showCurrentColor,function(t,e){t=new Common.Utils.RGBColor("hsb("+t.h+","+t.s+","+t.b+")").toHex();d.color=e?"transparent":t,g(),d.trigger("changecolor",d,d.color)}),g=function(){var t;0<i.length&&0<l.length&&("transparent"==d.color?l.show():(i.css("background-color",d.color),l.hide())),0<n.length&&(t="linear-gradient(rgba(255,255,255,0), #000), linear-gradient(-90deg,"+(t=new Common.Utils.RGBColor("hsb("+h+", 100, 100)")).toRGB()+","+t.toRGBA(0)+"), #fff",n.css("background",t)),0<r.length&&(r[0].innerHTML="transparent"==d.color?d.textNoColor:d.color.toUpperCase()),0<s.length&&0<o.length&&(s.css({left:p+"%",top:100-m+"%","background-color":d.color}),o.css("top",parseInt(100*h/360)+"%"))},b=function(t,e,i){0<s.length&&0<n.length&&(t=[Math.max(0,Math.min(100,parseInt((t.pageX*Common.Utils.zoom()-n.offset().left)/n.width()*100))),Math.max(0,Math.min(100,parseInt((t.pageY*Common.Utils.zoom()-n.offset().top)/n.height()*100)))],s.css("left",t[0]+"%"),s.css("top",t[1]+"%"),u({h:h,s:p=t[0],b:m=100-t[1]}))},C=function(t,e,i){o&&a&&(t=Math.max(0,Math.min(100,parseInt((t.pageY*Common.Utils.zoom()-a.offset().top)/a.height()*100))),o.css("top",t+"%"),h=parseInt(360*t/100),u({h:h,s:p,b:m}))},f=function(t,e,i){$(document).on("mouseup",S),$(document).on("mousemove",b)},S=function(t,e,i){$(document).off("mouseup",S),$(document).off("mousemove",b),b(t,e,i)},v=function(t,e,i){$(document).on("mouseup",w),$(document).on("mousemove",C),C(t,e,i)},w=function(t,e,i){$(document).off("mouseup",w),$(document).off("mousemove",C)},_=function(t){var e=new Common.util.RGBColor(d.color).toHSB();u(e,!0)};d.setColor=function(t){var e;d.color!=t&&(e="transparent"==t?{h:0,s:100,b:100}:new Common.Utils.RGBColor(t).toHSB(),h=e.h,p=e.s,m=e.b,h==p&&h==m&&0==h&&(p=100),d.color=t,g())},d.getColor=function(){return d.color},d.on("render:after",function(t){var e=$(d.el);e&&(s=e.find(".cnt-hb-arrow"),o=e.find(".cnt-sat-arrow"),n=e.find(".cnt-hb"),a=e.find(".cnt-sat"),i=e.find(".color-value"),r=e.find(".color-text"),c=e.find(".empty-color"),0<i.length&&(l=i.find(".transparent-color")),0<n.length&&(n.off("mousedown"),n.on("mousedown",f)),0<a.length&&(a.off("mousedown"),a.on("mousedown",v)),0<c.length&&(c.off("click"),c.on("click",_)),e="transparent"==d.color?{h:0,s:100,b:100}:new Common.Utils.RGBColor(d.color).toHSB(),h=e.h,p=e.s,m=e.b,h==p&&h==m&&0==h&&(p=100),g())}),d.render()},render:function(){return(this.$el||$(this.el)).html(this.template()),this.trigger("render:after",this),this},textNoColor:"No Color"})}),void 0===Common&&(Common={}),define("common/main/lib/component/MaskedField",["common/main/lib/component/BaseView"],function(){"use strict";Common.UI.MaskedField=Common.UI.BaseView.extend({options:{maskExp:"",maxLength:999},initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);var i=this,s=i.$el||$(this.el);s.addClass("masked-field user-select"),s.attr("maxlength",i.options.maxLength),s.on("keypress",function(t){var e=String.fromCharCode(t.which);i.options.maskExp.test(e)||t.ctrlKey||(t.keyCode==Common.UI.Keys.RETURN&&i.trigger("changed",i,s.val()),t.preventDefault(),t.stopPropagation())}),s.on("input",function(t){i.trigger("change",i,s.val())}),s.on("blur",function(t){i.trigger("changed",i,s.val())})},render:function(){return this},setValue:function(t){this.options.maskExp.test(t)&&t.length<=this.options.maxLength&&this.$el.val(t)},getValue:function(){this.$el.val()}})}),void 0===Common&&(Common={}),define("common/main/lib/view/ExtendedColorDialog",["text!common/main/lib/template/ExtendedColorDialog.template","common/main/lib/component/HSBColorPicker","common/main/lib/component/MetricSpinner","common/main/lib/component/MaskedField","common/main/lib/component/Window"],function(t){"use strict";Common.UI.ExtendedColorDialog=Common.UI.Window.extend(_.extend({tpl:_.template(t),options:{},rendered:!1,initialize:function(t){Common.UI.Window.prototype.initialize.call(this,{cls:"extended-color-dlg",tpl:this.tpl({txtNew:this.textNew,txtCurrent:this.textCurrent,txtAdd:this.addButtonText,txtCancel:this.cancelButtonText}),header:!1,width:340,height:272}),this.hexRe=/\s*#?([0-9a-fA-F][0-9a-fA-F]?)([0-9a-fA-F][0-9a-fA-F]?)([0-9a-fA-F][0-9a-fA-F]?)\s*/},render:function(){var e=this;return Common.UI.Window.prototype.render.call(this),this.colorsPicker=new Common.UI.HSBColorPicker({el:$("#id-hsb-colorpicker"),showCurrentColor:!1}),this.colorsPicker.on("changecolor",_.bind(this.onChangeColor,this)),this.colorNew=$("#field-new-color"),this.colorSaved=$("#field-start-color"),this.spinR=new Common.UI.MetricSpinner({el:$("#extended-spin-r"),step:1,width:63,value:"0",defaultUnit:"",maxValue:255,minValue:0,maskExp:/[0-9]/,allowDecimal:!1}),this.spinG=new Common.UI.MetricSpinner({el:$("#extended-spin-g"),step:1,width:63,value:"0",defaultUnit:"",maxValue:255,minValue:0,maskExp:/[0-9]/,allowDecimal:!1}),this.spinB=new Common.UI.MetricSpinner({el:$("#extended-spin-b"),step:1,width:63,value:"0",defaultUnit:"",maxValue:255,minValue:0,maskExp:/[0-9]/,allowDecimal:!1}),this.textColor=new Common.UI.MaskedField({el:$("#extended-text-color"),width:55,maskExp:/[a-fA-F0-9]/,maxLength:6}),this.spinR.on("change",_.bind(this.showColor,this,null,!0)).on("changing",_.bind(this.onChangingRGB,this,1)),this.spinG.on("change",_.bind(this.showColor,this,null,!0)).on("changing",_.bind(this.onChangingRGB,this,2)),this.spinB.on("change",_.bind(this.showColor,this,null,!0)).on("changing",_.bind(this.onChangingRGB,this,3)),this.textColor.on("change",_.bind(this.onChangeMaskedField,this)),this.textColor.on("changed",_.bind(this.onChangedMaskedField,this)),this.textColor.$el.on("focus",function(){setTimeout(function(){e.textColor.$el&&e.textColor.$el.select()},1)}),this.spinR.$el.find("input").attr("maxlength",3),this.spinG.$el.find("input").attr("maxlength",3),this.spinB.$el.find("input").attr("maxlength",3),this.on("close",function(){e.trigger("onmodalresult",0)}),$(this)[0].getChild(".footer .dlg-btn").on("click",function(t){e.trigger("onmodalresult",parseInt(t.currentTarget.attributes.result.value)),e.close(!0)}),this.rendered=!0,void 0!==this.color&&this.setColor(this.color),this},getFocusedComponents:function(){return[this.spinR,this.spinG,this.spinB,{cmp:this.textColor,selector:"input"}]},getDefaultFocusableComponent:function(){return this.getChild("#extended-text-color")},onChangeColor:function(t,e){this.colorNew.css({"background-color":e}),this.stopevents=!0;e=e.match(this.hexRe);this.spinR.setValue(parseInt(e[1],16)),this.spinG.setValue(parseInt(e[2],16)),this.spinB.setValue(parseInt(e[3],16)),this.textColor.setValue((e[1]+e[2]+e[3]).toUpperCase()),this.stopevents=!1},showColor:function(t,e){var i,s,o;this.stopevents||(i=null==(o=this.spinR.getNumberValue())||o<0?0:255<o?255:o,e&&this.spinR.setValue(i,!0),i=i.toString(16),s=null==(o=this.spinG.getNumberValue())||o<0?0:255<o?255:o,e&&this.spinG.setValue(s,!0),s=s.toString(16),o=null==(o=this.spinB.getNumberValue())||o<0?0:255<o?255:o,e&&this.spinB.setValue(o,!0),o=o.toString(16),e=(1==i.length?"0"+i:i)+(1==s.length?"0"+s:s)+(1==o.length?"0"+o:o),this.colorsPicker.setColor("#"+e),"hex"!=t&&this.textColor.setValue(e.toUpperCase()),this.colorNew.css("background-color","#"+e))},onChangingRGB:function(t,e,i,s){if(!this.stopevents){var o,n,a,l;switch(i=_.isEmpty(i)||isNaN(parseInt(i))?parseInt(e.getValue()):parseInt(i),t){case 1:o=(null==i||isNaN(i)||i<0?0:255<i?255:i).toString(16),n=(null==(l=this.spinG.getNumberValue())||l<0?0:255<l?255:l).toString(16),a=(null==(l=this.spinB.getNumberValue())||l<0?0:255<l?255:l).toString(16);break;case 2:o=(null==(l=this.spinR.getNumberValue())||l<0?0:255<l?255:l).toString(16),n=(null==i||isNaN(i)||i<0?0:255<i?255:i).toString(16),a=(null==(l=this.spinB.getNumberValue())||l<0?0:255<l?255:l).toString(16);break;case 3:o=(null==(l=this.spinR.getNumberValue())||l<0?0:255<l?255:l).toString(16),n=(null==(l=this.spinG.getNumberValue())||l<0?0:255<l?255:l).toString(16),a=(null==i||isNaN(i)||i<0?0:255<i?255:i).toString(16)}e=(1==o.length?"0"+o:o)+(1==n.length?"0"+n:n)+(1==a.length?"0"+a:a);this.colorsPicker.setColor("#"+e),this.textColor.setValue(e.toUpperCase()),this.colorNew.css("background-color","#"+e)}},onChangeMaskedField:function(t,e){e=(e="000000"+(e=/^[a-fA-F0-9]{0,6}$/.test(e)?e:"000000")).match(/([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})$/i);this.stopevents=!0,this.spinR.setValue(parseInt(e[1],16)),this.spinG.setValue(parseInt(e[2],16)),this.spinB.setValue(parseInt(e[3],16)),this.stopevents=!1,this.rendered&&this.showColor("hex")},onChangedMaskedField:function(t,e){/^[a-fA-F0-9]{0,6}$/.test(e)&&!_.isEmpty(e)||t.setValue("000000"),this.rendered&&this.showColor("",!0)},getColor:function(){var t=/#?([a-fA-F0-9]{6})/.exec(this.colorsPicker.getColor());return t?t[1]:null},setColor:function(t){var e,i=this;!0!==this.rendered?this.color=t:(e=/#?([a-fA-F0-9]{6})/.test(t)?t:"ff0000",i.colorsPicker.setColor("#"+e),"transparent"==t?i.colorSaved.addClass("color-transparent"):(i.colorSaved.removeClass("color-transparent"),i.colorSaved.css("background-color","#"+t)),i.colorNew.css("background-color","#"+e),i.stopevents=!0,t=i.hexRe.exec(e),i.spinR.setValue(parseInt(t[1],16)),i.spinG.setValue(parseInt(t[2],16)),i.spinB.setValue(parseInt(t[3],16)),i.textColor.setValue((t[1]+t[2]+t[3]).toUpperCase()),i.stopevents=!1)},onPrimary:function(){return this.trigger("onmodalresult",1),this.close(!0),!1}},Common.UI.ExtendedColorDialog||{}))}),void 0===Common&&(Common={}),define("common/main/lib/component/ThemeColorPalette",["common/main/lib/component/BaseView","common/main/lib/view/ExtendedColorDialog"],function(){"use strict";Common.UI.ThemeColorPalette=Common.UI.BaseView.extend(_.extend({options:{dynamiccolors:10,standardcolors:10,themecolors:10,columns:10,effects:5,hideEmptyColors:!0,allowReselect:!0,transparent:!1,value:"000000",enableKeyEvents:!0,colorHints:!0,keyMoveDirection:"both",storageSuffix:""},template:_.template('<div class="palette-inner"><% var me = this; var idx = 0; %><% $(colors).each(function(num, item) { %><% if (me.isBlankSeparator(item)) { %> <div class="palette-color-spacer"></div><% } else if (me.isSeparator(item)) { %> </div><div class="divider"></div><div style="padding: 12px;"><% } else if (me.isColor(item)) { %> <a class="palette-color color-<%=item%>" data-toggle="tooltip" style="background:#<%=item%>" idx="<%=idx++%>"><em><span style="background:#<%=item%>;" unselectable="on">&#160;</span></em></a><% } else if (me.isTransparent(item)) { %><a class="color-<%=item%>" data-toggle="tooltip" idx="<%=idx++%>"><em><span unselectable="on">&#160;</span></em></a><% } else if (me.isEffect(item)) { %><% if (idx>0 && me.columns>0 && idx%me.columns===0) { %> <div class="color-divider"></div><% } %><a effectid="<%=item.effectId%>" effectvalue="<%=item.effectValue%>" data-toggle="tooltip" class="palette-color-effect color-<%=item.color%>" style="background:#<%=item.color%>" idx="<%=idx++%>"><em><span style="background:#<%=item.color%>;" unselectable="on">&#160;</span></em></a><% } else if (me.isCaption(item)) { %><div class="palette-color-caption"><%=item%></div><% } %><% }); %></div><% if (me.options.dynamiccolors!==undefined) { %><div class="palette-color-dynamiccolors"><div class="palette-color-spacer"></div><div class="palette-color-caption"><%=me.textRecentColors%></div><% for (var i=0; i<me.options.dynamiccolors; i++) { %><a class="color-dynamic-<%=i%> dynamic-empty-color <%= me.emptyColorsClass %>" data-toggle="tooltip" color="" idx="<%=idx++%>"><em><span unselectable="on">&#160;</span></em></a><% } %><% } %></div>'),colorRe:/(?:^|\s)color-(.{6})(?:\s|$)/,selectedCls:"selected",initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);var e=this,t=e.$el||$(this.el);this.colors=e.options.colors||this.generateColorData(e.options.themecolors,e.options.effects,e.options.standardcolors,e.options.transparent),this.columns=e.options.columns||0,this.enableKeyEvents=e.options.enableKeyEvents,this.tabindex=e.options.tabindex||0,this.outerMenu=e.options.outerMenu,this.lastSelectedIdx=-1,this.emptyColorsClass=e.options.hideEmptyColors?"hidden":"",this.colorHints=e.options.colorHints,e.colorItems=[],"vertical"==e.options.keyMoveDirection?e.moveKeys=[Common.UI.Keys.UP,Common.UI.Keys.DOWN]:"horizontal"==e.options.keyMoveDirection?e.moveKeys=[Common.UI.Keys.LEFT,Common.UI.Keys.RIGHT]:e.moveKeys=[Common.UI.Keys.UP,Common.UI.Keys.DOWN,Common.UI.Keys.LEFT,Common.UI.Keys.RIGHT],t.addClass("theme-colorpalette"),this.render(),this.options.updateColorsArr&&this.updateColors(this.options.updateColorsArr[0],this.options.updateColorsArr[1]),this.options.value&&this.select(this.options.value,!0),this.options.outerMenu&&this.options.outerMenu.focusOnShow&&this.options.outerMenu.menu&&(t.addClass("focused"),this.options.outerMenu.menu.on("show:after",function(t){_.delay(function(){e.showLastSelected(),e.focus()},10)})),this.updateCustomColors(),t.closest(".btn-group").on("show.bs.dropdown",_.bind(this.updateCustomColors,this)),t.closest(".dropdown-submenu").on("show.bs.dropdown",_.bind(this.updateCustomColors,this)),t.on("click",_.bind(this.handleClick,this))},render:function(){this.$el.html(this.template({colors:this.colors}));var i=this,t=(this.moveKeys&&this.$el.find("a").each(function(t,e){i.colorItems.push({el:e,index:t})}),this.attachKeyEvents(),this.$el.closest(".asc-window"));return 0<t.length&&(this.tipZIndex=parseInt(t.css("z-index"))+10),this.colorHints&&(this.options.transparent&&this.createTip(this.$el.find("a.color-transparent"),this.textTransparent),this.options.themecolors||this.options.effects||this.updateHints("object"==typeof this.colorHints?this.colorHints:void 0),this.colorHints=!!this.colorHints),this},isBlankSeparator:function(t){return"string"==typeof t&&"-"==t},isSeparator:function(t){return"string"==typeof t&&"--"==t},isColor:function(t){return"string"==typeof t&&/[0-9A-F]{6}/.test(t)},isTransparent:function(t){return"string"==typeof t&&"transparent"==t},isCaption:function(t){return"string"==typeof t&&"-"!=t&&"--"!=t&&!/[0-9A-F]{6}|transparent/.test(t)},isEffect:function(t){return"object"==typeof t&&void 0!==t.effectId},getColor:function(){return this.value},updateCustomColors:function(){var t=this.$el||$(this.el);if(t){var e,i=0<=this.lastSelectedIdx?$(this.colorItems[this.lastSelectedIdx].el):t.find("a."+this.selectedCls),s=0<i.length&&/color-dynamic/.test(i[0].className)?i.attr("color"):void 0,o=(s&&(s=s.toUpperCase(),i.removeClass(this.selectedCls),this.lastSelectedIdx=-1),Common.localStorage.getItem("asc."+Common.localStorage.getId()+".colors.custom"+this.options.storageSuffix)),n=-1,a=(o=o?o.split(","):[]).length<this.options.dynamiccolors?o.length:this.options.dynamiccolors;for(this.options.hideEmptyColors&&this._layoutParams&&t.find(".dynamic-empty-color").length!==this.options.dynamiccolors-a&&(this._layoutParams=void 0);++n<a;)(e=t.find(".color-dynamic-"+n)).removeClass("dynamic-empty-color").removeClass(this.emptyColorsClass).attr("color",o[n]),e.find("span").css({"background-color":"#"+o[n]}),o[n]==s&&(e.addClass(this.selectedCls),this.lastSelectedIdx=parseInt(e.attr("idx")),s=void 0),this.colorHints&&this.createTip(e,Common.Utils.ThemeColor.getTranslation(Common.Utils.ThemeColor.getRgbColor(o[n]).asc_getName()));for(;n<this.options.dynamiccolors;)(e=t.find(".color-dynamic-"+n)).removeAttr("color"),e.addClass("dynamic-empty-color").addClass(this.emptyColorsClass),e.find("span").css({"background-color":"transparent"}),n++;t.find(".palette-color-dynamiccolors").toggleClass(this.emptyColorsClass,0===a)}},handleClick:function(t){var e,i,s=this,o=$(t.target).closest("a");if(0==o.length)return!1;o.hasClass("color-transparent")?(s.clearSelection(!0),o.addClass(s.selectedCls),t.suppressEvent||(s.lastSelectedIdx=parseInt(o.attr("idx")),s.value="transparent",s.trigger("select",s,"transparent"))):o[0].className.search("color-dynamic")<0?((!/^[a-fA-F0-9]{6}$/.test(s.value)||_.indexOf(s.colors,s.value)<0)&&(s.value=!1),s.clearSelection(!0),o.addClass(s.selectedCls),e=o[0].className.match(s.colorRe)[1],o.hasClass("palette-color-effect")?(i=parseInt(o.attr("effectid")),e&&!t.suppressEvent&&(s.value=e.toUpperCase(),s.trigger("select",s,{color:e,effectId:i}),s.lastSelectedIdx=parseInt(o.attr("idx")))):/#?[a-fA-F0-9]{6}/.test(e)&&(e=/#?([a-fA-F0-9]{6})/.exec(e)[1].toUpperCase())&&!t.suppressEvent&&(s.value=e,s.trigger("select",s,e),s.lastSelectedIdx=parseInt(o.attr("idx")))):/dynamic-empty-color/.test(o[0].className)?t.suppressEvent?(s.clearSelection(!0),o.addClass(s.selectedCls)):setTimeout(function(){s.addNewColor()},10):(s.clearSelection(!0),o.addClass(s.selectedCls),t.suppressEvent||(s.lastSelectedIdx=parseInt(o.attr("idx")),e=o.attr("color"),s.trigger("select",s,e),s.value=e.toUpperCase()))},setCustomColor:function(t){var e,i,s=this.$el||$(this.el);(t=/#?([a-fA-F0-9]{6})/.exec(t))&&(e=this.saveCustomColor(t[1]),this.clearSelection(!0),0==(i=s.find(".dynamic-empty-color")).length?(this.updateCustomColors(),i=s.find(".color-dynamic-"+(this.options.dynamiccolors-1))):e&&this.options.hideEmptyColors&&this._layoutParams&&(this._layoutParams=void 0),e&&(i.first().removeClass("dynamic-empty-color").removeClass(this.emptyColorsClass).addClass(this.selectedCls).attr("color",t[1]),i.first().find("span").css({"background-color":"#"+t[1]})),s.find(".palette-color-dynamiccolors").removeClass(this.emptyColorsClass),this.select(t[1],!0))},saveCustomColor:function(t){var e="asc."+Common.localStorage.getId()+".colors.custom"+this.options.storageSuffix,i=(i=Common.localStorage.getItem(e))?i.split(","):[],s=_.indexOf(i,t.toUpperCase());return s<0&&(i.push(t)>this.options.dynamiccolors&&i.shift(),Common.localStorage.setItem(e,i.join().toUpperCase())),s<0},addNewColor:function(t){var e=this,i=new Common.UI.ExtendedColorDialog({});i.on("onmodalresult",function(t){e._isdlgopen=!1,1==t&&(e.setCustomColor(i.getColor()),e.fireEvent("select",e,i.getColor())),e.fireEvent("close:extended",e,1==t)}),e._isdlgopen=!0,i.setColor(void 0!==e.value&&!1!==e.value?e.value:void 0!==t?t:"000000"),i.show()},isDialogOpen:function(){return 1==this._isdlgopen},select:function(t,e){var i,s,o=this.$el||$(this.el);this.clearSelection(),"object"==typeof t?void 0!==t.effectId?0<(i=o.find('a[effectid="'+t.effectId+'"]').first()).length?(i.addClass(this.selectedCls),this.lastSelectedIdx=parseInt(i.attr("idx")),this.value=i[0].className.match(this.colorRe)[1].toUpperCase()):this.value=!1:void 0!==t.effectValue&&(0<(i=o.find('a[effectvalue="'+t.effectValue+'"].color-'+t.color.toUpperCase()).first()).length?(i.addClass(this.selectedCls),this.lastSelectedIdx=parseInt(i.attr("idx")),this.value=i[0].className.match(this.colorRe)[1].toUpperCase()):this.value=!1):(/#?[a-fA-F0-9]{6}/.test(t)&&(t=/#?([a-fA-F0-9]{6})/.exec(t)[1].toUpperCase(),this.value=t),/^[a-fA-F0-9]{6}|transparent$/.test(t)&&0<=_.indexOf(this.colors,t)?(_.indexOf(this.colors,this.value)<0&&(this.value=!1),t==this.value&&!this.options.allowReselect||(s=("transparent"==t?o.find("a.color-transparent"):o.find("a.palette-color.color-"+t).first()).addClass(this.selectedCls),this.value=t,this.lastSelectedIdx=parseInt(s.attr("idx")),!0!==e&&this.fireEvent("select",this,t))):0<(s=0==(s=o.find("#"+t).first()).length?o.find('a[color="'+t+'"]').first():s).length&&(s.addClass(this.selectedCls),this.lastSelectedIdx=parseInt(s.attr("idx")),this.value=t.toUpperCase()))},selectByRGB:function(t,e){var i,s=this.$el||$(this.el),t=(this.clearSelection(!0),"object"==typeof t?t.color:t);/#?[a-fA-F0-9]{6}/.test(t)&&(t=/#?([a-fA-F0-9]{6})/.exec(t)[1].toUpperCase()),/^[a-fA-F0-9]{6}|transparent$/.test(t)&&(t!=this.value||this.options.allowReselect)&&(0<(i=0==(i=0==(i="transparent"==t?s.find("a.color-transparent"):s.find("a.color-"+t).first()).length?s.find("#"+t).first():i).length?s.find('a[color="'+t+'"]').first():i).length&&(i.addClass(this.selectedCls),this.lastSelectedIdx=parseInt(i.attr("idx")),this.value=t),!0!==e&&this.fireEvent("select",this,t))},updateColors:function(t,e,i){if(void 0!==t&&void 0!==e){for(var s,o=this,n=o.$el||$(this.el),a=(void 0===o.aColorElements&&(o.aColorElements=n.find("a.palette-color")),void 0===o.aEffectElements&&(o.aEffectElements=n.find("a.palette-color-effect")),0),l=0,r=0;r<o.colors.length;r++)"string"==typeof o.colors[r]&&/[0-9A-F]{6}/.test(o.colors[r])?a>=e.length||((s=$(o.aColorElements[a])).removeClass("color-"+o.colors[r]),o.colors[r]=e[a].color=e[a].color.toUpperCase(),s.addClass("color-"+o.colors[r]),s.css({background:"#"+o.colors[r]}),s.find("span").first().css({background:"#"+o.colors[r]}),o.colorHints&&o.createTip(s,e[a].tip),a++):"object"!=typeof o.colors[r]||void 0===o.colors[r].effectId||l>=t.length||(s=$(o.aEffectElements[l]),t[l].color=t[l].color.toUpperCase(),o.colors[r].color!==t[l].color&&(s.removeClass("color-"+o.colors[r].color),s.addClass("color-"+t[l].color),s.css({background:"#"+t[l].color}),s.find("span").first().css({background:"#"+t[l].color})),o.colors[r].effectId!==t[l].effectId&&s.attr("effectid",""+t[l].effectId),o.colors[r].effectValue!==t[l].effectValue&&s.attr("effectvalue",""+t[l].effectValue),o.colors[r]=t[l],o.colorHints&&o.createTip(s,t[l].tip),l++);i?this.select(i,!0):(i=n.find("a."+this.selectedCls)).length&&i.hasClass("palette-color-effect")&&(this.value=i[0].className.match(this.colorRe)[1].toUpperCase()),this.options.updateColorsArr=void 0}},createTip:function(t,e){var i=this.tipZIndex,s=(void 0===t.attr("color-name")&&t.one("mouseenter",function(t){t=$(t.currentTarget);t.tooltip({title:t.attr("color-name"),placement:"cursor",zIndex:i}),t.mouseenter()}),t.data("bs.tooltip"));s&&s.updateTitle(e),t.attr("color-name",e||"")},clearSelection:function(t){this.$el.find("a."+this.selectedCls).removeClass(this.selectedCls),t||(this.value=void 0,this.lastSelectedIdx=-1)},showLastSelected:function(){this.selectByIndex(this.lastSelectedIdx,!0)},getSelectedColor:function(){var t=(this.$el||$(this.el)).find("a."+this.selectedCls).attr("idx");return void 0!==t?this.colorItems[parseInt(t)]:null},selectByIndex:function(t,e){this.clearSelection(!0),0<=t&&t<this.colorItems.length&&this.handleClick({target:this.colorItems[t].el,suppressEvent:e})},generateColorData:function(t,e,i,s){var o=[],n=0<t&&0<e?t*e:0;if(0<t){for(var o=[this.textThemeColors],a=0;a<t;a++)o.push({color:"FFFFFF",effectId:1});0<e&&o.push("-");for(a=0;a<n;a++)o.push({color:"FFFFFF",effectId:1});i&&o.push("-")}if(i){o.push(this.textStandartColors),s&&(o.push("transparent"),i--);for(a=0;a<i;a++)o.push("FFFFFF")}return o},onKeyDown:function(t,e){if(void 0===e&&(e=t),-1<_.indexOf(this.moveKeys,e.keyCode)||e.keyCode==Common.UI.Keys.RETURN){e.preventDefault(),e.stopPropagation();t=this.getSelectedColor();if(e.keyCode==Common.UI.Keys.RETURN)t&&this.selectByIndex(t.index),this.outerMenu&&this.outerMenu.menu&&this.outerMenu.menu.hide();else{if((o=t?t.index:-1)<0)o=0;else if("both"==this.options.keyMoveDirection){void 0===this._layoutParams&&this.fillIndexesArray();var i=this.colorItems[o].topIdx,s=this.colorItems[o].leftIdx,o=void 0;if(e.keyCode==Common.UI.Keys.LEFT)for(;void 0===o;)--s<0&&(s=this._layoutParams.columns-1),o=this._layoutParams.itemsIndexes[i][s];else if(e.keyCode==Common.UI.Keys.RIGHT)for(;void 0===o;)++s>this._layoutParams.columns-1&&(s=0),o=this._layoutParams.itemsIndexes[i][s];else if(e.keyCode==Common.UI.Keys.UP)if(0==i&&this.outerMenu&&this.outerMenu.menu)this.clearSelection(!0),this.outerMenu.menu.focusOuter(e,this.outerMenu.index);else for(;void 0===o;)--i<0&&(i=this._layoutParams.rows-1),o=this._layoutParams.itemsIndexes[i][s];else if(i==this._layoutParams.rows-1&&this.outerMenu&&this.outerMenu.menu)this.clearSelection(!0),this.outerMenu.menu.focusOuter(e,this.outerMenu.index);else for(;void 0===o;)++i>this._layoutParams.rows-1&&(i=0),o=this._layoutParams.itemsIndexes[i][s]}else o=e.keyCode==Common.UI.Keys.UP||e.keyCode==Common.UI.Keys.LEFT?Math.max(0,o-1):Math.min(this.colorItems.length-1,o+1);void 0!==o&&0<=o&&(this._fromKeyDown=!0,this.selectByIndex(o,!0),this._fromKeyDown=!1)}}},fillIndexesArray:function(){if(!(this.colorItems.length<=0)){this._layoutParams={itemsIndexes:[],columns:0,rows:0};for(var t=$(this.colorItems[0].el),e=t.outerWidth()+parseInt(t.css("margin-left"))+parseInt(t.css("margin-right")),i=this.$el.offset().left,s=t.offset().top,o=-1,n=0,a=0;a<this.colorItems.length;a++){var l=$(this.colorItems[a].el).offset().top-s,r=Math.floor(($(this.colorItems[a].el).offset().left-i)/e);o<l&&(o=l,this._layoutParams.itemsIndexes.push([]),n=this._layoutParams.itemsIndexes.length-1),this._layoutParams.itemsIndexes[n][r]=a,this.colorItems[a].topIdx=n,this.colorItems[a].leftIdx=r,this._layoutParams.columns<r&&(this._layoutParams.columns=r)}this._layoutParams.rows=this._layoutParams.itemsIndexes.length,this._layoutParams.columns++}},attachKeyEvents:function(){var t;this.enableKeyEvents&&((t=this.$el||$(this.el)).addClass("canfocused"),t.attr("tabindex",this.tabindex.toString()),t.on("keydown",_.bind(this.onKeyDown,this)))},focus:function(t){var e=this.$el||$(this.el);e&&e.focus(),"string"==typeof t?"first"==t?this.selectByIndex(0,!0):"last"==t&&(void 0===this._layoutParams&&this.fillIndexesArray(),this.selectByIndex(this._layoutParams.itemsIndexes[this._layoutParams.rows-1][0],!0)):void 0!==t&&this.selectByIndex(t,!0)},focusInner:function(t){this.focus(t.keyCode==Common.UI.Keys.DOWN?"first":"last")},updateHints:function(i){var s;this.colorHints&&((s=this).$el||$(s.el)).find("a.palette-color").each(function(t,e){i&&i[t]?s.createTip($(e),i[t]):(t=e.className.match(s.colorRe)[1],s.createTip($(e),Common.Utils.ThemeColor.getTranslation(Common.Utils.ThemeColor.getRgbColor(t).asc_getName())))})},textThemeColors:"Theme Colors",textStandartColors:"Standard Colors",textRecentColors:"Recent Colors",textTransparent:"Transparent"},Common.UI.ThemeColorPalette||{}))}),void 0===Common&&(Common={}),define("common/main/lib/component/ColorButton",["common/main/lib/component/Button","common/main/lib/component/ThemeColorPalette"],function(){"use strict";Common.UI.ButtonColored=Common.UI.Button.extend(_.extend({render:function(t){Common.UI.Button.prototype.render.call(this,t),/huge/.test(this.options.cls)&&!0===this.options.split&&!this.options.hideColorLine?(t=$("button",this.cmpEl),(t=$(t[1]))&&t.append($('<div class="btn-color-value-line"></div>'))):this.options.hideColorLine||$("button:first-child",this.cmpEl).append($('<div class="btn-color-value-line"></div>')),this.colorEl=this.cmpEl.find(".btn-color-value-line"),this.options.auto&&(this.autocolor="object"==typeof this.options.auto&&this.options.auto.color||"000000"),void 0!==this.options.color&&this.setColor(this.options.color)},getPicker:function(t,e){return this.colorPicker||(e={el:this.cmpEl.find("#"+this.menu.id+"-color-menu"),value:t,colors:e},void 0!==this.options.transparent&&(e.transparent=this.options.transparent),void 0!==this.options.hideEmptyColors&&(e.hideEmptyColors=this.options.hideEmptyColors),void 0!==this.options.themecolors&&(e.themecolors=this.options.themecolors),void 0!==this.options.effects&&(e.effects=this.options.effects),void 0!==this.options.colorHints&&(e.colorHints=this.options.colorHints),this.colorPicker=new Common.UI.ThemeColorPalette(e),this.colorPicker.on("select",_.bind(this.onColorSelect,this)),this.colorPicker.on("close:extended",_.bind(this.onCloseExtentedColor,this)),this.cmpEl.find("#"+this.menu.id+"-color-new").on("click",_.bind(this.addNewColor,this)),this.options.auto&&(this.cmpEl.find("#"+this.menu.id+"-color-auto").on("click",_.bind(this.onAutoColorSelect,this)),this.colorAuto=this.cmpEl.find("#"+this.menu.id+"-color-auto > a"),"auto"==t&&this.setAutoColor(!0)),this.options.eyeDropper&&this.cmpEl.find("#"+this.menu.id+"-eyedropper").on("click",_.bind(this.onEyedropperStart,this)),this.initInnerMenu()),this.colorPicker},setPicker:function(t){this.colorPicker=t},getMenu:function(e){var t,i,s,o,n;return"object"!=typeof this.menu?(t=(e=e||this.options).paletteHeight?e.paletteHeight+"px":"auto",i=Common.UI.getId(),o=[],s=[],e.auto&&(this.autocolor="object"==typeof e.auto&&e.auto.color||"000000",o.push({id:i+"-color-auto",caption:"object"==typeof e.auto&&e.auto.caption||this.textAutoColor,template:_.template('<a tabindex="-1" type="menuitem"><span class="menu-item-icon color-auto" style="background-color: #'+this.autocolor+';"></span><%= caption %></a>')}),o.push({caption:"--"})),e.eyeDropper&&s.push({id:i+"-eyedropper",caption:this.textEyedropper,iconCls:"menu__icon btn-eyedropper"}),o=new Common.UI.Menu({id:i,cls:"color-menu "+(e.eyeDropper?"shifted-right":"shifted-left"),additionalAlign:e.additionalAlign,items:(e.additionalItems||[]).concat(o).concat([{template:_.template('<div id="'+i+'-color-menu" style="width: 164px; height:'+t+'; display: inline-block;"></div>')},{caption:"--"}]).concat(s).concat([{id:i+"-color-new",template:_.template('<a tabindex="-1" type="menuitem" style="">'+this.textNewColor+"</a>")}])}),this.initInnerMenu(),n=this,o.on("keydown:before",_.bind(this.onBeforeKeyDown,this)),o.on("show:after",function(t){n.colorPicker&&_.delay(function(){n.colorPicker.showLastSelected(),e.additionalItems||e.auto||n.colorPicker.focus()},10)}).on("hide:after",function(){n.options.takeFocusOnClose&&setTimeout(function(){n.focus()},1)}),o):this.menu},initInnerMenu:function(){var t;this.colorPicker&&"object"==typeof this.menu&&(t=(this.options.additionalItems||[]).length+(this.options.auto?2:0),this.colorPicker.outerMenu={menu:this.menu,index:t},this.menu.setInnerMenu([{menu:this.colorPicker,index:t}]))},setMenu:function(t,e){t=t||this.getMenu(),Common.UI.Button.prototype.setMenu.call(this,t),e||this.getPicker(this.options.color,this.options.colors)},onColorSelect:function(t,e){this.setColor(e),this.setAutoColor(!1),this.trigger("color:select",this,e)},onCloseExtentedColor:function(t,e){var i;this.options.takeFocusOnClose&&(i=this,setTimeout(function(){i.focus()},1))},setColor:function(t){"auto"==t&&this.options.auto&&(t=this.autocolor),this.color=t,this.colorEl&&(this.colorEl.css({"background-color":"transparent"==t?t:"object"==typeof t?"#"+t.color:"#"+t}),this.colorEl.toggleClass("bordered","transparent"==t))},setAutoColor:function(t){this.colorAuto&&(t&&!this.colorAuto.hasClass("selected")?this.colorAuto.addClass("selected"):!t&&this.colorAuto.hasClass("selected")&&this.colorAuto.removeClass("selected"))},isAutoColor:function(){return this.colorAuto&&this.colorAuto.hasClass("selected")},onAutoColorSelect:function(){this.setColor("auto"),this.setAutoColor(!0),this.colorPicker&&this.colorPicker.clearSelection(),this.trigger("auto:select",this,this.autocolor)},addNewColor:function(){this.colorPicker&&this.colorPicker.addNewColor(("object"==typeof this.color?this.color:this).color)},onEyedropperStart:function(){Common.NotificationCenter.trigger("eyedropper:start"),this.trigger("eyedropper:start",this)},eyedropperEnd:function(t,e,i){void 0!==t&&(t=Common.Utils.ThemeColor.getHexColor(t,e,i),this.colorPicker.setCustomColor("#"+t),this.onColorSelect(this.colorPicker,t),this.trigger("eyedropper:end",this))},onBeforeKeyDown:function(t,e){if((e.keyCode==Common.UI.Keys.DOWN||e.keyCode==Common.UI.Keys.SPACE)&&!this.isMenuOpen())return $("button",this.cmpEl).click(),!1},isMenuOpen:function(){return this.cmpEl.hasClass("open")},focus:function(){$("button",this.cmpEl).focus()},textNewColor:"Add New Custom Color",textAutoColor:"Automatic",textEyedropper:"Eyedropper"},Common.UI.ButtonColored||{})),Common.UI.ColorButton=Common.UI.ButtonColored.extend(_.extend({options:{id:null,hint:!1,enableToggle:!1,allowDepress:!1,toggleGroup:null,cls:"",iconCls:"",caption:"",menu:null,disabled:!1,pressed:!1,split:!1,visible:!0},template:_.template(['<div class="btn-group" id="<%= id %>">','<button type="button" class="btn btn-color dropdown-toggle <%= cls %>" data-toggle="dropdown" style="<%= style %>" data-hint="<%= dataHint %>" data-hint-direction="<%= dataHintDirection %>" data-hint-offset="<%= dataHintOffset %>">',"<span>&nbsp;</span>",'<span class="inner-box-caret">','<i class="caret"></i>',"</span>","</button>","</div>"].join("")),initialize:function(e){var i;e.menu||!1===e.menu||(e.menu=(i=this).getMenu(e),i.on("render:after",function(t){i.getPicker(e.color,e.colors)})),Common.UI.Button.prototype.initialize.call(this,e)},render:function(t){Common.UI.Button.prototype.render.call(this,t),this.options.auto&&(this.autocolor="object"==typeof this.options.auto&&this.options.auto.color||"000000"),void 0!==this.options.color&&this.setColor(this.options.color)},setColor:function(t){"auto"==t&&this.options.auto&&(t=this.autocolor);var e=$(this.cmpEl).find("button span:nth-child(1)");this.color=t,e.toggleClass("color-transparent","transparent"==t),e.css({"background-color":"transparent"==t?t:"object"==typeof t?"#"+t.color:"#"+t})},focus:function(){$("button",this.cmpEl).focus()}},Common.UI.ColorButton||{}))}),!function(e){var n=1,a=2,t=3,i=4,s=5,o=6,l=7,r=8,c=9,d=10,U=11,L=12,B=13,H=14,O=15,N=16,$=17,G=18,z=19,W=20,j=21,q=22,K=23,Y=24,X=25,J=26,Z=27,Q=28,tt=29,et=30,it=31,st=32,ot=33,nt=34,at=35,lt=36,rt=37,ct=38,dt=39,ht=40,pt=41,mt=42,ut=43,gt=44,bt=45,Ct=46,ft=47,St=48,vt=49,wt=50,_t=51,xt=52,yt=53,At=54,Tt=55,kt=56,Et=57,It=58,Dt=59,Vt=60,Pt=61,Ft=62,Mt=63,Rt=64,Ut=65,Lt=66,Bt=67,Ht=68,Ot=69,Nt=70,$t=71,Gt=72,zt=73,Wt=74,jt=75,qt=76,Kt=77,Yt=78,Xt=79,Jt=80,Zt=81,Qt=82,te=83,ee=84,ie=85,se=86,oe=87,ne=88,ae=89,le=90,re=91,ce=92,de=93,he=94,pe=95,me=96,ue=97,ge=98,be=99,Ce=100,fe=101,Se=102,ve=103,we=104,_e=105,xe=106,ye=107,Ae=108,Te=109,ke=110,Ee=111,Ie=112,De=113,Ve=114,Pe=115,Fe=116,Me=117,h=118,Re=119,Ue=120,Le=121,Be=122,He=123,Oe=124,Ne=125,$e=126,Ge=127,ze=128,We=129,je=130,qe=131,Ke=132,Ye=133,Xe=134,Je=135,Ze=136,Qe=137,ti=138,ei=139,ii=140,si=141,oi=142,ni=143,ai=144,li=145,ri=146,ci=147,di=148,hi=149,pi=150,mi=151,ui=152,gi=153,bi=154,Ci=155,fi=156,Si=157,vi=158,wi=159,_i=160,xi=161,yi=162,Ai=163,Ti=164,ki=165,Ei=166,Ii=167,Di=168,Vi=169,Pi=170,Fi=171,Mi=172,Ri=173,Ui=174,Li=175,Bi=176,Hi=177,Oi=178,Ni=179,$i=180,Gi=181,zi=182,Wi=183,ji=184,qi=185,Ki=186,Yi=187,Xi=188,Ji=189,Zi=190,Qi=191,ts=192,es=193,is=194,ss=195,os=196,ns=197,as=198,ls=199,rs=200,cs=201,ds=202,hs=203,ps=204,ms=205,us=206,gs=207,bs=208,Cs=209,fs=210,Ss=211,vs=212,ws=213,_s=214,xs=215,ys=216,As=217,Ts=218,ks=219,Es=220,Is=221,Ds=222,Vs=223,Ps=224,Fs=225,Ms=226,Rs=227,Us=228,Ls=229,Bs=230,Hs=231,Os=232,Ns=233,$s=234,Gs=235,zs=236,Ws=237,js=238,qs=239,Ks=240,Ys=241,Xs=242,Js=243,Zs=244,Qs=245,to=246,eo=247,io=248,so=249,oo=250,no=251,ao=252,lo=253,ro=254,co=255,ho=256,po=257,mo=258,uo=259,go=260,bo=261,Co=262,fo=263,So=264,vo=265,wo=266,_o=267,xo=268,yo=269,Ao=270,To=271,ko=272,Eo=273,p=0,m=1,u=2,Io=3,g=4,b=5,C=6,f=7,Do=8,Vo=16,S=17,v=18,w=19,_=20,x=30,y=19,Po=21,A=29,T={Basic_Latin:0,Latin_1_Supplement:1,Latin_Extended_A:2,Latin_Extended_B:3,IPA_Extensions:4,Spacing_Modifier_Letters:5,Combining_Diacritical_Marks:6,Greek_and_Coptic:7,Coptic:8,Cyrillic:9,Armenian:10,Hebrew:11,Vai:12,Arabic:13,NKo:14,Devanagari:15,Bengali:16,Gurmukhi:17,Gujarati:18,Oriya:19,Tamil:20,Telugu:21,Kannada:22,Malayalam:23,Thai:24,Lao:25,Georgian:26,Balinese:27,Hangul_Jamo:28,Latin_Extended_Additional:29,Greek_Extended:30,General_Punctuation:31},k={Superscripts_And_Subscripts:0,Currency_Symbols:1,Combining_Diacritical_Marks_For_Symbols:2,Letterlike_Symbols:3,Number_Forms:4,Arrows:5,Mathematical_Operators:6,Miscellaneous_Technical:7,Control_Pictures:8,Optical_Character_Recognition:9,Enclosed_Alphanumerics:10,Box_Drawing:11,Block_Elements:12,Geometric_Shapes:13,Miscellaneous_Symbols:14,Dingbats:15,CJK_Symbols_And_Punctuation:16,Hiragana:17,Katakana:18,Bopomofo:19,Hangul_Compatibility_Jamo:20,Phags_pa:21,Enclosed_CJK_Letters_And_Months:22,CJK_Compatibility:23,Hangul_Syllables:24,Non_Plane:25,Phoenician:26,CJK_Unified_Ideographs:27,Private_Use_Area_plane_0:28,CJK_Strokes:29,Alphabetic_Presentation_Forms:30,Arabic_Presentation_Forms_A:31},E={Combining_Half_Marks:0,Vertical_Forms:1,Small_Form_Variants:2,Arabic_Presentation_Forms_B:3,Halfwidth_And_Fullwidth_Forms:4,Specials:5,Tibetan:6,Syriac:7,Thaana:8,Sinhala:9,Myanmar:10,Ethiopic:11,Cherokee:12,Unified_Canadian_Aboriginal_Syllabics:13,Ogham:14,Runic:15,Khmer:16,Mongolian:17,Braille_Patterns:18,Yi_Syllables:19,Tagalog:20,Old_Italic:21,Gothic:22,Deseret:23,Byzantine_Musical_Symbols:24,Mathematical_Alphanumeric_Symbols:25,Private_Use_plane_15:26,Variation_Selectors:27,Tags:28,Limbu:29,Tai_Le:30,New_Tai_Lue:31},Fo=1,Mo=2,Ro=3,Uo=4,I=5,Lo=6,Bo=7,Ho=8,Oo=9,No=10,$o=11,Go=12,D=14,V=16,zo=17,Wo=18,jo=19,qo=20,Ko=21,Yo=22,Xo=23,Jo=24,P=25,F=26;function M(t,e,i,s,o){this.Start=t,this.End=e,this.Name=i,this.Lid=s,this.Param=o}var R=[new M(32,126,n,1033,[1<<T.Basic_Latin,0,0,0,1<<p,0]),new M(160,255,a,0,[1<<T.Basic_Latin|1<<T.Latin_1_Supplement,0,0,0,1<<p,0]),new M(256,383,t,0,[1<<T.Basic_Latin|1<<T.Latin_Extended_A,0,0,0,1<<p|1<<m|1<<g|1<<f,0]),new M(384,591,i,0,[1<<T.Basic_Latin|1<<T.Latin_Extended_B,0,0,0,1<<p|1<<m|1<<g|1<<f,0]),new M(592,687,s,0,[1<<T.IPA_Extensions,0,0,0,0,0]),new M(688,767,o,0,[1<<T.Spacing_Modifier_Letters,0,0,0,0,0]),new M(768,879,l,0,[1<<T.Combining_Diacritical_Marks,0,0,0,0,0]),new M(880,1023,r,1032,[1<<T.Greek_and_Coptic,0,0,0,1<<Io,0]),new M(1024,1279,c,1049,[1<<T.Cyrillic,0,0,0,1<<u,0]),new M(1280,1327,d,0,[1<<T.Cyrillic,0,0,0,1<<u,0]),new M(1328,1423,U,1067,[1<<T.Armenian,0,0,0,0,0]),new M(1424,1535,L,1037,[1<<T.Hebrew,0,0,0,1<<b,1<<Po]),new M(1536,1791,B,1,[1<<T.Arabic,0,0,0,1<<C,1<<y|1<<A]),new M(1792,1871,H,1114,[1<<T.Arabic,0,0,0,1<<C,1<<y|1<<A]),new M(1872,1919,O,1,[1<<T.Arabic,0,0,0,1<<C,1<<y|1<<A]),new M(1920,1983,N,1125,[1<<T.Arabic,0,0,0,1<<C,1<<y|1<<A]),new M(1984,2047,$,0,[1<<T.NKo,0,0,0,0,0]),new M(2048,2111,G,0,[1<<T.Hebrew,0,0,0,1<<b,0]),new M(2112,2143,z,0,[1<<T.Arabic,0,0,0,1<<C,1<<y|1<<A]),new M(2208,2303,W,1,[1<<T.Arabic,0,0,0,1<<C,1<<y|1<<A]),new M(2304,2431,j,1081,[1<<T.Devanagari,0,0,0,0,0]),new M(2432,2559,q,1093,[1<<T.Bengali,0,0,0,0,0]),new M(2560,2687,K,1094,[1<<T.Gurmukhi,0,0,0,0,0]),new M(2688,2815,Y,1095,[1<<T.Gujarati,0,0,0,0,0]),new M(2816,2943,X,1096,[1<<T.Oriya,0,0,0,0,0]),new M(2944,3071,J,1097,[1<<T.Tamil,0,0,0,0,0]),new M(3072,3199,Z,1098,[1<<T.Telugu,0,0,0,0,0]),new M(3200,3327,Q,1099,[1<<T.Kannada,0,0,0,0,0]),new M(3328,3455,tt,1100,[1<<T.Malayalam,0,0,0,0,0]),new M(3456,3583,et,1115,[0,0,1<<E.Sinhala,0,0,0]),new M(3584,3711,it,1054,[1<<T.Thai,0,0,0,1<<Vo,0]),new M(3712,3839,st,1108,[1<<T.Lao,0,0,0,0,0]),new M(3840,4095,ot,2129,[0,0,1<<E.Tibetan,0,0,0]),new M(4096,4255,nt,1109,[0,0,1<<E.Myanmar,0,0,0]),new M(4256,4351,at,1079,[1<<T.Georgian,0,0,0,0,0]),new M(4352,4607,lt,1042,[1<<T.Hangul_Jamo,0,0,0,1<<w,0]),new M(4608,4991,rt,1138,[0,0,1<<E.Ethiopic,0,0,0]),new M(4992,5023,ct,0,[0,0,1<<E.Ethiopic,0,0,0]),new M(5024,5119,dt,1116,[0,0,1<<E.Cherokee,0,0,0]),new M(5120,5759,ht,1117,[0,0,1<<E.Unified_Canadian_Aboriginal_Syllabics,0,0,0]),new M(5760,5791,pt,0,[0,0,1<<E.Ogham,0,0,0]),new M(5792,5887,mt,0,[0,0,1<<E.Runic,0,0,0]),new M(5888,5919,ut,1124,[0,0,1<<E.Tagalog,0,0,0]),new M(5920,5951,gt,1124,[0,0,1<<E.Tagalog,0,0,0]),new M(5952,5983,bt,1124,[0,0,1<<E.Tagalog,0,0,0]),new M(5984,6015,Ct,1124,[0,0,1<<E.Tagalog,0,0,0]),new M(6016,6143,ft,1107,[0,0,1<<E.Khmer,0,0,0]),new M(6144,6319,St,1104,[0,0,1<<E.Mongolian,0,0,0]),new M(6320,6399,vt,1117,[0,0,1<<E.Unified_Canadian_Aboriginal_Syllabics,0,0,0]),new M(6400,6479,wt,0,[0,0,1<<E.Limbu,0,0,0]),new M(6480,6527,_t,0,[0,0,1<<E.Tai_Le,0,0,0]),new M(6528,6623,xt,0,[0,0,1<<E.New_Tai_Lue,0,0,0]),new M(6624,6655,yt,1107,[0,0,1<<E.Khmer,0,0,0]),new M(6656,6687,At,0,[0,0,1<<E.Buginese,0,0,0]),new M(6688,6831,Tt,1054,[0,0,1<<E.Tai_Le,0,0,0]),new M(6832,6911,kt,0,[1<<T.Combining_Diacritical_Marks,0,0,0,0,0]),new M(6912,7039,Et,1057,[1<<T.Balinese,0,0,0,0,0]),new M(7040,7103,It,1057,[0,0,0,1<<V,0,0]),new M(7104,7167,Dt,1057,[]),new M(7168,7247,Vt,0,[0,0,0,1<<zo,0,0]),new M(7248,7295,Pt,0,[0,0,0,1<<Wo,0,0]),new M(7296,7311,Ft,0,[1<<T.Cyrillic,0,0,0,0,0]),new M(7360,7375,Mt,0,[0,0,0,1<<V,0,0]),new M(7376,7423,Rt,0,[]),new M(7424,7551,Ut,0,[1<<T.IPA_Extensions,0,0,0,0,0]),new M(7552,7615,Lt,0,[1<<T.IPA_Extensions,0,0,0,0,0]),new M(7616,7679,Bt,0,[1<<T.Combining_Diacritical_Marks,0,0,0,0,0]),new M(7680,7935,Ht,0,[1<<T.Latin_Extended_Additional,0,0,0,1<<Do,0]),new M(7936,8191,Ot,0,[1<<T.Greek_Extended,0,0,0,0,0]),new M(8192,8303,Nt,0,[1<<T.Punctuation,0,0,0,0,0]),new M(8304,8351,$t,0,[0,1<<k.Superscripts_And_Subscripts,0,0,0,0]),new M(8352,8399,Gt,0,[0,1<<k.Currency_Symbols,0,0,0,0]),new M(8400,8447,zt,0,[0,1<<k.Combining_Diacritical_Marks_For_Symbols,0,0,0,0]),new M(8448,8527,Wt,0,[0,1<<k.Letterlike_Symbols,0,0,0,0]),new M(8528,8591,jt,0,[0,1<<k.Number_Forms,0,0,0,0]),new M(8592,8703,qt,0,[0,1<<k.Arrows,0,0,0,0]),new M(8704,8959,Kt,0,[0,1<<k.Mathematical_Operators,0,0,0,0]),new M(8960,9215,Yt,0,[0,1<<k.Miscellaneous_Technical,0,0,0,0]),new M(9216,9279,Xt,0,[0,1<<k.Control_Pictures,0,0,0,0]),new M(9280,9311,Jt,0,[0,1<<k.Optical_Character_Recognition,0,0,0,0]),new M(9312,9471,Zt,0,[0,1<<k.Enclosed_Alphanumerics,0,0,0,0]),new M(9472,9599,Qt,0,[0,1<<k.Box_Drawing,0,0,0,0]),new M(9600,9631,te,0,[0,1<<k.Block_Elements,0,0,0,0]),new M(9632,9727,ee,0,[0,1<<k.Geometric_Shapes,0,0,0,0]),new M(9728,9983,ie,0,[0,1<<k.Miscellaneous_Symbols,0,0,0,0]),new M(9984,10175,se,0,[0,1<<k.Dingbats,0,0,0,0]),new M(10176,10223,oe,0,[0,1<<k.Mathematical_Operators,0,0,0,0]),new M(10224,10239,ne,0,[0,1<<k.Arrows,0,0,0,0]),new M(10240,10495,ae,0,[0,0,1<<E.Braille_Patterns,0,0,0]),new M(10496,10623,le,0,[0,1<<k.Arrows,0,0,0,0]),new M(10624,10751,re,0,[0,1<<k.Mathematical_Operators,0,0,0,0]),new M(10752,11007,ce,0,[0,1<<k.Mathematical_Operators,0,0,0,0]),new M(11008,11263,de,0,[0,1<<k.Arrows,0,0,0,0]),new M(11264,11359,he,0,[0,0,0,1<<k.Glagolitic,0,0]),new M(11360,11391,pe,0,[1<<T.Latin_Extended_Additional,0,0,0,0,0]),new M(11392,11519,me,0,[1<<T.Coptic,0,0,0,0,0]),new M(11520,11567,ue,0,[1<<T.Georgian,0,0,0,0,0]),new M(11568,11647,ge,0,[0,0,0,1<<Mo,0,0]),new M(11648,11743,be,0,[0,0,1<<E.Ethiopic,0,0,0]),new M(11744,11775,Ce,0,[1<<T.Cyrillic,0,0,0,1<<u,0]),new M(11776,11903,fe,0,[1<<T.General_Punctuation,0,0,0,0,0]),new M(11904,12031,Se,0,[0,1<<k.CJK_Unified_Ideographs,0,0,0,0]),new M(12032,12255,ve,0,[0,1<<k.CJK_Unified_Ideographs,0,0,0,0]),new M(12272,12287,we,0,[0,1<<k.CJK_Unified_Ideographs,0,0,0,0]),new M(12288,12351,_e,0,[0,1<<k.CJK_Symbols_And_Punctuation,0,0,1<<S|1<<x,0]),new M(12352,12447,xe,1041,[0,1<<k.Hiragana,0,0,0,0]),new M(12448,12543,ye,1041,[0,1<<k.Katakana,0,0,0,0]),new M(12544,12591,Ae,0,[0,1<<k.Bopomofo,0,0,0,0]),new M(12592,12687,Te,0,[0,1<<k.Hangul_Compatibility_Jamo,0,0,1<<w,0]),new M(12688,12703,ke,2052,[0,1<<k.CJK_Unified_Ideographs,0,0,0,0]),new M(12704,12735,Ee,0,[0,1<<k.Bopomofo,0,0,0,0]),new M(12736,12783,Ie,0,[0,1<<k.CJK_Strokes,0,0,0,0]),new M(12784,12799,De,0,[0,1<<k.Katakana,0,0,0,0]),new M(12800,13055,Ve,0,[0,1<<k.Enclosed_CJK_Letters_And_Months,0,0,0,0]),new M(13056,13311,Pe,0,[0,1<<k.CJK_Compatibility,0,0,0,0]),new M(13312,19903,Fe,0,[0,1<<k.CJK_Unified_Ideographs,0,0,1<<v|1<<_,0]),new M(19904,19967,Me,0,[0,0,0,1<<Ro,1<<v|1<<_,0]),new M(19968,40959,h,0,[0,1<<k.CJK_Unified_Ideographs,0,0,1<<v|1<<_|1<<S|1<<x,0]),new M(40960,42127,Re,0,[0,0,1<<E.Yi_Syllables,0,0,0]),new M(42128,42191,Ue,0,[0,0,1<<E.Yi_Radicals,0,0,0]),new M(42192,42239,Le,0,[]),new M(42240,42559,Be,0,[1<<T.Vai,0,0,0,0,0]),new M(42560,42655,He,0,[1<<T.Cyrillic,0,0,0,1<<u,0]),new M(42656,42751,Oe,0,[]),new M(42752,42783,Ne,0,[1<<T.Spacing_Modifier_Letters,0,0,0,0,0]),new M(42784,43007,$e,0,[1<<T.Latin_Extended_Additional,0,0,0,0,0]),new M(43008,43055,Ge,0,[0,0,0,1<<Uo,0,0]),new M(43056,43071,ze,0,[]),new M(43072,43135,We,0,[0,1<<k.Phags_pa,0,0,0,0]),new M(43136,43231,je,0,[0,0,0,1<<jo,0,0]),new M(43232,43263,qe,0,[1<<T.Devanagari,0,0,0,0,0]),new M(43264,43311,Ke,0,[0,0,0,1<<qo,0,0]),new M(43312,43359,Ye,0,[0,0,0,1<<Ko,0,0]),new M(43360,43391,Xe,0,[1<<T.Hangul_Jamo,0,0,0,0,0]),new M(43392,43487,Je,1057,[]),new M(43488,43519,Ze,0,[0,0,1<<E.Myanmar,0,0,0]),new M(43520,43615,Qe,0,[0,0,0,1<<Yo,0,0]),new M(43616,43647,ti,0,[0,0,1<<E.Myanmar,0,0,0]),new M(43648,43743,ei,0,[]),new M(43744,43775,ii,0,[]),new M(43776,43823,si,0,[]),new M(43824,43887,oi,0,[1<<T.Latin_Extended_Additional,0,0,0,0,0]),new M(43888,43967,ni,0,[]),new M(43968,44031,ai,0,[]),new M(44032,55215,li,0,[0,1<<k.Hangul_Syllables,0,0,1<<w,0]),new M(55216,55295,ri,0,[1<<T.Hangul_Jamo,0,0,0,0,0]),new M(55296,56191,ci,0,[]),new M(56192,56319,di,0,[]),new M(56320,57343,hi,0,[]),new M(57344,63743,pi,0,[0,1<<k.Private_Use_Area_plane_0,0,0,0,0]),new M(63744,64255,mi,0,[0,1<<k.CJK_Compatibility_Ideographs,0,0,1<<v|1<<_,0]),new M(64256,64335,ui,0,[0,1<<k.Alphabetic_Presentation_Forms,0,0,0,0]),new M(64336,65023,gi,0,[0,1<<k.Arabic_Presentation_Forms_A,0,0,1<<C,1<<y|1<<A]),new M(65024,65039,bi,0,[0,0,1<<E.Variation_Selectors,0,0,0]),new M(65040,65055,Ci,0,[0,0,1<<E.Vertical_Forms,0,0,0]),new M(65056,65071,fi,0,[0,0,1<<E.Combining_Half_Marks,0,0,0]),new M(65072,65103,Si,0,[0,0,1<<E.Vertical_Forms,0,0,0]),new M(65104,65135,vi,0,[0,0,1<<E.Small_Form_Variants,0,0,0]),new M(65136,65279,wi,0,[0,0,1<<E.Arabic_Presentation_Forms_B,0,1<<C,1<<y|1<<A]),new M(65280,65519,_i,0,[0,0,1<<E.Halfwidth_And_Fullwidth_Forms,0,1<<w|1<<v|1<<_|1<<S|1<<x,0]),new M(65520,65535,xi,0,[0,0,1<<E.Specials,0,0,0]),new M(65536,65663,yi,0,[0,0,0,1<<I,0,0]),new M(65664,65791,Ai,0,[0,0,0,1<<I,0,0]),new M(65792,65855,Ti,0,[0,0,0,1<<I,0,0]),new M(65856,65935,ki,0,[0,0,0,1<<Lo,0,0]),new M(65936,65999,Ei,0,[0,0,0,1<<Xo,0,0]),new M(66e3,66047,Ii,0,[0,0,0,1<<Jo,0,0]),new M(66176,66207,Di,0,[0,0,0,1<<P,0,0]),new M(66208,66271,Vi,0,[0,0,0,1<<P,0,0]),new M(66272,66303,Pi,0,[1<<T.Coptic,0,0,0,0,0]),new M(66304,66351,Fi,0,[0,0,1<<E.Old_Italic,0,0,0]),new M(66352,66383,Mi,0,[0,0,1<<E.Gothic,0,0,0]),new M(66384,66431,Ri,0,[]),new M(66432,66463,Ui,0,[0,0,0,1<<Bo,0,0]),new M(66464,66527,Li,0,[0,0,0,1<<Ho,0,0]),new M(66560,66639,Bi,0,[0,0,1<<E.Deseret,0,0,0]),new M(66640,66687,Hi,0,[0,0,0,1<<Oo,0,0]),new M(66688,66735,Oi,0,[0,0,0,1<<No,0,0]),new M(66736,66815,Ni,0,[]),new M(66816,66863,$i,0,[]),new M(66864,66927,Gi,0,[]),new M(67072,67455,zi,0,[]),new M(67584,67647,Wi,0,[0,0,0,1<<$o,0,0]),new M(67648,67679,ji,0,[]),new M(67680,67711,qi,0,[]),new M(67712,67759,Ki,0,[]),new M(67808,67839,Yi,0,[]),new M(67840,67871,Xi,0,[0,1<<k.Phoenician,0,0,0,0]),new M(67872,67903,Ji,0,[0,0,0,1<<P,0,0]),new M(67968,67999,Zi,0,[]),new M(68e3,68095,Qi,0,[]),new M(68096,68191,ts,0,[0,0,0,1<<Go,0,0]),new M(68192,68223,es,0,[]),new M(68224,68255,is,0,[]),new M(68288,68351,ss,0,[]),new M(68352,68415,os,0,[]),new M(68416,68447,ns,0,[]),new M(68448,68479,as,0,[]),new M(68480,68527,ls,0,[]),new M(68608,68687,rs,0,[]),new M(68736,68863,cs,0,[]),new M(69216,69247,ds,0,[]),new M(69632,69759,hs,0,[]),new M(69760,69839,ps,0,[]),new M(69840,69887,ms,0,[]),new M(69888,69967,us,0,[]),new M(69968,70015,gs,0,[]),new M(70016,70111,bs,0,[]),new M(70112,70143,Cs,0,[0,0,1<<E.Sinhala,0,0,0]),new M(70144,70223,fs,0,[]),new M(70272,70319,Ss,0,[]),new M(70320,70399,vs,0,[]),new M(70400,70527,ws,0,[]),new M(70656,70783,_s,0,[]),new M(70784,70879,xs,0,[]),new M(71040,71167,ys,0,[]),new M(71168,71263,As,0,[]),new M(71264,71295,Ts,0,[0,0,1<<E.Mongolian,0,0,0]),new M(71296,71375,ks,0,[]),new M(71424,71487,Es,0,[]),new M(71840,71935,Is,0,[]),new M(72384,72447,Ds,0,[]),new M(72704,72815,Vs,0,[]),new M(72816,72895,Ps,0,[]),new M(73728,74751,Fs,0,[0,0,0,1<<D,0,0]),new M(74752,74879,Ms,0,[0,0,0,1<<D,0,0]),new M(74880,75087,Rs,0,[]),new M(77824,78895,Us,0,[]),new M(82944,83583,Ls,0,[]),new M(92160,92735,Bs,0,[]),new M(92736,92783,Hs,0,[]),new M(92880,92927,Os,0,[]),new M(92928,93071,Ns,0,[]),new M(93952,94111,$s,2052,[]),new M(94176,94207,Gs,0,[]),new M(94208,100351,zs,0,[]),new M(100352,101119,Ws,0,[]),new M(110592,110847,js,0,[]),new M(113664,113823,qs,0,[]),new M(113824,113839,Ks,0,[]),new M(118784,119039,Ys,0,[0,0,1<<E.Byzantine_Musical_Symbols,0,0,0]),new M(119040,119295,Xs,0,[0,0,1<<E.Byzantine_Musical_Symbols,0,0,0]),new M(119296,119375,Js,0,[0,0,1<<E.Byzantine_Musical_Symbols,0,0,0]),new M(119552,119647,Zs,0,[]),new M(119648,119679,Qs,0,[]),new M(119808,120831,to,0,[0,0,1<<E.Mathematical_Alphanumeric_Symbols,0,0,0]),new M(120832,121519,eo,0,[]),new M(122880,122927,io,0,[0,0,0,1<<Fo,0,0]),new M(124928,125151,so,0,[]),new M(125184,125279,oo,0,[]),new M(126464,126719,no,0,[]),new M(126976,127023,ao,0,[0,0,0,1<<F,0,0]),new M(127024,127135,lo,0,[0,0,0,1<<F,0,0]),new M(127136,127231,ro,0,[]),new M(127232,127487,co,0,[]),new M(127488,127743,ho,0,[]),new M(127744,128511,po,0,[]),new M(128512,128591,mo,0,[]),new M(128592,128639,uo,0,[]),new M(128640,128767,go,0,[]),new M(128768,128895,bo,0,[]),new M(128896,129023,Co,0,[0,1<<k.Geometric_Shapes,0,0,0,0]),new M(129024,129279,fo,0,[0,1<<k.Arrows,0,0,0,0]),new M(129280,129535,So,0,[]),new M(131072,173791,vo,0,[0,0,1<<E.CJK_Unified_Ideographs,0,1<<v|1<<_,0]),new M(173824,177983,wo,0,[0,0,1<<E.CJK_Unified_Ideographs,0,1<<v|1<<_,0]),new M(177984,178207,_o,0,[0,0,1<<E.CJK_Unified_Ideographs,0,1<<v|1<<_,0]),new M(178208,183983,xo,0,[0,0,1<<E.CJK_Unified_Ideographs,0,1<<v|1<<_,0]),new M(194560,195103,yo,0,[0,0,1<<E.CJK_Strokes,0,1<<v|1<<_,0]),new M(917504,917631,Ao,0,[0,0,1<<E.Tags,0,0,0]),new M(917760,917999,To,0,[0,0,1<<E.Variation_Selectors,0,0,0]),new M(983040,1048575,ko,0,[0,0,1<<E.Private_Use_plane_15,0,0,0]),new M(1048576,1114111,Eo,0,[0,0,1<<E.Private_Use_plane_15,0,0,0])];e.getSupportedFonts=function(t){t=function(t,e){var i,s=0,o=e.length-1,n=null;if(o<=s)return null;for(;s<o;)if((n=e[i=s+o>>1]).Start>t)o=i-1;else{if(!(n.End<t))return e[i];s=1+i}return o<s||(n=e[s]).Start>t||n.End<t?null:e[s]}(t,R);return e.getSupportedFontsByRange(t)},e.getSupportedFontsByRange=function(t){if(null==t)return[];for(var e=AscFonts.g_fontApplication.g_fontSelections.List,i=e.length,s=[],o=0;o<i;o++){var n=e[o],a=t.Param;if(a[0]==(n.m_ulUnicodeRange1&a[0])&&(a[1]==(n.m_ulUnicodeRange2&a[1])&&a[2]==(n.m_ulUnicodeRange3&a[2])&&a[3]==(n.m_ulUnicodeRange4&a[3]))){if(t.Name==h){if(0==(n.m_ulCodePageRange1&a[4]))continue}else if(a[4]!=(n.m_ulCodePageRange1&a[4]))continue;a[5]==(n.m_ulCodePageRange2&a[5])&&s.push(n.m_wsFontName)}}return s},e.getSupportedRangesByFont=function(t){for(var e=[],i=0;i<R.length;++i){var s=R[i],o=s.Param;o[0]==(t.m_ulUnicodeRange1&o[0])&&o[1]==(t.m_ulUnicodeRange2&o[1])&&o[2]==(t.m_ulUnicodeRange3&o[2])&&o[3]==(t.m_ulUnicodeRange4&o[3])&&o[4]==(t.m_ulCodePageRange1&o[4])&&o[5]==(t.m_ulCodePageRange2&o[5])&&e.push(s)}return 0===e.length&&(e.push(new M(32,126,n,1033,[1<<T.Basic_Latin,0,0,0,1<<p,0])),e.push(new M(160,255,a,0,[1<<T.Basic_Latin|1<<T.Latin_1_Supplement,0,0,0,1<<p,0]))),e}}(window),define("common/main/lib/util/character",function(){}),!function(d){function s(t,e){this.init("tooltip",t,e)}var h=d.fn.tooltip,t=(h.prototype=d.fn.tooltip.Constructor.prototype,d.extend(d.fn.tooltip.Constructor.DEFAULTS,{container:"body",delay:{show:500},arrow:!1}),s.prototype=d.extend({},d.fn.tooltip.Constructor.prototype,{constructor:s,init:function(){h.prototype.init.apply(this,arguments),"cursor"==this.options.placement&&/hover/.exec(this.options.trigger)&&this.$element.on("mousemove.tooltip",this.options.selector,d.proxy(this.mousemove,this)),this.options.zIndex&&this.tip().css("z-index",this.options.zIndex);var e=this;Common.NotificationCenter.on({"layout:changed":function(t){e.options.keepvisible||e.options.hideonclick||!e.tip().is(":visible")||e.hide()}}),this.isDesktopApp=!1},mousemove:function(t){var e=t.clientX*Common.Utils.zoom(),t=t.clientY*Common.Utils.zoom();this.targetXY=[e,this.isDesktopApp?Math.max(t,14):t]},leave:function(t){h.prototype.leave.apply(this,arguments),this.dontShow=void 0},show:function(t){if(this.hasContent()&&("left"==this.options.hintDirection||this.enabled)&&!this.dontShow&&(this.$element.is(":visible")||!(0<this.$element.closest("[role=menu]").length))){var e=this.tip(),i=(!1===this.options.arrow&&e.addClass("arrow-free"),this.options.cls&&e.addClass(this.options.cls),"function"!=typeof this.options.placement?/^([a-zA-Z]+)-?([a-zA-Z]*)$/.exec(this.options.placement):null);if(t||!i||i[2].length){var s=d.Event("show.bs.tooltip");if(this.$element.trigger(s),s.isDefaultPrevented())return;if(this.setContent(),this.options.animation&&e.addClass("fade"),e.detach().css({top:0,left:0,display:"block"}),this.options.container?e.appendTo(this.options.container):e.insertAfter(this.$element),"function"==typeof this.options.placement)this.options.placement.call(this,e[0],this.$element[0]);else if("object"==typeof t){var o={top:t[1]+15,left:Common.UI.isRTL()?t[0]-e.width()-9:t[0]+18},s=Common.Utils.innerWidth(),n=Common.Utils.innerHeight();o.left<0&&(o.left=t[0]+18),o.left+e.width()>s&&(o.left=s-e.width()-30),o.top+e.height()>n&&(o.top=n-e.height()-30),e.offset(o).addClass("in")}else{var a=this.getPosition(),l=e[0].offsetWidth,r=e[0].offsetHeight;switch(i[1]){case"bottom":o={top:a.top+a.height+10};break;case"top":o={top:a.top-r-10}}switch(i[2]){case"left":o.left=a.left,this.$element.outerWidth()<=18&&(o.left-=4);break;case"right":o.left=a.left+a.width-l,this.$element.outerWidth()<=18&&(o.left+=4)}this.applyPlacement(o,i[1]),this.moveArrow(),e.addClass(i[1]).addClass(i[0])}this.$element.trigger("shown.bs.tooltip")}else h.prototype.show.apply(this,arguments);var c=this;clearTimeout(c.timeout),c.timeout=setTimeout(function(){"in"==c.hoverState&&c.hide(),c.dontShow=!1},5e3)}},moveArrow:function(){var t=this.tip().find(".tooltip-arrow, .arrow");switch(this.options.placement){case"top-left":case"bottom-left":t.css("left",10);break;case"top-right":case"bottom-right":t.css("right",10)}},enter:function(t){var e,i;"mouseenter"!==t.type||(e=d(t.target)).is("[role=menu]")||e.parentsUntil(t.currentTarget,"[role=menu]").length&&t.target!==t.currentTarget||this.tip().is(":visible")||(i=t instanceof this.constructor?t:d(t.currentTarget)[this.type](this.getDelegateOptions()).data("bs.tooltip"),clearTimeout(i.timeout),i.hoverState="in",this._updateTitle&&(this.tip().find(".tooltip-inner")[this.options.html?"html":"text"](this.options.title),this._updateTitle=void 0),i.options.delay&&i.options.delay.show?i.timeout=setTimeout(function(){"in"==i.hoverState&&i.show("cursor"==i.options.placement?i.targetXY:void 0)},i.options.delay.show):i.show())},replaceArrow:function(t,e,i){!1===this.options.arrow?this.arrow().hide():h.prototype.replaceArrow.apply(this,arguments)},getCalculatedOffset:function(t,e,i,s){var o=h.prototype.getCalculatedOffset.apply(this,arguments);if(0<this.options.offset||this.options.offset<0)switch(/(bottom|top)/.exec(t)[1]){case"bottom":o.top+=this.options.offset;break;case"top":o.top-=this.options.offset}return o},updateTitle:function(t){this.options.title=t,this._updateTitle=t}}),d.fn.tooltip);d.fn.tooltip=function(i){return this.each(function(){var t=d(this),e=t.data("bs.tooltip");e||t.data("bs.tooltip",e=new s(this,"object"==typeof i&&i)),"string"==typeof i&&e[i]()})},d.fn.tooltip.Constructor=s,d.fn.tooltip.noConflict=function(){return d.fn.tooltip=t,this}}(window.jQuery),define("tip",function(){}),define("common/main/lib/component/Tooltip",["tip","backbone"],function(){"use strict";function t(t){this.$element=this.placement=void 0,this.init.call(this,t)}_.extend(t.prototype,Backbone.Events,{init:function(t){var e,i;this.$element=t.owner instanceof Backbone.View?t.owner.$el:$(t.owner),this.placement=t.placement,this.$element.data("bs.tooltip")&&this.$element.removeData("bs.tooltip"),this.$element.tooltip({title:t.title,trigger:"manual",placement:t.placement,offset:t.offset,cls:t.cls,html:t.html,hideonclick:t.hideonclick,keepvisible:t.keepvisible}),t.hideonclick&&(i=(e=this).$element.data("bs.tooltip"))&&i.tip().on("click",function(){i.hide(),e.trigger("tooltip:hideonclick",this)}),this.$element.on("shown.bs.tooltip",_.bind(this.onTipShown,this)),this.$element.on("hidden.bs.tooltip",_.bind(this.onTipHidden,this))},show:function(t){this.getBSTip().show(t)},hide:function(t){this.getBSTip().hide(t)},setTitle:function(t){var e=this.getBSTip();e&&(e.options.title=t)},updateTitle:function(){var t=this.getBSTip();t.$tip.find(".tooltip-inner")[t.options.html?"html":"text"](t.options.title)},getBSTip:function(){return this.$element.data("bs.tooltip")},onTipShown:function(){this.trigger("tooltip:show",this)},onTipHidden:function(){this.trigger("tooltip:hide",this)},isVisible:function(){return this.getBSTip().tip().is(":visible")}}),Common.UI=Common.UI||{},Common.UI.Tooltip=t}),void 0===Common&&(Common={}),define("common/main/lib/component/InputField",["common/main/lib/component/BaseView","common/main/lib/component/Tooltip","common/main/lib/component/Button"],function(){"use strict";Common.UI.InputField=Common.UI.BaseView.extend({options:{id:null,cls:"",style:"",value:"",type:"text",name:"",validation:null,allowBlank:!0,placeHolder:"",blankError:null,spellcheck:!1,maskExp:"",validateOnChange:!1,validateOnBlur:!0,disabled:!1,editable:!0},template:_.template(['<div class="input-field" style="<%= style %>">',"<input ",'type="<%= type %>" ','name="<%= name %>" ','spellcheck="<%= spellcheck %>" ','class="form-control <%= cls %>" ','placeholder="<%= placeHolder %>" ','data-hint="<%= dataHint %>"','data-hint-direction="<%= dataHintDirection %>"','data-hint-offset="<%= dataHintOffset %>"',">",'<span class="input-error"></span>',"</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);t=this;this.id=t.options.id||Common.UI.getId(),this.cls=t.options.cls,this.style=t.options.style,this.value=t.options.value,this.type=t.options.type,this.name=t.options.name,this.validation=t.options.validation,this.allowBlank=t.options.allowBlank,this.placeHolder=t.options.placeHolder,this.template=t.options.template||t.template,this.editable=t.options.editable,this.disabled=t.options.disabled,this.spellcheck=t.options.spellcheck,this.blankError=t.options.blankError||"This field is required",this.validateOnChange=t.options.validateOnChange,this.validateOnBlur=t.options.validateOnBlur,this.maxLength=t.options.maxLength,t.rendered=t.options.rendered||!1,t.options.el&&t.render()},render:function(t){var e,i;return this.rendered?this.cmpEl=this.$el:(this.cmpEl=$(this.template({id:this.id,cls:this.cls,style:this.style,value:this.value,type:this.type,name:this.name,placeHolder:this.placeHolder,spellcheck:this.spellcheck,dataHint:this.options.dataHint,dataHintDirection:this.options.dataHintDirection,dataHintOffset:this.options.dataHintOffset,scope:this})),(t?(this.setElement(t,!1),t):this.$el).html(this.cmpEl)),this.rendered||(e=this.cmpEl,this._input=this.cmpEl.find("input").addBack().filter("input").first(),this.editable&&(this._input.on("blur",_.bind(this.onInputChanged,this)),this._input.on("keypress",_.bind(this.onKeyPress,this)),this._input.on("keydown",_.bind(this.onKeyDown,this)),this._input.on("keyup",_.bind(this.onKeyUp,this)),this.validateOnChange&&this._input.on("input",_.bind(this.onInputChanging,this)),this.maxLength&&this._input.attr("maxlength",this.maxLength)),this.setEditable(this.editable),this.disabled&&this.setDisabled(this.disabled),0<this._input.closest(".asc-window").length&&(i=function(){var t=e.find(".input-error").data("bs.tooltip");t&&t.tip().remove(),Common.NotificationCenter.off({"modal:close":i})}),Common.NotificationCenter.on({"modal:close":i})),this.rendered=!0,this.value&&this.setValue(this.value),this},_doChange:function(t,e){var i;e&&e.synthetic||(e=$(t.target).val(),i=this.value,this.trigger("changed:before",this,e,i,t),t.isDefaultPrevented()||(this.value=e,this.validateOnBlur&&this.checkValidate(),this.trigger("changed:after",this,e,i,t)))},onInputChanged:function(t,e){this._doChange(t,e)},onInputChanging:function(t,e){var i=$(t.target).val(),s=this.value;t.isDefaultPrevented()||(this.value=i,this.validateOnBlur&&this.checkValidate(),this.trigger("changing",this,i,s,t))},onKeyPress:function(t){var e;this.trigger("keypress:before",this,t),t.isDefaultPrevented()||(this.options.maskExp&&!_.isEmpty(this.options.maskExp.source)&&(e=String.fromCharCode(t.which),this.options.maskExp.test(e)||t.ctrlKey||t.keyCode===Common.UI.Keys.RETURN||(t.preventDefault(),t.stopPropagation())),this.trigger("keypress:after",this,t))},onKeyDown:function(t){this.trigger("keydown:before",this,t),t.isDefaultPrevented()||(t.keyCode===Common.UI.Keys.RETURN&&this._doChange(t),t.keyCode==Common.UI.Keys.ESC&&this.setValue(this.value),t.keyCode!=Common.UI.Keys.RETURN&&t.keyCode!=Common.UI.Keys.ESC||this.trigger("inputleave",this))},onKeyUp:function(t){this.trigger("keyup:before",this,t),t.isDefaultPrevented()||this.trigger("keyup:after",this,t)},setEditable:function(t){var e=this._input;(this.editable=t)&&e?(e.removeAttr("readonly"),e.removeAttr("data-can-copy")):(e.attr("readonly","readonly"),e.attr("data-can-copy",!1))},isEditable:function(){return this.editable},setDisabled:function(t){this.disabled=t=!!t,$(this.el).toggleClass("disabled",t),this.rendered&&(t?this._input.attr("disabled",!0):this._input.removeAttr("disabled"))},isDisabled:function(){return this.disabled},setValue:function(t){this.value=t,this.rendered&&this._input.val(t)},getValue:function(){return this.value},focus:function(){this._input&&this._input.focus()},checkValidate:function(){var t,e,i=this,s=[];return!i.allowBlank&&_.isEmpty(i.value)&&s.push(i.blankError),_.isFunction(i.validation)&&!0!==(t=i.validation.call(i,i.value))&&(s=_.flatten(s.concat(t))),_.isEmpty(s)?(i.cmpEl.removeClass("error"),!0):(i.cmpEl.hasClass("error")?(e=i.cmpEl.find(".input-error").data("bs.tooltip"))&&(e.options.title=s.join("\n"),e.setContent()):(i.cmpEl.addClass("error"),i=(t=i.cmpEl.find(".input-error")).closest(".asc-window"),(e=t.data("bs.tooltip"))&&e.tip().remove(),t.attr("data-toggle","tooltip"),t.removeData("bs.tooltip"),t.tooltip({title:s.join("\n"),placement:"cursor"}),0<i.length&&t.data("bs.tooltip").tip().css("z-index",parseInt(i.css("z-index"))+10)),s)},showError:function(t,e){var i,s;_.isEmpty(t)?(this.cmpEl.removeClass("error"),this.cmpEl.removeClass("warning")):(this.cmpEl.addClass(e?"warning":"error"),i=(e=this.cmpEl.find(".input-error")).closest(".asc-window"),(s=e.data("bs.tooltip"))&&s.tip().remove(),e.attr("data-toggle","tooltip"),e.removeData("bs.tooltip"),e.tooltip({title:t.join("\n"),placement:"cursor"}),0<i.length&&e.data("bs.tooltip").tip().css("z-index",parseInt(i.css("z-index"))+10))},showWarning:function(t){this.showError(t,!0)}}),Common.UI.InputFieldBtn=Common.UI.InputField.extend({options:{id:null,cls:"",style:"",value:"",type:"text",name:"",validation:null,allowBlank:!0,placeHolder:"",blankError:null,spellcheck:!1,maskExp:"",validateOnChange:!1,validateOnBlur:!0,disabled:!1,editable:!0,iconCls:"toolbar__icon btn-select-range",btnHint:""},template:_.template(['<div class="input-field input-field-btn" style="<%= style %>">',"<input ","type=<%= type %> ",'name="<%= name %>" ','spellcheck="<%= spellcheck %>" ','class="form-control <%= cls %>" ','placeholder="<%= placeHolder %>" ','value="<%= value %>"','data-hint="<%= dataHint %>"','data-hint-offset="<%= dataHintOffset %>"','data-hint-direction="<%= dataHintDirection %>"',">",'<span class="input-error"></span>','<div class="select-button"></div>',"</div>"].join("")),render:function(t){var e,i;return this.rendered?this.cmpEl=this.$el:(this.cmpEl=$(this.template({id:this.id,cls:this.cls,style:this.style,value:this.value,type:this.type,name:this.name,placeHolder:this.placeHolder,spellcheck:this.spellcheck,scope:this,dataHint:this.options.dataHint,dataHintOffset:this.options.dataHintOffset,dataHintDirection:this.options.dataHintDirection})),(t?(this.setElement(t,!1),t):this.$el).html(this.cmpEl)),this.rendered||(e=this.cmpEl,this._button=new Common.UI.Button({cls:"btn-toolbar",iconCls:this.options.iconCls,hint:this.options.btnHint||"",menu:this.options.menu}),this._button.render(this.cmpEl.find(".select-button")),this._button.on("click",_.bind(this.onButtonClick,this)),this._input=this.cmpEl.find("input").addBack().filter("input"),this.editable&&(this._input.on("blur",_.bind(this.onInputChanged,this)),this._input.on("keypress",_.bind(this.onKeyPress,this)),this._input.on("keydown",_.bind(this.onKeyDown,this)),this._input.on("keyup",_.bind(this.onKeyUp,this)),this.validateOnChange&&this._input.on("input",_.bind(this.onInputChanging,this)),this.maxLength&&this._input.attr("maxlength",this.maxLength)),this.setEditable(this.editable),this.disabled&&this.setDisabled(this.disabled),0<this._input.closest(".asc-window").length&&(i=function(){var t=e.find(".input-error").data("bs.tooltip");t&&t.tip().remove(),Common.NotificationCenter.off({"modal:close":i})}),Common.NotificationCenter.on({"modal:close":i})),this.rendered=!0,this.value&&this.setValue(this.value),this},onButtonClick:function(t,e){this.trigger("button:click",this,e)},setDisabled:function(t){this.disabled=t=!!t,$(this.el).toggleClass("disabled",t),t?this._input.attr("disabled",!0):this._input.removeAttr("disabled"),this._button.setDisabled(t)},setBtnDisabled:function(t){this._button.setDisabled(t)},updateBtnHint:function(t){this.options.hint=t,this.rendered&&this._button.updateHint(this.options.hint)}}),Common.UI.InputFieldBtnPassword=Common.UI.InputFieldBtn.extend(_.extend({options:{id:null,cls:"",style:"",value:"",name:"",type:"password",validation:null,allowBlank:!0,placeHolder:"",blankError:null,spellcheck:!1,maskExp:"",validateOnChange:!1,validateOnBlur:!0,disabled:!1,editable:!0,showCls:"toolbar__icon btn-sheet-view",hideCls:"toolbar__icon btn-hide-password",btnHint:"",repeatInput:null,showPwdOnClick:!0},initialize:function(t){(t=t||{}).btnHint=t.btnHint||this.textHintShowPwd,t.iconCls=t.showCls||this.options.showCls,Common.UI.InputFieldBtn.prototype.initialize.call(this,t),this.hidePwd=!0,this.repeatInput=this.options.repeatInput},render:function(t){return Common.UI.InputFieldBtn.prototype.render.call(this,t),this._btnElm=this._button.$el,this.options.showPwdOnClick?this._button.on("click",_.bind(this.passwordClick,this)):this._btnElm.on("mousedown",_.bind(this.passwordShow,this)),this},passwordClick:function(t){this.hidePwd?(this.passwordShow(t),this.hidePwd=!1):(this.passwordHide(t),this.hidePwd=!0);var e=this,i=e._input[0].selectionStart,s=e._input[0].selectionEnd;setTimeout(function(){e.focus(),e._input[0].selectionStart=i,e._input[0].selectionEnd=s},1)},passwordShow:function(t){this.disabled||(this._button.setIconCls(this.options.hideCls),this.type="text",this._input.attr("type",this.type),this.repeatInput&&(this.repeatInput.type=this.type,this.repeatInput._input.attr("type",this.type)),this.options.showPwdOnClick?this._button.updateHint(this.textHintHidePwd):(this._btnElm.on("mouseup",_.bind(this.passwordHide,this)),this._btnElm.on("mouseout",_.bind(this.passwordHide,this))))},passwordHide:function(t){var e,i,s;this._button.setIconCls(this.options.showCls),this.type="password",this._input.attr("type",this.type),this.repeatInput&&(this.repeatInput.type=this.type,this.repeatInput._input.attr("type",this.type)),this.options.showPwdOnClick?this._button.updateHint(this.textHintShowPwd):(this._btnElm.off("mouseup",this.passwordHide),this._btnElm.off("mouseout",this.passwordHide),i=(e=this)._input[0].selectionStart,s=e._input[0].selectionEnd,setTimeout(function(){e.focus(),e._input[0].selectionStart=i,e._input[0].selectionEnd=s},1))},textHintShowPwd:"Show password",textHintHidePwd:"Hide password"},Common.UI.InputFieldBtnPassword||{})),Common.UI.InputFieldBtnCalendar=Common.UI.InputFieldBtn.extend({options:{id:null,cls:"",style:"",value:"",type:"text",name:"",validation:null,allowBlank:!0,placeHolder:"",blankError:null,spellcheck:!1,maskExp:"",validateOnChange:!1,validateOnBlur:!0,disabled:!1,editable:!0,iconCls:"toolbar__icon btn-date",btnHint:"",menu:!0},initialize:function(t){(t=t||{}).btnHint=t.btnHint||this.textDate,Common.UI.InputFieldBtn.prototype.initialize.call(this,t)},render:function(t){var s=this,e=(Common.UI.InputFieldBtn.prototype.render.call(this,t),"id-"+Common.UI.getId()+"input-field-datetime"),t=new Common.UI.Menu({menuAlign:"tr-br",style:"border: none; padding: 0;",items:[{template:_.template('<div id="'+e+'" style=""></div>'),stopPropagation:!0}]});$("button",this._button.cmpEl).addClass("no-caret"),this._button.setMenu(t),this._button.menu.on("show:after",function(i){s.cmpCalendar||(s.cmpCalendar=new Common.UI.Calendar({el:s.cmpEl.find("#"+e),enableKeyEvents:!0,firstday:1}),s.cmpCalendar.on("date:click",function(t,e){s.trigger("date:click",s,e),i.hide()}),i.alignPosition()),s.cmpCalendar.focus()})},setDate:function(t){this.cmpCalendar&&t&&t instanceof Date&&!isNaN(t)&&this.cmpCalendar&&this.cmpCalendar.setDate(t)},textDate:"Select date"}),Common.UI.InputFieldFixed=Common.UI.InputField.extend({options:{id:null,cls:"",style:"",value:"",fixedValue:"",type:"text",name:"",validation:null,allowBlank:!0,placeHolder:"",blankError:null,spellcheck:!1,maskExp:"",validateOnChange:!1,validateOnBlur:!0,disabled:!1,editable:!0,btnHint:""},template:_.template(['<div class="input-field input-field-fixed" style="<%= style %>">',"<input ","type=<%= type %> ",'name="<%= name %>" ','spellcheck="<%= spellcheck %>" ','class="form-control <%= cls %>" ','placeholder="<%= placeHolder %>" ','value="<%= value %>"','data-hint="<%= dataHint %>"','data-hint-offset="<%= dataHintOffset %>"','data-hint-direction="<%= dataHintDirection %>"',">",'<span class="input-error"></span>','<input class="fixed-text form-control" type="text" readonly="readonly"></div>'].join("")),initialize:function(t){this.fixedValue=t.fixedValue,Common.UI.InputField.prototype.initialize.call(this,t)},render:function(t){return Common.UI.InputField.prototype.render.call(this,t),this.fixedValue&&this.setFixedValue(this.fixedValue),this},setFixedValue:function(t){this.fixedValue=t,this.rendered&&this.cmpEl.find("input.fixed-text").addBack().filter("input.fixed-text").val(t)},setDisabled:function(t){var e;this.disabled=t=!!t,$(this.el).toggleClass("disabled",t),this.rendered&&(e=this.cmpEl.find("input").addBack().filter("input"),t?e.attr("disabled",!0):e.removeAttr("disabled"))}})}),void 0===Common&&(Common={}),define("common/main/lib/view/SymbolTableDialog",["common/main/lib/util/utils","common/main/lib/util/character","common/main/lib/component/InputField","common/main/lib/component/Window"],function(){"use strict";var s={1:"Basic Latin",2:"Latin 1 Supplement",3:"Latin Extended A",4:"Latin Extended B",5:"IPA Extensions",6:"Spacing Modifier Letters",7:"Combining Diacritical Marks",8:"Greek and Coptic",9:"Cyrillic",10:"Cyrillic Supplement",11:"Armenian",12:"Hebrew",13:"Arabic",14:"Syriac",15:"Arabic Supplement",16:"Thaana",17:"NKo",18:"Samaritan",19:"Mandaic",20:"Arabic Extended A",21:"Devanagari",22:"Bengali",23:"Gurmukhi",24:"Gujarati",25:"Oriya",26:"Tamil",27:"Telugu",28:"Kannada",29:"Malayalam",30:"Sinhala",31:"Thai",32:"Lao",33:"Tibetan",34:"Myanmar",35:"Georgian",36:"Hangul Jamo",37:"Ethiopic",38:"Ethiopic Supplement",39:"Cherokee",40:"Unified Canadian Aboriginal Syllabics",41:"Ogham",42:"Runic",43:"Tagalog",44:"Hanunoo",45:"Buhid",46:"Tagbanwa",47:"Khmer",48:"Mongolian",49:"Unified Canadian Aboriginal Syllabics Extended",50:"Limbu",51:"Tai Le",52:"New Tai Lue",53:"Khmer Symbols",54:"Buginese",55:"Tai Tham",56:"Combining Diacritical Marks Extended",57:"Balinese",58:"Sundanese",59:"Batak",60:"Lepcha",61:"Ol Chiki",62:"Cyrillic Extended C",63:"Sundanese Supplement",64:"Vedic Extensions",65:"Phonetic Extensions",66:"Phonetic Extensions Supplement",67:"Combining Diacritical Marks Supplement",68:"Latin Extended Additional",69:"Greek Extended",70:"General Punctuation",71:"Superscripts and Subscripts",72:"Currency Symbols",73:"Combining Diacritical Marks for Symbols",74:"Letterlike Symbols",75:"Number Forms",76:"Arrows",77:"Mathematical Operators",78:"Miscellaneous Technical",79:"Control Pictures",80:"Optical Character Recognition",81:"Enclosed Alphanumerics",82:"Box Drawing",83:"Block Elements",84:"Geometric Shapes",85:"Miscellaneous Symbols",86:"Dingbats",87:"Miscellaneous Mathematical Symbols A",88:"Supplemental Arrows A",89:"Braille Patterns",90:"Supplemental Arrows B",91:"Miscellaneous Mathematical Symbols B",92:"Supplemental Mathematical Operators",93:"Miscellaneous Symbols and Arrows",94:"Glagolitic",95:"Latin Extended C",96:"Coptic",97:"Georgian Supplement",98:"Tifinagh",99:"Ethiopic Extended",100:"Cyrillic Extended A",101:"Supplemental Punctuation",102:"CJK Radicals Supplement",103:"Kangxi Radicals",104:"Ideographic Description Characters",105:"CJK Symbols and Punctuation",106:"Hiragana",107:"Katakana",108:"Bopomofo",109:"Hangul Compatibility Jamo",110:"Kanbun",111:"Bopomofo Extended",112:"CJK Strokes",113:"Katakana Phonetic Extensions",114:"Enclosed CJK Letters and Months",115:"CJK Compatibility",116:"CJK Unified Ideographs Extension",117:"Yijing Hexagram Symbols",118:"CJK Unified Ideographs",119:"Yi Syllables",120:"Yi Radicals",121:"Lisu",122:"Vai",123:"Cyrillic Extended B",124:"Bamum",125:"Modifier Tone Letters",126:"Latin Extended D",127:"Syloti Nagri",128:"Common Indic Number Forms",129:"Phags pa",130:"Saurashtra",131:"Devanagari Extended",132:"Kayah Li",133:"Rejang",134:"Hangul Jamo Extended A",135:"Javanese",136:"Myanmar Extended B",137:"Cham",138:"Myanmar Extended A",139:"Tai Viet",140:"Meetei Mayek Extensions",141:"Ethiopic Extended A",142:"Latin Extended E",143:"Cherokee Supplement",144:"Meetei Mayek",145:"Hangul Syllables",146:"Hangul Jamo Extended B",147:"High Surrogates",148:"High Private Use Surrogates",149:"Low Surrogates",150:"Private Use Area",151:"CJK Compatibility Ideographs",152:"Alphabetic Presentation Forms",153:"Arabic Presentation Forms A",154:"Variation Selectors",155:"Vertical Forms",156:"Combining Half Marks",157:"CJK Compatibility Forms",158:"Small Form Variants",159:"Arabic Presentation Forms B",160:"Halfwidth and Fullwidth Forms",161:"Specials",162:"Linear B Syllabary",163:"Linear B Ideograms",164:"Aegean Numbers",165:"Ancient Greek Numbers",166:"Ancient Symbols",167:"Phaistos Disc",168:"Lycian",169:"Carian",170:"Coptic Epact Numbers",171:"Old Italic",172:"Gothic",173:"Old Permic",174:"Ugaritic",175:"Old Persian",176:"Deseret",177:"Shavian",178:"Osmanya",179:"Osage",180:"Elbasan",181:"Caucasian Albanian",182:"Linear A",183:"Cypriot Syllabary",184:"Imperial Aramaic",185:"Palmyrene",186:"Nabataean",187:"Hatran",188:"Phoenician",189:"Lydian",190:"Meroitic Hieroglyphs",191:"Meroitic Cursive",192:"Kharoshthi",193:"Old South Arabian",194:"Old North Arabian",195:"Manichaean",196:"Avestan",197:"Inscriptional Parthian",198:"Inscriptional Pahlavi",199:"Psalter Pahlavi",200:"Old Turkic",201:"Old Hungarian",202:"Rumi Numeral Symbols",203:"Brahmi",204:"Kaithi",205:"Sora Sompeng",206:"Chakma",207:"Mahajani",208:"Sharada",209:"Sinhala Archaic Numbers",210:"Khojki",211:"Multani",212:"Khudawadi",213:"Grantha",214:"Newa",215:"Tirhuta",216:"Siddham",217:"Modi",218:"Mongolian Supplement",219:"Takri",220:"Ahom",221:"Warang Citi",222:"Pau Cin Hau",223:"Bhaiksuki",224:"Marchen",225:"Cuneiform",226:"Cuneiform Numbers and Punctuation",227:"Early Dynastic Cuneiform",228:"Egyptian Hieroglyphs",229:"Anatolian Hieroglyphs",230:"Bamum Supplement",231:"Mro",232:"Bassa Vah",233:"Pahawh Hmong",234:"Miao",235:"Ideographic Symbols and Punctuation",236:"Tangut",237:"Tangut Components",238:"Kana Supplement",239:"Duployan",240:"Shorthand Format Controls",241:"Byzantine Musical Symbols",242:"Musical Symbols",243:"Ancient Greek Musical Notation",244:"Tai Xuan Jing Symbols",245:"Counting Rod Numerals",246:"Mathematical Alphanumeric Symbols",247:"Sutton SignWriting",248:"Glagolitic Supplement",249:"Mende Kikakui",250:"Adlam",251:"Arabic Mathematical Alphabetic Symbols",252:"Mahjong Tiles",253:"Domino Tiles",254:"Playing Cards",255:"Enclosed Alphanumeric Supplement",256:"Enclosed Ideographic Supplement",257:"Miscellaneous Symbols and Pictographs",258:"Emoticons",259:"Ornamental Dingbats",260:"Transport and Map Symbols",261:"Alchemical Symbols",262:"Geometric Shapes Extended",263:"Supplemental Arrows C",264:"Supplemental Symbols and Pictographs",265:"CJK Unified Ideographs Extension B",266:"CJK Unified Ideographs Extension C",267:"CJK Unified Ideographs Extension D",268:"CJK Unified Ideographs Extension E",269:"CJK Compatibility Ideographs Supplement",270:"Tags",271:"Variation Selectors Supplement",272:"Supplementary Private Use Area A",273:"Supplementary Private Use Area B"},c=[],d=[],n=[],h=-1,a=-1,l=!0,r=-1,p="",m=-1e3,o="",u=-1e3,g=-1,b=-1,C=20,f=20;Common.Views.SymbolTableDialog=Common.UI.Window.extend(_.extend({options:{resizable:!0,minwidth:448,minheight:434,width:448,height:434,cls:"modal-dlg invisible-borders",buttons:["ok","cancel"]},initialize:function(t){var e,i=Common.localStorage.getKeysFilter(),i=(this.appPrefix=i&&i.length?i.split(",")[0]:"",this.appPrefix+"settings-size-symbol-table"),s=Common.Utils.InternalSettings.get(i);if(null==s&&(s=Common.localStorage.getItem(i)||"",Common.Utils.InternalSettings.set(i,s)),s=s?JSON.parse(s):[],this.options=_.extend({resizable:!0,minwidth:448,minheight:434,width:448,height:434,cls:"modal-dlg invisible-borders",buttons:["ok","cancel"]},{title:this.textTitle,width:s[0]||448,height:s[1]||434},t||{}),this.api=this.options.api,this.type=this.options.type||0,this.special=this.options.special||!1,this.showShortcutKey=this.options.showShortcutKey||!1,this.special||(this.options.height-=38),this.special||(this.options.minheight-=38),this.template=['<div class="box">','<div style="margin-bottom: 16px;" class="'+(this.special?"":"hidden")+'">','<button type="button" class="btn btn-text-default auto" id="symbol-table-symbols">',this.textSymbols,"</button>",'<button type="button" class="btn btn-text-default auto" id="symbol-table-special">',this.textSpecial,"</button>","</div>",'<div id="symbol-table-pnl-symbols">','<table cols="2" style="width: 100%;max-width: 497px;">',"<tr>",'<td class="padding-right-5" style="padding-bottom: 8px;width: 50%;">','<label class="input-label">'+this.textFont+"</label>",'<div id="symbol-table-cmb-fonts"></div>',"</td>",'<td class="padding-left-5" style="padding-bottom: 8px;">','<label class="input-label">'+this.textRange+"</label>",'<div id="symbol-table-cmb-range"></div>',"</td>","</tr>","</table>",'<table cols="1" style="width: 100%;">',"<tr>",'<td style="padding-bottom: 16px;">','<div id="symbol-table-scrollable-div" style="position: relative;height:'+(this.options.height-304+38*(this.special?0:1))+'px;">','<div style="width: 100%;">','<div id="id-preview">',"<div>",'<div style="position: absolute; top: 0;"><div id="id-preview-data" tabindex="0" oo_editor_input="true"></div></div>',"</div>","</div>","</div>","</div>","</td>","</tr>","<tr>",'<td style="padding-bottom: 16px;">','<label class="input-label">'+this.textRecent+"</label>",'<div id="symbol-table-recent" tabindex="0" oo_editor_input="true" style="width: 100%;"></div>',"</td>","</tr>","</table>",'<table cols="2" style="width: 100%;max-width: 497px;">',"<tr>",'<td class="padding-right-5" style="width: 50%;">','<label class="input-label">'+this.textCode+"</label>","</td>",'<td class="padding-left-5">',"</td>","</tr>","<tr>",'<td class="padding-right-5">','<div id="symbol-table-text-code" oo_editor_input="true"></div>',"</td>",'<td class="padding-left-5">','<div id="symbol-table-label-font" style="overflow: hidden; text-overflow: ellipsis;white-space: nowrap;max-width: 160px;"></div>',"</td>","</tr>","</table>","</div>",'<div id="symbol-table-pnl-special">','<table cols="1" style="width: 100%;">',"<tr>","<td>","<label>"+this.textCharacter+"</label>",'<label id="symbol-table-lbl-shortcut" style="width: 112px;" class="float-right">'+this.textShortcut+"</label>","</td>","</tr>","<tr>","<td>",'<div id="symbol-table-special-list" class="no-borders" style="width:100%; height: '+(this.options.height-157+38*(this.special?0:1))+'px;"></div>',"</td>","</tr>","</table>","</div>","</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),c.length<1&&this.initFonts(),this.fillRecentSymbols(),t.font?e=t.font:0<n.length&&(e=n[0].font),e)for(var o=0;o<c.length;++o)if(c[o].displayValue===e){h=o;break}h<0&&(h=0),d=this.getArrRangesByFont(h),-1===a&&(a=d[0].Start),t.code?a=t.code:t.symbol?a=this.fixedCharCodeAt(t.symbol,0):0<n.length&&(a=n[0].symbol),Common.UI.Window.prototype.initialize.call(this,this.options),this.on("resizing",_.bind(this.onWindowResizing,this)),this.on("resize",_.bind(this.onWindowResize,this)),l=!0},initFonts:function(){for(var t,e,i,s=this.api.pluginMethod_GetFontList(),o=(s.sort(function(t,e){return t.m_wsFontName<e.m_wsFontName?-1:t.m_wsFontName>e.m_wsFontName?1:0}),[]),n={},a=0;a<s.length;++a)(!(e=n[i=(t=s[a]).m_wsFontName])||e.m_bBold&&e.m_bItalic||e.m_bBold&&!t.m_bBold||e.m_bItalic&&!t.m_bBold&&!t.m_bItalic)&&(n[i]=t);delete n.ASCW3;var l,a=0;for(l in n)n.hasOwnProperty(l)&&(o.push(n[l]),o[o.length-1].displayValue=n[l].m_wsFontName);for((c=o).sort(function(t,e){return t.displayValue.toLowerCase()>e.displayValue.toLowerCase()?1:-1}),a=0;a<c.length;++a)c[a].value=a;if(n[p]||(n["Cambria Math"]?p="Cambria Math":n["Asana-Math"]&&(p="Asana-Math")),n[p])for(a=0;a<c.length;++a)if(c[a].displayValue===p){h=a;break}},render:function(){Common.UI.Window.prototype.render.call(this);var o=this,n=this.getChild(),t=(this.btnSymbols=new Common.UI.Button({el:n.find("#symbol-table-symbols"),enableToggle:!0,toggleGroup:"hyperlink-type",allowDepress:!1,pressed:!0}),this.btnSymbols.on("click",_.bind(this.onModeClick,this,!1)),this.btnSpecial=new Common.UI.Button({el:n.find("#symbol-table-special"),enableToggle:!0,toggleGroup:"hyperlink-type",allowDepress:!1}),this.btnSpecial.on("click",_.bind(this.onModeClick,this,!0)),this.cmbFonts=new Common.UI.ComboBox({el:n.find("#symbol-table-cmb-fonts"),cls:"input-group-nr",data:c,editable:!1,search:!0,menuStyle:"min-width: 100%; max-height: 209px;"}).on("selected",function(t,e){var i=o.getRangeBySymbol(d,a);if(h=e.value,d=o.getArrRangesByFont(h),i){for(var s=0;s<d.length&&i.Name!==d[s].Name;++s);s===d.length&&(a=d[0].Start)}else a=d[0].Start;l=!0,o.updateView(),setTimeout(function(){o.previewPanel.focus()},1)}),this.cmbFonts.setValue(h),this.cmbRange=new Common.UI.ComboBox({el:n.find("#symbol-table-cmb-range"),cls:"input-group-nr",editable:!1,search:!0,menuStyle:"min-width: 100%; max-height: 209px;"}).on("selected",function(t,e){e=o.getRangeByName(d,parseInt(e.value));a=e.Start,l=!0,o.updateView(void 0,void 0,void 0,void 0,!1),setTimeout(function(){o.previewPanel.focus()},1)}),this.updateRangeSelector(),o.inputCode=new Common.UI.InputField({el:n.find("#symbol-table-text-code"),allowBlank:!1,blankError:o.txtEmpty,style:"width: 100%;",validateOnBlur:!1,validateOnChange:!0}).on("changing",function(t,e,i){var s,e=parseInt(e,16);!isNaN(e)&&31<e&&o.getRangeBySymbol(d,e)&&(s=0===n.find("#c"+e).length,a=e,l=!0,o.updateView(s,void 0,!1))}).on("change:after",function(t,e,i){o.updateInput()}),this.symbolTablePanel=n.find("#symbol-table-scrollable-div"),this.previewPanel=n.find("#id-preview-data"),this.previewParent=this.previewPanel.parent(),this.previewScrolled=n.find("#id-preview"),this.previewInner=this.previewScrolled.find("> div:first-child"),this.recentPanel=n.find("#symbol-table-recent"),this.fontLabel=n.find("#symbol-table-label-font"),this.boxPanel=n.find(".box"),this.updateView(void 0,void 0,void 0,!0),[{symbol:"—",description:this.textEmDash,shortcutKey:Common.Utils.String.platformKey(Common.Utils.isMac?"Alt Shift -":"Alt+Ctrl+Num -","{0}"),code:"2014"},{symbol:"–",description:this.textEnDash,shortcutKey:Common.Utils.String.platformKey(Common.Utils.isMac?"Ctrl Num -":"Ctrl+Num -","{0}"),code:"2013"},{symbol:"‑",description:this.textNBHyphen,shortcutKey:Common.Utils.String.platformKey(Common.Utils.isMac?"Ctrl Shift _":"Ctrl+Shift+_","{0}"),code:"002D",special:{NonBreakingHyphen:!0}},{symbol:"",description:this.textEmSpace,shortcutKey:"",code:"2003"},{symbol:"",description:this.textEnSpace,shortcutKey:"",code:"2002"},{symbol:"",description:this.textQEmSpace,shortcutKey:"",code:"2005"},{symbol:"°",description:this.textNBSpace,shortcutKey:Common.Utils.String.platformKey(Common.Utils.isMac?"Alt ":"Ctrl+Shift+","{0}")+"Space",code:"00A0"},{symbol:"©",description:this.textCopyright,shortcutKey:Common.Utils.String.platformKey(Common.Utils.isMac?"Alt Ctrl ":"Alt+Ctrl+","{0}")+"G",code:"00A9"},{symbol:"®",description:this.textRegistered,shortcutKey:Common.Utils.String.platformKey(Common.Utils.isMac?"Alt Ctrl ":"Alt+Ctrl+","{0}")+"R",code:"00AE"},{symbol:"™",description:this.textTradeMark,shortcutKey:Common.Utils.String.platformKey(Common.Utils.isMac?"Alt Ctrl ":"Alt+Ctrl+","{0}")+"T",code:"2122"},{symbol:"§",description:this.textSection,shortcutKey:"",code:"00A7"},{symbol:"¶",description:this.textPilcrow,shortcutKey:"",code:"00B6"},{symbol:"…",description:this.textEllipsis,shortcutKey:Common.Utils.String.platformKey(Common.Utils.isMac?"Alt Ctrl ":"Alt+Ctrl+","{0}")+".",code:"2026"},{symbol:"‛",description:this.textSOQuote,shortcutKey:"",code:"2018"},{symbol:"’",description:this.textSCQuote,shortcutKey:"",code:"2019"},{symbol:"‟",description:this.textDOQuote,shortcutKey:"",code:"201C"},{symbol:"”",description:this.textDCQuote,shortcutKey:"",code:"201D"}]);this.specialList=new Common.UI.ListView({el:n.find("#symbol-table-special-list"),store:new Common.UI.DataViewStore(t),simpleAddMode:!0,cls:"dbl-clickable",itemTemplate:_.template(['<div id="<%= id %>" class="list-item" style="width: 100%;display:flex;">','<div class="padding-right-5" style="width:70px;text-align: center;"><%= symbol %></div>','<div class="padding-right-5" style="flex-grow:1;"><%= description %></div>',"<% if ("+this.showShortcutKey+") { %>",'<div style="width:105px;"><%= shortcutKey %></div>',"<% } %>","</div>"].join(""))}),this.specialList.on("item:dblclick",_.bind(this.onDblClickSpecialItem,this)).on("entervalue",_.bind(this.onDblClickSpecialItem,this)),this.specialList.selectByIndex(0),this.lblShortCut=n.find("#symbol-table-lbl-shortcut"),this.lblShortCut.toggleClass("hidden",!this.showShortcutKey),n.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.symbolsPanel=n.find("#symbol-table-pnl-symbols"),this.specialPanel=n.find("#symbol-table-pnl-special")},show:function(){Common.UI.Window.prototype.show.apply(this,arguments),this.binding||(this.binding={}),this.binding.keydownSymbols=_.bind(this.onKeyDown,this),this.binding.keypressSymbols=_.bind(this.onKeyPress,this),$(document).on("keydown."+this.cid,"#symbol-table-scrollable-div #id-preview-data, #symbol-table-recent",this.binding.keydownSymbols),$(document).on("keypress."+this.cid,"#symbol-table-scrollable-div #id-preview-data, #symbol-table-recent",this.binding.keypressSymbols);var t=this.special&&!!Common.Utils.InternalSettings.get(this.appPrefix+"symbol-table-special");(t?this.btnSpecial:this.btnSymbols).toggle(!0),this.ShowHideElem(t)},close:function(t){$(document).off("keydown."+this.cid,this.binding.keydownSymbols),$(document).off("keypress."+this.cid,this.binding.keypressSymbols),this.special&&Common.Utils.InternalSettings.set(this.appPrefix+"symbol-table-special",this.btnSpecial.isActive()),Common.UI.Window.prototype.close.apply(this,arguments)},getPasteSymbol:function(t){var e,i=!1;return{font:e=t&&0<t.length?((i="c"===t[0])?c[h]:(t=parseInt(t.split("_")[2]),c[t])).displayValue:e,symbol:this.encodeSurrogateChar(a),code:a,updateRecents:i}},getSpecialSymbol:function(){var t=this.specialList.getSelectedRec();return{font:void 0,symbol:this.encodeSurrogateChar(t.get("code")),code:parseInt(t.get("code"),16),special:t.get("special"),speccharacter:!0}},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value,!0)},onPrimary:function(t){return this._handleInput("ok"),!1},_handleInput:function(t,e){var i;!e&&document.activeElement&&"textarea"==document.activeElement.localName&&/area_id/.test(document.activeElement.id)||(e=this.btnSpecial.isActive(),i="ok"==t?e?this.getSpecialSymbol():this.getPasteSymbol(this.$window.find(".cell-selected").attr("id")):{},this.options.handler&&this.options.handler.call(this,this,t,i),"ok"==t&&(e||this.checkRecent(a,i.font),!e&&i.updateRecents&&this.updateRecents(),this.type)||this.close())},encodeSurrogateChar:function(t){var e;return t<65536?String.fromCharCode(t):(e=56320|1023&(t-=65536),String.fromCharCode(55296|t>>10)+String.fromCharCode(e))},fixedCharCodeAt:function(t,e){var i,s=t.charCodeAt(e=e||0);if(55296<=s&&s<=56319){if(i=s,t=t.charCodeAt(e+1),isNaN(t))throw"Старшая часть суррогатной пары без следующей младшей в fixedCharCodeAt()";return 1024*(i-55296)+(t-56320)+65536}return!(56320<=s&&s<=57343)&&s},getArrRangesByFont:function(t){t=getSupportedRangesByFont(c[t]);return 0===t.length&&t.push({Start:32,End:255}),t[0].Start<32&&(t[0].Start=32),t},getRangeBySymbol:function(t,e){for(var i=0;i<t.length;++i)if(t[i].Start<=e&&t[i].End>=e)return t[i];return null},getRangeByName:function(t,e){for(var i=0;i<t.length;++i)if(t[i].Name===e)return t[i];return null},getLinearIndexByCode:function(t,e){for(var i,s=0,o=0;o<t.length;++o){if((i=t[o]).Start>e)return-1;if(i.Start<=e&&i.End>=e)return s+(e-i.Start);s+=i.End-i.Start+1}return-1},getCodeByLinearIndex:function(t,e){if(!(e<0))for(var i,s,o=0,n=(t[0],0);n<t.length;++n){if(e<o+(s=(i=t[n]).End-i.Start+1))return i.Start+e-o;o+=s}return-1},createTable:function(t,e,i){for(var s,o=e*i,n=0,a="",l=0;l<o;++l)s=l/i>>0==e-1?"style='border-bottom: none'":"",l<t.length?a+='<div class="cell" '+s+' id="'+("c"+t[l])+'">&#'+t[l].toString(10)+"</div>":a+='<div class="cell"'+s+"></div>",i<=++n&&(a+='<br class="noselect">',n=0);this.previewPanel.html(a)},fillRecentSymbols:function(){var t,e=Common.localStorage.getItem(this.appPrefix+"recentSymbols");""!=e&&(t=JSON.parse(e)),_.isArray(t)&&(n=t)},saveRecent:function(){var t=JSON.stringify(n);Common.localStorage.setItem(this.appPrefix+"recentSymbols",t)},checkRecent:function(t,e){if(0===n.length)n.push({symbol:t,font:e});else{for(var i=0;i<n.length;++i)if(n[i].symbol===t&&n[i].font===e){n.splice(i,1);break}n.splice(0,0,{symbol:t,font:e}),36<n.length&&n.splice(36,n.length-36)}this.saveRecent()},createCell:function(t,e){var i="",s="";if(e){for(var o=0,n=0;n<c.length;++n)if(c[n].displayValue===e){o=n;break}i="r_"+t+"_"+o,s="&#"+t.toString()}else void 0!==t&&(i="r"+t,s="&#"+t.toString());t=$('<div id="'+i+'">'+s+"</div>");return t.addClass("cell"),t.addClass("noselect"),t.mousedown(_.bind(this.cellClickHandler,this)),e&&t.css("font-family","'"+e+"'"),t},cellClickHandler:function(t){var e,i=$(t.target).attr("id");i&&(e=(new Date).getTime(),i===o&&e-u<300?this.cellDblClickHandler(t):(l="c"===i[0]?(a=parseInt(i.slice(1,i.length)),!0):(i=i.split("_"),a=parseInt(i[1]),r=parseInt(i[2]),!1),this.updateView(!1)),o=t.target.id,u=e)},cellDblClickHandler:function(t){this.type?(t=this.getPasteSymbol($(t.target).attr("id")),this.checkRecent(a,t.font),t.updateRecents&&this.updateView(!1,void 0,void 0,!0),this.fireEvent("symbol:dblclick",this,"ok",t)):this._handleInput("ok")},onDblClickSpecialItem:function(t){var e;this.type?(e=this.getSpecialSymbol(),this.fireEvent("symbol:dblclick",this,"ok",e)):this._handleInput("ok")},updateRecents:function(){var t=this.recentPanel,e=(t.empty(),this.getColsCount()),i=n.length;t.width(31*e);for(var s=0;s<e;++s){var o=s<i?this.createCell(n[s].symbol,n[s].font):this.createCell();o.css("border-bottom","none"),t.append(o),s===e-1&&o.css(Common.UI.isRTL()?"border-left":"border-right","none")}},getColsCount:function(){return(this.boxPanel.innerWidth()-13)/31>>0},getMaxHeight:function(){return this.symbolTablePanel.innerHeight()-2},getRowsCount:function(){return Math.max(1,this.getMaxHeight()/33>>0)},getAllSymbolsCount:function(t){for(var e,i=0,s=0;s<t.length;++s)i+=(e=t[s]).End-e.Start+1;return i},setTable:function(t){for(var e,i=this.getColsCount(),s=this.getRowsCount(),t=this.getLinearIndexByCode(d,t),o=this.getAllSymbolsCount(d),o=Math.ceil(o/i),o=Math.max(0,Math.min(o-s,t/i>>0)),n=o*i,a=s*i,l=[],r=0;r<a&&-1!==(e=this.getCodeByLinearIndex(d,n+r));++r)l.push(e);return this.previewPanel.css("font-family","'"+c[h].displayValue+"'"),this.createTable(l,s,i),o},updateView:function(t,e,i,s,o){l&&!1!==o&&this.updateRangeSelector(),l?this.fontLabel.text(c[h]?c[h].displayValue:""):this.fontLabel.text(c[r]?c[r].displayValue:""),!1!==t&&this.cmbFonts.setValue(h);var n=33*this.getRowsCount();!1!==t&&(o=null!=e?e:a,t=this.setTable(o),e=this.getAllSymbolsCount(d),o=Math.ceil(e/this.getColsCount()),this.previewInner.height(33*o),this.previewPanel.height(n),this.previewScrolled.height(n),this.scrollerY||(C=Math.max(22,n/8+.5>>0),f=Math.min(33*Math.floor(this.previewPanel.height()/33)/10,20),this.scrollerY=new Common.UI.Scroller({el:this.previewScrolled,minScrollbarLength:C,alwaysVisibleY:!0,wheelSpeed:f,useKeyboard:!1,onChange:_.bind(function(){this.scrollerY&&(this._preventUpdateScroll=!0,this.onScrollEnd(),this._preventUpdateScroll=!1,this.previewParent.height(n),this.previewParent.css({top:this.scrollerY.getScrollTop()}))},this)})),this._preventUpdateScroll||(this.scrollerY.update({minScrollbarLength:C,wheelSpeed:f}),this.scrollerY.scrollTop(33*t)),(e=this.previewPanel.find(".cell")).off("mousedown"),e.mousedown(_.bind(this.cellClickHandler,this))),s&&this.updateRecents(),this.$window.find(".cell").removeClass("cell-selected"),(l?this.$window.find("#c"+a):this.$window.find("#r_"+a+"_"+r)).addClass("cell-selected"),!1!==i&&this.updateInput()},onScrollEnd:function(){if(this.scrollerY.getScrollTop()!==m){var t=this.getAllSymbolsCount(d),e=this.getColsCount(),i=this.getRowsCount(),t=Math.ceil(t/e),s=33*t,i=Math.max(0,Math.min(t-i,t*this.scrollerY.getScrollTop()/s+.5>>0));if(m=this.scrollerY.getScrollTop(),l){t=this.previewPanel.children()[0];if(t){s=t.id;if(s){var t=parseInt(s.slice(1,s.length)),s=this.getLinearIndexByCode(d,t),o=i*e+(this.getLinearIndexByCode(d,a)-s),n=(a=this.getCodeByLinearIndex(d,o),i*e);for(o-=e;-1===a&&n<=o;)a=this.getCodeByLinearIndex(d,o),o-=e;-1===a&&(a=this.getCodeByLinearIndex(d,n))}else a=this.getCodeByLinearIndex(d,i*e)}}else a=this.getCodeByLinearIndex(d,i*e),l=!0;this.updateView(!0,this.getCodeByLinearIndex(d,i*e))}},updateInput:function(){for(var t=a.toString(16).toUpperCase(),e=t.length;e<5;++e)t="0"+t;this.inputCode.setValue(t)},updateRangeSelector:function(){var t=this.getRangeBySymbol(d,a);if(t&&t.Name){this.cmbRange.setDisabled(!1);for(var e=[],i=0;i<d.length;++i)e.push({value:d[i].Name,displayValue:s[d[i].Name]});this.cmbRange.setData(e),this.cmbRange.setValue(t.Name)}else this.cmbRange.setDisabled(!0),this.cmbRange.setValue("")},onKeyDown:function(t){var e,i,s,o;document.activeElement&&document.activeElement.nodeName&&"span"===document.activeElement.nodeName.toLowerCase()||(t=t.which||t.charCode||t.keyCode||0,e=!0,l?(s=-1,t===Common.UI.Keys.LEFT?s=this.getCodeByLinearIndex(d,this.getLinearIndexByCode(d,a)-1):t===Common.UI.Keys.UP?s=this.getCodeByLinearIndex(d,this.getLinearIndexByCode(d,a)-this.getColsCount()):t===Common.UI.Keys.RIGHT?s=this.getCodeByLinearIndex(d,this.getLinearIndexByCode(d,a)+1):t===Common.UI.Keys.DOWN?s=this.getCodeByLinearIndex(d,this.getLinearIndexByCode(d,a)+this.getColsCount()):t===Common.UI.Keys.HOME?0<d.length&&(s=d[0].Start):t===Common.UI.Keys.END?0<d.length&&(s=d[d.length-1].End):e=!1,-1<s&&(a=s,s=0===this.$window.find("#c"+a).length,this.updateView(s))):t===Common.UI.Keys.LEFT?(o=this.$window.find(".cell-selected")[0])&&"r"===o.id[0]&&0<(s=this.$window.find(o).prev()).length&&(i=this.$window.find(s).attr("id").split("_"),a=parseInt(i[1]),r=parseInt(i[2]),this.updateView(!1)):t===Common.UI.Keys.RIGHT?(o=this.$window.find(".cell-selected")[0])&&"r"===o.id[0]&&0<(s=this.$window.find(o).next()).length&&(i=this.$window.find(s).attr("id").split("_"),a=parseInt(i[1]),r=parseInt(i[2]),this.updateView(!1)):t===Common.UI.Keys.HOME?(o=this.$window.find("#recent-table").children()[0])&&(i=o.id.split("_"),a=parseInt(i[1]),r=parseInt(i[2]),this.updateView(!1)):t===Common.UI.Keys.END?(o=(s=this.recentPanel.children())[s.length-1])&&(i=o.id.split("_"),a=parseInt(i[1]),r=parseInt(i[2]),this.updateView(!1)):e=!1,e&&(b=t,g=(new Date).getTime()))},onKeyPress:function(t){var e,i;document.activeElement&&document.activeElement.nodeName&&"span"===document.activeElement.nodeName.toLowerCase()||(e=t.which||t.charCode||t.keyCode||0,b===e&&Math.abs(g-(new Date).getTime())<1e3||(!isNaN(e)&&31<e&&this.getRangeBySymbol(d,e)&&(i=0===this.$window.find("#c"+e).length,a=e,l=!0,this.updateView(i,void 0,!0)),t.preventDefault&&t.preventDefault()))},onWindowResize:function(t){var e=this.getSize();t&&"start"==t[1]?(this._preventUpdateScroll=!0,this.curSize={resize:!1,width:e[0],height:e[1]}):this.curSize.resize&&(this._preventUpdateScroll=!1,this.curSize.height=e[1]-304+38*(this.special?0:1),t=33*Math.max(1,(this.curSize.height-2)/33>>0),this.symbolTablePanel.css({height:this.curSize.height+"px"}),this.previewPanel.css({height:t+"px"}),this.previewScrolled.css({height:t+"px"}),this.scrollerY=null,this.updateView(void 0,void 0,void 0,!0),this.specialList.cmpEl.height(e[1]-157+38*(this.special?0:1)),this.special||(e[1]+=38),t=JSON.stringify(e),Common.localStorage.setItem(this.appPrefix+"settings-size-symbol-table",t),Common.Utils.InternalSettings.set(this.appPrefix+"settings-size-symbol-table",t))},onWindowResizing:function(){var t,e;!this.curSize||(t=this.getSize())[0]===this.curSize.width&&t[1]===this.curSize.height||(this.curSize.resize||(this.curSize.resize=!0),this.curSize.width=t[0],this.curSize.height=t[1]-304+38*(this.special?0:1),e=33*Math.max(1,(this.curSize.height-2)/33>>0),this.symbolTablePanel.css({height:this.curSize.height+"px"}),this.previewPanel.css({height:e+"px"}),this.previewScrolled.css({height:e+"px"}),this.specialList.cmpEl.height(t[1]-157+38*(this.special?0:1)),this.updateView(void 0,void 0,void 0,!0))},onModeClick:function(t,e,i){this.ShowHideElem(t)},ShowHideElem:function(t){this.symbolsPanel.toggleClass("hidden",t),this.specialPanel.toggleClass("hidden",!t);var e=this;_.delay(function(){(t?e.specialList:e.previewPanel).focus()},50)}},Common.Views.SymbolTableDialog||{}))}),void 0===Common&&(Common={}),define("common/main/lib/view/ListSettingsDialog",["common/main/lib/component/Window","common/main/lib/component/MetricSpinner","common/main/lib/component/ThemeColorPalette","common/main/lib/component/ColorButton","common/main/lib/view/SymbolTableDialog"],function(){"use strict";var l={none:-1,symbol:0,image:2,newSymbol:1,newImage:-2};Common.Views.ListSettingsDialog=Common.UI.Window.extend(_.extend({options:{type:0,width:285,height:261,style:"min-width: 240px;",cls:"modal-dlg",id:"window-list-settings",split:!1,buttons:["ok","cancel"]},initialize:function(t){this.type=t.type||0,_.extend(this.options,{title:this.txtTitle},t||{}),this.template=['<div class="box">','<div style="margin-bottom: 16px;">','<button type="button" class="btn btn-text-default auto" id="id-dlg-list-bullet">',this.textBulleted,"</button>",'<button type="button" class="btn btn-text-default auto" id="id-dlg-list-numbering">',this.textNumbering,"</button>","</div>",'<div style="height:120px;">','<table cols="3">',"<tr>",'<td class="padding-right-5" style="padding-bottom: 8px;min-width: 50px;">','<label class="text">'+this.txtType+"</label>","</td>",'<td class="padding-right-5" style="padding-bottom: 8px;width: 105px;">','<div id="id-dlg-list-numbering-format" class="input-group-nr" style="width: 105px;"></div>','<div id="id-dlg-list-bullet-format" class="input-group-nr" style="width: 105px;"></div>',"</td>",'<td style="padding-bottom: 8px;"></td>',"</tr>",'<tr class="image">','<td class="padding-right-5" style="padding-bottom: 8px;min-width: 50px;">','<label class="text">'+this.txtImport+"</label>","</td>",'<td class="padding-right-5" style="padding-bottom: 8px;width: 105px;">','<div id="id-dlg-list-image" style="width: 105px;"></div>',"</td>",'<td style="padding-bottom: 8px;"></td>',"</tr>","<tr>",'<td class="padding-right-5" style="padding-bottom: 8px;min-width: 50px;">','<label class="text">'+this.txtSize+"</label>","</td>",'<td class="padding-right-5" style="padding-bottom: 8px;width: 105px;">','<div id="id-dlg-list-size"></div>',"</td>",'<td style="padding-bottom: 8px;">','<label class="text" style="white-space: nowrap;">'+this.txtOfText+"</label>","</td>","</tr>",'<tr class="numbering">','<td class="padding-right-5" style="padding-bottom: 8px;min-width: 50px;">','<label class="text" style="white-space: nowrap;">'+this.txtStart+"</label>","</td>",'<td class="padding-right-5" style="padding-bottom: 8px;width: 105px;">','<div id="id-dlg-list-start"></div>',"</td>",'<td style="padding-bottom: 8px;"></td>',"</tr>",'<tr class="color">','<td class="padding-right-5" style="padding-bottom: 8px;min-width: 50px;">','<label class="text">'+this.txtColor+"</label>","</td>",'<td class="padding-right-5" style="padding-bottom: 8px;width: 105px;">','<div id="id-dlg-list-color"></div>',"</td>",'<td style="padding-bottom: 8px;"></td>',"</tr>","</table>","</div>","</div>"].join(""),this.props=t.props,this.options.tpl=_.template(this.template)(this.options),this.color="000000",this.storage=!!t.storage,this.api=t.api,Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var o=this,t=this.getChild(),e=(t.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),o.btnBullet=new Common.UI.Button({el:$("#id-dlg-list-bullet"),enableToggle:!0,toggleGroup:"list-type",allowDepress:!1,pressed:!0}),o.btnBullet.on("click",_.bind(o.onListTypeClick,o,0)),o.btnNumbering=new Common.UI.Button({el:$("#id-dlg-list-numbering"),enableToggle:!0,toggleGroup:"list-type",allowDepress:!1}),o.btnNumbering.on("click",_.bind(o.onListTypeClick,o,1)),this.cmbNumFormat=new Common.UI.ComboBox({el:$("#id-dlg-list-numbering-format"),menuStyle:"min-width: 100%;max-height: 183px;",editable:!1,takeFocusOnClose:!0,cls:"input-group-nr",data:[{displayValue:this.txtNone,value:-1},{displayValue:"A, B, C,...",value:4},{displayValue:"a), b), c),...",value:5},{displayValue:"a, b, c,...",value:6},{displayValue:"1, 2, 3,...",value:1},{displayValue:"1), 2), 3),...",value:2},{displayValue:"I, II, III,...",value:3},{displayValue:"i, ii, iii,...",value:7}]}),this.cmbNumFormat.on("selected",_.bind(function(t,e){this._changedProps&&this._changedProps.asc_putListType(1,e.value)},this)),this.cmbNumFormat.setValue(1),["<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%= item.value %>"><a tabindex="-1" type="menuitem">',"<%= item.displayValue %>",'<% if (item.value === 0) { %><span style="font-family:<%=item.font%>;"><%=item.symbol%></span>','<% } else if (item.value === 2) { %><span id="id-dlg-list-bullet-image-preview" class="margin-left-4" style="width:12px; height: 12px; margin-bottom: 1px;display: inline-block; vertical-align: middle;"></span><% } %>',"</a></li>","<% }); %>"]),i=['<div class="input-group combobox input-group-nr <%= cls %>" id="<%= id %>" style="<%= style %>">','<div class="form-control" style="padding-top:3px; line-height: 14px; cursor: pointer; <%= style %>"></div>','<div style="display: table-cell;"></div>','<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown"><span class="caret"></span></button>','<ul class="dropdown-menu <%= menuCls %>" style="<%= menuStyle %>" role="menu">'].concat(e).concat(["</ul>","</div>"]),i=(this.cmbBulletFormat=new Common.UI.ComboBoxCustom({el:$("#id-dlg-list-bullet-format"),menuStyle:"min-width: 100%;max-height: 183px;",style:"width: 105px;",editable:!1,takeFocusOnClose:!0,template:_.template(i.join("")),itemsTemplate:_.template(e.join("")),data:[{displayValue:this.txtNone,value:l.none},{displayValue:this.txtSymbol+": ",value:l.symbol,symbol:"•",font:"Arial"},{displayValue:this.txtSymbol+": ",value:l.symbol,symbol:"o",font:"Courier New"},{displayValue:this.txtSymbol+": ",value:l.symbol,symbol:"§",font:"Wingdings"},{displayValue:this.txtSymbol+": ",value:l.symbol,symbol:"v",font:"Wingdings"},{displayValue:this.txtSymbol+": ",value:l.symbol,symbol:"Ø",font:"Wingdings"},{displayValue:this.txtSymbol+": ",value:l.symbol,symbol:"ü",font:"Wingdings"},{displayValue:this.txtSymbol+": ",value:l.symbol,symbol:"w",font:"Wingdings"},{displayValue:this.txtSymbol+": ",value:l.symbol,symbol:"–",font:"Arial"},{displayValue:this.txtNewBullet,value:l.newSymbol},{displayValue:this.txtNewImage,value:l.newImage}],updateFormControl:function(t){var e,i=$(this.el).find(".form-control");t?t.get("value")===l.symbol?i[0].innerHTML=t.get("displayValue")+'<span style="font-family:'+(t.get("font")||"Arial")+'">'+t.get("symbol")+"</span>":t.get("value")===l.image?(i[0].innerHTML=t.get("displayValue")+'<span id="id-dlg-list-bullet-combo-preview" class="margin-left-2" style="width:12px; height: 12px; margin-bottom: 1px;display: inline-block; vertical-align: middle;"></span>',(e=new Asc.asc_CBullet).asc_fillBulletImage(o.imageProps.id),e.drawSquareImage("id-dlg-list-bullet-combo-preview")):t.get("value")===l.newImage?i[0].innerHTML=o.txtImage:i[0].innerHTML=t.get("displayValue"):i[0].innerHTML=""}}),this.cmbBulletFormat.store.at(1)),e=(this.cmbBulletFormat.selectRecord(i),this.bulletProps={symbol:i.get("symbol"),font:i.get("font")},this.cmbBulletFormat.on("selected",_.bind(function(s,t){var o,n,a,e,i;this.imageControls.toggleClass("hidden",!(t.value===l.image||t.value===l.newImage)),this.colorControls.toggleClass("hidden",t.value===l.image||t.value===l.newImage),t.value===l.newSymbol?(n=(o=this).bulletProps,(i=new Common.Views.SymbolTableDialog({api:o.options.api,lang:o.options.interfaceLang,modal:!0,type:0,font:n.font,symbol:n.symbol,handler:e=function(t,e,i){"ok"==(a=e)&&(n.changed=!0,n.code=i.code,n.font=i.font,n.symbol=i.symbol,o._changedProps&&(o._changedProps.asc_putFont(n.font),o._changedProps.asc_putSymbol(n.symbol)));e=s.store;e.findWhere({value:l.symbol,symbol:n.symbol,font:n.font})||((i=e.indexOf(e.findWhere({value:l.image})))<0&&(i=e.indexOf(e.findWhere({value:l.newSymbol}))),e.add({displayValue:o.txtSymbol+": ",value:l.symbol,symbol:n.symbol,font:n.font},{at:i})),o.imageProps&&(o.imageProps.redraw=!0),s.setData(e.models),s.selectRecord(s.store.findWhere({value:l.symbol,symbol:n.symbol,font:n.font}))}}).on("close",function(t){void 0===a&&e.call(o),setTimeout(function(){o.cmbBulletFormat.focus()},1)})).show(),i.on("symbol:dblclick",e)):t.value!=l.newImage&&(t.value==l.image?this._changedProps&&this._changedProps.asc_fillBulletImage(this.imageProps.id):t.value==l.none?this._changedProps&&this._changedProps.asc_putListType(0,t.value):(this.bulletProps.changed=!0,this.bulletProps.code=t.code,this.bulletProps.font=t.font,this.bulletProps.symbol=t.symbol,this._changedProps&&(this._changedProps.asc_putFont(this.bulletProps.font),this._changedProps.asc_putSymbol(this.bulletProps.symbol)))),this.btnOk.setDisabled(t.value===l.newImage)},this)),this.cmbBulletFormat.on("show:after",_.bind(this.onBulletFormatOpen,this)),this.spnSize=new Common.UI.MetricSpinner({el:t.find("#id-dlg-list-size"),step:1,width:105,value:100,defaultUnit:"",maxValue:400,minValue:25,allowDecimal:!1}).on("change",function(t,e,i,s){o._changedProps&&o._changedProps.asc_putSize(t.getNumberValue())}),this.btnColor=new Common.UI.ColorButton({parentEl:t.find("#id-dlg-list-color"),style:"width:45px;",additionalAlign:this.menuAddAlign,color:this.color,cls:"move-focus",takeFocusOnClose:!0}),this.btnColor.on("color:select",_.bind(this.onColorsSelect,this)),this.colors=this.btnColor.getPicker(),this.spnStart=new Common.UI.MetricSpinner({el:t.find("#id-dlg-list-start"),step:1,width:105,value:1,defaultUnit:"",maxValue:32767,minValue:1,allowDecimal:!1}).on("change",function(t,e,i,s){o._changedProps&&o._changedProps.asc_putNumStartAt(t.getNumberValue())}),this.btnSelectImage=new Common.UI.Button({parentEl:$("#id-dlg-list-image"),cls:"btn-text-menu-default",caption:this.textSelect,style:"width: 100%;",menu:new Common.UI.Menu({style:"min-width: 105px;",maxHeight:200,additionalAlign:this.menuAddAlign,items:[{caption:this.textFromFile,value:0},{caption:this.textFromUrl,value:1},{caption:this.textFromStorage,value:2}]})}),this.btnSelectImage.menu.on("item:click",_.bind(this.onImageSelect,this)),this.btnSelectImage.menu.items[2].setVisible(this.storage),this.btnOk=new Common.UI.Button({el:t.find(".primary")}),o.numberingControls=t.find("tr.numbering"),o.imageControls=t.find("tr.image"),o.colorControls=t.find("tr.color"),t.find("table tr:first() td:first()"));e.width(Math.max(t.find(".numbering .text").width(),e.width())),this.afterRender()},getFocusedComponents:function(){return[this.cmbNumFormat,this.cmbBulletFormat,this.btnSelectImage,this.spnSize,this.spnStart,this.btnColor]},afterRender:function(){this.updateThemeColors(),this._setDefaults(this.props);function e(t){var e;s.imageProps={id:t.asc_getImageId(),redraw:!0},s._changedProps&&s._changedProps.asc_fillBulletImage(s.imageProps.id),(t=s.cmbBulletFormat.store).findWhere({value:l.image})||(e=t.indexOf(t.findWhere({value:l.newSymbol})),t.add({displayValue:s.txtImage+":",value:l.image},{at:e})),s.cmbBulletFormat.setData(t.models),s.cmbBulletFormat.selectRecord(s.cmbBulletFormat.store.findWhere({value:l.image})),s.btnOk.setDisabled(!1)}function i(t){t&&t._urls&&"bullet"==t.c&&(new Asc.asc_CBullet).asc_putImageUrl(t._urls[0],t.token)}var s=this;this.api.asc_registerCallback("asc_onBulletImageLoaded",e);Common.NotificationCenter.on("storage:image-insert",i),this.on("close",function(t){s.api.asc_unregisterCallback("asc_onBulletImageLoaded",e),Common.NotificationCenter.off("storage:image-insert",i)})},onBulletFormatOpen:function(t){t.store.findWhere({value:l.image})&&this.imageProps.redraw&&((t=new Asc.asc_CBullet).asc_fillBulletImage(this.imageProps.id),t.drawSquareImage("id-dlg-list-bullet-image-preview"),this.imageProps.redraw=!1)},updateThemeColors:function(){this.colors.updateColors(Common.Utils.ThemeColor.getEffectColors(),Common.Utils.ThemeColor.getStandartColors())},onColorsSelect:function(t,e){this.color=e,this._changedProps&&this._changedProps.asc_putColor(Common.Utils.ThemeColor.getRgbColor(e))},onListTypeClick:function(t,e,i){this.ShowHideElem(t)},ShowHideElem:function(t){var e=0==t&&(this.cmbBulletFormat.getValue()===l.image||this.cmbBulletFormat.getValue()===l.newImage||(void 0===this.cmbBulletFormat.getValue()||""===this.cmbBulletFormat.getValue())&&this.originalType===AscFormat.BULLET_TYPE_BULLET_BLIP),i=(this.numberingControls.toggleClass("hidden",0==t),this.imageControls.toggleClass("hidden",!e),this.colorControls.toggleClass("hidden",e),this.cmbNumFormat.setVisible(1==t),this.cmbBulletFormat.setVisible(0==t),this.btnOk.setDisabled(e&&this.cmbBulletFormat.getValue()===l.newImage),this);_.delay(function(){(t?i.cmbNumFormat:i.cmbBulletFormat).focus()},50)},_handleInput:function(t){if(this.options.handler){if("ok"==t&&this.btnOk.isDisabled())return;var e=this.btnBullet.pressed?0:1;this.originalType==AscFormat.BULLET_TYPE_BULLET_NONE&&(this._changedProps=new Asc.asc_CBullet,this._changedProps.asc_putSize(this.spnSize.getNumberValue()),0==e&&this.cmbBulletFormat.getValue()===l.image&&this.imageProps?this._changedProps.asc_fillBulletImage(this.imageProps.id):this._changedProps.asc_putColor(Common.Utils.ThemeColor.getRgbColor(this.color))),(this.originalType==AscFormat.BULLET_TYPE_BULLET_NONE||(this.originalType==AscFormat.BULLET_TYPE_BULLET_CHAR||this.originalType==AscFormat.BULLET_TYPE_BULLET_BLIP)&&1==e||this.originalType==AscFormat.BULLET_TYPE_BULLET_AUTONUM&&0==e)&&(0==e?this.cmbBulletFormat.getValue()==l.none?this._changedProps.asc_putListType(0,-1):this.cmbBulletFormat.getValue()!=l.image&&(this._changedProps.asc_putFont(this.bulletProps.font),this._changedProps.asc_putSymbol(this.bulletProps.symbol)):(this._changedProps.asc_putListType(1,this.cmbNumFormat.getValue()),this._changedProps.asc_putNumStartAt(this.spnStart.getNumberValue()))),this.options.handler.call(this,t,this._changedProps)}this.close()},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onPrimary:function(t){return this._handleInput("ok"),!1},_setDefaults:function(t){if(t){var e=0,t=t.asc_getBullet();if(t){this.originalType=t.asc_getType(),this.spnSize.setValue(t.asc_getSize()||"",!0);var i,s=(s=t.asc_getColor())?s.get_type()==Asc.c_oAscColor.COLOR_TYPE_SCHEME?{color:Common.Utils.ThemeColor.getHexColor(s.get_r(),s.get_g(),s.get_b()),effectValue:s.get_value()}:Common.Utils.ThemeColor.getHexColor(s.get_r(),s.get_g(),s.get_b()):"transparent";if(this.color=Common.Utils.ThemeColor.colorValue2EffectId(s),this.btnColor.setColor(s),"object"==typeof s){for(var o=!1,n=0;n<10;n++)if(Common.Utils.ThemeColor.ThemeValues[n]==s.effectValue){this.colors.select(s,!0),o=!0;break}o||this.colors.clearSelection()}else this.colors.select(s,!0);this.originalType==AscFormat.BULLET_TYPE_BULLET_NONE?(this.cmbNumFormat.setValue(-1),this.cmbBulletFormat.setValue(l.none),e=this.type):this.originalType==AscFormat.BULLET_TYPE_BULLET_CHAR?((i=t.asc_getSymbol())?(this.bulletProps={symbol:i,font:t.asc_getFont()},this.cmbBulletFormat.store.findWhere({value:l.symbol,symbol:this.bulletProps.symbol,font:this.bulletProps.font})||this.cmbBulletFormat.store.add({displayValue:this.txtSymbol+": ",value:l.symbol,symbol:this.bulletProps.symbol,font:this.bulletProps.font},{at:this.cmbBulletFormat.store.length-2}),this.cmbBulletFormat.setData(this.cmbBulletFormat.store.models),this.cmbBulletFormat.selectRecord(this.cmbBulletFormat.store.findWhere({value:l.symbol,symbol:this.bulletProps.symbol,font:this.bulletProps.font}))):this.cmbBulletFormat.setValue(""),this._changedProps=t,e=0):this.originalType==AscFormat.BULLET_TYPE_BULLET_BLIP?((i=t.asc_getImageId())?(this.imageProps={id:i,redraw:!0},this.cmbBulletFormat.store.findWhere({value:l.image})||this.cmbBulletFormat.store.add({displayValue:this.txtImage+":",value:l.image},{at:this.cmbBulletFormat.store.length-2}),this.cmbBulletFormat.setData(this.cmbBulletFormat.store.models),this.cmbBulletFormat.selectRecord(this.cmbBulletFormat.store.findWhere({value:l.image}))):this.cmbBulletFormat.setValue(""),this._changedProps=t,e=0):this.originalType==AscFormat.BULLET_TYPE_BULLET_AUTONUM&&(i=t.asc_getAutoNumType(),this.cmbNumFormat.setValue(i,""),i=t.asc_getNumStartAt(),this.spnStart.setValue(i||"",!0),this.spnStart.setDisabled(null===i),this._changedProps=t,e=1)}else this.cmbNumFormat.setValue(-1),this.cmbBulletFormat.setValue(l.none),this._changedProps=new Asc.asc_CBullet,e=this.type}(1==e?this.btnNumbering:this.btnBullet).toggle(!0),this.ShowHideElem(e)},onImageSelect:function(t,e){1==e.value?new Common.Views.ImageFromUrlDialog({handler:function(t,e){"ok"==t&&(t=e.replace(/ /g,""),_.isEmpty(t)||(new Asc.asc_CBullet).asc_putImageUrl(t))}}).show():2==e.value?Common.NotificationCenter.trigger("storage:image-load","bullet"):(new Asc.asc_CBullet).asc_showFileDialog()}},Common.Views.ListSettingsDialog||{}))}),$(document).off("keydown.bs.dropdown.data-api").on("keydown.bs.dropdown.data-api","[data-toggle=dropdown], [role=menu]",onDropDownKeyDown),"ontouchstart"in document.documentElement&&$(document).on("click.bs.dropdown.data-api","[data-toggle=dropdown]",toggle),!function(){var s,t=$._data($(document).get(0),"events");t&&t.click&&t.click.every(function(t,e,i){return!(s=/click/.test(t.type)&&!t.selector&&/bs\..+\.dropdown/.test(t.namespace)?t.handler:s)}),s&&$(document).off("click.bs.dropdown.data-api",s).on("click.bs.dropdown.data-api",function(t){1!=t.which&&null!=t.which||clearMenus(/form-control/.test(t.target.className))})}(),define("common/main/lib/extend/Bootstrap",function(){}),void 0===Common&&(Common={}),define("common/main/lib/component/MenuItem",["common/main/lib/component/BaseView","common/main/lib/component/ToggleManager"],function(){"use strict";Common.UI.MenuItem=Common.UI.BaseView.extend({options:{id:null,cls:"",style:"",hint:!1,checkable:!1,checked:!1,allowDepress:!1,disabled:!1,visible:!0,value:null,toggleGroup:null,iconCls:"",menu:null,canFocused:!0,dataHint:"",dataHintDirection:"",dataHintOffset:"",dataHintTitle:"",scaling:!1},tagName:"li",template:_.template(['<a id="<%= id %>" class="menu-item" style="<%= style %>" <% if(options.canFocused) { %> tabindex="-1" type="menuitem" <% }; if(!_.isUndefined(options.stopPropagation)) { %> data-stopPropagation="true" <% }; if(!_.isUndefined(options.dataHint)) { %> data-hint="<%= options.dataHint %>" <% }; if(!_.isUndefined(options.dataHintDirection)) { %> data-hint-direction="<%= options.dataHintDirection %>" <% }; if(!_.isUndefined(options.dataHintOffset)) { %> data-hint-offset="<%= options.dataHintOffset %>" <% }; if(options.dataHintTitle) { %> data-hint-title="<%= options.dataHintTitle %>" <% }; %> >',"<% if (!_.isEmpty(iconCls)) { %>",'<span class="menu-item-icon <%= iconCls %>"></span>',"<% } %>","<%= caption %>","</a>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);t=this;this.id=t.options.id||Common.UI.getId(),this.cls=t.options.cls,this.style=t.options.style,this.caption=t.options.caption,this.menu=t.options.menu||null,this.checkable=t.options.checkable,this.checked=t.options.checked,t.allowDepress=t.options.allowDepress,this.disabled=t.options.disabled,this.visible=t.options.visible,this.value=t.options.value,this.toggleGroup=t.options.toggleGroup,this.template=t.options.template||this.template,this.iconCls=t.options.iconCls,this.hint=t.options.hint,this.rendered=!1,null===this.menu||this.menu instanceof Common.UI.Menu||this.menu instanceof Common.UI.MenuSimple||(this.menu=new Common.UI.Menu(_.extend({},t.options.menu))),t.options.el&&this.render()},render:function(){var t,i=this,e=i.$el||$(this.el);return i.cmpEl=e,i.trigger("render:before",i),"--"===i.caption?e.addClass("divider"):this.rendered||(e.off("click"),Common.UI.ToggleManager.unregister(i),e.html(this.template({id:i.id,caption:i.caption,iconCls:i.iconCls,style:i.style,options:i.options})),i.menu&&(e.addClass("dropdown-submenu"),i.menu.render(e),e.mouseenter(_.bind(i.menu.alignPosition,i.menu)),e.focusout(_.bind(i.onBlurItem,i)),e.hover(_.bind(i.onHoverItem,i),_.bind(i.onUnHoverItem,i))),t=e.children(":first"),this.checkable&&t&&(t.toggleClass("checkable",this.checkable),t.toggleClass("no-checkmark",!1===this.options.checkmark),t.toggleClass("checked",this.checked),_.isEmpty(this.iconCls)||t.css("background-image","none")),i.options.hint&&(e.attr("data-toggle","tooltip"),e.tooltip({title:i.options.hint,placement:i.options.hintAnchor||function(t,e){var i=this.getPosition(),s=t.offsetWidth,o=t.offsetHeight,n=Common.Utils.innerWidth(),a=Common.Utils.innerHeight(),l=i.top,r=i.left+i.width+2;a<l+o&&(l=a-o-2),n<r+s&&(r=i.left-s-2),$(t).offset({top:l,left:r}).addClass("in")}})),this.cls&&e.addClass(this.cls),this.disabled&&e.toggleClass("disabled",this.disabled),e.on("click",_.bind(this.onItemClick,this)),e.on("mousedown",_.bind(this.onItemMouseDown,this)),Common.UI.ToggleManager.register(i),!1!==i.options.scaling&&i.iconCls&&(e.attr("ratio","ratio"),i.applyScaling(Common.UI.Scaling.currentRatio()),e.on("app:scaling",function(t,e){i.options.scaling!=e.ratio&&i.applyScaling(e.ratio)}))),this.visible||this.setVisible(this.visible),i.rendered=!0,i.trigger("render:after",i),this},setCaption:function(t,e){this.caption=t,this.rendered&&(this.cmpEl.find("> a").contents().last()[0].textContent=e?t:Common.Utils.String.htmlEncode(t))},setIconCls:function(t){var e,i;this.rendered&&!_.isEmpty(this.iconCls)&&(e=this.cmpEl.children(":first"))&&(e.find(".menu-item-icon").removeClass(this.iconCls).addClass(t),(e=e.find("use.zoom-int")).length&&(i=(i=/btn-[^\s]+/.exec(t))?i[0]:"null",e.attr("href","#"+i))),this.iconCls=t},setChecked:function(t,e){this.toggle(t,e)},isChecked:function(){return this.checked},setDisabled:function(t){this.disabled=!!t,this.rendered&&this.cmpEl.toggleClass("disabled",this.disabled)},isDisabled:function(){return this.disabled},toggle:function(t,e){var i,t=void 0===t?!this.checked:!!t;this.checkable&&(this.checked=t,this.rendered&&(i=this.cmpEl.children(":first"))&&(i.toggleClass("checked",this.checked),_.isEmpty(this.iconCls)||i.css("background-image","none")),e||this.trigger("toggle",this,t))},onItemMouseDown:function(t){if(Common.UI.HintManager&&Common.UI.HintManager.clearHints(),1!=t.which)return t.preventDefault(),t.stopPropagation(),!1;t.stopPropagation()},onItemClick:function(t){return(1==t.which||void 0===t.which&&!this.menu)&&(this.disabled||!this.allowDepress&&this.checked&&this.toggleGroup||this.menu||this.setChecked(!this.checked),this.menu?t.target.id!=this.id&&void(this.menu.isOver||this.cmpEl.removeClass("over")):!this.disabled&&void this.trigger("click",this,t))},onHoverItem:function(t){this._doHover(t)},onUnHoverItem:function(t){this._doUnHover(t)},onBlurItem:function(t){this._doUnHover(t)},_doHover:function(t){var e=this;e.menu&&!e.disabled&&(clearTimeout(e.hideMenuTimer),e.cmpEl.trigger("show.bs.dropdown"),e.expandMenuTimer=_.delay(function(){e.cmpEl.addClass("over"),e.cmpEl.trigger("shown.bs.dropdown")},200))},_doUnHover:function(t){var e=this;e.cmpEl.hasClass("dropdown-submenu")&&e.cmpEl.hasClass("over")&&(t&&t.relatedTarget&&0<e.cmpEl.find(t.relatedTarget).length||e.cmpEl.hasClass("focused-submenu"))?e.cmpEl.removeClass("focused-submenu"):e.menu&&!e.disabled&&(clearTimeout(e.expandMenuTimer),e.hideMenuTimer=_.delay(function(){e.menu.isOver||e.cmpEl.removeClass("over")},200),t&&"focusout"!==t.type&&0<(t=e.cmpEl.children(":focus")).length&&(t.blur(),e.cmpEl.closest("ul").focus()))},setMenu:function(t){var e;t&&_.isObject(t)&&_.isFunction(t.render)&&(this.rendered?(this.menu&&(this.menu instanceof Common.UI.Menu||this.menu instanceof Common.UI.MenuSimple)&&(Common.UI.Menu.Manager.unregister(this.menu),this.menu.cmpEl&&this.menu.cmpEl.remove()),this.menu=t,(e=this.cmpEl).addClass("dropdown-submenu"),this.menu.render(e),e.mouseenter(_.bind(this.menu.alignPosition,this.menu)),e.focusout(_.bind(this.onBlurItem,this)),e.hover(_.bind(this.onHoverItem,this),_.bind(this.onUnHoverItem,this))):this.menu=t)},applyScaling:function(t){var e;this.options.scaling!=t&&(this.options.scaling=t,e=this.cmpEl.children(":first"),2<t&&(e.find("svg.menu-item-icon").length||(t=this.iconCls,t=(t=/btn-[^\s]+/.exec(t))?t[0]:"null",t='<svg class="menu-item-icon"><use class="zoom-int" href="#%iconname"></use></svg>'.replace("%iconname",t),e.find("span.menu-item-icon").after(t))))}}),Common.UI.MenuItemSeparator=function(t){return(t=t||{}).caption="--",new Common.UI.MenuItem(t)}}),!function(t){"function"==typeof define&&define.amd?define("jmousewheel",["jquery"],t):"object"==typeof exports?module.exports=t:t(jQuery)}(function(l){var r,c,t=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],e="onwheel"in document||9<=document.documentMode?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],d=Array.prototype.slice;if(l.event.fixHooks)for(var i=t.length;i;)l.event.fixHooks[t[--i]]=l.event.mouseHooks;var s=l.event.special.mousewheel={version:"3.1.9",setup:function(){if(this.addEventListener)for(var t=e.length;t;)this.addEventListener(e[--t],o,!1);else this.onmousewheel=o;l.data(this,"mousewheel-line-height",s.getLineHeight(this)),l.data(this,"mousewheel-page-height",s.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var t=e.length;t;)this.removeEventListener(e[--t],o,!1);else this.onmousewheel=null},getLineHeight:function(t){return parseInt(l(t)["offsetParent"in l.fn?"offsetParent":"parent"]().css("fontSize"),10)},getPageHeight:function(t){return l(t).height()},settings:{adjustOldDeltas:!0}};function o(t){var e,i=t||window.event,s=d.call(arguments,1),o=0,n=0,a=0;if((t=l.event.fix(i)).type="mousewheel","detail"in i&&(a=-1*i.detail),"wheelDelta"in i&&(a=i.wheelDelta),"wheelDeltaY"in i&&(a=i.wheelDeltaY),"wheelDeltaX"in i&&(n=-1*i.wheelDeltaX),"axis"in i&&i.axis===i.HORIZONTAL_AXIS&&(n=-1*a,a=0),o=0===a?n:a,"deltaY"in i&&(o=a=-1*i.deltaY),"deltaX"in i&&(n=i.deltaX,0===a&&(o=-1*n)),0!==a||0!==n)return 1===i.deltaMode?(o*=e=l.data(this,"mousewheel-line-height"),a*=e,n*=e):2===i.deltaMode&&(o*=e=l.data(this,"mousewheel-page-height"),a*=e,n*=e),e=Math.max(Math.abs(a),Math.abs(n)),(!c||e<c)&&p(i,c=e)&&(c/=40),p(i,e)&&(o/=40,n/=40,a/=40),o=Math[1<=o?"floor":"ceil"](o/c),n=Math[1<=n?"floor":"ceil"](n/c),a=Math[1<=a?"floor":"ceil"](a/c),t.deltaX=n,t.deltaY=a,t.deltaFactor=c,t.deltaMode=0,s.unshift(t,o,n,a),r&&clearTimeout(r),r=setTimeout(h,200),(l.event.dispatch||l.event.handle).apply(this,s)}function h(){c=null}function p(t,e){return s.settings.adjustOldDeltas&&"mousewheel"===t.type&&e%120==0}l.fn.extend({mousewheel:function(t){return t?this.bind("mousewheel",t):this.trigger("mousewheel")},unmousewheel:function(t){return this.unbind("mousewheel",t)}})}),!function(t){"use strict";"function"==typeof define&&define.amd?define("perfectscrollbar",["jquery"],t):"object"==typeof exports?t(require("jquery")):t(jQuery)}(function(O){"use strict";var e,N={wheelSpeed:10,wheelPropagation:!1,minScrollbarLength:null,useBothWheelAxes:!1,useKeyboard:!0,suppressScrollX:!1,suppressScrollY:!1,scrollXMarginOffset:0,scrollYMarginOffset:0,includePadding:!1,includeMargin:!0},$=(e=0,function(){var t=e;return e+=1,".perfect-scrollbar-"+t});O.fn.perfectScrollbar=function(B,H){return this.each(function(){var l=O.extend(!0,{},N),d=O(this);if("object"==typeof B?O.extend(!0,l,B):H=B,"update"===H)d.data("perfect-scrollbar-update")&&d.data("perfect-scrollbar-update")();else if("destroy"===H)d.data("perfect-scrollbar-destroy")&&d.data("perfect-scrollbar-destroy")();else{if(d.data("perfect-scrollbar"))return d.data("perfect-scrollbar");d.addClass("ps-container oo");var r,c,s,o,n,a,h,p,i,m,u,g,t,b=O("<div class='ps-scrollbar-x-rail'></div>").appendTo(d),C=O("<div class='ps-scrollbar-y-rail'></div>").appendTo(d),f=O("<div class='ps-scrollbar-x'></div>").appendTo(b),S=O("<div class='ps-scrollbar-y'></div>").appendTo(C),v=parseInt(b.css("bottom"),10),w=parseInt(C.css("right"),10),_=$(),e=function(t,e){t+=e,e=g-m,u=t<0?0:e<t?e:t,e=parseInt(u*(a-o)/(g-m),10);d.scrollTop(e),b.css({bottom:v-e})},x=function(t,e){t+=e,e=i-h,p=t<0?0:e<t?e:t,e=parseInt(p*(n-s)/(i-h),10);d.scrollLeft(e),C.css({right:w-e})},y=function(t){return t=l.minScrollbarLength?Math.max(t,l.minScrollbarLength):t},A=function(){b.css({left:d.scrollLeft(),bottom:v-d.scrollTop(),width:i,display:r?"inherit":"none"}),C.hasClass("in-scrolling")?C.css({right:w-d.scrollLeft(),height:g,display:c?"inherit":"none"}):C.css({top:d.scrollTop(),right:w-d.scrollLeft(),height:g,display:c?"inherit":"none"}),f&&f.css({left:p,width:h}),S&&S.css({top:u,height:m})},T=function(){s=l.includePadding?d.innerWidth():d.width(),o=l.includePadding?d.innerHeight():d.height(),g=o-(l.includeMargin?parseInt(C.css("margin-top"))+parseInt(C.css("margin-bottom")):0),i=s-(l.includeMargin?parseInt(b.css("margin-left"))+parseInt(b.css("margin-right")):0),n=d.prop("scrollWidth"),a=d.prop("scrollHeight"),!l.suppressScrollX&&s+l.scrollXMarginOffset<n?(r=!0,h=y(parseInt(i*s/n,10)),p=parseInt(d.scrollLeft()*(i-h)/(n-s),10)):(r=!1,p=h=0,d.scrollLeft(0)),!l.suppressScrollY&&o+l.scrollYMarginOffset<a?(c=!0,m=y(parseInt(g*o/a,10)),u=parseInt(d.scrollTop()*(g-m)/(a-o),10)):(c=!1,u=m=0,d.scrollTop(0)),g-m<=u&&(u=g-m),i-h<=p&&(p=i-h),A(),l.onChange&&l.onChange(this)},k=function(){var e,i;f.bind("mousedown"+_,function(t){Common.NotificationCenter.trigger("hints:clear"),i=t.pageX,e=f.position().left,b.addClass("in-scrolling"),t.stopPropagation(),t.preventDefault()}),O(document).bind("mousemove"+_,function(t){b.hasClass("in-scrolling")&&(x(e,t.pageX-i),t.stopPropagation(),t.preventDefault())}),O(document).bind("mouseup"+_,function(t){b.hasClass("in-scrolling")&&b.removeClass("in-scrolling")}),e=i=null},E=function(){var s,o;S.bind("mousedown"+_,function(t){Common.NotificationCenter.trigger("hints:clear"),o=t.pageY,s=S.position().top,C.addClass("in-scrolling");var e=parseInt(C.css("margin-top")),i=C[0].getBoundingClientRect();C.css({position:"fixed",left:i.left,top:i.top-e}),t.stopPropagation(),t.preventDefault()}),O(document).bind("mousemove"+_,function(t){C.hasClass("in-scrolling")&&(e(s,t.pageY-o),t.stopPropagation(),t.preventDefault())}),O(document).bind("mouseup"+_,function(t){C.hasClass("in-scrolling")&&(C.removeClass("in-scrolling"),C.css({position:"",left:"",top:""}),A())}),s=o=null},I=function(t,e){var i=d.scrollTop();if(0===t){if(!c)return!1;if(0===i&&0<e||a-o<=i&&e<0)return!l.wheelPropagation}i=d.scrollLeft();if(0===e){if(!r)return!1;if(0===i&&t<0||n-s<=i&&0<t)return!l.wheelPropagation}return!0},D=function(){l.wheelSpeed/=10;var a=!1;d.bind("mousewheel"+_,function(t,e,i,s){Common.NotificationCenter.trigger("hints:clear");var o,n,i=t.deltaX*t.deltaFactor||i,s=t.deltaY*t.deltaFactor||s;t&&t.target&&("textarea"===t.target.type||"input"===t.target.type)?(t.stopImmediatePropagation(),t.preventDefault(),o=O(t.target).scrollTop(),n=0,t.originalEvent?t.originalEvent.wheelDelta?n=t.originalEvent.wheelDelta:t.originalEvent.deltaY?n=40*-t.originalEvent.deltaY:t.originalEvent.detail&&(n=t.originalEvent.detail):n=void 0!==t.wheelDelta?t.wheelDelta:t.deltaY,O(t.target).scrollTop(o-n)):(a=!1,l.useBothWheelAxes?c&&!r?(s?d.scrollTop(d.scrollTop()-s*l.wheelSpeed):d.scrollTop(d.scrollTop()+i*l.wheelSpeed),a=!0):r&&!c&&(i?d.scrollLeft(d.scrollLeft()+i*l.wheelSpeed):d.scrollLeft(d.scrollLeft()-s*l.wheelSpeed),a=!0):(d.scrollTop(d.scrollTop()-s*l.wheelSpeed),d.scrollLeft(d.scrollLeft()+i*l.wheelSpeed)),T(),(a=a||I(i,s))&&(t.stopPropagation(),t.preventDefault()))}),d.bind("MozMousePixelScroll"+_,function(t){a&&t.preventDefault()})},V=function(){var s=!1;d.bind("mouseenter"+_,function(t){s=!0}),d.bind("mouseleave"+_,function(t){s=!1});O(document).bind("keydown"+_,function(t){if(s&&!O(document.activeElement).is(":input,[contenteditable]")){var e=0,i=0;switch(t.which){case 37:e=-30;break;case 38:i=30;break;case 39:e=30;break;case 40:i=-30;break;case 33:i=90;break;case 32:case 34:i=-90;break;case 35:i=-o;break;case 36:i=o;break;default:return}d.scrollTop(d.scrollTop()-i),d.scrollLeft(d.scrollLeft()+e),I(e,i)&&t.preventDefault()}})},P=function(){function t(t){t.stopPropagation()}S.bind("click"+_,t),C.bind("click"+_,function(t){var e=parseInt(m/2,10),t=(t.pageY-C.offset().top-e)/(g-m);t<0?t=0:1<t&&(t=1),d.scrollTop((a-o)*t)}),f.bind("click"+_,t),b.bind("click"+_,function(t){var e=parseInt(h/2,10),t=(t.pageX-b.offset().left-e)/(i-h);t<0?t=0:1<t&&(t=1),d.scrollLeft((n-s)*t)})},F=function(){function n(t,e){d.scrollTop(d.scrollTop()-e),d.scrollLeft(d.scrollLeft()-t),T()}var a={},l=0,r={},i=null,c=!1;O(window).bind("touchstart"+_,function(t){c=!0}),O(window).bind("touchend"+_,function(t){c=!1}),d.bind("touchstart"+_,function(t){var e=t.originalEvent.targetTouches[0];a.pageX=e.pageX,a.pageY=e.pageY,l=(new Date).getTime(),null!==i&&clearInterval(i),t.stopPropagation()}),d.bind("touchmove"+_,function(t){var e,i,s,o;c||1!==t.originalEvent.targetTouches.length||(e=t.originalEvent.targetTouches[0],(s={}).pageX=e.pageX,s.pageY=e.pageY,e=s.pageX-a.pageX,i=s.pageY-a.pageY,n(e,i),a=s,0<(o=(s=(new Date).getTime())-l)&&(r.x=e/o,r.y=i/o,l=s),t.preventDefault())}),d.bind("touchend"+_,function(t){clearInterval(i),i=setInterval(function(){Math.abs(r.x)<.01&&Math.abs(r.y)<.01?clearInterval(i):(n(30*r.x,30*r.y),r.x*=.8,r.y*=.8)},10)})},M=function(){d.bind("scroll"+_,function(t){T()})},R=function(){d.unbind(_),O(window).unbind(_),O(document).unbind(_),d.data("perfect-scrollbar",null),d.data("perfect-scrollbar-update",null),d.data("perfect-scrollbar-destroy",null),f.remove(),S.remove(),b.remove(),C.remove(),f=S=s=o=n=a=h=p=v=m=u=w=null},U=function(t){d.addClass("ie").addClass("ie"+t);function e(){O(this).addClass("hover")}function i(){O(this).removeClass("hover")}6===t&&(d.bind("mouseenter"+_,e).bind("mouseleave"+_,i),b.bind("mouseenter"+_,e).bind("mouseleave"+_,i),C.bind("mouseenter"+_,e).bind("mouseleave"+_,i),f.bind("mouseenter"+_,e).bind("mouseleave"+_,i),S.bind("mouseenter"+_,e).bind("mouseleave"+_,i),A=function(){f.css({left:p+d.scrollLeft(),bottom:v,width:h}),S.css({top:u+d.scrollTop(),right:w,height:m}),f.hide().show(),S.hide().show()})},L="ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch;(t=navigator.userAgent.toLowerCase().match(/(msie) ([\w.]+)/))&&"msie"===t[1]&&U(parseInt(t[2],10)),T(),M(),k(),E(),P(),L&&F(),d.mousewheel&&D(),l.useKeyboard&&V(),d.data("perfect-scrollbar",d),d.data("perfect-scrollbar-update",T),d.data("perfect-scrollbar-destroy",R)}return d})}}),void 0===Common&&(Common={}),define("common/main/lib/component/Scroller",["jmousewheel","perfectscrollbar","common/main/lib/component/BaseView"],function(){"use strict";var s;Common.UI.Scroller=_.extend(Common.UI.BaseView.extend({options:{wheelSpeed:20,wheelPropagation:!1,minScrollbarLength:null,useBothWheelAxes:!1,useKeyboard:!0,suppressScrollX:!1,suppressScrollY:!1,scrollXMarginOffset:5,scrollYMarginOffset:5,includePadding:!0,includeMargin:!0,alwaysVisibleX:!1,alwaysVisibleY:!1,scrollYStyle:null},initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t),this.options.el&&this.render()},render:function(){return this.cmpEl=this.$el||$(this.el),this.rendered||(this.cmpEl.perfectScrollbar(_.extend({},this.options)),this.rendered=!0,this.setAlwaysVisibleX(this.options.alwaysVisibleX),this.setAlwaysVisibleY(this.options.alwaysVisibleY),this.options.scrollYStyle&&this.setOptionStyleY(this.options.scrollYStyle)),this},remove:function(){this.destroy(),Backbone.View.prototype.remove.call(this)},update:function(t){function e(t){function e(t){$(document).unbind("mouseup",e),_.delay(function(){s=!1},10)}s=!0,$(document).mouseup(e)}var i=this.options;t?(this.destroy(),i=_.extend(this.options,t),this.cmpEl.perfectScrollbar(i)):this.cmpEl.perfectScrollbar("update"),this.setAlwaysVisibleX(i.alwaysVisibleX),this.setAlwaysVisibleY(i.alwaysVisibleY),i.scrollYStyle&&this.setOptionStyleY(i.scrollYStyle);$(".ps-scrollbar-x-rail, .ps-scrollbar-y-rail, .ps-scrollbar-x, .ps-scrollbar-y",this.cmpEl).off("mousedown",e).on("mousedown",e)},destroy:function(){this.cmpEl.perfectScrollbar("destroy")},scrollLeft:function(t){this.cmpEl.scrollLeft(t),this.update()},scrollTop:function(t){this.cmpEl.scrollTop(t),this.update()},getScrollTop:function(){return this.cmpEl.scrollTop()},getScrollLeft:function(){return this.cmpEl.scrollLeft()},setAlwaysVisibleX:function(t){t?$(this.el).find(".ps-scrollbar-x-rail").addClass("always-visible-x"):$(this.el).find(".ps-scrollbar-x-rail").removeClass("always-visible-x"),$(this.el).find(".ps-scrollbar-x").addClass("always-visible-x")},setAlwaysVisibleY:function(t){t?$(this.el).find(".ps-scrollbar-y-rail").addClass("always-visible-y"):$(this.el).find(".ps-scrollbar-y-rail").removeClass("always-visible-y"),$(this.el).find(".ps-scrollbar-y").addClass("always-visible-y")},setOptionStyleY:function(t){$(this.el).find(".ps-scrollbar-y-rail").css(t),this.cmpEl.perfectScrollbar("update")},isVisible:function(){return $(this.el).find(".ps-scrollbar-y-rail").is(":visible")}}),{isMouseCapture:function(){return s}})}),void 0===Common&&(Common={}),define("common/main/lib/component/Menu",["common/main/lib/extend/Bootstrap","common/main/lib/component/BaseView","common/main/lib/component/MenuItem","common/main/lib/component/Scroller"],function(){"use strict";var i,s,o;Common.UI.Menu=(i=[],s={},o={register:function(t){(s[t.id]=t).on("show:after",function(t){i.push(t)}).on("hide:after",function(t){t=i.indexOf(t);-1<t&&i.splice(t,1)})},unregister:function(t){var e=i.indexOf(t);delete s[t.id],-1<e&&i.splice(e,1),t.off("show:after").off("hide:after")},hideAll:function(){return Common.NotificationCenter.trigger("menumanager:hideall"),!!(i&&0<i.length)&&(_.each(i,function(t){t&&t.hide()}),!0)}},_.extend(Common.UI.BaseView.extend({options:{cls:"",style:"",itemTemplate:null,items:[],menuAlign:"tl-bl",menuAlignEl:null,offset:[0,0],cyclic:!0,search:!1,scrollAlwaysVisible:!0,scrollToCheckedItem:!0,focusToCheckedItem:!1},template:_.template(['<ul class="dropdown-menu <%= options.cls %>" oo_editor_input="true" style="<%= options.style %>" role="menu"></ul>'].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);var e=this;this.id=this.options.id||Common.UI.getId(),this.itemTemplate=this.options.itemTemplate||Common.UI.MenuItem.prototype.template,this.rendered=!1,this.items=[],this.offset=[0,0],this.menuAlign=this.options.menuAlign,this.menuAlignEl=this.options.menuAlignEl,this.scrollAlwaysVisible=this.options.scrollAlwaysVisible,this.search=this.options.search,this.outerMenu=this.options.outerMenu,Common.UI.isRTL()&&("tl-tr"===this.menuAlign?this.menuAlign="tr-tl":"tl-bl"===this.menuAlign?this.menuAlign="tr-br":"tr-br"===this.menuAlign?this.menuAlign="tl-bl":"bl-tl"===this.menuAlign&&(this.menuAlign="br-tr")),this.options.restoreHeight&&(this.options.restoreHeight="number"==typeof this.options.restoreHeight?this.options.restoreHeight:this.options.maxHeight||1e5,this.options.maxHeight||(this.options.maxHeight=this.options.restoreHeight)),this.options.cyclic||(this.options.cls+=" no-cyclic"),_.each(this.options.items,function(t){t instanceof Common.UI.MenuItem?e.items.push(t):e.items.push(new Common.UI.MenuItem(_.extend({tagName:"li",template:e.itemTemplate},t)))}),this.options.el&&this.render(),o.register(this)},remove:function(){o.unregister(this),Common.UI.BaseView.prototype.remove.call(this)},render:function(t){var e=this,t=(this.trigger("render:before",this),this.cmpEl=e.$el||$(this.el),t?(this.setElement(t,!1),e.rendered||(this.cmpEl=$(this.template({options:e.options})),t.append(this.cmpEl))):e.rendered||(this.cmpEl=this.template({options:e.options}),this.$el.append(this.cmpEl)),this.cmpEl.parent()),i="menu"===t.attr("role")?t:t.find("[role=menu]");return(this.menuRoot=i)&&(e.rendered||(_.each(e.items||[],function(t){i.append(t.render().el),t.on("click",_.bind(e.onItemClick,e)),t.on("toggle",_.bind(e.onItemToggle,e))}),i.on("click",function(t){e.trigger("menu:click",this,t)})),this.options.maxHeight&&(i.css({"max-height":e.options.maxHeight}),this.scroller=new Common.UI.Scroller({el:e.$el.find(".dropdown-menu "),minScrollbarLength:30,suppressScrollX:!0,alwaysVisibleY:this.scrollAlwaysVisible})),i.css({position:"fixed",right:"auto",left:-1e3,top:-1e3}),this.parentEl=i.parent(),this.parentEl.on("show.bs.dropdown",_.bind(e.onBeforeShowMenu,e)),this.parentEl.on("shown.bs.dropdown",_.bind(e.onAfterShowMenu,e)),this.parentEl.on("hide.bs.dropdown",_.bind(e.onBeforeHideMenu,e)),this.parentEl.on("hidden.bs.dropdown",_.bind(e.onAfterHideMenu,e)),this.parentEl.on("keydown.after.bs.dropdown",_.bind(e.onAfterKeydownMenu,e)),this.parentEl.on("keydown.before.bs.dropdown",_.bind(e.onBeforeKeydownMenu,e)),this.options.innerMenus&&this.on("keydown:before",_.bind(e.onBeforeKeyDown,e)),i.hover(function(t){e.isOver=!0},function(t){e.isOver=!1})),this.rendered=!0,this.trigger("render:after",this),this},isVisible:function(){return this.rendered&&this.cmpEl.is(":visible")},show:function(){this.rendered&&this.parentEl&&!this.parentEl.hasClass("open")&&this.cmpEl.dropdown("toggle")},hide:function(){this.rendered&&this.parentEl&&(this.parentEl.hasClass("open")?this.cmpEl.dropdown("toggle"):this.parentEl.hasClass("over")&&this.parentEl.removeClass("over"))},insertItem:function(t,e){var i;this.cmpEl;e instanceof Common.UI.MenuItem||(e=new Common.UI.MenuItem(_.extend({tagName:"li",template:this.itemTemplate},e))),t<0||t>=this.items.length?this.items.push(e):this.items.splice(t,0,e),this.rendered&&(i=this.menuRoot)&&(t<0?i.append(e.render().el):0===t?i.prepend(e.render().el):i.children("li:nth-child("+(t+1)+")").before(e.render().el),e.on("click",_.bind(this.onItemClick,this)),e.on("toggle",_.bind(this.onItemToggle,this)))},addItem:function(t){this.insertItem(-1,t)},removeItem:function(t){var e=this.items.indexOf(t);-1<e&&(this.items.splice(e,1),t.off("click").off("toggle"),t.remove())},removeItems:function(t,e){if(!(t>this.items.length-1)){t+e>this.items.length&&(e=this.items.length-t);for(var i=t;i<t+e;i++)this.items[i].off("click").off("toggle"),this.items[i].remove();this.items.splice(t,e)}},removeAll:function(){_.each(this.items,function(t){t.off("click").off("toggle"),t.remove()}),this.items=[]},onBeforeShowMenu:function(t){Common.NotificationCenter.trigger("menu:show"),this.trigger("show:before",this,t),t&&t.target===t.currentTarget&&this.alignPosition()},onAfterShowMenu:function(t){var e,i,s,o;this.trigger("show:after",this,t),this.scroller&&t&&t.target===t.currentTarget&&(t=this.menuRoot,void 0===this.wheelSpeed&&(i=(i=t.find("> li:first")).length?i.outerHeight():1,this.wheelSpeed=Math.min(Math.floor(t.height()/i)*i/10,20)),this.scroller.update({alwaysVisibleY:this.scrollAlwaysVisible,wheelSpeed:this.wheelSpeed}),(e=t.find("> li .checked")).length&&(o=e.position().top,i=e.outerHeight(),s=t.outerHeight(),this.options.scrollToCheckedItem&&(o<0||s<o+i)&&(o=t.scrollTop()+o+(i-s)/2,o=Math.floor(o/i)*i,t.scrollTop(o)),this.options.focusToCheckedItem&&setTimeout(function(){e.focus()},1))),this._search={}},onBeforeHideMenu:function(t){this.trigger("hide:before",this,t),Common.UI.Scroller.isMouseCapture()&&t.preventDefault()},onAfterHideMenu:function(t,e){this.trigger("hide:after",this,t,e),Common.NotificationCenter.trigger("menu:hide",this,e)},onAfterKeydownMenu:function(t){if(this.trigger("keydown:before",this,t),!t.isDefaultPrevented())if(t.keyCode==Common.UI.Keys.RETURN){var e=$(t.target).closest("li");if(0<(e=e.length<=0?$(t.target).parent().find("li .dataview"):e).length&&e.click(),e.hasClass("dropdown-submenu")||Common.UI.Menu.Manager.hideAll(),$(t.currentTarget).closest("li").hasClass("dropdown-submenu"))return t.stopPropagation(),!1}else{var i;t.keyCode==Common.UI.Keys.UP||t.keyCode==Common.UI.Keys.DOWN?this.fromKeyDown=!0:t.keyCode!=Common.UI.Keys.ESC&&this.search&&64<t.keyCode&&t.keyCode<91&&t.key&&(i=this,clearTimeout(this._search.timer),this._search.timer=setTimeout(function(){i._search={}},1e3),this._search.text||(this._search.text=""),this._search.char||(this._search.char=t.key),this._search.char!==t.key&&(this._search.full=!0),this._search.text+=t.key,void 0===this._search.index&&(e=this.menuRoot.find("> li").find("> a"),this._search.index=e.index(e.filter(":focus"))),this.selectCandidate())}},onBeforeKeydownMenu:function(t){var e,i;t.isDefaultPrevented()||!this.outerMenu||!this.outerMenu.menu||t.keyCode!=Common.UI.Keys.UP&&t.keyCode!=Common.UI.Keys.DOWN||(i=(e=this.menuRoot.find("> li").find("> a")).index(e.filter(":focus")),(t.keyCode==Common.UI.Keys.UP&&0==i||t.keyCode==Common.UI.Keys.DOWN&&i==e.length-1)&&(this.outerMenu.menu.focusOuter(t,this.outerMenu.index),t.preventDefault(),t.stopPropagation()))},selectCandidate:function(){for(var t,e,i,s,o,n=this._search.index&&-1!=this._search.index?this._search.index:0,a=new RegExp("^"+(this._search.full?this._search.text:this._search.char),"i"),l=a.test(this.items[n].caption),r=0;r<this.items.length;r++){var c=this.items[r];if(a.test(c.caption)){if(!t&&(t=c,e=r,!l))break;if(this._search.full&&r==n||n<r){t=c,e=r;break}}}t&&(this._search.index=e,c=t.cmpEl.find("a"),this.scroller&&(this.scroller.update({alwaysVisibleY:this.scrollAlwaysVisible,wheelSpeed:this.wheelSpeed}),i=c.position().top,s=c.outerHeight(),o=this.menuRoot.outerHeight(),(i<0||o<i+s)&&(o=this.menuRoot.scrollTop()+i,o=Math.floor(o/s)*s,this.menuRoot.scrollTop(o))),c.focus())},onBeforeKeyDown:function(t,e){var i,s;e.keyCode==Common.UI.Keys.RETURN?(0<(i=$(e.target).closest("li")).length&&(e.preventDefault(),e.stopPropagation(),i.click()),Common.UI.Menu.Manager.hideAll()):"after.bs.dropdown"===e.namespace||e.keyCode!=Common.UI.Keys.DOWN&&e.keyCode!=Common.UI.Keys.UP||this.menuRoot.length<1||$(e.target).closest("ul[role=menu]").get(0)!==this.menuRoot.get(0)||(s=this.findInnerMenu(e.keyCode))&&s.focusInner&&(e.preventDefault(),e.stopPropagation(),_.delay(function(){s.focusInner(e)},10))},setInnerMenu:function(t){!this.options.innerMenus&&t&&(this.options.innerMenus=t,this.rendered&&this.on("keydown:before",_.bind(this.onBeforeKeyDown,this)))},findInnerMenu:function(t,e,i){if(this.options.innerMenus){var s=$("> li",this.menuRoot),o=$("> li:not(.divider):not(.disabled):visible",this.menuRoot),n=o.length;if(n)for(var a=0;a<n;){var l=void 0!==e?o.index(s.eq(e)):o.index(o.find("> a").filter(":focus").parent()),l=t==Common.UI.Keys.DOWN?l<n-1?l+1:0:0<l?l-1:n-1,l=o.eq(l);e=s.index(l);for(var r=0;r<this.options.innerMenus.length;r++){var c=this.options.innerMenus[r];if(c&&c.menu&&c.index==e)return c.menu}if(0<l.find("> a").length)return i?l:void 0;a++}}},focusInner:function(t){(t.keyCode==Common.UI.Keys.UP?this.items[this.items.length-1]:this.items[0]).cmpEl.find("> a").focus()},focusOuter:function(t,e){var i,s,o=this.findInnerMenu(t.keyCode,e,!0);o&&o.focusInner?_.delay(function(){o.focusInner(t)},10):o?o.find("> a").focus():(s=(i=$("> li:not(.divider):not(.disabled):visible",this.menuRoot).find("> a")).length)&&i.eq(t.keyCode==Common.UI.Keys.UP?e<0?s-1:e:s-1<=e?0:e+1).focus()},onItemClick:function(t,e){var i;t.menu||(this.isOver=!1),t.options.stopPropagation?(e.stopPropagation(),i=this,_.delay(function(){i.$el.parent().parent().find("[data-toggle=dropdown]").focus()},10)):this.trigger("item:click",this,t,e)},onItemToggle:function(t,e,i){this.trigger("item:toggle",this,t,e,i)},setOffset:function(t,e){this.offset[0]=_.isUndefined(t)?this.offset[0]:t,this.offset[1]=_.isUndefined(e)?this.offset[1]:e,this.alignPosition()},getOffset:function(){return this.offset},alignPosition:function(t,e){var i,s=this.menuRoot,o=this.menuAlignEl||s.parent(),n=this.menuAlign.match(/^([a-z]+)-([a-z]+)/),a=o.offset(),l=Common.Utils.innerWidth()-10,r=Common.Utils.innerHeight()-10,c=s.outerWidth(),d=s.outerHeight(),h=o.outerWidth(),p=o.outerHeight(),m={tl:[0,0],bl:[0,d],tr:[c,0],br:[c,d]},p={tl:[0,0],tr:[h,0],bl:[0,p],br:[h,p]},u=a.left-m[n[1]][0]+p[n[2]][0]+this.offset[0],g=a.top-m[n[1]][1]+p[n[2]][1]+this.offset[1];l<u+c?u=o.is("li.dropdown-submenu")?a.left-c+2:l-c:u<0&&(u=o.is("li.dropdown-submenu")?a.left+h-2:0),u<0&&(u=0),this.options.restoreHeightAndTop?(r=(i=Common.Utils.croppedGeometry()).height-10,s.css("max-height","none"),(g=(g=g+(d=s.outerHeight())>r+i.top?r-d:g)<i.top?i.top:g)+d>r+i.top&&(s.css("max-height",r-g+"px"),this.scroller||(this.scroller=new Common.UI.Scroller({el:this.$el.find("> .dropdown-menu "),minScrollbarLength:30,suppressScrollX:!0,alwaysVisibleY:this.scrollAlwaysVisible})),this.wheelSpeed=void 0),this.scroller&&this.scroller.update({alwaysVisibleY:this.scrollAlwaysVisible})):this.options.restoreHeight?"number"==typeof this.options.restoreHeight&&(r<g+d?(s.css("max-height",r-g+"px"),this.scroller||(this.scroller=new Common.UI.Scroller({el:this.$el.find(".dropdown-menu "),minScrollbarLength:30,suppressScrollX:!0,alwaysVisibleY:this.scrollAlwaysVisible})),this.wheelSpeed=void 0):g+d<r&&s.height()<this.options.restoreHeight&&(s.css("max-height",Math.min(r-g,this.options.restoreHeight)+"px"),this.wheelSpeed=void 0)):(g=g+d>(r=(i=Common.Utils.croppedGeometry()).height-10)+i.top?t&&"string"==typeof t?(n=t.match(/^([a-z]+)-([a-z]+)/),a.top-m[n[1]][1]+p[n[2]][1]+this.offset[1]+(e||0)):r-d:g)<i.top&&(g=i.top),this.options.additionalAlign?this.options.additionalAlign.call(this,s,u,g):(l={left:u,top:g},d<r||(l["margin-top"]=0),s.css(l))},getChecked:function(){for(var t=0;t<this.items.length;t++){var e=this.items[t];if(e.isChecked&&e.isChecked())return e}},clearAll:function(){_.each(this.items,function(t){t.setChecked&&t.setChecked(!1,!0)})}}),{Manager:o})),Common.UI.MenuSimple=Common.UI.BaseView.extend({options:{cls:"",style:"",itemTemplate:null,items:[],menuAlign:"tl-bl",menuAlignEl:null,offset:[0,0],cyclic:!0,search:!1,scrollAlwaysVisible:!0,scrollToCheckedItem:!0,focusToCheckedItem:!1},template:_.template(['<ul class="dropdown-menu <%= options.cls %>" oo_editor_input="true" style="<%= options.style %>" role="menu">',"<% _.each(items, function(item) { %>","<% if (!item.id) item.id = Common.UI.getId(); %>","<% item.checked = item.checked || false;  %>","<li><%= itemTemplate(item) %></li>","<% }) %>","</ul>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);this.id=this.options.id||Common.UI.getId(),this.itemTemplate=this.options.itemTemplate||_.template(['<a id="<%= id %>" <% if(typeof style !== "undefined") { %> style="<%= style %>" <% } %>','<% if(typeof canFocused !== "undefined") { %> tabindex="-1" type="menuitem" <% } %>','<% if(typeof stopPropagation !== "undefined") { %> data-stopPropagation="true" <% } %>','class="<% if (checked) { %> checked <% } %>" >','<% if (typeof iconCls !== "undefined") { %>','<span class="menu-item-icon <%= iconCls %>"></span>',"<% } %>","<%= caption %>","</a>"].join("")),this.rendered=!1,this.items=this.options.items||[],this.offset=[0,0],this.menuAlign=this.options.menuAlign,this.menuAlignEl=this.options.menuAlignEl,this.scrollAlwaysVisible=this.options.scrollAlwaysVisible,this.search=this.options.search,Common.UI.isRTL()&&("tl-tr"===this.menuAlign?this.menuAlign="tr-tl":"tl-bl"===this.menuAlign?this.menuAlign="tr-br":"tr-br"===this.menuAlign?this.menuAlign="tl-bl":"bl-tl"===this.menuAlign&&(this.menuAlign="br-tr")),this.options.restoreHeight&&(this.options.restoreHeight="number"==typeof this.options.restoreHeight?this.options.restoreHeight:this.options.maxHeight||1e5,this.options.maxHeight||(this.options.maxHeight=this.options.restoreHeight)),this.options.cyclic||(this.options.cls+=" no-cyclic"),this.options.el&&this.render(),Common.UI.Menu.Manager.register(this)},remove:function(){Common.UI.Menu.Manager.unregister(this),Common.UI.BaseView.prototype.remove.call(this)},render:function(t){var e=this,t=(this.trigger("render:before",this),this.cmpEl=e.$el||$(this.el),t&&this.setElement(t,!1),e.rendered||(this.cmpEl=$(this.template({items:e.items,itemTemplate:e.itemTemplate,options:e.options})),(t||this.$el).append(this.cmpEl)),this.cmpEl.parent()),t="menu"===t.attr("role")?t:t.find("[role=menu]");return(this.menuRoot=t)&&(e.rendered||(t.on("click","li",_.bind(e.onItemClick,e)),t.on("mousedown","li",_.bind(e.onItemMouseDown,e))),this.options.maxHeight&&(t.css({"max-height":e.options.maxHeight}),this.scroller=new Common.UI.Scroller({el:e.$el.find(".dropdown-menu "),minScrollbarLength:30,suppressScrollX:!0,alwaysVisibleY:this.scrollAlwaysVisible})),t.css({position:"fixed",right:"auto",left:-1e3,top:-1e3}),this.parentEl=t.parent(),this.parentEl.on("show.bs.dropdown",_.bind(e.onBeforeShowMenu,e)),this.parentEl.on("shown.bs.dropdown",_.bind(e.onAfterShowMenu,e)),this.parentEl.on("hide.bs.dropdown",_.bind(e.onBeforeHideMenu,e)),this.parentEl.on("hidden.bs.dropdown",_.bind(e.onAfterHideMenu,e)),this.parentEl.on("keydown.after.bs.dropdown",_.bind(e.onAfterKeydownMenu,e)),t.hover(function(t){e.isOver=!0},function(t){e.isOver=!1})),this.rendered=!0,this.trigger("render:after",this),this},resetItems:function(t){this.items=t||[],this.$items=null;t=_.template(["<% _.each(items, function(item) { %>","<% if (!item.id) item.id = Common.UI.getId(); %>","<% item.checked = item.checked || false;  %>","<li><%= itemTemplate(item) %></li>","<% }) %>"].join(""));this.cmpEl&&this.cmpEl.html(t({items:this.items,itemTemplate:this.itemTemplate,options:this.options}))},isVisible:function(){return this.rendered&&this.cmpEl.is(":visible")},show:function(){this.rendered&&this.parentEl&&!this.parentEl.hasClass("open")&&this.cmpEl.dropdown("toggle")},hide:function(){this.rendered&&this.parentEl&&(this.parentEl.hasClass("open")?this.cmpEl.dropdown("toggle"):this.parentEl.hasClass("over")&&this.parentEl.removeClass("over"))},onItemClick:function(t){if(1!=t.which&&void 0!==t.which)return!1;var e,i=$(t.currentTarget).closest("li").index(),s=0<=i?this.items[i]:null;if(s){if(s.disabled)return!1;s.checkable&&!s.checked&&this.setChecked(i,!s.checked),this.isOver=!1,s.stopPropagation?(t.stopPropagation(),e=this,_.delay(function(){e.$el.parent().parent().find("[data-toggle=dropdown]").focus()},10)):this.trigger("item:click",this,s,t)}},onItemMouseDown:function(t){if(1!=t.which)return t.preventDefault(),t.stopPropagation(),!1;t.stopPropagation()},setChecked:function(t,e,i){this.toggle(t,e,i)},toggle:function(t,e,i){var s,e=!!e,t=this.items[t];this.clearAll(),t&&t.checkable&&(t.checked=e,this.rendered&&(s=t.el||this.cmpEl.find("#"+t.id))&&(s.toggleClass("checked",t.checked),_.isEmpty(t.iconCls)||s.css("background-image","none")),i||this.trigger("item:toggle",this,t,e))},setDisabled:function(t){this.disabled=!!t,this.rendered&&this.cmpEl.toggleClass("disabled",this.disabled)},isDisabled:function(){return this.disabled},onBeforeShowMenu:function(t){Common.NotificationCenter.trigger("menu:show"),this.trigger("show:before",this,t),t&&t.target===t.currentTarget&&this.alignPosition()},onAfterShowMenu:function(t){var e,i,s,o,n;this.trigger("show:after",this,t),this.scroller&&t&&t.target===t.currentTarget&&(this.scroller.update({alwaysVisibleY:this.scrollAlwaysVisible}),t=this.menuRoot,(e=t.find("> li .checked")).length&&(o=e.position().top,i=e.outerHeight(),s=t.outerHeight(),this.options.scrollToCheckedItem&&(o<0||s<o+i)&&(o=t.scrollTop()+o+(i-s)/2,o=Math.floor(o/i)*i,t.scrollTop(o)),this.options.focusToCheckedItem&&setTimeout(function(){e.focus()},1))),this._search={},this.search&&!this.$items&&((n=this).$items=this.menuRoot.find("> li").find("> a"),_.each(this.$items,function(t,e){n.items[e].el=$(t)}))},onBeforeHideMenu:function(t){this.trigger("hide:before",this,t),Common.UI.Scroller.isMouseCapture()&&t.preventDefault()},onAfterHideMenu:function(t,e){this.trigger("hide:after",this,t,e),Common.NotificationCenter.trigger("menu:hide",this,e)},onAfterKeydownMenu:function(t){if(t.keyCode==Common.UI.Keys.RETURN){var e=$(t.target).closest("li");if(0<(e=e.length<=0?$(t.target).parent().find("li .dataview"):e).length&&e.click(),e.hasClass("dropdown-submenu")||Common.UI.Menu.Manager.hideAll(),$(t.currentTarget).closest("li").hasClass("dropdown-submenu"))return t.stopPropagation(),!1}else{var i;t.keyCode==Common.UI.Keys.UP||t.keyCode==Common.UI.Keys.DOWN?this.fromKeyDown=!0:t.keyCode!=Common.UI.Keys.ESC&&this.search&&64<t.keyCode&&t.keyCode<91&&t.key&&(i=this,clearTimeout(this._search.timer),this._search.timer=setTimeout(function(){i._search={}},1e3),this._search.text||(this._search.text=""),this._search.char||(this._search.char=t.key),this._search.char!==t.key&&(this._search.full=!0),this._search.text+=t.key,void 0===this._search.index&&(this._search.index=this.$items.index(this.$items.filter(":focus"))),this.selectCandidate())}},selectCandidate:function(){for(var t,e,i,s,o,n=this._search.index&&-1!=this._search.index?this._search.index:0,a=new RegExp("^"+(this._search.full?this._search.text:this._search.char),"i"),l=a.test(this.items[n].caption),r=0;r<this.items.length;r++){var c=this.items[r];if(a.test(c.caption)){if(!t&&(t=c,e=r,!l))break;if(this._search.full&&r==n||n<r){t=c,e=r;break}}}t&&(this._search.index=e,c=t.el,this.scroller&&(this.scroller.update({alwaysVisibleY:this.scrollAlwaysVisible}),i=c.position().top,s=c.outerHeight(),o=this.menuRoot.outerHeight(),(i<0||o<i+s)&&(o=this.menuRoot.scrollTop()+i,o=Math.floor(o/s)*s,this.menuRoot.scrollTop(o))),c.focus())},setOffset:function(t,e){this.offset[0]=_.isUndefined(t)?this.offset[0]:t,this.offset[1]=_.isUndefined(e)?this.offset[1]:e,this.alignPosition()},getOffset:function(){return this.offset},alignPosition:function(t,e){var i=this.menuRoot,s=this.menuAlignEl||i.parent(),o=this.menuAlign.match(/^([a-z]+)-([a-z]+)/),n=s.offset(),a=Common.Utils.innerWidth(),l=Common.Utils.innerHeight()-10,r=i.outerWidth(),c=i.outerHeight(),d=s.outerWidth(),h=s.outerHeight(),p={tl:[0,0],bl:[0,c],tr:[r,0],br:[r,c]},h={tl:[0,0],tr:[d,0],bl:[0,h],br:[d,h]},m=n.left-p[o[1]][0]+h[o[2]][0]+this.offset[0],u=n.top-p[o[1]][1]+h[o[2]][1]+this.offset[1];a<m+r?m=s.is("li.dropdown-submenu")?n.left-r+2:a-r:m<0&&(m=s.is("li.dropdown-submenu")?n.left+d-2:0),m<0&&(m=0),this.options.restoreHeight?"number"==typeof this.options.restoreHeight&&(l<u+c?(i.css("max-height",l-u+"px"),this.scroller||(this.scroller=new Common.UI.Scroller({el:this.$el.find(".dropdown-menu "),minScrollbarLength:30,suppressScrollX:!0,alwaysVisibleY:this.scrollAlwaysVisible}))):u+c<l&&i.height()<this.options.restoreHeight&&i.css("max-height",Math.min(l-u,this.options.restoreHeight)+"px")):(u=l<u+c?t&&"string"==typeof t?(o=t.match(/^([a-z]+)-([a-z]+)/),n.top-p[o[1]][1]+h[o[2]][1]+this.offset[1]+(e||0)):l-c:u)<0&&(u=0),this.options.additionalAlign?this.options.additionalAlign.call(this,i,m,u):i.css({left:Math.ceil(m),top:Math.ceil(u)})},clearAll:function(){this.cmpEl&&this.cmpEl.find("li > a.checked").removeClass("checked"),_.each(this.items,function(t){t.checked=!1})}})}),define("spreadsheeteditor/main/app/view/DocumentHolder",["jquery","underscore","backbone","gateway","common/main/lib/component/Menu"],function(i,e,t,s){"use strict";SSE.Views.DocumentHolder=t.View.extend(e.extend({el:"#editor_sdk",template:null,events:{},initialize:function(){var e=this;e._preventCustomClick=null,e._hasCustomItems=!1,this.setApi=function(t){return e.api=t,e}},render:function(){return this.fireEvent("render:before",this),this.cmpEl=i(this.el),this.fireEvent("render:after",this),this},focus:function(){var t=this;e.defer(function(){t.cmpEl&&t.cmpEl.focus()},50)},createDelayedElementsViewer:function(){var s=this;s.menuViewCopy=new Common.UI.MenuItem({iconCls:"menu__icon btn-copy",caption:s.txtCopy,value:"copy"}),s.menuViewUndo=new Common.UI.MenuItem({iconCls:"menu__icon btn-undo",caption:s.textUndo}),s.menuViewCopySeparator=new Common.UI.MenuItem({caption:"--"}),s.menuViewAddComment=new Common.UI.MenuItem({iconCls:"menu__icon btn-menu-comments",id:"id-context-menu-item-view-add-comment",caption:s.txtAddComment}),s.menuSignatureViewSign=new Common.UI.MenuItem({caption:this.strSign,value:0}),s.menuSignatureDetails=new Common.UI.MenuItem({caption:this.strDetails,value:1}),s.menuSignatureViewSetup=new Common.UI.MenuItem({caption:this.strSetup,value:2}),s.menuSignatureRemove=new Common.UI.MenuItem({caption:this.strDelete,value:3}),s.menuViewSignSeparator=new Common.UI.MenuItem({caption:"--"}),this.viewModeMenu=new Common.UI.Menu({cls:"shifted-right",items:[s.menuViewCopy,s.menuViewUndo,s.menuViewCopySeparator,s.menuSignatureViewSign,s.menuSignatureDetails,s.menuSignatureViewSetup,s.menuSignatureRemove,s.menuViewSignSeparator,s.menuViewAddComment]}).on("hide:after",function(t,e,i){s.clearCustomItems(t)}),s.fireEvent("createdelayedelements",[s,"view"])},createDelayedElements:function(){var s=this,t=(s.pmiCut=new Common.UI.MenuItem({iconCls:"menu__icon btn-cut",caption:s.txtCut,value:"cut"}),s.pmiCopy=new Common.UI.MenuItem({iconCls:"menu__icon btn-copy",caption:s.txtCopy,value:"copy"}),s.pmiPaste=new Common.UI.MenuItem({iconCls:"menu__icon btn-paste",caption:s.txtPaste,value:"paste"}),s.pmiSelectTable=new Common.UI.MenuItem({caption:s.txtSelect,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:this.selectRowText,value:Asc.c_oAscChangeSelectionFormatTable.row},{caption:this.selectColumnText,value:Asc.c_oAscChangeSelectionFormatTable.column},{caption:this.selectDataText,value:Asc.c_oAscChangeSelectionFormatTable.data},{caption:this.selectTableText,value:Asc.c_oAscChangeSelectionFormatTable.all}]})}),s.pmiInsertEntire=new Common.UI.MenuItem({caption:s.txtInsert}),s.pmiInsertCells=new Common.UI.MenuItem({iconCls:"menu__icon btn-addcell",caption:s.txtInsert,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:s.txtShiftRight,value:Asc.c_oAscInsertOptions.InsertCellsAndShiftRight},{caption:s.txtShiftDown,value:Asc.c_oAscInsertOptions.InsertCellsAndShiftDown},{caption:s.txtRow,value:Asc.c_oAscInsertOptions.InsertRows},{caption:s.txtColumn,value:Asc.c_oAscInsertOptions.InsertColumns}]})}),s.pmiInsertTable=new Common.UI.MenuItem({iconCls:"menu__icon btn-addcell",caption:s.txtInsert,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:s.insertColumnLeftText,value:Asc.c_oAscInsertOptions.InsertTableColLeft},{caption:s.insertColumnRightText,value:Asc.c_oAscInsertOptions.InsertTableColRight},{caption:s.insertRowAboveText,value:Asc.c_oAscInsertOptions.InsertTableRowAbove},{caption:s.insertRowBelowText,value:Asc.c_oAscInsertOptions.InsertTableRowBelow}]})}),s.pmiDeleteEntire=new Common.UI.MenuItem({caption:s.txtDelete}),s.pmiDeleteCells=new Common.UI.MenuItem({iconCls:"menu__icon btn-delcell",caption:s.txtDelete,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:s.txtShiftLeft,value:Asc.c_oAscDeleteOptions.DeleteCellsAndShiftLeft},{caption:s.txtShiftUp,value:Asc.c_oAscDeleteOptions.DeleteCellsAndShiftTop},{caption:s.txtRow,value:Asc.c_oAscDeleteOptions.DeleteRows},{caption:s.txtColumn,value:Asc.c_oAscDeleteOptions.DeleteColumns}]})}),s.pmiDeleteTable=new Common.UI.MenuItem({iconCls:"menu__icon btn-delcell",caption:s.txtDelete,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:this.deleteRowText,value:Asc.c_oAscDeleteOptions.DeleteRows},{caption:this.deleteColumnText,value:Asc.c_oAscDeleteOptions.DeleteColumns},{caption:this.deleteTableText,value:Asc.c_oAscDeleteOptions.DeleteTable}]})}),s.pmiClear=new Common.UI.MenuItem({iconCls:"menu__icon btn-clearstyle",caption:s.txtClear,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:s.txtClearAll,value:Asc.c_oAscCleanOptions.All},{caption:s.txtClearText,value:Asc.c_oAscCleanOptions.Text},{caption:s.txtClearFormat,value:Asc.c_oAscCleanOptions.Format},{caption:s.txtClearComments,value:Asc.c_oAscCleanOptions.Comments},{caption:s.txtClearHyper,value:Asc.c_oAscCleanOptions.Hyperlinks}]})}),s.pmiSortCells=new Common.UI.MenuItem({caption:s.txtSort,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{iconCls:"menu__icon btn-sort-down",caption:s.txtAscending,value:Asc.c_oAscSortOptions.Ascending},{iconCls:"menu__icon btn-sort-up",caption:s.txtDescending,value:Asc.c_oAscSortOptions.Descending},{caption:s.txtSortCellColor,value:Asc.c_oAscSortOptions.ByColorFill},{caption:s.txtSortFontColor,value:Asc.c_oAscSortOptions.ByColorFont},{caption:s.txtCustomSort,value:"advanced"}]})}),s.pmiFilterCells=new Common.UI.MenuItem({iconCls:"menu__icon btn-autofilter",caption:s.txtFilter,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:s.txtFilterValue,value:0},{caption:s.txtFilterCellColor,value:1},{caption:s.txtFilterFontColor,value:2}]})}),s.pmiReapply=new Common.UI.MenuItem({caption:s.txtReapply}),s.mnuRefreshPivot=new Common.UI.MenuItem({caption:s.txtRefresh}),s.mnuGroupPivot=new Common.UI.MenuItem({caption:this.txtGroup,value:"grouping"}),s.mnuUnGroupPivot=new Common.UI.MenuItem({caption:this.txtUngroup,value:"ungrouping"}),s.mnuPivotSettings=new Common.UI.MenuItem({caption:this.txtPivotSettings}),s.mnuFieldSettings=new Common.UI.MenuItem({caption:this.txtFieldSettings}),s.mnuPivotFilter=new Common.UI.MenuItem({caption:this.txtFilter,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:s.txtClear,value:"clear"},{caption:"--"},{caption:s.txtTop10,value:"top10"},{caption:s.txtValueFilter,value:"value"},{caption:s.txtLabelFilter,value:"label"}]})}),s.mnuPivotSort=new Common.UI.MenuItem({caption:this.txtSort,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{iconCls:"menu__icon btn-sort-down",caption:s.txtAscending,value:Asc.c_oAscSortOptions.Ascending},{iconCls:"menu__icon btn-sort-up",caption:s.txtDescending,value:Asc.c_oAscSortOptions.Descending},{caption:s.txtSortOption,value:"advanced"}]})}),s.mnuDeleteField=new Common.UI.MenuItem({caption:this.txtDelField}),s.mnuSubtotalField=new Common.UI.MenuItem({caption:this.txtSubtotalField,checkable:!0,allowDepress:!0}),s.mnuSummarize=new Common.UI.MenuItem({caption:this.txtSummarize,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:s.txtSum,value:Asc.c_oAscDataConsolidateFunction.Sum,checkable:!0},{caption:s.txtCount,value:Asc.c_oAscDataConsolidateFunction.Count,checkable:!0},{caption:s.txtAverage,value:Asc.c_oAscDataConsolidateFunction.Average,checkable:!0},{caption:s.txtMax,value:Asc.c_oAscDataConsolidateFunction.Max,checkable:!0},{caption:s.txtMin,value:Asc.c_oAscDataConsolidateFunction.Min,checkable:!0},{caption:s.txtProduct,value:Asc.c_oAscDataConsolidateFunction.Product,checkable:!0},{caption:"--"},{caption:s.txtMoreOptions,value:-1}]})}),s.mnuShowAs=new Common.UI.MenuItem({caption:this.txtShowAs,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:s.txtNormal,value:Asc.c_oAscShowDataAs.Normal,numFormat:Asc.c_oAscNumFormatType.General,checkable:!0},{caption:s.txtPercentOfGrand,value:Asc.c_oAscShowDataAs.PercentOfTotal,numFormat:Asc.c_oAscNumFormatType.Percent,checkable:!0},{caption:s.txtPercentOfCol,value:Asc.c_oAscShowDataAs.PercentOfCol,numFormat:Asc.c_oAscNumFormatType.Percent,checkable:!0},{caption:s.txtPercentOfTotal,value:Asc.c_oAscShowDataAs.PercentOfRow,numFormat:Asc.c_oAscNumFormatType.Percent,checkable:!0},{caption:s.txtPercent,value:Asc.c_oAscShowDataAs.Percent,numFormat:Asc.c_oAscNumFormatType.Percent,showMore:!0,checkable:!0},{caption:s.txtPercentOfParentRow,value:Asc.c_oAscShowDataAs.PercentOfParentRow,numFormat:Asc.c_oAscNumFormatType.Percent,checkable:!0},{caption:s.txtPercentOfParentCol,value:Asc.c_oAscShowDataAs.PercentOfParentCol,numFormat:Asc.c_oAscNumFormatType.Percent,checkable:!0},{caption:s.txtPercentOfParent,value:Asc.c_oAscShowDataAs.PercentOfParent,numFormat:Asc.c_oAscNumFormatType.Percent,showMore:!0,checkable:!0},{caption:s.txtDifference,value:Asc.c_oAscShowDataAs.Difference,numFormat:Asc.c_oAscNumFormatType.General,showMore:!0,checkable:!0},{caption:s.txtPercentDiff,value:Asc.c_oAscShowDataAs.PercentDiff,numFormat:Asc.c_oAscNumFormatType.Percent,showMore:!0,checkable:!0},{caption:s.txtRunTotal,value:Asc.c_oAscShowDataAs.RunTotal,numFormat:Asc.c_oAscNumFormatType.General,showMore:!0,checkable:!0},{caption:s.txtPercentOfRunTotal,value:Asc.c_oAscShowDataAs.PercentOfRunningTotal,numFormat:Asc.c_oAscNumFormatType.Percent,showMore:!0,checkable:!0},{caption:s.txtRankAscending,value:Asc.c_oAscShowDataAs.RankAscending,numFormat:Asc.c_oAscNumFormatType.General,showMore:!0,checkable:!0},{caption:s.txtRankDescending,value:Asc.c_oAscShowDataAs.RankDescending,numFormat:Asc.c_oAscNumFormatType.General,showMore:!0,checkable:!0},{caption:s.txtIndex,value:Asc.c_oAscShowDataAs.Index,numFormat:Asc.c_oAscNumFormatType.General,checkable:!0},{caption:"--"},{caption:s.txtMoreOptions,value:-1}]})}),s.mnuShowDetails=new Common.UI.MenuItem({caption:s.txtShowDetails}),s.mnuPivotRefreshSeparator=new Common.UI.MenuItem({caption:"--"}),s.mnuPivotSubtotalSeparator=new Common.UI.MenuItem({caption:"--"}),s.mnuPivotGroupSeparator=new Common.UI.MenuItem({caption:"--"}),s.mnuPivotDeleteSeparator=new Common.UI.MenuItem({caption:"--"}),s.mnuPivotValueSeparator=new Common.UI.MenuItem({caption:"--"}),s.mnuPivotFilterSeparator=new Common.UI.MenuItem({caption:"--"}),s.mnuShowDetailsSeparator=new Common.UI.MenuItem({caption:"--"}),s.pmiInsFunction=new Common.UI.MenuItem({iconCls:"menu__icon btn-function",caption:s.txtFormula}),s.menuAddHyperlink=new Common.UI.MenuItem({iconCls:"menu__icon btn-inserthyperlink",caption:s.txtInsHyperlink,inCell:!0}),s.menuEditHyperlink=new Common.UI.MenuItem({caption:s.editHyperlinkText,inCell:!0}),s.menuRemoveHyperlink=new Common.UI.MenuItem({caption:s.removeHyperlinkText}),s.menuHyperlink=new Common.UI.MenuItem({iconCls:"menu__icon btn-inserthyperlink",caption:s.txtInsHyperlink,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[s.menuEditHyperlink,s.menuRemoveHyperlink]})}),s.pmiRowHeight=new Common.UI.MenuItem({caption:s.txtRowHeight,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:s.txtAutoRowHeight,value:"auto-row-height"},{caption:s.txtCustomRowHeight,value:"row-height"}]})}),s.pmiColumnWidth=new Common.UI.MenuItem({caption:s.txtColumnWidth,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:s.txtAutoColumnWidth,value:"auto-column-width"},{caption:s.txtCustomColumnWidth,value:"column-width"}]})}),s.pmiEntireHide=new Common.UI.MenuItem({caption:s.txtHide}),s.pmiEntireShow=new Common.UI.MenuItem({caption:s.txtShow}),s.pmiAddComment=new Common.UI.MenuItem({iconCls:"menu__icon btn-menu-comments",id:"id-context-menu-item-add-comment",caption:s.txtAddComment}),s.pmiAddCommentSeparator=new Common.UI.MenuItem({caption:"--"}),s.pmiCellMenuSeparator=new Common.UI.MenuItem({caption:"--"}),s.pmiFunctionSeparator=new Common.UI.MenuItem({caption:"--"}),s.pmiFreezeSeparator=new Common.UI.MenuItem({caption:"--"}),s.pmiAddNamedRange=new Common.UI.MenuItem({id:"id-context-menu-item-add-named-range",caption:s.txtAddNamedRange}),s.pmiFreezePanes=new Common.UI.MenuItem({caption:s.textFreezePanes}),s.pmiEntriesList=new Common.UI.MenuItem({caption:s.textEntriesList}),s.pmiSparklines=new Common.UI.MenuItem({caption:s.txtSparklines,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:s.txtClearSparklines,value:Asc.c_oAscCleanOptions.Sparklines},{caption:s.txtClearSparklineGroups,value:Asc.c_oAscCleanOptions.SparklineGroups}]})}),e.template('<a id="<%= id %>" tabindex="-1" type="menuitem"><div style="position: relative;"><div class="display-value"><%= caption %></div><label class="example-val" style="cursor: pointer;"><%= options.exampleval ? options.exampleval : "" %></label></div></a>')),t=(s.pmiNumFormat=new Common.UI.MenuItem({caption:s.txtNumFormat,menu:new Common.UI.Menu({cls:"shifted-right format-num-cls",menuAlign:"tl-tr",items:[{caption:this.txtGeneral,template:t,format:"General",exampleval:"100",value:Asc.c_oAscNumFormatType.General},{caption:this.txtNumber,template:t,format:"0.00",exampleval:"100,00",value:Asc.c_oAscNumFormatType.Number},{caption:this.txtScientific,template:t,format:"0.00E+00",exampleval:"1,00E+02",value:Asc.c_oAscNumFormatType.Scientific},{caption:this.txtAccounting,template:t,format:'_($* #,##0.00_);_($* (#,##0.00);_($* "-"??_);_(@_)',exampleval:"100,00 $",value:Asc.c_oAscNumFormatType.Accounting},{caption:this.txtCurrency,template:t,format:"$#,##0.00",exampleval:"100,00 $",value:Asc.c_oAscNumFormatType.Currency},{caption:this.txtDateShort,template:t,format:"MM-dd-yyyy",exampleval:"04-09-1900",value:Asc.c_oAscNumFormatType.Date},{caption:this.txtDateLong,template:t,format:"MMMM d yyyy",exampleval:"April 9 1900",value:Asc.c_oAscNumFormatType.Date},{caption:this.txtTime,template:t,format:"HH:MM:ss",exampleval:"00:00:00",value:Asc.c_oAscNumFormatType.Time},{caption:this.txtPercentage,template:t,format:"0.00%",exampleval:"100,00%",value:Asc.c_oAscNumFormatType.Percent},{caption:this.txtFraction,template:t,format:"# ?/?",exampleval:"100",value:Asc.c_oAscNumFormatType.Fraction},{caption:this.txtText,template:t,format:"@",exampleval:"100",value:Asc.c_oAscNumFormatType.Text},{caption:"--"},s.pmiAdvancedNumFormat=new Common.UI.MenuItem({caption:s.textMoreFormats,value:"advanced"})]})}),s.pmiCondFormat=new Common.UI.MenuItem({caption:s.txtCondFormat}),s.pmiGetRangeList=new Common.UI.MenuItem({caption:s.txtGetLink}),s.ssMenu=new Common.UI.Menu({cls:"shifted-right",restoreHeightAndTop:!0,scrollToCheckedItem:!1,id:"id-context-menu-cell",items:[s.pmiCut,s.pmiCopy,s.pmiPaste,{caption:"--"},s.pmiSelectTable,s.pmiInsertEntire,s.pmiInsertCells,s.pmiInsertTable,s.pmiDeleteEntire,s.pmiDeleteCells,s.pmiDeleteTable,s.pmiClear,{caption:"--"},s.pmiSparklines,s.pmiSortCells,s.pmiFilterCells,s.pmiReapply,s.mnuRefreshPivot,s.mnuPivotRefreshSeparator,s.mnuPivotSort,s.mnuPivotFilter,s.mnuPivotFilterSeparator,s.mnuSubtotalField,s.mnuPivotSubtotalSeparator,s.mnuGroupPivot,s.mnuUnGroupPivot,s.mnuPivotGroupSeparator,s.mnuDeleteField,s.mnuPivotDeleteSeparator,s.mnuSummarize,s.mnuShowAs,s.mnuPivotValueSeparator,s.mnuShowDetails,s.mnuShowDetailsSeparator,s.mnuFieldSettings,s.mnuPivotSettings,s.pmiAddCommentSeparator,s.pmiAddComment,s.pmiCellMenuSeparator,s.pmiNumFormat,s.pmiCondFormat,s.pmiEntriesList,s.pmiGetRangeList,s.pmiAddNamedRange,s.pmiFunctionSeparator,s.pmiInsFunction,s.menuAddHyperlink,s.menuHyperlink,s.pmiRowHeight,s.pmiColumnWidth,s.pmiEntireHide,s.pmiEntireShow,s.pmiFreezeSeparator,s.pmiFreezePanes]}).on("hide:after",function(t,e,i){s.clearCustomItems(t)}),s.mnuGroupImg=new Common.UI.MenuItem({caption:this.txtGroup,iconCls:"menu__icon btn-shape-group",type:"group",value:"grouping"}),s.mnuUnGroupImg=new Common.UI.MenuItem({caption:this.txtUngroup,iconCls:"menu__icon btn-shape-ungroup",type:"group",value:"ungrouping"}),s.mnuShapeSeparator=new Common.UI.MenuItem({caption:"--"}),s.mnuShapeAdvanced=new Common.UI.MenuItem({iconCls:"menu__icon btn-menu-shape",caption:s.advancedShapeText}),s.mnuImgAdvanced=new Common.UI.MenuItem({iconCls:"menu__icon btn-menu-image",caption:s.advancedImgText}),s.mnuSlicerSeparator=new Common.UI.MenuItem({caption:"--"}),s.mnuSlicerAdvanced=new Common.UI.MenuItem({iconCls:"menu__icon btn-slicer",caption:s.advancedSlicerText}),s.mnuChartEdit=new Common.UI.MenuItem({iconCls:"menu__icon btn-menu-chart",caption:s.chartText}),s.mnuChartData=new Common.UI.MenuItem({iconCls:"menu__icon btn-select-range",caption:s.chartDataText}),s.mnuChartType=new Common.UI.MenuItem({caption:s.chartTypeText}),s.pmiImgCut=new Common.UI.MenuItem({iconCls:"menu__icon btn-cut",caption:s.txtCut,value:"cut"}),s.pmiImgCopy=new Common.UI.MenuItem({iconCls:"menu__icon btn-copy",caption:s.txtCopy,value:"copy"}),s.pmiImgPaste=new Common.UI.MenuItem({iconCls:"menu__icon btn-paste",caption:s.txtPaste,value:"paste"}),s.menuSignatureEditSign=new Common.UI.MenuItem({caption:this.strSign,value:0}),s.menuSignatureEditSetup=new Common.UI.MenuItem({caption:this.strSetup,value:2}),s.menuEditSignSeparator=new Common.UI.MenuItem({caption:"--"}),s.menuImgOriginalSize=new Common.UI.MenuItem({caption:s.originalSizeText}),s.menuImgReplace=new Common.UI.MenuItem({caption:s.textReplace,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[new Common.UI.MenuItem({caption:this.textFromFile,value:"file"}),new Common.UI.MenuItem({caption:this.textFromUrl,value:"url"}),new Common.UI.MenuItem({caption:this.textFromStorage,value:"storage"})]})}),s.menuImgCrop=new Common.UI.MenuItem({caption:s.textCrop,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[new Common.UI.MenuItem({caption:s.textCrop,checkable:!0,allowDepress:!0,value:0}),new Common.UI.MenuItem({caption:s.textCropFill,value:1}),new Common.UI.MenuItem({caption:s.textCropFit,value:2})]})}),s.mnuBringToFront=new Common.UI.MenuItem({caption:this.textArrangeFront,iconCls:"menu__icon btn-arrange-front",type:"arrange",value:Asc.c_oAscDrawingLayerType.BringToFront}),s.mnuSendToBack=new Common.UI.MenuItem({caption:this.textArrangeBack,iconCls:"menu__icon btn-arrange-back",type:"arrange",value:Asc.c_oAscDrawingLayerType.SendToBack}),s.mnuBringForward=new Common.UI.MenuItem({caption:this.textArrangeForward,iconCls:"menu__icon btn-arrange-forward",type:"arrange",value:Asc.c_oAscDrawingLayerType.BringForward}),s.mnuSendBackward=new Common.UI.MenuItem({caption:this.textArrangeBackward,iconCls:"menu__icon btn-arrange-backward",type:"arrange",value:Asc.c_oAscDrawingLayerType.SendBackward}),s.menuImageArrange=new Common.UI.MenuItem({caption:s.textArrange,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[s.mnuBringToFront,s.mnuSendToBack,s.mnuBringForward,s.mnuSendBackward,{caption:"--"},s.mnuGroupImg,s.mnuUnGroupImg]})}),s.menuImageAlign=new Common.UI.MenuItem({caption:s.textAlign,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:s.textShapeAlignLeft,iconCls:"menu__icon btn-shape-align-left",value:0},{caption:s.textShapeAlignCenter,iconCls:"menu__icon btn-shape-align-center",value:4},{caption:s.textShapeAlignRight,iconCls:"menu__icon btn-shape-align-right",value:1},{caption:s.textShapeAlignTop,iconCls:"menu__icon btn-shape-align-top",value:3},{caption:s.textShapeAlignMiddle,iconCls:"menu__icon btn-shape-align-middle",value:5},{caption:s.textShapeAlignBottom,iconCls:"menu__icon btn-shape-align-bottom",value:2},{caption:"--"},{caption:s.txtDistribHor,iconCls:"menu__icon btn-shape-distribute-hor",value:6},{caption:s.txtDistribVert,iconCls:"menu__icon btn-shape-distribute-vert",value:7}]})}),s.menuImgRotate=new Common.UI.MenuItem({caption:s.textRotate,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[new Common.UI.MenuItem({iconCls:"menu__icon btn-rotate-90",caption:s.textRotate90,type:"rotate",value:1}),new Common.UI.MenuItem({iconCls:"menu__icon btn-rotate-270",caption:s.textRotate270,type:"rotate",value:0}),{caption:"--"},new Common.UI.MenuItem({iconCls:"menu__icon btn-flip-hor",caption:s.textFlipH,type:"flip",value:1}),new Common.UI.MenuItem({iconCls:"menu__icon btn-flip-vert",caption:s.textFlipV,type:"flip",value:0})]})}),s.menuImgMacro=new Common.UI.MenuItem({caption:s.textMacro}),s.menuSaveAsPicture=new Common.UI.MenuItem({caption:s.textSaveAsPicture}),new Common.UI.MenuItem({caption:"--"}));s.menuImgEditPoints=new Common.UI.MenuItem({caption:s.textEditPoints}),this.imgMenu=new Common.UI.Menu({cls:"shifted-right",restoreHeightAndTop:!0,scrollToCheckedItem:!1,items:[s.pmiImgCut,s.pmiImgCopy,s.pmiImgPaste,{caption:"--"},s.menuSignatureEditSign,s.menuSignatureEditSetup,s.menuEditSignSeparator,s.menuImageArrange,s.menuImageAlign,s.menuImgRotate,s.menuImgMacro,t,s.menuSaveAsPicture,s.mnuShapeSeparator,s.menuImgCrop,s.mnuChartData,s.mnuChartType,s.mnuChartEdit,s.menuImgEditPoints,s.mnuShapeAdvanced,s.menuImgOriginalSize,s.menuImgReplace,s.mnuImgAdvanced,s.mnuSlicerSeparator,s.mnuSlicerAdvanced]}).on("hide:after",function(t,e,i){s.clearCustomItems(t)}),this.menuParagraphVAlign=new Common.UI.MenuItem({iconCls:"menu__icon btn-align-top",caption:this.vertAlignText,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[s.menuParagraphTop=new Common.UI.MenuItem({iconCls:"menu__icon btn-align-top",caption:s.topCellText,checkable:!0,checkmark:!1,toggleGroup:"popupparagraphvalign",value:Asc.c_oAscVAlign.Top}),s.menuParagraphCenter=new Common.UI.MenuItem({iconCls:"menu__icon btn-align-middle",caption:s.centerCellText,checkable:!0,checkmark:!1,toggleGroup:"popupparagraphvalign",value:Asc.c_oAscVAlign.Center}),this.menuParagraphBottom=new Common.UI.MenuItem({iconCls:"menu__icon btn-align-bottom",caption:s.bottomCellText,checkable:!0,checkmark:!1,toggleGroup:"popupparagraphvalign",value:Asc.c_oAscVAlign.Bottom})]})}),s.menuParagraphDirection=new Common.UI.MenuItem({iconCls:"menu__icon btn-text-orient-hor",caption:s.directionText,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[s.menuParagraphDirectH=new Common.UI.MenuItem({caption:s.directHText,iconCls:"menu__icon btn-text-orient-hor",checkable:!0,checkmark:!1,checked:!1,toggleGroup:"popupparagraphdirect",direction:Asc.c_oAscVertDrawingText.normal}),s.menuParagraphDirect90=new Common.UI.MenuItem({caption:s.direct90Text,iconCls:"menu__icon btn-text-orient-rdown",checkable:!0,checkmark:!1,checked:!1,toggleGroup:"popupparagraphdirect",direction:Asc.c_oAscVertDrawingText.vert}),s.menuParagraphDirect270=new Common.UI.MenuItem({caption:s.direct270Text,iconCls:"menu__icon btn-text-orient-rup",checkable:!0,checkmark:!1,checked:!1,toggleGroup:"popupparagraphdirect",direction:Asc.c_oAscVertDrawingText.vert270})]})}),s.menuParagraphBullets=new Common.UI.MenuItem({iconCls:"menu__icon btn-setmarkers",caption:s.bulletsText,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{template:e.template('<div id="id-docholder-menu-bullets" class="menu-layouts" style="width: 376px;"></div>')},{caption:"--"},s.menuParagraphBulletNone=new Common.UI.MenuItem({caption:s.textNone,checkable:!0,checked:!1,value:-1}),s.mnuListSettings=new Common.UI.MenuItem({caption:s.textListSettings,value:"settings"})]})}),s._markersArr=['{"bulletTypeface":{"type":"bufont","typeface":"Symbol"},"bulletType":{"type":"char","char":"·","startAt":null}}','{"bulletTypeface":{"type":"bufont","typeface":"Courier New"},"bulletType":{"type":"char","char":"o","startAt":null}}','{"bulletTypeface":{"type":"bufont","typeface":"Wingdings"},"bulletType":{"type":"char","char":"§","startAt":null}}','{"bulletTypeface":{"type":"bufont","typeface":"Wingdings"},"bulletType":{"type":"char","char":"v","startAt":null}}','{"bulletTypeface":{"type":"bufont","typeface":"Wingdings"},"bulletType":{"type":"char","char":"Ø","startAt":null}}','{"bulletTypeface":{"type":"bufont","typeface":"Wingdings"},"bulletType":{"type":"char","char":"ü","startAt":null}}','{"bulletTypeface":{"type":"bufont","typeface":"Symbol"},"bulletType":{"type":"char","char":"¨","startAt":null}}','{"bulletTypeface":{"type":"bufont","typeface":"Arial"},"bulletType":{"type":"char","char":"–","startAt":null}}'],s._numbersArr=['{"bulletTypeface":{"type":"bufont","typeface":"Arial"},"bulletType":{"type":"autonum","char":null,"autoNumType":"alphaUcPeriod","startAt":null}}','{"bulletTypeface":{"type":"bufont","typeface":"Arial"},"bulletType":{"type":"autonum","char":null,"autoNumType":"alphaLcParenR","startAt":null}}','{"bulletTypeface":{"type":"bufont","typeface":"Arial"},"bulletType":{"type":"autonum","char":null,"autoNumType":"alphaLcPeriod","startAt":null}}','{"bulletTypeface":{"type":"bufont","typeface":"Arial"},"bulletType":{"type":"autonum","char":null,"autoNumType":"arabicPeriod","startAt":null}}','{"bulletTypeface":{"type":"bufont","typeface":"Arial"},"bulletType":{"type":"autonum","char":null,"autoNumType":"arabicParenR","startAt":null}}','{"bulletTypeface":{"type":"bufont","typeface":"Arial"},"bulletType":{"type":"autonum","char":null,"autoNumType":"romanUcPeriod","startAt":null}}','{"bulletTypeface":{"type":"bufont","typeface":"Arial"},"bulletType":{"type":"autonum","char":null,"autoNumType":"romanLcPeriod","startAt":null}}'],s.paraBulletsPicker={conf:{rec:null},delayRenderTips:!0,store:new Common.UI.DataViewStore([{group:"menu-list-bullet-group",id:"id-markers-"+Common.UI.getId(),type:0,subtype:1,numberingInfo:s._markersArr[0],skipRenderOnChange:!0,tip:this.tipMarkersFRound},{group:"menu-list-bullet-group",id:"id-markers-"+Common.UI.getId(),type:0,subtype:2,numberingInfo:s._markersArr[1],skipRenderOnChange:!0,tip:this.tipMarkersHRound},{group:"menu-list-bullet-group",id:"id-markers-"+Common.UI.getId(),type:0,subtype:3,numberingInfo:s._markersArr[2],skipRenderOnChange:!0,tip:this.tipMarkersFSquare},{group:"menu-list-bullet-group",id:"id-markers-"+Common.UI.getId(),type:0,subtype:4,numberingInfo:s._markersArr[3],skipRenderOnChange:!0,tip:this.tipMarkersStar},{group:"menu-list-bullet-group",id:"id-markers-"+Common.UI.getId(),type:0,subtype:5,numberingInfo:s._markersArr[4],skipRenderOnChange:!0,tip:this.tipMarkersArrow},{group:"menu-list-bullet-group",id:"id-markers-"+Common.UI.getId(),type:0,subtype:6,numberingInfo:s._markersArr[5],skipRenderOnChange:!0,tip:this.tipMarkersCheckmark},{group:"menu-list-bullet-group",id:"id-markers-"+Common.UI.getId(),type:0,subtype:7,numberingInfo:s._markersArr[6],skipRenderOnChange:!0,tip:this.tipMarkersFRhombus},{group:"menu-list-bullet-group",id:"id-markers-"+Common.UI.getId(),type:0,subtype:8,numberingInfo:s._markersArr[7],skipRenderOnChange:!0,tip:this.tipMarkersDash},{group:"menu-list-number-group",id:"id-numbers-"+Common.UI.getId(),type:1,subtype:4,numberingInfo:s._numbersArr[0],skipRenderOnChange:!0,tip:this.tipNumCapitalLetters},{group:"menu-list-number-group",id:"id-numbers-"+Common.UI.getId(),type:1,subtype:5,numberingInfo:s._numbersArr[1],skipRenderOnChange:!0,tip:this.tipNumLettersParentheses},{group:"menu-list-number-group",id:"id-numbers-"+Common.UI.getId(),type:1,subtype:6,numberingInfo:s._numbersArr[2],skipRenderOnChange:!0,tip:this.tipNumLettersPoints},{group:"menu-list-number-group",id:"id-numbers-"+Common.UI.getId(),type:1,subtype:1,numberingInfo:s._numbersArr[3],skipRenderOnChange:!0,tip:this.tipNumNumbersPoint},{group:"menu-list-number-group",id:"id-numbers-"+Common.UI.getId(),type:1,subtype:2,numberingInfo:s._numbersArr[4],skipRenderOnChange:!0,tip:this.tipNumNumbersParentheses},{group:"menu-list-number-group",id:"id-numbers-"+Common.UI.getId(),type:1,subtype:3,numberingInfo:s._numbersArr[5],skipRenderOnChange:!0,tip:this.tipNumRoman},{group:"menu-list-number-group",id:"id-numbers-"+Common.UI.getId(),type:1,subtype:7,numberingInfo:s._numbersArr[6],skipRenderOnChange:!0,tip:this.tipNumRomanSmall}]),groups:new Common.UI.DataViewGroupStore([{id:"menu-list-bullet-group",caption:this.textBullets},{id:"menu-list-number-group",caption:this.textNumbering}]),selectRecord:function(t){this.conf.rec=t}},s.menuAddHyperlinkShape=new Common.UI.MenuItem({iconCls:"menu__icon btn-inserthyperlink",caption:s.txtInsHyperlink}),s.menuEditHyperlinkShape=new Common.UI.MenuItem({caption:s.editHyperlinkText}),s.menuRemoveHyperlinkShape=new Common.UI.MenuItem({caption:s.removeHyperlinkText}),s.menuHyperlinkShape=new Common.UI.MenuItem({iconCls:"menu__icon btn-inserthyperlink",caption:s.txtInsHyperlink,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[s.menuEditHyperlinkShape,s.menuRemoveHyperlinkShape]})}),this.pmiTextAdvanced=new Common.UI.MenuItem({iconCls:"menu__icon btn-paragraph",caption:s.txtTextAdvanced}),s.pmiTextCut=new Common.UI.MenuItem({iconCls:"menu__icon btn-cut",caption:s.txtCut,value:"cut"}),s.pmiTextCopy=new Common.UI.MenuItem({iconCls:"menu__icon btn-copy",caption:s.txtCopy,value:"copy"}),s.pmiTextPaste=new Common.UI.MenuItem({iconCls:"menu__icon btn-paste",caption:s.txtPaste,value:"paste"}),s.menuParagraphEquation=new Common.UI.MenuItem({caption:s.advancedEquationText,iconCls:"menu__icon btn-equation",menu:s.createEquationMenu("popupparaeqinput","tl-tr")}),this.textInShapeMenu=new Common.UI.Menu({cls:"shifted-right",scrollToCheckedItem:!1,items:[s.pmiTextCut,s.pmiTextCopy,s.pmiTextPaste,{caption:"--"},s.menuParagraphVAlign,s.menuParagraphDirection,s.menuParagraphBullets,s.menuAddHyperlinkShape,s.menuHyperlinkShape,{caption:"--"},s.pmiTextAdvanced,s.menuParagraphEquation]}).on("hide:after",function(t,e,i){s.clearCustomItems(t)}),s.pmiCommonCut=new Common.UI.MenuItem({iconCls:"menu__icon btn-cut",caption:s.txtCut,value:"cut"}),s.pmiCommonCopy=new Common.UI.MenuItem({iconCls:"menu__icon btn-copy",caption:s.txtCopy,value:"copy"}),s.pmiCommonPaste=new Common.UI.MenuItem({iconCls:"menu__icon btn-paste",caption:s.txtPaste,value:"paste"}),this.copyPasteMenu=new Common.UI.Menu({cls:"shifted-right",items:[s.pmiCommonCut,s.pmiCommonCopy,s.pmiCommonPaste]}),this.entriesMenu=new Common.UI.Menu({maxHeight:200,cyclic:!1,items:[]}).on("show:after",function(){this.scroller.update({alwaysVisibleY:!0})}).on("keydown:before",function(t,e){e.altKey&&e.keyCode==Common.UI.Keys.DOWN&&(0<(e=i(e.target).closest("li")).length?e.click():t.hide())}),this.funcMenu=new Common.UI.Menu({maxHeight:200,cyclic:!1,items:[]}).on("render:after",function(t){t.cmpEl.removeAttr("oo_editor_input").attr("oo_editor_keyboard",!0)}),this.tableTotalMenu=new Common.UI.Menu({maxHeight:160,menuAlign:"tr-br",cyclic:!1,cls:"lang-menu",items:[{caption:this.textNone,value:Asc.ETotalsRowFunction.totalrowfunctionNone,checkable:!0},{caption:this.textAverage,value:Asc.ETotalsRowFunction.totalrowfunctionAverage,checkable:!0},{caption:this.textCount,value:Asc.ETotalsRowFunction.totalrowfunctionCount,checkable:!0},{caption:this.textMax,value:Asc.ETotalsRowFunction.totalrowfunctionMax,checkable:!0},{caption:this.textMin,value:Asc.ETotalsRowFunction.totalrowfunctionMin,checkable:!0},{caption:this.textSum,value:Asc.ETotalsRowFunction.totalrowfunctionSum,checkable:!0},{caption:this.textStdDev,value:Asc.ETotalsRowFunction.totalrowfunctionStdDev,checkable:!0},{caption:this.textVar,value:Asc.ETotalsRowFunction.totalrowfunctionVar,checkable:!0},{caption:this.textMore,value:Asc.ETotalsRowFunction.totalrowfunctionCustom,checkable:!0}]}),s.fireEvent("createdelayedelements",[s,"edit"])},setMenuItemCommentCaptionMode:function(t,e,i){t.setCaption(e?this.txtAddComment:i?this.txtEditComment:this.txtShowComment,!0)},createEquationMenu:function(t,e){return new Common.UI.Menu({cls:"ppm-toolbar shifted-right",menuAlign:e,items:[new Common.UI.MenuItem({caption:this.currProfText,iconCls:"menu__icon btn-professional-equation",type:"view",value:{all:!1,linear:!1}}),new Common.UI.MenuItem({caption:this.currLinearText,iconCls:"menu__icon btn-linear-equation",type:"view",value:{all:!1,linear:!0}}),new Common.UI.MenuItem({caption:this.allProfText,iconCls:"menu__icon btn-professional-equation",type:"view",value:{all:!0,linear:!1}}),new Common.UI.MenuItem({caption:this.allLinearText,iconCls:"menu__icon btn-linear-equation",type:"view",value:{all:!0,linear:!0}}),{caption:"--"},new Common.UI.MenuItem({caption:this.unicodeText,checkable:!0,checked:!1,toggleGroup:t,type:"input",value:Asc.c_oAscMathInputType.Unicode}),new Common.UI.MenuItem({caption:this.latexText,checkable:!0,checked:!1,toggleGroup:t,type:"input",value:Asc.c_oAscMathInputType.LaTeX}),{caption:"--"},new Common.UI.MenuItem({caption:this.hideEqToolbar,isToolbarHide:!1,type:"hide"})]})},updateCustomItems:function(n,t){var a,l,r,c,d;!n||!t||t.length<1||(l=(a=this).mode&&a.mode.lang?a.mode.lang.split(/[\-_]/)[0]:"en",a._preventCustomClick&&clearTimeout(a._preventCustomClick),a._hasCustomItems&&(a._preventCustomClick=setTimeout(function(){a._preventCustomClick=null},500)),a._hasCustomItems=!0,r=function(t,e){if(n&&0<n.items.length)for(var i=n.items.length-1;0<=i;i--)if(n.items[i].options.isCustomItem&&(void 0===e&&n.items[i].options.guid===t||n.items[i].options.guid===t&&n.items[i].value===e))return n.items[i]},c=function(t,e,i){return i?i.removeAll():((i=new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[]})).on("item:click",function(t,e,i){!a._preventCustomClick&&a.api&&a.api.onPluginContextMenuItemClick&&a.api.onPluginContextMenuItemClick(e.options.guid,e.value)}),i.on("menu:click",function(t,e){a._preventCustomClick&&e.stopPropagation()})),t.forEach(function(t){t.separator&&i.addItem({caption:"--",isCustomItem:!0,guid:e}),t.text&&i.addItem({caption:("object"==typeof t.text?t.text[l]||t.text.en:t.text)||"",isCustomItem:!0,value:t.id,guid:e,menu:!!t.items&&c(t.items,e),disabled:!!t.disabled})}),i},t.forEach(function(s){var o=!r(s.guid);s&&s.items&&0<s.items.length&&s.items.forEach(function(t){var e,i;t.separator&&o?n.addItem({caption:"--",isCustomItem:!0,guid:s.guid}):t.text&&(i=r(s.guid,t.id),e=("object"==typeof t.text?t.text[l]||t.text.en:t.text)||"",i?(i.setCaption(e),i.setDisabled(!!t.disabled),t.items&&(i.menu?(i.menu.isVisible()&&0<i.menu.cmpEl.find(" > li:not(.divider):not(.disabled):visible").find("> a").filter(":focus").length&&(i.menu.isOver=!0,d=i.cmpEl),c(t.items,s.guid,i.menu)):i.setMenu(c(t.items,s.guid)))):(i=new Common.UI.MenuItem({caption:e,isCustomItem:!0,value:t.id,guid:s.guid,menu:!!(t.items&&0<=t.items.length)&&c(t.items,s.guid),disabled:!!t.disabled}).on("click",function(t,e){!a._preventCustomClick&&a.api&&a.api.onPluginContextMenuItemClick&&a.api.onPluginContextMenuItemClick(t.options.guid,t.value)}),n.addItem(i)))})}),d&&0<(t=i("> [role=menu]",d).find("> li:not(.divider):not(.disabled):visible > a")).length&&t.eq(0).focus(),n.alignPosition())},clearCustomItems:function(t){if(t&&0<t.items.length)for(var e=0;e<t.items.length;e++)t.items[e].options.isCustomItem&&(t.removeItem(t.items[e]),e--);this._hasCustomItems=!1}},SSE.Views.DocumentHolder||{}))}),void 0===Common&&(Common={}),define("common/main/lib/component/ComboBox",["common/main/lib/component/BaseView","common/main/lib/component/Scroller"],function(){"use strict";Common.UI.ComboBoxModel=Backbone.Model.extend({defaults:function(){return{id:Common.UI.getId(),value:null,displayValue:null}}}),Common.UI.ComboBoxStore=Backbone.Collection.extend({model:Common.UI.ComboBoxModel}),Common.UI.ComboBox=Common.UI.BaseView.extend({options:{id:null,cls:"",style:"",hint:!1,editable:!0,disabled:!1,menuCls:"",menuStyle:"",restoreMenuHeight:!0,displayField:"displayValue",valueField:"value",search:!1,placeHolder:"",scrollAlwaysVisible:!1,takeFocusOnClose:!1,dataHint:"",dataHintDirection:"",dataHintOffset:""},template:_.template(['<span class="input-group combobox <%= cls %>" id="<%= id %>" style="<%= style %>">','<input type="text" class="form-control" spellcheck="false" placeholder="<%= placeHolder %>" data-hint="<%= dataHint %>" data-hint-direction="<%= dataHintDirection %>" data-hint-offset="<%= dataHintOffset %>">','<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">','<span class="caret"></span>',"</button>",'<ul class="dropdown-menu <%= menuCls %>" style="<%= menuStyle %>" role="menu">',"<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%- item.value %>"><a tabindex="-1" type="menuitem"><%= scope.getDisplayValue(item) %></a></li>',"<% }); %>","</ul>","</span>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);t=this;this.id=t.options.id||Common.UI.getId(),this.cls=t.options.cls,this.style=t.options.style,this.menuCls=t.options.menuCls,this.menuStyle=t.options.menuStyle,this.template=t.options.template||t.template,this.itemsTemplate=t.options.itemsTemplate,this.hint=t.options.hint,this.editable=t.options.editable,this.disabled=t.options.disabled,this.store=t.options.store||new Common.UI.ComboBoxStore,this.displayField=t.options.displayField,this.valueField=t.options.valueField,this.placeHolder=t.options.placeHolder,this.search=t.options.search,this.scrollAlwaysVisible=t.options.scrollAlwaysVisible,this.focusWhenNoSelection=!1!==t.options.focusWhenNoSelection,this.restoreMenuHeight=t.options.restoreMenuHeight,t.rendered=t.options.rendered||!1,this.lastValue=null,t.store.add(t.options.data),t.options.el&&t.render()},render:function(t){var e,i,s,o,n=this;return n.rendered?this.cmpEl=n.$el||$(this.el):(o=this.store.toJSON(),this.cmpEl=$(this.template({id:this.id,cls:this.cls,style:this.style,menuCls:this.menuCls,menuStyle:this.menuStyle,items:o,scope:n,placeHolder:this.placeHolder,dataHint:this.options.dataHint,dataHintDirection:this.options.dataHintDirection,dataHintOffset:this.options.dataHintOffset,isRTL:Common.UI.isRTL()})),this.itemsTemplate&&this.cmpEl.find("ul").html($(this.itemsTemplate({items:o,scope:n}))),(t?(this.setElement(t,!1),t):this.$el).html(this.cmpEl)),n.rendered||(e=this.cmpEl,this._input=e.find("input"),this._button=e.find(".btn"),e.on("click","a",_.bind(this.itemClicked,this)),e.on("mousedown","a",_.bind(this.itemMouseDown,this)),this.editable?(e.on("change","input",_.bind(this.onInputChanged,this)),e.on("input","input",_.bind(this.onInputChanging,this)),e.on("keydown","input",_.bind(this.onInputKeyDown,this)),e.on("focusin","input",_.bind(this.onInputFocusIn,this)),e.on("click",".form-control",_.bind(this.onEditableInputClick,this))):(e.on("click",".form-control",_.bind(this.onInputClick,this)),this._input.attr("readonly","readonly"),this._input.attr("data-can-copy",!1),this._input.on("mousedown",function(t){t.preventDefault()})),n.options.hint&&(e.attr("data-toggle","tooltip"),e.tooltip({title:n.options.hint,placement:n.options.hintAnchor||"cursor"}),0<(i=e.closest(".asc-window")).length&&(e.data("bs.tooltip").tip().css("z-index",parseInt(i.css("z-index"))+10),s=function(t){i[0]===t.$window[0]&&((t=e.data("bs.tooltip"))&&(void 0===t.dontShow&&(t.dontShow=!0),t.hide()),Common.NotificationCenter.off({"modal:close":s}))},Common.NotificationCenter.on({"modal:close":s})),e.find(".dropdown-menu").on("mouseenter",function(){var t=e.data("bs.tooltip");t&&(void 0===t.dontShow&&(t.dontShow=!0),t.hide())})),(o=e.find(".dropdown-menu")).hasClass("menu-absolute")&&o.css("min-width",e.outerWidth()),e.on("show.bs.dropdown",_.bind(n.onBeforeShowMenu,n)),e.on("shown.bs.dropdown",_.bind(n.onAfterShowMenu,n)),e.on("hide.bs.dropdown",_.bind(n.onBeforeHideMenu,n)),e.on("hidden.bs.dropdown",_.bind(n.onAfterHideMenu,n)),e.on("keydown.after.bs.dropdown",_.bind(n.onAfterKeydownMenu,n)),Common.NotificationCenter.on("menumanager:hideall",_.bind(n.closeMenu,n)),this.setDefaultSelection(),this.listenTo(this.store,"reset",this.onResetItems)),n.rendered=!0,n.disabled&&n.setDisabled(n.disabled),this},setData:function(t){this.store.reset([]),this.store.add(t),this.setRawValue(""),this.onResetItems()},openMenu:function(t){var e;this.store.length<1||((e=this).scroller||(this.scroller=new Common.UI.Scroller(_.extend({el:$(".dropdown-menu",this.cmpEl),minScrollbarLength:40,includePadding:!0,wheelSpeed:10,alwaysVisibleY:this.scrollAlwaysVisible},this.options.scroller))),_.delay(function(){e.cmpEl.addClass("open")},t||0))},closeMenu:function(){this.cmpEl.removeClass("open")},isMenuOpen:function(){return this.cmpEl.hasClass("open")},onBeforeShowMenu:function(t){this.scroller||(this.scroller=new Common.UI.Scroller(_.extend({el:$(".dropdown-menu",this.cmpEl),minScrollbarLength:40,includePadding:!0,wheelSpeed:10,alwaysVisibleY:this.scrollAlwaysVisible},this.options.scroller))),Common.NotificationCenter.trigger("menu:show"),this.trigger("show:before",this,t),this.options.hint&&(t=this.cmpEl.data("bs.tooltip"))&&(void 0===t.dontShow&&(t.dontShow=!0),t.hide());var e,i,t=this.cmpEl.find("ul");t.hasClass("menu-absolute")?((e=(i=this.cmpEl.offset()).left)+t.outerWidth()>Common.Utils.innerWidth()&&(e+=this.cmpEl.outerWidth()-t.outerWidth()),t.css({left:e,top:i.top+this.cmpEl.outerHeight()+2})):t.hasClass("menu-aligned")&&(i=this.cmpEl.offset(),t.toggleClass("show-top",i.top+this.cmpEl.outerHeight()+t.outerHeight()>Common.Utils.innerHeight()))},onAfterShowMenu:function(t){this.alignMenuPosition();var e,i,s,o,n=$(this.el).find("ul"),a=n.find("> li.selected");a.length?(s=a.position().top,e=a.outerHeight(),i=n.outerHeight(),(s<0||i<s+e)&&(s=n.scrollTop()+s+(e-i)/2,s=Math.floor(s/e)*e,n.scrollTop(s)),setTimeout(function(){a.find("a").focus()},1)):this.focusWhenNoSelection&&(o=this,setTimeout(function(){o.cmpEl.find("ul li:first a").focus()},1)),this.scroller&&this.scroller.update({alwaysVisibleY:this.scrollAlwaysVisible}),this.trigger("show:after",this,t,{fromKeyDown:void 0===t}),this._search={}},alignMenuPosition:function(){var t,e,i,s,o;this.restoreMenuHeight&&(t=$(this.el).find("ul"),"number"!=typeof this.restoreMenuHeight&&(e=parseFloat(t.css("max-height")),t.hasClass("scrollable-menu")||e?this.restoreMenuHeight=e||1e5:this.restoreMenuHeight=1e5),e=Common.Utils.croppedGeometry().height-10,i=t.outerHeight(),(o=e<(s=t.get(0).getBoundingClientRect().top)+(o=(o=i)<this.restoreMenuHeight?this.restoreMenuHeight:o)?e-s:o)!==i&&t.css("max-height",o+"px"))},onBeforeHideMenu:function(t){this.trigger("hide:before",this,t),Common.UI.Scroller.isMouseCapture()&&t.preventDefault()},onAfterHideMenu:function(t,e){var i;this.cmpEl.find(".dropdown-toggle").blur(),this.trigger("hide:after",this,t,e),Common.NotificationCenter.trigger("menu:hide",this,e),this.options.takeFocusOnClose&&((i=this)._input&&0<i._input.length&&!i.editable&&i._input[0].selectionStart===i._input[0].selectionEnd&&setTimeout(function(){i._input[0].selectionStart=i._input[0].selectionEnd=0},1),setTimeout(function(){i.focus()},1))},onAfterKeydownMenu:function(t){if(t.keyCode==Common.UI.Keys.DOWN&&!this.editable&&!this.isMenuOpen())return this.openMenu(),this.onAfterShowMenu(),!1;if(this.focusWhenNoSelection||t.keyCode!=Common.UI.Keys.DOWN&&t.keyCode!=Common.UI.Keys.UP){var e,i;if(t.keyCode==Common.UI.Keys.RETURN&&(this.editable||this.isMenuOpen()))return e=this.isMenuOpen(),$(t.target).click(),this.rendered&&(Common.Utils.isIE?this._input.trigger("change",{onkeydown:!0}):this._input.blur()),!e;{if(t.keyCode==Common.UI.Keys.ESC&&this.isMenuOpen())return this._input.val(this.lastValue),this.closeMenu(),this.onAfterHideMenu(t),!1;this.search&&64<t.keyCode&&t.keyCode<91&&t.key&&"object"==typeof this._search&&(i=this,clearTimeout(this._search.timer),this._search.timer=setTimeout(function(){i._search={}},1e3),this._search.text||(this._search.text=""),this._search.char||(this._search.char=t.key),this._search.char!==t.key&&(this._search.full=!0),this._search.text+=t.key,void 0===this._search.index&&(s=this.cmpEl.find("ul > li").find("> a"),this._search.index=s.index(s.filter(":focus"))),this.selectCandidate())}}else{var s;0===(s=this.cmpEl.find("ul > li a")).filter(":focus").length&&0<s.length&&setTimeout(function(){s[t.keyCode==Common.UI.Keys.DOWN?0:s.length-1].focus()},1)}},selectCandidate:function(){for(var t,e,i,s,o,n,a=this._search.index&&-1!=this._search.index?this._search.index:0,l=new RegExp("^"+(this._search.full?this._search.text:this._search.char),"i"),r=l.test(this.store.at(a).get(this.displayField)),c=0;c<this.store.length;c++){var d=this.store.at(c);if(l.test(d.get(this.displayField))){if(!t&&(t=d,e=c,!r))break;if(this._search.full&&c==a||a<c){t=d,e=c;break}}}t&&(this._search.index=e,d=$("#"+t.get("id")+" a",$(this.el)),this.scroller&&(this.scroller.update({alwaysVisibleY:this.scrollAlwaysVisible}),i=$(this.el).find("ul"),s=d.position().top,o=d.outerHeight(),n=i.outerHeight(),(s<0||n<s+o)&&(n=i.scrollTop()+s,n=Math.floor(n/o)*o,i.scrollTop(n))),d.focus())},onInputKeyDown:function(t){var e=this;t.keyCode==Common.UI.Keys.ESC?(this._input.val(this.lastValue),this.closeMenu(),this.onAfterHideMenu(t)):t.keyCode==Common.UI.Keys.UP||t.keyCode==Common.UI.Keys.DOWN?(this.isMenuOpen()||(this.openMenu(),this.onAfterShowMenu()),_.delay(function(){e._skipInputChange=!0,e.cmpEl.find("ul li:first a").focus()},10)):t.keyCode==Common.UI.Keys.RETURN&&$(t.target).val()===e.lastValue?this._input.trigger("change",{reapply:!0}):e._skipInputChange=!1},onInputFocusIn:function(t){this.trigger("combo:focusin",this,t)},onInputChanged:function(t,e){var i,s,o;e&&e.synthetic||(this._skipInputChange?this._skipInputChange=!1:(i=$(t.target).val(),s={},this.lastValue!==i||e&&e.reapply?(s[this.valueField]=i,this.trigger("changed:before",this,s,t),t.isDefaultPrevented()||(this._selectedItem=this.store.findWhere(((o={})[this.displayField]=i,o)),this._selectedItem&&(s=this._selectedItem.toJSON(),$(".selected",$(this.el)).removeClass("selected"),$("#"+this._selectedItem.get("id"),$(this.el)).addClass("selected")),this.trigger("changed:after",this,s,t))):e&&e.onkeydown&&this.trigger("combo:blur",this,t)))},onInputChanging:function(t,e){var i=$(t.target).val();t.isDefaultPrevented()||this.trigger("changing",this,i,t)},onInputClick:function(t){this._button&&this._button.dropdown("toggle"),t.preventDefault(),t.stopPropagation()},onEditableInputClick:function(t){var e;this.options.hint&&(e=this.cmpEl.data("bs.tooltip"))&&(void 0===e.dontShow&&(e.dontShow=!0),e.hide()),this.isMenuOpen()&&1==t.which&&t.stopPropagation()},setDefaultSelection:function(){var t,e;!this.rendered||(t=this._input.val())&&(this._selectedItem=this.store.findWhere(((e={})[this.displayField]=t,e)),this._selectedItem&&($(".selected",$(this.el)).removeClass("selected"),$("#"+this._selectedItem.get("id"),$(this.el)).addClass("selected")))},setDisabled:function(t){this.disabled=t=!!t,this.rendered&&(t?this._input.attr("disabled",!0):this._input.removeAttr("disabled"),this.cmpEl.toggleClass("disabled",t),this._button.toggleClass("disabled",t))},isDisabled:function(){return this.disabled},setRawValue:function(t){this.rendered&&(this._input.val(t).trigger("change",{synthetic:!0}),this.lastValue=null!=t?t.toString():t)},getRawValue:function(){return this.rendered?this._input.val():null},setValue:function(t,e){var i;this.rendered&&(this._selectedItem=this.store.findWhere(((i={})[this.valueField]=t,i)),$(".selected",$(this.el)).removeClass("selected"),this._selectedItem?(this.setRawValue(this._selectedItem.get(this.displayField)),$("#"+this._selectedItem.get("id"),$(this.el)).addClass("selected")):this.setRawValue(void 0!==e?e:t))},getValue:function(){return this.rendered?this._selectedItem&&!_.isUndefined(this._selectedItem.get(this.valueField))?this._selectedItem.get(this.valueField):this._input.val():null},getDisplayValue:function(t){return Common.Utils.String.htmlEncode(t[this.displayField])},getSelectedRecord:function(){return this.rendered&&this._selectedItem&&!_.isUndefined(this._selectedItem.get(this.valueField))?_.extend({},this._selectedItem.toJSON()):null},selectRecord:function(t){this.rendered&&t&&(this._selectedItem=t,$(".selected",$(this.el)).removeClass("selected"),this.setRawValue(this._selectedItem.get(this.displayField)),$("#"+this._selectedItem.get("id"),$(this.el)).addClass("selected"))},clearSelection:function(){$(".selected",$(this.el)).removeClass("selected"),this._selectedItem=null},itemClicked:function(t){var e=$(t.target).closest("li");this._selectedItem=this.store.findWhere({id:e.attr("id")}),this._selectedItem&&(this.lastValue=this._selectedItem.get(this.displayField),this._input.val(this.lastValue).trigger("change",{synthetic:!0}),$(".selected",$(this.el)).removeClass("selected"),e.addClass("selected"),this.trigger("selected",this,_.extend({},this._selectedItem.toJSON()),t),t.preventDefault()),this._isMouseDownMenu=!1},itemMouseDown:function(t){if(1!=t.which)return t.preventDefault(),t.stopPropagation(),!1;this._isMouseDownMenu=!0},onResetItems:function(){this.itemsTemplate?$(this.el).find("ul").html($(this.itemsTemplate({items:this.store.toJSON(),scope:this}))):$(this.el).find("ul").html(_.template(["<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%- item.value %>"><a tabindex="-1" type="menuitem"><%= scope.getDisplayValue(item) %></a></li>',"<% }); %>"].join(""))({items:this.store.toJSON(),scope:this})),_.isUndefined(this.scroller)||(this.scroller.destroy(),delete this.scroller),this.scroller=new Common.UI.Scroller(_.extend({el:$(".dropdown-menu",this.cmpEl),minScrollbarLength:40,includePadding:!0,wheelSpeed:10,alwaysVisibleY:this.scrollAlwaysVisible},this.options.scroller))},focus:function(){this._input&&this._input.focus()}}),Common.UI.ComboBoxCustom=Common.UI.ComboBox.extend(_.extend({itemClicked:function(t){Common.UI.ComboBox.prototype.itemClicked.call(this,t),this.options.updateFormControl&&this.options.updateFormControl.call(this,this._selectedItem)},setValue:function(t,e){Common.UI.ComboBox.prototype.setValue.call(this,t,e),this.options.updateFormControl&&this.options.updateFormControl.call(this,this._selectedItem,e)},selectRecord:function(t){Common.UI.ComboBox.prototype.selectRecord.call(this,t),this.options.updateFormControl&&this.options.updateFormControl.call(this,this._selectedItem)},focus:function(){this.cmpEl&&this.cmpEl.find(".form-control").focus()}},Common.UI.ComboBoxCustom||{}))}),void 0===Common&&(Common={}),define("common/main/lib/component/DataView",["common/main/lib/component/BaseView","common/main/lib/component/Scroller"],function(){"use strict";Common.UI.DataViewGroupModel=Backbone.Model.extend({defaults:function(){return{id:Common.UI.getId(),caption:"",inline:!1,headername:void 0}}}),Common.UI.DataViewGroupStore=Backbone.Collection.extend({model:Common.UI.DataViewGroupModel}),Common.UI.DataViewModel=Backbone.Model.extend({defaults:function(){return{id:Common.UI.getId(),selected:!1,allowSelected:!0,value:null,disabled:!1}}}),Common.UI.DataViewStore=Backbone.Collection.extend({model:Common.UI.DataViewModel}),Common.UI.DataViewItem=Common.UI.BaseView.extend({options:{},template:_.template(['<div id="<%= id %>"><%= value %></div>'].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);t=this;t.template=t.options.template||t.template,t.dataHint=t.options.dataHint||"",t.dataHintDirection=t.options.dataHintDirection||"",t.dataHintOffset=t.options.dataHintOffset||"",t.scaling=t.options.scaling,t.listenTo(t.model,"change",this.model.get("skipRenderOnChange")?t.onChange:t.render),t.listenTo(t.model,"change:selected",t.onSelectChange),t.listenTo(t.model,"remove",t.remove)},render:function(){var t,e;return _.isUndefined(this.model.id)||((t=this.$el||$(this.el)).html(this.template(this.model.toJSON())),t.addClass("item"),t.toggleClass("selected",this.model.get("selected")&&this.model.get("allowSelected")),""!==this.dataHint&&(t.attr("data-hint",this.dataHint),t.attr("data-hint-direction",this.dataHintDirection),t.attr("data-hint-offset",this.dataHintOffset)),_.isUndefined(this.model.get("contentTarget"))||t.attr("content-target",this.model.get("contentTarget")),t.off("click dblclick contextmenu"),t.on({click:_.bind(this.onClick,this),dblclick:_.bind(this.onDblClick,this),contextmenu:_.bind(this.onContextMenu,this)}),t.toggleClass("disabled",!!this.model.get("disabled")),_.isUndefined(this.model.get("cls"))||t.addClass(this.model.get("cls")),(e=t.data("bs.tooltip"))&&void 0===e.dontShow&&t.is(":hover")&&(e.dontShow=!0),!1!==this.scaling&&t.find(".options__icon").length&&(t.attr("ratio","ratio"),this.applyScaling(Common.UI.Scaling.currentRatio()),t.on("app:scaling",_.bind(function(t,e){this.scaling!=e.ratio&&this.applyScaling(e.ratio)},this))),this.trigger("change",this,this.model)),this},remove:function(){this.stopListening(this.model),this.trigger("remove",this,this.model),Common.UI.BaseView.prototype.remove.call(this)},onClick:function(t){if(this.model.get("disabled"))return!1;this.trigger("click",this,this.model,t)},onDblClick:function(t){if(this.model.get("disabled"))return!1;this.trigger("dblclick",this,this.model,t)},onContextMenu:function(t){this.trigger("contextmenu",this,this.model,t)},onSelectChange:function(t,e){this.trigger("select",this,t,e)},onChange:function(){var t;return _.isUndefined(this.model.id)||((t=this.$el||$(this.el)).toggleClass("selected",this.model.get("selected")&&this.model.get("allowSelected")),t.toggleClass("disabled",!!this.model.get("disabled")),this.trigger("change",this,this.model)),this},applyScaling:function(t){var e;2<(this.scaling=t)&&(0<(e=(t=this.$el||$(this.el)).find(".options__icon")).length&&(t.find("svg.icon").length||(t=e.attr("class"),t=(t=/btn-[^\s]+/.exec(t))?t[0]:"null",t='<svg class="icon"><use class="zoom-int" href="#%iconname"></use></svg>'.replace("%iconname",t),e.after(t))))}}),Common.UI.DataView=Common.UI.BaseView.extend({options:{multiSelect:!1,handleSelect:!0,enableKeyEvents:!0,keyMoveDirection:"both",restoreHeight:0,emptyText:"",listenStoreEvents:!0,allowScrollbar:!0,scrollAlwaysVisible:!1,minScrollbarLength:40,scrollYStyle:null,showLast:!0,useBSKeydown:!1,cls:""},template:_.template(['<div class="dataview inner <%= cls %>" style="<%= style %>">',"<% _.each(groups, function(group) { %>","<% if (group.headername !== undefined) { %>",'<div class="header-name"><%= group.headername %></div>',"<% } %>",'<div class="grouped-data <% if (group.inline) { %> inline <% } %> <% if (!_.isEmpty(group.caption)) { %> margin <% } %>" id="<%= group.id %>">',"<% if (!_.isEmpty(group.caption)) { %>",'<div class="group-description">',"<span><%= group.caption %></span>","</div>","<% } %>",'<div class="group-items-container">',"</div>","</div>","<% }); %>","</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);t=this;t.template=t.options.template||t.template,t.store=t.options.store||new Common.UI.DataViewStore,t.groups=t.options.groups||null,t.itemTemplate=t.options.itemTemplate||null,t.itemDataHint=t.options.itemDataHint||"",t.itemDataHintDirection=t.options.itemDataHintDirection||"",t.itemDataHintOffset=t.options.itemDataHintOffset||"",t.multiSelect=t.options.multiSelect,t.handleSelect=t.options.handleSelect,t.parentMenu=t.options.parentMenu,t.outerMenu=t.options.outerMenu,t.enableKeyEvents=t.options.enableKeyEvents,t.useBSKeydown=t.options.useBSKeydown,t.showLast=t.options.showLast,t.style=t.options.style||"",t.cls=t.options.cls||"",t.emptyText=t.options.emptyText||"",t.listenStoreEvents=void 0===t.options.listenStoreEvents||t.options.listenStoreEvents,t.allowScrollbar=void 0===t.options.allowScrollbar||t.options.allowScrollbar,t.scrollAlwaysVisible=t.options.scrollAlwaysVisible||!1,t.minScrollbarLength=t.options.minScrollbarLength||40,t.scrollYStyle=t.options.scrollYStyle,t.tabindex=t.options.tabindex||0,t.delayRenderTips=t.options.delayRenderTips||!1,t.parentMenu&&(t.parentMenu.options.restoreHeight=0<t.options.restoreHeight),t.delaySelect=t.options.delaySelect||!1,t.rendered=!1,t.dataViewItems=[],"vertical"==t.options.keyMoveDirection?t.moveKeys=[Common.UI.Keys.UP,Common.UI.Keys.DOWN]:"horizontal"==t.options.keyMoveDirection?t.moveKeys=[Common.UI.Keys.LEFT,Common.UI.Keys.RIGHT]:t.moveKeys=[Common.UI.Keys.UP,Common.UI.Keys.DOWN,Common.UI.Keys.LEFT,Common.UI.Keys.RIGHT],!1===t.options.scaling&&(t.cls=t.options.cls+" scaling-off"),t.options.el&&t.render()},render:function(t){var i=this,t=(this.trigger("render:before",this),t?(this.setElement(t,!1),this.cmpEl=$(this.template({groups:i.groups?i.groups.toJSON():null,style:i.style,cls:i.cls,options:i.options})),t.html(this.cmpEl)):(this.cmpEl=i.$el||$(this.el),this.cmpEl.html(this.template({groups:i.groups?i.groups.toJSON():null,style:i.style,cls:i.cls,options:i.options}))),this.cmpEl.closest(".asc-window"));return 0<(t=t.length<1?this.cmpEl.closest('[id^="menu-container-"]'):t).length&&(this.tipZIndex=parseInt(t.css("z-index"))+10),this.rendered||(this.listenStoreEvents&&(this.listenTo(this.store,"add",this.onAddItem),this.listenTo(this.store,"reset",this.onResetItems),this.groups&&(this.listenTo(this.groups,"add",this.onAddGroup),this.listenTo(this.groups,"remove",this.onRemoveGroup))),this.onResetItems(),this.parentMenu&&(this.cmpEl.closest("li").css("height","100%"),this.cmpEl.css("height","100%"),this.parentMenu.on("show:after",_.bind(this.alignPosition,this))),this.enableKeyEvents&&this.parentMenu&&this.handleSelect&&(i.showLast||this.parentMenu.on("show:before",function(t){i.deselectAll()}),this.parentMenu.on("show:after",function(t,e){e&&t.el!==e.target||(i.showLast&&i.showLastSelected(),Common.NotificationCenter.trigger("dataview:focus"),_.delay(function(){t.cmpEl.find(".dataview").focus()},10))}).on("hide:after",function(){Common.NotificationCenter.trigger("dataview:blur")}))),_.isUndefined(this.scroller)&&this.allowScrollbar&&(this.scroller=new Common.UI.Scroller({el:$(this.el).find(".inner").addBack().filter(".inner"),useKeyboard:this.enableKeyEvents&&!this.handleSelect,minScrollbarLength:this.minScrollbarLength,scrollYStyle:this.scrollYStyle,wheelSpeed:10,alwaysVisibleY:this.scrollAlwaysVisible})),this.rendered=!0,this.cmpEl.on("click",function(t){if(/dataview/.test(t.target.className))return!1}),this.trigger("render:after",this),this},setStore:function(t){t&&(this.stopListening(this.store),this.store=t,this.listenStoreEvents&&(this.listenTo(this.store,"add",this.onAddItem),this.listenTo(this.store,"reset",this.onResetItems)))},selectRecord:function(e,t){var i,s;if(this.handleSelect)return t&&this.suspendEvents(),this.extremeSeletedRec=e,!this.multiSelect||!this.pressedShift&&!this.pressedCtrl||!this.currentSelectedRec||this.pressedShift&&this.currentSelectedRec==e?(_.each(this.store.where({selected:!0}),function(t){t.set({selected:!1})}),e&&(e.set({selected:!0}),this.currentSelectedRec=e)):e&&(this.pressedCtrl?(e.set({selected:!e.get("selected")}),this.currentSelectedRec=e):this.pressedShift&&(i=this,s=!1,_.each(i.store.models,function(t){i.currentSelectedRec==t||e==t?(s=!s,t.set({selected:!0})):t.set({selected:s})}))),t&&this.resumeEvents(),e},selectByIndex:function(t,e){if(0<this.store.length&&-1<t&&t<this.store.length)return this.selectRecord(this.store.at(t),e)},deselectAll:function(t){t&&this.suspendEvents(),_.each(this.store.where({selected:!0}),function(t){t.set({selected:!1})}),t&&this.resumeEvents()},getSelectedRec:function(){return this.multiSelect?this.store.where({selected:!0}):this.store.findWhere({selected:!0})},onAddItem:function(t,e,i){var s,o,n,a,l=new Common.UI.DataViewItem({template:this.itemTemplate,model:t,scaling:this.options.scaling,dataHint:this.itemDataHint,dataHintDirection:this.itemDataHintDirection,dataHintOffset:this.itemDataHintOffset});l&&(s=$(this.el).find(".inner").addBack().filter(".inner"),this.groups&&0<this.groups.length&&((o=this.groups.findWhere({id:t.get("group")}))&&(s=s.find("#"+o.id+" .group-items-container"))),o=_.indexOf(this.store.models,t),s&&(i&&"number"==typeof i.at&&0<=i.at?0==i.at?s.prepend(l.render().el):this.groups&&0<this.groups.length?s.append(l.render().el):(i=s.find("> div"),0<o?$(i.get(o-1)).after(l.render().el):0<i.length?$(i[o]).before(l.render().el):s.append(l.render().el)):s.append(l.render().el),this.dataViewItems.length<1&&s.find(".empty-text").remove(),this.dataViewItems=this.dataViewItems.slice(0,o).concat(l).concat(this.dataViewItems.slice(o)),n=this,a=$(l.el),null!=t.get("tip")&&(this.delayRenderTips?a.one("mouseenter",function(){a.attr("data-toggle","tooltip"),a.tooltip({title:t.get("tip"),placement:"cursor",zIndex:n.tipZIndex}),a.mouseenter()}):(a.attr("data-toggle","tooltip"),a.tooltip({title:t.get("tip"),placement:"cursor",zIndex:n.tipZIndex}))),this.listenTo(l,"change",this.onChangeItem),this.listenTo(l,"remove",this.onRemoveItem),this.listenTo(l,"click",this.onClickItem),this.listenTo(l,"dblclick",this.onDblClickItem),this.listenTo(l,"select",this.onSelectItem),this.listenTo(l,"contextmenu",this.onContextMenuItem),this.isSuspendEvents||this.trigger("item:add",this,l,t))),this._layoutParams=void 0},onAddGroup:function(t){var e,i=$(_.template(["<% if (group.headername !== undefined) { %>",'<div class="header-name"><%= group.headername %></div>',"<% } %>",'<div class="grouped-data <% if (group.inline) { %> group.inline <% } %> <% if (!_.isEmpty(group.caption)) { %> margin <% } %>" id="<%= group.id %>">',"<% if (!_.isEmpty(group.caption)) { %>",'<div class="group-description">',"<span><%= group.caption %></span>","</div>","<% } %>",'<div class="group-items-container">',"</div>","</div>"].join(""))({group:t.toJSON()})),s=$(this.el).find(".inner").addBack().filter(".inner");s&&(t=_.indexOf(this.groups.models,t),e=s.find(".grouped-data"),0<t?$(e.get(t-1)).after(i):0<e.length?$(e[t]).before(i):s.append(i))},onRemoveGroup:function(t){var e=$(this.el).find(".inner").addBack().filter(".inner");e&&(e=e.find("#"+t.get("id")+".grouped-data"))&&e.remove(),this._layoutParams=void 0},onResetItems:function(){this.trigger("reset:before",this),_.each(this.dataViewItems,function(t){t=t.$el.data("bs.tooltip");t&&(void 0===t.dontShow&&(t.dontShow=!0),t.tip().remove())},this),$(this.el).html(this.template({groups:this.groups?this.groups.toJSON():null,style:this.style,cls:this.cls,options:this.options})),_.isUndefined(this.scroller)||(this.scroller.destroy(),delete this.scroller),this.store.length<1&&0<this.emptyText.length&&$(this.el).find(".inner").addBack().filter(".inner").append('<table cellpadding="10" class="empty-text"><tr><td>'+this.emptyText+"</td></tr></table>"),_.each(this.dataViewItems,function(t){this.stopListening(t),t.stopListening(t.model)},this),this.dataViewItems=[];var e=this;this.store.each(function(t){e.onAddItem(t,e.store)},this),this.allowScrollbar&&(this.scroller=new Common.UI.Scroller({el:$(this.el).find(".inner").addBack().filter(".inner"),useKeyboard:this.enableKeyEvents&&!this.handleSelect,minScrollbarLength:this.minScrollbarLength,scrollYStyle:this.scrollYStyle,wheelSpeed:10,alwaysVisibleY:this.scrollAlwaysVisible})),this.disabled&&this.setDisabled(this.disabled),this.attachKeyEvents(),this.lastSelectedRec=null,this._layoutParams=void 0},onChangeItem:function(t,e){this.isSuspendEvents||this.trigger("item:change",this,t,e)},onRemoveItem:function(t,e){var i=t.$el.data("bs.tooltip");i&&(void 0===i.dontShow&&(i.dontShow=!0),i.tip().remove()),this.stopListening(t),t.stopListening(),this.store.length<1&&0<this.emptyText.length&&((i=$(this.el).find(".inner").addBack().filter(".inner")).find(".empty-text").length<=0&&i.append('<table cellpadding="10" class="empty-text"><tr><td>'+this.emptyText+"</td></tr></table>"));for(var s=0;s<this.dataViewItems.length;s++)if(_.isEqual(t,this.dataViewItems[s])){this.dataViewItems.splice(s,1);break}this.isSuspendEvents||this.trigger("item:remove",this,t,e),this._layoutParams=void 0},onClickItem:function(t,e,i){var s;this.disabled||(window._event=i,this.multiSelect&&(i&&i.ctrlKey?this.pressedCtrl=!0:i&&i.shiftKey&&(this.pressedShift=!0)),this.showLast&&(this.delaySelect?(_.each(this.store.where({selected:!0}),function(t){t.set({selected:!1})}),e&&setTimeout(_.bind(function(){e.set({selected:!0}),this.trigger("item:click",this,t,e,i)},this),300)):this.selectRecord(e)),this.lastSelectedRec=null,(s=t.$el.data("bs.tooltip"))&&s.tip().remove(),this.isSuspendEvents||this.delaySelect||this.trigger("item:click",this,t,e,i))},onDblClickItem:function(t,e,i){this.disabled||(window._event=i,this.showLast&&this.selectRecord(e),this.lastSelectedRec=null,this.isSuspendEvents||this.trigger("item:dblclick",this,t,e,i))},onSelectItem:function(t,e,i){this.isSuspendEvents||this.trigger(i?"item:select":"item:deselect",this,t,e,this._fromKeyDown)},onContextMenuItem:function(t,e,i){this.isSuspendEvents||this.trigger("item:contextmenu",this,t,e,i)},scrollToRecord:function(t,e,i){var s,o,n;t&&(i=(s=$(this.el).find(".inner")).offset().top+(i||0),(o=0<=(o=_.indexOf(this.store.models,t))&&this.dataViewItems.length>o?$(this.dataViewItems[o].el):s.find("#"+t.get("id"))).length<=0||(t=o.offset().top,n=0<(n=$(this.dataViewItems[0].el)).length?n[0].clientTop:0,(e||t<i+n||t+.9*o.outerHeight()>i+n+s.height())&&(this.scroller&&this.allowScrollbar?this.scroller.scrollTop(s.scrollTop()+t-i-n,0):s.scrollTop(s.scrollTop()+t-i-n))))},onKeyDown:function(t,e){if(!this.disabled)if(void 0===e&&(e=t),this.multiSelect&&(e.keyCode==Common.UI.Keys.CTRL?this.pressedCtrl=!0:e.keyCode==Common.UI.Keys.SHIFT&&(this.pressedShift=!0)),-1<_.indexOf(this.moveKeys,e.keyCode)||e.keyCode==Common.UI.Keys.RETURN){e.preventDefault(),e.stopPropagation();var i=this.multiSelect?this.extremeSeletedRec:this.getSelectedRec();if(null===this.lastSelectedRec&&(this.lastSelectedRec=i),e.keyCode==Common.UI.Keys.RETURN)this.lastSelectedRec=null,this.selectedBeforeHideRec&&(i=this.selectedBeforeHideRec),this.trigger("item:click",this,this,i,t),this.trigger("item:select",this,this,i,t),this.trigger("entervalue",this,i,t),this.parentMenu&&this.parentMenu.hide();else{this.pressedCtrl=!1;var s=_.indexOf(this.store.models,i);if(s<0)e.keyCode==Common.UI.Keys.LEFT&&0<(o=$(t.target).closest(".dropdown-submenu.over")).length?(o.removeClass("over"),o.find("> a").focus()):s=0;else if("both"==this.options.keyMoveDirection){void 0===this._layoutParams&&this.fillIndexesArray();var o,n=this.dataViewItems[s].topIdx,a=this.dataViewItems[s].leftIdx,s=void 0;if(e.keyCode==Common.UI.Keys.LEFT)for(;void 0===s;){if(--a<0){if(0<(o=$(t.target).closest(".dropdown-submenu.over")).length){o.removeClass("over"),o.find("> a").focus();break}a=this._layoutParams.columns-1}s=this._layoutParams.itemsIndexes[n][a]}else if(e.keyCode==Common.UI.Keys.RIGHT)for(;void 0===s;)++a>this._layoutParams.columns-1&&(a=0),s=this._layoutParams.itemsIndexes[n][a];else if(e.keyCode==Common.UI.Keys.UP){if(0==n&&this.outerMenu&&this.outerMenu.menu)return this.deselectAll(!0),void(this.outerMenu.menu.focusOuter&&this.outerMenu.menu.focusOuter(e,this.outerMenu.index));for(;void 0===s;)--n<0&&(n=this._layoutParams.rows-1),s=this._layoutParams.itemsIndexes[n][a]}else{if(n==this._layoutParams.rows-1&&this.outerMenu&&this.outerMenu.menu)return this.deselectAll(!0),void(this.outerMenu.menu.focusOuter&&this.outerMenu.menu.focusOuter(e,this.outerMenu.index));for(;void 0===s;)++n>this._layoutParams.rows-1&&(n=0),s=this._layoutParams.itemsIndexes[n][a]}}else s=e.keyCode==Common.UI.Keys.UP||e.keyCode==Common.UI.Keys.LEFT?Math.max(0,s-1):Math.min(this.store.length-1,s+1);(i=void 0!==s&&0<=s?this.store.at(s):i)&&(this._fromKeyDown=!0,this.selectRecord(i),this.scrollToRecord(i),this._fromKeyDown=!1)}}else this.trigger("item:keydown",this,i,t)},onKeyUp:function(t){t.keyCode==Common.UI.Keys.SHIFT&&(this.pressedShift=!1),t.keyCode==Common.UI.Keys.CTRL&&(this.pressedCtrl=!1),this.trigger("item:keyup",this,t)},attachKeyEvents:function(){var t;this.enableKeyEvents&&this.handleSelect&&((t=$(this.el).find(".inner").addBack().filter(".inner")).addClass("canfocused"),t.attr("tabindex",this.tabindex.toString()),t.on(this.parentMenu&&this.useBSKeydown?"dataview:keydown":"keydown",_.bind(this.onKeyDown,this)),t.on(this.parentMenu&&this.useBSKeydown?"dataview:keyup":"keyup",_.bind(this.onKeyUp,this)))},showLastSelected:function(){var t;this.lastSelectedRec?(this.selectRecord(this.lastSelectedRec,!0),this.scrollToRecord(this.lastSelectedRec),this.lastSelectedRec=null):(t=this.getSelectedRec(),this.multiSelect?t&&0<t.length&&this.scrollToRecord(t[t.length-1]):this.scrollToRecord(t))},setDisabled:function(t){this.disabled=t=!!t,$(this.el).find(".inner").addBack().filter(".inner").toggleClass("disabled",t)},isDisabled:function(){return this.disabled},setEmptyText:function(t){this.emptyText=t,this.store.length<1&&(0<(t=$(this.el).find(".inner").addBack().filter(".inner").find(".empty-text td")).length&&t.text(this.emptyText))},alignPosition:function(){var t="menu"===this.parentMenu.cmpEl.attr("role")?this.parentMenu.cmpEl:this.parentMenu.cmpEl.find("[role=menu]"),e=Common.Utils.innerHeight()-10,i=$(this.el).find(".inner").addBack().filter(".inner"),s=t.outerHeight(),o=i.height(),n=Math.max(s-o,0),t=parseInt(t.css("top")),a={minScrollbarLength:this.minScrollbarLength};this.scrollAlwaysVisible&&(a.alwaysVisibleY=this.scrollAlwaysVisible),e<t+s?(i.css("max-height",e-t-n+"px"),this.allowScrollbar&&this.scroller.update(a)):t+s<e&&o<this.options.restoreHeight&&(i.css("max-height",Math.min(e-t-n,this.options.restoreHeight)+"px"),this.allowScrollbar&&this.scroller.update(a))},fillIndexesArray:function(){if(!(this.dataViewItems.length<=0)){this._layoutParams={itemsIndexes:[],columns:0,rows:0};for(var t=$(this.dataViewItems[0].el),e=t.outerWidth()+parseFloat(t.css("margin-left"))+parseFloat(t.css("margin-right")),i=this.$el.offset().left,s=t.offset().top,o=-1,n=0,a=0;a<this.dataViewItems.length;a++){var l=$(this.dataViewItems[a].el).offset().top-s,r=Math.floor(($(this.dataViewItems[a].el).offset().left-i)/e+.01);o<l&&(o=l,this._layoutParams.itemsIndexes.push([]),n=this._layoutParams.itemsIndexes.length-1),this._layoutParams.itemsIndexes[n][r]=a,this.dataViewItems[a].topIdx=n,this.dataViewItems[a].leftIdx=r,this._layoutParams.columns<r&&(this._layoutParams.columns=r)}this._layoutParams.rows=this._layoutParams.itemsIndexes.length,this._layoutParams.columns++}},setMultiselectMode:function(t){this.pressedCtrl=!!t},onResize:function(){this._layoutParams=void 0},focus:function(t){var e;$(this.el).find(".inner").addBack().filter(".inner").focus(),"string"==typeof t?"first"==t?e=this.selectByIndex(0,!0):"last"==t&&(void 0===this._layoutParams&&this.fillIndexesArray(),e=this.selectByIndex(this._layoutParams.itemsIndexes[this._layoutParams.rows-1][0],!0)):void 0!==t&&(e=this.selectByIndex(t,!0)),this.scrollToRecord(e)},focusInner:function(t){this.focus(t.keyCode==Common.UI.Keys.DOWN?"first":"last")}}),Common.UI.DataViewSimple=Common.UI.BaseView.extend({options:{handleSelect:!0,enableKeyEvents:!0,keyMoveDirection:"both",restoreHeight:0,scrollAlwaysVisible:!1,useBSKeydown:!1},template:_.template(['<div class="dataview inner" style="<%= style %>">',"<% _.each(items, function(item) { %>","<% if (!item.id) item.id = Common.UI.getId(); %>",'<div class="item" <% if(!!item.tip) { %> data-toggle="tooltip" <% } %> data-hint="<%= item.dataHint %>" data-hint-direction="<%= item.dataHintDirection %>" data-hint-offset="<%= item.dataHintOffset %>"><%= itemTemplate(item) %></div>',"<% }) %>","</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);t=this;t.template=t.options.template||t.template,t.store=t.options.store||new Common.UI.DataViewStore,t.itemTemplate=t.options.itemTemplate||null,t.handleSelect=t.options.handleSelect,t.parentMenu=t.options.parentMenu,t.enableKeyEvents=t.options.enableKeyEvents,t.useBSKeydown=t.options.useBSKeydown,t.style=t.options.style||"",t.scrollAlwaysVisible=t.options.scrollAlwaysVisible||!1,t.tabindex=t.options.tabindex||0,t.parentMenu&&(t.parentMenu.options.restoreHeight=0<t.options.restoreHeight),t.rendered=!1,"vertical"==t.options.keyMoveDirection?t.moveKeys=[Common.UI.Keys.UP,Common.UI.Keys.DOWN]:"horizontal"==t.options.keyMoveDirection?t.moveKeys=[Common.UI.Keys.LEFT,Common.UI.Keys.RIGHT]:t.moveKeys=[Common.UI.Keys.UP,Common.UI.Keys.DOWN,Common.UI.Keys.LEFT,Common.UI.Keys.RIGHT],t.options.el&&t.render()},render:function(t){var e=this,t=(this.trigger("render:before",this),t?(this.setElement(t,!1),this.cmpEl=$(this.template({items:e.store.toJSON(),itemTemplate:e.itemTemplate,style:e.style})),t.html(this.cmpEl)):(this.cmpEl=e.$el||$(this.el),this.cmpEl.html(this.template({items:e.store.toJSON(),itemTemplate:e.itemTemplate,style:e.style,options:e.options}))),this.cmpEl.closest(".asc-window"));return 0<(t=t.length<1?this.cmpEl.closest('[id^="menu-container-"]'):t).length&&(this.tipZIndex=parseInt(t.css("z-index"))+10),this.rendered||(this.parentMenu?(this.cmpEl.closest("li").css("height","100%"),this.cmpEl.css("height","100%"),this.parentMenu.on("show:after",_.bind(this.alignPosition,this)),this.parentMenu.on("show:after",_.bind(this.onAfterShowMenu,this))):0<this.store.length&&this.onAfterShowMenu(),this.enableKeyEvents&&this.parentMenu&&this.handleSelect&&(this.parentMenu.on("show:before",function(t){e.deselectAll()}),this.parentMenu.on("show:after",function(t){Common.NotificationCenter.trigger("dataview:focus"),_.delay(function(){t.cmpEl.find(".dataview").focus()},10)}).on("hide:after",function(){Common.NotificationCenter.trigger("dataview:blur")})),this.attachKeyEvents(),this.cmpEl.on("click","div.item",_.bind(e.onClickItem,e))),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:$(this.el).find(".inner").addBack().filter(".inner"),useKeyboard:this.enableKeyEvents&&!this.handleSelect,minScrollbarLength:this.minScrollbarLength,scrollYStyle:this.scrollYStyle,wheelSpeed:10,alwaysVisibleY:this.scrollAlwaysVisible})),this.rendered=!0,this.cmpEl.on("click",function(t){if(/dataview/.test(t.target.className))return!1}),this.trigger("render:after",this),this},selectRecord:function(t,e){var i;if(this.handleSelect)return e&&this.suspendEvents(),this.deselectAll(e),t&&(t.set({selected:!0}),0<=(i=_.indexOf(this.store.models,t))&&this.dataViewItems&&this.dataViewItems.length>i&&this.dataViewItems[i].el.addClass("selected")),e&&this.resumeEvents(),t},selectByIndex:function(t,e){if(0<this.store.length&&-1<t&&t<this.store.length)return this.selectRecord(this.store.at(t),e)},deselectAll:function(t){t&&this.suspendEvents(),_.each(this.store.where({selected:!0}),function(t){t.set({selected:!1})}),this.cmpEl.find(".item.selected").removeClass("selected"),t&&this.resumeEvents()},getSelectedRec:function(){return this.store.findWhere({selected:!0})},onResetItems:function(){this.dataViewItems&&_.each(this.dataViewItems,function(t){t=t.el.data("bs.tooltip");t&&(void 0===t.dontShow&&(t.dontShow=!0),t.tip().remove())},this),this.dataViewItems=null;var t=_.template(["<% _.each(items, function(item) { %>","<% if (!item.id) item.id = Common.UI.getId(); %>",'<div class="item" <% if(!!item.tip) { %> data-toggle="tooltip" <% } %> data-hint="<%= item.dataHint %>" data-hint-direction="<%= item.dataHintDirection %>" data-hint-offset="<%= item.dataHintOffset %>"><%= itemTemplate(item) %></div>',"<% }) %>"].join(""));this.cmpEl&&this.cmpEl.find(".inner").html(t({items:this.store.toJSON(),itemTemplate:this.itemTemplate,style:this.style})),_.isUndefined(this.scroller)||(this.scroller.destroy(),delete this.scroller),this.scroller=new Common.UI.Scroller({el:$(this.el).find(".inner").addBack().filter(".inner"),useKeyboard:this.enableKeyEvents&&!this.handleSelect,minScrollbarLength:this.minScrollbarLength,scrollYStyle:this.scrollYStyle,wheelSpeed:10,alwaysVisibleY:this.scrollAlwaysVisible}),!this.parentMenu&&0<this.store.length&&this.onAfterShowMenu(),this._layoutParams=void 0},setStore:function(t){t&&(this.store=t,this.onResetItems())},onClickItem:function(t){var e,i,s;this.disabled||(window._event=t,e=0<=(i=$(t.currentTarget).closest("div.item").index())?this.store.at(i):null,i=0<=i?this.dataViewItems[i]:null,e&&i&&(e.set({selected:!0}),(s=i.el.data("bs.tooltip"))&&s.tip().remove(),this.isSuspendEvents||this.trigger("item:click",this,i.el,e,t)))},onAfterShowMenu:function(t){var i;this.dataViewItems||((i=this).dataViewItems=[],_.each(this.cmpEl.find("div.item"),function(t,e){t=$(t),e=i.store.at(e);i.dataViewItems.push({el:t}),e.get("tip")&&t.tooltip({title:e.get("tip"),placement:"cursor",zIndex:i.tipZIndex})}))},scrollToRecord:function(t){var e,i,s,o;t&&(i=(e=$(this.el).find(".inner")).offset().top,(s=0<=(s=_.indexOf(this.store.models,t))&&this.dataViewItems.length>s?this.dataViewItems[s].el:e.find("#"+t.get("id"))).length<=0||((t=s.offset().top)<i+(o=0<(o=this.dataViewItems[0].el).length?o[0].offsetTop:0)||t+s.outerHeight()>i+e.height())&&(this.scroller?this.scroller.scrollTop(e.scrollTop()+t-i-o,0):e.scrollTop(e.scrollTop()+t-i-o)))},onKeyDown:function(t,e){if(!this.disabled)if(void 0===e&&(e=t),-1<_.indexOf(this.moveKeys,e.keyCode)||e.keyCode==Common.UI.Keys.RETURN){e.preventDefault(),e.stopPropagation();var i=this.getSelectedRec();if(e.keyCode==Common.UI.Keys.RETURN)this.selectedBeforeHideRec&&(i=this.selectedBeforeHideRec),this.canAddRecents&&this.addRecentItem(i),this.trigger("item:click",this,this,i,t),this.parentMenu&&this.parentMenu.hide();else{if((l=_.indexOf(this.store.models,i))<0){function s(){for(var t=0;!this.dataViewItems[t].el.is(":visible");)t++;return t}e.keyCode==Common.UI.Keys.LEFT&&0<(o=$(t.target).closest(".dropdown-submenu.over")).length?(o.removeClass("over"),o.find("> a").focus()):l=s.call(this)}else if("both"==this.options.keyMoveDirection){void 0===this._layoutParams&&this.fillIndexesArray();var o,n=this.dataViewItems[l].topIdx,a=this.dataViewItems[l].leftIdx,l=void 0;if(e.keyCode==Common.UI.Keys.LEFT)for(;void 0===l;){if(--a<0){if(0<(o=$(t.target).closest(".dropdown-submenu.over")).length){o.removeClass("over"),o.find("> a").focus();break}a=this._layoutParams.columns-1}l=this._layoutParams.itemsIndexes[n][a]}else if(e.keyCode==Common.UI.Keys.RIGHT)for(;void 0===l;)++a>this._layoutParams.columns-1&&(a=0),l=this._layoutParams.itemsIndexes[n][a];else if(e.keyCode==Common.UI.Keys.UP){if(0==n&&this.outerMenu&&this.outerMenu.menu)return this.deselectAll(!0),void(this.outerMenu.menu.focusOuter&&this.outerMenu.menu.focusOuter(e,this.outerMenu.index));for(;void 0===l;)--n<0&&(n=this._layoutParams.rows-1),l=this._layoutParams.itemsIndexes[n][a]}else{if(n==this._layoutParams.rows-1&&this.outerMenu&&this.outerMenu.menu)return this.deselectAll(!0),void(this.outerMenu.menu.focusOuter&&this.outerMenu.menu.focusOuter(e,this.outerMenu.index));for(;void 0===l;)++n>this._layoutParams.rows-1&&(n=0),l=this._layoutParams.itemsIndexes[n][a]}}else l=e.keyCode==Common.UI.Keys.UP||e.keyCode==Common.UI.Keys.LEFT?Math.max(0,l-1):Math.min(this.store.length-1,l+1);(i=void 0!==l&&0<=l?this.store.at(l):i)&&(this._fromKeyDown=!0,this.selectRecord(i),this.scrollToRecord(i),this._fromKeyDown=!1)}}else this.trigger("item:keydown",this,i,t)},attachKeyEvents:function(){var t;this.enableKeyEvents&&this.handleSelect&&((t=$(this.el).find(".inner").addBack().filter(".inner")).addClass("canfocused"),t.attr("tabindex",this.tabindex.toString()),t.on(this.parentMenu&&this.useBSKeydown?"dataview:keydown":"keydown",_.bind(this.onKeyDown,this)))},setDisabled:function(t){this.disabled=t=!!t,$(this.el).find(".inner").addBack().filter(".inner").toggleClass("disabled",t)},isDisabled:function(){return this.disabled},alignPosition:function(){var t,e="menu"===this.parentMenu.cmpEl.attr("role")?this.parentMenu.cmpEl:this.parentMenu.cmpEl.find("[role=menu]"),i=Common.Utils.innerHeight()-10,s=$(this.el).find(".inner").addBack().filter(".inner"),o=s.parent(),o=parseInt(o.css("margin-top"))+parseInt(o.css("margin-bottom"))+parseInt(e.css("margin-top")),n=parseInt(e.css("padding-top"))+parseInt(e.css("padding-bottom")),a=e.outerHeight(),l=parseInt(e.css("top")),r={minScrollbarLength:this.minScrollbarLength},c=(this.scrollAlwaysVisible&&(r.alwaysVisibleY=this.scrollAlwaysVisible),!1);(c=this.parentMenu.menuAlign?"bl"===(t=this.parentMenu.menuAlign.match(/^([a-z]+)-([a-z]+)/))[1]||"br"===t[1]:c)?(t=l+a,l<0?(s.css("max-height",t-n-o+"px"),e.css("top",0),this.scroller.update(r)):0<l&&s.height()<this.options.restoreHeight&&(s.css("max-height",Math.min(t-n-o,this.options.restoreHeight)+"px"),e.css("top",t-e.outerHeight()),this.scroller.update(r))):i<l+a?(s.css("max-height",i-l-n-o+"px"),this.scroller.update(r)):l+a<i&&s.height()<this.options.restoreHeight&&(s.css("max-height",Math.min(i-l-n-o,this.options.restoreHeight)+"px"),this.scroller.update(r))},fillIndexesArray:function(){if(!(this.dataViewItems.length<=0)){this._layoutParams={itemsIndexes:[],columns:0,rows:0};for(var t=this.dataViewItems[0].el,e=t.outerWidth()+parseFloat(t.css("margin-left"))+parseFloat(t.css("margin-right")),i=this.$el.offset().left,s=t.offset().top,o=-1,n=0,a=0;a<this.dataViewItems.length;a++){var l=this.dataViewItems[a],r=l.el.offset().top-s,c=Math.floor((l.el.offset().left-i)/e);o<r&&(o=r,this._layoutParams.itemsIndexes.push([]),n=this._layoutParams.itemsIndexes.length-1),this._layoutParams.itemsIndexes[n][c]=a,l.topIdx=n,l.leftIdx=c,this._layoutParams.columns<c&&(this._layoutParams.columns=c)}this._layoutParams.rows=this._layoutParams.itemsIndexes.length,this._layoutParams.columns++}},onResize:function(){this._layoutParams=void 0},focus:function(){this.cmpEl&&this.cmpEl.find(".dataview").focus()}}),$(document).on("keydown.dataview","[data-toggle=dropdown], [role=menu]",function(e){e.keyCode!==Common.UI.Keys.UP&&e.keyCode!==Common.UI.Keys.DOWN&&e.keyCode!==Common.UI.Keys.LEFT&&e.keyCode!==Common.UI.Keys.RIGHT&&e.keyCode!==Common.UI.Keys.RETURN||_.defer(function(){var t=$(e.target).closest(".dropdown-toggle");(t.length?t.parent():$(e.target).closest(".dropdown-submenu")).find(".inner.canfocused").trigger("dataview:keydown",e)},100)}),Common.UI.DataViewShape=Common.UI.DataViewSimple.extend(_.extend({template:_.template(['<div class="dataview inner" style="<%= style %>">',"<% _.each(options.groupsWithRecent, function(group, index) { %>",'<div class="grouped-data <% if (index === 0) { %> recent-group <% } %> " id="<%= group.id %>" >',"<% if (!_.isEmpty(group.groupName)) { %>",'<div class="group-description">',"<span><%= group.groupName %></span>","</div>","<% } %>",'<div class="group-items-container <% if (index === 0) { %> recent-items <% } %>">',"<% _.each(group.groupStore.toJSON(), function(item, index) { %>","<% if (!item.id) item.id = Common.UI.getId(); %>",'<div class="item" data-index="<%= index %>"<% if(!!item.tip) { %> data-toggle="tooltip" <% } %> ><%= itemTemplate(item) %></div>',"<% }); %>","</div>","</div>","<% }); %>","</div>"].join("")),initialize:function(t){var e=this,i=(this.canAddRecents=!0,this._state={hideTextRect:t.hideTextRect,hideLines:t.hideLines},Common.localStorage.getKeysFilter()),i=(this.appPrefix=i&&i.length?i.split(",")[0]:"",e.groups=t.groups.toJSON(),new Common.UI.DataViewGroupStore),s=t.recentShapes||[],o=18<s.length?7:6,n=35*Math.ceil(s.length/o)+3,o=30*o;if((e.recentShapes=s,0<e.recentShapes.length)&&!_.findWhere(e.groups,{groupName:e.recentShapes[0].groupName})){for(var a=0;a<e.recentShapes.length;a++)for(var l,r=e.recentShapes[a].data.shapeType,c=0;c<e.groups.length;c++){for(var d=e.groups[c].groupStore,h=e.groups[c].groupName,p=0;p<d.length;p++)if(d.at(p).get("data").shapeType===r){l=d.at(p).toJSON(),e.recentShapes[a]={data:l.data,tip:l.tip,allowSelected:l.allowSelected,selected:!1,groupName:h};break}if(l){l=void 0;break}}Common.localStorage.setItem(this.appPrefix+"recent-shapes",JSON.stringify(e.recentShapes))}if(e.recentShapes.length<12){for(var m=12-e.recentShapes.length,u=[],g=function(t,e){t=t.toJSON(),t={data:t.data,tip:t.tip,allowSelected:t.allowSelected,selected:!1,groupName:e};u.push(t)},p=0;p<e.groups.length&&0<m;p++){var b=e.groups[p].groupStore,h=e.groups[p].groupName;0===p?(g(b.at(1),h),0<--m&&(g(b.at(2),h),m--)):3!==p&&6!==p&&7!==p&&(g(b.at(0),h),0<--m&&(g(b.at(1),h),m--))}e.recentShapes=e.recentShapes.concat(u)}i.add(e.recentShapes),e.groups.unshift({groupName:t.textRecentlyUsed,groupStore:i,groupWidth:o,groupHeight:n}),e.options.groupsWithRecent=e.groups;d=new Common.UI.DataViewStore;_.each(e.groups,function(t,e){var i=t.groupStore.models;if(0<e)for(var s=0;s<i.length;s++)i[s].set({groupName:t.groupName});d.add(i)}),t.store=d,Common.UI.DataViewSimple.prototype.initialize.call(this,t),e.parentMenu.on("show:before",function(){e.updateRecents()}),e._state.hideLines&&e.hideLinesGroup()},onAfterShowMenu:function(t){var n=this,e=!1;if(n.dataViewItems||(n.dataViewItems=[],_.each(n.cmpEl.find("div.grouped-data"),function(t,o){_.each($(t).find("div.item"),function(t,e){var i=$(t),t=n.groups[o].groupStore.at(e),s=(n.dataViewItems.push({el:i,groupIndex:o,index:e}),t.get("tip"));s&&i.one("mouseenter",function(){i.attr("data-toggle","tooltip"),i.tooltip({title:s,placement:"cursor",zIndex:n.tipZIndex}),i.mouseenter()})})}),e=!0),n.updateDataViewItems&&n.cmpEl.is(":visible")){for(var i=_.where(n.dataViewItems,{groupIndex:0}),s=i?i.length:0,o=0;o<s;o++){var a=n.dataViewItems[o].el.data("bs.tooltip");a&&(void 0===a.dontShow&&(a.dontShow=!0),a.tip().remove())}n.dataViewItems=n.dataViewItems.slice(s);var l=[];_.each(n.cmpEl.find(".recent-group div.item"),function(t,e){var i=$(t),t=n.recentShapes[e],s=(l.push({el:i,groupIndex:0,index:e}),t.tip);s&&i.one("mouseenter",function(){i.attr("data-toggle","tooltip"),i.tooltip({title:s,placement:"cursor",zIndex:n.tipZIndex}),i.mouseenter()})}),n.dataViewItems=l.concat(n.dataViewItems),1===n.recentShapes.length&&$(".recent-group").show(),e=!(n.updateDataViewItems=!1)}this._state.hideLines&&n.hideLines(),e&&n.hideTextRect(n._state.hideTextRect),n.fillIndexesArray()},onClickItem:function(t){var e,i,s,o,n;this.disabled||(window._event=t,e=$(t.currentTarget).closest("div.grouped-data").index(),i=$(t.currentTarget).closest("div.item").data("index"),s=0<=(o=_.findIndex(this.dataViewItems,function(t){return t.groupIndex===e&&t.index===i}))?this.store.at(o):null,o=0<=o?this.dataViewItems[o]:null,s&&o&&(s.set({selected:!0}),(n=o.el.data("bs.tooltip"))&&n.tip().remove(),this.isSuspendEvents||this.trigger("item:click",this,o.el,s,t),this.addRecentItem(s)))},addRecentItem:function(t){for(var e=!1,i=t.get("data").shapeType,s=t.get("groupName"),o=0;o<this.recentShapes.length;o++)if(this.recentShapes[o].data.shapeType===i){e=!0;break}e||(t=[{data:(t=t.toJSON()).data,tip:t.tip,allowSelected:t.allowSelected,selected:!1,groupName:s}].concat(this.recentShapes.slice(0,11)),Common.localStorage.setItem(this.appPrefix+"recent-shapes",JSON.stringify(t)),this.recentShapes=void 0)},updateRecents:function(){var e,i,t,s=this,o=(o=Common.localStorage.getItem(this.appPrefix+"recent-shapes"))?JSON.parse(o):[],n=!1;if(s.recentShapes)for(var a=0;a<o.length;a++)(!s.recentShapes[a]||s.recentShapes[a]&&o[a].tip!==s.recentShapes[a].tip)&&(n=!0);else n=!0;0<o.length&&n&&(s.recentShapes=o,e=new Common.UI.DataViewStore,_.each(s.recentShapes,function(t){t={data:{shapeType:t.data.shapeType},tip:t.tip,allowSelected:t.allowSelected,selected:t.selected,groupName:t.groupName};e.push(t)}),s.groups[0].groupStore=e,i=new Common.UI.DataViewStore,_.each(s.groups,function(t){i.add(t.groupStore.models)}),s.store=i,t=_.template(["<% _.each(items, function(item, index) { %>","<% if (!item.id) item.id = Common.UI.getId(); %>",'<div class="item" data-index="<%= index %>"<% if(!!item.tip) { %> data-toggle="tooltip" <% } %> ><%= itemTemplate(item) %></div>',"<% }) %>"].join("")),s.cmpEl&&s.cmpEl.find(".recent-items").html(t({items:s.recentShapes,itemTemplate:this.itemTemplate,style:this.style})),s.updateDataViewItems=!0)},fillIndexesArray:function(){if(!(this.dataViewItems.length<=0)){this._layoutParams={itemsIndexes:[],columns:0,rows:0};for(var t=this.dataViewItems[0].el,e=0;!this.dataViewItems[e].el.is(":visible");){if(e++,!this.dataViewItems[e])return;t=this.dataViewItems[e].el}for(var i=t.outerWidth()+parseInt(t.css("margin-left"))+parseInt(t.css("margin-right")),s=this.$el.offset().left,o=t.offset().top,n=-1,a=0,l=e,r=0;r<this.dataViewItems.length;r++){var c,d=this.dataViewItems[r];d.el.is(":visible")?(c=d.el.offset().top-o,l=Math.floor((d.el.offset().left-s)/i),n<c&&(n=c,this._layoutParams.itemsIndexes.push([]),a=this._layoutParams.itemsIndexes.length-1),this._layoutParams.itemsIndexes[a][l]=r,d.topIdx=a,d.leftIdx=l,this._layoutParams.columns<l&&(this._layoutParams.columns=l)):(d.topIdx=-1,d.leftIdx=-1)}this._layoutParams.rows=this._layoutParams.itemsIndexes.length,this._layoutParams.columns++}},hideTextRect:function(i){var s=this;this.store.each(function(t,e){"textRect"===t.get("data").shapeType&&s.dataViewItems[e].el[i?"addClass":"removeClass"]("hidden")},this),this._state.hideTextRect=i},hideLinesGroup:function(){$(this.cmpEl.find("div.grouped-data")[9]).hide()},hideLines:function(){var i=this;this.store.each(function(t,e){"Lines"===t.get("groupName")&&(t=i.dataViewItems[e].el).is(":visible")&&t.addClass("hidden")},this)}}))}),void 0===Common&&(Common={}),define("common/main/lib/component/TreeView",["common/main/lib/component/DataView"],function(){"use strict";Common.UI.TreeViewModel=Common.UI.DataViewModel.extend({defaults:function(){return{id:Common.UI.getId(),name:"",isNotHeader:!1,hasSubItems:!1,hasParent:!1,isEmptyItem:!1,isExpanded:!0,isVisible:!0,selected:!1,allowSelected:!0,disabled:!1,level:0,index:0}}}),Common.UI.TreeViewStore=Backbone.Collection.extend({model:Common.UI.TreeViewModel,expandSubItems:function(t){var a=this,l=function(t,e,i){for(var s=t+1;s<a.length;s++){var o=a.at(s),n=o.get("level");if(!(i<n))return s-1;e&&o.set("isVisible",!0),o.get("hasSubItems")&&(s=l(s,o.get("isExpanded"),n))}};t.set("isExpanded",!0),l(t.get("index"),!0,t.get("level"))},collapseSubItems:function(t){for(var e=t.get("level"),i=t.get("index")+1;i<this.length;i++){var s=this.at(i);if(!(e<s.get("level")))break;s.set("isVisible",!1)}return i-1},expandAll:function(){this.each(function(t){t.set("isExpanded",!0),t.set("isVisible",!0)})},collapseAll:function(){for(var t=0;t<this.length;t++){var e=this.at(t);e.get("isNotHeader")||(e.set("isExpanded",!1),t=this.collapseSubItems(e))}},expandToLevel:function(a){for(var l=this,r=function(t,e){var i=l.at(t);i.set("isExpanded",!1);for(var s=t+1;s<l.length;s++){var o=l.at(s),n=o.get("level");if(!(e<n))return s-1;n<=a&&i.set("isExpanded",!0),o.set("isVisible",n<=a),o.get("hasSubItems")&&(s=r(s,n))}},t=0;t<this.length;t++){var e=this.at(t);(e.get("level")<=a||!e.get("hasParent"))&&(e.set("isVisible",!0),e.get("isNotHeader")||(t=r(t,e.get("level"))))}}}),Common.UI.TreeView=Common.UI.DataView.extend({options:{handleSelect:!0,showLast:!0,allowScrollbar:!0,scrollAlwaysVisible:!0,emptyItemText:"",keyMoveDirection:"both"},template:_.template(['<div class="treeview inner" style="<%= style %>"></div>'].join("")),initialize:function(t){t.store=t.store||new Common.UI.TreeViewStore,t.emptyItemText=t.emptyItemText||"",t.itemTemplate=t.itemTemplate||(Common.UI.isRTL()?_.template(['<div id="<%= id %>" class="tree-item <% if (!isVisible) { %>hidden<% } %>" style="display: block;padding-right: <%= level*16 + 24 %>px;">',"<% if (hasSubItems) { %>",'<div class="tree-caret img-commonctrl <% if (!isExpanded) { %>up<% } %>" style="margin-right: <%= level*16 %>px;"></div>',"<% } %>","<% if (isNotHeader) { %>",'<div class="name not-header"><%= Common.Utils.String.htmlEncode(name) %></div>',"<% } else if (isEmptyItem) { %>",'<div class="name empty">'+t.emptyItemText+"</div>","<% } else { %>",'<div class="name"><%= Common.Utils.String.htmlEncode(name) %></div>',"<% } %>","</div>"].join("")):_.template(['<div id="<%= id %>" class="tree-item <% if (!isVisible) { %>hidden<% } %>" style="display: block;padding-left: <%= level*16 + 24 %>px;">',"<% if (hasSubItems) { %>",'<div class="tree-caret img-commonctrl <% if (!isExpanded) { %>up<% } %>" style="margin-left: <%= level*16 %>px;"></div>',"<% } %>","<% if (isNotHeader) { %>",'<div class="name not-header"><%= Common.Utils.String.htmlEncode(name) %></div>',"<% } else if (isEmptyItem) { %>",'<div class="name empty">'+t.emptyItemText+"</div>","<% } else { %>",'<div class="name"><%= Common.Utils.String.htmlEncode(name) %></div>',"<% } %>","</div>"].join(""))),Common.UI.DataView.prototype.initialize.call(this,t)},onAddItem:function(t,e,i){var s,o,n=new Common.UI.DataViewItem({template:this.itemTemplate,model:t});n&&(s=(this.$el||$(this.el)).find(".inner").addBack().filter(".inner"))&&(this.dataViewItems.length<1&&s.find(".empty-text").remove(),i&&"number"==typeof i.at?(i=i.at,o=s.find("> div"),0<i?$(o.get(i-1)).after(n.render().el):0<o.length?$(o[i]).before(n.render().el):s.append(n.render().el),this.dataViewItems=this.dataViewItems.slice(0,i).concat(n).concat(this.dataViewItems.slice(i))):(s.append(n.render().el),this.dataViewItems.push(n)),this.updateTip(n),this.listenTo(n,"change",this.onChangeItem),this.listenTo(n,"remove",this.onRemoveItem),this.listenTo(n,"click",this.onClickItem),this.listenTo(n,"dblclick",this.onDblClickItem),this.listenTo(n,"select",this.onSelectItem),this.listenTo(n,"contextmenu",this.onContextMenuItem),this.isSuspendEvents||this.trigger("item:add",this,n,t))},onClickItem:function(t,e,i){var s=$(i.target);s&&(s.hasClass("tree-caret")||s.hasClass("btn-tree-caret"))?((s=t.$el.data("bs.tooltip"))&&s.tip().remove(),s=!e.get("isExpanded"),e.set("isExpanded",s),this.store[s?"expandSubItems":"collapseSubItems"](e),this.scroller.update({minScrollbarLength:this.minScrollbarLength,alwaysVisibleY:this.scrollAlwaysVisible})):Common.UI.DataView.prototype.onClickItem.call(this,t,e,i)},expandAll:function(){this.store.expandAll(),this.scroller.update({minScrollbarLength:this.minScrollbarLength,alwaysVisibleY:this.scrollAlwaysVisible})},collapseAll:function(){this.store.collapseAll(),this.scroller.update({minScrollbarLength:this.minScrollbarLength,alwaysVisibleY:this.scrollAlwaysVisible})},expandToLevel:function(t){this.store.expandToLevel(t),this.scroller.update({minScrollbarLength:this.minScrollbarLength,alwaysVisibleY:this.scrollAlwaysVisible})},expandRecord:function(t){t&&(t.set("isExpanded",!0),this.store.expandSubItems(t),this.scroller.update({minScrollbarLength:this.minScrollbarLength,alwaysVisibleY:this.scrollAlwaysVisible}))},collapseRecord:function(t){t&&(t.set("isExpanded",!1),this.store.collapseSubItems(t),this.scroller.update({minScrollbarLength:this.minScrollbarLength,alwaysVisibleY:this.scrollAlwaysVisible}))},onKeyDown:function(t,e){if(!this.disabled)if(void 0===e&&(e=t),-1<_.indexOf(this.moveKeys,e.keyCode)||e.keyCode==Common.UI.Keys.RETURN){e.preventDefault(),e.stopPropagation();var i=this.getSelectedRec();if(null===this.lastSelectedRec&&(this.lastSelectedRec=i),e.keyCode==Common.UI.Keys.RETURN)this.lastSelectedRec=null,this.selectedBeforeHideRec&&(i=this.selectedBeforeHideRec),this.trigger("item:click",this,this,i,t),this.trigger("item:select",this,this,i,t),this.trigger("entervalue",this,i,t),this.parentMenu&&this.parentMenu.hide();else{var s=_.indexOf(this.store.models,i);if(s<0)e.keyCode==Common.UI.Keys.LEFT&&0<(o=$(t.target).closest(".dropdown-submenu.over")).length?(o.removeClass("over"),o.find("> a").focus()):s=0;else if("both"==this.options.keyMoveDirection){var o=i.get("hasSubItems"),n=(i.get("hasParent"),i.get("isExpanded"));if(e.keyCode==Common.UI.Keys.LEFT)o&&n&&this.collapseRecord(i);else if(e.keyCode==Common.UI.Keys.RIGHT)o&&!n&&this.expandRecord(i);else if(e.keyCode==Common.UI.Keys.DOWN){for(var a=s+1;a<this.store.length;a++)if(this.store.at(a).get("isVisible")){s=a;break}}else if(e.keyCode==Common.UI.Keys.UP)for(a=s-1;0<=a;a--)if(this.store.at(a).get("isVisible")){s=a;break}}else s=e.keyCode==Common.UI.Keys.UP||e.keyCode==Common.UI.Keys.LEFT?Math.max(0,s-1):Math.min(this.store.length-1,s+1);(i=void 0!==s&&0<=s?this.store.at(s):i)&&(this._fromKeyDown=!0,this.selectRecord(i),this._fromKeyDown=!1,this.scrollToRecord(i))}}else this.trigger("item:keydown",this,i,t)},focus:function(){this.cmpEl&&this.cmpEl.find(".treeview").focus()},updateTip:function(t){var e=t.model,i=e.get("name"),s=this,o=(i.length>37-2*e.get("level")?e.set("tip",i):e.set("tip",""),t.$el||$(t.el)),i=o.data("bs.tooltip");i&&(void 0===i.dontShow&&(i.dontShow=!0),o.removeData("bs.tooltip"),i.tip().remove()),e.get("tip")&&(o.attr("data-toggle","tooltip"),o.tooltip({title:e.get("tip"),placement:"cursor",zIndex:this.tipZIndex}),this.delayRenderTips?o.one("mouseenter",function(){o.attr("data-toggle","tooltip"),o.tooltip({title:e.get("tip"),placement:"cursor",zIndex:s.tipZIndex}),o.mouseenter()}):(o.attr("data-toggle","tooltip"),o.tooltip({title:e.get("tip"),placement:"cursor",zIndex:s.tipZIndex})))}})}),void 0===Common&&(Common={}),define("spreadsheeteditor/main/app/view/HyperlinkSettingsDialog",["common/main/lib/util/utils","common/main/lib/component/ComboBox","common/main/lib/component/InputField","common/main/lib/component/Window","common/main/lib/component/TreeView"],function(){"use strict";SSE.Views.HyperlinkSettingsDialog=Common.UI.Window.extend(_.extend({options:{width:350,style:"min-width: 230px;",cls:"modal-dlg",id:"window-hyperlink",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:this.textTitle},t||{}),this.template=['<div class="box" style="height: 313px;">','<div class="input-row margin-bottom-big">','<button type="button" class="btn btn-text-default auto" id="id-dlg-hyperlink-external">',this.textExternalLink,"</button>",'<button type="button" class="btn btn-text-default auto" id="id-dlg-hyperlink-internal">',this.textInternalLink,"</button>","</div>",'<div class="input-row">',"<label>"+this.strDisplay+"</label>","</div>",'<div id="id-dlg-hyperlink-display" class="input-row margin-bottom"></div>','<div id="id-external-link">','<div class="input-row">',"<label>"+this.strLinkTo+"</label>","</div>",'<div id="id-dlg-hyperlink-url" class="input-row margin-bottom"></div>',"</div>",'<div id="id-internal-link" class="hidden">','<div class="input-row">',"<label>"+this.strLinkTo+"</label>",'<div class="get-link float-right">','<label class="link dropdown-toggle float-right" data-toggle="dropdown" id="id-dlg-hyperlink-get-link">'+this.textGetLink+"</label>",'<div id="id-clip-copy-box" class="dropdown-menu">','<div id="id-dlg-clip-copy"></div>','<button id="id-dlg-copy-btn" class="btn btn-text-default margin-left-5">'+this.textCopy+"</button>","</div>","</div>","</div>",'<div id="id-dlg-hyperlink-list"></div>','<div class="input-row">',"<label>"+this.strRange+"</label>","</div>",'<div id="id-dlg-hyperlink-range" class="input-row margin-bottom"></div>',"</div>",'<div class="input-row">',"<label>"+this.textTipText+"</label>","</div>",'<div id="id-dlg-hyperlink-tip" class="input-row margin-bottom"></div>',"</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),this.api=this.options.api,this.appOptions=t.appOptions,this.dataRangeValid="",this.urlType=AscCommon.c_oAscUrlType.Invalid,Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var e,t,i=this.getChild(),s=this;s.btnExternal=new Common.UI.Button({el:$("#id-dlg-hyperlink-external"),enableToggle:!0,toggleGroup:"hyperlink-type",allowDepress:!1,pressed:!0}),s.btnExternal.on("click",_.bind(s.onLinkTypeClick,s,Asc.c_oAscHyperlinkType.WebLink)),s.btnInternal=new Common.UI.Button({el:$("#id-dlg-hyperlink-internal"),enableToggle:!0,toggleGroup:"hyperlink-type",allowDepress:!1}),s.btnInternal.on("click",_.bind(s.onLinkTypeClick,s,Asc.c_oAscHyperlinkType.RangeLink)),s.inputUrl=new Common.UI.InputField({el:$("#id-dlg-hyperlink-url"),allowBlank:!1,blankError:s.txtEmpty,validateOnBlur:!1,style:"width: 100%;",validation:function(t){t=$.trim(t);return 2083<s.api.asc_getFullHyperlinkLength(t)?s.txtSizeLimit:(s.urlType=s.api.asc_getUrlType(t),s.urlType!==AscCommon.c_oAscUrlType.Invalid||s.txtNotUrl)}}),s.inputUrl._input.on("input",function(t){s.isInputFirstChange_url&&s.inputUrl.showError(),s.isInputFirstChange_url=!1;t=$(t.target).val();s.isAutoUpdate&&s.inputDisplay.setValue(t),s.btnOk.setDisabled(""==$.trim(t))}),s.inputRange=new Common.UI.InputFieldBtn({el:$("#id-dlg-hyperlink-range"),allowBlank:!1,blankError:s.txtEmpty,style:"width: 100%;",btnHint:s.textSelectData,validateOnChange:!0,validateOnBlur:!1,value:Common.Utils.InternalSettings.get("sse-settings-r1c1")?"R1C1":"A1",validation:function(t){return!!s.inputRange.isDisabled()||(s.api.asc_checkDataRange(Asc.c_oAscSelectionDialogType.Chart,t,!1)==Asc.c_oAscError.ID.No||s.textInvalidRange)}}),s.inputRange._input.on("input",function(t){s.isInputFirstChange_range&&s.inputRange.showError(),s.isInputFirstChange_range=!1;t=$(t.target).val();s.isAutoUpdate&&s.inputDisplay.setValue(s.internalList.getSelectedRec().get("name")+(""!==t?"!"+t:"")),s.btnOk.setDisabled(""==$.trim(t))}),s.inputRange.on("button:click",_.bind(s.onSelectData,s)),s.inputDisplay=new Common.UI.InputField({el:$("#id-dlg-hyperlink-display"),allowBlank:!0,validateOnBlur:!1,style:"width: 100%;"}),s.inputDisplay._input.on("input",function(t){s.isAutoUpdate=""==$(t.target).val()}),s.inputTip=new Common.UI.InputField({el:$("#id-dlg-hyperlink-tip"),style:"width: 100%;",maxLength:Asc.c_oAscMaxTooltipLength}),s.internalList=new Common.UI.TreeView({el:$("#id-dlg-hyperlink-list"),store:new Common.UI.TreeViewStore,tabindex:1,enableKeyEvents:!0}),s.internalList.on("item:select",_.bind(this.onSelectItem,this)),s.appOptions&&s.appOptions.canMakeActionLink&&(e=new Common.UI.InputField({el:$("#id-dlg-clip-copy"),editable:!1,style:"width: 176px;"}),(t=i.find("#id-clip-copy-box")).on("click",_.bind(function(){return!1},this)),t.parent().on({"shown.bs.dropdown":function(){_.delay(function(){e._input.select().focus()},100)}}),t.find("button").on("click",function(){e._input.select(),document.execCommand("copy")}),Common.Gateway.on("setactionlink",function(t){e.setValue(t)})),s.linkGetLink=$("#id-dlg-hyperlink-get-link"),s.linkGetLink.toggleClass("hidden",!(s.appOptions&&s.appOptions.canMakeActionLink)),s.btnOk=new Common.UI.Button({el:i.find(".primary"),disabled:!0}),i.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),s.internalList.on("entervalue",_.bind(s.onPrimary,s)),i.on("click","#id-dlg-hyperlink-get-link",_.bind(s.getLink,s)),s.externalPanel=i.find("#id-external-link"),s.internalPanel=i.find("#id-internal-link")},getFocusedComponents:function(){return[this.inputUrl,this.internalList,this.inputRange,this.inputDisplay,this.inputTip]},show:function(){Common.UI.Window.prototype.show.apply(this,arguments),Common.Utils.InternalSettings.set("sse-dialog-link-visible",!0)},close:function(){Common.Utils.InternalSettings.set("sse-dialog-link-visible",!1),Common.UI.Window.prototype.close.apply(this,arguments)},setSettings:function(t){var e,i;t&&(((e=(this.settings=t).props?t.props.asc_getType():Common.Utils.InternalSettings.get("sse-settings-link-type")&&t.allowInternal?Asc.c_oAscHyperlinkType.RangeLink:Asc.c_oAscHyperlinkType.WebLink)==Asc.c_oAscHyperlinkType.WebLink?this.btnExternal:this.btnInternal).toggle(!0),this.ShowHideElem(e,t.props),this.btnInternal.setDisabled(!t.allowInternal&&e==Asc.c_oAscHyperlinkType.WebLink),this.btnExternal.setDisabled(!t.allowInternal&&e==Asc.c_oAscHyperlinkType.RangeLink),i="",t.props?(e==Asc.c_oAscHyperlinkType.RangeLink?i=t.props.asc_getSheet()?(this.inputRange.setValue(t.props.asc_getRange()),this.dataRangeValid=this.inputRange.getValue(),t.props.asc_getSheet()+"!"+t.props.asc_getRange()):(this.inputRange.setDisabled(!0),t.props.asc_getLocation()):(this.inputUrl.setValue(t.props.asc_getHyperlinkUrl().replace(new RegExp(" ","g"),"%20")),this.btnOk.setDisabled(""==$.trim(this.inputUrl.getValue()))),this.inputDisplay.setValue(t.isLock?this.textDefault:t.props.asc_getText()),this.inputTip.setValue(t.props.asc_getTooltip())):this.inputDisplay.setValue(t.isLock?this.textDefault:t.text),this.inputDisplay.setDisabled(t.isLock),t.isLock||(this.isAutoUpdate=""==this.inputDisplay.getValue()||e==Asc.c_oAscHyperlinkType.WebLink&&this.inputUrl.getValue()==this.inputDisplay.getValue()||e==Asc.c_oAscHyperlinkType.RangeLink&&i==this.inputDisplay.getValue()))},getSettings:function(){var t,e=new Asc.asc_CHyperlink,i="",s=this.btnInternal.isActive()?Asc.c_oAscHyperlinkType.RangeLink:Asc.c_oAscHyperlinkType.WebLink;return e.asc_setType(s),s==Asc.c_oAscHyperlinkType.RangeLink?(t=this.internalList.getSelectedRec())&&0<t.get("level")&&(i=t.get("type")?(e.asc_setSheet(null),e.asc_setLocation(t.get("name")),t.get("name")):(e.asc_setSheet(t.get("name")),e.asc_setRange(this.inputRange.getValue()),t.get("name")+"!"+this.inputRange.getValue())):(t=this.inputUrl.getValue().replace(/^\s+|\s+$/g,""),t=(t=this.urlType===AscCommon.c_oAscUrlType.Unsafe||/(((^https?)|(^ftp)):\/\/)|(^mailto:)/i.test(t)?t:(this.urlType==AscCommon.c_oAscUrlType.Email?"mailto:":"http://")+t).replace(new RegExp("%20","g")," "),e.asc_setHyperlinkUrl(t),i=t),this.inputDisplay.isDisabled()?e.asc_setText(null):((_.isEmpty(this.inputDisplay.getValue())||s==Asc.c_oAscHyperlinkType.WebLink&&this.isAutoUpdate)&&this.inputDisplay.setValue(i),e.asc_setText(this.inputDisplay.getValue())),e.asc_setTooltip(this.inputTip.getValue()),e},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onPrimary:function(t){return this._handleInput("ok"),!1},_handleInput:function(t){if(this.options.handler){if("ok"==t){var e=!this.btnExternal.isActive()||this.inputUrl.checkValidate(),i=!this.btnInternal.isActive()||this.inputRange.checkValidate(),s=this.inputDisplay.checkValidate();if(!0!==e)return this.inputUrl.focus(),void(this.isInputFirstChange_url=!0);if(!0!==i)return this.inputRange.focus(),void(this.isInputFirstChange_range=!0);if(!0!==s)return void this.inputDisplay.focus();this.settings.props||Common.Utils.InternalSettings.set("sse-settings-link-type",this.btnInternal.isActive())}this.options.handler.call(this,this,t)}this.close()},ShowHideElem:function(t,e){this.externalPanel.toggleClass("hidden",t!==Asc.c_oAscHyperlinkType.WebLink),this.internalPanel.toggleClass("hidden",t!==Asc.c_oAscHyperlinkType.RangeLink);var i=this.internalList.store;if(t==Asc.c_oAscHyperlinkType.RangeLink){if(i.length<1&&this.settings){var s=this.settings.sheets,o=s.length,n=[];n.push(new Common.UI.TreeViewModel({name:this.textSheets,level:0,index:0,hasParent:!1,isEmptyItem:!1,isNotHeader:!0,isExpanded:!1,hasSubItems:!0}));for(var a=0;a<o;a++)s[a].hidden||n.push(new Common.UI.TreeViewModel({name:s[a].name,level:1,index:a+1,type:0,isVisible:!1,hasParent:!0}));n.push(new Common.UI.TreeViewModel({name:this.textNames,level:0,index:n.length,hasParent:!1,isEmptyItem:!1,isNotHeader:!1,isExpanded:!1,hasSubItems:!1}));for(var t=n[n.length-1],l=this.settings.ranges,r=0,o=l.length,a=0;a<o;a++){var c=l[a],d=c.asc_getScope();c.asc_getIsHidden()||(r<1&&n[n.length-1].set("hasSubItems",!0),n.push(new Common.UI.TreeViewModel({name:(c.asc_getIsXlnm()&&s[d]?s[d].name+"!":"")+c.asc_getName(),level:1,index:n.length,type:1,isVisible:!1,hasParent:!0})),r=1)}i.reset(n);e=e?e.asc_getSheet()||e.asc_getLocation():this.api.asc_getWorksheetName(this.settings.currentSheet);(h=i.findWhere({name:e}))&&(this.internalList.expandRecord(h.get("type")?t:i.at(0)),this.internalList.scrollToRecord(this.internalList.selectRecord(h)))}var h=this.internalList.getSelectedRec(),p=(this.btnOk.setDisabled(!h||0==h.get("level")||0==h.get("type")&&""==$.trim(this.inputRange.getValue())),this);_.delay(function(){(p.inputRange.isDisabled()?p.internalList:p.inputRange).focus()},50)}else{this.btnOk.setDisabled(""==$.trim(this.inputUrl.getValue()));p=this;_.delay(function(){p.inputUrl.focus()},50)}},onLinkTypeClick:function(t,e,i){var s;this.ShowHideElem(t),this.isAutoUpdate&&(t==Asc.c_oAscHyperlinkType.RangeLink?(s=(t=this.internalList.getSelectedRec())&&t.get("level")?t.get("name"):"",t&&1==t.get("type")?this.inputDisplay.setValue(s):(t=this.inputRange.getValue(),this.inputDisplay.setValue(s+(""!==s&&""!==t?"!":"")+t))):this.inputDisplay.setValue(this.inputUrl.getValue()))},onSelectItem:function(t,e,i,s){var o,n;this.btnOk.setDisabled(0==i.get("level")||0==i.get("type")&&""==$.trim(this.inputRange.getValue())),this.inputRange.setDisabled(1==i.get("type")||0==i.get("level")),this.isAutoUpdate&&(o=i.get("level")?i.get("name"):"",1==i.get("type")?this.inputDisplay.setValue(o):(n=this.inputRange.getValue(),this.inputDisplay.setValue(o+(""!==o&&""!==n?"!":"")+n))),this.linkGetLink.toggleClass("disabled",0==i.get("level"))},getLink:function(t){var e;t.cmpEl&&t.cmpEl.parent().hasClass("open")||(t=this.internalList.getSelectedRec())&&t.get("level")&&(e=t.get("name"),1==t.get("type")?this.inputDisplay.setValue(e):(t=this.inputRange.getValue(),e=(e=this.api.asc_getEscapeSheetName(e))+(""!==e&&""!==t?"!":"")+t),e&&Common.Gateway.requestMakeActionLink({action:{type:"internallink",data:e}}))},onSelectData:function(){var t,e,i=this;i.api&&(t=new SSE.Views.CellRangeDialog({handler:function(t,e){"ok"==e&&(i.dataRangeValid=t.getSettings(),0<=(e=i.dataRangeValid.indexOf("!"))&&(i.dataRangeValid=i.dataRangeValid.substring(e+1,i.dataRangeValid.length)),(t=i.internalList.store.findWhere({name:i.api.asc_getWorksheetName(i.api.asc_getActiveWorksheetIndex())}))&&(i.internalList.expandRecord(i.internalList.store.at(0)),i.internalList.scrollToRecord(i.internalList.selectRecord(t))),i.inputRange.setValue(i.dataRangeValid),i.inputRange.checkValidate(),i.isAutoUpdate&&i.inputDisplay.setValue(i.internalList.getSelectedRec().get("name")+(""!==i.dataRangeValid?"!"+i.dataRangeValid:"")),i.btnOk.setDisabled(""==$.trim(i.dataRangeValid)))}}).on("close",function(){i.show(),_.delay(function(){i.inputRange.focus()},1),_.delay(function(){i.api.asc_showWorksheet(i.settings.currentSheet)},1)}),i.api.asc_showWorksheet(i.internalList.getSelectedRec().get("index")-1),e=i.$window.offset(),i.hide(),t.show(e.left+160,e.top+125),t.setSettings({api:i.api,range:_.isEmpty(i.inputRange.getValue())||1!=i.inputRange.checkValidate()?i.dataRangeValid:i.inputRange.getValue(),type:Asc.c_oAscSelectionDialogType.Chart}))}},SSE.Views.HyperlinkSettingsDialog||{}))}),define("text!spreadsheeteditor/main/app/template/ParagraphSettingsAdvanced.template",[],function(){return'<div id="id-adv-paragraph-indents" class="settings-panel active">\n    <div class="inner-content">\n        <div>\n            <div class="padding-large" style="display: inline-block;">\n                <label class="input-label"><%= scope.textAlign %></label>\n                <div id="paragraphadv-spin-text-alignment"></div>\n            </div>\n        </div>\n        <div class="padding-very-small"><label class="header"><%= scope.strIndent %></label></div>\n        <div>\n            <div class="padding-large margin-right-3" style="display: inline-block;">\n                <label class="input-label"><%= scope.strIndentsLeftText %></label>\n                <div id="paragraphadv-spin-indent-left"></div>\n            </div>\x3c!--\n         --\x3e<div class="padding-large margin-right-3" style="display: inline-block;">\n                <label class="input-label"><%= scope.strIndentsRightText %></label>\n                <div id="paragraphadv-spin-indent-right"></div>\n            </div>\x3c!--\n         --\x3e<div class="padding-large" style="display: inline-block;vertical-align: top">\n                <div>\n                    <label class="input-label"><%= scope.strIndentsSpecial %></label>\n                </div>\n                <div>\n                    <div id="paragraphadv-spin-special" class="margin-right-3" style="display: inline-block;"></div>\x3c!--\n                 --\x3e<div id="paragraphadv-spin-special-by" style="display: inline-block;"></div>\n                </div>\n            </div>\n        </div>\n        <div class="padding-very-small"><label class="header"><%= scope.strSpacing %></label></div>\n        <div>\n            <div class="margin-right-3" style="display: inline-block;">\n                <label class="input-label"><%= scope.strIndentsSpacingBefore %></label>\n                <div id="paragraphadv-spin-spacing-before"></div>\n            </div>\x3c!--\n         --\x3e<div class="margin-right-3" style="display: inline-block;">\n                <label class="input-label"><%= scope.strIndentsSpacingAfter %></label>\n                <div id="paragraphadv-spin-spacing-after"></div>\n            </div>\x3c!--\n         --\x3e<div style="display: inline-block;vertical-align: top">\n                <div>\n                    <label class="input-label"><%= scope.strIndentsLineSpacing %></label>\n                </div>\n                <div>\n                    <div id="paragraphadv-spin-line-rule" class="margin-right-3" style="display: inline-block;"></div>\x3c!--\n                 --\x3e<div id="paragraphadv-spin-line-height" style="display: inline-block;"></div>\n                </div>\n            </div>\n        </div>\n        <div class="padding-large" style="padding-top: 16px; display: none;">\n            <div style="border: 1px solid #cbcbcb; width: 350px;">\n                <div id="paragraphadv-indent-preview" style="height: 80px; position: relative;"></div>\n            </div>\n        </div>\n    </div>\n</div>\n<div id="id-adv-paragraph-font" class="settings-panel">\n    <div class="inner-content" style="width: 100%;">\n        <div class="padding-very-small">\n            <label class="header"><%= scope.textEffects %></label>\n        </div>\n        <table cols="2">\n            <tr>\n                <td class="padding-small">\n                    <div id="paragraphadv-checkbox-strike"></div>\n                </td>\n                <td class="padding-small padding-left-40">\n                    <div id="paragraphadv-checkbox-subscript"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="paragraphadv-checkbox-double-strike"></div>\n                </td>\n                <td class="padding-small padding-left-40">\n                    <div id="paragraphadv-checkbox-small-caps"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-large">\n                    <div id="paragraphadv-checkbox-superscript"></div>\n                </td>\n                <td class="padding-large padding-left-40">\n                    <div id="paragraphadv-checkbox-all-caps"></div>\n                </td>\n            </tr>\n        </table>\n        <div class="padding-very-small">\n            <label class="header"><%= scope.textCharacterSpacing %></label>\n        </div>\n        <div class="padding-large">\n            <div style="display: inline-block;">\n                <div id="paragraphadv-spin-spacing"></div>\n            </div>\n        </div>\n        <div class="doc-content-color" style="border: 1px solid #cbcbcb;">\n            <div id="paragraphadv-font-img" style="width: 300px; height: 80px; position: relative; margin: 0 auto;"></div>\n        </div>\n    </div>\n</div>\n<div id="id-adv-paragraph-tabs" class="settings-panel">\n    <div class="inner-content">\n        <div class="padding-large">\n            <label class="input-label"><%= scope.textDefault %></label>\n            <div id="paraadv-spin-default-tab"></div>\n\n        </div>\n        <div>\n            <div class="padding-large margin-right-9" style="display: inline-block;">\n                <label class="input-label"><%= scope.textTabPosition %></label>\n                <div id="paraadv-spin-tab"></div>\n            </div>\n            <div class="padding-large margin-right-9" style=" display: inline-block;">\n                <label class="input-label"><%= scope.textAlign %></label>\n                <div id="paraadv-cmb-align"></div>\n            </div>\n        </div>\n        <div>\n            <div colspan=3 class="padding-large">\n                <div id="paraadv-list-tabs" style="width:348px; height: 116px;"></div>\n            </div>\n        </div>\n        <div>\n            <button type="button" class="btn btn-text-default margin-right-9" id="paraadv-button-add-tab" style="width:108px; display: inline-block;"><%= scope.textSet %></button>\n            <button type="button" class="btn btn-text-default margin-right-9" id="paraadv-button-remove-tab" style="width:108px; display: inline-block;"><%= scope.textRemove %></button>\n            <button type="button" class="btn btn-text-default" id="paraadv-button-remove-all" style="width:108px;display: inline-block;"><%= scope.textRemoveAll %></button>\n        </div>\n    </div>\n</div>'}),define("common/main/lib/view/AdvancedSettingsWindow",["common/main/lib/component/Window"],function(){"use strict";Common.Views.AdvancedSettingsWindow=Common.UI.Window.extend(_.extend({initialize:function(t){var e={};_.extend(e,{height:"auto",header:!0,cls:"advanced-settings-dlg",toggleGroup:"advanced-settings-group",contentTemplate:"",contentStyle:"",items:[],buttons:["ok","cancel"],separator:!0},t),this.template=t.template||['<div class="box">',"<% if (items.length>0) { %>",'<div class="menu-panel">',"<% _.each(items, function(item) { %>",'<div id="slot-category-<%= item.panelId %>"></div>',"<% }); %>","</div>",'<div class="separator"></div>',"<% } %>",'<div class="content-panel" style="<%= contentStyle %>">'+e.contentTemplate+"</div>","</div>","<% if (separator) { %>",'<div class="separator horizontal"></div>',"<% } %>"].join(""),e.tpl=_.template(this.template)(e),this.handler=e.handler,this.toggleGroup=e.toggleGroup,this.contentWidth=e.contentWidth,this.storageName=e.storageName,Common.UI.Window.prototype.initialize.call(this,e)},render:function(){Common.UI.Window.prototype.render.call(this);function t(){o.width((0<n.length?n.width():0)+i.outerWidth()+2)}var e,s=this,o=this.getChild(),i=(o.find(".dlg-btn").on("click",_.bind(this.onDlgBtnClick,this)),this.on("animate:after",_.bind(this.onAnimateAfter,this)),this.btnsCategory=[],this.options.items.forEach(function(t,e){var i=new Common.UI.Button({parentEl:o.find("#slot-category-"+t.panelId),cls:"btn-category "+(t.categoryCls||""),caption:t.panelCaption,iconCls:t.categoryIcon||"",enableToggle:!0,toggleGroup:s.toggleGroup,allowDepress:!1,contentTarget:t.panelId});i.cmpEl.attr("content-target",t.panelId),i.on("click",_.bind(s.onCategoryClick,s,i,e)),s.btnsCategory.push(i)}),o.find(".content-panel")),n=o.find(".menu-panel");i.width(this.contentWidth),o.width((0<n.length?n.width():0)+i.outerWidth()+2),this.options.contentHeight?o.find(".body > .box").css("height",this.options.contentHeight):"number"==typeof this.options.height&&(e=o.find(".body"),e=parseInt(o.find(".header").css("height"))+parseInt(o.find(".footer").css("height"))+parseInt(e.css("padding-top"))+parseInt(e.css("padding-bottom"))+parseInt(o.css("border-bottom-width"))+parseInt(o.css("border-top-width")),o.find(".body > .box").css("height",this.options.height-e)),this.content_panels=o.find(".settings-panel"),0<this.btnsCategory.length&&this.btnsCategory[0].toggle(!0,!0);$(window).on("resize",t),this.on("close",function(){$(window).off("resize",t)})},setHeight:function(t){Common.UI.Window.prototype.setHeight.call(this,t);var t=this.getChild(),e=t.find(".body"),i=parseInt(t.find(".footer").css("height"))+parseInt(e.css("padding-top"))+parseInt(e.css("padding-bottom"));t.find(".body > .box").css("height",parseInt(e.css("height"))-i)},setInnerHeight:function(t){var e=this.getChild(),i=e.find(".body"),i=parseInt(e.find(".header").css("height"))+parseInt(e.find(".footer").css("height"))+parseInt(i.css("padding-top"))+parseInt(i.css("padding-bottom"))+parseInt(e.css("border-bottom-width"))+parseInt(e.css("border-top-width"));Common.UI.Window.prototype.setHeight.call(this,t+i),e.find(".body > .box").css("height",t)},onDlgBtnClick:function(t){t=t.currentTarget.attributes.result.value;this.handler&&this.handler.call(this,t,"ok"==t?this.getSettings():void 0)||this.close()},onCategoryClick:function(t,e){this.content_panels.filter(".active").removeClass("active"),$("#"+t.options.contentTarget).addClass("active")},getSettings:function(){},onPrimary:function(){return this.handler&&this.handler.call(this,"ok",this.getSettings())||this.close(),!1},setActiveCategory:function(t){if(!(this.btnsCategory.length<1)){t=0<=t&&t<this.btnsCategory.length?t:0;var e=this.btnsCategory[t];if(!e.isVisible()||e.isDisabled())for(var i=0;i<this.btnsCategory.length;i++){var s=this.btnsCategory[i];if(s.isVisible()&&!s.isDisabled()){e=s,t=i;break}}e.toggle(!0),this.onCategoryClick(e,t)}},getActiveCategory:function(){var i=-1;return this.btnsCategory.forEach(function(t,e){t.pressed&&(i=e)}),i},close:function(t){this.storageName&&Common.localStorage.setItem(this.storageName,this.getActiveCategory()),Common.UI.Window.prototype.close.call(this,t)},onAnimateAfter:function(){}},Common.Views.AdvancedSettingsWindow||{}))}),void 0===Common&&(Common={}),define("common/main/lib/component/RadioBox",["common/main/lib/component/BaseView","underscore"],function(t,e){"use strict";Common.UI.RadioBox=Common.UI.BaseView.extend({options:{labelText:""},disabled:!1,rendered:!1,template:e.template('<div class="radiobox" data-hint="<%= dataHint %>" data-hint-direction="<%= dataHintDirection %>" data-hint-offset="<%= dataHintOffset %>"><input type="radio" name="<%= name %>" id="<%= id %>" class="button__radiobox"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><circle class="rb-circle" cx="8" cy="8" r="6.5" /><circle class="rb-check-mark" cx="8" cy="8" r="4" /></svg><span></span></div>'),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t),this.dataHint=t.dataHint,this.dataHintDirection=t.dataHintDirection,this.dataHintOffset=t.dataHintOffset;this.name=this.options.name||Common.UI.getId(),this.render(),this.options.disabled&&this.setDisabled(this.options.disabled),void 0!==this.options.checked&&this.setValue(this.options.checked,!0),this.setCaption(this.options.labelText)},render:function(){var t=this.$el||$(this.el);return t.html(this.template({labelText:this.options.labelText,name:this.name,id:Common.UI.getId("rdb-"),dataHint:this.dataHint,dataHintDirection:this.dataHintDirection,dataHintOffset:this.dataHintOffset})),this.$radio=t.find("input[type=radio]"),this.$label=t.find("div.radiobox"),this.$span=this.$label.find("span"),this.$label.on({keydown:this.onKeyDown.bind(this),click:function(t){this.disabled||this.setValue(!0)}.bind(this)}),this.rendered=!0,this},setDisabled:function(t){this.rendered&&((t=!!t)!==this.disabled&&(this.$label.toggleClass("disabled",t),this.$radio.toggleClass("disabled",t),t?this.$radio.attr({disabled:t}):this.$radio.removeAttr("disabled"),void 0!==this.tabindex&&(t&&(this.tabindex=this.$label.attr("tabindex")),this.$label.attr("tabindex",t?"-1":this.tabindex))),this.disabled=t)},isDisabled:function(){return this.disabled},onItemCheck:function(t){this.disabled||this.setValue(!0)},setRawValue:function(t){(t=!0===t||"true"===t||"1"===t||1===t)&&$("input[type=radio][name="+this.name+"]").removeClass("checked"),this.$radio.toggleClass("checked",t),this.$radio.prop("checked",t)},setValue:function(t,e){var i;this.rendered?(i=this.$radio.hasClass("checked"),this.setRawValue(t),!0!==e&&i!==t&&this.trigger("change",this,this.$radio.is(":checked"))):this.options.checked=t},getValue:function(){return this.$radio.is(":checked")},setCaption:function(t){this.$span.text(t),this.$span.css("visibility",t?"visible":"hidden")},onKeyDown:function(t){t.isDefaultPrevented()||t.keyCode===Common.UI.Keys.SPACE&&this.onItemCheck(t)},focus:function(){this.$label&&this.$label.focus()},setTabIndex:function(t){this.rendered&&(this.tabindex=t.toString(),this.disabled||this.$label.attr("tabindex",this.tabindex))}})}),void 0===Common&&(Common={}),define("common/main/lib/component/ListView",["common/main/lib/component/DataView"],function(){"use strict";Common.UI.ListView=Common.UI.DataView.extend({options:{handleSelect:!0,enableKeyEvents:!0,showLast:!0,simpleAddMode:!1,headers:[],initSort:null,keyMoveDirection:"vertical",itemTemplate:_.template('<div id="<%= id %>" class="list-item" style=""><%= value %></div>'),cls:""},template:_.template(['<div class="listview inner <%= cls %>" <% if (options.dataHint) { %> data-hint="<%= options.dataHint %>" <% } if (options.dataHintDirection) { %> data-hint-direction="<%= options.dataHintDirection %>" <% } if (options.dataHintOffset) { %> data-hint-offset="<%= options.dataHintOffset %>" <% } %>>',"</div>"].join("")),initialize:function(t){null!=this.options.initSort&&(this.activeSortType=this.options.initSort.type,this.sortDirection=this.options.initSort.direction),this.headerEl=null,this.headerHeight=0,Common.UI.DataView.prototype.initialize.call(this,t)},render:function(){0<this.options.headers.length&&this.insertHeaders(),Common.UI.DataView.prototype.render.call(this)},insertHeaders:function(){for(var e,t=_.template(['<div class="listview-table-header-wrapper">','<div class="listview-table-header">',"<% _.each(headers, function(header){ %>","<%if (header.sortType) { %>",'<div class="table-header-item" style="<% if (header.width) {%>width: <%=header.width%>px; <%}%> <% if (header.style) { %> <%= header.style %> <%}%>" sort-type="<%=header.sortType%>">','<div class="header-sorted-wrapper">','<span class="header-sorted">',"<label><%= header.name %></label>",'<span class="sort-direction caret <%if (sortDirection == -1) { %>sort-desc <% } if (activeSortType != header.sortType) { %>caret-hidden<%}%>"></span>',"</span>","</div>","</div>","<%} else { %>",'<label class="table-header-item" style="<% if (header.width) {%>width: <%=header.width%>px; <%}%> <% if (header.style) { %> <%= header.style %> <%}%>"><%= header.name %></label>',"<%}%>","<% }); %>","</div>","</div>"].join(""))({headers:this.options.headers,activeSortType:this.options.initSort?this.options.initSort.type:null,sortDirection:this.options.initSort?this.options.initSort.direction:null}),i=(this.$el.before(t),this),s=this.$el.prev().children(),o=0,n=0;o<this.options.headers.length;o++){var a,l,r,c=this.options.headers[o];c.sortType&&(c=c.name.split(" "),a=$(s.find(".table-header-item .header-sorted label")[n]),l=$("<label>A</label>"),i.$el.before(l),1<c.length&&a.height()>Math.ceil(l.height())&&(r=0,c.forEach(function(t){l.text(t),l.width()>r&&(r=l.width())}),r<a.width()&&a.width(r)),l.remove(),n++)}s.find(".table-header-item .header-sorted").on("click",function(t){var e=$(t.currentTarget).parent().parent().attr("sort-type"),t=$(t.currentTarget).find(".caret");i.activeSortType===e?i.sortDirection=-i.sortDirection:(i.activeSortType=e,i.sortDirection=1),s.find(".caret").addClass("caret-hidden"),t.removeClass("caret-hidden"),-1==i.sortDirection?t.addClass("sort-desc"):t.removeClass("sort-desc"),i.trigger("header:click",i.activeSortType,i.sortDirection)}),0!=this.tabindex&&this.handleSelect&&(s.on("click",function(t){i.focus()}),e=function(t){i.focus(),i.$el.find(".inner").removeClass("focused"),$(document).off("mouseup",e)},s.on("mousedown",function(t){i.$el.find(".inner").addClass("focused"),$(document).on("mouseup",e)})),this.headerEl=s,this.calcOffsetFromHeader()},setHeaderName:function(t,e){var i;t<0||t>this.options.headers.length-1||!this.headerEl||((i=$(this.headerEl.find(".table-header-item")[t])).attr("sort-type")&&(i=i.find("label")[0]),this.options.headers[t].name=e,i.text(e))},setHeaderWidth:function(t,e){var i;t<0||t>this.options.headers.length-1||!this.headerEl||((i=$(this.headerEl.find(".table-header-item")[t])).attr("sort-type")&&(i=i.find("label")[0]),this.options.headers[t].width=e,$(i).width(e))},calcOffsetFromHeader:function(){var t;this.headerEl&&(t=Math.floor(this.headerEl.outerHeight()),this.headerHeight=t,this.scrollYStyle=_.extend({},this.scrollYStyle,{"margin-top":t+1+"px"}))},setOffsetFromHeader:function(t){this.headerEl&&(!0===t&&this.calcOffsetFromHeader(),this.$el.find(".listview").css({"padding-top":this.headerHeight+"px"}),this.scroller&&this.scroller.update(t?{scrollYStyle:this.scrollYStyle}:void 0))},onResetItems:function(){this.innerEl=null,Common.UI.DataView.prototype.onResetItems.call(this),this.trigger("items:reset",this),this.headerEl&&this.setOffsetFromHeader()},createNewItem:function(t){return new Common.UI.DataViewItem({template:this.itemTemplate,model:t})},onAddItem:function(t,e,i){var s,o,n=this.createNewItem(t);this.innerEl||(this.innerEl=$(this.el).find(".inner")),n&&this.innerEl&&(this.dataViewItems.length<1&&this.innerEl.find(".empty-text").remove(),this.options.simpleAddMode?(this.innerEl.append(n.render().el),this.dataViewItems.push(n)):(s=_.indexOf(this.store.models,t),o=this.innerEl.find("> .item"),0<s?$(o.get(s-1)).after(n.render().el):0<o.length?$(o[s]).before(n.render().el):this.innerEl.append(n.render().el),this.dataViewItems=this.dataViewItems.slice(0,s).concat(n).concat(this.dataViewItems.slice(s))),this.listenTo(n,"change",this.onChangeItem),this.listenTo(n,"remove",this.onRemoveItem),this.listenTo(n,"click",this.onClickItem),this.listenTo(n,"dblclick",this.onDblClickItem),this.listenTo(n,"select",this.onSelectItem),t.get("tip")&&((o=$(n.el)).attr("data-toggle","tooltip"),o.tooltip({title:t.get("tip"),placement:"cursor",zIndex:this.tipZIndex})),this.isSuspendEvents||this.trigger("item:add",this,n,t))},focus:function(){this.cmpEl&&this.cmpEl.find(".listview").focus()},scrollToRecord:function(t,e){var i,s,o,n,a,l;this._fromKeyDown?t&&(s=(i=$(this.el).find(".inner")).innerHeight(),(n=0<=(n=_.indexOf(this.store.models,t))&&this.dataViewItems.length>n?$(this.dataViewItems[n].el):i.find("#"+t.get("id"))).length<=0||(o=n.position().top,n=n.outerHeight(),a=(a=this.dataViewItems[0].el)?a.offsetTop:0,e||o<a?l=i.scrollTop()+o-a:s<o+n&&(l=i.scrollTop()+o+n-s),void 0!==l&&(this.scroller&&this.allowScrollbar?this.scroller.scrollTop(l,0):i.scrollTop(l)))):Common.UI.DataView.prototype.scrollToRecord.call(this,t,e,this.headerHeight)}})}),define("spreadsheeteditor/main/app/view/ParagraphSettingsAdvanced",["text!spreadsheeteditor/main/app/template/ParagraphSettingsAdvanced.template","common/main/lib/view/AdvancedSettingsWindow","common/main/lib/component/MetricSpinner","common/main/lib/component/CheckBox","common/main/lib/component/RadioBox","common/main/lib/component/ListView"],function(i){"use strict";SSE.Views.ParagraphSettingsAdvanced=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:370,height:394,toggleGroup:"paragraph-adv-settings-group",storageName:"sse-para-settings-adv-category"},initialize:function(t){var e=this,t=(_.extend(this.options,{title:this.textTitle,items:[{panelId:"id-adv-paragraph-indents",panelCaption:this.strParagraphIndents},{panelId:"id-adv-paragraph-font",panelCaption:this.strParagraphFont},{panelId:"id-adv-paragraph-tabs",panelCaption:this.strTabs}],contentTemplate:_.template(i)({scope:this})},t),Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options),this._changedProps=null,this.checkGroup=0,this._noApply=!0,this._tabListChanged=!1,this.spinners=[],this.FirstLine=void 0,this.Spacing=null,this.api=this.options.api,this._originalProps=new Asc.asc_CParagraphProperty(this.options.paragraphProps),this._arrLineRule=[{displayValue:this.textAuto,defaultValue:1,value:c_paragraphLinerule.LINERULE_AUTO,minValue:.5,step:.01,defaultUnit:""},{displayValue:this.textExact,defaultValue:5,value:c_paragraphLinerule.LINERULE_EXACT,minValue:.03,step:.01,defaultUnit:"cm"}],this._originalProps.asc_getSpacing().asc_getLineRule()),t=_.findWhere(this._arrLineRule,{value:t});this.CurLineRuleIdx=this._arrLineRule.indexOf(t),this._arrTextAlignment=[{displayValue:this.textTabLeft,value:c_paragraphTextAlignment.LEFT},{displayValue:this.textTabCenter,value:c_paragraphTextAlignment.CENTERED},{displayValue:this.textTabRight,value:c_paragraphTextAlignment.RIGHT},{displayValue:this.textJustified,value:c_paragraphTextAlignment.JUSTIFIED}],this._arrSpecial=[{displayValue:this.textNoneSpecial,value:c_paragraphSpecial.NONE_SPECIAL,defaultValue:0},{displayValue:this.textFirstLine,value:c_paragraphSpecial.FIRST_LINE,defaultValue:12.7},{displayValue:this.textHanging,value:c_paragraphSpecial.HANGING,defaultValue:12.7}],this._arrTabAlign=[{value:Asc.c_oAscTabType.Left,displayValue:this.textTabLeft},{value:Asc.c_oAscTabType.Center,displayValue:this.textTabCenter},{value:Asc.c_oAscTabType.Right,displayValue:this.textTabRight}],this._arrKeyTabAlign=[],this._arrTabAlign.forEach(function(t){e._arrKeyTabAlign[t.value]=t.displayValue})},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);function t(){e._noApply||(e._tabListChanged=!0)}var e=this;this.cmbTextAlignment=new Common.UI.ComboBox({el:$("#paragraphadv-spin-text-alignment"),cls:"input-group-nr",editable:!1,data:this._arrTextAlignment,style:"width: 173px;",menuStyle:"min-width: 173px;",takeFocusOnClose:!0}),this.cmbTextAlignment.setValue(""),this.numIndentsLeft=new Common.UI.MetricSpinner({el:$("#paragraphadv-spin-indent-left"),step:.1,width:85,defaultUnit:"cm",defaultValue:0,value:"0 cm",maxValue:55.87,minValue:0}),this.numIndentsLeft.on("change",_.bind(function(t,e,i,s){t=t.getNumberValue();this._changedProps&&(null!==this._changedProps.asc_getInd()&&void 0!==this._changedProps.asc_getInd()||this._changedProps.put_Ind(new Asc.asc_CParagraphInd),this._changedProps.asc_getInd().put_Left(Common.Utils.Metric.fnRecalcToMM(t)))},this)),this.spinners.push(this.numIndentsLeft),this.numIndentsRight=new Common.UI.MetricSpinner({el:$("#paragraphadv-spin-indent-right"),step:.1,width:85,defaultUnit:"cm",defaultValue:0,value:"0 cm",maxValue:55.87,minValue:0}),this.numIndentsRight.on("change",_.bind(function(t,e,i,s){this._changedProps&&(null!==this._changedProps.asc_getInd()&&void 0!==this._changedProps.asc_getInd()||this._changedProps.put_Ind(new Asc.asc_CParagraphInd),this._changedProps.asc_getInd().put_Right(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())))},this)),this.spinners.push(this.numIndentsRight),this.cmbSpecial=new Common.UI.ComboBox({el:$("#paragraphadv-spin-special"),cls:"input-group-nr",editable:!1,data:this._arrSpecial,style:"width: 85px;",menuStyle:"min-width: 85px;",takeFocusOnClose:!0}),this.cmbSpecial.setValue(""),this.cmbSpecial.on("selected",_.bind(this.onSpecialSelect,this)),this.numSpecialBy=new Common.UI.MetricSpinner({el:$("#paragraphadv-spin-special-by"),step:.1,width:85,defaultUnit:"cm",defaultValue:0,value:"0 cm",maxValue:55.87,minValue:0}),this.spinners.push(this.numSpecialBy),this.numSpecialBy.on("change",_.bind(this.onFirstLineChange,this)),this.numSpacingBefore=new Common.UI.MetricSpinner({el:$("#paragraphadv-spin-spacing-before"),step:.1,width:85,value:"",defaultUnit:"cm",maxValue:55.88,minValue:0,allowAuto:!0,autoText:this.txtAutoText}),this.numSpacingBefore.on("change",_.bind(function(t,e,i,s){var o;null===this.Spacing&&(o=this._originalProps||new Asc.asc_CParagraphProperty,this.Spacing=o.asc_getSpacing()),this.Spacing.put_Before(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue()))},this)),this.spinners.push(this.numSpacingBefore),this.numSpacingAfter=new Common.UI.MetricSpinner({el:$("#paragraphadv-spin-spacing-after"),step:.1,width:85,value:"",defaultUnit:"cm",maxValue:55.88,minValue:0,allowAuto:!0,autoText:this.txtAutoText}),this.numSpacingAfter.on("change",_.bind(function(t,e,i,s){var o;null===this.Spacing&&(o=this._originalProps||new Asc.asc_CParagraphProperty,this.Spacing=o.asc_getSpacing()),this.Spacing.put_After(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue()))},this)),this.spinners.push(this.numSpacingAfter),this.cmbLineRule=new Common.UI.ComboBox({el:$("#paragraphadv-spin-line-rule"),cls:"input-group-nr",editable:!1,data:this._arrLineRule,style:"width: 85px;",menuStyle:"min-width: 85px;",takeFocusOnClose:!0}),this.cmbLineRule.setValue(""),this.cmbLineRule.on("selected",_.bind(this.onLineRuleSelect,this)),this.numLineHeight=new Common.UI.MetricSpinner({el:$("#paragraphadv-spin-line-height"),step:.01,width:85,value:"",defaultUnit:"",maxValue:132,minValue:.5}),this.spinners.push(this.numLineHeight),this.numLineHeight.on("change",_.bind(this.onNumLineHeightChange,this)),this.chStrike=new Common.UI.CheckBox({el:$("#paragraphadv-checkbox-strike"),labelText:this.strStrike}),this.chStrike.on("change",_.bind(this.onStrikeChange,this)),this.chDoubleStrike=new Common.UI.CheckBox({el:$("#paragraphadv-checkbox-double-strike"),labelText:this.strDoubleStrike}),this.chDoubleStrike.on("change",_.bind(this.onDoubleStrikeChange,this)),this.chSuperscript=new Common.UI.CheckBox({el:$("#paragraphadv-checkbox-superscript"),labelText:this.strSuperscript}),this.chSuperscript.on("change",_.bind(this.onSuperscriptChange,this)),this.chSubscript=new Common.UI.CheckBox({el:$("#paragraphadv-checkbox-subscript"),labelText:this.strSubscript}),this.chSubscript.on("change",_.bind(this.onSubscriptChange,this)),this.chSmallCaps=new Common.UI.CheckBox({el:$("#paragraphadv-checkbox-small-caps"),labelText:this.strSmallCaps}),this.chSmallCaps.on("change",_.bind(this.onSmallCapsChange,this)),this.chAllCaps=new Common.UI.CheckBox({el:$("#paragraphadv-checkbox-all-caps"),labelText:this.strAllCaps}),this.chAllCaps.on("change",_.bind(this.onAllCapsChange,this)),this.numSpacing=new Common.UI.MetricSpinner({el:$("#paragraphadv-spin-spacing"),step:.01,width:100,defaultUnit:"cm",defaultValue:0,value:"0 cm",maxValue:55.87,minValue:-55.87}),this.numSpacing.on("change",_.bind(function(t,e,i,s){var o;this._changedProps&&this._changedProps.asc_putTextSpacing(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())),this.api&&!this._noApply&&((o=this._originalProps||new Asc.asc_CParagraphProperty).asc_putTextSpacing(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())),this.api.asc_setDrawImagePlaceParagraph("paragraphadv-font-img",o))},this)),this.spinners.push(this.numSpacing),this.numTab=new Common.UI.MetricSpinner({el:$("#paraadv-spin-tab"),step:.1,width:108,defaultUnit:"cm",value:"1.25 cm",maxValue:55.87,minValue:0}),this.spinners.push(this.numTab),this.numDefaultTab=new Common.UI.MetricSpinner({el:$("#paraadv-spin-default-tab"),step:.1,width:108,defaultUnit:"cm",value:"1.25 cm",maxValue:55.87,minValue:0}),this.numDefaultTab.on("change",_.bind(function(t,e,i,s){this._changedProps&&this._changedProps.asc_putDefaultTab(parseFloat(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue()).toFixed(1)))},this)),this.spinners.push(this.numDefaultTab),this.tabList=new Common.UI.ListView({el:$("#paraadv-list-tabs"),emptyText:this.noTabs,store:new Common.UI.DataViewStore,template:_.template(['<div class="listview inner" style=""></div>'].join("")),itemTemplate:_.template(['<div id="<%= id %>" class="list-item" style="width: 100%;display:inline-block;">','<div style="width: 117px;display: inline-block;"><%= value %></div>','<div style="display: inline-block;"><%= displayTabAlign %></div>',"</div>"].join("")),tabindex:1}),this.tabList.store.comparator=function(t){return t.get("tabPos")},this.tabList.on("item:select",_.bind(this.onSelectTab,this));this.listenTo(this.tabList.store,"add",t),this.listenTo(this.tabList.store,"remove",t),this.listenTo(this.tabList.store,"reset",t),this.cmbAlign=new Common.UI.ComboBox({el:$("#paraadv-cmb-align"),style:"width: 108px;",menuStyle:"min-width: 108px;",editable:!1,cls:"input-group-nr",data:this._arrTabAlign,takeFocusOnClose:!0}),this.cmbAlign.setValue(Asc.c_oAscTabType.Left),this.btnAddTab=new Common.UI.Button({el:$("#paraadv-button-add-tab")}),this.btnAddTab.on("click",_.bind(this.addTab,this)),this.btnRemoveTab=new Common.UI.Button({el:$("#paraadv-button-remove-tab")}),this.btnRemoveTab.on("click",_.bind(this.removeTab,this)),this.btnRemoveAll=new Common.UI.Button({el:$("#paraadv-button-remove-all")}),this.btnRemoveAll.on("click",_.bind(this.removeAllTabs,this)),this.afterRender()},getFocusedComponents:function(){return[this.cmbTextAlignment,this.numIndentsLeft,this.numIndentsRight,this.cmbSpecial,this.numSpecialBy,this.numSpacingBefore,this.numSpacingAfter,this.cmbLineRule,this.numLineHeight,this.chStrike,this.chSubscript,this.chDoubleStrike,this.chSmallCaps,this.chSuperscript,this.chAllCaps,this.numSpacing,this.numDefaultTab,this.numTab,this.cmbAlign,this.tabList,this.btnAddTab,this.btnRemoveTab,this.btnRemoveAll]},onCategoryClick:function(t,e,i,s){Common.Views.AdvancedSettingsWindow.prototype.onCategoryClick.call(this,t,e);var o=this;setTimeout(function(){switch(e){case 0:o.cmbTextAlignment.focus();break;case 1:o.chStrike.focus(),s&&s instanceof jQuery.Event&&o.api.asc_setDrawImagePlaceParagraph("paragraphadv-font-img",o._originalProps||new Asc.asc_CParagraphProperty);break;case 2:o.numDefaultTab.focus()}},10)},onAnimateAfter:function(){1==this.getActiveCategory()&&this.api.asc_setDrawImagePlaceParagraph("paragraphadv-font-img",this._originalProps||new Asc.asc_CParagraphProperty)},getSettings:function(){this._tabListChanged&&(null!==this._changedProps.asc_getTabs()&&void 0!==this._changedProps.asc_getTabs()||this._changedProps.asc_putTabs(new Asc.asc_CParagraphTabs),this.tabList.store.each(function(t,e){t=new Asc.asc_CParagraphTab(Common.Utils.Metric.fnRecalcToMM(t.get("tabPos")),t.get("tabAlign"));this._changedProps.asc_getTabs().add_Tab(t)},this));var t=this.cmbTextAlignment.getValue();return this._changedProps.asc_putJc(null!=t?t:c_paragraphTextAlignment.LEFT),null!==this.Spacing&&this._changedProps.asc_putSpacing(this.Spacing),{paragraphProps:this._changedProps}},_setDefaults:function(t){if(t){this._originalProps=new Asc.asc_CParagraphProperty(t),this.FirstLine=null!==t.asc_getInd()?t.asc_getInd().asc_getFirstLine():null,this.numIndentsLeft.setValue(null!==t.asc_getInd()&&null!==t.asc_getInd().asc_getLeft()?Common.Utils.Metric.fnRecalcFromMM(t.asc_getInd().asc_getLeft()):"",!0),this.numIndentsRight.setValue(null!==t.asc_getInd()&&null!==t.asc_getInd().asc_getRight()?Common.Utils.Metric.fnRecalcFromMM(t.asc_getInd().asc_getRight()):"",!0),this.cmbTextAlignment.setValue(void 0!==t.asc_getJc()&&null!==t.asc_getJc()?t.asc_getJc():c_paragraphTextAlignment.CENTERED,!0),void 0===this.CurSpecial&&(this.CurSpecial=0===t.asc_getInd().asc_getFirstLine()?c_paragraphSpecial.NONE_SPECIAL:0<t.asc_getInd().asc_getFirstLine()?c_paragraphSpecial.FIRST_LINE:c_paragraphSpecial.HANGING),this.cmbSpecial.setValue(this.CurSpecial),this.numSpecialBy.setValue(null!==this.FirstLine?Math.abs(Common.Utils.Metric.fnRecalcFromMM(this.FirstLine)):"",!0),this.numSpacingBefore.setValue(null!==t.asc_getSpacing()&&null!==t.asc_getSpacing().asc_getBefore()?Common.Utils.Metric.fnRecalcFromMM(t.asc_getSpacing().asc_getBefore()):"",!0),this.numSpacingAfter.setValue(null!==t.asc_getSpacing()&&null!==t.asc_getSpacing().asc_getAfter()?Common.Utils.Metric.fnRecalcFromMM(t.asc_getSpacing().asc_getAfter()):"",!0);var e=t.asc_getSpacing().asc_getLineRule(),e=(this.cmbLineRule.setValue(null!==e?e:""),null!==t.asc_getSpacing()&&null!==t.asc_getSpacing().asc_getLine()?this.numLineHeight.setValue(e==c_paragraphLinerule.LINERULE_AUTO?t.asc_getSpacing().asc_getLine():Common.Utils.Metric.fnRecalcFromMM(t.asc_getSpacing().asc_getLine()),!0):this.numLineHeight.setValue("",!0),this._noApply=!0,this.chStrike.setValue(null!==t.asc_getStrikeout()&&void 0!==t.asc_getStrikeout()?t.asc_getStrikeout():"indeterminate",!0),this.chDoubleStrike.setValue(null!==t.asc_getDStrikeout()&&void 0!==t.asc_getDStrikeout()?t.asc_getDStrikeout():"indeterminate",!0),this.chSubscript.setValue(null!==t.asc_getSubscript()&&void 0!==t.asc_getSubscript()?t.asc_getSubscript():"indeterminate",!0),this.chSuperscript.setValue(null!==t.asc_getSuperscript()&&void 0!==t.asc_getSuperscript()?t.asc_getSuperscript():"indeterminate",!0),this.chSmallCaps.setValue(null!==t.asc_getSmallCaps()&&void 0!==t.asc_getSmallCaps()?t.asc_getSmallCaps():"indeterminate",!0),this.chAllCaps.setValue(null!==t.asc_getAllCaps()&&void 0!==t.asc_getAllCaps()?t.asc_getAllCaps():"indeterminate",!0),this.numSpacing.setValue(null!==t.asc_getTextSpacing()&&void 0!==t.asc_getTextSpacing()?Common.Utils.Metric.fnRecalcFromMM(t.asc_getTextSpacing()):"",!0),this.numDefaultTab.setValue(null!==t.asc_getDefaultTab()&&void 0!==t.asc_getDefaultTab()?Common.Utils.Metric.fnRecalcFromMM(parseFloat(t.asc_getDefaultTab().toFixed(1))):"",!0),this.tabList.store),i=t.asc_getTabs();if(i){for(var s=[],o=i.asc_getCount(),n=0;n<o;n++){var a=i.asc_getTab(n),l=Common.Utils.Metric.fnRecalcFromMM(parseFloat(a.asc_getPos().toFixed(1))),r=new Common.UI.DataViewModel;r.set({tabPos:l,value:parseFloat(l.toFixed(3))+" "+Common.Utils.Metric.getCurrentMetricName(),tabAlign:a.asc_getValue(),displayTabAlign:this._arrKeyTabAlign[a.asc_getValue()]}),s.push(r)}e.reset(s,{silent:!1}),this.tabList.selectByIndex(0)}this._noApply=!1,this._changedProps=new Asc.asc_CParagraphProperty}},updateMetricUnit:function(){if(this.spinners)for(var t=0;t<this.spinners.length;t++){var e=this.spinners[t];e.setDefaultUnit(Common.Utils.Metric.getCurrentMetricName()),"paragraphadv-spin-spacing"==e.el.id||"paragraphadv-spin-position"==e.el.id||"paragraphadv-spin-spacing-before"==e.el.id||"paragraphadv-spin-spacing-after"==e.el.id?e.setStep(Common.Utils.Metric.getCurrentMetric()==Common.Utils.Metric.c_MetricUnits.pt?1:.01):e.setStep(Common.Utils.Metric.getCurrentMetric()==Common.Utils.Metric.c_MetricUnits.pt?1:.1)}var i;this._arrLineRule[1].defaultUnit=Common.Utils.Metric.getCurrentMetricName(),this._arrLineRule[1].minValue=parseFloat(Common.Utils.Metric.fnRecalcFromMM(.3).toFixed(2)),this._arrLineRule[1].step=Common.Utils.Metric.getCurrentMetric()==Common.Utils.Metric.c_MetricUnits.pt?1:.01,null!==this.CurLineRuleIdx&&(i=this._arrLineRule[-1!==this.CurLineRuleIdx?this.CurLineRuleIdx:0],this.numLineHeight.setDefaultUnit(i.defaultUnit),this.numLineHeight.setStep(i.step))},afterRender:function(){var t;this.updateMetricUnit(),this._setDefaults(this._originalProps),this.storageName&&(t=Common.localStorage.getItem(this.storageName),this.setActiveCategory(null!==t?parseInt(t):0))},onStrikeChange:function(t,e,i,s){var o;this._changedProps&&1!=this.checkGroup&&this._changedProps.asc_putStrikeout("checked"==t.getValue()),this.checkGroup=0,"checked"==t.getValue()&&(this.checkGroup=1,this.chDoubleStrike.setValue(0),this._changedProps&&this._changedProps.asc_putDStrikeout(!1),this.checkGroup=0),this.api&&!this._noApply&&((o=this._originalProps||new Asc.asc_CParagraphProperty).asc_putStrikeout("checked"==t.getValue()),o.asc_putDStrikeout("checked"==this.chDoubleStrike.getValue()),this.api.asc_setDrawImagePlaceParagraph("paragraphadv-font-img",o))},onDoubleStrikeChange:function(t,e,i,s){var o;this._changedProps&&1!=this.checkGroup&&this._changedProps.asc_putDStrikeout("checked"==t.getValue()),this.checkGroup=0,"checked"==t.getValue()&&(this.checkGroup=1,this.chStrike.setValue(0),this._changedProps&&this._changedProps.asc_putStrikeout(!1),this.checkGroup=0),this.api&&!this._noApply&&((o=this._originalProps||new Asc.asc_CParagraphProperty).asc_putDStrikeout("checked"==t.getValue()),o.asc_putStrikeout("checked"==this.chStrike.getValue()),this.api.asc_setDrawImagePlaceParagraph("paragraphadv-font-img",o))},onSuperscriptChange:function(t,e,i,s){var o;this._changedProps&&2!=this.checkGroup&&this._changedProps.asc_putSuperscript("checked"==t.getValue()),this.checkGroup=0,"checked"==t.getValue()&&(this.checkGroup=2,this.chSubscript.setValue(0),this._changedProps&&this._changedProps.asc_putSubscript(!1),this.checkGroup=0),this.api&&!this._noApply&&((o=this._originalProps||new Asc.asc_CParagraphProperty).asc_putSuperscript("checked"==t.getValue()),o.asc_putSubscript("checked"==this.chSubscript.getValue()),this.api.asc_setDrawImagePlaceParagraph("paragraphadv-font-img",o))},onSubscriptChange:function(t,e,i,s){var o;this._changedProps&&2!=this.checkGroup&&this._changedProps.asc_putSubscript("checked"==t.getValue()),this.checkGroup=0,"checked"==t.getValue()&&(this.checkGroup=2,this.chSuperscript.setValue(0),this._changedProps&&this._changedProps.asc_putSuperscript(!1),this.checkGroup=0),this.api&&!this._noApply&&((o=this._originalProps||new Asc.asc_CParagraphProperty).asc_putSubscript("checked"==t.getValue()),o.asc_putSuperscript("checked"==this.chSuperscript.getValue()),this.api.asc_setDrawImagePlaceParagraph("paragraphadv-font-img",o))},onSmallCapsChange:function(t,e,i,s){var o;this._changedProps&&3!=this.checkGroup&&this._changedProps.asc_putSmallCaps("checked"==t.getValue()),this.checkGroup=0,"checked"==t.getValue()&&(this.checkGroup=3,this.chAllCaps.setValue(0),this._changedProps&&this._changedProps.asc_putAllCaps(!1),this.checkGroup=0),this.api&&!this._noApply&&((o=this._originalProps||new Asc.asc_CParagraphProperty).asc_putSmallCaps("checked"==t.getValue()),o.asc_putAllCaps("checked"==this.chAllCaps.getValue()),this.api.asc_setDrawImagePlaceParagraph("paragraphadv-font-img",o))},onAllCapsChange:function(t,e,i,s){var o;this._changedProps&&3!=this.checkGroup&&this._changedProps.asc_putAllCaps("checked"==t.getValue()),this.checkGroup=0,"checked"==t.getValue()&&(this.checkGroup=3,this.chSmallCaps.setValue(0),this._changedProps&&this._changedProps.asc_putSmallCaps(!1),this.checkGroup=0),this.api&&!this._noApply&&((o=this._originalProps||new Asc.asc_CParagraphProperty).asc_putAllCaps("checked"==t.getValue()),o.asc_putSmallCaps("checked"==this.chSmallCaps.getValue()),this.api.asc_setDrawImagePlaceParagraph("paragraphadv-font-img",o))},addTab:function(t,e){var i=this.numTab.getNumberValue(),s=this.cmbAlign.getValue(),o=this._arrKeyTabAlign[s],n=this.tabList.store,a=n.find(function(t){return Math.abs(t.get("tabPos")-i)<.001});a?(a.set("tabAlign",s),a.set("displayTabAlign",o),this._tabListChanged=!0):((a=new Common.UI.DataViewModel).set({tabPos:i,value:i+" "+Common.Utils.Metric.getCurrentMetricName(),tabAlign:s,displayTabAlign:o}),n.add(a)),this.tabList.selectRecord(a),this.tabList.scrollToRecord(a)},removeTab:function(t,e){var i,s,o=this.tabList.getSelectedRec();o&&(i=this.tabList.store,s=_.indexOf(i.models,o),i.remove(o),s>i.length-1&&(s=i.length-1),0<i.length&&(this.tabList.selectByIndex(s),this.tabList.scrollToRecord(i.at(s))))},removeAllTabs:function(t,e){this.tabList.store.reset()},onSelectTab:function(t,e,i){if(i){var s={};if(_.isFunction(i.toJSON)){if(!i.get("selected"))return;s=i.toJSON()}else s=i;this.numTab.setValue(s.tabPos),this.cmbAlign.setValue(s.tabAlign)}},onSpecialSelect:function(t,e){var i;this.CurSpecial=e.value,this.CurSpecial===c_paragraphSpecial.NONE_SPECIAL&&this.numSpecialBy.setValue(0,!0),this._changedProps&&(null!==this._changedProps.asc_getInd()&&void 0!==this._changedProps.asc_getInd()||this._changedProps.put_Ind(new Asc.asc_CParagraphInd),0===(i=Common.Utils.Metric.fnRecalcToMM(this.numSpecialBy.getNumberValue()))&&(this.numSpecialBy.setValue(Common.Utils.Metric.fnRecalcFromMM(this._arrSpecial[e.value].defaultValue),!0),i=this._arrSpecial[e.value].defaultValue),this.CurSpecial===c_paragraphSpecial.HANGING&&(i=-i),this._changedProps.asc_getInd().put_FirstLine(i))},onFirstLineChange:function(t,e,i,s){this._changedProps&&(null!==this._changedProps.asc_getInd()&&void 0!==this._changedProps.asc_getInd()||this._changedProps.put_Ind(new Asc.asc_CParagraphInd),t=Common.Utils.Metric.fnRecalcToMM(t.getNumberValue()),this.CurSpecial===c_paragraphSpecial.HANGING?t=-t:this.CurSpecial===c_paragraphSpecial.NONE_SPECIAL&&0<t?(this.CurSpecial=c_paragraphSpecial.FIRST_LINE,this.cmbSpecial.setValue(c_paragraphSpecial.FIRST_LINE)):0===t&&(this.CurSpecial=c_paragraphSpecial.NONE_SPECIAL,this.cmbSpecial.setValue(c_paragraphSpecial.NONE_SPECIAL)),this._changedProps.asc_getInd().put_FirstLine(t))},onLineRuleSelect:function(t,e){null===this.Spacing&&(i=this._originalProps||new Asc.asc_CParagraphProperty,this.Spacing=i.asc_getSpacing()),this.Spacing.put_LineRule(e.value);var i=_.findWhere(this._arrLineRule,{value:e.value}),e=this._arrLineRule.indexOf(i);this.CurLineRuleIdx!==e&&(this.numLineHeight.setDefaultUnit(this._arrLineRule[e].defaultUnit),this.numLineHeight.setMinValue(this._arrLineRule[e].minValue),this.numLineHeight.setStep(this._arrLineRule[e].step),this.Spacing.get_LineRule()===c_paragraphLinerule.LINERULE_AUTO?this.numLineHeight.setValue(this._arrLineRule[e].defaultValue):this.numLineHeight.setValue(Common.Utils.Metric.fnRecalcFromMM(this._arrLineRule[e].defaultValue)),this.CurLineRuleIdx=e)},onNumLineHeightChange:function(t,e,i,s){var o;""!==this.cmbLineRule.getRawValue()&&(null===this.Spacing&&(o=this._originalProps||new Asc.asc_CParagraphProperty,this.Spacing=o.asc_getSpacing()),this.Spacing.put_Line(this.cmbLineRule.getValue()==c_paragraphLinerule.LINERULE_AUTO?t.getNumberValue():Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())))}},SSE.Views.ParagraphSettingsAdvanced||{}))}),define("text!spreadsheeteditor/main/app/template/ImageSettingsAdvanced.template",[],function(){return'<div id="id-adv-image-rotate" class="settings-panel active">\n    <div class="inner-content  padding-large">\n        <div style="width: 100%;">\n            <label class="input-label"><%= scope.textAngle %></label>\n            <div id="image-advanced-spin-angle" class="margin-left-5" style="display: inline-block;"></div>\n        </div>\n    </div>\n    <div class="separator horizontal padding-large"></div>\n    <div class="inner-content  padding-large">\n        <table cols="2">\n            <tr>\n                <td rowspan="2" class="padding-small" style="vertical-align: top;">\n                    <label class="input-label margin-right-15" style="vertical-align: top;"><%= scope.textFlipped %></label>\n                </td>\n                <td class="padding-small">\n                    <div id="image-advanced-checkbox-hor"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="image-advanced-checkbox-vert"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-adv-image-snap" class="settings-panel">\n    <div class="inner-content">\n        <table cols="1">\n            <tr>\n                <td class="padding-small">\n                    <div id="image-advanced-radio-twocell"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="image-advanced-radio-onecell"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="image-advanced-radio-absolute"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-adv-image-alttext" class="settings-panel active">\n    <div class="inner-content">\n        <table cols="1" width="100%">\n            <tr>\n                <td class="padding-large">\n                    <label class="header"><%= scope.textAltTitle %></label>\n                    <div id="image-advanced-alt-title"></div>\n                </td>\n            </tr>\n            <tr>\n                <td>\n                    <label class="header"><%= scope.textAltDescription %></label>\n                    <textarea id="image-advanced-alt-description" class="form-control" style="width: 100%; height: 70px;"></textarea>\n                </td>\n            </tr>\n            <tr>\n                <td>\n                    <label><%= scope.textAltTip %></label>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>'}),define("spreadsheeteditor/main/app/view/ImageSettingsAdvanced",["text!spreadsheeteditor/main/app/template/ImageSettingsAdvanced.template","common/main/lib/view/AdvancedSettingsWindow","common/main/lib/component/InputField","common/main/lib/component/MetricSpinner","common/main/lib/component/CheckBox"],function(e){"use strict";SSE.Views.ImageSettingsAdvanced=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:300,height:342,toggleGroup:"image-adv-settings-group",properties:null,storageName:"sse-image-settings-adv-category"},initialize:function(t){_.extend(this.options,{title:this.textTitle,items:[{panelId:"id-adv-image-rotate",panelCaption:this.textRotation},{panelId:"id-adv-image-snap",panelCaption:this.textSnap},{panelId:"id-adv-image-alttext",panelCaption:this.textAlt}],contentTemplate:_.template(e)({scope:this})},t),Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options),this._originalProps=this.options.imageProps,this._changedProps=null},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var e=this;this.spnAngle=new Common.UI.MetricSpinner({el:$("#image-advanced-spin-angle"),step:1,width:80,defaultUnit:"°",value:"0 °",maxValue:3600,minValue:-3600}),this.chFlipHor=new Common.UI.CheckBox({el:$("#image-advanced-checkbox-hor"),labelText:this.textHorizontally}),this.chFlipVert=new Common.UI.CheckBox({el:$("#image-advanced-checkbox-vert"),labelText:this.textVertically}),this.radioTwoCell=new Common.UI.RadioBox({el:$("#image-advanced-radio-twocell"),name:"asc-radio-snap",labelText:this.textTwoCell,value:AscCommon.c_oAscCellAnchorType.cellanchorTwoCell}),this.radioTwoCell.on("change",_.bind(this.onRadioSnapChange,this)),this.radioOneCell=new Common.UI.RadioBox({el:$("#image-advanced-radio-onecell"),name:"asc-radio-snap",labelText:this.textOneCell,value:AscCommon.c_oAscCellAnchorType.cellanchorOneCell}),this.radioOneCell.on("change",_.bind(this.onRadioSnapChange,this)),this.radioAbsolute=new Common.UI.RadioBox({el:$("#image-advanced-radio-absolute"),name:"asc-radio-snap",labelText:this.textAbsolute,value:AscCommon.c_oAscCellAnchorType.cellanchorAbsolute}),this.radioAbsolute.on("change",_.bind(this.onRadioSnapChange,this)),this.inputAltTitle=new Common.UI.InputField({el:$("#image-advanced-alt-title"),allowBlank:!0,validateOnBlur:!1,style:"width: 100%;"}).on("changed:after",function(){e.isAltTitleChanged=!0}),this.textareaAltDescription=this.$window.find("textarea"),this.textareaAltDescription.keydown(function(t){t.keyCode==Common.UI.Keys.RETURN&&t.stopPropagation(),e.isAltDescChanged=!0}),this.afterRender()},getFocusedComponents:function(){return[this.spnAngle,this.chFlipHor,this.chFlipVert,this.radioTwoCell,this.radioOneCell,this.radioAbsolute,this.inputAltTitle,this.textareaAltDescription]},onCategoryClick:function(t,e){Common.Views.AdvancedSettingsWindow.prototype.onCategoryClick.call(this,t,e);var i=this;setTimeout(function(){switch(e){case 0:i.spnAngle.focus();break;case 1:i.radioTwoCell.focus();break;case 2:i.inputAltTitle.focus()}},10)},onRadioSnapChange:function(t,e,i){e&&this._changedProps&&this._changedProps.asc_putAnchor(t.options.value)},afterRender:function(){var t;this._setDefaults(this._originalProps),this.storageName&&(t=Common.localStorage.getItem(this.storageName),this.setActiveCategory(null!==t?parseInt(t):0))},_setDefaults:function(t){if(t){var e=t.asc_getTitle();switch(this.inputAltTitle.setValue(e||""),e=t.asc_getDescription(),this.textareaAltDescription.val(e||""),e=t.asc_getRot(),this.spnAngle.setValue(null==e||null===e?"":Math.floor(180*e/3.14159265358979+.5),!0),this.chFlipHor.setValue(t.asc_getFlipH()),this.chFlipVert.setValue(t.asc_getFlipV()),t.asc_getAnchor()){case AscCommon.c_oAscCellAnchorType.cellanchorTwoCell:this.radioTwoCell.setValue(!0,!0);break;case AscCommon.c_oAscCellAnchorType.cellanchorOneCell:this.radioOneCell.setValue(!0,!0);break;case AscCommon.c_oAscCellAnchorType.cellanchorAbsolute:this.radioAbsolute.setValue(!0,!0)}e=t.asc_getPluginGuid();this.btnsCategory[0].setVisible(null==e),this._changedProps=new Asc.asc_CImgProperty}},getSettings:function(){return this.isAltTitleChanged&&this._changedProps.asc_putTitle(this.inputAltTitle.getValue()),this.isAltDescChanged&&this._changedProps.asc_putDescription(this.textareaAltDescription.val()),this._changedProps.asc_putRot(3.14159265358979*this.spnAngle.getNumberValue()/180),this._changedProps.asc_putFlipH("checked"==this.chFlipHor.getValue()),this._changedProps.asc_putFlipV("checked"==this.chFlipVert.getValue()),{imageProps:this._changedProps}}},SSE.Views.ImageSettingsAdvanced||{}))}),define("spreadsheeteditor/main/app/view/SetValueDialog",["common/main/lib/component/Window","common/main/lib/component/ComboBox"],function(){"use strict";SSE.Views.SetValueDialog=Common.UI.Window.extend(_.extend({options:{width:214,header:!0,style:"min-width: 214px;",cls:"modal-dlg",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:this.textTitle},t||{}),this.template=['<div class="box">','<div class="input-row">','<div id="id-spin-set-value"></div>',"</div>","</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),this.startvalue=this.options.startvalue,this.maxvalue=this.options.maxvalue,this.defaultUnit=this.options.defaultUnit,this.step=this.options.step,Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){var e;Common.UI.Window.prototype.render.call(this),this.spnSize=new Common.UI.MetricSpinner({el:$("#id-spin-set-value"),width:182,step:this.step,defaultUnit:this.defaultUnit,minValue:0,maxValue:this.maxvalue}),this.spnSize.setValue(null!==this.startvalue?this.startvalue+" "+this.defaultUnit:""),null!==this.startvalue&&(e=this,setTimeout(function(){var t=e.spnSize.$input[0];document.selection?e.spnSize.$input.select():(t.selectionStart=0,t.selectionEnd=e.startvalue.toString().length)},10)),this.getChild().find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.spnSize.on("entervalue",_.bind(this.onPrimary,this)),this.options.rounding&&this.spnSize.on("change",_.bind(this.onChange,this)),this.spnSize.$el.find("input").focus()},_handleInput:function(t){this.options.handler&&this.options.handler.call(this,this,t),this.close()},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onChange:function(){var t=this.spnSize.getNumberValue(),t=((t/=this.step)|t)*this.step;this.spnSize.setValue(t,!0)},getSettings:function(){return this.spnSize.getNumberValue()},onPrimary:function(){return this._handleInput("ok"),!1},txtMinText:"The minimum value for this field is {0}",txtMaxText:"The maximum value for this field is {0}"},SSE.Views.SetValueDialog||{}))}),void 0===Common&&(Common={}),define("common/main/lib/component/ColorPaletteExt",["common/main/lib/component/BaseView"],function(){"use strict";Common.UI.ColorPaletteExt=Common.UI.BaseView.extend({options:{dynamiccolors:10,allowReselect:!0,cls:"",style:""},template:_.template(['<div class="palette-color-ext">',"<% var me = this; %>","<% $(colors).each(function(num, item) { %>","<% if (me.isColor(item)) { %>",'<div class="palette-color-item palette-color color-<%=item%>" style="background:#<%=item%>" hidefocus="on">','<em><span style="background:#<%=item%>;" unselectable="on">&#160;</span></em>',"</div>","<% } else if (me.isTransparent(item)) { %>",'<div class="palette-color-item color-<%=item%>" hidefocus="on">','<em><span unselectable="on">&#160;</span></em>',"</div>","<% } else if (me.isEffect(item)) { %>",'<div effectid="<%=item.effectId%>" effectvalue="<%=item.effectValue%>" class="palette-color-item palette-color-effect color-<%=item.color%>" style="background:#<%=item.color%>" hidefocus="on">','<em><span style="background:#<%=item.color%>;" unselectable="on">&#160;</span></em>',"</div>","<% } %>","<% }); %>","</div>"].join("")),colorRe:/(?:^|\s)color-(.{6})(?:\s|$)/,selectedCls:"selected",initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t),this.id=this.options.id,this.cls=this.options.cls,this.style=this.options.style,this.colors=this.options.colors||[],this.value=this.options.value,this.options.el&&this.render(),this.options.value&&this.select(this.options.value,!0)},render:function(t){return this.rendered?this.cmpEl=this.$el||$(this.el):(this.cmpEl=$(this.template({id:this.id,cls:this.cls,style:this.style,colors:this.colors})),(t?(this.setElement(t,!1),t):this.$el).html(this.cmpEl),this.cmpEl.on("click",this.handleClick.bind(this))),this.rendered=!0,this},isColor:function(t){return"string"==typeof t&&/[0-9A-F]{6}/.test(t)},isTransparent:function(t){return"string"==typeof t&&"transparent"==t},isEffect:function(t){return"object"==typeof t&&void 0!==t.effectId},getColor:function(){return this.value},handleClick:function(t){var e,i=this,t=$(t.target).closest("div.palette-color-item");0!=t.length&&(t.hasClass("color-transparent")?($(i.el).find("div."+i.selectedCls).removeClass(i.selectedCls),t.addClass(i.selectedCls),i.value="transparent",i.trigger("select",i,"transparent")):((!/^[a-fA-F0-9]{6}$/.test(i.value)||_.indexOf(i.colors,i.value)<0)&&(i.value=!1),$(i.el).find("div."+i.selectedCls).removeClass(i.selectedCls),t.addClass(i.selectedCls),e=t[0].className.match(i.colorRe)[1],t.hasClass("palette-color-effect")?(t=parseInt(t.attr("effectid")),e&&(i.value=e.toUpperCase(),i.trigger("select",i,{color:e,effectId:t}))):/#?[a-fA-F0-9]{6}/.test(e)&&(e=/#?([a-fA-F0-9]{6})/.exec(e)[1].toUpperCase(),i.value=e,i.trigger("select",i,e))))},select:function(t,e){var i,s=$(this.el);s.find("div."+this.selectedCls).removeClass(this.selectedCls),t&&("object"==typeof t?void 0!==t.effectId?0<(i=s.find('div[effectid="'+t.effectId+'"]').first()).length?(i.addClass(this.selectedCls),this.value=i[0].className.match(this.colorRe)[1].toUpperCase()):this.value=!1:void 0!==t.effectValue&&(0<(i=s.find('div[effectvalue="'+t.effectValue+'"].color-'+t.color.toUpperCase()).first()).length?(i.addClass(this.selectedCls),this.value=i[0].className.match(this.colorRe)[1].toUpperCase()):this.value=!1):(/#?[a-fA-F0-9]{6}/.test(t)&&(t=/#?([a-fA-F0-9]{6})/.exec(t)[1].toUpperCase(),this.value=t),/^[a-fA-F0-9]{6}|transparent$/.test(t)&&0<=_.indexOf(this.colors,t)?(_.indexOf(this.colors,this.value)<0&&(this.value=!1),t==this.value&&!this.options.allowReselect||(("transparent"==t?s.find("div.color-transparent"):s.find("div.palette-color.color-"+t).first()).addClass(this.selectedCls),this.value=t,!0!==e&&this.fireEvent("select",this,t))):0<(i=0==(i=s.find("#"+t).first()).length?s.find('div[color="'+t+'"]').first():i).length&&(i.addClass(this.selectedCls),this.value=t.toUpperCase())))},updateColors:function(t){void 0!==t&&(this.colors=t,this.cmpEl=$(this.template({id:this.id,cls:this.cls,style:this.style,colors:this.colors})),$(this.el).html(this.cmpEl),this.cmpEl.on("click",_.bind(this.handleClick,this)))},clearSelection:function(t){$(this.el).find("div."+this.selectedCls).removeClass(this.selectedCls),this.value=void 0}})}),void 0===Common&&(Common={}),define("common/main/lib/component/Calendar",["common/main/lib/component/BaseView","common/main/lib/util/utils"],function(){"use strict";Common.UI.Calendar=Common.UI.BaseView.extend(_.extend({template:_.template(['<div id="calendar" class="calendar-box">','<div class="calendar-header">','<div class="top-row">','<div id="prev-arrow"><button type="button"><i class="arrow-prev img-commonctrl"></i></button></div>','<div class="title"></div>','<div id="next-arrow"><button type="button"><i class="arrow-next img-commonctrl" /></button></div>',"</div>",'<div class="bottom-row"></div>',"</div>",'<div class="calendar-content"></div>',"</div>"].join("")),options:{date:void 0,firstday:0},initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);this.monthNames=[this.textJanuary,this.textFebruary,this.textMarch,this.textApril,this.textMay,this.textJune,this.textJuly,this.textAugust,this.textSeptember,this.textOctober,this.textNovember,this.textDecember],this.dayNamesShort=[this.textShortSunday,this.textShortMonday,this.textShortTuesday,this.textShortWednesday,this.textShortThursday,this.textShortFriday,this.textShortSaturday],this.monthShortNames=[this.textShortJanuary,this.textShortFebruary,this.textShortMarch,this.textShortApril,this.textShortMay,this.textShortJune,this.textShortJuly,this.textShortAugust,this.textShortSeptember,this.textShortOctober,this.textShortNovember,this.textShortDecember],this.options.date=t.date,_.isUndefined(t.firstday)||0!==t.firstday&&1!==t.firstday||(this.options.firstday=t.firstday),this.enableKeyEvents=this.options.enableKeyEvents,this._state=void 0,this.render()},render:function(){var e=this;return e.cmpEl=e.$el||$(this.el),e.cmpEl.html(this.template()),e.currentDate=e.options.date||new Date,e.btnPrev=new Common.UI.Button({parentEl:e.cmpEl.find("#prev-arrow"),cls:"",iconCls:"arrow-prev img-commonctrl"}),e.btnPrev.on("click",_.bind(e.onClickPrev,e)),e.btnNext=new Common.UI.Button({parentEl:e.cmpEl.find("#next-arrow"),cls:"",iconCls:"arrow-next img-commonctrl"}),e.btnNext.on("click",_.bind(e.onClickNext,e)),e.cmpEl.on("keydown",function(t){e.trigger("calendar:keydown",e,t)}),e.renderMonth(e.currentDate),this.trigger("render:after",this),this},onClickPrev:function(){var t,e,i=this;0===i._state?((t=new Date(i.currentDate)).setMonth(t.getMonth()-1),0<t.getFullYear()&&i.renderMonth(t)):1===i._state?((t=new Date(i.currentDate)).setFullYear(t.getFullYear()-1),0<t.getFullYear()&&i.renderMonths(t)):2===i._state&&0<(e=(t=i.currentDate.getFullYear())%10!=0?(e=String(t),Number(e.slice(0,-1)+"0")-1):t-1)&&(i.currentDate.setFullYear(e),i.renderYears(e))},onClickNext:function(){var t,e,i=this;0===i._state?((t=new Date(i.currentDate)).setMonth(t.getMonth()+1),0<t.getFullYear()&&i.renderMonth(t)):1===i._state?((t=new Date(i.currentDate)).setFullYear(t.getFullYear()+1),0<t.getFullYear()&&i.renderMonths(t)):2===i._state&&0<(e=(t=i.currentDate.getFullYear())%10!=9?(e=String(t),Number(e.slice(0,-1)+"9")+1):t+1)&&(i.currentDate.setFullYear(e),i.renderYears(e))},renderYears:function(t){for(var e,n=this,t=_.isNumber(t)?t:(n.currentDate||new Date).getFullYear(),i=(n._state=2,n.$el.removeClass("view-days view-months").addClass("view-years"),t),s=t,o=(i%10!=0&&(e=String(t),i=Number(e.slice(0,-1)+"0")),s%10!=9&&(e=String(t),s=Number(e.slice(0,-1)+"9")),n.topTitle=_.template(["<label>"+i+"-"+s+"</label>"].join("")),n.cmpEl.find(".calendar-header .title").html(n.topTitle),n.bottomTitle=_.template(["<label>"+n.textYears+"</label>"].join("")),n.cmpEl.find(".calendar-header .bottom-row").html(n.bottomTitle),[]),a=i-3,l=0;l<16;l++)o.push({year:0<a?a:"",isCurrentDecade:i<=a&&a<=s,disabled:!(0<a),selected:_.isDate(n.selectedDate)?a===n.selectedDate.getFullYear():a===(new Date).getFullYear()}),a++;n.yearPicker?n.yearPicker.store.reset(o):(n.yearPicker=new Common.UI.DataView({el:n.cmpEl.find(".calendar-content"),store:new Common.UI.DataViewStore(o),itemTemplate:_.template('<div class="name-year <% if (!isCurrentDecade) { %> no-current-decade <% } %>" data-year="<%= year %>"><%= year %></div>')}),n.yearPicker.on("item:click",function(t,e,i,s){var i=i.get("year"),o=new Date;o.setFullYear(i),n.renderMonths(o)}),n.enableKeyEvents&&this.yearPicker.on("item:keydown",function(t,e,i){i.keyCode==Common.UI.Keys.ESC&&Common.NotificationCenter.trigger("dataview:blur")})),n.enableKeyEvents&&_.delay(function(){n.monthPicker.focus()},10)},renderMonths:function(t){for(var a=this,e=_.isDate(t)?t:a.currentDate||new Date,i=e.getFullYear(),s=(a._state=1,a.currentDate=e,a.$el.removeClass("view-years view-days").addClass("view-months"),a.topTitle=_.template(['<div class="button"><label>'+i+"</label></div>"].join("")),a.cmpEl.find(".calendar-header .title").html(a.topTitle),a.cmpEl.find(".calendar-header .title").off(),a.cmpEl.find(".calendar-header .title").on("click",_.bind(a.renderYears,a)),a.bottomTitle=_.template(["<label>"+a.textMonths+"</label>"].join("")),a.cmpEl.find(".calendar-header .bottom-row").html(a.bottomTitle),[]),o=new Date,n=0;n<12;n++)s.push({indexMonth:n,nameMonth:a.monthShortNames[n],year:i,curYear:!0,isCurrentMonth:n===e.getMonth(),selected:_.isDate(a.selectedDate)?n===a.selectedDate.getMonth()&&i===a.selectedDate.getFullYear():n===o.getMonth()&&i===o.getFullYear()});i+=1;for(n=0;n<4;n++)s.push({indexMonth:n,nameMonth:a.monthShortNames[n],year:i,curYear:!1,selected:_.isDate(a.selectedDate)?n===a.selectedDate.getMonth()&&i===a.selectedDate.getFullYear():n===o.getMonth()&&i===o.getFullYear()});a.monthsPicker?a.monthsPicker.store.reset(s):(a.monthsPicker=new Common.UI.DataView({el:a.cmpEl.find(".calendar-content"),store:new Common.UI.DataViewStore(s),itemTemplate:_.template('<div class="name-month <% if (!curYear) { %> no-cur-year <% } %>" data-month="<%= indexMonth %>" data-year="<%= year %>"><%= nameMonth %></div>')}),a.monthsPicker.on("item:click",function(t,e,i,s){var o=i.get("indexMonth"),i=i.get("year"),n=new Date;n.setFullYear(i,o),a.renderMonth(n)}),a.enableKeyEvents&&this.monthsPicker.on("item:keydown",function(t,e,i){i.keyCode==Common.UI.Keys.ESC&&Common.NotificationCenter.trigger("dataview:blur")})),a.enableKeyEvents&&_.delay(function(){a.monthPicker.focus()},10)},renderMonth:function(t){for(var a=this,e=(a._state=0,a.options.firstday),t=t||new Date,i=t.getMonth(),s=(t.getDay(),t.getDate(),t.getFullYear()),o=(a.currentDate=t,a.$el.removeClass("view-years view-months").addClass("view-days"),a.topTitle=_.template(['<div class="button">',"<label>"+a.monthNames[i]+" "+s+"</label>","</div>"].join("")),a.cmpEl.find(".calendar-header .title").html(a.topTitle),a.cmpEl.find(".calendar-header .title").off(),a.cmpEl.find(".calendar-header .title").on("click",_.bind(a.renderMonths,a)),""),n=e;n<7;n++)o+="<label>"+a.dayNamesShort[n]+"</label>";0<e&&(o+="<label>"+a.dayNamesShort[0]+"</label>"),a.cmpEl.find(".calendar-header .bottom-row").html(_.template(o));for(var l,r=[],t=new Date(t),c=(t.setDate(1),t.getDay()),t=a.daysInMonth(t.getTime()-864e6),t=0===e?0<c?t-(c-1):1:0===c?t-5:t-(c-2),c=0<c&&0===e||1===e?0<=i-1?(l=i-1,s):(l=11,s-1):(l=i,s),d=new Date,h=(d.setFullYear(c,l,t),new Date),p=0;p<6;p++)for(var m=0;m<7;m++){var u=d.getDay(),g=d.getDate(),b=d.getMonth(),C=d.getFullYear();r.push({indexInWeek:u,dayNumber:g,month:b,year:C,isCurrentMonth:b===i,selected:_.isDate(a.selectedDate)?g===a.selectedDate.getDate()&&b===a.selectedDate.getMonth()&&C===a.selectedDate.getFullYear():g===h.getDate()&&b===h.getMonth()&&C===h.getFullYear()}),d.setDate(g+1)}a.monthPicker?a.monthPicker.store.reset(r):(a.monthPicker=new Common.UI.DataView({el:a.cmpEl.find(".calendar-content"),store:new Common.UI.DataViewStore(r),itemTemplate:_.template('<div class="number-day<% if (indexInWeek === 6 || indexInWeek === 0) { %> weekend<% } %><% if (!isCurrentMonth) { %> no-current-month<% } %>" data-number="<%= dayNumber %>" data-month="<%= month %>" data-year="<%= year %>"><%= dayNumber %></div>')}),a.monthPicker.on("item:click",function(t,e,i,s){var o=i.get("dayNumber"),n=i.get("month"),i=i.get("year");_.isUndefined(a.selectedDate)&&(a.selectedDate=new Date),a.selectedDate.setFullYear(i,n,o),a.trigger("date:click",a,a.selectedDate)}),a.enableKeyEvents&&this.monthPicker.on("item:keydown",function(t,e,i){i.keyCode==Common.UI.Keys.ESC&&Common.NotificationCenter.trigger("dataview:blur")})),a.enableKeyEvents&&_.delay(function(){a.monthPicker.focus()},10)},daysInMonth:function(t){var t=t?new Date(t):new Date,e=new Date;return e.setFullYear(t.getFullYear(),t.getMonth()+1,0),e.getDate()},setDate:function(t){_.isDate(t)&&(this.selectedDate=new Date(t),this.renderMonth(this.selectedDate))},focus:function(){var t=this;t.enableKeyEvents&&t.monthPicker&&_.delay(function(){t.monthPicker.focus()},10)},textJanuary:"January",textFebruary:"February",textMarch:"March",textApril:"April",textMay:"May",textJune:"June",textJuly:"July",textAugust:"August",textSeptember:"September",textOctober:"October",textNovember:"November",textDecember:"December",textShortJanuary:"Jan",textShortFebruary:"Feb",textShortMarch:"Mar",textShortApril:"Apr",textShortMay:"May",textShortJune:"Jun",textShortJuly:"Jul",textShortAugust:"Aug",textShortSeptember:"Sep",textShortOctober:"Oct",textShortNovember:"Nov",textShortDecember:"Dec",textShortSunday:"Su",textShortMonday:"Mo",textShortTuesday:"Tu",textShortWednesday:"We",textShortThursday:"Th",textShortFriday:"Fr",textShortSaturday:"Sa",textMonths:"Months",textYears:"Years"},Common.UI.Calendar||{}))}),define("spreadsheeteditor/main/app/view/AutoFilterDialog",["common/main/lib/component/Window","common/main/lib/component/ColorPaletteExt","common/main/lib/component/Calendar"],function(){"use strict";SSE.Views=SSE.Views||{},SSE.Views.DigitalFilterDialog=Common.UI.Window.extend(_.extend({initialize:function(t){var e={};_.extend(e,{width:"date"===t.type?528:501,height:230,contentWidth:180,header:!0,cls:"filter-dlg"+("date"===t.type?" date-filter":""),contentTemplate:"",title:this.txtTitle,items:[]},t),this.template=t.template||['<div class="box" style="height:'+(e.height-85)+'px;">','<div class="content-panel" >','<label class="header">',this.textShowRows,"</label>",'<div class="combo-container-1">','<div id="id-search-begin-digital-combo" class="input-group-nr"></div>','<div id="id-sd-cell-search-begin" class="margin-left-18"></div>','<% if (type === "date") {%>','<div id="id-btn-date-picker-1" class="margin-left-5"></div>',"<% } %>","</div>","<div>",'<div id="id-and-radio" class="padding-small"></div>','<div id="id-or-radio" class="padding-small margin-left-22"></div>',"</div>",'<div class="combo-container-2">','<div id="id-search-end-digital-combo" class="input-group-nr"></div>','<div id="id-sd-cell-search-end" class="margin-left-18"></div>','<% if (type === "date") {%>','<div id="id-btn-date-picker-2" class="margin-left-5"></div>',"<% } %>","</div>","</div>","</div>",'<div class="separator horizontal"></div>','<div class="footer center">','<button class="btn normal dlg-btn primary" result="ok">',this.okButtonText,"</button>",'<button class="btn normal dlg-btn" result="cancel">',this.cancelButtonText,"</button>","</div>"].join(""),this.api=t.api,this.handler=t.handler,this.type=t.type||"number","date"===this.type&&(this.datePickers=[]),e.tpl=_.template(this.template)(e),Common.UI.Window.prototype.initialize.call(this,e)},render:function(){Common.UI.Window.prototype.render.call(this),this.conditions=[{value:Asc.c_oAscCustomAutoFilter.equals,displayValue:this.capCondition1},{value:Asc.c_oAscCustomAutoFilter.doesNotEqual,displayValue:this.capCondition2},{value:Asc.c_oAscCustomAutoFilter.isGreaterThan,displayValue:"date"!==this.type?this.capCondition3:this.capCondition30},{value:Asc.c_oAscCustomAutoFilter.isGreaterThanOrEqualTo,displayValue:"date"!==this.type?this.capCondition4:this.capCondition40},{value:Asc.c_oAscCustomAutoFilter.isLessThan,displayValue:"date"!==this.type?this.capCondition5:this.capCondition50},{value:Asc.c_oAscCustomAutoFilter.isLessThanOrEqualTo,displayValue:"date"!==this.type?this.capCondition6:this.capCondition60}],"text"!=this.type&&"date"!=this.type||(this.conditions=this.conditions.concat([{value:Asc.c_oAscCustomAutoFilter.beginsWith,displayValue:this.capCondition7},{value:Asc.c_oAscCustomAutoFilter.doesNotBeginWith,displayValue:this.capCondition8},{value:Asc.c_oAscCustomAutoFilter.endsWith,displayValue:this.capCondition9},{value:Asc.c_oAscCustomAutoFilter.doesNotEndWith,displayValue:this.capCondition10},{value:Asc.c_oAscCustomAutoFilter.contains,displayValue:this.capCondition11},{value:Asc.c_oAscCustomAutoFilter.doesNotContain,displayValue:this.capCondition12}])),this.cmbCondition1=new Common.UI.ComboBox({el:$("#id-search-begin-digital-combo",this.$window),menuStyle:"min-width: 225px;max-height: 135px;",cls:"input-group-nr",data:this.conditions,scrollAlwaysVisible:!0,editable:!1,takeFocusOnClose:!0}),this.cmbCondition1.setValue(Asc.c_oAscCustomAutoFilter.equals),this.conditions.splice(0,0,{value:0,displayValue:this.textNoFilter}),this.cmbCondition2=new Common.UI.ComboBox({el:$("#id-search-end-digital-combo",this.$window),menuStyle:"min-width: 225px;max-height: 135px;",cls:"input-group-nr",data:this.conditions,scrollAlwaysVisible:!0,editable:!1,takeFocusOnClose:!0}),this.cmbCondition2.setValue(0),this.rbAnd=new Common.UI.RadioBox({el:$("#id-and-radio",this.$window),labelText:this.capAnd,name:"asc-radio-filter-tab",checked:!0}),this.rbOr=new Common.UI.RadioBox({el:$("#id-or-radio",this.$window),labelText:this.capOr,name:"asc-radio-filter-tab"}),this.cmbValue1=new Common.UI.ComboBox({el:$("#id-sd-cell-search-begin",this.$window),cls:"input-group-nr",menuStyle:"min-width: 225px;max-height: 135px;",scrollAlwaysVisible:!0,data:[],takeFocusOnClose:!0}),this.cmbValue2=new Common.UI.ComboBox({el:$("#id-sd-cell-search-end",this.$window),cls:"input-group-nr",menuStyle:"min-width: 225px;max-height: 135px;",scrollAlwaysVisible:!0,data:[],takeFocusOnClose:!0}),"date"===this.type&&(this.btnDatePicker1=new Common.UI.Button({parentEl:$("#id-btn-date-picker-1",this.$window),cls:"btn-toolbar bg-white",iconCls:"toolbar__icon",hint:this.txtSelectDate}),this.btnDatePicker1.on("click",_.bind(this.showDatePicker,this)),this.btnDatePicker2=new Common.UI.Button({parentEl:$("#id-btn-date-picker-2",this.$window),cls:"btn-toolbar bg-white",iconCls:"toolbar__icon",hint:this.txtSelectDate}),this.btnDatePicker2.on("click",_.bind(this.showDatePicker,this)));this.cmbValue1.store.comparator=this.cmbValue2.store.comparator=function(t,e){var i=t.get("intval"),s=e.get("intval"),o=void 0!==i;return o!=(void 0!==s)?o?-1:1:(!o&&(i=t.get("value").toLowerCase())&&(s=e.get("value").toLowerCase()),i===s?0:""===s||""!==i&&i<s?-1:1)},this.$window.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.loadDefaults()},getFocusedComponents:function(){return[this.cmbCondition1,this.cmbValue1,this.rbAnd,this.rbOr,this.cmbCondition2,this.cmbValue2]},getDefaultFocusableComponent:function(){return this.cmbValue1},close:function(){this.api&&this.api.asc_enableKeyEvents(!0),Common.UI.Window.prototype.close.call(this)},onBtnClick:function(t){t.currentTarget.attributes&&t.currentTarget.attributes.result&&("ok"===t.currentTarget.attributes.result.value&&this.save(),this.close())},setSettings:function(t){this.properties=t},loadDefaults:function(){var e,t,i;this.properties&&this.rbOr&&this.rbAnd&&this.cmbCondition1&&this.cmbCondition2&&this.cmbValue1&&this.cmbValue2&&(e=[],this.properties.asc_getValues().forEach(function(t){t=t.asc_getText();_.isEmpty(t)||e.push({value:t,displayValue:t,intval:!isNaN(parseFloat(t))&&isFinite(t)?parseFloat(t):void 0})}),this.cmbValue1.setData(e),this.cmbValue2.setData(e),(t=this.properties.asc_getFilterObj()).asc_getType()==Asc.c_oAscAutoFilterTypes.CustomFilters&&(i=(t=t.asc_getFilter()).asc_getCustomFilters(),(t.asc_getAnd()?this.rbAnd:this.rbOr).setValue(!0),this.cmbCondition1.setValue(i[0].asc_getOperator()||Asc.c_oAscCustomAutoFilter.equals),this.cmbCondition2.setValue(1<i.length&&i[1].asc_getOperator()||0),this.cmbValue1.setValue(null===i[0].asc_getVal()?"":i[0].asc_getVal()),this.cmbValue2.setValue(!(1<i.length)||null===i[1].asc_getVal()?"":i[1].asc_getVal())))},save:function(){var t,e;this.api&&this.properties&&this.rbOr&&this.rbAnd&&this.cmbCondition1&&this.cmbCondition2&&this.cmbValue1&&this.cmbValue2&&((t=this.properties.asc_getFilterObj()).asc_setFilter(new Asc.CustomFilters),t.asc_setType(Asc.c_oAscAutoFilterTypes.CustomFilters),(t=t.asc_getFilter()).asc_setCustomFilters(0==this.cmbCondition2.getValue()?[new Asc.CustomFilter]:[new Asc.CustomFilter,new Asc.CustomFilter]),e=t.asc_getCustomFilters(),t.asc_setAnd(this.rbAnd.getValue()),e[0].asc_setOperator(this.cmbCondition1.getValue()),e[0].asc_setVal(this.cmbValue1.getValue()),0!==this.cmbCondition2.getValue()&&(e[1].asc_setOperator(this.cmbCondition2.getValue()||void 0),e[1].asc_setVal(this.cmbValue2.getValue())),this.api.asc_applyAutoFilter(this.properties))},onPrimary:function(){return this.save(),this.close(),!1},showDatePicker:function(t){Common.UI.Menu.Manager.hideAll();var i,e=t.$el.attr("id"),e=parseInt(e.slice(-1)),s=1===e?this.cmbValue1:this.cmbValue2;this.datePickers[e]?i=t.$el.find("#date-picker-"+e):(i=$('<div id="date-picker-'+e+'"><div id="date-picker-control'+e+'"></div></div>'),t.$el.append(i),this.datePickers[e]=new Common.UI.Calendar({el:i.find("#date-picker-control"+e),enableKeyEvents:!0,firstday:1}),this.datePickers[e].on("date:click",_.bind(function(t,e){s.setValue(new Date(e).toLocaleString().split(",")[0].replace(/\./g,"/")),i.hide()},this)),$(document).on("mousedown",function(t){"canvas"!==t.target.localName&&i.is(":visible")&&0==i.find(t.target).length&&i.hide()})),i.show()}},SSE.Views.DigitalFilterDialog||{})),SSE.Views.Top10FilterDialog=Common.UI.Window.extend(_.extend({initialize:function(t){var e={};this.type=t.type,_.extend(e,{width:"value"==this.type?450:318,height:160,contentWidth:180,header:!0,cls:"filter-dlg",contentTemplate:"",title:this.txtTitle,items:[],buttons:["ok","cancel"]},t),this.template=t.template||['<div class="box" style="height:'+(e.height-85)+'px;">','<div class="content-panel" >',"<label>",this.textType,"</label>","<div>",'<div id="id-top10-type-combo" class="margin-right-10" style="display: inline-block; vertical-align: middle;"></div>','<div id="id-top10-count-spin" class="input-group-nr margin-right-10" style="display: inline-block; vertical-align: middle;"></div>','<div id="id-top10-item-combo" class="input-group-nr" style="display: inline-block; vertical-align: middle;"></div>','<label id="id-top10-lblby" class="input-group-nr" style="min-width: 40px; text-align: center; display: inline-block; vertical-align: middle;">'+this.txtBy+"</label>",'<div id="id-top10-fields-combo" class="input-group-nr" style="width:100px;display: inline-block; vertical-align: middle;"></div>',"</div>","</div>","</div>",'<div class="separator horizontal" style="width:100%"></div>'].join(""),this.api=t.api,this.handler=t.handler,e.tpl=_.template(this.template)(e),Common.UI.Window.prototype.initialize.call(this,e)},render:function(){Common.UI.Window.prototype.render.call(this),this.cmbType=new Common.UI.ComboBox({el:$("#id-top10-type-combo",this.$window),style:"width: 85px;",menuStyle:"min-width: 85px;",cls:"input-group-nr",data:[{value:!0,displayValue:this.txtTop},{value:!1,displayValue:this.txtBottom}],editable:!1,takeFocusOnClose:!0}),this.cmbType.setValue(!0);var t=[{value:!1,displayValue:this.txtItems},{value:!0,displayValue:this.txtPercent}];"value"==this.type&&t.push({value:0,displayValue:this.txtSum}),this.cmbItem=new Common.UI.ComboBox({el:$("#id-top10-item-combo",this.$window),style:"width: 85px;",menuStyle:"min-width: 85px;",cls:"input-group-nr",data:t,editable:!1,takeFocusOnClose:!0}),this.cmbItem.setValue(!1),this.cmbItem.on("selected",_.bind(function(t,e){this.spnCount.setDefaultUnit(e.value?"%":"")},this)),this.spnCount=new Common.UI.MetricSpinner({el:$("#id-top10-count-spin"),step:1,width:85,defaultUnit:"",value:"10",maxValue:500,minValue:1}),this.cmbFields=new Common.UI.ComboBox({el:$("#id-top10-fields-combo",this.$window),menuStyle:"min-width: 100%;max-height: 135px;",style:"width:100%;",cls:"input-group-nr",data:[],scrollAlwaysVisible:!0,editable:!1,takeFocusOnClose:!0}),this.cmbFields.setVisible("value"==this.type),"value"!==this.type&&this.$window.find("#id-top10-lblby").addClass("hidden"),this.$window.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.loadDefaults()},getFocusedComponents:function(){return[this.cmbType,this.spnCount,this.cmbItem,this.cmbFields]},getDefaultFocusableComponent:function(){return this.spnCount},close:function(){this.api&&this.api.asc_enableKeyEvents(!0),Common.UI.Window.prototype.close.call(this)},onBtnClick:function(t){t.currentTarget.attributes&&t.currentTarget.attributes.result&&("ok"===t.currentTarget.attributes.result.value&&this.save(),this.close())},setSettings:function(t){this.properties=t},loadDefaults:function(){var t,i,e,s,o;this.properties&&(t=!1,"value"==this.type&&(s=(o=this.properties.asc_getPivotObj()).asc_getDataFieldIndexFilter(),e=o.asc_getDataFields(),t=o.asc_getIsTop10Sum(),this.setTitle(this.txtValueTitle+" ("+e[0]+")"),e.shift(),i=[],e&&e.forEach(function(t,e){t&&i.push({value:e,displayValue:t})}),this.cmbFields.setData(i),this.cmbFields.setValue(0!==s?s-1:0)),(o=this.properties.asc_getFilterObj()).asc_getType()==Asc.c_oAscAutoFilterTypes.Top10&&(s=(e=o.asc_getFilter()).asc_getTop(),o=e.asc_getPercent(),this.cmbType.setValue(s||null===s),this.cmbItem.setValue(t?0:o||null===o),this.spnCount.setDefaultUnit(!o&&null!==o||t?"":"%"),this.spnCount.setValue(e.asc_getVal())))},save:function(){var t;this.api&&this.properties&&((t=this.properties.asc_getFilterObj()).asc_setFilter(new Asc.Top10),t.asc_setType(Asc.c_oAscAutoFilterTypes.Top10),(t=t.asc_getFilter()).asc_setTop(this.cmbType.getValue()),t.asc_setPercent(!0===this.cmbItem.getValue()),t.asc_setVal(this.spnCount.getNumberValue()),"value"==this.type&&((t=this.properties.asc_getPivotObj()).asc_setIsTop10Sum(0===this.cmbItem.getValue()),t.asc_setDataFieldIndexFilter("value"==this.type?this.cmbFields.getValue()+1:0)),this.api.asc_applyAutoFilter(this.properties))},onPrimary:function(){return this.save(),this.close(),!1},txtTitle:"Top 10 AutoFilter",textType:"Show",txtTop:"Top",txtBottom:"Bottom",txtItems:"Item",txtPercent:"Percent",txtValueTitle:"Top 10 Filter",txtSum:"Sum",txtBy:"by"},SSE.Views.Top10FilterDialog||{})),SSE.Views.PivotDigitalFilterDialog=Common.UI.Window.extend(_.extend({initialize:function(t){var e=this,i={};_.extend(i,{width:501,height:210,contentWidth:180,header:!0,cls:"filter-dlg",contentTemplate:"",title:"label"==t.type?e.txtTitleLabel:e.txtTitleValue,items:[]},t),this.api=t.api,this.handler=t.handler,this.type=t.type||"value",this.template=t.template||['<div class="box" style="height:'+(i.height-85)+'px;">','<div class="content-panel" >','<label class="header">',"label"==e.type?e.textShowLabel:e.textShowValue,"</label>",'<div style="margin-top:15px;">','<div id="id-field-digital-combo" class="input-group-nr margin-right-10" style="vertical-align:middle;width:110px;display:inline-block;"></div>','<div id="id-cond-digital-combo" class="input-group-nr margin-right-10" style="vertical-align:middle;width:'+("label"==e.type?225:110)+'px;display:inline-block;"></div>','<div id="id-input-digital-value1" class="" style="vertical-align: middle; width:225px;display:inline-block;"></div>','<label id="id-label-digital-and" class="margin-left-5" style="vertical-align: middle;">'+this.txtAnd+"</label>",'<div id="id-input-digital-value2" class="margin-left-5" style="vertical-align: middle; width:100px;display:inline-block;"></div>',"</div>",'<div style="margin-top:10px;">','<label style="display:block;">'+e.textUse1+"</label>",'<label style="display:block;">'+e.textUse2+"</label>","</div>","</div>","</div>",'<div class="separator horizontal" style="width:100%"></div>','<div class="footer center">','<button class="btn normal dlg-btn primary" result="ok">',e.okButtonText,"</button>",'<button class="btn normal dlg-btn" result="cancel">',e.cancelButtonText,"</button>","</div>"].join(""),i.tpl=_.template(this.template)(i),Common.UI.Window.prototype.initialize.call(this,i)},render:function(){Common.UI.Window.prototype.render.call(this),this.conditions=[{value:Asc.c_oAscCustomAutoFilter.equals,displayValue:this.capCondition1},{value:Asc.c_oAscCustomAutoFilter.doesNotEqual,displayValue:this.capCondition2},{value:Asc.c_oAscCustomAutoFilter.isGreaterThan,displayValue:this.capCondition3},{value:Asc.c_oAscCustomAutoFilter.isGreaterThanOrEqualTo,displayValue:this.capCondition4},{value:Asc.c_oAscCustomAutoFilter.isLessThan,displayValue:this.capCondition5},{value:Asc.c_oAscCustomAutoFilter.isLessThanOrEqualTo,displayValue:this.capCondition6},{value:-2,displayValue:this.capCondition13},{value:-3,displayValue:this.capCondition14}],"label"==this.type&&(this.conditions=this.conditions.concat([{value:Asc.c_oAscCustomAutoFilter.beginsWith,displayValue:this.capCondition7},{value:Asc.c_oAscCustomAutoFilter.doesNotBeginWith,displayValue:this.capCondition8},{value:Asc.c_oAscCustomAutoFilter.endsWith,displayValue:this.capCondition9},{value:Asc.c_oAscCustomAutoFilter.doesNotEndWith,displayValue:this.capCondition10},{value:Asc.c_oAscCustomAutoFilter.contains,displayValue:this.capCondition11},{value:Asc.c_oAscCustomAutoFilter.doesNotContain,displayValue:this.capCondition12}])),this.cmbCondition1=new Common.UI.ComboBox({el:$("#id-cond-digital-combo",this.$window),menuStyle:"min-width: 100%;max-height: 135px;",style:"width:100%;",cls:"input-group-nr",data:this.conditions,scrollAlwaysVisible:!0,editable:!1,takeFocusOnClose:!0}),this.cmbCondition1.setValue(Asc.c_oAscCustomAutoFilter.equals),this.cmbCondition1.on("selected",_.bind(function(t,e){var e=-2==e.value||-3==e.value,i=(this.inputValue2.setVisible(e),this.lblAnd.toggleClass("hidden",!e),this.inputValue.$el.width(e?100:225),this);setTimeout(function(){i.inputValue&&i.inputValue.focus()},10)},this)),this.cmbFields=new Common.UI.ComboBox({el:$("#id-field-digital-combo",this.$window),menuStyle:"min-width: 100%;max-height: 135px;",style:"width:100%;",cls:"input-group-nr",data:[],scrollAlwaysVisible:!0,editable:!1,takeFocusOnClose:!0}),this.cmbFields.setVisible("value"==this.type),this.cmbFields.on("selected",_.bind(function(t,e){var i=this;setTimeout(function(){i.inputValue&&i.inputValue.focus()},10)},this)),this.inputValue=new Common.UI.InputField({el:$("#id-input-digital-value1"),allowBlank:!1,style:"width: 100%;",validateOnBlur:!1}),this.inputValue2=new Common.UI.InputField({el:$("#id-input-digital-value2"),allowBlank:!1,style:"width: 100%;",validateOnBlur:!1}),this.lblAnd=this.$window.find("#id-label-digital-and"),this.$window.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.loadDefaults()},getFocusedComponents:function(){return[this.cmbFields,this.cmbCondition1,this.inputValue,this.inputValue2]},getDefaultFocusableComponent:function(){return this.inputValue},close:function(){this.api&&this.api.asc_enableKeyEvents(!0),Common.UI.Window.prototype.close.call(this)},onBtnClick:function(t){t.currentTarget.attributes&&t.currentTarget.attributes.result&&("ok"===t.currentTarget.attributes.result.value&&this.save(),this.close())},setSettings:function(t){this.properties=t},loadDefaults:function(){var i,t,e,s,o,n;this.properties&&this.cmbCondition1&&this.cmbFields&&this.inputValue&&(s=(t=this.properties.asc_getPivotObj()).asc_getDataFieldIndexFilter(),t=t.asc_getDataFields(),this.setTitle(this.options.title+" ("+t[0]+")"),"value"==this.type&&(t.shift(),i=[],t&&t.forEach(function(t,e){t&&i.push({value:e,displayValue:t})}),this.cmbFields.setData(i),this.cmbFields.setValue(0!==s?s-1:0)),(t=this.properties.asc_getFilterObj()).asc_getType()==Asc.c_oAscAutoFilterTypes.CustomFilters&&(e=(t=(s=t.asc_getFilter()).asc_getCustomFilters())[0].asc_getOperator(),1<t.length&&(s=s.asc_getAnd(),o=t[0].asc_getOperator()==Asc.c_oAscCustomAutoFilter.isGreaterThanOrEqualTo&&t[1].asc_getOperator()==Asc.c_oAscCustomAutoFilter.isLessThanOrEqualTo,n=t[0].asc_getOperator()==Asc.c_oAscCustomAutoFilter.isLessThan&&t[1].asc_getOperator()==Asc.c_oAscCustomAutoFilter.isGreaterThan,s&&o?e=-2:!s&&n&&(e=-3)),this.cmbCondition1.setValue(e||Asc.c_oAscCustomAutoFilter.equals),this.inputValue.setValue(null===t[0].asc_getVal()?"":t[0].asc_getVal()),this.inputValue.$el.width(-2==e||-3==e?100:225),this.lblAnd.toggleClass("hidden",!(-2==e||-3==e)),this.inputValue2.setVisible(-2==e||-3==e),this.inputValue2.setValue(!(1<t.length)||null===t[1].asc_getVal()?"":t[1].asc_getVal())))},save:function(){var t,e,i;this.api&&this.properties&&this.cmbCondition1&&this.cmbFields&&this.inputValue&&((t=this.properties.asc_getFilterObj()).asc_setFilter(new Asc.CustomFilters),t.asc_setType(Asc.c_oAscAutoFilterTypes.CustomFilters),t=t.asc_getFilter(),-2==(e=this.cmbCondition1.getValue())?(t.asc_setCustomFilters([new Asc.CustomFilter,new Asc.CustomFilter]),t.asc_setAnd(!0),(i=t.asc_getCustomFilters())[0].asc_setOperator(Asc.c_oAscCustomAutoFilter.isGreaterThanOrEqualTo),i[0].asc_setVal(this.inputValue.getValue()),i[1].asc_setOperator(Asc.c_oAscCustomAutoFilter.isLessThanOrEqualTo),i[1].asc_setVal(this.inputValue2.getValue())):-3==e?(t.asc_setCustomFilters([new Asc.CustomFilter,new Asc.CustomFilter]),t.asc_setAnd(!1),(i=t.asc_getCustomFilters())[0].asc_setOperator(Asc.c_oAscCustomAutoFilter.isLessThan),i[0].asc_setVal(this.inputValue.getValue()),i[1].asc_setOperator(Asc.c_oAscCustomAutoFilter.isGreaterThan),i[1].asc_setVal(this.inputValue2.getValue())):(t.asc_setCustomFilters([new Asc.CustomFilter]),t.asc_setAnd(!0),(i=t.asc_getCustomFilters())[0].asc_setOperator(this.cmbCondition1.getValue()),i[0].asc_setVal(this.inputValue.getValue())),this.properties.asc_getPivotObj().asc_setDataFieldIndexFilter("value"==this.type?this.cmbFields.getValue()+1:0),this.api.asc_applyAutoFilter(this.properties))},onPrimary:function(){return this.save(),this.close(),!1}},SSE.Views.PivotDigitalFilterDialog||{})),SSE.Views.SortFilterDialog=Common.UI.Window.extend(_.extend({initialize:function(t){var e={};this.type=t.type,_.extend(e,{width:250,height:215,contentWidth:180,header:!0,cls:"filter-dlg",contentTemplate:"",title:this.txtTitle,items:[],buttons:["ok","cancel"]},t),this.template=t.template||['<div class="box" style="height:'+(e.height-85)+'px;">','<div class="content-panel" >','<div id="id-sort-filter-radio-asc" style="margin-bottom: 4px;"></div>','<div id="id-sort-filter-fields-asc" class="input-group-nr margin-left-22" style="margin-bottom: 10px;"></div>','<div id="id-sort-filter-radio-desc" style="margin-bottom: 4px;"></div>','<div id="id-sort-filter-fields-desc" class="input-group-nr margin-left-22"></div>',"</div>","</div>",'<div class="separator horizontal" style="width:100%"></div>'].join(""),this.api=t.api,this.handler=t.handler,e.tpl=_.template(this.template)(e),Common.UI.Window.prototype.initialize.call(this,e)},render:function(){Common.UI.Window.prototype.render.call(this),this.radioAsc=new Common.UI.RadioBox({el:$("#id-sort-filter-radio-asc"),labelText:this.textAsc,name:"asc-radio-sort",checked:!0}),this.radioAsc.on("change",_.bind(function(t,e){e&&this.cmbFieldsAsc.setDisabled(!1),e&&this.cmbFieldsDesc.setDisabled(!0)},this)),this.radioDesc=new Common.UI.RadioBox({el:$("#id-sort-filter-radio-desc"),labelText:this.textDesc,name:"asc-radio-sort"}),this.radioDesc.on("change",_.bind(function(t,e){e&&this.cmbFieldsAsc.setDisabled(!0),e&&this.cmbFieldsDesc.setDisabled(!1)},this)),this.cmbFieldsAsc=new Common.UI.ComboBox({el:$("#id-sort-filter-fields-asc",this.$window),menuStyle:"min-width: 100%;max-height: 135px;",style:"width:100%;",cls:"input-group-nr",data:[],scrollAlwaysVisible:!0,editable:!1,takeFocusOnClose:!0}),this.cmbFieldsDesc=new Common.UI.ComboBox({el:$("#id-sort-filter-fields-desc",this.$window),menuStyle:"min-width: 100%;max-height: 135px;",style:"width:100%;",cls:"input-group-nr",data:[],scrollAlwaysVisible:!0,editable:!1,disabled:!0,takeFocusOnClose:!0}),this.$window.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.loadDefaults()},getFocusedComponents:function(){return[this.radioAsc,this.cmbFieldsAsc,this.radioDesc,this.cmbFieldsDesc]},getDefaultFocusableComponent:function(){return this.cmbFieldsAsc.isDisabled()?this.cmbFieldsDesc:this.cmbFieldsAsc},show:function(){Common.UI.Window.prototype.show.call(this)},close:function(){this.api&&this.api.asc_enableKeyEvents(!0),Common.UI.Window.prototype.close.call(this)},onBtnClick:function(t){t.currentTarget.attributes&&t.currentTarget.attributes.result&&("ok"===t.currentTarget.attributes.result.value&&this.save(),this.close())},setSettings:function(t){this.properties=t},loadDefaults:function(){var i,s,t,e,o,n,a;this.properties&&(t=0,e=Asc.c_oAscSortOptions.Ascending,i=[],this.properties.filter?(o=(a=(s=this.properties.filter).asc_getPivotObj()).asc_getDataFields(),t=a.asc_getDataFieldIndexSorting(),e=s.asc_getSortState(),o&&o.forEach(function(t,e){t&&i.push({value:e,displayValue:t,filter:s,indexSorting:e})}),this.setTitle(this.txtTitle+" ("+o[0]+")")):this.properties.rowFilter&&this.properties.colFilter&&(this.setTitle(this.txtTitleValue),o=(a=this.properties.rowFilter.asc_getPivotObj()).asc_getDataFields(),n=a.asc_getDataFieldIndexSorting(),i.push({value:0,displayValue:o[0],filter:this.properties.rowFilter,indexSorting:1}),o=(a=this.properties.colFilter.asc_getPivotObj()).asc_getDataFields(),a=a.asc_getDataFieldIndexSorting(),i.push({value:1,displayValue:o[0],filter:this.properties.colFilter,indexSorting:1}),e=(0<n||n===a?(t=0,this.properties.rowFilter):(t=1,this.properties.colFilter)).asc_getSortState()),this.cmbFieldsAsc.setData(i),this.cmbFieldsAsc.setValue(0<=t?t:0),this.cmbFieldsDesc.setData(i),this.cmbFieldsDesc.setValue(0<=t?t:0),this.radioDesc.setValue(e==Asc.c_oAscSortOptions.Descending,!0),this.cmbFieldsDesc.setDisabled(e!==Asc.c_oAscSortOptions.Descending),this.cmbFieldsAsc.setDisabled(e===Asc.c_oAscSortOptions.Descending))},save:function(){var t,e;this.api&&this.properties&&((t=(this.radioAsc.getValue()?this.cmbFieldsAsc:this.cmbFieldsDesc).getSelectedRecord())&&((e=t.filter).asc_getPivotObj().asc_setDataFieldIndexSorting(t.indexSorting),e.asc_setSortState(this.radioAsc.getValue()?Asc.c_oAscSortOptions.Ascending:Asc.c_oAscSortOptions.Descending),this.api.asc_applyAutoFilter(e)))},onPrimary:function(){return this.save(),this.close(),!1},txtTitle:"Sort",txtTitleValue:"Sort by value",textAsc:"Ascenging (A to Z) by",textDesc:"Descending (Z to A) by"},SSE.Views.SortFilterDialog||{})),SSE.Views.AutoFilterDialog=Common.UI.Window.extend(_.extend({initialize:function(t){var e={},i=450,s=void 0;Common.Utils.InternalSettings.get("sse-settings-size-filter-window")&&(i=Common.Utils.InternalSettings.get("sse-settings-size-filter-window")[0],s=Common.Utils.InternalSettings.get("sse-settings-size-filter-window")[1]),_.extend(e,{width:i||450,height:s||277,contentWidth:i-50||400,header:!1,cls:"filter-dlg autofilter invisible-borders",contentTemplate:"",title:this.txtTitle,modal:!1,animate:!1,items:[],resizable:!0,minwidth:450,minheight:277},t),this.template=t.template||['<div class="box" style="height: 100%; display: flex; justify-content: space-between;">','<div class="content-panel">','<div class="" style="display: flex; flex-direction: column; justify-content: flex-start; height: calc(100% - 37px);">','<div id="id-sd-cell-search" style="height:22px; margin-bottom:10px;flex-shrink: 0;"></div>','<div class="border-values" style="overflow: hidden; flex-grow: 1;display: flex;">','<div id="id-dlg-filter-values" class="combo-values" style=""></div>',"</div>","</div>",'<div class="footer center">','<div id="id-apply-filter" style="display: inline-block;"></div>','<button class="btn normal dlg-btn" result="cancel">',this.cancelButtonText,"</button>","</div>","</div>",'<div class="menu-panel">','<div id="menu-container-filters" style=""><div class="dropdown-toggle" data-toggle="dropdown"></div></div>',"</div>","</div>"].join(""),this.api=t.api,this.handler=t.handler,this.throughIndexes=[],this.filteredIndexes=[],this.curSize=null,e.tpl=_.template(this.template)(e),Common.UI.Window.prototype.initialize.call(this,e),this.on("resizing",_.bind(this.onWindowResizing,this)),this.on("resize",_.bind(this.onWindowResize,this))},render:function(){for(var i=this,t=(Common.UI.Window.prototype.render.call(this),this.$window.find(".resize-border")),e=(this.$window.find(".resize-border.left, .resize-border.top").css({cursor:"default"}),t.removeClass("left"),t.removeClass("top"),this.$window.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.btnOk=new Common.UI.Button({cls:"btn normal dlg-btn primary",caption:this.okButtonText,enableToggle:!1,allowDepress:!1}),this.btnOk&&(this.btnOk.render($("#id-apply-filter",this.$window)),this.btnOk.on("click",_.bind(this.onApplyFilter,this))),this.miSortLow2High=new Common.UI.MenuItem({caption:this.txtSortLow2High,toggleGroup:"menufiltersort",checkable:!0,checked:!1}),this.miSortLow2High.on("click",_.bind(this.onSortType,this,Asc.c_oAscSortOptions.Ascending)),this.miSortHigh2Low=new Common.UI.MenuItem({caption:this.txtSortHigh2Low,toggleGroup:"menufiltersort",checkable:!0,checked:!1}),this.miSortHigh2Low.on("click",_.bind(this.onSortType,this,Asc.c_oAscSortOptions.Descending)),this.miSortOptions=new Common.UI.MenuItem({caption:this.txtSortOption}),this.miSortOptions.on("click",_.bind(this.onSortOptions,this)),this.miSortCellColor=new Common.UI.MenuItem({caption:this.txtSortCellColor,toggleGroup:"menufiltersort",checkable:!0,checked:!1,menu:new Common.UI.Menu({style:"min-width: inherit; padding: 0px;",menuAlign:"tl-tr",items:[{template:_.template('<div id="filter-dlg-sort-cells-color" style="max-width: 147px; max-height: 120px;"></div>')}]})}),this.miSortFontColor=new Common.UI.MenuItem({caption:this.txtSortFontColor,toggleGroup:"menufiltersort",checkable:!0,checked:!1,menu:new Common.UI.Menu({style:"min-width: inherit; padding: 0px;",menuAlign:"tl-tr",items:[{template:_.template('<div id="filter-dlg-sort-font-color" style="max-width: 147px; max-height: 120px;"></div>')}]})}),this.miNumFilter=new Common.UI.MenuItem({caption:this.txtNumFilter,toggleGroup:"menufilterfilter",checkable:!0,checked:!1,menu:new Common.UI.Menu({menuAlign:"tl-tr",items:[{value:Asc.c_oAscCustomAutoFilter.equals,caption:this.txtEquals,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters},{value:Asc.c_oAscCustomAutoFilter.doesNotEqual,caption:this.txtNotEquals,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters},{caption:"--"},{value:Asc.c_oAscCustomAutoFilter.isGreaterThan,caption:this.txtGreater,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters},{value:Asc.c_oAscCustomAutoFilter.isGreaterThanOrEqualTo,caption:this.txtGreaterEquals,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters},{value:Asc.c_oAscCustomAutoFilter.isLessThan,caption:this.txtLess,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters},{value:Asc.c_oAscCustomAutoFilter.isLessThanOrEqualTo,caption:this.txtLessEquals,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters},{value:-2,caption:this.txtBetween,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters},{caption:"--"},{value:Asc.c_oAscCustomAutoFilter.top10,caption:this.txtTop10,checkable:!0,type:Asc.c_oAscAutoFilterTypes.Top10},{value:Asc.c_oAscDynamicAutoFilter.aboveAverage,caption:this.txtAboveAve,checkable:!0,type:Asc.c_oAscAutoFilterTypes.DynamicFilter},{value:Asc.c_oAscDynamicAutoFilter.belowAverage,caption:this.txtBelowAve,checkable:!0,type:Asc.c_oAscAutoFilterTypes.DynamicFilter},{caption:"--"},{value:-1,caption:this.btnCustomFilter+"...",checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters}]})}),this.miNumFilter.menu.items),s=0;s<e.length;s++)e[s].on("click",_.bind(e[s].options.type==Asc.c_oAscAutoFilterTypes.CustomFilters?this.onNumCustomFilterItemClick:e[s].options.type==Asc.c_oAscAutoFilterTypes.DynamicFilter?this.onNumDynamicFilterItemClick:this.onTop10FilterItemClick,this));for(this.miTextFilter=new Common.UI.MenuItem({caption:this.txtTextFilter,toggleGroup:"menufilterfilter",checkable:!0,checked:!1,menu:new Common.UI.Menu({menuAlign:"tl-tr",items:[{value:Asc.c_oAscCustomAutoFilter.equals,caption:this.txtEquals,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters},{value:Asc.c_oAscCustomAutoFilter.doesNotEqual,caption:this.txtNotEquals,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters},{caption:"--"},{value:Asc.c_oAscCustomAutoFilter.beginsWith,caption:this.txtBegins,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters},{value:Asc.c_oAscCustomAutoFilter.doesNotBeginWith,caption:this.txtNotBegins,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters},{value:Asc.c_oAscCustomAutoFilter.endsWith,caption:this.txtEnds,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters},{value:Asc.c_oAscCustomAutoFilter.doesNotEndWith,caption:this.txtNotEnds,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters},{caption:"--"},{value:Asc.c_oAscCustomAutoFilter.contains,caption:this.txtContains,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters},{value:Asc.c_oAscCustomAutoFilter.doesNotContain,caption:this.txtNotContains,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters},{caption:"--"},{value:-1,caption:this.btnCustomFilter+"...",checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters}]})}),this.miTextFilter.menu.on("item:click",_.bind(this.onTextFilterMenuClick,this)),this.miDateFilter=new Common.UI.MenuItem({caption:this.txtDateFilter,toggleGroup:"menudatefilter",checkable:!0,checked:!1,menu:new Common.UI.Menu({menuAlign:"tl-tr",restoreHeightAndTop:!0,items:[{value:Asc.c_oAscCustomAutoFilter.equals,caption:this.txtEquals,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters},{caption:"--"},{value:Asc.c_oAscCustomAutoFilter.isLessThan,caption:this.txtBefore,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters},{value:Asc.c_oAscCustomAutoFilter.isGreaterThan,caption:this.txtAfter,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters},{value:-2,caption:this.txtBetween,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters},{caption:"--"},{value:Asc.c_oAscDynamicAutoFilter.tomorrow,caption:this.txtTomorrow,checkable:!0,type:Asc.c_oAscAutoFilterTypes.DynamicFilter},{value:Asc.c_oAscDynamicAutoFilter.today,caption:this.txtToday,checkable:!0,type:Asc.c_oAscAutoFilterTypes.DynamicFilter},{value:Asc.c_oAscDynamicAutoFilter.yesterday,caption:this.txtYesterday,checkable:!0,type:Asc.c_oAscAutoFilterTypes.DynamicFilter},{caption:"--"},{value:Asc.c_oAscDynamicAutoFilter.nextWeek,caption:this.txtNextWeek,checkable:!0,type:Asc.c_oAscAutoFilterTypes.DynamicFilter},{value:Asc.c_oAscDynamicAutoFilter.thisWeek,caption:this.txtThisWeek,checkable:!0,type:Asc.c_oAscAutoFilterTypes.DynamicFilter},{value:Asc.c_oAscDynamicAutoFilter.lastWeek,caption:this.txtLastWeek,checkable:!0,type:Asc.c_oAscAutoFilterTypes.DynamicFilter},{caption:"--"},{value:Asc.c_oAscDynamicAutoFilter.nextMonth,caption:this.txtNextMonth,checkable:!0,type:Asc.c_oAscAutoFilterTypes.DynamicFilter},{value:Asc.c_oAscDynamicAutoFilter.thisMonth,caption:this.txtThisMonth,checkable:!0,type:Asc.c_oAscAutoFilterTypes.DynamicFilter},{value:Asc.c_oAscDynamicAutoFilter.lastMonth,caption:this.txtLastMonth,checkable:!0,type:Asc.c_oAscAutoFilterTypes.DynamicFilter},{caption:"--"},{value:Asc.c_oAscDynamicAutoFilter.nextQuarter,caption:this.txtNextQuarter,checkable:!0,type:Asc.c_oAscAutoFilterTypes.DynamicFilter},{value:Asc.c_oAscDynamicAutoFilter.thisQuarter,caption:this.txtThisQuarter,checkable:!0,type:Asc.c_oAscAutoFilterTypes.DynamicFilter},{value:Asc.c_oAscDynamicAutoFilter.lastQuarter,caption:this.txtLastQuarter,checkable:!0,type:Asc.c_oAscAutoFilterTypes.DynamicFilter},{caption:"--"},{value:Asc.c_oAscDynamicAutoFilter.nextYear,caption:this.txtNextYear,checkable:!0,type:Asc.c_oAscAutoFilterTypes.DynamicFilter},{value:Asc.c_oAscDynamicAutoFilter.thisYear,caption:this.txtThisYear,checkable:!0,type:Asc.c_oAscAutoFilterTypes.DynamicFilter},{value:Asc.c_oAscDynamicAutoFilter.lastYear,caption:this.txtLastYear,checkable:!0,type:Asc.c_oAscAutoFilterTypes.DynamicFilter},{caption:"--"},{value:Asc.c_oAscDynamicAutoFilter.yearToDate,caption:this.txtYearToDate,checkable:!0,type:Asc.c_oAscAutoFilterTypes.DynamicFilter},this.miDatesInThePeriod=new Common.UI.MenuItem({caption:this.txtAllDatesInThePeriod,toggleGroup:"menudateperiod",checkable:!0,menu:new Common.UI.Menu({menuAlign:"tl-tr",restoreHeightAndTop:!0,items:[{value:Asc.c_oAscDynamicAutoFilter.q1,caption:this.txtQuarter1,checkable:!0,type:Asc.c_oAscAutoFilterTypes.DynamicFilter},{value:Asc.c_oAscDynamicAutoFilter.q2,caption:this.txtQuarter2,checkable:!0,type:Asc.c_oAscAutoFilterTypes.DynamicFilter},{value:Asc.c_oAscDynamicAutoFilter.q3,caption:this.txtQuarter3,checkable:!0,type:Asc.c_oAscAutoFilterTypes.DynamicFilter},{value:Asc.c_oAscDynamicAutoFilter.q4,caption:this.txtQuarter4,checkable:!0,type:Asc.c_oAscAutoFilterTypes.DynamicFilter},{caption:"--"},{value:Asc.c_oAscDynamicAutoFilter.m1,caption:this.txtJanuary,checkable:!0,type:Asc.c_oAscAutoFilterTypes.DynamicFilter},{value:Asc.c_oAscDynamicAutoFilter.m2,caption:this.txtFebruary,checkable:!0,type:Asc.c_oAscAutoFilterTypes.DynamicFilter},{value:Asc.c_oAscDynamicAutoFilter.m3,caption:this.txtMarch,checkable:!0,type:Asc.c_oAscAutoFilterTypes.DynamicFilter},{value:Asc.c_oAscDynamicAutoFilter.m4,caption:this.txtApril,checkable:!0,type:Asc.c_oAscAutoFilterTypes.DynamicFilter},{value:Asc.c_oAscDynamicAutoFilter.m5,caption:this.txtMay,checkable:!0,type:Asc.c_oAscAutoFilterTypes.DynamicFilter},{value:Asc.c_oAscDynamicAutoFilter.m6,caption:this.txtJune,checkable:!0,type:Asc.c_oAscAutoFilterTypes.DynamicFilter},{value:Asc.c_oAscDynamicAutoFilter.m7,caption:this.txtJuly,checkable:!0,type:Asc.c_oAscAutoFilterTypes.DynamicFilter},{value:Asc.c_oAscDynamicAutoFilter.m8,caption:this.txtAugust,checkable:!0,type:Asc.c_oAscAutoFilterTypes.DynamicFilter},{value:Asc.c_oAscDynamicAutoFilter.m9,caption:this.txtSeptember,checkable:!0,type:Asc.c_oAscAutoFilterTypes.DynamicFilter},{value:Asc.c_oAscDynamicAutoFilter.m10,caption:this.txtOctober,checkable:!0,type:Asc.c_oAscAutoFilterTypes.DynamicFilter},{value:Asc.c_oAscDynamicAutoFilter.m11,caption:this.txtNovember,checkable:!0,type:Asc.c_oAscAutoFilterTypes.DynamicFilter},{value:Asc.c_oAscDynamicAutoFilter.m12,caption:this.txtDecember,checkable:!0,type:Asc.c_oAscAutoFilterTypes.DynamicFilter}]})}),{caption:"--"},{value:-1,caption:this.btnCustomFilter+"...",checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters}]})}),e=this.miDateFilter.menu.items.concat(this.miDatesInThePeriod.menu.items),s=0;s<e.length;s++)e[s].on("click",_.bind(e[s].options.type===Asc.c_oAscAutoFilterTypes.CustomFilters?this.onDataFilterMenuClick:this.onNumDynamicFilterItemClick,this));this.miFilterCellColor=new Common.UI.MenuItem({caption:this.txtFilterCellColor,toggleGroup:"menufilterfilter",checkable:!0,checked:!1,menu:new Common.UI.Menu({style:"min-width: inherit; padding: 0px;",menuAlign:"tl-tr",items:[{template:_.template('<div id="filter-dlg-filter-cells-color" style="max-width: 147px; max-height: 120px;"></div>')}]})}),this.miFilterFontColor=new Common.UI.MenuItem({caption:this.txtFilterFontColor,toggleGroup:"menufilterfilter",checkable:!0,checked:!1,menu:new Common.UI.Menu({style:"min-width: inherit; padding: 0px;",menuAlign:"tl-tr",items:[{template:_.template('<div id="filter-dlg-filter-font-color" style="max-width: 147px; max-height: 120px;"></div>')}]})}),this.miClear=new Common.UI.MenuItem({caption:this.txtClear,checkable:!1}),this.miClear.on("click",_.bind(this.onClear,this)),this.miReapply=new Common.UI.MenuItem({caption:this.txtReapply,checkable:!1}),this.miReapply.on("click",_.bind(this.onReapply,this)),this.miReapplySeparator=new Common.UI.MenuItem({caption:"--"}),this.miValueFilter=new Common.UI.MenuItem({caption:this.txtValueFilter,toggleGroup:"menufilterfilter",checkable:!0,checked:!1,menu:new Common.UI.Menu({menuAlign:"tl-tr",items:[{value:Asc.c_oAscCustomAutoFilter.equals,caption:this.txtEquals,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters,pivottype:"value"},{value:Asc.c_oAscCustomAutoFilter.doesNotEqual,caption:this.txtNotEquals,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters,pivottype:"value"},{caption:"--"},{value:Asc.c_oAscCustomAutoFilter.isGreaterThan,caption:this.txtGreater,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters,pivottype:"value"},{value:Asc.c_oAscCustomAutoFilter.isGreaterThanOrEqualTo,caption:this.txtGreaterEquals,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters,pivottype:"value"},{value:Asc.c_oAscCustomAutoFilter.isLessThan,caption:this.txtLess,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters,pivottype:"value"},{value:Asc.c_oAscCustomAutoFilter.isLessThanOrEqualTo,caption:this.txtLessEquals,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters,pivottype:"value"},{value:-2,caption:this.txtBetween,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters,pivottype:"value"},{value:-3,caption:this.txtNotBetween,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters,pivottype:"value"},{caption:"--"},{value:Asc.c_oAscCustomAutoFilter.top10,caption:this.txtTop10,checkable:!0,type:Asc.c_oAscAutoFilterTypes.Top10,pivottype:"value"}]})}),this.miValueFilter.menu.on("item:click",_.bind(this.onValueFilterMenuClick,this)),this.miLabelFilter=new Common.UI.MenuItem({caption:this.txtLabelFilter,toggleGroup:"menufilterfilter",checkable:!0,checked:!1,menu:new Common.UI.Menu({menuAlign:"tl-tr",items:[{value:Asc.c_oAscCustomAutoFilter.equals,caption:this.txtEquals,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters,pivottype:"label"},{value:Asc.c_oAscCustomAutoFilter.doesNotEqual,caption:this.txtNotEquals,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters,pivottype:"label"},{caption:"--"},{value:Asc.c_oAscCustomAutoFilter.beginsWith,caption:this.txtBegins,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters,pivottype:"label"},{value:Asc.c_oAscCustomAutoFilter.doesNotBeginWith,caption:this.txtNotBegins,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters,pivottype:"label"},{value:Asc.c_oAscCustomAutoFilter.endsWith,caption:this.txtEnds,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters,pivottype:"label"},{value:Asc.c_oAscCustomAutoFilter.doesNotEndWith,caption:this.txtNotEnds,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters,pivottype:"label"},{caption:"--"},{value:Asc.c_oAscCustomAutoFilter.contains,caption:this.txtContains,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters,pivottype:"label"},{value:Asc.c_oAscCustomAutoFilter.doesNotContain,caption:this.txtNotContains,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters,pivottype:"label"},{caption:"--"},{value:Asc.c_oAscCustomAutoFilter.isGreaterThan,caption:this.txtGreater,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters,pivottype:"label"},{value:Asc.c_oAscCustomAutoFilter.isGreaterThanOrEqualTo,caption:this.txtGreaterEquals,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters,pivottype:"label"},{value:Asc.c_oAscCustomAutoFilter.isLessThan,caption:this.txtLess,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters,pivottype:"label"},{value:Asc.c_oAscCustomAutoFilter.isLessThanOrEqualTo,caption:this.txtLessEquals,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters,pivottype:"label"},{value:-2,caption:this.txtBetween,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters,pivottype:"label"},{value:-3,caption:this.txtNotBetween,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters,pivottype:"label"}]})}),this.miLabelFilter.menu.on("item:click",_.bind(this.onLabelFilterMenuClick,this)),this.filtersMenu=new Common.UI.Menu({items:[this.miSortLow2High,this.miSortHigh2Low,this.miSortOptions,this.miSortCellColor,this.miSortFontColor,{caption:"--"},this.miLabelFilter,this.miValueFilter,this.miNumFilter,this.miTextFilter,this.miDateFilter,this.miFilterCellColor,this.miFilterFontColor,this.miClear,this.miReapplySeparator,this.miReapply]});function o(t){i._skipCheckDocumentClick||$(t.target).closest(".filter-dlg").length<=0&&i.close()}t=this.$window.find("#menu-container-filters");this.filtersMenu.render(t),this.filtersMenu.cmpEl.attr({tabindex:"-1"}),this.mnuSortColorCellsPicker=new Common.UI.ColorPaletteExt({el:$("#filter-dlg-sort-cells-color"),colors:[]}),this.mnuSortColorCellsPicker.on("select",_.bind(this.onSortColorSelect,this,Asc.c_oAscSortOptions.ByColorFill)),this.mnuSortColorFontPicker=new Common.UI.ColorPaletteExt({el:$("#filter-dlg-sort-font-color"),colors:[]}),this.mnuSortColorFontPicker.on("select",_.bind(this.onSortColorSelect,this,Asc.c_oAscSortOptions.ByColorFont)),this.mnuFilterColorCellsPicker=new Common.UI.ColorPaletteExt({el:$("#filter-dlg-filter-cells-color"),colors:[]}),this.mnuFilterColorCellsPicker.on("select",_.bind(this.onFilterColorSelect,this,!0)),this.mnuFilterColorFontPicker=new Common.UI.ColorPaletteExt({el:$("#filter-dlg-filter-font-color"),colors:[]}),this.mnuFilterColorFontPicker.on("select",_.bind(this.onFilterColorSelect,this,!1)),this.input=new Common.UI.InputField({el:$("#id-sd-cell-search",this.$window),allowBlank:!0,placeHolder:this.txtEmpty,validateOnChange:!0,validation:function(){return!0}}).on("changing",function(t,e){e.length?(e=e.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1"),i.filter=new RegExp(e,"ig")):i.filter=void 0,i.setupDataCells()}),this.cells=new Common.UI.TreeViewStore,this.filterExcludeCells=new Common.UI.TreeViewStore,this.cells&&(this.cellsList=new Common.UI.TreeView({el:$("#id-dlg-filter-values",this.$window),store:this.cells,tabindex:1,enableKeyEvents:!0,template:_.template(['<div class="treeview inner" style="height:auto;"></div>'].join("")),itemTemplate:_.template(['<% if (typeof isDate !=="undefined" && isDate) { %>','<div class="tree-item date <% if (!isVisible) { %>hidden<% } %>" style="display: block;'+(Common.UI.isRTL()?"padding-right":"padding-left")+': <%= level*16 + 22 %>px;">',"<% if (hasSubItems) { %>",'<i class="icon toolbar__icon btn-tree-caret <% if (!isExpanded) { %>up<% } %>" style="'+(Common.UI.isRTL()?"margin-right":"margin-left")+':<%= level*16 %>px;"></i>',"<% } %>",'<div class="name not-header">','<label class="checkbox-indeterminate" style="position:absolute;">','<input id="afcheckbox-<%= id %>" type="checkbox" class="button__checkbox">','<label for="afcheckbox-<%= id %>" class="checkbox__shape"></label>',"</label>",'<div id="<%= id %>" class="tree-label margin-left-20" style="pointer-events: none; display: flex;">','<div style="flex-grow: 1;"><%= Common.Utils.String.htmlEncode(dateValue) %></div>',"</div>","</div>","</div>","<% } else { %>",'<div class="tree-item">','<div class="name not-header">','<label class="checkbox-indeterminate" style="position:absolute;">','<input id="afcheckbox-<%= id %>" type="checkbox" class="button__checkbox">','<label for="afcheckbox-<%= id %>" class="checkbox__shape"></label>',"</label>",'<div id="<%= id %>" class="tree-label margin-left-20" style="pointer-events:none; display: flex;">','<div style="flex-grow: 1;"><%= Common.Utils.String.htmlEncode(value) %></div>','<% if (typeof count !=="undefined" && count) { %>','<div class="margin-left-10" style="word-break: normal; color: #afafaf;"><%= count%></div>',"<% } %>","</div>","</div>","</div>","<% } %>"].join(""))}),this.cellsList.store.comparator=function(t,e){var i,s,o;return"0"==t.get("groupid")?-1:"0"==e.get("groupid")?1:"2"==t.get("groupid")?-1:"2"==e.get("groupid")?1:t.get("isDate")||e.get("isDate")?0:(o=void 0!==(i=t.get("intval")))!=(void 0!==(s=e.get("intval")))?o?-1:1:(!o&&(i=t.get("cellvalue").toLowerCase())&&(s=e.get("cellvalue").toLowerCase()),i===s?0:""===s||""!==i&&i<s?-1:1)},this.cellsList.on({"item:change":this.onItemChanged.bind(this),"item:add":this.onItemChanged.bind(this),"item:select":this.onCellCheck.bind(this)}),this.cellsList.onKeyDown=_.bind(this.onListKeyDown,this)),this.setupDataCells(),this._setDefaults();this.on("close",function(){$(document.body).off("mousedown",o)}),_.delay(function(){$(document.body).on("mousedown",o)},100,this),this.cellsList.scroller.update({minScrollbarLength:this.cellsList.minScrollbarLength,alwaysVisibleY:!0,suppressScrollX:!0})},show:function(t,e){Common.UI.Window.prototype.show.call(this,t,e);var i=this;this.input&&_.delay(function(){i.input.focus()},500,this)},onBtnClick:function(t){t.currentTarget.attributes&&t.currentTarget.attributes.result&&"cancel"===t.currentTarget.attributes.result.value&&this.close()},onApplyFilter:function(){this.testFilter()&&(this.save(),this.close())},onSortType:function(t){this.api&&this.configTo&&this.api.asc_sortColFilter(t,this.configTo.asc_getCellId(),this.configTo.asc_getDisplayName()),this.close()},onSortOptions:function(){var t=this,e=new SSE.Views.SortFilterDialog({api:this.api}).on({close:function(){t.close()}});this.close(),e.setSettings({filter:this.configTo}),e.show()},onNumCustomFilterItemClick:function(t){var e,i,s,o=this.configTo.asc_getFilterObj(),n="",a="",l=Asc.c_oAscCustomAutoFilter.equals,r=0,c=!0,d=(o.asc_getType()==Asc.c_oAscAutoFilterTypes.CustomFilters&&(i=(e=o.asc_getFilter()).asc_getCustomFilters(),c=e.asc_getAnd(),l=i[0].asc_getOperator(),r=1<i.length&&i[1].asc_getOperator()||0,n=null===i[0].asc_getVal()?"":i[0].asc_getVal(),a=!(1<i.length)||null===i[1].asc_getVal()?"":i[1].asc_getVal()),-1!==t.value&&((e=new Asc.CustomFilters).asc_setCustomFilters(-2==t.value||-3==t.value?[new Asc.CustomFilter,new Asc.CustomFilter]:[new Asc.CustomFilter]),(i=e.asc_getCustomFilters())[0].asc_setOperator(-2==t.value?Asc.c_oAscCustomAutoFilter.isGreaterThanOrEqualTo:-3==t.value?Asc.c_oAscCustomAutoFilter.isLessThan:t.value),-2==t.value?(s=l==Asc.c_oAscCustomAutoFilter.isGreaterThanOrEqualTo&&r==Asc.c_oAscCustomAutoFilter.isLessThanOrEqualTo,e.asc_setAnd(!s||c),i[0].asc_setVal(s?n:""),i[1].asc_setOperator(Asc.c_oAscCustomAutoFilter.isLessThanOrEqualTo),i[1].asc_setVal(s?a:"")):-3==t.value?(s=l==Asc.c_oAscCustomAutoFilter.isLessThan&&r==Asc.c_oAscCustomAutoFilter.isGreaterThan,e.asc_setAnd(s&&c),i[0].asc_setVal(s?n:""),i[1].asc_setOperator(Asc.c_oAscCustomAutoFilter.isGreaterThan),i[1].asc_setVal(s?a:"")):(e.asc_setAnd(!0),i[0].asc_setVal(t.value==l?n:"")),o.asc_setFilter(e),o.asc_setType(Asc.c_oAscAutoFilterTypes.CustomFilters)),this),r=("label"==t.options.pivottype||"value"==t.options.pivottype?new SSE.Views.PivotDigitalFilterDialog({api:this.api,type:t.options.pivottype}):new SSE.Views.DigitalFilterDialog({api:this.api,type:"number"})).on({close:function(){d.close()}});this.close(),r.setSettings(this.configTo),r.show()},onTextFilterMenuClick:function(t,e){var i,s=this.configTo.asc_getFilterObj(),o="",n=Asc.c_oAscCustomAutoFilter.equals,a=(s.asc_getType()==Asc.c_oAscAutoFilterTypes.CustomFilters&&(l=(i=s.asc_getFilter()).asc_getCustomFilters(),i.asc_getAnd(),n=l[0].asc_getOperator(),1<l.length&&l[1].asc_getOperator(),o=null===l[0].asc_getVal()?"":l[0].asc_getVal(),!(1<l.length)||null===l[1].asc_getVal()||l[1].asc_getVal()),-1!==e.value&&((i=new Asc.CustomFilters).asc_setCustomFilters([new Asc.CustomFilter]),l=i.asc_getCustomFilters(),i.asc_setAnd(!0),l[0].asc_setOperator(e.value),l[0].asc_setVal(e.value==n?o:""),s.asc_setFilter(i),s.asc_setType(Asc.c_oAscAutoFilterTypes.CustomFilters)),this),l=("label"==e.options.pivottype||"value"==e.options.pivottype?new SSE.Views.PivotDigitalFilterDialog({api:this.api,type:e.options.pivottype}):new SSE.Views.DigitalFilterDialog({api:this.api,type:"text"})).on({close:function(){a.close()}});this.close(),l.setSettings(this.configTo),l.show()},onDataFilterMenuClick:function(t){var e,i,s=this.configTo.asc_getFilterObj(),o="",n="",a=Asc.c_oAscCustomAutoFilter.equals,l=0,r=!0,c=(s.asc_getType()==Asc.c_oAscAutoFilterTypes.CustomFilters&&(i=(e=s.asc_getFilter()).asc_getCustomFilters(),r=e.asc_getAnd(),a=i[0].asc_getOperator(),l=1<i.length&&i[1].asc_getOperator()||0,o=null===i[0].asc_getVal()?"":i[0].asc_getVal(),n=!(1<i.length)||null===i[1].asc_getVal()?"":i[1].asc_getVal()),-1!==t.value&&((e=new Asc.CustomFilters).asc_setCustomFilters(-2==t.value||-3==t.value?[new Asc.CustomFilter,new Asc.CustomFilter]:[new Asc.CustomFilter]),(i=e.asc_getCustomFilters())[0].asc_setOperator(-2==t.value?Asc.c_oAscCustomAutoFilter.isGreaterThanOrEqualTo:-3==t.value?Asc.c_oAscCustomAutoFilter.isLessThan:t.value),-2==t.value?(l=a==Asc.c_oAscCustomAutoFilter.isGreaterThanOrEqualTo&&l==Asc.c_oAscCustomAutoFilter.isLessThanOrEqualTo,e.asc_setAnd(!l||r),i[0].asc_setVal(l?o:""),i[1].asc_setOperator(Asc.c_oAscCustomAutoFilter.isLessThanOrEqualTo),i[1].asc_setVal(l?n:"")):(e.asc_setAnd(!0),i[0].asc_setVal(t.value==a?o:"")),s.asc_setFilter(e),s.asc_setType(Asc.c_oAscAutoFilterTypes.CustomFilters)),this),r=new SSE.Views.DigitalFilterDialog({api:this.api,type:"date"}).on({close:function(){c.close()}});this.close(),r.setSettings(this.configTo),r.show()},onNumDynamicFilterItemClick:function(t){var e=this.configTo.asc_getFilterObj();e.asc_getType()!==Asc.c_oAscAutoFilterTypes.DynamicFilter&&(e.asc_setFilter(new Asc.DynamicFilter),e.asc_setType(Asc.c_oAscAutoFilterTypes.DynamicFilter)),e.asc_getFilter().asc_setType(t.value),this.api.asc_applyAutoFilter(this.configTo),this.close()},onTop10FilterItemClick:function(t){var e=this,t=new SSE.Views.Top10FilterDialog({api:this.api,type:t.options.pivottype}).on({close:function(){e.close()}});this.close(),t.setSettings(this.configTo),t.show()},onLabelFilterMenuClick:function(t,e){e.value==Asc.c_oAscCustomAutoFilter.isGreaterThan||e.value==Asc.c_oAscCustomAutoFilter.isGreaterThanOrEqualTo||e.value==Asc.c_oAscCustomAutoFilter.isLessThan||e.value==Asc.c_oAscCustomAutoFilter.isLessThanOrEqualTo||-2==e.value||-3==e.value?this.onNumCustomFilterItemClick(e):this.onTextFilterMenuClick(t,e)},onValueFilterMenuClick:function(t,e){var i=this;this.configTo.asc_getPivotObj().asc_getDataFields().length<2?Common.UI.warning({title:this.textWarning,msg:this.warnFilterError,callback:function(){_.delay(function(){i.close()},10)}}):e.options.type==Asc.c_oAscAutoFilterTypes.CustomFilters?this.onNumCustomFilterItemClick(e):this.onTop10FilterItemClick(e)},onFilterColorSelect:function(t,e,i){var s=this.configTo.asc_getFilterObj(),s=(s.asc_getType()!==Asc.c_oAscAutoFilterTypes.ColorFilter&&(s.asc_setFilter(new Asc.ColorFilter),s.asc_setType(Asc.c_oAscAutoFilterTypes.ColorFilter)),s.asc_getFilter());s.asc_setCellColor(!!t&&null),s.asc_setCColor(t&&"transparent"==i||!t&&"#000000"==i?null:Common.Utils.ThemeColor.getRgbColor(i)),this.api.asc_applyAutoFilter(this.configTo),this.close()},onSortColorSelect:function(t,e,i){var s;this.api&&this.configTo&&(s=t==Asc.c_oAscSortOptions.ByColorFill,this.api.asc_sortColFilter(t,this.configTo.asc_getCellId(),this.configTo.asc_getDisplayName(),s&&"transparent"==i||!s&&"#000000"==i?null:Common.Utils.ThemeColor.getRgbColor(i))),this.close()},onCellCheck:function(t,e,i){var s,o,n,a,l;this.checkCellTrigerBlock||(l="",s=!1,n=null,(o=window.event||window._event)&&((l=$(o.currentTarget).find(".tree-label")).length&&(n=l.get(0).getBoundingClientRect(),l=o.clientX*Common.Utils.zoom(),a=o.clientY*Common.Utils.zoom(),n.left<l&&l<n.right&&n.top<a&&a<n.bottom&&(s=!0)),(s||o.target.className.match("checkbox")&&"input"!==o.target.localName)&&(this.updateCellCheck(t,i),_.delay(function(){t.focus()},100,this))))},onListKeyDown:function(t,e){var i=this.cellsList;i.disabled||((e=_.isUndefined(void 0)?t:e).keyCode==Common.UI.Keys.SPACE?(e.preventDefault(),e.stopPropagation(),this.updateCellCheck(i,i.getSelectedRec())):Common.UI.TreeView.prototype.onKeyDown.call(this.cellsList,t,e))},updateDateLevelCheck:function(t){var e,i,s=t||this.cells.at(this.cells.length-1).get("check"),o=[],n=-1,a=[];for(this.dateTimeGroup=[],e=this.cells.length-1;0<=e;e--)if((i=this.cells.at(e)).get("isDate")){0===n&&(o=[o[n]]);var l=i.get("level"),r=i.get("check"),c=i.get("throughIndex");if(n<l)(o=0<n?o.slice(0,n+1):o)[l]=r,a.push(c);else if(l===n)a.push(c),r!==o[l]&&(o[l]="indeterminate");else if(l<n){if(0<a.length&&("indeterminate"===o[n]||0===l)){for(var d="indeterminate"===o[n]?n:0,h=0;h<a.length;h++)this.dateTimeGroup[a[h]]=d;a.length=0}i.set("check",o[n]),void 0!==o[l]&&o[n]!==o[l]?o[l]="indeterminate":void 0===o[l]&&(o[l]=o[n])}n=l}else"0"===i.get("groupid")&&"indeterminate"!==s?s=o[0]:"1"===i.get("groupid")&&i.get("check")!==s&&(s="indeterminate");this.checkCellTrigerBlock=!0,this.cells.at(0).set("check",s),this.checkCellTrigerBlock=void 0},updateCellCheck:function(t,e){if(e&&t){var i=!e.get("check"),s=this.filter?this.filteredIndexes:this.throughIndexes;if("0"==e.get("groupid"))this.cells.each(function(t){"2"!==t.get("groupid")&&(t.set("check",i),1<t.get("throughIndex")&&(s[parseInt(t.get("throughIndex"))]=i))});else{e.set("check",i);var o,n=i;if(s[parseInt(e.get("throughIndex"))]=i,e.get("isDate")){for(var a=e.get("level"),l=e.get("fullDate").slice(0,a+1),r=0;r<this.cells.length;r++)"1"==(o=this.cells.at(r)).get("groupid")&&o.get("isDate")&&o.get("level")>a&&l.toString()===o.get("fullDate").slice(0,a+1).toString()&&(o.set("check",i),s[parseInt(o.get("throughIndex"))]=i);this.updateDateLevelCheck(i)}else{for(r=0;r<this.cells.length;r++)if("1"==(o=this.cells.at(r)).get("groupid")&&o.get("check")!==i){n="indeterminate";break}this.checkCellTrigerBlock=!0,this.cells.at(0).set("check",n),this.checkCellTrigerBlock=void 0}}this.btnOk.setDisabled(!1),this.configTo.asc_getFilterObj().asc_setType(Asc.c_oAscAutoFilterTypes.Filters),t.scroller.update({minScrollbarLength:t.minScrollbarLength,alwaysVisibleY:!0,suppressScrollX:!0})}},onClear:function(){this.api&&this.configTo&&this.api.asc_clearFilterColumn(this.configTo.asc_getCellId(),this.configTo.asc_getDisplayName()),this.close()},onReapply:function(){this.api&&this.configTo&&this.api.asc_reapplyAutoFilter(this.config.asc_getDisplayName()),this.close()},setSettings:function(t){this.config=t,this.configTo=t},_setDefaults:function(){this.initialFilterType=this.configTo.asc_getFilterObj().asc_getType();var i,s,o,n,t,a,e=this.$window.find(".menu-panel"),l=this.configTo.asc_getPivotObj(),r=!!l,c=!1,d=(this.miValueFilter.setVisible(r),this.miLabelFilter.setVisible(r),this.miSortOptions.setVisible(r),r&&(this.miReapplySeparator.setVisible(!1),this.miReapply.setVisible(!1),c=0!==l.asc_getDataFieldIndexFilter()),this.configTo.asc_getFilterObj()),h=this.initialFilterType===Asc.c_oAscAutoFilterTypes.CustomFilters,p=this.initialFilterType===Asc.c_oAscAutoFilterTypes.DynamicFilter,m=this.initialFilterType===Asc.c_oAscAutoFilterTypes.Top10,u=this.configTo.asc_getIsTextFilter(),g=this.configTo.asc_getIsDateFilter(),b=this.configTo.asc_getColorsFill(),C=this.configTo.asc_getColorsFont(),f=this.configTo.asc_getSortState(),S=(S=this.configTo.asc_getSortColor())&&Common.Utils.ThemeColor.getHexColor(S.get_r(),S.get_g(),S.get_b()).toLocaleUpperCase(),v=(this.miTextFilter.setVisible(!r&&u),this.miDateFilter.setVisible(!r&&g),this.miNumFilter.setVisible(!r&&!u&&!g),this.miTextFilter.setChecked(h&&u,!0),this.miNumFilter.setChecked((h||p||m)&&!u,!0),this.miDateFilter.setChecked((p||h)&&g,!0),this.miValueFilter.setChecked(r&&c,!0),this.miLabelFilter.setChecked(r&&!c&&(h||m),!0),this.miSortLow2High.setChecked(f==Asc.c_oAscSortOptions.Ascending,!0),this.miSortHigh2Low.setChecked(f==Asc.c_oAscSortOptions.Descending,!0),C&&0<C.length),h=(this.miSortFontColor.setVisible(v),this.miFilterFontColor.setVisible(!r&&v),v&&(i=[],C.forEach(function(t,e){t?i.push(Common.Utils.ThemeColor.getHexColor(t.get_r(),t.get_g(),t.get_b()).toLocaleUpperCase()):i.push("000000")}),this.mnuSortColorFontPicker.updateColors(i),this.mnuFilterColorFontPicker.updateColors(i),this.miFilterFontColor.setChecked(!1,!0),this.miSortFontColor.setChecked(f==Asc.c_oAscSortOptions.ByColorFont,!0),f==Asc.c_oAscSortOptions.ByColorFont&&this.mnuSortColorFontPicker.select(S||"000000",!0)),v=b&&0<b.length,this.miSortCellColor.setVisible(v),this.miFilterCellColor.setVisible(!r&&v),v&&(i=[],b.forEach(function(t,e){t?i.push(Common.Utils.ThemeColor.getHexColor(t.get_r(),t.get_g(),t.get_b()).toLocaleUpperCase()):i.push("transparent")}),this.mnuSortColorCellsPicker.updateColors(i),this.mnuFilterColorCellsPicker.updateColors(i),this.miFilterCellColor.setChecked(!1,!0),this.miSortCellColor.setChecked(f==Asc.c_oAscSortOptions.ByColorFill,!0),f==Asc.c_oAscSortOptions.ByColorFill&&this.mnuSortColorCellsPicker.select(S||"transparent",!0)),h?(v=(C=d.asc_getFilter()).asc_getCustomFilters(),C.asc_getAnd(),s=v[0].asc_getOperator(),b=1<v.length&&v[1].asc_getOperator()||0,t=(r?c?this.miValueFilter:this.miLabelFilter:u?this.miTextFilter:g?this.miDateFilter:this.miNumFilter).menu.items,o=!0,1==v.length?t.forEach(function(t){var e=t.options.type==Asc.c_oAscAutoFilterTypes.CustomFilters&&t.value==s;t.setChecked(e,!0),e&&(o=!1)}):!r&&u||s!=Asc.c_oAscCustomAutoFilter.isGreaterThanOrEqualTo||b!=Asc.c_oAscCustomAutoFilter.isLessThanOrEqualTo?r&&s==Asc.c_oAscCustomAutoFilter.isLessThan&&b==Asc.c_oAscCustomAutoFilter.isGreaterThan&&(t[c?7:14].setChecked(!0,!0),o=!1):(t[g?3:r&&!c?13:6].setChecked(!0,!0),o=!1),o&&t[t.length-1].setChecked(!0,!0)):this.initialFilterType===Asc.c_oAscAutoFilterTypes.ColorFilter?(S=(S=(f=d.asc_getFilter()).asc_getCColor())&&Common.Utils.ThemeColor.getHexColor(S.get_r(),S.get_g(),S.get_b()).toLocaleUpperCase(),null===f.asc_getCellColor()?(this.miFilterCellColor.setChecked(!0,!0),this.mnuFilterColorCellsPicker.select(S||"transparent",!0)):!1===f.asc_getCellColor()&&(this.miFilterFontColor.setChecked(!0,!0),this.mnuFilterColorFontPicker.select(S||"000000",!0))):(p||m)&&(n=p?d.asc_getFilter().asc_getType():null,(t=(r?this.miValueFilter:g?this.miDateFilter:this.miNumFilter).menu.items).forEach(function(t){t.setChecked(p&&t.options.type==Asc.c_oAscAutoFilterTypes.DynamicFilter&&t.value==n||m&&t.options.type==Asc.c_oAscAutoFilterTypes.Top10,!0)}),g&&!this.miDateFilter.menu.getChecked()&&(a=!1,(t=this.miDatesInThePeriod.menu.items).forEach(function(t){var e=t.value==n;t.setChecked(e,!0),e&&(a=!0)}),a&&this.miDateFilter.menu.items[20].setChecked(a,!0))),this.miClear.setDisabled(this.initialFilterType===Asc.c_oAscAutoFilterTypes.None),this.miReapply.setDisabled(this.initialFilterType===Asc.c_oAscAutoFilterTypes.None),this.btnOk.setDisabled(this.initialFilterType!==Asc.c_oAscAutoFilterTypes.Filters&&this.initialFilterType!==Asc.c_oAscAutoFilterTypes.None),this.menuPanelWidth=e.innerWidth(),this.getWidth());h-this.menuPanelWidth<260&&(h=Math.ceil(this.menuPanelWidth+260),this.setResizable(!0,[h,this.initConfig.minheight])),Common.Utils.InternalSettings.get("sse-settings-size-filter-window")&&(h=Common.Utils.InternalSettings.get("sse-settings-size-filter-window")[0]+this.menuPanelWidth),r&&l.asc_getIsPageFilter()&&(this.setResizable(!0,[this.initConfig.minwidth-this.menuPanelWidth,this.initConfig.minheight]),e.addClass("hidden"),h-=this.menuPanelWidth,this.menuPanelWidth=0),this.setSize(h,this.getHeight())},setupDataCells:function(){var m,u,g,b,C,f=this,S=0,v=2,w=!0,t=!1,_=0,x=[],y=[],A=f.filter?f.filteredIndexes:f.throughIndexes,T=f.configTo.asc_getTimeFormat(),k=[this.txtJanuary,this.txtFebruary,this.txtMarch,this.txtApril,this.txtMay,this.txtJune,this.txtJuly,this.txtAugust,this.txtSeptember,this.txtOctober,this.txtNovember,this.txtDecember],E=0,I=0;this.configTo.asc_getValues().forEach(function(t){u=t.asc_getText(),d=u,m=!isNaN(parseFloat(d))&&isFinite(d),w=!0,g=t.asc_getRepeats?t.asc_getRepeats():void 0;var e,i,s,o,n,a,l,r,c,d=t.asc_getIsDateFormat(),h="";if(d&&(b=!0,f.filter&&0===S&&(S+=1),s=t.asc_getYear(),o=t.asc_getMonth(),n=t.asc_getDay(),a=t.asc_getHour(),l=t.asc_getMinute(),r=t.asc_getSecond(),(c=T?(e=[s,o,n,a,l,r],[s,o,n,a||"00",":"+(l||"00"),":"+(r||"00")]):(e=[s,o,n]).slice()).forEach(function(t,e){h+=1===e?k[t]:t}),a=function(t,e){var i=0;if(t)for(var s=0;s<t.length;s++)if(t[s]!==e[s]){i=s;break}return i}(C,e),i=e.length-1),f.filter?(null===(d?h:u).match(f.filter)&&(w=!1),A[v]=w):null==A[v]&&(A[v]=t.asc_getVisible()),w)if(d){0===a?(E+=1,I+=1):1===a&&(I+=1);for(var p=a;p<=i;p++)S+=1,x.push(new Common.UI.TreeViewModel({id:S,selected:!1,allowSelected:!0,cellvalue:u,value:u,groupid:"1",check:A[v],throughIndex:v,count:g?g.toString():"",isDate:!0,fullDate:e,dateValue:1===p?k[c[p]]:c[p],level:p,index:S,hasParent:0<p,hasSubItems:p<i,isVisible:0===p,isExpanded:!1})),A[v]&&_++;C=e}else x.push(new Common.UI.TreeViewModel({id:++S,selected:!1,allowSelected:!0,cellvalue:u,value:m||0<u.length?u:f.textEmptyItem,intval:m?parseFloat(u):void 0,strval:m?"":u,groupid:"1",check:A[v],throughIndex:v,count:g?g.toString():""})),A[v]&&_++;else y.push(new Common.UI.TreeViewModel({cellvalue:u}));++v}),1===E&&x.forEach(function(t){var e;t.get("isDate")&&(e=t.get("level"),1<I?(t.set("isVisible",e<2),t.set("isExpanded",0===e)):(t.set("isVisible",e<3),t.set("isExpanded",e<2)))}),f.cellsList.cmpEl[0<E?"addClass":"removeClass"]("shifted-right"),_==x.length?t=!0:0<_&&(t="indeterminate"),!f.filter&&null!=A[0]||(A[0]=!0),(!f.filter||0<x.length)&&x.unshift(new Common.UI.TreeViewModel({id:++S,selected:!1,allowSelected:!0,value:f.filter?this.textSelectAllResults:this.textSelectAll,groupid:"0",check:A[0],throughIndex:0})),f.filter&&1<x.length&&(null==A[1]&&(A[1]=!1),x.splice(1,0,new Common.UI.TreeViewModel({id:++S,selected:!1,allowSelected:!0,value:this.textAddSelection,groupid:"2",check:A[1],throughIndex:1}))),this.cells.reset(x),this.filterExcludeCells.reset(y),this.cells.length&&(b&&_!==x.length?this.updateDateLevelCheck():(this.checkCellTrigerBlock=!0,this.cells.at(0).set("check",t),this.checkCellTrigerBlock=void 0)),this.btnOk.setDisabled(this.cells.length<1),this.cellsList.scroller.update({minScrollbarLength:this.cellsList.minScrollbarLength,alwaysVisibleY:!0,suppressScrollX:!0})},testFilter:function(){var t=this,e=!1;return this.cells&&(this.filter&&this.filteredIndexes[1]?e=!0:this.cells.forEach(function(t){if("1"==t.get("groupid")&&t.get("check"))return e=!0})),e||(t._skipCheckDocumentClick=!0,Common.UI.warning({title:this.textWarning,msg:this.warnNoSelected,callback:function(){t._skipCheckDocumentClick=!1,_.delay(function(){t.input.focus()},100,this)}})),e},save:function(){var e,i,s,o,t;this.api&&this.configTo&&this.cells&&this.filterExcludeCells&&(e=this.configTo.asc_getValues(),i=!1,(s=this).filter&&this.filteredIndexes[1]?(this.initialFilterType===Asc.c_oAscAutoFilterTypes.CustomFilters&&e.forEach(function(t,e){t.asc_setVisible(!0)}),this.cells.each(function(t){"1"==t.get("groupid")&&e[parseInt(t.get("throughIndex"))-2].asc_setVisible(t.get("check"))}),e.forEach(function(t,e){if(t.asc_getVisible())return i=!0})):(o=this.filter?this.filteredIndexes:this.throughIndexes,e.forEach(function(t,e){if(t.asc_setVisible(o[e+2]),t.asc_getIsDateFormat()){var i;switch(s.dateTimeGroup[e+2]){case 0:i=Asc.EDateTimeGroup.datetimegroupYear;break;case 1:i=Asc.EDateTimeGroup.datetimegroupMonth;break;case 2:i=Asc.EDateTimeGroup.datetimegroupDay;break;case 3:i=Asc.EDateTimeGroup.datetimegroupHour;break;case 4:i=Asc.EDateTimeGroup.datetimegroupMinute;break;case 5:i=Asc.EDateTimeGroup.datetimegroupSecond}t.asc_setDateTimeGrouping(i)}}),i=!0),i&&((t=this.configTo.asc_getPivotObj())&&t.asc_getIsPageFilter()&&t.asc_setIsMultipleItemSelectionAllowed(!0),this.configTo.asc_getFilterObj().asc_setType(Asc.c_oAscAutoFilterTypes.Filters),this.api.asc_applyAutoFilter(this.configTo)))},onPrimary:function(){return this.save(),this.close(),!1},onWindowResize:function(t){t&&"start"==t[1]?this.curSize={resize:!1,height:this.getSize()[1]}:this.curSize.resize&&(this.getSize(),this.cellsList.scroller.update({minScrollbarLength:this.cellsList.minScrollbarLength,alwaysVisibleY:!0,suppressScrollX:!0}))},onWindowResizing:function(){var t;this.curSize&&((t=this.getSize())[1]!==this.curSize.height&&(this.curSize.resize||(this.curSize.resize=!0,this.cellsList.scroller.update({minScrollbarLength:this.cellsList.minScrollbarLength,alwaysVisibleY:!1,suppressScrollX:!0})),this.curSize.height=t[1]),t[0]-=this.menuPanelWidth,Common.Utils.InternalSettings.set("sse-settings-size-filter-window",t))},onItemChanged:function(t,e){var i=e.model.get("check");"indeterminate"==i?$("input[type=checkbox]",e.$el).prop("indeterminate",!0):$("input[type=checkbox]",e.$el).prop({checked:i,indeterminate:!1})}},SSE.Views.AutoFilterDialog||{}))}),define("spreadsheeteditor/main/app/view/SpecialPasteDialog",["common/main/lib/util/utils","common/main/lib/component/RadioBox","common/main/lib/component/CheckBox","common/main/lib/view/AdvancedSettingsWindow"],function(){"use strict";SSE.Views.SpecialPasteDialog=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:350,height:400},initialize:function(t){_.extend(this.options,{title:this.textTitle,template:['<div class="box" style="height:'+(this.options.height-85)+'px;">','<div class="content-panel" style="padding: 0 5px;"><div class="inner-content">','<div class="settings-panel active">','<table cols="2" style="width: 100%;">',"<tr>",'<td colspan=2 class="padding-small">','<label class="header">',this.textPaste,"</label>","</td>","</tr>","<tr>",'<td class="padding-small">','<div id="paste-radio-all"></div>',"</td>",'<td class="padding-small">','<div id="paste-radio-without-borders"></div>',"</td>","</tr>","<tr>",'<td class="padding-small">','<div id="paste-radio-formulas"></div>',"</td>",'<td class="padding-small">','<div id="paste-radio-formula-formats"></div>',"</td>","</tr>","<tr>",'<td class="padding-small">','<div id="paste-radio-values"></div>',"</td>",'<td class="padding-small">','<div id="paste-radio-formula-col-width"></div>',"</td>","</tr>","<tr>",'<td class="padding-small">','<div id="paste-radio-formats"></div>',"</td>",'<td class="padding-small">','<div id="paste-radio-formula-num-format"></div>',"</td>","</tr>","<tr>",'<td class="padding-small">','<div id="paste-radio-comments"></div>',"</td>",'<td class="padding-small">','<div id="paste-radio-value-num-format"></div>',"</td>","</tr>","<tr>",'<td class="padding-large">','<div id="paste-radio-col-width"></div>',"</td>",'<td class="padding-large">','<div id="paste-radio-value-formats"></div>',"</td>","</tr>","<tr>",'<td colspan=2 class="padding-small">','<label class="header">',this.textOperation,"</label>","</td>","</tr>","<tr>",'<td class="padding-small">','<div id="paste-radio-none"></div>',"</td>",'<td class="padding-small">','<div id="paste-radio-mult"></div>',"</td>","</tr>","<tr>",'<td class="padding-small">','<div id="paste-radio-add"></div>',"</td>",'<td class="padding-small">','<div id="paste-radio-div"></div>',"</td>","</tr>","<tr>",'<td class="padding-small">','<div id="paste-radio-sub"></div>',"</td>",'<td class="padding-small">',"</td>","</tr>","<tr>",'<td colspan=2 class="padding-small" style="border-top: 1px solid #cbcbcb;">',"</td>","</tr>","<tr>",'<td class="padding-small">','<div id="paste-checkbox-blanks"></div>',"</td>",'<td class="padding-small">','<div id="paste-checkbox-transpose"></div>',"</td>","</tr>","</table>","</div></div>","</div>","</div>"].join("")},t),this.handler=t.handler,this.props=t.props,this._changedProps=null,this.isTable=!!t.isTable,Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);this.propControls=[],this.radioAll=new Common.UI.RadioBox({el:$("#paste-radio-all"),name:"asc-radio-paste",labelText:this.textAll,value:Asc.c_oSpecialPasteProps.paste,disabled:!0}),this.radioAll.on("change",_.bind(this.onRadioPasteChange,this)),this.propControls[Asc.c_oSpecialPasteProps.paste]=this.radioAll,this.radioFormulas=new Common.UI.RadioBox({el:$("#paste-radio-formulas"),name:"asc-radio-paste",labelText:this.textFormulas,value:Asc.c_oSpecialPasteProps.pasteOnlyFormula,disabled:!0}),this.radioFormulas.on("change",_.bind(this.onRadioPasteChange,this)),this.propControls[Asc.c_oSpecialPasteProps.pasteOnlyFormula]=this.radioFormulas,this.radioValues=new Common.UI.RadioBox({el:$("#paste-radio-values"),name:"asc-radio-paste",labelText:this.textValues,value:Asc.c_oSpecialPasteProps.pasteOnlyValues,disabled:!0}),this.radioValues.on("change",_.bind(this.onRadioPasteChange,this)),this.propControls[Asc.c_oSpecialPasteProps.pasteOnlyValues]=this.radioValues,this.radioFormats=new Common.UI.RadioBox({el:$("#paste-radio-formats"),name:"asc-radio-paste",labelText:this.textFormats,value:Asc.c_oSpecialPasteProps.pasteOnlyFormating,disabled:!0}),this.radioFormats.on("change",_.bind(this.onRadioPasteChange,this)),this.propControls[Asc.c_oSpecialPasteProps.pasteOnlyFormating]=this.radioFormats,this.radioComments=new Common.UI.RadioBox({el:$("#paste-radio-comments"),name:"asc-radio-paste",labelText:this.textComments,value:Asc.c_oSpecialPasteProps.comments,disabled:!0}),this.radioComments.on("change",_.bind(this.onRadioPasteChange,this)),this.propControls[Asc.c_oSpecialPasteProps.comments]=this.radioComments,this.radioColWidth=new Common.UI.RadioBox({el:$("#paste-radio-col-width"),name:"asc-radio-paste",labelText:this.textColWidth,value:Asc.c_oSpecialPasteProps.columnWidth,disabled:!0}),this.radioColWidth.on("change",_.bind(this.onRadioPasteChange,this)),this.propControls[Asc.c_oSpecialPasteProps.columnWidth]=this.radioColWidth,this.radioWBorders=new Common.UI.RadioBox({el:$("#paste-radio-without-borders"),name:"asc-radio-paste",labelText:this.textWBorders,value:Asc.c_oSpecialPasteProps.formulaWithoutBorders,disabled:!0}),this.radioWBorders.on("change",_.bind(this.onRadioPasteChange,this)),this.propControls[Asc.c_oSpecialPasteProps.formulaWithoutBorders]=this.radioWBorders,this.radioFFormat=new Common.UI.RadioBox({el:$("#paste-radio-formula-formats"),name:"asc-radio-paste",labelText:this.textFFormat,value:Asc.c_oSpecialPasteProps.formulaAllFormatting,disabled:!0}),this.radioFFormat.on("change",_.bind(this.onRadioPasteChange,this)),this.propControls[Asc.c_oSpecialPasteProps.formulaAllFormatting]=this.radioFFormat,this.radioFWidth=new Common.UI.RadioBox({el:$("#paste-radio-formula-col-width"),name:"asc-radio-paste",labelText:this.textFWidth,value:Asc.c_oSpecialPasteProps.formulaColumnWidth,disabled:!0}),this.radioFWidth.on("change",_.bind(this.onRadioPasteChange,this)),this.propControls[Asc.c_oSpecialPasteProps.formulaColumnWidth]=this.radioFWidth,this.radioFNFormat=new Common.UI.RadioBox({el:$("#paste-radio-formula-num-format"),name:"asc-radio-paste",labelText:this.textFNFormat,value:Asc.c_oSpecialPasteProps.formulaNumberFormat,disabled:!0}),this.radioFNFormat.on("change",_.bind(this.onRadioPasteChange,this)),this.propControls[Asc.c_oSpecialPasteProps.formulaNumberFormat]=this.radioFNFormat,this.radioVNFormat=new Common.UI.RadioBox({el:$("#paste-radio-value-num-format"),name:"asc-radio-paste",labelText:this.textVNFormat,value:Asc.c_oSpecialPasteProps.valueNumberFormat,disabled:!0}),this.radioVNFormat.on("change",_.bind(this.onRadioPasteChange,this)),this.propControls[Asc.c_oSpecialPasteProps.valueNumberFormat]=this.radioVNFormat,this.radioVFormat=new Common.UI.RadioBox({el:$("#paste-radio-value-formats"),name:"asc-radio-paste",labelText:this.textVFormat,value:Asc.c_oSpecialPasteProps.valueAllFormating,disabled:!0}),this.radioVFormat.on("change",_.bind(this.onRadioPasteChange,this)),this.propControls[Asc.c_oSpecialPasteProps.valueAllFormating]=this.radioVFormat,this.radioNone=new Common.UI.RadioBox({el:$("#paste-radio-none"),name:"asc-radio-paste-operation",labelText:this.textNone,value:Asc.c_oSpecialPasteOperation.none,checked:!0}),this.radioNone.on("change",_.bind(this.onRadioOperationChange,this)),this.radioAdd=new Common.UI.RadioBox({el:$("#paste-radio-add"),name:"asc-radio-paste-operation",labelText:this.textAdd,value:Asc.c_oSpecialPasteOperation.add}),this.radioAdd.on("change",_.bind(this.onRadioOperationChange,this)),this.radioMult=new Common.UI.RadioBox({el:$("#paste-radio-mult"),name:"asc-radio-paste-operation",labelText:this.textMult,value:Asc.c_oSpecialPasteOperation.multiply}),this.radioMult.on("change",_.bind(this.onRadioOperationChange,this)),this.radioSub=new Common.UI.RadioBox({el:$("#paste-radio-sub"),name:"asc-radio-paste-operation",labelText:this.textSub,value:Asc.c_oSpecialPasteOperation.subtract}),this.radioSub.on("change",_.bind(this.onRadioOperationChange,this)),this.radioDiv=new Common.UI.RadioBox({el:$("#paste-radio-div"),name:"asc-radio-paste-operation",labelText:this.textDiv,value:Asc.c_oSpecialPasteOperation.divide}),this.radioDiv.on("change",_.bind(this.onRadioOperationChange,this)),this.chBlanks=new Common.UI.CheckBox({el:$("#paste-checkbox-blanks"),labelText:this.textBlanks}),this.chTranspose=new Common.UI.CheckBox({el:$("#paste-checkbox-transpose"),labelText:this.textTranspose}),this.afterRender()},getFocusedComponents:function(){return[this.radioAll,this.radioFormulas,this.radioValues,this.radioFormats,this.radioComments,this.radioColWidth,this.radioWBorders,this.radioFFormat,this.radioFWidth,this.radioFNFormat,this.radioVNFormat,this.radioVFormat,this.radioNone,this.radioAdd,this.radioMult,this.radioSub,this.radioDiv,this.chBlanks,this.chTranspose]},getDefaultFocusableComponent:function(){return this.radioAll},afterRender:function(){this._setDefaults(this.props)},show:function(){Common.Views.AdvancedSettingsWindow.prototype.show.apply(this,arguments)},_setDefaults:function(t){var i=this;t&&_.each(t,function(t,e){i.propControls[t]&&i.propControls[t].setDisabled(!1)}),this._changedProps=new Asc.SpecialPasteProps,this._changedProps.asc_setProps(Asc.c_oSpecialPasteProps.paste),this._changedProps.asc_setOperation(Asc.c_oSpecialPasteOperation.none),this.radioAll.setValue(!0)},getSettings:function(){return this._changedProps&&(this._changedProps.asc_setTranspose("checked"==this.chTranspose.getValue()),this._changedProps.asc_setSkipBlanks("checked"==this.chBlanks.getValue())),this._changedProps},onDlgBtnClick:function(t){this._handleInput("object"==typeof t?t.currentTarget.attributes.result.value:t)},onPrimary:function(){return this._handleInput("ok"),!1},_handleInput:function(t){this.handler&&this.handler.call(this,t,"ok"==t?this.getSettings():void 0),this.close()},onRadioPasteChange:function(t,e,i){e&&this._changedProps&&(this._changedProps.asc_setProps(t.options.value),e=t.options.value==Asc.c_oSpecialPasteProps.pasteOnlyFormating||t.options.value==Asc.c_oSpecialPasteProps.comments||t.options.value==Asc.c_oSpecialPasteProps.columnWidth,t=this.isTable&&!!this._changedProps.asc_getTableAllowed(),this.radioNone.setDisabled(e||t),this.radioAdd.setDisabled(e||t),this.radioDiv.setDisabled(e||t),this.radioSub.setDisabled(e||t),this.radioMult.setDisabled(e||t),this.chBlanks.setDisabled(t),this.chTranspose.setDisabled(t))},onRadioOperationChange:function(t,e,i){e&&this._changedProps&&this._changedProps.asc_setOperation(t.options.value)}},SSE.Views.SpecialPasteDialog||{}))}),define("text!spreadsheeteditor/main/app/template/SlicerSettingsAdvanced.template",[],function(){return'<div id="id-adv-slicer-style" class="settings-panel active">\n    <div class="inner-content">\n        <div>\n            <div class="padding-small" style="display: inline-block;">\n                <label class="input-label"><%= scope.textHeader %></label>\n                <div id="sliceradv-text-header"></div>\n            </div>\n        </div>\n        <div class="padding-large" id="sliceradv-checkbox-header"></div>\n        <div class="padding-very-small"><label class="header"><%= scope.strStyle %></label></div>\n        <div class="padding-large">\n            <div id="sliceradv-btn-style" style="width: 100%;height: 52px;"></div>\n        </div>\n        <div class="padding-very-small"><label class="header"><%= scope.strSize %></label></div>\n        <div class="padding-large">\n            <div class="margin-right-5" style="display: inline-block;">\n                <label class="input-label"><%= scope.strWidth %></label>\n                <div id="sliceradv-spin-width"></div>\n            </div>\n            <div id="sliceradv-button-ratio" class="margin-right-5"></div>\n            <div style="display: inline-block;">\n                <label class="input-label"><%= scope.strHeight %></label>\n                <div id="sliceradv-spin-height"></div>\n            </div>\n        </div>\n        <div class="padding-very-small"><label class="header"><%= scope.strButtons %></label></div>\n        <div>\n            <div class="margin-right-5" style="display: inline-block;">\n                <label class="input-label"><%= scope.strColumns %></label>\n                <div id="sliceradv-spin-columns"></div>\n            </div>\n            <div style="display: inline-block;">\n                <label class="input-label"><%= scope.strHeight %></label>\n                <div id="sliceradv-spin-col-height"></div>\n            </div>\n        </div>\n    </div>\n</div>\n<div id="id-adv-slicer-sorting" class="settings-panel">\n    <div class="inner-content" style="width: 100%;">\n        <div class="padding-small">\n            <label class="header"><%= scope.textSort %></label>\n        </div>\n        <div class="padding-large">\n            <div style="display: inline-block;">\n                <div class="padding-small" id="sliceradv-radio-asc"></div>\n                <div class="padding-small" id="sliceradv-radio-desc"></div>\n            </div>\n        </div>\n        <div>\n            <div style="display: inline-block;">\n                <div class="padding-small" id="sliceradv-check-hide-nodata"></div>\n                <div class="padding-small" id="sliceradv-check-indicate-nodata"></div>\n                <div class="padding-small" id="sliceradv-check-show-nodata-last"></div>\n                \x3c!--<div class="padding-small" id="sliceradv-check-show-deleted"></div>--\x3e\n            </div>\n        </div>\n    </div>\n</div>\n<div id="id-adv-slicer-references" class="settings-panel">\n    <div class="inner-content">\n        <div class="padding-large">\n            <label class="header" style="display: block;"><%= scope.textSourceName %></label>\n            <label class="input-label" id="sliceradv-lbl-source"></label>\n        </div>\n        <div class="padding-large">\n            <label class="header" style="display: block;"><%= scope.textFormulaName %></label>\n            <label class="input-label" id="sliceradv-lbl-formula"></label>\n        </div>\n        <div class="padding-large">\n            <label class="header"><%= scope.textName %></label>\n            <div id="sliceradv-text-name"></div>\n        </div>\n    </div>\n</div>\n<div id="id-adv-slicer-snap" class="settings-panel">\n    <div class="inner-content">\n        <table cols="1">\n            <tr>\n                <td class="padding-small">\n                    <div id="slicer-advanced-radio-twocell"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="slicer-advanced-radio-onecell"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="slicer-advanced-radio-absolute"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-adv-slicer-alttext" class="settings-panel">\n    <div class="inner-content">\n        <table cols="1" width="100%">\n            <tr>\n                <td class="padding-large">\n                    <label class="header"><%= scope.textAltTitle %></label>\n                    <div id="sliceradv-alt-title"></div>\n                </td>\n            </tr>\n            <tr>\n                <td>\n                    <label class="header"><%= scope.textAltDescription %></label>\n                    <textarea id="sliceradv-alt-description" class="form-control" style="width: 100%; height: 120px;"></textarea>\n                </td>\n            </tr>\n            <tr>\n                <td>\n                    <label><%= scope.textAltTip %></label>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>'}),void 0===Common&&(Common={}),define("common/main/lib/component/ComboDataView",["common/main/lib/component/BaseView","common/main/lib/component/DataView"],function(){"use strict";Common.UI.ComboDataView=Common.UI.BaseView.extend({options:{id:null,cls:"",style:"",hint:!1,itemWidth:80,itemHeight:40,menuMaxHeight:300,autoWidth:!1,enableKeyEvents:!1,beforeOpenHandler:null,additionalMenuItems:null,showLast:!0,minWidth:-1,dataHint:"",dataHintDirection:"",dataHintOffset:""},template:_.template(['<div id="<%= id %>" class="combo-dataview <%= cls %>" style="<%= style %>">','<div class="view"></div> ','<div class="button"></div> ',"</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t),this.id=this.options.id||Common.UI.getId(),this.cls=this.options.cls,this.style=this.options.style,this.hint=this.options.hint,this.store=this.options.store||new Common.UI.DataViewStore,this.groups=this.options.groups,this.itemWidth=this.options.itemWidth,this.itemHeight=this.options.itemHeight,this.menuMaxHeight=this.options.menuMaxHeight,this.beforeOpenHandler=this.options.beforeOpenHandler,this.showLast=this.options.showLast,this.wrapWidth=0,this.rootWidth=0,this.rootHeight=0,this.rendered=!1,this.needFillComboView=!1,this.minWidth=this.options.minWidth,this.autoWidth=this.initAutoWidth=!Common.Utils.isIE10&&!Common.Utils.isIE11&&this.options.autoWidth,this.delayRenderTips=this.options.delayRenderTips||!1,this.itemTemplate=this.options.itemTemplate||_.template(['<div class="style" id="<%= id %>">','<img src="<%= imageUrl %>" width="'+this.itemWidth+'" height="'+this.itemHeight+'" + <% if(typeof imageUrl === "undefined" || imageUrl===null || imageUrl==="") { %> style="visibility: hidden;" <% } %>/>','<% if (typeof title !== "undefined") {%>','<span class="title"><%= title %></span>',"<% } %>","</div>"].join("")),this.fieldPicker=new Common.UI.DataView({cls:"field-picker",allowScrollbar:!1,itemTemplate:this.itemTemplate,delayRenderTips:this.delayRenderTips}),this.openButton=new Common.UI.Button({cls:"open-menu",menu:new Common.UI.Menu({menuAlign:Common.UI.isRTL()?"tr-tr":"tl-tl",offset:[0,3],items:[{template:_.template('<div class="menu-picker-container"></div>')}].concat(null!=this.options.additionalMenuItems?this.options.additionalMenuItems:[])}),dataHint:this.options.dataHint,dataHintDirection:this.options.dataHintDirection,dataHintOffset:this.options.dataHintOffset}),this.menuPicker=new Common.UI.DataView({cls:"menu-picker",parentMenu:this.openButton.menu,outerMenu:this.options.additionalMenuItems?{menu:this.openButton.menu,index:0}:void 0,restoreHeight:this.menuMaxHeight,style:"max-height: "+this.menuMaxHeight+"px;",enableKeyEvents:this.options.enableKeyEvents,groups:this.groups,store:this.store,itemTemplate:this.itemTemplate,delayRenderTips:this.delayRenderTips}),null!=this.options.additionalMenuItems&&this.openButton.menu.setInnerMenu([{menu:this.menuPicker,index:0}]),setInterval(_.bind(this.checkSize,this),500),this.options.el&&this.render()},render:function(t){var e,i;return this.rendered||((e=this).trigger("render:before",e),e.cmpEl=e.$el||$(e.el),i=e.template({id:e.id,cls:e.cls,style:e.style}),t?(e.setElement(t,!1),e.cmpEl=$(i),t.html(e.cmpEl)):e.cmpEl.html(i),e.rootWidth=e.cmpEl.width(),e.rootHeight=e.cmpEl.height(),e.fieldPicker.render($(".view",e.cmpEl)),e.openButton.render($(".button",e.cmpEl)),e.menuPicker.render($(".menu-picker-container",e.cmpEl)),e.openButton.menu.cmpEl&&e.openButton.menu.cmpEl&&(e.openButton.menu.menuAlignEl=e.cmpEl,e.openButton.menu.cmpEl.css("min-width",e.itemWidth),e.openButton.menu.on("show:before",_.bind(e.onBeforeShowMenu,e)),e.openButton.menu.on("show:after",_.bind(e.onAfterShowMenu,e)),e.openButton.cmpEl.on("hide.bs.dropdown",_.bind(e.onBeforeHideMenu,e)),e.openButton.cmpEl.on("hidden.bs.dropdown",_.bind(e.onAfterHideMenu,e))),e.options.hint&&(e.cmpEl.attr("data-toggle","tooltip"),e.cmpEl.tooltip({title:e.options.hint,placement:e.options.hintAnchor||"cursor"})),e.fieldPicker.on("item:select",_.bind(e.onFieldPickerSelect,e)),e.menuPicker.on("item:select",_.bind(e.onMenuPickerSelect,e)),e.fieldPicker.on("item:click",_.bind(e.onFieldPickerClick,e)),e.menuPicker.on("item:click",_.bind(e.onMenuPickerClick,e)),e.fieldPicker.on("item:contextmenu",_.bind(e.onPickerItemContextMenu,e)),e.menuPicker.on("item:contextmenu",_.bind(e.onPickerItemContextMenu,e)),e.fieldPicker.el.addEventListener("contextmenu",_.bind(e.onPickerComboContextMenu,e),!1),e.menuPicker.el.addEventListener("contextmenu",_.bind(e.onPickerComboContextMenu,e),!1),Common.NotificationCenter.on("more:toggle",_.bind(this.onMoreToggle,this)),e.onResize(),e.rendered=!0,e.trigger("render:after",e)),this.disabled&&this.setDisabled(!!this.disabled),this},onMoreToggle:function(t,e){e&&this.checkSize()},checkSize:function(){var t,e,i;this.cmpEl&&this.cmpEl.is(":visible")&&(this.autoWidth&&0<this.menuPicker.store.length&&((e=this.$el.width())==this.wrapWidth&&!this.needFillComboView||(this.wrapWidth=e,this.autoChangeWidth(),i=(e=this.menuPicker).getSelectedRec(),this.fillComboView(i||e.store.at(0),!!i,!0))),e=(t=this).cmpEl.width(),i=this.cmpEl.height(),e<this.minWidth||this.rootWidth==e&&this.rootHeight==i||(this.rootWidth=e,this.rootHeight=i,setTimeout(function(){t.openButton.menu.cmpEl.outerWidth(),t.rootWidth=t.cmpEl.width()},10),this.onResize()))},onResize:function(){var t,e;this.openButton&&(t=$("button",this.openButton.cmpEl),e=$(".button",this.cmpEl),t&&0<e.width()&&t.css({width:e.width(),height:e.height()}),this.openButton.menu.hide(),(t=this.menuPicker)&&(e=t.getSelectedRec(),this.itemMarginLeft=void 0,this.fillComboView(e||t.store.at(0),!!e,!0),t.onResize())),this.isSuspendEvents||this.trigger("resize",this)},autoChangeWidth:function(){var t,e,i,s,o,n,a,l;this.menuPicker.dataViewItems[0]&&(a=this.$el.width(),t=this.menuPicker.dataViewItems[0].$el,l=this.itemWidth+parseFloat(t.css("padding-left"))+parseFloat(t.css("padding-right"))+2*parseFloat(t.css("border-width")),t=parseFloat(t.css("margin-left"))+parseFloat(t.css("margin-right")),i=this.fieldPicker.$el,e=parseFloat(i.css(Common.UI.isRTL()?"padding-left":"padding-right")),i=parseFloat(i.css("border-width")),s=parseFloat(this.fieldPicker.$el.find(".dataview").css("padding-left"))+parseFloat(this.fieldPicker.$el.find(".dataview").css("padding-right")),o=this.cmpEl,n=parseFloat(o.css("padding-left"))+parseFloat(o.css("padding-right")),(a=Math.floor((a-e-s-2*i-n)/(l+t)))>this.store.length&&(a=this.store.length),a=Math.ceil(10*(a*(l+t)+e+s+2*i+n))/10,l=parseFloat(o.css("max-width")),o.css("width",a=l<a?l:a),this.initAutoWidth&&(this.initAutoWidth=!1,o.css("position","absolute"),o.css("top","50%"),o.css("bottom","50%"),o.css("margin","auto 0")))},onBeforeShowMenu:function(t){var e=this;if(_.isFunction(e.beforeOpenHandler))e.beforeOpenHandler(e,t);else if(e.openButton.menu.cmpEl){var i=0;try{var s=$($(".dropdown-menu .dataview.inner .style",e.cmpEl)[0]),i=s?parseInt(s.css("margin-left"))+parseInt(s.css("margin-right")):0}catch(t){}e.openButton.menu.cmpEl.css({width:Math.round((e.cmpEl.width()+i*e.fieldPicker.store.length)/e.itemWidth-.2)*(e.itemWidth+i),"min-height":this.cmpEl.height()})}e.options.hint&&(s=e.cmpEl.data("bs.tooltip"))&&(void 0===s.dontShow&&(s.dontShow=!0),s.hide()),this.menuPicker.selectedBeforeHideRec=null},onBeforeHideMenu:function(t){if(this.trigger("hide:before",this,t),Common.UI.Scroller.isMouseCapture()&&t.preventDefault(),this.isStylesNotClosable)return!1},onAfterShowMenu:function(t){this.menuPicker.scroller&&this.menuPicker.scroller.update({includePadding:!0,suppressScrollX:!0,alwaysVisibleY:!0})},onAfterHideMenu:function(t,e){this.menuPicker.selectedBeforeHideRec=this.menuPicker.getSelectedRec(),this.showLast?this.menuPicker.showLastSelected():this.menuPicker.deselectAll(),this.trigger("hide:after",this,t,e)},onFieldPickerSelect:function(t,e,i){},onMenuPickerSelect:function(t,e,i,s){this.needFillComboView=this.disabled,this.disabled||!0===s||(this.fillComboView(i,!1),i&&!this.isSuspendEvents&&this.trigger("select",this,i))},onFieldPickerClick:function(t,e,i){this.disabled||(this.isSuspendEvents||this.trigger("click",this,i),this.options.hint&&(i=this.cmpEl.data("bs.tooltip"))&&(void 0===i.dontShow&&(i.dontShow=!0),i.hide()),this.showLast||this.fieldPicker.deselectAll())},onMenuPickerClick:function(t,e,i){this.disabled||this.isSuspendEvents||this.trigger("click",this,i)},onPickerItemContextMenu:function(t,e,i,s){if(!this.disabled)return this.isSuspendEvents||this.trigger("contextmenu",this,i,s),s.preventDefault(),s.stopPropagation(),!1},onPickerComboContextMenu:function(t){this.disabled||this.isSuspendEvents||this.trigger("contextmenu",this,void 0,t)},setDisabled:function(t){var e;this.disabled=t=!!t,this.rendered&&(this.cmpEl.toggleClass("disabled",t),$("button",this.openButton.cmpEl).toggleClass("disabled",t),this.fieldPicker.setDisabled(t),this.needFillComboView&&!t&&(t=this.menuPicker)&&(e=t.getSelectedRec(),this.fillComboView(e||t.store.at(0),!1)))},isDisabled:function(){return this.disabled},fillComboView:function(t,e,i){if(!_.isUndefined(t)&&t instanceof Backbone.Model){this.needFillComboView=!this.isVisible();var s=this,o=s.menuPicker.store,n=$(s.fieldPicker.el);if(o){if(i||!s.fieldPicker.store.findWhere({id:t.get("id")})){void 0!==s.itemMarginLeft||0<(i=!(i=$($(this.menuPicker.el).find(".inner > div:not(.grouped-data):not(.ps-scrollbar-x-rail):not(.ps-scrollbar-y-rail)")[0]))||i.length<1?$($(this.menuPicker.el).find(".inner .group-items-container > div:not(.grouped-data):not(.ps-scrollbar-x-rail):not(.ps-scrollbar-y-rail)")[0]):i).length&&(s.itemMarginLeft=parseInt(i.css("margin-left")),s.itemMarginRight=parseInt(i.css("margin-right")),s.itemPaddingLeft=parseInt(i.css("padding-left")),s.itemPaddingRight=parseInt(i.css("padding-right")),s.itemBorderLeft=parseInt(i.css("border-left-width")),s.itemBorderRight=parseInt(i.css("border-right-width")));i=o.indexOf(t);if(i<0)return;var a=o.length,l=Math.floor(Math.max(n.width(),s.minWidth)/(s.itemWidth+(s.itemMarginLeft||0)+(s.itemMarginRight||0)+(s.itemPaddingLeft||0)+(s.itemPaddingRight||0)+(s.itemBorderLeft||0)+(s.itemBorderRight||0))),r=[];2<n.height()/s.itemHeight&&(l*=Math.floor(n.height()/s.itemHeight));for(var c=i=a-(i=Math.floor(i/l)*l)<l?Math.max(a-l,0):i,d=0;c<a&&d<l;c++,d++)r.push(o.at(c));s.fieldPicker.store.reset(r)}return e&&(n=s.fieldPicker.store.findWhere({id:t.get("id")}))&&(s.suspendEvents(),s.fieldPicker.selectRecord(n,!0),s.resumeEvents()),s.fieldPicker.store.models}}},clearComboView:function(){this.fieldPicker.store.reset([])},selectByIndex:function(t){t<0&&this.fieldPicker.deselectAll(),this.menuPicker.selectByIndex(t)},selectRecord:function(t){t||this.fieldPicker.deselectAll(),this.menuPicker.selectRecord(t)},setItemWidth:function(t){this.itemWidth!=t&&(this.itemWidth=1<Common.Utils.applicationPixelRatio()?t/2:t)},setItemHeight:function(t){this.itemHeight!=t&&(this.itemHeight=1<Common.Utils.applicationPixelRatio()?t/2:t)},removeTips:function(){var t=this.menuPicker;_.each(t.dataViewItems,function(t){t=t.$el.data("bs.tooltip");t&&t.tip().remove()},t)}})}),define("spreadsheeteditor/main/app/view/SlicerSettingsAdvanced",["text!spreadsheeteditor/main/app/template/SlicerSettingsAdvanced.template","common/main/lib/view/AdvancedSettingsWindow","common/main/lib/component/MetricSpinner","common/main/lib/component/CheckBox","common/main/lib/component/RadioBox","common/main/lib/component/ComboDataView"],function(t){"use strict";SSE.Views.SlicerSettingsAdvanced=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:330,height:435,toggleGroup:"slicer-adv-settings-group",storageName:"sse-slicer-settings-adv-category"},initialize:function(i){_.extend(this.options,{title:this.textTitle,items:[{panelId:"id-adv-slicer-style",panelCaption:this.strStyleSize},{panelId:"id-adv-slicer-sorting",panelCaption:this.strSorting},{panelId:"id-adv-slicer-references",panelCaption:this.strReferences},{panelId:"id-adv-slicer-snap",panelCaption:this.textSnap},{panelId:"id-adv-slicer-alttext",panelCaption:this.textAlt}],contentTemplate:_.template(t)({scope:this})},i),this.options.handler=function(t,e){if("ok"==t&&!this.isNameValid())return!0;i.handler&&i.handler.call(this,t,e)},Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options),this._changedProps=null,this._noApply=!0,this.spinners=[],this._nRatio=1,this._originalProps=this.options.imageProps},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var e=this;this.inputHeader=new Common.UI.InputField({el:$("#sliceradv-text-header"),allowBlank:!0,style:"width: 178px;"}).on("changed:after",function(){e.isCaptionChanged=!0}),this.chHeader=new Common.UI.CheckBox({el:$("#sliceradv-checkbox-header"),labelText:this.strShowHeader}),this.chHeader.on("change",_.bind(function(t,e,i,s){this._changedProps&&this._changedProps.asc_setShowCaption("checked"==t.getValue())},this)),this.btnSlicerStyle=new Common.UI.Button({parentEl:$("#sliceradv-btn-style"),cls:"btn-large-dataview sheet-template-slicer",iconCls:"icon-template-slicer",scaling:!1,menu:new Common.UI.Menu({style:"width: 333px;",additionalAlign:this.menuAddAlign,items:[{template:_.template('<div id="sliceradv-menu-style" class="menu-slicer-template"  style="margin: 5px 5px 5px 10px;"></div>')}]})}),this.mnuSlicerPicker=new Common.UI.DataView({el:$("#sliceradv-menu-style"),parentMenu:this.btnSlicerStyle.menu,restoreHeight:325,groups:new Common.UI.DataViewGroupStore,store:new Common.UI.DataViewStore,itemTemplate:_.template('<div id="<%= id %>" class="item"><img src="<%= imageUrl %>" height="49" width="36"></div>'),style:"max-height: 325px;"}),this.mnuSlicerPicker.on("item:click",_.bind(this.onSelectSlicerStyle,this,this.btnSlicerStyle)),this.numWidth=new Common.UI.MetricSpinner({el:$("#sliceradv-spin-width"),step:.1,width:85,defaultUnit:"cm",defaultValue:0,value:"0 cm",maxValue:5963.9,minValue:0}),this.numWidth.on("change",_.bind(function(t,e,i,s){var o,n;this.btnRatio.pressed&&((n=t.getNumberValue()/this._nRatio)>this.numHeight.options.maxValue&&(o=(n=this.numHeight.options.maxValue)*this._nRatio,this.numWidth.setValue(o,!0)),this.numHeight.setValue(n,!0)),this._originalProps&&(this._originalProps.put_Width(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())),this._originalProps.put_Height(Common.Utils.Metric.fnRecalcToMM(this.numHeight.getNumberValue())))},this)),this.spinners.push(this.numWidth),this.numHeight=new Common.UI.MetricSpinner({el:$("#sliceradv-spin-height"),step:.1,width:85,defaultUnit:"cm",defaultValue:0,value:"0 cm",maxValue:5963.9,minValue:0}),this.numHeight.on("change",_.bind(function(t,e,i,s){var o=t.getNumberValue(),n=null;this.btnRatio.pressed&&((n=o*this._nRatio)>this.numWidth.options.maxValue&&(o=(n=this.numWidth.options.maxValue)/this._nRatio,this.numHeight.setValue(o,!0)),this.numWidth.setValue(n,!0)),this._originalProps&&(this._originalProps.put_Width(Common.Utils.Metric.fnRecalcToMM(this.numWidth.getNumberValue())),this._originalProps.put_Height(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())))},this)),this.spinners.push(this.numHeight),this.btnRatio=new Common.UI.Button({parentEl:$("#sliceradv-button-ratio"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-advanced-ratio",style:"margin-bottom: 1px;",enableToggle:!0,hint:this.textKeepRatio}),this.btnRatio.on("click",_.bind(function(t,e){t.pressed&&0<this.numHeight.getNumberValue()&&(this._nRatio=this.numWidth.getNumberValue()/this.numHeight.getNumberValue()),this._originalProps&&this._originalProps.asc_putLockAspect(t.pressed)},this)),this.numColHeight=new Common.UI.MetricSpinner({el:$("#sliceradv-spin-col-height"),step:.1,width:85,defaultUnit:"cm",defaultValue:0,value:"0 cm",maxValue:5963.9,minValue:0}),this.numColHeight.on("change",_.bind(function(t,e,i,s){t=t.getNumberValue();this._changedProps&&this._changedProps.asc_setRowHeight(36e3*Common.Utils.Metric.fnRecalcToMM(t))},this)),this.spinners.push(this.numColHeight),this.numCols=new Common.UI.MetricSpinner({el:$("#sliceradv-spin-columns"),step:1,width:85,defaultUnit:"",defaultValue:1,value:"1",allowDecimal:!1,maxValue:2e4,minValue:1}),this.numCols.on("change",_.bind(function(t,e,i,s){t=t.getNumberValue();this._changedProps&&this._changedProps.asc_setColumnCount(t)},this)),this.radioAsc=new Common.UI.RadioBox({el:$("#sliceradv-radio-asc"),name:"asc-radio-sliceradv-sort",labelText:this.textAsc,checked:!0}),this.radioAsc.on("change",_.bind(function(t,e,i){e&&this._changedProps&&this._changedProps.asc_setSortOrder(Asc.ST_tabularSlicerCacheSortOrder.Ascending)},this)),this.radioDesc=new Common.UI.RadioBox({el:$("#sliceradv-radio-desc"),name:"asc-radio-sliceradv-sort",labelText:this.textDesc,checked:!1}),this.radioDesc.on("change",_.bind(function(t,e,i){e&&this._changedProps&&this._changedProps.asc_setSortOrder(Asc.ST_tabularSlicerCacheSortOrder.Descending)},this)),this.chHideNoData=new Common.UI.CheckBox({el:$("#sliceradv-check-hide-nodata"),labelText:this.strHideNoData}),this.chHideNoData.on("change",_.bind(function(t,e,i,s){t="checked"==t.getValue();this.chIndNoData.setDisabled(t),this.chShowNoData.setDisabled(t||"checked"!=this.chIndNoData.getValue()),this.chShowDel.setDisabled(t),this._changedProps&&this._changedProps.asc_setHideItemsWithNoData(t)},this)),this.chIndNoData=new Common.UI.CheckBox({el:$("#sliceradv-check-indicate-nodata"),labelText:this.strIndNoData}),this.chIndNoData.on("change",_.bind(function(t,e,i,s){t="checked"==t.getValue();this.chShowNoData.setDisabled(!t),this._changedProps&&this._changedProps.asc_setIndicateItemsWithNoData(t)},this)),this.chShowNoData=new Common.UI.CheckBox({el:$("#sliceradv-check-show-nodata-last"),disabled:!0,labelText:this.strShowNoData}),this.chShowNoData.on("change",_.bind(function(t,e,i,s){this._changedProps&&this._changedProps.asc_setShowItemsWithNoDataLast("checked"==t.getValue())},this)),this.chShowDel=new Common.UI.CheckBox({el:$("#sliceradv-check-show-deleted"),labelText:this.strShowDel}),this.chShowDel.on("change",_.bind(function(t,e,i,s){this._changedProps},this)),this.inputName=new Common.UI.InputField({el:$("#sliceradv-text-name"),allowBlank:!1,blankError:e.txtEmpty,style:"width: 178px;"}).on("changed:after",function(){e.isNameChanged=!0}),this.lblSource=$("#sliceradv-lbl-source"),this.lblFormula=$("#sliceradv-lbl-formula"),this.radioTwoCell=new Common.UI.RadioBox({el:$("#slicer-advanced-radio-twocell"),name:"asc-radio-snap",labelText:this.textTwoCell,value:AscCommon.c_oAscCellAnchorType.cellanchorTwoCell}),this.radioTwoCell.on("change",_.bind(this.onRadioSnapChange,this)),this.radioOneCell=new Common.UI.RadioBox({el:$("#slicer-advanced-radio-onecell"),name:"asc-radio-snap",labelText:this.textOneCell,value:AscCommon.c_oAscCellAnchorType.cellanchorOneCell}),this.radioOneCell.on("change",_.bind(this.onRadioSnapChange,this)),this.radioAbsolute=new Common.UI.RadioBox({el:$("#slicer-advanced-radio-absolute"),name:"asc-radio-snap",labelText:this.textAbsolute,value:AscCommon.c_oAscCellAnchorType.cellanchorAbsolute}),this.radioAbsolute.on("change",_.bind(this.onRadioSnapChange,this)),this.inputAltTitle=new Common.UI.InputField({el:$("#sliceradv-alt-title"),allowBlank:!0,validateOnBlur:!1,style:"width: 100%;"}).on("changed:after",function(){e.isAltTitleChanged=!0}),this.textareaAltDescription=this.$window.find("textarea"),this.textareaAltDescription.keydown(function(t){t.keyCode==Common.UI.Keys.RETURN&&t.stopPropagation(),e.isAltDescChanged=!0}),this.afterRender()},getFocusedComponents:function(){return[this.inputHeader,this.chHeader,this.numWidth,this.btnRatio,this.numHeight,this.numCols,this.numColHeight,this.radioAsc,this.radioDesc,this.chHideNoData,this.chIndNoData,this.chShowNoData,this.inputName,this.radioTwoCell,this.radioOneCell,this.radioAbsolute,this.inputAltTitle,this.textareaAltDescription]},onCategoryClick:function(t,e){Common.Views.AdvancedSettingsWindow.prototype.onCategoryClick.call(this,t,e);var i=this;setTimeout(function(){switch(e){case 0:i.inputHeader.focus();break;case 1:i.chHideNoData.focus();break;case 2:i.inputName.focus();break;case 3:i.radioTwoCell.focus();break;case 4:i.inputAltTitle.focus()}},10)},getSettings:function(){return this.isCaptionChanged&&this._changedProps.asc_setCaption(this.inputHeader.getValue()),this.isNameChanged&&this._changedProps.asc_setName(this.inputName.getValue()),this.isAltTitleChanged&&this._originalProps.asc_putTitle(this.inputAltTitle.getValue()),this.isAltDescChanged&&this._originalProps.asc_putDescription(this.textareaAltDescription.val()),{imageProps:this._originalProps}},_setDefaults:function(t){if(t){var e=t.asc_getWidth();switch(this.numWidth.setValue(null!==e?Common.Utils.Metric.fnRecalcFromMM(e).toFixed(2):"",!0),e=t.asc_getHeight(),this.numHeight.setValue(null!==e?Common.Utils.Metric.fnRecalcFromMM(e).toFixed(2):"",!0),0<t.asc_getHeight()&&(this._nRatio=t.asc_getWidth()/t.asc_getHeight()),e=t.asc_getLockAspect(),this.btnRatio.toggle(e),e=t.asc_getTitle(),this.inputAltTitle.setValue(e||""),e=t.asc_getDescription(),this.textareaAltDescription.val(e||""),t.asc_getAnchor()){case AscCommon.c_oAscCellAnchorType.cellanchorTwoCell:this.radioTwoCell.setValue(!0,!0);break;case AscCommon.c_oAscCellAnchorType.cellanchorOneCell:this.radioOneCell.setValue(!0,!0);break;case AscCommon.c_oAscCellAnchorType.cellanchorAbsolute:this.radioAbsolute.setValue(!0,!0)}var i,t=t.asc_getSlicerProperties();t&&(this._noApply=!0,this.numCols.setValue(t.asc_getColumnCount(),!0),this.numColHeight.setValue(Common.Utils.Metric.fnRecalcFromMM(t.asc_getRowHeight()/36e3).toFixed(2),!0),this.inputHeader.setValue(t.asc_getCaption(),!0),i=t.asc_getShowCaption(),this.chHeader.setValue(null!=i?i:"indeterminate",!0),this.radioAsc.setCaption(this.textAsc+" ("+this.textAZ+")"),this.radioDesc.setCaption(this.textDesc+" ("+this.textZA+")"),(t.asc_getSortOrder()==Asc.ST_tabularSlicerCacheSortOrder.Ascending?this.radioAsc:this.radioDesc).setValue(!0,!0),i=t.asc_getIndicateItemsWithNoData(),this.chIndNoData.setValue(null!=i?i:"indeterminate",!0),i=t.asc_getShowItemsWithNoDataLast(),this.chShowNoData.setValue(null!=i?i:"indeterminate",!0),i=t.asc_getHideItemsWithNoData(),this.chHideNoData.setValue(null!=i?i:"indeterminate",!0),this.chIndNoData.setDisabled(i),this.chShowNoData.setDisabled(i||"checked"!=this.chIndNoData.getValue()),this.chShowDel.setDisabled(i),e=t.asc_getName(),this.inputName.setValue(null!=e?e:""),this.inputName.setDisabled(null==e),this.lblSource.text(t.asc_getSourceName()),this.lblFormula.text(t.asc_getNameInFormulas()),e=t.asc_getStyle(),(i=!(i=this.mnuSlicerPicker.store.findWhere({type:e}))&&0<this.mnuSlicerPicker.store.length?this.mnuSlicerPicker.store.at(0):i)?(this.btnSlicerStyle.suspendEvents(),this.mnuSlicerPicker.selectRecord(i,!0),this.btnSlicerStyle.resumeEvents(),this.$window.find(".icon-template-slicer").css({"background-image":"url("+i.get("imageUrl")+")",height:"49px",width:"36px","background-position":"center","background-size":"cover"})):this.$window.find(".icon-template-slicer").css({height:"49px",width:"36px","background-position":"center","background-size":"cover"}),this._noApply=!1,this._changedProps=t)}},updateMetricUnit:function(){if(this.spinners)for(var t=0;t<this.spinners.length;t++)this.spinners[t].setDefaultUnit(Common.Utils.Metric.getCurrentMetricName())},afterRender:function(){var t;this.updateMetricUnit(),this.onInitStyles(this.options.styles),this._setDefaults(this._originalProps),this.storageName&&(t=Common.localStorage.getItem(this.storageName),this.setActiveCategory(null!==t?parseInt(t):0))},onInitStyles:function(t){var e=[];t&&_.each(t,function(t){e.push({id:Common.UI.getId(),type:t.asc_getName(),imageUrl:t.asc_getImage(),allowSelected:!0,selected:!1})}),this.mnuSlicerPicker.store.reset(e),this.btnSlicerStyle.setDisabled(this.mnuSlicerPicker.store.length<1)},onSelectSlicerStyle:function(t,e,i,s){this._noApply||(this._changedProps&&this._changedProps.asc_setStyle(s.get("type")),this.$window.find(".icon-template-slicer").css({"background-image":"url("+s.get("imageUrl")+")",height:"49px",width:"36px","background-position":"center","background-size":"cover"}))},onRadioSnapChange:function(t,e,i){e&&this._originalProps&&this._originalProps.asc_putAnchor(t.options.value)},isNameValid:function(){return!this.isNameChanged||!_.isEmpty(this.inputName.getValue())||(this.setActiveCategory(2),this.inputName.cmpEl.find("input").focus(),!1)}},SSE.Views.SlicerSettingsAdvanced||{}))}),define("spreadsheeteditor/main/app/view/PivotGroupDialog",["common/main/lib/component/Window"],function(){"use strict";SSE.Views.PivotGroupDialog=Common.UI.Window.extend(_.extend({options:{width:250,header:!0,cls:"modal-dlg",buttons:["ok","cancel"]},initialize:function(t){var e=t.date?335:195;_.extend(this.options,{title:this.txtTitle},t||{}),this.template=t.template||['<div class="box" style="height:'+(e-85)+'px;">','<table cols="2" style="width: 100%;">',"<tr>",'<td colspan="2" style="padding-bottom: 4px;">','<label class="font-weight-bold">'+this.textAuto+"</label>","</td>","</tr>","<tr>",'<td class="padding-right-10" style="padding-bottom: 8px;width: 100%;">','<div id="pivot-group-dlg-chk-start" style="margin-top: 2px;"></div>',"</td>",'<td style="padding-bottom: 8px;">','<div id="pivot-group-dlg-txt-start"></div>',"</td>","</tr>","<tr>",'<td class="padding-right-10" style="padding-bottom: 8px;width: 100%;">','<div id="pivot-group-dlg-chk-end" style="margin-top: 2px;"></div>',"</td>",'<td style="padding-bottom: 8px;">','<div id="pivot-group-dlg-txt-end"></div>',"</td>","</tr>",'<tr class="group-number">','<td class="padding-right-10" style="padding-bottom: 8px;width: 100%;">','<label class="margin-left-22" style="margin-top:2px;">'+this.textBy+"</label>","</td>",'<td style="padding-bottom: 8px;">','<div id="pivot-group-dlg-txt-by"></div>',"</td>","</tr>",'<tr class="group-date">','<td colspan="2" style="padding-bottom: 4px;">','<label class="font-weight-bold">'+this.textBy+"</label>","</td>","</tr>",'<tr class="group-date">','<td colspan="2" style="padding-bottom: 8px;">','<div id="pivot-group-dlg-list" style="height:116px;"></div>',"</td>","</tr>",'<tr class="group-date">','<td class="padding-right-10" style="width: 100%;">','<label style="margin-top:2px;">'+this.textNumDays+"</label>","</td>","<td>",'<div id="pivot-group-dlg-spn-days"></div>',"</td>","</tr>","</table>","</div>"].join(""),this.api=t.api,this.handler=t.handler,this.options.tpl=_.template(this.template)(this.options),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this),this.$window.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this));var o=this,t=(this.chStart=new Common.UI.CheckBox({el:$("#pivot-group-dlg-chk-start",this.$window),labelText:this.textStart}),this.chStart.on("change",function(t,e,i,s){"checked"==e&&o.defRangePr&&o.inputStart.setValue(o.defRangePr.start)}),this.chEnd=new Common.UI.CheckBox({el:$("#pivot-group-dlg-chk-end",this.$window),labelText:this.textEnd}),this.chEnd.on("change",function(t,e,i,s){"checked"==e&&o.defRangePr&&o.inputEnd.setValue(o.defRangePr.end)}),this.inputStart=new Common.UI.InputField({el:$("#pivot-group-dlg-txt-start",this.$window),style:"width: 100px;",allowBlank:!0,validateOnChange:!0,validation:function(){return!0}}).on("changing",function(t,e){o.chStart.setValue(!1,!0)}),this.inputEnd=new Common.UI.InputField({el:$("#pivot-group-dlg-txt-end",this.$window),style:"width: 100px;",allowBlank:!0,validateOnChange:!0,validation:function(){return!0}}).on("changing",function(t,e){o.chEnd.setValue(!1,!0)}),this.inputBy=new Common.UI.InputField({el:$("#pivot-group-dlg-txt-by",this.$window),style:"width: 100px;",allowBlank:!0,validateOnChange:!0,validation:function(){return!0}}).on("changing",function(t,e){e.length}),this.spnDays=new Common.UI.MetricSpinner({el:$("#pivot-group-dlg-spn-days",this.$window),step:1,width:100,defaultUnit:"",value:"1",maxValue:32767,minValue:1}),this.spnDays.on("change",_.bind(function(t,e,i,s){},this)),[{value:this.textSec,type:Asc.c_oAscGroupBy.Seconds},{value:this.textMin,type:Asc.c_oAscGroupBy.Minutes},{value:this.textHour,type:Asc.c_oAscGroupBy.Hours},{value:this.textDays,type:Asc.c_oAscGroupBy.Days},{value:this.textMonth,type:Asc.c_oAscGroupBy.Months},{value:this.textQuart,type:Asc.c_oAscGroupBy.Quarters},{value:this.textYear,type:Asc.c_oAscGroupBy.Years}]);this.listDate=new Common.UI.ListView({el:$("#pivot-group-dlg-list",this.$window),store:new Common.UI.DataViewStore(t),multiSelect:!0,tabindex:1,itemTemplate:_.template('<div id="<%= id %>" class="list-item" style="pointer-events:none;"><%= value %></div>')}),this.listDate.on("item:select",_.bind(this.onSelectDate,this)),this.listDate.on("item:deselect",_.bind(this.onSelectDate,this)),this.listDate.on("entervalue",_.bind(this.onPrimary,this)),this.btnOk=new Common.UI.Button({el:$(".dlg-btn.primary",this.$window)})},getFocusedComponents:function(){return[this.chStart,this.inputStart,this.chEnd,this.inputEnd,this.inputBy,this.listDate,this.spnDays]},getDefaultFocusableComponent:function(){return this.inputStart},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onSelectDate:function(t,e,i){!i||i.length<1||(i.get("type")==Asc.c_oAscGroupBy.Days&&(this.isDays=i.get("selected")),i=this.listDate.getSelectedRec().length,this.spnDays.setDisabled(!this.isDays||1<i),this.btnOk.setDisabled(i<1))},setSettings:function(t,e,i){var s,o,n;this.$window.find(".group-number").toggleClass("hidden",!!e),this.$window.find(".group-date").toggleClass("hidden",!e),t&&(this.chStart.setValue(t.asc_getAutoStart(),!0),this.chEnd.setValue(t.asc_getAutoEnd(),!0),s=e?t.asc_getStartDateText():t.asc_getStartNum(),this.inputStart.setValue(null!=s?s:""),s=e?t.asc_getEndDateText():t.asc_getEndNum(),this.inputEnd.setValue(null!=s?s:""),e||this.inputBy.setValue(t.asc_getGroupInterval()),this.rangePr=t,i&&(this.defRangePr={start:e?i.asc_getStartDateText():i.asc_getStartNum(),end:e?i.asc_getEndDateText():i.asc_getEndNum()})),e&&((o=this).listDate.setMultiselectMode(1<e.length),_.each(e,function(t){var e=o.listDate.store.findWhere({type:t});e&&o.listDate.selectRecord(e),t==Asc.c_oAscGroupBy.Days&&(n=!0)}),this.listDate.setMultiselectMode(!1),this.spnDays.setValue(t.asc_getGroupInterval()),this.spnDays.setDisabled(!n||1<e.length),this.btnOk.setDisabled(e.length<1),this.dateTypes=e,this.isDays=n)},getSettings:function(){return this.rangePr&&(this.rangePr.asc_setAutoStart("checked"==this.chStart.getValue()),this.rangePr.asc_setAutoEnd("checked"==this.chEnd.getValue()),this.dateTypes?(this.dateTypes=this.listDate.getSelectedRec().map(function(t){return t.get("type")}),this.rangePr.asc_setGroupInterval(this.spnDays.getNumberValue()),this.rangePr.asc_setStartDateText(this.inputStart.getValue()),this.rangePr.asc_setEndDateText(this.inputEnd.getValue())):(this.rangePr.asc_setStartNum(parseFloat(this.inputStart.getValue().toString().replace(",","."))),this.rangePr.asc_setEndNum(parseFloat(this.inputEnd.getValue().toString().replace(",","."))),this.rangePr.asc_setGroupInterval(parseFloat(this.inputBy.getValue().toString().replace(",","."))))),[this.rangePr,this.dateTypes]},isRangeValid:function(){if(this.dateTypes){if(this.rangePr){this.rangePr.asc_setStartDateText(this.inputStart.getValue());var t=this.rangePr.asc_getStartDate();if(isNaN(t))return this.inputStart.showError([this.textError]),this.inputStart.focus(),!1;this.rangePr.asc_setEndDateText(this.inputEnd.getValue());var e=this.rangePr.asc_getEndDate();if(isNaN(e))return this.inputEnd.showError([this.textError]),this.inputEnd.focus(),!1;if(e<t)return Common.UI.warning({msg:this.textGreaterError,maxwidth:600}),this.inputEnd.focus(),!1}}else{var i=new RegExp("^s*[-]?[0-9]+[,.]?[0-9]*s*$"),t=this.inputStart.getValue().toString();if(!i.test(t))return this.inputStart.showError([this.textError]),this.inputStart.focus(),!1;e=this.inputEnd.getValue().toString();if(!i.test(e))return this.inputEnd.showError([this.textError]),this.inputEnd.focus(),!1;if(parseFloat(e.replace(",","."))<parseFloat(t.replace(",",".")))return Common.UI.warning({msg:this.textGreaterError,maxwidth:600}),this.inputEnd.focus(),!1;if(!i.test(this.inputBy.getValue().toString()))return this.inputBy.showError([this.textError]),this.inputBy.focus(),!1}return!0},onPrimary:function(t,e,i){return this._handleInput("ok"),!1},_handleInput:function(t){if(this.options.handler){if("ok"==t&&(this.btnOk.isDisabled()||!this.isRangeValid()))return;this.options.handler.call(this,this,t)}this.close()}},SSE.Views.PivotGroupDialog||{}))}),define("spreadsheeteditor/main/app/view/MacroDialog",["common/main/lib/util/utils","common/main/lib/component/ListView","common/main/lib/component/InputField","common/main/lib/view/AdvancedSettingsWindow"],function(){"use strict";SSE.Views.MacroDialog=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:250,height:312},initialize:function(t){_.extend(this.options,{title:this.textTitle,template:['<div class="box" style="height:'+(this.options.height-85)+'px;">','<div class="content-panel" style="padding: 0 5px;"><div class="inner-content">','<div class="settings-panel active">','<table cols="1" style="width: 100%;">',"<tr>",'<td class="padding-extra-small">','<label class="input-label">',this.textMacro,"</label>","</td>","</tr>","<tr>",'<td class="padding-small">','<div id="macro-dlg-txt-name"></div>',"</td>","</tr>","<tr>","<td>",'<div id="macro-dlg-list" style="width:100%; height: 169px;"></div>',"</td>","</tr>","</table>","</div></div>","</div>","</div>"].join("")},t),this.handler=t.handler,this.props=t.props,Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var i=this;this.txtName=new Common.UI.InputField({el:$("#macro-dlg-txt-name"),allowBlank:!0,validateOnChange:!0,validateOnBlur:!0,style:"width: 100%;",value:"",maxLength:40,validation:function(t){return!0}}).on("changing",function(t,e){i.findMacro(e)}),this.macroList=new Common.UI.ListView({el:$("#macro-dlg-list",this.$window),store:new Common.UI.DataViewStore,tabindex:1,cls:"dbl-clickable",itemTemplate:_.template('<div id="<%= id %>" class="list-item" style="overflow: hidden; text-overflow: ellipsis;"><%= value %></div>')}),this.macroList.on("item:dblclick",_.bind(this.onDblClickMacro,this)),this.macroList.on("entervalue",_.bind(this.onPrimary,this)),this.macroList.on("item:select",_.bind(this.onSelectMacro,this)),this.afterRender()},getFocusedComponents:function(){return[this.txtName,this.macroList]},getDefaultFocusableComponent:function(){return this.txtName},afterRender:function(){this._setDefaults(this.props)},_setDefaults:function(t){this.props=t,this.refreshList()},getSettings:function(){return this.txtName.getValue()},onDlgBtnClick:function(t){t=t.currentTarget.attributes.result.value;this.handler&&this.handler.call(this,t,"ok"==t?this.getSettings():void 0),this.close()},onPrimary:function(){return this.handler&&this.handler.call(this,"ok",this.getSettings()),this.close(),!1},refreshList:function(){if(this.props&&this.props.macroList){for(var t=this.props.macroList,e=[],i=0;i<t.length;i++)e.push({value:t[i]});this.macroList.store.reset(e),this.props.current&&(this.txtName.setValue(this.props.current),this.findMacro(this.props.current))}},onSelectMacro:function(t,e,i){i&&this.txtName.setValue(i.get("value"))},onDblClickMacro:function(t,e,i){this.handler&&this.handler.call(this,"ok",this.getSettings()),this.close()},findMacro:function(t){t=this.macroList.store.findWhere({value:t});t?(this.macroList.selectRecord(t),this.macroList.scrollToRecord(t)):this.macroList.deselectAll()},textTitle:"Assign Macro",textMacro:"Macro name"},SSE.Views.MacroDialog||{}))}),define("text!spreadsheeteditor/main/app/template/FieldSettingsDialog.template",[],function(){return'<div id="id-pivot-field-settings-layout" class="settings-panel active">\n    <div class="inner-content">\n        <table cols="1" style="width: 100%;">\n            <tr>\n                <td class="padding-small" style="white-space: nowrap;">\n                    <label class="header margin-right-4" style="vertical-align: middle;"><%= scope.txtSourceName %></label>\n                    <label id="field-settings-source" style="vertical-align: middle; max-width: 220px; overflow: hidden; text-overflow: ellipsis;"></label>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-large">\n                    <label class="header"><%= scope.txtCustomName %></label>\n                    <div id="field-settings-custom" style="width:264px;"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <label class="header"><%= scope.textReport %></label>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="field-settings-radio-tab"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="field-settings-radio-outline"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="field-settings-chk-compact" class="margin-left-20"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="field-settings-numformat" style="width:128px;"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="field-settings-chk-repeat"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="field-settings-chk-blank"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="field-settings-chk-subtotals"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="field-settings-radio-top" class="margin-left-20"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-large">\n                    <div id="field-settings-radio-bottom" class="margin-left-20"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="field-settings-chk-empty"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-pivot-field-settings-subtotals" class="settings-panel">\n    <div class="inner-content">\n        <table cols="1" style="width: 100%;">\n            <tr>\n                <td class="padding-small">\n                    <label class="header"><%= scope.txtSummarize %></label>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="field-settings-chk-sum"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="field-settings-chk-count"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="field-settings-chk-ave"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="field-settings-chk-max"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="field-settings-chk-min"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="field-settings-chk-product"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="field-settings-chk-num"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="field-settings-chk-dev"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="field-settings-chk-devp"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="field-settings-chk-var"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="field-settings-chk-varp"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n'}),define("spreadsheeteditor/main/app/view/FormatSettingsDialog",["common/main/lib/util/utils","common/main/lib/component/MetricSpinner","common/main/lib/component/ComboBox","common/main/lib/view/AdvancedSettingsWindow"],function(){"use strict";SSE.Views.FormatSettingsDialog=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:284,height:340},initialize:function(t){var e=this,i=(e.numFormatData=[{value:Asc.c_oAscNumFormatType.General,displayValue:this.txtGeneral},{value:Asc.c_oAscNumFormatType.Number,displayValue:this.txtNumber},{value:Asc.c_oAscNumFormatType.Scientific,displayValue:this.txtScientific},{value:Asc.c_oAscNumFormatType.Accounting,displayValue:this.txtAccounting},{value:Asc.c_oAscNumFormatType.Currency,displayValue:this.txtCurrency},{value:Asc.c_oAscNumFormatType.Date,displayValue:this.txtDate},{value:Asc.c_oAscNumFormatType.Time,displayValue:this.txtTime},{value:Asc.c_oAscNumFormatType.Percent,displayValue:this.txtPercentage},{value:Asc.c_oAscNumFormatType.Fraction,displayValue:this.txtFraction},{value:Asc.c_oAscNumFormatType.Text,displayValue:this.txtText},{value:Asc.c_oAscNumFormatType.Custom,displayValue:this.txtCustom}],e.FractionData=[{displayValue:this.txtUpto1,value:"# ?/?"},{displayValue:this.txtUpto2,value:"# ??/??"},{displayValue:this.txtUpto3,value:"# ???/???"},{displayValue:this.txtAs2,value:"# ?/2"},{displayValue:this.txtAs4,value:"# ?/4"},{displayValue:this.txtAs8,value:"# ?/8"},{displayValue:this.txtAs16,value:"# ??/16"},{displayValue:this.txtAs10,value:"# ?/10"},{displayValue:this.txtAs100,value:"# ??/100"}],e.CurrencySymbolsData=null,e.langId=1033,this.api=t.api,this.handler=t.handler,this.props=t.props,this.linked=t.linked||!1,this.linked?360:340);_.extend(this.options,{title:this.textTitle,height:i,template:['<div class="box" style="height:'+(i-85)+'px;">','<div class="content-panel" style="padding: 0 10px;"><div class="inner-content">','<div class="settings-panel active">','<table cols="1" style="width: 100%;">',"<tr>",'<td style="width:170px;padding-bottom: 3px;">','<label class="header">',e.textCategory,"</label>",'<div id="format-settings-combo-format" class="input-group-nr" style="width:264px;"></div>',"</td>","</tr>","<tr>",'<td class="padding-large" style="white-space: nowrap;">','<label class="format-sample margin-right-4" style="vertical-align: middle;">'+e.txtSample+"</label>",'<label class="format-sample" id="format-settings-label-example" style="vertical-align: middle; max-width: 220px; overflow: hidden; text-overflow: ellipsis;">100</label>',"</td>","</tr>",'<tr class="format-no-code">','<td class="padding-small">',"</td>","</tr>",'<tr class="format-decimal">','<td class="padding-large" style="vertical-align: bottom;">','<label class="header">',e.textDecimal,"</label>",'<div id="format-settings-spin-decimal"></div>',"</td>","</tr>",'<tr class="format-separator">','<td class="padding-large">','<div id="format-settings-checkbox-separator"></div>',"</td>","</tr>",'<tr class="format-symbols">','<td class="padding-large">','<label class="header">',e.textSymbols,"</label>",'<div id="format-settings-combo-symbols" class="input-group-nr" style="width:264px;"></div>',"</td>","</tr>",'<tr class="format-decimal">','<td class="padding-large format-negative">','<label class="header">',e.textFormat,"</label>",'<div id="format-settings-combo-negative" class="input-group-nr" style="width:264px;"></div>',"</td>","</tr>",'<tr class="format-type">','<td class="padding-large">','<label class="header">',e.textFormat,"</label>",'<div id="format-settings-combo-type" class="input-group-nr" style="width:264px;"></div>',"</td>","</tr>",'<tr class="format-code">','<td colspan="1" class="padding-large">','<label class="header">',e.textFormat,"</label>",'<div id="format-settings-txt-code" class="input-group-nr" style="height:22px;width:264px;margin-bottom: 8px;"></div>','<div id="format-settings-list-code" style="width:264px; height: 116px;"></div>',"</td>","</tr>","<tr>",'<td colspan="1">','<div id="format-settings-chk-linked"></div>',"</td>","</tr>","</table>","</div></div>","</div>","</div>",'<div class="separator horizontal"></div>'].join("")},t),Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options),this._state={hasDecimal:!1,hasNegative:!1,hasSeparator:!1,hasType:!1,hasSymbols:!1,hasCode:!1},this.FormatType=Asc.c_oAscNumFormatType.General,this.Format="General",this.FormatInfo=new Asc.asc_CFormatCellsInfo,this.CustomFormat=null},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var o=this;this.cmbFormat=new Common.UI.ComboBox({el:$("#format-settings-combo-format"),cls:"input-group-nr",menuStyle:"min-width: 264px;",editable:!1,data:this.numFormatData,takeFocusOnClose:!0}),this.cmbFormat.setValue(this.FormatType),this.cmbFormat.on("selected",_.bind(this.onFormatSelect,this)),this.cmbNegative=new Common.UI.ComboBox({el:$("#format-settings-combo-negative"),cls:"input-group-nr",menuStyle:"min-width: 264px;max-height:235px;",editable:!1,data:[],scrollAlwaysVisible:!0,takeFocusOnClose:!0}),this.cmbNegative.on("selected",_.bind(this.onNegativeSelect,this)),this.spnDecimal=new Common.UI.MetricSpinner({el:$("#format-settings-spin-decimal"),step:1,width:45,defaultUnit:"",value:2,maxValue:30,minValue:0,allowDecimal:!1}),this.spnDecimal.on("change",_.bind(this.onDecimalChange,this)),this.chSeparator=new Common.UI.CheckBox({el:$("#format-settings-checkbox-separator"),labelText:this.textSeparator}),this.chSeparator.on("change",_.bind(this.onSeparatorChange,this)),this.cmbSymbols=new Common.UI.ComboBox({el:$("#format-settings-combo-symbols"),cls:"input-group-nr",menuStyle:"min-width: 264px;max-height:235px;",editable:!1,data:[],scrollAlwaysVisible:!0,takeFocusOnClose:!0,search:!0}),this.cmbSymbols.on("selected",_.bind(this.onSymbolsSelect,this)),this.cmbType=new Common.UI.ComboBox({el:$("#format-settings-combo-type"),cls:"input-group-nr",menuStyle:"min-width: 264px;max-height:235px;",editable:!1,data:[],scrollAlwaysVisible:!0,takeFocusOnClose:!0}),this.cmbType.on("selected",_.bind(this.onTypeSelect,this)),this.codesList=new Common.UI.ListView({el:$("#format-settings-list-code"),store:new Common.UI.DataViewStore,tabindex:1,itemTemplate:_.template('<div id="<%= id %>" class="list-item" style="pointer-events:none;overflow: hidden; text-overflow: ellipsis;"><%= value %></div>')}),this.codesList.on("item:select",_.bind(this.onCodeSelect,this)),this.codesList.on("entervalue",_.bind(this.onPrimary,this)),this.inputCustomFormat=new Common.UI.InputField({el:$("#format-settings-txt-code"),allowBlank:!0,validateOnChange:!0,validation:function(){return!0}}).on("changing",function(t,e){o.codesList.deselectAll(),o.Format=o.api.asc_convertNumFormatLocal2NumFormat(e),o.lblExample.text(o.api.asc_getLocaleExample(o.Format)),o.chLinked.setValue(!1,!0),o._state.warning||(t.showWarning([o.txtCustomWarning]),o._state.warning=!0)}),this.chLinked=new Common.UI.CheckBox({el:$("#format-settings-chk-linked"),labelText:this.textLinked}).on("change",function(t,e,i,s){o.props.linked="checked"==t.getValue(),o.props.linked&&(o.props.chartFormat.putSourceLinked(!0),o.props.format=o.props.chartFormat.getFormatCode(),o.props.formatInfo=o.props.chartFormat.getFormatCellsInfo(),o._setDefaults(o.props))}),this.chLinked.setVisible(this.linked),this._decimalPanel=this.$window.find(".format-decimal"),this._negativePanel=this.$window.find(".format-negative"),this._separatorPanel=this.$window.find(".format-separator"),this._typePanel=this.$window.find(".format-type"),this._symbolsPanel=this.$window.find(".format-symbols"),this._codePanel=this.$window.find(".format-code"),this._nocodePanel=this.$window.find(".format-no-code"),this.$window.find(".format-sample").toggleClass("hidden",this.linked),this.lblExample=this.$window.find("#format-settings-label-example"),this.afterRender()},getFocusedComponents:function(){return[this.cmbFormat,this.spnDecimal,this.chSeparator,this.cmbSymbols,this.cmbNegative,this.cmbType,this.inputCustomFormat,this.codesList,this.chLinked]},getDefaultFocusableComponent:function(){return this.cmbFormat},afterRender:function(){this._setDefaults(this.props)},show:function(){Common.Views.AdvancedSettingsWindow.prototype.show.apply(this,arguments)},_setDefaults:function(t){var e;t&&t.formatInfo&&(this.langId&&(this.langId=t.langId),this.cmbFormat.setValue(t.formatInfo.asc_getType(),this.txtCustom),this.FormatInfo=t.formatInfo,t.formatInfo.asc_getType()==Asc.c_oAscNumFormatType.Custom&&t.format&&(this.CustomFormat=this.Format=t.format),this.onFormatSelect(this.cmbFormat,this.cmbFormat.getSelectedRecord(),null,t.formatInfo),this._state.hasDecimal&&this.spnDecimal.setValue(t.formatInfo.asc_getDecimalPlaces()),this._state.hasSeparator&&this.chSeparator.setValue(t.formatInfo.asc_getSeparator()),this._state.hasSymbols&&this.cmbSymbols.setValue(t.formatInfo.asc_getSymbol()||t.formatInfo.asc_getCurrencySymbol()),t.format&&(this._state.hasNegative?(e=this.cmbNegative.store.findWhere({value:t.format}))?this.cmbNegative.selectRecord(e):this.cmbNegative.setValue(this.api.asc_getLocaleExample(t.format)):this._state.hasType&&((e=this.cmbType.store.findWhere({value:t.format}))?this.cmbType.selectRecord(e):t.formatInfo.asc_getType()==Asc.c_oAscNumFormatType.Fraction?this.cmbType.setValue(this.txtCustom):t.formatInfo.asc_getType()==Asc.c_oAscNumFormatType.Time?this.cmbType.setValue(this.api.asc_getLocaleExample(t.format,1.534)):this.cmbType.setValue(this.api.asc_getLocaleExample(t.format,38822))),this.Format=t.format,this.lblExample.text(this.api.asc_getLocaleExample(this.Format)))),t&&t.chartFormat&&this.chLinked.setValue(!!t.chartFormat.getSourceLinked(),!0)},getSettings:function(){return{format:this.Format,formatInfo:this.FormatInfo,linked:"checked"===this.chLinked.getValue()}},onDlgBtnClick:function(t){t="object"==typeof t?t.currentTarget.attributes.result.value:t;"ok"==t&&this.handler&&this.handler.call(this,t,"ok"==t?this.getSettings():void 0),this.close()},onPrimary:function(){return this.onDlgBtnClick("ok"),!1},onNegativeSelect:function(t,e){this.Format=e.value,this.lblExample.text(this.api.asc_getLocaleExample(this.Format)),this.chLinked.setValue(!1,!0)},onSymbolsSelect:function(t,e){var i=this,s=new Asc.asc_CFormatCellsInfo,e=(s.asc_setType(this.FormatType),s.asc_setDecimalPlaces(this.spnDecimal.getNumberValue()),s.asc_setSeparator(!1),"string"==typeof e.value?s.asc_setCurrencySymbol(e.value):s.asc_setSymbol(e.value),this.api.asc_getFormatCells(s)),o=[];e.forEach(function(t){o.push({value:t,displayValue:i.api.asc_getLocaleExample(t,-1234.1234567890124)})}),this.cmbNegative.setData(o),this.cmbNegative.selectRecord(this.cmbNegative.store.at(0)),this.cmbNegative.cmpEl.find("li:nth-child(2) a, li:nth-child(4) a").css({color:"#ff0000"}),this.Format=e[0],this.FormatInfo=s,this.lblExample.text(this.api.asc_getLocaleExample(this.Format)),this.chLinked.setValue(!1,!0)},onDecimalChange:function(t,e,i,s){var o,n=this,a=new Asc.asc_CFormatCellsInfo,t=(a.asc_setType(this.FormatType),a.asc_setDecimalPlaces(t.getNumberValue()),a.asc_setSeparator(this.FormatType==Asc.c_oAscNumFormatType.Number&&"checked"==this.chSeparator.getValue()),this.FormatType==Asc.c_oAscNumFormatType.Currency||this.FormatType==Asc.c_oAscNumFormatType.Accounting?"string"==typeof(t=this.cmbSymbols.getValue())?a.asc_setCurrencySymbol(t):a.asc_setSymbol(t):a.asc_setSymbol(!1),this.api.asc_getFormatCells(a));this.FormatType!=Asc.c_oAscNumFormatType.Number&&this.FormatType!=Asc.c_oAscNumFormatType.Currency&&this.FormatType!=Asc.c_oAscNumFormatType.Accounting||(o=[],t.forEach(function(t){o.push({value:t,displayValue:n.api.asc_getLocaleExample(t,-1234.1234567890124)})}),this.cmbNegative.setData(o),this.cmbNegative.selectRecord(this.cmbNegative.store.at(0)),this.cmbNegative.cmpEl.find("li:nth-child(2) a, li:nth-child(4) a").css({color:"#ff0000"})),this.Format=t[0],this.FormatInfo=a,this.lblExample.text(this.api.asc_getLocaleExample(this.Format)),this.chLinked.setValue(!1,!0)},onSeparatorChange:function(t,e,i,s){var o=this,n=new Asc.asc_CFormatCellsInfo,t=(n.asc_setType(this.FormatType),n.asc_setDecimalPlaces(this.spnDecimal.getNumberValue()),n.asc_setSeparator("checked"==t.getValue()),this.api.asc_getFormatCells(n)),a=[];t.forEach(function(t){a.push({value:t,displayValue:o.api.asc_getLocaleExample(t,-1234.1234567890124)})}),this.cmbNegative.setData(a),this.cmbNegative.selectRecord(this.cmbNegative.store.at(0)),this.cmbNegative.cmpEl.find("li:nth-child(2) a, li:nth-child(4) a").css({color:"#ff0000"}),this.Format=t[0],this.FormatInfo=n,this.lblExample.text(this.api.asc_getLocaleExample(this.Format)),this.chLinked.setValue(!1,!0)},onTypeSelect:function(t,e){this.Format=e.value,this.lblExample.text(this.api.asc_getLocaleExample(this.Format)),this.chLinked.setValue(!1,!0)},onCodeSelect:function(t,e,i){i&&(this.Format=i.get("format"),this.lblExample.text(this.api.asc_getLocaleExample(this.Format)),this.inputCustomFormat.setValue(i.get("value")),this.chLinked.setValue(!1,!0),this.inputCustomFormat.showWarning(),this._state.warning=!1)},onFormatSelect:function(t,e,i,s){if(e){this.FormatType=e.value;var o=e.value==Asc.c_oAscNumFormatType.Number||e.value==Asc.c_oAscNumFormatType.Scientific||e.value==Asc.c_oAscNumFormatType.Accounting||e.value==Asc.c_oAscNumFormatType.Currency||e.value==Asc.c_oAscNumFormatType.Percent,n=e.value==Asc.c_oAscNumFormatType.Number||e.value==Asc.c_oAscNumFormatType.Currency||e.value==Asc.c_oAscNumFormatType.Accounting,a=e.value==Asc.c_oAscNumFormatType.Number,l=e.value==Asc.c_oAscNumFormatType.Date||e.value==Asc.c_oAscNumFormatType.Time||e.value==Asc.c_oAscNumFormatType.Fraction,r=e.value==Asc.c_oAscNumFormatType.Accounting||e.value==Asc.c_oAscNumFormatType.Currency,c=e.value==Asc.c_oAscNumFormatType.Custom,d=this,h=s?s.asc_getDecimalPlaces():this.spnDecimal.getNumberValue(),p=s?s.asc_getSeparator():"checked"==this.chSeparator.getValue(),m=s?s.asc_getSymbol()||s.asc_getCurrencySymbol():this.langId;if(e.value!==Asc.c_oAscNumFormatType.Custom){if((S=new Asc.asc_CFormatCellsInfo).asc_setType(e.value),S.asc_setDecimalPlaces(o?h:0),S.asc_setSeparator(a&&p),n||e.value==Asc.c_oAscNumFormatType.Date||e.value==Asc.c_oAscNumFormatType.Time){if(r){if(!d.CurrencySymbolsData){d.CurrencySymbolsData=[];var u,g=this.api.asc_getCurrencySymbols();for(u in g)g.hasOwnProperty(u)&&d.CurrencySymbolsData.push({value:parseInt(u),displayValue:g[u]+" "+Common.util.LanguageInfo.getLocalLanguageName(u)[1]});d.CurrencySymbolsData.sort(function(t,e){return t.displayValue<e.displayValue?-1:t.displayValue>e.displayValue?1:0}),d.CurrencySymbolsData.unshift({value:null,displayValue:d.txtNone}),(g=this.api.asc_getAdditionalCurrencySymbols()).forEach(function(t){d.CurrencySymbolsData.push({value:t,displayValue:t})}),this.cmbSymbols.setData(this.CurrencySymbolsData),this.cmbSymbols.setValue(m)}S.asc_setSymbol(this.cmbSymbols.getValue())}var b=this.api.asc_getFormatCells(S),C=[],f=e.value==Asc.c_oAscNumFormatType.Date?38822:e.value==Asc.c_oAscNumFormatType.Time?1.534:parseFloat("-1234.12345678901234567890");b.forEach(function(t){C.push({value:t,displayValue:d.api.asc_getLocaleExample(t,f)})}),n?(this.cmbNegative.setData(C),this.cmbNegative.selectRecord(this.cmbNegative.store.at(0)),this.cmbNegative.cmpEl.find("li:nth-child(2) a, li:nth-child(4) a").css({color:"#ff0000"})):(this.cmbType.setData(C),this.cmbType.selectRecord(this.cmbType.store.at(0))),this.Format=b[0]}else e.value==Asc.c_oAscNumFormatType.Fraction?(this.cmbType.setData(this.FractionData),this.cmbType.selectRecord(this.cmbType.store.at(0)),this.Format=this.cmbType.getValue()):this.Format=this.api.asc_getFormatCells(S)[0];this.FormatInfo=S}else{(S=new Asc.asc_CFormatCellsInfo).asc_setType(Asc.c_oAscNumFormatType.Custom),S.asc_setSymbol(m),this.FormatInfo=S;var S,b=this.api.asc_getFormatCells(S),C=[],v=!!this.CustomFormat,w=(b.forEach(function(t){var e=new Common.UI.DataViewModel;e.set({value:d.api.asc_convertNumFormat2NumFormatLocal(t),format:t}),C.push(e),d.CustomFormat==t&&(v=!1)}),v&&((w=new Common.UI.DataViewModel).set({value:d.api.asc_convertNumFormat2NumFormatLocal(this.CustomFormat),format:this.CustomFormat}),C.push(w)),this.codesList.store.reset(C,{silent:!1}),this.codesList.store.findWhere({value:this.Format}));w&&this.codesList.selectRecord(w),w&&this.codesList.scrollToRecord(w),this.inputCustomFormat.setValue(d.api.asc_convertNumFormat2NumFormatLocal(this.Format))}this.lblExample.text(this.api.asc_getLocaleExample(this.Format)),this._decimalPanel.toggleClass("hidden",!o),this._negativePanel.toggleClass("hidden",!n),this._separatorPanel.toggleClass("hidden",!a),this._typePanel.toggleClass("hidden",!l),this._symbolsPanel.toggleClass("hidden",!r),this._codePanel.toggleClass("hidden",!c),this._nocodePanel.toggleClass("hidden",c),this._state={hasDecimal:o,hasNegative:n,hasSeparator:a,hasType:l,hasSymbols:r,hasCode:c},s||this.chLinked.setValue(!1,!0)}}},SSE.Views.FormatSettingsDialog||{}))}),define("spreadsheeteditor/main/app/view/FieldSettingsDialog",["text!spreadsheeteditor/main/app/template/FieldSettingsDialog.template","common/main/lib/util/utils","common/main/lib/component/InputField","common/main/lib/component/ComboBox","common/main/lib/component/CheckBox","common/main/lib/view/AdvancedSettingsWindow","spreadsheeteditor/main/app/view/FormatSettingsDialog"],function(e){"use strict";SSE.Views.FieldSettingsDialog=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:284,height:450,toggleGroup:"pivot-field-settings-group",storageName:"sse-pivot-field-settings-category"},initialize:function(t){_.extend(this.options,{title:this.textTitle,items:[{panelId:"id-pivot-field-settings-layout",panelCaption:this.strLayout},{panelId:"id-pivot-field-settings-subtotals",panelCaption:this.strSubtotals}],contentTemplate:_.template(e)({scope:this})},t),this.api=t.api,this.handler=t.handler,this.props=t.props,this.fieldIndex=t.fieldIndex||0,this.type=t.type||0,this.format={formatStr:"General"},Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);this.inputCustomName=new Common.UI.InputField({el:$("#field-settings-custom"),allowBlank:!0,validateOnBlur:!1,style:"width: 100%;"}),this.lblSourceName=this.$window.find("#field-settings-source"),this.radioTabular=new Common.UI.RadioBox({el:$("#field-settings-radio-tab"),labelText:this.txtTabular,name:"asc-radio-report-form"}),this.radioOutline=new Common.UI.RadioBox({el:$("#field-settings-radio-outline"),labelText:this.txtOutline,name:"asc-radio-report-form",checked:!0}),this.chCompact=new Common.UI.CheckBox({el:$("#field-settings-chk-compact"),labelText:this.txtCompact}),this.chRepeat=new Common.UI.CheckBox({el:$("#field-settings-chk-repeat"),labelText:this.txtRepeat}),this.chBlank=new Common.UI.CheckBox({el:$("#field-settings-chk-blank"),labelText:this.txtBlank}),this.chSubtotals=new Common.UI.CheckBox({el:$("#field-settings-chk-subtotals"),labelText:this.txtShowSubtotals}),this.radioTop=new Common.UI.RadioBox({el:$("#field-settings-radio-top"),labelText:this.txtTop,name:"asc-radio-show-subtotals"}),this.radioBottom=new Common.UI.RadioBox({el:$("#field-settings-radio-bottom"),labelText:this.txtBottom,name:"asc-radio-show-subtotals",checked:!0}),this.chEmpty=new Common.UI.CheckBox({el:$("#field-settings-chk-empty"),labelText:this.txtEmpty}),this.chSum=new Common.UI.CheckBox({el:$("#field-settings-chk-sum"),labelText:this.txtSum}),this.chCount=new Common.UI.CheckBox({el:$("#field-settings-chk-count"),labelText:this.txtCount}),this.chAve=new Common.UI.CheckBox({el:$("#field-settings-chk-ave"),labelText:this.txtAverage}),this.chMax=new Common.UI.CheckBox({el:$("#field-settings-chk-max"),labelText:this.txtMax}),this.chMin=new Common.UI.CheckBox({el:$("#field-settings-chk-min"),labelText:this.txtMin}),this.chProduct=new Common.UI.CheckBox({el:$("#field-settings-chk-product"),labelText:this.txtProduct}),this.chNum=new Common.UI.CheckBox({el:$("#field-settings-chk-num"),labelText:this.txtCountNums}),this.chDev=new Common.UI.CheckBox({el:$("#field-settings-chk-dev"),labelText:this.txtStdDev}),this.chDevp=new Common.UI.CheckBox({el:$("#field-settings-chk-devp"),labelText:this.txtStdDevp}),this.chVar=new Common.UI.CheckBox({el:$("#field-settings-chk-var"),labelText:this.txtVar}),this.chVarp=new Common.UI.CheckBox({el:$("#field-settings-chk-varp"),labelText:this.txtVarp}),this.btnFormat=new Common.UI.Button({parentEl:$("#field-settings-numformat"),cls:"btn-text-default",style:"width: 128px;",caption:this.textNumFormat}),this.btnFormat.on("click",_.bind(this.openFormat,this)),this.afterRender()},getFocusedComponents:function(){return[this.inputCustomName,this.radioTabular,this.radioOutline,this.chCompact,this.btnFormat,this.chRepeat,this.chBlank,this.chSubtotals,this.radioTop,this.radioBottom,this.chEmpty,this.chSum,this.chCount,this.chAve,this.chMax,this.chMin,this.chProduct,this.chNum,this.chDev,this.chDevp,this.chVar,this.chVarp]},onCategoryClick:function(t,e){Common.Views.AdvancedSettingsWindow.prototype.onCategoryClick.call(this,t,e);var i=this;setTimeout(function(){switch(e){case 0:i.inputCustomName.focus();break;case 1:i.chSum.focus()}},10)},afterRender:function(){var t;this._setDefaults(this.props),this.storageName&&(t=Common.localStorage.getItem(this.storageName),this.setActiveCategory(null!==t?parseInt(t):0))},show:function(){Common.Views.AdvancedSettingsWindow.prototype.show.apply(this,arguments)},_setDefaults:function(t){var e,i;t&&(e=this,i=t.asc_getPivotFields()[this.fieldIndex],this.format.formatStr=i.asc_getNumFormat(),this.format.formatInfo=i.asc_getNumFormatInfo(),this.lblSourceName.html(Common.Utils.String.htmlEncode(t.getCacheFieldName(this.fieldIndex))),this.inputCustomName.setValue(Common.Utils.String.htmlEncode(t.getPivotFieldName(this.fieldIndex))),(i.asc_getOutline()?this.radioOutline:this.radioTabular).setValue(!0),this.chCompact.setValue(i.asc_getOutline()&&i.asc_getCompact()),this.chRepeat.setValue(i.asc_getFillDownLabelsDefault()),this.chBlank.setValue(i.asc_getInsertBlankRow()),this.chSubtotals.setValue(i.asc_getDefaultSubtotal()),(i.asc_getSubtotalTop()?this.radioTop:this.radioBottom).setValue(!0),this.chEmpty.setValue(i.asc_getShowAll()),i.asc_getDefaultSubtotal()&&(i=i.asc_getSubtotals())&&_.each(i,function(t){switch(t){case Asc.c_oAscItemType.Sum:e.chSum.setValue(!0);break;case Asc.c_oAscItemType.Count:e.chNum.setValue(!0);break;case Asc.c_oAscItemType.Avg:e.chAve.setValue(!0);break;case Asc.c_oAscItemType.Max:e.chMax.setValue(!0);break;case Asc.c_oAscItemType.Min:e.chMin.setValue(!0);break;case Asc.c_oAscItemType.Product:e.chProduct.setValue(!0);break;case Asc.c_oAscItemType.CountA:e.chCount.setValue(!0);break;case Asc.c_oAscItemType.StdDev:e.chDev.setValue(!0);break;case Asc.c_oAscItemType.StdDevP:e.chDevp.setValue(!0);break;case Asc.c_oAscItemType.Var:e.chVar.setValue(!0);break;case Asc.c_oAscItemType.VarP:e.chVarp.setValue(!0)}}),this.btnFormat.setVisible(t.asc_getFieldGroupType(this.fieldIndex)!==Asc.c_oAscGroupType.Text))},getSettings:function(){var t,e=new Asc.CT_PivotField;return e.asc_setName(this.inputCustomName.getValue()),e.asc_setOutline(this.radioOutline.getValue()),e.asc_setCompact(this.radioOutline.getValue()&&"checked"==this.chCompact.getValue()),e.asc_setFillDownLabelsDefault("checked"==this.chRepeat.getValue()),e.asc_setInsertBlankRow("checked"==this.chBlank.getValue()),e.asc_setDefaultSubtotal("checked"==this.chSubtotals.getValue()),e.asc_setSubtotalTop(this.radioTop.getValue()),e.asc_setShowAll("checked"==this.chEmpty.getValue()),e.asc_getDefaultSubtotal()&&(t=[],"checked"==this.chSum.getValue()&&t.push(Asc.c_oAscItemType.Sum),"checked"==this.chNum.getValue()&&t.push(Asc.c_oAscItemType.Count),"checked"==this.chAve.getValue()&&t.push(Asc.c_oAscItemType.Avg),"checked"==this.chMax.getValue()&&t.push(Asc.c_oAscItemType.Max),"checked"==this.chMin.getValue()&&t.push(Asc.c_oAscItemType.Min),"checked"==this.chProduct.getValue()&&t.push(Asc.c_oAscItemType.Product),"checked"==this.chCount.getValue()&&t.push(Asc.c_oAscItemType.CountA),"checked"==this.chDev.getValue()&&t.push(Asc.c_oAscItemType.StdDev),"checked"==this.chDevp.getValue()&&t.push(Asc.c_oAscItemType.StdDevP),"checked"==this.chVar.getValue()&&t.push(Asc.c_oAscItemType.Var),"checked"==this.chVarp.getValue()&&t.push(Asc.c_oAscItemType.VarP),e.asc_setSubtotals(t)),this.format.isChanged&&e.asc_setNumFormat(this.format.formatStr),e},onDlgBtnClick:function(t){t="object"==typeof t?t.currentTarget.attributes.result.value:t;"ok"==t&&this.handler&&this.handler.call(this,t,"ok"==t?this.getSettings():void 0),this.close()},onPrimary:function(){return this.onDlgBtnClick("ok"),!1},openFormat:function(){var i=this,t=i.api.asc_getLocale(),e=Common.Utils.InternalSettings.get("sse-config-lang"),t=t||(e?parseInt(Common.util.LanguageInfo.getLocalLanguageCode(e)):1033);new SSE.Views.FormatSettingsDialog({api:i.api,handler:function(t,e){"ok"==t&&e&&(i.format.isChanged=!0,i.format.formatStr=e.format,i.format.formatInfo=e.formatInfo)},props:{format:this.format.formatStr,formatInfo:this.format.formatInfo,langId:t}}).on("close",function(){i.btnFormat.cmpEl.focus()}).show()}},SSE.Views.FieldSettingsDialog||{}))}),define("spreadsheeteditor/main/app/view/ValueFieldSettingsDialog",["common/main/lib/util/utils","common/main/lib/component/InputField","common/main/lib/component/ComboBox","common/main/lib/view/AdvancedSettingsWindow","spreadsheeteditor/main/app/view/FormatSettingsDialog"],function(){"use strict";SSE.Views.ValueFieldSettingsDialog=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:284,height:320},initialize:function(t){_.extend(this.options,{title:this.textTitle,template:['<div class="box" style="height:'+(this.options.height-85)+'px;">','<div class="content-panel" style="padding: 0 10px;"><div class="inner-content">','<div class="settings-panel active">','<table cols="2" style="width: 100%;">',"<tr>",'<td colspan="2" class="padding-small" style="white-space: nowrap;">','<label class="header" class="margin-right-4" style="vertical-align: middle;">'+this.txtSourceName+"</label>",'<label id="value-field-settings-source" style="vertical-align: middle; max-width: 220px; overflow: hidden; text-overflow: ellipsis;"></label>',"</td>","</tr>","<tr>",'<td colspan="2" class="padding-large">','<label class="header">',this.txtCustomName,"</label>",'<div id="value-field-settings-custom" style="width:264px;"></div>',"</td>","</tr>","<tr>",'<td colspan="2" class="padding-large">','<label class="header">',this.txtSummarize,"</label>",'<div id="value-field-settings-summarize" class="input-group-nr" style="width:264px;"></div>',"</td>","</tr>","<tr>",'<td colspan="2" class="padding-large">','<label class="header" style="display:block;">',this.txtShowAs,"</label>",'<div id="value-field-settings-showas" class="input-group-nr float-left" style="width:128px;"></div>','<div id="value-field-settings-numformat" class="float-right" style="width:128px;"></div>',"</td>","</tr>",'<tr class="format-code">',"<td>",'<label class="header">',this.txtBaseField,"</label>",'<div id="value-field-settings-field" class="input-group-nr" style="width:128px;"></div>',"</td>",'<td class="float-right">','<label class="header">',this.txtBaseItem,"</label>",'<div id="value-field-settings-item" class="input-group-nr" style="width:128px;"></div>',"</td>","</tr>","</table>","</div></div>","</div>","</div>"].join("")},t),this.api=t.api,this.handler=t.handler,this.props=t.props,this.field=t.field||0,this.showAsValue=t.showAsValue,this.baseFieldChanged=!1,Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);this.inputCustomName=new Common.UI.InputField({el:$("#value-field-settings-custom"),allowBlank:!0,validateOnBlur:!1,style:"width: 100%;"}),this.cmbSummarize=new Common.UI.ComboBox({el:$("#value-field-settings-summarize"),cls:"input-group-nr",menuStyle:"min-width: 264px;max-height:160px;",scrollAlwaysVisible:!0,editable:!1,takeFocusOnClose:!0,data:[{value:Asc.c_oAscDataConsolidateFunction.Sum,displayValue:this.txtSum},{value:Asc.c_oAscDataConsolidateFunction.Count,displayValue:this.txtCount},{value:Asc.c_oAscDataConsolidateFunction.Average,displayValue:this.txtAverage},{value:Asc.c_oAscDataConsolidateFunction.Max,displayValue:this.txtMax},{value:Asc.c_oAscDataConsolidateFunction.Min,displayValue:this.txtMin},{value:Asc.c_oAscDataConsolidateFunction.Product,displayValue:this.txtProduct},{value:Asc.c_oAscDataConsolidateFunction.CountNums,displayValue:this.txtCountNums},{value:Asc.c_oAscDataConsolidateFunction.StdDev,displayValue:this.txtStdDev},{value:Asc.c_oAscDataConsolidateFunction.StdDevp,displayValue:this.txtStdDevp},{value:Asc.c_oAscDataConsolidateFunction.Var,displayValue:this.txtVar},{value:Asc.c_oAscDataConsolidateFunction.Varp,displayValue:this.txtVarp}]}),this.cmbSummarize.setValue(Asc.c_oAscDataConsolidateFunction.Sum),this.cmbSummarize.on("selected",_.bind(this.onSummarizeSelect,this)),this.cmbShowAs=new Common.UI.ComboBox({el:$("#value-field-settings-showas"),cls:"input-group-nr",menuStyle:"min-width: 264px;max-height:160px;",editable:!1,takeFocusOnClose:!0,data:[{value:Asc.c_oAscShowDataAs.Normal,displayValue:this.txtNormal,numFormat:Asc.c_oAscNumFormatType.General},{value:Asc.c_oAscShowDataAs.PercentOfTotal,displayValue:this.txtPercentOfGrand,numFormat:Asc.c_oAscNumFormatType.Percent},{value:Asc.c_oAscShowDataAs.PercentOfCol,displayValue:this.txtPercentOfCol,numFormat:Asc.c_oAscNumFormatType.Percent},{value:Asc.c_oAscShowDataAs.PercentOfRow,displayValue:this.txtPercentOfTotal,numFormat:Asc.c_oAscNumFormatType.Percent},{value:Asc.c_oAscShowDataAs.Percent,displayValue:this.txtPercent,numFormat:Asc.c_oAscNumFormatType.Percent},{value:Asc.c_oAscShowDataAs.PercentOfParentRow,displayValue:this.txtPercentOfParentRow,numFormat:Asc.c_oAscNumFormatType.Percent},{value:Asc.c_oAscShowDataAs.PercentOfParentCol,displayValue:this.txtPercentOfParentCol,numFormat:Asc.c_oAscNumFormatType.Percent},{value:Asc.c_oAscShowDataAs.PercentOfParent,displayValue:this.txtPercentOfParent,numFormat:Asc.c_oAscNumFormatType.Percent},{value:Asc.c_oAscShowDataAs.Difference,displayValue:this.txtDifference,numFormat:Asc.c_oAscNumFormatType.General},{value:Asc.c_oAscShowDataAs.PercentDiff,displayValue:this.txtPercentDiff,numFormat:Asc.c_oAscNumFormatType.Percent},{value:Asc.c_oAscShowDataAs.RunTotal,displayValue:this.txtRunTotal,numFormat:Asc.c_oAscNumFormatType.General},{value:Asc.c_oAscShowDataAs.PercentOfRunningTotal,displayValue:this.txtPercentOfRunTotal,numFormat:Asc.c_oAscNumFormatType.Percent},{value:Asc.c_oAscShowDataAs.RankAscending,displayValue:this.txtRankAscending,numFormat:Asc.c_oAscNumFormatType.General},{value:Asc.c_oAscShowDataAs.RankDescending,displayValue:this.txtRankDescending,numFormat:Asc.c_oAscNumFormatType.General},{value:Asc.c_oAscShowDataAs.Index,displayValue:this.txtIndex,numFormat:Asc.c_oAscNumFormatType.General}]}),this.cmbShowAs.setValue(Asc.c_oAscShowDataAs.Normal),this.cmbShowAs.on("selected",_.bind(this.onShowAsSelect,this)),this.cmbBaseField=new Common.UI.ComboBox({el:$("#value-field-settings-field"),cls:"input-group-nr",menuStyle:"min-width: 100%;max-height:160px;",editable:!1,takeFocusOnClose:!0,data:[],scrollAlwaysVisible:!0}),this.cmbBaseField.on("selected",_.bind(this.onBaseFieldSelect,this)),this.cmbBaseItem=new Common.UI.ComboBox({el:$("#value-field-settings-item"),cls:"input-group-nr",menuStyle:"min-width: 100%;max-height:160px;",editable:!1,takeFocusOnClose:!0,data:[],scrollAlwaysVisible:!0}),this.cmbBaseItem.on("selected",_.bind(this.onBaseItemSelect,this)),this.lblSourceName=this.$window.find("#value-field-settings-source"),this.btnFormat=new Common.UI.Button({parentEl:$("#value-field-settings-numformat"),cls:"btn-text-default",style:"width: 128px;",caption:this.textNumFormat}),this.btnFormat.on("click",_.bind(this.openFormat,this)),this.afterRender()},getFocusedComponents:function(){return[this.inputCustomName,this.cmbSummarize,this.cmbShowAs,this.btnFormat,this.cmbBaseField,this.cmbBaseItem]},getDefaultFocusableComponent:function(){return this.inputCustomName},afterRender:function(){this._setDefaults(this.props)},_setDefaults:function(t){this.format={defFormats:[]};var i,s,e,o,n=new Asc.asc_CFormatCellsInfo;n.asc_setType(Asc.c_oAscNumFormatType.General),n.asc_setDecimalPlaces(0),n.asc_setSeparator(!1),this.format.defFormats[Asc.c_oAscNumFormatType.General]={formatStr:this.api.asc_getFormatCells(n)[0],formatInfo:n},(n=new Asc.asc_CFormatCellsInfo).asc_setType(Asc.c_oAscNumFormatType.Percent),n.asc_setDecimalPlaces(2),n.asc_setSeparator(!1),this.format.defFormats[Asc.c_oAscNumFormatType.Percent]={formatStr:this.api.asc_getFormatCells(n)[0],formatInfo:n},t&&(n=this.field,(i=this).cache_names=t.asc_getCacheFields(),this.pivot_names=t.asc_getPivotFields(),this.format.formatStr=n.asc_getNumFormat(),this.format.formatInfo=n.asc_getNumFormatInfo(),this.lblSourceName.html(Common.Utils.String.htmlEncode(this.cache_names[n.asc_getIndex()].asc_getName())),this.inputCustomName.setValue(Common.Utils.String.htmlEncode(n.asc_getName())),this.cmbSummarize.setValue(n.asc_getSubtotal()),t=n.asc_getShowDataAs(),this.cmbShowAs.setValue(t),this.format.show_as=t,s=[],this.pivot_names.forEach(function(t,e){s.push({value:e,displayValue:t.asc_getName()||i.cache_names[e].asc_getName()})}),e=this.api.asc_getPivotShowValueAsInfo(Asc.c_oAscShowDataAs.Difference),this.cmbBaseField.setData(s),o=t===Asc.c_oAscShowDataAs.Normal||t===Asc.c_oAscShowDataAs.PercentOfTotal||t===Asc.c_oAscShowDataAs.PercentOfRow||t===Asc.c_oAscShowDataAs.PercentOfCol||t===Asc.c_oAscShowDataAs.PercentOfParentRow||t===Asc.c_oAscShowDataAs.PercentOfParentCol||t===Asc.c_oAscShowDataAs.Index,this.cmbBaseField.setDisabled(o),this.cmbBaseField.setValue((o&&e?e:n).asc_getBaseField(),""),s=[],this.pivot_names[n.asc_getBaseField()].asc_getBaseItemObject(this.cache_names[n.asc_getBaseField()]).forEach(function(t,e){s.push({value:t.baseItem,displayValue:0===e?i.textPrev:1===e?i.textNext:t.name})}),this.cmbBaseItem.setData(s),this.cmbBaseItem.setDisabled(s.length<1||t!==Asc.c_oAscShowDataAs.Difference&&t!==Asc.c_oAscShowDataAs.Percent&&t!==Asc.c_oAscShowDataAs.PercentDiff),this.cmbBaseItem.setValue(0<s.length&&(t===Asc.c_oAscShowDataAs.Difference||t===Asc.c_oAscShowDataAs.Percent||t===Asc.c_oAscShowDataAs.PercentDiff)?n.asc_getBaseItem():"",""),this.btnFormat.setDisabled(this.props.asc_getFieldGroupType(n.asc_getIndex())===Asc.c_oAscGroupType.Text),this.getDefFormat(t)===Asc.c_oAscNumFormatType.General&&(this.format.defFormats[Asc.c_oAscNumFormatType.General]={formatStr:this.format.formatStr,formatInfo:this.format.formatInfo})),void 0!==this.showAsValue&&(this.cmbShowAs.setValue(this.showAsValue),this.onShowAsSelect(this.cmbShowAs,this.cmbShowAs.getSelectedRecord()))},getSettings:function(){var t=new Asc.CT_DataField;return t.asc_setName(this.inputCustomName.getValue()),t.asc_setSubtotal(this.cmbSummarize.getValue()),t.asc_setShowDataAs(this.cmbShowAs.getValue()),this.format.isChanged&&this.cmbShowAs.getSelectedRecord()&&t.asc_setNumFormat(this.format.formatStr),this.cmbBaseField.isDisabled()||t.asc_setBaseField(this.cmbBaseField.getValue()),this.cmbBaseItem.isDisabled()||t.asc_setBaseItem(this.cmbBaseItem.getValue()),t},onDlgBtnClick:function(t){t="object"==typeof t?t.currentTarget.attributes.result.value:t;"ok"==t&&this.handler&&this.handler.call(this,t,"ok"==t?this.getSettings():void 0),this.close()},onPrimary:function(){return this.onDlgBtnClick("ok"),!1},onSummarizeSelect:function(t,e){this.inputCustomName.setValue(this.txtByField.replace("%1",e.displayValue).replace("%2",this.lblSourceName.text()))},onShowAsSelect:function(t,e){var e=e.value,i=e===Asc.c_oAscShowDataAs.Normal||e===Asc.c_oAscShowDataAs.PercentOfTotal||e===Asc.c_oAscShowDataAs.PercentOfRow||e===Asc.c_oAscShowDataAs.PercentOfCol||e===Asc.c_oAscShowDataAs.PercentOfParentRow||e===Asc.c_oAscShowDataAs.PercentOfParentCol||e===Asc.c_oAscShowDataAs.Index,i=(this.cmbBaseField.setDisabled(i),this.baseFieldChanged?this.cmbBaseItem.setValue((e===Asc.c_oAscShowDataAs.Difference||e===Asc.c_oAscShowDataAs.Percent||e===Asc.c_oAscShowDataAs.PercentDiff)&&0<this.cmbBaseItem.store.length?this.cmbBaseItem.store.at(2<this.cmbBaseItem.store.length?2:0).get("value"):"",""):(i=this.api.asc_getPivotShowValueAsInfo(e))&&(this.cmbBaseField.setValue(i.asc_getBaseField(),""),this.cmbBaseField.getSelectedRecord()&&this.changeBaseField(i.asc_getBaseItem())),this.cmbBaseItem.setDisabled(this.cmbBaseItem.store.length<1||e!==Asc.c_oAscShowDataAs.Difference&&e!==Asc.c_oAscShowDataAs.Percent&&e!==Asc.c_oAscShowDataAs.PercentDiff),this.getDefFormat(e));i!==this.getDefFormat(this.format.show_as)&&(this.format.isChanged=!0,this.format.formatStr=this.format.defFormats[i].formatStr,this.format.formatInfo=this.format.defFormats[i].formatInfo),this.format.show_as=e},onBaseFieldSelect:function(t,e){this.changeBaseField(),this.baseFieldChanged=!0},changeBaseField:function(t){var e=this.cmbBaseField.getValue(),e=this.pivot_names[e].asc_getBaseItemObject(this.cache_names[e]),i=[],s=this,e=(e.forEach(function(t,e){i.push({value:t.baseItem,displayValue:0===e?s.textPrev:1===e?s.textNext:t.name})}),this.cmbBaseItem.setData(i),void 0===t&&0<i.length&&(t=this.cmbBaseItem.store.at(2<i.length?2:0).get("value")),this.cmbShowAs.getValue());this.cmbBaseItem.setDisabled(i.length<1||e!==Asc.c_oAscShowDataAs.Difference&&e!==Asc.c_oAscShowDataAs.Percent&&e!==Asc.c_oAscShowDataAs.PercentDiff),this.cmbBaseItem.setValue((e===Asc.c_oAscShowDataAs.Difference||e===Asc.c_oAscShowDataAs.Percent||e===Asc.c_oAscShowDataAs.PercentDiff)&&0<i.length?t:"","")},onBaseItemSelect:function(t,e){},openFormat:function(){var i=this,t=i.api.asc_getLocale(),e=Common.Utils.InternalSettings.get("sse-config-lang"),t=t||(e?parseInt(Common.util.LanguageInfo.getLocalLanguageCode(e)):1033);new SSE.Views.FormatSettingsDialog({api:i.api,handler:function(t,e){"ok"==t&&e&&(i.format.isChanged=!0,i.format.formatStr=e.format,i.format.formatInfo=e.formatInfo,i.getDefFormat(i.format.show_as)===Asc.c_oAscNumFormatType.General&&(i.format.defFormats[Asc.c_oAscNumFormatType.General].formatStr=e.format,i.format.defFormats[Asc.c_oAscNumFormatType.General].formatInfo=e.formatInfo))},props:{format:this.format.formatStr,formatInfo:this.format.formatInfo,langId:t}}).on("close",function(){i.btnFormat.cmpEl.focus()}).show()},getDefFormat:function(t){return t===Asc.c_oAscShowDataAs.Normal||t===Asc.c_oAscShowDataAs.Difference||t===Asc.c_oAscShowDataAs.RunTotal||t===Asc.c_oAscShowDataAs.RankAscending||t===Asc.c_oAscShowDataAs.RankDescending||t===Asc.c_oAscShowDataAs.Index?Asc.c_oAscNumFormatType.General:Asc.c_oAscNumFormatType.Percent}},SSE.Views.ValueFieldSettingsDialog||{}))}),define("text!spreadsheeteditor/main/app/template/PivotSettingsAdvanced.template",[],function(){return'<div id="id-adv-pivot-layout" class="settings-panel active">\n    <div class="inner-content">\n        <table cols="2" style="width: 100%;">\n            <tr>\n                <td colspan="2" class="padding-large">\n                    <label class="header"><%= scope.txtName %></label>\n                    <div id="pivot-adv-name"></div>\n                </td>\n            </tr>\n            <tr>\n                <td colspan="2" class="padding-small">\n                    <label class="header"><%= scope.textGrandTotals %></label>\n                </td>\n            </tr>\n            <tr>\n                <td colspan="2" class="padding-small">\n                    <div id="pivot-adv-chk-show-rows"></div>\n                </td>\n            </tr>\n            <tr>\n                <td colspan="2" class="padding-large">\n                    <div id="pivot-adv-chk-show-columns"></div>\n                </td>\n            </tr>\n            <tr>\n                <td colspan="2" class="padding-small">\n                    <label class="header"><%= scope.textDisplayFields %></label>\n                </td>\n            </tr>\n            <tr>\n                <td colspan="2" class="padding-small">\n                    <div id="pivot-adv-radio-down"></div>\n                </td>\n            </tr>\n            <tr>\n                <td colspan="2" class="padding-small">\n                    <div id="pivot-adv-radio-over"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-large">\n                    <label id="pivot-adv-label-wrap" class="input-label"></label>\n                </td>\n                <td class="padding-large">\n                    <div id="pivot-adv-spin-wrap" class="float-right" style="width: 85px;"></div>\n                </td>\n            </tr>\n            <tr>\n                <td colspan="2" class="padding-small">\n                    <div id="pivot-adv-chk-show-headers"></div>\n                </td>\n            </tr>\n            <tr>\n                <td colspan="2" class="padding-small">\n                    <div id="pivot-adv-chk-autofit-col-width"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-adv-pivot-data" class="settings-panel">\n    <div class="inner-content">\n        <table cols="1" style="width: 100%;">\n            <tr>\n                <td>\n                    <label class="header"><%= scope.textDataRange %></label>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small" width="220">\n                    <div id="pivot-adv-txt-range" class="input-row"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-adv-pivot-alttext" class="settings-panel">\n    <div class="inner-content">\n        <table cols="1" width="100%">\n            <tr>\n                <td class="padding-large">\n                    <label class="header"><%= scope.textAltTitle %></label>\n                    <div id="pivot-advanced-alt-title"></div>\n                </td>\n            </tr>\n            <tr>\n                <td>\n                    <label class="header"><%= scope.textAltDescription %></label>\n                    <textarea id="pivot-advanced-alt-description" class="form-control" style="width: 100%; height: 70px;"></textarea>\n                </td>\n            </tr>\n            <tr>\n                <td>\n                    <label><%= scope.textAltTip %></label>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>'}),define("spreadsheeteditor/main/app/view/PivotSettingsAdvanced",["text!spreadsheeteditor/main/app/template/PivotSettingsAdvanced.template","common/main/lib/util/utils","common/main/lib/component/InputField","common/main/lib/component/ComboBox","common/main/lib/component/CheckBox","common/main/lib/component/MetricSpinner","common/main/lib/view/AdvancedSettingsWindow"],function(t){"use strict";SSE.Views.PivotSettingsAdvanced=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:310,height:440,toggleGroup:"pivot-adv-settings-group",storageName:"sse-pivot-adv-settings-category"},initialize:function(i){_.extend(this.options,{title:this.textTitle,items:[{panelId:"id-adv-pivot-layout",panelCaption:this.strLayout},{panelId:"id-adv-pivot-data",panelCaption:this.textDataSource},{panelId:"id-adv-pivot-alttext",panelCaption:this.textAlt}],contentTemplate:_.template(t)({scope:this})},i),this.api=i.api,this.props=i.props,this.options.handler=function(t,e){if("ok"==t&&!this.isRangeValid())return!0;i.handler&&i.handler.call(this,t,e)},Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var e=this;this.inputName=new Common.UI.InputField({el:$("#pivot-adv-name"),allowBlank:!0,validateOnBlur:!1,style:"width: 100%;"}),this.radioDown=new Common.UI.RadioBox({el:$("#pivot-adv-radio-down"),labelText:this.textDown,name:"asc-radio-display-field",checked:!0}),this.radioDown.on("change",_.bind(function(t,e,i){e&&this.lblPageWrap.html(this.textWrapCol)},this)),this.radioOver=new Common.UI.RadioBox({el:$("#pivot-adv-radio-over"),labelText:this.textOver,name:"asc-radio-display-field"}),this.radioOver.on("change",_.bind(function(t,e,i){e&&this.lblPageWrap.html(this.textWrapRow)},this)),this.chRows=new Common.UI.CheckBox({el:$("#pivot-adv-chk-show-rows"),labelText:this.textShowRows}),this.chCols=new Common.UI.CheckBox({el:$("#pivot-adv-chk-show-columns"),labelText:this.textShowCols}),this.numWrap=new Common.UI.MetricSpinner({el:$("#pivot-adv-spin-wrap"),step:1,width:60,allowDecimal:!1,defaultUnit:"",value:"0",maxValue:255,minValue:0}),this.lblPageWrap=this.$window.find("#pivot-adv-label-wrap"),this.chHeaders=new Common.UI.CheckBox({el:$("#pivot-adv-chk-show-headers"),labelText:this.textShowHeaders}),this.chAutofitColWidth=new Common.UI.CheckBox({el:$("#pivot-adv-chk-autofit-col-width"),labelText:this.textAutofitColWidth}),this.txtDataRange=new Common.UI.InputFieldBtn({el:$("#pivot-adv-txt-range"),name:"range",style:"width: 100%;",btnHint:this.textSelectData,allowBlank:!0,blankError:this.txtEmpty,validateOnChange:!0}),this.txtDataRange.on("button:click",_.bind(this.onSelectData,this)),this.inputAltTitle=new Common.UI.InputField({el:$("#pivot-advanced-alt-title"),allowBlank:!0,validateOnBlur:!1,style:"width: 100%;"}).on("changed:after",function(){e.isAltTitleChanged=!0}),this.textareaAltDescription=this.$window.find("textarea"),this.textareaAltDescription.keydown(function(t){t.keyCode==Common.UI.Keys.RETURN&&t.stopPropagation(),e.isAltDescChanged=!0}),this.afterRender()},getFocusedComponents:function(){return[this.inputName,this.chRows,this.chCols,this.radioDown,this.radioOver,this.numWrap,this.chHeaders,this.chAutofitColWidth,this.txtDataRange,this.inputAltTitle,this.textareaAltDescription]},onCategoryClick:function(t,e){Common.Views.AdvancedSettingsWindow.prototype.onCategoryClick.call(this,t,e);var i=this;setTimeout(function(){switch(e){case 0:i.inputName.focus();break;case 1:i.txtDataRange.focus();break;case 2:i.inputAltTitle.focus()}},10)},afterRender:function(){var t;this._setDefaults(this.props),this.storageName&&(t=Common.localStorage.getItem(this.storageName),this.setActiveCategory(null!==t?parseInt(t):0))},show:function(){Common.Views.AdvancedSettingsWindow.prototype.show.apply(this,arguments)},_setDefaults:function(t){var e,i;t&&((e=this).inputName.setValue(Common.Utils.String.htmlEncode(t.asc_getName())),this.chCols.setValue(t.asc_getRowGrandTotals(),!0),this.chRows.setValue(t.asc_getColGrandTotals(),!0),(t.asc_getPageOverThenDown()?this.radioOver:this.radioDown).setValue(!0),this.lblPageWrap.html(t.asc_getPageOverThenDown()?this.textWrapRow:this.textWrapCol),this.numWrap.setValue(t.asc_getPageWrap()),this.chHeaders.setValue(t.asc_getShowHeaders(),!0),this.chAutofitColWidth.setValue(t.asc_getUseAutoFormatting(),!0),i=t.asc_getDataRef(),this.txtDataRange.setValue(i||""),this.dataRangeValid=i,this.txtDataRange.validation=function(t){return e.api.asc_checkDataRange(Asc.c_oAscSelectionDialogType.PivotTableData,t,!1)!=Asc.c_oAscError.ID.DataRangeError||e.textInvalidRange},i=t.asc_getTitle(),this.inputAltTitle.setValue(i||""),i=t.asc_getDescription(),this.textareaAltDescription.val(i||""))},getSettings:function(){var t=new Asc.CT_pivotTableDefinition;return t.asc_setName(this.inputName.getValue()),t.asc_setRowGrandTotals("checked"==this.chCols.getValue()),t.asc_setColGrandTotals("checked"==this.chRows.getValue()),t.asc_setPageOverThenDown(this.radioOver.getValue()),t.asc_setPageWrap(this.numWrap.getNumberValue()),t.asc_setShowHeaders("checked"==this.chHeaders.getValue()),t.asc_setUseAutoFormatting("checked"==this.chAutofitColWidth.getValue()),t.asc_setDataRef(this.txtDataRange.getValue()),this.isAltTitleChanged&&t.asc_setTitle(this.inputAltTitle.getValue()),this.isAltDescChanged&&t.asc_setDescription(this.textareaAltDescription.val()),t},isRangeValid:function(){var t=!0,e="";return _.isEmpty(this.txtDataRange.getValue())?(t=!1,e=this.txtEmpty):(t=(t=this.api.asc_checkDataRange(Asc.c_oAscSelectionDialogType.PivotTableData,this.txtDataRange.getValue()))==Asc.c_oAscError.ID.No)||(e=this.textInvalidRange),t||(this.setActiveCategory(1),this.txtDataRange.showError([e]),this.txtDataRange.cmpEl.find("input").focus()),t},onSelectData:function(){var t,e,i=this;i.api&&(t=new SSE.Views.CellRangeDialog({handler:function(t,e){"ok"==e&&(i.dataRangeValid=t.getSettings(),i.txtDataRange.setValue(i.dataRangeValid),i.txtDataRange.checkValidate())}}).on("close",function(){i.show()}),e=i.$window.offset(),i.hide(),t.show(e.left+160,e.top+125),t.setSettings({api:i.api,range:_.isEmpty(i.txtDataRange.getValue())||1!=i.txtDataRange.checkValidate()?i.dataRangeValid:i.txtDataRange.getValue(),type:Asc.c_oAscSelectionDialogType.PivotTableData}))}},SSE.Views.PivotSettingsAdvanced||{}))});var c_paragraphLinerule={LINERULE_AUTO:1,LINERULE_EXACT:2},c_paragraphTextAlignment={RIGHT:0,LEFT:1,CENTERED:2,JUSTIFIED:3},c_paragraphSpecial={NONE_SPECIAL:0,FIRST_LINE:1,HANGING:2},Common,Common,Common,Common,Common,Common,Common,Common,FONT_TYPE_RECENT=(define("spreadsheeteditor/main/app/controller/DocumentHolder",["core","common/main/lib/util/utils","common/main/lib/util/Shortcuts","common/main/lib/view/CopyWarningDialog","common/main/lib/view/OpenDialog","common/main/lib/view/ListSettingsDialog","spreadsheeteditor/main/app/view/DocumentHolder","spreadsheeteditor/main/app/view/HyperlinkSettingsDialog","spreadsheeteditor/main/app/view/ParagraphSettingsAdvanced","spreadsheeteditor/main/app/view/ImageSettingsAdvanced","spreadsheeteditor/main/app/view/SetValueDialog","spreadsheeteditor/main/app/view/AutoFilterDialog","spreadsheeteditor/main/app/view/SpecialPasteDialog","spreadsheeteditor/main/app/view/SlicerSettingsAdvanced","spreadsheeteditor/main/app/view/PivotGroupDialog","spreadsheeteditor/main/app/view/MacroDialog","spreadsheeteditor/main/app/view/FieldSettingsDialog","spreadsheeteditor/main/app/view/ValueFieldSettingsDialog","spreadsheeteditor/main/app/view/PivotSettingsAdvanced"],function(){"use strict";SSE.Controllers.DocumentHolder=Backbone.Controller.extend(_.extend({models:[],collections:[],views:["DocumentHolder"],initialize:function(){var t=this,e=(t.tooltips={hyperlink:{},comment:{},coauth:{ttHeight:20},row_column:{ttHeight:20},slicer:{ttHeight:20},filter:{ttHeight:40},func_arg:{},input_msg:{},foreignSelect:{ttHeight:20},eyedropper:{isHidden:!0},placeholder:{}},t.mouse={},t.popupmenu=!1,t.rangeSelectionMode=!1,t.namedrange_locked=!1,t._currentMathObj=void 0,t._currentParaObjDisabled=!1,t._isDisabled=!1,t._state={wsLock:!1,wsProps:[]},t.fastcoauthtips=[],t._TtHeight=20,t.lastMathTrackBounds=[],this.wrapEvents={apiHideComment:_.bind(this.onApiHideComment,this),onKeyUp:_.bind(this.onKeyUp,this)},this.addListeners({DocumentHolder:{createdelayedelements:this.onCreateDelayedElements}}),{});this.hkComments=Common.Utils.isMac?"command+alt+a":"alt+h",e[this.hkComments]=function(){return t.onAddComment(),!1},Common.util.Shortcuts.delegateShortcuts({shortcuts:e}),Common.Utils.InternalSettings.set("sse-equation-toolbar-hide",Common.localStorage.getBool("sse-equation-toolbar-hide"))},onLaunch:function(){var e=this;e.documentHolder=this.createView("DocumentHolder"),e.documentHolder.render(),e.documentHolder.el.tabIndex=-1,$(document).on("mousedown",_.bind(e.onDocumentRightDown,e)),$(document).on("mouseup",_.bind(e.onDocumentRightUp,e)),$(document).on("keydown",_.bind(e.onDocumentKeyDown,e)),$(document).on("mousemove",_.bind(e.onDocumentMouseMove,e)),$(window).on("resize",_.bind(e.onDocumentResize,e)),SSE.getController("Viewport").getView("Viewport").hlayout.on("layout:resizedrag",_.bind(e.onDocumentResize,e)),Common.NotificationCenter.on({"window:show":function(t){e.hideHyperlinkTip(),e.permissions&&e.permissions.isDesktopApp&&e.api&&e.api.asc_onShowPopupWindow()},"modal:show":function(t){e.hideCoAuthTips(),e.hideForeignSelectTips()},"layout:changed":function(t){e.hideHyperlinkTip(),e.hideCoAuthTips(),e.hideForeignSelectTips(),e.onDocumentResize(),e.api&&!e.tooltips.input_msg.isHidden&&e.tooltips.input_msg.text&&e.changeInputMessagePosition(e.tooltips.input_msg)},"cells:range":function(t){e.onCellsRange(t)},"tabs:dragend":_.bind(e.onDragEndMouseUp,e),"protect:wslock":_.bind(e.onChangeProtectSheet,e)}),Common.Gateway.on("processmouse",_.bind(e.onProcessMouse,e)),Common.Gateway.on("setactionlink",_.bind(e.onSetActionLink,e))},onCreateDelayedElements:function(i,t){function e(t,e,i,s){t.addEventListener?t.addEventListener(e,i,s):t.attachEvent("on"+e,i)}var s,o=this,n=("edit"===t?(i.pmiCut.on("click",_.bind(o.onCopyPaste,o)),i.pmiCopy.on("click",_.bind(o.onCopyPaste,o)),i.pmiPaste.on("click",_.bind(o.onCopyPaste,o)),i.pmiImgCut.on("click",_.bind(o.onCopyPaste,o)),i.pmiImgCopy.on("click",_.bind(o.onCopyPaste,o)),i.pmiImgPaste.on("click",_.bind(o.onCopyPaste,o)),i.pmiTextCut.on("click",_.bind(o.onCopyPaste,o)),i.pmiTextCopy.on("click",_.bind(o.onCopyPaste,o)),i.pmiTextPaste.on("click",_.bind(o.onCopyPaste,o)),i.pmiCommonCut.on("click",_.bind(o.onCopyPaste,o)),i.pmiCommonCopy.on("click",_.bind(o.onCopyPaste,o)),i.pmiCommonPaste.on("click",_.bind(o.onCopyPaste,o)),i.pmiInsertEntire.on("click",_.bind(o.onInsertEntire,o)),i.pmiDeleteEntire.on("click",_.bind(o.onDeleteEntire,o)),i.pmiInsertCells.menu.on("item:click",_.bind(o.onInsertCells,o)),i.pmiDeleteCells.menu.on("item:click",_.bind(o.onDeleteCells,o)),i.pmiSparklines.menu.on("item:click",_.bind(o.onClear,o)),i.pmiSortCells.menu.on("item:click",_.bind(o.onSortCells,o)),i.pmiFilterCells.menu.on("item:click",_.bind(o.onFilterCells,o)),i.pmiReapply.on("click",_.bind(o.onReapply,o)),i.pmiCondFormat.on("click",_.bind(o.onCondFormat,o)),i.mnuRefreshPivot.on("click",_.bind(o.onRefreshPivot,o)),i.mnuGroupPivot.on("click",_.bind(o.onGroupPivot,o)),i.mnuUnGroupPivot.on("click",_.bind(o.onGroupPivot,o)),i.mnuPivotSettings.on("click",_.bind(o.onPivotSettings,o)),i.mnuFieldSettings.on("click",_.bind(o.onFieldSettings,o)),i.mnuDeleteField.on("click",_.bind(o.onDeleteField,o)),i.mnuSubtotalField.on("click",_.bind(o.onSubtotalField,o)),i.mnuSummarize.menu.on("item:click",_.bind(o.onSummarize,o)),i.mnuShowAs.menu.on("item:click",_.bind(o.onShowAs,o)),i.mnuShowDetails.on("click",_.bind(o.onShowDetails,o)),i.mnuPivotSort.menu.on("item:click",_.bind(o.onPivotSort,o)),i.mnuPivotFilter.menu.on("item:click",_.bind(o.onPivotFilter,o)),i.pmiClear.menu.on("item:click",_.bind(o.onClear,o)),i.pmiSelectTable.menu.on("item:click",_.bind(o.onSelectTable,o)),i.pmiInsertTable.menu.on("item:click",_.bind(o.onInsertTable,o)),i.pmiDeleteTable.menu.on("item:click",_.bind(o.onDeleteTable,o)),i.pmiInsFunction.on("click",_.bind(o.onInsFunction,o)),i.menuAddHyperlink.on("click",_.bind(o.onInsHyperlink,o)),i.menuEditHyperlink.on("click",_.bind(o.onInsHyperlink,o)),i.menuRemoveHyperlink.on("click",_.bind(o.onDelHyperlink,o)),i.pmiRowHeight.menu.on("item:click",_.bind(o.onSetSize,o)),i.pmiColumnWidth.menu.on("item:click",_.bind(o.onSetSize,o)),i.pmiEntireHide.on("click",_.bind(o.onEntireHide,o)),i.pmiEntireShow.on("click",_.bind(o.onEntireShow,o)),i.pmiFreezePanes.on("click",_.bind(o.onFreezePanes,o)),i.pmiEntriesList.on("click",_.bind(o.onEntriesList,o)),i.pmiAddComment.on("click",_.bind(o.onAddComment,o)),i.pmiAddNamedRange.on("click",_.bind(o.onAddNamedRange,o)),i.menuImageArrange.menu.on("item:click",_.bind(o.onImgMenu,o)),i.menuImgRotate.menu.on("item:click",_.bind(o.onImgMenu,o)),i.menuImgCrop.menu.on("item:click",_.bind(o.onImgCrop,o)),i.menuImageAlign.menu.on("item:click",_.bind(o.onImgMenuAlign,o)),i.menuParagraphVAlign.menu.on("item:click",_.bind(o.onParagraphVAlign,o)),i.menuParagraphDirection.menu.on("item:click",_.bind(o.onParagraphDirection,o)),i.menuParagraphBullets.menu.on("item:click",_.bind(o.onSelectBulletMenu,o)),i.menuParagraphBullets.menu.on("show:after",_.bind(o.onBulletMenuShowAfter,o)),i.menuAddHyperlinkShape.on("click",_.bind(o.onInsHyperlink,o)),i.menuEditHyperlinkShape.on("click",_.bind(o.onInsHyperlink,o)),i.menuRemoveHyperlinkShape.on("click",_.bind(o.onDelHyperlink,o)),i.pmiTextAdvanced.on("click",_.bind(o.onTextAdvanced,o)),i.mnuShapeAdvanced.on("click",_.bind(o.onShapeAdvanced,o)),i.mnuChartEdit.on("click",_.bind(o.onChartEdit,o)),i.mnuChartData.on("click",_.bind(o.onChartData,o)),i.mnuChartType.on("click",_.bind(o.onChartType,o)),i.mnuImgAdvanced.on("click",_.bind(o.onImgAdvanced,o)),i.mnuSlicerAdvanced.on("click",_.bind(o.onSlicerAdvanced,o)),i.textInShapeMenu.on("render:after",_.bind(o.onTextInShapeAfterRender,o)),i.menuSignatureEditSign.on("click",_.bind(o.onSignatureClick,o)),i.menuSignatureEditSetup.on("click",_.bind(o.onSignatureClick,o)),i.menuImgOriginalSize.on("click",_.bind(o.onOriginalSizeClick,o)),i.menuImgReplace.menu.on("item:click",_.bind(o.onImgReplace,o)),i.pmiNumFormat.menu.on("item:click",_.bind(o.onNumberFormatSelect,o)),i.pmiNumFormat.menu.on("show:after",_.bind(o.onNumberFormatOpenAfter,o)),i.pmiAdvancedNumFormat.on("click",_.bind(o.onCustomNumberFormat,o)),i.tableTotalMenu.on("item:click",_.bind(o.onTotalMenuClick,o)),i.menuImgMacro.on("click",_.bind(o.onImgMacro,o)),i.menuImgEditPoints.on("click",_.bind(o.onImgEditPoints,o)),i.pmiGetRangeList.on("click",_.bind(o.onGetLink,o)),i.menuParagraphEquation.menu.on("item:click",_.bind(o.convertEquation,o)),i.menuSaveAsPicture.on("click",_.bind(o.saveAsPicture,o)),o.permissions.isEditMailMerge||o.permissions.isEditDiagram||o.permissions.isEditOle||(s=o.getApplication().getController("Common.Controllers.ExternalOleEditor").getView("Common.Views.ExternalOleEditor"))&&(s.on("internalmessage",_.bind(function(t,e){e.data.command;e=e.data.data;o.api&&s.isEditMode()&&o.api.asc_editTableOleObject(e)},o)),s.on("hide",_.bind(function(t,e){o.api&&(o.api.asc_enableKeyEvents(!0),o.api.asc_onCloseChartFrame()),setTimeout(function(){i.fireEvent("editcomplete",i)},10)},o)))):(i.menuViewCopy.on("click",_.bind(o.onCopyPaste,o)),i.menuViewUndo.on("click",_.bind(o.onUndo,o)),i.menuViewAddComment.on("click",_.bind(o.onAddComment,o)),i.menuSignatureViewSign.on("click",_.bind(o.onSignatureClick,o)),i.menuSignatureDetails.on("click",_.bind(o.onSignatureClick,o)),i.menuSignatureViewSetup.on("click",_.bind(o.onSignatureClick,o)),i.menuSignatureRemove.on("click",_.bind(o.onSignatureClick,o))),i.cmpEl);n&&(n.on({mousedown:function(t){"canvas"==t.target.localName&&2!=t.button&&Common.UI.Menu.Manager.hideAll()},click:function(t){o.api&&(o.api.isTextAreaBlur=!1,"canvas"!=t.target.localName||o.isEditFormula&&!o.rangeSelectionMode||(o._preventClick?o._preventClick=!1:n.focus()))},touchstart:function(t){"canvas"==t.target.localName&&Common.UI.Menu.Manager.hideAll()}}),t=/Firefox/i.test(navigator.userAgent)?"DOMMouseScroll":"mousewheel",e(i.el,t,_.bind(this.onDocumentWheel,this),!1),o.cellEditor=$("#ce-cell-content")),Common.Utils.isChrome?e(document,"mousewheel",_.bind(this.onDocumentWheel,this),{passive:!1}):$(document).on("mousewheel",_.bind(this.onDocumentWheel,this)),this.onChangeProtectSheet()},loadConfig:function(t){this.editorConfig=t.config},setMode:function(t){this.permissions=t,this.permissions.canCoAuthoring&&this.permissions.canComments?Common.util.Shortcuts.resumeEvents(this.hkComments):Common.util.Shortcuts.suspendEvents(this.hkComments)},setApi:function(t){return this.api=t,this.api.asc_registerCallback("asc_onContextMenu",_.bind(this.onApiContextMenu,this)),this.api.asc_registerCallback("asc_onMouseMove",_.bind(this.onApiMouseMove,this)),this.api.asc_registerCallback("asc_onHideComment",this.wrapEvents.apiHideComment),this.api.asc_registerCallback("asc_onHyperlinkClick",_.bind(this.onApiHyperlinkClick,this)),this.api.asc_registerCallback("asc_onCoAuthoringDisconnect",_.bind(this.onApiCoAuthoringDisconnect,this)),Common.NotificationCenter.on("api:disconnect",_.bind(this.onApiCoAuthoringDisconnect,this)),this.api.asc_registerCallback("asc_onSelectionChanged",_.bind(this.onSelectionChanged,this)),!0===this.permissions.isEdit&&(this.api.asc_registerCallback("asc_onSetAFDialog",_.bind(this.onApiAutofilter,this)),this.api.asc_registerCallback("asc_onEditCell",_.bind(this.onApiEditCell,this)),this.api.asc_registerCallback("asc_onLockDefNameManager",_.bind(this.onLockDefNameManager,this)),this.api.asc_registerCallback("asc_onEntriesListMenu",_.bind(this.onEntriesListMenu,this,!1)),this.api.asc_registerCallback("asc_onValidationListMenu",_.bind(this.onEntriesListMenu,this,!0)),this.api.asc_registerCallback("asc_onFormulaCompleteMenu",_.bind(this.onFormulaCompleteMenu,this)),this.api.asc_registerCallback("asc_onShowSpecialPasteOptions",_.bind(this.onShowSpecialPasteOptions,this)),this.api.asc_registerCallback("asc_onHideSpecialPasteOptions",_.bind(this.onHideSpecialPasteOptions,this)),this.api.asc_registerCallback("asc_onToggleAutoCorrectOptions",_.bind(this.onToggleAutoCorrectOptions,this)),this.api.asc_registerCallback("asc_onFormulaInfo",_.bind(this.onFormulaInfo,this)),this.api.asc_registerCallback("asc_ChangeCropState",_.bind(this.onChangeCropState,this)),this.api.asc_registerCallback("asc_onInputMessage",_.bind(this.onInputMessage,this)),this.api.asc_registerCallback("asc_onTableTotalMenu",_.bind(this.onTableTotalMenu,this)),this.api.asc_registerCallback("asc_onShowPivotGroupDialog",_.bind(this.onShowPivotGroupDialog,this)),this.permissions.isEditMailMerge||this.permissions.isEditDiagram||this.permissions.isEditOle||(this.api.asc_registerCallback("asc_doubleClickOnTableOleObject",_.bind(this.onDoubleClickOnTableOleObject,this)),this.api.asc_registerPlaceholderCallback(AscCommon.PlaceholderButtonType.Image,_.bind(this.onInsertImage,this)),this.api.asc_registerPlaceholderCallback(AscCommon.PlaceholderButtonType.ImageUrl,_.bind(this.onInsertImageUrl,this))),this.api.asc_registerCallback("asc_onShowMathTrack",_.bind(this.onShowMathTrack,this)),this.api.asc_registerCallback("asc_onHideMathTrack",_.bind(this.onHideMathTrack,this)),this.api.asc_registerCallback("asc_onHideEyedropper",_.bind(this.hideEyedropperTip,this)),this.api.asc_SetMathInputType(Common.localStorage.getBool("sse-equation-input-latex")?Asc.c_oAscMathInputType.LaTeX:Asc.c_oAscMathInputType.Unicode)),this.api.asc_registerCallback("asc_onShowForeignCursorLabel",_.bind(this.onShowForeignCursorLabel,this)),this.api.asc_registerCallback("asc_onHideForeignCursorLabel",_.bind(this.onHideForeignCursorLabel,this)),this.api.asc_registerCallback("onPluginContextMenu",_.bind(this.onPluginContextMenu,this)),this},resetApi:function(t){this.api.asc_unregisterCallback("asc_onHideComment",this.wrapEvents.apiHideComment),this.api.asc_registerCallback("asc_onHideComment",this.wrapEvents.apiHideComment)},onCopyPaste:function(t){var e=this;e.api&&(("cut"==t.value?e.api.asc_Cut():"copy"==t.value?e.api.asc_Copy():e.api.asc_Paste())?Common.component.Analytics.trackEvent("ToolBar","Copy Warning"):(t=Common.localStorage.getItem("sse-hide-copywarning"))&&1==parseInt(t)||new Common.Views.CopyWarningDialog({handler:function(t){t&&Common.localStorage.setItem("sse-hide-copywarning",1),Common.NotificationCenter.trigger("edit:complete",e.documentHolder)}}).show()),Common.NotificationCenter.trigger("edit:complete",e.documentHolder)},onInsertEntire:function(t){if(this.api){switch(this.api.asc_getCellInfo().asc_getSelectionType()){case Asc.c_oAscSelectionType.RangeRow:this.api.asc_insertCells(Asc.c_oAscInsertOptions.InsertRows);break;case Asc.c_oAscSelectionType.RangeCol:this.api.asc_insertCells(Asc.c_oAscInsertOptions.InsertColumns)}Common.NotificationCenter.trigger("edit:complete",this.documentHolder),Common.component.Analytics.trackEvent("DocumentHolder","Insert Entire")}},onInsertCells:function(t,e){this.api&&(this.api.asc_insertCells(e.value),Common.NotificationCenter.trigger("edit:complete",this.documentHolder),Common.component.Analytics.trackEvent("DocumentHolder","Insert Cells"))},onDeleteEntire:function(t){if(this.api){switch(this.api.asc_getCellInfo().asc_getSelectionType()){case Asc.c_oAscSelectionType.RangeRow:this.api.asc_deleteCells(Asc.c_oAscDeleteOptions.DeleteRows);break;case Asc.c_oAscSelectionType.RangeCol:this.api.asc_deleteCells(Asc.c_oAscDeleteOptions.DeleteColumns)}Common.NotificationCenter.trigger("edit:complete",this.documentHolder),Common.component.Analytics.trackEvent("DocumentHolder","Delete Entire")}},onDeleteCells:function(t,e){this.api&&(this.api.asc_deleteCells(e.value),Common.NotificationCenter.trigger("edit:complete",this.documentHolder),Common.component.Analytics.trackEvent("DocumentHolder","Delete Cells"))},onSortCells:function(t,e){Common.NotificationCenter.trigger("protect:check",this.onSortCellsCallback,this,[t,e])},onSortCellsCallback:function(t,e){if("advanced"==e.value)Common.NotificationCenter.trigger("data:sortcustom",this);else if(this.api){var i=this.api.asc_sortCellsRangeExpand();switch(i){case Asc.c_oAscSelectionSortExpand.showExpandMessage:var s={width:500,title:this.txtSorting,msg:this.txtExpandSort,buttons:[{caption:this.txtExpand,primary:!0,value:"expand"},{caption:this.txtSortSelected,primary:!0,value:"sort"},"cancel"],callback:_.bind(function(t){"expand"!=t&&"sort"!=t||this.api.asc_sortColFilter(e.value,"",void 0,e.value==Asc.c_oAscSortOptions.ByColorFill?this.documentHolder.ssMenu.cellColor:this.documentHolder.ssMenu.fontColor,"expand"==t),Common.NotificationCenter.trigger("edit:complete",this.documentHolder),Common.component.Analytics.trackEvent("DocumentHolder","Sort Cells")},this)};Common.UI.alert(s);break;case Asc.c_oAscSelectionSortExpand.showLockMessage:s={width:500,title:this.txtSorting,msg:this.txtLockSort,buttons:["yes","no"],primary:"yes",callback:_.bind(function(t){"yes"==t&&this.api.asc_sortColFilter(e.value,"",void 0,e.value==Asc.c_oAscSortOptions.ByColorFill?this.documentHolder.ssMenu.cellColor:this.documentHolder.ssMenu.fontColor,!1),Common.NotificationCenter.trigger("edit:complete",this.documentHolder),Common.component.Analytics.trackEvent("DocumentHolder","Sort Cells")},this)};Common.UI.alert(s);break;case Asc.c_oAscSelectionSortExpand.expandAndNotShowMessage:case Asc.c_oAscSelectionSortExpand.notExpandAndNotShowMessage:this.api.asc_sortColFilter(e.value,"",void 0,e.value==Asc.c_oAscSortOptions.ByColorFill?this.documentHolder.ssMenu.cellColor:this.documentHolder.ssMenu.fontColor,i===Asc.c_oAscSelectionSortExpand.expandAndNotShowMessage),Common.NotificationCenter.trigger("edit:complete",this.documentHolder),Common.component.Analytics.trackEvent("DocumentHolder","Sort Cells")}}},onFilterCells:function(t,e){var i,s,o;this.api&&(i=new Asc.AutoFiltersOptions,s=new Asc.AutoFilterObj,0<e.value?(s.asc_setFilter(new Asc.ColorFilter),s.asc_setType(Asc.c_oAscAutoFilterTypes.ColorFilter),(o=s.asc_getFilter()).asc_setCellColor(1==e.value&&null),o.asc_setCColor(1==e.value?this.documentHolder.ssMenu.cellColor:this.documentHolder.ssMenu.fontColor)):(s.asc_setFilter(new Asc.CustomFilters),s.asc_setType(Asc.c_oAscAutoFilterTypes.CustomFilters),(o=s.asc_getFilter()).asc_setCustomFilters([new Asc.CustomFilter]),o.asc_setAnd(!0),o.asc_getCustomFilters()[0].asc_setOperator(Asc.c_oAscCustomAutoFilter.equals)),i.asc_setFilterObj(s),this.api.asc_applyAutoFilterByType(i),Common.NotificationCenter.trigger("edit:complete",this.documentHolder),Common.component.Analytics.trackEvent("DocumentHolder","Filter Cells"))},onReapply:function(){this.api.asc_reapplyAutoFilter(this.documentHolder.ssMenu.formatTableName)},onCondFormat:function(){var i=this,t=(t=i.api.asc_getLocale())||(i.permissions.lang?parseInt(Common.util.LanguageInfo.getLocalLanguageCode(i.permissions.lang)):1033);new SSE.Views.FormatRulesEditDlg({api:i.api,props:null,isEdit:!1,langId:t,handler:function(t,e){"ok"==t&&e&&i.api.asc_setCF([e],[])}}).show()},onRefreshPivot:function(){this.api&&this.propsPivot.originalProps.asc_refresh(this.api)},onGroupPivot:function(t){"grouping"==t.value?this.api.asc_groupPivot():this.api.asc_ungroupPivot()},onShowPivotGroupDialog:function(t,e,i){var s,o=this,n=new SSE.Views.PivotGroupDialog({date:!!e,handler:function(t,e){"ok"==e&&(s=t.getSettings(),o.api.asc_groupPivot(s[0],s[1]),Common.NotificationCenter.trigger("edit:complete",o.documentHolder))}});n.show(),n.setSettings(t,e,i)},onPivotSettings:function(){var i,s=this.propsPivot.originalProps;!s||(i=this).api&&new SSE.Views.PivotSettingsAdvanced({props:s,api:i.api,handler:function(t,e){"ok"==t&&i.api&&e&&(s.asc_set(i.api,e),Common.NotificationCenter.trigger("edit:complete",i.documentHolder)),Common.NotificationCenter.trigger("edit:complete",i.documentHolder)}}).show()},onFieldSettings:function(){var i,s,o=this.propsPivot.originalProps;!o||(i=this).api&&(2===i.propsPivot.fieldType?(s=i.propsPivot.field,new SSE.Views.ValueFieldSettingsDialog({props:o,field:s,showAsValue:i.propsPivot.showAsValue,api:i.api,handler:function(t,e){"ok"===t&&i.api&&e&&(s.asc_set(i.api,o,i.propsPivot.index,e),Common.NotificationCenter.trigger("edit:complete",i.documentHolder)),Common.NotificationCenter.trigger("edit:complete",i.documentHolder)}})):new SSE.Views.FieldSettingsDialog({props:o,fieldIndex:i.propsPivot.pivotIndex,api:i.api,type:i.propsPivot.fieldType,handler:function(t,e){"ok"===t&&i.api&&e&&(i.propsPivot.field.asc_set(i.api,o,i.propsPivot.pivotIndex,e),Common.NotificationCenter.trigger("edit:complete",i.documentHolder)),Common.NotificationCenter.trigger("edit:complete",i.documentHolder)}})).show()},onDeleteField:function(){var t;this.api&&this.propsPivot.originalProps&&this.propsPivot.field&&(2===this.propsPivot.fieldType?this.propsPivot.rowTotal||this.propsPivot.colTotal?((t=new Asc.CT_pivotTableDefinition).asc_setRowGrandTotals(!this.propsPivot.rowTotal&&this.propsPivot.originalProps.asc_getRowGrandTotals()),t.asc_setColGrandTotals(!this.propsPivot.colTotal&&this.propsPivot.originalProps.asc_getColGrandTotals()),this.propsPivot.originalProps.asc_set(this.api,t)):this.propsPivot.originalProps.asc_removeDataField(this.api,this.propsPivot.pivotIndex,this.propsPivot.index):this.propsPivot.originalProps.asc_removeNoDataField(this.api,this.propsPivot.pivotIndex)),Common.NotificationCenter.trigger("edit:complete",this.documentHolder)},onSubtotalField:function(t){var e;this.api&&this.propsPivot.originalProps&&(e=new Asc.CT_pivotTableDefinition,t.checked?(e.asc_setDefaultSubtotal(!0),e.asc_setSubtotalTop(!0)):e.asc_setDefaultSubtotal(!1),this.propsPivot.originalProps.asc_set(this.api,e))},onSummarize:function(t,e,i){var s;this.propsPivot.originalProps&&(-1===e.value?this.onFieldSettings():void 0!==e.value&&null!==e.value&&((s=new Asc.CT_DataField).asc_setSubtotal(e.value),this.propsPivot.fieldSourceName&&s.asc_setName(this.txtByField.replace("%1",e.caption).replace("%2",this.propsPivot.fieldSourceName)),this.propsPivot.field.asc_set(this.api,this.propsPivot.originalProps,this.propsPivot.index,s),Common.NotificationCenter.trigger("edit:complete",this.documentHolder)))},onShowAs:function(t,e,i){var s,o;this.propsPivot.originalProps&&(-1===e.value||e.options.showMore?(e.options.showMore&&(this.propsPivot.showAsValue=e.value),this.onFieldSettings()):void 0!==e.value&&null!==e.value&&((s=new Asc.CT_DataField).asc_setShowDataAs(e.value),(o=new Asc.asc_CFormatCellsInfo).asc_setType(e.options.numFormat),o.asc_setDecimalPlaces(e.options.numFormat===Asc.c_oAscNumFormatType.Percent?2:0),o.asc_setSeparator(!1),s.asc_setNumFormat(this.api.asc_getFormatCells(o)[0]),this.propsPivot.field.asc_set(this.api,this.propsPivot.originalProps,this.propsPivot.index,s),Common.NotificationCenter.trigger("edit:complete",this.documentHolder)))},showCustomFilterDlg:function(t,e){var i,s=t.asc_getFilterObj(),o=(s.asc_getType()!==Asc.c_oAscAutoFilterTypes.CustomFilters&&((i=new Asc.CustomFilters).asc_setCustomFilters([new Asc.CustomFilter]),(n=i.asc_getCustomFilters())[0].asc_setOperator(Asc.c_oAscCustomAutoFilter.equals),i.asc_setAnd(!0),n[0].asc_setVal(""),s.asc_setFilter(i),s.asc_setType(Asc.c_oAscAutoFilterTypes.CustomFilters)),this),n=new SSE.Views.PivotDigitalFilterDialog({api:this.api,type:e}).on({close:function(){Common.NotificationCenter.trigger("edit:complete",o.documentHolder)}});n.setSettings(t),n.show()},onPivotFilter:function(t,e,i){var s,o,n;this.propsPivot.filter&&(s=this.propsPivot.filter,o=this,"value"===e.value?s.asc_getPivotObj().asc_getDataFields().length<2?Common.UI.warning({title:this.textWarning,msg:this.warnFilterError,callback:function(){Common.NotificationCenter.trigger("edit:complete",o.documentHolder)}}):this.showCustomFilterDlg(s,e.value):"label"===e.value?this.showCustomFilterDlg(s,e.value):"top10"===e.value?((n=new SSE.Views.Top10FilterDialog({api:this.api,type:"value"}).on({close:function(){Common.NotificationCenter.trigger("edit:complete",o.documentHolder)}})).setSettings(s),n.show()):"clear"===e.value&&(this.api.asc_clearFilterColumn(s.asc_getCellId(),s.asc_getDisplayName()),Common.NotificationCenter.trigger("edit:complete",this.documentHolder)))},onPivotSort:function(t,e,i){var s,o;(this.propsPivot.filter||this.propsPivot.rowFilter||this.propsPivot.colFilter)&&(s=this,"advanced"===e.value?((o=new SSE.Views.SortFilterDialog({api:this.api}).on({close:function(){Common.NotificationCenter.trigger("edit:complete",s.documentHolder)}})).setSettings({filter:this.propsPivot.filter,rowFilter:this.propsPivot.rowFilter,colFilter:this.propsPivot.colFilter}),o.show()):(o=this.propsPivot.filter||this.propsPivot.rowFilter||this.propsPivot.colFilter,this.api.asc_sortColFilter(e.value,o.asc_getCellId(),o.asc_getDisplayName()),Common.NotificationCenter.trigger("edit:complete",this.documentHolder)))},onShowDetails:function(t,e){this.propsPivot.originalProps&&this.api&&this.api.asc_pivotShowDetails(this.propsPivot.originalProps)},fillPivotProps:function(){var t,e,i,s,o,n,a,l=this.propsPivot.originalProps;l&&(e=(t=this.api.asc_getPivotInfo()).asc_getPageFieldIndex(),i=t.asc_getColFieldIndex(),s=t.asc_getRowFieldIndex(),o=t.asc_getDataFieldIndex(),this.propsPivot.canGroup=t.asc_canGroup(),this.propsPivot.rowTotal=t.asc_getRowGrandTotals(),this.propsPivot.colTotal=t.asc_getColGrandTotals(),this.propsPivot.filter=t.asc_getFilter(),this.propsPivot.rowFilter=t.asc_getFilterRow(),this.propsPivot.colFilter=t.asc_getFilterCol(),this.propsPivot.showDetails=t.asc_showDetails(),-1<i?(n=l.asc_getColumnFields())&&-1<(a=n[i].asc_getIndex())&&(this.propsPivot.pivotIndex=a,this.propsPivot.index=i,this.propsPivot.field=l.asc_getPivotFields()[a],this.propsPivot.fieldType=0,this.propsPivot.fieldName=this.propsPivot.field.asc_getName()||l.asc_getCacheFields()[a].asc_getName()):-1<s?(n=l.asc_getRowFields())&&-1<(a=n[s].asc_getIndex())&&(this.propsPivot.pivotIndex=a,this.propsPivot.index=s,this.propsPivot.field=l.asc_getPivotFields()[a],this.propsPivot.fieldType=1,this.propsPivot.fieldName=this.propsPivot.field.asc_getName()||l.asc_getCacheFields()[a].asc_getName()):-1<e&&(n=l.asc_getPageFields())&&-1<(a=n[e].asc_getIndex())&&(this.propsPivot.pivotIndex=a,this.propsPivot.index=e,this.propsPivot.field=l.asc_getPivotFields()[a],this.propsPivot.fieldType=3,this.propsPivot.fieldName=this.propsPivot.field.asc_getName()||l.asc_getCacheFields()[a].asc_getName()),-1<o&&(n=l.asc_getDataFields())&&-1<(a=n[o].asc_getIndex())&&(this.propsPivot.pivotIndex=a,this.propsPivot.index=o,this.propsPivot.field=n[o],this.propsPivot.fieldType=2,this.propsPivot.fieldName=this.propsPivot.field.asc_getName(),this.propsPivot.fieldSourceName=l.asc_getCacheFields()[a].asc_getName()))},onClear:function(t,e,i){e.value==Asc.c_oAscCleanOptions.Format&&!this._state.wsProps.FormatCells||e.value==Asc.c_oAscCleanOptions.All&&!this.api.asc_checkLockedCells()?this.onClearCallback(t,e):e.value==Asc.c_oAscCleanOptions.Comments?this._state.wsProps.Objects?Common.NotificationCenter.trigger("showerror",Asc.c_oAscError.ID.ChangeOnProtectedSheet,Asc.c_oAscError.Level.NoCritical):this.onClearCallback(t,e):Common.NotificationCenter.trigger("protect:check",this.onClearCallback,this,[t,e])},onClearCallback:function(t,e){this.api&&(e.value==Asc.c_oAscCleanOptions.Comments?this.api.asc_RemoveAllComments(!this.permissions.canDeleteComments,!0):this.api.asc_emptyCells(e.value,e.value==Asc.c_oAscCleanOptions.All&&!this.permissions.canDeleteComments),Common.NotificationCenter.trigger("edit:complete",this.documentHolder),Common.component.Analytics.trackEvent("DocumentHolder","Clear"))},onSelectTable:function(t,e){this.api&&this.documentHolder.ssMenu.formatTableName&&(this.api.asc_changeSelectionFormatTable(this.documentHolder.ssMenu.formatTableName,e.value),Common.NotificationCenter.trigger("edit:complete",this.documentHolder),Common.component.Analytics.trackEvent("DocumentHolder","Select Table"))},onInsertTable:function(t,e){this.api&&this.documentHolder.ssMenu.formatTableName&&(this.api.asc_insertCellsInTable(this.documentHolder.ssMenu.formatTableName,e.value),Common.NotificationCenter.trigger("edit:complete",this.documentHolder),Common.component.Analytics.trackEvent("DocumentHolder","Insert to Table"))},onDeleteTable:function(t,e){this.api&&this.documentHolder.ssMenu.formatTableName&&(this.api.asc_deleteCellsInTable(this.documentHolder.ssMenu.formatTableName,e.value),Common.NotificationCenter.trigger("edit:complete",this.documentHolder),Common.component.Analytics.trackEvent("DocumentHolder","Delete from Table"))},onInsFunction:function(t){var e=this.getApplication().getController("FormulaDialog");e&&this.api&&e.showDialog(void 0,t.value==Asc.ETotalsRowFunction.totalrowfunctionCustom)},onInsHyperlink:function(t){Common.NotificationCenter.trigger("protect:check",this.onInsHyperlinkCallback,this,[t])},onInsHyperlinkCallback:function(t){var i=this;if(i.api){for(var e=i.api.asc_getWorksheetsCount(),s=-1,o=[];++s<e;)o.push({name:i.api.asc_getWorksheetName(s),hidden:i.api.asc_isWorksheetHidden(s)});var n,a=i.api.asc_getCellInfo(),l=a.asc_getHyperlink();(n=new SSE.Views.HyperlinkSettingsDialog({api:i.api,appOptions:i.permissions,handler:function(t,e){"ok"==e&&(l=t.getSettings(),i.api.asc_insertHyperlink(l)),Common.NotificationCenter.trigger("edit:complete",i.documentHolder)}})).show(),n.setSettings({sheets:o,ranges:i.api.asc_getDefinedNames(Asc.c_oAscGetDefinedNamesList.All,!0),currentSheet:i.api.asc_getActiveWorksheetIndex(),props:l,text:a.asc_getText(),isLock:a.asc_getLockText(),allowInternal:t.options.inCell})}Common.component.Analytics.trackEvent("DocumentHolder","Add Hyperlink")},onDelHyperlink:function(t){Common.NotificationCenter.trigger("protect:check",this.onDelHyperlinkCallback,this)},onDelHyperlinkCallback:function(t){this.api&&(this.api.asc_removeHyperlink(),Common.NotificationCenter.trigger("edit:complete",this.documentHolder),Common.component.Analytics.trackEvent("DocumentHolder","Remove Hyperlink"))},onSetSize:function(t,i){var s;"row-height"==i.value||"column-width"==i.value?(s=this,new SSE.Views.SetValueDialog({title:i.caption,startvalue:"row-height"==i.value?s.api.asc_getRowHeight():s.api.asc_getColumnWidth(),maxvalue:"row-height"==i.value?Asc.c_oAscMaxRowHeight:Asc.c_oAscMaxColumnWidth,step:"row-height"==i.value?.75:1,rounding:"row-height"==i.value,defaultUnit:"row-height"==i.value?Common.Utils.Metric.getMetricName(Common.Utils.Metric.c_MetricUnits.pt):s.textSym,handler:function(t,e){"ok"==e&&(e=t.getSettings(),isNaN(e)||("row-height"==i.value?s.api.asc_setRowHeight(e):s.api.asc_setColumnWidth(e))),Common.NotificationCenter.trigger("edit:complete",s.documentHolder)}}).show()):("auto-row-height"==i.value?this.api.asc_autoFitRowHeight():this.api.asc_autoFitColumnWidth(),Common.NotificationCenter.trigger("edit:complete",this.documentHolder))},onEntireHide:function(t){this.api&&this.api[t.isrowmenu?"asc_hideRows":"asc_hideColumns"]()},onEntireShow:function(t){this.api&&this.api[t.isrowmenu?"asc_showRows":"asc_showColumns"]()},onFreezePanes:function(t){this.api&&this.api.asc_freezePane()},onEntriesList:function(t){var e;this.api&&(e=this,setTimeout(function(){e.api.asc_showAutoComplete()},10))},onAddComment:function(t){var e,i;this._state.wsProps.Objects||this.api&&this.permissions.canCoAuthoring&&this.permissions.canComments&&(e=SSE.getController("Common.Controllers.Comments"),i=this.api.asc_getCellInfo(),e&&(i=i.asc_getComments())&&(i.length?e.onEditComments(i):this.permissions.canCoAuthoring&&e.addDummyComment()))},onAddNamedRange:function(t){if(this.namedrange_locked)Common.NotificationCenter.trigger("namedrange:locked");else{for(var i=this,e=i.api.asc_getWorksheetsCount(),s=-1,o=[];++s<e;)this.api.asc_isWorksheetHidden(s)||o.push({displayValue:i.api.asc_getWorksheetName(s),value:s});new SSE.Views.NamedRangeEditDlg({api:i.api,handler:function(t,e){"ok"==t&&e&&(i.api.asc_setDefinedNames(e),Common.component.Analytics.trackEvent("DocumentHolder","New Named Range")),Common.NotificationCenter.trigger("edit:complete",i.documentHolder)},sheets:o,currentSheet:i.api.asc_getActiveWorksheetIndex(),props:i.api.asc_getDefaultDefinedName(),isEdit:!1}).show()}},onImgMenu:function(t,e){var i;this.api&&("arrange"==e.options.type?(this.api.asc_setSelectedDrawingObjectLayer(e.value),Common.NotificationCenter.trigger("edit:complete",this.documentHolder),Common.component.Analytics.trackEvent("DocumentHolder","Arrange")):"group"==e.options.type?(this.api["grouping"==e.value?"asc_groupGraphicsObjects":"asc_unGroupGraphicsObjects"](),Common.NotificationCenter.trigger("edit:complete",this.documentHolder),Common.component.Analytics.trackEvent("DocumentHolder","grouping"==e.value?"Grouping":"Ungrouping")):"rotate"==e.options.type?((i=new Asc.asc_CImgProperty).asc_putRotAdd(3.14159265358979*(1==e.value?90:270)/180),this.api.asc_setGraphicObjectProps(i),Common.NotificationCenter.trigger("edit:complete",this.documentHolder),Common.component.Analytics.trackEvent("DocumentHolder","Rotate")):"flip"==e.options.type&&(i=new Asc.asc_CImgProperty,1==e.value?i.asc_putFlipHInvert(!0):i.asc_putFlipVInvert(!0),this.api.asc_setGraphicObjectProps(i),Common.NotificationCenter.trigger("edit:complete",this.documentHolder),Common.component.Analytics.trackEvent("DocumentHolder","Flip")))},onImgCrop:function(t,e){this.api&&(1==e.value?this.api.asc_cropFill():2==e.value?this.api.asc_cropFit():e.checked?this.api.asc_startEditCrop():this.api.asc_endEditCrop()),Common.NotificationCenter.trigger("edit:complete",this.documentHolder)},onImgMenuAlign:function(t,e){this.api&&(-1<e.value&&e.value<6?(this.api.asc_setSelectedDrawingObjectAlign(e.value),Common.NotificationCenter.trigger("edit:complete",this.documentHolder),Common.component.Analytics.trackEvent("DocumentHolder","Objects Align")):6==e.value?(this.api.asc_DistributeSelectedDrawingObjectHor(),Common.NotificationCenter.trigger("edit:complete",this.documentHolder),Common.component.Analytics.trackEvent("DocumentHolder","Distribute")):7==e.value&&(this.api.asc_DistributeSelectedDrawingObjectVer(),Common.NotificationCenter.trigger("edit:complete",this.documentHolder),Common.component.Analytics.trackEvent("DocumentHolder","Distribute")))},onParagraphVAlign:function(t,e){var i;this.api&&((i=new Asc.asc_CImgProperty).asc_putVerticalTextAlign(e.value),this.api.asc_setGraphicObjectProps(i),Common.NotificationCenter.trigger("edit:complete",this.documentHolder),Common.component.Analytics.trackEvent("DocumentHolder","Paragraph Vertical Align"))},onParagraphDirection:function(t,e){var i;this.api&&((i=new Asc.asc_CImgProperty).asc_putVert(e.options.direction),this.api.asc_setGraphicObjectProps(i),Common.NotificationCenter.trigger("edit:complete",this.documentHolder),Common.component.Analytics.trackEvent("DocumentHolder","Text Direction"))},onSelectBulletMenu:function(t,e){if(this.api)if(-1==e.options.value)this.api.asc_setListType(0,e.options.value),Common.NotificationCenter.trigger("edit:complete",this.documentHolder),Common.component.Analytics.trackEvent("DocumentHolder","List Type");else if("settings"==e.options.value){for(var i,s=this,o=s.api.asc_getGraphicObjectProps(),n=0;n<o.length;n++)if(o[n].asc_getObjectType()==Asc.c_oAscTypeSelectElement.Paragraph){i=o[n].asc_getObjectValue();break}i&&(s.api.asc_getCurrentListType(),new Common.Views.ListSettingsDialog({api:s.api,props:i,type:0,storage:s.permissions.canRequestInsertImage||s.permissions.fileChoiceUrl&&-1<s.permissions.fileChoiceUrl.indexOf("{documentType}"),interfaceLang:s.permissions.lang,handler:function(t,e){"ok"==t&&s.api&&(i.asc_putBullet(e),s.api.asc_setGraphicObjectProps(i)),Common.NotificationCenter.trigger("edit:complete",s.documentHolder)}}).show())}},onSelectBullets:function(t,e,i,s){var o={};if(_.isFunction(i.toJSON)){if(!i.get("selected"))return;o=i.toJSON()}else o=i;if(0===o.type&&4096===o.subtype){var n=o.customBullet;if(n)for(var a,l=this.api.asc_getGraphicObjectProps(),r=0;r<l.length;r++)if(l[r].asc_getObjectType()==Asc.c_oAscTypeSelectElement.Paragraph){(a=l[r].asc_getObjectValue()).asc_putBullet(n),this.api.asc_setGraphicObjectProps(a);break}}else this.api.asc_setListType(o.type,o.subtype);"click"!==s.type&&this.documentHolder.textInShapeMenu.hide(),Common.NotificationCenter.trigger("edit:complete",this.documentHolder),Common.component.Analytics.trackEvent("DocumentHolder","List Type")},onTextAdvanced:function(t){var i=this;new SSE.Views.ParagraphSettingsAdvanced({paragraphProps:t.textInfo,api:i.api,handler:function(t,e){"ok"==t&&i.api&&(i.api.asc_setGraphicObjectProps(e.paragraphProps),Common.component.Analytics.trackEvent("DocumentHolder","Apply advanced paragraph settings")),Common.NotificationCenter.trigger("edit:complete",i)}}).show()},onShapeAdvanced:function(t){var i=this;new SSE.Views.ShapeSettingsAdvanced({shapeProps:t.shapeInfo,api:i.api,handler:function(t,e){"ok"==t&&i.api&&(i.api.asc_setGraphicObjectProps(e.shapeProps),Common.component.Analytics.trackEvent("DocumentHolder","Apply advanced shape settings")),Common.NotificationCenter.trigger("edit:complete",i)}}).show()},onImgAdvanced:function(t){var i=this;new SSE.Views.ImageSettingsAdvanced({imageProps:t.imageInfo,api:i.api,handler:function(t,e){"ok"==t&&i.api&&(i.api.asc_setGraphicObjectProps(e.imageProps),Common.component.Analytics.trackEvent("DocumentHolder","Apply advanced image settings")),Common.NotificationCenter.trigger("edit:complete",i)}}).show()},onSlicerAdvanced:function(t){var i=this;new SSE.Views.SlicerSettingsAdvanced({imageProps:t.imageInfo,api:i.api,styles:t.imageInfo.asc_getSlicerProperties().asc_getStylesPictures(),handler:function(t,e){"ok"==t&&i.api&&(i.api.asc_setGraphicObjectProps(e.imageProps),Common.component.Analytics.trackEvent("DocumentHolder","Apply slicer settings")),Common.NotificationCenter.trigger("edit:complete",i)}}).show()},onChartEdit:function(t){var e,i=this;i.api&&(e=i.api.asc_getChartObject())&&new SSE.Views.ChartSettingsDlg({chartSettings:e,imageSettings:t.chartInfo,isChart:!0,api:i.api,handler:function(t,e){"ok"==t&&i.api&&(i.api.asc_editChartDrawingObject(e.chartSettings),e.imageSettings&&i.api.asc_setGraphicObjectProps(e.imageSettings)),Common.NotificationCenter.trigger("edit:complete",i)}}).show()},onChartData:function(t){var i,s=this;s.api&&(i=s.api.asc_getChartObject())&&(s._isEditRanges=!0,i.startEdit(),new SSE.Views.ChartDataDialog({chartSettings:i,api:s.api,handler:function(t,e){"ok"==t&&(i.endEdit(),s._isEditRanges=!1),Common.NotificationCenter.trigger("edit:complete",s)}}).on("close",function(){s._isEditRanges&&i.cancelEdit(),s._isEditRanges=!1}).show())},onChartType:function(t){var i,s=this;s.api&&(i=s.api.asc_getChartObject())&&(s._isEditType=!0,i.startEdit(),new SSE.Views.ChartTypeDialog({chartSettings:i,api:s.api,handler:function(t,e){"ok"==t&&(i.endEdit(),s._isEditType=!1),Common.NotificationCenter.trigger("edit:complete",s)}}).on("close",function(){s._isEditType&&i.cancelEdit(),s._isEditType=!1}).show())},onImgMacro:function(t){var i=this;new SSE.Views.MacroDialog({props:{macroList:i.api.asc_getAllMacrosNames(),current:i.api.asc_getCurrentDrawingMacrosName()},handler:function(t,e){"ok"==t&&i.api&&i.api.asc_assignMacrosToCurrentDrawing(e),Common.NotificationCenter.trigger("edit:complete",i)}}).show()},onImgEditPoints:function(t){this.api&&this.api.asc_editPointsGeometry()},onGetLink:function(t){var e,i;this.api&&(e=this.api.asc_getActiveRangeStr(Asc.referenceType.A,!1,!0),(i=(i=this.api.asc_getEscapeSheetName(this.api.asc_getWorksheetName(this.api.asc_getActiveWorksheetIndex())))+(""!==i&&""!==e?"!":"")+e)&&Common.Gateway.requestMakeActionLink({action:{type:"internallink",data:i}}))},onSetActionLink:function(t){var e;Common.Utils.InternalSettings.get("sse-dialog-link-visible")||(e=this,navigator.clipboard&&navigator.clipboard.writeText(t).then(function(){Common.NotificationCenter.trigger("showmessage",{msg:e.txtCopySuccess},{timeout:3e3,hideCloseTip:!0})}).catch(function(t){}))},onApiCoAuthoringDisconnect:function(){this.permissions.isEdit=!1},hideCoAuthTips:function(){this.tooltips.coauth.ref&&($(this.tooltips.coauth.ref).remove(),this.tooltips.coauth.ref=void 0,this.tooltips.coauth.x_point=void 0,this.tooltips.coauth.y_point=void 0)},hideForeignSelectTips:function(){this.tooltips.foreignSelect.ref&&($(this.tooltips.foreignSelect.ref).remove(),this.tooltips.foreignSelect.ref=void 0,this.tooltips.foreignSelect.userId=void 0,this.tooltips.foreignSelect.x_point=void 0,this.tooltips.foreignSelect.y_point=void 0)},hideHyperlinkTip:function(){!this.tooltips.hyperlink.isHidden&&this.tooltips.hyperlink.ref&&(this.tooltips.hyperlink.ref.hide(),this.tooltips.hyperlink.ref=void 0,this.tooltips.hyperlink.text="",this.tooltips.hyperlink.isHidden=!0)},hideEyedropperTip:function(){!this.tooltips.eyedropper.isHidden&&this.tooltips.eyedropper.color&&(this.tooltips.eyedropper.color.css({left:"-1000px",top:"-1000px"}),this.tooltips.eyedropper.ref&&(this.tooltips.eyedropper.ref.hide(),this.tooltips.eyedropper.ref=void 0),this.tooltips.eyedropper.isHidden=!0)},hidePlaceholderTip:function(){!this.tooltips.placeholder.isHidden&&this.tooltips.placeholder.ref&&(this.tooltips.placeholder.ref.hide(),this.tooltips.placeholder.ref=void 0,this.tooltips.placeholder.text="",this.tooltips.placeholder.isHidden=!0)},onApiMouseMove:function(t){if(!this._isFullscreenMenu&&t.length){for(var e,i,s,o,n,a,l,r,c,d,h=t.length;0<h;h--)switch(t[h-1].asc_getType()){case Asc.c_oAscMouseMoveType.Hyperlink:e=h;break;case Asc.c_oAscMouseMoveType.Comment:i=h;break;case Asc.c_oAscMouseMoveType.LockedObject:s=h;break;case Asc.c_oAscMouseMoveType.ResizeColumn:o=h;break;case Asc.c_oAscMouseMoveType.ResizeRow:n=h;break;case Asc.c_oAscMouseMoveType.Filter:a=h;break;case Asc.c_oAscMouseMoveType.Tooltip:l=h;break;case Asc.c_oAscMouseMoveType.ForeignSelect:r=h;break;case Asc.c_oAscMouseMoveType.Eyedropper:c=h;break;case Asc.c_oAscMouseMoveType.Placeholder:d=h}var p,U,L,B,H,m,u,g,b,C,f,S,v,w,_,x,O,y=this,A=[0,0],T=y.tooltips.coauth,k=y.tooltips.comment,E=y.tooltips.hyperlink,I=y.tooltips.row_column,D=y.tooltips.filter,V=y.tooltips.slicer,P=y.tooltips.foreignSelect,F=y.tooltips.eyedropper,M=y.tooltips.placeholder,R=[y.documentHolder.cmpEl.offset().left-$(window).scrollLeft(),y.documentHolder.cmpEl.offset().top-$(window).scrollTop()];if(e||y.hideHyperlinkTip(),void 0===o&&void 0===n&&!I.isHidden&&I.ref&&(I.ref.hide(),I.ref=void 0,I.text="",I.isHidden=!0),r||y.hideForeignSelectTips(),!y.permissions.isEdit&&!y.permissions.canViewComments||i&&!this.popupmenu||(k.moveCommentId=void 0,null!=k.viewCommentId&&(k={},(p=this.getApplication().getController("Common.Controllers.Comments"))&&(this.permissions.canCoAuthoring&&this.permissions.canViewComments?setTimeout(function(){p.onApiHideComment(!0)},200):p.onApiHideComment(!0)))),y.permissions.isEdit&&(s||y.hideCoAuthTips(),void 0===l&&!V.isHidden&&V.ref&&(V.ref.hide(),V.ref=void 0,V.text="",V.isHidden=!0),d||y.hidePlaceholderTip()),(void 0===a||y.dlgFilter&&y.dlgFilter.isVisible()||y.currentMenu&&y.currentMenu.isVisible())&&!D.isHidden&&D.ref&&(D.ref.hide(),D.ref=void 0,D.text="",D.isHidden=!0),c||y.hideEyedropperTip(),e&&(E.parentEl||(E.parentEl=$('<div id="tip-container-hyperlinktip" style="position: absolute; z-index: 10000;"></div>'),y.documentHolder.cmpEl.append(E.parentEl)),(m=(f=t[e-1]).asc_getHyperlink()).asc_getType()==Asc.c_oAscHyperlinkType.WebLink?(256<(x=(x=m.asc_getTooltip())||m.asc_getHyperlinkUrl()).length&&(x=x.substr(0,256)+"..."),x=Common.Utils.String.htmlEncode(x)+"<br><b>"+y.textCtrlClick+"</b>"):(x=Common.Utils.String.htmlEncode(m.asc_getTooltip()||m.asc_getLocation()),x+="<br><b>"+y.textCtrlClick+"</b>"),E.ref&&E.ref.isVisible()&&E.text!=x&&(E.ref.hide(),E.ref=void 0,E.text="",E.isHidden=!0),E.ref&&E.ref.isVisible()||(E.text=x,E.ref=new Common.UI.Tooltip({owner:E.parentEl,html:!0,title:x}),E.ref.show([-1e4,-1e4]),E.isHidden=!1,(A=[f.asc_getX(),f.asc_getY()])[0]+=R[0]+6,A[1]+=R[1]-20,A[1]-=E.ref.getBSTip().$tip.height(),C=E.ref.getBSTip().$tip.width(),A[0]+C>y.tooltips.coauth.bodyWidth&&(A[0]=y.tooltips.coauth.bodyWidth-C),E.ref.getBSTip().$tip.css({top:A[1]+"px",left:A[0]+"px"}))),void 0===o&&void 0===n||(I.parentEl||(I.parentEl=$('<div id="tip-container-rowcolumntip" style="position: absolute; z-index: 10000;"></div>'),y.documentHolder.cmpEl.append(I.parentEl)),f=t[void 0!==o?o-1:n-1],b=Common.Utils.String.format(void 0!==o?this.textChangeColumnWidth:this.textChangeRowHeight,f.asc_getSizeCCOrPt().toFixed(2),f.asc_getSizePx().toFixed()),I.ref&&I.ref.isVisible()&&I.text!=b&&(I.text=b,I.ref.setTitle(b),I.ref.updateTitle()),I.ref&&I.ref.isVisible()||(I.text=b,I.ref=new Common.UI.Tooltip({owner:I.parentEl,html:!0,title:b}),I.ref.show([-1e4,-1e4]),I.isHidden=!1,(A=[f.asc_getX(),f.asc_getY()])[0]+=R[0]+6,A[1]+=R[1]-20-I.ttHeight,C=I.ref.getBSTip().$tip.width(),A[0]+C>y.tooltips.coauth.bodyWidth&&(A[0]=y.tooltips.coauth.bodyWidth-C-20),I.ref.getBSTip().$tip.css({top:A[1]+"px",left:A[0]+"px"}))),(y.permissions.isEdit||y.permissions.canViewComments)&&i&&!this.popupmenu&&(f=t[i-1],k.editCommentId||k.moveCommentId==f.asc_getCommentIndexes()[0]||(k.moveCommentId=f.asc_getCommentIndexes()[0],k.moveCommentTimer&&clearTimeout(k.moveCommentTimer),U=f.asc_getCommentIndexes(),L=f.asc_getX(),B=f.asc_getY(),H=f.asc_getReverseX(),k.moveCommentTimer=setTimeout(function(){var t;k.moveCommentId&&!k.editCommentId&&(k.viewCommentId=k.moveCommentId,(t=y.getApplication().getController("Common.Controllers.Comments"))&&!t.isSelectedComment&&t.onApiShowComment(U,L,B,H,!1,!0))},400))),y.permissions.isEdit)if(s&&y.isUserVisible(t[s-1].asc_getUserId())&&(f=t[s-1],T.XY||y.onDocumentResize(),T.x_point==f.asc_getX()&&T.y_point==f.asc_getY()||(y.hideCoAuthTips(),T.x_point=f.asc_getX(),T.y_point=f.asc_getY(),g=$(document.createElement("div")),m=f.asc_getLockedObjectType()==Asc.c_oAscMouseMoveLockedObjectType.Sheet||f.asc_getLockedObjectType()==Asc.c_oAscMouseMoveLockedObjectType.TableProperties,(T.ref=g).addClass("username-tip"),g.css({height:T.ttHeight+"px",position:"absolute",zIndex:"900",visibility:"visible"}),$(document.body).append(g),(A=[m?T.x_point+T.rightMenuWidth:T.bodyWidth-(T.x_point+T.XY[0]),T.y_point+T.XY[1]])[1]>=T.XY[1]&&A[1]+T.ttHeight<T.XY[1]+T.apiHeight&&(g.text(y.getUserName(f.asc_getUserId())),T.bodyWidth-A[0]<T.ref.outerWidth()?g.css({visibility:"visible",left:"0px",top:A[1]-T.ttHeight+"px"}):g.css({visibility:"visible",right:A[0]+"px",top:A[1]+"px"})))),d){switch(M.parentEl||(M.parentEl=$('<div id="tip-container-placeholdertip" style="position: absolute; z-index: 10000;"></div>'),y.documentHolder.cmpEl.append(M.parentEl)),(f=t[d-1]).asc_getPlaceholderType()){case AscCommon.PlaceholderButtonType.Image:u=y.documentHolder.txtInsImage;break;case AscCommon.PlaceholderButtonType.ImageUrl:u=y.documentHolder.txtInsImageUrl}M.ref&&M.ref.isVisible()&&M.text!=u&&(M.ref.hide(),M.ref=void 0,M.text="",M.isHidden=!0),M.ref&&M.ref.isVisible()||(M.text=u,M.ref=new Common.UI.Tooltip({owner:M.parentEl,html:!0,title:u}),M.ref.show([-1e4,-1e4]),M.isHidden=!1,(A=[f.asc_getX(),f.asc_getY()])[0]+=R[0]+6,A[1]+=R[1]-20,A[1]-=M.ref.getBSTip().$tip.height(),C=M.ref.getBSTip().$tip.width(),A[0]+C>y.tooltips.coauth.bodyWidth&&(A[0]=y.tooltips.coauth.bodyWidth-C),M.ref.getBSTip().$tip.css({top:A[1]+"px",left:A[0]+"px"}))}r&&y.isUserVisible(t[r-1].asc_getUserId())&&(f=t[r-1],T.XY||y.onDocumentResize(),P.x_point==f.asc_getX()&&P.y_point==f.asc_getY()||(y.hideForeignSelectTips(),P.x_point=f.asc_getX(),P.y_point=f.asc_getY(),g=$(document.createElement("div")),S=f.asc_getColor(),P.ref=g,P.userId=f.asc_getUserId(),g.addClass("username-tip"),g.css({height:P.ttHeight+"px",position:"absolute",zIndex:"900",visibility:"visible","background-color":"#"+Common.Utils.ThemeColor.getHexColor(S.get_r(),S.get_g(),S.get_b())}),$(document.body).append(g),A=[P.x_point+T.XY[0],P.y_point+T.XY[1]-P.ttHeight],g.text(y.getUserName(f.asc_getUserId())),g.css({visibility:"visible",left:(A[0]+P.ref.outerWidth()>T.bodyWidth-T.rightMenuWidth?T.bodyWidth-T.rightMenuWidth-P.ref.outerWidth():A[0])+"px",top:A[1]+"px"}))),void 0===a||y.dlgFilter&&y.dlgFilter.isVisible()||y.currentMenu&&y.currentMenu.isVisible()||t[a-1].asc_getFilter().asc_getPivotObj()||(D.parentEl||(D.parentEl=$('<div id="tip-container-filtertip" style="position: absolute; z-index: 10000;"></div>'),y.documentHolder.cmpEl.append(D.parentEl)),f=t[a-1],b=y.makeFilterTip(f.asc_getFilter()),D.ref&&D.ref.isVisible()&&D.text!=b&&(D.text=b,D.ref.setTitle(b),D.ref.updateTitle()),D.ref&&D.ref.isVisible()||(D.text=b,D.ref=new Common.UI.Tooltip({owner:D.parentEl,html:!0,title:b,cls:"auto-tooltip"}),D.ref.show([-1e4,-1e4]),D.isHidden=!1,A=[f.asc_getX()+R[0]-10,f.asc_getY()+R[1]+20],D.ref.getBSTip().$tip.width(),A[1]+D.ttHeight>y.tooltips.coauth.bodyHeight&&(A[1]=y.tooltips.coauth.bodyHeight-D.ttHeight-5,A[0]+=20),C=D.ref.getBSTip().$tip.width(),A[0]+C>y.tooltips.coauth.bodyWidth&&(A[0]=y.tooltips.coauth.bodyWidth-C-20),D.ref.getBSTip().$tip.css({top:A[1]+"px",left:A[0]+"px"}))),void 0!==l&&y.permissions.isEdit&&(V.parentEl||(V.parentEl=$('<div id="tip-container-slicertip" style="position: absolute; z-index: 10000;"></div>'),y.documentHolder.cmpEl.append(V.parentEl)),b=(f=t[l-1]).asc_getTooltip(),V.ref&&V.ref.isVisible()&&V.text!=b&&(V.text=b,V.ref.setTitle(b),V.ref.updateTitle()),V.ref&&V.ref.isVisible()||(V.text=b,V.ref=new Common.UI.Tooltip({owner:V.parentEl,html:!0,title:b}),V.ref.show([-1e4,-1e4]),V.isHidden=!1,(A=[f.asc_getX(),f.asc_getY()])[0]+=R[0]+6,A[1]+=R[1]-20-V.ttHeight,C=V.ref.getBSTip().$tip.width(),A[0]+C>y.tooltips.coauth.bodyWidth&&(A[0]=y.tooltips.coauth.bodyWidth-C-20),V.ref.getBSTip().$tip.css({top:A[1]+"px",left:A[0]+"px"}))),c&&(F.isHidden=!1,F.ref&&(F.ref.hide(),F.ref=void 0),v=(S=(f=t[c-1]).asc_getColor()).get_r(),w=S.get_g(),_=S.get_b(),null!=v&&(x=Common.Utils.ThemeColor.getHexColor(v,w,_),O=S.asc_getName(),F.color||((E=$(document.createElement("div"))).addClass("eyedropper-color"),E.appendTo(document.body),F.color=E),F.color.css({backgroundColor:"#"+x,left:f.asc_getX()+R[0]+23+"px",top:f.asc_getY()+R[1]-53+"px"}),F.tipInterval&&clearInterval(F.tipInterval),F.tipInterval=setInterval(function(){clearInterval(F.tipInterval),y.tooltips.eyedropper.isHidden||(F.parentEl||(F.parentEl=$('<div id="tip-container-eyedroppertip" style="position: absolute; z-index: 10000;"></div>'),y.documentHolder.cmpEl.append(F.parentEl)),F.ref||(F.ref=new Common.UI.Tooltip({owner:F.parentEl,html:!0,title:"<div>RGB ("+v+","+w+","+_+")</div><div>"+O+"</div>",cls:"eyedropper-tooltip"})),F.ref.show([-1e4,-1e4]),F.tipWidth=F.ref.getBSTip().$tip.width(),(A=[f.asc_getX(),f.asc_getY()])[1]+=R[1]-57,A[0]+=R[0]+58,A[0]+F.tipWidth>y.tooltips.coauth.bodyWidth&&(A[0]=A[0]-F.tipWidth-40),F.ref.getBSTip().$tip.css({top:A[1]+"px",left:A[0]+"px"}))},800)))}},onApiHideComment:function(){this.tooltips.comment.viewCommentId=this.tooltips.comment.editCommentId=this.tooltips.comment.moveCommentId=void 0},onApiHyperlinkClick:function(e){var t;e?(t=this.api.asc_getUrlType(e))===AscCommon.c_oAscUrlType.Http||t===AscCommon.c_oAscUrlType.Email?window.open(e,"_blank"):Common.UI.warning({msg:this.txtWarnUrl,buttons:["yes","no"],primary:"yes",callback:function(t){"yes"==t&&window.open(e,"_blank")}}):Common.UI.alert({msg:this.errorInvalidLink,title:this.notcriticalErrorTitle,iconCls:"warn",buttons:["ok"],callback:_.bind(function(t){Common.NotificationCenter.trigger("edit:complete",this.documentHolder)},this)})},onApiAutofilter:function(t){var e,i,s,o=this;!o.tooltips.filter.isHidden&&o.tooltips.filter.ref&&(o.tooltips.filter.ref.hide(),o.tooltips.filter.ref=void 0,o.tooltips.filter.text="",o.tooltips.filter.isHidden=!0),o.permissions.isEdit&&(o.dlgFilter?o.dlgFilter.close():o._state.wsProps.PivotTables&&t.asc_getPivotObj()||o._state.wsProps.AutoFilter&&!t.asc_getPivotObj()||(o.dlgFilter=new SSE.Views.AutoFilterDialog({api:this.api}).on({close:function(){o.api&&o.api.asc_enableKeyEvents(!0),o.dlgFilter=void 0}}),o.api&&o.api.asc_enableKeyEvents(!1),Common.UI.Menu.Manager.hideAll(),o.dlgFilter.setSettings(t),i=o.documentHolder.cmpEl.offset(),e=(t=t.asc_getCellCoord()).asc_getX()+t.asc_getWidth()+i.left,t=t.asc_getY()+t.asc_getHeight()+i.top,i=Common.Utils.innerWidth(),s=Common.Utils.innerHeight(),e+o.dlgFilter.options.width>i&&(e=i-o.dlgFilter.options.width-5),t+o.dlgFilter.options.height>s&&(t=s-o.dlgFilter.options.height-5),o.dlgFilter.show(e,t)))},makeFilterTip:function(t){var e,i,s,o,n,a=t.asc_getFilterObj(),l=a.asc_getType(),r=(t.asc_getIsTextFilter(),t.asc_getColorsFill(),t.asc_getColorsFont(),"");return l===Asc.c_oAscAutoFilterTypes.CustomFilters?(e=(i=a.asc_getFilter()).asc_getCustomFilters(),r=this.getFilterName(Asc.c_oAscAutoFilterTypes.CustomFilters,e[0].asc_getOperator())+' "'+e[0].asc_getVal()+'"',1<e.length&&(r=(r=r+" "+(i.asc_getAnd()?this.txtAnd:this.txtOr))+" "+this.getFilterName(Asc.c_oAscAutoFilterTypes.CustomFilters,e[1].asc_getOperator())+' "'+e[1].asc_getVal()+'"')):l===Asc.c_oAscAutoFilterTypes.ColorFilter?null===(i=a.asc_getFilter()).asc_getCellColor()?r=this.txtEqualsToCellColor:!1===i.asc_getCellColor()&&(r=this.txtEqualsToFontColor):l===Asc.c_oAscAutoFilterTypes.DynamicFilter?r=this.getFilterName(Asc.c_oAscAutoFilterTypes.DynamicFilter,a.asc_getFilter().asc_getType()):l===Asc.c_oAscAutoFilterTypes.Top10?(i=(e=a.asc_getFilter()).asc_getPercent(),r=this.getFilterName(Asc.c_oAscAutoFilterTypes.Top10,e.asc_getTop()),r+=" "+e.asc_getVal()+" "+(i||null===i?this.txtPercent:this.txtItems)):l===Asc.c_oAscAutoFilterTypes.Filters?(n=void(o=s=0),(a=t.asc_getValues()).forEach(function(t){t.asc_getVisible()&&(o++,s<100&&t.asc_getText()&&(r+=t.asc_getText()+"; ",s=r.length)),t.asc_getText()||(n=t.asc_getVisible())}),r=o==a.length?this.txtAll:1==o&&n?this.txtEquals+' "'+this.txtBlanks+'"':o==a.length-1&&0==n?this.txtNotEquals+' "'+this.txtBlanks+'"':(n&&(r+=this.txtBlanks+"; "),this.txtEquals+' "'+r.substring(0,r.length-2)+'"')):l===Asc.c_oAscAutoFilterTypes.None&&(r=this.txtAll),100<r.length&&(r=r.substring(0,100)+"..."),r="<b>"+(t.asc_getColumnName()||"("+this.txtColumn+" "+t.asc_getSheetColumnName()+")")+":</b><br>"+r},getFilterName:function(t,e){var i="";if(t==Asc.c_oAscAutoFilterTypes.CustomFilters)switch(e){case Asc.c_oAscCustomAutoFilter.equals:i=this.txtEquals;break;case Asc.c_oAscCustomAutoFilter.isGreaterThan:i=this.txtGreater;break;case Asc.c_oAscCustomAutoFilter.isGreaterThanOrEqualTo:i=this.txtGreaterEquals;break;case Asc.c_oAscCustomAutoFilter.isLessThan:i=this.txtLess;break;case Asc.c_oAscCustomAutoFilter.isLessThanOrEqualTo:i=this.txtLessEquals;break;case Asc.c_oAscCustomAutoFilter.doesNotEqual:i=this.txtNotEquals;break;case Asc.c_oAscCustomAutoFilter.beginsWith:i=this.txtBegins;break;case Asc.c_oAscCustomAutoFilter.doesNotBeginWith:i=this.txtNotBegins;break;case Asc.c_oAscCustomAutoFilter.endsWith:i=this.txtEnds;break;case Asc.c_oAscCustomAutoFilter.doesNotEndWith:i=this.txtNotEnds;break;case Asc.c_oAscCustomAutoFilter.contains:i=this.txtContains;break;case Asc.c_oAscCustomAutoFilter.doesNotContain:i=this.txtNotContains}else if(t==Asc.c_oAscAutoFilterTypes.DynamicFilter)switch(e){case Asc.c_oAscDynamicAutoFilter.aboveAverage:i=this.txtAboveAve;break;case Asc.c_oAscDynamicAutoFilter.belowAverage:i=this.txtBelowAve}else t==Asc.c_oAscAutoFilterTypes.Top10&&(i=e||null===e?this.txtFilterTop:this.txtFilterBottom);return i},onUndo:function(){this.api&&(this.api.asc_Undo(),Common.NotificationCenter.trigger("edit:complete",this.documentHolder))},onApiContextMenu:function(t){Common.UI.HintManager.isHintVisible()&&Common.UI.HintManager.clearHints();var e=this;_.delay(function(){e.showObjectMenu.call(e,t)},10)},onAfterRender:function(t){},onDocumentResize:function(t){var e,i=this;i.documentHolder&&(i.tooltips.coauth.XY=[i.documentHolder.cmpEl.offset().left-$(window).scrollLeft(),i.documentHolder.cmpEl.offset().top-$(window).scrollTop()],i.tooltips.coauth.apiHeight=i.documentHolder.cmpEl.height(),i.tooltips.coauth.apiWidth=i.documentHolder.cmpEl.width(),e=$("#right-menu"),i.tooltips.coauth.rightMenuWidth=e.is(":visible")?e.width():0,i.tooltips.coauth.bodyWidth=$(window).width(),i.tooltips.coauth.bodyHeight=$(window).height())},onDocumentWheel:function(t){var e,i;this.api&&!this.isEditCell&&(e=(_.isUndefined(t.originalEvent)?t:t.originalEvent).wheelDelta,_.isUndefined(e)&&(e=t.deltaY),t.ctrlKey&&!t.altKey&&(i=this.api.asc_getZoom(),e<0?(i=Math.ceil(10*i)/10,(i-=.1)<.1||this.api.asc_setZoom(i)):0<e&&(i=Math.floor(10*i)/10,0<(i+=.1)&&!(5<i)&&this.api.asc_setZoom(i)),t.preventDefault(),t.stopPropagation()))},onDocumentKeyDown:function(t){var e,i;if(this.api)return e=t.keyCode,this.hkSpecPaste&&(this._needShowSpecPasteMenu=!t.shiftKey&&!t.altKey&&t.keyCode==Common.UI.Keys.CTRL),!t.ctrlKey&&!t.metaKey||t.shiftKey||t.altKey?e==Common.UI.Keys.F10&&t.shiftKey?(this.showObjectMenu(t),t.preventDefault(),t.stopPropagation(),!1):void(e==Common.UI.Keys.ESC&&!this.tooltips.input_msg.isHidden&&this.tooltips.input_msg.text&&this.onInputMessage()):e===Common.UI.Keys.NUM_PLUS||e===Common.UI.Keys.EQUALITY||Common.Utils.isGecko&&e===Common.UI.Keys.EQUALITY_FF||Common.Utils.isOpera&&43==e?this.api.isCellEdited?this.permissions.isEditMailMerge||this.permissions.isEditDiagram||this.permissions.isEditOle?(t.preventDefault(),t.stopPropagation(),!1):void 0:(i=Math.floor(10*this.api.asc_getZoom())/10,0<(i+=.1)&&!(5<i)&&this.api.asc_setZoom(i),t.preventDefault(),t.stopPropagation(),!1):e===Common.UI.Keys.NUM_MINUS||e===Common.UI.Keys.MINUS||Common.Utils.isGecko&&e===Common.UI.Keys.MINUS_FF||Common.Utils.isOpera&&45==e?this.api.isCellEdited?this.permissions.isEditMailMerge||this.permissions.isEditDiagram||this.permissions.isEditOle?(t.preventDefault(),t.stopPropagation(),!1):void 0:(i=Math.ceil(10*this.api.asc_getZoom())/10,(i-=.1)<.1||this.api.asc_setZoom(i),t.preventDefault(),t.stopPropagation(),!1):e!==Common.UI.Keys.ZERO&&e!==Common.UI.Keys.NUM_ZERO||this.api.isCellEdited?void 0:(this.api.asc_setZoom(1),t.preventDefault(),t.stopPropagation(),!1)},onDocumentRightDown:function(t){0==t.button&&(this.mouse.isLeftButtonDown=!0)},onDocumentRightUp:function(t){0==t.button&&(this.mouse.isLeftButtonDown=!1)},onProcessMouse:function(t){"mouseup"==t.type&&(this.mouse.isLeftButtonDown=!1)},onDragEndMouseUp:function(){this.mouse.isLeftButtonDown=!1},onDocumentMouseMove:function(t){t&&"canvas"!==t.target.localName&&this.hideHyperlinkTip()},showObjectMenu:function(t){!this.api||this.mouse.isLeftButtonDown||this.rangeSelectionMode||(this.permissions.isEdit&&!this._isDisabled?this.fillMenuProps(this.api.asc_getCellInfo(),!0,t):this.fillViewMenuProps(this.api.asc_getCellInfo(),!0,t))},onSelectionChanged:function(t){if(!this.mouse.isLeftButtonDown&&!this.rangeSelectionMode&&this.currentMenu&&this.currentMenu.isVisible()&&(this.permissions.isEdit&&!this._isDisabled?this.fillMenuProps(t,!0):this.fillViewMenuProps(t,!0)),this.mouse.isLeftButtonDown&&this.permissions&&this.permissions.isEdit){for(var e=this.api.asc_getGraphicObjectProps(),i=-1,s=!1,o=!1;++i<e.length;){var n=e[i].asc_getObjectType();n===Asc.c_oAscTypeSelectElement.Math?s=!0:n===Asc.c_oAscTypeSelectElement.Paragraph&&(n=e[i].asc_getObjectValue())&&(o=o||n.asc_getLocked())}s&&(this._state.equationLocked=o,this.disableEquationBar())}},fillMenuProps:function(t,e,L){if(t){var i,s,o,n,a,l,B,r,c,H,O,d=this.documentHolder,h=t.asc_getSelectionType(),p=t.asc_getLocked(),m=!0===t.asc_getLockedTable(),u=!0===t.asc_getLockedPivotTable(),g=!1,N=this.getApplication().getController("Common.Controllers.Comments"),$=this.permissions.isEditMailMerge||this.permissions.isEditDiagram||this.permissions.isEditOle,b=this.permissions.isEditMailMerge||this.permissions.isEditDiagram,G=t.asc_getXfs(),z=!1,C=!1;switch(h){case Asc.c_oAscSelectionType.RangeCells:i=!0;break;case Asc.c_oAscSelectionType.RangeRow:s=!0;break;case Asc.c_oAscSelectionType.RangeCol:o=!0;break;case Asc.c_oAscSelectionType.RangeMax:n=!0;break;case Asc.c_oAscSelectionType.RangeSlicer:case Asc.c_oAscSelectionType.RangeImage:l=!(this.permissions.isEditMailMerge||this.permissions.isEditDiagram);break;case Asc.c_oAscSelectionType.RangeShape:r=!(this.permissions.isEditMailMerge||this.permissions.isEditDiagram);break;case Asc.c_oAscSelectionType.RangeChart:a=!(this.permissions.isEditMailMerge||this.permissions.isEditDiagram);break;case Asc.c_oAscSelectionType.RangeChartText:c=!(this.permissions.isEditMailMerge||this.permissions.isEditDiagram);break;case Asc.c_oAscSelectionType.RangeShapeText:B=!(this.permissions.isEditMailMerge||this.permissions.isEditDiagram)}if(this.api.asc_getHeaderFooterMode())d.copyPasteMenu&&(e||d.copyPasteMenu.isVisible())&&e&&this.showPopupMenu(d.copyPasteMenu,{},L);else if(l||r||a){if(d.imgMenu&&(e||d.imgMenu.isVisible())){l=r=a=O=!1,d.mnuImgAdvanced.imageInfo=void 0;for(var W,j=!1,f=this.api.asc_getGraphicObjectProps(),S=0;S<f.length;S++)if(f[S].asc_getObjectType()==Asc.c_oAscTypeSelectElement.Image){var v=f[S].asc_getObjectValue(),g=g||v.asc_getLocked();if(this._state.wsProps.Objects&&v.asc_getProtectionLocked())return;var q=v.asc_getShapeProperties();q?q.asc_getFromChart()?a=!0:q.asc_getFromImage()?H=!0:(d.mnuShapeAdvanced.shapeInfo=v,r=!0,q.asc_getFromSmartArt()&&(z=!0),q.asc_getFromSmartArtInternal()&&(C=!0)):v.asc_getChartProperties()?(d.mnuChartEdit.chartInfo=v,j=a=!0):v.asc_getSlicerProperties()?(d.mnuSlicerAdvanced.imageInfo=v,O=!0):(d.mnuImgAdvanced.imageInfo=v,l=!0),this.permissions.isSignatureSupport&&(W=v.asc_getSignatureId())}d.mnuBringToFront.setDisabled(C),d.mnuSendToBack.setDisabled(C),d.mnuBringForward.setDisabled(C),d.mnuSendBackward.setDisabled(C);var w=this.api.asc_canGroupGraphicsObjects(),w=(d.mnuUnGroupImg.setDisabled(g||!this.api.asc_canUnGroupGraphicsObjects()),d.mnuGroupImg.setDisabled(g||!w),d.menuImageAlign.setDisabled(g||!w),this.api.asc_getSelectedDrawingObjectsCount()),w=(d.menuImageAlign.menu.items[7].setDisabled(w<3),d.menuImageAlign.menu.items[8].setDisabled(w<3),d.mnuShapeAdvanced.setVisible(r&&!l&&!a),d.mnuShapeAdvanced.setDisabled(g),d.mnuChartEdit.setVisible(a&&!l&&!r&&j),d.mnuChartEdit.setDisabled(g),d.mnuChartData.setVisible(this.permissions.isEditOle&&a&&!l&&!r&&j),d.mnuChartData.setDisabled(g),d.mnuChartType.setVisible(this.permissions.isEditOle&&a&&!l&&!r&&j),d.mnuChartType.setDisabled(g),d.pmiImgCut.setDisabled(g),d.pmiImgPaste.setDisabled(g),d.mnuImgAdvanced.setVisible(l&&(!r||H)&&!a),d.mnuImgAdvanced.setDisabled(g),d.menuImgOriginalSize.setVisible(l&&(!r||H)&&!a),d.mnuImgAdvanced.imageInfo&&d.menuImgOriginalSize.setDisabled(g||null===d.mnuImgAdvanced.imageInfo.get_ImageUrl()||void 0===d.mnuImgAdvanced.imageInfo.get_ImageUrl()),d.mnuSlicerAdvanced.setVisible(O),d.mnuSlicerAdvanced.setDisabled(g),d.mnuImgAdvanced.imageInfo?d.mnuImgAdvanced.imageInfo.asc_getPluginGuid():null),w=(d.menuImgReplace.setVisible(H&&null==w),d.menuImgReplace.setDisabled(g||null===w),d.menuImgReplace.menu.items[2].setVisible(this.permissions.canRequestInsertImage||this.permissions.fileChoiceUrl&&-1<this.permissions.fileChoiceUrl.indexOf("{documentType}")),d.menuImageArrange.setDisabled(g),d.menuImgRotate.setVisible(!a&&null==w&&!O),d.menuImgRotate.setDisabled(g||z),d.menuImgRotate.menu.items[3].setDisabled(C),d.menuImgRotate.menu.items[4].setDisabled(C),d.menuImgCrop.setVisible(this.api.asc_canEditCrop()),d.menuImgCrop.setDisabled(g),!!W),x=(d.menuSignatureEditSign.setVisible(w),d.menuSignatureEditSetup.setVisible(w),d.menuEditSignSeparator.setVisible(w),d.menuImgMacro.setVisible(!$),d.menuImgMacro.setDisabled(g),this.api&&this.api.asc_canEditGeometry());d.menuImgEditPoints.setVisible(x),x&&d.menuImgEditPoints.setDisabled(g),e&&this.showPopupMenu(d.imgMenu,{},L),d.mnuShapeSeparator.setVisible(d.mnuShapeAdvanced.isVisible()||d.mnuChartEdit.isVisible()||d.mnuImgAdvanced.isVisible()),d.mnuSlicerSeparator.setVisible(d.mnuSlicerAdvanced.isVisible()),w&&(d.menuSignatureEditSign.cmpEl.attr("data-value",W),d.menuSignatureEditSetup.cmpEl.attr("data-value",W))}}else if(B||c){if(d.textInShapeMenu&&(e||d.textInShapeMenu.isVisible())){d.pmiTextAdvanced.textInfo=void 0;for(var f=this.api.asc_getGraphicObjectProps(),y=!1,S=0;S<f.length;S++){var K=f[S].asc_getObjectType();if(K==Asc.c_oAscTypeSelectElement.Image){var A=f[S].asc_getObjectValue(),T=A.asc_getVerticalTextAlign(),k=A.asc_getVert(),E=this.api.asc_getCurrentListType(),I=A?A.asc_getShapeProperties():null;if(this._state.wsProps.Objects&&A.asc_getProtectionLockText())return;g=g||A.asc_getLocked();var z=!!I&&I.asc_getFromSmartArt(),C=!!I&&I.asc_getFromSmartArtInternal(),D="";switch(T){case Asc.c_oAscVAlign.Top:D="menu__icon btn-align-top";break;case Asc.c_oAscVAlign.Center:D="menu__icon btn-align-middle";break;case Asc.c_oAscVAlign.Bottom:D="menu__icon btn-align-bottom"}switch(d.menuParagraphVAlign.setIconCls(D),d.menuParagraphTop.setChecked(T==Asc.c_oAscVAlign.Top),d.menuParagraphCenter.setChecked(T==Asc.c_oAscVAlign.Center),d.menuParagraphBottom.setChecked(T==Asc.c_oAscVAlign.Bottom),D="",k){case Asc.c_oAscVertDrawingText.normal:D="menu__icon btn-text-orient-hor";break;case Asc.c_oAscVertDrawingText.vert:D="menu__icon btn-text-orient-rdown";break;case Asc.c_oAscVertDrawingText.vert270:D="menu__icon btn-text-orient-rup"}d.menuParagraphDirection.setIconCls(D),d.menuParagraphDirectH.setChecked(k==Asc.c_oAscVertDrawingText.normal),d.menuParagraphDirect90.setChecked(k==Asc.c_oAscVertDrawingText.vert),d.menuParagraphDirect270.setChecked(k==Asc.c_oAscVertDrawingText.vert270),d.menuParagraphBulletNone.setChecked(-1==E.get_ListType());var V,P,A=E.get_ListType(),I=E.get_ListSubType(),T=d.paraBulletsPicker.store.at(7),k=4096===T.get("subtype")&&(1===A||4096!==I);1===A||4096!==I?V=d.paraBulletsPicker.store.findWhere({type:A,subtype:I}):(A=E.asc_getListCustom())&&((I=A.asc_getType())===Asc.asc_PreviewBulletType.char?(E=A.asc_getChar())&&((P=new Asc.asc_CBullet).asc_putSymbol(E),P.asc_putFont(A.asc_getSpecialFont()),(V=T).set("subtype",4096),V.set("customBullet",P),V.set("numberingInfo",JSON.stringify(P.asc_getJsonBullet())),V.set("tip",""),d.paraBulletsPicker.dataViewItems&&this.updateBulletTip(d.paraBulletsPicker.dataViewItems[7],""),k=!1):I===Asc.asc_PreviewBulletType.image&&(E=A.asc_getImageId())&&((P=new Asc.asc_CBullet).asc_fillBulletImage(E),(V=T).set("subtype",4096),V.set("customBullet",P),V.set("numberingInfo",JSON.stringify(P.asc_getJsonBullet())),V.set("tip",""),d.paraBulletsPicker.dataViewItems&&this.updateBulletTip(d.paraBulletsPicker.dataViewItems[7],""),k=!1)),d.paraBulletsPicker.selectRecord(V,!0),k&&(T.set("subtype",8),T.set("numberingInfo",d._markersArr[7]),T.set("tip",d.tipMarkersDash),d.paraBulletsPicker.dataViewItems&&this.updateBulletTip(d.paraBulletsPicker.dataViewItems[7],d.tipMarkersDash))}else K==Asc.c_oAscTypeSelectElement.Paragraph?(d.pmiTextAdvanced.textInfo=f[S].asc_getObjectValue(),g=g||d.pmiTextAdvanced.textInfo.asc_getLocked()):K==Asc.c_oAscTypeSelectElement.Math&&(this._currentMathObj=f[S].asc_getObjectValue(),y=!0)}var Y=t.asc_getHyperlink(),x=this.api.asc_canAddShapeHyperlink();d.menuParagraphBullets.setVisible(!0!==c),d.menuHyperlinkShape.setVisible(B&&!1!==x&&Y),d.menuAddHyperlinkShape.setVisible(B&&!1!==x&&!Y),d.menuParagraphVAlign.setVisible(!0!==c&&!y),d.menuParagraphDirection.setVisible(!0!==c&&!y),d.textInShapeMenu.items[3].setVisible(!0!==c||B&&!1!==x),d.pmiTextAdvanced.setVisible(void 0!==d.pmiTextAdvanced.textInfo),_.each(d.textInShapeMenu.items,function(t){t.setDisabled(g)}),d.pmiTextCopy.setDisabled(!1),d.menuHyperlinkShape.setDisabled(g||this._state.wsProps.InsertHyperlinks),d.menuAddHyperlinkShape.setDisabled(g||this._state.wsProps.InsertHyperlinks);this._currentParaObjDisabled=g,y?this.addEquationMenu(4):this.clearEquationMenu(4),d.menuParagraphEquation.setVisible(y),d.menuParagraphEquation.setDisabled(g),y&&(w=this.api.asc_GetMathInputType(),x=Common.Utils.InternalSettings.get("sse-equation-toolbar-hide"),d.menuParagraphEquation.menu.items[5].setChecked(w===Asc.c_oAscMathInputType.Unicode),d.menuParagraphEquation.menu.items[6].setChecked(w===Asc.c_oAscMathInputType.LaTeX),d.menuParagraphEquation.menu.items[8].options.isToolbarHide=x,d.menuParagraphEquation.menu.items[8].setCaption(x?d.showEqToolbar:d.hideEqToolbar,!0)),e&&this.showPopupMenu(d.textInShapeMenu,{},L),d.menuParagraphBullets.setDisabled(z||C)}}else if(!this.permissions.isEditMailMerge&&!this.permissions.isEditDiagram&&!this.permissions.isEditOle||h!==Asc.c_oAscSelectionType.RangeImage&&h!==Asc.c_oAscSelectionType.RangeShape&&h!==Asc.c_oAscSelectionType.RangeChart&&h!==Asc.c_oAscSelectionType.RangeChartText&&h!==Asc.c_oAscSelectionType.RangeShapeText&&h!==Asc.c_oAscSelectionType.RangeSlicer){if(d.ssMenu&&(e||d.ssMenu.isVisible())){this.propsPivot={originalProps:t.asc_getPivotTableInfo()};var w=this.api.isCellEdited,x=t.asc_getFormatTableInfo(),F=null!==t.asc_getSparklineInfo(),M=null!==x,X=t.asc_getMultiselect(),R=!!this.propsPivot.originalProps,U=!0===t.asc_getUserProtected(),F=(d.ssMenu.formatTableName=M?x.asc_getTableName():null,d.ssMenu.cellColor=G.asc_getFillColor(),d.ssMenu.fontColor=G.asc_getFontColor(),d.pmiCut.setVisible(!R),d.pmiPaste.setVisible(!R),d.pmiInsertEntire.setVisible(s||o),d.pmiInsertEntire.setCaption(s?this.textInsertTop:this.textInsertLeft),d.pmiDeleteEntire.setVisible(s||o),d.pmiInsertCells.setVisible(i&&!w&&!M&&!R),d.pmiDeleteCells.setVisible(i&&!w&&!M&&!R),d.pmiSelectTable.setVisible(i&&!w&&M),d.pmiInsertTable.setVisible(i&&!w&&M),d.pmiDeleteTable.setVisible(i&&!w&&M),d.pmiSparklines.setVisible(F),d.pmiSortCells.setVisible((i||n)&&!w&&!R),d.pmiSortCells.menu.items[2].setVisible(!b),d.pmiSortCells.menu.items[3].setVisible(!b),d.pmiSortCells.menu.items[4].setVisible(!$),d.pmiFilterCells.setVisible(i&&!w&&!b&&!R),d.pmiReapply.setVisible((i||n)&&!w&&!b&&!R),d.pmiCondFormat.setVisible(!w&&!b),d.ssMenu.items[12].setVisible((i||n||F)&&!w),d.pmiInsFunction.setVisible(i&&!w&&!R),d.pmiAddNamedRange.setVisible(i&&!w&&!$),i&&!w&&!b&&R);if(F&&this.fillPivotProps(),d.mnuRefreshPivot.setVisible(F),d.mnuPivotRefreshSeparator.setVisible(F),d.mnuPivotSort.setVisible(this.propsPivot.filter||this.propsPivot.rowFilter||this.propsPivot.colFilter),d.mnuPivotFilter.setVisible(!!this.propsPivot.filter),d.mnuPivotFilterSeparator.setVisible(this.propsPivot.filter||this.propsPivot.rowFilter||this.propsPivot.colFilter),d.mnuSubtotalField.setVisible(!!this.propsPivot.field&&(0===this.propsPivot.fieldType||1===this.propsPivot.fieldType)),d.mnuPivotSubtotalSeparator.setVisible(!!this.propsPivot.field&&(0===this.propsPivot.fieldType||1===this.propsPivot.fieldType)),d.mnuGroupPivot.setVisible(!!this.propsPivot.canGroup),d.mnuUnGroupPivot.setVisible(!!this.propsPivot.canGroup),d.mnuPivotGroupSeparator.setVisible(!!this.propsPivot.canGroup),d.mnuDeleteField.setVisible(!!this.propsPivot.field),d.mnuPivotDeleteSeparator.setVisible(!!this.propsPivot.field),d.mnuSummarize.setVisible(!!this.propsPivot.field&&2===this.propsPivot.fieldType),d.mnuShowAs.setVisible(!!this.propsPivot.field&&2===this.propsPivot.fieldType&&!this.propsPivot.rowTotal&&!this.propsPivot.colTotal),d.mnuPivotValueSeparator.setVisible(!!this.propsPivot.field&&2===this.propsPivot.fieldType),d.mnuShowDetails.setVisible(!!this.propsPivot.showDetails),d.mnuShowDetailsSeparator.setVisible(!!this.propsPivot.showDetails),d.mnuPivotSettings.setVisible(F),d.mnuFieldSettings.setVisible(!!this.propsPivot.field),this.propsPivot.field)if(d.mnuDeleteField.setCaption(d.txtDelField+" "+(this.propsPivot.rowTotal||this.propsPivot.colTotal?d.txtGrandTotal:'"'+Common.Utils.String.htmlEncode(this.propsPivot.fieldName)+'"'),!0),d.mnuSubtotalField.setCaption(d.txtSubtotalField+' "'+Common.Utils.String.htmlEncode(this.propsPivot.fieldName)+'"',!0),d.mnuFieldSettings.setCaption(2===this.propsPivot.fieldType?d.txtValueFieldSettings:d.txtFieldSettings),2===this.propsPivot.fieldType){for(var J=this.propsPivot.field.asc_getSubtotal(),S=0;S<d.mnuSummarize.menu.items.length;S++)void 0!==(Z=d.mnuSummarize.menu.items[S]).value&&Z.setChecked(Z.value===J,!0);if(!this.propsPivot.rowTotal&&!this.propsPivot.colTotal)for(var Z,J=this.propsPivot.field.asc_getShowDataAs(),S=0;S<d.mnuShowAs.menu.items.length;S++)void 0!==(Z=d.mnuShowAs.menu.items[S]).value&&Z.setChecked(Z.value===J,!0)}else d.mnuSubtotalField.setChecked(!!this.propsPivot.field.asc_getDefaultSubtotal(),!0);this.propsPivot.filter&&(d.mnuPivotFilter.menu.items[0].setCaption(this.propsPivot.fieldName?Common.Utils.String.format(d.txtClearPivotField,' "'+Common.Utils.String.htmlEncode(this.propsPivot.fieldName)+'"'):d.txtClear,!0),d.mnuPivotFilter.menu.items[0].setDisabled(this.propsPivot.filter.asc_getFilterObj().asc_getType()===Asc.c_oAscAutoFilterTypes.None)),R&&d.mnuPivotSort.menu.items[2].setDisabled(!(this.propsPivot.filter||this.propsPivot.rowFilter&&this.propsPivot.colFilter)),M&&(d.pmiInsertTable.menu.items[0].setDisabled(!x.asc_getIsInsertRowAbove()),d.pmiInsertTable.menu.items[1].setDisabled(!x.asc_getIsInsertRowBelow()),d.pmiInsertTable.menu.items[2].setDisabled(!x.asc_getIsInsertColumnLeft()),d.pmiInsertTable.menu.items[3].setDisabled(!x.asc_getIsInsertColumnRight()),d.pmiDeleteTable.menu.items[0].setDisabled(!x.asc_getIsDeleteRow()),d.pmiDeleteTable.menu.items[1].setDisabled(!x.asc_getIsDeleteColumn()),d.pmiDeleteTable.menu.items[2].setDisabled(!x.asc_getIsDeleteTable()));Y=t.asc_getHyperlink(),F=(d.menuHyperlink.setVisible(i&&Y&&!w&&!X&&!b&&!R),d.menuAddHyperlink.setVisible(i&&!Y&&!w&&!X&&!b&&!R),d.pmiRowHeight.setVisible(s||n),d.pmiColumnWidth.setVisible(o||n),d.pmiEntireHide.setVisible(o||s),d.pmiEntireShow.setVisible(o||s),d.pmiFreezePanes.setVisible(!w),d.pmiFreezePanes.setCaption(this.api.asc_getSheetViewSettings().asc_getIsFreezePane()?d.textUnFreezePanes:d.textFreezePanes),t.asc_getComments());d.pmiAddCommentSeparator.setVisible(i&&!w&&this.permissions.canCoAuthoring&&this.permissions.canComments&&F&&F.length<1),d.pmiAddComment.setVisible(i&&!w&&this.permissions.canCoAuthoring&&this.permissions.canComments&&F&&F.length<1),d.pmiCellMenuSeparator.setVisible(i&&!w||s||o||n),d.pmiEntireHide.isrowmenu=s,d.pmiEntireShow.isrowmenu=s,N&&N.blockPopover(!0),d.pmiClear.menu.items[0].setDisabled(!this.permissions.canModifyFilter),d.pmiClear.menu.items[1].setDisabled(w),d.pmiClear.menu.items[2].setDisabled(w||!this.permissions.canModifyFilter),d.pmiClear.menu.items[3].setDisabled(w),d.pmiClear.menu.items[4].setDisabled(w),d.pmiClear.menu.items[3].setVisible(!this.permissions.isEditDiagram),d.pmiClear.menu.items[4].setVisible(!this.permissions.isEditDiagram);x=!!(M=t.asc_getAutoFilterInfo())&&M.asc_getIsApplyAutoFilter(),M=M?M.asc_getIsAutoFilter():null;d.pmiInsertCells.menu.items[0].setDisabled(x),d.pmiDeleteCells.menu.items[0].setDisabled(x),d.pmiInsertCells.menu.items[1].setDisabled(x),d.pmiDeleteCells.menu.items[1].setDisabled(x),d.pmiEntriesList.setVisible(!w&&!R),d.pmiNumFormat.setVisible(!w),d.pmiAdvancedNumFormat.options.numformatinfo=d.pmiNumFormat.menu.options.numformatinfo=G.asc_getNumFormatInfo(),d.pmiAdvancedNumFormat.options.numformat=G.asc_getNumFormat(),d.pmiGetRangeList.setVisible(!Common.Utils.isIE&&i&&!w&&!X&&!$&&this.permissions.canMakeActionLink&&!!navigator.clipboard),_.each(d.ssMenu.items,function(t){t.setDisabled(p||U)}),d.pmiCopy.setDisabled(!1),d.pmiSelectTable.setDisabled(this._state.wsLock),d.pmiInsertEntire.setDisabled(p||m||s&&this._state.wsProps.InsertRows||o&&this._state.wsProps.InsertColumns||U),d.pmiInsertCells.setDisabled(p||m||R||this._state.wsLock||U),d.pmiInsertTable.setDisabled(p||m||this._state.wsLock||U),d.pmiDeleteEntire.setDisabled(p||m||s&&this._state.wsProps.DeleteRows||o&&this._state.wsProps.DeleteColumns||U),d.pmiDeleteCells.setDisabled(p||m||R||this._state.wsLock||U),d.pmiDeleteTable.setDisabled(p||m||this._state.wsLock||U),d.pmiClear.setDisabled(p||R||U),d.pmiFilterCells.setDisabled(p||m||null==M||R||!M&&!this.permissions.canModifyFilter||this._state.wsLock||U),d.pmiSortCells.setDisabled(p||m||null==M||R||!this.permissions.canModifyFilter||this._state.wsProps.Sort||U),d.pmiReapply.setDisabled(p||m||!0!==x||U),d.pmiCondFormat.setDisabled(p||m||this._state.wsProps.FormatCells||U),d.menuHyperlink.setDisabled(p||R||this._state.wsProps.InsertHyperlinks||U),d.menuAddHyperlink.setDisabled(p||R||this._state.wsProps.InsertHyperlinks||U),d.pmiInsFunction.setDisabled(p||R||U),d.pmiFreezePanes.setDisabled(this.api.asc_isWorksheetLockedOrDeleted(this.api.asc_getActiveWorksheetIndex())),d.pmiRowHeight.setDisabled(p||this._state.wsProps.FormatRows),d.pmiColumnWidth.setDisabled(p||this._state.wsProps.FormatColumns),d.pmiEntireHide.setDisabled(p||o&&this._state.wsProps.FormatColumns||s&&this._state.wsProps.FormatRows),d.pmiEntireShow.setDisabled(p||o&&this._state.wsProps.FormatColumns||s&&this._state.wsProps.FormatRows),d.pmiNumFormat.setDisabled(p||this._state.wsProps.FormatCells||U),d.pmiSparklines.setDisabled(p||this._state.wsLock||U),d.pmiEntriesList.setDisabled(p||this._state.wsLock||U),d.pmiAddNamedRange.setDisabled(p||this._state.wsLock),d.pmiAddComment.setDisabled(p||this._state.wsProps.Objects),d.pmiGetRangeList.setDisabled(!1),R&&(d.mnuGroupPivot.setDisabled(u||this._state.wsLock),d.mnuUnGroupPivot.setDisabled(u||this._state.wsLock),d.mnuRefreshPivot.setDisabled(u||this._state.wsLock),d.mnuPivotSettings.setDisabled(u||this._state.wsLock),d.mnuFieldSettings.setDisabled(u||this._state.wsLock),d.mnuDeleteField.setDisabled(u||this._state.wsLock),d.mnuSubtotalField.setDisabled(u||this._state.wsLock),d.mnuSummarize.setDisabled(u||this._state.wsLock),d.mnuShowAs.setDisabled(u||this._state.wsLock),d.mnuShowDetails.setDisabled(this.api.asc_isWorkbookLocked()||this.api.asc_isProtectedWorkbook()),d.mnuPivotFilter.setDisabled(u||this._state.wsLock)),e&&this.showPopupMenu(d.ssMenu,{},L),d.pmiFunctionSeparator.setVisible(d.pmiInsFunction.isVisible()||d.menuAddHyperlink.isVisible()||d.menuHyperlink.isVisible()||s||o||n),d.pmiFreezeSeparator.setVisible(d.pmiFreezePanes.isVisible())}}else this.permissions.isEditDiagram&&h==Asc.c_oAscSelectionType.RangeChartText&&(e||d.textInShapeMenu.isVisible())&&(d.pmiTextAdvanced.textInfo=void 0,d.menuHyperlinkShape.setVisible(!1),d.menuAddHyperlinkShape.setVisible(!1),d.menuParagraphVAlign.setVisible(!1),d.menuParagraphDirection.setVisible(!1),d.pmiTextAdvanced.setVisible(!1),d.menuParagraphEquation.setVisible(!1),d.textInShapeMenu.items[9].setVisible(!1),d.menuParagraphBullets.setVisible(!1),d.textInShapeMenu.items[3].setVisible(!1),d.pmiTextCopy.setDisabled(!1),e&&this.showPopupMenu(d.textInShapeMenu,{},L))}},fillViewMenuProps:function(t,e,i){if(t){var s,o=this.documentHolder,n=t.asc_getSelectionType(),a=t.asc_getLocked(),l=!0===t.asc_getLockedTable(),r=this.getApplication().getController("Common.Controllers.Comments"),c=n==Asc.c_oAscSelectionType.RangeCells&&!this.permissions.isEditMailMerge&&!this.permissions.isEditDiagram&&!this.permissions.isEditOle,d=this.api.isCellEdited,n=!(n!=Asc.c_oAscSelectionType.RangeShape&&n!=Asc.c_oAscSelectionType.RangeImage||this.permissions.isEditMailMerge||this.permissions.isEditDiagram||this.permissions.isEditOle);if(o.viewModeMenu||o.createDelayedElementsViewer(),e||o.viewModeMenu.isVisible()){if(n&&this.permissions.isSignatureSupport)for(var h=this.api.asc_getGraphicObjectProps(),p=0;p<h.length;p++)h[p].asc_getObjectType()==Asc.c_oAscTypeSelectElement.Image&&(s=h[p].asc_getObjectValue().asc_getSignatureId());var n=s?this.api.asc_getSignatureSetup(s):null,m=!!n&&this._canProtect,c=c&&!d&&this.permissions.canCoAuthoring&&this.permissions.canComments&&!this._isDisabled&&t.asc_getComments()&&t.asc_getComments().length<1,d=(o.menuViewUndo.setVisible(this.permissions.canCoAuthoring&&this.permissions.canComments&&!this._isDisabled),o.menuViewUndo.setDisabled(!this.api.asc_getCanUndo()),o.menuViewCopySeparator.setVisible(m),!!n&&n.asc_getRequested());o.menuSignatureViewSign.setVisible(m&&d),o.menuSignatureDetails.setVisible(m&&!d),o.menuSignatureViewSetup.setVisible(m),o.menuSignatureRemove.setVisible(m&&!d),o.menuViewSignSeparator.setVisible(c),o.menuViewAddComment.setVisible(c),r&&r.blockPopover(!0),o.menuViewAddComment.setDisabled(a||l||this._state.wsProps.Objects),e&&this.showPopupMenu(o.viewModeMenu,{},i),m&&(o.menuSignatureViewSign.cmpEl.attr("data-value",s),o.menuSignatureDetails.cmpEl.attr("data-value",n.asc_getId()),o.menuSignatureViewSetup.cmpEl.attr("data-value",s),o.menuSignatureRemove.cmpEl.attr("data-value",s))}}},showPopupMenu:function(t,e,i){var s,o,n,a;!_.isUndefined(t)&&null!==t&&i&&(Common.UI.Menu.Manager.hideAll(),n=this.documentHolder,s=[i.pageX*Common.Utils.zoom()-n.cmpEl.offset().left,i.pageY*Common.Utils.zoom()-n.cmpEl.offset().top],o=n.cmpEl.find(Common.Utils.String.format("#menu-container-{0}",t.id)),t.rendered||(o.length<1&&(o=$(Common.Utils.String.format('<div id="menu-container-{0}" style="position: absolute; z-index: 10000;"><div class="dropdown-toggle" data-toggle="dropdown"></div></div>',t.id)),n.cmpEl.append(o)),t.render(o),t.cmpEl.attr({tabindex:"-1"})),2!==i.button&&(n=this.api.asc_getActiveCellCoord(),s[a=i=0]=n.asc_getX()+n.asc_getWidth()+i,s[1]=(n.asc_getY()<0?0:n.asc_getY())+n.asc_getHeight()+a),o.css({left:s[0],top:s[1]}),_.isFunction(t.options.initMenu)&&(t.options.initMenu(e),t.alignPosition()),_.delay(function(){t.cmpEl.focus()},10),t.show(),this.currentMenu=t,this.api.onPluginContextMenuShow&&this.api.onPluginContextMenuShow())},onEntriesListMenu:function(t,e,i){if(e&&0<e.length){var s=this,o=s.documentHolder,n=o.entriesMenu,a=o.cmpEl.find(Common.Utils.String.format("#menu-container-{0}",n.id));if(t&&n.isVisible())n.hide();else{for(var l=0;l<n.items.length;l++)n.removeItem(n.items[l]),l--;_.each(e,function(t,e){e=new Common.UI.MenuItem({caption:t,value:i?i[e]:t,style:"string"==typeof t&&_.isEmpty(t.trim())?"min-height: 25px;":""}).on("click",function(t,e){s.api.asc_insertInCell(t.value,Asc.c_oAscPopUpSelectorType.None,!1)});n.addItem(e)}),Common.UI.Menu.Manager.hideAll(),n.rendered||(a.length<1&&(a=$(Common.Utils.String.format('<div id="menu-container-{0}" style="position: absolute; z-index: 10000;"><div class="dropdown-toggle" data-toggle="dropdown"></div></div>',n.id)),o.cmpEl.append(a)),n.render(a),n.cmpEl.attr({tabindex:"-1"}));var e=s.api.asc_getActiveCellCoord(t),o=0,r=0,o=[e.asc_getX()+o+(t?e.asc_getWidth():0),(e.asc_getY()<0?0:e.asc_getY())+e.asc_getHeight()+r];a.css({left:o[0],top:o[1]}),n.menuAlign=t?"tr-br":"tl-bl",Common.UI.isRTL()&&(n.menuAlign="tr-br"===n.menuAlign?"tl-bl":"tr-br"),(s._preventClick=t)&&a.attr("data-value","prevent-canvas-click"),n.show(),n.alignPosition(),_.delay(function(){n.cmpEl.focus()},10)}}else this.documentHolder.entriesMenu.hide(),t||Common.UI.warning({title:this.notcriticalErrorTitle,maxwidth:600,msg:this.txtNoChoices,callback:_.bind(function(t){Common.NotificationCenter.trigger("edit:complete",this.documentHolder)},this)})},onTableTotalMenu:function(e){var t,i,s,o,n;void 0!==e?(n=this.documentHolder,t=n.tableTotalMenu,i=n.cmpEl.find(Common.Utils.String.format("#menu-container-{0}",t.id)),t.isVisible()?t.hide():(Common.UI.Menu.Manager.hideAll(),t.rendered||(i.length<1&&(i=$(Common.Utils.String.format('<div id="menu-container-{0}" style="position: absolute; z-index: 10000;"><div class="dropdown-toggle" data-toggle="dropdown"></div></div>',t.id)),n.cmpEl.append(i)),t.render(i),t.cmpEl.attr({tabindex:"-1"})),t.clearAll(),(n=_.find(t.items,function(t){return t.value==e}))&&n.setChecked(!0,!0),o=n=0,n=[(s=this.api.asc_getActiveCellCoord()).asc_getX()+n+s.asc_getWidth(),(s.asc_getY()<0?0:s.asc_getY())+s.asc_getHeight()+o],i.css({left:n[0],top:n[1]}),this._preventClick=!0,i.attr("data-value","prevent-canvas-click"),t.show(),t.alignPosition(),_.delay(function(){t.cmpEl.focus()},10))):this.documentHolder.tableTotalMenu.hide()},onTotalMenuClick:function(t,e){e.value==Asc.ETotalsRowFunction.totalrowfunctionCustom?this.onInsFunction(e):this.api.asc_insertInCell(e.value,Asc.c_oAscPopUpSelectorType.TotalRowFunc),Common.NotificationCenter.trigger("edit:complete",this.documentHolder)},onFormulaCompleteMenu:function(t,e){if(this.documentHolder.funcMenu&&!Common.Utils.ModalWindow.isVisible()&&!this.rangeSelectionMode)if(t){for(var r=this,i=r.documentHolder,c=i.funcMenu,l=i.cmpEl.find("#menu-formula-selection"),d=r.getApplication().getController("FormulaDialog").getDescription(Common.Utils.InternalSettings.get("sse-settings-func-locale")),s=0;s<c.items.length;s++){var o=c.items[s].cmpEl.data("bs.tooltip");o&&o.hide(),c.removeItem(c.items[s]),s--}t.sort(function(t,e){var i=t.asc_getType(),s=e.asc_getType();return i===s&&i===Asc.c_oAscPopUpSelectorType.TableColumnName?0:i===Asc.c_oAscPopUpSelectorType.TableThisRow?-1:s===Asc.c_oAscPopUpSelectorType.TableThisRow?1:i!==Asc.c_oAscPopUpSelectorType.TableColumnName&&s!==Asc.c_oAscPopUpSelectorType.TableColumnName||i===s?(s=t.asc_getName(!0).toLocaleUpperCase())<(t=e.asc_getName(!0).toLocaleUpperCase())?-1:t<s?1:0:i===Asc.c_oAscPopUpSelectorType.TableColumnName?-1:1}),_.each(t,function(t,e){var i=t.asc_getType(),s=t.asc_getName(!0),o=r.api.asc_getFormulaNameByLocale(s),n="",a=s,l="";switch(i){case Asc.c_oAscPopUpSelectorType.Func:n="menu__icon btn-function",l=d&&d[o]?d[o].d:"";break;case Asc.c_oAscPopUpSelectorType.Table:n="menu__icon btn-menu-table";break;case Asc.c_oAscPopUpSelectorType.Slicer:n="menu__icon btn-slicer";break;case Asc.c_oAscPopUpSelectorType.Range:n="menu__icon btn-named-range";break;case Asc.c_oAscPopUpSelectorType.TableColumnName:a="(...) "+s;break;case Asc.c_oAscPopUpSelectorType.TableThisRow:l=r.txtThisRowHint;break;case Asc.c_oAscPopUpSelectorType.TableAll:l=r.txtAllTableHint;break;case Asc.c_oAscPopUpSelectorType.TableData:l=r.txtDataTableHint;break;case Asc.c_oAscPopUpSelectorType.TableHeaders:l=r.txtHeadersTableHint;break;case Asc.c_oAscPopUpSelectorType.TableTotals:l=r.txtTotalsTableHint}t=new Common.UI.MenuItem({iconCls:n,caption:a,name:s,hint:l}).on("click",function(t,e){setTimeout(function(){r.api.asc_insertInCell(t.options.name,i,!1)},10)});c.addItem(t)}),c.rendered||(l.length<1&&(l=$(Common.Utils.String.format('<div id="menu-formula-selection" style="position: absolute; z-index: 10000;" class="no-stop-propagate"><div class="dropdown-toggle" data-toggle="dropdown"></div></div>')),i.cmpEl.append(l)),c.onAfterKeydownMenu=function(t){var e,i,s,o,n,a;t.keyCode==Common.UI.Keys.RETURN&&(t.ctrlKey||t.altKey)||(1<arguments.length&&arguments[1]instanceof KeyboardEvent&&(t=arguments[1]),l.hasClass("open")&&(t.keyCode==Common.UI.Keys.TAB||t.keyCode==Common.UI.Keys.RETURN&&!t.ctrlKey&&!t.altKey?e=l.find("a.focus").closest("li"):t.keyCode!=Common.UI.Keys.UP&&t.keyCode!=Common.UI.Keys.DOWN||(t=c.cmpEl,n=l.find("a.focus").closest("li"),s=((i=t.innerHeight())-t.height())/2,o=n.position().top,n=n.outerHeight(),o<0?a=t.scrollTop()+o-s:i<o+n&&(a=t.scrollTop()+o+n-i+s),void 0!==a&&(c.scroller?c.scroller.scrollTop(a,0):t.scrollTop(a)))),e&&(0<e.length&&e.click(),Common.UI.Menu.Manager.hideAll()))},c.on("hide:after",function(){for(var t=0;t<c.items.length;t++){var e=c.items[t].cmpEl.data("bs.tooltip");e&&e.hide()}}),c.render(l),c.cmpEl.attr({tabindex:"-1"}));var n=r.cellEditor.is(":focus");n?(c.menuAlignEl=r.cellEditor,r.focusInCellEditor=!0):(c.menuAlignEl=void 0,r.focusInCellEditor=!1,i=[(t=r.api.asc_getActiveCellCoord()).asc_getX()+(e?e[0]:0),(t.asc_getY()<0?0:t.asc_getY())+t.asc_getHeight()+(e?e[1]:0)],l.css({left:i[0],top:i[1]})),c.alignPosition(),c.isVisible()||Common.UI.Menu.Manager.hideAll(),_.delay(function(){c.isVisible()||c.show(),c.scroller&&(c.scroller.update({alwaysVisibleY:!0}),c.scroller.scrollTop(0)),n&&r.cellEditor.focus(),c.cmpEl.toggleClass("from-cell-edit",n),_.delay(function(){var t=c.cmpEl.find("li:first a"),t=(t.addClass("focus"),t.parent().data("bs.tooltip"));t&&t.show()},10),n||_.delay(function(){c.cmpEl.focus()},10)},1)}else this.documentHolder.funcMenu.hide()},onFormulaInfo:function(t){var e,i=this.tooltips.func_arg;t?(i.parentEl||(i.parentEl=$('<div id="tip-container-functip" style="position: absolute; z-index: 10000;"></div>'),this.documentHolder.cmpEl.append(i.parentEl)),e=((e=this.getApplication().getController("FormulaDialog").getDescription(Common.Utils.InternalSettings.get("sse-settings-func-locale")))&&e[t]?this.api.asc_getFormulaLocaleName(t)+e[t].a:"").replace(/[,;]/g,this.api.asc_getFunctionArgumentSeparator()),i.ref&&i.ref.isVisible()&&i.text!=e&&(i.ref.hide(),i.ref=void 0,i.text="",i.isHidden=!0),e&&(i.ref&&i.ref.isVisible()||(i.text=e,i.ref=new Common.UI.Tooltip({owner:i.parentEl,html:!0,title:e,cls:"auto-tooltip"}),i.ref.show([-1e4,-1e4]),i.isHidden=!1),t=this.cellEditor.is(":focus")||this.focusInCellEditor?[(t=this.cellEditor.offset()).left,t.top+this.cellEditor.height()+3]:(e=[this.documentHolder.cmpEl.offset().left-$(window).scrollLeft(),this.documentHolder.cmpEl.offset().top-$(window).scrollTop()],[(t=this.api.asc_getActiveCellCoord()).asc_getX()+e[0]-3,t.asc_getY()+e[1]-i.ref.getBSTip().$tip.height()-5]),e=i.ref.getBSTip().$tip.width(),t[0]+e>this.tooltips.coauth.bodyWidth&&(t[0]=this.tooltips.coauth.bodyWidth-e),i.ref.getBSTip().$tip.css({top:t[1]+"px",left:t[0]+"px"}))):!i.isHidden&&i.ref&&(i.ref.hide(),i.ref=void 0,i.text="",i.isHidden=!0)},changeInputMessagePosition:function(t){var e=[this.documentHolder.cmpEl.offset().left-$(window).scrollLeft(),this.documentHolder.cmpEl.offset().top-$(window).scrollTop()],i=this.api.asc_getActiveCellCoord(),s=[i.asc_getX()+e[0]-3,i.asc_getY()+e[1]-t.ref.getBSTip().$tip.height()-5],o=t.ref.getBSTip().$tip.width();s[0]+o>this.tooltips.coauth.bodyWidth&&(s[0]=this.tooltips.coauth.bodyWidth-o),s[1]<e[1]&&(s[1]=e[1]+i.asc_getY()+i.asc_getHeight()+5),t.ref.getBSTip().$tip.css({top:s[1]+"px",left:s[0]+"px","z-index":900})},onInputMessage:function(t,e){var i=this.tooltips.input_msg;e?(i.parentEl||(i.parentEl=$('<div id="tip-container-inputtip" style="position: absolute; z-index: 10000;"></div>'),this.documentHolder.cmpEl.append(i.parentEl)),t=t?"<b>"+Common.Utils.String.htmlEncode(t||"")+"</b><br>":"",t+=Common.Utils.String.htmlEncode(e||""),i.ref&&i.ref.isVisible()&&i.text!=t&&(i.ref.hide(),i.ref=void 0,i.text="",i.isHidden=!0),i.ref&&i.ref.isVisible()||(i.text=t,i.ref=new Common.UI.Tooltip({owner:i.parentEl,html:!0,title:t,keepvisible:!0}),i.ref.show([-1e4,-1e4]),i.ref.getBSTip().$tip.on("click",function(){i.ref.hide(),i.ref=void 0,i.text="",i.isHidden=!0}),i.isHidden=!1),this.changeInputMessagePosition(i)):!i.isHidden&&i.ref&&(i.ref.hide(),i.ref=void 0,i.text="",i.isHidden=!0)},onShowSpecialPasteOptions:function(t){if(!this.permissions||this.permissions.isEdit){var e,i,s,o,n=this,a=n.documentHolder,l=t.asc_getCellCoord(),r=a.cmpEl.find("#special-paste-container"),c=t.asc_getOptions(),d=!!t.asc_getContainTables();if(c){if(r.length<1&&(n._arrSpecialPaste=[],n._arrSpecialPaste[Asc.c_oSpecialPasteProps.paste]=[n.txtPaste,0],n._arrSpecialPaste[Asc.c_oSpecialPasteProps.pasteOnlyFormula]=[n.txtPasteFormulas,0],n._arrSpecialPaste[Asc.c_oSpecialPasteProps.formulaNumberFormat]=[n.txtPasteFormulaNumFormat,0],n._arrSpecialPaste[Asc.c_oSpecialPasteProps.formulaAllFormatting]=[n.txtPasteKeepSourceFormat,0],n._arrSpecialPaste[Asc.c_oSpecialPasteProps.formulaWithoutBorders]=[n.txtPasteBorders,0],n._arrSpecialPaste[Asc.c_oSpecialPasteProps.formulaColumnWidth]=[n.txtPasteColWidths,0],n._arrSpecialPaste[Asc.c_oSpecialPasteProps.mergeConditionalFormating]=[n.txtPasteMerge,0],n._arrSpecialPaste[Asc.c_oSpecialPasteProps.transpose]=[n.txtPasteTranspose,0],n._arrSpecialPaste[Asc.c_oSpecialPasteProps.pasteOnlyValues]=[n.txtPasteValues,1],n._arrSpecialPaste[Asc.c_oSpecialPasteProps.valueNumberFormat]=[n.txtPasteValNumFormat,1],n._arrSpecialPaste[Asc.c_oSpecialPasteProps.valueAllFormating]=[n.txtPasteValFormat,1],n._arrSpecialPaste[Asc.c_oSpecialPasteProps.pasteOnlyFormating]=[n.txtPasteFormat,2],n._arrSpecialPaste[Asc.c_oSpecialPasteProps.link]=[n.txtPasteLink,2],n._arrSpecialPaste[Asc.c_oSpecialPasteProps.picture]=[n.txtPastePicture,2],n._arrSpecialPaste[Asc.c_oSpecialPasteProps.linkedPicture]=[n.txtPasteLinkPicture,2],n._arrSpecialPaste[Asc.c_oSpecialPasteProps.sourceformatting]=[n.txtPasteSourceFormat,2],n._arrSpecialPaste[Asc.c_oSpecialPasteProps.destinationFormatting]=[n.txtPasteDestFormat,2],n._arrSpecialPaste[Asc.c_oSpecialPasteProps.keepTextOnly]=[n.txtKeepTextOnly,2],n._arrSpecialPaste[Asc.c_oSpecialPasteProps.useTextImport]=[n.txtUseTextImport,3],r=$('<div id="special-paste-container" style="position: absolute;"><div id="id-document-holder-btn-special-paste"></div></div>'),a.cmpEl.find("#ws-canvas-outer").append(r),n.btnSpecialPaste=new Common.UI.Button({parentEl:$("#id-document-holder-btn-special-paste"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-paste",caption:Common.Utils.String.format("({0})",Common.Utils.String.textCtrl),menu:new Common.UI.Menu({items:[]})}),n.initSpecialPasteEvents()),0<c.length){for(var h=n.btnSpecialPaste.menu,p=0;p<h.items.length;p++)h.removeItem(h.items[p]),p--;for(var m,u=[],p=0;p<3;p++)u[p]=[];_.each(c,function(t,e){var i;t==Asc.c_oSpecialPasteProps.useTextImport?(m=new Common.UI.MenuItem({caption:n._arrSpecialPaste[t][0]+(n.hkSpecPaste[t]?" ("+n.hkSpecPaste[t]+")":""),value:t,checkable:!0,toggleGroup:"specialPasteGroup"}).on("click",_.bind(n.onSpecialPasteItemClick,n)),n._arrSpecialPaste[t][2]=m):n._arrSpecialPaste[t]&&(i=new Common.UI.MenuItem({caption:n._arrSpecialPaste[t][0]+(n.hkSpecPaste[t]?" ("+n.hkSpecPaste[t]+")":""),value:t,checkable:!0,toggleGroup:"specialPasteGroup"}).on("click",_.bind(n.onSpecialPasteItemClick,n)),u[n._arrSpecialPaste[t][1]].push(i),n._arrSpecialPaste[t][2]=i)});for(var g=!1,p=0;p<3;p++)g&&0<u[p].length&&(h.addItem(new Common.UI.MenuItem({caption:"--"})),g=!1),_.each(u[p],function(t,e){h.addItem(t),g=!0});0<h.items.length&&h.items[0].setChecked(!0,!0),n._state.lastSpecPasteChecked=0<h.items.length?h.items[0]:null,m&&(h.addItem(new Common.UI.MenuItem({caption:"--"})),h.addItem(m)),0<h.items.length&&t.asc_getShowPasteSpecial()&&(h.addItem(new Common.UI.MenuItem({caption:"--"})),a=new Common.UI.MenuItem({caption:n.textPasteSpecial,value:"special"}).on("click",function(t,e){new SSE.Views.SpecialPasteDialog({props:c,isTable:d,handler:function(t,e){"ok"==t&&(n._state.lastSpecPasteChecked&&n._state.lastSpecPasteChecked.setChecked(!1,!0),n._state.lastSpecPasteChecked=e&&n._arrSpecialPaste[e.asc_getProps()]?n._arrSpecialPaste[e.asc_getProps()][2]:null,n._state.lastSpecPasteChecked&&n._state.lastSpecPasteChecked.setChecked(!0,!0),n&&n.api&&n.api.asc_SpecialPaste(e))}}).show(),setTimeout(function(){h.hide()},100)}),h.addItem(a))}l[0].asc_getX()<0||l[0].asc_getY()<0?(r.is(":visible")&&r.hide(),$(document).off("keyup",this.wrapEvents.onKeyUp)):(t=l[0],a=l[1],l=n.tooltips.coauth.bodyWidth-n.tooltips.coauth.XY[0]-n.tooltips.coauth.rightMenuWidth-15,e=n.tooltips.coauth.apiHeight-15,i=[],s=[31,20],o=t.asc_getX()+t.asc_getWidth()+3+s[0],t=t.asc_getY()+t.asc_getHeight()+3+s[1],l<o?(i[0]=void 0!==a?a.asc_getX():l-s[0]-3,e<t&&(i[0]-=s[0]+3),i[0]<0&&(i[0]=l-3-s[0])):i[0]=o-s[0],i[1]=e<t?e-3-s[1]:t-s[1],r.css({left:i[0],top:i[1]}),r.show(),setTimeout(function(){$(document).on("keyup",n.wrapEvents.onKeyUp)},10),this.disableSpecialPaste())}}},onHideSpecialPasteOptions:function(){var t;this.documentHolder&&this.documentHolder.cmpEl&&((t=this.documentHolder.cmpEl.find("#special-paste-container")).is(":visible")&&(t.hide(),$(document).off("keyup",this.wrapEvents.onKeyUp)))},disableSpecialPaste:function(){var t=this.documentHolder.cmpEl.find("#special-paste-container");0<t.length&&t.is(":visible")&&this.btnSpecialPaste.setDisabled(!!this._isDisabled)},onSpecialPasteItemClick:function(i,t){var e,s=this,o=this.btnSpecialPaste.menu;if(i.value==Asc.c_oSpecialPasteProps.useTextImport?new Common.Views.OpenDialog({title:s.txtImportWizard,closable:!0,type:Common.Utils.importTextType.Paste,preview:!0,api:s.api,handler:function(t,e){"ok"==t?(s&&s.api&&((t=new Asc.SpecialPasteProps).asc_setProps(Asc.c_oSpecialPasteProps.useTextImport),t.asc_setAdvancedOptions(e.textOptions),s.api.asc_SpecialPaste(t)),s._state.lastSpecPasteChecked=i):i.cmpEl&&(i.setChecked(!1,!0),s._state.lastSpecPasteChecked&&s._state.lastSpecPasteChecked.setChecked(!0,!0))}}).show():(s._state.lastSpecPasteChecked=i,(e=new Asc.SpecialPasteProps).asc_setProps(i.value),s.api.asc_SpecialPaste(e)),setTimeout(function(){o.hide()},100),!i.cmpEl&&s._state.lastSpecPasteChecked)for(var n=0;n<o.items.length;n++)o.items[n].setChecked(o.items[n].value===s._state.lastSpecPasteChecked.value,!0),o.items[n].value===s._state.lastSpecPasteChecked.value&&(s._state.lastSpecPasteChecked=o.items[n]);return!1},onKeyUp:function(t){t.keyCode==Common.UI.Keys.CTRL&&this._needShowSpecPasteMenu&&!this.btnSpecialPaste.menu.isVisible()&&/area_id/.test(t.target.id)&&($("button",this.btnSpecialPaste.cmpEl).click(),t.preventDefault()),this._needShowSpecPasteMenu=!1},initSpecialPasteEvents:function(){var t,s=this,e=(s.hkSpecPaste=[],s.hkSpecPaste[Asc.c_oSpecialPasteProps.paste]="P",s.hkSpecPaste[Asc.c_oSpecialPasteProps.pasteOnlyFormula]="F",s.hkSpecPaste[Asc.c_oSpecialPasteProps.formulaNumberFormat]="O",s.hkSpecPaste[Asc.c_oSpecialPasteProps.formulaAllFormatting]="K",s.hkSpecPaste[Asc.c_oSpecialPasteProps.formulaWithoutBorders]="B",s.hkSpecPaste[Asc.c_oSpecialPasteProps.formulaColumnWidth]="W",s.hkSpecPaste[Asc.c_oSpecialPasteProps.mergeConditionalFormating]="G",s.hkSpecPaste[Asc.c_oSpecialPasteProps.transpose]="T",s.hkSpecPaste[Asc.c_oSpecialPasteProps.pasteOnlyValues]="V",s.hkSpecPaste[Asc.c_oSpecialPasteProps.valueNumberFormat]="A",s.hkSpecPaste[Asc.c_oSpecialPasteProps.valueAllFormating]="E",s.hkSpecPaste[Asc.c_oSpecialPasteProps.pasteOnlyFormating]="R",s.hkSpecPaste[Asc.c_oSpecialPasteProps.link]="N",s.hkSpecPaste[Asc.c_oSpecialPasteProps.picture]="U",s.hkSpecPaste[Asc.c_oSpecialPasteProps.linkedPicture]="I",s.hkSpecPaste[Asc.c_oSpecialPasteProps.sourceformatting]="K",s.hkSpecPaste[Asc.c_oSpecialPasteProps.destinationFormatting]="M",s.hkSpecPaste[Asc.c_oSpecialPasteProps.keepTextOnly]="T","");for(t in s.hkSpecPaste)s.hkSpecPaste.hasOwnProperty(t)&&e.indexOf(s.hkSpecPaste[t])<0&&(e+=s.hkSpecPaste[t]+",");var i={},o=(i[e=e.substring(0,e.length-1)]=_.bind(function(t){for(var e=this.btnSpecialPaste.menu,i=0;i<e.items.length;i++)if(this.hkSpecPaste[e.items[i].value]===String.fromCharCode(t.keyCode))return s.onSpecialPasteItemClick({value:e.items[i].value})},s),Common.util.Shortcuts.delegateShortcuts({shortcuts:i}),Common.util.Shortcuts.suspendEvents(e,void 0,!0),s.documentHolder.cmpEl.find("#special-paste-container"));s.btnSpecialPaste.menu.on("show:after",function(t){Common.util.Shortcuts.resumeEvents(e),o.addClass("has-open-menu")}).on("hide:after",function(t){Common.util.Shortcuts.suspendEvents(e,void 0,!0),o.removeClass("has-open-menu")})},onToggleAutoCorrectOptions:function(t){if(t){var i=this,e=i.documentHolder,s=t.asc_getCellCoord(),o=e.cmpEl.find("#autocorrect-paste-container"),t=t.asc_getOptions();if(o.length<1&&(i._arrAutoCorrectPaste=[],i._arrAutoCorrectPaste[Asc.c_oAscAutoCorrectOptions.UndoTableAutoExpansion]={caption:i.txtUndoExpansion,icon:"menu__icon btn-undo"},i._arrAutoCorrectPaste[Asc.c_oAscAutoCorrectOptions.RedoTableAutoExpansion]={caption:i.txtRedoExpansion,icon:"menu__icon btn-redo"},o=$('<div id="autocorrect-paste-container" style="position: absolute;"><div id="id-document-holder-btn-autocorrect-paste"></div></div>'),e.cmpEl.append(o),i.btnAutoCorrectPaste=new Common.UI.Button({parentEl:$("#id-document-holder-btn-autocorrect-paste"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-autocorrect",menu:new Common.UI.Menu({cls:"shifted-right",items:[]})}),i.btnAutoCorrectPaste.menu.on("show:after",_.bind(i.onAutoCorrectOpenAfter,i))),0<t.length){for(var n=i.btnAutoCorrectPaste.menu,a=0;a<n.items.length;a++)n.removeItem(n.items[a]),a--;_.each(t,function(t,e){t=new Common.UI.MenuItem({caption:i._arrAutoCorrectPaste[t].caption,value:t,iconCls:i._arrAutoCorrectPaste[t].icon}).on("click",function(t,e){i.api.asc_applyAutoCorrectOptions(t.value),setTimeout(function(){n.hide()},100)});n.addItem(t)}),i.mnuAutoCorrectStop=new Common.UI.MenuItem({caption:i.textStopExpand,checkable:!0,allowDepress:!0,checked:!Common.Utils.InternalSettings.get("sse-settings-autoformat-new-rows")}).on("click",function(t){Common.localStorage.setBool("sse-settings-autoformat-new-rows",!t.checked),Common.Utils.InternalSettings.set("sse-settings-autoformat-new-rows",!t.checked),i.api.asc_setIncludeNewRowColTable(!t.checked),setTimeout(function(){n.hide()},100)}),n.addItem(i.mnuAutoCorrectStop),n.addItem({caption:"--"});e=new Common.UI.MenuItem({caption:i.textAutoCorrectSettings}).on("click",_.bind(i.onAutoCorrectOptions,i));n.addItem(e)}var t=i.tooltips.coauth.bodyWidth-i.tooltips.coauth.XY[0]-i.tooltips.coauth.rightMenuWidth-15,e=i.tooltips.coauth.apiHeight-15,l=[31,20],r=s.asc_getX()+s.asc_getWidth()+2+l[0],c=s.asc_getY()+s.asc_getHeight()+1+l[1];t<r||e<c||s.asc_getX()<0||s.asc_getY()<0?o.is(":visible")&&o.hide():(o.css({left:r-l[0],top:c-l[1]}),o.show())}else(o=this.documentHolder.cmpEl.find("#autocorrect-paste-container")).is(":visible")&&o.hide()},onCellsRange:function(t){this.rangeSelectionMode=t!=Asc.c_oAscSelectionDialogType.None},onApiEditCell:function(t){this.isEditFormula=t==Asc.c_oAscCellEditorState.editFormula,this.isEditCell=t!=Asc.c_oAscCellEditorState.editEnd},onLockDefNameManager:function(t){this.namedrange_locked=t==Asc.c_oAscDefinedNameReason.LockDefNameManager},onChangeCropState:function(t){this.documentHolder.menuImgCrop&&this.documentHolder.menuImgCrop.menu.items[0].setChecked(t,!0)},initEquationMenu:function(){if(this._currentMathObj){var t,e=this,i=e._currentMathObj.get_Type(),s=e._currentMathObj,o=[];switch(i){case Asc.c_oAscMathInterfaceType.Accent:t=new Common.UI.MenuItem({caption:e.txtRemoveAccentChar,equation:!0,disabled:e._currentParaObjDisabled,equationProps:{type:i,callback:"remove_AccentCharacter"}}),o.push(t);break;case Asc.c_oAscMathInterfaceType.BorderBox:t=new Common.UI.MenuItem({caption:e.txtBorderProps,equation:!0,disabled:e._currentParaObjDisabled,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:s.get_HideTop()?e.txtAddTop:e.txtHideTop,equationProps:{type:i,callback:"put_HideTop",value:!s.get_HideTop()}},{caption:s.get_HideBottom()?e.txtAddBottom:e.txtHideBottom,equationProps:{type:i,callback:"put_HideBottom",value:!s.get_HideBottom()}},{caption:s.get_HideLeft()?e.txtAddLeft:e.txtHideLeft,equationProps:{type:i,callback:"put_HideLeft",value:!s.get_HideLeft()}},{caption:s.get_HideRight()?e.txtAddRight:e.txtHideRight,equationProps:{type:i,callback:"put_HideRight",value:!s.get_HideRight()}},{caption:s.get_HideHor()?e.txtAddHor:e.txtHideHor,equationProps:{type:i,callback:"put_HideHor",value:!s.get_HideHor()}},{caption:s.get_HideVer()?e.txtAddVer:e.txtHideVer,equationProps:{type:i,callback:"put_HideVer",value:!s.get_HideVer()}},{caption:s.get_HideTopLTR()?e.txtAddLT:e.txtHideLT,equationProps:{type:i,callback:"put_HideTopLTR",value:!s.get_HideTopLTR()}},{caption:s.get_HideTopRTL()?e.txtAddLB:e.txtHideLB,equationProps:{type:i,callback:"put_HideTopRTL",value:!s.get_HideTopRTL()}}]})}),o.push(t);break;case Asc.c_oAscMathInterfaceType.Bar:t=new Common.UI.MenuItem({caption:e.txtRemoveBar,equation:!0,disabled:e._currentParaObjDisabled,equationProps:{type:i,callback:"remove_Bar"}}),o.push(t),t=new Common.UI.MenuItem({caption:s.get_Pos()==Asc.c_oAscMathInterfaceBarPos.Top?e.txtUnderbar:e.txtOverbar,equation:!0,disabled:e._currentParaObjDisabled,equationProps:{type:i,callback:"put_Pos",value:s.get_Pos()==Asc.c_oAscMathInterfaceBarPos.Top?Asc.c_oAscMathInterfaceBarPos.Bottom:Asc.c_oAscMathInterfaceBarPos.Top}}),o.push(t);break;case Asc.c_oAscMathInterfaceType.Script:var n=s.get_ScriptType();n==Asc.c_oAscMathInterfaceScript.PreSubSup?(t=new Common.UI.MenuItem({caption:e.txtScriptsAfter,equation:!0,disabled:e._currentParaObjDisabled,equationProps:{type:i,callback:"put_ScriptType",value:Asc.c_oAscMathInterfaceScript.SubSup}}),o.push(t),t=new Common.UI.MenuItem({caption:e.txtRemScripts,equation:!0,disabled:e._currentParaObjDisabled,equationProps:{type:i,callback:"put_ScriptType",value:Asc.c_oAscMathInterfaceScript.None}}),o.push(t)):(n==Asc.c_oAscMathInterfaceScript.SubSup&&(t=new Common.UI.MenuItem({caption:e.txtScriptsBefore,equation:!0,disabled:e._currentParaObjDisabled,equationProps:{type:i,callback:"put_ScriptType",value:Asc.c_oAscMathInterfaceScript.PreSubSup}}),o.push(t)),n!=Asc.c_oAscMathInterfaceScript.SubSup&&n!=Asc.c_oAscMathInterfaceScript.Sub||(t=new Common.UI.MenuItem({caption:e.txtRemSubscript,equation:!0,disabled:e._currentParaObjDisabled,equationProps:{type:i,callback:"put_ScriptType",value:n==Asc.c_oAscMathInterfaceScript.SubSup?Asc.c_oAscMathInterfaceScript.Sup:Asc.c_oAscMathInterfaceScript.None}}),o.push(t)),n!=Asc.c_oAscMathInterfaceScript.SubSup&&n!=Asc.c_oAscMathInterfaceScript.Sup||(t=new Common.UI.MenuItem({caption:e.txtRemSuperscript,equation:!0,disabled:e._currentParaObjDisabled,equationProps:{type:i,callback:"put_ScriptType",value:n==Asc.c_oAscMathInterfaceScript.SubSup?Asc.c_oAscMathInterfaceScript.Sub:Asc.c_oAscMathInterfaceScript.None}}),o.push(t)));break;case Asc.c_oAscMathInterfaceType.Fraction:n=s.get_FractionType();n!=Asc.c_oAscMathInterfaceFraction.Skewed&&n!=Asc.c_oAscMathInterfaceFraction.Linear||(t=new Common.UI.MenuItem({caption:e.txtFractionStacked,equation:!0,disabled:e._currentParaObjDisabled,equationProps:{type:i,callback:"put_FractionType",value:Asc.c_oAscMathInterfaceFraction.Bar}}),o.push(t)),n!=Asc.c_oAscMathInterfaceFraction.Bar&&n!=Asc.c_oAscMathInterfaceFraction.Linear||(t=new Common.UI.MenuItem({caption:e.txtFractionSkewed,equation:!0,disabled:e._currentParaObjDisabled,equationProps:{type:i,callback:"put_FractionType",value:Asc.c_oAscMathInterfaceFraction.Skewed}}),o.push(t)),n!=Asc.c_oAscMathInterfaceFraction.Bar&&n!=Asc.c_oAscMathInterfaceFraction.Skewed||(t=new Common.UI.MenuItem({caption:e.txtFractionLinear,equation:!0,disabled:e._currentParaObjDisabled,equationProps:{type:i,callback:"put_FractionType",value:Asc.c_oAscMathInterfaceFraction.Linear}}),o.push(t)),n!=Asc.c_oAscMathInterfaceFraction.Bar&&n!=Asc.c_oAscMathInterfaceFraction.NoBar||(t=new Common.UI.MenuItem({caption:n==Asc.c_oAscMathInterfaceFraction.Bar?e.txtRemFractionBar:e.txtAddFractionBar,equation:!0,disabled:e._currentParaObjDisabled,equationProps:{type:i,callback:"put_FractionType",value:n==Asc.c_oAscMathInterfaceFraction.Bar?Asc.c_oAscMathInterfaceFraction.NoBar:Asc.c_oAscMathInterfaceFraction.Bar}}),o.push(t));break;case Asc.c_oAscMathInterfaceType.Limit:t=new Common.UI.MenuItem({caption:s.get_Pos()==Asc.c_oAscMathInterfaceLimitPos.Top?e.txtLimitUnder:e.txtLimitOver,equation:!0,disabled:e._currentParaObjDisabled,equationProps:{type:i,callback:"put_Pos",value:s.get_Pos()==Asc.c_oAscMathInterfaceLimitPos.Top?Asc.c_oAscMathInterfaceLimitPos.Bottom:Asc.c_oAscMathInterfaceLimitPos.Top}}),o.push(t),t=new Common.UI.MenuItem({caption:e.txtRemLimit,equation:!0,disabled:e._currentParaObjDisabled,equationProps:{type:i,callback:"put_Pos",value:Asc.c_oAscMathInterfaceLimitPos.None}}),o.push(t);break;case Asc.c_oAscMathInterfaceType.Matrix:t=new Common.UI.MenuItem({caption:s.get_HidePlaceholder()?e.txtShowPlaceholder:e.txtHidePlaceholder,equation:!0,disabled:e._currentParaObjDisabled,equationProps:{type:i,callback:"put_HidePlaceholder",value:!s.get_HidePlaceholder()}}),o.push(t),t=new Common.UI.MenuItem({caption:e.insertText,equation:!0,disabled:e._currentParaObjDisabled,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:e.insertRowAboveText,equationProps:{type:i,callback:"insert_MatrixRow",value:!0}},{caption:e.insertRowBelowText,equationProps:{type:i,callback:"insert_MatrixRow",value:!1}},{caption:e.insertColumnLeftText,equationProps:{type:i,callback:"insert_MatrixColumn",value:!0}},{caption:e.insertColumnRightText,equationProps:{type:i,callback:"insert_MatrixColumn",value:!1}}]})}),o.push(t),t=new Common.UI.MenuItem({caption:e.deleteText,equation:!0,disabled:e._currentParaObjDisabled,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:e.deleteRowText,equationProps:{type:i,callback:"delete_MatrixRow"}},{caption:e.deleteColumnText,equationProps:{type:i,callback:"delete_MatrixColumn"}}]})}),o.push(t),t=new Common.UI.MenuItem({caption:e.txtMatrixAlign,equation:!0,disabled:e._currentParaObjDisabled,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:e.txtTop,checkable:!0,checked:s.get_MatrixAlign()==Asc.c_oAscMathInterfaceMatrixMatrixAlign.Top,equationProps:{type:i,callback:"put_MatrixAlign",value:Asc.c_oAscMathInterfaceMatrixMatrixAlign.Top}},{caption:e.centerText,checkable:!0,checked:s.get_MatrixAlign()==Asc.c_oAscMathInterfaceMatrixMatrixAlign.Center,equationProps:{type:i,callback:"put_MatrixAlign",value:Asc.c_oAscMathInterfaceMatrixMatrixAlign.Center}},{caption:e.txtBottom,checkable:!0,checked:s.get_MatrixAlign()==Asc.c_oAscMathInterfaceMatrixMatrixAlign.Bottom,equationProps:{type:i,callback:"put_MatrixAlign",value:Asc.c_oAscMathInterfaceMatrixMatrixAlign.Bottom}}]})}),o.push(t),t=new Common.UI.MenuItem({caption:e.txtColumnAlign,equation:!0,disabled:e._currentParaObjDisabled,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:e.leftText,checkable:!0,checked:s.get_ColumnAlign()==Asc.c_oAscMathInterfaceMatrixColumnAlign.Left,equationProps:{type:i,callback:"put_ColumnAlign",value:Asc.c_oAscMathInterfaceMatrixColumnAlign.Left}},{caption:e.centerText,checkable:!0,checked:s.get_ColumnAlign()==Asc.c_oAscMathInterfaceMatrixColumnAlign.Center,equationProps:{type:i,callback:"put_ColumnAlign",value:Asc.c_oAscMathInterfaceMatrixColumnAlign.Center}},{caption:e.rightText,checkable:!0,checked:s.get_ColumnAlign()==Asc.c_oAscMathInterfaceMatrixColumnAlign.Right,equationProps:{type:i,callback:"put_ColumnAlign",value:Asc.c_oAscMathInterfaceMatrixColumnAlign.Right}}]})}),o.push(t);break;case Asc.c_oAscMathInterfaceType.EqArray:t=new Common.UI.MenuItem({caption:e.txtInsertEqBefore,equation:!0,disabled:e._currentParaObjDisabled,equationProps:{type:i,callback:"insert_Equation",value:!0}}),o.push(t),t=new Common.UI.MenuItem({caption:e.txtInsertEqAfter,equation:!0,disabled:e._currentParaObjDisabled,equationProps:{type:i,callback:"insert_Equation",value:!1}}),o.push(t),t=new Common.UI.MenuItem({caption:e.txtDeleteEq,equation:!0,disabled:e._currentParaObjDisabled,equationProps:{type:i,callback:"delete_Equation"}}),o.push(t),t=new Common.UI.MenuItem({caption:e.alignmentText,equation:!0,disabled:e._currentParaObjDisabled,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:e.txtTop,checkable:!0,checked:s.get_Align()==Asc.c_oAscMathInterfaceEqArrayAlign.Top,equationProps:{type:i,callback:"put_Align",value:Asc.c_oAscMathInterfaceEqArrayAlign.Top}},{caption:e.centerText,checkable:!0,checked:s.get_Align()==Asc.c_oAscMathInterfaceEqArrayAlign.Center,equationProps:{type:i,callback:"put_Align",value:Asc.c_oAscMathInterfaceEqArrayAlign.Center}},{caption:e.txtBottom,checkable:!0,checked:s.get_Align()==Asc.c_oAscMathInterfaceEqArrayAlign.Bottom,equationProps:{type:i,callback:"put_Align",value:Asc.c_oAscMathInterfaceEqArrayAlign.Bottom}}]})}),o.push(t);break;case Asc.c_oAscMathInterfaceType.LargeOperator:t=new Common.UI.MenuItem({caption:e.txtLimitChange,equation:!0,disabled:e._currentParaObjDisabled,equationProps:{type:i,callback:"put_LimitLocation",value:s.get_LimitLocation()==Asc.c_oAscMathInterfaceNaryLimitLocation.UndOvr?Asc.c_oAscMathInterfaceNaryLimitLocation.SubSup:Asc.c_oAscMathInterfaceNaryLimitLocation.UndOvr}}),o.push(t),void 0!==s.get_HideUpper()&&(t=new Common.UI.MenuItem({caption:s.get_HideUpper()?e.txtShowTopLimit:e.txtHideTopLimit,equation:!0,disabled:e._currentParaObjDisabled,equationProps:{type:i,callback:"put_HideUpper",value:!s.get_HideUpper()}}),o.push(t)),void 0!==s.get_HideLower()&&(t=new Common.UI.MenuItem({caption:s.get_HideLower()?e.txtShowBottomLimit:e.txtHideBottomLimit,equation:!0,disabled:e._currentParaObjDisabled,equationProps:{type:i,callback:"put_HideLower",value:!s.get_HideLower()}}),o.push(t));break;case Asc.c_oAscMathInterfaceType.Delimiter:t=new Common.UI.MenuItem({caption:e.txtInsertArgBefore,equation:!0,disabled:e._currentParaObjDisabled,equationProps:{type:i,callback:"insert_DelimiterArgument",value:!0}}),o.push(t),t=new Common.UI.MenuItem({caption:e.txtInsertArgAfter,equation:!0,disabled:e._currentParaObjDisabled,equationProps:{type:i,callback:"insert_DelimiterArgument",value:!1}}),o.push(t),s.can_DeleteArgument()&&(t=new Common.UI.MenuItem({caption:e.txtDeleteArg,equation:!0,disabled:e._currentParaObjDisabled,equationProps:{type:i,callback:"delete_DelimiterArgument"}}),o.push(t)),t=new Common.UI.MenuItem({caption:s.has_Separators()?e.txtDeleteCharsAndSeparators:e.txtDeleteChars,equation:!0,disabled:e._currentParaObjDisabled,equationProps:{type:i,callback:"remove_DelimiterCharacters"}}),o.push(t),t=new Common.UI.MenuItem({caption:s.get_HideOpeningBracket()?e.txtShowOpenBracket:e.txtHideOpenBracket,equation:!0,disabled:e._currentParaObjDisabled,equationProps:{type:i,callback:"put_HideOpeningBracket",value:!s.get_HideOpeningBracket()}}),o.push(t),t=new Common.UI.MenuItem({caption:s.get_HideClosingBracket()?e.txtShowCloseBracket:e.txtHideCloseBracket,equation:!0,disabled:e._currentParaObjDisabled,equationProps:{type:i,callback:"put_HideClosingBracket",value:!s.get_HideClosingBracket()}}),o.push(t),t=new Common.UI.MenuItem({caption:e.txtStretchBrackets,equation:!0,disabled:e._currentParaObjDisabled,checkable:!0,checked:s.get_StretchBrackets(),equationProps:{type:i,callback:"put_StretchBrackets",value:!s.get_StretchBrackets()}}),o.push(t),t=new Common.UI.MenuItem({caption:e.txtMatchBrackets,equation:!0,disabled:!s.get_StretchBrackets()||e._currentParaObjDisabled,checkable:!0,checked:s.get_StretchBrackets()&&s.get_MatchBrackets(),equationProps:{type:i,callback:"put_MatchBrackets",value:!s.get_MatchBrackets()}}),o.push(t);break;case Asc.c_oAscMathInterfaceType.GroupChar:s.can_ChangePos()&&(t=new Common.UI.MenuItem({caption:s.get_Pos()==Asc.c_oAscMathInterfaceGroupCharPos.Top?e.txtGroupCharUnder:e.txtGroupCharOver,equation:!0,disabled:e._currentParaObjDisabled,equationProps:{type:i,callback:"put_Pos",value:s.get_Pos()==Asc.c_oAscMathInterfaceGroupCharPos.Top?Asc.c_oAscMathInterfaceGroupCharPos.Bottom:Asc.c_oAscMathInterfaceGroupCharPos.Top}}),o.push(t),t=new Common.UI.MenuItem({caption:e.txtDeleteGroupChar,equation:!0,disabled:e._currentParaObjDisabled,equationProps:{type:i,callback:"put_Pos",value:Asc.c_oAscMathInterfaceGroupCharPos.None}}),o.push(t));break;case Asc.c_oAscMathInterfaceType.Radical:void 0!==s.get_HideDegree()&&(t=new Common.UI.MenuItem({caption:s.get_HideDegree()?e.txtShowDegree:e.txtHideDegree,equation:!0,disabled:e._currentParaObjDisabled,equationProps:{type:i,callback:"put_HideDegree",value:!s.get_HideDegree()}}),o.push(t)),t=new Common.UI.MenuItem({caption:e.txtDeleteRadical,equation:!0,disabled:e._currentParaObjDisabled,equationProps:{type:i,callback:"remove_Radical"}}),o.push(t)}return s.can_IncreaseArgumentSize()&&(t=new Common.UI.MenuItem({caption:e.txtIncreaseArg,equation:!0,disabled:e._currentParaObjDisabled,equationProps:{type:i,callback:"increase_ArgumentSize"}}),o.push(t)),s.can_DecreaseArgumentSize()&&(t=new Common.UI.MenuItem({caption:e.txtDecreaseArg,equation:!0,disabled:e._currentParaObjDisabled,equationProps:{type:i,callback:"decrease_ArgumentSize"}}),o.push(t)),s.can_InsertManualBreak()&&(t=new Common.UI.MenuItem({caption:e.txtInsertBreak,equation:!0,disabled:e._currentParaObjDisabled,equationProps:{type:i,callback:"insert_ManualBreak"}}),o.push(t)),s.can_DeleteManualBreak()&&(t=new Common.UI.MenuItem({caption:e.txtDeleteBreak,equation:!0,disabled:e._currentParaObjDisabled,equationProps:{type:i,callback:"delete_ManualBreak"}}),o.push(t)),s.can_AlignToCharacter()&&(t=new Common.UI.MenuItem({caption:e.txtAlignToChar,equation:!0,disabled:e._currentParaObjDisabled,equationProps:{type:i,callback:"align_ToCharacter"}}),o.push(t)),o}},addEquationMenu:function(i){var s=this,o=(s.clearEquationMenu(i),s.documentHolder.textInShapeMenu),t=s.initEquationMenu();return 0<t.length&&_.each(t,function(t,e){t.menu?_.each(t.menu.items,function(t){t.on("click",_.bind(s.equationCallback,s,t.options.equationProps))}):t.on("click",_.bind(s.equationCallback,s,t.options.equationProps)),o.insertItem(i,t),i++}),t.length},clearEquationMenu:function(t){for(var e=this.documentHolder.textInShapeMenu,i=t;i<e.items.length&&e.items[i].options.equation;i++)e.items[i].menu?_.each(e.items[i].menu.items,function(t){t.off("click")}):e.items[i].off("click"),e.removeItem(e.items[i]),i--},equationCallback:function(t){var e;if(t){switch(t.type){case Asc.c_oAscMathInterfaceType.Accent:e=new CMathMenuAccent;break;case Asc.c_oAscMathInterfaceType.BorderBox:e=new CMathMenuBorderBox;break;case Asc.c_oAscMathInterfaceType.Box:e=new CMathMenuBox;break;case Asc.c_oAscMathInterfaceType.Bar:e=new CMathMenuBar;break;case Asc.c_oAscMathInterfaceType.Script:e=new CMathMenuScript;break;case Asc.c_oAscMathInterfaceType.Fraction:e=new CMathMenuFraction;break;case Asc.c_oAscMathInterfaceType.Limit:e=new CMathMenuLimit;break;case Asc.c_oAscMathInterfaceType.Matrix:e=new CMathMenuMatrix;break;case Asc.c_oAscMathInterfaceType.EqArray:e=new CMathMenuEqArray;break;case Asc.c_oAscMathInterfaceType.LargeOperator:e=new CMathMenuNary;break;case Asc.c_oAscMathInterfaceType.Delimiter:e=new CMathMenuDelimiter;break;case Asc.c_oAscMathInterfaceType.GroupChar:e=new CMathMenuGroupCharacter;break;case Asc.c_oAscMathInterfaceType.Radical:e=new CMathMenuRadical;break;case Asc.c_oAscMathInterfaceType.Common:e=new CMathMenuBase}e&&(e[t.callback](t.value),this.api.asc_SetMathProps(e))}Common.NotificationCenter.trigger("edit:complete",this.documentHolder)},onTextInShapeAfterRender:function(t){var e=this.documentHolder,i=e.paraBulletsPicker.conf;e.paraBulletsPicker=new Common.UI.DataView({el:$("#id-docholder-menu-bullets"),parentMenu:e.menuParagraphBullets.menu,outerMenu:{menu:e.menuParagraphBullets.menu,index:0},groups:e.paraBulletsPicker.groups,store:e.paraBulletsPicker.store,delayRenderTips:!0,itemTemplate:_.template('<% if (type==0) { %><div id="<%= id %>" class="item-markerlist"></div><% } else if (type==1) { %><div id="<%= id %>" class="item-multilevellist"></div><% } %>')}),e.paraBulletsPicker.on("item:click",_.bind(this.onSelectBullets,this)),e.menuParagraphBullets.menu.setInnerMenu([{menu:e.paraBulletsPicker,index:0}]),i&&e.paraBulletsPicker.selectRecord(i.rec,!0)},onBulletMenuShowAfter:function(){var t=this.documentHolder.paraBulletsPicker.store,e=[],i=[];t.each(function(t){("menu-list-bullet-group"===t.get("group")?i:e).push({numberingInfo:{bullet:"undefined"===t.get("numberingInfo")?void 0:JSON.parse(t.get("numberingInfo"))},divId:t.get("id")})}),this.api&&this.api.SetDrawImagePreviewBulletForMenu&&(this.api.SetDrawImagePreviewBulletForMenu(i,0),this.api.SetDrawImagePreviewBulletForMenu(e,1))},updateBulletTip:function(t,e){t&&(t=$(t.el).data("bs.tooltip"))&&(t.options.title=e,t.$tip.find(".tooltip-inner").text(e))},onSignatureClick:function(t){var e=t.cmpEl.attr("data-value");switch(t.value){case 0:Common.NotificationCenter.trigger("protect:sign",e);break;case 1:this.api.asc_ViewCertificate(e);break;case 2:Common.NotificationCenter.trigger("protect:signature","visible",this._isDisabled,e);break;case 3:var i=this;Common.UI.warning({title:this.notcriticalErrorTitle,msg:this.txtRemoveWarning,buttons:["ok","cancel"],primary:"ok",callback:function(t){"ok"==t&&i.api.asc_RemoveSignature(e)}})}},onOriginalSizeClick:function(t){var e,i,s;this.api&&(e=(i=this.api.asc_getOriginalImageSize()).asc_getImageWidth(),i=i.asc_getImageHeight(),(s=new Asc.asc_CImgProperty).asc_putWidth(e),s.asc_putHeight(i),s.put_ResetCrop(!0),s.put_Rot(0),this.api.asc_setGraphicObjectProps(s),Common.NotificationCenter.trigger("edit:complete",this.documentHolder),Common.component.Analytics.trackEvent("DocumentHolder","Set Image Original Size"))},onImgReplace:function(t,e){var i=this;this.api&&("file"==e.value?setTimeout(function(){i.api&&i.api.asc_changeImageFromFile(),Common.NotificationCenter.trigger("edit:complete",i.documentHolder)},10):"storage"==e.value?Common.NotificationCenter.trigger("storage:image-load","change"):new Common.Views.ImageFromUrlDialog({handler:function(t,e){"ok"==t&&i.api&&(t=e.replace(/ /g,""),_.isEmpty(t)||((e=new Asc.asc_CImgProperty).asc_putImageUrl(t),i.api.asc_setGraphicObjectProps(e))),Common.NotificationCenter.trigger("edit:complete",i.documentHolder)}}).show())},onNumberFormatSelect:function(t,e){void 0!==e.value&&"advanced"!==e.value&&this.api&&this.api.asc_setCellFormat(e.options.format),Common.NotificationCenter.trigger("edit:complete",this.documentHolder)},onCustomNumberFormat:function(t){var i=this,e=(e=i.api.asc_getLocale())||(i.permissions.lang?parseInt(Common.util.LanguageInfo.getLocalLanguageCode(i.permissions.lang)):1033);new SSE.Views.FormatSettingsDialog({api:i.api,handler:function(t,e){e&&i.api.asc_setCellFormat(e.format),Common.NotificationCenter.trigger("edit:complete",i.documentHolder)},props:{format:t.options.numformat,formatInfo:t.options.numformatinfo,langId:e}}).show(),Common.NotificationCenter.trigger("edit:complete",this.documentHolder)},onNumberFormatOpenAfter:function(t){if(this.api){var e=(e=this.api.asc_getLocale())||(this.permissions.lang?parseInt(Common.util.LanguageInfo.getLocalLanguageCode(this.permissions.lang)):1033);if(this._state.langId!==e){this._state.langId=e;for(var e=new Asc.asc_CFormatCellsInfo,i=(e.asc_setType(Asc.c_oAscNumFormatType.None),e.asc_setSymbol(this._state.langId),this.api.asc_getFormatCells(e)),s=0;s<t.items.length-2;s++)t.items[s].options.format=i[s]}for(s=0;s<t.items.length-2;s++){var o=t.items[s];o.options.exampleval=this.api.asc_getLocaleExample(o.options.format),$(o.el).find("label").text(o.options.exampleval)}}},onAutoCorrectOpenAfter:function(t){this.mnuAutoCorrectStop&&this.mnuAutoCorrectStop.setChecked(!Common.Utils.InternalSettings.get("sse-settings-autoformat-new-rows"))},onAutoCorrectOptions:function(){var t=new Common.Views.AutoCorrectDialog({api:this.api});t&&(t.show(),t.setActiveCategory(2))},onChangeProtectSheet:function(t){var e;(t=t?t:(e=this.getApplication().getController("WBProtection"))?e.getWSProps():null)&&(this._state.wsProps=t.wsProps,this._state.wsLock=t.wsLock)},onShowForeignCursorLabel:function(t,e,i,s){if(this.isUserVisible(t)){var o,n=this;n.tooltips&&n.tooltips.foreignSelect&&n.tooltips.foreignSelect.userId==t&&n.hideForeignSelectTips();for(var a=0;a<n.fastcoauthtips.length;a++)if(n.fastcoauthtips[a].attr("userid")==t){o=n.fastcoauthtips[a];break}var l=this.tooltips.coauth;e<0||e+l.XY[0]>l.bodyWidth-l.rightMenuWidth||i<0||i>l.apiHeight?o&&this.onHideForeignCursorLabel(t):(o||((o=$(document.createElement("div"))).addClass("username-tip"),o.attr("userid",t),o.css({height:n._TtHeight+"px",position:"absolute",zIndex:"900",display:"none","pointer-events":"none","background-color":"#"+Common.Utils.ThemeColor.getHexColor(s.get_r(),s.get_g(),s.get_b())}),o.text(n.getUserName(t)),$("#editor_sdk").append(o),n.fastcoauthtips.push(o),o.fadeIn(150)),o.css({left:(e+l.XY[0]+o.outerWidth()>l.bodyWidth-l.rightMenuWidth?l.bodyWidth-l.rightMenuWidth-o.outerWidth()-l.XY[0]:e)+"px",top:i-n._TtHeight+"px"}))}},onHideForeignCursorLabel:function(t){for(var e=0;e<this.fastcoauthtips.length;e++)if(this.fastcoauthtips[e].attr("userid")==t){var i=this.fastcoauthtips[e];this.fastcoauthtips[e].fadeOut(150,function(){i.remove()}),this.fastcoauthtips.splice(e,1);break}},onDoubleClickOnTableOleObject:function(t){var e;this.permissions.isEdit&&!this._isDisabled&&(e=SSE.getController("Common.Controllers.ExternalOleEditor").getView("Common.Views.ExternalOleEditor"))&&t&&(e.setEditMode(!0),e.show(),e.setOleData(Asc.asc_putBinaryDataToFrameFromTableOleObject(t)))},onShowMathTrack:function(t){if(!this.permissions||this.permissions.isEdit)if((this.lastMathTrackBounds=t)[3]<0||Common.Utils.InternalSettings.get("sse-equation-toolbar-hide"))this.onHideMathTrack();else{var o=this,e=o.documentHolder,i=e.cmpEl.find("#equation-container");if(i.length<1){var s=o.getApplication().getCollection("EquationGroups"),n='<div id="equation-container" style="position: absolute;">';o.getApplication().getController("Toolbar").onMathTypes(),o.equationBtns=[];for(var a=0;a<s.length;++a)n+='<span id="id-document-holder-btn-equation-'+a+'"></span>';n=(n+='<div class="separator"></div>')+'<span id="id-document-holder-btn-equation-settings"></span>'+"</div>",i=$(n),e.cmpEl.append(i);for(var l=function(t){var e=t.options.value,i=s.at(e);new Common.UI.DataViewSimple({el:$("#id-document-holder-btn-equation-menu-"+e,t.cmpEl),parentMenu:t,store:i.get("groupStore"),scrollAlwaysVisible:!0,showLast:!1,restoreHeight:450,itemTemplate:_.template('<div class="item-equation" style="" ><div class="equation-icon" style="background-position:<%= posX %>px <%= posY %>px;width:<%= width %>px;height:<%= height %>px;" id="<%= id %>"></div></div>')}).on("item:click",function(t,e,i,s){o.api&&i&&o.api.asc_AddMath(i.get("data").equationType)}),t.off("show:before",l)},r=function(t){i.addClass("has-open-menu")},c=function(t){i.removeClass("has-open-menu")},a=0;a<s.length;++a){var d=s.at(a),d=new Common.UI.Button({parentEl:$("#id-document-holder-btn-equation-"+a,e.cmpEl),cls:"btn-toolbar no-caret",iconCls:"svgicon "+d.get("groupIcon"),hint:d.get("groupName"),menu:new Common.UI.Menu({cls:"menu-shapes",value:a,items:[{template:_.template('<div id="id-document-holder-btn-equation-menu-'+a+'" class="menu-shape margin-left-5" style="width:'+(d.get("groupWidth")+8)+"px; "+d.get("groupHeightStr")+'"></div>')}]})});d.menu.on("show:before",l),d.menu.on("show:before",r),d.menu.on("hide:after",c),o.equationBtns.push(d)}o.equationSettingsBtn=new Common.UI.Button({parentEl:$("#id-document-holder-btn-equation-settings",e.cmpEl),cls:"btn-toolbar no-caret",iconCls:"toolbar__icon btn-more-vertical",hint:o.documentHolder.advancedEquationText,menu:o.documentHolder.createEquationMenu("popuptbeqinput","tl-bl")}),o.equationSettingsBtn.menu.options.initMenu=function(){var t=o.api.asc_GetMathInputType(),e=o.equationSettingsBtn.menu,i=Common.Utils.InternalSettings.get("sse-equation-toolbar-hide");e.items[5].setChecked(t===Asc.c_oAscMathInputType.Unicode),e.items[6].setChecked(t===Asc.c_oAscMathInputType.LaTeX),e.items[8].options.isToolbarHide=i,e.items[8].setCaption(i?o.documentHolder.showEqToolbar:o.documentHolder.hideEqToolbar,!0)},o.equationSettingsBtn.menu.on("item:click",_.bind(o.convertEquation,o)),o.equationSettingsBtn.menu.on("show:before",function(t){r(),t.options.initMenu()}),o.equationSettingsBtn.menu.on("hide:after",c)}o.tooltips.coauth.XY||o.onDocumentResize();var h=[(t[0]+t[2])/2-i.outerWidth()/2,t[1]-i.outerHeight()-10],t=(h[0]<0&&(h[0]=0),h[1]<0&&(h[1]=t[3]+10),h[1]=Math.min(o.tooltips.coauth.apiHeight-i.outerHeight(),Math.max(0,h[1])),i.css({left:h[0],top:h[1]}),o.tooltips.coauth.apiHeight-h[1]-i.outerHeight()),h=o.tooltips.coauth.XY[1]+h[1],p=t<220&&t<.9*h?"bl-tl":"tl-bl";Common.UI.isRTL()&&(p="bl-tl"===p?"br-tr":"tr-br"),o.equationBtns.forEach(function(t){t&&(t.menu.menuAlign=p)}),o.equationSettingsBtn.menu.menuAlign=p,i.is(":visible")?o.equationSettingsBtn.menu.isVisible()&&(o.equationSettingsBtn.menu.options.initMenu(),o.equationSettingsBtn.menu.alignPosition()):i.show(),o.disableEquationBar()}},onHideMathTrack:function(){var t;this.documentHolder&&this.documentHolder.cmpEl&&((t=this.documentHolder.cmpEl.find("#equation-container")).is(":visible")&&t.hide())},disableEquationBar:function(){var t=this.documentHolder.cmpEl.find("#equation-container"),e=this._isDisabled||this._state.equationLocked;0<t.length&&t.is(":visible")&&(this.equationBtns.forEach(function(t){t&&t.setDisabled(!!e)}),this.equationSettingsBtn.setDisabled(!!e))},convertEquation:function(t,e,i){this.api&&("input"==e.options.type?(this.api.asc_SetMathInputType(e.value),Common.localStorage.setBool("sse-equation-input-latex",e.value===Asc.c_oAscMathInputType.LaTeX)):"view"==e.options.type?this.api.asc_ConvertMathView(e.value.linear,e.value.all):"hide"==e.options.type&&(e.options.isToolbarHide=!e.options.isToolbarHide,Common.Utils.InternalSettings.set("sse-equation-toolbar-hide",e.options.isToolbarHide),Common.localStorage.setBool("sse-equation-toolbar-hide",e.options.isToolbarHide),e.options.isToolbarHide?this.onHideMathTrack():this.onShowMathTrack(this.lastMathTrackBounds)))},saveAsPicture:function(){this.api&&this.api.asc_SaveDrawingAsPicture()},onInsertImage:function(t,e,i){this.api&&this.api.asc_addImage(t),Common.NotificationCenter.trigger("edit:complete",this.documentHolder)},onInsertImageUrl:function(i,t,e){var s=this;new Common.Views.ImageFromUrlDialog({handler:function(t,e){"ok"==t&&s.api&&(t=e.replace(/ /g,""),_.isEmpty(t)||s.api.AddImageUrl([t],void 0,void 0,i)),Common.NotificationCenter.trigger("edit:complete",s.documentHolder)}}).show()},getUserName:function(t){var e=SSE.getCollection("Common.Collections.Users");if(e){e=e.findUser(t);if(e)return AscCommon.UserInfoParser.getParsedName(e.get("username"))}return this.guestText},isUserVisible:function(t){var e=SSE.getCollection("Common.Collections.Users");if(e){e=e.findUser(t);if(e)return!e.get("hidden")}return!0},SetDisabled:function(t,e){this._isDisabled=t,this._canProtect=!t||e,this.disableEquationBar(),this.disableSpecialPaste()},clearSelection:function(){this.onHideMathTrack(),this.onHideSpecialPasteOptions()},onPluginContextMenu:function(t){t&&0<t.length&&this.documentHolder&&this.currentMenu&&this.currentMenu.isVisible()&&this.documentHolder.updateCustomItems(this.currentMenu,t)}},SSE.Controllers.DocumentHolder||{}))}),define("text!spreadsheeteditor/main/app/template/CellEditor.template",[],function(){return'<div class="ce-group-name float-left">\n    <input id="ce-cell-name" class="aslabel form-control" type="text" autocomplete="off">\n    <div id="ce-cell-name-menu"></div>\n    <button id="ce-func-label" type="button" class="btn small btn-toolbar"><i class="icon toolbar__icon btn-function"></i></button>\n</div>\n<div class="ce-group-expand float-right">\n    <button id="ce-btn-expand" type="button" class="btn"><span class="caret">&nbsp;</span></button>\n</div>\n<div class="ce-group-content">\n    <textarea id="ce-cell-content" class="form-control" spellcheck="false" rows="1" cols="20"></textarea>\n</div>\n'}),define("spreadsheeteditor/main/app/view/CellEditor",["text!spreadsheeteditor/main/app/template/CellEditor.template","common/main/lib/component/BaseView"],function(t){"use strict";SSE.Views.CellEditor=Common.UI.BaseView.extend(_.extend({template:_.template(t),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t)},render:function(){$(this.el).html(this.template()),this.btnNamedRanges=new Common.UI.Button({parentEl:$("#ce-cell-name-menu"),menu:new Common.UI.Menu({style:"min-width: 70px;max-width:400px;",maxHeight:250,items:[{caption:this.textManager,value:"manager"},{caption:"--"}]})}),this.btnNamedRanges.setVisible(!1),this.btnNamedRanges.menu.setOffset(Common.UI.isRTL()?81:-81),this.$cellname=$("#ce-cell-name",this.el),this.$btnexpand=$("#ce-btn-expand",this.el),this.$btnfunc=$("#ce-func-label",this.el);var i=this;return this.$cellname.on("focus",function(t){var e=i.$cellname[0];e.selectionStart=0,e.selectionEnd=e.value.length,e.scrollLeft=e.scrollWidth}),this.$btnfunc.addClass("disabled"),this.$btnfunc.tooltip({title:this.tipFormula,placement:"cursor"}),this.$btnfunc.attr("ratio","ratio"),this.applyScaling(Common.UI.Scaling.currentRatio()),this.$btnfunc.on("app:scaling",function(t,e){i.applyScaling(e.ratio)}),this},updateCellInfo:function(t){t&&this.$cellname.val("string"==typeof t?t:t.asc_getName())},cellNameDisabled:function(t){t?this.$cellname.attr("disabled","disabled"):this.$cellname.removeAttr("disabled"),this.btnNamedRanges.setDisabled(t)},applyScaling:function(t){2<t&&!this.$btnfunc.find("svg.icon").length&&(t='<svg class="icon"><use class="zoom-int" href="#%iconname"></use></svg>'.replace("%iconname","btn-function"),this.$btnfunc.find("i.icon").after(t))},tipFormula:"Insert Function",textManager:"Manager"},SSE.Views.CellEditor||{}))}),define("text!spreadsheeteditor/main/app/template/NameManagerDlg.template",[],function(){return'<div class="settings-panel active">\n    <div class="inner-content">\n        <table cols="2" style="width: 100%;">\n            <tr>\n                <td class="padding-small">\n                    <label class="header"><%= scope.textFilter %></label>\n                    <div id="name-manager-combo-filter" class="input-group-nr" style="width:180px;"></div>\n                </td>\n                <td id="name-manager-group-btn" class="padding-small text-align-right">\n                    <button type="button" class="btn btn-text-default margin-right-5" id="name-manager-btn-new" style="min-width: 80px;"><%= scope.textNew %></button>\n                    <button type="button" class="btn btn-text-default margin-right-15" id="name-manager-btn-edit" style="min-width: 80px;"><%= scope.textEdit %></button>\n                    <button type="button" class="btn btn-text-default" id="name-manager-btn-delete" style="min-width: 80px;"><%= scope.textDelete %></button>\n                </td>\n            </tr>\n            <tr>\n                <td colspan=2 class="padding-small">\n                    <div id="name-manager-range-list" class="range-tableview" style="width:100%; height: 191px;"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>'}),define("spreadsheeteditor/main/app/view/NameManagerDlg",["text!spreadsheeteditor/main/app/template/NameManagerDlg.template","common/main/lib/view/AdvancedSettingsWindow","common/main/lib/component/ComboBox","common/main/lib/component/ListView","common/main/lib/component/InputField"],function(e){"use strict";SSE.Views=SSE.Views||{},SSE.Views.NameManagerDlg=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{alias:"NameManagerDlg",contentWidth:540,height:330,buttons:null,id:"window-name-manager"},initialize:function(t){_.extend(this.options,{title:this.txtTitle,template:['<div class="box" style="height:'+(this.options.height-85)+'px;">','<div class="content-panel" style="padding: 0;">'+_.template(e)({scope:this})+"</div>","</div>",'<div class="footer center">','<button class="btn normal dlg-btn" result="cancel" style="width: 86px;">'+this.closeButtonText+"</button>","</div>"].join("")},t),this.api=t.api,this.handler=t.handler,this.sheets=t.sheets||[],this.sheetNames=t.sheetNames||[],this.ranges=t.ranges||[],this.props=t.props,this.sort=t.sort||{type:"name",direction:1},this.locked=t.locked||!1,this.userTooltip=!0,this.currentNamedRange=void 0,this.rangesStore=new Common.UI.DataViewStore,this.wrapEvents={onRefreshDefNameList:_.bind(this.onRefreshDefNameList,this),onLockDefNameManager:_.bind(this.onLockDefNameManager,this)},Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var i=this;this.cmbFilter=new Common.UI.ComboBox({el:$("#name-manager-combo-filter"),menuStyle:"min-width: 100%;",editable:!1,cls:"input-group-nr",data:[{value:0,displayValue:this.textFilterAll},{value:1,displayValue:this.textFilterDefNames},{value:2,displayValue:this.textFilterTableNames},{value:3,displayValue:this.textFilterSheet},{value:4,displayValue:this.textFilterWorkbook}],takeFocusOnClose:!0}).on("selected",function(t,e){i.refreshRangeList(null,0)}),this.cmbFilter.setValue(0),this.rangeList=new Common.UI.ListView({el:$("#name-manager-range-list",this.$window),store:new Common.UI.DataViewStore,simpleAddMode:!0,emptyText:this.textEmpty,headers:[{name:i.textRanges,width:171,sortType:"name",style:(Common.UI.isRTL(),"left")},{name:i.textScope,width:122,sortType:"scopeName",style:(Common.UI.isRTL(),"left")},{name:i.textDataRange,width:213}],initSort:{type:this.sort.type,direction:this.sort.direction},itemTemplate:_.template(['<div id="<%= id %>" class="list-item" style="width: 100%;display:inline-block;<% if (!lock) { %>pointer-events:none;<% } %>">','<div class="listitem-icon toolbar__icon margin-right-5 <% print(isTable?"btn-menu-table":(isSlicer ? "btn-slicer" : "btn-named-range")) %>"></div>','<div style="width:146px;padding-<% if (Common.UI.isRTL()) { %>left<% } else {%>right<% } %>: 5px;"><%= Common.Utils.String.htmlEncode(name) %></div>','<div style="width:122px;padding-<% if (Common.UI.isRTL()) { %>left<% } else {%>right<% } %>: 5px;"><%= scopeName %></div>','<div style="width:209px;"><%= range %></div>',"<% if (lock) { %>",'<div class="lock-user"><%=lockuser%></div>',"<% } %>","</div>"].join("")),tabindex:1}),this.rangeList.store.comparator=function(t,e){t=t.get(i.sort.type).toLowerCase(),e=e.get(i.sort.type).toLowerCase();return t==e?0:t<e?-i.sort.direction:i.sort.direction},this.rangeList.on("item:select",_.bind(this.onSelectRangeItem,this)).on("item:keydown",_.bind(this.onKeyDown,this)).on("item:dblclick",_.bind(this.onDblClickItem,this)).on("entervalue",_.bind(this.onDblClickItem,this)),this.btnNewRange=new Common.UI.Button({el:$("#name-manager-btn-new")}),this.btnNewRange.on("click",_.bind(this.onEditRange,this,!1)),this.btnEditRange=new Common.UI.Button({el:$("#name-manager-btn-edit")}),this.btnEditRange.on("click",_.bind(this.onEditRange,this,!0)),this.btnDeleteRange=new Common.UI.Button({el:$("#name-manager-btn-delete")}),this.btnDeleteRange.on("click",_.bind(this.onDeleteRange,this)),this.rangeList.on("header:click",_.bind(this.onSortNames,this)),this.afterRender()},getFocusedComponents:function(){return[this.cmbFilter,this.btnNewRange,this.btnEditRange,this.btnDeleteRange,this.rangeList]},getDefaultFocusableComponent:function(){return this.rangeList},afterRender:function(){this._setDefaults(this.props)},_setDefaults:function(t){this.refreshRangeList(this.ranges,0),this.api.asc_registerCallback("asc_onLockDefNameManager",this.wrapEvents.onLockDefNameManager),this.api.asc_registerCallback("asc_onRefreshDefNameList",this.wrapEvents.onRefreshDefNameList)},onRefreshDefNameList:function(){this.refreshRangeList(this.api.asc_getDefinedNames(Asc.c_oAscGetDefinedNamesList.All),this.currentNamedRange)},refreshRangeList:function(t,e){if(t){this.ranges=t;for(var i=[],s=0;s<this.ranges.length;s++){var o=this.ranges[s].asc_getScope(),n=this.ranges[s].asc_getIsLock(),a=this.ranges[s].asc_getType();i.push({name:this.ranges[s].asc_getName(!0),scope:o,scopeName:null===o?this.textWorkbook:this.sheetNames[o],range:a===Asc.c_oAscDefNameType.slicer?"":this.ranges[s].asc_getRef(),lock:null!=n,lockuser:n?this.isUserVisible(n)?this.getUserName(n):this.lockText:this.guestText,type:a,isTable:a===Asc.c_oAscDefNameType.table,isSlicer:a===Asc.c_oAscDefNameType.slicer})}this.rangesStore.reset(i),this.rangeList.setEmptyText(0<this.rangesStore.length?this.textnoNames:this.textEmpty)}var l,r=this,c=this.rangeList.store,t=this.rangesStore.models,d=this.cmbFilter.getValue(),h=d<3?2==d:-1,p=2<d?4==d:-1;0<d&&(t=this.rangesStore.filter(function(t){return-1!==h?h===t.get("isTable"):-1!==p&&p===(null===t.get("scope"))})),c.reset(t,{silent:!1}),d=c.length,this.btnEditRange.setDisabled(!d),this.btnDeleteRange.setDisabled(!d),0<d&&(null==e&&(e=0),_.isNumber(e)?(d-1<e&&(e=d-1),this.rangeList.selectByIndex(e),setTimeout(function(){r.rangeList.scrollToRecord(c.at(e))},50)):e&&(l=c.findWhere({name:e.asc_getName(!0),scope:e.asc_getScope()}))&&(this.rangeList.selectRecord(l),setTimeout(function(){r.rangeList.scrollToRecord(l)},50)),!0===this.userTooltip&&0<this.rangeList.cmpEl.find(".lock-user").length&&this.rangeList.cmpEl.on("mouseover",_.bind(r.onMouseOverLock,r)).on("mouseout",_.bind(r.onMouseOutLock,r))),_.delay(function(){r.rangeList.scroller.update({alwaysVisibleY:!0})},100,this)},onMouseOverLock:function(t,e,i){var s;!0===this.userTooltip&&$(t.target).hasClass("lock-user")&&(s=this,t=$(t.target).tooltip({title:this.tipIsLocked,trigger:"manual"}).data("bs.tooltip"),this.userTooltip=t.tip(),this.userTooltip.css("z-index",parseInt(this.$window.css("z-index"))+10),t.show(),setTimeout(function(){s.userTipHide()},5e3))},userTipHide:function(){"object"==typeof this.userTooltip&&(this.userTooltip.remove(),this.userTooltip=void 0,this.rangeList.cmpEl.off("mouseover").off("mouseout"))},onMouseOutLock:function(t,e,i){"object"==typeof this.userTooltip&&this.userTipHide()},onEditRange:function(i){var s,t,o,e;this._isWarningVisible||(this.locked?Common.NotificationCenter.trigger("namedrange:locked"):(t=(s=this).$window.offset(),e=this.rangeList.getSelectedRec(),_.indexOf(this.rangeList.store.models,e),o=i&&e?new Asc.asc_CDefName(e.get("name"),e.get("range"),e.get("scope"),e.get("type"),void 0,void 0,void 0,!0):null,e=new SSE.Views.NamedRangeEditDlg({api:s.api,sheets:this.sheets,props:i?o:this.props,isEdit:i,handler:function(t,e){"ok"==t&&e&&(i?(s.currentNamedRange=e,s.api.asc_editDefinedNames(o,e)):(s.cmbFilter.setValue(0),s.currentNamedRange=e,s.api.asc_setDefinedNames(e)))}}).on("close",function(){s.show(),setTimeout(function(){s.getDefaultFocusableComponent().focus()},100)}),s.hide(),e.show(t.left+65,t.top+77)))},onDeleteRange:function(){var e,i=this.rangeList.getSelectedRec();i&&((e=this)._isWarningVisible=!0,Common.UI.warning({msg:Common.Utils.String.format(e.warnDelete,i.get("name")),buttons:["ok","cancel"],callback:function(t){"ok"==t&&(e.currentNamedRange=_.indexOf(e.rangeList.store.models,i),e.api.asc_delDefinedNames(new Asc.asc_CDefName(i.get("name"),i.get("range"),i.get("scope"),i.get("type"),void 0,void 0,void 0,!0))),setTimeout(function(){e.getDefaultFocusableComponent().focus()},100),e._isWarningVisible=!1}}))},getSettings:function(){return this.sort},onPrimary:function(){return!0},onDlgBtnClick:function(t){this.handler&&this.handler.call(this,t.currentTarget.attributes.result.value),this.close()},onSortNames:function(t,e){this.sort={type:t,direction:e},this.rangeList.store.sort(),this.rangeList.onResetItems(),this.rangeList.scroller.update({alwaysVisibleY:!0})},getUserName:function(t){var e=SSE.getCollection("Common.Collections.Users");if(e){e=e.findUser(t);if(e)return AscCommon.UserInfoParser.getParsedName(e.get("username"))}return this.guestText},isUserVisible:function(t){var e=SSE.getCollection("Common.Collections.Users");if(e){e=e.findUser(t);if(e)return!e.get("hidden")}return!0},onSelectRangeItem:function(t,e,i){var s;i&&(this.userTipHide(),s={},_.isFunction(i.toJSON)&&i.get("selected")&&(s=i.toJSON(),this.currentNamedRange=_.indexOf(this.rangeList.store.models,i),this.btnEditRange.setDisabled(s.lock),this.btnDeleteRange.setDisabled(s.lock||s.isTable||s.isSlicer)))},hide:function(){this.userTipHide(),Common.UI.Window.prototype.hide.call(this)},close:function(){this.userTipHide(),this.api.asc_unregisterCallback("asc_onLockDefNameManager",this.wrapEvents.onLockDefNameManager),this.api.asc_unregisterCallback("asc_onRefreshDefNameList",this.wrapEvents.onRefreshDefNameList),Common.UI.Window.prototype.close.call(this)},onKeyDown:function(t,e,i){i.keyCode!=Common.UI.Keys.DELETE||this.btnDeleteRange.isDisabled()||this.onDeleteRange()},onDblClickItem:function(t,e,i){this.btnEditRange.isDisabled()||this.onEditRange(!0)},onLockDefNameManager:function(t){this.locked=t==Asc.c_oAscDefinedNameReason.LockDefNameManager}},SSE.Views.NameManagerDlg||{}))}),define("spreadsheeteditor/main/app/controller/CellEditor",["core","spreadsheeteditor/main/app/view/CellEditor","spreadsheeteditor/main/app/view/NameManagerDlg"],function(t){"use strict";SSE.Controllers.CellEditor=Backbone.Controller.extend({views:["CellEditor"],events:function(){return{"keyup input#ce-cell-name":_.bind(this.onCellName,this),"keyup textarea#ce-cell-content":_.bind(this.onKeyupCellEditor,this),"blur textarea#ce-cell-content":_.bind(this.onBlurCellEditor,this),"click button#ce-btn-expand":_.bind(this.expandEditorField,this),"click button#ce-func-label":_.bind(this.onInsertFunction,this)}},initialize:function(){this.addListeners({CellEditor:{},Viewport:{"layout:resizedrag":_.bind(this.onLayoutResize,this)},ViewTab:{"viewtab:formula":function(t,e){this.editor.setVisible(e),Common.localStorage.setBool("sse-hidden-formula",!e),Common.NotificationCenter.trigger("layout:changed","celleditor",e?"showed":"hidden")}.bind(this)}})},setApi:function(t){return this.api=t,this.api.isCEditorFocused=!1,this.api.asc_registerCallback("asc_onSelectionNameChanged",_.bind(this.onApiCellSelection,this)),this.api.asc_registerCallback("asc_onEditCell",_.bind(this.onApiEditCell,this)),this.api.asc_registerCallback("asc_onCoAuthoringDisconnect",_.bind(this.onApiDisconnect,this)),Common.NotificationCenter.on("api:disconnect",_.bind(this.onApiDisconnect,this)),Common.NotificationCenter.on("cells:range",_.bind(this.onCellsRange,this)),this.api.asc_registerCallback("asc_onLockDefNameManager",_.bind(this.onLockDefNameManager,this)),this.api.asc_registerCallback("asc_onInputKeyDown",_.bind(this.onInputKeyDown,this)),this},setMode:function(t){this.mode=t,this.editor.$btnfunc[this.mode.isEdit?"removeClass":"addClass"]("disabled"),this.editor.btnNamedRanges.setVisible(this.mode.isEdit&&!this.mode.isEditDiagram&&!this.mode.isEditMailMerge&&!this.mode.isEditOle),this.mode.isEdit&&this.api.asc_registerCallback("asc_onSelectionChanged",_.bind(this.onApiSelectionChanged,this))},onInputKeyDown:function(t){var e;Common.UI.Keys.UP!==t.keyCode&&Common.UI.Keys.DOWN!==t.keyCode&&Common.UI.Keys.TAB!==t.keyCode&&Common.UI.Keys.RETURN!==t.keyCode&&Common.UI.Keys.ESC!==t.keyCode&&Common.UI.Keys.LEFT!==t.keyCode&&Common.UI.Keys.RIGHT!==t.keyCode||(e=$("#menu-formula-selection")).hasClass("open")&&e.find(".dropdown-menu").trigger("keydown",t)},onLaunch:function(){this.editor=this.getView("CellEditor"),this.bindViewEvents(this.editor,this.events),this.editor.$el.parent().find(".after").css({zIndex:"4"});var t=Common.localStorage.getItem("sse-celleditor-height");this.editor.keep_height=null!==t&&0<parseInt(t)?parseInt(t):74,Common.localStorage.getBool("sse-celleditor-expand")&&(this.editor.$el.height(this.editor.keep_height),this.onLayoutResize(void 0,"cell:edit")),this.editor.btnNamedRanges.menu.on("item:click",_.bind(this.onNamedRangesMenu,this)).on("show:before",_.bind(this.onNameBeforeShow,this)),this.namedrange_locked=!1,this.isUserProtected=!1},onApiEditCell:function(t){this.viewmode||(t==Asc.c_oAscCellEditorState.editStart?(this.api.isCellEdited=!0,this.editor.cellNameDisabled(!0)):t==Asc.c_oAscCellEditorState.editInCell?this.api.isCEditorFocused="clear":t==Asc.c_oAscCellEditorState.editEnd&&(this.api.isCellEdited=!1,this.api.isCEditorFocused=!1,this.editor.cellNameDisabled(!1)),this.editor.$btnfunc.toggleClass("disabled",t==Asc.c_oAscCellEditorState.editText||this.isUserProtected))},onApiCellSelection:function(t){this.editor.updateCellInfo(t)},onApiSelectionChanged:function(t){var e,i,s,o,n,a;!this.viewmode&&t&&(n=t.asc_getSelectionType(),e=!(this.mode.isEditMailMerge||this.mode.isEditDiagram||this.mode.isEditOle)&&(!0===t.asc_getLocked()||!0===t.asc_getLockedTable()||!0===t.asc_getLockedPivotTable()),i=n==Asc.c_oAscSelectionType.RangeChartText,s=n==Asc.c_oAscSelectionType.RangeChart,a=n==Asc.c_oAscSelectionType.RangeShapeText,o=n==Asc.c_oAscSelectionType.RangeShape,n=n==Asc.c_oAscSelectionType.RangeImage||n==Asc.c_oAscSelectionType.RangeSlicer,a=a||o||i||s,this.isUserProtected=!!t.asc_getUserProtected(),this.editor.$btnfunc.toggleClass("disabled",n||a||e||this.isUserProtected))},onApiDisconnect:function(){this.mode.isEdit=!1;var t=this.getApplication().getController("FormulaDialog");t&&t.hideDialog(),this.mode.isEdit||($("#ce-func-label",this.editor.el).addClass("disabled"),this.editor.btnNamedRanges.setVisible(!1))},onCellsRange:function(t){this.editor.cellNameDisabled(t!=Asc.c_oAscSelectionDialogType.None),this.editor.$btnfunc.toggleClass("disabled",t!=Asc.c_oAscSelectionDialogType.None||this.isUserProtected)},onLayoutResize:function(t,e){"cell:edit"==e&&(19<Math.floor(this.editor.$el.height())?(this.editor.$btnexpand.hasClass("btn-collapse")||(this.editor.$el.addClass("expanded"),this.editor.$btnexpand.addClass("btn-collapse")),t&&Common.localStorage.setItem("sse-celleditor-height",this.editor.$el.height()),t&&Common.localStorage.setBool("sse-celleditor-expand",!0)):(this.editor.$el.removeClass("expanded"),this.editor.$btnexpand.removeClass("btn-collapse"),t&&Common.localStorage.setBool("sse-celleditor-expand",!1)))},onCellName:function(t){t.keyCode==Common.UI.Keys.RETURN&&((t=this.editor.$cellname.val())&&t.length&&this.api.asc_findCell(t),Common.NotificationCenter.trigger("edit:complete",this.editor))},onBlurCellEditor:function(){"clear"==this.api.isCEditorFocused?this.api.isCEditorFocused=void 0:this.api.isCellEdited&&(this.api.isCEditorFocused=!0)},onKeyupCellEditor:function(t){t.keyCode!=Common.UI.Keys.RETURN||t.altKey||(this.api.isCEditorFocused="clear")},expandEditorField:function(){19<Math.floor(this.editor.$el.height())?(this.editor.keep_height=this.editor.$el.height(),this.editor.$el.height(19),this.editor.$el.removeClass("expanded"),this.editor.$btnexpand.removeClass("btn-collapse"),Common.localStorage.setBool("sse-celleditor-expand",!1)):(this.editor.$el.height(this.editor.keep_height),this.editor.$el.addClass("expanded"),this.editor.$btnexpand.addClass("btn-collapse"),Common.localStorage.setBool("sse-celleditor-expand",!0)),Common.NotificationCenter.trigger("layout:changed","celleditor"),Common.NotificationCenter.trigger("edit:complete",this.editor,{restorefocus:!0})},onInsertFunction:function(){var t;this.viewmode||!this.mode.isEdit||this.editor.$btnfunc.hasClass("disabled")||(t=this.getApplication().getController("FormulaDialog"))&&($("#ce-func-label",this.editor.el).blur(),t.showDialog())},onNamedRangesMenu:function(t,e){var i=this;if("manager"==e.options.value){for(var s=this.api.asc_getWorksheetsCount(),o=-1,n=[],a=[];++o<s;)this.api.asc_isWorksheetHidden(o)||(a[o]=this.api.asc_getWorksheetName(o),n.push({displayValue:a[o],value:o}));new SSE.Views.NameManagerDlg({api:this.api,handler:function(t){Common.NotificationCenter.trigger("edit:complete",i.editor)},locked:this.namedrange_locked,sheets:n,sheetNames:a,ranges:this.api.asc_getDefinedNames(Asc.c_oAscGetDefinedNamesList.All),props:this.api.asc_getDefaultDefinedName(),sort:this.rangeListSort}).on("close",function(t){i.rangeListSort=t.getSettings()}).show()}else this.api.asc_findCell(e.caption),Common.NotificationCenter.trigger("edit:complete",this.editor)},onNameBeforeShow:function(){var t=this.api.asc_getDefinedNames(Asc.c_oAscGetDefinedNamesList.WorksheetWorkbook,!0),i=this.editor.btnNamedRanges.menu,s="";i.removeItems(2,i.items.length-1),t.sort(function(t,e){t=t.asc_getName(!0).toLowerCase(),e=e.asc_getName(!0).toLowerCase();return t==e?0:t<e?-1:1}),_.each(t,function(t,e){t=t.asc_getName(!0);s!==t&&i.addItem(new Common.UI.MenuItem({caption:t})),s=t}),this.editor.btnNamedRanges.menu.items[0].setDisabled(!!this.api.asc_isProtectedSheet()),this.editor.btnNamedRanges.menu.items[1].setVisible(2<i.items.length)},onLockDefNameManager:function(t){this.namedrange_locked=t==Asc.c_oAscDefinedNameReason.LockDefNameManager},SetDisabled:function(t){this.editor.$btnfunc[t||!this.mode.isEdit||this.isUserProtected?"addClass":"removeClass"]("disabled"),this.editor.btnNamedRanges.setVisible(!t&&this.mode.isEdit&&!this.mode.isEditDiagram&&!this.mode.isEditMailMerge&&!this.mode.isEditOle)},setPreviewMode:function(t){this.viewmode!==t&&(this.viewmode=t,this.editor.$btnfunc[t||!this.mode.isEdit||this.isUserProtected?"addClass":"removeClass"]("disabled"),this.editor.cellNameDisabled(t&&!(this.mode.isEdit&&!this.mode.isEditDiagram&&!this.mode.isEditMailMerge&&!this.mode.isEditOle)))}})}),define("common/main/lib/view/ImageFromUrlDialog",["common/main/lib/component/Window"],function(){"use strict";Common.Views.ImageFromUrlDialog=Common.UI.Window.extend(_.extend({options:{width:330,header:!1,cls:"modal-dlg",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,t||{}),this.template=['<div class="box">','<div class="input-row">',"<label>"+(this.options.title||this.textUrl)+"</label>","</div>",'<div id="id-dlg-url" class="input-row"></div>',"</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var e=this;e.inputUrl=new Common.UI.InputField({el:$("#id-dlg-url"),allowBlank:!1,blankError:e.txtEmpty,style:"width: 100%;",validateOnBlur:!1,validation:function(t){return!!/((^https?)|(^ftp)):\/\/.+/i.test(t)||e.txtNotUrl}}),this.getChild().find(".dlg-btn").on("click",_.bind(this.onBtnClick,this))},show:function(){Common.UI.Window.prototype.show.apply(this,arguments);var t=this;_.delay(function(){t.getChild("input").focus()},100)},onPrimary:function(t){return this._handleInput("ok"),!1},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},_handleInput:function(t){if(this.options.handler){if("ok"==t&&!0!==this.inputUrl.checkValidate())return void this.inputUrl.cmpEl.find("input").focus();this.options.handler.call(this,t,this.inputUrl.getValue())}this.close()}},Common.Views.ImageFromUrlDialog||{}))}),void 0===Common&&(Common={}),define("common/main/lib/component/LoadMask",["common/main/lib/component/BaseView"],function(){"use strict";Common.UI.LoadMask=Common.UI.BaseView.extend({options:{cls:"",style:"",title:"Loading...",owner:document.body},template:_.template(['<div id="<%= id %>" class="asc-loadmask-body <%= cls %>" role="presentation" tabindex="-1">','<i id="loadmask-spinner" class="asc-loadmask-image"></i>','<div class="asc-loadmask-title"><%= title %></div>',"</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t),this.template=this.options.template||this.template,this.title=this.options.title,this.ownerEl=this.options.owner instanceof Common.UI.BaseView?$(this.options.owner.el):$(this.options.owner),this.loaderEl=$(this.template({id:this.id,cls:this.options.cls,style:this.options.style,title:this.title})),this.maskeEl=$('<div class="asc-loadmask"></div>'),this.timerId=0},render:function(){return this},internalShowLoader:function(){this.ownerEl.append(this.loaderEl),this.loaderEl.css("min-width",$(".asc-loadmask-title",this.loaderEl).width()+105),this.ownerEl&&0==this.ownerEl.closest(".asc-window.modal").length&&Common.util.Shortcuts.suspendEvents()},internalShowMask:function(){this.ownerEl.ismasked||(this.ownerEl.ismasked=!0,this.ownerEl.append(this.maskeEl))},show:function(t){var e;return this.internalShowMask(),this.ownerEl.hasloader||(this.ownerEl.hasloader=!0,(e=this).title!=e.options.title&&(e.options.title=e.title,$(".asc-loadmask-title",this.loaderEl).html(e.title)),t?e.internalShowLoader():e.timerId||(e.timerId=setTimeout(function(){e.internalShowLoader()},20))),this},hide:function(){var t=this.ownerEl;this.timerId&&(clearTimeout(this.timerId),this.timerId=0),t&&t.ismasked&&this.maskeEl&&this.maskeEl.remove(),delete t.ismasked,t&&t.hasloader&&(0!=t.closest(".asc-window.modal").length||Common.Utils.ModalWindow.isVisible()||Common.util.Shortcuts.resumeEvents(),this.loaderEl&&this.loaderEl.remove(),this.loaderEl&&this.loaderEl.find(".download-doc").remove()),delete t.hasloader},setTitle:function(t){var e;this.title=t,this.ownerEl&&this.ownerEl.hasloader&&this.loaderEl&&((e=$(".asc-loadmask-title",this.loaderEl)).html(t),this.loaderEl.css("min-width",e.width()+105))},isVisible:function(){return!!this.ownerEl.ismasked},updatePosition:function(){var t=this.ownerEl,e=this.loaderEl;t&&t.hasloader&&e&&(e.css({top:Math.round(t.height()/2-(e.height()+parseInt(e.css("padding-top"))+parseInt(e.css("padding-bottom")))/2)+"px",left:Math.round(t.width()/2-(e.width()+parseInt(e.css("padding-left"))+parseInt(e.css("padding-right")))/2)+"px"}),e.css({visibility:"visible"}))}})}),define("common/main/lib/view/SelectFileDlg",["common/main/lib/component/Window","common/main/lib/component/LoadMask"],function(){"use strict";Common.Views.SelectFileDlg=Common.UI.Window.extend(_.extend({initialize:function(t){var e={};_.extend(e,{title:this.textTitle,width:1024,height:621,header:!0},t),this.template=['<div id="id-select-file-placeholder"></div>'].join(""),e.tpl=_.template(this.template)(e),this.fileChoiceUrl=t.fileChoiceUrl||"",Common.UI.Window.prototype.initialize.call(this,e)},render:function(){Common.UI.Window.prototype.render.call(this),this.$window.find("> .body").css({height:"auto",overflow:"hidden"});var t=document.createElement("iframe"),e=(t.width="100%",t.height=585,t.align="top",t.frameBorder=0,t.scrolling="no",t.onload=_.bind(this._onLoad,this),$("#id-select-file-placeholder").append(t),this.loadMask=new Common.UI.LoadMask({owner:$("#id-select-file-placeholder")}),this.loadMask.setTitle(this.textLoading),this.loadMask.show(),t.src=this.fileChoiceUrl,this);this._eventfunc=function(t){e._onWindowMessage(t)},this._bindWindowEvents.call(this),this.on("close",function(t){e._unbindWindowEvents()})},_bindWindowEvents:function(){window.addEventListener?window.addEventListener("message",this._eventfunc,!1):window.attachEvent&&window.attachEvent("onmessage",this._eventfunc)},_unbindWindowEvents:function(){window.removeEventListener?window.removeEventListener("message",this._eventfunc):window.detachEvent&&window.detachEvent("onmessage",this._eventfunc)},_onWindowMessage:function(t){if(t&&window.JSON)try{this._onMessage.call(this,window.JSON.parse(t.data))}catch(t){}},_onMessage:function(t){var e;t&&"onlyoffice"==t.Referer&&void 0!==t.file&&(Common.NotificationCenter.trigger("window:close",this),e=this,setTimeout(function(){_.isEmpty(t.file)||e.trigger("selectfile",e,t.file)},50))},_onLoad:function(){this.loadMask&&this.loadMask.hide()}},Common.Views.SelectFileDlg||{}))}),define("common/main/lib/view/OptionsDialog",["common/main/lib/component/Window","common/main/lib/component/RadioBox"],function(){"use strict";Common.Views.OptionsDialog=Common.UI.Window.extend(_.extend({options:{width:214,header:!0,style:"min-width: 214px;",cls:"modal-dlg",items:[],buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,t||{}),this.template=['<div class="box">','<% if (typeof label !== "undefined" && label !=="") { %>','<label style="margin-bottom: 10px;"><%= label %></label>',"<% } %>","<% _.each(items, function(item, index) { %>","<% if (!item.id) item.id = Common.UI.getId(); %>",'<div id="<%= item.id %>" style="margin-bottom: 10px;"></div>',"<% }) %>","</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),this.radio=[],Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var s=this,t=s.getChild(),e=this.options.items,i=!0;if(this.checkedIndex=-1,e){for(var o=0;o<e.length;o++){var n=e[o];this.radio.push(new Common.UI.RadioBox({el:t.find("#"+n.id),labelText:n.caption||"",name:"asc-radio-opt-dlg",value:n.value,disabled:!!n.disabled,checked:i&&!n.disabled}).on("change",function(t,e,i){e&&(s.currentCell=t.options.value)})),!i&&!n.checked||n.disabled||(i=!1,this.checkedIndex=o)}0<=this.checkedIndex&&(this.radio[this.checkedIndex].setValue(!0),this.currentCell=this.radio[this.checkedIndex].options.value)}t.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this))},getFocusedComponents:function(){return this.radio},getDefaultFocusableComponent:function(){return 0<=this.checkedIndex?this.radio[this.checkedIndex]:null},_handleInput:function(t){this.options.handler&&this.options.handler.call(this,this,t),this.close()},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},getSettings:function(){return this.currentCell},onPrimary:function(){return this._handleInput("ok"),!1}},Common.Views.OptionsDialog||{}))}),void 0===Common&&(Common={}),void 0===Common.define&&(Common.define={}),define("common/main/lib/util/define",[],function(){"use strict";Common.define.c_oAscMathMainType={Symbol:0,Fraction:1,Script:2,Radical:3,Integral:4,LargeOperator:5,Bracket:6,Function:7,Accent:8,LimitLog:9,Operator:10,Matrix:11},Common.define.c_oAscMathType={Symbol_pm:0,Symbol_infinity:1,Symbol_equals:2,Symbol_neq:3,Symbol_about:4,Symbol_times:5,Symbol_div:6,Symbol_factorial:7,Symbol_propto:8,Symbol_less:9,Symbol_ll:10,Symbol_greater:11,Symbol_gg:12,Symbol_leq:13,Symbol_geq:14,Symbol_mp:15,Symbol_cong:16,Symbol_approx:17,Symbol_equiv:18,Symbol_forall:19,Symbol_additional:20,Symbol_partial:21,Symbol_sqrt:22,Symbol_cbrt:23,Symbol_qdrt:24,Symbol_cup:25,Symbol_cap:26,Symbol_emptyset:27,Symbol_percent:28,Symbol_degree:29,Symbol_fahrenheit:30,Symbol_celsius:31,Symbol_inc:32,Symbol_nabla:33,Symbol_exists:34,Symbol_notexists:35,Symbol_in:36,Symbol_ni:37,Symbol_leftarrow:38,Symbol_uparrow:39,Symbol_rightarrow:40,Symbol_downarrow:41,Symbol_leftrightarrow:42,Symbol_therefore:43,Symbol_plus:44,Symbol_minus:45,Symbol_not:46,Symbol_ast:47,Symbol_bullet:48,Symbol_vdots:49,Symbol_cdots:50,Symbol_rddots:51,Symbol_ddots:52,Symbol_aleph:53,Symbol_beth:54,Symbol_QED:55,Symbol_alpha:65536,Symbol_beta:65537,Symbol_gamma:65538,Symbol_delta:65539,Symbol_varepsilon:65540,Symbol_epsilon:65541,Symbol_zeta:65542,Symbol_eta:65543,Symbol_theta:65544,Symbol_vartheta:65545,Symbol_iota:65546,Symbol_kappa:65547,Symbol_lambda:65548,Symbol_mu:65549,Symbol_nu:65550,Symbol_xsi:65551,Symbol_o:65552,Symbol_pi:65553,Symbol_varpi:65554,Symbol_rho:65555,Symbol_varrho:65556,Symbol_sigma:65557,Symbol_varsigma:65558,Symbol_tau:65559,Symbol_upsilon:65560,Symbol_varphi:65561,Symbol_phi:65562,Symbol_chi:65563,Symbol_psi:65564,Symbol_omega:65565,Symbol_Alpha:131072,Symbol_Beta:131073,Symbol_Gamma:131074,Symbol_Delta:131075,Symbol_Epsilon:131076,Symbol_Zeta:131077,Symbol_Eta:131078,Symbol_Theta:131079,Symbol_Iota:131080,Symbol_Kappa:131081,Symbol_Lambda:131082,Symbol_Mu:131083,Symbol_Nu:131084,Symbol_Xsi:131085,Symbol_O:131086,Symbol_Pi:131087,Symbol_Rho:131088,Symbol_Sigma:131089,Symbol_Tau:131090,Symbol_Upsilon:131091,Symbol_Phi:131092,Symbol_Chi:131093,Symbol_Psi:131094,Symbol_Omega:131095,FractionVertical:16777216,FractionDiagonal:16777217,FractionHorizontal:16777218,FractionSmall:16777219,FractionDifferential_1:16842752,FractionDifferential_2:16842753,FractionDifferential_3:16842754,FractionDifferential_4:16842755,FractionPi_2:16842756,ScriptSup:33554432,ScriptSub:33554433,ScriptSubSup:33554434,ScriptSubSupLeft:33554435,ScriptCustom_1:33619968,ScriptCustom_2:33619969,ScriptCustom_3:33619970,ScriptCustom_4:33619971,RadicalSqrt:50331648,RadicalRoot_n:50331649,RadicalRoot_2:50331650,RadicalRoot_3:50331651,RadicalCustom_1:50397184,RadicalCustom_2:50397185,Integral:67108864,IntegralSubSup:67108865,IntegralCenterSubSup:67108866,IntegralDouble:67108867,IntegralDoubleSubSup:67108868,IntegralDoubleCenterSubSup:67108869,IntegralTriple:67108870,IntegralTripleSubSup:67108871,IntegralTripleCenterSubSup:67108872,IntegralOriented:67174400,IntegralOrientedSubSup:67174401,IntegralOrientedCenterSubSup:67174402,IntegralOrientedDouble:67174403,IntegralOrientedDoubleSubSup:67174404,IntegralOrientedDoubleCenterSubSup:67174405,IntegralOrientedTriple:67174406,IntegralOrientedTripleSubSup:67174407,IntegralOrientedTripleCenterSubSup:67174408,Integral_dx:67239936,Integral_dy:67239937,Integral_dtheta:67239938,LargeOperator_Sum:83886080,LargeOperator_Sum_CenterSubSup:83886081,LargeOperator_Sum_SubSup:83886082,LargeOperator_Sum_CenterSub:83886083,LargeOperator_Sum_Sub:83886084,LargeOperator_Prod:83951616,LargeOperator_Prod_CenterSubSup:83951617,LargeOperator_Prod_SubSup:83951618,LargeOperator_Prod_CenterSub:83951619,LargeOperator_Prod_Sub:83951620,LargeOperator_CoProd:83951621,LargeOperator_CoProd_CenterSubSup:83951622,LargeOperator_CoProd_SubSup:83951623,LargeOperator_CoProd_CenterSub:83951624,LargeOperator_CoProd_Sub:83951625,LargeOperator_Union:84017152,LargeOperator_Union_CenterSubSup:84017153,LargeOperator_Union_SubSup:84017154,LargeOperator_Union_CenterSub:84017155,LargeOperator_Union_Sub:84017156,LargeOperator_Intersection:84017157,LargeOperator_Intersection_CenterSubSup:84017158,LargeOperator_Intersection_SubSup:84017159,LargeOperator_Intersection_CenterSub:84017160,LargeOperator_Intersection_Sub:84017161,LargeOperator_Disjunction:84082688,LargeOperator_Disjunction_CenterSubSup:84082689,LargeOperator_Disjunction_SubSup:84082690,LargeOperator_Disjunction_CenterSub:84082691,LargeOperator_Disjunction_Sub:84082692,LargeOperator_Conjunction:84082693,LargeOperator_Conjunction_CenterSubSup:84082694,LargeOperator_Conjunction_SubSup:84082695,LargeOperator_Conjunction_CenterSub:84082696,LargeOperator_Conjunction_Sub:84082697,LargeOperator_Custom_1:84148224,LargeOperator_Custom_2:84148225,LargeOperator_Custom_3:84148226,LargeOperator_Custom_4:84148227,LargeOperator_Custom_5:84148228,Bracket_Round:100663296,Bracket_Square:100663297,Bracket_Curve:100663298,Bracket_Angle:100663299,Bracket_LowLim:100663300,Bracket_UppLim:100663301,Bracket_Line:100663302,Bracket_LineDouble:100663303,Bracket_Square_OpenOpen:100663304,Bracket_Square_CloseClose:100663305,Bracket_Square_CloseOpen:100663306,Bracket_SquareDouble:100663307,Bracket_Round_Delimiter_2:100728832,Bracket_Curve_Delimiter_2:100728833,Bracket_Angle_Delimiter_2:100728834,Bracket_Angle_Delimiter_3:100728835,Bracket_Round_OpenNone:100794368,Bracket_Round_NoneOpen:100794369,Bracket_Square_OpenNone:100794370,Bracket_Square_NoneOpen:100794371,Bracket_Curve_OpenNone:100794372,Bracket_Curve_NoneOpen:100794373,Bracket_Angle_OpenNone:100794374,Bracket_Angle_NoneOpen:100794375,Bracket_LowLim_OpenNone:100794376,Bracket_LowLim_NoneNone:100794377,Bracket_UppLim_OpenNone:100794378,Bracket_UppLim_NoneOpen:100794379,Bracket_Line_OpenNone:100794380,Bracket_Line_NoneOpen:100794381,Bracket_LineDouble_OpenNone:100794382,Bracket_LineDouble_NoneOpen:100794383,Bracket_SquareDouble_OpenNone:100794384,Bracket_SquareDouble_NoneOpen:100794385,Bracket_Custom_1:100859904,Bracket_Custom_2:100859905,Bracket_Custom_3:100859906,Bracket_Custom_4:100859907,Bracket_Custom_5:100925440,Bracket_Custom_6:100925441,Bracket_Custom_7:100925442,Function_Sin:117440512,Function_Cos:117440513,Function_Tan:117440514,Function_Csc:117440515,Function_Sec:117440516,Function_Cot:117440517,Function_1_Sin:117506048,Function_1_Cos:117506049,Function_1_Tan:117506050,Function_1_Csc:117506051,Function_1_Sec:117506052,Function_1_Cot:117506053,Function_Sinh:117571584,Function_Cosh:117571585,Function_Tanh:117571586,Function_Csch:117571587,Function_Sech:117571588,Function_Coth:117571589,Function_1_Sinh:117637120,Function_1_Cosh:117637121,Function_1_Tanh:117637122,Function_1_Csch:117637123,Function_1_Sech:117637124,Function_1_Coth:117637125,Function_Custom_1:117702656,Function_Custom_2:117702657,Function_Custom_3:117702658,Accent_Dot:134217728,Accent_DDot:134217729,Accent_DDDot:134217730,Accent_Hat:134217731,Accent_Check:134217732,Accent_Accent:134217733,Accent_Grave:134217734,Accent_Smile:134217735,Accent_Tilde:134217736,Accent_Bar:134217737,Accent_DoubleBar:134217738,Accent_CurveBracketTop:134217739,Accent_CurveBracketBot:134217740,Accent_GroupTop:134217741,Accent_GroupBot:134217742,Accent_ArrowL:134217743,Accent_ArrowR:134217744,Accent_ArrowD:134217745,Accent_HarpoonL:134217746,Accent_HarpoonR:134217747,Accent_BorderBox:134283264,Accent_BorderBoxCustom:134283265,Accent_BarTop:134348800,Accent_BarBot:134348801,Accent_Custom_1:134414336,Accent_Custom_2:134414337,Accent_Custom_3:134414338,LimitLog_LogBase:150994944,LimitLog_Log:150994945,LimitLog_Lim:150994946,LimitLog_Min:150994947,LimitLog_Max:150994948,LimitLog_Ln:150994949,LimitLog_Custom_1:151060480,LimitLog_Custom_2:151060481,Operator_ColonEquals:167772160,Operator_EqualsEquals:167772161,Operator_PlusEquals:167772162,Operator_MinusEquals:167772163,Operator_Definition:167772164,Operator_UnitOfMeasure:167772165,Operator_DeltaEquals:167772166,Operator_ArrowL_Top:167837696,Operator_ArrowR_Top:167837697,Operator_ArrowL_Bot:167837698,Operator_ArrowR_Bot:167837699,Operator_DoubleArrowL_Top:167837700,Operator_DoubleArrowR_Top:167837701,Operator_DoubleArrowL_Bot:167837702,Operator_DoubleArrowR_Bot:167837703,Operator_ArrowD_Top:167837704,Operator_ArrowD_Bot:167837705,Operator_DoubleArrowD_Top:167837706,Operator_DoubleArrowD_Bot:167837707,Operator_Custom_1:167903232,Operator_Custom_2:167903233,Matrix_1_2:184549376,Matrix_2_1:184549377,Matrix_1_3:184549378,Matrix_3_1:184549379,Matrix_2_2:184549380,Matrix_2_3:184549381,Matrix_3_2:184549382,Matrix_3_3:184549383,Matrix_Dots_Center:184614912,Matrix_Dots_Baseline:184614913,Matrix_Dots_Vertical:184614914,Matrix_Dots_Diagonal:184614915,Matrix_Identity_2:184680448,Matrix_Identity_2_NoZeros:184680449,Matrix_Identity_3:184680450,Matrix_Identity_3_NoZeros:184680451,Matrix_2_2_RoundBracket:184745984,Matrix_2_2_SquareBracket:184745985,Matrix_2_2_LineBracket:184745986,Matrix_2_2_DLineBracket:184745987,Matrix_Flat_Round:184811520,Matrix_Flat_Square:184811521},Common.define.chartData=_.extend(new function(){return{textLine:"Line",textColumn:"Column",textBar:"Bar",textArea:"Area",textPie:"Pie",textPoint:"XY (Scatter)",textStock:"Stock",textSurface:"Surface",textCharts:"Charts",textSparks:"Sparklines",textLineSpark:"Line",textColumnSpark:"Column",textWinLossSpark:"Win/Loss",textCombo:"Combo",textBarNormal:"Clustered column",textBarStacked:"Stacked column",textBarStackedPer:"100% Stacked column",textBarNormal3d:"3-D Clustered column",textBarStacked3d:"3-D Stacked column",textBarStackedPer3d:"3-D 100% Stacked column",textBarNormal3dPerspective:"3-D column",textLineStacked:"Stacked line",textLineStackedPer:"100% Stacked line",textLineMarker:"Line with markers",textLineStackedMarker:"Stacked line with markers",textLineStackedPerMarker:"100% Stacked line with markers",textLine3d:"3-D line",textDoughnut:"Doughnut",textPie3d:"3-D pie",textHBarNormal:"Clustered bar",textHBarStacked:"Stacked bar",textHBarStackedPer:"100% Stacked bar",textHBarNormal3d:"3-D Clustered bar",textHBarStacked3d:"3-D Stacked bar",textHBarStackedPer3d:"3-D 100% Stacked bar",textAreaStacked:"Stacked area",textAreaStackedPer:"100% Stacked area",textScatter:"Scatter",textScatterSmoothMarker:"Scatter with smooth lines and markers",textScatterSmooth:"Scatter with smooth lines",textScatterLineMarker:"Scatter with straight lines and markers",textScatterLine:"Scatter with straight lines",textComboBarLine:"Clustered column - line",textComboBarLineSecondary:"Clustered column - line on secondary axis",textComboAreaBar:"Stacked area - clustered column",textComboCustom:"Custom combination",textRadar:"Radar",textRadarMarker:"Radar with markers",textRadarFilled:"Filled radar",getChartGroupData:function(t){return[{id:"menu-chart-group-bar",caption:this.textColumn,headername:t?this.textCharts:void 0},{id:"menu-chart-group-line",caption:this.textLine},{id:"menu-chart-group-pie",caption:this.textPie},{id:"menu-chart-group-hbar",caption:this.textBar},{id:"menu-chart-group-area",caption:this.textArea,inline:!0},{id:"menu-chart-group-stock",caption:this.textStock,inline:!0},{id:"menu-chart-group-scatter",caption:this.textPoint},{id:"menu-chart-group-radar",caption:this.textRadar},{id:"menu-chart-group-combo",caption:this.textCombo}]},getChartData:function(){return[{group:"menu-chart-group-bar",type:Asc.c_oAscChartTypeSettings.barNormal,iconCls:"column-normal",tip:this.textBarNormal},{group:"menu-chart-group-bar",type:Asc.c_oAscChartTypeSettings.barStacked,iconCls:"column-stack",tip:this.textBarStacked},{group:"menu-chart-group-bar",type:Asc.c_oAscChartTypeSettings.barStackedPer,iconCls:"column-pstack",tip:this.textBarStackedPer},{group:"menu-chart-group-bar",type:Asc.c_oAscChartTypeSettings.barNormal3d,iconCls:"column-3d-normal",tip:this.textBarNormal3d,is3d:!0},{group:"menu-chart-group-bar",type:Asc.c_oAscChartTypeSettings.barStacked3d,iconCls:"column-3d-stack",tip:this.textBarStacked3d,is3d:!0},{group:"menu-chart-group-bar",type:Asc.c_oAscChartTypeSettings.barStackedPer3d,iconCls:"column-3d-pstack",tip:this.textBarStackedPer3d,is3d:!0},{group:"menu-chart-group-bar",type:Asc.c_oAscChartTypeSettings.barNormal3dPerspective,iconCls:"column-3d-normal-per",tip:this.textBarNormal3dPerspective,is3d:!0},{group:"menu-chart-group-line",type:Asc.c_oAscChartTypeSettings.lineNormal,iconCls:"line-normal",tip:this.textLine},{group:"menu-chart-group-line",type:Asc.c_oAscChartTypeSettings.lineStacked,iconCls:"line-stack",tip:this.textLineStacked},{group:"menu-chart-group-line",type:Asc.c_oAscChartTypeSettings.lineStackedPer,iconCls:"line-pstack",tip:this.textLineStackedPer},{group:"menu-chart-group-line",type:Asc.c_oAscChartTypeSettings.lineNormalMarker,iconCls:"line-normal-marker",tip:this.textLineMarker},{group:"menu-chart-group-line",type:Asc.c_oAscChartTypeSettings.lineStackedMarker,iconCls:"line-stack-marker",tip:this.textLineStackedMarker},{group:"menu-chart-group-line",type:Asc.c_oAscChartTypeSettings.lineStackedPerMarker,iconCls:"line-pstack-marker",tip:this.textLineStackedPerMarker},{group:"menu-chart-group-line",type:Asc.c_oAscChartTypeSettings.line3d,iconCls:"line-3d",tip:this.textLine3d,is3d:!0},{group:"menu-chart-group-pie",type:Asc.c_oAscChartTypeSettings.pie,iconCls:"pie-normal",tip:this.textPie},{group:"menu-chart-group-pie",type:Asc.c_oAscChartTypeSettings.doughnut,iconCls:"pie-doughnut",tip:this.textDoughnut},{group:"menu-chart-group-pie",type:Asc.c_oAscChartTypeSettings.pie3d,iconCls:"pie-3d-normal",tip:this.textPie3d,is3d:!0},{group:"menu-chart-group-hbar",type:Asc.c_oAscChartTypeSettings.hBarNormal,iconCls:"bar-normal",tip:this.textHBarNormal},{group:"menu-chart-group-hbar",type:Asc.c_oAscChartTypeSettings.hBarStacked,iconCls:"bar-stack",tip:this.textHBarStacked},{group:"menu-chart-group-hbar",type:Asc.c_oAscChartTypeSettings.hBarStackedPer,iconCls:"bar-pstack",tip:this.textHBarStackedPer},{group:"menu-chart-group-hbar",type:Asc.c_oAscChartTypeSettings.hBarNormal3d,iconCls:"bar-3d-normal",tip:this.textHBarNormal3d,is3d:!0},{group:"menu-chart-group-hbar",type:Asc.c_oAscChartTypeSettings.hBarStacked3d,iconCls:"bar-3d-stack",tip:this.textHBarStacked3d,is3d:!0},{group:"menu-chart-group-hbar",type:Asc.c_oAscChartTypeSettings.hBarStackedPer3d,iconCls:"bar-3d-pstack",tip:this.textHBarStackedPer3d,is3d:!0},{group:"menu-chart-group-area",type:Asc.c_oAscChartTypeSettings.areaNormal,iconCls:"area-normal",tip:this.textArea},{group:"menu-chart-group-area",type:Asc.c_oAscChartTypeSettings.areaStacked,iconCls:"area-stack",tip:this.textAreaStacked},{group:"menu-chart-group-area",type:Asc.c_oAscChartTypeSettings.areaStackedPer,iconCls:"area-pstack",tip:this.textAreaStackedPer},{group:"menu-chart-group-scatter",type:Asc.c_oAscChartTypeSettings.scatter,iconCls:"point-normal",tip:this.textScatter},{group:"menu-chart-group-scatter",type:Asc.c_oAscChartTypeSettings.scatterSmoothMarker,iconCls:"point-smooth-marker",tip:this.textScatterSmoothMarker},{group:"menu-chart-group-scatter",type:Asc.c_oAscChartTypeSettings.scatterSmooth,iconCls:"point-smooth",tip:this.textScatterSmooth},{group:"menu-chart-group-scatter",type:Asc.c_oAscChartTypeSettings.scatterLineMarker,iconCls:"point-line-marker",tip:this.textScatterLineMarker},{group:"menu-chart-group-scatter",type:Asc.c_oAscChartTypeSettings.scatterLine,iconCls:"point-line",tip:this.textScatterLine},{group:"menu-chart-group-stock",type:Asc.c_oAscChartTypeSettings.stock,iconCls:"stock-normal",tip:this.textStock},{group:"menu-chart-group-radar",type:Asc.c_oAscChartTypeSettings.radar,iconCls:"radar",tip:this.textRadar},{group:"menu-chart-group-radar",type:Asc.c_oAscChartTypeSettings.radarMarker,iconCls:"radar-with-markers",tip:this.textRadarMarker},{group:"menu-chart-group-radar",type:Asc.c_oAscChartTypeSettings.radarFilled,iconCls:"filled-radar",tip:this.textRadarFilled},{group:"menu-chart-group-combo",type:Asc.c_oAscChartTypeSettings.comboBarLine,iconCls:"combo-bar-line",tip:this.textComboBarLine},{group:"menu-chart-group-combo",type:Asc.c_oAscChartTypeSettings.comboBarLineSecondary,iconCls:"combo-bar-line-sec",tip:this.textComboBarLineSecondary},{group:"menu-chart-group-combo",type:Asc.c_oAscChartTypeSettings.comboAreaBar,iconCls:"combo-area-bar",tip:this.textComboAreaBar},{group:"menu-chart-group-combo",type:Asc.c_oAscChartTypeSettings.comboCustom,iconCls:"combo-custom",tip:this.textComboCustom}]},getSparkGroupData:function(t){return[{id:"menu-chart-group-sparkcolumn",inline:!0,headername:t?this.textSparks:void 0},{id:"menu-chart-group-sparkline",inline:!0},{id:"menu-chart-group-sparkwin",inline:!0}]},getSparkData:function(){return[{group:"menu-chart-group-sparkcolumn",type:Asc.c_oAscSparklineType.Column,allowSelected:!0,iconCls:"spark-column",tip:this.textColumnSpark},{group:"menu-chart-group-sparkline",type:Asc.c_oAscSparklineType.Line,allowSelected:!0,iconCls:"spark-line",tip:this.textLineSpark},{group:"menu-chart-group-sparkwin",type:Asc.c_oAscSparklineType.Stacked,allowSelected:!0,iconCls:"spark-win",tip:this.textWinLossSpark}]}}},Common.define.chartData||{}),Common.define.conditionalData=_.extend(new function(){return{textDate:"Date",textYesterday:"Yesterday",textToday:"Today",textTomorrow:"Tomorrow",textLast7days:"In the last 7 days",textLastWeek:"Last week",textThisWeek:"This week",textNextWeek:"Next week",textLastMonth:"Last month",textThisMonth:"This month",textNextMonth:"Next month",textText:"Text",textContains:"Contains",textNotContains:"Does not contain",textBegins:"Begins with",textEnds:"Ends with",textAverage:"Average",textAbove:"Above",textBelow:"Below",textEqAbove:"Equal to or above",textEqBelow:"Equal to or below",text1Above:"1 std dev above",text1Below:"1 std dev below",text2Above:"2 std dev above",text2Below:"2 std dev below",text3Above:"3 std dev above",text3Below:"3 std dev below",textGreater:"Greater than",textGreaterEq:"Greater than or equal to",textLess:"Less than",textLessEq:"Less than or equal to",textEqual:"Equal to",textNotEqual:"Not equal to",textBetween:"Between",textNotBetween:"Not between",textTop:"Top",textBottom:"Bottom",textBlank:"Blank",textError:"Error",textBlanks:"Contains blanks",textNotBlanks:"Does not contain blanks",textErrors:"Contains errors",textNotErrors:"Does not contain errors",textDuplicate:"Duplicate",textUnique:"Unique",textDataBar:"Data bar",textIconSets:"Icon sets",textFormula:"Formula",exampleText:"AaBbCcYyZz",noFormatText:"No format set",textValue:"Value is"}},Common.define.conditionalData||{}),Common.define.smartArt=_.extend(new function(){return{textList:"List",textProcess:"Process",textCycle:"Cycle",textHierarchy:"Hierarchy",textRelationship:"Relationship",textMatrix:"Matrix",textPyramid:"Pyramid",textPicture:"Picture",textBasicBlockList:"Basic Block List",textAlternatingHexagons:"Alternating Hexagons",textPictureCaptionList:"Picture Caption List",textLinedList:"Lined List",textVerticalBulletList:"Vertical Bullet List",textVerticalBoxList:"Vertical Box List",textHorizontalBulletList:"Horizontal Bullet List",textSquareAccentList:"Square Accent List",textPictureAccentList:"Picture Accent List",textBendingPictureAccentList:"Bending Picture Accent List",textStackedList:"Stacked List",textIncreasingCircleProcess:"Increasing Circle Process",textPieProcess:"Pie Process",textDetailedProcess:"Detailed Process",textGroupedList:"Grouped List",textHorizontalPictureList:"Horizontal Picture List",textContinuousPictureList:"Continuous Picture List",textPictureStrips:"Picture Strips",textVerticalPictureList:"Vertical Picture List",textAlternatingPictureBlocks:"Alternating Picture Blocks",textVerticalPictureAccentList:"Vertical Picture Accent List",textTitledPictureAccentList:"Titled Picture Accent List",textVerticalBlockList:"Vertical Block List",textVerticalChevronList:"Vertical Chevron List",textVerticalAccentList:"Vertical Accent List",textVerticalArrowList:"Vertical Arrow List",textTrapezoidList:"Trapezoid List",textDescendingBlockList:"Descending Block List",textTableList:"Table List",textSegmentedProcess:"Segmented Process",textVerticalCurvedList:"Vertical Curved List",textPyramidList:"Pyramid List",textTargetList:"Target List",textHierarchyList:"Hierarchy List",textVerticalCircleList:"Vertical Circle List",textTableHierarchy:"Table Hierarchy",textBasicProcess:"Basic Process",textStepUpProcess:"Step Up Process",textStepDownProcess:"Step Down Process",textAccentProcess:"Accent Process",textPictureAccentProcess:"Picture Accent Process",textAlternatingFlow:"Alternating Flow",textContinuousBlockProcess:"Continuous Block Process",textIncreasingArrowProcess:"Increasing Arrow Process",textContinuousArrowProcess:"Continuous Arrow Process",textProcessArrows:"Process Arrows",textCircleAccentTimeline:"Circle Accent Timeline",textBasicTimeline:"Basic Timeline",textBasicChevronProcess:"Basic Chevron Process",textClosedChevronProcess:"Closed Chevron Process",textChevronList:"Chevron List",textSubStepProcess:"Sub-Step Process",textPhasedProcess:"Phased Process",textRandomToResultProcess:"Random to Result Process",textVerticalProcess:"Vertical Process",textStaggeredProcess:"Staggered Process",textProcessList:"Process List",textCircleArrowProcess:"Circle Arrow Process",textBasicBendingProcess:"Basic Bending Process",textRepeatingBendingProcess:"Repeating Bending Process",textVerticalBendingProcess:"Vertical Bending Process",textAscendingPictureAccentProcess:"Ascending Picture Accent Process",textUpwardArrow:"Upward Arrow",textDescendingProcess:"Descending Process",textCircularBendingProcess:"Circular Bending Process",textEquation:"Equation",textVerticalEquation:"Vertical Equation",textFunnel:"Funnel",textGear:"Gear",textArrowRibbon:"Arrow Ribbon",textOpposingArrows:"Opposing Arrows",textConvergingArrows:"Converging Arrows",textDivergingArrows:"Diverging Arrows",textBasicCycle:"Basic Cycle",textTextCycle:"Text Cycle",textBlockCycle:"Block Cycle",textNondirectionalCycle:"Nondirectional Cycle",textContinuousCycle:"Continuous Cycle",textMultidirectionalCycle:"Multidirectional Cycle",textSegmentedCycle:"Segmented Cycle",textBasicPie:"Basic Pie",textRadialCycle:"Radial Cycle",textBasicRadial:"Basic Radial",textDivergingRadial:"Diverging Radial",textRadialVenn:"Radial Venn",textCycleMatrix:"Cycle Matrix",textRadialCluster:"Radial Cluster",textOrganizationChart:"Organization Chart",textNameAndTitleOrganizationChart:"Name and Title Organization Chart",textHalfCircleOrganizationChart:"Half Circle Organization Chart",textCirclePictureHierarchy:"Circle Picture Hierarchy",textLabeledHierarchy:"Labeled Hierarchy",textHorizontalOrganizationChart:"Horizontal Organization Chart",textHorizontalMultiLevelHierarchy:"Horizontal Multi-Level Hierarchy",textHorizontalHierarchy:"Horizontal Hierarchy",textHorizontalLabeledHierarchy:"Horizontal Labeled Hierarchy",textBalance:"Balance",textCircleRelationship:"Circle Relationship",textHexagonCluster:"Hexagon Cluster",textOpposingIdeas:"Opposing Ideas",textPlusAndMinus:"Plus and Minus",textReverseList:"Reverse List",textCounterbalanceArrows:"Counterbalance Arrows",textSegmentedPyramid:"Segmented Pyramid",textNestedTarget:"Nested Target",textConvergingRadial:"Converging Radial",textRadialList:"Radial List",textBasicTarget:"Basic Target",textBasicVenn:"Basic Venn",textLinearVenn:"Linear Venn",textStackedVenn:"Stacked Venn",textBasicMatrix:"Basic Matrix",textTitledMatrix:"Titled Matrix",textGridMatrix:"Grid Matrix",textBasicPyramid:"Basic Pyramid",textInvertedPyramid:"Inverted Pyramid",textAccentedPicture:"Accented Picture",textCircularPictureCallout:"Circular Picture Callout",textSnapshotPictureList:"Snapshot Picture List",textSpiralPicture:"Spiral Picture",textCaptionedPictures:"Captioned Pictures",textBendingPictureCaption:"Bending Picture Caption",textBendingPictureSemiTranparentText:"Bending Picture Semi-Tranparent Text",textBendingPictureBlocks:"Bending Picture Blocks",textBendingPictureCaptionList:"Bending Picture Caption List",textTitledPictureBlocks:"Titled Picture Blocks",textPictureGrid:"Picture Grid",textPictureAccentBlocks:"Picture Accent Blocks",textAlternatingPictureCircles:"Alternating Picture Circles",textTitlePictureLineup:"Title Picture Lineup",textPictureLineup:"Picture Lineup",textFramedTextPicture:"Framed Text Picture",textBubblePictureList:"Bubble Picture List",textOther:"Other",textPictureOrganizationChart:"Picture Organization Chart",textChevronAccentProcess:"Chevron Accent Process",textRadialPictureList:"Radial Picture List",textVerticalBracketList:"Vertical Bracket List",textInterconnectedBlockProcess:"Interconnected Block Process",textTabbedArc:"Tabbed Arc",textThemePictureAccent:"Theme Picture Accent",textVaryingWidthList:"Varying Width List",textConvergingText:"Converging Text",textInterconnectedRings:"Interconnected Rings",textArchitectureLayout:"Architecture Layout",textThemePictureAlternatingAccent:"Theme Picture Alternating Accent",textThemePictureGrid:"Theme Picture Grid",textCircleProcess:"Circle Process",textHexagonRadial:"Hexagon Radial",textPictureFrame:"PictureFrame",textTabList:"Tab List",getSmartArtData:function(){return[{id:"menu-smart-art-group-list",sectionId:Asc.c_oAscSmartArtSectionNames.List,caption:this.textList,icon:"btn-smart-list",items:[{type:Asc.c_oAscSmartArtTypes.BasicBlockList,tip:this.textBasicBlockList},{type:Asc.c_oAscSmartArtTypes.AlternatingHexagonList,tip:this.textAlternatingHexagons},{type:Asc.c_oAscSmartArtTypes.PictureCaptionList,tip:this.textPictureCaptionList},{type:Asc.c_oAscSmartArtTypes.LinedList,tip:this.textLinedList},{type:Asc.c_oAscSmartArtTypes.VerticalBulletList,tip:this.textVerticalBulletList},{type:Asc.c_oAscSmartArtTypes.VerticalBoxList,tip:this.textVerticalBoxList},{type:Asc.c_oAscSmartArtTypes.VerticalBracketList,tip:this.textVerticalBracketList},{type:Asc.c_oAscSmartArtTypes.VaryingWidthList,tip:this.textVaryingWidthList},{type:Asc.c_oAscSmartArtTypes.TabList,tip:this.textTabList},{type:Asc.c_oAscSmartArtTypes.HorizontalBulletList,tip:this.textHorizontalBulletList},{type:Asc.c_oAscSmartArtTypes.SquareAccentList,tip:this.textSquareAccentList},{type:Asc.c_oAscSmartArtTypes.PictureAccentList,tip:this.textPictureAccentList},{type:Asc.c_oAscSmartArtTypes.BendingPictureAccentList,tip:this.textBendingPictureAccentList},{type:Asc.c_oAscSmartArtTypes.StackedList,tip:this.textStackedList},{type:Asc.c_oAscSmartArtTypes.IncreasingCircleProcess,tip:this.textIncreasingCircleProcess},{type:Asc.c_oAscSmartArtTypes.PieProcess,tip:this.textPieProcess},{type:Asc.c_oAscSmartArtTypes.DetailedProcess,tip:this.textDetailedProcess},{type:Asc.c_oAscSmartArtTypes.GroupedList,tip:this.textGroupedList},{type:Asc.c_oAscSmartArtTypes.HorizontalPictureList,tip:this.textHorizontalPictureList},{type:Asc.c_oAscSmartArtTypes.ContinuousPictureList,tip:this.textContinuousPictureList},{type:Asc.c_oAscSmartArtTypes.PictureStrips,tip:this.textPictureStrips},{type:Asc.c_oAscSmartArtTypes.VerticalPictureList,tip:this.textVerticalPictureList},{type:Asc.c_oAscSmartArtTypes.AlternatingPictureBlocks,tip:this.textAlternatingPictureBlocks},{type:Asc.c_oAscSmartArtTypes.VerticalPictureAccentList,tip:this.textVerticalPictureAccentList},{type:Asc.c_oAscSmartArtTypes.TitledPictureAccentList,tip:this.textTitledPictureAccentList},{type:Asc.c_oAscSmartArtTypes.VerticalBlockList,tip:this.textVerticalBlockList},{type:Asc.c_oAscSmartArtTypes.VerticalChevronList,tip:this.textVerticalChevronList},{type:Asc.c_oAscSmartArtTypes.VerticalAccentList,tip:this.textVerticalAccentList},{type:Asc.c_oAscSmartArtTypes.VerticalArrowList,tip:this.textVerticalArrowList},{type:Asc.c_oAscSmartArtTypes.TrapezoidList,tip:this.textTrapezoidList},{type:Asc.c_oAscSmartArtTypes.DescendingBlockList,tip:this.textDescendingBlockList},{type:Asc.c_oAscSmartArtTypes.TableList,tip:this.textTableList},{type:Asc.c_oAscSmartArtTypes.SegmentedProcess,tip:this.textSegmentedProcess},{type:Asc.c_oAscSmartArtTypes.VerticalCurvedList,tip:this.textVerticalCurvedList},{type:Asc.c_oAscSmartArtTypes.PyramidList,tip:this.textPyramidList},{type:Asc.c_oAscSmartArtTypes.TargetList,tip:this.textTargetList},{type:Asc.c_oAscSmartArtTypes.HierarchyList,tip:this.textHierarchyList},{type:Asc.c_oAscSmartArtTypes.VerticalCircleList,tip:this.textVerticalCircleList},{type:Asc.c_oAscSmartArtTypes.TableHierarchy,tip:this.textTableHierarchy},{type:Asc.c_oAscSmartArtTypes.ArchitectureLayout,tip:this.textArchitectureLayout}]},{id:"menu-smart-art-group-process",sectionId:Asc.c_oAscSmartArtSectionNames.Process,caption:this.textProcess,icon:"btn-smart-process",items:[{type:Asc.c_oAscSmartArtTypes.BasicProcess,tip:this.textBasicProcess},{type:Asc.c_oAscSmartArtTypes.StepUpProcess,tip:this.textStepUpProcess},{type:Asc.c_oAscSmartArtTypes.StepDownProcess,tip:this.textStepDownProcess},{type:Asc.c_oAscSmartArtTypes.AccentProcess,tip:this.textAccentProcess},{type:Asc.c_oAscSmartArtTypes.PictureAccentProcess,tip:this.textPictureAccentProcess},{type:Asc.c_oAscSmartArtTypes.AlternatingFlow,tip:this.textAlternatingFlow},{type:Asc.c_oAscSmartArtTypes.IncreasingCircleProcess,tip:this.textIncreasingCircleProcess},{type:Asc.c_oAscSmartArtTypes.PieProcess,tip:this.textPieProcess},{type:Asc.c_oAscSmartArtTypes.ContinuousBlockProcess,tip:this.textContinuousBlockProcess},{type:Asc.c_oAscSmartArtTypes.IncreasingArrowsProcess,tip:this.textIncreasingArrowProcess},{type:Asc.c_oAscSmartArtTypes.InterconnectedBlockProcess,tip:this.textInterconnectedBlockProcess},{type:Asc.c_oAscSmartArtTypes.ContinuousArrowProcess,tip:this.textContinuousArrowProcess},{type:Asc.c_oAscSmartArtTypes.ConvergingText,tip:this.textConvergingText},{type:Asc.c_oAscSmartArtTypes.ProcessArrows,tip:this.textProcessArrows},{type:Asc.c_oAscSmartArtTypes.CircleAccentTimeline,tip:this.textCircleAccentTimeline},{type:Asc.c_oAscSmartArtTypes.BasicTimeline,tip:this.textBasicTimeline},{type:Asc.c_oAscSmartArtTypes.CircleProcess,tip:this.textCircleProcess},{type:Asc.c_oAscSmartArtTypes.BasicChevronProcess,tip:this.textBasicChevronProcess},{type:Asc.c_oAscSmartArtTypes.ChevronAccentProcess,tip:this.textChevronAccentProcess},{type:Asc.c_oAscSmartArtTypes.ClosedChevronProcess,tip:this.textClosedChevronProcess},{type:Asc.c_oAscSmartArtTypes.ChevronList,tip:this.textChevronList},{type:Asc.c_oAscSmartArtTypes.VerticalChevronList,tip:this.textVerticalChevronList},{type:Asc.c_oAscSmartArtTypes.SubStepProcess,tip:this.textSubStepProcess},{type:Asc.c_oAscSmartArtTypes.PhasedProcess,tip:this.textPhasedProcess},{type:Asc.c_oAscSmartArtTypes.RandomToResultProcess,tip:this.textRandomToResultProcess},{type:Asc.c_oAscSmartArtTypes.VerticalProcess,tip:this.textVerticalProcess},{type:Asc.c_oAscSmartArtTypes.StaggeredProcess,tip:this.textStaggeredProcess},{type:Asc.c_oAscSmartArtTypes.ProcessList,tip:this.textProcessList},{type:Asc.c_oAscSmartArtTypes.SegmentedProcess,tip:this.textSegmentedProcess},{type:Asc.c_oAscSmartArtTypes.CircleArrowProcess,tip:this.textCircleArrowProcess},{type:Asc.c_oAscSmartArtTypes.BasicBendingProcess,tip:this.textBasicBendingProcess},{type:Asc.c_oAscSmartArtTypes.RepeatingBendingProcess,tip:this.textRepeatingBendingProcess},{type:Asc.c_oAscSmartArtTypes.VerticalBendingProcess,tip:this.textVerticalBendingProcess},{type:Asc.c_oAscSmartArtTypes.ContinuousPictureList,tip:this.textContinuousPictureList},{type:Asc.c_oAscSmartArtTypes.DetailedProcess,tip:this.textDetailedProcess},{type:Asc.c_oAscSmartArtTypes.VerticalArrowList,tip:this.textVerticalArrowList},{type:Asc.c_oAscSmartArtTypes.AscendingPictureAccentProcess,tip:this.textAscendingPictureAccentProcess},{type:Asc.c_oAscSmartArtTypes.UpwardArrow,tip:this.textUpwardArrow},{type:Asc.c_oAscSmartArtTypes.DescendingProcess,tip:this.textDescendingProcess},{type:Asc.c_oAscSmartArtTypes.CircularBendingProcess,tip:this.textCircularBendingProcess},{type:Asc.c_oAscSmartArtTypes.Equation,tip:this.textEquation},{type:Asc.c_oAscSmartArtTypes.VerticalEquation,tip:this.textVerticalEquation},{type:Asc.c_oAscSmartArtTypes.Funnel,tip:this.textFunnel},{type:Asc.c_oAscSmartArtTypes.Gear,tip:this.textGear},{type:Asc.c_oAscSmartArtTypes.ArrowRibbon,tip:this.textArrowRibbon},{type:Asc.c_oAscSmartArtTypes.OpposingArrows,tip:this.textOpposingArrows},{type:Asc.c_oAscSmartArtTypes.ConvergingArrows,tip:this.textConvergingArrows},{type:Asc.c_oAscSmartArtTypes.DivergingArrows,tip:this.textDivergingArrows}]},{id:"menu-smart-art-group-cycle",sectionId:Asc.c_oAscSmartArtSectionNames.Cycle,caption:this.textCycle,icon:"btn-smart-cycle",items:[{type:Asc.c_oAscSmartArtTypes.BasicCycle,tip:this.textBasicCycle},{type:Asc.c_oAscSmartArtTypes.TextCycle,tip:this.textTextCycle},{type:Asc.c_oAscSmartArtTypes.BlockCycle,tip:this.textBlockCycle},{type:Asc.c_oAscSmartArtTypes.NonDirectionalCycle,tip:this.textNondirectionalCycle},{type:Asc.c_oAscSmartArtTypes.ContinuousCycle,tip:this.textContinuousCycle},{type:Asc.c_oAscSmartArtTypes.MultiDirectionalCycle,tip:this.textMultidirectionalCycle},{type:Asc.c_oAscSmartArtTypes.SegmentedCycle,tip:this.textSegmentedCycle},{type:Asc.c_oAscSmartArtTypes.BasicPie,tip:this.textBasicPie},{type:Asc.c_oAscSmartArtTypes.HexagonRadial,tip:this.textHexagonRadial},{type:Asc.c_oAscSmartArtTypes.RadialCycle,tip:this.textRadialCycle},{type:Asc.c_oAscSmartArtTypes.BasicRadial,tip:this.textBasicRadial},{type:Asc.c_oAscSmartArtTypes.DivergingRadial,tip:this.textDivergingRadial},{type:Asc.c_oAscSmartArtTypes.RadialVenn,tip:this.textRadialVenn},{type:Asc.c_oAscSmartArtTypes.CycleMatrix,tip:this.textCycleMatrix},{type:Asc.c_oAscSmartArtTypes.Gear,tip:this.textGear},{type:Asc.c_oAscSmartArtTypes.RadialCluster,tip:this.textRadialCluster},{type:Asc.c_oAscSmartArtTypes.CircleArrowProcess,tip:this.textCircleArrowProcess}]},{id:"menu-smart-art-group-hierarchy",sectionId:Asc.c_oAscSmartArtSectionNames.Hierarchy,caption:this.textHierarchy,icon:"btn-smart-hierarchy",items:[{type:Asc.c_oAscSmartArtTypes.OrganizationChart,tip:this.textOrganizationChart},{type:Asc.c_oAscSmartArtTypes.PictureOrganizationChart,tip:this.textPictureOrganizationChart},{type:Asc.c_oAscSmartArtTypes.NameAndTitleOrganizationChart,tip:this.textNameAndTitleOrganizationChart},{type:Asc.c_oAscSmartArtTypes.HalfCircleOrganizationChart,tip:this.textHalfCircleOrganizationChart},{type:Asc.c_oAscSmartArtTypes.CirclePictureHierarchy,tip:this.textCirclePictureHierarchy},{type:Asc.c_oAscSmartArtTypes.Hierarchy,tip:this.textHierarchy},{type:Asc.c_oAscSmartArtTypes.LabeledHierarchy,tip:this.textLabeledHierarchy},{type:Asc.c_oAscSmartArtTypes.TableHierarchy,tip:this.textTableHierarchy},{type:Asc.c_oAscSmartArtTypes.HorizontalOrganizationChart,tip:this.textHorizontalOrganizationChart},{type:Asc.c_oAscSmartArtTypes.ArchitectureLayout,tip:this.textArchitectureLayout},{type:Asc.c_oAscSmartArtTypes.HorizontalMultiLevelHierarchy,tip:this.textHorizontalMultiLevelHierarchy},{type:Asc.c_oAscSmartArtTypes.HorizontalHierarchy,tip:this.textHorizontalHierarchy},{type:Asc.c_oAscSmartArtTypes.HorizontalLabeledHierarchy,tip:this.textHorizontalLabeledHierarchy},{type:Asc.c_oAscSmartArtTypes.HierarchyList,tip:this.textHierarchyList},{type:Asc.c_oAscSmartArtTypes.LinedList,tip:this.textLinedList}]},{id:"menu-smart-art-group-relationship",sectionId:Asc.c_oAscSmartArtSectionNames.Relationship,caption:this.textRelationship,icon:"btn-smart-relationship",items:[{type:Asc.c_oAscSmartArtTypes.Balance,tip:this.textBalance},{type:Asc.c_oAscSmartArtTypes.CircleRelationship,tip:this.textCircleRelationship},{type:Asc.c_oAscSmartArtTypes.Funnel,tip:this.textFunnel},{type:Asc.c_oAscSmartArtTypes.Gear,tip:this.textGear},{type:Asc.c_oAscSmartArtTypes.HexagonCluster,tip:this.textHexagonCluster},{type:Asc.c_oAscSmartArtTypes.OpposingIdeas,tip:this.textOpposingIdeas},{type:Asc.c_oAscSmartArtTypes.PlusAndMinus,tip:this.textPlusAndMinus},{type:Asc.c_oAscSmartArtTypes.ReverseList,tip:this.textReverseList},{type:Asc.c_oAscSmartArtTypes.ArrowRibbon,tip:this.textArrowRibbon},{type:Asc.c_oAscSmartArtTypes.CounterbalanceArrows,tip:this.textCounterbalanceArrows},{type:Asc.c_oAscSmartArtTypes.ConvergingArrows,tip:this.textConvergingArrows},{type:Asc.c_oAscSmartArtTypes.DivergingArrows,tip:this.textDivergingArrows},{type:Asc.c_oAscSmartArtTypes.OpposingArrows,tip:this.textOpposingArrows},{type:Asc.c_oAscSmartArtTypes.SegmentedPyramid,tip:this.textSegmentedPyramid},{type:Asc.c_oAscSmartArtTypes.TableHierarchy,tip:this.textTableHierarchy},{type:Asc.c_oAscSmartArtTypes.ArchitectureLayout,tip:this.textArchitectureLayout},{type:Asc.c_oAscSmartArtTypes.TargetList,tip:this.textTargetList},{type:Asc.c_oAscSmartArtTypes.NestedTarget,tip:this.textNestedTarget},{type:Asc.c_oAscSmartArtTypes.GroupedList,tip:this.textGroupedList},{type:Asc.c_oAscSmartArtTypes.ContinuousPictureList,tip:this.textContinuousPictureList},{type:Asc.c_oAscSmartArtTypes.HierarchyList,tip:this.textHierarchyList},{type:Asc.c_oAscSmartArtTypes.PictureAccentList,tip:this.textPictureAccentList},{type:Asc.c_oAscSmartArtTypes.Equation,tip:this.textEquation},{type:Asc.c_oAscSmartArtTypes.VerticalEquation,tip:this.textVerticalEquation},{type:Asc.c_oAscSmartArtTypes.ConvergingRadial,tip:this.textConvergingRadial},{type:Asc.c_oAscSmartArtTypes.RadialCluster,tip:this.textRadialCluster},{type:Asc.c_oAscSmartArtTypes.RadialList,tip:this.textRadialList},{type:Asc.c_oAscSmartArtTypes.TabbedArc,tip:this.textTabbedArc},{type:Asc.c_oAscSmartArtTypes.RadialCycle,tip:this.textRadialCycle},{type:Asc.c_oAscSmartArtTypes.BasicRadial,tip:this.textBasicRadial},{type:Asc.c_oAscSmartArtTypes.DivergingRadial,tip:this.textDivergingRadial},{type:Asc.c_oAscSmartArtTypes.NonDirectionalCycle,tip:this.textNondirectionalCycle},{type:Asc.c_oAscSmartArtTypes.BasicTarget,tip:this.textBasicTarget},{type:Asc.c_oAscSmartArtTypes.CycleMatrix,tip:this.textCycleMatrix},{type:Asc.c_oAscSmartArtTypes.BasicPie,tip:this.textBasicPie},{type:Asc.c_oAscSmartArtTypes.BasicVenn,tip:this.textBasicVenn},{type:Asc.c_oAscSmartArtTypes.LinearVenn,tip:this.textLinearVenn},{type:Asc.c_oAscSmartArtTypes.StackedVenn,tip:this.textStackedVenn},{type:Asc.c_oAscSmartArtTypes.RadialVenn,tip:this.textRadialVenn},{type:Asc.c_oAscSmartArtTypes.InterconnectedRings,tip:this.textInterconnectedRings}]},{id:"menu-smart-art-group-matrix",sectionId:Asc.c_oAscSmartArtSectionNames.Matrix,caption:this.textMatrix,icon:"btn-smart-matrix",items:[{type:Asc.c_oAscSmartArtTypes.BasicMatrix,tip:this.textBasicMatrix},{type:Asc.c_oAscSmartArtTypes.TitledMatrix,tip:this.textTitledMatrix},{type:Asc.c_oAscSmartArtTypes.GridMatrix,tip:this.textGridMatrix},{type:Asc.c_oAscSmartArtTypes.CycleMatrix,tip:this.textCycleMatrix}]},{id:"menu-smart-art-group-pyramid",sectionId:Asc.c_oAscSmartArtSectionNames.Pyramid,caption:this.textPyramid,icon:"btn-smart-pyramid",items:[{type:Asc.c_oAscSmartArtTypes.BasicPyramid,tip:this.textBasicPyramid},{type:Asc.c_oAscSmartArtTypes.InvertedPyramid,tip:this.textInvertedPyramid},{type:Asc.c_oAscSmartArtTypes.PyramidList,tip:this.textPyramidList},{type:Asc.c_oAscSmartArtTypes.SegmentedPyramid,tip:this.textSegmentedPyramid}]},{id:"menu-smart-art-group-picture",sectionId:Asc.c_oAscSmartArtSectionNames.Picture,caption:this.textPicture,icon:"btn-menu-image",items:[{type:Asc.c_oAscSmartArtTypes.AccentedPicture,tip:this.textAccentedPicture},{type:Asc.c_oAscSmartArtTypes.CircularPictureCallout,tip:this.textCircularPictureCallout},{type:Asc.c_oAscSmartArtTypes.PictureCaptionList,tip:this.textPictureCaptionList},{type:Asc.c_oAscSmartArtTypes.RadialPictureList,tip:this.textRadialPictureList},{type:Asc.c_oAscSmartArtTypes.SnapshotPictureList,tip:this.textSnapshotPictureList},{type:Asc.c_oAscSmartArtTypes.SpiralPicture,tip:this.textSpiralPicture},{type:Asc.c_oAscSmartArtTypes.CaptionedPictures,tip:this.textCaptionedPictures},{type:Asc.c_oAscSmartArtTypes.BendingPictureCaption,tip:this.textBendingPictureCaption},{type:Asc.c_oAscSmartArtTypes.PictureFrame,tip:this.textPictureFrame},{type:Asc.c_oAscSmartArtTypes.BendingPictureSemiTransparentText,tip:this.textBendingPictureSemiTranparentText},{type:Asc.c_oAscSmartArtTypes.BendingPictureBlocks,tip:this.textBendingPictureBlocks},{type:Asc.c_oAscSmartArtTypes.BendingPictureCaptionList,tip:this.textBendingPictureCaptionList},{type:Asc.c_oAscSmartArtTypes.TitledPictureBlocks,tip:this.textTitledPictureBlocks},{type:Asc.c_oAscSmartArtTypes.PictureGrid,tip:this.textPictureGrid},{type:Asc.c_oAscSmartArtTypes.PictureAccentBlocks,tip:this.textPictureAccentBlocks},{type:Asc.c_oAscSmartArtTypes.PictureStrips,tip:this.textPictureStrips},{type:Asc.c_oAscSmartArtTypes.ThemePictureAccent,tip:this.textThemePictureAccent},{type:Asc.c_oAscSmartArtTypes.ThemePictureGrid,tip:this.textThemePictureGrid},{type:Asc.c_oAscSmartArtTypes.ThemePictureAlternatingAccent,tip:this.textThemePictureAlternatingAccent},{type:Asc.c_oAscSmartArtTypes.TitledPictureAccentList,tip:this.textTitledPictureAccentList},{type:Asc.c_oAscSmartArtTypes.AlternatingPictureBlocks,tip:this.textAlternatingPictureBlocks},{type:Asc.c_oAscSmartArtTypes.AscendingPictureAccentProcess,tip:this.textAscendingPictureAccentProcess},{type:Asc.c_oAscSmartArtTypes.AlternatingPictureCircles,tip:this.textAlternatingPictureCircles},{type:Asc.c_oAscSmartArtTypes.TitlePictureLineup,tip:this.textTitlePictureLineup},{type:Asc.c_oAscSmartArtTypes.PictureLineup,tip:this.textPictureLineup},{type:Asc.c_oAscSmartArtTypes.FramedTextPicture,tip:this.textFramedTextPicture},{type:Asc.c_oAscSmartArtTypes.HexagonCluster,tip:this.textHexagonCluster},{type:Asc.c_oAscSmartArtTypes.BubblePictureList,tip:this.textBubblePictureList},{type:Asc.c_oAscSmartArtTypes.CirclePictureHierarchy,tip:this.textCirclePictureHierarchy},{type:Asc.c_oAscSmartArtTypes.HorizontalPictureList,tip:this.textHorizontalPictureList},{type:Asc.c_oAscSmartArtTypes.ContinuousPictureList,tip:this.textContinuousPictureList},{type:Asc.c_oAscSmartArtTypes.VerticalPictureList,tip:this.textVerticalPictureList},{type:Asc.c_oAscSmartArtTypes.VerticalPictureAccentList,tip:this.textVerticalPictureAccentList},{type:Asc.c_oAscSmartArtTypes.BendingPictureAccentList,tip:this.textBendingPictureAccentList},{type:Asc.c_oAscSmartArtTypes.PictureAccentList,tip:this.textPictureAccentList},{type:Asc.c_oAscSmartArtTypes.PictureAccentProcess,tip:this.textPictureAccentProcess}]},{id:"menu-smart-art-group-other",sectionId:Asc.c_oAscSmartArtSectionNames.OfficeCom,caption:this.textOther,items:[{type:Asc.c_oAscSmartArtTypes.PictureOrganizationChart,tip:this.textPictureOrganizationChart},{type:Asc.c_oAscSmartArtTypes.ChevronAccentProcess,tip:this.textChevronAccentProcess},{type:Asc.c_oAscSmartArtTypes.RadialPictureList,tip:this.textRadialPictureList},{type:Asc.c_oAscSmartArtTypes.VerticalBracketList,tip:this.textVerticalBracketList},{type:Asc.c_oAscSmartArtTypes.InterconnectedBlockProcess,tip:this.textInterconnectedBlockProcess},{type:Asc.c_oAscSmartArtTypes.TabbedArc,tip:this.textTabbedArc},{type:Asc.c_oAscSmartArtTypes.ThemePictureAccent,tip:this.textThemePictureAccent},{type:Asc.c_oAscSmartArtTypes.VaryingWidthList,tip:this.textVaryingWidthList},{type:Asc.c_oAscSmartArtTypes.ConvergingText,tip:this.textConvergingText},{type:Asc.c_oAscSmartArtTypes.InterconnectedRings,tip:this.textInterconnectedRings},{type:Asc.c_oAscSmartArtTypes.ArchitectureLayout,tip:this.textArchitectureLayout},{type:Asc.c_oAscSmartArtTypes.ThemePictureAlternatingAccent,tip:this.textThemePictureAlternatingAccent},{type:Asc.c_oAscSmartArtTypes.ThemePictureGrid,tip:this.textThemePictureGrid},{type:Asc.c_oAscSmartArtTypes.CircleProcess,tip:this.textCircleProcess},{type:Asc.c_oAscSmartArtTypes.HexagonRadial,tip:this.textHexagonRadial},{type:Asc.c_oAscSmartArtTypes.PictureFrame,tip:this.textPictureFrame},{type:Asc.c_oAscSmartArtTypes.TabList,tip:this.textTabList}]}]}}},Common.define.smartArt||{})}),define("text!spreadsheeteditor/main/app/template/Toolbar.template",[],function(){return'<section class="toolbar">\n    <section class="box-tabs">\n        <div class="extra left"></div>\n        <%= tabsmarkup %>\n        <div class="extra right"></div>\n    </section>\n    <section class="box-controls">\n        <section class="panel static">\n            <div class="group no-mask small">\n                <div class="elset">\n                    <span class="btn-slot" id="slot-btn-save" data-layout-name="toolbar-save"></span>\n                </div>\n                <div class="elset">\n                    <span class="btn-slot" id="slot-btn-print"></span>\n                </div>\n            </div>\n            <div class="separator long"></div>\n            <div class="group small">\n                <div class="elset">\n                    <span class="btn-slot split" id="slot-btn-copy"></span>\n                    <span class="btn-slot" id="slot-btn-paste"></span>\n                </div>\n                <div class="elset">\n                    <span class="btn-slot split" id="slot-btn-undo"></span>\n                    <span class="btn-slot" id="slot-btn-redo"></span>\n                </div>\n            </div>\n            <div class="group small">\n                <div class="elset">\n                    <span class="btn-slot" id="slot-btn-cut"></span>\n                </div>\n                <div class="elset">\n                    <span class="btn-slot" id="slot-btn-copystyle"></span>\n                </div>\n            </div>\n            <div class="separator long"></div>\n        </section>\n        <section class="box-panels">\n            <section class="panel" data-tab="home">\n                <div class="group small">\n                    <div class="elset font-attr-top">\n                        <span class="btn-slot float-left" id="slot-field-fontname" style="width: 94px;"></span>\n                        <span class="btn-slot float-left" id="slot-field-fontsize"></span>\n                        <span class="btn-slot float-left" id="slot-btn-incfont"></span>\n                        <span class="btn-slot float-left" id="slot-btn-decfont"></span>\n                        <span class="btn-slot float-left split" id="slot-btn-changecase"></span>\n                    </div>\n                    <div class="elset font-attr">\n                        <span class="btn-slot" id="slot-btn-bold"></span>\n                        <span class="btn-slot" id="slot-btn-italic"></span>\n                        <span class="btn-slot" id="slot-btn-underline"></span>\n                        <span class="btn-slot" id="slot-btn-strikeout"></span>\n                        <span class="btn-slot split" id="slot-btn-subscript"></span>\n                        <span class="btn-slot split" id="slot-btn-fontcolor"></span>\n                        <span class="btn-slot split" id="slot-btn-fillparag"></span>\n                        <span class="btn-slot split" id="slot-btn-borders"></span>\n                    </div>\n                </div>\n                <div class="separator long"></div>\n                <div class="group small">\n                    <div class="elset">\n                        <span class="btn-slot split-small" id="slot-btn-top"></span>\n                        <span class="btn-slot split-small" id="slot-btn-middle"></span>\n                        <span class="btn-slot split-small" id="slot-btn-bottom"></span>\n                        <span class="btn-slot split-small" id="slot-btn-wrap"></span>\n                        <span class="btn-slot split" id="slot-btn-text-orient"></span>\n                    </div>\n                    <div class="elset">\n                        <span class="btn-slot split-small" id="<% if (!isRTL) { %>slot-btn-align-left<% } else { %>slot-btn-align-right<% } %>"></span>\n                        <span class="btn-slot split-small" id="slot-btn-align-center"></span>\n                        <span class="btn-slot split-small" id="<% if (!isRTL) { %>slot-btn-align-right<% } else { %>slot-btn-align-left<% } %>"></span>\n                        <span class="btn-slot split-small" id="slot-btn-align-just"></span>\n                        <span class="btn-slot split" id="slot-btn-merge"></span>\n                    </div>\n                </div>\n                <div class="separator long"></div>\n                <div class="group small">\n                    <div class="elset">\n                        <span class="btn-slot split" id="slot-btn-formula"></span>\n                        <span class="btn-slot split" id="slot-btn-fill-num"></span>\n                    </div>\n                    <div class="elset">\n                        <span class="btn-slot split" id="slot-btn-named-range"></span>\n                    </div>\n                </div>\n                <div class="separator long"></div>\n                <div class="group small">\n                    <div class="elset">\n                        <span class="btn-slot split slot-sortdesc"></span>\n                        <span class="btn-slot slot-sortasc"></span>\n                    </div>\n                    <div class="elset">\n                        <span class="btn-slot split slot-btn-setfilter"></span>\n                        <span class="btn-slot slot-btn-clear-filter"></span>\n                    </div>\n                </div>\n                <div class="separator long"></div>\n                <div class="group small">\n                    <div class="elset">\n                        <span class="btn-slot" id="slot-btn-format" style="width: 100%"></span>\n                    </div>\n                    <div class="elset">\n                        <span class="btn-slot split" id="slot-btn-percents"></span>\n                        <span class="btn-slot split" id="slot-btn-currency"></span>\n                        <span class="btn-slot split" id="slot-btn-digit-dec"></span>\n                        <span class="btn-slot" id="slot-btn-digit-inc"></span>\n                    </div>\n                </div>\n                <div class="separator long"></div>\n                <div class="group small">\n                    <div class="elset">\n                        <span class="btn-slot split" id="slot-btn-cell-ins"></span>\n                    </div>\n                    <div class="elset">\n                        <span class="btn-slot split" id="slot-btn-cell-del"></span>\n                    </div>\n                </div>\n                <div class="separator long"></div>\n                <div class="group small">\n                    <div class="elset">\n                        <span class="btn-slot split" id="slot-btn-clear"></span>\n                        <span class="btn-slot split" id="slot-btn-condformat"></span>\n                    </div>\n                    <div class="elset">\n                        <span class="btn-slot split" id="slot-btn-select-all"></span>\n                        <span class="btn-slot split" id="slot-btn-table-tpl"></span>\n                    </div>\n                </div>\n                <div class="separator long invisible"></div>\n                <div class="group small flex field-styles" id="slot-field-styles" style="min-width: 148px;width: 100%;" data-group-width="100%"></div>\n            </section>\n            <section class="panel" data-tab="ins">\n                <div class="group">\n                    <span class="btn-slot text x-huge slot-add-pivot"></span>\n                    <span class="btn-slot text x-huge" id="slot-btn-instable"></span>\n                </div>\n                <div class="separator long"></div>\n                <div class="group">\n                    <span class="btn-slot text x-huge" id="slot-btn-insimage"></span>\n                    <span class="btn-slot text x-huge" id="slot-btn-insshape"></span>\n                    <span class="btn-slot text x-huge" id="slot-btn-instext"></span>\n                    <span class="btn-slot text x-huge" id="slot-btn-instextart"></span>\n                    <span class="btn-slot text x-huge" id="slot-btn-inssmartart"></span>\n                </div>\n                <div class="separator long"></div>\n                <div class="group">\n                    <span class="btn-slot text x-huge" id="slot-btn-insrecommend"></span>\n                    <span class="btn-slot text x-huge" id="slot-btn-inschart"></span>\n                    <span class="btn-slot text x-huge" id="slot-btn-inssparkline"></span>\n                </div>\n                <div class="separator long"></div>\n                <div class="group">\n                    <span class="btn-slot text x-huge slot-comment"></span>\n                    <span class="btn-slot text x-huge" id="slot-btn-inshyperlink"></span>\n                </div>\n                <div class="separator long"></div>\n                <div class="group">\n                    <span class="btn-slot text x-huge slot-editheader"></span>\n                </div>\n                <div class="separator long"></div>\n                <div class="group">\n                    <span class="btn-slot text x-huge" id="slot-btn-insequation"></span>\n                    <span class="btn-slot text x-huge" id="slot-btn-inssymbol"></span>\n                </div>\n                <div class="separator long"></div>\n                <div class="group">\n                    <span class="btn-slot text x-huge" id="slot-btn-insslicer"></span>\n                </div>\n            </section>\n            <section class="panel" data-tab="layout">\n                <div class="group">\n                    <span class="btn-slot text x-huge" id="slot-btn-pagemargins"></span>\n                    <span class="btn-slot text x-huge" id="slot-btn-pageorient"></span>\n                    <span class="btn-slot text x-huge" id="slot-btn-pagesize"></span>\n                    <span class="btn-slot text x-huge" id="slot-btn-printarea"></span>\n                    <span class="btn-slot text x-huge" id="slot-btn-pagebreak"></span>\n                    <span class="btn-slot text x-huge slot-editheader"></span>\n                    <span class="btn-slot text" id="slot-btn-scale"></span>\n                    <span class="btn-slot text x-huge" id="slot-btn-printtitles"></span>\n                </div>\n                <div class="separator long"></div>\n                <div class="group small">\n                    <div class="elset">\n                        <span class="btn-slot text" id="slot-chk-print-gridlines"></span>\n                    </div>\n                    <div class="elset">\n                        <span class="btn-slot text" id="slot-chk-print-headings"></span>\n                    </div>\n                </div>\n                <div class="separator long"></div>\n                <div class="group">\n                    <span class="btn-slot text x-huge" id="slot-img-movefrwd"></span>\n                    <span class="btn-slot text x-huge" id="slot-img-movebkwd"></span>\n                    <span class="btn-slot text x-huge" id="slot-img-align"></span>\n                    <span class="btn-slot text x-huge" id="slot-img-group"></span>\n                </div>\n                <div class="separator long"></div>\n                <div class="group">\n                    <span class="btn-slot text x-huge" id="slot-btn-colorschemas"></span>\n                </div>\n            </section>\n            <section class="panel" data-tab="formula">\n                <div class="group">\n                    <span class="btn-slot text x-huge" id="slot-btn-additional-formula"></span>\n                </div>\n                <div class="separator long"></div>\n                <div class="group">\n                    <span class="btn-slot text x-huge" id="slot-btn-autosum"></span>\n                    <span class="btn-slot text x-huge" id="slot-btn-recent"></span>\n                    <span class="btn-slot text x-huge" id="slot-btn-financial"></span>\n                    <span class="btn-slot text x-huge" id="slot-btn-logical"></span>\n                    <span class="btn-slot text x-huge" id="slot-btn-text"></span>\n                    <span class="btn-slot text x-huge" id="slot-btn-datetime"></span>\n                    <span class="btn-slot text x-huge" id="slot-btn-lookup"></span>\n                    <span class="btn-slot text x-huge" id="slot-btn-math"></span>\n                    <span class="btn-slot text x-huge" id="slot-btn-more"></span>\n                </div>\n                <div class="separator long"></div>\n                <div class="group">\n                    <span class="btn-slot text x-huge" id="slot-btn-named-range-huge"></span>\n                </div>\n                <div class="separator long"></div>\n                <div class="group small">\n                    <div class="elset">\n                        <span class="btn-slot text" id="slot-btn-trace-prec"></span>\n                    </div>\n                    <div class="elset">\n                        <span class="btn-slot text" id="slot-btn-trace-dep"></span>\n                    </div>\n                </div>\n                <div class="group small">\n                    <div class="elset">\n                        <span class="btn-slot text" id="slot-btn-remove-arrows"></span>\n                    </div>\n                    <div class="elset">\n                        <span class="btn-slot text" id="slot-btn-show-formulas"></span>\n                    </div>\n                </div>\n                <div class="group">\n                    <span class="btn-slot text x-huge" id="slot-btn-watch-window"></span>\n                </div>\n                <div class="separator long"></div>\n                <div class="group">\n                    <span class="btn-slot text x-huge" id="slot-btn-calculate"></span>\n                </div>\n            </section>\n            <section class="panel" data-tab="data">\n                <div class="group">\n                    <span class="btn-slot text x-huge" id="slot-btn-data-from-text"></span>\n                </div>\n                <div class="separator long"></div>\n                <div class="group">\n                    <span class="btn-slot text x-huge" id="slot-btn-data-external-links"></span>\n                </div>\n                <div class="separator long"></div>\n                <div class="group">\n                    <div class="elset">\n                        <span class="btn-slot split slot-btn-setfilter"></span>\n                        <span class="btn-slot slot-sortdesc"></span>\n                    </div>\n                    <div class="elset">\n                        <span class="btn-slot split slot-btn-clear-filter"></span>\n                        <span class="btn-slot slot-sortasc"></span>\n                    </div>\n                </div>\n                <div class="group">\n                    <span class="btn-slot text x-huge" id="slot-btn-custom-sort"></span>\n                </div>\n                <div class="separator long"></div>\n                <div class="group">\n                    <span class="btn-slot text x-huge" id="slot-btn-text-column"></span>\n                    <span class="btn-slot text x-huge" id="slot-btn-rem-duplicates"></span>\n                    <span class="btn-slot text x-huge" id="slot-btn-data-validation"></span>\n                </div>\n                <div class="separator long"></div>\n                <div class="group">\n                    <span class="btn-slot text x-huge" id="slot-btn-group"></span>\n                    <span class="btn-slot text x-huge" id="slot-btn-ungroup"></span>\n                </div>\n                \x3c!--<div class="group">--\x3e\n                    \x3c!--<div class="elset">--\x3e\n                        \x3c!--<span class="btn-slot" id="slot-btn-show-details" style="width:auto;"></span>--\x3e\n                    \x3c!--</div>--\x3e\n                    \x3c!--<div class="elset">--\x3e\n                        \x3c!--<span class="btn-slot" id="slot-btn-hide-details" style="width:auto;"></span>--\x3e\n                    \x3c!--</div>--\x3e\n                \x3c!--</div>--\x3e\n            </section>\n        </section>\n    </section>\n</section>'}),define("text!spreadsheeteditor/main/app/template/ToolbarAnother.template",[],function(){return'<div class="toolbar" style="height: 41px; padding: 10px 0;">\n    <% if ( isEditDiagram ) { %>\n        \x3c!-----------------------\x3e\n        \x3c!-- Edit diagram mode --\x3e\n        \x3c!-----------------------\x3e\n        <section class="simple-bar">\n            <div class="group small">\n                <div class="elset">\n                    <span class="btn-slot split" id="slot-btn-copy"></span>\n                    <span class="btn-slot split" id="slot-btn-paste"></span>\n                    <span class="btn-slot split" id="slot-btn-undo"></span>\n                    <span class="btn-slot" id="slot-btn-redo"></span>\n                </div>\n            </div>\n            <div class="separator short"></div>\n            <div class="group small">\n                <div class="elset">\n                    <span class="btn-slot split" id="slot-btn-formula"></span>\n                </div>\n            </div>\n            <div class="separator short"></div>\n            <div class="group small">\n                <div class="elset">\n                    <span class="btn-slot split" id="slot-btn-digit-dec"></span>\n                    <span class="btn-slot split" id="slot-btn-digit-inc"></span>\n                    <span class="btn-slot" id="slot-btn-format" style="width: 80px; vertical-align: middle;"></span>\n                </div>\n            </div>\n            <div class="separator short"></div>\n            <div class="group small">\n                <div class="elset">\n                    <span class="btn-slot text" id="slot-btn-chart-data"></span>\n                    <span class="btn-slot text margin-left-12" id="slot-btn-chart-type"></span>\n                    <span class="btn-slot margin-left-12" id="slot-btn-chart" style="width: auto;"></span>\n                </div>\n            </div>\n            <div class="group" style="width: 100%;"></div>\n        </section>\n    <% } else if ( isEditMailMerge ) { %>\n        \x3c!-----------------------\x3e\n        \x3c!-- Edit mail merge mode --\x3e\n        \x3c!-----------------------\x3e\n        <section class="simple-bar">\n            <div class="group small">\n                <div class="elset">\n                    <span class="btn-slot split" id="slot-btn-copy"></span>\n                    <span class="btn-slot split" id="slot-btn-paste"></span>\n                    <span class="btn-slot split" id="slot-btn-undo"></span>\n                    <span class="btn-slot" id="slot-btn-redo"></span>\n                </div>\n            </div>\n            <div class="separator short"></div>\n            <div class="group small">\n                <div class="elset">\n                    <span class="btn-slot split" id="slot-btn-sortdesc"></span>\n                    <span class="btn-slot" id="slot-btn-sortasc"></span>\n                </div>\n            </div>\n            <div class="separator short"></div>\n            <div class="group small">\n                <div class="elset">\n                    <span class="btn-slot split" id="slot-btn-setfilter"></span>\n                    <span class="btn-slot" id="slot-btn-clear-filter"></span>\n                </div>\n            </div>\n            <div class="separator short"></div>\n            <div class="group small">\n                <div class="elset">\n                    <span class="btn-slot" id="slot-btn-search"></span>\n                </div>\n            </div>\n            <div class="group" style="width: 100%;"></div>\n        </section>\n    <% } else if ( isEditOle ) { %>\n        \x3c!-----------------------\x3e\n        \x3c!-- Edit ole object --\x3e\n        \x3c!-----------------------\x3e\n        <section class="simple-bar">\n            <div class="group small">\n                <div class="elset">\n                    <span class="btn-slot split-small" id="slot-btn-copy"></span>\n                    <span class="btn-slot split-small" id="slot-btn-paste"></span>\n                    <span class="btn-slot split-small" id="slot-btn-undo"></span>\n                    <span class="btn-slot" id="slot-btn-redo"></span>\n                </div>\n            </div>\n            <div class="separator short"></div>\n            <div class="group small">\n                <div class="elset" style="width: 172px;">\n                    <span class="btn-slot float-left" id="slot-field-fontname" style="width: 80px;"></span>\n                    <span class="btn-slot float-left margin-left-2" id="slot-field-fontsize" style="width: 35px;"></span>\n                    <span class="btn-slot split float-left margin-left-2" id="slot-btn-fontcolor" style="margin-top: 1px;"></span>\n                    <span class="btn-slot float-left margin-left-2" id="slot-btn-formatting" style="margin-top: 1px;"></span>\n                </div>\n            </div>\n            <div class="separator short"></div>\n            <div class="group small">\n                <div class="elset font-attr">\n                    <span class="btn-slot split" id="slot-btn-halign"></span>\n                    <span class="btn-slot split" id="slot-btn-valign"></span>\n                    <span class="btn-slot split-small" id="slot-btn-wrap"></span>\n                    <span class="btn-slot split" id="slot-btn-merge"></span>\n                </div>\n            </div>\n            <div class="separator short"></div>\n            <div class="group small">\n                <div class="elset font-attr">\n                    <span class="btn-slot split" id="slot-btn-borders"></span>\n                    <span class="btn-slot split" id="slot-btn-fillparag"></span>\n                    <span class="btn-slot split" id="slot-btn-table-tpl"></span>\n                    <span class="btn-slot split" id="slot-btn-cell-style"></span>\n                </div>\n            </div>\n            <div class="separator short"></div>\n            <div class="group small">\n                <div class="elset">\n                    <span class="btn-slot float-left" id="slot-btn-format" style="width: 80px;"></span>\n                </div>\n            </div>\n            <div class="separator short"></div>\n            <div class="group small">\n                <div class="elset">\n                    <span class="btn-slot split" id="slot-btn-formula"></span>\n                </div>\n            </div>\n            <div class="separator short"></div>\n            <div class="group small">\n                <div class="elset">\n                    <span class="btn-slot" id="slot-btn-search"></span>\n                </div>\n            </div>\n            <div class="group" style="width: 100%;padding-left: 0;"></div>\n            <div class="group small padding-right-10">\n                <div class="elset">\n                    <span class="btn-slot float-left" id="slot-btn-visible-area" style="width: auto;"></span>\n                    <span class="btn-slot float-left" id="slot-btn-visible-area-close" style="width: auto;"></span>\n                </div>\n            </div>\n        </section>\n    <% } %>\n</div>'}),define("text!spreadsheeteditor/main/app/template/ToolbarView.template",[],function(){return'<section class="toolbar toolbar-view">\n    <section class="box-tabs">\n        <div class="extra left"></div>\n        <%= tabsmarkup %>\n        <div class="extra right">\n        </div>\n    </section>\n    <section class="box-controls">\n        <section class="box-panels">\n        </section>\n    </section>\n</section>'}),void 0===Common&&(Common={}),Common.Models=Common.Models||{},define("common/main/lib/model/Font",["backbone"],function(t){"use strict";Common.Models.Font=t.Model.extend({defaults:function(){return{id:Common.UI.getId(),name:null,cloneid:null,imgidx:0,type:0}}})}),void 0===Common&&(Common={}),Common.Collections=Common.Collections||{},define("common/main/lib/collection/Fonts",["backbone","common/main/lib/model/Font"],function(t){"use strict";Common.Collections.Fonts=t.Collection.extend({model:Common.Models.Font})}),void 0===Common&&(Common={}),define("common/main/lib/component/ColorPalette",["common/main/lib/component/BaseView"],function(){"use strict";Common.UI.ColorPalette=Common.UI.BaseView.extend({options:{allowReselect:!0,cls:"",style:""},template:_.template(['<div class="palette-color">',"<% _.each(colors, function(color, index) { %>",'<span class="color-item" data-color="<%= color %>" style="background-color: #<%= color %>;"></span>',"<% }) %>","</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);this.id=this.options.id,this.cls=this.options.cls,this.style=this.options.style,this.colors=this.options.colors||[],this.value=this.options.value,this.options.el&&this.render()},render:function(t){return this.rendered?this.cmpEl=this.$el||$(this.el):(this.cmpEl=$(this.template({id:this.id,cls:this.cls,style:this.style,colors:this.colors})),(t?(this.setElement(t,!1),t):this.$el).html(this.cmpEl)),this.rendered||this.cmpEl.on("click","span.color-item",this.itemClick.bind(this)),this.rendered=!0,this},itemClick:function(t){t=$(t.target);this.select(t.attr("data-color"))},select:function(t,e){this.value!=t&&($("span.color-item",this.cmpEl).removeClass("selected"),(this.value=t)&&/#?[a-fA-F0-9]{6}/.test(t)&&(t=/#?([a-fA-F0-9]{6})/.exec(t)[1].toUpperCase(),$("span[data-color="+t+"]",this.cmpEl).addClass("selected"),e||this.trigger("select",this,this.value)))}})}),void 0===Common&&(Common={}),define("common/main/lib/component/DimensionPicker",["common/main/lib/component/BaseView"],function(){"use strict";Common.UI.DimensionPicker=Common.UI.BaseView.extend({options:{itemSize:20,minRows:5,minColumns:5,maxRows:20,maxColumns:20,direction:void 0},template:_.template(['<div style="width: 100%; height: 100%;">','<div dir="ltr" class="dimension-picker-status">0x0</div>','<div class="dimension-picker-observecontainer">','<div class="dimension-picker-mousecatcher"></div>','<div class="dimension-picker-unhighlighted"></div>','<div class="dimension-picker-highlighted"></div>',"</div>","</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);function e(t){var e;e="right"===o.direction&&o.areaMouseCatcher?(e=o.areaMouseCatcher.width(),void 0===t.offsetX?e-t.originalEvent.layerX:(e-t.offsetX)*Common.Utils.zoom()):void 0===t.offsetX?t.originalEvent.layerX:t.offsetX*Common.Utils.zoom(),o.setTableSize(Math.ceil(e/o.itemSize),Math.ceil((void 0===t.offsetY?t.originalEvent.layerY:t.offsetY*Common.Utils.zoom())/o.itemSize),t)}function i(t){o.setTableSize(0,0,t)}function s(t){o.trigger("select",o,o.curColumns,o.curRows,t)}var o=this,t=(this.render(),this.cmpEl=o.$el||$(this.el),this.cmpEl);o.itemSize=o.options.itemSize,o.minRows=o.options.minRows,o.minColumns=o.options.minColumns,o.maxRows=o.options.maxRows,o.maxColumns=o.options.maxColumns,o.direction=o.options.direction,Common.UI.isRTL()&&!o.direction&&(o.direction="right"),o.curColumns=0,o.curRows=0;t&&(o.areaMouseCatcher=t.find(".dimension-picker-mousecatcher"),o.areaUnHighLighted=t.find(".dimension-picker-unhighlighted"),o.areaHighLighted=t.find(".dimension-picker-highlighted"),o.areaStatus=t.find(".dimension-picker-status"),t.css({width:o.minColumns+"em"}),o.areaMouseCatcher.css("z-index",1),o.areaMouseCatcher.width(o.maxColumns+"em").height(o.maxRows+"em"),o.areaUnHighLighted.width(o.minColumns+"em").height(o.minRows+"em"),o.areaStatus.html(Common.UI.isRTL()?this.curRows+" x "+this.curColumns:this.curColumns+" x "+this.curRows),o.areaStatus.width(o.areaUnHighLighted.width()),o.areaMouseCatcher.on("mousemove",e),o.areaHighLighted.on("mousemove",e),o.areaUnHighLighted.on("mousemove",e),o.areaMouseCatcher.on("mouseleave",i),o.areaHighLighted.on("mouseleave",i),o.areaUnHighLighted.on("mouseleave",i),o.areaMouseCatcher.on("click",s),o.areaHighLighted.on("click",s),o.areaUnHighLighted.on("click",s),"right"===o.direction&&o.areaHighLighted.css({left:"auto",right:"0"}))},render:function(){return(this.$el||$(this.el)).html(this.template()),this},setTableSize:function(t,e,i){t>this.maxColumns&&(t=this.maxColumns),e>this.maxRows&&(e=this.maxRows),this.curColumns==t&&this.curRows==e||(this.curColumns=t,this.curRows=e,this.areaHighLighted.width(this.curColumns+"em").height(this.curRows+"em"),this.areaUnHighLighted.width((this.curColumns<this.minColumns?this.minColumns:this.curColumns+1>this.maxColumns?this.maxColumns:this.curColumns+1)+"em").height((this.curRows<this.minRows?this.minRows:this.curRows+1>this.maxRows?this.maxRows:this.curRows+1)+"em"),this.cmpEl.width(this.areaUnHighLighted.width()),this.areaStatus.html(Common.UI.isRTL()?this.curRows+" x "+this.curColumns:this.curColumns+" x "+this.curRows),this.areaStatus.width(this.areaUnHighLighted.width()),this.trigger("change",this,this.curColumns,this.curRows,i))},getColumnsCount:function(){return this.curColumns},getRowsCount:function(){return this.curRows}})}),void 0===Common&&(Common={}),define("common/main/lib/component/UpDownPicker",["common/main/lib/component/BaseView"],function(){"use strict";Common.UI.UpDownPicker=Common.UI.BaseView.extend({options:{caption:"",iconUpCls:"btn-zoomup",iconDownCls:"btn-zoomdown",minWidth:40},disabled:!1,template:_.template(['<label class="title float-left"><%= options.caption %></label>','<button type="button" class="btn small btn-toolbar updown-picker-button-up float-right"><i class="icon menu__icon <%= options.iconUpCls %>">&nbsp;</i></button>','<label class="updown-picker-value float-right" style="min-width: <%= options.minWidth %>px;"></label>','<button type="button" class="btn small btn-toolbar updown-picker-button-down float-right"><i class="icon menu__icon <%= options.iconDownCls %>">&nbsp;</i></button>'].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t),this.render(),this.cmpEl=this.$el||$(this.el),this.btnUp=new Common.UI.Button({el:this.cmpEl.find(".updown-picker-button-up")}).on("click",_.bind(function(){this.trigger("click","up")},this)),this.btnDown=new Common.UI.Button({el:this.cmpEl.find(".updown-picker-button-down")}).on("click",_.bind(function(){this.trigger("click","down")},this)),this.displayValue=this.cmpEl.find(".updown-picker-value"),this.options.disabled&&this.setDisabled(this.options.disabled)},render:function(){return(this.$el||$(this.el)).html($(this.template({options:this.options}))),this.rendered=!0,this},setValue:function(t){this.displayValue.html(t||"")},setDisabled:function(t){this.rendered&&((t=!0===t)!==this.disabled&&(this.btnUp.setDisabled(t),this.btnDown.setDisabled(t)),this.disabled=t)}})}),void 0===Common&&(Common={}),4),Common,Common,Common,c_paragraphLinerule=(define("common/main/lib/component/ComboBoxFonts",["common/main/lib/component/ComboBox"],function(){"use strict";Common.UI.ComboBoxFonts=Common.UI.ComboBox.extend(function(){for(var t,p=Asc.FONT_THUMBNAIL_HEIGHT||28,i=document.createElement("canvas"),s=i.getContext("2d"),o=[{ratio:1.5,path:"../../../../sdkjs/common/Images/fonts_thumbnail"+(/^(zh|ja|ko)$/i.test(Common.Locale.getCurrentLanguage())?"_ea":"")+"@1.5x.png",width:450,height:1.5*p}],n=0,h=1,e=Common.Utils.applicationPixelRatio(),a=Math.abs(e-o[0].ratio),l=1;l<o.length;l++)(t=Math.abs(e-o[l].ratio))<a-1e-4&&(a=t,n=l);function r(){this.supportBinaryFormat=!0,this.image=null,this.binaryFormat=null,this.data=null,this.width=0,this.height=0,this.heightOne=0,this.count=0,this.offsets=null,this.load=function(t,e){var i,s;e&&(this.supportBinaryFormat?(i=this,(s=new XMLHttpRequest).open("GET",t+".bin",!0),s.responseType="arraybuffer",s.overrideMimeType?s.overrideMimeType("text/plain; charset=x-user-defined"):s.setRequestHeader("Accept-Charset","x-user-defined"),s.onload=function(){i.binaryFormat=new Uint8Array(this.response),e()},s.send(null)):(this.width=o[n].width,this.heightOne=o[n].height,this.image=new Image,this.image.onload=e,this.image.src=o[n].path))},this.openBinary=function(t){var e=this.binaryFormat,i=(this.width=e[0]<<24|e[1]<<16|e[2]<<8|e[3]<<0,this.heightOne=e[4]<<24|e[5]<<16|e[6]<<8|e[7]<<0,this.count=e[8]<<24|e[9]<<16|e[10]<<8|e[11]<<0,this.height=this.count*this.heightOne,4*this.width*this.height),s=5e7<i,o=(s?this.offsets=new Array(this.count):this.data=new Uint8ClampedArray(i),12),n=e.length,a=0,l=0,r=0;if(s)for(var c=this.width*this.heightOne,d=c-1;o<n;)if(0==(r=e[o++]))for(l=e[o++];0<l;)l--,++d===c&&(this.offsets[a++]={pos:o,len:l+1},d=0);else++d===c&&(this.offsets[a++]={pos:o-1,len:-1},d=0);else for(var h=this.data;o<n;)if(0==(r=e[o++]))for(l=e[o++];0<l;)l--,h[a]=h[a+1]=h[a+2]=255,h[a+3]=0,a+=4;else h[a]=h[a+1]=h[a+2]=255-r,h[a+3]=r,a+=4;this.offsets||delete this.binaryFormat},this.getImage=function(t,e,i){if(this.supportBinaryFormat){this.data||this.offsets||this.openBinary(this.binaryFormat),e||((e=document.createElement("canvas")).width=this.width,e.height=this.heightOne,e.style.width="300px",e.style.height=p+"px",i=e.getContext("2d"));var s=i.createImageData(this.width,this.heightOne),o=4*this.width*this.heightOne;if(this.offsets){var n,a=this.binaryFormat,l=this.offsets[t].pos,r=0,c=this.width*this.heightOne,d=0,h=s.data;for(-1!=this.offsets[t].len&&(r+=4*this.offsets[t].len);0<c;)if(0==(n=a[l++]))for(c<(d=a[l++])&&(d=c);0<d;)d--,h[r]=h[r+1]=h[r+2]=255,h[r+3]=0,r+=4,c--;else h[r]=h[r+1]=h[r+2]=255-n,h[r+3]=n,r+=4,c--}else s.data.set(new Uint8ClampedArray(this.data.buffer,t*o,o));i.putImageData(s,0,0)}else e||((e=document.createElement("canvas")).width=this.width,e.height=this.heightOne,e.style.width="300px",e.style.height=p+"px",i=e.getContext("2d")),i.clearRect(0,0,this.width,this.heightOne),i.drawImage(this.image,0,-this.heightOne*t);return e}}return i.height=o[n].height,i.width=o[n].width,{template:_.template(['<div class="input-group combobox fonts <%= cls %>" id="<%= id %>" style="<%= style %>">','<input type="text" class="form-control" spellcheck="false" data-hint="<%= dataHint %>" data-hint-direction="<%= dataHintDirection %>"> ','<div style="display: table-cell;"></div>','<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown"><span class="caret"></span></button>','<ul class="dropdown-menu <%= menuCls %>" style="<%= menuStyle %>" role="menu">','<li class="divider">',"<% _.each(items, function(item) { %>",'<li id="<%= item.id %>">','<a class="font-item" tabindex="-1" type="menuitem" style="height:<%=scope.getListItemHeight()%>px;"></a>',"</li>","<% }); %>","</ul>","</div>"].join("")),initialize:function(t){Common.UI.ComboBox.prototype.initialize.call(this,_.extend(t,{displayField:"name",scroller:{wheelSpeed:20,alwaysVisibleY:!0,onChange:this.updateVisibleFontsTiles.bind(this)}})),this.recent=_.isNumber(t.recent)?t.recent:5;t=Common.localStorage.getKeysFilter();this.appPrefix=t&&t.length?t.split(",")[0]:"",Common.NotificationCenter.on("fonts:load",_.bind(this.fillFonts,this))},render:function(t){var e=null,i="";return _.isUndefined(this._input)||(e=this._input.val(),i=this._input.attr("tabindex")),Common.UI.ComboBox.prototype.render.call(this,t),this.setRawValue(e),this._input.attr("tabindex",i),this._input.on("keyup",_.bind(this.onInputKeyUp,this)),this._input.on("keydown",_.bind(this.onInputKeyDown,this)),this._input.on("focus",_.bind(function(){this.inFormControl=!0},this)),this._input.on("blur",_.bind(function(){this.inFormControl=!1},this)),this},onAfterKeydownMenu:function(t){var e=this;if(t.keyCode==Common.UI.Keys.RETURN){if($(t.target).closest("input").length){if(this.lastValue===this._input.val())return!0;this._input.trigger("change")}else $(t.target).click(),this.rendered&&(Common.Utils.isIE?this._input.trigger("change",{onkeydown:!0}):this._input.blur());return!1}if(t.keyCode==Common.UI.Keys.ESC&&this.isMenuOpen())return this._input.val(this.lastValue),setTimeout(function(){e.closeMenu(),e.onAfterHideMenu(t)},10),!1;(t.keyCode==Common.UI.Keys.HOME&&!t.shiftKey||t.keyCode==Common.UI.Keys.END&&!t.shiftKey||t.keyCode==Common.UI.Keys.BACKSPACE&&!e._input.is(":focus"))&&this.isMenuOpen()&&(e._input.focus(),setTimeout(function(){e._input[0].selectionStart=e._input[0].selectionEnd=t.keyCode==Common.UI.Keys.HOME?0:e._input[0].value.length},10)),this.updateVisibleFontsTiles()},onInputKeyUp:function(t){var s;this._isKeyDown&&(t.keyCode!=Common.UI.Keys.RETURN&&t.keyCode!==Common.UI.Keys.SHIFT&&t.keyCode!==Common.UI.Keys.CTRL&&t.keyCode!==Common.UI.Keys.ALT&&t.keyCode!==Common.UI.Keys.LEFT&&t.keyCode!==Common.UI.Keys.RIGHT&&t.keyCode!==Common.UI.Keys.HOME&&t.keyCode!==Common.UI.Keys.END&&t.keyCode!==Common.UI.Keys.ESC&&t.keyCode!==Common.UI.Keys.INSERT&&t.keyCode!==Common.UI.Keys.TAB&&(t.stopPropagation(),this.selectCandidate(t.keyCode==Common.UI.Keys.DELETE||t.keyCode==Common.UI.Keys.BACKSPACE),this._selectedItem&&void 0===(s=this)._timerSelection&&(s._timerSelection=setInterval(function(){var t,e,i;new Date-s._inInputKeyDown<100||!s._selectedItem||(clearInterval(s._timerSelection),s._timerSelection=void 0,t=s._input[0],e=s._selectedItem.get(s.displayField),i=t.value,s.rendered&&(document.selection?document.selection.createRange().text=e:!t.selectionStart&&"0"!=t.selectionStart||(t.value=e,t.selectionStart=i.length,t.selectionEnd=e.length)))},10))),this._isKeyDown=!1)},onInputKeyDown:function(e){this._isKeyDown=!0,this._inInputKeyDown=new Date;var i=this;e.keyCode==Common.UI.Keys.ESC?(this._input.val(this.lastValue),setTimeout(function(){i.closeMenu(),i.onAfterHideMenu(e)},10)):e.keyCode!=Common.UI.Keys.RETURN&&e.keyCode!=Common.UI.Keys.CTRL&&e.keyCode!=Common.UI.Keys.SHIFT&&e.keyCode!=Common.UI.Keys.ALT&&e.keyCode!=Common.UI.Keys.TAB?(this.isMenuOpen()||e.ctrlKey||(this.openMenu(),0<this.recent&&this.flushVisibleFontsTiles()),e.keyCode==Common.UI.Keys.UP||e.keyCode==Common.UI.Keys.DOWN?_.delay(function(){var t=e.keyCode==Common.UI.Keys.DOWN?i.cmpEl.find("ul li.selected").nextAll("li:not(.divider)"):i.cmpEl.find("ul li.selected").prevAll("li:not(.divider)");t=(t=0<t.length?t.eq(0):e.keyCode==Common.UI.Keys.DOWN?i.cmpEl.find("ul li:not(.divider):first"):i.cmpEl.find("ul li:not(.divider):last")).find("a"),i._skipInputChange=!0,t.focus(),i.updateVisibleFontsTiles()},10):i._skipInputChange=!1):e.keyCode==Common.UI.Keys.RETURN&&this._input.val()===i.lastValue&&this._input.trigger("change",{reapply:!0})},onInputChanged:function(t,e){var i,s;e&&e.synthetic||(this._skipInputChange?this._skipInputChange=!1:this._isMouseDownMenu?this._isMouseDownMenu=!1:(i=$(t.target).val(),s={},this.lastValue!==i||e&&e.reapply?(s[this.valueField]=i,s[this.displayField]=i,this.trigger("changed:before",this,s,t),t.isDefaultPrevented()||(this._selectedItem?(s[this.valueField]=this._selectedItem.get(this.displayField),this.setRawValue(s[this.valueField]),this.trigger("selected",this,_.extend({},this._selectedItem.toJSON()),t),this.addItemToRecent(this._selectedItem)):(this.setRawValue(s[this.valueField]),s.isNewFont=!0,this.trigger("selected",this,s,t)),this.closeMenu(),this.trigger("changed:after",this,s,t))):e&&e.onkeydown&&this.trigger("combo:blur",this,t)))},getImageUri:function(t){var e;return t.cloneid?null!=(e=$(this.el).find("ul > li#"+t.cloneid+" img"))?e[0].src:void 0:(e=Math.floor(t.imgidx/h),this.spriteThumbs.getImage(e,i,s).toDataURL())},getImageWidth:function(){return 300},getImageHeight:function(){return p},getListItemHeight:function(){return 28},loadSprite:function(t){this.spriteThumbs=new r,this.spriteThumbs.load(o[n].path,t)},fillFonts:function(e,t){var i=this;this.loadSprite(function(){var t;h=Math.floor(i.spriteThumbs.width/o[n].width)||1,i.store.set(e.toJSON()),i.rendered=!1,_.isUndefined(i.scroller)||(i.scroller.destroy(),delete i.scroller),i._scrollerIsInited=!1,i.render($(i.el)),i._fontsArray=i.store.toJSON(),0<i.recent&&(i.store.on("add",i.onInsertItem,i),i.store.on("remove",i.onRemoveItem,i),Common.Utils.InternalSettings.set(i.appPrefix+"-settings-recent-fonts",Common.localStorage.getItem(i.appPrefix+"-settings-recent-fonts")),(t=(t=Common.Utils.InternalSettings.get(i.appPrefix+"-settings-recent-fonts"))?t.split(";"):[]).reverse().forEach(function(t){t&&i.addItemToRecent(i.store.findWhere({name:t}),!0)}))})},onApiChangeFont:function(t){var e=this,t=_.isFunction(t.get_Name)?t.get_Name():t.asc_getFontName();this.__name!==t&&(this.__name=t,this.__nameId||(this.__nameId=setTimeout(function(){e.onApiChangeFontInternal(e.__name),e.__nameId=null},100)))},onApiChangeFontInternal:function(t){var e,i;this.inFormControl||this.getRawValue()!==t&&(e=this.store.findWhere({name:t}),$(".selected",$(this.el)).removeClass("selected"),e?(this.setRawValue(e.get(this.displayField)),e=$("#"+e.get("id"),$(this.el)),i=$("ul.dropdown-menu",this.cmpEl),e&&i&&(e.addClass("selected"),this.recent<=0&&i.scrollTop(e.offset().top-i.offset().top))):this.setRawValue(t))},itemClicked:function(t){this.__name=void 0,this.__nameId&&(clearTimeout(this.__nameId),this.__nameId=void 0),Common.UI.ComboBox.prototype.itemClicked.apply(this,arguments);t=$(t.target).closest("li"),t=this.store.findWhere({id:t.attr("id")});this.addItemToRecent(t)},onInsertItem:function(t){$(this.el).find("ul").prepend(_.template(['<li id="<%= item.id %>">','<a class="font-item" tabindex="-1" type="menuitem" style="height:<%=scope.getListItemHeight()%>px;"></a>',"</li>"].join(""))({item:t.attributes,scope:this}))},onRemoveItem:function(t,e,i){$(this.el).find("ul > li#"+t.id).remove()},onBeforeShowMenu:function(t){this.store.length<1?t.preventDefault():(Common.UI.ComboBox.prototype.onBeforeShowMenu.apply(this,arguments),!this.getSelectedRecord()&&this.getRawValue()&&(t=this.store.where({name:this.getRawValue()}))&&t.length&&this.selectRecord(t[t.length-1]))},onAfterShowMenu:function(t){this.alignMenuPosition(),0<this.recent?(this.scroller&&!this._scrollerIsInited&&(this.scroller.update(),this._scrollerIsInited=!0),$(this.el).find("ul").scrollTop(0),this.trigger("show:after",this,t),this.flushVisibleFontsTiles(),this.updateVisibleFontsTiles(null,0),Common.Utils.isGecko&&this.scroller&&this.scroller.update()):Common.UI.ComboBox.prototype.onAfterShowMenu.apply(this,arguments)},onAfterHideMenu:function(t){this.lastValue!==this._input.val()&&this._input.val(this.lastValue),Common.UI.ComboBox.prototype.onAfterHideMenu.apply(this,arguments)},addItemToRecent:function(t,e){var i,s;!t||this.recent<1||((i=this.store.findWhere({name:t.get("name"),type:FONT_TYPE_RECENT}))&&this.store.remove(i),(i=this.store.where({type:FONT_TYPE_RECENT})).length<this.recent||this.store.remove(i[this.recent-1]),(i=t.clone()).set({type:FONT_TYPE_RECENT,id:Common.UI.getId(),cloneid:t.id}),this.store.add(i,{at:0}),e||(s=[],this.store.where({type:FONT_TYPE_RECENT}).forEach(function(t){s.push(t.get("name"))}),s=s.join(";"),Common.localStorage.setItem(this.appPrefix+"-settings-recent-fonts",s),Common.Utils.InternalSettings.set(this.appPrefix+"-settings-recent-fonts",s)))},selectCandidate:function(e){var t,i,s=this,o=this._input.val().toLowerCase(),n=(this._fontsArray||(this._fontsArray=this.store.toJSON()),_.find(this._fontsArray,function(t){return e?t[s.displayField].toLowerCase()==o:0==t[s.displayField].toLowerCase().indexOf(o)}));this._selectedItem=n?this.store.findWhere({id:n.id}):null,$(".selected",$(this.el)).removeClass("selected"),this._selectedItem&&(n=$("#"+this._selectedItem.get("id"),$(this.el)),t=$("ul[role=menu]",$(this.el)),0<n.length&&0<t.length&&(n.addClass("selected"),n=n.position().top,i=t.scrollTop(),0!=n&&t.scrollTop(i+n)))},updateVisibleFontsTiles:function(t,e){var i=this,s=0,o=i.store.length,n=0;if(i.tiles||(i.tiles=[]),o!==i.tiles.length)for(s=i.tiles.length;s<o;++s)i.tiles.unshift(null);_.isUndefined(e)&&(e=parseInt($(i.el).find(".ps-scrollbar-x-rail").css("bottom")));for(var a,l=$(i.el).find(".dropdown-menu").height(),l=Math.max(Math.floor(l/28)+3,0),r=Math.max(Math.floor(-e/28)-1,0),c=r+l,d=$(i.el).find("a"),s=0;s<o;++s)r<=s&&s<c?null===i.tiles[s]&&(n=Math.floor(i.store.at(s).get("imgidx")/h),a=i.spriteThumbs.getImage(n),i.tiles[s]=a,$(d[s]).get(0).appendChild(a)):i.tiles[s]&&(i.tiles[s].parentNode.removeChild(i.tiles[s]),i.tiles[s]=null)},flushVisibleFontsTiles:function(){for(var t=this.tiles.length-1;0<=t;--t)this.tiles[t]&&(this.tiles[t].parentNode.removeChild(this.tiles[t]),this.tiles[t]=null)}}}())}),void 0===Common&&(Common={}),define("common/main/lib/component/SynchronizeTip",["common/main/lib/component/BaseView"],function(){"use strict";Common.UI.SynchronizeTip=Common.UI.BaseView.extend(_.extend({options:{target:$(document.body),text:"",placement:"right-bottom",showLink:!0,showButton:!1,closable:!0},template:_.template(['<div class="synch-tip-root <% if (!!scope.options.extCls) {print(scope.options.extCls + " ");} %><%= scope.placement %>" style="<%= scope.style %>">','<div class="asc-synchronizetip">','<div class="tip-arrow <%= scope.placement %>"></div>',"<div>",'<div class="tip-text"><%= scope.text %></div>',"<% if ( scope.closable ) { %>",'<div class="close"></div>',"<% } %>","</div>","<% if ( scope.showLink ) { %>",'<div class="show-link"><label><%= scope.textLink %></label></div>',"<% } %>","<% if ( scope.showButton ) { %>",'<div class="btn-div"><%= scope.textButton %></div>',"<% } %>","</div>","</div>"].join("")),initialize:function(t){this.textSynchronize+=Common.Utils.String.platformKey("Ctrl+S"),Common.UI.BaseView.prototype.initialize.call(this,t),this.target=this.options.target,this.text=_.isEmpty(this.options.text)?this.textSynchronize:this.options.text,this.textLink=_.isEmpty(this.options.textLink)?this.textDontShow:this.options.textLink,this.placement=this.options.placement,this.showLink=this.options.showLink,this.showButton=this.options.showButton,this.closable=this.options.closable,this.textButton=this.options.textButton||"",this.position=this.options.position,this.style=this.options.style||""},render:function(){return this.cmpEl||(this.cmpEl=$(this.template({scope:this})),$(document.body).append(this.cmpEl),this.cmpEl.find(".close").on("click",_.bind(function(){this.trigger("closeclick")},this)),this.cmpEl.find(".show-link label").on("click",_.bind(function(){this.trigger("dontshowclick")},this)),this.cmpEl.find(".btn-div").on("click",_.bind(function(){this.trigger("buttonclick")},this)),this.closable&&this.cmpEl.addClass("closable")),this.applyPlacement(),this},show:function(){this.cmpEl?(this.applyPlacement(),this.cmpEl.show()):this.render()},hide:function(){this.cmpEl&&this.cmpEl.hide(),this.trigger("hide")},close:function(){this.cmpEl&&this.cmpEl.remove()},applyPlacement:function(){var t,e,i,s,o,n,a=this.target&&0<this.target.length?this.target:$(document.body),l=a.offset();"target"!=this.placement||this.position?this.position&&"object"==typeof this.position?(t=this.position.top,e=this.position.left,i=this.position.bottom,s=this.position.right,void 0!==i||void 0!==t?e=l.left+(a.width()-this.cmpEl.width())/2:t=l.top+(a.height()-this.cmpEl.height())/2,this.cmpEl.css({top:t=void 0!==t?t+"px":"auto",left:e=void 0!==e?e+"px":"auto",right:s=void 0!==s?s+"px":"auto",bottom:i=void 0!==i?i+"px":"auto"})):0<(n=this.placement.split("-")).length&&("top"==(o=n[0])?i=Common.Utils.innerHeight()-l.top:"bottom"==o?t=l.top+a.height():"left"==o?s=Common.Utils.innerWidth()-l.left:"right"==o&&(e=l.left+a.width()),"top"==(o=n[1])?i=Common.Utils.innerHeight()-l.top-a.height()/2:"bottom"==o?(t=l.top+a.height()/2)+(n=this.cmpEl.height())>Common.Utils.innerHeight()&&(t=Common.Utils.innerHeight()-n-10):"left"==o?s=Common.Utils.innerWidth()-l.left-a.width()/2:"right"==o?e=l.left+a.width()/2:void 0!==i||void 0!==t?e=l.left+(a.width()-this.cmpEl.width())/2:t=l.top+(a.height()-this.cmpEl.height())/2,t=void 0!==t?t+"px":"auto",i=void 0!==i?i+"px":"auto",s=void 0!==s?s+"px":"auto",void 0!==e?(e+(n=this.cmpEl.width())>Common.Utils.innerWidth()&&(e=Common.Utils.innerWidth()-n-10),e+="px"):e="auto",this.cmpEl.css({top:t,left:e,right:s,bottom:i})):this.cmpEl.css({top:l.top+5+"px",left:l.left+5+"px"})},isVisible:function(){return this.cmpEl&&this.cmpEl.is(":visible")},textDontShow:"Don't show this message again",textSynchronize:"The document has been changed by another user.<br>Please click to save your changes and reload the updates."},Common.UI.SynchronizeTip||{})),Common.UI.TooltipManager=new function(){function o(t){return a[t]&&!(a[t].name&&Common.localStorage.getItem(a[t].name))}function n(t){if(a[t]){if(o(t)&&(!a[t].prev||!o(a[t].prev))){var e=a[t],i=e.target;if(e.tip&&e.tip.isVisible())return!0;if(!((i="string"==typeof i?$(i):i)&&i.length&&i.is(":visible")))return!1;var s=e.placement;Common.UI.isRTL()&&(s=-1<s.indexOf("right")?s.replace("right","left"):s.replace("left","right")),i.addClass("highlight-tip"),e.tip=new Common.UI.SynchronizeTip({extCls:"colored",style:"min-width:200px;max-width:"+(e.maxwidth||250)+"px;",placement:s,target:i,text:e.text,textHeader:e.header,showLink:!!e.link,textLink:e.link?e.link.text:"",closable:!1!==e.closable,showButton:!1!==e.showButton,automove:!!e.automove}),e.tip.on({buttonclick:function(){e.tip&&e.tip.close(),e.tip=void 0},closeclick:function(){e.tip&&e.tip.close(),e.tip=void 0},dontshowclick:function(){Common.NotificationCenter.trigger("file:help",e.link.src)},close:function(){i.removeClass("highlight-tip"),e.name&&Common.localStorage.setItem(e.name,1),e.callback&&e.callback(),e.next&&n(e.next),delete a[t]}}),e.tip.show()}return!0}}var a={};return{showTip:n,closeTip:function(t,e,i){t=a[t];t&&(i&&(t.next=void 0),t.tip&&t.tip.close(),t.tip=void 0,e&&t.name&&Common.localStorage.setItem(t.name,1))},addTips:function(t){for(var e in t)t.hasOwnProperty(e)&&!Common.localStorage.getItem(t[e].name)&&(a[e]=t[e])},getNeedShow:o}}}),define("common/main/lib/component/Mixtbar",["backbone","common/main/lib/component/BaseView"],function(t){"use strict";function i(){var t=a.scrollLeft();o.toggleClass("disabled",0==t),n.toggleClass("disabled",Math.round(t)==a[0].scrollWidth-a[0].clientWidth)}function e(t,e){$(e.target).hasClass("disabled")||((e=a.scrollLeft())||"right"==t||Common.UI.isRTL()&&"left"==t)&&a.animate({scrollLeft:"left"==t?e-100:e+100},200,i)}function s(t){t.preventDefault(),t=t.deltaX||t.detail||t.deltaY,a.scrollLeft(a.scrollLeft()+60*t),i()}var a,o,n,l,r,c;Common.UI.Mixtbar=Common.UI.BaseView.extend((l={timeout:2e3},r={},{$tabs:void 0,$panels:void 0,isFolded:!(c=[]),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);var e=Common.UI.isRTL()?'<section class="tabs"><a class="scroll right" data-hint="0" data-hint-direction="bottom" data-hint-offset="-7, 0" data-hint-title="R"></a><ul><% for(var i in items) { %><% if (typeof items[i] == "object") { %><li class="ribtab<% if (items[i].haspanel===false) print(" x-lone") %><% if (items[i].extcls) print(\' \' + items[i].extcls) %>"<% if (typeof items[i].layoutname == "string") print(" data-layout-name=" + \' \' +  items[i].layoutname) + \' \' %>><a data-tab="<%= items[i].action %>" data-title="<%= items[i].caption %>" data-hint="0" data-hint-direction="bottom" data-hint-offset="small" <% if (typeof items[i].dataHintTitle !== "undefined") { %> data-hint-title="<%= items[i].dataHintTitle %>" <% } %>><%= items[i].caption %></a></li><% } %><% } %></ul><a class="scroll left" data-hint="0" data-hint-direction="bottom" data-hint-offset="-7, 0" data-hint-title="V"></a></section>':'<section class="tabs"><a class="scroll left" data-hint="0" data-hint-direction="bottom" data-hint-offset="-7, 0" data-hint-title="V"></a><ul><% for(var i in items) { %><% if (typeof items[i] == "object") { %><li class="ribtab<% if (items[i].haspanel===false) print(" x-lone") %><% if (items[i].extcls) print(\' \' + items[i].extcls) %>"<% if (typeof items[i].layoutname == "string") print(" data-layout-name=" + \' \' +  items[i].layoutname) + \' \' %>><a data-tab="<%= items[i].action %>" data-title="<%= items[i].caption %>" data-hint="0" data-hint-direction="bottom" data-hint-offset="small" <% if (typeof items[i].dataHintTitle !== "undefined") { %> data-hint-title="<%= items[i].dataHintTitle %>" <% } %>><%= items[i].caption %></a></li><% } %><% } %></ul><a class="scroll right" data-hint="0" data-hint-direction="bottom" data-hint-offset="-7, 0" data-hint-title="R"></a></section>';this.$layout=$(t.template({tabsmarkup:_.template(e)({items:t.tabs}),isRTL:Common.UI.isRTL()})),r.tabs=t.tabs,$(document.body).on("click",function(t){!this.isFolded||$(t.target).parents(".toolbar, #file-menu-panel").length||l.$bar&&l.$bar.hasClass("expanded")&&this.collapse()}.bind(this)),Common.NotificationCenter.on("tab:visible",_.bind(function(t,e){this.setVisible(t,e)},this)),Common.NotificationCenter.on("tab:resize",_.bind(this.onResizeTabs,this))},afterRender:function(){var t=this;a=t.$(".tabs > ul"),t.$tabs=a.find("> li"),t.$boxpanels=t.$(".box-panels"),t.$panels=t.$boxpanels.find("> .panel"),l.$bar=t.$(".toolbar"),n=t.$(".tabs .scroll.right"),(o=t.$(".tabs .scroll.left")).on("click",e.bind(this,"left")),n.on("click",e.bind(this,"right")),a.on("dblclick","> .ribtab",function(t){t=$(t.currentTarget).find("> a[data-tab]").data("tab"),this.dblclick_el==t&&(this.fireEvent("change:compact",[t]),this.dblclick_el=void 0)}.bind(this)),a.on("click","> .ribtab",t.onTabClick.bind(this)),a.on("mousewheel",s)},isTabActive:function(t){var e=this.$tabs.filter(".active").find("> a");return e.length&&e.data("tab")==t},setFolded:function(t){this.isFolded=t;var e;this.isFolded?(l.$box||(l.$box=this.$el.find(".box-controls")),l.$bar.addClass("folded z-clear").toggleClass("expanded",!1),l.$bar.find(".tabs .ribtab").removeClass("active"),l.$bar.on($.support.transition.end,function(t){l.$bar.hasClass("folded")&&!l.$bar.hasClass("expanded")&&l.$bar.toggleClass("z-clear",!0)}),l.$box.on({mouseleave:function(t){},mouseenter:function(t){}})):(l.$bar.removeClass("folded z-clear"),l.$box.off(),(t=l.$box.find(".panel.active")).length?(e=t.data("tab"),this.$tabs.find("> a[data-tab="+e+"]").parent().toggleClass("active",!0)):(e=this.$tabs.siblings(":not(.x-lone):visible").first().find("> a[data-tab]").data("tab"),this.setTab(e)))},collapse:function(){Common.UI.Menu.Manager.hideAll(),this.isFolded&&l.$bar&&(l.$bar.removeClass("expanded"),l.$bar.find(".tabs .ribtab").removeClass("active"))},expand:function(){l.$bar.removeClass("z-clear"),l.$bar.addClass("expanded")},onResizeTabs:function(t){this.hasTabInvisible()?a.parent().hasClass("short")||(a.parent().addClass("short"),i()):a.parent().hasClass("short")&&a.parent().removeClass("short")},onResize:function(t){this.onResizeTabs(),this.hideMoreBtns(),this.processPanelVisible()},onTabClick:function(t){var e=this,t=$(t.currentTarget),i=t.find("> a[data-tab]").data("tab");t.hasClass("x-lone")?e.isFolded&&e.collapse():t.hasClass("active")?e._timerSetTab||(e.dblclick_el=i,e.isFolded&&(e.collapse(),setTimeout(function(){e.dblclick_el=void 0},500))):(e._timerSetTab=!0,setTimeout(function(){e._timerSetTab=!1},500),e.setTab(i),e.isFolded?e.dblclick_el=i:(e.dblclick_timer&&clearTimeout(e.dblclick_timer),e.dblclick_timer=setTimeout(function(){e.dblclick_el=i,delete e.dblclick_timer},500)))},setTab:function(t){var e;t||(this.isFolded?this.collapse():t=this.lastPanel),t&&(this.$tabs.removeClass("active"),this.$panels.removeClass("active"),this.hideMoreBtns(),(e=this.$panels.filter("[data-tab="+t+"]")).length&&(this.lastPanel=t,e.addClass("active"),this.setMoreButton(t,e),this.processPanelVisible(null,!0,!0)),e.length?this.isFolded&&this.expand():this.isFolded&&this.collapse(),(e=this.$tabs.find("> a[data-tab="+t+"]").parent()).length&&e.addClass("active"),this.fireEvent("tab:active",[t]))},addTab:function(t,e,i){var s=_.template('<li class="ribtab" style="display: none;" <% if (typeof layoutname == "string") print(" data-layout-name=" + \' \' +  layoutname) + \' \' %>><a data-tab="<%= action %>" data-title="<%= caption %>" data-hint="0" data-hint-direction="bottom" data-hint-offset="small" <% if (typeof dataHintTitle !== "undefined") { %> data-hint-title="<%= dataHintTitle %>" <% } %> ><%= caption %></a></li>'),i=(r.tabs[i+1]=t,function t(e){return r.tabs[e]?r.tabs[e].action:t(--e)}(i)),o=this.$tabs||this.$layout.find(".tabs"),n=o.find("a[data-tab="+i+"]");n.length&&(n.parent().after(s(t)),e&&((n=(o=this.$panels||this.$layout.find(".box-panels > .panel")).filter("[data-tab="+i+"]")).length?n.after(e):e.appendTo(this.$layout.find(".box-panels"))),this.$tabs&&(this.$tabs=a.find("> li")),this.$panels&&(this.$panels=this.$el.find(".box-panels > .panel")))},isCompact:function(){return this.isFolded},hasTabInvisible:function(){var t,e,i,s;return!(a.length<1)&&(t=Math.round(a.offset().left),e=Math.round(t+a.width()),!!(i=this.$tabs.filter(Common.UI.isRTL()?":visible:last":":visible:first").get(0))&&(s=i.getBoundingClientRect(),Math.round(s.left)<t||(s=(i=this.$tabs.filter(Common.UI.isRTL()?":visible:first":":visible:last").get(0)).getBoundingClientRect(),Math.round(s.right)>e)))},processPanelVisible:function(h,t,p){var m=this;function e(){var t=h||m.$panels.filter(".active");if(t&&t.length){var e=t.parents(".box-controls").width(),i=(i=t.parents(".box-controls").find(".panel.static").outerWidth())||0,s=t.data(),o=s.rightedge,n=s.buttons,a=s.flex,l=t.find(".more-box");if(0===l.length&&m.setMoreButton(t.attr("data-tab"),t),o=o||t.outerWidth()+i,n||(n=[],_.each(t.find(".btn-slot .x-huge"),function(t){n.push($(t).closest(".btn-slot"))}),s.buttons=n),a||(a=[],_.each(t.find(".group.flex"),function(t){t=$(t);a.push({el:t,width:t.attr("data-group-width")||t.attr("max-width")})}),s.flex=a),e<o){if(!l.is(":visible")){if(0<a.length)for(var r=0;r<a.length;r++){var c=a[r].el,o=t.outerWidth()+i;if(Math.floor(c.outerWidth())>parseInt(c.css("min-width")))return void(s.rightedge=o);c.css("width",c.css("min-width"))}for(r=n.length-1;0<=r;r--){var d=n[r];if(!d.hasClass("compactwidth")&&!d.hasClass("slot-btn-more")&&(d.addClass("compactwidth"),(o=t.outerWidth()+i)<=e))break}s.rightedge=o}m.resizeToolbar(p)}else if(l.is(":visible")&&m.resizeToolbar(p),!l.is(":visible")){for(r=0;r<n.length;r++){d=n[r];if(d.hasClass("compactwidth")&&(d.removeClass("compactwidth"),e<(o=t.outerWidth()+i))){d.addClass("compactwidth"),o=t.outerWidth()+i;break}}if(s.rightedge=o,0<a.length&&t.find(".btn-slot.compactwidth").length<1)for(r=0;r<a.length;r++)(c=a[r]).el.css("width",c.width),s.rightedge=t.get(0).getBoundingClientRect().right}}}m._timer_id&&clearTimeout(m._timer_id),!0===t?e():m._timer_id=setTimeout(function(){delete m._timer_id,e()},100)},setExtra:function(t,e){!e||this.$tabs||("right"==t?this.$layout.find(".extra.right").html(e):"left"==t&&this.$layout.find(".extra.left").html(e))},setVisible:function(t,e){t&&this.$tabs&&(this.$tabs.find("> a[data-tab="+t+"]").parent().css("display",e?"":"none"),this.onResize())},setMoreButton:function(t,e){var i,s=this;c[t]||(i=e.position().top,i=$('<div class="more-box" style="top:'+i+'px;"><div class="separator long" style="position: relative;display: table-cell;"></div><div class="group" style=""><span class="btn-slot text x-huge slot-btn-more"></span></div></div>'),e.append(i),c[t]=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top dropdown-manual",caption:Common.Locale.get("textMoreButton",{name:"Common.Translation",default:"More"}),iconCls:"toolbar__icon btn-more",enableToggle:!0}),c[t].render(i.find(".slot-btn-more")),c[t].on("toggle",function(t,e,i){e?s.onMoreShow(t,i):s.onMoreHide(t,i),Common.NotificationCenter.trigger("more:toggle",t,e)}),e=$('<div class="dropdown-menu more-container" data-tab="'+t+'"><div style="display: inline;"></div></div>'),l.$bar.append(e),c[t].panel=e.find("div")),this.$moreBar=c[t].panel},clearMoreButton:function(t){var e,i=this.$panels.filter("[data-tab="+t+"]");i.length&&((e=i.data()).buttons=e.flex=e.rightedge=e.leftedge=void 0,i.find(".more-box").remove()),c[t]&&(l.$bar.find('.more-container[data-tab="'+t+'"]').remove(),c[t].remove(),delete c[t])},resizeToolbar:function(t){var e=this.$panels.filter(".active"),i=e.find(".more-box"),s=(0===i.length&&this.setMoreButton(e.attr("data-tab"),e),parseInt(i.css("width"))||0),o=e.parents(".box-controls").width(),n=o,a=(a=e.parents(".box-controls").find(".panel.static").outerWidth())||0,l=e.outerWidth()+a,r=this._prevBoxWidth?n-this._prevBoxWidth:-1,c=!1;if(this._prevBoxWidth=n,i.is(":visible")&&(n-=s),this.$moreBar&&this.$moreBar.parent().is(":visible")&&this.$moreBar.parent().css("max-width",Common.Utils.innerWidth()),(t||r<0)&&n<l){i.is(":visible")||(i.css("display","block"),n-=parseInt(i.css("width")));var d=null,h=null;0<(_=this.$moreBar.children().filter("[data-hidden-tb-item!=true]")).length&&((_=$(_[0])).hasClass("separator")&&(d=_),_.hasClass("group")&&"open"==_.attr("group-state")&&(h=_));for(var p=!1,m=(x=e.find("> div:not(.more-box)")).length-1;0<=m;m--)if((A=$(x[m])).is(":visible")||A.attr("hidden-on-resize"))if(A.hasClass("group")){if((l=e.outerWidth()+a)<=n)break;var u=A.get(0).getBoundingClientRect(),g=A.outerWidth(),b=A.children();if(!A.attr("inner-width")&&"open"!==A.attr("group-state")){A.attr("inner-width",g);for(var C=b.length-1;0<=C;C--)(k=$(b[C])).attr("inner-width",k.outerWidth())}if((u.left>n||Common.UI.isRTL()&&o-u.right>n||1==b.length)&&"open"!=A.attr("group-state"))this.$moreBar.prepend(A),d&&(d.css("display",""),d.removeAttr("hidden-on-resize")),c=!0;else{if(!((Common.UI.isRTL()?o-u.right:u.left)+g>n))break;for(C=b.length-1;0<=C;C--){if((k=$(b[C])).hasClass("elset")){this.$moreBar.prepend(A),d&&(d.css("display",""),d.removeAttr("hidden-on-resize")),c=!0;break}var f=k.get(0).getBoundingClientRect(),S=k.outerWidth();if(!((Common.UI.isRTL()?o-f.right:f.left)+S>n)){p=!0;break}if(!h){(h=$("<div></div>")).addClass(x[m].className);for(var v=x[m].attributes,w=0;w<v.length;w++)h.attr(v[w].name,v[w].value);this.$moreBar.prepend(h),d&&(d.css("display",""),d.removeAttr("hidden-on-resize"))}h.prepend(k),c=!0}if(A.children().length<1?(A.remove(),h&&h.removeAttr("group-state").attr("inner-width",A.attr("inner-width")),h=null):h&&h.attr("group-state","open")&&A.attr("group-state","open"),p)break}d=null}else A.hasClass("separator")&&(this.$moreBar.prepend(A),A.css("display","none"),A.attr("hidden-on-resize",!0),d=A,c=!0);else A.attr("data-hidden-tb-item",!0),this.$moreBar.prepend(A),c=!0}else if((t||0<r)&&i.is(":visible")){var _,x,d=null,h=null,y=0;if(0<(_=e.find("> div:not(.more-box)")).length&&((_=$(_[_.length-1])).hasClass("separator")&&(d=_,y=parseInt(d.css("margin-left"))+parseInt(d.css("margin-right"))+1),_.hasClass("group")&&"open"==_.attr("group-state")&&(h=_)),0<(x=this.$moreBar.children()).length)for(m=0;m<x.length;m++){var A=$(x[m]);if(l=e.outerWidth()+a,!A.is(":visible")&&A.attr("data-hidden-tb-item"))A.removeAttr("data-hidden-tb-item"),i.before(A),0==this.$moreBar.children().filter(".group").length&&(this.hideMoreBtns(),i.css("display","none"));else if(A.hasClass("group")){var T=!1;if(1==this.$moreBar.children().filter(".group").length&&(n=o,T=!0),l+y+(g=parseInt(A.attr("inner-width")||0))<n&&"open"!=A.attr("group-state"))i.before(A),d&&(d.css("display",""),d.removeAttr("hidden-on-resize")),0==this.$moreBar.children().filter(".group").length&&(this.hideMoreBtns(),i.css("display","none")),c=!0;else{if(!(l+y<n))break;for(b=A.children(),n=o-s,C=0;C<b.length;C++){T&&C==b.length-1&&(n=o);var k,l=e.outerWidth()+a;if((k=$(b[C])).hasClass("elset")){p=!0;break}if(!(l+y+(S=parseInt(k.attr("inner-width")||0)+(h?0:parseInt(A.css("padding-left"))))<n)){p=!0;break}if(!h){(h=$("<div></div>")).addClass(x[m].className);for(v=x[m].attributes,w=0;w<v.length;w++)h.attr(v[w].name,v[w].value);h.hasClass("flex")&&(e.data().flex=null),i.before(h),d&&(d.css("display",""),d.removeAttr("hidden-on-resize"))}h.append(k),c=!0}if(A.children().length<1?(A.remove(),h&&h.removeAttr("group-state").attr("inner-width",A.attr("inner-width")),h=null,0==this.$moreBar.children().filter(".group").length&&(this.hideMoreBtns(),i.css("display","none"))):h&&h.attr("group-state","open")&&A.attr("group-state","open"),p)break}d=null,y=0}else A.hasClass("separator")&&(i.before(A),A.css("display","none"),A.attr("hidden-on-resize",!0),d=A,y=parseInt(d.css("margin-left"))+parseInt(d.css("margin-right"))+1,c=!0)}else this.hideMoreBtns(),i.css("display","none")}c&&Common.UI.Menu.Manager.hideAll()},onMoreHide:function(t,e){var i=t.panel.parent();t.pressed&&t.toggle(!1,!0),i.is(":visible")&&(i.hide(),Common.NotificationCenter.trigger("edit:complete",this.toolbar,t))},onMoreShow:function(t,e){var i=t.panel.parent(),s=i.parent().offset(),t=t.$el,o=t.offset(),n=Common.Utils.innerWidth()-(o.left-s.left+t.width()),o=o.top-s.top+t.height()+10,s=Common.UI.isRTL()?{left:"6px",right:"auto",top:o,"max-width":Common.Utils.innerWidth()+"px"}:{right:n,left:"auto",top:o,"max-width":Common.Utils.innerWidth()+"px"};i.css(s),i.show()},hideMoreBtns:function(){for(var t in c)c[t]&&c[t].isActive()&&c[t].toggle(!1)}}))}),define("spreadsheeteditor/main/app/view/Toolbar",["backbone","text!spreadsheeteditor/main/app/template/Toolbar.template","text!spreadsheeteditor/main/app/template/ToolbarAnother.template","text!spreadsheeteditor/main/app/template/ToolbarView.template","common/main/lib/collection/Fonts","common/main/lib/component/Button","common/main/lib/component/ComboBox","common/main/lib/component/DataView","common/main/lib/component/ColorPalette","common/main/lib/component/ThemeColorPalette","common/main/lib/component/Menu","common/main/lib/component/DimensionPicker","common/main/lib/component/UpDownPicker","common/main/lib/component/Window","common/main/lib/component/ComboBoxFonts","common/main/lib/component/ComboDataView","common/main/lib/component/SynchronizeTip","common/main/lib/component/Mixtbar"],function(t,a,l,r){"use strict";Common.enumLock||(Common.enumLock={});var e,i={editCell:"cell-editing",editFormula:"is-formula",editText:"is-text",editPivot:"is-pivot",selImage:"sel-image",selShape:"sel-shape",selShapeText:"sel-shape-txt",selChart:"sel-chart",selChartText:"sel-chart-txt",selRange:"sel-range",selRangeEdit:"sel-range-edit",lostConnect:"disconnect",coAuth:"co-auth",coAuthText:"co-auth-text",ruleMerge:"rule-btn-merge",ruleFilter:"rule-filter",ruleDelFilter:"rule-clear-filter",menuFileOpen:"menu-file-open",cantPrint:"cant-print",multiselect:"is-multiselect",cantHyperlink:"cant-hyperlink",commentLock:"can-comment",cantModifyFilter:"cant-filter",disableOnStart:"on-start",cantGroup:"cant-group",cantGroupUngroup:"cant-group-ungroup",docPropsLock:"doc-props-lock",printAreaLock:"print-area-lock",namedRangeLock:"named-range-lock",multiselectCols:"is-multiselect-cols",headerLock:"header-lock",sheetLock:"sheet-lock",noPivot:"no-pivot",noSubitems:"no-subitems",noSlicerSource:"no-slicer-source",selSlicer:"sel-slicer",cantSort:"cant-sort",pivotLock:"pivot-lock",tableHasSlicer:"table-has-slicer",sheetView:"sheet-view",wbLock:"workbook-lock",wsLock:"worksheet-lock",itemsDisabled:"all-items-disabled",wsLockText:"worksheet-lock-text",wsLockShape:"worksheet-lock-shape",wsLockFormat:"worksheet-lock-format",inSmartartInternal:"in-smartart-internal",wsLockFormatFill:"worksheet-lock-format-fill",editVisibleArea:"is-visible-area",userProtected:"cell-user-protected",pageBreakLock:"page-break-lock"};for(e in i)i.hasOwnProperty(e)&&(Common.enumLock[e]=i[e]);SSE.Views.Toolbar=Common.UI.Mixtbar.extend(_.extend({el:"#toolbar",template:_.template(a),events:{},initialize:function(){var t=this;return t.SchemeNames=[t.txtScheme22,t.txtScheme1,t.txtScheme2,t.txtScheme3,t.txtScheme4,t.txtScheme5,t.txtScheme6,t.txtScheme7,t.txtScheme8,t.txtScheme9,t.txtScheme10,t.txtScheme11,t.txtScheme12,t.txtScheme13,t.txtScheme14,t.txtScheme15,t.txtScheme16,t.txtScheme17,t.txtScheme18,t.txtScheme19,t.txtScheme20,t.txtScheme21],t._state={hasCollaborativeChanges:void 0},t.btnSaveCls="btn-save",t.btnSaveTip=this.tipSave+Common.Utils.String.platformKey("Ctrl+S"),t.ascFormatOptions={General:"General",Number:"0.00",Currency:"$#,##0.00",Accounting:'_($* #,##0.00_);_($* (#,##0.00);_($* "-"??_);_(@_)',DateShort:"m/d/yyyy",DateLong:"[$-F800]dddd, mmmm dd, yyyy",Time:"[$-F400]h:mm:ss AM/PM",Percentage:"0.00%",Percent:"0%",Fraction:"# ?/?",Scientific:"0.00E+00",Text:"@"},t.numFormatData=[{value:Asc.c_oAscNumFormatType.General,format:this.ascFormatOptions.General,displayValue:this.txtGeneral,exampleval:"100"},{value:Asc.c_oAscNumFormatType.Number,format:this.ascFormatOptions.Number,displayValue:this.txtNumber,exampleval:"100,00"},{value:Asc.c_oAscNumFormatType.Scientific,format:this.ascFormatOptions.Scientific,displayValue:this.txtScientific,exampleval:"1,00E+02"},{value:Asc.c_oAscNumFormatType.Accounting,format:this.ascFormatOptions.Accounting,displayValue:this.txtAccounting,exampleval:"100,00 $"},{value:Asc.c_oAscNumFormatType.Currency,format:this.ascFormatOptions.Currency,displayValue:this.txtCurrency,exampleval:"100,00 $"},{value:Asc.c_oAscNumFormatType.Date,format:"MM-dd-yyyy",displayValue:this.txtDateShort,exampleval:"04-09-1900",customDisplayValue:this.txtDate},{value:Asc.c_oAscNumFormatType.Date,format:"MMMM d yyyy",displayValue:this.txtDateLong,exampleval:"April 9 1900",customDisplayValue:this.txtDate},{value:Asc.c_oAscNumFormatType.Time,format:"HH:MM:ss",displayValue:this.txtTime,exampleval:"00:00:00"},{value:Asc.c_oAscNumFormatType.Percent,format:this.ascFormatOptions.Percentage,displayValue:this.txtPercentage,exampleval:"100,00%"},{value:Asc.c_oAscNumFormatType.Fraction,format:this.ascFormatOptions.Fraction,displayValue:this.txtFraction,exampleval:"100"},{value:Asc.c_oAscNumFormatType.Text,format:this.ascFormatOptions.Text,displayValue:this.txtText,exampleval:"100"}],this},onUpdateLastCustomMargins:function(t){var e,i,s,o;this.btnPageMargins&&(e=t?t.asc_getTop():Common.localStorage.getItem("sse-pgmargins-top"),i=t?t.asc_getLeft():Common.localStorage.getItem("sse-pgmargins-left"),s=t?t.asc_getBottom():Common.localStorage.getItem("sse-pgmargins-bottom"),t=t?t.asc_getRight():Common.localStorage.getItem("sse-pgmargins-right"),null!==e&&null!==i&&null!==s&&null!==t?((o=this.btnPageMargins.menu.items[0]).options.value=o.value=[parseFloat(e),parseFloat(i),parseFloat(s),parseFloat(t)],o.setVisible(!0),$(o.el).html(o.template({id:Common.UI.getId(),caption:o.caption,options:o.options}))):this.btnPageMargins.menu.items[0].setVisible(!1))},lockToolbar:function(t,e,i){Common.Utils.lockControls(t,e,i,this.lockControls)},applyLayout:function(t){var e=this;function i(){return{isDummy:!0,on:function(){}}}var s,o,n=Common.enumLock;return e.btnCopy=new Common.UI.Button({id:"id-toolbar-btn-copy",cls:"btn-toolbar",iconCls:"toolbar__icon btn-copy",dataHint:"1",dataHintDirection:t.isEditDiagram||t.isEditMailMerge||t.isEditOle?"bottom":"top",dataHintTitle:"C"}),e.btnPaste=new Common.UI.Button({id:"id-toolbar-btn-paste",cls:"btn-toolbar",iconCls:"toolbar__icon btn-paste",lock:[n.coAuth,n.lostConnect,n.editVisibleArea,n.userProtected],dataHint:"1",dataHintDirection:t.isEditDiagram||t.isEditMailMerge||t.isEditOle?"bottom":"top",dataHintTitle:"V"}),e.btnUndo=new Common.UI.Button({id:"id-toolbar-btn-undo",cls:"btn-toolbar",iconCls:"toolbar__icon btn-undo",disabled:!0,lock:[n.lostConnect],signals:["disabled"],dataHint:"1",dataHintDirection:"bottom",dataHintTitle:"Z"}),e.btnRedo=new Common.UI.Button({id:"id-toolbar-btn-redo",cls:"btn-toolbar",iconCls:"toolbar__icon btn-redo",disabled:!0,lock:[n.lostConnect],signals:["disabled"],dataHint:"1",dataHintDirection:"bottom",dataHintTitle:"Y"}),t.isEditDiagram||t.isEditMailMerge||t.isEditOle?(e.$layout=$(_.template(l)(t)),(t.isEditDiagram||t.isEditOle)&&(e.btnInsertFormula=new Common.UI.Button({id:"id-toolbar-btn-insertformula",cls:"btn-toolbar",iconCls:"toolbar__icon btn-formula",split:!0,lock:[n.editText,n.selChart,n.selChartText,n.selShape,n.selShapeText,n.selImage,n.selRangeEdit,n.lostConnect,n.coAuth,n.editVisibleArea],menu:new Common.UI.Menu({style:"min-width: 110px",items:[{caption:"SUM",value:"SUM"},{caption:"AVERAGE",value:"AVERAGE"},{caption:"MIN",value:"MIN"},{caption:"MAX",value:"MAX"},{caption:"COUNT",value:"COUNT"},{caption:"--"},{caption:e.txtAdditional,value:"more",hint:e.txtFormula+Common.Utils.String.platformKey("Shift+F3")}]}),dataHint:"1",dataHintDirection:"bottom"}),s=_.template(["<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%= item.value %>"><a tabindex="-1" type="menuitem">','<div style="position: relative;"><div class="display-value"><%= scope.getDisplayValue(item) %></div>','<div class="example-val"><%= item.exampleval ? item.exampleval : "" %></div>',"</div></a></li>","<% }); %>",'<li class="divider">','<li id="id-toolbar-mnu-item-more-formats" data-value="-1"><a tabindex="-1" type="menuitem">'+e.textMoreFormats+"</a></li>"].join("")),e.cmbNumberFormat=new Common.UI.ComboBoxCustom({cls:"input-group-nr",menuStyle:"min-width: 180px;",hint:e.tipNumFormat,lock:[n.editCell,n.selChart,n.selChartText,n.selShape,n.selShapeText,n.selImage,n.selRangeEdit,n.lostConnect,n.coAuth,n.editVisibleArea],itemsTemplate:s,editable:!1,focusWhenNoSelection:!1,data:e.numFormatData,dataHint:"1",dataHintDirection:"bottom",updateFormControl:function(t){this.clearSelection(),t&&this.setRawValue(t.get("customDisplayValue")||t.get("displayValue"))}})),(t.isEditMailMerge||t.isEditOle)&&(e.btnSearch=new Common.UI.Button({id:"id-toolbar-btn-search",cls:"btn-toolbar",iconCls:"toolbar__icon btn-menu-search",lock:[n.lostConnect],enableToggle:!0,dataHint:"1",dataHintDirection:"bottom"})),t.isEditDiagram&&(e.btnDecDecimal=new Common.UI.Button({id:"id-toolbar-btn-decdecimal",cls:"btn-toolbar",iconCls:"toolbar__icon btn-decdecimal",lock:[n.editCell,n.selChart,n.selChartText,n.selShape,n.selShapeText,n.selImage,n.lostConnect,n.coAuth,n.editVisibleArea],dataHint:"1",dataHintDirection:"bottom"}),e.btnIncDecimal=new Common.UI.Button({id:"id-toolbar-btn-incdecimal",cls:"btn-toolbar",iconCls:"toolbar__icon btn-incdecimal",lock:[n.editCell,n.selChart,n.selChartText,n.selShape,n.selShapeText,n.selImage,n.lostConnect,n.coAuth,n.editVisibleArea],dataHint:"1",dataHintDirection:"bottom"}),e.btnEditChart=new Common.UI.Button({id:"id-toolbar-rtn-edit-chart",cls:"btn-toolbar btn-text-default auto",caption:e.tipEditChart,lock:[n.lostConnect],style:"min-width: 120px;",dataHint:"1",dataHintDirection:"bottom"}),e.btnEditChartData=new Common.UI.Button({id:"id-toolbar-rtn-edit-chart-data",cls:"btn-toolbar",iconCls:"toolbar__icon btn-select-range",caption:e.tipEditChartData,lock:[n.editCell,n.selRange,n.selRangeEdit,n.lostConnect],dataHint:"1",dataHintDirection:"left",dataHintOffset:"medium"}),e.btnEditChartType=new Common.UI.Button({id:"id-toolbar-rtn-edit-chart-type",cls:"btn-toolbar",iconCls:"toolbar__icon btn-menu-chart",caption:e.tipEditChartType,lock:[n.editCell,n.selRange,n.selRangeEdit,n.lostConnect],style:"min-width: 120px;",dataHint:"1",dataHintDirection:"left",dataHintOffset:"medium"})),t.isEditMailMerge&&(e.btnSortDown=new Common.UI.Button({id:"id-toolbar-btn-sort-down",cls:"btn-toolbar",iconCls:"toolbar__icon btn-sort-down",lock:[n.editCell,n.selChart,n.selChartText,n.selShape,n.selShapeText,n.selImage,n.lostConnect,n.coAuth,n.ruleFilter,n.editPivot,n.editVisibleArea],dataHint:"1",dataHintDirection:"bottom"}),e.btnSortUp=new Common.UI.Button({id:"id-toolbar-btn-sort-up",cls:"btn-toolbar",iconCls:"toolbar__icon btn-sort-up",lock:[n.editCell,n.selChart,n.selChartText,n.selShape,n.selShapeText,n.selImage,n.lostConnect,n.coAuth,n.ruleFilter,n.editPivot,n.editVisibleArea],dataHint:"1",dataHintDirection:"bottom"}),e.btnSetAutofilter=new Common.UI.Button({id:"id-toolbar-btn-setautofilter",cls:"btn-toolbar",iconCls:"toolbar__icon btn-autofilter",lock:[n.editCell,n.selChart,n.selChartText,n.selShape,n.selShapeText,n.selImage,n.lostConnect,n.coAuth,n.ruleFilter,n.editPivot,n.editVisibleArea],enableToggle:!0,dataHint:"1",dataHintDirection:"bottom"}),e.btnClearAutofilter=new Common.UI.Button({id:"id-toolbar-btn-clearfilter",cls:"btn-toolbar",iconCls:"toolbar__icon btn-clear-filter",lock:[n.editCell,n.selChart,n.selChartText,n.selShape,n.selShapeText,n.selImage,n.lostConnect,n.coAuth,n.ruleDelFilter,n.editPivot,n.editVisibleArea],dataHint:"1",dataHintDirection:"bottom"})),t.isEditOle&&(e.cmbFontSize=new Common.UI.ComboBox({cls:"input-group-nr",menuStyle:"min-width: 55px;",hint:e.tipFontSize,lock:[n.selImage,n.editFormula,n.selRangeEdit,n.selSlicer,n.coAuth,n.coAuthText,n.lostConnect,n.editVisibleArea],data:[{value:8,displayValue:"8"},{value:9,displayValue:"9"},{value:10,displayValue:"10"},{value:11,displayValue:"11"},{value:12,displayValue:"12"},{value:14,displayValue:"14"},{value:16,displayValue:"16"},{value:18,displayValue:"18"},{value:20,displayValue:"20"},{value:22,displayValue:"22"},{value:24,displayValue:"24"},{value:26,displayValue:"26"},{value:28,displayValue:"28"},{value:36,displayValue:"36"},{value:48,displayValue:"48"},{value:72,displayValue:"72"},{value:96,displayValue:"96"}],dataHint:"1",dataHintDirection:"bottom"}),e.cmbFontName=new Common.UI.ComboBoxFonts({cls:"input-group-nr",menuCls:"scrollable-menu",menuStyle:"min-width: 325px;",hint:e.tipFontName,lock:[n.selImage,n.editFormula,n.selRangeEdit,n.selSlicer,n.coAuth,n.coAuthText,n.lostConnect,n.editVisibleArea],store:new Common.Collections.Fonts,recent:0,dataHint:"1",dataHintDirection:"bottom"}),e.btnWrap=new Common.UI.Button({id:"id-toolbar-rtn-wrap",cls:"btn-toolbar",iconCls:"toolbar__icon btn-wrap",lock:[n.editCell,n.selChart,n.selChartText,n.selShape,n.selShapeText,n.selImage,n.selSlicer,n.lostConnect,n.coAuth,n.FormatCells,n.editVisibleArea],enableToggle:!0,allowDepress:!0,dataHint:"1",dataHintDirection:"bottom"}),e.btnMerge=new Common.UI.Button({id:"id-toolbar-rtn-merge",cls:"btn-toolbar",iconCls:"toolbar__icon btn-merge-and-center",enableToggle:!0,allowDepress:!0,split:!0,lock:[n.editCell,n.selShape,n.selShapeText,n.selChart,n.selChartText,n.selImage,n.selSlicer,n.lostConnect,n.coAuth,n.ruleMerge,n.editPivot,n.wsLock,n.editVisibleArea],menu:new Common.UI.Menu({items:[{caption:e.txtMergeCenter,iconCls:"menu__icon btn-merge-and-center",value:Asc.c_oAscMergeOptions.MergeCenter},{caption:e.txtMergeAcross,iconCls:"menu__icon btn-merge-across",value:Asc.c_oAscMergeOptions.MergeAcross},{caption:e.txtMergeCells,iconCls:"menu__icon btn-merge-cells",value:Asc.c_oAscMergeOptions.Merge},{caption:e.txtUnmerge,iconCls:"menu__icon btn-unmerge-cells",value:Asc.c_oAscMergeOptions.None}]}),dataHint:"1",dataHintDirection:"bottom"}),e.mnuTextColorPicker=i(),e.btnTextColor=new Common.UI.ButtonColored({id:"id-toolbar-btn-fontcolor",cls:"btn-toolbar",iconCls:"toolbar__icon btn-fontcolor",split:!0,lock:[n.selImage,n.editFormula,n.selRangeEdit,n.selSlicer,n.coAuth,n.coAuthText,n.lostConnect,n.wsLockFormat,n.editVisibleArea],menu:!0,auto:!0,eyeDropper:!0,dataHint:"1",dataHintDirection:"bottom"}),e.mnuBackColorPicker=i(),e.btnBackColor=new Common.UI.ButtonColored({id:"id-toolbar-btn-fillparag",cls:"btn-toolbar",iconCls:"toolbar__icon btn-paracolor",split:!0,lock:[n.selImage,n.editCell,n.selSlicer,n.coAuth,n.coAuthText,n.lostConnect,n.wsLockFormatFill,n.editVisibleArea],transparent:!0,menu:!0,eyeDropper:!0,dataHint:"1",dataHintDirection:"bottom"}),e.btnBorders=new Common.UI.Button({id:"id-toolbar-btn-borders",cls:"btn-toolbar",iconCls:"toolbar__icon btn-border-out",icls:"btn-border-out",borderId:"outer",borderswidth:Asc.c_oAscBorderStyles.Thin,lock:[n.editCell,n.selChart,n.selChartText,n.selShape,n.selShapeText,n.selImage,n.selSlicer,n.lostConnect,n.coAuth,n.FormatCells,n.editVisibleArea],split:!0,menu:!0,dataHint:"1",dataHintDirection:"bottom"}),e.btnTableTemplate=new Common.UI.Button({id:"id-toolbar-btn-ttempl",cls:"btn-toolbar",iconCls:"toolbar__icon btn-menu-table",lock:[n.editCell,n.selChart,n.selChartText,n.selShape,n.selShapeText,n.selImage,n.selSlicer,n.lostConnect,n.coAuth,n.ruleFilter,n.multiselect,n.cantModifyFilter,n.wsLock,n.editVisibleArea],menu:new Common.UI.Menu({items:[{template:_.template('<div id="id-toolbar-menu-table-templates" style="width: 487px; height: 300px; margin: 0px 4px;"></div>')}]}),dataHint:"1",dataHintDirection:"bottom"}),e.btnCellStyle=new Common.UI.Button({id:"id-toolbar-btn-cstyle",cls:"btn-toolbar",iconCls:"toolbar__icon btn-menu-cell",lock:[n.editCell,n.selChart,n.selChartText,n.selShape,n.selShapeText,n.selImage,n.selSlicer,n.lostConnect,n.coAuth,n.ruleFilter,n.multiselect,n.cantModifyFilter,n.wsLock,n.editVisibleArea],menu:new Common.UI.Menu({items:[{template:_.template('<div id="id-toolbar-menu-cell-styles" style="width: 645px; height: 306px; margin: 0px 4px;"></div>')}]}),dataHint:"1",dataHintDirection:"bottom"}),e.btnTextFormatting=new Common.UI.Button({id:"id-toolbar-btn-formatting",cls:"btn-toolbar no-caret",iconCls:"toolbar__icon btn-more-vertical",lock:[n.selImage,n.editFormula,n.selRangeEdit,n.selSlicer,n.coAuth,n.coAuthText,n.lostConnect,n.wsLockFormat,n.editVisibleArea],menu:new Common.UI.Menu({items:[{caption:e.textBold,iconCls:"menu__icon btn-bold",value:"bold",checkable:!0,checkmark:!1,allowDepress:!0},{caption:e.textItalic,iconCls:"menu__icon btn-italic",value:"italic",checkable:!0,checkmark:!1,allowDepress:!0},{caption:e.textUnderline,iconCls:"menu__icon btn-underline",value:"underline",checkable:!0,checkmark:!1,allowDepress:!0},{caption:e.textStrikeout,iconCls:"menu__icon btn-strikeout",value:"strikeout",checkable:!0,checkmark:!1,allowDepress:!0},{caption:e.textSuperscript,iconCls:"menu__icon btn-superscript",checkable:!0,checkmark:!1,allowDepress:!0,toggleGroup:"textsubscriptgroup",value:"superscript"},{caption:e.textSubscript,iconCls:"menu__icon btn-subscript",checkable:!0,checkmark:!1,allowDepress:!0,toggleGroup:"textsubscriptgroup",value:"subscript"}]}),dataHint:"1",dataHintDirection:"bottom"}),e.btnHorizontalAlign=new Common.UI.Button({id:"id-toolbar-btn-halign",cls:"btn-toolbar",iconCls:"toolbar__icon btn-align-left",icls:"btn-align-left",lock:[n.editCell,n.selChart,n.selChartText,n.selImage,n.selSlicer,n.lostConnect,n.coAuth,n.coAuthText,n.wsLockFormat,n.editVisibleArea],menu:new Common.UI.Menu({items:[{caption:e.tipAlignLeft,iconCls:"menu__icon btn-align-left",icls:"btn-align-left",checkable:!0,checkmark:!1,allowDepress:!0,toggleGroup:"halignGroup",checked:!0,value:AscCommon.align_Left},{caption:e.tipAlignCenter,iconCls:"menu__icon btn-align-center",icls:"btn-align-center",checkable:!0,checkmark:!1,allowDepress:!0,toggleGroup:"halignGroup",value:AscCommon.align_Center},{caption:e.tipAlignRight,iconCls:"menu__icon btn-align-right",icls:"btn-align-right",checkable:!0,checkmark:!1,allowDepress:!0,toggleGroup:"halignGroup",value:AscCommon.align_Right},{caption:e.tipAlignJust,iconCls:"menu__icon btn-align-just",icls:"btn-align-just",checkable:!0,checkmark:!1,allowDepress:!0,toggleGroup:"halignGroup",value:AscCommon.align_Justify}]}),dataHint:"1",dataHintDirection:"bottom"}),e.btnVerticalAlign=new Common.UI.Button({id:"id-toolbar-btn-valign",cls:"btn-toolbar",lock:[n.editCell,n.selChart,n.selChartText,n.selImage,n.selSlicer,n.lostConnect,n.coAuth,n.coAuthText,n.wsLockFormat,n.editVisibleArea],iconCls:"toolbar__icon btn-align-middle",icls:"btn-align-middle",menu:new Common.UI.Menu({items:[{caption:e.textAlignTop,iconCls:"menu__icon btn-align-top",icls:"btn-align-top",checkable:!0,checkmark:!1,allowDepress:!0,toggleGroup:"valignGroup",value:Asc.c_oAscVAlign.Top},{caption:e.textAlignMiddle,iconCls:"menu__icon btn-align-middle",icls:"btn-align-middle",checkable:!0,checkmark:!1,allowDepress:!0,toggleGroup:"valignGroup",value:Asc.c_oAscVAlign.Center,checked:!0},{caption:e.textAlignBottom,iconCls:"menu__icon btn-align-bottom",icls:"btn-align-bottom",checkable:!0,checkmark:!1,allowDepress:!0,toggleGroup:"valignGroup",value:Asc.c_oAscVAlign.Bottom}]}),dataHint:"1",dataHintDirection:"bottom"}),e.btnVisibleArea=new Common.UI.Button({id:"id-toolbar-btn-visible-area",cls:"btn-toolbar btn-icon-default",iconCls:"toolbar__icon btn-sheet-view",menu:new Common.UI.Menu({items:[{caption:e.textShowVA,value:"show"},{caption:e.textHideVA,value:"hide",visible:!1},{caption:e.textEditVA,value:"edit"}]}),lock:[n.lostConnect],dataHint:"1",dataHintDirection:"bottom"}),e.btnVisibleAreaClose=new Common.UI.Button({id:"id-toolbar-btn-visible-area-close",cls:"btn-toolbar btn-text-default auto",caption:e.textDone,lock:[n.lostConnect],visible:!1,dataHint:"1",dataHintDirection:"bottom"}))):t.isEdit?(Common.UI.Mixtbar.prototype.initialize.call(this,{template:_.template(a),tabs:[{caption:e.textTabFile,action:"file",extcls:"canedit",layoutname:"toolbar-file",haspanel:!1,dataHintTitle:"F"},{caption:e.textTabHome,action:"home",extcls:"canedit",dataHintTitle:"H"},{caption:e.textTabInsert,action:"ins",extcls:"canedit",dataHintTitle:"I"},{caption:e.textTabLayout,action:"layout",extcls:"canedit",layoutname:"toolbar-layout",dataHintTitle:"L"},{caption:e.textTabFormula,action:"formula",extcls:"canedit",dataHintTitle:"O"},{caption:e.textTabData,action:"data",extcls:"canedit",dataHintTitle:"D"}]}),e.btnCut=new Common.UI.Button({id:"id-toolbar-btn-cut",cls:"btn-toolbar",iconCls:"toolbar__icon btn-cut",lock:[n.coAuth,n.lostConnect,n.disableOnStart,n.userProtected],dataHint:"1",dataHintDirection:"top",dataHintTitle:"X"}),e.btnSelectAll=new Common.UI.Button({id:"id-toolbar-btn-select-all",cls:"btn-toolbar",iconCls:"toolbar__icon btn-select-all",lock:[n.disableOnStart],dataHint:"1",dataHintDirection:"bottom"}),e.cmbFontSize=new Common.UI.ComboBox({cls:"input-group-nr",menuStyle:"min-width: 55px;",hint:e.tipFontSize,lock:[n.selImage,n.editFormula,n.selRangeEdit,n.selSlicer,n.coAuth,n.coAuthText,n.lostConnect,n.userProtected],data:[{value:8,displayValue:"8"},{value:9,displayValue:"9"},{value:10,displayValue:"10"},{value:11,displayValue:"11"},{value:12,displayValue:"12"},{value:14,displayValue:"14"},{value:16,displayValue:"16"},{value:18,displayValue:"18"},{value:20,displayValue:"20"},{value:22,displayValue:"22"},{value:24,displayValue:"24"},{value:26,displayValue:"26"},{value:28,displayValue:"28"},{value:36,displayValue:"36"},{value:48,displayValue:"48"},{value:72,displayValue:"72"},{value:96,displayValue:"96"}],dataHint:"1",dataHintDirection:"top"}),e.cmbFontName=new Common.UI.ComboBoxFonts({cls:"input-group-nr",menuCls:"scrollable-menu",menuStyle:"min-width: 325px;",hint:e.tipFontName,lock:[n.selImage,n.editFormula,n.selRangeEdit,n.selSlicer,n.coAuth,n.coAuthText,n.lostConnect,n.userProtected],store:new Common.Collections.Fonts,dataHint:"1",dataHintDirection:"top"}),e.btnPrint=new Common.UI.Button({id:"id-toolbar-btn-print",cls:"btn-toolbar",iconCls:"toolbar__icon btn-print no-mask",lock:[n.editCell,n.cantPrint,n.disableOnStart],signals:["disabled"],split:t.canQuickPrint,menu:t.canQuickPrint,dataHint:"1",dataHintDirection:"bottom",dataHintTitle:"P",printType:"print"}),e.btnSave=new Common.UI.Button({id:"id-toolbar-btn-save",cls:"btn-toolbar",iconCls:"toolbar__icon no-mask "+e.btnSaveCls,lock:[n.lostConnect],signals:["disabled"],dataHint:"1",dataHintDirection:"top",dataHintTitle:"S"}),e.btnCollabChanges=e.btnSave,e.btnIncFontSize=new Common.UI.Button({id:"id-toolbar-btn-incfont",cls:"btn-toolbar",iconCls:"toolbar__icon btn-incfont",lock:[n.selImage,n.editFormula,n.selRangeEdit,n.selSlicer,n.coAuth,n.coAuthText,n.lostConnect,n.wsLockFormat,n.userProtected],dataHint:"1",dataHintDirection:"top"}),e.btnDecFontSize=new Common.UI.Button({id:"id-toolbar-btn-decfont",cls:"btn-toolbar",iconCls:"toolbar__icon btn-decfont",lock:[n.selImage,n.editFormula,n.selRangeEdit,n.selSlicer,n.coAuth,n.coAuthText,n.lostConnect,n.wsLockFormat,n.userProtected],dataHint:"1",dataHintDirection:"top"}),e.btnChangeCase=new Common.UI.Button({id:"id-toolbar-btn-case",cls:"btn-toolbar",iconCls:"toolbar__icon btn-change-case",lock:[n.selImage,n.editFormula,n.selRangeEdit,n.selSlicer,n.coAuth,n.coAuthText,n.lostConnect,n.wsLockFormat,n.userProtected],menu:new Common.UI.Menu({items:[{caption:e.mniSentenceCase,value:Asc.c_oAscChangeTextCaseType.SentenceCase},{caption:e.mniLowerCase,value:Asc.c_oAscChangeTextCaseType.LowerCase},{caption:e.mniUpperCase,value:Asc.c_oAscChangeTextCaseType.UpperCase},{caption:e.mniCapitalizeWords,value:Asc.c_oAscChangeTextCaseType.CapitalizeWords},{caption:e.mniToggleCase,value:Asc.c_oAscChangeTextCaseType.ToggleCase}]}),dataHint:"1",dataHintDirection:"top"}),e.mnuChangeCase=e.btnChangeCase.menu,e.btnBold=new Common.UI.Button({id:"id-toolbar-btn-bold",cls:"btn-toolbar",iconCls:"toolbar__icon btn-bold",lock:[n.selImage,n.editFormula,n.selRangeEdit,n.selSlicer,n.coAuth,n.coAuthText,n.lostConnect,n.wsLockFormat,n.userProtected],enableToggle:!0,dataHint:"1",dataHintDirection:"bottom"}),e.btnItalic=new Common.UI.Button({id:"id-toolbar-btn-italic",cls:"btn-toolbar",iconCls:"toolbar__icon btn-italic",lock:[n.selImage,n.editFormula,n.selRangeEdit,n.selSlicer,n.coAuth,n.coAuthText,n.lostConnect,n.wsLockFormat,n.userProtected],enableToggle:!0,dataHint:"1",dataHintDirection:"bottom"}),e.btnUnderline=new Common.UI.Button({id:"id-toolbar-btn-underline",cls:"btn-toolbar",iconCls:"toolbar__icon btn-underline",lock:[n.selImage,n.editFormula,n.selRangeEdit,n.selSlicer,n.coAuth,n.coAuthText,n.lostConnect,n.wsLockFormat,n.userProtected],enableToggle:!0,dataHint:"1",dataHintDirection:"bottom"}),e.btnStrikeout=new Common.UI.Button({id:"id-toolbar-btn-strikeout",cls:"btn-toolbar",iconCls:"toolbar__icon btn-strikeout",lock:[n.selImage,n.editFormula,n.selRangeEdit,n.selSlicer,n.coAuth,n.coAuthText,n.lostConnect,n.wsLockFormat,n.userProtected],enableToggle:!0,dataHint:"1",dataHintDirection:"bottom"}),e.btnSubscript=new Common.UI.Button({id:"id-toolbar-btn-subscript",cls:"btn-toolbar",iconCls:"toolbar__icon btn-subscript",icls:"btn-subscript",split:!0,enableToggle:!0,lock:[n.selImage,n.editFormula,n.selRangeEdit,n.selSlicer,n.coAuth,n.coAuthText,n.lostConnect,n.wsLockFormat,n.userProtected],menu:new Common.UI.Menu({items:[{caption:e.textSuperscript,iconCls:"menu__icon btn-superscript",icls:"btn-superscript",checkable:!0,checkmark:!1,allowDepress:!0,toggleGroup:"textsubscriptgroup",value:"super"},{caption:e.textSubscript,iconCls:"menu__icon btn-subscript",icls:"btn-subscript",checkable:!0,checkmark:!1,allowDepress:!0,toggleGroup:"textsubscriptgroup",value:"sub"}]}),dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"0, -16"}),e.mnuTextColorPicker=i(),e.btnTextColor=new Common.UI.ButtonColored({id:"id-toolbar-btn-fontcolor",cls:"btn-toolbar",iconCls:"toolbar__icon btn-fontcolor",split:!0,lock:[n.selImage,n.editFormula,n.selRangeEdit,n.selSlicer,n.coAuth,n.coAuthText,n.lostConnect,n.wsLockFormat,n.userProtected],menu:!0,auto:!0,eyeDropper:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"0, -16"}),e.mnuBackColorPicker=i(),e.btnBackColor=new Common.UI.ButtonColored({id:"id-toolbar-btn-fillparag",cls:"btn-toolbar",iconCls:"toolbar__icon btn-paracolor",split:!0,lock:[n.selImage,n.editCell,n.selSlicer,n.coAuth,n.coAuthText,n.lostConnect,n.wsLockFormatFill,n.userProtected],transparent:!0,menu:!0,eyeDropper:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"0, -16"}),e.btnBorders=new Common.UI.Button({id:"id-toolbar-btn-borders",cls:"btn-toolbar",iconCls:"toolbar__icon btn-border-out",icls:"btn-border-out",borderId:"outer",borderswidth:Asc.c_oAscBorderStyles.Thin,lock:[n.editCell,n.selChart,n.selChartText,n.selShape,n.selShapeText,n.selImage,n.selSlicer,n.lostConnect,n.coAuth,n.FormatCells,n.userProtected],split:!0,menu:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"0, -16"}),e.btnAlignLeft=new Common.UI.Button({id:"id-toolbar-btn-align-left",cls:"btn-toolbar",iconCls:"toolbar__icon btn-align-left",enableToggle:!0,lock:[n.editCell,n.selChart,n.selChartText,n.selImage,n.selSlicer,n.lostConnect,n.coAuth,n.coAuthText,n.wsLockFormat,n.userProtected],toggleGroup:"alignGroup",dataHint:"1",dataHintDirection:"bottom"}),e.btnAlignCenter=new Common.UI.Button({id:"id-toolbar-btn-align-center",cls:"btn-toolbar",iconCls:"toolbar__icon btn-align-center",enableToggle:!0,lock:[n.editCell,n.selChart,n.selChartText,n.selImage,n.selSlicer,n.lostConnect,n.coAuth,n.coAuthText,n.wsLockFormat,n.userProtected],toggleGroup:"alignGroup",dataHint:"1",dataHintDirection:"bottom"}),e.btnAlignRight=new Common.UI.Button({id:"id-toolbar-btn-align-right",cls:"btn-toolbar",iconCls:"toolbar__icon btn-align-right",enableToggle:!0,lock:[n.editCell,n.selChart,n.selChartText,n.selImage,n.selSlicer,n.lostConnect,n.coAuth,n.coAuthText,n.wsLockFormat,n.userProtected],toggleGroup:"alignGroup",dataHint:"1",dataHintDirection:"bottom"}),e.btnAlignJust=new Common.UI.Button({id:"id-toolbar-btn-align-just",cls:"btn-toolbar",iconCls:"toolbar__icon btn-align-just",enableToggle:!0,lock:[n.editCell,n.selChart,n.selChartText,n.selImage,n.selSlicer,n.lostConnect,n.coAuth,n.coAuthText,n.wsLockFormat,n.userProtected],toggleGroup:"alignGroup",dataHint:"1",dataHintDirection:"bottom"}),e.btnMerge=new Common.UI.Button({id:"id-toolbar-rtn-merge",cls:"btn-toolbar",iconCls:"toolbar__icon btn-merge-and-center",enableToggle:!0,allowDepress:!0,split:!0,lock:[n.editCell,n.selShape,n.selShapeText,n.selChart,n.selChartText,n.selImage,n.selSlicer,n.lostConnect,n.coAuth,n.ruleMerge,n.editPivot,n.wsLock,n.userProtected],menu:new Common.UI.Menu({items:[{caption:e.txtMergeCenter,iconCls:"menu__icon btn-merge-and-center",value:Asc.c_oAscMergeOptions.MergeCenter},{caption:e.txtMergeAcross,iconCls:"menu__icon btn-merge-across",value:Asc.c_oAscMergeOptions.MergeAcross},{caption:e.txtMergeCells,iconCls:"menu__icon btn-merge-cells",value:Asc.c_oAscMergeOptions.Merge},{caption:e.txtUnmerge,iconCls:"menu__icon btn-unmerge-cells",value:Asc.c_oAscMergeOptions.None}]}),dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"0, -16"}),e.btnAlignTop=new Common.UI.Button({id:"id-toolbar-rtn-valign-top",cls:"btn-toolbar",iconCls:"toolbar__icon btn-align-top",lock:[n.editCell,n.selChart,n.selChartText,n.selImage,n.selSlicer,n.lostConnect,n.coAuth,n.coAuthText,n.wsLockFormat,n.userProtected],enableToggle:!0,toggleGroup:"vAlignGroup",dataHint:"1",dataHintDirection:"top"}),e.btnAlignMiddle=new Common.UI.Button({id:"id-toolbar-rtn-valign-middle",cls:"btn-toolbar",iconCls:"toolbar__icon btn-align-middle",enableToggle:!0,lock:[n.editCell,n.selChart,n.selChartText,n.selImage,n.selSlicer,n.lostConnect,n.coAuth,n.coAuthText,n.wsLockFormat,n.userProtected],toggleGroup:"vAlignGroup",dataHint:"1",dataHintDirection:"top"}),e.btnAlignBottom=new Common.UI.Button({id:"id-toolbar-rtn-valign-bottom",cls:"btn-toolbar",iconCls:"toolbar__icon btn-align-bottom",lock:[n.editCell,n.selChart,n.selChartText,n.selImage,n.selSlicer,n.lostConnect,n.coAuth,n.coAuthText,n.wsLockFormat,n.userProtected],enableToggle:!0,toggleGroup:"vAlignGroup",dataHint:"1",dataHintDirection:"top"}),e.btnWrap=new Common.UI.Button({id:"id-toolbar-rtn-wrap",cls:"btn-toolbar",iconCls:"toolbar__icon btn-wrap",lock:[n.editCell,n.selChart,n.selChartText,n.selShape,n.selShapeText,n.selImage,n.selSlicer,n.lostConnect,n.coAuth,n.FormatCells,n.userProtected],enableToggle:!0,allowDepress:!0,dataHint:"1",dataHintDirection:"top"}),e.btnTextOrient=new Common.UI.Button({id:"id-toolbar-rtn-textorient",cls:"btn-toolbar",iconCls:"toolbar__icon btn-text-orient-ccw",lock:[n.editCell,n.selChart,n.selChartText,n.selImage,n.selSlicer,n.lostConnect,n.coAuth,n.coAuthText,n.wsLockFormat,n.userProtected],menu:new Common.UI.Menu({items:[{caption:e.textHorizontal,iconCls:"menu__icon btn-text-orient-hor",checkable:!0,checkmark:!1,toggleGroup:"textorientgroup",value:"horiz"},{caption:e.textCounterCw,iconCls:"menu__icon btn-text-orient-ccw",checkable:!0,checkmark:!1,toggleGroup:"textorientgroup",value:"countcw"},{caption:e.textClockwise,iconCls:"menu__icon btn-text-orient-cw",checkable:!0,checkmark:!1,toggleGroup:"textorientgroup",value:"clockwise"},{caption:e.textVertical,iconCls:"menu__icon btn-text-orient-vertical",checkable:!0,checkmark:!1,toggleGroup:"textorientgroup",value:"vertical"},{caption:e.textRotateUp,iconCls:"menu__icon btn-text-orient-rup",checkable:!0,checkmark:!1,toggleGroup:"textorientgroup",value:"rotateup"},{caption:e.textRotateDown,iconCls:"menu__icon btn-text-orient-rdown",checkable:!0,checkmark:!1,toggleGroup:"textorientgroup",value:"rotatedown"}]}),dataHint:"1",dataHintDirection:"top"}),e.btnInsertImage=new Common.UI.Button({id:"tlbtn-insertimage",cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-insertimage",caption:e.capInsertImage,lock:[n.editCell,n.lostConnect,n.coAuth,n.Objects],menu:new Common.UI.Menu({items:[{caption:e.mniImageFromFile,value:"file"},{caption:e.mniImageFromUrl,value:"url"},{caption:e.mniImageFromStorage,value:"storage"}]}),dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),e.btnInsertHyperlink=new Common.UI.Button({id:"tlbtn-insertlink",cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-inserthyperlink",caption:e.capInsertHyperlink,lock:[n.editCell,n.selChart,n.selChartText,n.selImage,n.selShape,n.cantHyperlink,n.selSlicer,n.multiselect,n.lostConnect,n.coAuth,n.editPivot,n.InsertHyperlinks,n.userProtected],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),e.btnInsertChart=new Common.UI.Button({id:"tlbtn-insertchart",cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-insertchart",lock:[n.editCell,n.lostConnect,n.coAuth,n.coAuthText,n.Objects],caption:e.capInsertChart,menu:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),e.btnInsertChartRecommend=new Common.UI.Button({id:"tlbtn-insertchartrecommend",cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-recommended-chart",lock:[n.editCell,n.lostConnect,n.coAuth,n.coAuthText,n.Objects],caption:e.capInsertChartRecommend,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),e.btnInsertSparkline=new Common.UI.Button({id:"tlbtn-insertsparkline",cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-sparkline",lock:[n.editCell,n.selChart,n.selChartText,n.selImage,n.selShape,n.selSlicer,n.multiselect,n.lostConnect,n.coAuth,n.coAuthText,n.editPivot,n.wsLock,n.userProtected],caption:e.capInsertSpark,menu:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.btnInsertSmartArt=new Common.UI.Button({id:"tlbtn-insertsmartart",cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-smart-art",lock:[n.editCell,n.lostConnect,n.coAuth,n.Objects],caption:e.capBtnInsSmartArt,menu:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),e.btnInsertShape=new Common.UI.Button({id:"tlbtn-insertshape",cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-insertshape",enableToggle:!0,caption:e.capInsertShape,lock:[n.editCell,n.lostConnect,n.coAuth,n.Objects],menu:new Common.UI.Menu({cls:"menu-shapes menu-insert-shape"}),dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),e.btnInsertText=new Common.UI.Button({id:"tlbtn-inserttext",cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-big-text",caption:e.capInsertText,lock:[n.editCell,n.lostConnect,n.coAuth,n.Objects],enableToggle:!0,split:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small",textboxType:"textRect"}),e.btnInsertTextArt=new Common.UI.Button({id:"tlbtn-inserttextart",cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-textart",caption:e.capInsertTextart,lock:[n.editCell,n.lostConnect,n.coAuth,n.Objects],menu:new Common.UI.Menu({cls:"menu-shapes",items:[{template:_.template('<div id="id-toolbar-menu-insart" class="margin-left-5" style="width: 239px;"></div>')}]}),dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),e.btnInsertEquation=new Common.UI.Button({id:"tlbtn-insertequation",cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-insertequation",caption:e.capInsertEquation,split:!0,lock:[n.editCell,n.lostConnect,n.coAuth],menu:new Common.UI.Menu({cls:"menu-shapes"}),dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),e.btnInsertSymbol=new Common.UI.Button({id:"tlbtn-insertsymbol",cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-symbol",caption:e.capBtnInsSymbol,lock:[n.selImage,n.selChart,n.selShape,n.editFormula,n.selRangeEdit,n.selSlicer,n.coAuth,n.coAuthText,n.lostConnect],menu:new Common.UI.Menu({style:"min-width: 100px;",items:[{template:_.template('<div id="id-toolbar-menu-symbols"></div>')},{caption:"--"},new Common.UI.MenuItem({caption:this.textMoreSymbols})]}),dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),e.btnInsertSlicer=new Common.UI.Button({id:"tlbtn-insertslicer",cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-big-slicer",caption:e.capBtnInsSlicer,lock:[n.editCell,n.selChart,n.selChartText,n.selShape,n.selShapeText,n.selImage,n.selSlicer,n.lostConnect,n.coAuth,n.multiselect,n.noSlicerSource,n.wsLock],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),e.btnTableTemplate=new Common.UI.Button({id:"id-toolbar-btn-ttempl",cls:"btn-toolbar",iconCls:"toolbar__icon btn-menu-table",lock:[n.editCell,n.selChart,n.selChartText,n.selShape,n.selShapeText,n.selImage,n.selSlicer,n.lostConnect,n.coAuth,n.ruleFilter,n.multiselect,n.cantModifyFilter,n.wsLock,n.userProtected],menu:new Common.UI.Menu({items:[{template:_.template('<div id="id-toolbar-menu-table-templates" style="width: 487px; height: 300px; margin: 0px 4px;"></div>')}]}),dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"0, -6"}),e.btnInsertTable=new Common.UI.Button({id:"tlbtn-inserttable",cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-inserttable",caption:e.capInsertTable,lock:[n.editCell,n.selChart,n.selChartText,n.selShape,n.selShapeText,n.selImage,n.selSlicer,n.lostConnect,n.coAuth,n.ruleFilter,n.multiselect,n.cantModifyFilter,n.ruleMerge,n.editPivot,n.wsLock,n.userProtected],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),e.listStyles=new Common.UI.ComboDataView({cls:"combo-cell-styles",enableKeyEvents:!0,itemWidth:100,itemHeight:20,style:"min-width:135px; max-width: 660px;",groups:new Common.UI.DataViewGroupStore,menuMaxHeight:380,lock:[n.editCell,n.selChart,n.selChartText,n.selShape,n.selShapeText,n.selImage,n.selSlicer,n.lostConnect,n.coAuth,n.FormatCells,n.userProtected],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"-16, -4",delayRenderTips:!0,autoWidth:!0,beforeOpenHandler:function(t){var e,i,s,o,n,a=this.openButton.menu;a.cmpEl&&(e=$(a.menuRoot.find(".dataview .item").get(0)),i=$(a.menuRoot.find(".dataview .group-items-container").get(0)),n=parseFloat(e.css("margin-left"))+parseFloat(e.css("margin-right")),1<Common.Utils.applicationPixelRatio()&&Common.Utils.applicationPixelRatio()<2&&(n=-1/Common.Utils.applicationPixelRatio()),e=e.is(":visible")?parseFloat(e.css("width")):this.itemWidth+parseFloat(e.css("padding-left"))+parseFloat(e.css("padding-right"))+parseFloat(e.css("border-left-width"))+parseFloat(e.css("border-right-width")),a.menuAlignEl=this.cmpEl,a.menuAlign="tl-tl",s=$(a.menuRoot.find(".menu-picker-container").get(0)),i=15+parseFloat(i.css("padding-left"))+parseFloat(i.css("padding-right"))+parseFloat(s.css("margin-left"))+parseFloat(s.css("margin-right")),s=Math.ceil(6*(e+n)+i),o=this.openButton.$el.offset().left,s>Common.Utils.innerWidth()&&(s=Math.max(Math.floor((Common.Utils.innerWidth()-i)/(n+e)),2)*(n+e)+i),n=this.cmpEl.width()-this.openButton.$el.width()-Math.min(s,o)-1,Common.UI.isRTL()&&(n=this.openButton.$el.width()),a.setOffset(Common.UI.isRTL()?n:Math.min(n,0)),a.cmpEl.css({width:s,"min-height":this.cmpEl.height()}))}}),s=_.template(["<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%= item.value %>"><a tabindex="-1" type="menuitem">','<div style="position: relative;"><div class="display-value"><%= scope.getDisplayValue(item) %></div>','<div class="example-val"><%= item.exampleval ? item.exampleval : "" %></div>',"</div></a></li>","<% }); %>",'<li class="divider">','<li id="id-toolbar-mnu-item-more-formats" data-value="-1"><a tabindex="-1" type="menuitem">'+e.textMoreFormats+"</a></li>"].join("")),e.cmbNumberFormat=new Common.UI.ComboBoxCustom({cls:"input-group-nr",style:"width: 113px;",menuStyle:"min-width: 180px;",hint:e.tipNumFormat,lock:[n.editCell,n.selChart,n.selChartText,n.selShape,n.selShapeText,n.selImage,n.selSlicer,n.selRangeEdit,n.lostConnect,n.coAuth,n.FormatCells,n.userProtected],itemsTemplate:s,editable:!1,focusWhenNoSelection:!1,data:e.numFormatData,dataHint:"1",dataHintDirection:"top",updateFormControl:function(t){this.clearSelection(),t&&this.setRawValue(t.get("customDisplayValue")||t.get("displayValue"))}}),e.btnPercentStyle=new Common.UI.Button({id:"id-toolbar-btn-percent-style",cls:"btn-toolbar",iconCls:"toolbar__icon btn-percent-style",lock:[n.editCell,n.selChart,n.selChartText,n.selShape,n.selShapeText,n.selImage,n.selSlicer,n.lostConnect,n.coAuth,n.FormatCells,n.userProtected],styleName:"Percent",dataHint:"1",dataHintDirection:"bottom"}),e.btnCurrencyStyle=new Common.UI.Button({id:"id-toolbar-btn-accounting-style",cls:"btn-toolbar",iconCls:"toolbar__icon btn-currency-style",lock:[n.editCell,n.selChart,n.selChartText,n.selShape,n.selShapeText,n.selImage,n.selSlicer,n.lostConnect,n.coAuth,n.FormatCells,n.userProtected],styleName:"Currency",split:!0,menu:new Common.UI.Menu({style:"min-width: 120px;",items:[{caption:e.txtYuan,value:2052},{caption:e.txtDollar,value:1033},{caption:e.txtEuro,value:1031},{caption:e.txtPound,value:2057},{caption:e.txtRouble,value:1049},{caption:"--"},{caption:e.textMoreFormats,value:-1}]}),dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"0, -16"}),e.btnDecDecimal=new Common.UI.Button({id:"id-toolbar-btn-decdecimal",cls:"btn-toolbar",iconCls:"toolbar__icon btn-decdecimal",lock:[n.editCell,n.selChart,n.selChartText,n.selShape,n.selShapeText,n.selImage,n.selSlicer,n.lostConnect,n.coAuth,n.FormatCells,n.userProtected],dataHint:"1",dataHintDirection:"bottom"}),e.btnIncDecimal=new Common.UI.Button({id:"id-toolbar-btn-incdecimal",cls:"btn-toolbar",iconCls:"toolbar__icon btn-incdecimal",lock:[n.editCell,n.selChart,n.selChartText,n.selShape,n.selShapeText,n.selImage,n.selSlicer,n.lostConnect,n.coAuth,n.FormatCells,n.userProtected],dataHint:"1",dataHintDirection:"bottom"}),e.btnInsertFormula=new Common.UI.Button({id:"id-toolbar-btn-insertformula",cls:"btn-toolbar",iconCls:"toolbar__icon btn-formula",split:!0,lock:[n.editText,n.selChart,n.selChartText,n.selShape,n.selShapeText,n.selImage,n.selSlicer,n.selRangeEdit,n.lostConnect,n.coAuth,n.userProtected],menu:new Common.UI.Menu({style:"min-width: 110px",items:[{caption:"SUM",value:"SUM"},{caption:"AVERAGE",value:"AVERAGE"},{caption:"MIN",value:"MIN"},{caption:"MAX",value:"MAX"},{caption:"COUNT",value:"COUNT"},{caption:"--"},{caption:e.txtAdditional,value:"more",hint:e.txtFormula+Common.Utils.String.platformKey("Shift+F3")}]}),dataHint:"1",dataHintDirection:"top",dataHintOffset:"0, -16"}),e.btnNamedRange=new Common.UI.Button({id:"id-toolbar-btn-insertrange",cls:"btn-toolbar",iconCls:"toolbar__icon btn-named-range",lock:[n.selChart,n.selChartText,n.selShape,n.selShapeText,n.selImage,n.lostConnect,n.coAuth,n.selRangeEdit,n.wsLock],menu:new Common.UI.Menu({style:"min-width: 110px",items:[{caption:e.txtManageRange,lock:[n.editCell],value:"manage"},{caption:e.txtNewRange,lock:[n.editCell],value:"new"},{caption:e.txtPasteRange,lock:[n.userProtected],value:"paste"}]}),dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"0, -6"}),e.btnFillNumbers=new Common.UI.Button({id:"id-toolbar-btn-fill-num",cls:"btn-toolbar",iconCls:"toolbar__icon btn-fill",lock:[n.selChart,n.selChartText,n.selShape,n.selShapeText,n.selImage,n.lostConnect,n.coAuth,n.selRangeEdit,n.wsLock],menu:new Common.UI.Menu({style:"min-width: 110px",items:[{caption:e.textDown,value:Asc.c_oAscFillType.fillDown},{caption:e.textFillRight,value:Asc.c_oAscFillType.fillRight},{caption:e.textUp,value:Asc.c_oAscFillType.fillUp},{caption:e.textFillLeft,value:Asc.c_oAscFillType.fillLeft},{caption:"--"},{caption:e.textSeries,value:Asc.c_oAscFillType.series}]}),dataHint:"1",dataHintDirection:"top",dataHintOffset:"0, -16"}),e.btnClearStyle=new Common.UI.Button({id:"id-toolbar-btn-clear",cls:"btn-toolbar",iconCls:"toolbar__icon btn-clearstyle",lock:[n.lostConnect,n.coAuth,n.selRangeEdit,n.selSlicer,n.userProtected],menu:new Common.UI.Menu({style:"min-width: 110px",items:[{caption:e.txtClearAll,lock:[n.cantModifyFilter],value:Asc.c_oAscCleanOptions.All},{caption:e.txtClearText,lock:[n.editCell,n.selChart,n.selChartText,n.selShape,n.selShapeText,n.selImage,n.coAuth],value:Asc.c_oAscCleanOptions.Text},{caption:e.txtClearFormat,lock:[n.editCell,n.selChart,n.selChartText,n.selShape,n.selShapeText,n.selImage,n.coAuth,n.cantModifyFilter],value:Asc.c_oAscCleanOptions.Format},{caption:e.txtClearComments,lock:[n.editCell,n.selChart,n.selChartText,n.selShape,n.selShapeText,n.selImage,n.coAuth],value:Asc.c_oAscCleanOptions.Comments},{caption:e.txtClearHyper,lock:[n.editCell,n.selChart,n.selChartText,n.selShape,n.selShapeText,n.selImage,n.coAuth],value:Asc.c_oAscCleanOptions.Hyperlinks}]}),dataHint:"1",dataHintDirection:"top",dataHintOffset:"0, -6"}),e.btnCopyStyle=new Common.UI.Button({id:"id-toolbar-btn-copystyle",cls:"btn-toolbar",iconCls:"toolbar__icon btn-copystyle",lock:[n.editCell,n.lostConnect,n.coAuth,n.selChart,n.selSlicer],enableToggle:!0,dataHint:"1",dataHintDirection:"bottom"}),e.btnAddCell=new Common.UI.Button({id:"id-toolbar-btn-addcell",cls:"btn-toolbar",iconCls:"toolbar__icon btn-addcell",lock:[n.editCell,n.selChart,n.selChartText,n.selShape,n.selShapeText,n.selImage,n.selSlicer,n.itemsDisabled,n.lostConnect,n.coAuth,n.userProtected],menu:new Common.UI.Menu({items:[{caption:e.textInsRight,value:Asc.c_oAscInsertOptions.InsertCellsAndShiftRight,lock:[n.wsLock]},{caption:e.textInsDown,value:Asc.c_oAscInsertOptions.InsertCellsAndShiftDown,lock:[n.wsLock]},{caption:e.textEntireRow,value:Asc.c_oAscInsertOptions.InsertRows},{caption:e.textEntireCol,value:Asc.c_oAscInsertOptions.InsertColumns}]}),dataHint:"1",dataHintDirection:"top",dataHintOffset:"0, -6"}),e.btnDeleteCell=new Common.UI.Button({id:"id-toolbar-btn-delcell",cls:"btn-toolbar",iconCls:"toolbar__icon btn-delcell",lock:[n.editCell,n.selChart,n.selChartText,n.selShape,n.selShapeText,n.selImage,n.selSlicer,n.itemsDisabled,n.lostConnect,n.coAuth,n.userProtected],menu:new Common.UI.Menu({items:[{caption:e.textDelLeft,value:Asc.c_oAscDeleteOptions.DeleteCellsAndShiftLeft,lock:[n.wsLock]},{caption:e.textDelUp,value:Asc.c_oAscDeleteOptions.DeleteCellsAndShiftTop,lock:[n.wsLock]},{caption:e.textEntireRow,value:Asc.c_oAscDeleteOptions.DeleteRows},{caption:e.textEntireCol,value:Asc.c_oAscDeleteOptions.DeleteColumns}]}),dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"0, -6"}),e.btnCondFormat=new Common.UI.Button({id:"id-toolbar-btn-condformat",cls:"btn-toolbar",iconCls:"toolbar__icon btn-cond-format",lock:[n.editCell,n.selChart,n.selChartText,n.selShape,n.selShapeText,n.selImage,n.lostConnect,n.coAuth,n.FormatCells,n.userProtected],menu:!0,dataHint:"1",dataHintDirection:"top",dataHintOffset:"0, -6"}),e.btnColorSchemas=new Common.UI.Button({id:"id-toolbar-btn-colorschemas",cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-big-colorschemas",caption:e.capBtnColorSchemas,lock:[n.editCell,n.lostConnect,n.coAuth,n.wsLock],menu:new Common.UI.Menu({cls:"shifted-left",items:[],restoreHeight:!0}),dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),s=Common.localStorage.getItem("sse-hide-synch"),e.showSynchTip=!(s&&1==parseInt(s)),e.btnPageOrient=new Common.UI.Button({id:"tlbtn-pageorient",cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-pageorient",caption:e.capBtnPageOrient,lock:[n.docPropsLock,n.lostConnect,n.coAuth,n.editCell,n.selRangeEdit],menu:new Common.UI.Menu({cls:"ppm-toolbar",items:[{caption:e.textPortrait,iconCls:"menu__icon btn-page-portrait",checkable:!0,checkmark:!1,toggleGroup:"menuOrient",value:Asc.c_oAscPageOrientation.PagePortrait},{caption:e.textLandscape,iconCls:"menu__icon btn-page-landscape",checkable:!0,checkmark:!1,toggleGroup:"menuOrient",value:Asc.c_oAscPageOrientation.PageLandscape}]}),dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),s=Common.UI.isRTL()?_.template('<a id="<%= id %>" tabindex="-1" type="menuitem"><div><b><%= caption %></b></div><% if (options.value !== null) { %><div class="margin-vertical"><label><%= Common.Utils.Metric.getCurrentMetricName() %> <%= parseFloat(Common.Utils.Metric.fnRecalcFromMM(options.value[0]).toFixed(2)) %>'+this.textTop+"</label><label><%= Common.Utils.Metric.getCurrentMetricName() %> <%= parseFloat(Common.Utils.Metric.fnRecalcFromMM(options.value[1]).toFixed(2)) %>"+this.textLeft+'</label></div><div class="margin-horizontal"><label><%= Common.Utils.Metric.getCurrentMetricName() %> <%= parseFloat(Common.Utils.Metric.fnRecalcFromMM(options.value[2]).toFixed(2)) %>'+this.textBottom+"</label><label><%= Common.Utils.Metric.getCurrentMetricName() %> <%= parseFloat(Common.Utils.Metric.fnRecalcFromMM(options.value[3]).toFixed(2)) %>"+this.textRight+"</label></div><% } %></a>"):_.template('<a id="<%= id %>" tabindex="-1" type="menuitem"><div><b><%= caption %></b></div><% if (options.value !== null) { %><div class="margin-vertical"><label>'+this.textTop+"<%= parseFloat(Common.Utils.Metric.fnRecalcFromMM(options.value[0]).toFixed(2)) %> <%= Common.Utils.Metric.getCurrentMetricName() %></label><label>"+this.textLeft+'<%= parseFloat(Common.Utils.Metric.fnRecalcFromMM(options.value[1]).toFixed(2)) %> <%= Common.Utils.Metric.getCurrentMetricName() %></label></div><div class="margin-horizontal"><label>'+this.textBottom+"<%= parseFloat(Common.Utils.Metric.fnRecalcFromMM(options.value[2]).toFixed(2)) %> <%= Common.Utils.Metric.getCurrentMetricName() %></label><label>"+this.textRight+"<%= parseFloat(Common.Utils.Metric.fnRecalcFromMM(options.value[3]).toFixed(2)) %> <%= Common.Utils.Metric.getCurrentMetricName() %></label></div><% } %></a>"),e.btnPageMargins=new Common.UI.Button({id:"tlbtn-pagemargins",cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-pagemargins",caption:e.capBtnMargins,lock:[n.docPropsLock,n.lostConnect,n.coAuth,n.editCell,n.selRangeEdit],menu:new Common.UI.Menu({cls:"menu-margins",items:[{caption:e.textMarginsLast,checkable:!0,template:s,toggleGroup:"menuPageMargins"},{caption:e.textMarginsNormal,checkable:!0,template:s,toggleGroup:"menuPageMargins",value:[19.1,17.8,19.1,17.8]},{caption:e.textMarginsNarrow,checkable:!0,template:s,toggleGroup:"menuPageMargins",value:[19.1,6.4,19.1,6.4]},{caption:e.textMarginsWide,checkable:!0,template:s,toggleGroup:"menuPageMargins",value:[25.4,25.4,25.4,25.4]},{caption:"--"},{caption:e.textPageMarginsCustom,value:"advanced"}]}),dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),s=Common.UI.isRTL()?_.template('<a id="<%= id %>" tabindex="-1" type="menuitem"><div><b><%= caption %></b></div><div dir="ltr"><%= Common.Utils.Metric.getCurrentMetricName() %> <%= parseFloat(Common.Utils.Metric.fnRecalcFromMM(options.value[1]).toFixed(2)) %> x <%= Common.Utils.Metric.getCurrentMetricName() %> <%= parseFloat(Common.Utils.Metric.fnRecalcFromMM(options.value[0]).toFixed(2)) %></div></a>'):_.template('<a id="<%= id %>" tabindex="-1" type="menuitem"><div><b><%= caption %></b></div><div dir="ltr"><%= parseFloat(Common.Utils.Metric.fnRecalcFromMM(options.value[0]).toFixed(2)) %> <%= Common.Utils.Metric.getCurrentMetricName() %> x <%= parseFloat(Common.Utils.Metric.fnRecalcFromMM(options.value[1]).toFixed(2)) %> <%= Common.Utils.Metric.getCurrentMetricName() %></div></a>'),e.btnPageSize=new Common.UI.Button({id:"tlbtn-pagesize",cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-pagesize",caption:e.capBtnPageSize,lock:[n.docPropsLock,n.lostConnect,n.coAuth,n.editCell,n.selRangeEdit],menu:new Common.UI.Menu({restoreHeight:!0,items:[{caption:"US Letter",subtitle:"21,59cm x 27,94cm",template:s,checkable:!0,toggleGroup:"menuPageSize",value:[215.9,279.4]},{caption:"US Legal",subtitle:"21,59cm x 35,56cm",template:s,checkable:!0,toggleGroup:"menuPageSize",value:[215.9,355.6]},{caption:"A4",subtitle:"21cm x 29,7cm",template:s,checkable:!0,toggleGroup:"menuPageSize",value:[210,297],checked:!0},{caption:"A5",subtitle:"14,81cm x 20,99cm",template:s,checkable:!0,toggleGroup:"menuPageSize",value:[148,210]},{caption:"B5",subtitle:"17,6cm x 25,01cm",template:s,checkable:!0,toggleGroup:"menuPageSize",value:[176,250]},{caption:"Envelope #10",subtitle:"10,48cm x 24,13cm",template:s,checkable:!0,toggleGroup:"menuPageSize",value:[104.8,241.3]},{caption:"Envelope DL",subtitle:"11,01cm x 22,01cm",template:s,checkable:!0,toggleGroup:"menuPageSize",value:[110,220]},{caption:"Tabloid",subtitle:"27,94cm x 43,17cm",template:s,checkable:!0,toggleGroup:"menuPageSize",value:[279.4,431.8]},{caption:"A3",subtitle:"29,7cm x 42,01cm",template:s,checkable:!0,toggleGroup:"menuPageSize",value:[297,420]},{caption:"Tabloid Oversize",subtitle:"30,48cm x 45,71cm",template:s,checkable:!0,toggleGroup:"menuPageSize",value:[304.8,457.1]},{caption:"ROC 16K",subtitle:"19,68cm x 27,3cm",template:s,checkable:!0,toggleGroup:"menuPageSize",value:[196.8,273]},{caption:"Envelope Choukei 3",subtitle:"11,99cm x 23,49cm",template:s,checkable:!0,toggleGroup:"menuPageSize",value:[119.9,234.9]},{caption:"Super B/A3",subtitle:"33,02cm x 48,25cm",template:s,checkable:!0,toggleGroup:"menuPageSize",value:[330.2,482.5]}]}),dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),e.mnuPageSize=e.btnPageSize.menu,e.btnPrintArea=new Common.UI.Button({id:"tlbtn-printarea",cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-print-area",caption:e.capBtnPrintArea,lock:[n.selChart,n.selChartText,n.selShape,n.selShapeText,n.selImage,n.selSlicer,n.editCell,n.selRangeEdit,n.printAreaLock,n.lostConnect,n.coAuth],menu:new Common.UI.Menu({cls:"ppm-toolbar",items:[{caption:e.textSetPrintArea,lock:[n.namedRangeLock],value:Asc.c_oAscChangePrintAreaType.set},{caption:e.textClearPrintArea,value:Asc.c_oAscChangePrintAreaType.clear},{caption:e.textAddPrintArea,lock:[n.namedRangeLock],value:Asc.c_oAscChangePrintAreaType.add}]}),dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),e.btnPageBreak=new Common.UI.Button({id:"tlbtn-pagebreak",cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-pagebreak",caption:e.capBtnPageBreak,lock:[n.docPropsLock,n.selChart,n.selChartText,n.selShape,n.selShapeText,n.selImage,n.selSlicer,n.editCell,n.selRangeEdit,n.pageBreakLock,n.lostConnect,n.coAuth],menu:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),e.mnuCustomScale=new Common.UI.MenuItem({template:_.template('<div id="id-toolbar-scale-updownpicker" class="custom-scale" data-stopPropagation="true"></div>'),stopPropagation:!0,value:4}),e.btnScale=new Common.UI.Button({id:"tlbtn-scale",cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-scale",caption:e.capBtnScale,lock:[n.docPropsLock,n.lostConnect,n.coAuth,n.editCell,n.selRangeEdit],menu:new Common.UI.Menu({items:[],cls:"scale-menu"}),dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),s=new Common.UI.MenuItem({caption:e.textWidth,menu:new Common.UI.Menu({menuAlign:"tl-tr",items:[{caption:this.textAuto,value:0,checkable:!0,toggleGroup:"scaleWidth"},{caption:"1 "+this.textOnePage,value:1,checkable:!0,toggleGroup:"scaleWidth"},{caption:"2 "+this.textFewPages,value:2,checkable:!0,toggleGroup:"scaleWidth"},{caption:"3 "+this.textFewPages,value:3,checkable:!0,toggleGroup:"scaleWidth"},{caption:"4 "+this.textFewPages,value:4,checkable:!0,toggleGroup:"scaleWidth"},{caption:"5 "+this.textManyPages,value:5,checkable:!0,toggleGroup:"scaleWidth"},{caption:"6 "+this.textManyPages,value:6,checkable:!0,toggleGroup:"scaleWidth"},{caption:"7 "+this.textManyPages,value:7,checkable:!0,toggleGroup:"scaleWidth"},{caption:"8 "+this.textManyPages,value:8,checkable:!0,toggleGroup:"scaleWidth"},{caption:"9 "+this.textManyPages,value:9,checkable:!0,toggleGroup:"scaleWidth"},{caption:"--"},{caption:this.textMorePages,value:"more",checkable:!0,toggleGroup:"scaleWidth"}]})}),o=new Common.UI.MenuItem({caption:e.textHeight,menu:new Common.UI.Menu({menuAlign:"tl-tr",items:[{caption:this.textAuto,value:0,checkable:!0,toggleGroup:"scaleHeight"},{caption:"1 "+this.textOnePage,value:1,checkable:!0,toggleGroup:"scaleHeight"},{caption:"2 "+this.textFewPages,value:2,checkable:!0,toggleGroup:"scaleHeight"},{caption:"3 "+this.textFewPages,value:3,checkable:!0,toggleGroup:"scaleHeight"},{caption:"4 "+this.textFewPages,value:4,checkable:!0,toggleGroup:"scaleHeight"},{caption:"5 "+this.textManyPages,value:5,checkable:!0,toggleGroup:"scaleHeight"},{caption:"6 "+this.textManyPages,value:6,checkable:!0,toggleGroup:"scaleHeight"},{caption:"7 "+this.textManyPages,value:7,checkable:!0,toggleGroup:"scaleHeight"},{caption:"8 "+this.textManyPages,value:8,checkable:!0,toggleGroup:"scaleHeight"},{caption:"9 "+this.textManyPages,value:9,checkable:!0,toggleGroup:"scaleHeight"},{caption:"--"},{caption:this.textMorePages,value:"more",checkable:!0,toggleGroup:"scaleHeight"}]})}),e.btnScale.menu.addItem(s),e.btnScale.menu.addItem(o),e.btnScale.menu.addItem(e.mnuCustomScale),e.btnScale.menu.addItem({caption:"--"}),e.btnScale.menu.addItem({caption:e.textScaleCustom,value:"custom"}),e.menuWidthScale=e.btnScale.menu.items[0].menu,e.menuHeightScale=e.btnScale.menu.items[1].menu,e.mnuScale=e.btnScale.menu,e.mnuScale.on("show:after",_.bind(e.onAfterShowMenuScale,e)),e.btnPrintTitles=new Common.UI.Button({id:"tlbtn-printtitles",cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-print-titles",caption:e.capBtnPrintTitles,lock:[n.docPropsLock,n.lostConnect,n.coAuth,n.editCell,n.selRangeEdit],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),e.chPrintGridlines=new Common.UI.CheckBox({labelText:this.textPrintGridlines,lock:[n.selRange,n.selRangeEdit,n.lostConnect,n.coAuth,n.coAuthText,n.Objects],dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),e.chPrintHeadings=new Common.UI.CheckBox({labelText:this.textPrintHeadings,lock:[n.selRange,n.selRangeEdit,n.lostConnect,n.coAuth,n.coAuthText,n.Objects],dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),e.btnImgAlign=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-img-align",caption:e.capImgAlign,lock:[n.selRange,n.selRangeEdit,n.cantGroup,n.lostConnect,n.coAuth,n.coAuthText,n.Objects],menu:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),e.btnImgGroup=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-img-group",caption:e.capImgGroup,lock:[n.selRange,n.selRangeEdit,n.cantGroupUngroup,n.lostConnect,n.coAuth,n.coAuthText,n.Objects],menu:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),e.btnImgForward=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-img-frwd",caption:e.capImgForward,split:!0,lock:[n.selRange,n.selRangeEdit,n.lostConnect,n.coAuth,n.coAuthText,n.Objects,n.inSmartartInternal],menu:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),e.btnImgBackward=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-img-bkwd",caption:e.capImgBackward,lock:[n.selRange,n.selRangeEdit,n.lostConnect,n.coAuth,n.coAuthText,n.Objects,n.inSmartartInternal],split:!0,menu:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"})):Common.UI.Mixtbar.prototype.initialize.call(this,{template:_.template(r),tabs:[{caption:e.textTabFile,action:"file",layoutname:"toolbar-file",haspanel:!1,dataHintTitle:"F"}]}),e.lockControls=[],t.isEdit&&(e.lockControls=[e.cmbFontName,e.cmbFontSize,e.btnIncFontSize,e.btnDecFontSize,e.btnChangeCase,e.btnBold,e.btnItalic,e.btnUnderline,e.btnStrikeout,e.btnSubscript,e.btnTextColor,e.btnAlignLeft,e.btnAlignCenter,e.btnAlignRight,e.btnAlignJust,e.btnAlignTop,e.btnAlignMiddle,e.btnAlignBottom,e.btnWrap,e.btnTextOrient,e.btnBackColor,e.btnInsertTable,e.btnMerge,e.btnInsertFormula,e.btnNamedRange,e.btnFillNumbers,e.btnIncDecimal,e.btnInsertShape,e.btnInsertSmartArt,e.btnInsertEquation,e.btnInsertSymbol,e.btnInsertSlicer,e.btnInsertText,e.btnInsertTextArt,e.btnSortUp,e.btnSortDown,e.btnSetAutofilter,e.btnClearAutofilter,e.btnTableTemplate,e.btnCellStyle,e.btnPercentStyle,e.btnCurrencyStyle,e.btnDecDecimal,e.btnAddCell,e.btnDeleteCell,e.btnCondFormat,e.cmbNumberFormat,e.btnBorders,e.btnInsertImage,e.btnInsertHyperlink,e.btnInsertChart,e.btnInsertChartRecommend,e.btnColorSchemas,e.btnInsertSparkline,e.btnCopy,e.btnPaste,e.btnCut,e.btnSelectAll,e.listStyles,e.btnPrint,e.btnClearStyle,e.btnCopyStyle,e.btnPageMargins,e.btnPageSize,e.btnPageOrient,e.btnPrintArea,e.btnPageBreak,e.btnPrintTitles,e.btnImgAlign,e.btnImgBackward,e.btnImgForward,e.btnImgGroup,e.btnScale,e.chPrintGridlines,e.chPrintHeadings,e.btnVisibleArea,e.btnVisibleAreaClose,e.btnTextFormatting,e.btnHorizontalAlign,e.btnVerticalAlign],_.each(e.lockControls.concat([e.btnSave]),function(t){t&&_.isFunction(t.setDisabled)&&t.setDisabled(!0)}),this.lockToolbar(Common.enumLock.disableOnStart,!0,{array:[e.btnPrint]}),this.on("render:after",_.bind(this.onToolbarAfterRender,this))),this},onAfterShowMenuScale:function(){var e=this;e.mnuScalePicker||(e.mnuScalePicker=new Common.UI.UpDownPicker({el:$("#id-toolbar-scale-updownpicker"),caption:e.textScale}),e.mnuScalePicker.on("click",_.bind(function(t){e.fireEvent("change:scalespn",[t,e.valueCustomScale],e)},e))),e.api&&(e.valueCustomScale=e.api.asc_getPageOptions().asc_getPageSetup().asc_getScale(),e.mnuScalePicker.setValue(e.valueCustomScale+"%")),e.itemCustomScale||(e.itemCustomScale=$(".custom-scale",e.mnuCustomScale.$el).on("click",_.bind(function(){e.fireEvent("click:customscale",["scale",void 0,void 0,void 0,e.valueCustomScale],e)},e))),SSE.getController("Toolbar").onChangeScaleSettings()},setValueCustomScale:function(t){this.api&&null!=t&&(this.valueCustomScale=t,this.mnuScalePicker&&this.mnuScalePicker.setValue(this.valueCustomScale+"%"))},render:function(t){var e=this;return e.isCompactView=t.isCompactView,this.fireEvent("render:before",[this]),t.isEdit?e.$el.html(e.rendererComponents(e.$layout)):(e.$layout.find(".canedit").hide(),e.$layout.addClass("folded"),e.$el.html(e.$layout)),this.fireEvent("render:after",[this]),Common.UI.Mixtbar.prototype.afterRender.call(this),Common.NotificationCenter.on({"window:resize":function(){Common.UI.Mixtbar.prototype.onResize.apply(e,arguments)}}),t.isEdit&&(t.isEditDiagram||t.isEditMailMerge||t.isEditOle||(e.onUpdateLastCustomMargins(),Common.NotificationCenter.on("margins:update",_.bind(e.onUpdateLastCustomMargins,e)),this.btnInsertImage.menu.items[2].setVisible(t.canRequestInsertImage||t.fileChoiceUrl&&-1<t.fileChoiceUrl.indexOf("{documentType}"))),e.setTab("home")),e.isCompactView&&e.setFolded(!0),this},onTabClick:function(t){var t=$(t.currentTarget).find("> a[data-tab]").data("tab"),e=this.isTabActive("file");Common.UI.Mixtbar.prototype.onTabClick.apply(this,arguments),e?this.fireEvent("file:close"):"file"==t&&(this.fireEvent("file:open"),this.setTab(t)),this.isTabActive("home")&&this.fireEvent("home:open"),this.isTabActive("pivot")&&(e=SSE.getController("PivotTable"))&&e.getView("PivotTable").fireEvent("pivot:open")},rendererComponents:function(t){function e(t,e){Common.Utils.injectComponent(i.find(t),e)}var i=$(t);return e("#slot-field-fontname",this.cmbFontName),e("#slot-field-fontsize",this.cmbFontSize),e("#slot-btn-print",this.btnPrint),e("#slot-btn-save",this.btnSave),e("#slot-btn-undo",this.btnUndo),e("#slot-btn-redo",this.btnRedo),e("#slot-btn-copy",this.btnCopy),e("#slot-btn-paste",this.btnPaste),e("#slot-btn-cut",this.btnCut),e("#slot-btn-select-all",this.btnSelectAll),e("#slot-btn-incfont",this.btnIncFontSize),e("#slot-btn-decfont",this.btnDecFontSize),e("#slot-btn-bold",this.btnBold),e("#slot-btn-italic",this.btnItalic),e("#slot-btn-underline",this.btnUnderline),e("#slot-btn-strikeout",this.btnStrikeout),e("#slot-btn-subscript",this.btnSubscript),e("#slot-btn-fontcolor",this.btnTextColor),e("#slot-btn-fillparag",this.btnBackColor),e("#slot-btn-borders",this.btnBorders),e("#slot-btn-align-left",this.btnAlignLeft),e("#slot-btn-align-center",this.btnAlignCenter),e("#slot-btn-align-right",this.btnAlignRight),e("#slot-btn-align-just",this.btnAlignJust),e("#slot-btn-merge",this.btnMerge),e("#slot-btn-top",this.btnAlignTop),e("#slot-btn-middle",this.btnAlignMiddle),e("#slot-btn-bottom",this.btnAlignBottom),e("#slot-btn-wrap",this.btnWrap),e("#slot-btn-text-orient",this.btnTextOrient),e("#slot-btn-insimage",this.btnInsertImage),e("#slot-btn-instable",this.btnInsertTable),e("#slot-btn-inshyperlink",this.btnInsertHyperlink),e("#slot-btn-insshape",this.btnInsertShape),e("#slot-btn-instext",this.btnInsertText),e("#slot-btn-instextart",this.btnInsertTextArt),e("#slot-btn-insequation",this.btnInsertEquation),e("#slot-btn-inssymbol",this.btnInsertSymbol),e("#slot-btn-insslicer",this.btnInsertSlicer),e("#slot-btn-sortdesc",this.btnSortDown),e("#slot-btn-sortasc",this.btnSortUp),e("#slot-btn-setfilter",this.btnSetAutofilter),e("#slot-btn-clear-filter",this.btnClearAutofilter),e("#slot-btn-table-tpl",this.btnTableTemplate),e("#slot-btn-cell-style",this.btnCellStyle),e("#slot-btn-format",this.cmbNumberFormat),e("#slot-btn-percents",this.btnPercentStyle),e("#slot-btn-currency",this.btnCurrencyStyle),e("#slot-btn-digit-dec",this.btnDecDecimal),e("#slot-btn-digit-inc",this.btnIncDecimal),e("#slot-btn-formula",this.btnInsertFormula),e("#slot-btn-named-range",this.btnNamedRange),e("#slot-btn-fill-num",this.btnFillNumbers),e("#slot-btn-clear",this.btnClearStyle),e("#slot-btn-copystyle",this.btnCopyStyle),e("#slot-btn-cell-ins",this.btnAddCell),e("#slot-btn-cell-del",this.btnDeleteCell),e("#slot-btn-colorschemas",this.btnColorSchemas),e("#slot-btn-search",this.btnSearch),e("#slot-btn-inschart",this.btnInsertChart),e("#slot-btn-insrecommend",this.btnInsertChartRecommend),e("#slot-btn-inssparkline",this.btnInsertSparkline),e("#slot-btn-inssmartart",this.btnInsertSmartArt),e("#slot-field-styles",this.listStyles),e("#slot-btn-chart",this.btnEditChart),e("#slot-btn-chart-data",this.btnEditChartData),e("#slot-btn-chart-type",this.btnEditChartType),e("#slot-btn-pageorient",this.btnPageOrient),e("#slot-btn-pagemargins",this.btnPageMargins),e("#slot-btn-pagesize",this.btnPageSize),e("#slot-btn-printarea",this.btnPrintArea),e("#slot-btn-pagebreak",this.btnPageBreak),e("#slot-btn-printtitles",this.btnPrintTitles),e("#slot-chk-print-gridlines",this.chPrintGridlines),e("#slot-chk-print-headings",this.chPrintHeadings),e("#slot-img-align",this.btnImgAlign),e("#slot-img-group",this.btnImgGroup),e("#slot-img-movefrwd",this.btnImgForward),e("#slot-img-movebkwd",this.btnImgBackward),e("#slot-btn-scale",this.btnScale),e("#slot-btn-condformat",this.btnCondFormat),e("#slot-btn-visible-area",this.btnVisibleArea),e("#slot-btn-visible-area-close",this.btnVisibleAreaClose),e("#slot-btn-formatting",this.btnTextFormatting),e("#slot-btn-halign",this.btnHorizontalAlign),e("#slot-btn-valign",this.btnVerticalAlign),e("#slot-btn-changecase",this.btnChangeCase),this.btnsEditHeader=Common.Utils.injectButtons(i.find(".slot-editheader"),"tlbtn-editheader-","toolbar__icon btn-editheader",this.capBtnInsHeader,[Common.enumLock.editCell,Common.enumLock.selRangeEdit,Common.enumLock.headerLock,Common.enumLock.lostConnect,Common.enumLock.coAuth],void 0,void 0,void 0,"1","bottom","small"),Array.prototype.push.apply(this.lockControls,this.btnsEditHeader),this.btnPrint&&this.btnPrint.menu&&this.btnPrint.$el.addClass("split"),i},createDelayedElements:function(){var t,e,i,s,n,a=this;function o(t,e){t&&t.updateHint(e)}o(this.btnPrint,this.tipPrint+Common.Utils.String.platformKey("Ctrl+P")),o(this.btnSave,this.btnSaveTip),o(this.btnCopy,this.tipCopy+Common.Utils.String.platformKey("Ctrl+C")),o(this.btnPaste,this.tipPaste+Common.Utils.String.platformKey("Ctrl+V")),o(this.btnCut,this.tipCut+Common.Utils.String.platformKey("Ctrl+X")),o(this.btnSelectAll,this.tipSelectAll+Common.Utils.String.platformKey("Ctrl+A")),o(this.btnUndo,this.tipUndo+Common.Utils.String.platformKey("Ctrl+Z")),o(this.btnRedo,this.tipRedo+Common.Utils.String.platformKey("Ctrl+Y")),o(this.btnIncFontSize,this.tipIncFont+Common.Utils.String.platformKey("Ctrl+]")),o(this.btnDecFontSize,this.tipDecFont+Common.Utils.String.platformKey("Ctrl+[")),o(this.btnChangeCase,this.tipChangeCase),o(this.btnBold,this.textBold+Common.Utils.String.platformKey("Ctrl+B")),o(this.btnItalic,this.textItalic+Common.Utils.String.platformKey("Ctrl+I")),o(this.btnUnderline,this.textUnderline+Common.Utils.String.platformKey("Ctrl+U")),o(this.btnStrikeout,this.textStrikeout),o(this.btnSubscript,this.textSubSuperscript),o(this.btnTextColor,this.tipFontColor),o(this.btnBackColor,this.tipPrColor),o(this.btnBorders,this.tipBorders),o(this.btnAlignLeft,this.tipAlignLeft),o(this.btnAlignCenter,this.tipAlignCenter),o(this.btnAlignRight,this.tipAlignRight),o(this.btnAlignJust,this.tipAlignJust),o(this.btnMerge,this.tipMerge),o(this.btnAlignTop,this.tipAlignTop),o(this.btnAlignMiddle,this.tipAlignMiddle),o(this.btnAlignBottom,this.tipAlignBottom),o(this.btnWrap,this.tipWrap),o(this.btnTextOrient,this.tipTextOrientation),o(this.btnInsertTable,this.tipInsertTable),o(this.btnInsertImage,this.tipInsertImage),o(this.btnInsertChart,this.tipInsertChartSpark),o(this.btnInsertChartRecommend,this.tipInsertChartRecommend),o(this.btnInsertSparkline,this.tipInsertSpark),o(this.btnInsertSmartArt,this.tipInsertSmartArt),o(this.btnInsertText,[this.tipInsertHorizontalText,this.tipInsertText]),o(this.btnInsertTextArt,this.tipInsertTextart),o(this.btnInsertHyperlink,this.tipInsertHyperlink+Common.Utils.String.platformKey("Ctrl+K")),o(this.btnInsertShape,this.tipInsertShape),o(this.btnInsertEquation,this.tipInsertEquation),o(this.btnInsertSymbol,this.tipInsertSymbol),o(this.btnInsertSlicer,this.tipInsertSlicer),o(this.btnSortDown,this.txtSortAZ),o(this.btnSortUp,this.txtSortZA),o(this.btnSetAutofilter,this.txtFilter+" (Ctrl+Shift+L)"),o(this.btnClearAutofilter,this.txtClearFilter),o(this.btnSearch,this.txtSearch),o(this.btnTableTemplate,this.txtTableTemplate),o(this.btnCellStyle,this.txtCellStyle),o(this.btnPercentStyle,this.tipDigStylePercent),o(this.btnCurrencyStyle,this.tipDigStyleAccounting),o(this.btnDecDecimal,this.tipDecDecimal),o(this.btnIncDecimal,this.tipIncDecimal),o(this.btnInsertFormula,[this.txtAutosumTip+Common.Utils.String.platformKey("Alt+="),this.txtFormula+Common.Utils.String.platformKey("Shift+F3")]),o(this.btnNamedRange,this.txtNamedRange),o(this.btnFillNumbers,this.txtFillNum),o(this.btnClearStyle,this.tipClearStyle),o(this.btnCopyStyle,this.tipCopyStyle),o(this.btnAddCell,this.tipInsertOpt+Common.Utils.String.platformKey("Ctrl+Shift+=")),o(this.btnDeleteCell,this.tipDeleteOpt+Common.Utils.String.platformKey("Ctrl+Shift+-")),o(this.btnColorSchemas,this.tipColorSchemas),o(this.btnPageOrient,this.tipPageOrient),o(this.btnPageSize,this.tipPageSize),o(this.btnPageMargins,this.tipPageMargins),o(this.btnPrintArea,this.tipPrintArea),o(this.btnPrintTitles,this.tipPrintTitles),o(this.btnScale,this.tipScale),o(this.btnCondFormat,this.tipCondFormat),o(this.btnVisibleArea,this.tipVisibleArea),o(this.btnTextFormatting,this.tipTextFormatting),o(this.btnHorizontalAlign,this.tipHAlighOle),o(this.btnVerticalAlign,this.tipVAlighOle),this.btnsEditHeader.forEach(function(t){o(t,a.tipEditHeader)}),this.btnBorders&&this.btnBorders.rendered&&(this.btnBorders.setMenu(new Common.UI.Menu({items:[{caption:this.textOutBorders,iconCls:"menu__icon btn-border-out",icls:"btn-border-out",borderId:"outer"},{caption:this.textAllBorders,iconCls:"menu__icon btn-border-all",icls:"btn-border-all",borderId:"all"},{caption:this.textTopBorders,iconCls:"menu__icon btn-border-top",icls:"btn-border-top",borderId:Asc.c_oAscBorderOptions.Top},{caption:this.textBottomBorders,iconCls:"menu__icon btn-border-bottom",icls:"btn-border-bottom",borderId:Asc.c_oAscBorderOptions.Bottom},{caption:this.textLeftBorders,iconCls:"menu__icon btn-border-left",icls:"btn-border-left",borderId:Asc.c_oAscBorderOptions.Left},{caption:this.textRightBorders,iconCls:"menu__icon btn-border-right",icls:"btn-border-right",borderId:Asc.c_oAscBorderOptions.Right},{caption:this.textNoBorders,iconCls:"menu__icon btn-border-no",icls:"btn-border-no",borderId:"none"},{caption:"--"},{caption:this.textInsideBorders,iconCls:"menu__icon btn-border-inside",icls:"btn-border-inside",borderId:"inner"},{caption:this.textCenterBorders,iconCls:"menu__icon btn-border-insidevert",icls:"btn-border-insidevert",borderId:Asc.c_oAscBorderOptions.InnerV},{caption:this.textMiddleBorders,iconCls:"menu__icon btn-border-insidehor",icls:"btn-border-insidehor",borderId:Asc.c_oAscBorderOptions.InnerH},{caption:this.textDiagUpBorder,iconCls:"menu__icon btn-border-diagup",icls:"btn-border-diagup",borderId:Asc.c_oAscBorderOptions.DiagU},{caption:this.textDiagDownBorder,iconCls:"menu__icon btn-border-diagdown",icls:"btn-border-diagdown",borderId:Asc.c_oAscBorderOptions.DiagD},{caption:"--"},{id:"id-toolbar-mnu-item-border-width",caption:this.textBordersStyle,iconCls:"menu__icon btn-border-style",menu:(t=_.template('<a id="<%= id %>" tabindex="-1" type="menuitem"><div class="border-size-item"><svg><use xlink:href="#<%= options.imgId %>"></use></svg></div></a>'),a.mnuBorderWidth=new Common.UI.Menu({style:"min-width: 100px;",menuAlign:"tl-tr",id:"toolbar-menu-borders-width",items:[{template:t,stopPropagation:!0,checkable:!0,toggleGroup:"border-width",value:Asc.c_oAscBorderStyles.Thin,imgId:"solid-s",checked:!0},{template:t,stopPropagation:!0,checkable:!0,toggleGroup:"border-width",value:Asc.c_oAscBorderStyles.Hair,imgId:"dots-s"},{template:t,stopPropagation:!0,checkable:!0,toggleGroup:"border-width",value:Asc.c_oAscBorderStyles.Dotted,imgId:"dashes-s"},{template:t,stopPropagation:!0,checkable:!0,toggleGroup:"border-width",value:Asc.c_oAscBorderStyles.Dashed,imgId:"dashes-m"},{template:t,stopPropagation:!0,checkable:!0,toggleGroup:"border-width",value:Asc.c_oAscBorderStyles.DashDot,imgId:"dash-dot-s"},{template:t,stopPropagation:!0,checkable:!0,toggleGroup:"border-width",value:Asc.c_oAscBorderStyles.DashDotDot,imgId:"dash-dot-dot-s"},{template:t,stopPropagation:!0,checkable:!0,toggleGroup:"border-width",value:Asc.c_oAscBorderStyles.Medium,imgId:"solid-m"},{template:t,stopPropagation:!0,checkable:!0,toggleGroup:"border-width",value:Asc.c_oAscBorderStyles.MediumDashed,imgId:"dashes-l"},{template:t,stopPropagation:!0,checkable:!0,toggleGroup:"border-width",value:Asc.c_oAscBorderStyles.MediumDashDot,imgId:"dash-dot-m"},{template:t,stopPropagation:!0,checkable:!0,toggleGroup:"border-width",value:Asc.c_oAscBorderStyles.MediumDashDotDot,imgId:"dash-dot-dot-m"},{template:t,stopPropagation:!0,checkable:!0,toggleGroup:"border-width",value:Asc.c_oAscBorderStyles.Thick,imgId:"solid-l"}]}),a.mnuBorderWidth)},this.mnuBorderColor=new Common.UI.MenuItem({id:"id-toolbar-mnu-item-border-color",caption:this.textBordersColor,iconCls:"mnu-icon-item mnu-border-color",template:_.template('<a id="<%= id %>"tabindex="-1" type="menuitem"><span class="menu-item-icon"></span><%= caption %></a>'),menu:new Common.UI.Menu({menuAlign:"tl-tr",cls:"shifted-left",items:[{id:"id-toolbar-menu-auto-bordercolor",caption:this.textAutoColor,template:_.template('<a tabindex="-1" type="menuitem"><span class="menu-item-icon color-auto"></span><%= caption %></a>'),stopPropagation:!0},{caption:"--"},{template:_.template('<div id="id-toolbar-menu-bordercolor" style="width: 164px;display: inline-block;"></div>'),stopPropagation:!0},{caption:"--"},{id:"id-toolbar-menu-new-bordercolor",template:_.template('<a tabindex="-1" type="menuitem">'+this.textNewColor+"</a>"),stopPropagation:!0}]})})]})),this.mnuBorderColorPicker=new Common.UI.ThemeColorPalette({el:$("#id-toolbar-menu-bordercolor"),outerMenu:{menu:this.mnuBorderColor.menu,index:2}}),this.mnuBorderColor.menu.setInnerMenu([{menu:this.mnuBorderColorPicker,index:2}])),this.btnInsertChart&&(this.btnInsertChart.setMenu(new Common.UI.Menu({style:"width: 364px;padding-top: 12px;",items:[{template:_.template('<div id="id-toolbar-menu-insertchart" class="menu-insertchart"></div>')}]})),e=function(o){new Common.UI.DataView({el:$("#id-toolbar-menu-insertchart"),parentMenu:o,showLast:!1,restoreHeight:535,groups:new Common.UI.DataViewGroupStore(Common.define.chartData.getChartGroupData()),store:new Common.UI.DataViewStore(Common.define.chartData.getChartData()),itemTemplate:_.template('<div id="<%= id %>" class="item-chartlist"><svg width="40" height="40" class="icon uni-scale"><use xlink:href="#chart-<%= iconCls %>"></use></svg></div>')}).on("item:click",function(t,e,i,s){i&&a.fireEvent("add:chart",[i.get("group"),i.get("type")]),"click"!==s.type&&o.hide()}),o.off("show:before",e)},this.btnInsertChart.menu.on("show:before",e)),this.btnInsertSmartArt&&(this.btnInsertSmartArt.setMenu(new Common.UI.Menu({cls:"shifted-right",items:[]})),Common.define.smartArt.getSmartArtData().forEach(function(t,e){var i=t.items.length,i=i<5?78*i+9:399;a.btnInsertSmartArt.menu.addItem({caption:t.caption,value:t.sectionId,itemId:t.id,iconCls:t.icon?"menu__icon "+t.icon:void 0,menu:new Common.UI.Menu({items:[{template:_.template('<div id="'+t.id+'" class="menu-add-smart-art margin-left-5" style="width: '+i+'px; height: 500px;"></div>')}],menuAlign:"tl-tr"})})}),i=function(t){a.btnInsertSmartArt.menu.items.forEach(function(t,e){t.$el.one("mouseenter",function(){a.fireEvent("generate:smartart",[t.value]),t.$el.mouseenter()}),t.menuPicker=new Common.UI.DataView({el:$("#"+t.options.itemId),parentMenu:a.btnInsertSmartArt.menu.items[e].menu,itemTemplate:_.template(["<div>",'<img src="<%= imageUrl %>" width="70" height="70" />',"</div>"].join("")),store:new Common.UI.DataViewStore,delayRenderTips:!0,scrollAlwaysVisible:!0,showLast:!1}),t.menuPicker.on("item:click",function(t,e,i,s){i&&a.fireEvent("insert:smartart",[i.get("value")]),Common.NotificationCenter.trigger("edit:complete",a)})}),t.off("show:before",i)},this.btnInsertSmartArt.menu.on("show:before",i)),this.btnInsertSparkline&&(this.btnInsertSparkline.setMenu(new Common.UI.Menu({style:"width: 166px;padding: 5px 0 10px;",items:[{template:_.template('<div id="id-toolbar-menu-insertspark" class="menu-insertchart"></div>')}]})),s=function(o){new Common.UI.DataView({el:$("#id-toolbar-menu-insertspark"),parentMenu:o,showLast:!1,restoreHeight:50,store:new Common.UI.DataViewStore(Common.define.chartData.getSparkData()),itemTemplate:_.template('<div id="<%= id %>" class="item-chartlist"><svg width="40" height="40" class="icon uni-scale"><use xlink:href="#chart-<%= iconCls %>"></use></svg></div>')}).on("item:click",function(t,e,i,s){i&&a.fireEvent("add:spark",[i.get("type")]),"click"!==s.type&&o.hide()}),o.off("show:before",s)},this.btnInsertSparkline.menu.on("show:before",s)),this.btnInsertText&&this.btnInsertText.setMenu(new Common.UI.Menu({items:[{caption:this.tipInsertHorizontalText,checkable:!0,checkmark:!1,iconCls:"menu__icon btn-text",toggleGroup:"textbox",value:"textRect",iconClsForMainBtn:"btn-big-text"},{caption:this.tipInsertVerticalText,checkable:!0,checkmark:!1,iconCls:"menu__icon btn-text-vertical",toggleGroup:"textbox",value:"textRectVertical",iconClsForMainBtn:"btn-big-text-vertical"}]})),this.btnInsertTextArt&&(n=function(o){var t=SSE.getCollection("Common.Collections.TextArt");t.length<1&&SSE.getController("Main").fillTextArt(a.api.asc_getTextArtPreviews()),new Common.UI.DataView({el:$("#id-toolbar-menu-insart"),store:t,parentMenu:o,showLast:!1,itemTemplate:_.template('<div class="item-art"><img src="<%= imageUrl %>" id="<%= id %>" style="width:50px;height:50px;"></div>')}).on("item:click",function(t,e,i,s){i&&a.fireEvent("insert:textart",[i.get("data")]),"click"!==s.type&&o.hide()}),o.off("show:before",n)},this.btnInsertTextArt.menu.on("show:before",n)),this.specSymbols=[{symbol:8226,description:this.textBullet},{symbol:65509,description:this.textRmb},{symbol:8364,description:this.textEuro},{symbol:65284,description:this.textDollar},{symbol:169,description:this.textCopyright},{symbol:174,description:this.textRegistered},{symbol:189,description:this.textOneHalf},{symbol:188,description:this.textOneQuarter},{symbol:8800,description:this.textNotEqualTo},{symbol:177,description:this.textPlusMinus},{symbol:247,description:this.textDivision},{symbol:8730,description:this.textSquareRoot},{symbol:8804,description:this.textLessEqual},{symbol:8805,description:this.textGreaterEqual},{symbol:8482,description:this.textTradeMark},{symbol:8734,description:this.textInfinity},{symbol:126,description:this.textTilde},{symbol:176,description:this.textDegree},{symbol:167,description:this.textSection},{symbol:945,description:this.textAlpha},{symbol:946,description:this.textBetta},{symbol:960,description:this.textLetterPi},{symbol:916,description:this.textDelta},{symbol:9786,description:this.textSmile},{symbol:9829,description:this.textBlackHeart}],this.btnInsertSymbol&&(this.mnuInsertSymbolsPicker=new Common.UI.DataView({el:$("#id-toolbar-menu-symbols"),parentMenu:this.btnInsertSymbol.menu,outerMenu:{menu:this.btnInsertSymbol.menu,index:0},restoreHeight:290,delayRenderTips:!0,scrollAlwaysVisible:!0,store:new Common.UI.DataViewStore(this.loadRecentSymbolsFromStorage()),itemTemplate:_.template('<div class="item-symbol" <% if (typeof font !== "undefined" && font !=="") { %> style ="font-family: <%= font %>"<% } %>>&#<%= symbol %></div>')}),this.btnInsertSymbol.menu.setInnerMenu([{menu:this.mnuInsertSymbolsPicker,index:0}]),this.btnInsertSymbol.menu.on("show:before",_.bind(function(){this.mnuInsertSymbolsPicker.deselectAll()},this))),this.btnCondFormat&&this.btnCondFormat.rendered&&this.btnCondFormat.setMenu(new Common.UI.Menu({items:[{caption:Common.define.conditionalData.textValue,menu:new Common.UI.Menu({menuAlign:"tl-tr",items:[{caption:Common.define.conditionalData.textGreater,type:Asc.c_oAscCFType.cellIs,value:Asc.c_oAscCFOperator.greaterThan},{caption:Common.define.conditionalData.textGreaterEq,type:Asc.c_oAscCFType.cellIs,value:Asc.c_oAscCFOperator.greaterThanOrEqual},{caption:Common.define.conditionalData.textLess,type:Asc.c_oAscCFType.cellIs,value:Asc.c_oAscCFOperator.lessThan},{caption:Common.define.conditionalData.textLessEq,type:Asc.c_oAscCFType.cellIs,value:Asc.c_oAscCFOperator.lessThanOrEqual},{caption:Common.define.conditionalData.textEqual,type:Asc.c_oAscCFType.cellIs,value:Asc.c_oAscCFOperator.equal},{caption:Common.define.conditionalData.textNotEqual,type:Asc.c_oAscCFType.cellIs,value:Asc.c_oAscCFOperator.notEqual},{caption:Common.define.conditionalData.textBetween,type:Asc.c_oAscCFType.cellIs,value:Asc.c_oAscCFOperator.between},{caption:Common.define.conditionalData.textNotBetween,type:Asc.c_oAscCFType.cellIs,value:Asc.c_oAscCFOperator.notBetween}]})},{caption:Common.define.conditionalData.textTop+"/"+Common.define.conditionalData.textBottom,type:Asc.c_oAscCFType.top10,menu:new Common.UI.Menu({menuAlign:"tl-tr",items:[{caption:Common.define.conditionalData.textTop+" 10 "+this.textItems,type:Asc.c_oAscCFType.top10,value:0,percent:!1},{caption:Common.define.conditionalData.textTop+" 10%",type:Asc.c_oAscCFType.top10,value:0,percent:!0},{caption:Common.define.conditionalData.textBottom+" 10 "+this.textItems,type:Asc.c_oAscCFType.top10,value:1,percent:!1},{caption:Common.define.conditionalData.textBottom+" 10%",type:Asc.c_oAscCFType.top10,value:1,percent:!0}]})},{caption:Common.define.conditionalData.textAverage,menu:new Common.UI.Menu({menuAlign:"tl-tr",items:[{caption:Common.define.conditionalData.textAbove,type:Asc.c_oAscCFType.aboveAverage,value:0},{caption:Common.define.conditionalData.textBelow,type:Asc.c_oAscCFType.aboveAverage,value:1},{caption:Common.define.conditionalData.textEqAbove,type:Asc.c_oAscCFType.aboveAverage,value:2},{caption:Common.define.conditionalData.textEqBelow,type:Asc.c_oAscCFType.aboveAverage,value:3},{caption:Common.define.conditionalData.text1Above,type:Asc.c_oAscCFType.aboveAverage,value:4},{caption:Common.define.conditionalData.text1Below,type:Asc.c_oAscCFType.aboveAverage,value:5},{caption:Common.define.conditionalData.text2Above,type:Asc.c_oAscCFType.aboveAverage,value:6},{caption:Common.define.conditionalData.text2Below,type:Asc.c_oAscCFType.aboveAverage,value:7},{caption:Common.define.conditionalData.text3Above,type:Asc.c_oAscCFType.aboveAverage,value:8},{caption:Common.define.conditionalData.text3Below,type:Asc.c_oAscCFType.aboveAverage,value:9}]})},{caption:Common.define.conditionalData.textText,menu:new Common.UI.Menu({menuAlign:"tl-tr",items:[{caption:Common.define.conditionalData.textContains,type:Asc.c_oAscCFType.containsText},{caption:Common.define.conditionalData.textNotContains,type:Asc.c_oAscCFType.notContainsText},{caption:Common.define.conditionalData.textBegins,type:Asc.c_oAscCFType.beginsWith},{caption:Common.define.conditionalData.textEnds,type:Asc.c_oAscCFType.endsWith}]})},{caption:Common.define.conditionalData.textDate,menu:new Common.UI.Menu({menuAlign:"tl-tr",items:[{caption:Common.define.conditionalData.textYesterday,type:Asc.c_oAscCFType.timePeriod,value:Asc.c_oAscTimePeriod.yesterday},{caption:Common.define.conditionalData.textToday,type:Asc.c_oAscCFType.timePeriod,value:Asc.c_oAscTimePeriod.today},{caption:Common.define.conditionalData.textTomorrow,type:Asc.c_oAscCFType.timePeriod,value:Asc.c_oAscTimePeriod.tomorrow},{caption:Common.define.conditionalData.textLast7days,type:Asc.c_oAscCFType.timePeriod,value:Asc.c_oAscTimePeriod.last7Days},{caption:Common.define.conditionalData.textLastWeek,type:Asc.c_oAscCFType.timePeriod,value:Asc.c_oAscTimePeriod.lastWeek},{caption:Common.define.conditionalData.textThisWeek,type:Asc.c_oAscCFType.timePeriod,value:Asc.c_oAscTimePeriod.thisWeek},{caption:Common.define.conditionalData.textNextWeek,type:Asc.c_oAscCFType.timePeriod,value:Asc.c_oAscTimePeriod.nextWeek},{caption:Common.define.conditionalData.textLastMonth,type:Asc.c_oAscCFType.timePeriod,value:Asc.c_oAscTimePeriod.lastMonth},{caption:Common.define.conditionalData.textThisMonth,type:Asc.c_oAscCFType.timePeriod,value:Asc.c_oAscTimePeriod.thisMonth},{caption:Common.define.conditionalData.textNextMonth,type:Asc.c_oAscCFType.timePeriod,value:Asc.c_oAscTimePeriod.nextMonth}]})},{caption:Common.define.conditionalData.textBlank+"/"+Common.define.conditionalData.textError,menu:new Common.UI.Menu({menuAlign:"tl-tr",items:[{caption:Common.define.conditionalData.textBlanks,type:Asc.c_oAscCFType.containsBlanks},{caption:Common.define.conditionalData.textNotBlanks,type:Asc.c_oAscCFType.notContainsBlanks},{caption:Common.define.conditionalData.textErrors,type:Asc.c_oAscCFType.containsErrors},{caption:Common.define.conditionalData.textNotErrors,type:Asc.c_oAscCFType.notContainsErrors}]})},{caption:Common.define.conditionalData.textDuplicate+"/"+Common.define.conditionalData.textUnique,menu:new Common.UI.Menu({menuAlign:"tl-tr",items:[{caption:Common.define.conditionalData.textDuplicate,type:Asc.c_oAscCFType.duplicateValues},{caption:Common.define.conditionalData.textUnique,type:Asc.c_oAscCFType.uniqueValues}]})},{caption:"--"},this.mnuDataBars=new Common.UI.MenuItem({caption:this.textDataBars,type:Asc.c_oAscCFType.dataBar,menu:new Common.UI.Menu({menuAlign:"tl-tr",style:"min-width: auto;",items:[]})}),this.mnuColorScales=new Common.UI.MenuItem({caption:this.textColorScales,type:Asc.c_oAscCFType.colorScale,menu:new Common.UI.Menu({menuAlign:"tl-tr",style:"min-width: auto;",items:[]})}),this.mnuIconSets=new Common.UI.MenuItem({caption:Common.define.conditionalData.textIconSets,type:Asc.c_oAscCFType.iconSet,menu:new Common.UI.Menu({menuAlign:"tl-tr",style:"min-width: auto;",items:[]})}),{caption:"--"},{caption:Common.define.conditionalData.textFormula,type:Asc.c_oAscCFType.expression},{caption:"--"},{caption:this.textNewRule,value:"new"},{caption:this.textClearRule,menu:new Common.UI.Menu({menuAlign:"tl-tr",items:[{value:"clear",type:Asc.c_oAscSelectionForCFType.selection,caption:this.textSelection},{value:"clear",type:Asc.c_oAscSelectionForCFType.worksheet,caption:this.textThisSheet},{value:"clear",type:Asc.c_oAscSelectionForCFType.table,caption:this.textThisTable},{value:"clear",type:Asc.c_oAscSelectionForCFType.pivot,caption:this.textThisPivot}]})},{caption:this.textManageRule,value:"manage"}]})),this.mode.isEditMailMerge||this.mode.isEditDiagram||this.mode.isEditOle||this.updateMetricUnit()},onToolbarAfterRender:function(t){this.btnTextColor&&this.btnTextColor.cmpEl&&(this.btnTextColor.setMenu(),this.mnuTextColorPicker=this.btnTextColor.getPicker(),this.btnTextColor.setColor(this.btnTextColor.currentColor||"transparent")),this.btnBackColor&&this.btnBackColor.cmpEl&&(this.btnBackColor.setMenu(),this.mnuBackColorPicker=this.btnBackColor.getPicker(),this.btnBackColor.setColor(this.btnBackColor.currentColor||"transparent"))},updateMetricUnit:function(){for(var t=this.btnPageMargins.menu.items,e=0;e<t.length;e++)(i=t[e]).checkable&&(s=i.checked,$(i.el).html(i.template({id:Common.UI.getId(),caption:i.caption,options:i.options})),s&&i.setChecked(s));for(var i,s,t=this.btnPageSize.menu.items,e=0;e<t.length;e++)(i=t[e]).checkable&&(s=i.checked,$(i.el).html(i.template({id:Common.UI.getId(),caption:i.caption,options:i.options})),s&&i.setChecked(s))},setApi:function(t){return this.api=t,this.mode.isEditMailMerge||this.mode.isEditDiagram||this.mode.isEditOle||(this.api.asc_registerCallback("asc_onCollaborativeChanges",_.bind(this.onApiCollaborativeChanges,this)),this.api.asc_registerCallback("asc_onSendThemeColorSchemes",_.bind(this.onApiSendThemeColorSchemes,this)),this.api.asc_registerCallback("asc_onAuthParticipantsChanged",_.bind(this.onApiUsersChanged,this)),this.api.asc_registerCallback("asc_onParticipantsChanged",_.bind(this.onApiUsersChanged,this))),this},setMode:function(t){return t.isDisconnected?(this.lockToolbar(Common.enumLock.lostConnect,!0),this.lockToolbar(Common.enumLock.lostConnect,!0,{array:[this.btnEditChart,this.btnEditChartData,this.btnEditChartType,this.btnUndo,this.btnRedo,this.btnSave,this.btnVisibleArea,this.btnVisibleAreaClose]}),this.synchTooltip&&this.synchTooltip.hide(),t.enableDownload||this.lockToolbar(Common.enumLock.cantPrint,!0,{array:[this.btnPrint]})):(!(this.mode=t).canPrint&&this.btnPrint&&this.btnPrint.hide(),this.lockToolbar(Common.enumLock.cantPrint,!t.canPrint,{array:[this.btnPrint]})),this},onApiSendThemeColorSchemes:function(t){var a=this,l=(this.mnuColorSchema=this.btnColorSchemas.menu,this.mnuColorSchema&&0<this.mnuColorSchema.items.length&&_.each(this.mnuColorSchema.items,function(t){t.remove()}),null==this.mnuColorSchema&&(this.mnuColorSchema=new Common.UI.Menu({cls:"shifted-left",restoreHeight:!0})),this.mnuColorSchema.items=[],_.template(['<a id="<%= id %>" class="<%= options.cls %>" tabindex="-1" type="menuitem">','<span class="colors">',"<% _.each(options.colors, function(color) { %>",'<span class="color" style="background: <%= color %>;"></span>',"<% }) %>","</span>",'<span class="text"><%= caption %></span>',"</a>"].join("")));_.each(t,function(t,e){for(var i=t.get_colors(),s=[],o=2;o<7;o++){var n="#"+Common.Utils.ThemeColor.getHexColor(i[o].get_r(),i[o].get_g(),i[o].get_b());s.push(n)}22==e&&this.mnuColorSchema.addItem({caption:"--"});t=t.get_name();this.mnuColorSchema.addItem({template:l,cls:"color-schemas-menu",colors:s,caption:e<22&&a.SchemeNames[e]||t,value:e,checkable:!0,toggleGroup:"menuSchema"})},this)},onApiCollaborativeChanges:function(){this._state.hasCollaborativeChanges||this.btnCollabChanges.rendered&&(this._state.hasCollaborativeChanges=!0,this.btnCollabChanges.cmpEl.addClass("notify"),this.showSynchTip?(this.btnCollabChanges.updateHint(""),void 0===this.synchTooltip&&this.createSynchTip(),this.synchTooltip.show()):this.btnCollabChanges.updateHint(this.tipSynchronize+Common.Utils.String.platformKey("Ctrl+S")),this.btnSave.setDisabled(!1),Common.Gateway.collaborativeChanges())},createSynchTip:function(){this.synchTooltip=new Common.UI.SynchronizeTip({extCls:this.mode.customization&&this.mode.customization.compactHeader?void 0:"inc-index",placement:"right-bottom",target:this.btnCollabChanges.$el}),this.synchTooltip.on("dontshowclick",function(){this.showSynchTip=!1,this.synchTooltip.hide(),this.btnCollabChanges.updateHint(this.tipSynchronize+Common.Utils.String.platformKey("Ctrl+S")),Common.localStorage.setItem("sse-hide-synch",1)},this),this.synchTooltip.on("closeclick",function(){this.synchTooltip.hide(),this.btnCollabChanges.updateHint(this.tipSynchronize+Common.Utils.String.platformKey("Ctrl+S"))},this)},synchronizeChanges:function(){this.btnCollabChanges.rendered&&this.btnCollabChanges.cmpEl.hasClass("notify")&&(this.btnCollabChanges.cmpEl.removeClass("notify"),this.synchTooltip&&this.synchTooltip.hide(),this.btnCollabChanges.updateHint(this.btnSaveTip),this.btnSave.setDisabled(!this.mode.forcesave),this._state.hasCollaborativeChanges=!1)},onApiUsersChanged:function(t){var e=[],t=(_.each(t,function(t){t.asc_getView()||e.push(t)}),_.size(e)),i=1<t?"btn-save-coauth":"btn-save";i!==this.btnSaveCls&&this.btnCollabChanges.rendered&&(this.btnSaveTip=(1<t?this.tipSaveCoauth:this.tipSave)+Common.Utils.String.platformKey("Ctrl+S"),this.btnCollabChanges.updateHint(this.btnSaveTip),this.btnCollabChanges.$icon.removeClass(this.btnSaveCls).addClass(i),this.btnSaveCls=i)},onAppReady:function(t){var e,i;!this.mode.isEdit||this.mode.isEditMailMerge||this.mode.isEditDiagram||this.mode.isEditOle||((e=this).btnPrint.menu&&e.btnPrint.setMenu(new Common.UI.Menu({items:[{caption:e.tipPrint,iconCls:"menu__icon btn-print",toggleGroup:"viewPrint",value:"print",iconClsForMainBtn:"btn-print",platformKey:Common.Utils.String.platformKey("Ctrl+P")},{caption:e.tipPrintQuick,iconCls:"menu__icon btn-quick-print",toggleGroup:"viewPrint",value:"print-quick",iconClsForMainBtn:"btn-quick-print",platformKey:""}]})),i=SSE.getController("DocumentHolder").getView("DocumentHolder"),e.btnImgForward.updateHint(e.tipSendForward),e.btnImgForward.setMenu(new Common.UI.Menu({items:[{caption:i.textArrangeFront,iconCls:"menu__icon btn-arrange-front",value:Asc.c_oAscDrawingLayerType.BringToFront},{caption:i.textArrangeForward,iconCls:"menu__icon btn-arrange-forward",value:Asc.c_oAscDrawingLayerType.BringForward}]})),e.btnImgBackward.updateHint(e.tipSendBackward),e.btnImgBackward.setMenu(new Common.UI.Menu({items:[{caption:i.textArrangeBack,iconCls:"menu__icon btn-arrange-back",value:Asc.c_oAscDrawingLayerType.SendToBack},{caption:i.textArrangeBackward,iconCls:"menu__icon btn-arrange-backward",value:Asc.c_oAscDrawingLayerType.SendBackward}]})),e.btnImgAlign.updateHint(e.tipImgAlign),e.btnImgAlign.setMenu(new Common.UI.Menu({items:[{caption:i.textShapeAlignLeft,iconCls:"menu__icon btn-shape-align-left",value:0},{caption:i.textShapeAlignCenter,iconCls:"menu__icon btn-shape-align-center",value:4},{caption:i.textShapeAlignRight,iconCls:"menu__icon btn-shape-align-right",value:1},{caption:i.textShapeAlignTop,iconCls:"menu__icon btn-shape-align-top",value:3},{caption:i.textShapeAlignMiddle,iconCls:"menu__icon btn-shape-align-middle",value:5},{caption:i.textShapeAlignBottom,iconCls:"menu__icon btn-shape-align-bottom",value:2},{caption:"--"},{caption:i.txtDistribHor,iconCls:"menu__icon btn-shape-distribute-hor",value:6},{caption:i.txtDistribVert,iconCls:"menu__icon btn-shape-distribute-vert",value:7}]})),e.btnImgGroup.updateHint(e.tipImgGroup),e.btnImgGroup.setMenu(new Common.UI.Menu({items:[{caption:i.txtGroup,iconCls:"menu__icon btn-shape-group",value:"grouping"},{caption:i.txtUngroup,iconCls:"menu__icon btn-shape-ungroup",value:"ungrouping"}]})),e.btnPageBreak.updateHint(e.tipPageBreak),e.btnPageBreak.setMenu(new Common.UI.Menu({items:[{caption:e.textInsPageBreak,value:"ins"},{caption:e.textDelPageBreak,value:"del"},{caption:e.textResetPageBreak,value:"reset"}]})))},loadRecentSymbolsFromStorage:function(){var t=Common.localStorage.getItem("sse-fastRecentSymbols"),t=t?JSON.parse(t):[{symbol:8226,font:"Arial"},{symbol:65509,font:"Arial"},{symbol:8364,font:"Arial"},{symbol:65284,font:"Arial"},{symbol:169,font:"Arial"},{symbol:174,font:"Arial"},{symbol:189,font:"Arial"},{symbol:188,font:"Arial"},{symbol:8800,font:"Arial"},{symbol:177,font:"Arial"},{symbol:247,font:"Arial"},{symbol:8730,font:"Arial"},{symbol:8804,font:"Arial"},{symbol:8805,font:"Arial"},{symbol:8482,font:"Arial"},{symbol:8734,font:"Arial"},{symbol:126,font:"Arial"},{symbol:176,font:"Arial"},{symbol:167,font:"Arial"},{symbol:945,font:"Arial"},{symbol:946,font:"Arial"},{symbol:960,font:"Arial"},{symbol:916,font:"Arial"},{symbol:9786,font:"Arial"},{symbol:9829,font:"Arial"}];return t.forEach(function(t){t.tip=this.getSymbolDescription(t.symbol)}.bind(this)),t},saveSymbol:function(e,i){var t=this.mnuInsertSymbolsPicker,s=t.store.find(function(t){return t.get("symbol")==e&&t.get("font")==i}),s=(s&&t.store.remove(s),t.store.add({symbol:e,font:i,tip:this.getSymbolDescription(e)},{at:0}),25<t.store.length&&t.store.remove(t.store.last()),t.store.map(function(t){return{symbol:t.get("symbol"),font:t.get("font")}})),t=JSON.stringify(s);Common.localStorage.setItem("sse-fastRecentSymbols",t)},getSymbolDescription:function(e){var t=this.specSymbols.find(function(t){return t.symbol==e});return t?t.description:this.capBtnInsSymbol+": "+e}},SSE.Views.Toolbar||{}))}),define("spreadsheeteditor/main/app/model/TableTemplate",["backbone"],function(t){"use strict";SSE.Models=SSE.Models||{},SSE.Models.TableTemplate=t.Model.extend({defaults:function(){return{id:Common.UI.getId(),name:null,caption:null,type:null,imageUrl:null}}})}),define("spreadsheeteditor/main/app/collection/TableTemplates",["backbone","spreadsheeteditor/main/app/model/TableTemplate"],function(t){"use strict";var e;(e=void 0===e?{}:e).Collections=e.Collections||{},SSE.Collections.TableTemplates=t.Collection.extend({model:SSE.Models.TableTemplate})}),define("spreadsheeteditor/main/app/view/PivotTable",["common/main/lib/util/utils","common/main/lib/component/Button","common/main/lib/component/ComboDataView","common/main/lib/component/Layout"],function(t){"use strict";SSE.Views.PivotTable=Common.UI.BaseView.extend(_.extend({options:{},initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t),this.toolbar=t.toolbar,this.lockedControls=[];t=Common.enumLock;this.btnsAddPivot=Common.Utils.injectButtons(this.toolbar.$el.find(".btn-slot.slot-add-pivot"),"","toolbar__icon btn-big-pivot-sum",this.txtPivotTable,[t.lostConnect,t.coAuth,t.editPivot,t.selRangeEdit,t.selChart,t.selChartText,t.selShape,t.selShapeText,t.selImage,t.selSlicer,t.editCell,t.wsLock],void 0,void 0,void 0,"1","bottom","small"),this.chRowHeader=new Common.UI.CheckBox({labelText:this.textRowHeader,lock:[t.lostConnect,t.coAuth,t.noPivot,t.selRangeEdit,t.pivotLock,t.FormatCells,t.PivotTables],dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.lockedControls.push(this.chRowHeader),this.chColHeader=new Common.UI.CheckBox({labelText:this.textColHeader,lock:[t.lostConnect,t.coAuth,t.noPivot,t.selRangeEdit,t.pivotLock,t.FormatCells,t.PivotTables],dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.lockedControls.push(this.chColHeader),this.chRowBanded=new Common.UI.CheckBox({labelText:this.textRowBanded,lock:[t.lostConnect,t.coAuth,t.noPivot,t.selRangeEdit,t.pivotLock,t.FormatCells,t.PivotTables],dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.lockedControls.push(this.chRowBanded),this.chColBanded=new Common.UI.CheckBox({labelText:this.textColBanded,lock:[t.lostConnect,t.coAuth,t.noPivot,t.selRangeEdit,t.pivotLock,t.FormatCells,t.PivotTables],dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.lockedControls.push(this.chColBanded),this.btnPivotLayout=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-pivot-layout",caption:this.capLayout,disabled:!0,lock:[t.lostConnect,t.coAuth,t.noPivot,t.selRangeEdit,t.pivotLock,t.wsLock],menu:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.lockedControls.push(this.btnPivotLayout),this.btnPivotBlankRows=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-blank-rows",caption:this.capBlankRows,disabled:!0,lock:[t.lostConnect,t.coAuth,t.noPivot,t.selRangeEdit,t.pivotLock,t.wsLock],menu:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.lockedControls.push(this.btnPivotBlankRows),this.btnPivotSubtotals=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-subtotals",caption:this.capSubtotals,disabled:!0,lock:[t.lostConnect,t.coAuth,t.noPivot,t.selRangeEdit,t.pivotLock,t.wsLock],menu:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.lockedControls.push(this.btnPivotSubtotals),this.btnPivotGrandTotals=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-grand-totals",caption:this.capGrandTotals,disabled:!0,lock:[t.lostConnect,t.coAuth,t.noPivot,t.selRangeEdit,t.pivotLock,t.wsLock],menu:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.lockedControls.push(this.btnPivotGrandTotals),this.btnRefreshPivot=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-update",caption:this.txtRefresh,disabled:!0,split:!0,lock:[t.lostConnect,t.coAuth,t.noPivot,t.selRangeEdit,t.pivotLock,t.wsLock],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.lockedControls.push(this.btnRefreshPivot),this.btnSelectPivot=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-select-pivot",caption:this.txtSelect,lock:[t.lostConnect,t.coAuth,t.noPivot,t.selRangeEdit,t.PivotTables],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.lockedControls.push(this.btnSelectPivot),this.pivotStyles=new Common.UI.ComboDataView({cls:"combo-pivot-template",style:"min-width: 103px; max-width: 517px;",enableKeyEvents:!0,itemWidth:61,itemHeight:49,menuMaxHeight:300,groups:new Common.UI.DataViewGroupStore,autoWidth:!0,lock:[t.lostConnect,t.coAuth,t.noPivot,t.selRangeEdit,t.pivotLock,t.FormatCells,t.PivotTables],beforeOpenHandler:function(t){var e,i,s,o=this,n=o.openButton.menu;n.cmpEl&&(s=(s=$(o.cmpEl.find(".dataview.inner .style").get(0)).parent()).is(":visible")?parseFloat(s.css("width")):o.itemWidth+parseFloat(s.css("padding-left"))+parseFloat(s.css("padding-right"))+parseFloat(s.css("border-left-width"))+parseFloat(s.css("border-right-width")),n.menuAlignEl=o.cmpEl,n.menuAlign="tl-tl",e=7*(8+s)+17,i=o.openButton.$el.offset().left,e>Common.Utils.innerWidth()&&(e=Math.max(Math.floor((Common.Utils.innerWidth()-17)/(8+s)),2)*(8+s)+17),s=o.cmpEl.width()-o.openButton.$el.width()-Math.min(e,i)-1,Common.UI.isRTL()&&(s=o.openButton.$el.width()+parseFloat($(o.$el.find(".combo-dataview").get(0)).css("padding-left"))),n.setOffset(Common.UI.isRTL()?s:Math.min(s,0)),n.cmpEl.css({width:e,"min-height":o.cmpEl.height()}))},dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"-16, 0"}),this.lockedControls.push(this.pivotStyles),Common.NotificationCenter.on("app:ready",this.onAppReady.bind(this))},render:function(t){return this.boxSdk=$("#editor_sdk"),t&&t.html(this.getPanel()),this},onAppReady:function(t){var e=this;new Promise(function(t,e){t()}).then(function(){e.btnsAddPivot.forEach(function(t){t.updateHint(e.tipCreatePivot)}),e.btnSelectPivot.updateHint(e.tipSelect),e.btnPivotLayout.updateHint(e.capLayout),e.btnPivotLayout.setMenu(new Common.UI.Menu({items:[{caption:e.mniLayoutCompact,value:0},{caption:e.mniLayoutOutline,value:1},{caption:e.mniLayoutTabular,value:2},{caption:"--"},{caption:e.mniLayoutRepeat,value:3},{caption:e.mniLayoutNoRepeat,value:4}]})),e.btnPivotBlankRows.updateHint(e.capBlankRows),e.btnPivotBlankRows.setMenu(new Common.UI.Menu({items:[{caption:e.mniInsertBlankLine,value:"insert"},{caption:e.mniRemoveBlankLine,value:"remove"}]})),e.btnPivotSubtotals.updateHint(e.tipSubtotals),e.btnPivotSubtotals.setMenu(new Common.UI.Menu({items:[{caption:e.mniNoSubtotals,value:0},{caption:e.mniBottomSubtotals,value:1},{caption:e.mniTopSubtotals,value:2}]})),e.btnPivotGrandTotals.updateHint(e.tipGrandTotals),e.btnPivotGrandTotals.setMenu(new Common.UI.Menu({items:[{caption:e.mniOffTotals,value:0},{caption:e.mniOnTotals,value:1},{caption:e.mniOnRowsTotals,value:2},{caption:e.mniOnColumnsTotals,value:3}]})),e.btnRefreshPivot.setMenu(new Common.UI.Menu({items:[{caption:e.txtRefresh,value:"current"},{caption:e.txtRefreshAll,value:"all"}]})),e.btnRefreshPivot.updateHint([e.tipRefreshCurrent,e.tipRefresh]),function(){var s=this;this.btnsAddPivot.forEach(function(t){t.on("click",function(t,e){s.fireEvent("pivottable:create")})}),this.btnPivotLayout.menu.on("item:click",function(t,e,i){s.fireEvent("pivottable:layout",[e.value])}),this.btnPivotBlankRows.menu.on("item:click",function(t,e,i){s.fireEvent("pivottable:blankrows",[e.value])}),this.btnPivotSubtotals.menu.on("item:click",function(t,e,i){s.fireEvent("pivottable:subtotals",[e.value])}),this.btnPivotGrandTotals.menu.on("item:click",function(t,e,i){s.fireEvent("pivottable:grandtotals",[e.value])}),this.btnRefreshPivot.on("click",function(t){s.fireEvent("pivottable:refresh",["current"])}),this.btnRefreshPivot.menu.on("item:click",function(t,e,i){s.fireEvent("pivottable:refresh",[e.value])}),this.btnSelectPivot.on("click",function(t){s.fireEvent("pivottable:select")}),this.chRowHeader.on("change",function(t,e){s.fireEvent("pivottable:rowscolumns",[0,e])}),this.chColHeader.on("change",function(t,e){s.fireEvent("pivottable:rowscolumns",[1,e])}),this.chRowBanded.on("change",function(t,e){s.fireEvent("pivottable:rowscolumns",[2,e])}),this.chColBanded.on("change",function(t,e){s.fireEvent("pivottable:rowscolumns",[3,e])}),this.pivotStyles.on("click",function(t,e){s.fireEvent("pivottable:style",[e])}),this.pivotStyles.openButton.menu.on("show:after",function(){s.pivotStyles.menuPicker.scroller.update({alwaysVisibleY:!0})})}.call(e)})},getPanel:function(){this.$el=$(_.template('<section id="pivot-table-panel" class="panel" data-tab="pivot"><div class="group"><span class="btn-slot text x-huge slot-add-pivot"></span></div><div class="separator long"></div><div class="group"><span id="slot-btn-pivot-subtotals" class="btn-slot text x-huge"></span><span id="slot-btn-pivot-grand-totals" class="btn-slot text x-huge"></span><span id="slot-btn-pivot-report-layout" class="btn-slot text x-huge"></span><span id="slot-btn-pivot-blank-rows" class="btn-slot text x-huge"></span></div><div class="separator long"></div><div class="group"><span id="slot-btn-refresh-pivot" class="btn-slot text x-huge"></span></div><div class="separator long"></div><div class="group"><span id="slot-btn-select-pivot" class="btn-slot text x-huge"></span></div><div class="separator long"></div><div class="group small"><div class="elset"><span class="btn-slot text" id="slot-chk-header-row"></span></div><div class="elset"><span class="btn-slot text" id="slot-chk-header-column"></span></div></div><div class="separator long invisible"></div><div class="group small"><div class="elset"><span class="btn-slot text" id="slot-chk-banded-row"></span></div><div class="elset"><span class="btn-slot text" id="slot-chk-banded-column"></span></div></div><div class="separator long invisible"></div><div class="group flex small" id="slot-field-pivot-styles" style="width: 100%; min-width: 105px;" data-group-width="100%"></div></section>')({}));var t=Common.enumLock;return this.btnsAddPivot=this.btnsAddPivot.concat(Common.Utils.injectButtons(this.$el.find(".btn-slot.slot-add-pivot"),"","toolbar__icon btn-big-pivot-sum",this.txtCreate,[t.lostConnect,t.coAuth,t.editPivot,t.selRangeEdit,t.selChart,t.selChartText,t.selShape,t.selShapeText,t.selImage,t.selSlicer,t.editCell,t.wsLock],void 0,void 0,void 0,"1","bottom","small")),this.chRowHeader.render(this.$el.find("#slot-chk-header-row")),this.chColHeader.render(this.$el.find("#slot-chk-header-column")),this.chRowBanded.render(this.$el.find("#slot-chk-banded-row")),this.chColBanded.render(this.$el.find("#slot-chk-banded-column")),this.btnRefreshPivot.render(this.$el.find("#slot-btn-refresh-pivot")),this.btnSelectPivot.render(this.$el.find("#slot-btn-select-pivot")),this.btnPivotLayout.render(this.$el.find("#slot-btn-pivot-report-layout")),this.btnPivotBlankRows.render(this.$el.find("#slot-btn-pivot-blank-rows")),this.btnPivotSubtotals.render(this.$el.find("#slot-btn-pivot-subtotals")),this.btnPivotGrandTotals.render(this.$el.find("#slot-btn-pivot-grand-totals")),this.pivotStyles.render(this.$el.find("#slot-field-pivot-styles")),this.$el},show:function(){Common.UI.BaseView.prototype.show.call(this),this.fireEvent("show",this)},getButtons:function(t){return this.btnsAddPivot.concat(this.lockedControls)},SetDisabled:function(e){this.btnsAddPivot.concat(this.lockedControls).forEach(function(t){t&&t.setDisabled(e)},this)}},SSE.Views.PivotTable||{}))}),define("spreadsheeteditor/main/app/view/CreatePivotDialog",["common/main/lib/util/utils","common/main/lib/component/InputField","common/main/lib/component/ComboBox","common/main/lib/view/AdvancedSettingsWindow"],function(){"use strict";SSE.Views.CreatePivotDialog=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:310,height:250,id:"window-create-pivot"},initialize:function(i){_.extend(this.options,{title:this.textTitle,template:['<div class="box" style="height:'+(this.options.height-85)+'px;">','<div class="content-panel" style="padding: 0 10px;"><div class="inner-content">','<div class="settings-panel active">','<table cols="1" style="width: 100%;">',"<tr>",'<td style="padding-bottom: 2px;">','<label class="input-label">'+this.textDataRange+"</label>","</td>","</tr>","<tr>",'<td class="padding-large">','<div id="create-pivot-input-source" class="input-row" style=""></div>',"</td>","</tr>","<tr>",'<td class="padding-small">','<label class="input-label">'+this.textDestination+"</label>","</td>","</tr>","<tr>",'<td class="padding-small">','<div id="create-pivot-radio-new"></div>',"</td>","</tr>","<tr>",'<td class="padding-small">','<div id="create-pivot-radio-exist"></div>',"</td>","</tr>","<tr>",'<td class="padding-left-22">','<div id="create-pivot-input-dest" class="input-row" style=""></div>',"</td>","</tr>","</table>","</div></div>","</div>","</div>"].join("")},i),this.api=i.api,this.props=i.props,this.options.handler=function(t,e){if("ok"==t&&!this.isRangeValid())return!0;i.handler&&i.handler.call(this,t,e)},this.dataSourceValid="",this.dataDestValid="",Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var i=this;this.txtSourceRange=new Common.UI.InputFieldBtn({el:$("#create-pivot-input-source"),name:"range",style:"width: 100%;",btnHint:this.textSelectData,allowBlank:!0,validateOnChange:!0}),this.txtSourceRange.on("button:click",_.bind(this.onSelectData,this,"source")),this.txtDestRange=new Common.UI.InputFieldBtn({el:$("#create-pivot-input-dest"),name:"range",style:"width: 100%;",btnHint:this.textSelectData,allowBlank:!0,validateOnChange:!0,validateOnBlur:!1,disabled:!0}),this.txtDestRange.on("button:click",_.bind(this.onSelectData,this,"dest")),this.radioNew=new Common.UI.RadioBox({el:$("#create-pivot-radio-new"),labelText:this.textNew,name:"asc-radio-pivot-dest",checked:!0}).on("change",function(t,e){i.txtDestRange.setDisabled(e),i.txtDestRange.showError()}),this.radioExist=new Common.UI.RadioBox({el:$("#create-pivot-radio-exist"),labelText:this.textExist,name:"asc-radio-pivot-dest"}).on("change",function(t,e){i.txtDestRange.setDisabled(!e),i.txtDestRange.cmpEl.find("input").focus()}),this.afterRender()},getFocusedComponents:function(){return[this.txtSourceRange,this.radioNew,this.radioExist,this.txtDestRange]},getDefaultFocusableComponent:function(){if(!this._alreadyRendered)return this._alreadyRendered=!0,this.txtSourceRange},afterRender:function(){this._setDefaults(this.props)},_setDefaults:function(t){var e;t&&(t=t.asc_getRange(),this.txtSourceRange.setValue(t||""),this.dataSourceValid=t,(e=this).txtSourceRange.validation=function(t){return e.api.asc_checkDataRange(Asc.c_oAscSelectionDialogType.PivotTableData,t,!1)!=Asc.c_oAscError.ID.DataRangeError||e.textInvalidRange},this.txtDestRange.validation=function(t){return e.api.asc_checkDataRange(Asc.c_oAscSelectionDialogType.PivotTableReport,t,!1)!=Asc.c_oAscError.ID.DataRangeError||e.textInvalidRange})},getSettings:function(){return{source:this.txtSourceRange.getValue(),destination:this.radioExist.getValue()?this.txtDestRange.getValue():null}},isRangeValid:function(){var t=!0,e="";return _.isEmpty(this.txtSourceRange.getValue())?(t=!1,e=this.txtEmpty):(t=(t=this.api.asc_checkDataRange(Asc.c_oAscSelectionDialogType.PivotTableData,this.txtSourceRange.getValue()))==Asc.c_oAscError.ID.No)||(e=this.textInvalidRange),t?this.radioExist.getValue()&&(_.isEmpty(this.txtDestRange.getValue())?(t=!1,e=this.txtEmpty):(t=(t=this.api.asc_checkDataRange(Asc.c_oAscSelectionDialogType.PivotTableReport,this.txtDestRange.getValue()))==Asc.c_oAscError.ID.No)||(e=this.textInvalidRange),t||(this.txtDestRange.showError([e]),this.txtDestRange.cmpEl.find("input").focus())):(this.txtSourceRange.showError([e]),this.txtSourceRange.cmpEl.find("input").focus()),t},onSelectData:function(i){var t,e,s=this,o="source"==i?s.txtSourceRange:s.txtDestRange;s.api&&(t=new SSE.Views.CellRangeDialog({handler:function(t,e){"ok"==e&&(e=t.getSettings(),"source"==i?s.dataSourceValid=e:s.dataDestValid=e,o.setValue(e),o.checkValidate())}}).on("close",function(){s.show(),_.delay(function(){o.focus()},1)}),e=s.$window.offset(),s.hide(),t.show(e.left+160,e.top+125),t.setSettings({api:s.api,range:_.isEmpty(o.getValue())||1!=o.checkValidate()?"source"==i?s.dataSourceValid:s.dataDestValid:o.getValue(),type:"source"==i?Asc.c_oAscSelectionDialogType.PivotTableData:Asc.c_oAscSelectionDialogType.PivotTableReport}))}},SSE.Views.CreatePivotDialog||{}))}),define("spreadsheeteditor/main/app/controller/PivotTable",["core","spreadsheeteditor/main/app/view/PivotTable","spreadsheeteditor/main/app/view/CreatePivotDialog"],function(){"use strict";SSE.Controllers.PivotTable=Backbone.Controller.extend(_.extend({models:[],views:["PivotTable"],sdkViewName:"#id_main",initialize:function(){this.addListeners({PivotTable:{"pivottable:rowscolumns":_.bind(this.onCheckTemplateChange,this),"pivottable:create":_.bind(this.onCreateClick,this),"pivottable:refresh":_.bind(this.onRefreshClick,this),"pivottable:select":_.bind(this.onSelectClick,this),"pivottable:style":_.bind(this.onPivotStyleSelect,this),"pivottable:layout":_.bind(this.onPivotLayout,this),"pivottable:blankrows":_.bind(this.onPivotBlankRows,this),"pivottable:subtotals":_.bind(this.onPivotSubtotals,this),"pivottable:grandtotals":_.bind(this.onPivotGrandTotals,this),"pivot:open":_.bind(this.onPivotOpen,this)},TableSettings:{"pivottable:create":_.bind(this.onCreateClick,this)}})},onLaunch:function(){this._state={TableName:"",TemplateName:"",RowHeader:void 0,RowBanded:void 0,ColHeader:void 0,ColBanded:void 0,DisabledControls:!1},this._originalProps=null,Common.NotificationCenter.on("app:ready",this.onAppReady.bind(this)),Common.NotificationCenter.on("api:disconnect",_.bind(this.SetDisabled,this)),Common.NotificationCenter.on("more:toggle",_.bind(this.onMoreToggle,this))},setConfig:function(t){this.view=this.createView("PivotTable",{toolbar:t.toolbar.toolbar})},setApi:function(t){return t&&(this.api=t,this.api.asc_registerCallback("asc_onCoAuthoringDisconnect",_.bind(this.SetDisabled,this)),Common.NotificationCenter.on("api:disconnect",_.bind(this.SetDisabled,this)),this.api.asc_registerCallback("asc_onSendThemeColors",_.bind(this.onSendThemeColors,this)),this.api.asc_registerCallback("asc_onSelectionChanged",_.bind(this.onSelectionChanged,this)),Common.NotificationCenter.on("cells:range",_.bind(this.onCellsRange,this))),this},setMode:function(t){return this.appConfig=t,this},SetDisabled:function(){this.view&&this.view.SetDisabled(!0)},onCheckTemplateChange:function(t,e){switch(t){case 0:this._originalProps.asc_getStyleInfo().asc_setShowRowHeaders(this.api,this._originalProps,"checked"==e);break;case 1:this._originalProps.asc_getStyleInfo().asc_setShowColHeaders(this.api,this._originalProps,"checked"==e);break;case 2:this._originalProps.asc_getStyleInfo().asc_setShowRowStripes(this.api,this._originalProps,"checked"==e);break;case 3:this._originalProps.asc_getStyleInfo().asc_setShowColStripes(this.api,this._originalProps,"checked"==e)}Common.NotificationCenter.trigger("edit:complete",this)},createSheetName:function(){for(var t=[],e=this.api.asc_getWorksheetsCount();e--;)t.push(this.api.asc_getWorksheetName(e).toLowerCase());for(var i,s=0;++s<1e3&&(i=this.strSheet+s,!(t.indexOf(i.toLowerCase())<0)););return i},onCreateClick:function(t,e){var i,s;this.api&&(i=this.api.asc_getAddPivotTableOptions())&&(s=this,new SSE.Views.CreatePivotDialog({props:i,api:s.api,handler:function(t,e){"ok"==t&&e&&(s.view&&s.view.fireEvent("insertpivot",s.view),e.destination?s.api.asc_insertPivotExistingWorksheet(e.source,e.destination):s.api.asc_insertPivotNewWorksheet(e.source,s.createSheetName())),Common.NotificationCenter.trigger("edit:complete",s)}}).show()),Common.NotificationCenter.trigger("edit:complete",this)},onRefreshClick:function(t){this.api&&("current"==t?this._originalProps.asc_refresh(this.api):"all"==t&&this.api.asc_refreshAllPivots()),Common.NotificationCenter.trigger("edit:complete",this)},onSelectClick:function(t,e){this.api&&this._originalProps.asc_select(this.api),Common.NotificationCenter.trigger("edit:complete",this)},onPivotStyleSelect:function(t){this.api&&this._originalProps.asc_getStyleInfo().asc_setName(this.api,this._originalProps,t.get("name")),Common.NotificationCenter.trigger("edit:complete",this)},onPivotBlankRows:function(t){var e;this.api&&((e=new Asc.CT_pivotTableDefinition).asc_setInsertBlankRow("insert"===t),this._originalProps.asc_set(this.api,e)),Common.NotificationCenter.trigger("edit:complete",this)},onPivotLayout:function(t){if(this.api){var e=new Asc.CT_pivotTableDefinition;switch(t){case 0:e.asc_setCompact(!0),e.asc_setOutline(!0);break;case 1:e.asc_setCompact(!1),e.asc_setOutline(!0);break;case 2:e.asc_setCompact(!1),e.asc_setOutline(!1);break;case 3:e.asc_setFillDownLabelsDefault(!0);break;case 4:e.asc_setFillDownLabelsDefault(!1)}this._originalProps.asc_set(this.api,e)}Common.NotificationCenter.trigger("edit:complete",this)},onPivotGrandTotals:function(t){var e;this.api&&((e=new Asc.CT_pivotTableDefinition).asc_setColGrandTotals(1==t||2==t),e.asc_setRowGrandTotals(1==t||3==t),this._originalProps.asc_set(this.api,e)),Common.NotificationCenter.trigger("edit:complete",this)},onPivotSubtotals:function(t){if(this.api){var e=new Asc.CT_pivotTableDefinition;switch(t){case 0:e.asc_setDefaultSubtotal(!1);break;case 1:e.asc_setDefaultSubtotal(!0),e.asc_setSubtotalTop(!1);break;case 2:e.asc_setDefaultSubtotal(!0),e.asc_setSubtotalTop(!0)}this._originalProps.asc_set(this.api,e)}Common.NotificationCenter.trigger("edit:complete",this)},ChangeSettings:function(t){var e,i,s,o;t&&(this._originalProps=t,e=this.view,i=!1,o=(s=t.asc_getStyleInfo()).asc_getShowRowHeaders(),this._state.RowHeader!==o&&(e.chRowHeader.setValue(o,!0),this._state.RowHeader=o,i=!0),o=s.asc_getShowColHeaders(),this._state.ColHeader!==o&&(e.chColHeader.setValue(o,!0),this._state.ColHeader=o,i=!0),o=s.asc_getShowColStripes(),this._state.ColBanded!==o&&(e.chColBanded.setValue(o,!0),this._state.ColBanded=o,i=!0),o=s.asc_getShowRowStripes(),this._state.RowBanded!==o&&(e.chRowBanded.setValue(o,!0),this._state.RowBanded=o,i=!0),o=t.asc_getColGrandTotals(),this._state.ColGrandTotals!==o&&(this._state.ColGrandTotals=o,i=!0),o=t.asc_getRowGrandTotals(),this._state.RowGrandTotals!==o&&(this._state.RowGrandTotals=o,i=!0),i&&this.onApiInitPivotStyles(this.api.asc_getTablePictures(this._originalProps,!0)),o=s.asc_getName(),this._state.TemplateName===o&&!this._isTemplatesChanged||(e.pivotStyles.suspendEvents(),t=e.pivotStyles.menuPicker.store.findWhere({name:o}),e.pivotStyles.menuPicker.selectRecord(t),e.pivotStyles.resumeEvents(),this._isTemplatesChanged&&(t?e.pivotStyles.fillComboView(e.pivotStyles.menuPicker.getSelectedRec(),!0):e.pivotStyles.fillComboView(e.pivotStyles.menuPicker.store.at(0),!0)),this._state.TemplateName=o),this._isTemplatesChanged=!1)},onSendThemeColors:function(){this.view.pivotStyles&&this._originalProps&&(this.onApiInitPivotStyles(this.api.asc_getTablePictures(this._originalProps,!0)),this.view.pivotStyles.menuPicker.scroller.update({alwaysVisibleY:!0}))},onApiInitPivotStyles:function(t){var s,e,a,l=this,i=this.view.pivotStyles,o=(this._isTemplatesChanged=!0,i.menuPicker.store.length);0<o&&o==t.length?(s=i.menuPicker.dataViewItems,s&&_.each(t,function(t,e){var i=t.asc_getImage(),t=function(t){for(var e=0;e<s.length;e++){if(s[e].model.get("name")&&s[e].model.get("name")===t.asc_getName())return s[e];if(s[e].model.get("caption")===t.asc_getDisplayName())return s[e]}}(t);t&&t.model.set("imageUrl",i,{silent:!0}),t&&$(t.el).find("img").attr("src",i)}),i.fieldPicker.store.reset(i.fieldPicker.store.models)):(i.menuPicker.store.reset([]),e=[],a=[{id:"menu-table-group-custom",caption:l.view.txtGroupPivot_Custom,templates:[]},{id:"menu-table-group-light",caption:l.view.txtGroupPivot_Light,templates:[]},{id:"menu-table-group-medium",caption:l.view.txtGroupPivot_Medium,templates:[]},{id:"menu-table-group-dark",caption:l.view.txtGroupPivot_Dark,templates:[]},{id:"menu-table-group-no-name",caption:"&nbsp",templates:[]}],_.each(t,function(t,e){var i,s=t.asc_getDisplayName(),o="",n=null;0==t.asc_getType()?(n=(i=s.split(" ")).pop(),null===t.asc_getName()?o="menu-table-group-light":(0<i.length&&(o="menu-table-group-"+i[i.length-1].toLowerCase()),0==a.some(function(t){return t.id===o})&&(o="menu-table-group-no-name")),i="txtTable_"+i.join(""),s=l.view[i]?l.view[i]+" "+n:s,n=parseInt(n)):o="menu-table-group-custom",a.filter(function(t){return t.id==o})[0].templates.push({id:Common.UI.getId(),name:t.asc_getName(),caption:t.asc_getDisplayName(),type:t.asc_getType(),imageUrl:t.asc_getImage(),group:o,allowSelected:!0,selected:!1,tip:s,numInGroup:null==n||isNaN(n)?null:n})}),a[1].templates.sort(o=function(t,e){return t.numInGroup-e.numInGroup}),a[2].templates.sort(o),a[3].templates.sort(o),(a=a.filter(function(t,e){return 0<t.templates.length})).forEach(function(t){e=e.concat(t.templates),delete t.templates}),i.groups.reset(a),i.menuPicker.store.reset(e))},onPivotOpen:function(){var t,e=this.view.pivotStyles;e&&e.needFillComboView&&0<e.menuPicker.store.length&&e.rendered&&(this._state.TemplateName&&(t=e.menuPicker.store.findWhere({name:this._state.TemplateName})),e.fillComboView(t||e.menuPicker.store.at(0),!0))},onSelectionChanged:function(t){var e;!this.rangeSelectionMode&&this.appConfig.isEdit&&this.view&&(e=t.asc_getPivotTableInfo(),Common.Utils.lockControls(Common.enumLock.noPivot,!e,{array:this.view.lockedControls}),Common.Utils.lockControls(Common.enumLock.pivotLock,e&&!0===t.asc_getLockedPivotTable(),{array:this.view.lockedControls}),Common.Utils.lockControls(Common.enumLock.editPivot,!!e,{array:this.view.btnsAddPivot}),e&&this.ChangeSettings(e))},onCellsRange:function(t){this.rangeSelectionMode=t!=Asc.c_oAscSelectionDialogType.None},createToolbarPanel:function(){return this.view.getPanel()},getView:function(t){return!t&&this.view?this.view:Backbone.Controller.prototype.getView.call(this,t)},onAppReady:function(t){new Promise(function(t){t()}).then(function(){})},onMoreToggle:function(t,e,i){var s;this.view&&this.view.toolbar&&this.view.toolbar.isTabActive("pivot")&&e&&((e=this.view.pivotStyles)&&e.needFillComboView&&0<e.menuPicker.store.length&&e.rendered&&(this._state.TemplateName&&(s=e.menuPicker.store.findWhere({name:this._state.TemplateName})),e.fillComboView(s||e.menuPicker.store.at(0),!0)))},strSheet:"Sheet"},SSE.Controllers.PivotTable||{}))}),void 0===Common&&(Common={}),define("spreadsheeteditor/main/app/view/TableOptionsDialog",["common/main/lib/component/ComboBox","common/main/lib/component/CheckBox","common/main/lib/component/InputField","common/main/lib/component/Window"],function(){"use strict";SSE.Views.TableOptionsDialog=Common.UI.Window.extend(_.extend({options:{width:355,cls:"modal-dlg",modal:!1,buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:this.txtFormat},t),this.template=['<div class="box">','<div id="id-dlg-tableoptions-range" class="input-row"  style="margin-bottom: 5px;"></div>','<div class="input-row hidden" id="id-dlg-tableoptions-title" style="margin-top: 5px;"></div>','<label class="" id="id-dlg-tableoptions-lbl" style="margin-top: 5px;">'+this.txtNote+"</label>","</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),this.checkRangeType=Asc.c_oAscSelectionDialogType.FormatTable,this.selectionType=Asc.c_oAscSelectionType.RangeCells,Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this.getChild();this.inputRange=new Common.UI.InputField({el:$("#id-dlg-tableoptions-range"),name:"range",style:"width: 100%;",allowBlank:!1,blankError:this.txtEmpty,validateOnChange:!0}),this.cbTitle=new Common.UI.CheckBox({el:$("#id-dlg-tableoptions-title"),labelText:this.txtTitle}),this.lblNote=t.find("#id-dlg-tableoptions-lbl"),t.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.on("close",_.bind(this.onClose,this))},onPrimary:function(){return this._handleInput("ok"),!1},setSettings:function(t){var e,i=this;t.api&&(i.api=t.api,t.range?(i.checkRangeType=Asc.c_oAscSelectionDialogType.FormatTableChangeRange,i.inputRange.setValue(t.range),i.api.asc_setSelectionDialogMode(Asc.c_oAscSelectionDialogType.FormatTable,t.range)):(i.cbTitle.$el&&i.cbTitle.$el.removeClass("hidden"),i.lblNote.addClass("hidden"),i.setHeight(152),e=i.api.asc_getAddFormatTableOptions(),i.inputRange.setValue(e.asc_getRange()),i.cbTitle.setValue(e.asc_getIsTitle()),i.api.asc_setSelectionDialogMode(Asc.c_oAscSelectionDialogType.FormatTable,e.asc_getRange())),t.title&&i.setTitle(t.title),t.selectionType&&(i.selectionType=t.selectionType),i.wrapEvents={onApiRangeChanged:_.bind(i.onApiRangeChanged,i)},i.api.asc_registerCallback("asc_onSelectionRangeChanged",i.wrapEvents.onApiRangeChanged),Common.NotificationCenter.trigger("cells:range",Asc.c_oAscSelectionDialogType.FormatTable)),i.inputRange.validation=function(t){return i.api.asc_checkDataRange(i.checkRangeType,t,!1)!=Asc.c_oAscError.ID.DataRangeError||i.txtInvalidRange}},getSettings:function(){var t;return this.checkRangeType==Asc.c_oAscSelectionDialogType.FormatTable?((t=this.api.asc_getAddFormatTableOptions(this.inputRange.getValue())).asc_setIsTitle(this.cbTitle.checked),{selectionType:this.selectionType,range:t}):{selectionType:this.selectionType,range:this.inputRange.getValue()}},onApiRangeChanged:function(t){this.inputRange.setValue(t),this.inputRange.cmpEl.hasClass("error")&&this.inputRange.cmpEl.removeClass("error")},isRangeValid:function(){var t=this.api.asc_checkDataRange(this.checkRangeType,this.inputRange.getValue(),!0);if(t==Asc.c_oAscError.ID.No)return!0;switch(t){case Asc.c_oAscError.ID.AutoFilterDataRangeError:Common.UI.warning({msg:this.errorAutoFilterDataRange});break;case Asc.c_oAscError.ID.FTChangeTableRangeError:Common.UI.warning({msg:this.errorFTChangeTableRangeError});break;case Asc.c_oAscError.ID.FTRangeIncludedOtherTables:Common.UI.warning({msg:this.errorFTRangeIncludedOtherTables});break;case Asc.c_oAscError.ID.MultiCellsInTablesFormulaArray:Common.UI.warning({msg:this.errorMultiCellFormula});break;case Asc.c_oAscError.ID.LargeRangeWarning:return this.selectionType=Asc.c_oAscSelectionType.RangeMax,!0}return!1},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onClose:function(t){this.api&&(this.api.asc_setSelectionDialogMode(Asc.c_oAscSelectionDialogType.None),this.api.asc_unregisterCallback("asc_onSelectionRangeChanged",this.wrapEvents.onApiRangeChanged)),Common.NotificationCenter.trigger("cells:range",Asc.c_oAscSelectionDialogType.None),Common.NotificationCenter.trigger("edit:complete",this),SSE.getController("RightMenu").SetDisabled(!1)},_handleInput:function(t){if(this.options.handler){if("ok"==t&&!0!==this.isRangeValid())return;this.options.handler.call(this,this,t)}this.close()},show:function(){Common.UI.Window.prototype.show.call(this),SSE.getController("RightMenu").SetDisabled(!0)}},SSE.Views.TableOptionsDialog||{}))}),define("spreadsheeteditor/main/app/view/NamedRangeEditDlg",["common/main/lib/view/AdvancedSettingsWindow","common/main/lib/component/ComboBox","common/main/lib/component/InputField"],function(){"use strict";SSE.Views=SSE.Views||{},SSE.Views.NamedRangeEditDlg=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{alias:"NamedRangeEditDlg",contentWidth:380,height:250},initialize:function(t){_.extend(this.options,{title:this.txtTitleNew,template:['<div class="box" style="height:'+(this.options.height-85)+'px;">','<div class="content-panel" style="padding: 0;"><div class="inner-content">','<div class="settings-panel active">','<table cols="1" style="width: 100%;">',"<tr>",'<td class="padding-small">','<label class="header">',this.textName,"</label>",'<div id="named-range-txt-name" class="input-row" style="width:100%;"></div>',"</td>","</tr>","<tr>",'<td class="padding-small">','<label class="header">',this.textScope,"</label>",'<div id="named-range-combo-scope" class="input-group-nr" style="width:100%;"></div>',"</td>","</tr>","<tr>","<td>",'<label class="header">',this.textDataRange,"</label>","</td>","</tr>","<tr>",'<td class="padding-small">','<div id="named-range-txt-range" class="input-row"></div>',"</td>","</tr>","</table>","</div></div>","</div>","</div>",'<div class="separator horizontal"></div>'].join("")},t),this.api=t.api,this.handler=t.handler,this.isEdit=t.isEdit||!1,this.sheets=t.sheets||[],this.props=t.props,this.dataRangeValid="",this.wrapEvents={onRefreshDefNameList:_.bind(this.onRefreshDefNameList,this),onLockDefNameManager:_.bind(this.onLockDefNameManager,this)},Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var i=this;this.inputName=new Common.UI.InputField({el:$("#named-range-txt-name"),allowBlank:!1,placeHolder:this.namePlaceholder,blankError:this.txtEmpty,validateOnChange:!1,validateOnBlur:!1,style:"width: 100%;",validation:function(t){var e=i.api.asc_checkDefinedName(t,-255==i.cmbScope.getValue()?null:i.cmbScope.getValue());if(!0===e.asc_getStatus())return!0;switch(e.asc_getReason()){case Asc.c_oAscDefinedNameReason.IsLocked:return i.textIsLocked;case Asc.c_oAscDefinedNameReason.Existed:return!(!i.isEdit||i.props.asc_getName(!0).toLowerCase()!=t.toLowerCase())||i.textExistName;case Asc.c_oAscDefinedNameReason.NameReserved:return!i.isEdit||i.textReservedName;default:return i.textInvalidName}}}),this.inputName._input.on("input",function(t,e){i.isInputFirstChange&&i.inputName.showError(),i.isInputFirstChange=!1}),this.cmbScope=new Common.UI.ComboBox({el:$("#named-range-combo-scope"),style:"width: 100%;",menuStyle:"min-width: 100%;max-height: 280px;",editable:!1,cls:"input-group-nr",data:[],takeFocusOnClose:!0}),this.txtDataRange=new Common.UI.InputFieldBtn({el:$("#named-range-txt-range"),name:"range",style:"width: 100%;",allowBlank:!0,btnHint:this.textSelectData,blankError:this.txtEmpty,validateOnChange:!0,validation:function(t){return!!_.isEmpty(t)||(!!(i.api.asc_checkDataRange(Asc.c_oAscSelectionDialogType.Chart,t,!1)!==Asc.c_oAscError.ID.DataRangeError||i.isEdit&&i.props.asc_getRef().toLowerCase()==t.toLowerCase())||i.textInvalidRange)}}),this.txtDataRange.on("button:click",_.bind(this.onSelectData,this)),this.afterRender()},getFocusedComponents:function(){return[this.inputName,this.cmbScope,this.txtDataRange]},getDefaultFocusableComponent:function(){if(!this._alreadyRendered)return this._alreadyRendered=!0,this.inputName},afterRender:function(){this._setDefaults(this.props),this.setTitle(this.isEdit?this.txtTitleEdit:this.txtTitleNew),this.api.asc_registerCallback("asc_onLockDefNameManager",this.wrapEvents.onLockDefNameManager),this.api.asc_registerCallback("asc_onRefreshDefNameList",this.wrapEvents.onRefreshDefNameList)},show:function(){Common.Views.AdvancedSettingsWindow.prototype.show.apply(this,arguments)},_setDefaults:function(t){var e;this.cmbScope.setData([{value:-255,displayValue:this.strWorkbook}].concat(this.sheets)),t?(e=t.asc_getScope(),this.cmbScope.setValue(null===e?-255:e),e=t.asc_getName(!0),_.isEmpty(e)||this.inputName.setValue(e),e=t.asc_getRef(),this.txtDataRange.setValue(e||""),this.dataRangeValid=e,this.txtDataRange.setDisabled(this.isEdit&&(t.asc_getType()===Asc.c_oAscDefNameType.table||t.asc_getType()===Asc.c_oAscDefNameType.slicer))):this.cmbScope.setValue(-255),this.cmbScope.setDisabled(this.isEdit)},onSelectData:function(){var t,e,i=this;i.api&&(t=new SSE.Views.CellRangeDialog({handler:function(t,e){"ok"==e&&(i.dataRangeValid=t.getSettings(),i.txtDataRange.setValue(i.dataRangeValid),i.txtDataRange.checkValidate())}}).on("close",function(){i.show(),_.delay(function(){i.txtDataRange.focus()},1)}),e=i.$window.offset(),i.hide(),t.show(e.left+65,e.top+77),t.setSettings({api:i.api,range:_.isEmpty(i.txtDataRange.getValue())||1!=i.txtDataRange.checkValidate()?i.dataRangeValid:i.txtDataRange.getValue(),type:Asc.c_oAscSelectionDialogType.Chart}))},getSettings:function(){return new Asc.asc_CDefName(this.inputName.getValue(),this.txtDataRange.getValue(),-255==this.cmbScope.getValue()?null:this.cmbScope.getValue(),this.props.asc_getType(),void 0,void 0,void 0,!0)},onPrimary:function(){return this.onDlgBtnClick("ok"),!1},onDlgBtnClick:function(t){var e=this,t="object"==typeof t?t.currentTarget.attributes.result.value:t;if("ok"==t){if(this.locked)return void Common.UI.alert({msg:this.errorCreateDefName,title:this.notcriticalErrorTitle,iconCls:"warn",buttons:["ok"],callback:function(t){e.close()}});var i=this.inputName.checkValidate(),s=this.txtDataRange.checkValidate();if(!0!==i)return this.inputName.focus(),void(this.isInputFirstChange=!0);if(!0!==s)return void this.txtDataRange.focus();this.handler&&this.handler.call(this,t,"ok"==t?this.getSettings():void 0)}this.close()},onLockDefNameManager:function(t){this.locked=t==Asc.c_oAscDefinedNameReason.LockDefNameManager},onRefreshDefNameList:function(t){var e=this;this.isEdit&&Common.Utils.InternalSettings.get("sse-settings-coauthmode")&&t&&t.asc_getIsLock()&&t.asc_getName(!0).toLowerCase()==this.props.asc_getName(!0).toLowerCase()&&(null===t.asc_getScope()&&null===this.props.asc_getScope()||t.asc_getScope().toLowerCase()==this.props.asc_getScope().toLowerCase())&&!this._listRefreshed&&(this._listRefreshed=!0,Common.UI.alert({closable:!1,msg:this.errorCreateDefName,title:this.notcriticalErrorTitle,iconCls:"warn",buttons:["ok"],callback:function(t){e.close()}}))},close:function(){this.api.asc_unregisterCallback("asc_onLockDefNameManager",this.wrapEvents.onLockDefNameManager),this.api.asc_unregisterCallback("asc_onRefreshDefNameList",this.wrapEvents.onRefreshDefNameList),Common.UI.Window.prototype.close.call(this)}},SSE.Views.NamedRangeEditDlg||{}))}),define("spreadsheeteditor/main/app/view/NamedRangePasteDlg",["common/main/lib/view/AdvancedSettingsWindow","common/main/lib/component/ListView"],function(){"use strict";SSE.Views=SSE.Views||{},SSE.Views.NamedRangePasteDlg=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{alias:"NamedRangePasteDlg",contentWidth:250,height:282},initialize:function(t){_.extend(this.options,{title:this.txtTitle,template:['<div class="box" style="height:'+(this.options.height-85)+'px;">','<div class="content-panel" style="padding: 0;"><div class="inner-content">','<div class="settings-panel active">','<table cols="1" style="width: 100%;">',"<tr>",'<td class="padding-small">','<label class="input-label">',this.textNames,"</label>",'<div id="named-range-paste-list" class="range-tableview" style="width:100%; height: 169px;"></div>',"</td>","</tr>","</table>","</div></div>","</div>","</div>"].join("")},t),this.handler=t.handler,this.ranges=t.ranges||[],Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);this.rangeList=new Common.UI.ListView({el:$("#named-range-paste-list",this.$window),store:new Common.UI.DataViewStore,simpleAddMode:!0,cls:"dbl-clickable",itemTemplate:_.template(['<div style="pointer-events:none;">','<div id="<%= id %>" class="list-item" style="width: 100%;display:inline-block;">','<div class="listitem-icon toolbar__icon margin-right-5 <% print(isTable?"btn-menu-table":(isSlicer ? "btn-slicer" : "btn-named-range")) %>"></div>','<div class="padding-right-5" style="width:186px;"><%= Common.Utils.String.htmlEncode(name) %></div>',"</div>","</div>"].join(""))}),this.rangeList.store.comparator=function(t,e){t=t.get("name").toLowerCase(),e=e.get("name").toLowerCase();return t==e?0:t<e?-1:1},this.rangeList.on("item:dblclick",_.bind(this.onDblClickFunction,this)),this.rangeList.on("entervalue",_.bind(this.onPrimary,this)),this.afterRender()},afterRender:function(){this._setDefaults()},_setDefaults:function(){if(this.ranges){for(var t=this,e=[],i="",s=0;s<this.ranges.length;s++){var o,n=this.ranges[s].asc_getName(!0);n!==i&&(o=this.ranges[s].asc_getType(),e.push({name:n,scope:this.ranges[s].asc_getScope(),range:this.ranges[s].asc_getRef(),type:o,isTable:o===Asc.c_oAscDefNameType.table,isSlicer:o===Asc.c_oAscDefNameType.slicer})),i=n}this.rangeList.store.reset(e),this.rangeList.store.sort(),0<this.rangeList.store.length&&this.rangeList.selectByIndex(0),this.rangeList.scroller.update({alwaysVisibleY:!0}),_.delay(function(){t.rangeList.focus()},100,this)}},getSettings:function(){var t=this.rangeList.getSelectedRec();return t?new Asc.asc_CDefName(t.get("name"),t.get("range"),t.get("scope"),t.get("type"),void 0,void 0,void 0,!0):null},onPrimary:function(){return this.handler&&this.handler.call(this,"ok",this.getSettings()),this.close(),!1},onDlgBtnClick:function(t){t=t.currentTarget.attributes.result.value;this.handler&&this.handler.call(this,t,"ok"==t?this.getSettings():void 0),this.close()},onDblClickFunction:function(){this.handler&&this.handler.call(this,"ok",this.getSettings()),this.close()},txtTitle:"Paste Name",textNames:"Named Ranges"},SSE.Views.NamedRangePasteDlg||{}))}),define("spreadsheeteditor/main/app/view/PageMarginsDialog",["common/main/lib/component/Window","common/main/lib/component/MetricSpinner"],function(){"use strict";SSE.Views.PageMarginsDialog=Common.UI.Window.extend(_.extend({options:{width:215,header:!0,style:"min-width: 216px;",cls:"modal-dlg",id:"window-page-margins",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:this.textTitle},t||{}),this.template=['<div class="box" style="height: 85px;">','<table cols="2" style="width: 100%;margin-bottom: 10px;">',"<tr>",'<td class="padding-right-10" style="padding-bottom: 8px;">','<label class="input-label">'+this.textTop+"</label>",'<div id="page-margins-spin-top"></div>',"</td>",'<td style="padding-bottom: 8px;">','<label class="input-label">'+this.textBottom+"</label>",'<div id="page-margins-spin-bottom"></div>',"</td>","</tr>","<tr>",'<td class="padding-small padding-right-10">','<label class="input-label">'+this.textLeft+"</label>",'<div id="page-margins-spin-left"></div>',"</td>",'<td class="padding-small">','<label class="input-label">'+this.textRight+"</label>",'<div id="page-margins-spin-right"></div>',"</td>","</tr>","</table>","</div>",'<div class="separator horizontal"></div>'].join(""),this.options.tpl=_.template(this.template)(this.options),this.spinners=[],this._noApply=!1,this.maxMarginsW=this.maxMarginsH=0,Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this),this.spnTop=new Common.UI.MetricSpinner({el:$("#page-margins-spin-top"),step:.1,width:86,defaultUnit:"cm",value:"0",maxValue:48.25,minValue:0}),this.spinners.push(this.spnTop),this.spnBottom=new Common.UI.MetricSpinner({el:$("#page-margins-spin-bottom"),step:.1,width:86,defaultUnit:"cm",value:"0",maxValue:48.25,minValue:0}),this.spinners.push(this.spnBottom),this.spnLeft=new Common.UI.MetricSpinner({el:$("#page-margins-spin-left"),step:.1,width:86,defaultUnit:"cm",value:"0.19 cm",maxValue:48.25,minValue:0}),this.spinners.push(this.spnLeft),this.spnRight=new Common.UI.MetricSpinner({el:$("#page-margins-spin-right"),step:.1,width:86,defaultUnit:"cm",value:"0.19 cm",maxValue:48.25,minValue:0}),this.spinners.push(this.spnRight);var t=this.getChild();t.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),t.find("input").on("keypress",_.bind(this.onKeyPress,this)),this.updateMetricUnit()},getFocusedComponents:function(){return this.spinners},getDefaultFocusableComponent:function(){return this.spnTop},_handleInput:function(t){if(this.options.handler){if("ok"==t){var e=this,i=null,s=this.spnTop.getNumberValue(),o=this.spnBottom.getNumberValue(),n=this.spnLeft.getNumberValue(),a=this.spnRight.getNumberValue();if(n>this.maxMarginsW?i="left":a>this.maxMarginsW-n?i="right":s>this.maxMarginsH?i="top":o>this.maxMarginsH-s&&(i="bottom"),i)return void Common.UI.warning({title:this.textWarning,msg:this.warnCheckMargings,callback:function(){switch(i){case"left":return void e.spnLeft.focus();case"right":return void e.spnRight.focus();case"top":return void e.spnTop.focus();case"bottom":return void e.spnBottom.focus()}}})}this.options.handler.call(this,this,t)}this.close()},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onKeyPress:function(t){t.keyCode==Common.UI.Keys.RETURN&&this._handleInput("ok")},setSettings:function(t){var e;t&&(e=t.asc_getPageMargins(),t=t.asc_getPageSetup(),this.maxMarginsH=Common.Utils.Metric.fnRecalcFromMM(t.asc_getHeight()),this.maxMarginsW=Common.Utils.Metric.fnRecalcFromMM(t.asc_getWidth()),this.spnTop.setValue(Common.Utils.Metric.fnRecalcFromMM(e.asc_getTop()),!0),this.spnBottom.setValue(Common.Utils.Metric.fnRecalcFromMM(e.asc_getBottom()),!0),this.spnLeft.setValue(Common.Utils.Metric.fnRecalcFromMM(e.asc_getLeft()),!0),this.spnRight.setValue(Common.Utils.Metric.fnRecalcFromMM(e.asc_getRight()),!0))},getSettings:function(){var t=new Asc.asc_CPageMargins;return t.asc_setTop(Common.Utils.Metric.fnRecalcToMM(this.spnTop.getNumberValue())),t.asc_setBottom(Common.Utils.Metric.fnRecalcToMM(this.spnBottom.getNumberValue())),t.asc_setLeft(Common.Utils.Metric.fnRecalcToMM(this.spnLeft.getNumberValue())),t.asc_setRight(Common.Utils.Metric.fnRecalcToMM(this.spnRight.getNumberValue())),t},updateMetricUnit:function(){if(this.spinners)for(var t=0;t<this.spinners.length;t++)this.spinners[t].setDefaultUnit(Common.Utils.Metric.getCurrentMetricName())}},SSE.Views.PageMarginsDialog||{}))}),define("spreadsheeteditor/main/app/view/HeaderFooterDialog",["common/main/lib/util/utils","common/main/lib/component/InputField","common/main/lib/component/Window","common/main/lib/component/ComboBoxFonts"],function(){"use strict";SSE.Views.HeaderFooterDialog=Common.UI.Window.extend(_.extend({options:{width:650,style:"min-width: 350px;",cls:"modal-dlg enable-key-events",animate:{mask:!1},buttons:["ok","cancel"],id:"window-header-footer"},initialize:function(t){_.extend(this.options,{title:this.textTitle},t||{}),this.api=this.options.api,this.props=this.options.props,this.fontStore=this.options.fontStore,this.pageSetup=this.options.pageSetup,this.isFooter=!1,this.currentCanvas=null,this.headerControls=[],this.footerControls=[],this._state={clrtext:void 0,bold:void 0,italic:void 0,underline:void 0,strikeout:void 0,subscript:void 0,superscript:void 0,fontsize:void 0,fontname:""},this.template=['<div class="box" style="height: 400px;">','<table cols="2" style="width: 450px;margin-bottom: 30px;">',"<tr>",'<td style="padding-bottom: 8px;">','<div id="id-dlg-hf-ch-first"></div>',"</td>",'<td style="padding-bottom: 8px;">','<div id="id-dlg-hf-ch-scale"></div>',"</td>","</tr>","<tr>","<td>",'<div id="id-dlg-hf-ch-odd"></div>',"</td>","<td>",'<div id="id-dlg-hf-ch-align"></div>',"</td>","</tr>","</table>",'<div class="input-row input-row-tabs" style="margin-bottom: 15px;">','<button type="button" class="btn btn-text-default auto" id="id-dlg-hf-btn-all" style="border-radius: 0;">',this.textAll,"</button>",'<button type="button" class="btn btn-text-default auto hidden" id="id-dlg-hf-btn-odd" style="border-radius: 0;">',this.textOdd,"</button>",'<button type="button" class="btn btn-text-default auto hidden" id="id-dlg-hf-btn-even" style="border-radius: 0;">',this.textEven,"</button>",'<button type="button" class="btn btn-text-default auto hidden" id="id-dlg-hf-btn-first" style="border-radius: 0;">',this.textFirst,"</button>","</div>",'<label style="display: block; margin-bottom: 3px;">'+this.textHeader+"</label>",'<div id="id-dlg-h-presets" class="input-row" style="display: inline-block; vertical-align: middle;"></div>','<div id="id-dlg-h-insert" class="input-row margin-left-2" style="display: inline-block; vertical-align: middle;"></div>','<div id="id-dlg-h-fonts" class="input-row margin-left-2" style="display: inline-block; vertical-align: middle;"></div>','<div id="id-dlg-h-font-size" class="input-row margin-left-2" style="display: inline-block; vertical-align: middle;"></div>','<div id="id-dlg-h-textcolor" class="margin-left-6" style="display: inline-block;"></div>','<div id="id-dlg-h-bold" class="margin-left-2" style="display: inline-block;"></div>','<div id="id-dlg-h-italic" class="margin-left-6" style="display: inline-block;"></div>','<div id="id-dlg-h-underline" class="margin-left-6" style="display: inline-block;"></div>','<div id="id-dlg-h-strikeout" class="margin-left-6" style="display: inline-block;"></div>','<div id="id-dlg-h-subscript" class="margin-left-6" style="display: inline-block;"></div>','<div id="id-dlg-h-superscript" class="margin-left-6" style="display: inline-block;"></div>','<div class="preview-container" style="display: inline-block;margin-top: 7px;vertical-align: middle;">','<div class="preview-canvas-container" style="width: 206px; height: 92px; position:relative; overflow:hidden;">','<div id="header-left-img" style="width: 190px; height: 100%;"></div>',"</div>","</div>",'<div class="preview-container" style="display: inline-block;margin-top: 7px;vertical-align: middle;">','<div class="preview-canvas-container" style="width: 206px; height: 92px; position:relative; overflow:hidden;">','<div id="header-center-img" style="width: 190px; height: 100%;"></div>',"</div>","</div>",'<div style="display: inline-block;margin-top: 7px;vertical-align: middle;">','<div class="preview-canvas-container" style="width: 206px; height: 92px; position:relative; overflow:hidden;">','<div id="header-right-img" style="width: 190px; height: 100%;"></div>',"</div>","</div>",'<label style="display: block; margin-top: 10px;margin-bottom: 3px;">'+this.textFooter+"</label>",'<div id="id-dlg-f-presets" class="input-row" style="display: inline-block; vertical-align: middle;"></div>','<div id="id-dlg-f-insert" class="input-row margin-left-2" style="display: inline-block; vertical-align: middle;"></div>','<div id="id-dlg-f-fonts" class="input-row margin-left-2" style="display: inline-block; vertical-align: middle;"></div>','<div id="id-dlg-f-font-size" class="input-row margin-left-2" style="display: inline-block; vertical-align: middle;"></div>','<div id="id-dlg-f-textcolor" class="margin-left-6" style="display: inline-block;"></div>','<div id="id-dlg-f-bold" class="margin-left-2" style="display: inline-block;"></div>','<div id="id-dlg-f-italic" class="margin-left-6" style="display: inline-block;"></div>','<div id="id-dlg-f-underline" class="margin-left-6" style="display: inline-block;"></div>','<div class="margin-left-6" id="id-dlg-f-strikeout" style="display: inline-block;"></div>','<div id="id-dlg-f-subscript" class="margin-left-6" style="display: inline-block;"></div>','<div id="id-dlg-f-superscript" class="margin-left-6" style="display: inline-block;"></div>','<div class="preview-container" style="display: inline-block;margin-top: 7px;vertical-align: middle;">','<div class="preview-canvas-container" style="width: 206px; height: 92px; position:relative; overflow:hidden;">','<div id="footer-left-img" style="width: 190px; height: 100%;"></div>',"</div>","</div>",'<div class="preview-container" style="display: inline-block;margin-top: 7px;vertical-align: middle;">','<div class="preview-canvas-container" style="width: 206px; height: 92px; position:relative; overflow:hidden;">','<div id="footer-center-img" style="width: 190px; height: 100%;"></div>',"</div>","</div>",'<div style="display: inline-block;margin-top: 7px;vertical-align: middle;">','<div class="preview-canvas-container" style="width: 206px; height: 92px; position:relative; overflow:hidden;">','<div id="footer-right-img" style="width: 190px; height: 100%;"></div>',"</div>","</div>","</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);function t(t){t.setMenu(),t.currentColor="000000",t.setColor(t.currentColor);var e=t.getPicker();return e.currentColor=t.currentColor,t.on("color:select",_.bind(i.onColorSelect,i)),e}var i=this,e=this.getChild(),s=(this.chFirstPage=new Common.UI.CheckBox({el:$("#id-dlg-hf-ch-first"),labelText:this.textDiffFirst}),this.chFirstPage.on("change",_.bind(function(t,e,i,s){var o,n="checked"==t.getValue(),a=this.HFObject?this.HFObject.setDifferentFirst(n):null;a?(o=this).showError(function(){t.setValue(!n,!0),_.delay(function(){o.onCanvasClick(a)},50)}):(this.btnFirst.setVisible(n),!n&&this.btnFirst.isActive()&&(this.btnAll.isVisible()?this.btnAll:this.btnOdd).toggle(!0))},this)),this.chOddPage=new Common.UI.CheckBox({el:$("#id-dlg-hf-ch-odd"),labelText:this.textDiffOdd}),this.chOddPage.on("change",_.bind(function(t,e,i,s){var o,n="checked"==t.getValue(),a=this.HFObject?this.HFObject.setDifferentOddEven(n):null;a?(o=this).showError(function(){t.setValue(!n,!0),_.delay(function(){o.onCanvasClick(a)},50)}):(this.btnOdd.setVisible(n),this.btnEven.setVisible(n),this.btnAll.setVisible(!n),n||!this.btnOdd.isActive()&&!this.btnEven.isActive()||this.btnAll.toggle(!0),n&&this.btnAll.isActive()&&this.btnOdd.toggle(!0))},this)),this.chScale=new Common.UI.CheckBox({el:$("#id-dlg-hf-ch-scale"),labelText:this.textScale}),this.chScale.on("change",_.bind(function(t,e,i,s){t="checked"==t.getValue();this.HFObject&&this.HFObject.setScaleWithDoc(t)},this)),this.chAlign=new Common.UI.CheckBox({el:$("#id-dlg-hf-ch-align"),labelText:this.textAlign}),this.chAlign.on("change",_.bind(function(t,e,i,s){t="checked"==t.getValue();this.HFObject&&this.HFObject.setAlignWithMargins(t)},this)),this.btnAll=new Common.UI.Button({el:$("#id-dlg-hf-btn-all"),enableToggle:!0,toggleGroup:"hf-pages",allowDepress:!1,pressed:!0}),this.btnAll.on("toggle",_.bind(this.onPageTypeToggle,this,Asc.c_oAscHeaderFooterType.odd)),this.btnOdd=new Common.UI.Button({el:$("#id-dlg-hf-btn-odd"),enableToggle:!0,toggleGroup:"hf-pages",allowDepress:!1}),this.btnOdd.on("toggle",_.bind(this.onPageTypeToggle,this,Asc.c_oAscHeaderFooterType.odd)),this.btnEven=new Common.UI.Button({el:$("#id-dlg-hf-btn-even"),enableToggle:!0,toggleGroup:"hf-pages",allowDepress:!1}),this.btnEven.on("toggle",_.bind(this.onPageTypeToggle,this,Asc.c_oAscHeaderFooterType.even)),this.btnFirst=new Common.UI.Button({el:$("#id-dlg-hf-btn-first"),enableToggle:!0,toggleGroup:"hf-pages",allowDepress:!1}),this.btnFirst.on("toggle",_.bind(this.onPageTypeToggle,this,Asc.c_oAscHeaderFooterType.first)),this.btnPresetsH=new Common.UI.Button({parentEl:$("#id-dlg-h-presets"),cls:"btn-text-menu-default",caption:this.textPresets,style:"width: 115px;",menu:!0}),this.btnPresetsF=new Common.UI.Button({parentEl:$("#id-dlg-f-presets"),cls:"btn-text-menu-default",caption:this.textPresets,style:"width: 115px;",menu:!0}),[{caption:this.textPageNum,value:Asc.c_oAscHeaderFooterField.pageNumber},{caption:this.textPageCount,value:Asc.c_oAscHeaderFooterField.pageCount},{caption:this.textDate,value:Asc.c_oAscHeaderFooterField.date},{caption:this.textTime,value:Asc.c_oAscHeaderFooterField.time},{caption:this.textFileName,value:Asc.c_oAscHeaderFooterField.fileName},{caption:this.textSheet,value:Asc.c_oAscHeaderFooterField.sheetName},{caption:this.textImage,value:Asc.c_oAscHeaderFooterField.picture}]);this.btnInsertH=new Common.UI.Button({parentEl:$("#id-dlg-h-insert"),cls:"btn-text-menu-default",caption:this.textInsert,style:"width: 115px;",menu:new Common.UI.Menu({style:"min-width: 115px;",maxHeight:200,additionalAlign:this.menuAddAlign,items:s})}),this.btnInsertH.menu.on("item:click",_.bind(this.onObjectSelect,this)),this.headerControls.push(this.btnInsertH),this.btnInsertF=new Common.UI.Button({parentEl:$("#id-dlg-f-insert"),cls:"btn-text-menu-default",caption:this.textInsert,style:"width: 115px;",menu:new Common.UI.Menu({style:"min-width: 115px;",maxHeight:200,additionalAlign:this.menuAddAlign,items:s})}),this.btnInsertF.menu.on("item:click",_.bind(this.onObjectSelect,this)),this.footerControls.push(this.btnInsertF),this.cmbFonts=[],this.cmbFonts.push(new Common.UI.ComboBoxFonts({el:$("#id-dlg-h-fonts"),cls:"input-group-nr",style:"width: 142px;",menuCls:"scrollable-menu",menuStyle:"min-width: 100%;max-height: 270px;",store:new Common.Collections.Fonts,recent:0,hint:this.tipFontName})),this.cmbFonts[0].on("selected",_.bind(this.onFontSelect,this)),this.cmbFonts[0].setValue(this._state.fontname),this.headerControls.push(this.cmbFonts[0]),this.cmbFonts.push(new Common.UI.ComboBoxFonts({el:$("#id-dlg-f-fonts"),cls:"input-group-nr",style:"width: 142px;",menuCls:"scrollable-menu",menuStyle:"min-width: 100%;max-height: 270px;",store:new Common.Collections.Fonts,recent:0,hint:this.tipFontName})),this.cmbFonts[1].on("selected",_.bind(this.onFontSelect,this)),this.cmbFonts[1].setValue(this._state.fontname),this.footerControls.push(this.cmbFonts[1]),Common.NotificationCenter.on("fonts:change",_.bind(this.onApiChangeFont,this)),s=[{value:8,displayValue:"8"},{value:9,displayValue:"9"},{value:10,displayValue:"10"},{value:11,displayValue:"11"},{value:12,displayValue:"12"},{value:14,displayValue:"14"},{value:16,displayValue:"16"},{value:18,displayValue:"18"},{value:20,displayValue:"20"},{value:22,displayValue:"22"},{value:24,displayValue:"24"},{value:26,displayValue:"26"},{value:28,displayValue:"28"},{value:36,displayValue:"36"},{value:48,displayValue:"48"},{value:72,displayValue:"72"}],this.cmbFontSize=[],this.cmbFontSize.push(new Common.UI.ComboBox({el:$("#id-dlg-h-font-size"),cls:"input-group-nr",style:"width: 45px;",menuCls:"scrollable-menu",menuStyle:"min-width: 45px;max-height: 270px;",hint:this.tipFontSize,data:s})),this.cmbFontSize[0].on("selected",_.bind(this.onFontSizeSelect,this)),this.cmbFontSize[0].on("changed:before",_.bind(this.onFontSizeChanged,this,!0)),this.cmbFontSize[0].on("changed:after",_.bind(this.onFontSizeChanged,this,!1)),this.cmbFontSize[0].setValue(this._state.fontsize),this.headerControls.push(this.cmbFontSize[0]),this.cmbFontSize.push(new Common.UI.ComboBox({el:$("#id-dlg-f-font-size"),cls:"input-group-nr",style:"width: 45px;",menuCls:"scrollable-menu",menuStyle:"min-width: 45px;max-height: 270px;",hint:this.tipFontSize,data:s})),this.cmbFontSize[1].on("selected",_.bind(this.onFontSizeSelect,this)),this.cmbFontSize[1].on("changed:before",_.bind(this.onFontSizeChanged,this,!0)),this.cmbFontSize[1].on("changed:after",_.bind(this.onFontSizeChanged,this,!1)),this.cmbFontSize[1].setValue(this._state.fontsize),this.footerControls.push(this.cmbFontSize[1]),this.btnBold=[],this.btnBold.push(new Common.UI.Button({parentEl:$("#id-dlg-h-bold"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-bold",enableToggle:!0,hint:this.textBold})),this.btnBold[0].on("click",_.bind(this.onBoldClick,this)),this.headerControls.push(this.btnBold[0]),this.btnBold.push(new Common.UI.Button({parentEl:$("#id-dlg-f-bold"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-bold",enableToggle:!0,hint:this.textBold})),this.btnBold[1].on("click",_.bind(this.onBoldClick,this)),this.footerControls.push(this.btnBold[1]),this.btnItalic=[],this.btnItalic.push(new Common.UI.Button({parentEl:$("#id-dlg-h-italic"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-italic",enableToggle:!0,hint:this.textItalic})),this.btnItalic[0].on("click",_.bind(this.onItalicClick,this)),this.headerControls.push(this.btnItalic[0]),this.btnItalic.push(new Common.UI.Button({parentEl:$("#id-dlg-f-italic"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-italic",enableToggle:!0,hint:this.textItalic})),this.btnItalic[1].on("click",_.bind(this.onItalicClick,this)),this.footerControls.push(this.btnItalic[1]),this.btnUnderline=[],this.btnUnderline.push(new Common.UI.Button({parentEl:$("#id-dlg-h-underline"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-underline",enableToggle:!0,hint:this.textUnderline})),this.btnUnderline[0].on("click",_.bind(this.onUnderlineClick,this)),this.headerControls.push(this.btnUnderline[0]),this.btnUnderline.push(new Common.UI.Button({parentEl:$("#id-dlg-f-underline"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-underline",enableToggle:!0,hint:this.textUnderline})),this.btnUnderline[1].on("click",_.bind(this.onUnderlineClick,this)),this.footerControls.push(this.btnUnderline[1]),this.btnStrikeout=[],this.btnStrikeout.push(new Common.UI.Button({parentEl:$("#id-dlg-h-strikeout"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-strikeout",enableToggle:!0,hint:this.textStrikeout})),this.btnStrikeout[0].on("click",_.bind(this.onStrikeoutClick,this)),this.headerControls.push(this.btnStrikeout[0]),this.btnStrikeout.push(new Common.UI.Button({parentEl:$("#id-dlg-f-strikeout"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-strikeout",enableToggle:!0,hint:this.textStrikeout})),this.btnStrikeout[1].on("click",_.bind(this.onStrikeoutClick,this)),this.footerControls.push(this.btnStrikeout[1]),this.btnSuperscript=[],this.btnSuperscript.push(new Common.UI.Button({parentEl:$("#id-dlg-h-superscript"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-superscript",enableToggle:!0,toggleGroup:"superscriptHFGroup",hint:this.textSuperscript})),this.btnSuperscript[0].on("click",_.bind(this.onSuperscriptClick,this)),this.headerControls.push(this.btnSuperscript[0]),this.btnSuperscript.push(new Common.UI.Button({parentEl:$("#id-dlg-f-superscript"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-superscript",enableToggle:!0,toggleGroup:"superscriptHFGroup",hint:this.textSuperscript})),this.btnSuperscript[1].on("click",_.bind(this.onSuperscriptClick,this)),this.footerControls.push(this.btnSuperscript[1]),this.btnSubscript=[],this.btnSubscript.push(new Common.UI.Button({parentEl:$("#id-dlg-h-subscript"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-subscript",enableToggle:!0,toggleGroup:"superscriptHFGroup",hint:this.textSubscript})),this.btnSubscript[0].on("click",_.bind(this.onSubscriptClick,this)),this.headerControls.push(this.btnSubscript[0]),this.btnSubscript.push(new Common.UI.Button({parentEl:$("#id-dlg-f-subscript"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-subscript",enableToggle:!0,toggleGroup:"superscriptHFGroup",hint:this.textSubscript})),this.btnSubscript[1].on("click",_.bind(this.onSubscriptClick,this)),this.footerControls.push(this.btnSubscript[1]);this.btnTextColor=[],this.btnTextColor.push(new Common.UI.ButtonColored({parentEl:$("#id-dlg-h-textcolor"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-fontcolor",hint:this.textColor,split:!0,additionalAlign:this.menuAddAlign,menu:!0})),this.btnTextColor[0].on("click",_.bind(this.onTextColor,this)),this.mnuTextColorPicker=[],this.mnuTextColorPicker.push(t(this.btnTextColor[0])),this.headerControls.push(this.btnTextColor[0]),this.btnTextColor.push(new Common.UI.ButtonColored({parentEl:$("#id-dlg-f-textcolor"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-fontcolor",hint:this.textColor,split:!0,additionalAlign:this.menuAddAlign,menu:!0})),this.btnTextColor[1].on("click",_.bind(this.onTextColor,this)),this.mnuTextColorPicker.push(t(this.btnTextColor[1])),this.footerControls.push(this.btnTextColor[1]),this.btnOk=new Common.UI.Button({el:e.find(".primary")}),e.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.scrollers=[],this.initCanvas("#header-left-img"),this.initCanvas("#header-center-img"),this.initCanvas("#header-right-img"),this.initCanvas("#footer-left-img"),this.initCanvas("#footer-center-img"),this.initCanvas("#footer-right-img"),this.wrapEvents={onApiEditorSelectionChanged:_.bind(this.onApiEditorSelectionChanged,this),onApiResizeEditorHeight:_.bind(this.onApiResizeEditorHeight,this),onUpdateEditorCursorPosition:_.bind(this.onUpdateEditorCursorPosition,this)},this.afterRender()},initCanvas:function(t){var e=this.$window.find(t);e.on("click",_.bind(this.onCanvasClick,this,t)),this.canvasBoxHeight=e.height(),this.scrollers[t]=new Common.UI.Scroller({el:e.parent(),minScrollbarLength:20}),this.scrollers[t].update(),this.scrollers[t].scrollTop(0)},show:function(){Common.UI.Window.prototype.show.apply(this,arguments)},close:function(){this.api.asc_unregisterCallback("asc_onEditorSelectionChanged",this.wrapEvents.onApiEditorSelectionChanged),this.api.asc_unregisterCallback("asc_resizeEditorHeight",this.wrapEvents.onApiResizeEditorHeight),this.api.asc_unregisterCallback("asc_updateEditorCursorPosition",this.wrapEvents.onUpdateEditorCursorPosition),Common.UI.Window.prototype.close.apply(this,arguments),this.HFObject&&this.HFObject.destroy(!1,this.pageSetup)},afterRender:function(){this.api.asc_registerCallback("asc_onEditorSelectionChanged",this.wrapEvents.onApiEditorSelectionChanged),this.api.asc_registerCallback("asc_resizeEditorHeight",this.wrapEvents.onApiResizeEditorHeight),this.api.asc_registerCallback("asc_updateEditorCursorPosition",this.wrapEvents.onUpdateEditorCursorPosition),this.cmbFonts[0].fillFonts(this.fontStore),this.cmbFonts[1].fillFonts(this.fontStore),this.updateThemeColors(),this.HFObject=new Asc.asc_CHeaderFooterEditor(["header-left-img","header-center-img","header-right-img","footer-left-img","footer-center-img","footer-right-img"],205,void 0,this.pageSetup),this._setDefaults(this.props),this.editorCanvas=this.$window.find("#ce-canvas-menu");var t=this;_.delay(function(){t.onCanvasClick("#header-left-img")},500)},_setDefaults:function(t){var i=[],e=(this.HFObject.getTextPresetsArr().forEach(function(t,e){i.push({caption:t,value:e})}),this.btnPresetsH.setMenu(new Common.UI.Menu({style:"min-width: 115px;",maxHeight:200,additionalAlign:this.menuAddAlign,items:i})),this.btnPresetsH.menu.on("item:click",_.bind(this.onPresetSelect,this,!1)),this.btnPresetsF.setMenu(new Common.UI.Menu({style:"min-width: 115px;",maxHeight:200,additionalAlign:this.menuAddAlign,items:i})),this.btnPresetsF.menu.on("item:click",_.bind(this.onPresetSelect,this,!0)),this.chOddPage.setValue(this.HFObject.getDifferentOddEven()),this.chFirstPage.setValue(this.HFObject.getDifferentFirst()),this.chAlign.setValue(this.HFObject.getAlignWithMargins()),this.chScale.setValue(this.HFObject.getScaleWithDoc()),"checked"==this.chOddPage.getValue());this.btnOdd.setVisible(e),this.btnEven.setVisible(e),this.btnAll.setVisible(!e),(e?this.btnOdd:this.btnAll).toggle(!0),e="checked"==this.chFirstPage.getValue(),this.btnFirst.setVisible(e)},updateThemeColors:function(){this.mnuTextColorPicker[0].updateColors(Common.Utils.ThemeColor.getEffectColors(),Common.Utils.ThemeColor.getStandartColors()),this.mnuTextColorPicker[1].updateColors(Common.Utils.ThemeColor.getEffectColors(),Common.Utils.ThemeColor.getStandartColors())},getSettings:function(){return{}},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onPrimary:function(t){return this._handleInput("ok"),!1},_handleInput:function(t){if(this.HFObject){var e,i=this.HFObject.destroy("ok"==t,this.pageSetup);if(i)return void(e=this).showError(function(){_.delay(function(){e.onCanvasClick(i)},50)});this.HFObject=null}this.options.handler&&this.options.handler.call(this,this,t),this.close()},showError:function(t){Common.UI.warning({title:this.notcriticalErrorTitle,msg:this.textMaxError,callback:t})},scrollerUpdate:function(){for(var t in this.scrollers)this.scrollers[t]&&this.scrollers[t].update()},scrollerScrollTop:function(){for(var t in this.scrollers)this.scrollers[t]&&this.scrollers[t].scrollTop(0)},onCanvasClick:function(t,e){var i,s;this.HFObject&&((i=this.currentCanvas!==(t=t||"#header-left-img"))&&(this.currentCanvas=t,this.isFooter="#footer-left-img"==t||"#footer-center-img"==t||"#footer-right-img"==t,(s=this).headerControls.forEach(function(t){t.setDisabled(s.isFooter)}),this.footerControls.forEach(function(t){t.setDisabled(!s.isFooter)})),e?this.HFObject.click(t,e.pageX,e.pageY):this.HFObject.click(t),i&&this.scrollerUpdate())},onApiResizeEditorHeight:function(t){var e;!this.editorCanvas||(e=this.editorCanvas.height())!=this.editorCanvasHeight&&(this.editorCanvasHeight=e,this.scrollers[this.currentCanvas]&&this.scrollers[this.currentCanvas].update())},onUpdateEditorCursorPosition:function(t,e){var i,s;this.editorCanvas&&(i=this.currentCanvas,this.scrollers[i]&&(t+e>(s=this.scrollers[i].getScrollTop())+this.canvasBoxHeight?this.scrollers[i].scrollTop(t+e-this.canvasBoxHeight):t<s&&this.scrollers[i].scrollTop(t)))},onPresetSelect:function(t,e,i){this.HFObject&&this.HFObject.applyPreset(i.value,!!t),this.onCanvasClick(t?"#footer-left-img":"#header-left-img")},onObjectSelect:function(t,e){this.HFObject&&this.HFObject.addField(e.value),this.onCanvasClick(this.currentCanvas)},onFontSelect:function(t,e){this.HFObject&&this.HFObject.setFontName(e.name),this.onCanvasClick(this.currentCanvas)},onFontSizeSelect:function(t,e){this.HFObject&&this.HFObject.setFontSize(e.value),this.onCanvasClick(this.currentCanvas)},onFontSizeChanged:function(t,e,i,s){var o;if(t){t=e.store.findWhere({displayValue:i.value});if(!t&&!(o=/^\+?(\d*(\.|,)?\d+)$|^\+?(\d+(\.|,)?\d*)$/.exec(i.value)))return o=e.getValue(),e.setRawValue(o),s.preventDefault(),!1}else o=409<(o=Common.Utils.String.parseFloat(i.value))?409:o<1?1:Math.floor(2*(o+.4))/2,e.setRawValue(o),this.HFObject&&this.HFObject.setFontSize(o)},onBoldClick:function(t,e){this.HFObject&&(this.HFObject.setBold(t.pressed),this.scrollerUpdate())},onItalicClick:function(t,e){this.HFObject&&(this.HFObject.setItalic(t.pressed),this.scrollerUpdate())},onUnderlineClick:function(t,e){this.HFObject&&(this.HFObject.setUnderline(t.pressed),this.scrollerUpdate())},onStrikeoutClick:function(t,e){this.HFObject&&(this.HFObject.setStrikeout(t.pressed),this.scrollerUpdate())},onSuperscriptClick:function(t,e){this.HFObject&&(this.HFObject.setSuperscript(t.pressed),this.scrollerUpdate())},onSubscriptClick:function(t,e){this.HFObject&&(this.HFObject.setSubscript(t.pressed),this.scrollerUpdate())},onTextColor:function(){var t=this.mnuTextColorPicker[this.isFooter?1:0];t.trigger("select",t,t.currentColor,!0)},onColorSelect:function(t,e){t.currentColor=e,t.colorPicker.currentColor=e,this.HFObject&&this.HFObject.setTextColor(Common.Utils.ThemeColor.getRgbColor(e)),this.onCanvasClick(this.currentCanvas)},onPageTypeToggle:function(t,e,i){var s,o,n;this._pagetype||i&&this.HFObject&&(s=this.HFObject.getPageType(),(o=this.HFObject.switchHeaderFooterType(t))?(this._pagetype=!0,(n=this).showError(function(){switch(s){case Asc.c_oAscHeaderFooterType.odd:(n.btnOdd.isVisible()?n.btnOdd:n.btnAll).toggle(!0);break;case Asc.c_oAscHeaderFooterType.even:n.btnEven.toggle(!0);break;case Asc.c_oAscHeaderFooterType.first:n.btnFirst.toggle(!0)}_.delay(function(){n.onCanvasClick(o)},50),n._pagetype=!1})):(this.scrollerScrollTop(),this.onCanvasClick(this.currentCanvas,void 0,!0)))},onApiChangeFont:function(t){this.cmbFonts[this.isFooter?1:0].onApiChangeFont(t)},onApiEditorSelectionChanged:function(t){var e=this.isFooter?1:0,i=(t.asc_getFontName()!=this.cmbFonts[e].getValue()&&Common.NotificationCenter.trigger("fonts:change",t),i=t.asc_getFontBold(),this.btnBold[e].isActive()!==i&&this.btnBold[e].toggle(!0===i,!0),i=t.asc_getFontItalic(),this.btnItalic[e].isActive()!==i&&this.btnItalic[e].toggle(!0===i,!0),i=t.asc_getFontUnderline(),this.btnUnderline[e].isActive()!==i&&this.btnUnderline[e].toggle(!0===i,!0),i=t.asc_getFontStrikeout(),this.btnStrikeout[e].isActive()!==i&&this.btnStrikeout[e].toggle(!0===i,!0),i=t.asc_getFontSubscript(),this.btnSubscript[e].isActive()!==i&&this.btnSubscript[e].toggle(!0===i,!0),i=t.asc_getFontSuperscript(),this.btnSuperscript[e].isActive()!==i&&this.btnSuperscript[e].toggle(!0===i,!0),t.asc_getFontSize());this.cmbFontSize[e].getValue()!==i&&this.cmbFontSize[e].setValue(void 0!==i?i:"");var s,o=this.mnuTextColorPicker[e],i=t.asc_getFontColor();if(i&&(s=i.get_type()==Asc.c_oAscColor.COLOR_TYPE_SCHEME?{color:Common.Utils.ThemeColor.getHexColor(i.get_r(),i.get_g(),i.get_b()),effectValue:i.get_value()}:Common.Utils.ThemeColor.getHexColor(i.get_r(),i.get_g(),i.get_b())),_.isObject(s)){for(var n=!1,a=0;a<10;a++)if(Common.Utils.ThemeColor.ThemeValues[a]==s.effectValue){o.select(s,!0),n=!0;break}n||o.clearSelection()}else o.select(s,!0)}},SSE.Views.HeaderFooterDialog||{}))}),define("spreadsheeteditor/main/app/view/PrintTitlesDialog",["common/main/lib/component/Window","common/main/lib/component/MetricSpinner"],function(){"use strict";SSE.Views.PrintTitlesDialog=Common.UI.Window.extend(_.extend({options:{width:300,header:!0,style:"min-width: 216px;",cls:"modal-dlg",id:"window-page-margins",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:this.textTitle},t||{}),this.template=['<div class="box" style="height: 100px;">','<table cols="2" style="width: 100%;margin-bottom: 10px;">',"<tr>",'<td colspan="2" class="padding-right-10">','<label class="input-label">'+this.textTop+"</label>","</td>","</tr>","<tr>",'<td class="padding-right-10" style="padding-bottom: 16px;">','<div id="print-titles-txt-top"></div>',"</td>",'<td style="padding-bottom: 16px;">','<div id="print-titles-presets-top"></div>',"</td>","</tr>","<tr>",'<td colspan="2" class="padding-right-10">','<label class="input-label">'+this.textLeft+"</label>","</td>","</tr>","<tr>",'<td class="padding-right-10">','<div id="print-titles-txt-left"></div>',"</td>","<td>",'<div id="print-titles-presets-left"></div>',"</td>","</tr>","</table>","</div>",'<div class="separator horizontal"></div>'].join(""),this.options.tpl=_.template(this.template)(this.options),this.api=this.options.api,this.sheet=this.options.sheet,Common.UI.Window.prototype.initialize.call(this,this.options),this.dataRangeTop="",this.dataRangeLeft=""},render:function(){Common.UI.Window.prototype.render.call(this);var e=this,t=(this.txtRangeTop=new Common.UI.InputFieldBtn({el:$("#print-titles-txt-top"),style:"width: 100%;",btnHint:this.textSelectRange,allowBlank:!0,validateOnChange:!0,validation:function(t){return!!_.isEmpty(t)||(e.api.asc_checkDataRange(Asc.c_oAscSelectionDialogType.PrintTitles,t,!1)!=Asc.c_oAscError.ID.DataRangeError||e.textInvalidRange)}}),this.api.asc_getPrintTitlesRange(Asc.c_oAscPrintTitlesRangeType.frozen,!1,this.sheet)),t=(this.btnPresetsTop=new Common.UI.Button({parentEl:$("#print-titles-presets-top"),cls:"btn-text-menu-default",caption:this.textRepeat,style:"width: 95px;",menu:new Common.UI.Menu({style:"min-width: 100px;",maxHeight:200,additionalAlign:this.menuAddAlign,items:[{caption:this.textSelectRange+"...",value:"select"},{caption:this.textFrozenRows,value:"frozen",range:t,disabled:!t},{caption:this.textFirstRow,value:"first",range:this.api.asc_getPrintTitlesRange(Asc.c_oAscPrintTitlesRangeType.first,!1,this.sheet)},{caption:"--"},{caption:this.textNoRepeat,value:"empty",range:""}]})}),this.btnPresetsTop.menu.on("item:click",_.bind(this.onPresetSelect,this,"top")),this.txtRangeTop.on("button:click",_.bind(this.onPresetSelect,this,"top",this.btnPresetsTop.menu,{value:"select"})),this.txtRangeLeft=new Common.UI.InputFieldBtn({el:$("#print-titles-txt-left"),style:"width: 100%;",btnHint:this.textSelectRange,allowBlank:!0,validateOnChange:!0,validation:function(t){return!!_.isEmpty(t)||(e.api.asc_checkDataRange(Asc.c_oAscSelectionDialogType.PrintTitles,t,!1)!=Asc.c_oAscError.ID.DataRangeError||e.textInvalidRange)}}),t=this.api.asc_getPrintTitlesRange(Asc.c_oAscPrintTitlesRangeType.frozen,!0,this.sheet),this.btnPresetsLeft=new Common.UI.Button({parentEl:$("#print-titles-presets-left"),cls:"btn-text-menu-default",caption:this.textRepeat,style:"width: 95px;",menu:new Common.UI.Menu({style:"min-width: 100px;",maxHeight:200,additionalAlign:this.menuAddAlign,items:[{caption:this.textSelectRange+"...",value:"select"},{caption:this.textFrozenCols,value:"frozen",range:t,disabled:!t},{caption:this.textFirstCol,value:"first",range:this.api.asc_getPrintTitlesRange(Asc.c_oAscPrintTitlesRangeType.first,!0,this.sheet)},{caption:"--"},{caption:this.textNoRepeat,value:"empty",range:""}]})}),this.btnPresetsLeft.menu.on("item:click",_.bind(this.onPresetSelect,this,"left")),this.txtRangeLeft.on("button:click",_.bind(this.onPresetSelect,this,"left",this.btnPresetsLeft.menu,{value:"select"})),this.getChild());t.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),t.find("input").on("keypress",_.bind(this.onKeyPress,this)),this.setSettings()},getFocusedComponents:function(){return[this.txtRangeTop,this.txtRangeLeft]},getDefaultFocusableComponent:function(){if(!this._alreadyRendered)return this._alreadyRendered=!0,this.txtRangeTop},isRangeValid:function(){return this.api.asc_checkDataRange(Asc.c_oAscSelectionDialogType.PrintTitles,this.txtRangeTop.getValue(),!1)==Asc.c_oAscError.ID.DataRangeError?(this.txtRangeTop.focus(),!1):this.api.asc_checkDataRange(Asc.c_oAscSelectionDialogType.PrintTitles,this.txtRangeLeft.getValue(),!1)!=Asc.c_oAscError.ID.DataRangeError||(this.txtRangeLeft.focus(),!1)},_handleInput:function(t){if(this.options.handler){if("ok"==t&&!this.isRangeValid())return;this.options.handler.call(this,this,t)}this.close()},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onKeyPress:function(t){t.keyCode==Common.UI.Keys.RETURN&&this._handleInput("ok")},setSettings:function(t){var e;this.api&&(e=this.api.asc_getPrintTitlesRange(Asc.c_oAscPrintTitlesRangeType.current,!1,this.sheet),this.txtRangeTop.setValue(e||""),this.dataRangeTop=e,e=this.api.asc_getPrintTitlesRange(Asc.c_oAscPrintTitlesRangeType.current,!0,this.sheet),this.txtRangeLeft.setValue(e||""),this.dataRangeLeft=e)},getSettings:function(){return{width:this.txtRangeLeft.getValue(),height:this.txtRangeTop.getValue()}},onPresetSelect:function(i,t,e){var s,o,n,a="top"==i?this.txtRangeTop:this.txtRangeLeft;"select"==e.value?(s=this).api&&(s.btnPresetsTop.menu.options.additionalAlign=s.menuAddAlign,s.btnPresetsLeft.menu.options.additionalAlign=s.menuAddAlign,o=new SSE.Views.CellRangeDialog({handler:function(t,e){"ok"==e&&(e=t.getSettings(),"top"==i?s.dataRangeTop=e:s.dataRangeLeft=e,a.setValue(e),a.checkValidate())}}).on("close",function(){s.show(),_.delay(function(){a.focus()},1)}),n=s.$window.offset(),s.hide(),o.show(n.left+160,n.top+125),o.setSettings({api:s.api,range:_.isEmpty(a.getValue())||1!=a.checkValidate()?"top"==i?s.dataRangeTop:s.dataRangeLeft:a.getValue(),type:Asc.c_oAscSelectionDialogType.PrintTitles})):(n=e.options.range||"",a.setValue(n),a.checkValidate(),"top"==i?this.dataRangeTop=n:this.dataRangeLeft=n,_.delay(function(){a.focus()},1))}},SSE.Views.PrintTitlesDialog||{}))}),define("spreadsheeteditor/main/app/view/ScaleDialog",["common/main/lib/component/Window","common/main/lib/component/MetricSpinner"],function(){"use strict";SSE.Views.ScaleDialog=Common.UI.Window.extend(_.extend({options:{width:215,height:235,header:!0,style:"min-width: 215px;",cls:"modal-dlg",id:"window-scale",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:this.textTitle},t||{}),this._state={width:null,height:null},this.template=['<div class="box">','<div id="radio-fit-to" style="margin-bottom: 4px;"></div>','<div class="padding-left-22">',"<div>",'<label style="height: 22px;width: 55px;padding-top: 4px;display: inline-block;margin-bottom: 4px;">'+this.textWidth+"</label>",'<div id="scale-width" style="display: inline-block;margin-bottom: 4px;"></div>',"</div>","<div>",'<label style="height: 22px;width: 55px;padding-top: 4px;display: inline-block;margin-bottom: 16px;">'+this.textHeight+"</label>",'<div id="scale-height" style="display: inline-block;margin-bottom: 16px;"></div>',"</div>","</div>",'<div id="radio-scale-to" style="margin-bottom: 6px;"></div>','<div id="scale" class="padding-left-22" style="margin-bottom: 6px;"></div>',"</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),this.api=this.options.api,this._originalProps=this.options.props,this.arrDataScale=[{displayValue:this.textAuto,value:0},{displayValue:"1 "+this.textOnePage,value:1},{displayValue:"2 "+this.textFewPages,value:2},{displayValue:"3 "+this.textFewPages,value:3},{displayValue:"4 "+this.textFewPages,value:4},{displayValue:"5 "+this.textManyPages,value:5},{displayValue:"6 "+this.textManyPages,value:6},{displayValue:"7 "+this.textManyPages,value:7},{displayValue:"8 "+this.textManyPages,value:8},{displayValue:"9 "+this.textManyPages,value:9}],Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this),this.radioFitTo=new Common.UI.RadioBox({el:$("#radio-fit-to"),labelText:this.textFitTo,name:"asc-radio-scale"}),this.radioFitTo.on("change",_.bind(this.onRadioScale,this,"fitto")),this.radioScaleTo=new Common.UI.RadioBox({el:$("#radio-scale-to"),labelText:this.textScaleTo,name:"asc-radio-scale"}),this.radioScaleTo.on("change",_.bind(this.onRadioScale,this,"scaleto")),this.cmbScaleWidth=new Common.UI.ComboBox({el:$("#scale-width"),cls:"input-group-nr",style:"width: 90px;",menuStyle:"min-width: 90px;",editable:!0,data:this.arrDataScale,scrollAlwaysVisible:!0,takeFocusOnClose:!0}).on("selected",_.bind(this.changeWidthHeight,this,"width")).on("changed:after",_.bind(this.changeWidthHeight,this,"width")).on("changed:before",_.bind(this.onChangeComboScale,this,"width")),this.cmbScaleHeight=new Common.UI.ComboBox({el:$("#scale-height"),cls:"input-group-nr",style:"width: 90px;",menuStyle:"min-width: 90px;",editable:!0,data:this.arrDataScale,scrollAlwaysVisible:!0,takeFocusOnClose:!0}).on("selected",_.bind(this.changeWidthHeight,this,"height")).on("changed:after",_.bind(this.changeWidthHeight,this,"height")).on("changed:before",_.bind(this.onChangeComboScale,this,"height")),this.spnScale=new Common.UI.MetricSpinner({el:$("#scale"),step:1,width:75,defaultUnit:"%",maxValue:400,minValue:10,defaultValue:"100 %"}).on("change",_.bind(function(t){this.radioScaleTo.setValue(!0,!0),this.cmbScaleHeight.setValue(0,!0),this.cmbScaleWidth.setValue(0,!0),this._state.width=0,this._state.height=0},this)),this.getChild().find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.afterRender()},getFocusedComponents:function(){return[this.radioFitTo,this.cmbScaleWidth,this.cmbScaleHeight,this.radioScaleTo,this.spnScale]},getDefaultFocusableComponent:function(){return this.radioScaleTo.getValue()?this.spnScale:this.cmbScaleWidth},afterRender:function(){this._setDefaults(this._originalProps)},_handleInput:function(t){this.options.handler&&"ok"===t&&this.options.handler.call(this,"ok",this.getSettings()),this.close(t)},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onPrimary:function(){return this._handleInput("ok"),!1},changeWidthHeight:function(t,e){e=e.getValue();"string"==typeof e&&(e=parseInt(e),isNaN(e)&&(e=0)),"width"===t?this._state.width=e:this._state.height=e,(0!==this._state.width&&null!==this._state.width||0!==this._state.height&&null!==this._state.height?this.radioFitTo:this.radioScaleTo).setValue(!0,!0)},onRadioScale:function(t,e,i){"scaleto"===t?(this.cmbScaleHeight.setValue(0,!0),this._state.height=0,this.cmbScaleWidth.setValue(0,!0),this._state.width=0):(this.cmbScaleHeight.setValue(0,!0),this._state.height=0,this.cmbScaleWidth.setValue(1,!0),this._state.width=1)},_setDefaults:function(t){var e,i;this.api&&(e=(t=(t||this.api.asc_getPageOptions()).asc_getPageSetup()).asc_getFitToWidth(),i=t.asc_getFitToHeight(),t=t.asc_getScale(),this._state.width=null!==e&&0!==e?e:null,this._state.height=null!==i&&0!==i?i:null,i=null!=i?i:0,(0===(e=null!=e?e:0)&&0===i?this.radioScaleTo:this.radioFitTo).setValue(!0,!0),_.findWhere(this.arrDataScale,{value:e})?this.cmbScaleWidth.setValue(e):this.cmbScaleWidth.setRawValue(e.toString()+" "+this.getTextPages(e)),_.findWhere(this.arrDataScale,{value:i})?this.cmbScaleHeight.setValue(i):this.cmbScaleHeight.setRawValue(i.toString()+" "+this.getTextPages(i)),this.spnScale.setValue(null!=t?t:"",!0))},getSettings:function(){var t={};return t.width=null===this._state.width?null:this._state.width,t.height=null===this._state.height?null:this._state.height,t.scale=this.spnScale.getNumberValue(),t},getTextPages:function(t){t%=10,t=0<t&&t<1.001?this.textOnePage:0<t&&t<4.001?this.textFewPages:this.textManyPages;return t},onChangeComboScale:function(t,e,i,s){var o,n=this,i=i.value.toLowerCase();new RegExp("^\\s*("+n.textAuto.toLowerCase()+")\\s*$").exec(i)?i=0:(i=parseInt(i),isNaN(i)||(o=n.getTextPages(i))),(isNaN(i)||i<0||32767<i)&&(Common.UI.error({msg:n.textError,callback:function(){_.defer(function(t){Common.NotificationCenter.trigger("edit:complete",n)})}}),i="width"===t?n._state.width:n._state.height,o=n.getTextPages(i)),null===i&&(i=0),"width"===t?(_.findWhere(n.arrDataScale,{value:i})?n.cmbScaleWidth.setValue(i):(n.cmbScaleWidth.setValue(""),n.cmbScaleWidth.setRawValue(i.toString()+" "+o)),n._state.width=i):"height"===t&&(_.findWhere(n.arrDataScale,{value:i})?n.cmbScaleHeight.setValue(i):(n.cmbScaleHeight.setValue(""),n.cmbScaleHeight.setRawValue(i.toString()+" "+o)),n._state.height=i)},close:function(t){this.options.handler&&"ok"!==t&&this.options.handler.call(this,"cancel",void 0),Common.UI.Window.prototype.close.call(this)}},SSE.Views.ScaleDialog||{}))}),define("text!spreadsheeteditor/main/app/template/FormatRulesManagerDlg.template",[],function(){return'<div class="settings-panel active">\n    <div class="inner-content">\n        <table cols="2" style="width: 100%;">\n            <tr>\n                <td colspan=2>\n                     <label><%= scope.textScope %></label>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="format-manager-combo-scope" class="input-group-nr" style="width:185px;"></div>\n                </td>\n                <td id="format-manager-btn-group" class="padding-small text-align-right">\n                    <button type="button" class="btn btn-text-default format-manager-btn-text margin-right-5" id="format-manager-btn-new"><%= scope.textNew %></button>\n                    <button type="button" class="btn btn-text-default format-manager-btn-text margin-right-5" id="format-manager-btn-edit"><%= scope.textEdit %></button>\n                    <div id="format-manager-btn-up" style="display: inline-block;"></div>\n                    <div id="format-manager-btn-down" class="margin-right-15" style="display: inline-block;"></div>\n                    <button type="button" class="btn btn-text-default format-manager-btn-text" id="format-manager-btn-delete"><%= scope.textDelete %></button>\n                </td>\n            </tr>\n            <tr>\n                <td colspan=2 class="padding-small">\n                    <div style="position: relative;">\n                    <div style="width: 100%;" id="format-manager-rules-list">\n                        <div id="id-preview">\n                            <div>\n                                <div style="position: absolute; top: 0;width:100%;"><div id="id-preview-data" class="range-tableview"></div></div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </td>\n            </tr>\n            <tr>\n\n            </tr>\n        </table>\n    </div>\n</div>'}),define("text!spreadsheeteditor/main/app/template/FormatRulesEditDlg.template",[],function(){return'<div class="settings-panel active">\n    <div class="inner-content">\n    <table cols="1">\n        <tr>\n            <td class="padding-small">\n                <div class="rule margin-right-10">\n                    <label class="header"><%= scope.textRule %></label>\n                    <div id="format-rules-edit-combo-category" class="input-group-nr"></div>\n                </div>\n            </td>\n        </tr>\n        <tr class="hasformat">\n            <td class="padding-large">\n                <div id="format-rules-edit-combo-rule" class="input-group-nr margin-right-10"></div>\x3c!--\n                --\x3e<div id="format-rules-edit-txt-r1" class="input-row margin-right-10"></div>\x3c!--\n                --\x3e<div id="format-rules-edit-txt-r2" class="input-row"></div>\x3c!--\n                --\x3e<div id="format-rules-edit-spin-rank" class="input-row margin-right-10"></div>\x3c!--\n                --\x3e<div id="format-rules-edit-combo-percent" class="input-row"></div>\n            </td>\n        </tr>\n        <tr class="hasformat">\n            <td class="padding-small">\n                <label class="header"><%= scope.textFormat %></label>\n                <div>\n                    <div id="format-rules-format-preset" class="input-group-nr"></div>\n                </div>\n            </td>\n        </tr>\n        <tr class="hasformat">\n            <td class="padding-large">\n                <div class="scaling-flex-row">\n                    <div id="format-rules-bold"></div>\n                    <div id="format-rules-italic" class="margin-left-3"></div>\n                    <div id="format-rules-underline" class="margin-left-3"></div>\n                    <div id="format-rules-strikeout" class="margin-left-3"></div>\n                    <div id="format-rules-fontcolor" class="margin-left-3"></div>\n                    <div id="format-rules-fillcolor" class="margin-left-3"></div>\n                    <div id="format-rules-borders" class="margin-left-3"></div>\n                    <div id="format-rules-edit-combo-num-format" class="input-group-nr margin-left-3"></div>\x3c!--\n                    --\x3e<button type="button" class="btn btn-text-default auto margin-left-10" id="format-rules-edit-btn-clear"><%= scope.textClear %></button>\n                    </div>\n                </td>\n            </tr>\n        <tr class="hasformat">\n            <td class="padding-small">\n                <label class="header"><%= scope.textPreview %></label>\n                <div class="edit-preview-format">\n                    <div id="format-rules-edit-preview-format"></div>\n                    </div>\n                </td>\n            </tr>\n        <tr class="scale">\n            <td class="padding-large scale-container">\n                <div class="scale-1 margin-right-10">\n                    <label><%= scope.textMinpoint %></label>\n                    <div id="format-rules-edit-combo-scale-1" class="input-group-nr"></div>\n                    <div id="format-rules-edit-txt-scale-1"></div>\n                    <div id="format-rules-edit-color-scale-1"></div>\n                </div>\x3c!--\n                --\x3e<div class="scale-2 margin-right-10">\n                    <label id="format-rules-edit-lbl-scale-2"><%= scope.textMidpoint %></label>\n                    <div id="format-rules-edit-combo-scale-2" class="input-group-nr"></div>\n                    <div id="format-rules-edit-txt-scale-2"></div>\n                    <div id="format-rules-edit-color-scale-2"></div>\n                </div>\x3c!--\n                --\x3e<div class="scale-3">\n                    <label><%= scope.textMaxpoint %></label>\n                    <div id="format-rules-edit-combo-scale-3" class="input-group-nr"></div>\n                    <div id="format-rules-edit-txt-scale-3"></div>\n                    <div id="format-rules-edit-color-scale-3"></div>\n                </div>\n            </td>\n        </tr>\n        <tr class="scale">\n            <td colspan="3" class="padding-small">\n                <label class="header"><%= scope.textPreview %></label>\n                <div class="preview-scale">\n                    <div id="format-rules-edit-preview-scale"></div>\n                </div>\n            </td>\n        </tr>\n        <tr class="databar">\n            <td class="padding-large databar-container">\n                <div class="bar-1 margin-right-10">\n                    <label style="display: block;"><%= scope.textMinimum %></label>\n                    <div id="format-rules-edit-combo-bar-1" class="input-group-nr"></div>\n                    <div id="format-rules-edit-txt-bar-1"></div>\n                </div>\x3c!--\n                 --\x3e<div class="bar-2">\n                    <label style="display: block;"><%= scope.textMaximum %></label>\n                    <div id="format-rules-edit-combo-bar-2" class="input-group-nr"></div>\n                    <div id="format-rules-edit-txt-bar-2"></div>\n                </div>\n            </td>\n        </tr>\n        <tr class="databar">\n            <td class="padding-very-small">\n                <label class="header"><%= scope.textAppearance %></label>\n            </td>\n        </tr>\n        <tr class="databar">\n            <td class="padding-large">\n                <div class="fill margin-right-10">\n                    <label><%= scope.textFill %></label>\n                    <div id="format-rules-edit-combo-fill" class="input-group-nr"></div>\n                    <div class="color-pos-fill">\n                        <label><%= scope.textPositive %></label>\n                        <div id="format-rules-edit-color-pos-fill" class="float-right"></div>\n                    </div>\n                    <div class="color-neg-fill">\n                        <label style="margin-top: 4px;"><%= scope.textNegative %></label>\n                        <div id="format-rules-edit-color-neg-fill" class="float-right"></div>\n                    </div>\n                    <div id="format-rules-edit-chk-fill"></div>\n                </div>\x3c!--\n                --\x3e<div class="border margin-right-10">\n                    <label><%= scope.textBorder %></label>\n                    <div id="format-rules-edit-combo-border" class="input-group-nr"></div>\n                    <div class="color-pos-border">\n                        <label><%= scope.textPositive %></label>\n                        <div id="format-rules-edit-color-pos-border" class="float-right"></div>\n                        </div>\n                    <div class="color-neg-border">\n                        <label><%= scope.textNegative %></label>\n                        <div id="format-rules-edit-color-neg-border" class="float-right"></div>\n                        </div>\n                    <div id="format-rules-edit-chk-border"></div>\n                </div>\x3c!--\n                --\x3e<div class="direction">\n                    <label><%= scope.textBarDirection %></label>\n                    <div id="format-rules-edit-combo-direction" class="input-group-nr"></div>\n                    <div id="format-rules-edit-chk-show-bar"></div>\n                </div>\n            </td>\n        </tr>\n        <tr class="databar">\n            <td class="padding-small">\n                <div class="axis float-left">\n                    <label class="header"><%= scope.textAxis %></label>\n                    <label class="position-label margin-right-10"><%= scope.textPosition %></label>\n                    <div id="format-rules-edit-combo-axis-pos" class="input-group-nr margin-right-10"></div>\n                    <div id="format-rules-edit-color-axis-color"></div>\n                    </div>\n                <div class="preview float-right">\n                    <label class="header"><%= scope.textPreview %></label>\n                    <div class="preview-databar">\n                        <div id="format-rules-edit-preview-databar"></div>\n                    </div>\n                </div>\n            </td>\n        </tr>\n        <tr class="iconset">\n            <td>\n                <table>\n                    <tr>\n                        <td class="padding-large icon-style">\n                            <label class="header"><%= scope.textIconStyle %></label>\n                            <div>\n                                <div id="format-rules-icon-style" class="input-group-nr"></div>\n                                <div id="format-rules-edit-chk-icon-show" class="margin-left-10"></div>\n                                <button type="button" class="btn btn-text-default auto float-right" id="format-rules-edit-btn-icon-reverse"><%= scope.textReverse %></button>\n                            </div>\n                        </td>\n                    </tr>\n                    <tr class="icons-5">\n                        <td class="padding-small">\n                            <div id="format-rules-combo-icon-5" class="margin-right-5"></div>\x3c!--\n                            --\x3e<div id="format-rules-txt-icon-5" class="iconset-label margin-right-5"></div>\x3c!--\n                            --\x3e<div id="format-rules-edit-combo-op-5" class="input-group-nr margin-right-5"></div>\x3c!--\n                            --\x3e<div id="format-rules-edit-txt-value-5" class="margin-right-5"></div>\x3c!--\n                            --\x3e<div id="format-rules-edit-combo-type-5" class="input-group-nr"></div>\n                        </td>\n                    </tr>\n                    <tr class="icons-4">\n                        <td class="padding-small">\n                            <div id="format-rules-combo-icon-4" class="margin-right-5"></div>\x3c!--\n                            --\x3e<div id="format-rules-txt-icon-4" class="iconset-label margin-right-5"></div>\x3c!--\n                            --\x3e<div id="format-rules-edit-combo-op-4" class="input-group-nr margin-right-5"></div>\x3c!--\n                            --\x3e<div id="format-rules-edit-txt-value-4" class="margin-right-5"></div>\x3c!--\n                            --\x3e<div id="format-rules-edit-combo-type-4" class="input-group-nr"></div>\n                        </td>\n                    </tr>\n                    <tr class="icons-3">\n                        <td class="padding-small">\n                            <div id="format-rules-combo-icon-3" class="margin-right-5"></div>\x3c!--\n                            --\x3e<div id="format-rules-txt-icon-3" class="iconset-label margin-right-5"></div>\x3c!--\n                            --\x3e<div id="format-rules-edit-combo-op-3" class="input-group-nr margin-right-5"></div>\x3c!--\n                            --\x3e<div id="format-rules-edit-txt-value-3" class="margin-right-5"></div>\x3c!--\n                            --\x3e<div id="format-rules-edit-combo-type-3" class="input-group-nr"></div>\n                        </td>\n                    </tr>\n                    <tr class="icons-2">\n                        <td class="padding-small">\n                            <div id="format-rules-combo-icon-2" class="margin-right-5"></div>\x3c!--\n                            --\x3e<div id="format-rules-txt-icon-2" class="iconset-label margin-right-5"></div>\x3c!--\n                            --\x3e<div id="format-rules-edit-combo-op-2" class="input-group-nr margin-right-5"></div>\x3c!--\n                            --\x3e<div id="format-rules-edit-txt-value-2" class="margin-right-5"></div>\x3c!--\n                            --\x3e<div id="format-rules-edit-combo-type-2" class="input-group-nr"></div>\n                        </td>\n                    </tr>\n                    <tr class="icons-1">\n                        <td class="padding-small">\n                            <div id="format-rules-combo-icon-1" class="margin-right-5"></div>\x3c!--\n                            --\x3e<div id="format-rules-txt-icon-1" class="iconset-label margin-right-5"></div>\x3c!--\n                            --\x3e<div id="format-rules-edit-combo-op-1" class="input-group-nr hidden margin-right-5"></div>\x3c!--\n                            --\x3e<div id="format-rules-edit-txt-value-1" class="hidden margin-right-5"></div>\x3c!--\n                            --\x3e<div id="format-rules-edit-combo-type-1" class="input-group-nr hidden"></div>\n                        </td>\n                    </tr>\n                </table>\n            </td>\n        </tr>\n    </table>\n    </div>\n</div>\n'}),define("spreadsheeteditor/main/app/view/FormatRulesEditDlg",["text!spreadsheeteditor/main/app/template/FormatRulesEditDlg.template","common/main/lib/view/AdvancedSettingsWindow","common/main/lib/component/ComboBox","common/main/lib/component/InputField"],function(e){"use strict";SSE.Views=SSE.Views||{},SSE.Views.FormatRulesEditDlg=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{alias:"FormatRulesEditDlg",contentWidth:491,height:445,id:"window-format-rules"},initialize:function(t){_.extend(this.options,{title:this.txtTitleNew,template:['<div class="box" style="height:'+(this.options.height-85)+'px;">','<div class="content-panel" style="padding: 0;">'+_.template(e)({scope:this})+"</div>","</div>",'<div class="separator horizontal"></div>'].join("")},t),this.api=t.api,this.handler=t.handler,this.isEdit=t.isEdit||!1,this.props=t.props,this.type=t.type,this.subtype=t.subtype,this.percent=t.percent,this.langId=t.langId,Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);function t(t){t.setMenu(),t.currentColor="000000";var e=t.getPicker();return e.currentColor=t.currentColor,e}var i,s=this,e=(this.dataValTypes=[{value:Asc.c_oAscCfvoType.Number,displayValue:this.txtNumber},{value:Asc.c_oAscCfvoType.Percent,displayValue:this.textPercent},{value:Asc.c_oAscCfvoType.Formula,displayValue:this.textFormula},{value:Asc.c_oAscCfvoType.Percentile,displayValue:this.textPercentile}],[{name:Common.define.conditionalData.textValue,type:Asc.c_oAscCFType.cellIs,rules:[{name:Common.define.conditionalData.textGreater,subtype:Asc.c_oAscCFOperator.greaterThan},{name:Common.define.conditionalData.textGreaterEq,subtype:Asc.c_oAscCFOperator.greaterThanOrEqual},{name:Common.define.conditionalData.textLess,subtype:Asc.c_oAscCFOperator.lessThan},{name:Common.define.conditionalData.textLessEq,subtype:Asc.c_oAscCFOperator.lessThanOrEqual},{name:Common.define.conditionalData.textEqual,subtype:Asc.c_oAscCFOperator.equal},{name:Common.define.conditionalData.textNotEqual,subtype:Asc.c_oAscCFOperator.notEqual},{name:Common.define.conditionalData.textBetween,subtype:Asc.c_oAscCFOperator.between},{name:Common.define.conditionalData.textNotBetween,subtype:Asc.c_oAscCFOperator.notBetween}]},{name:Common.define.conditionalData.textTop+"/"+Common.define.conditionalData.textBottom,type:Asc.c_oAscCFType.top10,rules:[{name:Common.define.conditionalData.textTop,subtype:0},{name:Common.define.conditionalData.textBottom,subtype:1}]},{name:Common.define.conditionalData.textAverage,type:Asc.c_oAscCFType.aboveAverage,rules:[{name:Common.define.conditionalData.textAbove,subtype:0},{name:Common.define.conditionalData.textBelow,subtype:1},{name:Common.define.conditionalData.textEqAbove,subtype:2},{name:Common.define.conditionalData.textEqBelow,subtype:3},{name:Common.define.conditionalData.text1Above,subtype:4},{name:Common.define.conditionalData.text1Below,subtype:5},{name:Common.define.conditionalData.text2Above,subtype:6},{name:Common.define.conditionalData.text2Below,subtype:7},{name:Common.define.conditionalData.text3Above,subtype:8},{name:Common.define.conditionalData.text3Below,subtype:9}]},{name:Common.define.conditionalData.textText,type:Asc.c_oAscCFType.containsText,rules:[{name:Common.define.conditionalData.textContains,type:Asc.c_oAscCFType.containsText},{name:Common.define.conditionalData.textNotContains,type:Asc.c_oAscCFType.notContainsText},{name:Common.define.conditionalData.textBegins,type:Asc.c_oAscCFType.beginsWith},{name:Common.define.conditionalData.textEnds,type:Asc.c_oAscCFType.endsWith}]},{name:Common.define.conditionalData.textDate,type:Asc.c_oAscCFType.timePeriod,rules:[{name:Common.define.conditionalData.textYesterday,subtype:Asc.c_oAscTimePeriod.yesterday},{name:Common.define.conditionalData.textToday,subtype:Asc.c_oAscTimePeriod.today},{name:Common.define.conditionalData.textTomorrow,subtype:Asc.c_oAscTimePeriod.tomorrow},{name:Common.define.conditionalData.textLast7days,subtype:Asc.c_oAscTimePeriod.last7Days},{name:Common.define.conditionalData.textLastWeek,subtype:Asc.c_oAscTimePeriod.lastWeek},{name:Common.define.conditionalData.textThisWeek,subtype:Asc.c_oAscTimePeriod.thisWeek},{name:Common.define.conditionalData.textNextWeek,subtype:Asc.c_oAscTimePeriod.nextWeek},{name:Common.define.conditionalData.textLastMonth,subtype:Asc.c_oAscTimePeriod.lastMonth},{name:Common.define.conditionalData.textThisMonth,subtype:Asc.c_oAscTimePeriod.thisMonth},{name:Common.define.conditionalData.textNextMonth,subtype:Asc.c_oAscTimePeriod.nextMonth}]},{name:Common.define.conditionalData.textBlank+"/"+Common.define.conditionalData.textError,type:Asc.c_oAscCFType.containsBlanks,rules:[{name:Common.define.conditionalData.textBlanks,type:Asc.c_oAscCFType.containsBlanks},{name:Common.define.conditionalData.textNotBlanks,type:Asc.c_oAscCFType.notContainsBlanks},{name:Common.define.conditionalData.textErrors,type:Asc.c_oAscCFType.containsErrors},{name:Common.define.conditionalData.textNotErrors,type:Asc.c_oAscCFType.notContainsErrors}]},{name:Common.define.conditionalData.textDuplicate+"/"+Common.define.conditionalData.textUnique,type:Asc.c_oAscCFType.duplicateValues,rules:[{name:Common.define.conditionalData.textDuplicate,type:Asc.c_oAscCFType.duplicateValues},{name:Common.define.conditionalData.textUnique,type:Asc.c_oAscCFType.uniqueValues}]},{name:this.text2Scales,type:Asc.c_oAscCFType.colorScale,num:2},{name:this.text3Scales,type:Asc.c_oAscCFType.colorScale,num:3},{name:Common.define.conditionalData.textDataBar,type:Asc.c_oAscCFType.dataBar},{name:Common.define.conditionalData.textIconSets,type:Asc.c_oAscCFType.iconSet},{name:Common.define.conditionalData.textFormula,type:Asc.c_oAscCFType.expression}]),o=[],n=[],e=(_.each(e,function(t,e){var i=[],s=(t.rules&&_.each(t.rules,function(t,e){i.push({name:t.name,type:t.type,subtype:t.subtype,allowSelected:!0,selected:!1})}),new Backbone.Collection(i));o.push({name:t.name,type:t.type,rules:s,num:t.num,index:e}),n.push({value:e,displayValue:t.name})}),this.ruleStore=new Backbone.Collection(o),this.cmbCategory=new Common.UI.ComboBox({el:$("#format-rules-edit-combo-category"),style:"width: 150px;",menuStyle:"min-width: 100%;max-height: 211px;",editable:!1,cls:"input-group-nr",data:n,takeFocusOnClose:!0,scrollAlwaysVisible:!1}).on("selected",function(t,e){s.refreshRules(e.value)}),Common.UI.FocusManager.add(this,this.cmbCategory),this.cmbRule=new Common.UI.ComboBox({el:$("#format-rules-edit-combo-rule"),style:"width: 150px;",menuStyle:"min-width: 100%;max-height: 211px;",editable:!1,cls:"input-group-nr",data:[],takeFocusOnClose:!0}).on("selected",function(t,e){s.setControls(s.cmbCategory.getValue(),e.value)}),Common.UI.FocusManager.add(this,this.cmbRule),this.txtRange1=new Common.UI.InputFieldBtn({el:$("#format-rules-edit-txt-r1"),name:"range",style:"width: 150px;",allowBlank:!0,btnHint:this.textSelectData,validateOnChange:!1}),this.txtRange1.on("button:click",_.bind(this.onSelectData,this)),Common.UI.FocusManager.add(this,this.txtRange1),this.txtRange2=new Common.UI.InputFieldBtn({el:$("#format-rules-edit-txt-r2"),name:"range",style:"width: 150px;",allowBlank:!0,btnHint:this.textSelectData,validateOnChange:!1}),this.txtRange2.on("button:click",_.bind(this.onSelectData,this)),Common.UI.FocusManager.add(this,this.txtRange2),this.cmbPercent=new Common.UI.ComboBox({el:$("#format-rules-edit-combo-percent"),style:"width: 100px;",menuStyle:"min-width: 100%;max-height: 211px;",editable:!1,cls:"input-group-nr",data:[{value:0,displayValue:this.textItem},{value:1,displayValue:this.textPercent}],takeFocusOnClose:!0}).on("selected",function(t,e){e.value;s.numRank.setValue(s.numRank.getNumberValue())}),this.cmbPercent.setValue(0),Common.UI.FocusManager.add(this,this.cmbPercent),this.numRank=new Common.UI.MetricSpinner({el:$("#format-rules-edit-spin-rank"),step:1,width:100,defaultUnit:"",defaultValue:10,allowDecimal:!1,value:"10",maxValue:1e12,minValue:-1e12}),this.numRank.on("change",_.bind(function(t,e,i,s){},this)),Common.UI.FocusManager.add(this,this.numRank),this.CFPresets=this.api.asc_getCFPresets(),this.CFPresets[Asc.c_oAscCFRuleTypeSettings.format]),a=[],l=_.template(['<a id="<%= id %>" tabindex="-1" type="menuitem" style="padding: 3px 10px;">','<div style="height: 22px;padding: 4px 0;<%= options.styleStr %>"><%= caption %></div>',"</a>"].join("")),e=(_.each(e,function(t,e){a.push({value:e,presetSettings:{fontColor:t[0],fillColor:t[1],borderColor:t[2],styleObj:{"background-color":t[1]?"#"+t[1]:"#ffffff",color:t[0]?"#"+t[0]:"transparent",border:t[2]?"1px solid #"+t[2]:"","text-align":"center"}},caption:t[0]?Common.define.conditionalData.exampleText:"",template:l,styleStr:"background-color: "+(t[1]?"#"+t[1]:"#ffffff")+";color:"+(t[0]?"#"+t[0]:"transparent")+";"+(t[2]?"border: 1px solid #"+t[2]+";":"text-align: center;")})}),this.btnFormats=new Common.UI.Button({parentEl:$("#format-rules-format-preset"),cls:"btn-text-menu-default",caption:this.textPresets,style:"width: 150px;",menu:new Common.UI.Menu({style:"min-width: 150px;",maxHeight:211,additionalAlign:this.menuAddAlign,items:a})}),this.btnFormats.menu.on("item:click",_.bind(this.onFormatsSelect,this)),this.btnBold=new Common.UI.Button({parentEl:$("#format-rules-bold"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-bold",enableToggle:!0,hint:this.textBold}),this.btnBold.on("click",_.bind(this.onBoldClick,this)),Common.UI.FocusManager.add(this,this.btnBold),this.btnItalic=new Common.UI.Button({parentEl:$("#format-rules-italic"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-italic",enableToggle:!0,hint:this.textItalic}),this.btnItalic.on("click",_.bind(this.onItalicClick,this)),Common.UI.FocusManager.add(this,this.btnItalic),this.btnUnderline=new Common.UI.Button({parentEl:$("#format-rules-underline"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-underline",enableToggle:!0,hint:this.textUnderline}),this.btnUnderline.on("click",_.bind(this.onUnderlineClick,this)),Common.UI.FocusManager.add(this,this.btnUnderline),this.btnStrikeout=new Common.UI.Button({parentEl:$("#format-rules-strikeout"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-strikeout",enableToggle:!0,hint:this.textStrikeout}),this.btnStrikeout.on("click",_.bind(this.onStrikeoutClick,this)),Common.UI.FocusManager.add(this,this.btnStrikeout),this.btnTextColor=new Common.UI.ButtonColored({parentEl:$("#format-rules-fontcolor"),cls:"btn-toolbar move-focus",iconCls:"toolbar__icon btn-fontcolor",hint:this.textColor,additionalAlign:this.menuAddAlign,color:"000000",menu:!0,takeFocusOnClose:!0}),this.mnuTextColorPicker=t(this.btnTextColor),this.btnTextColor.on("color:select",_.bind(this.onFormatTextColorSelect,this)),Common.UI.FocusManager.add(this,this.btnTextColor),this.btnFillColor=new Common.UI.ButtonColored({parentEl:$("#format-rules-fillcolor"),cls:"btn-toolbar move-focus",iconCls:"toolbar__icon btn-paracolor",hint:this.fillColor,additionalAlign:this.menuAddAlign,color:"000000",transparent:!0,menu:!0,takeFocusOnClose:!0}),this.mnuFillColorPicker=t(this.btnFillColor),this.btnFillColor.on("color:select",_.bind(this.onFormatFillColorSelect,this)),Common.UI.FocusManager.add(this,this.btnFillColor),this.btnBorders=new Common.UI.Button({parentEl:$("#format-rules-borders"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-border-out",hint:this.tipBorders,icls:"btn-border-out",borderId:"outer",borderswidth:Asc.c_oAscBorderStyles.Thin,split:!0,menu:new Common.UI.Menu({items:[{caption:this.textOutBorders,iconCls:"menu__icon btn-border-out",icls:"btn-border-out",borderId:"outer"},{caption:this.textAllBorders,iconCls:"menu__icon btn-border-all",icls:"btn-border-all",borderId:"all"},{caption:this.textTopBorders,iconCls:"menu__icon btn-border-top",icls:"btn-border-top",borderId:Asc.c_oAscBorderOptions.Top},{caption:this.textBottomBorders,iconCls:"menu__icon btn-border-bottom",icls:"btn-border-bottom",borderId:Asc.c_oAscBorderOptions.Bottom},{caption:this.textLeftBorders,iconCls:"menu__icon btn-border-left",icls:"btn-border-left",borderId:Asc.c_oAscBorderOptions.Left},{caption:this.textRightBorders,iconCls:"menu__icon btn-border-right",icls:"btn-border-right",borderId:Asc.c_oAscBorderOptions.Right},{caption:this.textNoBorders,iconCls:"menu__icon btn-border-no",icls:"btn-border-no",borderId:"none"},{caption:"--"},{caption:this.textInsideBorders,iconCls:"menu__icon btn-border-inside",icls:"btn-border-center",borderId:"inner"},{caption:this.textCenterBorders,iconCls:"menu__icon btn-border-insidevert",icls:"btn-border-vmiddle",borderId:Asc.c_oAscBorderOptions.InnerV},{caption:this.textMiddleBorders,iconCls:"menu__icon btn-border-insidehor",icls:"btn-border-hmiddle",borderId:Asc.c_oAscBorderOptions.InnerH},{caption:this.textDiagUpBorder,iconCls:"menu__icon btn-border-diagup",icls:"btn-border-diagup",borderId:Asc.c_oAscBorderOptions.DiagU},{caption:this.textDiagDownBorder,iconCls:"menu__icon btn-border-diagdown",icls:"btn-border-diagdown",borderId:Asc.c_oAscBorderOptions.DiagD},{caption:"--"},{id:"format-rules-borders-border-width",caption:this.textBordersStyle,iconCls:"menu__icon btn-border-style",menu:(e=_.template('<a id="<%= id %>" tabindex="-1" type="menuitem"><div class="border-size-item"><svg><use xlink:href="#<%= options.imgId %>"></use></svg></div></a>'),s.mnuBorderWidth=new Common.UI.Menu({style:"min-width: 100px;",menuAlign:"tl-tr",items:[{template:e,stopPropagation:!0,checkable:!0,toggleGroup:"border-width",value:Asc.c_oAscBorderStyles.Thin,imgId:"solid-s",checked:!0},{template:e,stopPropagation:!0,checkable:!0,toggleGroup:"border-width",value:Asc.c_oAscBorderStyles.Hair,imgId:"dots-s"},{template:e,stopPropagation:!0,checkable:!0,toggleGroup:"border-width",value:Asc.c_oAscBorderStyles.Dotted,imgId:"dashes-s"},{template:e,stopPropagation:!0,checkable:!0,toggleGroup:"border-width",value:Asc.c_oAscBorderStyles.Dashed,imgId:"dashes-m"},{template:e,stopPropagation:!0,checkable:!0,toggleGroup:"border-width",value:Asc.c_oAscBorderStyles.DashDot,imgId:"dash-dot-s"},{template:e,stopPropagation:!0,checkable:!0,toggleGroup:"border-width",value:Asc.c_oAscBorderStyles.DashDotDot,imgId:"dash-dot-dot-s"},{template:e,stopPropagation:!0,checkable:!0,toggleGroup:"border-width",value:Asc.c_oAscBorderStyles.Medium,imgId:"solid-m"},{template:e,stopPropagation:!0,checkable:!0,toggleGroup:"border-width",value:Asc.c_oAscBorderStyles.MediumDashed,imgId:"dashes-l"},{template:e,stopPropagation:!0,checkable:!0,toggleGroup:"border-width",value:Asc.c_oAscBorderStyles.MediumDashDot,imgId:"dash-dot-m"},{template:e,stopPropagation:!0,checkable:!0,toggleGroup:"border-width",value:Asc.c_oAscBorderStyles.MediumDashDotDot,imgId:"dash-dot-dot-m"},{template:e,stopPropagation:!0,checkable:!0,toggleGroup:"border-width",value:Asc.c_oAscBorderStyles.Thick,imgId:"solid-l"}]}),s.mnuBorderWidth)},this.mnuBorderColor=new Common.UI.MenuItem({id:"format-rules-borders-border-color",caption:this.textBordersColor,iconCls:"mnu-icon-item mnu-border-color",template:_.template('<a id="<%= id %>" tabindex="-1" type="menuitem"><span class="menu-item-icon" style="background-image: none; width: 12px; height: 12px; border-style: solid; border-width: 3px; border-color: #000;"></span><%= caption %></a>'),menu:new Common.UI.Menu({menuAlign:"tl-tr",items:[{template:_.template('<div id="format-rules-borders-menu-bordercolor" style="width: 164px; display: inline-block;"></div>'),stopPropagation:!0},{caption:"--"},{id:"format-rules-borders-menu-new-bordercolor",template:_.template('<a tabindex="-1" type="menuitem" style="'+(Common.UI.isRTL()?"padding-right: 12px;":"padding-left: 12px;")+'">'+this.textNewColor+"</a>"),stopPropagation:!0}]})})]})}),this.btnBorders.menu.on("item:click",_.bind(this.onBordersMenu,this)),this.btnBorders.on("click",_.bind(this.onBorders,this)),this.mnuBorderColorPicker=new Common.UI.ThemeColorPalette({el:$("#format-rules-borders-menu-bordercolor"),outerMenu:{menu:this.mnuBorderColor.menu,index:0,focusOnShow:!0}}),this.mnuBorderColor.menu.setInnerMenu([{menu:this.mnuBorderColorPicker,index:0}]),this.mnuBorderColorPicker.on("select",_.bind(this.onBordersColor,this)),$("#format-rules-borders-menu-new-bordercolor").on("click",_.bind(function(){s.mnuBorderColorPicker.addNewColor()},this)),this.mnuBorderWidth.on("item:toggle",_.bind(this.onBordersWidth,this)),this.ascFormatOptions={General:"General",Number:"0.00",Currency:"$#,##0.00",Accounting:'_($* #,##0.00_);_($* (#,##0.00);_($* "-"??_);_(@_)',DateShort:"m/d/yyyy",DateLong:"[$-F800]dddd, mmmm dd, yyyy",Time:"[$-F400]h:mm:ss AM/PM",Percentage:"0.00%",Percent:"0%",Fraction:"# ?/?",Scientific:"0.00E+00",Text:"@"},this.numFormatData=[{value:Asc.c_oAscNumFormatType.General,format:this.ascFormatOptions.General,displayValue:this.txtGeneral,exampleval:"100"},{value:Asc.c_oAscNumFormatType.Number,format:this.ascFormatOptions.Number,displayValue:this.txtNumber,exampleval:"100,00"},{value:Asc.c_oAscNumFormatType.Scientific,format:this.ascFormatOptions.Scientific,displayValue:this.txtScientific,exampleval:"1,00E+02"},{value:Asc.c_oAscNumFormatType.Accounting,format:this.ascFormatOptions.Accounting,displayValue:this.txtAccounting,exampleval:"100,00 $"},{value:Asc.c_oAscNumFormatType.Currency,format:this.ascFormatOptions.Currency,displayValue:this.txtCurrency,exampleval:"100,00 $"},{value:Asc.c_oAscNumFormatType.Date,format:"MM-dd-yyyy",displayValue:this.txtDateShort,exampleval:"04-09-1900",customDisplayValue:this.txtDate},{value:Asc.c_oAscNumFormatType.Date,format:"MMMM d yyyy",displayValue:this.txtDateLong,exampleval:"April 9 1900",customDisplayValue:this.txtDate},{value:Asc.c_oAscNumFormatType.Time,format:"HH:MM:ss",displayValue:this.txtTime,exampleval:"00:00:00"},{value:Asc.c_oAscNumFormatType.Percent,format:this.ascFormatOptions.Percentage,displayValue:this.txtPercentage,exampleval:"100,00%"},{value:Asc.c_oAscNumFormatType.Fraction,format:this.ascFormatOptions.Fraction,displayValue:this.txtFraction,exampleval:"100"},{value:Asc.c_oAscNumFormatType.Text,format:this.ascFormatOptions.Text,displayValue:this.txtText,exampleval:"100"}],this.api&&((e=new Asc.asc_CFormatCellsInfo).asc_setType(Asc.c_oAscNumFormatType.None),e.asc_setSymbol(this.langId),i=this.api.asc_getFormatCells(e),this.numFormatData.forEach(function(t,e){t.format=i[e],t.exampleval=s.api.asc_getLocaleExample(t.format,100)})),_.template(["<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%= item.value %>"><a tabindex="-1" type="menuitem">','<div style="position: relative;"><div class="display-value"><%= scope.getDisplayValue(item) %></div>','<div class="example-val"><%= item.exampleval ? item.exampleval : "" %></div>',"</div></a></li>","<% }); %>"].join("")));this.cmbNumberFormat=new Common.UI.ComboBoxCustom({el:$("#format-rules-edit-combo-num-format"),cls:"input-group-nr",style:"width: 113px;",menuStyle:"min-width: 100%;max-height: 211px;",hint:this.tipNumFormat,itemsTemplate:e,editable:!1,focusWhenNoSelection:!1,data:this.numFormatData,takeFocusOnClose:!0,updateFormControl:function(t){this.clearSelection(),t&&this.setRawValue(t.get("customDisplayValue")||t.get("displayValue"))}}),this.cmbNumberFormat.setValue(Asc.c_oAscNumFormatType.General),this.cmbNumberFormat.on("selected",_.bind(this.onNumberFormatSelect,this)),Common.UI.FocusManager.add(this,this.cmbNumberFormat),this.btnClear=new Common.UI.Button({el:$("#format-rules-edit-btn-clear")}),this.btnClear.on("click",_.bind(this.clearFormat,this)),Common.UI.FocusManager.add(this,this.btnClear),this.panels={format:{el:this.$window.find(".hasformat"),rendered:!1,initColors:!1},scale:{el:this.$window.find(".scale"),rendered:!1,initColors:!1},databar:{el:this.$window.find(".databar"),rendered:!1,initColors:!1},iconset:{el:this.$window.find(".iconset"),rendered:!1,initColors:!1}},this.panels.format.rendered=!0,this.afterRender()},addNewIconsLine:function(){var o=this,t=this.iconsControls.length,e=(this.iconsControls.push({}),new Common.UI.ComboBox({el:$("#format-rules-combo-icon-"+(t+1)),type:t,template:_.template(['<div class="input-group combobox combo-dataview-menu input-group-nr dropdown-toggle"  data-toggle="dropdown">','<div class="form-control image" style="display: block;width: 85px;">','<div style="display: inline-block;overflow: hidden;width: 100%;height: 100%;padding-top: 2px;background-repeat: no-repeat; background-position: 27px center;white-space:nowrap;"></div>',"</div>",'<div style="display: table-cell;"></div>','<button type="button" class="btn btn-default"><span class="caret"></span></button>',"</div>"].join(""))})),i=new Common.UI.Menu({style:"min-width: 105px;",additionalAlign:this.menuAddAlign,items:[{caption:this.txtNoCellIcon,checkable:!0,allowDepress:!1,toggleGroup:"no-cell-icons-"+(t+1)},{template:_.template('<div id="format-rules-combo-menu-icon-'+(t+1)+'" style="width: 217px; margin: 0 5px;"></div>')}]}).render($("#format-rules-combo-icon-"+(t+1))),s=new Common.UI.DataView({el:$("#format-rules-combo-menu-icon-"+(t+1)),parentMenu:i,outerMenu:{menu:i,index:1},store:new Common.UI.DataViewStore(o.iconsList),itemTemplate:_.template('<img id="<%= id %>" class="item-icon" src="<%= imgUrl %>" style="width: 16px; height: 16px;">'),type:t}),s=(s.on("item:click",_.bind(this.onSelectIcon,this,e,i.items[0])),i.setInnerMenu([{menu:s,index:1}]),i.items[0].on("toggle",_.bind(this.onSelectNoIcon,this,e,s)),this.iconsControls[t].cmbIcons=e,this.iconsControls[t].pickerIcons=s,this.iconsControls[t].itemNoIcons=i.items[0],(e=new Common.UI.ComboBox({el:$("#format-rules-edit-combo-op-"+(t+1)),style:"width: 55px;",menuStyle:"min-width: 100%;",editable:!1,cls:"input-group-nr",data:[{value:!0,displayValue:">=",prevOp:"<"},{value:!1,displayValue:">",prevOp:"<="}],type:t,takeFocusOnClose:!0}).on("selected",function(t,e){o.fillIconsLabels()})).setValue(1),this.iconsControls[t].cmbOperator=e,Common.UI.FocusManager.add(this,e),new Common.UI.InputFieldBtn({el:$("#format-rules-edit-txt-value-"+(t+1)),name:"range",style:"width: 100px;",allowBlank:!0,btnHint:this.textSelectData,validateOnChange:!1,type:t}).on("changed:after",function(t,e,i,s){o.fillIconsLabels()}));s.setValue(""),(this.iconsControls[t].value=s).on("button:click",_.bind(this.onSelectData,this)),Common.UI.FocusManager.add(this,s),(e=new Common.UI.ComboBox({el:$("#format-rules-edit-combo-type-"+(t+1)),style:"width: 80px;",menuStyle:"min-width: 100%;max-height: 211px;",editable:!1,cls:"input-group-nr",data:this.dataValTypes,type:t,takeFocusOnClose:!0}).on("selected",function(t,e){})).setValue(Asc.c_oAscCfvoType.Percent),this.iconsControls[t].cmbType=e,Common.UI.FocusManager.add(this,e),this.iconsControls[t].label=$("#format-rules-txt-icon-"+(t+1))},renderIconsPanel:function(){if(!this.panels.iconset.rendered){var n=this,a=(this.collectionPresets=SSE.getCollection("ConditionalFormatIconsPresets"),this.collectionPresets.length<1&&SSE.getController("Main").fillCondFormatIconsPresets(this.api.asc_getCFIconsByType()),this.collectionIcons=SSE.getCollection("ConditionalFormatIcons"),this.collectionIcons.length<1&&SSE.getController("Main").fillCondFormatIcons(this.api.asc_getFullCFIcons()),this.iconsList=[],n.collectionIcons.each(function(t,e){n.iconsList.push({value:t.get("index"),imgUrl:t.get("icon")})}),[]),l=this.collectionPresets.length,t=this.CFPresets[Asc.c_oAscCFRuleTypeSettings.icons];_.each(t,function(t,e){if(!(l<=e)){for(var i=[],s=0;s<t.length;s++){var o=new Asc.asc_CConditionalFormatValueObject;o.asc_setType(t[s][0]),o.asc_setVal(t[s][1]),t[s][2],i.push(o)}a.push({value:e,data:{iconSet:n.collectionPresets.at(e).get("icons"),values:i,icons:n.collectionIcons}})}}),this.cmbIconsPresets=new Common.UI.ComboBoxIcons({el:$("#format-rules-icon-style"),editable:!1,style:"width: 120px;",menuStyle:"max-height: 220px;min-width: 100%;",data:a}).on("selected",function(t,e){n.fillIconsControls(e.value,e.data.values),_.delay(function(){n.iconsControls[n.iconsControls.length-1].cmbOperator.focus()},50)}),this.cmbIconsPresets.setValue(3),this.iconsProps={iconsSet:3},this.chIconShow=new Common.UI.CheckBox({el:$("#format-rules-edit-chk-icon-show"),labelText:this.textShowIcon}),this.chIconShow.on("change",function(t,e,i,s){}),Common.UI.FocusManager.add(this,this.chIconShow),this.btnReverse=new Common.UI.Button({el:$("#format-rules-edit-btn-icon-reverse")}),this.btnReverse.on("click",function(){n.iconsProps.isReverse=!n.iconsProps.isReverse,n.reverseIconsControls()}),this.iconsControls=[];for(var e=0;e<3;e++)this.addNewIconsLine();t=this.cmbIconsPresets.getSelectedRecord();t&&this.fillIconsControls(t.value,t.data.values),this.panels.iconset.rendered=!0}},renderDataBarPanel:function(){if(!this.panels.databar.rendered){var o=this;this.barControls=[];for(var t=0;t<2;t++){var e=this.dataValTypes,e=(0==t?(e=[{value:Asc.c_oAscCfvoType.Minimum,displayValue:this.textMinimum}].concat(e)).push({value:Asc.c_oAscCfvoType.AutoMin,displayValue:this.textAutomatic}):(e=[{value:Asc.c_oAscCfvoType.Maximum,displayValue:this.textMaximum}].concat(e)).push({value:Asc.c_oAscCfvoType.AutoMax,displayValue:this.textAutomatic}),new Common.UI.ComboBox({el:$("#format-rules-edit-combo-bar-"+(t+1)),style:"width: 100%;",menuStyle:"min-width: 100%;max-height: 211px;",editable:!1,cls:"input-group-nr",data:e,type:t,takeFocusOnClose:!0}).on("selected",function(t,e){o.barControls[t.options.type].range.setDisabled(e.value==Asc.c_oAscCfvoType.Minimum||e.value==Asc.c_oAscCfvoType.Maximum||e.value==Asc.c_oAscCfvoType.AutoMin||e.value==Asc.c_oAscCfvoType.AutoMax),o.setDefComboValue(t.options.type,e.value,o.barControls[t.options.type].range)})),i=0==t?Asc.c_oAscCfvoType.AutoMin:Asc.c_oAscCfvoType.AutoMax,s=(e.setValue(i),Common.UI.FocusManager.add(this,e),new Common.UI.InputFieldBtn({el:$("#format-rules-edit-txt-bar-"+(t+1)),name:"range",style:"width: 100%;",allowBlank:!0,btnHint:this.textSelectData,validateOnChange:!1,type:t,disabled:i==Asc.c_oAscCfvoType.AutoMin||i==Asc.c_oAscCfvoType.AutoMax||i==Asc.c_oAscCfvoType.Minimum||i==Asc.c_oAscCfvoType.Maximum}));o.setDefComboValue(t,i,s),s.on("button:click",_.bind(this.onSelectData,this)),this.barControls.push({combo:e,range:s}),Common.UI.FocusManager.add(this,s)}this.cmbFill=new Common.UI.ComboBox({el:$("#format-rules-edit-combo-fill"),style:"width: 100%;",menuStyle:"min-width: 100%;max-height: 211px;",editable:!1,cls:"input-group-nr",data:[{value:!1,displayValue:this.textSolid},{value:!0,displayValue:this.textGradient}],takeFocusOnClose:!0}).on("selected",function(t,e){o.barProps&&(o.barProps.asc_setGradient(e.value),o.previewFormat())}),this.cmbFill.setValue(!1),Common.UI.FocusManager.add(this,this.cmbFill),this.btnPosFill=new Common.UI.ColorButton({parentEl:$("#format-rules-edit-color-pos-fill"),style:"width:45px;",menu:!0,color:"638EC6",cls:"move-focus",takeFocusOnClose:!0}),Common.UI.FocusManager.add(this,this.btnPosFill),this.btnNegFill=new Common.UI.ColorButton({parentEl:$("#format-rules-edit-color-neg-fill"),style:"width:45px;",menu:!0,color:"FF0000",cls:"move-focus",takeFocusOnClose:!0}),Common.UI.FocusManager.add(this,this.btnNegFill),this.chFill=new Common.UI.CheckBox({el:$("#format-rules-edit-chk-fill"),labelText:this.textSameAs}),this.chFill.on("change",function(t,e,i,s){o.btnNegFill.setDisabled("checked"==t.getValue())}),Common.UI.FocusManager.add(this,this.chFill),this.cmbBorder=new Common.UI.ComboBox({el:$("#format-rules-edit-combo-border"),style:"width: 100%;",menuStyle:"min-width: 100%;max-height: 211px;",editable:!1,cls:"input-group-nr",data:[{value:!1,displayValue:this.textSolid},{value:!0,displayValue:this.textNone}],takeFocusOnClose:!0}).on("selected",function(t,e){e=!e.value;o.btnPosBorder.setDisabled(!e),o.btnNegBorder.setDisabled(!e||"checked"==o.chBorder.getValue()),o.chBorder.setDisabled(!e),o.barProps&&(e?o.barProps.asc_setBorderColor(Common.Utils.ThemeColor.getRgbColor(o.btnPosBorder.colorPicker.currentColor)):o.barProps.asc_setBorderColor(null),o.previewFormat())}),this.cmbBorder.setValue(!1),Common.UI.FocusManager.add(this,this.cmbBorder),this.btnPosBorder=new Common.UI.ColorButton({parentEl:$("#format-rules-edit-color-pos-border"),style:"width:45px;",menu:!0,color:"000000",cls:"move-focus",takeFocusOnClose:!0}),Common.UI.FocusManager.add(this,this.btnPosBorder),this.btnNegBorder=new Common.UI.ColorButton({parentEl:$("#format-rules-edit-color-neg-border"),style:"width:45px;",menu:!0,color:"000000",cls:"move-focus",takeFocusOnClose:!0}),Common.UI.FocusManager.add(this,this.btnNegBorder),this.chBorder=new Common.UI.CheckBox({el:$("#format-rules-edit-chk-border"),labelText:this.textSameAs}),this.chBorder.on("change",function(t,e,i,s){o.btnNegBorder.setDisabled("checked"==t.getValue())}),Common.UI.FocusManager.add(this,this.chBorder),this.cmbBarDirection=new Common.UI.ComboBox({el:$("#format-rules-edit-combo-direction"),style:"width: 100%;",menuStyle:"min-width: 100%;max-height: 211px;",editable:!1,cls:"input-group-nr",data:[{value:Asc.c_oAscDataBarDirection.context,displayValue:this.textContext},{value:Asc.c_oAscDataBarDirection.leftToRight,displayValue:this.textLeft2Right},{value:Asc.c_oAscDataBarDirection.rightToLeft,displayValue:this.textRight2Left}],takeFocusOnClose:!0}).on("selected",function(t,e){o.barProps&&(o.barProps.asc_setDirection(e.value),o.previewFormat())}),this.cmbBarDirection.setValue(Asc.c_oAscDataBarDirection.context),Common.UI.FocusManager.add(this,this.cmbBarDirection),this.chShowBar=new Common.UI.CheckBox({el:$("#format-rules-edit-chk-show-bar"),labelText:this.textShowBar}),Common.UI.FocusManager.add(this,this.chShowBar),this.cmbAxisPos=new Common.UI.ComboBox({el:$("#format-rules-edit-combo-axis-pos"),style:"width: 150px;",menuStyle:"min-width: 100%;max-height: 211px;",editable:!1,cls:"input-group-nr",data:[{value:Asc.c_oAscDataBarAxisPosition.automatic,displayValue:this.textAutomatic},{value:Asc.c_oAscDataBarAxisPosition.middle,displayValue:this.textCellMidpoint},{value:Asc.c_oAscDataBarAxisPosition.none,displayValue:this.textNone}],takeFocusOnClose:!0}).on("selected",function(t,e){o.btnAxisColor.setDisabled(e.value==Asc.c_oAscDataBarAxisPosition.none)}),this.cmbAxisPos.setValue(Asc.c_oAscDataBarDirection.context),Common.UI.FocusManager.add(this,this.cmbAxisPos),this.btnAxisColor=new Common.UI.ColorButton({parentEl:$("#format-rules-edit-color-axis-color"),style:"width:45px;",menu:!0,color:"000000",cls:"move-focus",takeFocusOnClose:!0}),Common.UI.FocusManager.add(this,this.btnAxisColor),this.panels.databar.rendered=!0,this.updateThemeColors()}},renderScalesPanel:function(){if(!this.panels.scale.rendered){var i=this;this.scaleControls=[],this.lblMidScale=this.$window.find("#format-rules-edit-lbl-scale-2");for(var t=0;t<3;t++){var e=this.dataValTypes,s=(0==t?e=[{value:Asc.c_oAscCfvoType.Minimum,displayValue:this.textMinimum}].concat(e):2==t&&(e=[{value:Asc.c_oAscCfvoType.Maximum,displayValue:this.textMaximum}].concat(e)),new Common.UI.ComboBox({el:$("#format-rules-edit-combo-scale-"+(t+1)),style:"width: 100%;",menuStyle:"min-width: 100%;max-height: 211px;",editable:!1,cls:"input-group-nr",data:e,type:t,takeFocusOnClose:!0}).on("selected",function(t,e){i.scaleControls[t.options.type].range.setDisabled(e.value==Asc.c_oAscCfvoType.Minimum||e.value==Asc.c_oAscCfvoType.Maximum),i.setDefComboValue(t.options.type,e.value,i.scaleControls[t.options.type].range)})),e=(s.setValue(1==t?Asc.c_oAscCfvoType.Percentile:e[0].value),Common.UI.FocusManager.add(this,s),new Common.UI.InputFieldBtn({el:$("#format-rules-edit-txt-scale-"+(t+1)),name:"range",style:"width: 100%;",allowBlank:!0,btnHint:this.textSelectData,validateOnChange:!1,type:t,disabled:1!=t})),o=(e.setValue(1==t?50:""),e.on("button:click",_.bind(this.onSelectData,this)),Common.UI.FocusManager.add(this,e),new Common.UI.ColorButton({parentEl:$("#format-rules-edit-color-scale-"+(t+1)),menu:!0,type:t,color:"000000",cls:"move-focus",takeFocusOnClose:!0}));Common.UI.FocusManager.add(this,o),this.scaleControls.push({combo:s,range:e,color:o})}this.panels.scale.rendered=!0,this.updateThemeColors()}},afterRender:function(){this.updateThemeColors(),this._setDefaults(this.props),this.setTitle(this.isEdit?this.txtTitleEdit:this.txtTitleNew)},show:function(){Common.Views.AdvancedSettingsWindow.prototype.show.apply(this,arguments)},_setDefaults:function(t){var e,i=(this._originalProps=t)?t.asc_getType():this.type,s=this.subtype,o=!!this.percent;if(t)switch(i){case Asc.c_oAscCFType.containsText:case Asc.c_oAscCFType.notContainsText:case Asc.c_oAscCFType.beginsWith:case Asc.c_oAscCFType.endsWith:r=t.asc_getContainsText(),this.txtRange1.setValue(r||"");break;case Asc.c_oAscCFType.timePeriod:s=t.asc_getTimePeriod();break;case Asc.c_oAscCFType.aboveAverage:var n=t.asc_getAboveAverage(),a=t.asc_getEqualAverage(),l=t.asc_getStdDev(),s=n?0:1;a?s+=2:l&&(s+=2+2*l);break;case Asc.c_oAscCFType.top10:s=t.asc_getBottom()?1:0,o=t.asc_getPercent(),this.numRank.setValue(t.asc_getRank()?t.asc_getRank():10);break;case Asc.c_oAscCFType.cellIs:s=t.asc_getOperator(),this.txtRange1.setValue(t.asc_getValue1()||""),this.txtRange2.setValue(t.asc_getValue2()||"");break;case Asc.c_oAscCFType.expression:this.txtRange1.setValue(t.asc_getValue1()||"");break;case Asc.c_oAscCFType.colorScale:this.renderScalesPanel();for(var r,c=(r=t.asc_getColorScaleOrDataBarOrIconSetRule()).asc_getCFVOs(),d=r.asc_getColors(),h=(s=c.length,2==c.length?[this.scaleControls[0],this.scaleControls[2]]:this.scaleControls),p=0;p<c.length;p++){var m=c[p].asc_getType(),u=c[p].asc_getVal(),g=d[p];(C=h[p]).combo.setValue(m),C.range.setDisabled(m==Asc.c_oAscCfvoType.Minimum||m==Asc.c_oAscCfvoType.Maximum),C.range.setValue(m!==Asc.c_oAscCfvoType.Minimum&&m!==Asc.c_oAscCfvoType.Maximum&&null!=u?u:""),this.setColor(g,C.color)}break;case Asc.c_oAscCFType.dataBar:this.renderDataBarPanel();for(var b=(r=t.asc_getColorScaleOrDataBarOrIconSetRule()).asc_getCFVOs(),h=this.barControls,p=0;p<b.length;p++){var C,f=b[p].asc_getType(),u=b[p].asc_getVal();(C=h[p]).combo.setValue(f),C.range.setDisabled(f==Asc.c_oAscCfvoType.Minimum||f==Asc.c_oAscCfvoType.Maximum||f==Asc.c_oAscCfvoType.AutoMin||f==Asc.c_oAscCfvoType.AutoMax),C.range.setValue(f!==Asc.c_oAscCfvoType.Minimum&&f!==Asc.c_oAscCfvoType.Maximum&&f!==Asc.c_oAscCfvoType.AutoMin&&f!==Asc.c_oAscCfvoType.AutoMax&&null!=u?u:"")}this.cmbFill.setValue(r.asc_getGradient()),this.setColor(r.asc_getColor(),this.btnPosFill),this.setColor(r.asc_getNegativeColor()||r.asc_getColor(),this.btnNegFill),this.chFill.setValue(r.asc_getNegativeBarColorSameAsPositive());g=r.asc_getBorderColor();this.cmbBorder.setValue(null===g),this.btnPosBorder.setDisabled(null===g),g&&(this.setColor(r.asc_getBorderColor(),this.btnPosBorder),this.setColor(r.asc_getNegativeBorderColor()||r.asc_getBorderColor(),this.btnNegBorder)),this.chBorder.setValue(r.asc_getNegativeBarBorderColorSameAsPositive()),this.chBorder.setDisabled(null===g),this.btnNegBorder.setDisabled(null===g||r.asc_getNegativeBarBorderColorSameAsPositive()),this.cmbBarDirection.setValue(r.asc_getDirection()),this.chShowBar.setValue(!r.asc_getShowValue()),this.cmbAxisPos.setValue(r.asc_getAxisPosition()),r.asc_getAxisColor()&&this.setColor(r.asc_getAxisColor(),this.btnAxisColor),this.btnAxisColor.setDisabled(r.asc_getAxisPosition()==Asc.c_oAscDataBarAxisPosition.none);break;case Asc.c_oAscCFType.iconSet:this.renderIconsPanel(),r=t.asc_getColorScaleOrDataBarOrIconSetRule(),this.chIconShow.setValue(!r.asc_getShowValue()),this.iconsProps.isReverse=r.asc_getReverse(),this.fillIconsControls(r.asc_getIconSet(),r.asc_getCFVOs(),r.asc_getIconSets())}i!==Asc.c_oAscCFType.containsText&&i!==Asc.c_oAscCFType.notContainsText&&i!==Asc.c_oAscCFType.beginsWith&&i!==Asc.c_oAscCFType.endsWith&&i!==Asc.c_oAscCFType.containsBlanks&&i!==Asc.c_oAscCFType.notContainsBlanks&&i!==Asc.c_oAscCFType.duplicateValues&&i!==Asc.c_oAscCFType.uniqueValues&&i!==Asc.c_oAscCFType.containsErrors&&i!==Asc.c_oAscCFType.notContainsErrors&&i!==Asc.c_oAscCFType.timePeriod&&i!==Asc.c_oAscCFType.aboveAverage&&i!==Asc.c_oAscCFType.top10&&i!==Asc.c_oAscCFType.cellIs&&i!==Asc.c_oAscCFType.expression||(t?this.xfsFormat=t.asc_getDxf():this.onFormatsSelect(this.btnFormats.menu,this.btnFormats.menu.items[0]));var S=this.ruleStore.where({type:i});if(1<S.length)i==Asc.c_oAscCFType.colorScale&&(S=s==S[0].get("num")?S[0]:S[1]);else if(0==S.length)for(var v=this.ruleStore,p=0;p<v.length;p++){var w,_=v.at(p);if((w=_.get("rules"))&&w.findWhere({type:i})){S=_,e=i;break}}else(w=(S=S[0]).get("rules"))&&w.findWhere({type:i})?e=i:void 0!==s&&w&&w.findWhere({subtype:s})&&(e=s);(S=S||this.ruleStore.at(0))&&(this.cmbCategory.setValue(S.get("index")),this.refreshRules(S.get("index"),e),i===Asc.c_oAscCFType.top10&&this.cmbPercent.setValue(o?1:0));var x=this.xfsFormat||new Asc.asc_CellXfs;this.fillXfsFormatInfo(x),this.previewFormat()},setColor:function(t,e,i){if(i=e?e.colorPicker:i,t=t&&!t.get_auto()?t.get_type()==Asc.c_oAscColor.COLOR_TYPE_SCHEME?{color:Common.Utils.ThemeColor.getHexColor(t.get_r(),t.get_g(),t.get_b()),effectValue:t.get_value()}:Common.Utils.ThemeColor.getHexColor(t.get_r(),t.get_g(),t.get_b()):i.options.transparent?"transparent":"000000",e&&e.setColor(t),_.isObject(t)){for(var s=!1,o=0;o<10;o++)if(Common.Utils.ThemeColor.ThemeValues[o]==t.effectValue){i.select(t,!0),s=!0;break}s||i.clearSelection()}else i.select(t,!0);return i&&(i.currentColor=t),e&&(e.currentColor=t),t},fillXfsFormatInfo:function(t){t&&(this.btnBold.toggle(!0===t.asc_getFontBold(),!0),this.btnItalic.toggle(!0===t.asc_getFontItalic(),!0),this.btnUnderline.toggle(!0===t.asc_getFontUnderline(),!0),this.btnStrikeout.toggle(!0===t.asc_getFontStrikeout(),!0),this.setColor(t.asc_getFontColor(),this.btnTextColor,this.mnuTextColorPicker),this.setColor(t.asc_getFillColor(),this.btnFillColor,this.mnuFillColorPicker),(t=t.asc_getNumFormatInfo())&&this.cmbNumberFormat.setValue(t.asc_getType(),this.textCustom))},getSettings:function(){var t=this.ruleStore.findWhere({index:this.cmbCategory.getValue()});if(t){var e=this._originalProps||new Asc.asc_CConditionalFormattingRule,i=t.get("type"),s=i!==e.asc_getType();switch(e.asc_setType(i),i!=Asc.c_oAscCFType.containsText&&i!=Asc.c_oAscCFType.containsBlanks&&i!=Asc.c_oAscCFType.duplicateValues&&i!=Asc.c_oAscCFType.timePeriod&&i!=Asc.c_oAscCFType.aboveAverage&&i!=Asc.c_oAscCFType.top10&&i!=Asc.c_oAscCFType.cellIs&&i!=Asc.c_oAscCFType.expression||!this.xfsFormat&&null!==this.xfsFormat||e.asc_setDxf(this.xfsFormat),i){case Asc.c_oAscCFType.containsText:(S=this.txtRange1.getValue())&&e.asc_setContainsText(S),e.asc_setType(this.cmbRule.getValue());break;case Asc.c_oAscCFType.containsBlanks:case Asc.c_oAscCFType.duplicateValues:e.asc_setType(this.cmbRule.getValue());break;case Asc.c_oAscCFType.timePeriod:e.asc_setTimePeriod(this.cmbRule.getValue());break;case Asc.c_oAscCFType.aboveAverage:var o=this.cmbRule.getValue();e.asc_setAboveAverage(!(o%2)),e.asc_setEqualAverage(2==o||3==o),e.asc_setStdDev(3<o?Math.floor(o/2)-1:0);break;case Asc.c_oAscCFType.top10:e.asc_setBottom(!!this.cmbRule.getValue()),e.asc_setPercent(!!this.cmbPercent.getValue()),""!==this.numRank.getValue()&&e.asc_setRank(this.numRank.getNumberValue());break;case Asc.c_oAscCFType.cellIs:e.asc_setOperator(this.cmbRule.getValue()),e.asc_setValue1(this.txtRange1.getValue()),this.txtRange2.isVisible()&&e.asc_setValue2(this.txtRange2.getValue());break;case Asc.c_oAscCFType.expression:e.asc_setValue1(this.txtRange1.getValue());break;case Asc.c_oAscCFType.colorScale:for(var o=s?new Asc.asc_CColorScale:e.asc_getColorScaleOrDataBarOrIconSetRule(),n=t.get("num"),a=2==n?[this.scaleControls[0],this.scaleControls[2]]:this.scaleControls,l=[],r=[],c=0;c<n;c++){var d=new Asc.asc_CConditionalFormatValueObject,h=a[c];d.asc_setType(h.combo.getValue()),d.asc_setVal(h.range.getValue()),r.push(d),l.push(Common.Utils.ThemeColor.getRgbColor(h.colorPicker.currentColor))}o.asc_setColors(l),o.asc_setCFVOs(r),e.asc_setColorScaleOrDataBarOrIconSetRule(o);break;case Asc.c_oAscCFType.dataBar:for(var o=s?new Asc.asc_CDataBar:e.asc_getColorScaleOrDataBarOrIconSetRule(),a=(s&&o.asc_setInterfaceDefault(),this.barControls),p=[],c=0;c<a.length;c++){var m=new Asc.asc_CConditionalFormatValueObject,u=(h=a[c]).combo.getValue();m.asc_setType(u),u!==Asc.c_oAscCfvoType.Minimum&&u!==Asc.c_oAscCfvoType.Maximum&&u!==Asc.c_oAscCfvoType.AutoMin&&u!==Asc.c_oAscCfvoType.AutoMax&&m.asc_setVal(h.range.getValue()),p.push(m)}o.asc_setCFVOs(p),o.asc_setGradient(this.cmbFill.getValue()),o.asc_setColor(Common.Utils.ThemeColor.getRgbColor(this.btnPosFill.colorPicker.currentColor)),o.asc_setNegativeColor(Common.Utils.ThemeColor.getRgbColor(("checked"==this.chFill.getValue()?this.btnPosFill:this.btnNegFill).colorPicker.currentColor)),o.asc_setNegativeBarColorSameAsPositive("checked"==this.chFill.getValue());!this.cmbBorder.getValue()?(o.asc_setBorderColor(Common.Utils.ThemeColor.getRgbColor(this.btnPosBorder.colorPicker.currentColor)),o.asc_setNegativeBorderColor(Common.Utils.ThemeColor.getRgbColor(("checked"==this.chBorder.getValue()?this.btnPosBorder:this.btnNegBorder).colorPicker.currentColor)),o.asc_setNegativeBarBorderColorSameAsPositive("checked"==this.chBorder.getValue())):(o.asc_setBorderColor(null),o.asc_setNegativeBorderColor(null)),o.asc_setDirection(this.cmbBarDirection.getValue()),o.asc_setShowValue("checked"!==this.chShowBar.getValue());var g=this.cmbAxisPos.getValue();o.asc_setAxisPosition(g),g!==Asc.c_oAscDataBarAxisPosition.none?o.asc_setAxisColor(Common.Utils.ThemeColor.getRgbColor(this.btnAxisColor.colorPicker.currentColor)):o.asc_setAxisColor(null),e.asc_setColorScaleOrDataBarOrIconSetRule(o);break;case Asc.c_oAscCFType.iconSet:for(var g=s?new Asc.asc_CIconSet:e.asc_getColorScaleOrDataBarOrIconSetRule(),a=(g.asc_setShowValue("checked"!==this.chIconShow.getValue()),g.asc_setReverse(!!this.iconsProps.isReverse),g.asc_setIconSet(this.iconsProps.iconsSet),this.iconsControls),b=this.iconsProps.iconsLength,C=this.cmbIconsPresets.getSelectedRecord()?null:[],f=[],c=0;c<b;c++){var h=a[c],S=new Asc.asc_CConditionalFormatValueObject;if(S.asc_setType(h.cmbType.getValue()),S.asc_setVal(h.value.getValue()),S.asc_setGte(h.cmbOperator.getValue()),f.push(S),C)if(h.itemNoIcons.isChecked())(v=new Asc.asc_CConditionalFormatIconSet).asc_setIconSet(Asc.EIconSetType.NoIcons),v.asc_setIconId(0),this.iconsProps.isReverse?C.unshift(v):C.push(v);else for(var v=h.pickerIcons.getSelectedRec().get("value")+1,w=0;w<this.collectionPresets.length;w++){for(var _=this.collectionPresets.at(w).get("icons"),x=0;x<_.length;x++)if(v==_[x]){(v=new Asc.asc_CConditionalFormatIconSet).asc_setIconSet(w),v.asc_setIconId(x),this.iconsProps.isReverse?C.unshift(v):C.push(v);break}if("object"==typeof v)break}}g.asc_setCFVOs(f),g.asc_setIconSets(C),e.asc_setColorScaleOrDataBarOrIconSetRule(g)}}return e},refreshRules:function(t,e){var i,s=this.ruleStore.findWhere({index:t});if(s&&(o=s.get("rules"),i=[],o&&o.each(function(t,e){i.push({value:void 0!==t.get("type")?t.get("type"):t.get("subtype"),displayValue:t.get("name")})}),this.cmbRule.setData(i),0<i.length&&this.cmbRule.setValue(void 0!==e?e:i[0].value)),this.setControls(t,this.cmbRule.getValue()),this.setHeight(9==t?445:355),s){var o=s.get("type");if(this._changedProps=new Asc.asc_CConditionalFormattingRule,this._changedProps.asc_setType(o),o==Asc.c_oAscCFType.containsText||o==Asc.c_oAscCFType.containsBlanks||o==Asc.c_oAscCFType.duplicateValues||o==Asc.c_oAscCFType.timePeriod||o==Asc.c_oAscCFType.aboveAverage||o==Asc.c_oAscCFType.top10||o==Asc.c_oAscCFType.cellIs||o==Asc.c_oAscCFType.expression)!this.xfsFormat&&null!==this.xfsFormat||this._changedProps.asc_setDxf(this.xfsFormat);else if(o==Asc.c_oAscCFType.colorScale){for(var n=2==s.get("num")?[this.scaleControls[0],this.scaleControls[2]]:this.scaleControls,a=[],l=[],r=0;r<n.length;r++){var c=new Asc.asc_CConditionalFormatValueObject,d=n[r];c.asc_setType(d.combo.getValue()),c.asc_setVal(d.range.getValue()),l.push(c),a.push(Common.Utils.ThemeColor.getRgbColor(d.colorPicker.currentColor))}this.scaleProps=new Asc.asc_CColorScale,this.scaleProps.asc_setColors(a),this.scaleProps.asc_setCFVOs(l),this._changedProps.asc_setColorScaleOrDataBarOrIconSetRule(this.scaleProps)}else o==Asc.c_oAscCFType.dataBar&&(this.barProps=new Asc.asc_CDataBar,this.barProps.asc_setInterfaceDefault(),this.barProps.asc_setGradient(this.cmbFill.getValue()),this.barProps.asc_setColor(Common.Utils.ThemeColor.getRgbColor(this.btnPosFill.colorPicker.currentColor)),!this.cmbBorder.getValue()?this.barProps.asc_setBorderColor(Common.Utils.ThemeColor.getRgbColor(this.btnPosBorder.colorPicker.currentColor)):this.barProps.asc_setBorderColor(null),this.barProps.asc_setDirection(this.cmbBarDirection.getValue()),this._changedProps.asc_setColorScaleOrDataBarOrIconSetRule(this.barProps));this.previewFormat()}},setControls:function(t,e){var i;this.$window.find(".hasformat").toggleClass("hidden",7<=t&&t<=10),this.cmbRule.setVisible(t<7),this.txtRange1.setVisible(0==t||3==t||11==t),this.txtRange2.setVisible(0==t&&(e==Asc.c_oAscCFOperator.between||e==Asc.c_oAscCFOperator.notBetween)),this.cmbPercent.setVisible(1==t),this.numRank.setVisible(1==t),this.txtRange1.cmpEl.width(11==t?310:150),7!=t&&8!=t||(this.renderScalesPanel(),this.scaleControls[1].combo.setVisible(8==t),this.scaleControls[1].range.setVisible(8==t),this.scaleControls[1].color.setVisible(8==t),this.lblMidScale.toggleClass("hidden",7==t)),this.$window.find(".scale").toggleClass("hidden",t<7||8<t),9==t&&this.renderDataBarPanel(),10==t&&this.renderIconsPanel(),this.$window.find(".databar").toggleClass("hidden",9!==t),this.$window.find(".iconset").toggleClass("hidden",10!==t),t<7?i=this.cmbRule:7==t||8==t?i=this.scaleControls[0].combo:9==t?i=this.barControls[0].combo:10==t&&(i=this.iconsControls[this.iconsControls.length-1].cmbOperator),i&&_.delay(function(){i.focus()},50)},onSelectData:function(i){var t,e,s=this;s.api&&(t=new SSE.Views.CellRangeDialog({handler:function(t,e){"ok"==e&&(i.setValue(t.getSettings()),i.checkValidate())}}).on("close",function(){s.show()}),e=s.$window.offset(),s.hide(),t.show(e.left+160,e.top+125),t.setSettings({api:s.api,range:_.isEmpty(i.getValue())||1!=i.checkValidate()?"":i.getValue(),type:Asc.c_oAscSelectionDialogType.ConditionalFormattingRule,validation:function(){return!0}}))},onFormatsSelect:function(t,e){var i,s,o=new Asc.asc_CellXfs,e=e.options.presetSettings;e&&e.fontColor&&o.asc_setFontColor(Common.Utils.ThemeColor.getRgbColor(e.fontColor)),e&&e.fillColor&&o.asc_setFillColor(Common.Utils.ThemeColor.getRgbColor(e.fillColor)),e&&e.borderColor&&(i=[],s=Asc.c_oAscBorderStyles.Thin,e=Common.Utils.ThemeColor.getRgbColor(e.borderColor),i[Asc.c_oAscBorderOptions.Left]=new Asc.asc_CBorder(s,e),i[Asc.c_oAscBorderOptions.Top]=new Asc.asc_CBorder(s,e),i[Asc.c_oAscBorderOptions.Right]=new Asc.asc_CBorder(s,e),i[Asc.c_oAscBorderOptions.Bottom]=new Asc.asc_CBorder(s,e),o.asc_setBorder(i)),this.xfsFormat=o,this._changedProps&&this._changedProps.asc_setDxf(o),this.fillXfsFormatInfo(o),this.previewFormat()},clearFormat:function(){this.xfsFormat=null,this._changedProps&&this._changedProps.asc_setDxf(null),this.fillXfsFormatInfo(new Asc.asc_CellXfs),this.previewFormat()},onBoldClick:function(){this.xfsFormat||(this.xfsFormat=new Asc.asc_CellXfs),this.xfsFormat.asc_setFontBold(this.btnBold.isActive()),this.previewFormat()},onItalicClick:function(){this.xfsFormat||(this.xfsFormat=new Asc.asc_CellXfs),this.xfsFormat.asc_setFontItalic(this.btnItalic.isActive()),this.previewFormat()},onUnderlineClick:function(){this.xfsFormat||(this.xfsFormat=new Asc.asc_CellXfs),this.xfsFormat.asc_setFontUnderline(this.btnUnderline.isActive()),this.previewFormat()},onStrikeoutClick:function(){this.xfsFormat||(this.xfsFormat=new Asc.asc_CellXfs),this.xfsFormat.asc_setFontStrikeout(this.btnStrikeout.isActive()),this.previewFormat()},onBordersWidth:function(t,e,i){i&&(this.btnBorders.options.borderswidth=e.value)},onBordersColor:function(t,e){$("#format-rules-borders-border-color .menu-item-icon").css("border-color","#"+("object"==typeof e?e.color:e)),this.mnuBorderColor.onUnHoverItem(),this.btnBorders.options.borderscolor=Common.Utils.ThemeColor.getRgbColor(e)},onBorders:function(e){var i;_.each(e.menu.items,function(t){if(e.options.borderId==t.options.borderId)return i=t,!1}),i&&this.onBordersMenu(e.menu,i)},onBordersMenu:function(t,e){var i,s,o,n;_.isUndefined(e.options.borderId)||(s=[],o=(i=this.btnBorders).options.borderswidth,n=i.options.borderscolor,i.rendered&&(i.$icon.removeClass(i.options.icls).addClass(e.options.icls),i.options.icls=e.options.icls),i.options.borderId=e.options.borderId,"inner"==e.options.borderId?(s[Asc.c_oAscBorderOptions.InnerV]=new Asc.asc_CBorder(o,n),s[Asc.c_oAscBorderOptions.InnerH]=new Asc.asc_CBorder(o,n)):"all"==e.options.borderId?(s[Asc.c_oAscBorderOptions.InnerV]=new Asc.asc_CBorder(o,n),s[Asc.c_oAscBorderOptions.InnerH]=new Asc.asc_CBorder(o,n),s[Asc.c_oAscBorderOptions.Left]=new Asc.asc_CBorder(o,n),s[Asc.c_oAscBorderOptions.Top]=new Asc.asc_CBorder(o,n),s[Asc.c_oAscBorderOptions.Right]=new Asc.asc_CBorder(o,n),s[Asc.c_oAscBorderOptions.Bottom]=new Asc.asc_CBorder(o,n)):"outer"==e.options.borderId?(s[Asc.c_oAscBorderOptions.Left]=new Asc.asc_CBorder(o,n),s[Asc.c_oAscBorderOptions.Top]=new Asc.asc_CBorder(o,n),s[Asc.c_oAscBorderOptions.Right]=new Asc.asc_CBorder(o,n),s[Asc.c_oAscBorderOptions.Bottom]=new Asc.asc_CBorder(o,n)):"none"!=e.options.borderId&&(s[e.options.borderId]=new Asc.asc_CBorder(o,n)),this.xfsFormat||(this.xfsFormat=new Asc.asc_CellXfs),this.xfsFormat.asc_setBorder(s),this.previewFormat())},onFormatTextColorSelect:function(t,e,i){this.btnTextColor.currentColor=e,this.mnuTextColorPicker.currentColor=e,this.xfsFormat||(this.xfsFormat=new Asc.asc_CellXfs),this.xfsFormat.asc_setFontColor(Common.Utils.ThemeColor.getRgbColor(this.mnuTextColorPicker.currentColor)),this.previewFormat()},onFormatFillColorSelect:function(t,e,i){this.btnFillColor.currentColor=e,this.mnuFillColorPicker.currentColor=e,this.xfsFormat||(this.xfsFormat=new Asc.asc_CellXfs),this.xfsFormat.asc_setFillColor("transparent"==this.mnuFillColorPicker.currentColor?null:Common.Utils.ThemeColor.getRgbColor(this.mnuFillColorPicker.currentColor)),this.previewFormat()},onNumberFormatSelect:function(t,e){this.xfsFormat||(this.xfsFormat=new Asc.asc_CellXfs),this.xfsFormat.asc_setNumFormatInfo(e.format),this.previewFormat()},previewFormat:function(){var t;this._changedProps&&((t=this._changedProps.asc_getType())==Asc.c_oAscCFType.containsText||t==Asc.c_oAscCFType.notContainsText||t==Asc.c_oAscCFType.beginsWith||t==Asc.c_oAscCFType.endsWith||t==Asc.c_oAscCFType.containsBlanks||t==Asc.c_oAscCFType.notContainsBlanks||t==Asc.c_oAscCFType.duplicateValues||t==Asc.c_oAscCFType.uniqueValues||t==Asc.c_oAscCFType.containsErrors||t==Asc.c_oAscCFType.notContainsErrors||t==Asc.c_oAscCFType.timePeriod||t==Asc.c_oAscCFType.aboveAverage||t==Asc.c_oAscCFType.top10||t==Asc.c_oAscCFType.cellIs||t==Asc.c_oAscCFType.expression?(this.xfsFormat&&!this._changedProps.asc_getDxf()&&this._changedProps.asc_setDxf(this.xfsFormat),this._changedProps.asc_getPreview("format-rules-edit-preview-format",this.xfsFormat?Common.define.conditionalData.exampleText:Common.define.conditionalData.noFormatText)):t==Asc.c_oAscCFType.colorScale?this._changedProps.asc_getPreview("format-rules-edit-preview-scale",""):t==Asc.c_oAscCFType.dataBar&&this._changedProps.asc_getPreview("format-rules-edit-preview-databar",""))},updateThemeColors:function(){if(this.panels.scale.rendered&&!this.panels.scale.initColors){for(var t=0;t<this.scaleControls.length;t++){var e=this.scaleControls[t].color,i=(e.setMenu(),e.getPicker());i.options.type=t,i.updateColors(Common.Utils.ThemeColor.getEffectColors(),Common.Utils.ThemeColor.getStandartColors()),i.currentColor=0==t?"FFC000":1==t?"FFFF00":"92D050",i.select(i.currentColor,!0),e.setColor(i.currentColor),this.scaleControls[t].colorPicker=i,e.on("color:select",_.bind(this.onScaleColorsSelect,this))}this.panels.scale.initColors=!0}var s;this.panels.databar.rendered&&!this.panels.databar.initColors&&((s=function(t){t.setMenu();var e=t.getPicker();e.updateColors(Common.Utils.ThemeColor.getEffectColors(),Common.Utils.ThemeColor.getStandartColors()),(t.colorPicker=e).currentColor=t.color,e.select(e.currentColor,!0)})(this.btnPosFill),this.btnPosFill.on("color:select",_.bind(this.onBarColorsSelect,this,"pos")),s(this.btnNegFill),this.btnNegFill.on("color:select",_.bind(this.onBarColorsSelect,this,"")),s(this.btnPosBorder),this.btnPosBorder.on("color:select",_.bind(this.onBarColorsSelect,this,"pos-border")),s(this.btnNegBorder),this.btnNegBorder.on("color:select",_.bind(this.onBarColorsSelect,this,"")),s(this.btnAxisColor),this.btnAxisColor.on("color:select",_.bind(this.onBarColorsSelect,this,"")),this.panels.databar.initColors=!0),this.panels.format.rendered&&!this.panels.format.initColors&&(this.mnuTextColorPicker.updateColors(Common.Utils.ThemeColor.getEffectColors(),Common.Utils.ThemeColor.getStandartColors()),this.mnuFillColorPicker.updateColors(Common.Utils.ThemeColor.getEffectColors(),Common.Utils.ThemeColor.getStandartColors()),this.mnuBorderColorPicker.updateColors(Common.Utils.ThemeColor.getEffectColors(),Common.Utils.ThemeColor.getStandartColors()),this.panels.format.initColors=!0)},onScaleColorsSelect:function(t,e){t.colorPicker.currentColor=e,this.scaleProps&&((e=this.scaleProps.asc_getColors())[Math.min(t.options.type,e.length-1)]=Common.Utils.ThemeColor.getRgbColor(t.colorPicker.currentColor),this.scaleProps.asc_setColors(e),this.previewFormat())},onBarColorsSelect:function(t,e,i){e.colorPicker.currentColor=i,!this.barProps||"pos"!=t&&"pos-border"!=t||("pos"==t?this.barProps.asc_setColor(Common.Utils.ThemeColor.getRgbColor(i)):this.barProps.asc_setBorderColor(Common.Utils.ThemeColor.getRgbColor(i)),this.previewFormat())},setDefComboValue:function(t,e,i){var s=this.cmbCategory.getValue(),o="";switch(e){case Asc.c_oAscCfvoType.Number:o=0;break;case Asc.c_oAscCfvoType.Percent:o=0==t?0:1==t&&8==s?50:100;break;case Asc.c_oAscCfvoType.Percentile:o=0==t?10:1==t&&8==s?50:90}i.setValue(o)},fillIconsControls:function(t,e,i){var s=this,o=(this.iconsProps.iconsSet=t,this.iconsProps.iconsLength=e.length,this.$window.find(".icons-5").toggleClass("hidden",this.iconsProps.iconsLength<5),this.$window.find(".icons-4").toggleClass("hidden",this.iconsProps.iconsLength<4),this.iconsControls);o.length<this.iconsProps.iconsLength&&this.addNewIconsLine(),o.length<this.iconsProps.iconsLength&&this.addNewIconsLine();for(var n=0;n<e.length;n++)(c=o[n]).cmbType.setValue(e[n].asc_getType()),c.value.setValue(e[n].asc_getVal()||""),c.cmbOperator.setValue(e[n].asc_getGte());for(var a=[],l=(i&&0<i.length?(this.cmbIconsPresets.setValue(this.textCustom),_.each(i,function(t){t.asc_getIconSet()==Asc.EIconSetType.NoIcons?a.push(-1):a.push(s.collectionPresets.at(t.asc_getIconSet()).get("icons")[t.asc_getIconId()])})):(this.cmbIconsPresets.setValue(t),a=s.collectionPresets.at(t).get("icons")),this.iconsProps.isReverse),r=a.length,n=0;n<a.length;n++){var c=o[l?r-n-1:n],d=-1==a[n]?null:c.pickerIcons.store.findWhere({value:a[n]-1});d?c.pickerIcons.selectRecord(d,!0):c.pickerIcons.deselectAll(!0),c.itemNoIcons.setChecked(!d,!0),this.selectIconItem(c.cmbIcons,d)}this.fillIconsLabels()},fillIconsLabels:function(){var t=this.iconsControls,e=this.iconsProps.iconsLength,i=new RegExp("^s*[0-9]+[,.]?[0-9]*s*$"),s=t[1].value.getValue();t[0].label.text(Common.Utils.String.format(this.textIconLabelFirst,t[1].cmbOperator.getSelectedRecord().prevOp,i.test(s)?parseFloat(s):this.textFormula));for(var o=1;o<e-1;o++)s=t[o+1].value.getValue(),t[o].label.text(Common.Utils.String.format(this.textIconLabel,t[o+1].cmbOperator.getSelectedRecord().prevOp,i.test(s)?parseFloat(s):this.textFormula));t[e-1].label.text(this.textIconLabelLast)},reverseIconsControls:function(){for(var t=this.iconsControls,e=this.iconsProps.iconsLength,i=0;i<e/2;i++){var s=t[i],o=t[e-i-1],n=s.itemNoIcons.isChecked()?-1:s.pickerIcons.getSelectedRec().get("value"),a=o.itemNoIcons.isChecked()?-1:o.pickerIcons.getSelectedRec().get("value"),a=s.pickerIcons.store.findWhere({value:a});a?s.pickerIcons.selectRecord(a,!0):s.pickerIcons.deselectAll(!0),s.itemNoIcons.setChecked(!a,!0),this.selectIconItem(s.cmbIcons,a),(a=o.pickerIcons.store.findWhere({value:n}))?o.pickerIcons.selectRecord(a,!0):o.pickerIcons.deselectAll(!0),o.itemNoIcons.setChecked(!a,!0),this.selectIconItem(o.cmbIcons,a)}},onSelectIcon:function(t,e,i,s,o){this.selectIconItem(t,o),e.setChecked(!1,!0),this.cmbIconsPresets.setValue(this.textCustom)},onSelectNoIcon:function(t,e,i,s){s&&(this.selectIconItem(t),e.deselectAll(!0),this.cmbIconsPresets.setValue(this.textCustom))},selectIconItem:function(t,e){t=$(t.el).find(".form-control > div");t.css("background-image",e?"url("+e.get("imgUrl")+")":""),t.text(e?"":this.txtNoCellIcon)},isRangeValid:function(){var t=this.ruleStore.findWhere({index:this.cmbCategory.getValue()});if(t){var e,i=t.get("type"),s=[];switch(i){case Asc.c_oAscCFType.containsText:case Asc.c_oAscCFType.expression:""===this.txtRange1.getValue()?e=i==Asc.c_oAscCFType.containsText?this.textEmptyText:this.textEmptyFormulaExt:n=(n=this.api.asc_isValidDataRefCf(i,[[this.txtRange1.getValue()]]))&&n[0],(n||e)&&(c=this.txtRange1);break;case Asc.c_oAscCFType.cellIs:var o=this.cmbRule.getValue();""===this.txtRange1.getValue()?(e=this.textEmptyValue,c=this.txtRange1):o!=Asc.c_oAscCFOperator.notBetween&&o!=Asc.c_oAscCFOperator.between||""!==this.txtRange2.getValue()?(s=[[this.txtRange1.getValue()]],o!=Asc.c_oAscCFOperator.notBetween&&o!=Asc.c_oAscCFOperator.between||s.push([this.txtRange2.getValue()]),(n=this.api.asc_isValidDataRefCf(i,s))&&(c=n[1]?this.txtRange2:this.txtRange1,n=n[0])):(e=this.textEmptyValue,c=this.txtRange2);break;case Asc.c_oAscCFType.top10:var n,o=!!this.cmbPercent.getValue();(n=(n=this.api.asc_isValidDataRefCf(i,[[this.numRank.getNumberValue(),o]]))&&n[0])==Asc.c_oAscError.ID.ErrorTop10Between&&(e=Common.Utils.String.format(this.textErrorTop10Between,o?0:1,o?100:1e3));break;case Asc.c_oAscCFType.colorScale:for(var a=t.get("num"),l=2==a?[this.scaleControls[0],this.scaleControls[2]]:this.scaleControls,r=0;r<a;r++)if(!l[r].range.isDisabled()&&""===l[r].range.getValue()){e=l[r].combo.getValue()==Asc.c_oAscCfvoType.Formula?this.textEmptyFormula:this.textEmptyText,c=l[r].range;break}if(!e){for(var c,r=0;r<a;r++)s.push([l[r].range.getValue(),l[r].combo.getValue()]);(n=this.api.asc_isValidDataRefCf(i,s))&&(c=l[h=n[1]].range,(n=n[0])==Asc.c_oAscError.ID.ValueMustBeGreaterThen?e=Common.Utils.String.format(this.textErrorGreater,0==h?this.textMinpoint:h==a-1?this.textMaxpoint:this.textMidpoint,h==a-1&&3==a?this.textMidpoint:this.textMinpoint):n==Asc.c_oAscError.ID.NotValidPercentage?e=Common.Utils.String.format(this.textNotValidPercentageExt,0==h?this.textMinpoint:h==a-1?this.textMaxpoint:this.textMidpoint):n==Asc.c_oAscError.ID.NotValidPercentile&&(e=Common.Utils.String.format(this.textNotValidPercentileExt,0==h?this.textMinpoint:h==a-1?this.textMaxpoint:this.textMidpoint)))}break;case Asc.c_oAscCFType.dataBar:for(var d=this.barControls,r=0;r<d.length;r++)if(!d[r].range.isDisabled()&&""===d[r].range.getValue()){e=d[r].combo.getValue()==Asc.c_oAscCfvoType.Formula?this.textEmptyFormula:this.textEmptyText,c=d[r].range;break}if(!e){for(var h,r=0;r<d.length;r++)s.push([d[r].range.getValue(),d[r].combo.getValue()]);(n=this.api.asc_isValidDataRefCf(i,s))&&(h=n[1],c=d[h].range,(n=n[0])==Asc.c_oAscError.ID.NotValidPercentage?e=Common.Utils.String.format(this.textNotValidPercentageExt,h?this.textLongBar:this.textShortBar):n==Asc.c_oAscError.ID.NotValidPercentile&&(e=Common.Utils.String.format(this.textNotValidPercentileExt,h?this.textLongBar:this.textShortBar)))}break;case Asc.c_oAscCFType.iconSet:for(var p=this.iconsControls,r=0;r<this.iconsProps.iconsLength;r++)if(!p[r].value.isDisabled()&&""===p[r].value.getValue()){e=p[r].cmbType.getValue()==Asc.c_oAscCfvoType.Formula?this.textEmptyFormula:this.textEmptyText,c=p[r].value;break}if(!e){for(r=0;r<this.iconsProps.iconsLength;r++)s.push([p[r].value.getValue(),p[r].cmbType.getValue()]);(n=this.api.asc_isValidDataRefCf(i,s))&&(c=p[n[1]].value,n=n[0])}}if(!e&&n){var m=SSE.getController("Main");switch(n){case Asc.c_oAscError.ID.NotValidPercentile:e=this.textNotValidPercentile;break;case Asc.c_oAscError.ID.NotValidPercentage:e=this.textNotValidPercentage;break;case Asc.c_oAscError.ID.CannotAddConditionalFormatting:e=this.textCannotAddCF;break;case Asc.c_oAscError.ID.NotSingleReferenceCannotUsed:e=this.textSingleRef;break;case Asc.c_oAscError.ID.CannotUseRelativeReference:e=this.textRelativeRef;break;case Asc.c_oAscError.ID.IconDataRangesOverlap:e=this.textIconsOverlap;break;case Asc.c_oAscError.ID.FrmlWrongCountParentheses:e=m.errorWrongBracketsCount;break;case Asc.c_oAscError.ID.FrmlWrongOperator:e=m.errorWrongOperator;break;case Asc.c_oAscError.ID.FrmlWrongMaxArgument:e=m.errorCountArgExceed;break;case Asc.c_oAscError.ID.FrmlWrongCountArgument:e=m.errorCountArg;break;case Asc.c_oAscError.ID.FrmlWrongFunctionName:e=m.errorFormulaName;break;case Asc.c_oAscError.ID.FrmlAnotherParsingError:e=m.errorFormulaParsing;break;case Asc.c_oAscError.ID.FrmlWrongArgumentRange:e=m.errorArgsRange;break;case Asc.c_oAscError.ID.FrmlOperandExpected:e=m.errorOperandExpected;break;case Asc.c_oAscError.ID.FrmlWrongReferences:e=m.errorFrmlWrongReferences;break;case Asc.c_oAscError.ID.FrmlMaxTextLength:e=m.errorFrmlMaxTextLength;break;case Asc.c_oAscError.ID.FrmlMaxReference:e=m.errorFrmlMaxReference;break;case Asc.c_oAscError.ID.FrmlMaxLength:e=m.errorFrmlMaxLength;break;default:e=this.textInvalid}}return e&&Common.UI.warning({msg:e,maxwidth:600,callback:function(t){c&&c.focus()}}),!e}},onPrimary:function(){return this.onDlgBtnClick("ok"),!1},onDlgBtnClick:function(t){t="object"==typeof t?t.currentTarget.attributes.result.value:t;if("ok"==t){if(!this.isRangeValid())return;this.handler&&this.handler.call(this,t,"ok"==t?this.getSettings():void 0)}this.close()}},SSE.Views.FormatRulesEditDlg||{}))}),define("spreadsheeteditor/main/app/view/FormatRulesManagerDlg",["text!spreadsheeteditor/main/app/template/FormatRulesManagerDlg.template","common/main/lib/view/AdvancedSettingsWindow","common/main/lib/component/ComboBox","common/main/lib/component/ListView","common/main/lib/component/InputField","spreadsheeteditor/main/app/view/FormatRulesEditDlg"],function(e){"use strict";SSE.Views=SSE.Views||{};var s=Common.UI.DataViewItem.extend({initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);var i=this;i.template=i.options.template||i.template,i.listenTo(i.model,"change:name",function(){i.render(),i.trigger("change",i,i.model)}),i.listenTo(i.model,"change:lock",function(){i.render(),i.trigger("change",i,i.model)}),i.listenTo(i.model,"change:tip",function(){var t=i.$el||$(i.el),e=t.data("bs.tooltip");e&&(e=e.options.zIndex,t.removeData("bs.tooltip"),t.tooltip({title:i.model.get("tip"),placement:"cursor",zIndex:e}))}),i.listenTo(i.model,"change:selected",function(){(i.$el||$(i.el)).toggleClass("selected",i.model.get("selected")&&i.model.get("allowSelected")),i.onSelectChange(i.model,i.model.get("selected")&&i.model.get("allowSelected"))}),i.listenTo(i.model,"remove",i.remove)}});SSE.Views.FormatRulesManagerDlg=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{alias:"FormatRulesManagerDlg",contentWidth:560,height:340,buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:this.txtTitle,template:['<div class="box" style="height:'+(this.options.height-85)+'px;">','<div class="content-panel" style="padding: 0;">'+_.template(e)({scope:this})+"</div>","</div>"].join("")},t),this.api=t.api,this.handler=t.handler,this.props=t.props,this.langId=t.langId,this.rules=[],this.rulesStores={},this.rulesDeleted=[],this.listSettings={data:[],start:0,end:0,min:0,max:0},this.locked=t.locked||!1,this.userTooltip=!0,this.wrapEvents={onLockCFManager:_.bind(this.onLockCFManager,this),onUnLockCFManager:_.bind(this.onUnLockCFManager,this),onLockCFRule:_.bind(this.onLockCFRule,this),onUnLockCFRule:_.bind(this.onUnLockCFRule,this)},this.nLastScroll=-1e3,this.itemHeight=30,this.previewListHeight=203,this.maxItemsCount=parseInt(this.previewListHeight/this.itemHeight),this._keydowncounter=0,this._keydownTimer=void 0,Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var i=this;this.cmbScope=new Common.UI.ComboBox({el:$("#format-manager-combo-scope"),menuStyle:"min-width: 100%;max-height: 211px;",editable:!1,cls:"input-group-nr",data:[],takeFocusOnClose:!0}).on("selected",function(t,e){i.refreshRuleList(e)}),this.rulesList=new Common.UI.ListView({el:$("#id-preview-data",this.$window),store:new Common.UI.DataViewStore,emptyText:"",headers:[{name:this.textRules,width:198},{name:this.textApply,width:196},{name:this.textFormat,width:130}],isRTL:!0,template:_.template(['<div class="listview inner" style=""></div>'].join("")),itemTemplate:_.template(['<div class="list-item" style="width: 100%;display:inline-block;" id="format-manager-item-<%= ruleIndex %>">','<div style="width:197px;padding-<% if (Common.UI.isRTL()) { %>left<% } else {%>right<% } %>: 10px;display: inline-block;vertical-align: middle;overflow: hidden; text-overflow: ellipsis; white-space: nowrap;"><%= name %></div>','<div style="width:197px;padding-<% if (Common.UI.isRTL()) { %>left<% } else {%>right<% } %>: 10px;display: inline-block;vertical-align: middle;"><div id="format-manager-txt-rule-<%= ruleIndex %>" style=""></div></div>','<div style="width:128px;display: inline-block;vertical-align: middle;"><div id="format-manager-item-preview-<%= ruleIndex %>" style="height:22px;background-color: #ffffff;"></div></div>',"<% if (lock) { %>",'<div class="lock-user"><%=lockuser%></div>',"<% } %>","</div>"].join("")),allowScrollbar:!1,tabindex:1}),this.rulesList.moveKeys=[],this.rulesList.createNewItem=function(t){return new s({template:this.itemTemplate,model:t})},this.rulesList.on("item:select",_.bind(this.onSelectRule,this)).on("item:keydown",_.bind(this.onKeyDown,this)).on("item:keyup",_.bind(this.onKeyUp,this)),this.btnNew=new Common.UI.Button({el:$("#format-manager-btn-new")}),this.btnNew.on("click",_.bind(this.onEditRule,this,!1)),this.btnEdit=new Common.UI.Button({el:$("#format-manager-btn-edit")}),this.btnEdit.on("click",_.bind(this.onEditRule,this,!0)),this.btnDelete=new Common.UI.Button({el:$("#format-manager-btn-delete")}),this.btnDelete.on("click",_.bind(this.onDeleteRule,this)),this.btnUp=new Common.UI.Button({parentEl:$("#format-manager-btn-up"),cls:"btn-toolbar bg-white",iconCls:"caret-up",scaling:!1,hint:this.textUp}),this.btnUp.on("click",_.bind(this.onMoveClick,this,!0)),this.btnDown=new Common.UI.Button({parentEl:$("#format-manager-btn-down"),cls:"btn-toolbar bg-white",iconCls:"caret-down",scaling:!1,hint:this.textDown}),this.btnDown.on("click",_.bind(this.onMoveClick,this,!1)),this.previewPanel=this.$window.find("#id-preview-data"),this.previewParent=this.previewPanel.parent(),this.previewScrolled=this.$window.find("#id-preview"),this.previewInner=this.previewScrolled.find("> div:first-child"),this.previewPanel.css("height",this.previewListHeight+"px"),this.previewScrolled.css("height",this.previewListHeight+"px"),this.afterRender()},getDefaultFocusableComponent:function(){return this.cmbScope},afterRender:function(){this._setDefaults(this.props)},_setDefaults:function(t){Common.UI.FocusManager.add(this,this.cmbScope),Common.UI.FocusManager.add(this,this.btnNew),Common.UI.FocusManager.add(this,this.btnEdit),Common.UI.FocusManager.add(this,this.btnUp),Common.UI.FocusManager.add(this,this.btnDown),Common.UI.FocusManager.add(this,this.btnDelete),Common.UI.FocusManager.add(this,this.rulesList),this.rulesList.on("item:add",_.bind(this.addControls,this)),this.rulesList.on("item:change",_.bind(this.addControls,this)),this.currentSheet=this.api.asc_getActiveWorksheetIndex(),this.refreshScopeList(),this.refreshRuleList(this.cmbScope.getSelectedRecord()),this.api.asc_registerCallback("asc_onLockCFManager",this.wrapEvents.onLockCFManager),this.api.asc_registerCallback("asc_onUnLockCFManager",this.wrapEvents.onUnLockCFManager),this.api.asc_registerCallback("asc_onLockCFRule",this.wrapEvents.onLockCFRule),this.api.asc_registerCallback("asc_onUnLockCFRule",this.wrapEvents.onUnLockCFRule)},refreshScopeList:function(){this.api.asc_getWorksheetsCount();var t=[{value:Asc.c_oAscSelectionForCFType.selection,displayValue:this.textSelection,sheetIndex:-1},{value:Asc.c_oAscSelectionForCFType.worksheet,displayValue:this.textThisSheet,sheetIndex:-1},{value:Asc.c_oAscSelectionForCFType.table,displayValue:this.textThisTable,sheetIndex:-1},{value:Asc.c_oAscSelectionForCFType.pivot,displayValue:this.textThisPivot,sheetIndex:-1}];this.cmbScope.setData(t),this.cmbScope.setValue(Asc.c_oAscSelectionForCFType.selection)},refreshRuleList:function(t){this.rules=[];t=-1<t.sheetIndex?t.sheetIndex:this.currentSheet;if(!(e=this.rulesStores[t])){var e=[],i=this.api.asc_getCF(Asc.c_oAscSelectionForCFType.worksheet,t),s=i[0];if(this.currentRange=i[1],s)for(var o=0;o<s.length;o++){var n=s[o],a=this.getRuleName(n),l=n.asc_getLocation(),r=n.asc_getIsLock();e.push({ruleIndex:o,ruleId:n.asc_getId(),name:a,tip:a,range:l[1],activeSheet:l[0],priority:n.asc_getPriority(),ruleChanged:!1,props:n,lock:null!=r,lockuser:r?this.isUserVisible(r)?this.getUserName(r):this.lockText:this.guestText})}this.rulesStores[t]=e}this.nLastScroll=-1e3,this.updateRulesCount(!0),this.scrollerY||(this.scrollerY=new Common.UI.Scroller({el:this.previewScrolled,minScrollbarLength:20,wheelSpeed:20,scrollYStyle:this.rulesList.scrollYStyle,onChange:_.bind(function(){this.scrollerY&&(this._preventUpdateScroll=!0,this.onScrollEnd(),this._preventUpdateScroll=!1,this.previewParent.height(this.previewListHeight),this.previewParent.css({top:this.scrollerY.getScrollTop()}))},this)})),this.scrollerY.update(),this.scrollerY.scrollTop(0),0<this.listSettings.data.length&&(this.listSettings.current=0,this.rulesList.selectByIndex(0)),this.updateButtons()},onScrollEnd:function(){var t,e;this.scrollerY.getScrollTop()!==this.nLastScroll&&(this.nLastScroll=this.scrollerY.getScrollTop(),t=this.scrollerY.getScrollTop(),(e=(t=Math.floor(t/this.itemHeight+.5))+this.maxItemsCount-1)>this.listSettings.data.length-1&&(e=this.listSettings.data.length-1,t=Math.max(0,e-this.maxItemsCount+1)),this.previewDataBlock(t,e))},previewDataBlock:function(t,e){this.listSettings.start=t,this.listSettings.end=e;var i=this.rulesStores[this.currentSheet],s=[];this.rulesList.store.remove(this.rulesList.store.models);for(var o=t;o<=e;o++)s.push(i[this.listSettings.data[o]]);this.rulesList.store.add(s),this.listSettings.current<=this.listSettings.end&&this.rulesList.selectByIndex(this.listSettings.current-this.listSettings.start),this._preventUpdateScroll||(this.scrollerY.update({minScrollbarLength:20,wheelSpeed:20}),this.scrollerY.scrollTop(this.listSettings.start*this.itemHeight)),!0===this.userTooltip&&0<this.rulesList.cmpEl.find(".lock-user").length&&this.rulesList.cmpEl.on("mouseover",_.bind(this.onMouseOverLock,this)).on("mouseout",_.bind(this.onMouseOutLock,this))},onMouseOverLock:function(t,e,i){var s;!0===this.userTooltip&&$(t.target).hasClass("lock-user")&&(s=this,t=$(t.target).tooltip({title:this.tipIsLocked,trigger:"manual"}).data("bs.tooltip"),this.userTooltip=t.tip(),this.userTooltip.css("z-index",parseInt(this.$window.css("z-index"))+10),t.show(),setTimeout(function(){s.userTipHide()},5e3))},userTipHide:function(){"object"==typeof this.userTooltip&&(this.userTooltip.remove(),this.userTooltip=void 0,this.rulesList.cmpEl.off("mouseover").off("mouseout"))},onMouseOutLock:function(t,e,i){"object"==typeof this.userTooltip&&this.userTipHide()},getRuleName:function(t){var e="";switch(t.asc_getType()){case Asc.c_oAscCFType.aboveAverage:var e=this.textAbove,i=t.asc_getAboveAverage(),s=t.asc_getEqualAverage(),o=t.asc_getStdDev();switch(i=i?0:1,s?i+=2:o&&(i+=2+2*o),i){case 0:e=this.textAbove;break;case 1:e=this.textBelow;break;case 2:e=this.textEqAbove;break;case 3:e=this.textEqBelow;break;case 4:e=this.text1Above;break;case 5:e=this.text1Below;break;case 6:e=this.text2Above;break;case 7:e=this.text2Below;break;case 8:e=this.text3Above;break;case 9:e=this.text3Below}break;case Asc.c_oAscCFType.beginsWith:e=this.textBeginsWith+" "+(t.asc_getContainsText()||"");break;case Asc.c_oAscCFType.cellIs:switch(e=this.textCellValue,i=t.asc_getOperator()){case Asc.c_oAscCFOperator.greaterThan:e=e+" "+">"+" "+(t.asc_getValue1()||"");break;case Asc.c_oAscCFOperator.greaterThanOrEqual:e=e+" "+">="+" "+(t.asc_getValue1()||"");break;case Asc.c_oAscCFOperator.lessThan:e=e+" "+"<"+" "+(t.asc_getValue1()||"");break;case Asc.c_oAscCFOperator.lessThanOrEqual:e=e+" "+"<="+" "+(t.asc_getValue1()||"");break;case Asc.c_oAscCFOperator.equal:e=e+" "+"="+" "+(t.asc_getValue1()||"");break;case Asc.c_oAscCFOperator.notEqual:e=e+" "+"<>"+" "+(t.asc_getValue1()||"");break;case Asc.c_oAscCFOperator.between:e=e+" "+Common.Utils.String.format(this.textBetween,t.asc_getValue1()||"",t.asc_getValue2()||"");break;case Asc.c_oAscCFOperator.notBetween:e=e+" "+Common.Utils.String.format(this.textNotBetween,t.asc_getValue1()||"",t.asc_getValue2()||"")}break;case Asc.c_oAscCFType.colorScale:e=this.textColorScale;break;case Asc.c_oAscCFType.containsBlanks:e=this.textContainsBlank;break;case Asc.c_oAscCFType.containsErrors:e=this.textContainsError;break;case Asc.c_oAscCFType.containsText:e=this.textContains+" "+(t.asc_getContainsText()||"");break;case Asc.c_oAscCFType.dataBar:e=Common.define.conditionalData.textDataBar;break;case Asc.c_oAscCFType.duplicateValues:e=this.textDuplicate;break;case Asc.c_oAscCFType.expression:e=Common.define.conditionalData.textFormula+": "+(t.asc_getValue1()||"");break;case Asc.c_oAscCFType.iconSet:e=this.textIconSet;break;case Asc.c_oAscCFType.notContainsBlanks:e=this.textNotContainsBlank;break;case Asc.c_oAscCFType.notContainsErrors:e=this.textNotContainsError;break;case Asc.c_oAscCFType.notContainsText:e=this.textNotContains+" "+(t.asc_getContainsText()||"");break;case Asc.c_oAscCFType.timePeriod:switch(i=t.asc_getTimePeriod()){case Asc.c_oAscTimePeriod.yesterday:e=Common.define.conditionalData.textYesterday;break;case Asc.c_oAscTimePeriod.today:e=Common.define.conditionalData.textToday;break;case Asc.c_oAscTimePeriod.tomorrow:e=Common.define.conditionalData.textTomorrow;break;case Asc.c_oAscTimePeriod.last7Days:e=Common.define.conditionalData.textLast7days;break;case Asc.c_oAscTimePeriod.lastWeek:e=Common.define.conditionalData.textLastWeek;break;case Asc.c_oAscTimePeriod.thisWeek:e=Common.define.conditionalData.textThisWeek;break;case Asc.c_oAscTimePeriod.nextWeek:e=Common.define.conditionalData.textNextWeek;break;case Asc.c_oAscTimePeriod.lastMonth:e=Common.define.conditionalData.textLastMonth;break;case Asc.c_oAscTimePeriod.thisMonth:e=Common.define.conditionalData.textThisMonth;break;case Asc.c_oAscTimePeriod.nextMonth:e=Common.define.conditionalData.textNextMonth}break;case Asc.c_oAscCFType.top10:e=(e=t.asc_getBottom()?Common.define.conditionalData.textBottom:Common.define.conditionalData.textTop)+" "+t.asc_getRank()+(t.asc_getPercent()?"%":"");break;case Asc.c_oAscCFType.uniqueValues:e=this.textUnique;break;case Asc.c_oAscCFType.endsWith:e=this.textEnds+" "+(t.asc_getContainsText()||"")}return e},addControls:function(t,e,o){var n,i,s,a,l,r;o&&(n=this,i=o.get("ruleIndex"),s=this.rulesList.cmpEl.find("#format-manager-item-"+i),this.rules[i]||(this.rules[i]={}),a=this.rules[i],l=new Common.UI.InputFieldBtn({el:s.find("#format-manager-txt-rule-"+i),name:"range",style:"width: 100%;",btnHint:this.textSelectData,allowBlank:!0,disabled:!o.get("activeSheet")||o.get("lock"),validateOnChange:!0}).on("changed:after",function(t,e,i,s){a.dataRangeValid!==e&&(n.isRangeValid(e)?(a.dataRangeValid=e,o.set("ruleChanged",!0),o.get("props").asc_setLocation(a.dataRangeValid),o.set("range",a.dataRangeValid),n.rulesStores[n.currentSheet][o.get("indexInStore")].ruleChanged=!0,n.rulesStores[n.currentSheet][o.get("indexInStore")].range=a.dataRangeValid):a.txtDataRange.setValue(a.dataRangeValid))}).on("button:click",_.bind(this.onSelectData,this,a,o)),Common.UI.FocusManager.add(this,l),null!==(r=o.get("range"))&&l.setValue(r),a.txtDataRange=l,a.dataRangeValid=r,a.previewDiv="format-manager-item-preview-"+i,n.drawRulePreview(o),s.on("mousedown","input",function(){n.rulesList.selectRecord(o)}))},drawRulePreview:function(t){var e=t.get("props"),i=e.asc_getType(),s="";i!=Asc.c_oAscCFType.containsText&&i!=Asc.c_oAscCFType.notContainsText&&i!=Asc.c_oAscCFType.beginsWith&&i!=Asc.c_oAscCFType.endsWith&&i!=Asc.c_oAscCFType.containsBlanks&&i!=Asc.c_oAscCFType.notContainsBlanks&&i!=Asc.c_oAscCFType.duplicateValues&&i!=Asc.c_oAscCFType.uniqueValues&&i!=Asc.c_oAscCFType.containsErrors&&i!=Asc.c_oAscCFType.notContainsErrors&&i!=Asc.c_oAscCFType.timePeriod&&i!=Asc.c_oAscCFType.aboveAverage&&i!=Asc.c_oAscCFType.top10&&i!=Asc.c_oAscCFType.cellIs&&i!=Asc.c_oAscCFType.expression||(s=e.asc_getDxf()?Common.define.conditionalData.exampleText:Common.define.conditionalData.noFormatText),e.asc_getPreview(this.rules[t.get("ruleIndex")].previewDiv,s)},isRangeValid:function(t){return Asc.c_oAscError.ID.No===this.api.asc_checkDataRange(Asc.c_oAscSelectionDialogType.ConditionalFormattingRule,t,!0)},onSelectData:function(i,s){var t,e,o=this;o.api&&(t=new SSE.Views.CellRangeDialog({handler:function(t,e){"ok"==e&&(o.isRangeValid(t.getSettings())&&(i.dataRangeValid=t.getSettings(),s.set("ruleChanged",!0),s.get("props").asc_setLocation(i.dataRangeValid),s.set("range",i.dataRangeValid),o.rulesStores[o.currentSheet][s.get("indexInStore")].ruleChanged=!0,o.rulesStores[o.currentSheet][s.get("indexInStore")].range=i.dataRangeValid),i.txtDataRange.setValue(i.dataRangeValid))}}).on("close",function(){o.show()}),e=o.$window.offset(),o.hide(),t.show(e.left+160,e.top+125),t.setSettings({api:o.api,range:_.isEmpty(i.txtDataRange.getValue())?i.dataRangeValid:i.txtDataRange.getValue(),type:Asc.c_oAscSelectionDialogType.ConditionalFormattingRule,validation:function(){return!0}}))},onEditRule:function(s){var o,n=this,a=(n.$window.offset(),this.rulesList.getSelectedRec()),t=new SSE.Views.FormatRulesEditDlg({api:n.api,props:s&&a?a.get("props"):null,isEdit:s,langId:n.langId,handler:function(t,e){var i;"ok"==t&&e&&(t=n.getRuleName(e),s?((i=n.rulesStores[n.currentSheet][a.get("indexInStore")]).name=i.tip=t,i.ruleChanged=!0,i.props=e,a.set("name",t),a.set("tip",t),a.set("ruleChanged",!0),a.set("props",e),o=a):(e.asc_setLocation(n.currentRange),i=n.rulesStores[n.currentSheet],o=i.unshift({ruleIndex:n.rules.length,name:t,tip:t,range:n.currentRange,activeSheet:!0,ruleChanged:!0,priority:1,props:e,lock:!1,lockuser:""}),n.updateRulesPriority(i)))}}).on("close",function(){n.show(),s?o&&n.drawRulePreview(o):o&&(n.cmbScope.setValue(Asc.c_oAscSelectionForCFType.selection),n.refreshRuleList(n.cmbScope.getSelectedRecord()))});n.hide(),t.show()},onDeleteRule:function(){var t,e,i=this.rulesList.store,s=this.rulesList.getSelectedRec();s&&(void 0!==(t=s.get("ruleId"))&&this.rulesDeleted.push(t),this.rules[s.get("ruleIndex")]=void 0,this.rulesStores[this.currentSheet].splice(s.get("indexInStore"),1),t=i.indexOf(s),this.updateRulesCount(!0),(e=(s=this.listSettings.start)+this.maxItemsCount-1)>this.listSettings.data.length-1&&(e=this.listSettings.data.length-1,s=Math.max(0,e-this.maxItemsCount+1)),this.previewDataBlock(s,e),0<this.listSettings.data.length&&this.rulesList.selectByIndex(Math.min(t,i.length-1))),this.updateButtons()},onMoveClick:function(t){var e,i,s,o,n=this.rulesStores[this.currentSheet],a=this.rulesList.getSelectedRec(),l=this.rulesList.store.indexOf(a);a&&(e=a.get("indexInStore"),s=(i=n[o=t?this.getPrevRuleIndex(e):this.getNextRuleIndex(e)]).priority,a=n[e],i.priority=a.priority,a.priority=s,n.splice(o,1,a),n.splice(e,1,i),(o=(s=0===l&&t?this.listSettings.start-1:!t&&l>=this.maxItemsCount-1?this.listSettings.start+1:this.listSettings.start)+this.maxItemsCount-1)>this.listSettings.data.length-1&&(o=this.listSettings.data.length-1,s=Math.max(0,o-this.maxItemsCount+1)),t?this.listSettings.current--:this.listSettings.current++,this.updateRulesCount(),this.previewDataBlock(s,o)),this.updateMoveButtons()},onSelectRule:function(t,e,i){t=_.indexOf(t.store.models,i);this.listSettings.current=this.listSettings.start+t,this.userTipHide(),this.updateButtons()},updateButtons:function(){var t=this.rulesList.getSelectedRec(),t=!!t&&t.get("lock");this.btnNew.setDisabled(this.locked),this.btnDelete.setDisabled(this.listSettings.data.length<1||t),this.btnEdit.setDisabled(this.listSettings.data.length<1||t),this.updateMoveButtons()},updateMoveButtons:function(){var t=this.rulesList.getSelectedRec(),t=t?this.rulesList.store.indexOf(t):-1;this.btnUp.setDisabled(t+this.listSettings.start<1||this.locked),this.btnDown.setDisabled(t<0||t+this.listSettings.start>=this.listSettings.data.length-1||this.locked)},getPrevRuleIndex:function(t){if(this.cmbScope.getValue()===Asc.c_oAscSelectionForCFType.worksheet)return Math.max(0,t-1);for(var e=this.rulesStores[this.currentSheet],i=t-1;i>=this.listSettings.min;i--)if("hidden"!==e[i].cls)return i;return this.listSettings.min},getNextRuleIndex:function(t){if(this.cmbScope.getValue()==Asc.c_oAscSelectionForCFType.worksheet)return Math.min(this.listSettings.data.length-1,t+1);for(var e=this.rulesStores[this.currentSheet],i=t+1;i<=this.listSettings.max;i++)if("hidden"!==e[i].cls)return i;return this.listSettings.max},updateRulesCount:function(s){var t=this.rulesStores[this.currentSheet],o=this.cmbScope.getSelectedRecord(),n=this;s&&(this.listSettings.data=[]),this.listSettings.min=-1,this.listSettings.max=0,t.forEach(function(t,e){var i=o.value!==Asc.c_oAscSelectionForCFType.worksheet&&!t.props.asc_checkScope(o.value);t.cls=i?"hidden":void 0,t.indexInStore=e,i||(s&&n.listSettings.data.push(e),n.listSettings.max=e,n.listSettings.min<0&&(n.listSettings.min=e))}),s&&this.previewInner.height(this.listSettings.data.length*this.itemHeight+this.rulesList.headerHeight)},updateRulesPriority:function(t){for(var e=1;e<t.length;e++)t[e].priority++},getSettings:function(){var t,e,i,s=[];for(t in this.rulesStores)this.rulesStores.hasOwnProperty(t)&&(e=this.rulesStores[t],i=[],e&&e.forEach(function(t){var e=t.props;t.priority!==e.asc_getPriority()&&(e.asc_setPriority(t.priority),t.ruleChanged=!0),t.ruleChanged&&i.push(e)}),0<i.length&&(s[t]=i));return{rules:s,deleted:this.rulesDeleted}},onKeyDown:function(t,e,i){var s;i.keyCode!=Common.UI.Keys.UP&&i.keyCode!=Common.UI.Keys.DOWN||(i.preventDefault(),i.stopPropagation()),0===this._keydowncounter?(this._keydowncounter++,this.onKeyEvent(t,i)):this._keyEventBusy||(this._keyEventBusy=!0,(s=this)._keydownTimer=setTimeout(function(){s.onKeyEvent(t,i,!0)},1))},onKeyUp:function(t,e){this._keydowncounter=0,this._keydownTimer&&(clearTimeout(this._keydownTimer),this._keydownTimer=void 0),this._keyEventBusy=void 0},onKeyEvent:function(t,e,i){e.keyCode!=Common.UI.Keys.DELETE||this.btnDelete.isDisabled()||/form-control/.test(e.target.className)?e.keyCode!=Common.UI.Keys.UP&&e.keyCode!=Common.UI.Keys.DOWN||(s=t.getSelectedRec(),0<=(s=_.indexOf(t.store.models,s))&&(e.keyCode==Common.UI.Keys.UP&&(0<s?(s--,this.listSettings.current--,t.selectByIndex(s)):0<this.listSettings.start&&(this.listSettings.current--,this.previewDataBlock(this.listSettings.start-1,this.listSettings.end-1))),e.keyCode==Common.UI.Keys.DOWN&&(s<t.store.length-1?(s++,this.listSettings.current++,t.selectByIndex(s)):this.listSettings.end<this.listSettings.data.length-1&&(this.listSettings.current++,this.previewDataBlock(this.listSettings.start+1,this.listSettings.end+1))))):this.onDeleteRule();var s,o=this;i&&(this._keydownTimer=setTimeout(function(){o.onKeyEvent(t,e,!0)},1))},close:function(){this.userTipHide(),this.api.asc_unregisterCallback("asc_onLockCFManager",this.wrapEvents.onLockCFManager),this.api.asc_unregisterCallback("asc_onUnLockCFManager",this.wrapEvents.onUnLockCFManager),this.api.asc_unregisterCallback("asc_onLockCFRule",this.wrapEvents.onLockCFRule),this.api.asc_unregisterCallback("asc_onUnLockCFRule",this.wrapEvents.onUnLockCFRule),this._keydownTimer&&clearTimeout(this._keydownTimer),Common.UI.Window.prototype.close.call(this)},onLockCFManager:function(t){this.currentSheet===t&&(this.locked=!0,this.updateButtons(),!0===this.userTooltip&&0<this.rulesList.cmpEl.find(".lock-user").length&&this.rulesList.cmpEl.on("mouseover",_.bind(this.onMouseOverLock,this)).on("mouseout",_.bind(this.onMouseOutLock,this)))},onUnLockCFManager:function(t){this.currentSheet===t&&(this.locked=!1,this.updateButtons())},onLockCFRule:function(t,e,i){var s;this.currentSheet===t&&(t=this.rulesStores[this.currentSheet],(s=_.findWhere(t,{ruleId:e}))&&(s.lockuser=i?this.isUserVisible(i)?this.getUserName(i):this.lockText:this.guestText,s.lock=!0),(s=this.rulesList.store.findWhere({ruleId:e}))&&(s.set("lockuser",t[s.get("indexInStore")].lockuser),s.set("lock",!0),this.updateButtons()),!0===this.userTooltip&&0<this.rulesList.cmpEl.find(".lock-user").length&&this.rulesList.cmpEl.on("mouseover",_.bind(this.onMouseOverLock,this)).on("mouseout",_.bind(this.onMouseOutLock,this)))},onUnLockCFRule:function(t,e){this.currentSheet===t&&(t=this.rulesStores[this.currentSheet],(t=_.findWhere(t,{ruleId:e}))&&(t.lockuser="",t.lock=!1),(t=this.rulesList.store.findWhere({ruleId:e}))&&(t.set("lockuser",""),t.set("lock",!1),this.updateButtons()))},getUserName:function(t){var e=SSE.getCollection("Common.Collections.Users");if(e){e=e.findUser(t);if(e)return AscCommon.UserInfoParser.getParsedName(e.get("username"))}return this.guestText},isUserVisible:function(t){var e=SSE.getCollection("Common.Collections.Users");if(e){e=e.findUser(t);if(e)return!e.get("hidden")}return!0}},SSE.Views.FormatRulesManagerDlg||{}))}),define("spreadsheeteditor/main/app/view/SlicerAddDialog",["common/main/lib/component/Window","common/main/lib/component/ListView"],function(){"use strict";SSE.Views.SlicerAddDialog=Common.UI.Window.extend(_.extend({options:{width:250,style:"min-width: 230px;",cls:"modal-dlg",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:this.txtTitle},t||{}),this.template=['<div class="box" style="height: 195px;">','<div class="input-row">','<label class="font-weight-bold">'+this.textColumns+"</label>","</div>",'<div id="add-slicers-dlg-columns" class="" style="width: 100%; height: 162px; overflow: hidden;"></div>',"</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),this.props=this.options.props,this.handler=this.options.handler,Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this),this.columnsList=new Common.UI.ListView({el:$("#add-slicers-dlg-columns",this.$window),store:new Common.UI.DataViewStore,simpleAddMode:!0,scrollAlwaysVisible:!0,template:_.template(['<div class="listview inner" style=""></div>'].join("")),itemTemplate:_.template(["<div>",'<label class="checkbox-indeterminate" style="position:absolute;">','<input id="rdcheckbox-<%= id %>" type="checkbox" class="button__checkbox">','<label for="rdcheckbox-<%= id %>" class="checkbox__shape" ></label>',"</label>",'<div id="<%= id %>" class="list-item margin-left-20" style="pointer-events:none; display: flex;">','<div style="flex-grow: 1;"><%= Common.Utils.String.htmlEncode(value) %></div>',"</div>","</div>"].join(""))}),this.columnsList.on({"item:change":this.onItemChanged.bind(this),"item:add":this.onItemChanged.bind(this),"item:select":this.onCellCheck.bind(this)}),this.columnsList.onKeyDown=_.bind(this.onListKeyDown,this),this.columnsList.on("entervalue",_.bind(this.onPrimary,this)),this.$window.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.afterRender()},updateColumnsList:function(t){var i=[];t&&0<t.length&&(this.props.forEach(function(t,e){i.push(new Common.UI.DataViewModel({id:e,selected:!1,allowSelected:!0,value:t,check:!1}))}),this.columnsList.store.reset(i),this.columnsList.scroller.update({minScrollbarLength:this.columnsList.minScrollbarLength,alwaysVisibleY:!0,suppressScrollX:!0}))},onItemChanged:function(t,e){var i=e.model.get("check");"indeterminate"==i?$("input[type=checkbox]",e.$el).prop("indeterminate",!0):$("input[type=checkbox]",e.$el).prop({checked:i,indeterminate:!1})},onCellCheck:function(t,e,i){var s,o,n,a,l;this.checkCellTrigerBlock||(l="",s=!1,n=null,(o=window.event||window._event)&&((l=$(o.currentTarget).find(".list-item")).length&&(n=l.get(0).getBoundingClientRect(),l=o.clientX*Common.Utils.zoom(),a=o.clientY*Common.Utils.zoom(),n.left<l&&l<n.right&&n.top<a&&a<n.bottom&&(s=!0)),(s||o.target.className.match("checkbox")&&"input"!==o.target.localName)&&(this.updateCellCheck(t,i),_.delay(function(){t.focus()},100,this))))},onListKeyDown:function(t,e){var i=this.columnsList;i.disabled||((e=_.isUndefined(void 0)?t:e).keyCode==Common.UI.Keys.SPACE?(e.preventDefault(),e.stopPropagation(),this.updateCellCheck(i,i.getSelectedRec())):Common.UI.DataView.prototype.onKeyDown.call(this.columnsList,t,e))},updateCellCheck:function(t,e){e&&t&&e.set("check",!e.get("check"))},afterRender:function(){this._setDefaults(this.props)},_setDefaults:function(t){t&&this.updateColumnsList(t);var e=this;_.delay(function(){e.columnsList.focus()},100,this)},getSettings:function(){var t=this.columnsList.store,i=[];return t.each(function(t,e){t.get("check")&&i.push(t.get("value"))}),i},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onDblClickFormat:function(){this._handleInput("ok")},onPrimary:function(t){return this._handleInput("ok"),!1},_handleInput:function(t){this.options.handler&&this.options.handler.call(this,t,"ok"==t?this.getSettings():this.props),this.close()},txtTitle:"Insert Slicers",textColumns:"Columns"},SSE.Views.SlicerAddDialog||{}))}),define("spreadsheeteditor/main/app/view/AdvancedSeparatorDialog",["common/main/lib/component/Window","common/main/lib/component/InputField"],function(){"use strict";SSE.Views.AdvancedSeparatorDialog=Common.UI.Window.extend(_.extend({options:{width:330,cls:"modal-dlg",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:this.textTitle},t||{}),this.template=['<div class="box">','<div class="input-row" style="margin-bottom: 8px;">',"<label>"+this.textLabel+"</label>","</div>",'<div style="margin-bottom: 12px;">','<div id="id-adv-separator-decimal" class=""></div><label class="input-row margin-left-10" style="padding-top: 4px;">'+this.strDecimalSeparator+"</label>","</div>",'<div style="margin-bottom: 10px;">','<div id="id-adv-separator-thousands" class=""></div><label class="input-row margin-left-10" style="padding-top: 4px;">'+this.strThousandsSeparator+"</label>","</div>",'<div class="input-row" style="margin-bottom: 8px;">',"<label>"+this.textQualifier+"</label>","</div>",'<div style="margin-bottom: 12px;">','<div id="id-adv-separator-qualifier" class="input-group-nr"></div>',"</div>","</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),this.props=t.props,Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this),this.inputDecimalSeparator=new Common.UI.InputField({el:$("#id-adv-separator-decimal"),style:"width: 35px;",maxLength:1,validateOnBlur:!1}),this.inputThousandsSeparator=new Common.UI.InputField({el:$("#id-adv-separator-thousands"),style:"width: 35px;",maxLength:1,validateOnBlur:!1}),this.cmbQualifier=new Common.UI.ComboBox({el:$("#id-adv-separator-qualifier"),style:"width: 100px;",menuStyle:"min-width: 100px;",cls:"input-group-nr",data:[{value:'"',displayValue:'"'},{value:"'",displayValue:"'"},{value:null,displayValue:this.txtNone}],editable:!1,takeFocusOnClose:!0}),this.getChild().find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.afterRender()},getFocusedComponents:function(){return[this.inputDecimalSeparator,this.inputThousandsSeparator,this.cmbQualifier]},getDefaultFocusableComponent:function(){return this.inputDecimalSeparator},afterRender:function(){this._setDefaults(this.props)},_setDefaults:function(t){t&&(this.inputDecimalSeparator.setValue(t.decimal||""),this.inputThousandsSeparator.setValue(t.thousands||""),this.cmbQualifier.setValue(t.qualifier||null))},onPrimary:function(t){return this._handleInput("ok"),!1},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},_handleInput:function(t){this.options.handler&&this.options.handler.call(this,t,{decimal:this.inputDecimalSeparator.getValue(),thousands:this.inputThousandsSeparator.getValue(),qualifier:this.cmbQualifier.getValue()}),this.close()}},SSE.Views.AdvancedSeparatorDialog||{}))}),define("spreadsheeteditor/main/app/view/CreateSparklineDialog",["common/main/lib/util/utils","common/main/lib/component/InputField","common/main/lib/view/AdvancedSettingsWindow"],function(){"use strict";SSE.Views.CreateSparklineDialog=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:310,height:195},initialize:function(i){_.extend(this.options,{title:this.textTitle,template:['<div class="box" style="height:'+(this.options.height-85)+'px;">','<div class="content-panel" style="padding: 0 10px;"><div class="inner-content">','<div class="settings-panel active">','<table cols="1" style="width: 100%;">',"<tr>",'<td style="padding-bottom: 2px;">','<label class="input-label">'+this.textDataRange+"</label>","</td>","</tr>","<tr>",'<td class="padding-large">','<div id="create-spark-input-source" class="input-row" style=""></div>',"</td>","</tr>","<tr>","<td>",'<label class="input-label">'+this.textDestination+"</label>","</td>","</tr>","<tr>","<td>",'<div id="create-spark-input-dest" class="input-row" style=""></div>',"</td>","</tr>","</table>","</div></div>","</div>","</div>"].join("")},i),this.api=i.api,this.props=i.props,this.options.handler=function(t,e){if("ok"==t&&!this.isRangeValid())return!0;i.handler&&i.handler.call(this,t,e)},this.dataSourceValid="",this.dataDestValid="",Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);this.txtSourceRange=new Common.UI.InputFieldBtn({el:$("#create-spark-input-source"),name:"range",style:"width: 100%;",btnHint:this.textSelectData,allowBlank:!0,validateOnChange:!0}),this.txtSourceRange.on("button:click",_.bind(this.onSelectData,this,"source")),this.txtDestRange=new Common.UI.InputFieldBtn({el:$("#create-spark-input-dest"),name:"range",style:"width: 100%;",btnHint:this.textSelectData,allowBlank:!0,validateOnChange:!0,validateOnBlur:!1}),this.txtDestRange.on("button:click",_.bind(this.onSelectData,this,"dest")),this.afterRender()},getFocusedComponents:function(){return[this.txtSourceRange,this.txtDestRange]},afterRender:function(){this._setDefaults(this.props)},_setDefaults:function(t){var e,t=t?t.selectedCells:0,i=this;0<t?(e=this.api.asc_getActiveRangeStr(Asc.referenceType.R),this.txtSourceRange.setValue(e),this.dataSourceValid=e,setTimeout(function(){i.txtDestRange.focus()},100)):(e=this.api.asc_getActiveRangeStr(Asc.referenceType.A),this.txtDestRange.setValue(e),this.dataDestValid=e,setTimeout(function(){i.txtSourceRange.focus()},100)),this.txtSourceRange.validation=function(t){return i.api.asc_checkDataRange(Asc.c_oAscSelectionDialogType.Chart,t,!1)!=Asc.c_oAscError.ID.DataRangeError||i.textInvalidRange},this.txtDestRange.validation=function(t){return i.api.asc_checkDataRange(Asc.c_oAscSelectionDialogType.FormatTable,t,!1)!=Asc.c_oAscError.ID.DataRangeError||i.textInvalidRange}},getSettings:function(){return{source:this.txtSourceRange.getValue(),destination:this.txtDestRange.getValue()}},isRangeValid:function(){var t=!0,e="";return _.isEmpty(this.txtSourceRange.getValue())?(t=!1,e=this.txtEmpty):(t=(t=this.api.asc_checkDataRange(Asc.c_oAscSelectionDialogType.Chart,this.txtSourceRange.getValue()))==Asc.c_oAscError.ID.No)||(e=this.textInvalidRange),t?(_.isEmpty(this.txtDestRange.getValue())?(t=!1,e=this.txtEmpty):(t=(t=this.api.asc_checkDataRange(Asc.c_oAscSelectionDialogType.FormatTable,this.txtDestRange.getValue()))==Asc.c_oAscError.ID.No)||(e=this.textInvalidRange),t||(this.txtDestRange.showError([e]),this.txtDestRange.focus())):(this.txtSourceRange.showError([e]),this.txtSourceRange.focus()),t},onSelectData:function(i){var t,e,s=this,o="source"==i?s.txtSourceRange:s.txtDestRange;s.api&&(t=new SSE.Views.CellRangeDialog({handler:function(t,e){"ok"==e&&(e=t.getSettings(),"source"==i?s.dataSourceValid=e:s.dataDestValid=e,o.setValue(e),o.checkValidate())}}).on("close",function(){s.show(),_.delay(function(){o.focus()},1)}),e=s.$window.offset(),s.hide(),t.show(e.left+160,e.top+125),t.setSettings({api:s.api,range:_.isEmpty(o.getValue())||1!=o.checkValidate()?"source"==i?s.dataSourceValid:s.dataDestValid:o.getValue(),type:"source"==i?Asc.c_oAscSelectionDialogType.Chart:Asc.c_oAscSelectionDialogType.FormatTable}))}},SSE.Views.CreateSparklineDialog||{}))}),define("spreadsheeteditor/main/app/view/ChartTypeDialog",["common/main/lib/util/utils","common/main/lib/component/ComboBox","common/main/lib/component/ListView","common/main/lib/view/AdvancedSettingsWindow"],function(){"use strict";var s=Common.UI.DataViewItem.extend({initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);var e=this;e.template=e.options.template||e.template,e.listenTo(e.model,"change:sort",function(){e.render(),e.trigger("change",e,e.model)}),e.listenTo(e.model,"change:selected",function(){(e.$el||$(e.el)).toggleClass("selected",e.model.get("selected")&&e.model.get("allowSelected")),e.onSelectChange(e.model,e.model.get("selected")&&e.model.get("allowSelected"))}),e.listenTo(e.model,"remove",e.remove)}});SSE.Views.ChartTypeDialog=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:370,height:385},initialize:function(t){_.extend(this.options,{title:this.textTitle,template:['<div class="box" style="height:'+(this.options.height-85)+'px;">','<div class="content-panel" style="padding: 0 10px;"><div class="inner-content">','<div class="settings-panel active">','<table cols="1" style="width: 100%;">',"<tr>",'<td class="padding-large">','<label class="header">',this.textType,"</label>",'<div id="chart-type-dlg-button-type" style=""></div>',"</td>","</tr>",'<tr class="simple-chart">','<td class="padding-small">','<label class="header">',this.textStyle,"</label>",'<div id="chart-type-dlg-styles-list" class="" style="width:100%; height: 176px;"></div>',"</td>","</tr>",'<tr class="combined-chart">','<td class="padding-small">','<div id="chart-type-dlg-series-list" class="" style="width:100%; height: 203px;"></div>',"</td>","</tr>","</table>","</div></div>","</div>","</div>"].join("")},t),this.handler=t.handler,Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options),this._changedProps=null,this.api=this.options.api,this.chartSettings=this.options.chartSettings,this.currentChartType=Asc.c_oAscChartTypeSettings.barNormal,this.wrapEvents={onAddChartStylesPreview:_.bind(this.onAddChartStylesPreview,this)},this.api.asc_registerCallback("asc_onAddChartStylesPreview",this.wrapEvents.onAddChartStylesPreview)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var e=this,i=Common.define.chartData.getChartGroupData();this._arrSeriesGroups=[],i.forEach(function(t){"menu-chart-group-combo"!==t.id&&"menu-chart-group-stock"!==t.id&&e._arrSeriesGroups.push(t)}),i=Common.define.chartData.getChartData(),this._arrSeriesType=[],i.forEach(function(t){t.is3d||t.type===Asc.c_oAscChartTypeSettings.stock||t.type===Asc.c_oAscChartTypeSettings.comboBarLine||t.type===Asc.c_oAscChartTypeSettings.comboBarLineSecondary||t.type===Asc.c_oAscChartTypeSettings.comboAreaBar||t.type===Asc.c_oAscChartTypeSettings.comboCustom||e._arrSeriesType.push(t)}),this.btnChartType=new Common.UI.Button({cls:"btn-large-dataview",iconCls:"svgicon chart-bar-normal",menu:new Common.UI.Menu({style:"width: 364px;",additionalAlign:this.menuAddAlign,items:[{template:_.template('<div id="chart-type-dlg-menu-type" class="menu-insertchart"></div>')}]})}),this.btnChartType.on("render:after",function(t){e.mnuChartTypePicker=new Common.UI.DataView({el:$("#chart-type-dlg-menu-type",e.$window),parentMenu:t.menu,restoreHeight:535,groups:new Common.UI.DataViewGroupStore(Common.define.chartData.getChartGroupData()),store:new Common.UI.DataViewStore(i),itemTemplate:_.template('<div id="<%= id %>" class="item-chartlist"><svg width="40" height="40" class="icon uni-scale"><use xlink:href="#chart-<%= iconCls %>"></use></svg></div>')})}),this.btnChartType.render($("#chart-type-dlg-button-type"),this.$window),this.mnuChartTypePicker.on("item:click",_.bind(this.onSelectType,this)),this.stylesList=new Common.UI.DataView({el:$("#chart-type-dlg-styles-list",this.$window),store:new Common.UI.DataViewStore,cls:"bordered",enableKeyEvents:this.options.enableKeyEvents,itemTemplate:_.template(['<div class="style" id="<%= id %>">','<img src="<%= imageUrl %>" width="50" height="50" <% if(typeof imageUrl === "undefined" || imageUrl===null || imageUrl==="") { %> style="visibility: hidden;" <% } %>/>','<% if (typeof title !== "undefined") {%>','<span class="title"><%= title %></span>',"<% } %>","</div>"].join("")),delayRenderTips:!0}),this.stylesList.on("item:select",_.bind(this.onSelectStyles,this)),this.seriesList=new Common.UI.ListView({el:$("#chart-type-dlg-series-list",this.$window),store:new Common.UI.DataViewStore,emptyText:"",enableKeyEvents:!1,scrollAlwaysVisible:!0,headers:[{name:e.textSeries,width:108},{name:e.textType,width:105},{name:e.textSecondary,width:123,style:"text-align: center;"}],template:_.template(['<div class="listview inner" style=""></div>'].join("")),itemTemplate:_.template(['<div class="list-item" style="width: 100%;" id="chart-type-dlg-item-<%= seriesIndex %>">','<div class="series-color" id="chart-type-dlg-series-preview-<%= seriesIndex %>"></div>','<div class="series-value"><%= value %></div>','<div class="series-cmb"><div id="chart-type-dlg-cmb-series-<%= seriesIndex %>" class="input-group-nr" style=""></div></div>','<div class="series-chk"><div id="chart-type-dlg-chk-series-<%= seriesIndex %>" style=""></div></div>',"</div>"].join(""))}),this.seriesList.createNewItem=function(t){return new s({template:this.itemTemplate,model:t})},this.NotCombinedSettings=$(".simple-chart",this.$window),this.CombinedSettings=$(".combined-chart",this.$window),this.afterRender()},afterRender:function(){this._setDefaults(this.chartSettings)},show:function(){Common.Views.AdvancedSettingsWindow.prototype.show.apply(this,arguments)},close:function(){this.api.asc_onCloseChartFrame(),this.api.asc_unregisterCallback("asc_onAddChartStylesPreview",this.wrapEvents.onAddChartStylesPreview),Common.Views.AdvancedSettingsWindow.prototype.close.apply(this,arguments)},_setDefaults:function(t){if(t){this.chartSettings=t,this.currentChartType=t.getType();t=this.mnuChartTypePicker.store.findWhere({type:this.currentChartType});if(this.mnuChartTypePicker.selectRecord(t,!0),t)this.btnChartType.setIconCls("svgicon chart-"+t.get("iconCls"));else{var e="";switch(this.currentChartType){case Asc.c_oAscChartTypeSettings.surfaceNormal:e="chart-surface-normal";break;case Asc.c_oAscChartTypeSettings.surfaceWireframe:e="chart-surface-wireframe";break;case Asc.c_oAscChartTypeSettings.contourNormal:case Asc.c_oAscChartTypeSettings.contourWireframe:e="chart-contour-wireframe"}this.btnChartType.setIconCls("svgicon "+e)}this.seriesList.on("item:add",_.bind(this.addControls,this)),this.seriesList.on("item:change",_.bind(this.addControls,this)),this.ShowHideSettings(this.currentChartType),this.currentChartType==Asc.c_oAscChartTypeSettings.comboBarLine||this.currentChartType==Asc.c_oAscChartTypeSettings.comboBarLineSecondary||this.currentChartType==Asc.c_oAscChartTypeSettings.comboAreaBar||this.currentChartType==Asc.c_oAscChartTypeSettings.comboCustom?this.updateSeriesList(this.chartSettings.getSeries()):(this.updateChartStyles(this.api.asc_getChartPreviews(this.currentChartType,void 0,!0)),this.api.asc_generateChartPreviews(this.currentChartType))}},getSettings:function(){return{chartSettings:this.chartSettings}},onDlgBtnClick:function(t){t="object"==typeof t?t.currentTarget.attributes.result.value:t;"ok"==t&&this.handler&&this.handler.call(this,t,"ok"==t?this.getSettings():void 0),this.close()},onPrimary:function(){return this.onDlgBtnClick("ok"),!1},onSelectType:function(t,e,i){var s={};if(_.isFunction(i.toJSON)){if(!i.get("selected"))return;s=i.toJSON()}else s=i;i=s.type==Asc.c_oAscChartTypeSettings.comboBarLine||s.type==Asc.c_oAscChartTypeSettings.comboBarLineSecondary||s.type==Asc.c_oAscChartTypeSettings.comboAreaBar||s.type==Asc.c_oAscChartTypeSettings.comboCustom;i&&this.chartSettings.getSeries().length<2?Common.UI.warning({msg:this.errorComboSeries,maxwidth:600}):this.chartSettings.changeType(s.type)?(this.btnChartType.setIconCls("svgicon chart-"+s.iconCls),this.currentChartType=s.type,this.ShowHideSettings(this.currentChartType),i?this.updateSeriesList(this.chartSettings.getSeries()):(this.updateChartStyles(this.api.asc_getChartPreviews(this.currentChartType,void 0,!0)),this.api.asc_generateChartPreviews(this.currentChartType))):t.selectRecord(t.store.findWhere({type:this.currentChartType}),!0)},updateChartStyles:function(t){var e,i,s=this;t&&0<t.length?(e=this.stylesList.store)&&(i=[],_.each(t,function(t,e){i.push({imageUrl:t.asc_getImage(),data:t.asc_getName(),tip:s.textStyle+" "+t.asc_getName()})}),e.reset(i,{silent:!1})):this.stylesList.store.reset(),this.stylesList.setDisabled(!t||t.length<1)},onSelectStyles:function(t,e,i){i&&this.chartSettings.putStyle(i.get("data"))},onAddChartStylesPreview:function(t){var s;t&&0<t.length&&((s=this.stylesList.store)&&_.each(t,function(t,e){var i=s.findWhere({data:t.asc_getName()});i&&i.set("imageUrl",t.asc_getImage())}))},updateSeriesList:function(t,e){for(var i=[],s=this.seriesList.store,o=0,n=t.length;o<n;o++){var a=t[o],l=new Common.UI.DataViewModel;l.set({value:a.asc_getSeriesName(),type:a.asc_getChartType(),isSecondary:a.asc_getIsSecondaryAxis(),canChangeSecondary:a.asc_canChangeAxisType(),seriesIndex:o,series:a}),i.push(l)}s.reset(i),0<i.length&&void 0!==e&&e<i.length&&this.seriesList.selectByIndex(e)},addControls:function(t,e,i){var o,n,s,a;i&&(o=this,n=i.get("seriesIndex"),s=this.seriesList.cmpEl.find("#chart-type-dlg-item-"+n),(a=i.get("series")).asc_drawPreviewRect("chart-type-dlg-series-preview-"+n),this.initSeriesType("#chart-type-dlg-cmb-series-"+n,n,i),new Common.UI.CheckBox({el:s.find("#chart-type-dlg-chk-series-"+n),value:i.get("isSecondary"),disabled:!i.get("canChangeSecondary")}).on("change",function(t,e,i,s){a.asc_TryChangeAxisType("checked"==t.getValue())!==Asc.c_oAscError.ID.No?t.setValue("checked"!=t.getValue(),!0):o.updateSeriesList(o.chartSettings.getSeries(),n)}),s.on("mousedown",".combobox",function(){o.seriesList.selectRecord(i)}))},initSeriesType:function(t,n,a){var l=this,r=a.get("series"),i=new Common.UI.DataViewStore(l._arrSeriesType),s=i.findWhere({type:a.get("type")}),e=s?s.get("tip"):"",o=$(t),c=new Common.UI.ComboBox({el:o,template:_.template(['<span class="input-group combobox combo-dataview-menu input-group-nr dropdown-toggle no-highlighted" tabindex="0" data-toggle="dropdown">','<input type="text" class="form-control" spellcheck="false">','<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" data-target="'+t+'"><span class="caret"></span></button>',"</span>"].join(""))}),t=new Common.UI.Menu({cls:"menu-absolute",style:"width: 318px;",additionalAlign:this.menuAddAlign,items:[{template:_.template('<div id="chart-type-dlg-series-menu-'+n+'" class="menu-insertchart"></div>')}]}),d=(t.render(o),c.setValue(e),function(t){var e=new Common.UI.DataView({el:$("#chart-type-dlg-series-menu-"+n),parentMenu:t,restoreHeight:535,groups:new Common.UI.DataViewGroupStore(l._arrSeriesGroups),store:i,itemTemplate:_.template('<div id="<%= id %>" class="item-chartlist"><svg width="40" height="40" class="icon uni-scale"><use xlink:href="#chart-<%= iconCls %>"></use></svg></div>')});e.selectRecord(s,!0),e.on("item:click",function(t,e,i){var s=a.get("type"),o=r.asc_TryChangeChartType(i.get("type"));o==Asc.c_oAscError.ID.No?(c.setValue(i.get("tip")),l.updateSeriesList(l.chartSettings.getSeries(),n)):(i=t.store.findWhere({type:s}),t.selectRecord(i,!0),o==Asc.c_oAscError.ID.SecondaryAxis&&Common.UI.warning({msg:l.errorSecondaryAxis,maxwidth:500}))}),t.off("show:before",d)});return t.on("show:before",d),c},ShowHideSettings:function(t){t=t==Asc.c_oAscChartTypeSettings.comboBarLine||t==Asc.c_oAscChartTypeSettings.comboBarLineSecondary||t==Asc.c_oAscChartTypeSettings.comboAreaBar||t==Asc.c_oAscChartTypeSettings.comboCustom;this.NotCombinedSettings.toggleClass("hidden",t),this.CombinedSettings.toggleClass("hidden",!t)}},SSE.Views.ChartTypeDialog||{}))}),define("spreadsheeteditor/main/app/view/ChartWizardDialog",["common/main/lib/view/AdvancedSettingsWindow","common/main/lib/component/Button","common/main/lib/component/DataView"],function(){"use strict";var e=Common.UI.DataViewItem.extend({initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);var e=this;e.template=e.options.template||e.template,e.listenTo(e.model,"change:sort",function(){e.render(),e.trigger("change",e,e.model)}),e.listenTo(e.model,"change:selected",function(){(e.$el||$(e.el)).toggleClass("selected",e.model.get("selected")&&e.model.get("allowSelected")),e.onSelectChange(e.model,e.model.get("selected")&&e.model.get("allowSelected"))}),e.listenTo(e.model,"remove",e.remove)}});SSE.Views.ChartWizardDialog=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:455,contentHeight:400,toggleGroup:"chart-recommend-group",storageName:"sse-chart-recommend-category"},initialize:function(s){var o=this,t=[],n=[],a=Common.define.chartData.getChartData();if(this._currentTabIndex=void 0,this._arrSeriesGroups=[],this._arrSeriesType=[],s.props.recommended)for(var e in s.props.recommended)if(!isNaN(parseInt(e)))for(var i=0;i<a.length;i++)if(parseInt(e)===a[i].type){t.push(a[i]);break}0<t.length&&n.push({panelId:"id-chart-recommended-rec",panelCaption:o.textRecommended,groupId:"rec",charts:t,categoryIcon:"toolbar__icon btn-chartcategory-recommended",categoryCls:"png-icons"}),Common.define.chartData.getChartGroupData().forEach(function(e){var i=[];a.forEach(function(t){e.id===t.group&&(i.push(t),s.type===t.type&&(o._currentTabIndex=n.length))}),n.push({panelId:"id-chart-recommended-"+e.id,panelCaption:e.caption,groupId:e.id,charts:i,categoryIcon:"toolbar__icon btn-chartcategory-"+i[0].iconCls,categoryCls:"png-icons"}),"menu-chart-group-combo"!==e.id&&"menu-chart-group-stock"!==e.id&&o._arrSeriesGroups.push(e)}),a.forEach(function(t){t.is3d||t.type===Asc.c_oAscChartTypeSettings.stock||t.type===Asc.c_oAscChartTypeSettings.comboBarLine||t.type===Asc.c_oAscChartTypeSettings.comboBarLineSecondary||t.type===Asc.c_oAscChartTypeSettings.comboAreaBar||t.type===Asc.c_oAscChartTypeSettings.comboCustom||o._arrSeriesType.push(t)}),this.chartTabTemplate=['<div class="inner-content">','<div class="buttons-container">',"<% _.each(group.charts, function(chart) { %>",'<div id="id-<%= group.groupId %>-btn-<%= chart.type %>" class="margin-right-5" style="display: inline-block;margin-bottom:8px;"></div>',"<% }); %>","</div>","</div>",'<div class="inner-content" style="'+(Common.UI.isRTL()?"padding-left: 0;":"padding-right: 0;")+'">','<table cols="1" style="width: 100%;">',"<tr>",'<td class="padding-small"></td>',"</tr>","<tr>","<td>",'<label class="header" id="id-<%= group.groupId %>-lbl"></label>',"</td>","</tr>",'<tr class="chart-error">','<td class="padding-very-small"></td>',"</tr>",'<tr class="chart-error">',"<td>",'<label id="id-<%= group.groupId %>-lbl-error"></label>',"</td>","</tr>",'<tr class="preview-list">','<td style="padding-bottom:12px;">','<div id="id-<%= group.groupId %>-list-preview" style="width:100%; height: <% if (group.groupId === "menu-chart-group-combo") {%>163<% } else { %>258<% } %>px;"></div>',"</td>","</tr>",'<tr class="preview-one hidden">','<td style="padding: '+(Common.UI.isRTL()?"3px 3px 12px 12px":"3px 12px 12px 3px")+';">','<div id="id-<%= group.groupId %>-preview" class="preview-canvas-container" style="<% if (group.groupId === "menu-chart-group-combo") {%>width:280px; height: 160px;<% } else { %>width:100%; height:258px;<% } %>"></div>',"</td>","</tr>",'<% if (group.groupId === "menu-chart-group-combo") {%>','<tr class="preview-combo">',"<td>","<label>"+this.txtSeriesDesc+"</label>","</td>","</tr>",'<tr class="preview-combo">','<td style="padding: '+(Common.UI.isRTL()?"3px 3px 3px 12px":"3px 12px 3px 3px")+';">','<div id="id-<%= group.groupId %>-combo-preview" class="" style="width:100%; height: 113px;"></div>',"</td>","</tr>","<% } %>","</table>","</div>"].join("");var l=["<% _.each(groups, function(group) { %>",'<div id="<%= group.panelId %>" class="settings-panel"></div>',"<% }); %>"].join("");_.extend(this.options,{title:s.isEdit?this.textTitleChange:this.textTitle,items:n,contentTemplate:_.template(l)({groups:n,scope:this})},s),Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options),this.api=this.options.api,this.allCharts=[],this._currentChartType=null,this._currentChartSpace=null,this._currentPreviews=[],this._currentPreviewSize=[430,258],this._currentTabSettings=null},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this),this.chartButtons=[],this.btnOk=_.find(this.getFooterButtons(),function(t){return t.$el&&0<t.$el.find(".primary").addBack().filter(".primary").length})||new Common.UI.Button({el:this.$window.find(".primary")}),this.afterRender()},onCategoryClick:function(t,e){var i,s;$("#"+t.options.contentTarget).hasClass("active")||(Common.Views.AdvancedSettingsWindow.prototype.onCategoryClick.call(this,t,e),(t=(i=this).options.items[e]).rendered||this.renderChartTab(t),this.fillPreviews(t),0<(s=t.chartButtons).length&&(s[i._openedButtonIndex].toggle(!0),setTimeout(function(){s[i._openedButtonIndex].focus()},10)))},renderChartTab:function(s){var o=this,n=this.getChild();n.find("#"+s.panelId).append($(_.template(this.chartTabTemplate)({group:s,scope:o}))),o._openedButtonIndex=0,s.chartButtons=[],s.charts.forEach(function(i,t){var e=new Common.UI.Button({parentEl:n.find("#id-"+s.groupId+"-btn-"+i.type),cls:"btn-options huge-1 svg-chartlist",iconCls:"svgicon chart-"+i.iconCls,chart:i,hint:i.tip,enableToggle:!0,allowDepress:!1,toggleGroup:"toggle-"+s.groupId});e.on("toggle",function(t,e){e&&(n.find("#id-"+s.groupId+"-lbl").text(i.tip),o._currentChartType=i.type,o.updatePreview())}),s.chartButtons.push(e),o.chartButtons.push(e),i.type===o.options.type&&"rec"!==s.groupId&&(o._openedButtonIndex=t),Common.UI.FocusManager.insert(o,e,-1*o.getFooterButtons().length)}),s.divErrorEl=n.find("#"+s.panelId+" .chart-error"),s.lblError=n.find("#id-"+s.groupId+"-lbl-error"),s.divPreviewEl=n.find("#"+s.panelId+" .preview-one"),s.divPreviewId="id-"+s.groupId+"-preview",s.listViewEl=n.find("#"+s.panelId+" .preview-list"),s.listPreview=new Common.UI.DataView({el:n.find("#id-"+s.groupId+"-list-preview"),cls:"focus-inner",scrollAlwaysVisible:!0,store:new Common.UI.DataViewStore,itemTemplate:_.template(['<div class="style" id="<%= id %>" style="width:210px; height:120px;"></div>'].join("")),tabindex:1}),s.listPreview.on({"item:select":function(t,e,i){i&&(o._currentChartSpace=i.get("data"),"menu-chart-group-combo"===o._currentTabSettings.groupId&&o.updateSeriesList(o._currentChartSpace.asc_getSeries()))},"item:add":function(t,e,i){i&&i.get("data").updateView(i.get("id"))},entervalue:_.bind(this.onPrimary,this)}),Common.UI.FocusManager.insert(this,s.listPreview,-1*this.getFooterButtons().length),"menu-chart-group-combo"===s.groupId&&this.renderSeries(s),s.rendered=!0},renderSeries:function(t){this.seriesList=new Common.UI.ListView({el:this.$window.find("#id-"+t.groupId+"-combo-preview"),store:new Common.UI.DataViewStore,emptyText:"",scrollAlwaysVisible:!0,headers:[{name:this.textSeries,width:138},{name:this.textType,width:145},{name:this.textSecondary,width:130,style:"text-align: center;"}],template:_.template(['<div class="listview inner" style=""></div>'].join("")),itemTemplate:_.template(['<div class="list-item" style="width: 100%;" id="chart-recommend-item-<%= seriesIndex %>">','<div class="series-color" id="chart-recommend-series-preview-<%= seriesIndex %>"></div>','<div class="series-value" style="width: 125px;"><%= Common.Utils.String.htmlEncode(value) %></div>','<div class="series-cmb" style="width: 150px;"><div id="chart-recommend-cmb-series-<%= seriesIndex %>" class="input-group-nr" style=""></div></div>','<div class="series-chk"><div id="chart-recommend-chk-series-<%= seriesIndex %>" style=""></div></div>',"</div>"].join("")),tabindex:1}),this.seriesList.createNewItem=function(t){return new e({template:this.itemTemplate,model:t})},this.seriesList.on("item:add",_.bind(this.addControls,this)),this.seriesList.on("item:change",_.bind(this.addControls,this)),this.seriesList.on("item:select",_.bind(this.onSelectSeries,this)),this.seriesList.on("item:deselect",_.bind(this.onDeselectSeries,this)),this.seriesList.on("entervalue",_.bind(this.onPrimary,this)),this.listViewComboEl=this.$window.find("#"+t.panelId+" .preview-combo"),Common.UI.FocusManager.insert(this,this.seriesList,-1*this.getFooterButtons().length)},updateSeriesList:function(t,e){var i=this,s=[],o=this.seriesList.store;this.beforeSeriesReset(o);for(var n=0,a=t.length;n<a;n++){var l=t[n],r=new Common.UI.DataViewModel;r.set({value:l.asc_getSeriesName(),type:l.asc_getChartType(),isSecondary:l.asc_getIsSecondaryAxis(),canChangeSecondary:l.asc_canChangeAxisType(),seriesIndex:n,series:l}),s.push(r)}o.reset(s),0<s.length&&void 0!==e&&(e<s.length&&this.seriesList.selectByIndex(e),setTimeout(function(){i.seriesList.focus()},10))},addControls:function(t,e,i){var o,n,s,a,l,r;i&&(o=this,n=i.get("seriesIndex"),s=this.seriesList.cmpEl.find("#chart-recommend-item-"+n),(a=i.get("series")).asc_drawPreviewRect("chart-recommend-series-preview-"+n),l=this.initSeriesType("#chart-recommend-cmb-series-"+n,n,i),(r=new Common.UI.CheckBox({el:s.find("#chart-recommend-chk-series-"+n),value:i.get("isSecondary"),disabled:!i.get("canChangeSecondary")})).on("change",function(t,e,i,s){a.asc_TryChangeAxisType("checked"===t.getValue())!==Asc.c_oAscError.ID.No?t.setValue("checked"!==t.getValue(),!0):o.updatePreview(n)}),s.on("mousedown",".combobox",function(){o.seriesList.selectRecord(i)}),i.set("controls",{checkbox:r,combobox:l},{silent:!0}))},initSeriesType:function(t,a,l){var r=this,c=l.get("series"),e=new Common.UI.DataViewStore(r._arrSeriesType),i=e.findWhere({type:l.get("type")}),t=$(t),t=new Common.UI.ComboBoxDataView({el:t,additionalAlign:this.menuAddAlign,cls:"move-focus",menuCls:"menu-absolute",menuStyle:"width: 318px;",dataViewCls:"menu-insertchart",restoreHeight:535,groups:new Common.UI.DataViewGroupStore(r._arrSeriesGroups),store:e,formTemplate:_.template(['<input type="text" class="form-control" spellcheck="false">'].join("")),itemTemplate:_.template('<div id="<%= id %>" class="item-chartlist"><svg width="40" height="40" class="icon uni-scale"><use xlink:href="#chart-<%= iconCls %>"></use></svg></div>'),takeFocusOnClose:!0,updateFormControl:function(t){$(this.el).find("input").val(t?t.get("tip"):"")}});return t.selectRecord(i),t.on("item:click",function(t,e,i,s){var o=l.get("type"),n=c.asc_TryChangeChartType(s.get("type"));n===Asc.c_oAscError.ID.No?(t.selectRecord(s),r.updatePreview(a)):(t=e.store.findWhere({type:o}),e.selectRecord(t,!0),n===Asc.c_oAscError.ID.SecondaryAxis&&Common.UI.warning({msg:r.errorSecondaryAxis,maxwidth:500}))}),t},onDeselectSeries:function(t,e,i){i&&i.get("controls")&&(i=i.get("controls"),Common.UI.FocusManager.remove(this,i.index,2),i.index=void 0)},onSelectSeries:function(t,e,i,s){var o;i&&i.get("controls")&&(i=i.get("controls"),void 0!==(o=Common.UI.FocusManager.insert(this,[i.combobox,i.checkbox],-1*this.getFooterButtons().length))&&(i.index=o),s&&setTimeout(function(){t.focus()},1))},beforeSeriesReset:function(t){for(var e=0;e<t.length;e++){var i=t.at(e);if(i){i=i.get("controls");if(i&&void 0!==i.index){Common.UI.FocusManager.remove(this,i.index,2);break}}}},fillPreviews:function(t){this._currentPreviews="rec"===t.groupId?this.options.props.recommended:this.allCharts,this._currentPreviewSize="menu-chart-group-combo"===t.groupId?[280,160]:[430,258],this._currentTabSettings=t},updatePreview:function(t){var e=this._currentPreviews[this._currentChartType];if(void 0===e&&"rec"!==this._currentTabSettings.groupId&&(e=this._currentPreviews[this._currentChartType]=this.api.asc_getChartData(this._currentChartType)),this._currentTabSettings.divErrorEl.toggleClass("hidden","number"!=typeof e),"number"==typeof e){var i="";switch(e){case Asc.c_oAscError.ID.StockChartError:i=this.errorStockChart;break;case Asc.c_oAscError.ID.MaxDataSeriesError:i=this.errorMaxRows;break;case Asc.c_oAscError.ID.ComboSeriesError:i=this.errorComboSeries;break;case Asc.c_oAscError.ID.MaxDataPointsError:i=this.errorMaxPoints}this._currentTabSettings.lblError.text(i),e=null}if(this._currentTabSettings.listViewEl.toggleClass("hidden",!e||e.length<2),this._currentTabSettings.divPreviewEl.toggleClass("hidden",!e||1!==e.length),"menu-chart-group-combo"===this._currentTabSettings.groupId&&this.listViewComboEl.toggleClass("hidden",!e||0===e.length),e){if(1===e.length)this._currentChartSpace=e[0],this._currentChartSpace.updateView(this._currentTabSettings.divPreviewId);else if(1<e.length){for(var s=this._currentTabSettings.listPreview.store,o=void 0!==t?_.indexOf(s.models,this._currentTabSettings.listPreview.getSelectedRec()):0,n=[],a=0;a<e.length;a++)n.push(new Common.UI.DataViewModel({data:e[a],skipRenderOnChange:!0}));s.reset(n),this._currentChartSpace=e[o],this._currentTabSettings.listPreview.selectByIndex(o,!0)}0<e.length&&"menu-chart-group-combo"===this._currentTabSettings.groupId&&this.updateSeriesList(this._currentChartSpace.asc_getSeries(),t)}this.btnOk.setDisabled(!e||0===e.length)},afterRender:function(){this._setDefaults(this.options.props),this.setActiveCategory(this._currentTabIndex)},_setDefaults:function(t){Common.UI.FocusManager.add(this,this.btnsCategory.concat(this.getFooterButtons()))},getSettings:function(){return this._currentChartSpace},onDlgBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onPrimary:function(){return this._handleInput("ok"),!1},_handleInput:function(t){if(this.handler){if("ok"===t&&this.btnOk.isDisabled())return;this.handler.call(this,t,"ok"===t?this.getSettings():void 0)}this.close()},textTitle:"Insert Chart",textTitleChange:"Change Chart Type",textRecommended:"Recommended",txtSeriesDesc:"Choose the chart type and axis for your data series",textType:"Type",textSeries:"Series",textSecondary:"Secondary Axis",errorSecondaryAxis:"The selected chart type requires the secondary axis that an existing chart is using. Select another chart type.",errorComboSeries:"To create a combination chart, select at least two series of data.",errorStockChart:"Incorrect row order. To build a stock chart place the data on the sheet in the following order: opening price, max price, min price, closing price.",errorMaxRows:"The maximum number of data series per chart is 255.",errorMaxPoints:"The maximum number of points in series per chart is 4096."},SSE.Views.ChartWizardDialog||{}))}),define("spreadsheeteditor/main/app/view/FillSeriesDialog",["common/main/lib/util/utils","common/main/lib/component/RadioBox","common/main/lib/component/CheckBox","common/main/lib/component/InputField","common/main/lib/view/AdvancedSettingsWindow"],function(){"use strict";SSE.Views.FillSeriesDialog=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:350,separator:!1},initialize:function(t){_.extend(this.options,{title:this.textTitle,contentStyle:"padding: 0 5px;",contentTemplate:_.template(['<div class="settings-panel active">','<div class="inner-content">','<table cols="3" style="width: 100%;">',"<tr>",'<td class="padding-small">','<label class="header">',this.textSeries,"</label>","</td>",'<td class="padding-small">','<label class="header">',this.textType,"</label>","</td>",'<td class="padding-small">','<label class="header">',this.textDateUnit,"</label>","</td>","</tr>","<tr>",'<td class="padding-small">','<div id="fill-radio-rows"></div>',"</td>",'<td class="padding-small">','<div id="fill-radio-linear"></div>',"</td>",'<td class="padding-small">','<div id="fill-radio-day"></div>',"</td>","</tr>","<tr>",'<td class="padding-small">','<div id="fill-radio-cols"></div>',"</td>",'<td class="padding-small">','<div id="fill-radio-growth"></div>',"</td>",'<td class="padding-small">','<div id="fill-radio-weekday"></div>',"</td>","</tr>","<tr>",'<td class="padding-small">',"</td>",'<td class="padding-small">','<div id="fill-radio-date"></div>',"</td>",'<td class="padding-small">','<div id="fill-radio-month"></div>',"</td>","</tr>","<tr>",'<td class="padding-large">',"</td>",'<td class="padding-large">','<div id="fill-radio-autofill"></div>',"</td>",'<td class="padding-large">','<div id="fill-radio-year"></div>',"</td>","</tr>","<tr>",'<td colspan=3 class="padding-small">','<div id="fill-chb-trend"></div>',"</td>","</tr>","<tr>",'<td class="padding-small">','<label className="input-label">',this.textStep,"</label>",'<div id="fill-input-step-value"></div>',"</td>",'<td class="padding-small">','<label className="input-label">',this.textStop,"</label>",'<div id="fill-input-stop-value"></div>',"</td>",'<td class="padding-small">',"</td>","</tr>","</table>","</div></div>"].join(""))()},t),this.handler=t.handler,this.props=t.props,Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var e=this,t=this.getChild();this.radioCols=new Common.UI.RadioBox({el:t.find("#fill-radio-cols"),name:"asc-radio-series",labelText:this.textCols,value:Asc.c_oAscSeriesInType.columns}),this.radioCols.on("change",_.bind(this.onRadioSeriesChange,this)),this.radioRows=new Common.UI.RadioBox({el:t.find("#fill-radio-rows"),name:"asc-radio-series",labelText:this.textRows,value:Asc.c_oAscSeriesInType.rows}),this.radioRows.on("change",_.bind(this.onRadioSeriesChange,this)),this.radioLinear=new Common.UI.RadioBox({el:t.find("#fill-radio-linear"),name:"asc-radio-type",labelText:this.textLinear,value:Asc.c_oAscSeriesType.linear}),this.radioLinear.on("change",_.bind(this.onRadioTypeChange,this)),this.radioGrowth=new Common.UI.RadioBox({el:t.find("#fill-radio-growth"),name:"asc-radio-type",labelText:this.textGrowth,value:Asc.c_oAscSeriesType.growth}),this.radioGrowth.on("change",_.bind(this.onRadioTypeChange,this)),this.radioDate=new Common.UI.RadioBox({el:t.find("#fill-radio-date"),name:"asc-radio-type",labelText:this.textDate,value:Asc.c_oAscSeriesType.date}),this.radioDate.on("change",_.bind(this.onRadioTypeChange,this)),this.radioAuto=new Common.UI.RadioBox({el:t.find("#fill-radio-autofill"),name:"asc-radio-type",labelText:this.textAuto,value:Asc.c_oAscSeriesType.autoFill}),this.radioAuto.on("change",_.bind(this.onRadioTypeChange,this)),this.radioDay=new Common.UI.RadioBox({el:t.find("#fill-radio-day"),name:"asc-radio-date",labelText:this.textDay,value:Asc.c_oAscDateUnitType.day}),this.radioDay.on("change",_.bind(this.onRadioDateChange,this)),this.radioWeek=new Common.UI.RadioBox({el:t.find("#fill-radio-weekday"),name:"asc-radio-date",labelText:this.textWeek,value:Asc.c_oAscDateUnitType.weekday}),this.radioWeek.on("change",_.bind(this.onRadioDateChange,this)),this.radioMonth=new Common.UI.RadioBox({el:t.find("#fill-radio-month"),name:"asc-radio-date",labelText:this.textMonth,value:Asc.c_oAscDateUnitType.month}),this.radioMonth.on("change",_.bind(this.onRadioDateChange,this)),this.radioYear=new Common.UI.RadioBox({el:t.find("#fill-radio-year"),name:"asc-radio-date",labelText:this.textYear,value:Asc.c_oAscDateUnitType.year}),this.radioYear.on("change",_.bind(this.onRadioDateChange,this)),this.chTrend=new Common.UI.CheckBox({el:t.find("#fill-chb-trend"),labelText:this.textTrend}),this.chTrend.on("change",_.bind(this.onChangeTrend,this)),this.inputStep=new Common.UI.InputField({el:t.find("#fill-input-step-value"),style:"width: 85px;",allowBlank:!0,validateOnBlur:!1}).on("changed:after",function(){e.isStepChanged=!0}),this.inputStep._input.on("input",function(t){e.isInputStepFirstChange&&e.inputStep.showError(),e.isInputStepFirstChange=!1}),this.inputStop=new Common.UI.InputField({el:t.find("#fill-input-stop-value"),style:"width: 85px;",allowBlank:!0,validateOnBlur:!1}).on("changed:after",function(){e.isStopChanged=!0}),this.inputStop._input.on("input",function(t){e.isInputStopFirstChange&&e.inputStop.showError(),e.isInputStopFirstChange=!1}),this.afterRender()},getFocusedComponents:function(){return[this.radioRows,this.radioCols,this.radioLinear,this.radioGrowth,this.radioDate,this.radioAuto,this.radioDay,this.radioWeek,this.radioMonth,this.radioYear,this.chTrend,this.inputStep,this.inputStop].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.radioRows},afterRender:function(){this._setDefaults(this.props)},show:function(){Common.Views.AdvancedSettingsWindow.prototype.show.apply(this,arguments)},_setDefaults:function(t){var e;t&&(e=t.asc_getSeriesIn(),this.radioCols.setValue(e===Asc.c_oAscSeriesInType.columns,!0),this.radioRows.setValue(e===Asc.c_oAscSeriesInType.rows,!0),e=t.asc_getType(),this.radioLinear.setValue(e===Asc.c_oAscSeriesType.linear),this.radioGrowth.setValue(e===Asc.c_oAscSeriesType.growth),this.radioDate.setValue(e===Asc.c_oAscSeriesType.date),this.radioAuto.setValue(e===Asc.c_oAscSeriesType.autoFill),e=t.asc_getDateUnit(),this.radioDay.setValue(e===Asc.c_oAscDateUnitType.day,!0),this.radioWeek.setValue(e===Asc.c_oAscDateUnitType.weekday,!0),this.radioMonth.setValue(e===Asc.c_oAscDateUnitType.month,!0),this.radioYear.setValue(e===Asc.c_oAscDateUnitType.year,!0),this.chTrend.setValue(!!t.asc_getTrend()),e=t.asc_getStepValue(),this.inputStep.setValue(null!=e?e:""),e=t.asc_getStopValue(),this.inputStop.setValue(null!=e?e:"")),this._changedProps=t||new Asc.asc_CSeriesSettings},getSettings:function(){return this._changedProps},onDlgBtnClick:function(t){this._handleInput("object"==typeof t?t.currentTarget.attributes.result.value:t)},onPrimary:function(){return this._handleInput("ok"),!1},_handleInput:function(t){if(this.handler){if("ok"===t&&!this.isValid())return;this.handler.call(this,t,"ok"===t?this.getSettings():void 0)}this.close()},isValid:function(){if(this.isStepChanged){if((t=this._changedProps.asc_isValidStepValue(this.inputStep.getValue()))[0]!==Asc.c_oAscError.ID.No)return this.inputStep.showError([this.txtErrorNumber]),this.inputStep.focus(),!(this.isInputStepFirstChange=!0);this._changedProps.asc_setStepValue(t[1])}if(this.isStopChanged){var t;if((t=this._changedProps.asc_isValidStopValue(this.inputStop.getValue()))[0]!==Asc.c_oAscError.ID.No)return this.inputStop.showError([this.txtErrorNumber]),this.inputStop.focus(),!(this.isInputStopFirstChange=!0);this._changedProps.asc_setStopValue(t[1])}return!0},onRadioTypeChange:function(t,e,i){var s;e&&(this._changedProps&&this._changedProps.asc_setType(t.options.value),e=t.options.value==Asc.c_oAscSeriesType.date,t=t.options.value==Asc.c_oAscSeriesType.autoFill,s="checked"===this.chTrend.getValue(),this.radioDay.setDisabled(!e),this.radioMonth.setDisabled(!e),this.radioWeek.setDisabled(!e),this.radioYear.setDisabled(!e),this.inputStep.setDisabled(t||s),this.inputStop.setDisabled(t||s))},onRadioSeriesChange:function(t,e,i){e&&this._changedProps&&this._changedProps.asc_setSeriesIn(t.options.value)},onRadioDateChange:function(t,e,i){e&&this._changedProps&&this._changedProps.asc_setDateUnit(t.options.value)},onChangeTrend:function(t,e,i){var t="checked"===t.getValue(),s=this.radioDate.getValue(),o=this.radioAuto.getValue();this._changedProps&&this._changedProps.asc_setTrend(t),t&&(s||o)&&this.radioLinear.setValue(!0),this.radioDate.setDisabled(t),this.radioAuto.setDisabled(t),this.inputStep.setDisabled(t||o),this.inputStop.setDisabled(t||o)},textTitle:"Series",textSeries:"Series in",textType:"Type",textDateUnit:"Date unit",textStep:"Step value",textStop:"Stop value",textCols:"Columns",textRows:"Rows",textLinear:"Linear",textGrowth:"Growth",textDate:"Date",textAuto:"AutoFill",textDay:"Day",textWeek:"Weekday",textMonth:"Month",textYear:"Year",textTrend:"Trend",txtErrorNumber:"Your entry cannot be used. An integer or decimal number may be required."},SSE.Views.FillSeriesDialog||{}))}),define("spreadsheeteditor/main/app/controller/Toolbar",["core","common/main/lib/component/Window","common/main/lib/view/CopyWarningDialog","common/main/lib/view/ImageFromUrlDialog","common/main/lib/view/SelectFileDlg","common/main/lib/view/SymbolTableDialog","common/main/lib/view/OptionsDialog","common/main/lib/util/define","common/main/lib/view/SearchBar","spreadsheeteditor/main/app/view/Toolbar","spreadsheeteditor/main/app/collection/TableTemplates","spreadsheeteditor/main/app/controller/PivotTable","spreadsheeteditor/main/app/view/HyperlinkSettingsDialog","spreadsheeteditor/main/app/view/TableOptionsDialog","spreadsheeteditor/main/app/view/NamedRangeEditDlg","spreadsheeteditor/main/app/view/NamedRangePasteDlg","spreadsheeteditor/main/app/view/NameManagerDlg","spreadsheeteditor/main/app/view/FormatSettingsDialog","spreadsheeteditor/main/app/view/PageMarginsDialog","spreadsheeteditor/main/app/view/HeaderFooterDialog","spreadsheeteditor/main/app/view/PrintTitlesDialog","spreadsheeteditor/main/app/view/ScaleDialog","spreadsheeteditor/main/app/view/FormatRulesManagerDlg","spreadsheeteditor/main/app/view/SlicerAddDialog","spreadsheeteditor/main/app/view/AdvancedSeparatorDialog","spreadsheeteditor/main/app/view/CreateSparklineDialog","spreadsheeteditor/main/app/view/ChartTypeDialog","spreadsheeteditor/main/app/view/ChartWizardDialog","spreadsheeteditor/main/app/view/FillSeriesDialog"],function(){"use strict";SSE.Controllers.Toolbar=Backbone.Controller.extend(_.extend({models:[],collections:[],views:["Toolbar"],initialize:function(){function i(t,e){var i=(t=$(t.target)).closest("#editor_sdk"),s=t.closest("button").attr("id");void 0===s&&(s=t.closest(".btn-group").attr("id")),o.api&&o.api.asc_isAddAutoshape()&&(i.length<=0||"cancel"==e)&&(o.toolbar.btnInsertText.pressed&&s!=o.toolbar.btnInsertText.id||o.toolbar.btnInsertShape.pressed&&s!=o.toolbar.btnInsertShape.id?(o._isAddingShape=!1,o._addAutoshape(!1),o.toolbar.btnInsertShape.toggle(!1,!0),o.toolbar.btnInsertText.toggle(!1,!0),Common.NotificationCenter.trigger("edit:complete",o.toolbar)):o.toolbar.btnInsertShape.pressed&&s==o.toolbar.btnInsertShape.id&&_.defer(function(){o.api.asc_endAddShape(),Common.NotificationCenter.trigger("edit:complete",o.toolbar)},100))}var o=this;this.addListeners({Toolbar:{"change:compact":this.onClickChangeCompact.bind(o),"add:chart":this.onSelectChart,"add:spark":this.onSelectSpark,"insert:textart":this.onInsertTextart,"change:scalespn":this.onClickChangeScaleInMenu.bind(o),"click:customscale":this.onScaleClick.bind(o),"home:open":this.onHomeOpen,"generate:smartart":this.generateSmartArt,"insert:smartart":this.onInsertSmartArt},FileMenu:{"menu:hide":o.onFileMenu.bind(o,"hide"),"menu:show":o.onFileMenu.bind(o,"show")},Statusbar:{"sheet:changed":_.bind(this.onApiSheetChanged,this)},"Common.Views.Header":{print:function(t){this.getApplication().getController("Main").onPrint()},"print-quick":function(t){this.getApplication().getController("Main").onPrintQuick()},save:function(t){this.api.asc_Save()},undo:this.onUndo,redo:this.onRedo,downloadas:function(t){var e,i=this.getApplication().getController("Main"),s=i.appOptions.spreadsheet.fileType,s=(s&&(e=Asc.c_oAscFileType[s.toUpperCase()]),[Asc.c_oAscFileType.XLSX,Asc.c_oAscFileType.ODS,Asc.c_oAscFileType.CSV,Asc.c_oAscFileType.PDFA,Asc.c_oAscFileType.XLTX,Asc.c_oAscFileType.OTS,Asc.c_oAscFileType.XLSM]);(e=!e||s.indexOf(e)<0?Asc.c_oAscFileType.PDF:e)==Asc.c_oAscFileType.PDF||e==Asc.c_oAscFileType.PDFA?Common.NotificationCenter.trigger("download:settings",this.toolbar,e):i.api.asc_DownloadAs(new Asc.asc_CDownloadOptions(e))},download:function(){Common.Gateway._postMessage({event:"onDownload"})},"go:editor":function(){Common.Gateway.requestEditRights()}},DataTab:{"data:sort":this.onSortType,"data:setfilter":this.onAutoFilter,"data:clearfilter":this.onClearFilter},FormulaTab:{"function:namedrange":this.onNamedRangeMenu,"function:namedrange-open":this.onNamedRangeMenuOpen},CellSettings:{"cf:init":this.onShowBeforeCondFormat},ViewTab:{"viewtab:showtoolbar":this.onChangeViewMode.bind(this)},LeftMenu:{"search:show":this.searchShow.bind(this)}}),Common.NotificationCenter.on("page:settings",_.bind(this.onApiSheetChanged,this)),Common.NotificationCenter.on("formula:settings",_.bind(this.applyFormulaSettings,this)),Common.NotificationCenter.on("toolbar:collapse",_.bind(function(){this.toolbar.collapse()},this)),Common.NotificationCenter.on("oleedit:close",_.bind(this.onOleEditClose,this)),this.editMode=!0,this._isAddingShape=!1,this._state={activated:!1,prstyle:void 0,clrtext:void 0,pralign:void 0,clrback:void 0,valign:void 0,can_undo:void 0,can_redo:void 0,bold:void 0,italic:void 0,underline:void 0,strikeout:void 0,subscript:void 0,superscript:void 0,wrap:void 0,merge:void 0,angle:void 0,controlsdisabled:{filters:void 0},selection_type:void 0,filter:void 0,filterapplied:!1,tablestylename:void 0,tablename:void 0,namedrange_locked:!1,fontsize:void 0,multiselect:!1,sparklines_disabled:!1,numformatinfo:void 0,numformattype:void 0,numformat:void 0,langId:void 0,pgsize:[0,0],pgmargins:void 0,pgorient:void 0,lock_doc:void 0,cf_locked:[],selectedCells:0,wsLock:!1,wsProps:[],is_lockText:!1,is_lockShape:!1,isUserProtected:!1},this.binding={};this.checkInsertAutoshape=function(t){i({},t.action)},this._addAutoshape=function(t,e){this.api&&(t?(this.api.asc_startAddShape(e),$(document.body).on("mouseup",i)):(this.api.asc_endAddShape(),$(document.body).off("mouseup",i)))},this.onApiEndAddShape=function(){this.toolbar.btnInsertShape.pressed&&this.toolbar.btnInsertShape.toggle(!1,!0),this.toolbar.btnInsertText.pressed&&(this.toolbar.btnInsertText.toggle(!1,!0),this.toolbar.btnInsertText.menu.clearAll()),$(document.body).off("mouseup",i)}},onLaunch:function(){this.toolbar=this.createView("Toolbar"),Common.NotificationCenter.on("app:ready",this.onAppReady.bind(this)),Common.NotificationCenter.on("app:face",this.onAppShowed.bind(this))},setMode:function(t){this.mode=t,this.toolbar.applyLayout(t)},attachUIEvents:function(t){var e=this;e.appConfig.isEditDiagram?(t.btnUndo.on("click",_.bind(this.onUndo,this)),t.btnRedo.on("click",_.bind(this.onRedo,this)),t.btnCopy.on("click",_.bind(this.onCopyPaste,this,"copy")),t.btnPaste.on("click",_.bind(this.onCopyPaste,this,"paste")),t.btnInsertFormula.on("click",_.bind(this.onInsertFormulaMenu,this)),t.btnInsertFormula.menu.on("item:click",_.bind(this.onInsertFormulaMenu,this)),t.btnDecDecimal.on("click",_.bind(this.onDecrement,this)),t.btnIncDecimal.on("click",_.bind(this.onIncrement,this)),t.cmbNumberFormat.on("selected",_.bind(this.onNumberFormatSelect,this)),t.cmbNumberFormat.on("show:before",_.bind(this.onNumberFormatOpenBefore,this,!0)),t.cmbNumberFormat.cmpEl&&t.cmbNumberFormat.cmpEl.on("click","#id-toolbar-mnu-item-more-formats a",_.bind(this.onNumberFormatSelect,this)),t.btnEditChart.on("click",_.bind(this.onEditChart,this)),t.btnEditChartData.on("click",_.bind(this.onEditChartData,this)),t.btnEditChartType.on("click",_.bind(this.onEditChartType,this))):e.appConfig.isEditMailMerge?(t.btnUndo.on("click",_.bind(this.onUndo,this)),t.btnRedo.on("click",_.bind(this.onRedo,this)),t.btnCopy.on("click",_.bind(this.onCopyPaste,this,"copy")),t.btnPaste.on("click",_.bind(this.onCopyPaste,this,"paste")),t.btnSearch.on("toggle",_.bind(this.onSearch,this)),t.btnSortDown.on("click",_.bind(this.onSortType,this,Asc.c_oAscSortOptions.Ascending)),t.btnSortUp.on("click",_.bind(this.onSortType,this,Asc.c_oAscSortOptions.Descending)),t.btnSetAutofilter.on("click",_.bind(this.onAutoFilter,this)),t.btnClearAutofilter.on("click",_.bind(this.onClearFilter,this))):e.appConfig.isEditOle?(t.btnUndo.on("click",_.bind(this.onUndo,this)),t.btnRedo.on("click",_.bind(this.onRedo,this)),t.btnCopy.on("click",_.bind(this.onCopyPaste,this,"copy")),t.btnPaste.on("click",_.bind(this.onCopyPaste,this,"paste")),t.btnSearch.on("toggle",_.bind(this.onSearch,this)),t.btnInsertFormula.on("click",_.bind(this.onInsertFormulaMenu,this)),t.btnInsertFormula.menu.on("item:click",_.bind(this.onInsertFormulaMenu,this)),t.cmbNumberFormat.on("selected",_.bind(this.onNumberFormatSelect,this)),t.cmbNumberFormat.on("show:before",_.bind(this.onNumberFormatOpenBefore,this,!0)),t.cmbNumberFormat.cmpEl&&t.cmbNumberFormat.cmpEl.on("click","#id-toolbar-mnu-item-more-formats a",_.bind(this.onNumberFormatSelect,this)),t.btnWrap.on("click",_.bind(this.onWrap,this)),t.btnTextColor.on("click",_.bind(this.onTextColor,this)),t.btnTextColor.on("color:select",_.bind(this.onTextColorSelect,this)),t.btnTextColor.on("auto:select",_.bind(this.onAutoFontColor,this)),t.btnTextColor.on("eyedropper:start",_.bind(this.onEyedropperStart,this)),t.btnTextColor.on("eyedropper:end",_.bind(this.onEyedropperEnd,this)),t.btnBackColor.on("click",_.bind(this.onBackColor,this)),t.btnBackColor.on("color:select",_.bind(this.onBackColorSelect,this)),t.btnBackColor.on("eyedropper:start",_.bind(this.onEyedropperStart,this)),t.btnBackColor.on("eyedropper:end",_.bind(this.onEyedropperEnd,this)),t.btnBorders.on("click",_.bind(this.onBorders,this)),t.btnBorders.rendered&&(t.btnBorders.menu.on("item:click",_.bind(this.onBordersMenu,this)),t.mnuBorderWidth.on("item:toggle",_.bind(this.onBordersWidth,this)),t.mnuBorderColorPicker.on("select",_.bind(this.onBordersColor,this)),$("#id-toolbar-menu-auto-bordercolor").on("click",_.bind(this.onAutoBorderColor,this))),$("#id-toolbar-menu-new-bordercolor").on("click",_.bind(this.onNewBorderColor,this)),t.btnMerge.on("click",_.bind(this.onMergeCellsMenu,this,t.btnMerge.menu,t.btnMerge.menu.items[0])),t.btnMerge.menu.on("item:click",_.bind(this.onMergeCellsMenu,this)),t.btnTableTemplate.menu.on("show:after",_.bind(this.onTableTplMenuOpen,this)),t.btnCellStyle.menu.on("show:after",_.bind(this.onCellStyleMenuOpen,this)),t.btnVisibleArea.menu.on("item:click",_.bind(this.onVisibleAreaMenu,this)),t.btnVisibleAreaClose.on("click",_.bind(this.onVisibleAreaClose,this)),t.cmbFontName.on("selected",_.bind(this.onFontNameSelect,this)),t.cmbFontName.on("show:after",_.bind(this.onComboOpen,this,!0)),t.cmbFontName.on("hide:after",_.bind(this.onHideMenus,this)),t.cmbFontName.on("combo:blur",_.bind(this.onComboBlur,this)),t.cmbFontName.on("combo:focusin",_.bind(this.onComboOpen,this,!1)),t.cmbFontSize.on("selected",_.bind(this.onFontSizeSelect,this)),t.cmbFontSize.on("changed:before",_.bind(this.onFontSizeChanged,this,!0)),t.cmbFontSize.on("changed:after",_.bind(this.onFontSizeChanged,this,!1)),t.cmbFontSize.on("show:after",_.bind(this.onComboOpen,this,!0)),t.cmbFontSize.on("hide:after",_.bind(this.onHideMenus,this)),t.cmbFontSize.on("combo:blur",_.bind(this.onComboBlur,this)),t.cmbFontSize.on("combo:focusin",_.bind(this.onComboOpen,this,!1)),t.btnTextFormatting.menu.on("item:click",_.bind(this.onTextFormattingMenu,this)),t.btnHorizontalAlign.menu.on("item:click",_.bind(this.onHorizontalAlignMenu,this)),t.btnVerticalAlign.menu.on("item:click",_.bind(this.onVerticalAlignMenu,this))):(t.btnPrint.on("click",_.bind(this.onPrint,this)),t.btnPrint.on("disabled",_.bind(this.onBtnChangeState,this,"print:disabled")),t.btnPrint.menu&&t.btnPrint.menu.on("item:click",_.bind(this.onPrintMenu,this)),t.btnSave.on("click",_.bind(this.onSave,this)),t.btnSave.on("disabled",_.bind(this.onBtnChangeState,this,"save:disabled")),t.btnUndo.on("click",_.bind(this.onUndo,this)),t.btnUndo.on("disabled",_.bind(this.onBtnChangeState,this,"undo:disabled")),t.btnRedo.on("click",_.bind(this.onRedo,this)),t.btnRedo.on("disabled",_.bind(this.onBtnChangeState,this,"redo:disabled")),t.btnCopy.on("click",_.bind(this.onCopyPaste,this,"copy")),t.btnPaste.on("click",_.bind(this.onCopyPaste,this,"paste")),t.btnCut.on("click",_.bind(this.onCopyPaste,this,"cut")),t.btnSelectAll.on("click",_.bind(this.onSelectAll,this)),t.btnIncFontSize.on("click",_.bind(this.onIncreaseFontSize,this)),t.btnDecFontSize.on("click",_.bind(this.onDecreaseFontSize,this)),t.mnuChangeCase.on("item:click",_.bind(this.onChangeCase,this)),t.btnBold.on("click",_.bind(this.onBold,this)),t.btnItalic.on("click",_.bind(this.onItalic,this)),t.btnUnderline.on("click",_.bind(this.onUnderline,this)),t.btnStrikeout.on("click",_.bind(this.onStrikeout,this)),t.btnSubscript.on("click",_.bind(this.onSubscript,this)),t.btnSubscript.menu.on("item:click",_.bind(this.onSubscriptMenu,this)),t.btnTextColor.on("click",_.bind(this.onTextColor,this)),t.btnTextColor.on("color:select",_.bind(this.onTextColorSelect,this)),t.btnTextColor.on("auto:select",_.bind(this.onAutoFontColor,this)),t.btnTextColor.on("eyedropper:start",_.bind(this.onEyedropperStart,this)),t.btnTextColor.on("eyedropper:end",_.bind(this.onEyedropperEnd,this)),t.btnBackColor.on("click",_.bind(this.onBackColor,this)),t.btnBackColor.on("color:select",_.bind(this.onBackColorSelect,this)),t.btnBackColor.on("eyedropper:start",_.bind(this.onEyedropperStart,this)),t.btnBackColor.on("eyedropper:end",_.bind(this.onEyedropperEnd,this)),this.mode.isEdit&&Common.NotificationCenter.on("eyedropper:start",_.bind(this.eyedropperStart,this)),t.btnBorders.on("click",_.bind(this.onBorders,this)),t.btnBorders.rendered&&(t.btnBorders.menu.on("item:click",_.bind(this.onBordersMenu,this)),t.mnuBorderWidth.on("item:toggle",_.bind(this.onBordersWidth,this)),t.mnuBorderColorPicker.on("select",_.bind(this.onBordersColor,this)),$("#id-toolbar-menu-auto-bordercolor").on("click",_.bind(this.onAutoBorderColor,this))),t.btnAlignLeft.on("click",_.bind(this.onHorizontalAlign,this,AscCommon.align_Left)),t.btnAlignCenter.on("click",_.bind(this.onHorizontalAlign,this,AscCommon.align_Center)),t.btnAlignRight.on("click",_.bind(this.onHorizontalAlign,this,AscCommon.align_Right)),t.btnAlignJust.on("click",_.bind(this.onHorizontalAlign,this,AscCommon.align_Justify)),t.btnMerge.on("click",_.bind(this.onMergeCellsMenu,this,t.btnMerge.menu,t.btnMerge.menu.items[0])),t.btnMerge.menu.on("item:click",_.bind(this.onMergeCellsMenu,this)),t.btnAlignTop.on("click",_.bind(this.onVerticalAlign,this,Asc.c_oAscVAlign.Top)),t.btnAlignMiddle.on("click",_.bind(this.onVerticalAlign,this,Asc.c_oAscVAlign.Center)),t.btnAlignBottom.on("click",_.bind(this.onVerticalAlign,this,Asc.c_oAscVAlign.Bottom)),t.btnWrap.on("click",_.bind(this.onWrap,this)),t.btnTextOrient.menu.on("item:click",_.bind(this.onTextOrientationMenu,this)),t.btnInsertTable.on("click",_.bind(this.onBtnInsertTableClick,this)),t.btnInsertImage.menu.on("item:click",_.bind(this.onInsertImageMenu,this)),t.btnInsertHyperlink.on("click",_.bind(this.onHyperlink,this)),t.btnInsertText.on("click",_.bind(this.onBtnInsertTextClick,this)),t.btnInsertText.menu.on("item:click",_.bind(this.onMenuInsertTextClick,this)),t.btnInsertShape.menu.on("hide:after",_.bind(this.onInsertShapeHide,this)),t.btnInsertEquation.on("click",_.bind(this.onInsertEquationClick,this)),t.btnInsertSymbol.menu.items[2].on("click",_.bind(this.onInsertSymbolClick,this)),t.mnuInsertSymbolsPicker.on("item:click",_.bind(this.onInsertSymbolItemClick,this)),t.btnInsertSlicer.on("click",_.bind(this.onInsertSlicerClick,this)),t.btnTableTemplate.menu.on("show:after",_.bind(this.onTableTplMenuOpen,this)),t.btnPercentStyle.on("click",_.bind(this.onNumberFormat,this)),t.btnCurrencyStyle.on("click",_.bind(this.onNumberFormat,this)),t.btnDecDecimal.on("click",_.bind(this.onDecrement,this)),t.btnIncDecimal.on("click",_.bind(this.onIncrement,this)),t.btnInsertFormula.on("click",_.bind(this.onInsertFormulaMenu,this)),t.btnInsertFormula.menu.on("item:click",_.bind(this.onInsertFormulaMenu,this)),t.btnNamedRange.menu.on("item:click",_.bind(this.onNamedRangeMenu,this)),t.btnNamedRange.menu.on("show:after",_.bind(this.onNamedRangeMenuOpen,this)),t.btnClearStyle.menu.on("item:click",_.bind(this.onClearStyleMenu,this)),t.btnAddCell.menu.on("item:click",_.bind(this.onCellInsertMenu,this)),t.btnCopyStyle.on("toggle",_.bind(this.onCopyStyleToggle,this)),t.btnDeleteCell.menu.on("item:click",_.bind(this.onCellDeleteMenu,this)),t.btnColorSchemas.menu.on("item:click",_.bind(this.onColorSchemaClick,this)),t.btnColorSchemas.menu.on("show:after",_.bind(this.onColorSchemaShow,this)),t.cmbFontName.on("selected",_.bind(this.onFontNameSelect,this)),t.cmbFontName.on("show:after",_.bind(this.onComboOpen,this,!0)),t.cmbFontName.on("hide:after",_.bind(this.onHideMenus,this)),t.cmbFontName.on("combo:blur",_.bind(this.onComboBlur,this)),t.cmbFontName.on("combo:focusin",_.bind(this.onComboOpen,this,!1)),t.cmbFontSize.on("selected",_.bind(this.onFontSizeSelect,this)),t.cmbFontSize.on("changed:before",_.bind(this.onFontSizeChanged,this,!0)),t.cmbFontSize.on("changed:after",_.bind(this.onFontSizeChanged,this,!1)),t.cmbFontSize.on("show:after",_.bind(this.onComboOpen,this,!0)),t.cmbFontSize.on("hide:after",_.bind(this.onHideMenus,this)),t.cmbFontSize.on("combo:blur",_.bind(this.onComboBlur,this)),t.cmbFontSize.on("combo:focusin",_.bind(this.onComboOpen,this,!1)),t.listStyles.on("click",_.bind(this.onListStyleSelect,this)),t.cmbNumberFormat.on("selected",_.bind(this.onNumberFormatSelect,this)),t.cmbNumberFormat.on("show:before",_.bind(this.onNumberFormatOpenBefore,this,!0)),t.cmbNumberFormat.cmpEl&&t.cmbNumberFormat.cmpEl.on("click","#id-toolbar-mnu-item-more-formats a",_.bind(this.onNumberFormatSelect,this)),t.btnCurrencyStyle.menu.on("item:click",_.bind(this.onNumberFormatMenu,this)),$("#id-toolbar-menu-new-bordercolor").on("click",_.bind(this.onNewBorderColor,this)),t.btnPageOrient.menu.on("item:click",_.bind(this.onPageOrientSelect,this)),t.btnPageMargins.menu.on("item:click",_.bind(this.onPageMarginsSelect,this)),t.mnuPageSize.on("item:click",_.bind(this.onPageSizeClick,this)),t.mnuScale.on("item:click",_.bind(this.onScaleClick,this,"scale")),t.menuWidthScale.on("item:click",_.bind(this.onScaleClick,this,"width")),t.menuHeightScale.on("item:click",_.bind(this.onScaleClick,this,"height")),t.btnPrintArea.menu.on("item:click",_.bind(this.onPrintAreaClick,this)),t.btnPrintArea.menu.on("show:after",_.bind(this.onPrintAreaMenuOpen,this)),t.btnPageBreak.menu.on("item:click",_.bind(this.onPageBreakClick,this)),t.btnPageBreak.menu.on("show:after",_.bind(this.onPageBreakMenuOpen,this)),t.btnImgGroup.menu.on("item:click",_.bind(this.onImgGroupSelect,this)),t.btnImgBackward.menu.on("item:click",_.bind(this.onImgArrangeSelect,this)),t.btnImgForward.menu.on("item:click",_.bind(this.onImgArrangeSelect,this)),t.btnImgAlign.menu.on("item:click",_.bind(this.onImgAlignSelect,this)),t.btnImgForward.on("click",this.onImgArrangeSelect.bind(this,"forward")),t.btnImgBackward.on("click",this.onImgArrangeSelect.bind(this,"backward")),t.btnsEditHeader.forEach(function(t){t.on("click",_.bind(e.onEditHeaderClick,e,void 0))}),t.btnPrintTitles.on("click",_.bind(this.onPrintTitlesClick,this)),t.chPrintGridlines.on("change",_.bind(this.onPrintGridlinesChange,this)),t.chPrintHeadings.on("change",_.bind(this.onPrintHeadingsChange,this)),t.btnCondFormat.rendered&&t.btnCondFormat.menu.on("show:before",_.bind(this.onShowBeforeCondFormat,this,this.toolbar,"toolbar")),t.btnInsertChartRecommend.on("click",_.bind(this.onChartRecommendedClick,this)),t.btnFillNumbers.menu.on("item:click",_.bind(this.onFillNumMenu,this)),t.btnFillNumbers.menu.on("show:before",_.bind(this.onShowBeforeFillNumMenu,this)),Common.Gateway.on("insertimage",_.bind(this.insertImage,this)),this.onSetupCopyStyleButton())},setApi:function(t){this.api=t;t=SSE.getController("Main").appOptions;t.isEdit?(t.isEditDiagram||t.isEditMailMerge||t.isEditOle||(this.api.asc_registerCallback("asc_onSendThemeColors",_.bind(this.onSendThemeColors,this)),this.api.asc_registerCallback("asc_onMathTypes",_.bind(this.onApiMathTypes,this)),this.api.asc_registerCallback("asc_onContextMenu",_.bind(this.onContextMenu,this)),Common.NotificationCenter.on("storage:image-load",_.bind(this.openImageFromStorage,this)),Common.NotificationCenter.on("storage:image-insert",_.bind(this.insertImageFromStorage,this)),this.api.asc_registerCallback("asc_onSelectionMathChanged",_.bind(this.onApiMathChanged,this))),this.api.asc_registerCallback("asc_onInitEditorStyles",_.bind(this.onApiInitEditorStyles,this)),this.api.asc_registerCallback("asc_onCoAuthoringDisconnect",_.bind(this.onApiCoAuthoringDisconnect,this)),Common.NotificationCenter.on("api:disconnect",_.bind(this.onApiCoAuthoringDisconnect,this)),this.api.asc_registerCallback("asc_onLockDefNameManager",_.bind(this.onLockDefNameManager,this)),this.api.asc_registerCallback("asc_onLockCFManager",_.bind(this.onLockCFManager,this)),this.api.asc_registerCallback("asc_onUnLockCFManager",_.bind(this.onUnLockCFManager,this)),this.api.asc_registerCallback("asc_onZoomChanged",_.bind(this.onApiZoomChange,this)),Common.NotificationCenter.on("fonts:change",_.bind(this.onApiChangeFont,this)),this.api.asc_registerCallback("asc_onBeginSmartArtPreview",_.bind(this.onApiBeginSmartArtPreview,this)),this.api.asc_registerCallback("asc_onAddSmartArtPreview",_.bind(this.onApiAddSmartArtPreview,this)),this.api.asc_registerCallback("asc_onEndSmartArtPreview",_.bind(this.onApiEndSmartArtPreview,this))):t.isEditOle?Common.NotificationCenter.on("fonts:change",_.bind(this.onApiChangeFont,this)):t.isRestrictedEdit&&(this.api.asc_registerCallback("asc_onSelectionChanged",_.bind(this.onApiSelectionChangedRestricted,this)),Common.NotificationCenter.on("protect:wslock",_.bind(this.onChangeProtectSheet,this)))},onApiChangeFont:function(t){Common.Utils.ModalWindow.isVisible()||this.toolbar.cmbFontName.onApiChangeFont(t)},onContextMenu:function(){this.toolbar.collapse()},onPrint:function(t){"print"==this.toolbar.btnPrint.options.printType?Common.NotificationCenter.trigger("print",this.toolbar):this.getApplication().getController("Main").onPrintQuick()},onPrintMenu:function(t,e){var i=this.toolbar.btnPrint.options.printType,s=e.value;s!=i&&(this.toolbar.btnPrint.changeIcon({next:e.options.iconClsForMainBtn,curr:this.toolbar.btnPrint.menu.items.filter(function(t){return t.value==i})[0].options.iconClsForMainBtn}),this.toolbar.btnPrint.updateHint([e.caption+e.options.platformKey]),this.toolbar.btnPrint.options.printType=s),this.onPrint(e)},onSave:function(t){if(this.api){var e=this.api.asc_isDocumentCanSave(),i=this.toolbar.btnCollabChanges&&this.toolbar.btnCollabChanges.cmpEl.hasClass("notify");if(!e&&!i&&!this.toolbar.mode.forcesave)return;this.api.asc_Save()}Common.component.Analytics.trackEvent("Save"),Common.component.Analytics.trackEvent("ToolBar","Save")},onBtnChangeState:function(t){/\:disabled$/.test(t)&&this.toolbar.fireEvent(t,[arguments[2]])},onUndo:function(t,e){this.api&&this.api.asc_Undo(),Common.NotificationCenter.trigger("edit:complete",this.toolbar),Common.component.Analytics.trackEvent("ToolBar","Undo")},onRedo:function(t,e){this.api&&this.api.asc_Redo(),Common.NotificationCenter.trigger("edit:complete",this.toolbar),Common.component.Analytics.trackEvent("ToolBar","Redo")},onCopyPaste:function(t,e){var i=this;i.api&&(("cut"===t?i.api.asc_Cut():"copy"===t?i.api.asc_Copy():i.api.asc_Paste())?Common.component.Analytics.trackEvent("ToolBar","Copy Warning"):(t=Common.localStorage.getItem("sse-hide-copywarning"))&&1==parseInt(t)||new Common.Views.CopyWarningDialog({handler:function(t){t&&Common.localStorage.setItem("sse-hide-copywarning",1),Common.NotificationCenter.trigger("edit:complete",i.toolbar)}}).show()),Common.NotificationCenter.trigger("edit:complete",i.toolbar)},onSelectAll:function(t){this.api&&this.api.asc_EditSelectAll(),Common.NotificationCenter.trigger("edit:complete",this.toolbar),Common.component.Analytics.trackEvent("ToolBar","Select All")},onIncreaseFontSize:function(t){this.api&&this.api.asc_increaseFontSize(),Common.NotificationCenter.trigger("edit:complete",this.toolbar,{restorefocus:!0}),Common.component.Analytics.trackEvent("ToolBar","Font Size")},onDecreaseFontSize:function(t){this.api&&this.api.asc_decreaseFontSize(),Common.NotificationCenter.trigger("edit:complete",this.toolbar,{restorefocus:!0}),Common.component.Analytics.trackEvent("ToolBar","Font Size")},onChangeCase:function(t,e,i){this.api&&this.api.asc_ChangeTextCase(e.value),Common.NotificationCenter.trigger("edit:complete",this.toolbar,{restorefocus:!0})},onBold:function(t,e){this._state.bold=void 0,this.api&&this.api.asc_setCellBold(t.pressed),Common.NotificationCenter.trigger("edit:complete",this.toolbar,{restorefocus:!0}),Common.component.Analytics.trackEvent("ToolBar","Bold")},onItalic:function(t,e){this._state.italic=void 0,this.api&&this.api.asc_setCellItalic(t.pressed),Common.NotificationCenter.trigger("edit:complete",this.toolbar,{restorefocus:!0}),Common.component.Analytics.trackEvent("ToolBar","Italic")},onUnderline:function(t,e){this._state.underline=void 0,this.api&&this.api.asc_setCellUnderline(t.pressed),Common.NotificationCenter.trigger("edit:complete",this.toolbar,{restorefocus:!0}),Common.component.Analytics.trackEvent("ToolBar","Underline")},onStrikeout:function(t,e){this._state.strikeout=void 0,this.api&&this.api.asc_setCellStrikeout(t.pressed),Common.NotificationCenter.trigger("edit:complete",this.toolbar,{restorefocus:!0}),Common.component.Analytics.trackEvent("ToolBar","Strikeout")},onSubscriptMenu:function(t,e){var i=this.toolbar.btnSubscript;"sub"==e.value?(this._state.subscript=void 0,this.api.asc_setCellSubscript(e.checked)):(this._state.superscript=void 0,this.api.asc_setCellSuperscript(e.checked)),e.checked&&(i.$icon.removeClass(i.options.icls).addClass(e.options.icls),i.options.icls=e.options.icls),Common.NotificationCenter.trigger("edit:complete",this.toolbar,{restorefocus:!0}),Common.component.Analytics.trackEvent("ToolBar","sub"==e.value?"Subscript":"Superscript")},onSubscript:function(t,e){var i="btn-subscript"==t.options.icls;i?(this._state.subscript=void 0,this.api.asc_setCellSubscript(t.pressed)):(this._state.superscript=void 0,this.api.asc_setCellSuperscript(t.pressed)),Common.NotificationCenter.trigger("edit:complete",this.toolbar,{restorefocus:!0}),Common.component.Analytics.trackEvent("ToolBar",i?"Subscript":"Superscript")},onTextColor:function(){this.toolbar.mnuTextColorPicker.trigger("select",this.toolbar.mnuTextColorPicker,this.toolbar.mnuTextColorPicker.currentColor)},onBackColor:function(){this.toolbar.mnuBackColorPicker.trigger("select",this.toolbar.mnuBackColorPicker,this.toolbar.mnuBackColorPicker.currentColor)},onTextColorSelect:function(t,e){this._state.clrtext_asccolor=this._state.clrtext=void 0,this.toolbar.btnTextColor.currentColor=e,this.toolbar.mnuTextColorPicker.currentColor=e,this.api&&this.api.asc_setCellTextColor(e.isAuto?e.color:Common.Utils.ThemeColor.getRgbColor(e)),Common.NotificationCenter.trigger("edit:complete",this.toolbar,{restorefocus:!0}),Common.component.Analytics.trackEvent("ToolBar","Text Color")},onBackColorSelect:function(t,e){this._state.clrshd_asccolor=this._state.clrback=void 0,this.toolbar.btnBackColor.currentColor=e,this.toolbar.mnuBackColorPicker.currentColor=e,this.api&&this.api.asc_setCellBackgroundColor("transparent"==e?null:Common.Utils.ThemeColor.getRgbColor(e)),Common.component.Analytics.trackEvent("ToolBar","Background Color")},onNewBorderColor:function(t,e){this.toolbar.btnBorders.menu.hide(),this.toolbar.btnBorders.toggle(!1,!0),this.toolbar.mnuBorderColorPicker.addNewColor()},onAutoFontColor:function(t){this._state.clrtext_asccolor=this._state.clrtext=void 0;var e=new Asc.asc_CColor;e.put_auto(!0),this.toolbar.btnTextColor.currentColor={color:e,isAuto:!0},this.toolbar.mnuTextColorPicker.currentColor={color:e,isAuto:!0},this.api&&this.api.asc_setCellTextColor(e),Common.NotificationCenter.trigger("edit:complete",this.toolbar,{restorefocus:!0}),Common.component.Analytics.trackEvent("ToolBar","Text Color")},onBorders:function(e){var i;_.each(e.menu.items,function(t){if(e.options.borderId==t.options.borderId)return i=t,!1}),i&&this.onBordersMenu(e.menu,i)},onBordersMenu:function(t,e){var i,s,o,n;this.api&&!_.isUndefined(e.options.borderId)&&(s=[],o=(i=this.toolbar.btnBorders).options.borderswidth,n=i.options.borderscolor,i.rendered&&(i.$icon.removeClass(i.options.icls).addClass(e.options.icls),i.options.icls=e.options.icls),i.options.borderId=e.options.borderId,"inner"==e.options.borderId?(s[Asc.c_oAscBorderOptions.InnerV]=new Asc.asc_CBorder(o,n),s[Asc.c_oAscBorderOptions.InnerH]=new Asc.asc_CBorder(o,n)):"all"==e.options.borderId?(s[Asc.c_oAscBorderOptions.InnerV]=new Asc.asc_CBorder(o,n),s[Asc.c_oAscBorderOptions.InnerH]=new Asc.asc_CBorder(o,n),s[Asc.c_oAscBorderOptions.Left]=new Asc.asc_CBorder(o,n),s[Asc.c_oAscBorderOptions.Top]=new Asc.asc_CBorder(o,n),s[Asc.c_oAscBorderOptions.Right]=new Asc.asc_CBorder(o,n),s[Asc.c_oAscBorderOptions.Bottom]=new Asc.asc_CBorder(o,n)):"outer"==e.options.borderId?(s[Asc.c_oAscBorderOptions.Left]=new Asc.asc_CBorder(o,n),s[Asc.c_oAscBorderOptions.Top]=new Asc.asc_CBorder(o,n),s[Asc.c_oAscBorderOptions.Right]=new Asc.asc_CBorder(o,n),s[Asc.c_oAscBorderOptions.Bottom]=new Asc.asc_CBorder(o,n)):"none"!=e.options.borderId&&(s[e.options.borderId]=new Asc.asc_CBorder(o,n)),this.api.asc_setCellBorders(s),Common.NotificationCenter.trigger("edit:complete",this.toolbar),Common.component.Analytics.trackEvent("ToolBar","Borders"))},onBordersWidth:function(t,e,i){i&&(this.toolbar.btnBorders.options.borderswidth=e.value,Common.NotificationCenter.trigger("edit:complete",this.toolbar),Common.component.Analytics.trackEvent("ToolBar","Border Width"))},onBordersColor:function(t,e){$("#id-toolbar-mnu-item-border-color > a .menu-item-icon").css("border-color","#"+("object"==typeof e?e.color:e)),this.toolbar.mnuBorderColor.onUnHoverItem(),this.toolbar.btnBorders.options.borderscolor=Common.Utils.ThemeColor.getRgbColor(e),this.toolbar.mnuBorderColorPicker.currentColor=e;e=this.toolbar.btnBorders.menu.$el.find("#id-toolbar-menu-auto-bordercolor > a");e.hasClass("selected")&&e.removeClass("selected"),Common.NotificationCenter.trigger("edit:complete",this.toolbar),Common.component.Analytics.trackEvent("ToolBar","Border Color")},onAutoBorderColor:function(t){$("#id-toolbar-mnu-item-border-color > a .menu-item-icon").css("border-color","#000"),this.toolbar.mnuBorderColor.onUnHoverItem();var e=new Asc.asc_CColor,e=(e.put_auto(!0),this.toolbar.btnBorders.options.borderscolor=e,this.toolbar.mnuBorderColorPicker.clearSelection(),this.toolbar.mnuBorderColorPicker.currentColor={color:e,isAuto:!0},this.toolbar.btnBorders.menu.$el.find("#id-toolbar-menu-auto-bordercolor > a"));e.hasClass("selected")||e.addClass("selected"),Common.NotificationCenter.trigger("edit:complete",this.toolbar),Common.component.Analytics.trackEvent("ToolBar","Border Color")},onHorizontalAlign:function(t,e,i){this._state.pralign=void 0,this.api&&(this.api.asc_setCellAlign(e.pressed?t:null),this.toolbar.btnWrap.allowDepress=!(t==AscCommon.align_Justify)),Common.NotificationCenter.trigger("edit:complete",this.toolbar),Common.component.Analytics.trackEvent("ToolBar","Horizontal align")},onVerticalAlign:function(t,e,i){this._state.valign=void 0,this.api&&this.api.asc_setCellVertAlign(e.pressed?t:Asc.c_oAscVAlign.Bottom),Common.NotificationCenter.trigger("edit:complete",this.toolbar),Common.component.Analytics.trackEvent("ToolBar","Vertical align")},onMergeCellsMenu:function(t,e){var i=this;function s(t){i._state.merge=void 0,i.api.asc_mergeCells(t),Common.NotificationCenter.trigger("edit:complete",i.toolbar),Common.component.Analytics.trackEvent("ToolBar","Merge")}i.api&&(i.api.asc_getCellInfo().asc_getMerge()!==Asc.c_oAscMergeOptions.Merge&&i.api.asc_mergeCellsDataLost(e.value)?Common.UI.warning({msg:i.warnMergeLostData,buttons:["yes","no"],primary:"yes",callback:function(t){"yes"==t?s(e.value):(i.toolbar.btnMerge.toggle(!1,!0),Common.NotificationCenter.trigger("edit:complete",i.toolbar),Common.component.Analytics.trackEvent("ToolBar","Merge"))}}):s(e.value)),Common.NotificationCenter.trigger("edit:complete",this.toolbar),Common.component.Analytics.trackEvent("ToolBar","Merge cells")},onWrap:function(t,e){this._state.wrap=void 0,this.api&&this.api.asc_setCellTextWrap(t.pressed),Common.NotificationCenter.trigger("edit:complete",this.toolbar),Common.component.Analytics.trackEvent("ToolBar","Wrap")},onTextOrientationMenu:function(t,e){var i=0;switch(e.value){case"countcw":i=45;break;case"clockwise":i=-45;break;case"vertical":i=255;break;case"rotateup":i=90;break;case"rotatedown":i=-90}this._state.angle=void 0,this.api&&this.api.asc_setCellAngle(i),Common.NotificationCenter.trigger("edit:complete",this.toolbar),Common.component.Analytics.trackEvent("ToolBar","Text orientation")},onBtnInsertTableClick:function(t,e){this.api&&this._setTableFormat(this.api.asc_getDefaultTableStyle()),Common.NotificationCenter.trigger("edit:complete",this.toolbar),Common.component.Analytics.trackEvent("ToolBar","Table")},onInsertImageMenu:function(t,e,i){var s=this;"file"===e.value?(this.toolbar.fireEvent("insertimage",this.toolbar),this.api&&setTimeout(function(){s.api.asc_addImage()},1),Common.NotificationCenter.trigger("edit:complete",this.toolbar),Common.component.Analytics.trackEvent("ToolBar","Image")):"url"===e.value?new Common.Views.ImageFromUrlDialog({handler:function(t,e){"ok"==t&&(s.api&&(t=e.replace(/\s/g,""),_.isEmpty(t)?Common.UI.warning({msg:this.textEmptyImgUrl}):(s.toolbar.fireEvent("insertimage",s.toolbar),s.api.asc_addImageDrawingObject([t]),Common.component.Analytics.trackEvent("ToolBar","Image"))),Common.NotificationCenter.trigger("edit:complete",s.toolbar))}}).show():"storage"===e.value&&Common.NotificationCenter.trigger("storage:image-load","add")},openImageFromStorage:function(i){var s=this;this.toolbar.mode.canRequestInsertImage?Common.Gateway.requestInsertImage(i):new Common.Views.SelectFileDlg({fileChoiceUrl:this.toolbar.mode.fileChoiceUrl.replace("{fileExt}","").replace("{documentType}","ImagesOnly")}).on("selectfile",function(t,e){e&&(e.c=i),e.images||(e.images=[{fileType:e.fileType,url:e.url}]),e.url=null,s.insertImage(e)}).show()},insertImageFromStorage:function(t){!t||!t._urls||t.c&&"add"!=t.c||(this.toolbar.fireEvent("insertimage",this.toolbar),0<t._urls.length&&this.api.asc_addImageDrawingObject(t._urls,void 0,t.token),Common.component.Analytics.trackEvent("ToolBar","Image"))},insertImage:function(t){if(t&&(t.url||t.images)){t.url;var e=[];if(t.images&&0<t.images.length)for(var i=0;i<t.images.length;i++)t.images[i]&&t.images[i].url&&e.push(t.images[i].url);else t.url&&e.push(t.url);t._urls=e}Common.NotificationCenter.trigger("storage:image-insert",t)},onHyperlink:function(t){Common.NotificationCenter.trigger("protect:check",this.onHyperlinkCallback,this,[t])},onHyperlinkCallback:function(t){var i=this;if(i.api){for(var e=i.api.asc_getWorksheetsCount(),s=-1,o=[];++s<e;)o.push({name:i.api.asc_getWorksheetName(s),hidden:i.api.asc_isWorksheetHidden(s)});var n,a=i.api.asc_getCellInfo(),l=a.asc_getSelectionType(),r=a.asc_getHyperlink();(n=new SSE.Views.HyperlinkSettingsDialog({api:i.api,appOptions:i.appOptions,handler:function(t,e){"ok"==e&&(r=t.getSettings(),i.api.asc_insertHyperlink(r)),Common.NotificationCenter.trigger("edit:complete",i.toolbar)}})).show(),n.setSettings({sheets:o,ranges:i.api.asc_getDefinedNames(Asc.c_oAscGetDefinedNamesList.All,!0),currentSheet:i.api.asc_getActiveWorksheetIndex(),props:r,text:a.asc_getText(),isLock:a.asc_getLockText(),allowInternal:l!==Asc.c_oAscSelectionType.RangeImage&&l!==Asc.c_oAscSelectionType.RangeShape&&l!==Asc.c_oAscSelectionType.RangeShapeText&&l!==Asc.c_oAscSelectionType.RangeChart&&l!==Asc.c_oAscSelectionType.RangeChartText&&l!==Asc.c_oAscSelectionType.RangeSlicer})}Common.component.Analytics.trackEvent("ToolBar","Add Hyperlink")},onEditChart:function(t){if(this.editMode){var i=this,e=i.api.asc_getCellInfo().asc_getSelectionType();if(e!==Asc.c_oAscSelectionType.RangeImage)if(i.api){for(var s,o,n=i.api.asc_getChartObject(),a=i.api.asc_getGraphicObjectProps(),l=null,r=0;r<a.length;r++)a[r].asc_getObjectType()!=Asc.c_oAscTypeSelectElement.Image||(s=a[r].asc_getObjectValue()).asc_getChartProperties()&&(l=s);n&&(o=i.toolbar.mode.isEditDiagram||e===Asc.c_oAscSelectionType.RangeChart||e===Asc.c_oAscSelectionType.RangeChartText,new SSE.Views.ChartSettingsDlg({chartSettings:n,imageSettings:l,isChart:!0,api:i.api,handler:function(t,e){"ok"==t&&i.api&&(o?i.api.asc_editChartDrawingObject(e.chartSettings):i.api.asc_addChartDrawingObject(e.chartSettings),e.imageSettings&&i.api.asc_setGraphicObjectProps(e.imageSettings)),Common.NotificationCenter.trigger("edit:complete",i.toolbar)}}).show())}}},onEditChartData:function(t){var i,s;!this.editMode||(i=this).api&&(s=i.api.asc_getChartObject())&&(i._isEditRanges=!0,s.startEdit(),new SSE.Views.ChartDataDialog({chartSettings:s,api:i.api,handler:function(t,e){"ok"==t&&(s.endEdit(),i._isEditRanges=!1),Common.NotificationCenter.trigger("edit:complete",i)}}).on("close",function(){i._isEditRanges&&s.cancelEdit(),i._isEditRanges=!1}).show())},onEditChartType:function(t){var i,s;!this.editMode||(i=this).api&&(s=i.api.asc_getChartObject())&&(i._isEditType=!0,s.startEdit(),new SSE.Views.ChartTypeDialog({chartSettings:s,api:i.api,handler:function(t,e){"ok"==t&&(s.endEdit(),i._isEditType=!1),Common.NotificationCenter.trigger("edit:complete",i)}}).on("close",function(){i._isEditType&&s.cancelEdit(),i._isEditType=!1}).show())},onSelectChart:function(t,e){if(this.editMode){var i=this,s=i.api.asc_getCellInfo().asc_getSelectionType();if(i.api){var s=s==Asc.c_oAscSelectionType.RangeChart||s==Asc.c_oAscSelectionType.RangeChartText,o=i.api.asc_getChartObject(!0);if(o)if(s)o.changeType(e);else{o.putType(e);s=o.getRange(),e=_.isEmpty(s)?Asc.c_oAscError.ID.No:i.api.asc_checkDataRange(Asc.c_oAscSelectionDialogType.Chart,s,!0,o.getInRows(),o.getType());if(e==Asc.c_oAscError.ID.No)i.api.asc_addChartDrawingObject(o);else{var n=i.txtInvalidRange;switch(e){case Asc.c_oAscError.ID.StockChartError:n=i.errorStockChart;break;case Asc.c_oAscError.ID.MaxDataSeriesError:n=i.errorMaxRows;break;case Asc.c_oAscError.ID.ComboSeriesError:n=i.errorComboSeries;break;case Asc.c_oAscError.ID.MaxDataPointsError:n=i.errorMaxPoints}Common.UI.warning({msg:n,callback:function(){_.defer(function(t){Common.NotificationCenter.trigger("edit:complete",i.toolbar)})}})}}}Common.NotificationCenter.trigger("edit:complete",this.toolbar)}},onSelectSpark:function(i){var t,e,s;this.editMode&&(t=(e=(s=this).api.asc_getCellInfo()).asc_getSelectionType(),!s.api||t!=Asc.c_oAscSelectionType.RangeCells&&t!=Asc.c_oAscSelectionType.RangeCol&&t!=Asc.c_oAscSelectionType.RangeRow&&t!=Asc.c_oAscSelectionType.RangeMax||((t=e.asc_getSparklineInfo())?((e=new Asc.sparklineGroup).asc_setType(i),this.api.asc_setSparklineGroup(t.asc_getId(),e)):(s=this,new SSE.Views.CreateSparklineDialog({api:s.api,props:{selectedCells:s._state.selectedCells},handler:function(t,e){"ok"==t&&e&&(s.view&&s.view.fireEvent("insertspark",s.view),e.destination&&s.api.asc_addSparklineGroup(i,e.source,e.destination)),Common.NotificationCenter.trigger("edit:complete",s)}}).show())),Common.NotificationCenter.trigger("edit:complete",this.toolbar))},onApiMathChanged:function(t){this._state.selectedCells=t.asc_getCount()},onInsertTextart:function(t){this.api&&(this.toolbar.fireEvent("inserttextart",this.toolbar),this.api.asc_addTextArt(t),this.toolbar.btnInsertShape.pressed&&this.toolbar.btnInsertShape.toggle(!1,!0),Common.NotificationCenter.trigger("edit:complete",this.toolbar,this.toolbar.btnInsertTextArt),Common.component.Analytics.trackEvent("ToolBar","Add Text Art"))},onBtnInsertTextClick:function(e,t){e.menu.items.forEach(function(t){t.value==e.options.textboxType&&t.setChecked(!0)}),this.toolbar.btnInsertText.pressed||this.toolbar.btnInsertText.menu.clearAll(),this.onInsertText(e.options.textboxType,e,t)},onMenuInsertTextClick:function(t,e){var i=this.toolbar.btnInsertText.options.textboxType,s=e.value;this.toolbar.btnInsertText.toggle(!0),s!=i&&(this.toolbar.btnInsertText.changeIcon({next:e.options.iconClsForMainBtn,curr:this.toolbar.btnInsertText.menu.items.filter(function(t){return t.value==i})[0].options.iconClsForMainBtn}),this.toolbar.btnInsertText.updateHint([e.caption,this.views.Toolbar.prototype.tipInsertText]),this.toolbar.btnInsertText.options.textboxType=s),this.onInsertText(s,t,e)},onInsertText:function(t,e,i){this.api&&this._addAutoshape(this.toolbar.btnInsertText.pressed,t),this.toolbar.btnInsertShape.pressed&&this.toolbar.btnInsertShape.toggle(!1,!0),Common.NotificationCenter.trigger("edit:complete",this.toolbar,this.toolbar.btnInsertShape),Common.component.Analytics.trackEvent("ToolBar","Add Text")},onInsertShapeHide:function(t,e){this.toolbar.btnInsertShape.pressed&&!this._isAddingShape&&this.toolbar.btnInsertShape.toggle(!1,!0),this._isAddingShape=!1,Common.NotificationCenter.trigger("edit:complete",this.toolbar)},onSortType:function(t,e){Common.NotificationCenter.trigger("protect:check",this.onSortTypeCallback,this,[t,e])},onSortTypeCallback:function(e,t){if(this.api)if(this.api.asc_getCellInfo().asc_getSelectionType()==Asc.c_oAscSelectionType.RangeSlicer){for(var i=this.api.asc_getGraphicObjectProps(),s=0;s<i.length;s++)if(i[s].asc_getObjectType()==Asc.c_oAscTypeSelectElement.Image){var o=i[s].asc_getObjectValue();if(o.asc_getSlicerProperties()){o.asc_getSlicerProperties().asc_setSortOrder(e==Asc.c_oAscSortOptions.Ascending?Asc.ST_tabularSlicerCacheSortOrder.Ascending:Asc.ST_tabularSlicerCacheSortOrder.Descending),this.api.asc_setGraphicObjectProps(o);break}}Common.NotificationCenter.trigger("edit:complete",this.toolbar)}else{var n=this,a=this.api.asc_sortCellsRangeExpand();switch(a){case Asc.c_oAscSelectionSortExpand.showExpandMessage:var l={width:500,title:this.txtSorting,msg:this.txtExpandSort,buttons:[{caption:this.txtExpand,primary:!0,value:"expand"},{caption:this.txtSortSelected,primary:!0,value:"sort"},"cancel"],callback:function(t){"expand"!=t&&"sort"!=t||n.api.asc_sortColFilter(e,"",void 0,void 0,"expand"==t)}};Common.UI.alert(l);break;case Asc.c_oAscSelectionSortExpand.showLockMessage:l={width:500,title:this.txtSorting,msg:this.txtLockSort,buttons:["yes","no"],primary:"yes",callback:function(t){"yes"==t&&n.api.asc_sortColFilter(e,"",void 0,void 0,!1)}};Common.UI.alert(l);break;case Asc.c_oAscSelectionSortExpand.expandAndNotShowMessage:case Asc.c_oAscSelectionSortExpand.notExpandAndNotShowMessage:this.api.asc_sortColFilter(e,"",void 0,void 0,a===Asc.c_oAscSelectionSortExpand.expandAndNotShowMessage)}}},searchShow:function(){this.toolbar.btnSearch&&(this.searchBar&&this.searchBar.isVisible()?this.searchBar.focus():this.toolbar.btnSearch.toggle(!0))},onSearch:function(t,e){this.searchBar||(this.searchBar=new Common.UI.SearchBar({showOpenPanel:!1,width:303}),this.searchBar.on("hide",_.bind(function(){this.toolbar.btnSearch.toggle(!1,!0)},this))),this.toolbar.btnSearch.pressed?this.searchBar.show(this.api.asc_GetSelectedText()):this.searchBar.hide()},onAutoFilter:function(t){var e=this._state.filter;this._state.filter=void 0,this.api&&(this._state.tablename||e?this.api.asc_changeAutoFilter(this._state.tablename,Asc.c_oAscChangeFilterOptions.filter,!e):this.api.asc_addAutoFilter()),Common.NotificationCenter.trigger("edit:complete",this.toolbar),Common.component.Analytics.trackEvent("ToolBar","Auto filter")},onClearFilter:function(t){this.api&&this.api.asc_clearFilter(),Common.NotificationCenter.trigger("edit:complete",this.toolbar),Common.component.Analytics.trackEvent("ToolBar","Clear filter")},onNumberFormat:function(t){this.api&&this.api.asc_setCellStyle(t.options.styleName),Common.NotificationCenter.trigger("edit:complete",this.toolbar),Common.component.Analytics.trackEvent("ToolBar","Number Format")},onNumberFormatMenu:function(t,e){var i,s;this.api&&(-1==e.value?this._state.numformatinfo&&this._state.numformatinfo.asc_getType()==Asc.c_oAscNumFormatType.Accounting?this.onCustomNumberFormat():(s=(s=this.api.asc_getLocale())||(this.toolbar.mode.lang?parseInt(Common.util.LanguageInfo.getLocalLanguageCode(this.toolbar.mode.lang)):1033),(i=new Asc.asc_CFormatCellsInfo).asc_setType(Asc.c_oAscNumFormatType.Accounting),i.asc_setSeparator(!1),i.asc_setSymbol(s),s=this.api.asc_getFormatCells(i),this.onCustomNumberFormat(s&&0<s.length?s[0]:void 0,i)):((i=new Asc.asc_CFormatCellsInfo).asc_setType(Asc.c_oAscNumFormatType.Accounting),i.asc_setSeparator(!1),i.asc_setSymbol(e.value),(s=this.api.asc_getFormatCells(i))&&0<s.length&&this.api.asc_setCellFormat(s[0]))),Common.NotificationCenter.trigger("edit:complete",this.toolbar),Common.component.Analytics.trackEvent("ToolBar","Number Format")},onNumberFormatSelect:function(t,e){e?this.api&&this.api.asc_setCellFormat(e.format):this.onCustomNumberFormat(),Common.NotificationCenter.trigger("edit:complete",this.toolbar),Common.component.Analytics.trackEvent("ToolBar","Number Format")},onCustomNumberFormat:function(t,e){var i=this,s=(s=i.api.asc_getLocale())||(i.toolbar.mode.lang?parseInt(Common.util.LanguageInfo.getLocalLanguageCode(i.toolbar.mode.lang)):1033);new SSE.Views.FormatSettingsDialog({api:i.api,handler:function(t,e){e&&i.api.asc_setCellFormat(e.format),Common.NotificationCenter.trigger("edit:complete",i.toolbar)},props:{format:t||i._state.numformat,formatInfo:e||i._state.numformatinfo,langId:s}}).show(),Common.NotificationCenter.trigger("edit:complete",this.toolbar),Common.component.Analytics.trackEvent("ToolBar","Number Format")},onNumberFormatOpenBefore:function(t){var i,s,e;this.api&&(e=(e=(i=this).api.asc_getLocale())||(i.toolbar.mode.lang?parseInt(Common.util.LanguageInfo.getLocalLanguageCode(i.toolbar.mode.lang)):1033),this._state.langId!==e&&(this._state.langId=e,(e=new Asc.asc_CFormatCellsInfo).asc_setType(Asc.c_oAscNumFormatType.None),e.asc_setSymbol(this._state.langId),s=this.api.asc_getFormatCells(e),i.toolbar.numFormatData.forEach(function(t,e){i.toolbar.numFormatData[e].format=s[e]})),i.toolbar.numFormatData.forEach(function(t,e){t.exampleval=i.api.asc_getLocaleExample(t.format)}),i.toolbar.cmbNumberFormat.setData(i.toolbar.numFormatData),i.toolbar.cmbNumberFormat.setValue(i._state.numformattype,i.toolbar.txtCustom))},onDecrement:function(t){this.api&&this.api.asc_decreaseCellDigitNumbers(),Common.NotificationCenter.trigger("edit:complete",this.toolbar),Common.component.Analytics.trackEvent("ToolBar","Decrement")},onIncrement:function(t){this.api&&this.api.asc_increaseCellDigitNumbers(),Common.NotificationCenter.trigger("edit:complete",this.toolbar),Common.component.Analytics.trackEvent("ToolBar","Increment")},onInsertFormulaMenu:function(t,e,i){var s;this.api&&("more"===e.value?(s=this.getApplication().getController("FormulaDialog"))&&s.showDialog():(e.value=e.value||"SUM",this.toolbar.fireEvent("function:apply",[{name:this.api.asc_getFormulaLocaleName(e.value),origin:e.value},!0]),Common.NotificationCenter.trigger("edit:complete",this.toolbar),Common.component.Analytics.trackEvent("ToolBar","Insert formula")))},onNamedRangeMenu:function(t,e,i){if(this.api){var s=this;if("paste"===e.value)new SSE.Views.NamedRangePasteDlg({handler:function(t,e){"ok"==t&&e&&(s.api.asc_insertInCell(e.asc_getName(!0),e.asc_getType()===Asc.c_oAscDefNameType.table?Asc.c_oAscPopUpSelectorType.Table:Asc.c_oAscPopUpSelectorType.Range,!1),Common.component.Analytics.trackEvent("ToolBar","Paste Named Range")),Common.NotificationCenter.trigger("edit:complete",s.toolbar)},ranges:s.api.asc_getDefinedNames(Asc.c_oAscGetDefinedNamesList.WorksheetWorkbook)}).show(),Common.component.Analytics.trackEvent("ToolBar","Paste Named Range");else{var o=s.api.asc_getWorksheetsCount(),n=-1,a=[],l=[];if("new"===e.value)if(this._state.namedrange_locked)Common.NotificationCenter.trigger("namedrange:locked");else{for(;++n<o;)this.api.asc_isWorksheetHidden(n)||a.push({displayValue:s.api.asc_getWorksheetName(n),value:n});new SSE.Views.NamedRangeEditDlg({api:s.api,handler:function(t,e){"ok"==t&&e&&(s.api.asc_setDefinedNames(e),Common.component.Analytics.trackEvent("ToolBar","New Named Range")),Common.NotificationCenter.trigger("edit:complete",s.toolbar)},sheets:a,props:s.api.asc_getDefaultDefinedName(),isEdit:!1}).show()}else{for(var r=this.getApplication().getController("CellEditor");++n<o;)this.api.asc_isWorksheetHidden(n)||(l[n]=s.api.asc_getWorksheetName(n),a.push({displayValue:l[n],value:n}));new SSE.Views.NameManagerDlg({api:s.api,handler:function(t){Common.component.Analytics.trackEvent("ToolBar","Name Manager"),Common.NotificationCenter.trigger("edit:complete",s.toolbar)},locked:s._state.namedrange_locked,sheets:a,sheetNames:l,ranges:s.api.asc_getDefinedNames(Asc.c_oAscGetDefinedNamesList.All),props:s.api.asc_getDefaultDefinedName(),sort:r.rangeListSort}).on("close",function(t){r.rangeListSort=t.getSettings()}).show()}}}},onNamedRangeMenuOpen:function(t){var e;this.api&&t&&(e=this.api.asc_getDefinedNames(Asc.c_oAscGetDefinedNamesList.WorksheetWorkbook),t.items[2].setDisabled(e.length<1||this._state.isUserProtected))},onClearStyleMenu:function(t,e,i){(e.value!=Asc.c_oAscCleanOptions.Format||this._state.wsProps.FormatCells&&this.api.asc_checkLockedCells())&&(e.value!=Asc.c_oAscCleanOptions.All||this.api.asc_checkLockedCells())?e.value==Asc.c_oAscCleanOptions.Comments?this._state.wsProps.Objects?Common.NotificationCenter.trigger("showerror",Asc.c_oAscError.ID.ChangeOnProtectedSheet,Asc.c_oAscError.Level.NoCritical):this.onClearStyleMenuCallback(t,e):Common.NotificationCenter.trigger("protect:check",this.onClearStyleMenuCallback,this,[t,e]):this.onClearStyleMenuCallback(t,e)},onClearStyleMenuCallback:function(t,e,i){this.api&&(e.value==Asc.c_oAscCleanOptions.Comments?this.api.asc_RemoveAllComments(!this.mode.canDeleteComments,!0):this.api.asc_emptyCells(e.value,e.value==Asc.c_oAscCleanOptions.All&&!this.mode.canDeleteComments)),Common.NotificationCenter.trigger("edit:complete",this.toolbar),Common.component.Analytics.trackEvent("ToolBar","Clear")},onCopyStyleToggle:function(t,e,i){this.api&&this.api.asc_formatPainter(e?1:0),Common.NotificationCenter.trigger("edit:complete",this.toolbar),this.modeAlwaysSetStyle=e},onCellInsertMenu:function(t,e,i){this.api&&this.api.asc_insertCells(e.value),Common.NotificationCenter.trigger("edit:complete",this.toolbar),Common.component.Analytics.trackEvent("ToolBar","Cell insert")},onCellDeleteMenu:function(t,e,i){this.api&&this.api.asc_deleteCells(e.value),Common.NotificationCenter.trigger("edit:complete",this.toolbar),Common.component.Analytics.trackEvent("ToolBar","Cell delete")},onColorSchemaClick:function(t,e){this.api&&(this.api.asc_ChangeColorSchemeByIdx(e.value),Common.component.Analytics.trackEvent("ToolBar","Color Scheme")),Common.NotificationCenter.trigger("edit:complete",this.toolbar)},onColorSchemaShow:function(t){var e,i;this.api&&(e=this.api.asc_GetCurrentColorSchemeIndex(),(i=_.find(t.items,function(t){return t.value==e}))?i.setChecked(!0):t.clearAll())},onComboBlur:function(){Common.NotificationCenter.trigger("edit:complete",this.toolbar)},onFontNameSelect:function(t,e){this.api&&(e.isNewFont?Common.Utils.ModalWindow.isVisible()||Common.UI.warning({width:500,msg:this.confirmAddFontName,buttons:["yes","no"],primary:"yes",callback:_.bind(function(t){"yes"==t?(this.api.asc_setCellFontName(e.name),Common.component.Analytics.trackEvent("ToolBar","Font Name")):this.toolbar.cmbFontName.setValue(this.api.asc_getCellInfo().asc_getXfs().asc_getFontName()),Common.NotificationCenter.trigger("edit:complete",this.toolbar,{restorefocus:!0})},this)}):(this.api.asc_setCellFontName(e.name),Common.component.Analytics.trackEvent("ToolBar","Font Name"))),Common.NotificationCenter.trigger("edit:complete",this.toolbar,{restorefocus:!0})},onComboOpen:function(e,i,t,s){s&&s.fromKeyDown||_.delay(function(){var t=$("input",i.cmpEl).select();e?t.focus():i.isMenuOpen()||t.one("mouseup",function(t){t.preventDefault()})},10)},onFontSizeSelect:function(t,e){this._state.fontsize=void 0,this.api&&this.api.asc_setCellFontSize(e.value),Common.NotificationCenter.trigger("edit:complete",this.toolbar,{restorefocus:!0}),Common.component.Analytics.trackEvent("ToolBar","Font Size")},onFontSizeChanged:function(t,e,i,s){var o,n=this;if(t){t=e.store.findWhere({displayValue:i.value});if(!t&&!(o=/^\+?(\d*(\.|,)?\d+)$|^\+?(\d+(\.|,)?\d*)$/.exec(i.value)))return o=this._getApiTextSize(),setTimeout(function(){Common.UI.warning({msg:n.textFontSizeErr,callback:function(){_.defer(function(t){$("input",e.cmpEl).focus()})}})},1),e.setRawValue(o),s.preventDefault(),!1}else o=409<(o=Common.Utils.String.parseFloat(i.value))?409:o<1?1:Math.floor(2*(o+.4))/2,e.setRawValue(o),this._state.fontsize=void 0,this.api&&this.api.asc_setCellFontSize(o),Common.NotificationCenter.trigger("edit:complete",this.toolbar)},onListStyleSelect:function(t,e){this._state.prstyle=void 0,this.api&&(this.api.asc_setCellStyle(e.get("name")),Common.NotificationCenter.trigger("edit:complete",this.toolbar),Common.component.Analytics.trackEvent("ToolBar","Style"))},onShowBeforeCondFormat:function(o,t){if(!(0<o.mnuDataBars.menu.items.length)){o.btnCondFormat.menu.on("item:click",_.bind(this.onCondFormatMenu,this));for(var e=0;e<7;e++)o.btnCondFormat.menu.items[e].menu.on("item:click",_.bind(this.onCondFormatMenu,this));o.btnCondFormat.menu.items[15].menu.on("item:click",_.bind(this.onCondFormatMenu,this));for(var i=SSE.getCollection("ConditionalFormatIconsPresets"),s=(i.length<1&&SSE.getController("Main").fillCondFormatIconsPresets(this.api.asc_getCFIconsByType()),SSE.getCollection("ConditionalFormatIcons")),n=(s.length<1&&SSE.getController("Main").fillCondFormatIcons(this.api.asc_getFullCFIcons()),this),a=o.mnuDataBars,l=(a.menu.addItem(new Common.UI.MenuItem({template:_.template('<div id="id-'+t+'-menu-databar" class="menu-shapes margin-left-5" style="width: 203px;"></div>')})),new Common.UI.DataViewSimple({el:$("#id-"+t+"-menu-databar",a.$el),parentMenu:a.menu,itemTemplate:_.template('<div class="item-databar" id="<%= id %>"><svg width="25" height="25" class="icon uni-scale"><use xlink:href="#bar-<%= data.name %>"></use></svg></div>')})),r=(l.on("item:click",function(t,e,i,s){n.api&&(i&&n.api.asc_setCF([],[],[Asc.c_oAscCFRuleTypeSettings.dataBar,i.get("data").index]),"click"!==s.type&&o.btnCondFormat.menu.hide(),Common.NotificationCenter.trigger("edit:complete",o,o.btnCondFormat))}),[{data:{name:"gradient-blue",index:0}},{data:{name:"gradient-green",index:1}},{data:{name:"gradient-red",index:2}},{data:{name:"gradient-yellow",index:3}},{data:{name:"gradient-lightblue",index:4}},{data:{name:"gradient-purple",index:5}},{data:{name:"solid-blue",index:6}},{data:{name:"solid-green",index:7}},{data:{name:"solid-red",index:8}},{data:{name:"solid-yellow",index:9}},{data:{name:"solid-lightblue",index:10}},{data:{name:"solid-purple",index:11}}]),c=(l.setStore(new Common.UI.DataViewStore(r)),(a=o.mnuColorScales).menu.addItem(new Common.UI.MenuItem({template:_.template('<div id="id-'+t+'-menu-colorscales" class="menu-shapes margin-left-5" style="width: 136px;"></div>')})),(l=new Common.UI.DataViewSimple({el:$("#id-"+t+"-menu-colorscales",a.$el),parentMenu:a.menu,itemTemplate:_.template('<div class="item-colorscale" id="<%= id %>"><svg width="25" height="25" class="icon uni-scale"><use xlink:href="#color-scale-<%= data.name %>"></use></svg></div>')})).on("item:click",function(t,e,i,s){n.api&&(i&&n.api.asc_setCF([],[],[Asc.c_oAscCFRuleTypeSettings.colorScale,i.get("data").index]),"click"!==s.type&&o.btnCondFormat.menu.hide(),Common.NotificationCenter.trigger("edit:complete",o,o.btnCondFormat))}),l.setStore(new Common.UI.DataViewStore(r=[{data:{name:"green-yellow-red",index:0}},{data:{name:"red-yellow-green",index:1}},{data:{name:"green-white-red",index:2}},{data:{name:"red-white-green",index:3}},{data:{name:"blue-white-red",index:4}},{data:{name:"red-white-blue",index:5}},{data:{name:"white-red",index:6}},{data:{name:"red-white",index:7}},{data:{name:"green-white",index:8}},{data:{name:"white-green",index:9}},{data:{name:"green-yellow",index:10}},{data:{name:"yellow-green",index:11}}])),(a=o.mnuIconSets).menu.addItem(new Common.UI.MenuItem({template:_.template('<div id="id-'+t+'-menu-iconsets" class="menu-iconsets" style="width: 227px;"></div>')})),r=[],[Asc.EIconSetType.Arrows3,Asc.EIconSetType.Arrows3Gray,Asc.EIconSetType.Triangles3,Asc.EIconSetType.Arrows4Gray,Asc.EIconSetType.Arrows4,Asc.EIconSetType.Arrows5Gray,Asc.EIconSetType.Arrows5]),e=0;e<c.length;e++)r.push({group:"menu-iconset-group-direct",data:{index:c[e],iconSet:i.at([c[e]]).get("icons"),icons:s}});for(c=[Asc.EIconSetType.Traffic3Lights1,Asc.EIconSetType.Traffic3Lights2,Asc.EIconSetType.Signs3,Asc.EIconSetType.Traffic4Lights,Asc.EIconSetType.RedToBlack4],e=0;e<c.length;e++)r.push({group:"menu-iconset-group-shape",data:{index:c[e],iconSet:i.at([c[e]]).get("icons"),icons:s}});c=[Asc.EIconSetType.Symbols3,Asc.EIconSetType.Symbols3_2,Asc.EIconSetType.Flags3];for(e=0;e<c.length;e++)r.push({group:"menu-iconset-group-indicator",data:{index:c[e],iconSet:i.at([c[e]]).get("icons"),icons:s}});c=[Asc.EIconSetType.Stars3,Asc.EIconSetType.Rating4,Asc.EIconSetType.Quarters5,Asc.EIconSetType.Rating5,Asc.EIconSetType.Boxes5];for(e=0;e<c.length;e++)r.push({group:"menu-iconset-group-rating",data:{index:c[e],iconSet:i.at([c[e]]).get("icons"),icons:s}});(l=new Common.UI.DataView({el:$("#id-"+t+"-menu-iconsets",a.$el),parentMenu:a.menu,groups:new Common.UI.DataViewGroupStore([{id:"menu-iconset-group-direct",caption:this.textDirectional},{id:"menu-iconset-group-shape",caption:this.textShapes},{id:"menu-iconset-group-indicator",caption:this.textIndicator},{id:"menu-iconset-group-rating",caption:this.textRating}]),store:new Common.UI.DataViewStore(r),showLast:!1,itemTemplate:_.template('<div class="item-iconset" id="<%= id %>"><% _.each(data.iconSet, function(icon) { %><img src="<%= data.icons.at(icon-1).get(\'icon\') %>" style="width:16px;height:16px;"><% }) %></div>')})).on("item:click",function(t,e,i,s){n.api&&(i&&n.api.asc_setCF([],[],[Asc.c_oAscCFRuleTypeSettings.icons,i.get("data").index]),"click"!==s.type&&o.btnCondFormat.menu.hide(),Common.NotificationCenter.trigger("edit:complete",o,o.btnCondFormat))})}},onCondFormatMenu:function(t,e){var i=this,s=(s=this.api.asc_getLocale())||(this.toolbar.mode.lang?parseInt(Common.util.LanguageInfo.getLocalLanguageCode(this.toolbar.mode.lang)):1033);"manage"==e.value?new SSE.Views.FormatRulesManagerDlg({api:i.api,langId:s,locked:!!i._state.cf_locked[this.api.asc_getActiveWorksheetIndex()],handler:function(t,e){i&&i.api&&"ok"==t&&i.api.asc_setCF(e.rules,e.deleted)}}).show():"clear"==e.value?i.api.asc_clearCF(e.options.type):new SSE.Views.FormatRulesEditDlg({api:i.api,props:null,type:e.options.type,subtype:e.value,percent:e.options.percent,isEdit:!1,langId:s,handler:function(t,e){"ok"==t&&e&&i.api.asc_setCF([e],[])}}).show()},createDelayedElements:function(){var a=this,t=(this.toolbar.createDelayedElements(),this.attachUIEvents(this.toolbar),this.appConfig.isEditDiagram||this.appConfig.isEditMailMerge||this.appConfig.isEditOle||(this.api.asc_registerCallback("asc_onSheetsChanged",_.bind(this.onApiSheetChanged,this)),this.api.asc_registerCallback("asc_onUpdateSheetViewSettings",_.bind(this.onApiSheetChanged,this)),this.api.asc_registerCallback("asc_onEndAddShape",_.bind(this.onApiEndAddShape,this)),this.api.asc_registerCallback("asc_onEditorSelectionChanged",_.bind(this.onApiEditorSelectionChanged,this)),this.api.asc_registerCallback("asc_onUpdateDocumentProps",_.bind(this.onUpdateDocumentProps,this)),this.api.asc_registerCallback("asc_onLockDocumentProps",_.bind(this.onApiLockDocumentProps,this)),this.api.asc_registerCallback("asc_onUnLockDocumentProps",_.bind(this.onApiUnLockDocumentProps,this)),Common.NotificationCenter.on("protect:wslock",_.bind(this.onChangeProtectSheet,this))),this.appConfig.isEditOle&&this.api.asc_registerCallback("asc_onEditorSelectionChanged",_.bind(this.onApiEditorSelectionChanged_OleEditor,this)),this.appConfig.isEditMailMerge||this.applyFormulaSettings(),this.api.asc_registerCallback("asc_onShowChartDialog",_.bind(this.onApiChartDblClick,this)),this.api.asc_registerCallback("asc_onCanUndoChanged",_.bind(this.onApiCanRevert,this,"undo")),this.api.asc_registerCallback("asc_onCanRedoChanged",_.bind(this.onApiCanRevert,this,"redo")),this.api.asc_registerCallback("asc_onEditCell",_.bind(this.onApiEditCell,this)),this.api.asc_registerCallback("asc_onStopFormatPainter",_.bind(this.onApiStyleChange,this)),this.api.asc_registerCallback("asc_onSelectionChanged",_.bind(this.onApiSelectionChanged,this)),{"command+l,ctrl+l":function(t){var e,i;return a.editMode&&!a._state.multiselect&&a.appConfig.canModifyFilter&&!a._state.wsLock&&(i=(e=a.api.asc_getCellInfo()).asc_getAutoFilterInfo(),e=e.asc_getFormatTableInfo(),null===(i=i?i.asc_getIsAutoFilter():null)||e||a._setTableFormat(a.api.asc_getDefaultTableStyle())),!1},"command+shift+l,ctrl+shift+l":function(t){var e;return a.editMode&&a.api&&!a._state.multiselect&&a.appConfig.canModifyFilter&&!a._state.wsLock&&(e=a._state.filter,a._state.filter=void 0,a._state.tablename||e?a.api.asc_changeAutoFilter(a._state.tablename,Asc.c_oAscChangeFilterOptions.filter,!e):a.api.asc_addAutoFilter()),!1},"command+s,ctrl+s":function(t){a.onSave(),t.preventDefault(),t.stopPropagation()},"command+k,ctrl+k":function(t){!a.editMode||a.toolbar.mode.isEditMailMerge||a.toolbar.mode.isEditDiagram||a.toolbar.mode.isEditOle||a.api.isCellEdited||a._state.multiselect||a._state.inpivot||a.getApplication().getController("LeftMenu").leftMenu.menuFile.isVisible()||a._state.wsProps.InsertHyperlinks||a.api.asc_getCellInfo().asc_getSelectionType()===Asc.c_oAscSelectionType.RangeShapeText&&!1===a.api.asc_canAddShapeHyperlink()||a.onHyperlink(),t.preventDefault()},"command+1,ctrl+1":function(t){return!a.editMode||a.toolbar.mode.isEditMailMerge||a.toolbar.mode.isEditOle||a.api.isCellEdited||a.toolbar.cmbNumberFormat.isDisabled()||a.onCustomNumberFormat(),!1},"shift+f3":function(t){var e;return a.editMode&&!a.toolbar.btnInsertFormula.isDisabled()&&(e=a.getApplication().getController("FormulaDialog"))&&e.showDialog(),!1}});t["command+shift+=,ctrl+shift+=,command+shift+numplus,ctrl+shift+numplus"+(Common.Utils.isGecko?",command+shift+ff=,ctrl+shift+ff=":"")+(Common.Utils.isMac?",command+shift+0,ctrl+shift+0":"")]=function(t){if((!Common.Utils.isMac||t.keyCode!==Common.UI.Keys.ZERO||"="===t.key)&&a.editMode&&!a.toolbar.mode.isEditMailMerge&&!a.toolbar.mode.isEditDiagram&&!a.toolbar.mode.isEditOle&&!a.toolbar.btnAddCell.isDisabled()){t=a.api.asc_getCellInfo().asc_getSelectionType();if(t===Asc.c_oAscSelectionType.RangeRow||t===Asc.c_oAscSelectionType.RangeCol)t!==Asc.c_oAscSelectionType.RangeRow||a.toolbar.btnAddCell.menu.items[2].isDisabled()||a.api.asc_insertCells(Asc.c_oAscInsertOptions.InsertRows),t!==Asc.c_oAscSelectionType.RangeCol||a.toolbar.btnAddCell.menu.items[3].isDisabled()||a.api.asc_insertCells(Asc.c_oAscInsertOptions.InsertColumns),Common.NotificationCenter.trigger("edit:complete",a.toolbar);else{for(var e=a.toolbar.btnAddCell.menu.items,i=[],s=!1,o=0;o<4;o++)i.push({caption:e[o].caption,value:e[o].value,disabled:e[o].isDisabled()}),e[o].isDisabled()||(s=!0);s&&new Common.Views.OptionsDialog({title:a.txtInsertCells,items:i,handler:function(t,e){"ok"==e&&a.api.asc_insertCells(t.getSettings()),Common.NotificationCenter.trigger("edit:complete",a.toolbar)}}).show()}}return!1},t["command+shift+-,ctrl+shift+-,command+shift+numminus,ctrl+shift+numminus"+(Common.Utils.isGecko?",command+shift+ff-,ctrl+shift+ff-":"")]=function(t){if(a.editMode&&!a.toolbar.mode.isEditMailMerge&&!a.toolbar.mode.isEditDiagram&&!a.toolbar.mode.isEditOle&&!a.toolbar.btnDeleteCell.isDisabled()){var e=a.api.asc_getCellInfo().asc_getSelectionType();if(e===Asc.c_oAscSelectionType.RangeRow||e===Asc.c_oAscSelectionType.RangeCol)a.api.asc_deleteCells(e===Asc.c_oAscSelectionType.RangeRow?Asc.c_oAscDeleteOptions.DeleteRows:Asc.c_oAscDeleteOptions.DeleteColumns),Common.NotificationCenter.trigger("edit:complete",a.toolbar);else{for(var i=a.toolbar.btnDeleteCell.menu.items,s=[],o=!1,n=0;n<4;n++)s.push({caption:i[n].caption,value:i[n].value,disabled:i[n].isDisabled()}),i[n].isDisabled()||(o=!0);o&&new Common.Views.OptionsDialog({title:a.txtDeleteCells,items:s,handler:function(t,e){"ok"==e&&a.api.asc_deleteCells(t.getSettings()),Common.NotificationCenter.trigger("edit:complete",a.toolbar)}}).show()}}return!1},Common.util.Shortcuts.delegateShortcuts({shortcuts:t}),Common.Utils.injectSvgIcons(),this.onChangeProtectSheet(),this.attachToControlEvents(),this.onApiSheetChanged(),Common.NotificationCenter.on("cells:range",_.bind(this.onCellsRange,this))},onChangeViewMode:function(t,e){this.toolbar.setFolded(e),this.toolbar.fireEvent("view:compact",[this,e]),Common.localStorage.setBool("sse-compact-toolbar",e),Common.NotificationCenter.trigger("layout:changed","toolbar"),Common.NotificationCenter.trigger("edit:complete",this.toolbar)},onClickChangeCompact:function(t){"file"!=t&&Common.Utils.asyncCall(function(){this.onChangeViewMode(null,!this.toolbar.isCompact())},this)},fillTableTemplates:function(){var s,t,e;this.toolbar.btnTableTemplate.rendered&&(s=this,_.isUndefined(this.toolbar.mnuTableTemplatePicker)&&(this.toolbar.mnuTableTemplatePicker=(t=$("#id-toolbar-menu-table-templates"),e=this.toolbar.btnTableTemplate.menu,(t=new Common.UI.DataView({el:t,parentMenu:e,restoreHeight:300,groups:new Common.UI.DataViewGroupStore,style:"max-height: 300px;",cls:"classic",store:s.getCollection("TableTemplates"),itemTemplate:_.template('<div class="item-template"><img src="<%= imageUrl %>" id="<%= id %>" style="width:60px;height:44px;"></div>'),delayRenderTips:!0})).on("item:click",function(t,e,i){s.api&&(s._state.tablestylename=null,s._setTableFormat(i?i.get("name"):s.api.asc_getDefaultTableStyle()),Common.NotificationCenter.trigger("edit:complete",s.toolbar),Common.component.Analytics.trackEvent("ToolBar","Table Templates"))}),t.scroller&&t.scroller.update({alwaysVisibleY:!0}),t)))},onTableTplMenuOpen:function(t){this.onApiInitTableTemplates(this.api.asc_getTablePictures(this.api.asc_getCellInfo().asc_getFormatTableInfo())),t&&this.toolbar.mnuTableTemplatePicker&&((e=this.toolbar.mnuTableTemplatePicker).cmpEl&&((i=7*(8+(o=(o=$(e.cmpEl.find(".dataview.inner .item-template").get(0)).parent()).is(":visible")?parseFloat(o.css("width")):60))+11)+(s=parseFloat(e.cmpEl.css("margin-left"))+parseFloat(e.cmpEl.css("margin-right")))>Common.Utils.innerWidth()&&(i=Math.max(Math.floor((Common.Utils.innerWidth()-s-11)/(8+o)),2)*(8+o)+11),e.cmpEl.css({width:i}),t.alignPosition()));var e,i,s=this.toolbar.mnuTableTemplatePicker.scroller,o=(s&&(s.update({alwaysVisibleY:!0}),s.scrollTop(0)),this.toolbar.mnuTableTemplatePicker.store.findWhere({name:this._state.tablestylename}));o?this.toolbar.mnuTableTemplatePicker.selectRecord(o):this.toolbar.mnuTableTemplatePicker.deselectAll()},onSendThemeColors:function(){this.toolbar.btnTableTemplate.rendered&&this.toolbar.btnTableTemplate.cmpEl.hasClass("open")&&this.onTableTplMenuOpen()},onApiInitTableTemplates:function(t){var e,n,a=this,i=this.getCollection("TableTemplates");this.fillTableTemplates(),i&&(e=[],n=[{id:"menu-table-group-custom",caption:a.txtGroupTable_Custom,templates:[]},{id:"menu-table-group-light",caption:a.txtGroupTable_Light,templates:[]},{id:"menu-table-group-medium",caption:a.txtGroupTable_Medium,templates:[]},{id:"menu-table-group-dark",caption:a.txtGroupTable_Dark,templates:[]},{id:"menu-table-group-no-name",caption:"&nbsp",templates:[]}],_.each(t,function(t){var e,i=t.asc_getDisplayName(),s="",o=null;0==t.asc_getType()?(o=(e=i.split(" ")).pop(),null===t.asc_getName()?s="menu-table-group-light":(0<e.length&&(s="menu-table-group-"+e[e.length-1].toLowerCase()),0==n.some(function(t){return t.id===s})&&(s="menu-table-group-no-name")),e="txtTable_"+e.join(""),i=a[e]?a[e]+" "+o:i,o=parseInt(o)):s="menu-table-group-custom",n.filter(function(t){return t.id==s})[0].templates.push({name:t.asc_getName(),caption:t.asc_getDisplayName(),type:t.asc_getType(),imageUrl:t.asc_getImage(),group:s,allowSelected:!0,selected:!1,tip:i,numInGroup:null==o||isNaN(o)?null:o})}),n[1].templates.sort(t=function(t,e){return t.numInGroup-e.numInGroup}),n[2].templates.sort(t),n[3].templates.sort(t),(n=n.filter(function(t,e){return 0<t.templates.length})).forEach(function(t){e=e.concat(t.templates),delete t.templates}),a.toolbar.mnuTableTemplatePicker.groups.reset(n),i.reset(e))},onCellStyleMenuOpen:function(t){t&&this.toolbar.mnuCellStylePicker&&((e=this.toolbar.mnuCellStylePicker).cmpEl&&(i=$(e.cmpEl.find(".dataview.inner .item").get(0)),(s=6*((n=parseFloat(i.css("margin-left"))+parseFloat(i.css("margin-right")))+(i=i.is(":visible")?parseFloat(i.css("width")):106))+15)+(o=parseFloat(e.cmpEl.css("margin-left"))+parseFloat(e.cmpEl.css("margin-right")))>Common.Utils.innerWidth()&&(s=Math.max(Math.floor((Common.Utils.innerWidth()-o-11)/(n+i)),2)*(n+i)+11),e.cmpEl.css({width:s}),t.alignPosition()));var e,i,s,o=this.toolbar.mnuCellStylePicker.scroller,n=(o&&(o.update({alwaysVisibleY:!0}),o.scrollTop(0)),this.toolbar.mnuCellStylePicker.store.findWhere({name:this._state.prstyle}));n?this.toolbar.mnuCellStylePicker.selectRecord(n):this.toolbar.mnuCellStylePicker.deselectAll()},onApiInitEditorStyles:function(t){window.styles_loaded=!1,this.toolbar.mode.isEditOle&&(s=this,_.isUndefined(this.toolbar.mnuCellStylePicker)&&(this.toolbar.mnuCellStylePicker=(i=$("#id-toolbar-menu-cell-styles"),e=this.toolbar.btnCellStyle.menu,(i=new Common.UI.DataView({el:i,parentMenu:e,restoreHeight:380,groups:new Common.UI.DataViewGroupStore,store:new Common.UI.DataViewStore,style:"max-height: 380px;",itemTemplate:_.template('<div class="style"><img src="<%= imageUrl %>" id="<%= id %>" style="width:100px;height:20px;"></div>'),delayRenderTips:!0})).on("item:click",function(t,e,i){s.onListStyleSelect(t,i)}),i.scroller&&i.scroller.update({alwaysVisibleY:!0}),i)));var s,e=this.toolbar.mode.isEditOle?this.toolbar.mnuCellStylePicker:this.toolbar.listStyles;if(e){for(var i=this.toolbar.mode.isEditOle?e:e.menuPicker,o=this.getApplication().getController("Main"),n=i.store.length,a=i.getSelectedRec(),l=[{id:"menu-style-group-custom",caption:this.txtGroupCell_Custom},{id:"menu-style-group-color",caption:this.txtGroupCell_GoodBadAndNeutral},{id:"menu-style-group-model",caption:this.txtGroupCell_DataAndModel},{id:"menu-style-group-title",caption:this.txtGroupCell_TitlesAndHeadings},{id:"menu-style-group-themed",caption:this.txtGroupCell_ThemedCallStyles},{id:"menu-style-group-number",caption:this.txtGroupCell_NumberFormat},{id:"menu-style-group-no-name",caption:this.txtGroupCell_NoName}],r=[],c=0;c<4;c++)r.push("menu-style-group-color");for(c=0;c<8;c++)r.push("menu-style-group-model");for(c=0;c<6;c++)r.push("menu-style-group-title");for(c=0;c<24;c++)r.push("menu-style-group-themed");for(var d,h,p,m,c=0;c<5;c++)r.push("menu-style-group-number");0<n&&n==t.length?(d=i.dataViewItems)&&_.each(t,function(t,e){var i=t.asc_getImage();d[e].model.set("imageUrl",i,{silent:!0}),d[e].model.set({name:t.asc_getName(),tip:o.translationTable[t.get_Name()]||t.get_Name()}),$(d[e].el).find("img").attr("src",i)}):(p=0,m=!(h=[]),_.each(t,function(t,e){var i;0==t.asc_getType()?e-p<r.length?i=r[e-p]:(i="menu-style-group-no-name",m=!0):i="menu-style-group-custom",h.push({imageUrl:t.asc_getImage(),name:t.asc_getName(),group:i,tip:o.translationTable[t.get_Name()]||t.get_Name(),uid:Common.UI.getId()}),1==t.asc_getType()&&(p+=1)}),0==p&&(l=l.filter(function(t){return"menu-style-group-custom"!=t.id})),!1===m&&(l=l.filter(function(t){return"menu-style-group-no-name"!=t.id})),i.groups.reset(l),i.store.reset(h)),!this.toolbar.mode.isEditOle&&0<i.store.length&&e.rendered&&(a=a?i.store.findWhere({name:a.get("name")}):null,e.fillComboView(a||i.store.at(0),!0,!0)),window.styles_loaded=!0}else this.styles=t},onHomeOpen:function(){var t,e=this.toolbar.listStyles;e&&e.needFillComboView&&0<e.menuPicker.store.length&&e.rendered&&(this._state.prstyle&&(t=e.menuPicker.store.findWhere({name:this._state.prstyle})),e.fillComboView(t||e.menuPicker.store.at(0),!0))},onApiCoAuthoringDisconnect:function(t){this.toolbar.setMode({isDisconnected:!0,enableDownload:!!t}),this.editMode=!1},onApiChartDblClick:function(){this.onEditChart(this.btnInsertChart)},onApiCanRevert:function(t,e){"undo"==t?this._state.can_undo!==e&&(this.toolbar.btnUndo.setDisabled(!e),this._state.can_undo=e):this._state.can_redo!==e&&(this.toolbar.btnRedo.setDisabled(!e),this._state.can_redo=e)},setDisabledComponents:function(t,e){_.each([].concat(t),function(t){t.isDisabled()!==e&&t.setDisabled(e)})},onApiEditCell:function(t){var e,i,s,o,n;0<$(".asc-window.enable-key-events:visible").length||((e=this.toolbar).mode.isEditDiagram||e.mode.isEditMailMerge?(s=t==Asc.c_oAscCellEditorState.editStart,e.lockToolbar(Common.enumLock.editCell,t==Asc.c_oAscCellEditorState.editStart,{array:[e.btnDecDecimal,e.btnIncDecimal,e.cmbNumberFormat,e.btnEditChartData,e.btnEditChartType]})):e.mode.isEditOle?t==Asc.c_oAscCellEditorState.editStart||t==Asc.c_oAscCellEditorState.editEnd?(s=t==Asc.c_oAscCellEditorState.editStart,e.lockToolbar(Common.enumLock.editCell,t==Asc.c_oAscCellEditorState.editStart,{array:[e.cmbNumberFormat,e.btnWrap,e.btnMerge,e.btnBackColor,e.btnBorders,e.btnTableTemplate,e.btnHorizontalAlign,e.btnVerticalAlign],merge:!0,clear:[Common.enumLock.editFormula,Common.enumLock.editText]}),s?Common.util.Shortcuts.suspendEvents("command+l, ctrl+l, command+shift+l, ctrl+shift+l"):Common.util.Shortcuts.resumeEvents("command+l, ctrl+l, command+shift+l, ctrl+shift+l")):(t==Asc.c_oAscCellEditorState.editText?n=!(o=!0):t==Asc.c_oAscCellEditorState.editFormula?o=!(n=!0):t==Asc.c_oAscCellEditorState.editEmptyCell&&(o=n=!1),e.lockToolbar(Common.enumLock.editFormula,n,{array:[e.cmbFontName,e.cmbFontSize,e.btnTextFormatting,e.btnTextColor]}),e.lockToolbar(Common.enumLock.editText,o,{array:[e.btnInsertFormula]})):t==Asc.c_oAscCellEditorState.editStart||t==Asc.c_oAscCellEditorState.editEnd?(e.lockToolbar(Common.enumLock.editCell,t==Asc.c_oAscCellEditorState.editStart,{array:[e.btnClearStyle.menu.items[1],e.btnClearStyle.menu.items[2],e.btnClearStyle.menu.items[3],e.btnClearStyle.menu.items[4],e.btnNamedRange.menu.items[0],e.btnNamedRange.menu.items[1]].concat(e.itemsNamedRange),merge:!0,clear:[Common.enumLock.editFormula,Common.enumLock.editText]}),i=Common.Utils.isMac?"command+alt+a":"alt+h",(s=t==Asc.c_oAscCellEditorState.editStart)?Common.util.Shortcuts.suspendEvents("command+l, ctrl+l, command+shift+l, ctrl+shift+l, command+k, ctrl+k, command+1, ctrl+1, "+i):Common.util.Shortcuts.resumeEvents("command+l, ctrl+l, command+shift+l, ctrl+shift+l, command+k, ctrl+k, command+1, ctrl+1, "+i),s&&(e.listStyles.suspendEvents(),e.listStyles.menuPicker.selectRecord(null),e.listStyles.resumeEvents(),this._state.prstyle=void 0),this.appConfig.isDesktopApp&&(this.appConfig.isSignatureSupport||this.appConfig.isPasswordSupport)&&this.getApplication().getController("Common.Controllers.Protection").SetDisabled(s,!1)):(t==Asc.c_oAscCellEditorState.editText?n=!(o=!0):t==Asc.c_oAscCellEditorState.editFormula?o=!(n=!0):t==Asc.c_oAscCellEditorState.editEmptyCell&&(o=n=!1),e.lockToolbar(Common.enumLock.editFormula,n,{array:[e.cmbFontName,e.cmbFontSize,e.btnIncFontSize,e.btnDecFontSize,e.btnChangeCase,e.btnBold,e.btnItalic,e.btnUnderline,e.btnStrikeout,e.btnSubscript,e.btnTextColor]}),e.lockToolbar(Common.enumLock.editText,o,{array:[e.btnInsertFormula].concat(e.btnsFormula)})),this._state.coauthdisable=void 0,this._state.selection_type=void 0,this.checkInsertAutoshape({action:"cancel"}))},onApiZoomChange:function(t,e){},onApiSheetChanged:function(){var t,e,i;!this.toolbar.mode||!this.toolbar.mode.isEdit||this.toolbar.mode.isEditDiagram||this.toolbar.mode.isEditMailMerge||this.toolbar.mode.isEditOle||(t=this.api.asc_getActiveWorksheetIndex(),i=(e=this.api.asc_getPageOptions(t)).asc_getPageSetup(),this.onApiPageOrient(i.asc_getOrientation()),this.onApiPageSize(i.asc_getWidth(),i.asc_getHeight()),this.onApiPageMargins(e.asc_getPageMargins()),this.onChangeScaleSettings(i.asc_getFitToWidth(),i.asc_getFitToHeight(),i.asc_getScale()),this.onApiGridLines(e.asc_getGridLines()),this.onApiHeadings(e.asc_getHeadings()),this.api.asc_isLayoutLocked(t)?this.onApiLockDocumentProps(t):this.onApiUnLockDocumentProps(t),this.toolbar.lockToolbar(Common.enumLock.printAreaLock,this.api.asc_isPrintAreaLocked(t),{array:[this.toolbar.btnPrintArea]}),this.toolbar.lockToolbar(Common.enumLock.pageBreakLock,this.api.asc_GetPageBreaksDisableType(t)===Asc.c_oAscPageBreaksDisableType.all,{array:[this.toolbar.btnPageBreak]}))},onUpdateDocumentProps:function(t){t==this.api.asc_getActiveWorksheetIndex()&&this.onApiSheetChanged()},onApiGridLines:function(t){this.toolbar.chPrintGridlines.setValue(t,!0)},onApiHeadings:function(t){this.toolbar.chPrintHeadings.setValue(t,!0)},onApiPageSize:function(e,i){void 0!==this._state.pgorient&&(.1<Math.abs(this._state.pgsize[0]-e)||.1<Math.abs(this._state.pgsize[1]-i))&&(this._state.pgsize=[e,i],this.toolbar.mnuPageSize&&(this.toolbar.mnuPageSize.clearAll(),_.each(this.toolbar.mnuPageSize.items,function(t){if(t.value&&"object"==typeof t.value&&Math.abs(t.value[0]-e)<.1&&Math.abs(t.value[1]-i)<.1)return t.setChecked(!0),!1},this)))},onApiPageMargins:function(t){var e,i,s,o;t&&(e=t.asc_getLeft(),i=t.asc_getTop(),s=t.asc_getRight(),o=t.asc_getBottom(),(!this._state.pgmargins||.1<Math.abs(this._state.pgmargins[0]-i)||.1<Math.abs(this._state.pgmargins[1]-e)||.1<Math.abs(this._state.pgmargins[2]-o)||.1<Math.abs(this._state.pgmargins[3]-s))&&(this._state.pgmargins=[i,e,o,s],this.toolbar.btnPageMargins.menu&&(this.toolbar.btnPageMargins.menu.clearAll(),_.each(this.toolbar.btnPageMargins.menu.items,function(t){if(t.value&&"object"==typeof t.value&&Math.abs(t.value[0]-i)<.1&&Math.abs(t.value[1]-e)<.1&&Math.abs(t.value[2]-o)<.1&&Math.abs(t.value[3]-s)<.1)return t.setChecked(!0),!1},this))))},onApiPageOrient:function(t){this._state.pgorient!==t&&(this.toolbar.btnPageOrient.menu.items[t==Asc.c_oAscPageOrientation.PagePortrait?0:1].setChecked(!0),this._state.pgorient=t)},onChangeScaleSettings:function(e,i,t){var s,o;this.toolbar.btnScale.menu&&(void 0!==e?(o=s=!1,e=e||0,i=i||0,void 0!==t?this.toolbar.setValueCustomScale(t):this.toolbar.setValueCustomScale(this.api.asc_getPageOptions().asc_getPageSetup().asc_getScale()),this.toolbar.menuWidthScale.clearAll(),this.toolbar.menuWidthScale.items.forEach(function(t){if(t.value===e)return t.setChecked(!0),!(s=!0)}),s||this.toolbar.menuWidthScale.items[11].setChecked(!0),this.toolbar.menuHeightScale.clearAll(),this.toolbar.menuHeightScale.items.forEach(function(t){if(t.value===i)return t.setChecked(!0),!(o=!0)}),o||this.toolbar.menuHeightScale.items[11].setChecked(!0),this.toolbar.mnuScalePicker&&(this.toolbar.mnuScalePicker.setDisabled(!(!e&&!i)),this.toolbar.mnuCustomScale.setDisabled(!(!e&&!i))),this._state.scaleWidth=e,this._state.scaleHeight=i,this._state.scale=t):this.toolbar.mnuScalePicker&&(this.toolbar.mnuScalePicker.setDisabled(!(!this._state.scaleWidth&&!this._state.scaleHeight)),this.toolbar.mnuCustomScale.setDisabled(!(!this._state.scaleWidth&&!this._state.scaleHeight))))},onApiLockDocumentProps:function(t){!0!==this._state.lock_doc&&t==this.api.asc_getActiveWorksheetIndex()&&(this.toolbar.lockToolbar(Common.enumLock.docPropsLock,!0,{array:[this.toolbar.btnPageSize,this.toolbar.btnPageMargins,this.toolbar.btnPageOrient,this.toolbar.btnPageBreak,this.toolbar.btnScale,this.toolbar.btnPrintTitles]}),this._state.lock_doc=!0)},onApiUnLockDocumentProps:function(t){!1!==this._state.lock_doc&&t==this.api.asc_getActiveWorksheetIndex()&&(this.toolbar.lockToolbar(Common.enumLock.docPropsLock,!1,{array:[this.toolbar.btnPageSize,this.toolbar.btnPageMargins,this.toolbar.btnPageOrient,this.toolbar.btnPageBreak,this.toolbar.btnScale,this.toolbar.btnPrintTitles]}),this._state.lock_doc=!1)},onApiEditorSelectionChanged:function(t){if(this.editMode&&!(0<$(".asc-window.enable-key-events:visible").length)){var e=this.toolbar,i=(Common.NotificationCenter.trigger("fonts:change",t),e.mode.isEditMailMerge||e.mode.isEditDiagram||e.mode.isEditOle||(a=t.asc_getFontBold(),this._state.bold!==a&&(e.btnBold.toggle(!0===a,!0),this._state.bold=a),a=t.asc_getFontItalic(),this._state.italic!==a&&(e.btnItalic.toggle(!0===a,!0),this._state.italic=a),a=t.asc_getFontUnderline(),this._state.underline!==a&&(e.btnUnderline.toggle(!0===a,!0),this._state.underline=a),a=t.asc_getFontStrikeout(),this._state.strikeout!==a&&(e.btnStrikeout.toggle(!0===a,!0),this._state.strikeout=a),a=t.asc_getFontSubscript(),l=t.asc_getFontSuperscript(),this._state.subscript===a&&this._state.superscript===l||((s=e.btnSubscript).toggle(-1<(i=l?0:a?1:-1),!0),i<0?s.menu.clearAll():(s.menu.items[i].setChecked(!0),s.rendered&&s.$icon&&(s.$icon.removeClass(s.options.icls),s.options.icls=s.menu.items[i].options.icls,s.$icon.addClass(s.options.icls))),this._state.subscript=a,this._state.superscript=l)),t.asc_getFontSize());this._state.fontsize!==i&&(e.cmbFontSize.setValue(void 0!==i?i:""),this._state.fontsize=i);var s,o=this.toolbar.mnuTextColorPicker;if(!o.isDummy){if(s=t.asc_getFontColor())if(s.get_auto())"auto"!==this._state.clrtext&&(o.clearSelection(),this.toolbar.btnTextColor.setAutoColor(!0),this._state.clrtext="auto");else{var n,a=typeof(n=s.get_type()==Asc.c_oAscColor.COLOR_TYPE_SCHEME?{color:Common.Utils.ThemeColor.getHexColor(s.get_r(),s.get_g(),s.get_b()),effectValue:s.get_value()}:Common.Utils.ThemeColor.getHexColor(s.get_r(),s.get_g(),s.get_b())),l=typeof this._state.clrtext;if("auto"==this._state.clrtext||a!=l||"object"==a&&(n.effectValue!==this._state.clrtext.effectValue||this._state.clrtext.color.indexOf(n.color)<0)||"object"!=a&&void 0!==this._state.clrtext&&this._state.clrtext.indexOf(n)<0){if(this.toolbar.btnTextColor.setAutoColor(!1),_.isObject(n)){for(var r=!1,c=0;c<10;c++)if(Common.Utils.ThemeColor.ThemeValues[c]==n.effectValue){o.select(n,!0),r=!0;break}r||o.clearSelection()}else o.select(n,!0);this._state.clrtext=n}}this._state.clrtext_asccolor=s}}},onApiSelectionChanged:function(t){if(this.editMode&&!(0<$(".asc-window.enable-key-events:visible").length)&&t){if(this.toolbar.mode.isEditDiagram)return this.onApiSelectionChanged_DiagramEditor(t);if(this.toolbar.mode.isEditMailMerge)return this.onApiSelectionChanged_MailMergeEditor(t);if(this.toolbar.mode.isEditOle)return this.onApiSelectionChanged_OleEditor(t);var e=t.asc_getSelectionType(),i=!(this.toolbar.mode.isEditMailMerge||this.toolbar.mode.isEditDiagram||this.toolbar.mode.isEditOle)&&(!0===t.asc_getLocked()||!0===t.asc_getLockedTable()||!0===t.asc_getLockedPivotTable()),i=this._disableEditOptions(e,i),s=this.toolbar,o=t.asc_getXfs(),n=!1,a=(Common.NotificationCenter.trigger("fonts:change",o),o.asc_getFontSize()),a=(this._state.fontsize!==a&&(s.cmbFontSize.setValue(void 0!==a?a:""),this._state.fontsize=a),s.lockToolbar(Common.enumLock.cantHyperlink,e===Asc.c_oAscSelectionType.RangeShapeText&&!1===this.api.asc_canAddShapeHyperlink(),{array:[s.btnInsertHyperlink]}),n=e===Asc.c_oAscSelectionType.RangeCells||e===Asc.c_oAscSelectionType.RangeCol||e===Asc.c_oAscSelectionType.RangeRow||e===Asc.c_oAscSelectionType.RangeMax,s.lockToolbar(Common.enumLock.selRange,n,{array:[s.btnImgAlign,s.btnImgBackward,s.btnImgForward,s.btnImgGroup]}),this.api.asc_canGroupGraphicsObjects()),l=this.api.asc_canUnGroupGraphicsObjects(),l=(s.lockToolbar(Common.enumLock.cantGroupUngroup,!a&&!l,{array:[s.btnImgGroup]}),s.btnImgGroup.menu.items[0].setDisabled(!a),s.btnImgGroup.menu.items[1].setDisabled(!l),s.lockToolbar(Common.enumLock.cantGroup,!a,{array:[s.btnImgAlign]}),this.api.asc_getSelectedDrawingObjectsCount());if(s.btnImgAlign.menu.items[7].setDisabled(l<3),s.btnImgAlign.menu.items[8].setDisabled(l<3),n=e===Asc.c_oAscSelectionType.RangeImage||e===Asc.c_oAscSelectionType.RangeChart||e===Asc.c_oAscSelectionType.RangeChartText||e===Asc.c_oAscSelectionType.RangeShape||e===Asc.c_oAscSelectionType.RangeShapeText||e===Asc.c_oAscSelectionType.RangeSlicer,s.lockToolbar(Common.enumLock.wsLockFormat,n&&!!this._state.wsProps.Objects&&!!this._state.is_lockText||!n&&!!this._state.wsProps.FormatCells),s.lockToolbar(Common.enumLock.wsLockFormatFill,n&&!!this._state.wsProps.Objects&&!!this._state.is_lockShape||!n&&!!this._state.wsProps.FormatCells),s.lockToolbar(Common.enumLock.Objects,!!this._state.wsProps.Objects),s.lockToolbar(Common.enumLock.FormatCells,!!this._state.wsProps.FormatCells),s.lockToolbar(Common.enumLock.commentLock,e==Asc.c_oAscSelectionType.RangeCells&&(!t.asc_getComments()||0<t.asc_getComments().length||t.asc_getLocked())||e!=Asc.c_oAscSelectionType.RangeCells,{array:this.btnsComment}),s.lockToolbar(Common.enumLock.pageBreakLock,this.api.asc_GetPageBreaksDisableType(this.api.asc_getActiveWorksheetIndex())===Asc.c_oAscPageBreaksDisableType.all,{array:[s.btnPageBreak]}),!i){s.mode.isEditMailMerge||s.mode.isEditDiagram||s.mode.isEditOle||(f=o.asc_getFontBold(),this._state.bold!==f&&(s.btnBold.toggle(!0===f,!0),this._state.bold=f),f=o.asc_getFontItalic(),this._state.italic!==f&&(s.btnItalic.toggle(!0===f,!0),this._state.italic=f),f=o.asc_getFontUnderline(),this._state.underline!==f&&(s.btnUnderline.toggle(!0===f,!0),this._state.underline=f),f=o.asc_getFontStrikeout(),this._state.strikeout!==f&&(s.btnStrikeout.toggle(!0===f,!0),this._state.strikeout=f),a=o.asc_getFontSubscript(),l=o.asc_getFontSuperscript(),this._state.subscript===a&&this._state.superscript===l||((i=s.btnSubscript).toggle(-1<(b=l?0:a?1:-1),!0),b<0?i.menu.clearAll():(i.menu.items[b].setChecked(!0),i.rendered&&(i.$icon.removeClass(i.options.icls),i.options.icls=i.menu.items[b].options.icls,i.$icon.addClass(i.options.icls))),this._state.subscript=a,this._state.superscript=l));var r=this.toolbar.mnuTextColorPicker,c=this.toolbar.mnuBackColorPicker;if(!r.isDummy){if(C=o.asc_getFontColor())if(C.get_auto())"auto"!==this._state.clrtext&&(r.clearSelection(),s.btnTextColor.setAutoColor(!0),this._state.clrtext="auto");else{var d,h=typeof(d=C.get_type()==Asc.c_oAscColor.COLOR_TYPE_SCHEME?{color:Common.Utils.ThemeColor.getHexColor(C.get_r(),C.get_g(),C.get_b()),effectValue:C.get_value()}:Common.Utils.ThemeColor.getHexColor(C.get_r(),C.get_g(),C.get_b())),p=typeof this._state.clrtext;if("auto"==this._state.clrtext||h!==p||"object"==h&&(d.effectValue!==this._state.clrtext.effectValue||this._state.clrtext.color.indexOf(d.color)<0)||"object"!=h&&void 0!==this._state.clrtext&&this._state.clrtext.indexOf(d)<0){if(s.btnTextColor.setAutoColor(!1),_.isObject(d)){for(var m=!1,u=0;u<10;u++)if(Common.Utils.ThemeColor.ThemeValues[u]==d.effectValue){r.select(d,!0),m=!0;break}m||r.clearSelection()}else r.select(d,!0);this._state.clrtext=d}}this._state.clrtext_asccolor=C}if(!c.isDummy){if((h=typeof(d=(C=o.asc_getFillColor())&&!C.get_auto()?C.get_type()==Asc.c_oAscColor.COLOR_TYPE_SCHEME?{color:Common.Utils.ThemeColor.getHexColor(C.get_r(),C.get_g(),C.get_b()),effectValue:C.get_value()}:Common.Utils.ThemeColor.getHexColor(C.get_r(),C.get_g(),C.get_b()):"transparent"))!==(p=typeof this._state.clrback)||"object"==h&&(d.effectValue!==this._state.clrback.effectValue||this._state.clrback.color.indexOf(d.color)<0)||"object"!=h&&void 0!==this._state.clrback&&this._state.clrback.indexOf(d)<0){if(_.isObject(d)){m=!1;for(u=0;u<10;u++)if(Common.Utils.ThemeColor.ThemeValues[u]==d.effectValue){c.select(d,!0),m=!0;break}m||c.clearSelection()}else c.select(d,!0);this._state.clrback=d}this._state.clrshd_asccolor=C}i=e==Asc.c_oAscSelectionType.RangeChart||e==Asc.c_oAscSelectionType.RangeChartText;if(i!==this._state.in_chart&&(s.btnInsertChart.updateHint(i?s.tipChangeChart:s.tipInsertChart),this._state.in_chart=i),!i){if(!s.mode.isEditDiagram){var g=t.asc_getAutoFilterInfo(),a=t.asc_getFormatTableInfo();if(!s.mode.isEditMailMerge){l=o.asc_getHorAlign();if(this._state.pralign!==l){var b=-1;switch(this._state.pralign=l){case AscCommon.align_Left:b=0,0;break;case AscCommon.align_Center:b=1,0;break;case AscCommon.align_Right:b=2,0;break;case AscCommon.align_Justify:b=3,0;break;default:b=-255,0}b<0?-255==b&&(s.btnAlignRight.toggle(!1,!0),s.btnAlignLeft.toggle(!1,!0),s.btnAlignCenter.toggle(!1,!0),s.btnAlignJust.toggle(!1,!0)):(s.btnAlignRight.toggle(2===b,!0),s.btnAlignLeft.toggle(0===b,!0),s.btnAlignCenter.toggle(1===b,!0),s.btnAlignJust.toggle(3===b,!0)),s.btnWrap.allowDepress=l!==AscCommon.align_Justify}if(n=l==AscCommon.align_Justify||e==Asc.c_oAscSelectionType.RangeShapeText||e==Asc.c_oAscSelectionType.RangeShape,s.btnTextOrient.menu.items[1].setDisabled(n),s.btnTextOrient.menu.items[2].setDisabled(n),s.btnTextOrient.menu.items[3].setDisabled(n),l=o.asc_getVertAlign(),this._state.valign!==l){switch(b=-1,this._state.valign=l){case Asc.c_oAscVAlign.Top:b=0,0;break;case Asc.c_oAscVAlign.Center:b=1,0;break;case Asc.c_oAscVAlign.Bottom:b=2,0}s.btnAlignTop.toggle(0===b,!0),s.btnAlignMiddle.toggle(1===b,!0),s.btnAlignBottom.toggle(2===b,!0)}n=this._state.controlsdisabled.filters||null!==a||g&&null===g.asc_getIsAutoFilter(),s.lockToolbar(Common.enumLock.ruleMerge,n,{array:[s.btnMerge,s.btnInsertTable]}),f=t.asc_getMerge(),this._state.merge!==f&&(s.btnMerge.toggle(f===Asc.c_oAscMergeOptions.Merge,!0),this._state.merge=f),s.btnWrap.isDisabled()||(f=o.asc_getWrapText(),this._state.wrap!==f&&(s.btnWrap.toggle(!0===f,!0),this._state.wrap=f))}f=g?g.asc_getIsAutoFilter():null,this._state.filter!==f&&(s.btnsSetAutofilter.toggle(!0===f,!0),this._state.filter=f),n=this._state.controlsdisabled.filters||null===f,s.lockToolbar(Common.enumLock.ruleFilter,n,{array:s.btnsSetAutofilter.concat(s.btnCustomSort,s.btnTableTemplate,s.btnInsertTable,s.btnRemoveDuplicates,s.btnDataValidation)}),s.lockToolbar(Common.enumLock.tableHasSlicer,g&&g.asc_getIsSlicerAdded(),{array:s.btnsSetAutofilter}),n=e!==Asc.c_oAscSelectionType.RangeSlicer&&(this._state.controlsdisabled.filters||null===f),s.lockToolbar(Common.enumLock.cantSort,n,{array:s.btnsSortDown.concat(s.btnsSortUp)}),f=a?a.asc_getTableStyleName():null,this._state.tablestylename!==f&&this.toolbar.mnuTableTemplatePicker&&((f=this.toolbar.mnuTableTemplatePicker.store.findWhere({name:f}))?(this.toolbar.mnuTableTemplatePicker.selectRecord(f),this._state.tablestylename=f.get("name")):(s.mnuTableTemplatePicker.deselectAll(),this._state.tablestylename=null)),n=this._state.controlsdisabled.filters||!g||!0!==g.asc_getIsApplyAutoFilter(),s.lockToolbar(Common.enumLock.ruleDelFilter,n,{array:s.btnsClearAutofilter});p=this._state.tablename,h=(this._state.tablename=a?a.asc_getTableName():void 0,this._state.filterapplied);this._state.filterapplied=this._state.filter&&g.asc_getIsApplyAutoFilter(),this._state.tablename===p&&this._state.filterapplied===h||this.getApplication().getController("Statusbar").onApiFilterInfo(!n),this._state.multiselect=t.asc_getMultiselect(),s.lockToolbar(Common.enumLock.multiselect,this._state.multiselect,{array:[s.btnTableTemplate,s.btnInsertHyperlink,s.btnInsertTable]}),this._state.inpivot=!!t.asc_getPivotTableInfo(),s.lockToolbar(Common.enumLock.editPivot,this._state.inpivot,{array:s.btnsSetAutofilter.concat(s.btnMerge,s.btnInsertHyperlink,s.btnInsertTable,s.btnRemoveDuplicates,s.btnDataValidation)}),s.lockToolbar(Common.enumLock.noSlicerSource,!(this._state.inpivot||a),{array:[s.btnInsertSlicer]}),n=!this.appConfig.canModifyFilter,s.lockToolbar(Common.enumLock.cantModifyFilter,n,{array:s.btnsSetAutofilter.concat(s.btnsSortDown,s.btnsSortUp,s.btnCustomSort,s.btnTableTemplate,s.btnClearStyle.menu.items[0],s.btnClearStyle.menu.items[2],s.btnInsertTable,s.btnRemoveDuplicates,s.btnDataValidation)})}if((f=o.asc_getNumFormatInfo())&&(this._state.numformat=o.asc_getNumFormat(),f=(this._state.numformatinfo=f).asc_getType(),this._state.numformattype!==f&&(s.cmbNumberFormat.setValue(f,s.txtCustom),this._state.numformattype=f)),f=o.asc_getAngle(),this._state.angle!==f){switch(s.btnTextOrient.menu.clearAll(),f){case 45:s.btnTextOrient.menu.items[1].setChecked(!0,!0);break;case-45:s.btnTextOrient.menu.items[2].setChecked(!0,!0);break;case 255:s.btnTextOrient.menu.items[3].setChecked(!0,!0);break;case 90:s.btnTextOrient.menu.items[4].setChecked(!0,!0);break;case-90:s.btnTextOrient.menu.items[5].setChecked(!0,!0);break;case 0:s.btnTextOrient.menu.items[0].setChecked(!0,!0)}this._state.angle=f}var C,f=t.asc_getStyleName(),l=(this._state.prstyle==f||this.toolbar.listStyles.isDisabled()||(C=this.toolbar.listStyles).rendered&&(C.suspendEvents(),i=C.menuPicker.store.findWhere({name:f}),this._state.prstyle=0<C.menuPicker.store.length?f:void 0,C.menuPicker.selectRecord(i),C.resumeEvents()),e==Asc.c_oAscSelectionType.RangeCol),p=e==Asc.c_oAscSelectionType.RangeRow,h=e==Asc.c_oAscSelectionType.RangeMax,n=p||h&&this._state.wsLock||this._state.wsProps.InsertColumns;s.btnAddCell.menu.items[3].setDisabled(n),n=p||h&&this._state.wsLock||!l&&this._state.wsLock||this._state.wsProps.DeleteColumns,s.btnDeleteCell.menu.items[3].setDisabled(n),n=l||h&&this._state.wsLock||this._state.wsProps.InsertRows,s.btnAddCell.menu.items[2].setDisabled(n),n=l||h&&this._state.wsLock||!p&&this._state.wsLock||this._state.wsProps.DeleteRows,s.btnDeleteCell.menu.items[2].setDisabled(n),f=g&&g.asc_getIsApplyAutoFilter(),n=p||f||!(l||h)&&this._state.wsLock||l&&this._state.wsProps.InsertColumns||h&&this._state.wsProps.InsertColumns&&this._state.wsProps.InsertRows,s.btnAddCell.menu.items[0].setDisabled(n),n=p||f||!(l||h)&&this._state.wsLock||l&&this._state.wsProps.DeleteColumns||h&&this._state.wsProps.DeleteColumns&&this._state.wsProps.DeleteRows,s.btnDeleteCell.menu.items[0].setDisabled(n),n=l||f||!(p||h)&&this._state.wsLock||p&&this._state.wsProps.InsertRows||h&&this._state.wsProps.InsertColumns&&this._state.wsProps.InsertRows,s.btnAddCell.menu.items[1].setDisabled(n),n=l||f||!(p||h)&&this._state.wsLock||p&&this._state.wsProps.DeleteRows||h&&this._state.wsProps.DeleteColumns&&this._state.wsProps.DeleteRows,s.btnDeleteCell.menu.items[1].setDisabled(n);for(var S=s.btnAddCell.menu.items,v=!1,u=0;u<4;u++)S[u].isDisabled()||(v=!0);s.lockToolbar(Common.enumLock.itemsDisabled,!v,{array:[s.btnAddCell]});for(S=this.toolbar.btnDeleteCell.menu.items,v=!1,u=0;u<4;u++)S[u].isDisabled()||(v=!0);s.lockToolbar(Common.enumLock.itemsDisabled,!v,{array:[s.btnDeleteCell]}),s.lockToolbar(Common.enumLock.headerLock,t.asc_getLockedHeaderFooter(),{array:this.toolbar.btnsEditHeader}),this._state.isUserProtected=t.asc_getUserProtected(),s.lockToolbar(Common.enumLock.userProtected,this._state.isUserProtected)}}}},onApiSelectionChangedRestricted:function(t){var e;this.appConfig.isRestrictedEdit&&t&&(e=t.asc_getSelectionType(),this.toolbar.lockToolbar(Common.enumLock.commentLock,e==Asc.c_oAscSelectionType.RangeCells&&(!t.asc_getComments()||0<t.asc_getComments().length||t.asc_getLocked())||e!=Asc.c_oAscSelectionType.RangeCells,{array:this.btnsComment}),this.toolbar.lockToolbar(Common.enumLock.Objects,!!this._state.wsProps.Objects,{array:this.btnsComment}))},onApiSelectionChanged_DiagramEditor:function(t){var c,e,i;this.editMode&&!this.api.isCellEdited&&!this.api.isRangeSelection&&t&&(c=this,e=t.asc_getSelectionType(),t=t.asc_getXfs(),function(t,e){var i=t==Asc.c_oAscSelectionType.RangeChartText,s=t==Asc.c_oAscSelectionType.RangeChart,o=t==Asc.c_oAscSelectionType.RangeShapeText,n=t==Asc.c_oAscSelectionType.RangeShape,a=t==Asc.c_oAscSelectionType.RangeImage||t==Asc.c_oAscSelectionType.RangeSlicer,o=o||n||i||s,n=!1;if(!o&&!a&&c._state.selection_type===t&&c._state.coauthdisable===e)return t===Asc.c_oAscSelectionType.RangeImage;o&&(n=c.api.asc_getGraphicObjectProps().some(function(t){return t.asc_getObjectType()==Asc.c_oAscTypeSelectElement.Image&&t.asc_getObjectValue().asc_getLocked()}));var l=Common.enumLock,r=t;switch(t){case Asc.c_oAscSelectionType.RangeSlicer:case Asc.c_oAscSelectionType.RangeImage:r=l.selImage;break;case Asc.c_oAscSelectionType.RangeShape:r=l.selShape;break;case Asc.c_oAscSelectionType.RangeShapeText:r=l.selShapeText;break;case Asc.c_oAscSelectionType.RangeChart:r=l.selChart;break;case Asc.c_oAscSelectionType.RangeChartText:r=l.selChartText}return c.toolbar.lockToolbar(r,r!=t,{clear:[l.selImage,l.selChart,l.selChartText,l.selShape,l.selShapeText,l.coAuth]}),c.toolbar.lockToolbar(Common.enumLock.coAuthText,n),a}(e,!1)||(i=e===Asc.c_oAscSelectionType.RangeCells||e===Asc.c_oAscSelectionType.RangeCol||e===Asc.c_oAscSelectionType.RangeRow||e===Asc.c_oAscSelectionType.RangeMax,this.toolbar.lockToolbar(Common.enumLock.selRange,i,{array:[this.toolbar.btnEditChartData,this.toolbar.btnEditChartType]}),e!=Asc.c_oAscSelectionType.RangeChart&&e!=Asc.c_oAscSelectionType.RangeChartText&&(i=t.asc_getNumFormatInfo())&&(this._state.numformat=t.asc_getNumFormat(),i=(this._state.numformatinfo=i).asc_getType(),this._state.numformattype!==i&&(c.toolbar.cmbNumberFormat.setValue(i,c.toolbar.txtCustom),this._state.numformattype=i))))},onApiSelectionChanged_MailMergeEditor:function(t){var e,i,s,o,n,a,l,r,c;this.editMode&&!this.api.isCellEdited&&!this.api.isRangeSelection&&t&&(e=this,i=t.asc_getSelectionType(),c=!1,o=(s=i)==Asc.c_oAscSelectionType.RangeChartText,r=s==Asc.c_oAscSelectionType.RangeChart,n=s==Asc.c_oAscSelectionType.RangeShapeText,a=s==Asc.c_oAscSelectionType.RangeShape,l=s==Asc.c_oAscSelectionType.RangeImage||s==Asc.c_oAscSelectionType.RangeSlicer,n=n||a||o||r,o=a=!1,(n||l||e._state.selection_type!==s||e._state.coauthdisable!==c?(n&&(a=e.api.asc_getGraphicObjectProps().some(function(t){return t.asc_getObjectType()==Asc.c_oAscTypeSelectElement.Image&&t.asc_getObjectValue().asc_getLocked()})),e.toolbar.lockToolbar(Common.enumLock.coAuthText,a),l):s===Asc.c_oAscSelectionType.RangeImage)||i==Asc.c_oAscSelectionType.RangeChart||i==Asc.c_oAscSelectionType.RangeChartText||e.toolbar.mode.isEditDiagram||(c=(r=t.asc_getAutoFilterInfo())?r.asc_getIsAutoFilter():null,this._state.filter!==c&&(e.toolbar.btnSetAutofilter.toggle(!0===c,!0),this._state.filter=c),o=this._state.controlsdisabled.filters||null===c,e.toolbar.lockToolbar(Common.enumLock.ruleFilter,o,{array:[e.toolbar.btnSetAutofilter,e.toolbar.btnSortDown,e.toolbar.btnSortUp]}),o=this._state.controlsdisabled.filters||!r||!0!==r.asc_getIsApplyAutoFilter(),e.toolbar.lockToolbar(Common.enumLock.ruleDelFilter,o,{array:[e.toolbar.btnClearAutofilter]})))},onApiSelectionChanged_OleEditor:function(t){if(this.editMode&&!this.api.isCellEdited&&!this.api.isRangeSelection&&t){var c=this,e=t.asc_getSelectionType(),i=t.asc_getXfs(),s=this.toolbar,o=function(t,e){var i=t==Asc.c_oAscSelectionType.RangeChartText,s=t==Asc.c_oAscSelectionType.RangeChart,o=t==Asc.c_oAscSelectionType.RangeShapeText,n=t==Asc.c_oAscSelectionType.RangeShape,a=t==Asc.c_oAscSelectionType.RangeImage||t==Asc.c_oAscSelectionType.RangeSlicer,o=o||n||i||s,n=!1;if(!o&&!a&&c._state.selection_type===t&&c._state.coauthdisable===e)return t===Asc.c_oAscSelectionType.RangeImage;o&&(n=c.api.asc_getGraphicObjectProps().some(function(t){return t.asc_getObjectType()==Asc.c_oAscTypeSelectElement.Image&&t.asc_getObjectValue().asc_getLocked()}));var l=Common.enumLock,r=t;switch(t){case Asc.c_oAscSelectionType.RangeSlicer:case Asc.c_oAscSelectionType.RangeImage:r=l.selImage;break;case Asc.c_oAscSelectionType.RangeShape:r=l.selShape;break;case Asc.c_oAscSelectionType.RangeShapeText:r=l.selShapeText;break;case Asc.c_oAscSelectionType.RangeChart:r=l.selChart;break;case Asc.c_oAscSelectionType.RangeChartText:r=l.selChartText}return c.toolbar.lockToolbar(r,r!=t,{clear:[l.selImage,l.selChart,l.selChartText,l.selShape,l.selShapeText,l.coAuth]}),c.toolbar.lockToolbar(Common.enumLock.coAuthText,n),c._state.controlsdisabled.filters=a||o,a}(e,!1);if(!o&&e!=Asc.c_oAscSelectionType.RangeChart&&e!=Asc.c_oAscSelectionType.RangeChartText){Common.NotificationCenter.trigger("fonts:change",i);o=i.asc_getFontSize();this._state.fontsize!==o&&(s.cmbFontSize.setValue(void 0!==o?o:""),this._state.fontsize=o),e=i.asc_getFontBold(),this._state.bold!==e&&(s.btnTextFormatting.menu.items[0].setChecked(!0===e),this._state.bold=e),e=i.asc_getFontItalic(),this._state.italic!==e&&(s.btnTextFormatting.menu.items[1].setChecked(!0===e),this._state.italic=e),e=i.asc_getFontUnderline(),this._state.underline!==e&&(s.btnTextFormatting.menu.items[2].setChecked(!0===e),this._state.underline=e),e=i.asc_getFontStrikeout(),this._state.strikeout!==e&&(s.btnTextFormatting.menu.items[3].setChecked(!0===e),this._state.strikeout=e),e=i.asc_getFontSuperscript(),this._state.superscript!==e&&(s.btnTextFormatting.menu.items[4].setChecked(!0===e),this._state.superscript=e),e=i.asc_getFontSubscript(),this._state.subscript!==e&&(s.btnTextFormatting.menu.items[5].setChecked(!0===e),this._state.subscript=e);var n,a=s.mnuTextColorPicker,l=s.mnuBackColorPicker;if(!a.isDummy){if(n=i.asc_getFontColor())if(n.get_auto())"auto"!==this._state.clrtext&&(a.clearSelection(),s.btnTextColor.setAutoColor(!0),this._state.clrtext="auto");else{var r,d=typeof(r=n.get_type()==Asc.c_oAscColor.COLOR_TYPE_SCHEME?{color:Common.Utils.ThemeColor.getHexColor(n.get_r(),n.get_g(),n.get_b()),effectValue:n.get_value()}:Common.Utils.ThemeColor.getHexColor(n.get_r(),n.get_g(),n.get_b())),h=typeof this._state.clrtext;if("auto"==this._state.clrtext||d!==h||"object"==d&&(r.effectValue!==this._state.clrtext.effectValue||this._state.clrtext.color.indexOf(r.color)<0)||"object"!=d&&void 0!==this._state.clrtext&&this._state.clrtext.indexOf(r)<0){if(s.btnTextColor.setAutoColor(!1),_.isObject(r)){for(var p=!1,m=0;m<10;m++)if(Common.Utils.ThemeColor.ThemeValues[m]==r.effectValue){a.select(r,!0),p=!0;break}p||a.clearSelection()}else a.select(r,!0);this._state.clrtext=r}}this._state.clrtext_asccolor=n}if(!l.isDummy){if((d=typeof(r=(n=i.asc_getFillColor())&&!n.get_auto()?n.get_type()==Asc.c_oAscColor.COLOR_TYPE_SCHEME?{color:Common.Utils.ThemeColor.getHexColor(n.get_r(),n.get_g(),n.get_b()),effectValue:n.get_value()}:Common.Utils.ThemeColor.getHexColor(n.get_r(),n.get_g(),n.get_b()):"transparent"))!==(h=typeof this._state.clrback)||"object"==d&&(r.effectValue!==this._state.clrback.effectValue||this._state.clrback.color.indexOf(r.color)<0)||"object"!=d&&void 0!==this._state.clrback&&this._state.clrback.indexOf(r)<0){if(_.isObject(r)){for(p=!1,m=0;m<10;m++)if(Common.Utils.ThemeColor.ThemeValues[m]==r.effectValue){l.select(r,!0),p=!0;break}p||l.clearSelection()}else l.select(r,!0);this._state.clrback=r}this._state.clrshd_asccolor=n}o=t.asc_getAutoFilterInfo(),h=t.asc_getFormatTableInfo(),d=i.asc_getHorAlign();if(this._state.pralign!==d){var u,g=-1;switch(this._state.pralign=d){case AscCommon.align_Left:g=0,u="btn-align-left";break;case AscCommon.align_Center:g=1,u="btn-align-center";break;case AscCommon.align_Right:g=2,u="btn-align-right";break;case AscCommon.align_Justify:g=3,u="btn-align-just";break;default:g=-255,u="btn-align-left"}g<0?-255==g&&s.btnHorizontalAlign.menu.clearAll():s.btnHorizontalAlign.menu.items[g].setChecked(!0),s.btnHorizontalAlign.rendered&&s.btnHorizontalAlign.$icon&&(s.btnHorizontalAlign.$icon.removeClass(s.btnHorizontalAlign.options.icls).addClass(u),s.btnHorizontalAlign.options.icls=u),s.btnWrap.allowDepress=d!==AscCommon.align_Justify}if(d=i.asc_getVertAlign(),this._state.valign!==d){switch(g=-1,u="",this._state.valign=d){case Asc.c_oAscVAlign.Top:g=0,u="btn-align-top";break;case Asc.c_oAscVAlign.Center:g=1,u="btn-align-middle";break;case Asc.c_oAscVAlign.Bottom:g=2,u="btn-align-bottom"}g<0?-255==g&&s.btnVerticalAlign.menu.clearAll():s.btnVerticalAlign.menu.items[g].setChecked(!0),s.btnVerticalAlign.rendered&&s.btnVerticalAlign.$icon&&(s.btnVerticalAlign.$icon.removeClass(s.btnVerticalAlign.options.icls).addClass(u),s.btnVerticalAlign.options.icls=u)}n=this._state.controlsdisabled.filters||null!==h||o&&null===o.asc_getIsAutoFilter(),s.lockToolbar(Common.enumLock.ruleMerge,n,{array:[s.btnMerge]}),e=t.asc_getMerge(),this._state.merge!==e&&(s.btnMerge.toggle(e===Asc.c_oAscMergeOptions.Merge,!0),this._state.merge=e),s.btnWrap.isDisabled()||(e=i.asc_getWrapText(),this._state.wrap!==e&&(s.btnWrap.toggle(!0===e,!0),this._state.wrap=e)),e=o?o.asc_getIsAutoFilter():null,this._state.filter=e,n=this._state.controlsdisabled.filters||null===e,s.lockToolbar(Common.enumLock.ruleFilter,n,{array:[s.btnTableTemplate]}),e=h?h.asc_getTableStyleName():null,this._state.tablestylename!==e&&this.toolbar.mnuTableTemplatePicker&&((e=this.toolbar.mnuTableTemplatePicker.store.findWhere({name:e}))?(this.toolbar.mnuTableTemplatePicker.selectRecord(e),this._state.tablestylename=e.get("name")):(s.mnuTableTemplatePicker.deselectAll(),this._state.tablestylename=null)),e=t.asc_getStyleName(),this._state.prstyle!=e&&this.toolbar.mnuCellStylePicker&&((e=this.toolbar.mnuCellStylePicker.store.findWhere({name:e}))?(this.toolbar.mnuCellStylePicker.selectRecord(e),this._state.prstyle=e.get("name")):(this.toolbar.mnuCellStylePicker.deselectAll(),this._state.prstyle=null));d=this._state.tablename,h=(this._state.tablename=h?h.asc_getTableName():void 0,this._state.filterapplied);this._state.filterapplied=this._state.filter&&o.asc_getIsApplyAutoFilter(),this._state.tablename===d&&this._state.filterapplied===h||this.getApplication().getController("Statusbar").onApiFilterInfo(!n),this._state.multiselect=t.asc_getMultiselect(),s.lockToolbar(Common.enumLock.multiselect,this._state.multiselect,{array:[s.btnTableTemplate]}),this._state.inpivot=!!t.asc_getPivotTableInfo(),s.lockToolbar(Common.enumLock.editPivot,this._state.inpivot,{array:[s.btnMerge]}),n=!this.appConfig.canModifyFilter,s.lockToolbar(Common.enumLock.cantModifyFilter,n,{array:[s.btnTableTemplate]}),(e=i.asc_getNumFormatInfo())&&(this._state.numformat=i.asc_getNumFormat(),e=(this._state.numformatinfo=e).asc_getType(),this._state.numformattype!==e&&(c.toolbar.cmbNumberFormat.setValue(e,c.toolbar.txtCustom),this._state.numformattype=e))}}},onApiEditorSelectionChanged_OleEditor:function(t){if(this.editMode&&!(0<$(".asc-window.enable-key-events:visible").length)){var e=this.toolbar,i=(Common.NotificationCenter.trigger("fonts:change",t),i=t.asc_getFontBold(),this._state.bold!==i&&(e.btnTextFormatting.menu.items[0].setChecked(!0===i),this._state.bold=i),i=t.asc_getFontItalic(),this._state.italic!==i&&(e.btnTextFormatting.menu.items[1].setChecked(!0===i),this._state.italic=i),i=t.asc_getFontUnderline(),this._state.underline!==i&&(e.btnTextFormatting.menu.items[2].setChecked(!0===i),this._state.underline=i),i=t.asc_getFontStrikeout(),this._state.strikeout!==i&&(e.btnTextFormatting.menu.items[3].setChecked(!0===i),this._state.strikeout=i),i=t.asc_getFontSubscript(),this._state.subscript!==i&&(e.btnTextFormatting.menu.items[4].setChecked(!0===i),this._state.subscript=i),i=t.asc_getFontSuperscript(),this._state.superscript!==i&&(e.btnTextFormatting.menu.items[5].setChecked(!0===i),this._state.superscript=i),t.asc_getFontSize());this._state.fontsize!==i&&(e.cmbFontSize.setValue(void 0!==i?i:""),this._state.fontsize=i);var s=this.toolbar.mnuTextColorPicker;if(!s.isDummy){if(e=t.asc_getFontColor())if(e.get_auto())"auto"!==this._state.clrtext&&(s.clearSelection(),this.toolbar.btnTextColor.setAutoColor(!0),this._state.clrtext="auto");else{var o,i=typeof(o=e.get_type()==Asc.c_oAscColor.COLOR_TYPE_SCHEME?{color:Common.Utils.ThemeColor.getHexColor(e.get_r(),e.get_g(),e.get_b()),effectValue:e.get_value()}:Common.Utils.ThemeColor.getHexColor(e.get_r(),e.get_g(),e.get_b())),t=typeof this._state.clrtext;if("auto"==this._state.clrtext||i!=t||"object"==i&&(o.effectValue!==this._state.clrtext.effectValue||this._state.clrtext.color.indexOf(o.color)<0)||"object"!=i&&void 0!==this._state.clrtext&&this._state.clrtext.indexOf(o)<0){if(this.toolbar.btnTextColor.setAutoColor(!1),_.isObject(o)){for(var n=!1,a=0;a<10;a++)if(Common.Utils.ThemeColor.ThemeValues[a]==o.effectValue){s.select(o,!0),n=!0;break}n||s.clearSelection()}else s.select(o,!0);this._state.clrtext=o}}this._state.clrtext_asccolor=e}}},onApiStyleChange:function(){this.toolbar.btnCopyStyle.toggle(!1,!0),this.modeAlwaysSetStyle=!1},updateThemeColors:function(){function t(t,e){if(t){for(var i,s=Common.Utils.ThemeColor.getEffectColors(),o=0;o<s.length;o++)"object"==typeof t.currentColor&&void 0===i&&t.currentColor.effectId==s[o].effectId&&(i=s[o]);t.updateColors(s,Common.Utils.ThemeColor.getStandartColors()),void 0===t.currentColor?t.currentColor=e:void 0!==i&&(t.currentColor=i)}}var e,i;t(this.toolbar.mnuTextColorPicker,Common.Utils.ThemeColor.getStandartColors()[1]),void 0!==this.toolbar.btnTextColor.currentColor&&this.toolbar.btnTextColor.currentColor.isAuto||(this.toolbar.btnTextColor.currentColor=Common.Utils.ThemeColor.getStandartColors()[1],this.toolbar.btnTextColor.setColor(this.toolbar.btnTextColor.currentColor)),t(this.toolbar.mnuBackColorPicker,Common.Utils.ThemeColor.getStandartColors()[3]),void 0===this.toolbar.btnBackColor.currentColor?this.toolbar.btnBackColor.currentColor=Common.Utils.ThemeColor.getStandartColors()[3]:this.toolbar.btnBackColor.currentColor=this.toolbar.mnuBackColorPicker.currentColor.color||this.toolbar.mnuBackColorPicker.currentColor,this.toolbar.btnBackColor.setColor(this.toolbar.btnBackColor.currentColor),void 0===this._state.clrtext_asccolor&&void 0===this._state.clrshd_asccolor||(this._state.clrtext=void 0,this._state.clrback=void 0,this.onApiSelectionChanged(this.api.asc_getCellInfo())),this._state.clrtext_asccolor=void 0,this._state.clrshd_asccolor=void 0,this.toolbar.mnuBorderColorPicker&&(t(this.toolbar.mnuBorderColorPicker,{color:"000",isAuto:!0}),(e=this.toolbar.mnuBorderColorPicker.currentColor)&&e.isAuto&&((i=this.toolbar.btnBorders.menu.$el.find("#id-toolbar-menu-auto-bordercolor > a")).hasClass("selected")||i.addClass("selected")),this.toolbar.btnBorders.options.borderscolor=e.color||e,$("#id-toolbar-mnu-item-border-color > a .menu-item-icon").css("border-color","#"+this.toolbar.btnBorders.options.borderscolor))},hideElements:function(t){var e;_.isUndefined(t.compact)||this.onChangeViewMode(t.compact),_.isUndefined(t.formula)||((e=this.getApplication().getController("CellEditor").getView("CellEditor"))&&e.setVisible(!t.formula),Common.NotificationCenter.trigger("layout:changed","celleditor",t.formula?"hidden":"showed")),_.isUndefined(t.headings)||this.api&&this.api.asc_setDisplayHeadings(!t.headings),_.isUndefined(t.gridlines)||this.api&&this.api.asc_setDisplayGridlines(!t.gridlines),_.isUndefined(t.freezepanes)||this.api&&this.api.asc_freezePane(),Common.NotificationCenter.trigger("edit:complete",this.toolbar)},onApiAutoShapes:function(){function e(t){i.fillAutoShapes(),t.off("show:before",e)}var i=this;i.toolbar.btnInsertShape.menu.on("show:before",e)},fillAutoShapes:function(){var o=this,t=new Common.UI.MenuItem({template:_.template('<div id="id-toolbar-menu-insertshape" class="menu-insertshape"></div>')}),t=(o.toolbar.btnInsertShape.menu.addItem(t),Common.localStorage.getItem("sse-recent-shapes"));new Common.UI.DataViewShape({el:$("#id-toolbar-menu-insertshape"),itemTemplate:_.template('<div class="item-shape" id="<%= id %>"><svg width="20" height="20" class="icon uni-scale"><use xlink:href="#svg-icon-<%= data.shapeType %>"></use></svg></div>'),groups:o.getApplication().getCollection("ShapeGroups"),parentMenu:o.toolbar.btnInsertShape.menu,restoreHeight:652,textRecentlyUsed:o.textRecentlyUsed,recentShapes:t?JSON.parse(t):null}).on("item:click",function(t,e,i,s){o.api&&(i&&(o._addAutoshape(!0,i.get("data").shapeType),o._isAddingShape=!0),o.toolbar.btnInsertText.pressed&&o.toolbar.btnInsertText.toggle(!1,!0),"click"!==s.type&&o.toolbar.btnInsertShape.menu.hide(),Common.NotificationCenter.trigger("edit:complete",o.toolbar,o.toolbar.btnInsertShape),Common.component.Analytics.trackEvent("ToolBar","Add Shape"))})},fillEquations:function(){if(this.toolbar.btnInsertEquation.rendered&&!(0<this.toolbar.btnInsertEquation.menu.items.length)){var o=this,i=this.getApplication().getCollection("EquationGroups"),s=(o.toolbar.btnInsertEquation.menu.removeAll(),function(t){for(var e=0;e<i.length;++e)new Common.UI.DataViewSimple({el:$("#id-toolbar-menu-equationgroup"+e),parentMenu:t.items[e].menu,store:i.at(e).get("groupStore"),scrollAlwaysVisible:!0,itemTemplate:_.template('<div class="item-equation"><div class="equation-icon" style="background-position:<%= posX %>px <%= posY %>px;width:<%= width %>px;height:<%= height %>px;" id="<%= id %>"></div></div>')}).on("item:click",function(t,e,i,s){o.api&&(i&&o.api.asc_AddMath(i.get("data").equationType),o.toolbar.btnInsertText.pressed&&o.toolbar.btnInsertText.toggle(!1,!0),o.toolbar.btnInsertShape.pressed&&o.toolbar.btnInsertShape.toggle(!1,!0),"click"!==s.type&&o.toolbar.btnInsertEquation.menu.hide(),Common.NotificationCenter.trigger("edit:complete",o.toolbar,o.toolbar.btnInsertEquation),Common.component.Analytics.trackEvent("ToolBar","Add Equation"))});t.off("show:after",s)});o.toolbar.btnInsertEquation.menu.on("show:after",s);for(var t=0;t<i.length;++t){var e=i.at(t),e=new Common.UI.MenuItem({caption:e.get("groupName"),menu:new Common.UI.Menu({menuAlign:"tl-tr",items:[{template:_.template('<div id="id-toolbar-menu-equationgroup'+t+'" class="menu-shape margin-left-5" style="width:'+(e.get("groupWidth")+8)+"px; "+e.get("groupHeightStr")+'"></div>')}]})});o.toolbar.btnInsertEquation.menu.addItem(e)}}},onInsertEquationClick:function(){this.api&&(this.api.asc_AddMath(),Common.component.Analytics.trackEvent("ToolBar","Add Equation")),Common.NotificationCenter.trigger("edit:complete",this.toolbar,this.toolbar.btnInsertEquation)},onInsertSymbolClick:function(){Common.NotificationCenter.trigger("protect:check",this.onInsertSymbolClickCallback,this,[])},onInsertSymbolClickCallback:function(){var s,t;this.api&&(t=(s=this).api.asc_GetSelectedText(),(t=new Common.Views.SymbolTableDialog({api:s.api,lang:s.toolbar.mode.lang,type:1,special:!0,buttons:[{value:"ok",caption:this.textInsert},"close"],font:t&&0<t.length?s.api.asc_getCellInfo().asc_getXfs().asc_getFontName():void 0,symbol:t&&0<t.length?t.charAt(0):void 0,handler:function(t,e,i){"ok"==e?s.insertSymbol(i.font,i.code,i.special,i.speccharacter):Common.NotificationCenter.trigger("edit:complete",s.toolbar)}})).show(),t.on("symbol:dblclick",function(t,e,i){s.insertSymbol(i.font,i.code,i.special,i.speccharacter)}))},onInsertSymbolItemClick:function(t,e,i,s){this.api&&i&&this.insertSymbol(i.get("font"),i.get("symbol"),i.get("special"))},insertSymbol:function(t,e,i,s){t=t||this.api.asc_getCellInfo().asc_getXfs().asc_getFontName();this.api.asc_insertSymbol(t,e,i),s||this.toolbar.saveSymbol(e,t)},onInsertSlicerClick:function(){var i=this,t=i.api.asc_beforeInsertSlicer();t&&new SSE.Views.SlicerAddDialog({props:t,handler:function(t,e){i&&i.api&&"ok"==t&&i.api.asc_insertSlicer(e),Common.NotificationCenter.trigger("edit:complete",i.toolbar)}}).show()},onApiMathTypes:function(t){this._equationTemp=t;function e(t){i.onMathTypes(i._equationTemp),i._equationTemp&&0<i._equationTemp.get_Data().length&&i.fillEquations(),i.toolbar.btnInsertEquation.menu.off("show:before",e)}var i=this;i.toolbar.btnInsertEquation.menu.on("show:before",e)},onMathTypes:function(t){t=t||this._equationTemp;var e=[],i=this.getCollection("EquationGroups");if(!(0<i.length)){var s={},o=(s[Common.define.c_oAscMathMainType.Symbol]=[this.textSymbols,11,!1,"svg-icon-symbols"],s[Common.define.c_oAscMathMainType.Fraction]=[this.textFraction,4,!1,"svg-icon-fraction"],s[Common.define.c_oAscMathMainType.Script]=[this.textScript,4,!1,"svg-icon-script"],s[Common.define.c_oAscMathMainType.Radical]=[this.textRadical,4,!1,"svg-icon-radical"],s[Common.define.c_oAscMathMainType.Integral]=[this.textIntegral,3,!0,"svg-icon-integral"],s[Common.define.c_oAscMathMainType.LargeOperator]=[this.textLargeOperator,5,!0,"svg-icon-largeOperator"],s[Common.define.c_oAscMathMainType.Bracket]=[this.textBracket,4,!0,"svg-icon-bracket"],s[Common.define.c_oAscMathMainType.Function]=[this.textFunction,3,!0,"svg-icon-function"],s[Common.define.c_oAscMathMainType.Accent]=[this.textAccent,4,!1,"svg-icon-accent"],s[Common.define.c_oAscMathMainType.LimitLog]=[this.textLimitAndLog,3,!1,"svg-icon-limAndLog"],s[Common.define.c_oAscMathMainType.Operator]=[this.textOperator,4,!1,"svg-icon-operator"],s[Common.define.c_oAscMathMainType.Matrix]=[this.textMatrix,4,!0,"svg-icon-matrix"],{}),n="",a="";for(n in Common.define.c_oAscMathType)Common.define.c_oAscMathType.hasOwnProperty(n)&&(a=2==(b=n.split("_")).length&&"Symbol"==b[0]?"txt"+b[0]+"_"+b[1].toLocaleLowerCase():"txt"+n,o[Common.define.c_oAscMathType[n]]=this[a]);var l,r,c=null,d=null,h=null;if(t&&(l=(r=t.get_Data()).length)){for(var p=0;p<l;++p){var m=r[p],u=m.get_Id();if(w=m.get_W(),_=m.get_H(),c=new Backbone.Collection([],{model:SSE.Models.EquationModel})){for(var g,b=[],C=m.get_Data().length,f=0;f<C;++f){for(var S=(d=m.get_Data()[f]).get_Data().length,v=0;v<S;++v)g=(h=d.get_Data()[v]).get_Id(),a="",o.hasOwnProperty(g)&&(a=o[g]),b.push({data:{equationType:g},tip:a,allowSelected:!0,selected:!1,width:d.get_W(),height:d.get_H(),posX:-h.get_X(),posY:-h.get_Y()});0}c.add(b);var w=s[u][1]*(w+10),_=parseInt(370/(_+10))*(_+10);e.push({groupName:s[u][0],groupStore:c,groupWidth:w,groupHeight:_,groupHeightStr:s[u][2]?" height:"+_+"px!important; ":"",groupIcon:s[u][3]})}}i.add(e)}}},attachToControlEvents:function(){},_disableEditOptions:function(t,e){if(this.api.isCellEdited)return!0;if(this.api.isRangeSelection)return!0;var i=this.toolbar,s=t==Asc.c_oAscSelectionType.RangeChartText,o=t==Asc.c_oAscSelectionType.RangeChart,n=t==Asc.c_oAscSelectionType.RangeShapeText,a=t==Asc.c_oAscSelectionType.RangeShape,l=t==Asc.c_oAscSelectionType.RangeImage,r=t==Asc.c_oAscSelectionType.RangeSlicer,n=n||a||s||o||r,c=!1,d=!1,h=!1,p=!1;if(!n&&!l&&this._state.selection_type===t&&this._state.coauthdisable===e)return t===Asc.c_oAscSelectionType.RangeImage;if(n){for(var m,u,g=this.api.asc_getGraphicObjectProps(),b=0;b<g.length;++b)g[b].asc_getObjectType()==Asc.c_oAscTypeSelectElement.Image&&((u=(m=g[b].asc_getObjectValue())?m.asc_getShapeProperties():null)&&(d=u.asc_getFromSmartArtInternal()),c=c||m.asc_getLocked(),p=p||m.asc_getProtectionLockText(),h=h||m.asc_getProtectionLocked());this._state.is_lockText=p,this._state.is_lockShape=h}if(e)i.lockToolbar(Common.enumLock.coAuth,e);else{var C=Common.enumLock,f=t;switch(t){case Asc.c_oAscSelectionType.RangeImage:f=C.selImage;break;case Asc.c_oAscSelectionType.RangeShape:f=C.selShape;break;case Asc.c_oAscSelectionType.RangeShapeText:f=C.selShapeText;break;case Asc.c_oAscSelectionType.RangeChart:f=C.selChart;break;case Asc.c_oAscSelectionType.RangeChartText:f=C.selChartText;break;case Asc.c_oAscSelectionType.RangeSlicer:f=C.selSlicer}this.appConfig.isEditDiagram||this.appConfig.isEditMailMerge||this.appConfig.isEditOle||i.lockToolbar(f,f!=t,{array:[i.btnClearStyle.menu.items[1],i.btnClearStyle.menu.items[2],i.btnClearStyle.menu.items[3],i.btnClearStyle.menu.items[4]],merge:!0,clear:[C.selImage,C.selChart,C.selChartText,C.selShape,C.selShapeText,C.selSlicer,C.coAuth]}),i.lockToolbar(Common.enumLock.coAuthText,c),i.lockToolbar(Common.enumLock.coAuthText,c&&(t==Asc.c_oAscSelectionType.RangeChart||t==Asc.c_oAscSelectionType.RangeChartText),{array:[i.btnInsertChart,i.btnInsertChartRecommend]}),i.lockToolbar(Common.enumLock.inSmartartInternal,d)}return this._state.controlsdisabled.filters=l||n||e,(l||n||e)&&(i.listStyles&&(i.listStyles.suspendEvents(),i.listStyles.menuPicker.selectRecord(null),i.listStyles.resumeEvents()),this._state.prstyle=void 0),this._state.selection_type=t,this._state.coauthdisable=e,l},_getApiTextSize:function(){var t=this.api.asc_getCellInfo();return t?t.asc_getXfs().asc_getFontSize():12},_setTableFormat:function(s){var t,o=this;!0!==o.api.isRangeSelection&&(o.api.asc_getCellInfo().asc_getFormatTableInfo()?(o._state.filter=void 0,o._state.tablename?o.api.asc_changeAutoFilter(o._state.tablename,Asc.c_oAscChangeFilterOptions.style,s):(t=o.api.asc_getCellInfo().asc_getSelectionType())==Asc.c_oAscSelectionType.RangeMax||t==Asc.c_oAscSelectionType.RangeRow||t==Asc.c_oAscSelectionType.RangeCol?Common.UI.warning({title:o.textLongOperation,msg:o.warnLongOperation,buttons:["ok","cancel"],callback:function(t){"ok"==t&&setTimeout(function(){o.toolbar.fireEvent("inserttable",o.toolbar),o.api.asc_addAutoFilter(s)},1),Common.NotificationCenter.trigger("edit:complete",o.toolbar)}}):(o.toolbar.fireEvent("inserttable",o.toolbar),o.api.asc_addAutoFilter(s))):((t=new SSE.Views.TableOptionsDialog({handler:function(t,e){var i;"ok"==e&&(o._state.filter=void 0,o.api.asc_setSelectionDialogMode(Asc.c_oAscSelectionDialogType.None),o._state.tablename?o.api.asc_changeAutoFilter(o._state.tablename,Asc.c_oAscChangeFilterOptions.style,s):(i=t.getSettings()).selectionType==Asc.c_oAscSelectionType.RangeMax||i.selectionType==Asc.c_oAscSelectionType.RangeRow||i.selectionType==Asc.c_oAscSelectionType.RangeCol?Common.UI.warning({title:o.textLongOperation,msg:o.warnLongOperation,buttons:["ok","cancel"],callback:function(t){"ok"==t&&setTimeout(function(){o.toolbar.fireEvent("inserttable",o.toolbar),o.api.asc_addAutoFilter(s,i.range)},1),Common.NotificationCenter.trigger("edit:complete",o.toolbar)}}):(o.toolbar.fireEvent("inserttable",o.toolbar),o.api.asc_addAutoFilter(s,i.range))),Common.NotificationCenter.trigger("edit:complete",o.toolbar)}})).show(),t.setSettings({api:o.api,selectionType:o.api.asc_getCellInfo().asc_getSelectionType()})))},onHideMenus:function(t){Common.NotificationCenter.trigger("edit:complete",this.toolbar,{restorefocus:!0})},onSetupCopyStyleButton:function(){this.modeAlwaysSetStyle=!1;var e=this;Common.NotificationCenter.on({"edit:complete":function(t){e.api&&e.modeAlwaysSetStyle&&"tab"!==t&&(e.api.asc_formatPainter(AscCommon.c_oAscFormatPainterState.kOff),e.toolbar.btnCopyStyle.toggle(!1,!0),e.modeAlwaysSetStyle=!1)}}),$(e.toolbar.btnCopyStyle.cmpEl).dblclick(function(){e.api&&(e.modeAlwaysSetStyle=!0,e.toolbar.btnCopyStyle.toggle(!0,!0),e.api.asc_formatPainter(AscCommon.c_oAscFormatPainterState.kMultiple))})},onCellsRange:function(t){this.api.isRangeSelection=t!=Asc.c_oAscSelectionDialogType.None,this.onApiEditCell(this.api.isRangeSelection?Asc.c_oAscCellEditorState.editStart:Asc.c_oAscCellEditorState.editEnd);t=this.toolbar;t.lockToolbar(Common.enumLock.selRangeEdit,this.api.isRangeSelection),this.setDisabledComponents([t.btnUndo],this.api.isRangeSelection||!this.api.asc_getCanUndo()),this.setDisabledComponents([t.btnRedo],this.api.isRangeSelection||!this.api.asc_getCanRedo()),this.onApiSelectionChanged(this.api.asc_getCellInfo())},onLockDefNameManager:function(t){this._state.namedrange_locked=t==Asc.c_oAscDefinedNameReason.LockDefNameManager,this.toolbar.lockToolbar(Common.enumLock.printAreaLock,this.api.asc_isPrintAreaLocked(this.api.asc_getActiveWorksheetIndex()),{array:[this.toolbar.btnPrintArea]}),this.toolbar.lockToolbar(Common.enumLock.namedRangeLock,this._state.namedrange_locked,{array:[this.toolbar.btnPrintArea.menu.items[0],this.toolbar.btnPrintArea.menu.items[2]]})},onLockCFManager:function(t){this._state.cf_locked[t]=!0},onUnLockCFManager:function(t){this._state.cf_locked[t]=!1},activateControls:function(){this.toolbar.lockToolbar(Common.enumLock.disableOnStart,!1,{array:[this.toolbar.btnPrint]}),this._state.activated=!0},DisableToolbar:function(t,e){void 0!==e&&(this.editMode=!e),t=t||!this.editMode;var i,s,e=$(".toolbar-mask");t&&0<e.length||!t&&0==e.length||((i=this.toolbar).hideMoreBtns(),i.$el.find(".toolbar").toggleClass("masked",t),this.toolbar.lockToolbar(Common.enumLock.menuFileOpen,t),s=Common.Utils.isMac?"command+alt+a":"alt+h",t?(e=$("<div class='toolbar-mask'>").appendTo(i.$el.find(".toolbar")),Common.util.Shortcuts.suspendEvents("command+l, ctrl+l, command+shift+l, ctrl+shift+l, command+k, ctrl+k, command+1, ctrl+1, "+s)):(e.remove(),Common.util.Shortcuts.resumeEvents("command+l, ctrl+l, command+shift+l, ctrl+shift+l, command+k, ctrl+k, command+1, ctrl+1, "+s)))},applyFormulaSettings:function(){if(this.toolbar.btnInsertFormula&&this.toolbar.btnInsertFormula.rendered)for(var t=this.toolbar.btnInsertFormula.menu.items,e=0;e<Math.min(4,t.length);e++)t[e].setCaption(this.api.asc_getFormulaLocaleName(t[e].value))},onAppShowed:function(t){var e,i,s,o=this,n=!(o.appConfig=t).isEdit;!t.isEdit||t.isEditDiagram||t.isEditMailMerge||t.isEditOle||(Common.localStorage.itemExists("sse-compact-toolbar")?n=Common.localStorage.getBool("sse-compact-toolbar"):t.customization&&t.customization.compactToolbar&&(n=!0)),o.toolbar.render(_.extend({isCompactView:n},t)),log.debug("工具栏显示","controller/Toolbar/onAppShowed",Date.now()-window.__start),!t.canReview||t.isEditDiagram||t.isEditMailMerge||t.isEditOle||(i={action:"review",caption:o.toolbar.textTabCollaboration,layoutname:"toolbar-collaboration",dataHintTitle:"U"},(s=o.getApplication().getController("Common.Controllers.ReviewChanges").createToolbarPanel())&&(o.toolbar.addTab(i,s,7),o.toolbar.setVisible("review",(t.isEdit||t.canViewReview||t.canCoAuthoring&&t.canComments)&&Common.UI.LayoutManager.isElementVisible("toolbar-collaboration")))),t.isEdit&&(o.toolbar.setMode(t),o.toolbar.btnSave&&o.toolbar.btnSave.on("disabled",_.bind(o.onBtnChangeState,o,"save:disabled")),o.toolbar.btnUndo&&o.toolbar.btnUndo.on("disabled",_.bind(o.onBtnChangeState,o,"undo:disabled")),o.toolbar.btnRedo&&o.toolbar.btnRedo.on("disabled",_.bind(o.onBtnChangeState,o,"redo:disabled")),o.toolbar.btnPrint&&o.toolbar.btnPrint.on("disabled",_.bind(o.onBtnChangeState,o,"print:disabled")),o.toolbar.setApi(o.api),t.isEditDiagram||t.isEditMailMerge||t.isEditOle||((n=o.getApplication().getController("Common.Controllers.Draw")).setApi(o.api).setMode(t),(s=n.createToolbarPanel())&&(i={action:"draw",caption:o.toolbar.textTabDraw,extcls:"canedit",layoutname:"toolbar-draw",dataHintTitle:"C"},o.toolbar.addTab(i,s,2),o.toolbar.setVisible("draw",Common.UI.LayoutManager.isElementVisible("toolbar-draw")),Array.prototype.push.apply(o.toolbar.lockControls,n.getView().getButtons())),(n=o.getApplication().getController("DataTab")).setApi(o.api).setConfig({toolbar:o}),n=n.getView("DataTab"),Array.prototype.push.apply(o.toolbar.lockControls,n.getButtons()),o.toolbar.btnsSortDown=n.getButtons("sort-down"),o.toolbar.btnsSortUp=n.getButtons("sort-up"),o.toolbar.btnsSetAutofilter=n.getButtons("set-filter"),o.toolbar.btnsClearAutofilter=n.getButtons("clear-filter"),o.toolbar.btnCustomSort=n.getButtons("sort-custom"),o.toolbar.btnRemoveDuplicates=n.getButtons("rem-duplicates"),o.toolbar.btnDataValidation=n.getButtons("data-validation"),(n=o.getApplication().getController("FormulaDialog")).setConfig({toolbar:o}),n=n.getView("FormulaTab"),o.toolbar.btnsFormula=n.getButtons("formula"),e=n.getButtons("range"),o.toolbar.itemsNamedRange=e&&e.menu&&e.menu.items?[e.menu.items[0],e.menu.items[1]]:[],Array.prototype.push.apply(o.toolbar.lockControls,n.getButtons()),t.canFeaturePivot&&(i={action:"pivot",caption:o.textPivot,dataHintTitle:"B"},(e=o.getApplication().getController("PivotTable")).setApi(o.api).setConfig({toolbar:o}),(s=e.createToolbarPanel())&&(o.toolbar.addTab(i,s,6),o.toolbar.setVisible("pivot",!0),Array.prototype.push.apply(o.toolbar.lockControls,e.getView("PivotTable").getButtons()))),t.customization&&t.customization.compactHeader||(o.toolbar.btnPrint.$el.parents(".group").hide().next().hide(),n=o.toolbar.btnUndo.$el.hide().next().hide().parent(),o.toolbar.btnPaste.$el.detach().appendTo(n),o.toolbar.btnPaste.$el.find("button").attr("data-hint-direction","bottom"),o.toolbar.btnCopy.$el.removeClass("split"),o.toolbar.processPanelVisible(null,!0,!0)),t.canProtect&&(i={action:"protect",caption:o.toolbar.textTabProtect,layoutname:"toolbar-protect",dataHintTitle:"T"},(s=o.getApplication().getController("Common.Controllers.Protection").createToolbarPanel())&&((t.isSignatureSupport||t.isPasswordSupport)&&s.append($('<div class="separator long"></div>')),e=o.getApplication().getController("WBProtection"),s.append(e.createToolbarPanel()),o.toolbar.addTab(i,s,8),o.toolbar.setVisible("protect",Common.UI.LayoutManager.isElementVisible("toolbar-protect")),Array.prototype.push.apply(o.toolbar.lockControls,e.getView("WBProtection").getButtons()))))),t.isEditDiagram||t.isEditMailMerge||t.isEditOle||(i={caption:o.toolbar.textTabView,action:"view",extcls:t.isEdit?"canedit":"",layoutname:"toolbar-view",dataHintTitle:"W"},(n=o.getApplication().getController("ViewTab")).setApi(o.api).setConfig({toolbar:o,mode:t}),(s=n.createToolbarPanel())&&(o.toolbar.addTab(i,s,9),o.toolbar.setVisible("view",Common.UI.LayoutManager.isElementVisible("toolbar-view"))),t.isEdit&&Array.prototype.push.apply(o.toolbar.lockControls,n.getView("ViewTab").getButtons()))},onAppReady:function(t){var e,i,s=this;s.appOptions=t,this.btnsComment=[],t.canCoAuthoring&&t.canComments&&(e=Common.enumLock,this.btnsComment=Common.Utils.injectButtons(this.toolbar.$el.find(".slot-comment"),"tlbtn-addcomment-","toolbar__icon btn-big-menu-comments",this.toolbar.capBtnComment,[e.lostConnect,e.commentLock,e.editCell,e.Objects],void 0,void 0,void 0,"1","bottom","small"),this.btnsComment.length&&(i=SSE.getController("Common.Controllers.Comments").getView(),Array.prototype.push.apply(s.toolbar.lockControls,this.btnsComment),this.btnsComment.forEach(function(t){t.updateHint(i.textHintAddComment),t.on("click",function(t,e){Common.NotificationCenter.trigger("app:comment:add","toolbar",s.api.asc_getCellInfo().asc_getSelectionType()!=Asc.c_oAscSelectionType.RangeCells)}),0<t.cmpEl.closest("#review-changes-panel").length&&t.setCaption(s.toolbar.capBtnAddComment)},this))),Common.Utils.asyncCall(function(){t.isEdit&&s.toolbar.onAppReady(t)})},onFileMenu:function(t){"show"==t?this.toolbar.isTabActive("file")||this.toolbar.setTab("file"):this.toolbar.isTabActive("file")&&this.toolbar.setTab()},onPageSizeClick:function(t,e,i){this.api&&i&&(this._state.pgsize=[0,0],this.api.asc_changeDocSize(e.value[0],e.value[1],this.api.asc_getActiveWorksheetIndex()),Common.component.Analytics.trackEvent("ToolBar","Page Size")),Common.NotificationCenter.trigger("edit:complete",this.toolbar)},onPageMarginsSelect:function(t,e){var i,s;this.api&&(this._state.pgmargins=void 0,"advanced"!==e.value?this.api.asc_changePageMargins(e.value[1],e.value[3],e.value[0],e.value[2],this.api.asc_getActiveWorksheetIndex()):(s=this,(e=new SSE.Views.PageMarginsDialog({handler:function(t,e){"ok"==e&&(i=t.getSettings(),Common.localStorage.setItem("sse-pgmargins-top",i.asc_getTop()),Common.localStorage.setItem("sse-pgmargins-left",i.asc_getLeft()),Common.localStorage.setItem("sse-pgmargins-bottom",i.asc_getBottom()),Common.localStorage.setItem("sse-pgmargins-right",i.asc_getRight()),Common.NotificationCenter.trigger("margins:update",i),s.toolbar.btnPageMargins.menu.items[0].setChecked(!0),s.api.asc_changePageMargins(i.asc_getLeft(),i.asc_getRight(),i.asc_getTop(),i.asc_getBottom(),s.api.asc_getActiveWorksheetIndex()),Common.NotificationCenter.trigger("edit:complete",s.toolbar))}})).show(),e.setSettings(s.api.asc_getPageOptions(s.api.asc_getActiveWorksheetIndex()))),Common.component.Analytics.trackEvent("ToolBar","Page Margins")),Common.NotificationCenter.trigger("edit:complete",this.toolbar)},onPageOrientSelect:function(t,e){this._state.pgorient=void 0,this.api&&e.checked&&this.api.asc_changePageOrient(e.value==Asc.c_oAscPageOrientation.PagePortrait,this.api.asc_getActiveWorksheetIndex()),Common.NotificationCenter.trigger("edit:complete",this.toolbar),Common.component.Analytics.trackEvent("ToolBar","Page Orientation")},onImgGroupSelect:function(t,e){this.api&&this.api["grouping"==e.value?"asc_groupGraphicsObjects":"asc_unGroupGraphicsObjects"](),Common.NotificationCenter.trigger("edit:complete",this.toolbar),Common.component.Analytics.trackEvent("ToolBar","Objects Group")},onImgArrangeSelect:function(t,e){this.api&&("forward"==t?this.api.asc_setSelectedDrawingObjectLayer(Asc.c_oAscDrawingLayerType.BringForward):"backward"==t?this.api.asc_setSelectedDrawingObjectLayer(Asc.c_oAscDrawingLayerType.SendBackward):this.api.asc_setSelectedDrawingObjectLayer(e.value)),Common.NotificationCenter.trigger("edit:complete",this.toolbar),Common.component.Analytics.trackEvent("ToolBar","Objects Arrange")},onImgAlignSelect:function(t,e){this.api&&(-1<e.value&&e.value<6?(this.api.asc_setSelectedDrawingObjectAlign(e.value),Common.component.Analytics.trackEvent("ToolBar","Objects Align")):6==e.value?(this.api.asc_DistributeSelectedDrawingObjectHor(),Common.component.Analytics.trackEvent("ToolBar","Distribute")):7==e.value&&(this.api.asc_DistributeSelectedDrawingObjectVer(),Common.component.Analytics.trackEvent("ToolBar","Distribute"))),Common.NotificationCenter.trigger("edit:complete",this.toolbar)},onPrintAreaClick:function(t,e){this.api&&(this.api.asc_ChangePrintArea(e.value),Common.component.Analytics.trackEvent("ToolBar","Print Area")),Common.NotificationCenter.trigger("edit:complete",this.toolbar)},onPrintAreaMenuOpen:function(){this.api&&this.toolbar.btnPrintArea.menu.items[2].setVisible(this.api.asc_CanAddPrintArea())},onPageBreakClick:function(t,e){this.api&&("ins"===e.value?this.api.asc_InsertPageBreak():"del"===e.value?this.api.asc_RemovePageBreak():"reset"===e.value&&this.api.asc_ResetAllPageBreaks(),Common.component.Analytics.trackEvent("ToolBar","Page Break")),Common.NotificationCenter.trigger("edit:complete",this.toolbar)},onPageBreakMenuOpen:function(){var t;this.api&&(t=this.api.asc_GetPageBreaksDisableType(this.api.asc_getActiveWorksheetIndex()),this.toolbar.btnPageBreak.menu.items[0].setDisabled(t===Asc.c_oAscPageBreaksDisableType.insertRemove),this.toolbar.btnPageBreak.menu.items[1].setDisabled(t===Asc.c_oAscPageBreaksDisableType.insertRemove),this.toolbar.btnPageBreak.menu.items[2].setDisabled(t===Asc.c_oAscPageBreaksDisableType.reset))},onEditHeaderClick:function(t,e){var i,s,o=this;_.isUndefined(o.fontStore)&&(o.fontStore=new Common.Collections.Fonts,i=o.toolbar.cmbFontName.store.toJSON(),s=[],_.each(i,function(t,e){t.cloneid||s.push(_.clone(t))}),o.fontStore.add(s)),new SSE.Views.HeaderFooterDialog({api:o.api,fontStore:o.fontStore,pageSetup:t,handler:function(t,e){"ok"===e&&o.getApplication().getController("Print").updatePreview(),Common.NotificationCenter.trigger("edit:complete")}}).show(),Common.NotificationCenter.trigger("edit:complete",this.toolbar)},onClickChangeScaleInMenu:function(t,e){this.api&&(400<(t="up"===t?.001<e%5?5*Math.ceil(e/5):e+5:.001<e%5?5*Math.floor(e/5):e-5)?t=400:t<10&&(t=10),this.onChangeScaleSettings(0,0,t))},onScaleClick:function(t,e,i,s,o){var n=this;n.api&&("width"===t&&"more"!==i.value?(void 0!==n._state.scaleHeight&&null!==n._state.scaleHeight||(n._state.scaleHeight=0),n.api.asc_SetPrintScale(i.value,n._state.scaleHeight,100),n.onChangeScaleSettings(i.value,n._state.scaleHeight,100)):"height"===t&&"more"!==i.value?(void 0!==n._state.scaleWidth&&null!==n._state.scaleWidth||(n._state.scaleWidth=0),n.api.asc_SetPrintScale(n._state.scaleWidth,i.value,100),n.onChangeScaleSettings(n._state.scaleWidth,i.value,100)):"scale"===t&&void 0!==o?n.api.asc_SetPrintScale(0,0,o):"custom"!==i.value&&"more"!==i.value||new SSE.Views.ScaleDialog({api:n.api,props:null,handler:function(t,e){"ok"==t?n.api&&e&&(n.api.asc_SetPrintScale(e.width,e.height,e.scale),n.onChangeScaleSettings(e.width,e.height,e.scale)):n.onChangeScaleSettings(n._state.scaleWidth,n._state.scaleHeight,n._state.scale),Common.NotificationCenter.trigger("edit:complete")}}).show()),Common.NotificationCenter.trigger("edit:complete",this.toolbar)},onPrintTitlesClick:function(t){var i,s;this.api&&(s=this,new SSE.Views.PrintTitlesDialog({api:s.api,sheet:s.api.asc_getActiveWorksheetIndex(),handler:function(t,e){"ok"==e&&(i=t.getSettings(),s.api.asc_changePrintTitles(i.width,i.height,s.api.asc_getActiveWorksheetIndex()),Common.NotificationCenter.trigger("edit:complete",s.toolbar))}}).show(),Common.component.Analytics.trackEvent("ToolBar","Print Titles")),Common.NotificationCenter.trigger("edit:complete",this.toolbar)},onChangeProtectSheet:function(t){var e;(t=t?t:(e=this.getApplication().getController("WBProtection"))?e.getWSProps():null)&&(this._state.wsProps=t.wsProps,this._state.wsLock=t.wsLock,this.toolbar.lockToolbar(Common.enumLock.wsLock,this._state.wsLock),this.toolbar.lockToolbar(Common.enumLock.InsertHyperlinks,this._state.wsProps.InsertHyperlinks,{array:[this.toolbar.btnInsertHyperlink]}),this.appConfig&&this.appConfig.isEdit?this.onApiSelectionChanged(this.api.asc_getCellInfo()):this.onApiSelectionChangedRestricted(this.api.asc_getCellInfo()))},onPrintGridlinesChange:function(t,e){this.api.asc_SetPrintGridlines("checked"===e),Common.NotificationCenter.trigger("edit:complete",this.toolbar)},onPrintHeadingsChange:function(t,e){this.api.asc_SetPrintHeadings("checked"===e),Common.NotificationCenter.trigger("edit:complete",this.toolbar)},onVisibleAreaClose:function(t){this.api&&this.api.asc_toggleChangeVisibleAreaOleEditor(!1),this.toolbar.lockToolbar(Common.enumLock.editVisibleArea,!1),this.toolbar.btnVisibleArea.setVisible(!0),this.toolbar.btnVisibleAreaClose.setVisible(!1),Common.NotificationCenter.trigger("edit:complete",this.toolbar)},onVisibleAreaMenu:function(t,e,i){this.api&&("edit"===e.value?(this.api.asc_toggleChangeVisibleAreaOleEditor(!0),this.toolbar.btnVisibleArea.setVisible(!1),this.toolbar.btnVisibleAreaClose.setVisible(!0),this.toolbar.lockToolbar(Common.enumLock.editVisibleArea,!0)):(this.api.asc_toggleShowVisibleAreaOleEditor("show"===e.value),this.toolbar.btnVisibleArea.menu.items[0].setVisible("show"!==e.value),this.toolbar.btnVisibleArea.menu.items[1].setVisible("show"===e.value))),Common.NotificationCenter.trigger("edit:complete",this.toolbar)},onOleEditClose:function(){this.api&&(this.api.asc_toggleChangeVisibleAreaOleEditor(!1),this.toolbar.btnVisibleArea.setVisible(!0),this.toolbar.btnVisibleAreaClose.setVisible(!1),this.toolbar.lockToolbar(Common.enumLock.editVisibleArea,!1),this.api.asc_toggleShowVisibleAreaOleEditor(!1),this.toolbar.btnVisibleArea.menu.items[0].setVisible(!0),this.toolbar.btnVisibleArea.menu.items[1].setVisible(!1))},onTextFormattingMenu:function(t,e){if(this.api)switch(e.value){case"bold":this._state.bold=void 0,this.api.asc_setCellBold(e.checked);break;case"italic":this._state.italic=void 0,this.api.asc_setCellItalic(e.checked);break;case"underline":this._state.underline=void 0,this.api.asc_setCellUnderline(e.checked);break;case"strikeout":this._state.strikeout=void 0,this.api.asc_setCellStrikeout(e.checked);break;case"subscript":this._state.subscript=void 0,this.api.asc_setCellSubscript(e.checked);break;case"superscript":this._state.superscript=void 0,this.api.asc_setCellSuperscript(e.checked)}Common.NotificationCenter.trigger("edit:complete",this.toolbar),Common.component.Analytics.trackEvent("ToolBar","Text Formatting")},onHorizontalAlignMenu:function(t,e){this._state.pralign=void 0,this.api&&(this.api.asc_setCellAlign(e.checked?e.value:null),this.toolbar.btnWrap.allowDepress=!(e.value==AscCommon.align_Justify)),Common.NotificationCenter.trigger("edit:complete",this.toolbar),Common.component.Analytics.trackEvent("ToolBar","Horizontal align")},onVerticalAlignMenu:function(t,e){this._state.valign=void 0,this.api&&this.api.asc_setCellVertAlign(e.checked?e.value:Asc.c_oAscVAlign.Bottom),Common.NotificationCenter.trigger("edit:complete",this.toolbar),Common.component.Analytics.trackEvent("ToolBar","Vertical align")},generateSmartArt:function(t){this.api.asc_generateSmartArtPreviews(t)},onApiBeginSmartArtPreview:function(){this.smartArtGroups=this.toolbar.btnInsertSmartArt.menu.items,this.smartArtData=Common.define.smartArt.getSmartArtData()},onApiAddSmartArtPreview:function(t){t.forEach(_.bind(function(t){var e=t.asc_getImage(),t=t.asc_getSectionId(),i=_.findWhere(this.smartArtData,{sectionId:t}),i=_.findWhere(i.items,{type:e.asc_getName()}),t=_.findWhere(this.smartArtGroups,{value:t}),s=t.menuPicker;i&&(i=[{tip:i.tip,value:i.type,imageUrl:e.asc_getImage()}],s.store.length<1?s.store.reset(i):s.store.add(i)),this.currentSmartArtMenu=t},this))},onApiEndSmartArtPreview:function(){this.currentSmartArtMenu&&this.currentSmartArtMenu.menu.alignPosition()},onInsertSmartArt:function(t){this.api&&this.api.asc_createSmartArt(t)},eyedropperStart:function(){this.toolbar.btnCopyStyle.pressed&&(this.toolbar.btnCopyStyle.toggle(!1,!0),this.api.asc_formatPainter(AscCommon.c_oAscFormatPainterState.kOff),this.modeAlwaysSetStyle=!1)},onEyedropperStart:function(t){this.toolbar._isEyedropperStart=!0,this.api.asc_startEyedropper(_.bind(t.eyedropperEnd,t))},onEyedropperEnd:function(){this.toolbar._isEyedropperStart=!1},onChartRecommendedClick:function(){var t,i=this,e=i.api.asc_getRecommendedChartData();e?(t=i.api.asc_getCellInfo().asc_getSelectionType(),new SSE.Views.ChartWizardDialog({api:i.api,props:{recommended:e},isEdit:t==Asc.c_oAscSelectionType.RangeChart||t==Asc.c_oAscSelectionType.RangeChartText,handler:function(t,e){"ok"==t&&i.api&&i.api.asc_addChartSpace(e),Common.NotificationCenter.trigger("edit:complete",i.toolbar)}}).show()):Common.UI.warning({msg:i.warnNoRecommended,maxwidth:600,callback:function(t){Common.NotificationCenter.trigger("edit:complete",i.toolbar)}})},onFillNumMenu:function(t,e,i){var s;this.api&&(s=this,e.value===Asc.c_oAscFillType.series?new SSE.Views.FillSeriesDialog({handler:function(t,e){"ok"==t&&e&&s.api.asc_FillCells(Asc.c_oAscFillType.series,e),Common.NotificationCenter.trigger("edit:complete",s.toolbar)},props:s.api.asc_GetSeriesSettings()}).show():s.api.asc_FillCells(e.value))},onShowBeforeFillNumMenu:function(){if(this.api)for(var t=this.toolbar.btnFillNumbers.menu.items,e=this.api.asc_GetSeriesSettings().asc_getToolbarMenuAllowedProps(),i=0;i<t.length;i++)t[i].setDisabled(!e[t[i].value])}},SSE.Controllers.Toolbar||{}))}),define("text!spreadsheeteditor/main/app/template/StatusBar.template",[],function(){return'\n<div class="statusbar">\n    <div id="status-tabs-scroll" class="status-group float-left" dir="ltr">\n        <button id="status-btn-tabback" type="button" class="btn small btn-toolbar" data-hint="0" data-hint-direction="top" data-hint-offset="small" data-hint-title="G"><i class="icon toolbar__icon btn-previtem">&nbsp;</i></button>\n        <button id="status-btn-tabnext" type="button" class="btn small btn-toolbar" data-hint="0" data-hint-direction="top" data-hint-offset="small" data-hint-title="J"><i class="icon toolbar__icon btn-nextitem">&nbsp;</i></button>\n    </div>\n    <div id="status-addtabs-box" class="status-group float-left">\n        <button id="status-btn-addtab" type="button" class="btn small btn-toolbar" data-hint="0" data-hint-direction="top" data-hint-offset="small" data-hint-title="X"><i class="icon toolbar__icon btn-zoomup">&nbsp;</i></button>\n        <div class="cnt-tabslist">\n            <button id="status-btn-tabslist" type="button" class="btn small btn-toolbar dropdown-toggle" data-toggle="dropdown" data-hint="0" data-hint-direction="top" data-hint-offset="small" data-hint-title="N"><i class="icon toolbar__icon btn-sheet-list">&nbsp;</i></button>\n        </div>\n    </div>\n    <div id="status-zoom-box" class="status-group">\n        <div class="separator short"></div>\n        <button id="status-btn-zoomdown" type="button" class="btn small btn-toolbar"><i class="icon toolbar__icon btn-zoomdown">&nbsp;</i></button>\n        <div class="cnt-zoom">\n            <div class="dropdown-toggle" data-toggle="dropdown" data-hint="0" data-hint-direction="top">\n                <label id="status-label-zoom" class="status-label">Zoom 100%</label>\n            </div>\n        </div>\n        <button id="status-btn-zoomup" type="button" class="btn small btn-toolbar"><i class="icon toolbar__icon btn-zoomup">&nbsp;</i></button>\n    </div>\n    <div id="status-math-box" class="status-group padding-right-4">\n        <div class="separator short"></div>\n        <label id="status-math-average">AVERAGE: 10</label>\n        <label id="status-math-count">COUNT: 3</label>\n        <label id="status-math-min">MIN: 1</label>\n        <label id="status-math-max">MAX: 5</label>\n        <label id="status-math-sum">SUM: 5</label>\n    </div>\n    <div id="status-filtered-box" class="status-group">\n        <div class="separator short"></div>\n        <label id="status-filtered-records"></label>\n    </div>\n    <div id="status-sheets-bar-box">\n        <div id="status-sheets-bar" class="status-group">\n        </div>\n    </div>\n    <div id="status-number-of-sheet">\n        <label id="label-sheets" class="status-label"></label>\n    </div>\n    <div id="status-action">\n        <div class="separator short"></div>\n        <label id="label-action" class="status-label"></label>\n    </div>\n</div>\n'}),void 0===Common&&(Common={}),define("common/main/lib/component/Tab",["common/main/lib/component/BaseView"],function(t){"use strict";function e(t){return this.active=!1,this.label="Tab",this.cls="",this.iconCls="",this.iconVisible=!1,this.iconTitle="",this.index=-1,this.template=_.template(['<li class="list-item <% if(active){ %>active selected<% } %> <% if(cls.length){%><%= cls %><%}%><% if(iconVisible){%> icon-visible <%}%>" data-label="<%- label %>">','<span tabtitle="<%- label %>" draggable="true" oo_editor_input="true" tabindex="-1" data-index="<%= index %>">','<div class="toolbar__icon <% if(iconCls.length){%><%= iconCls %><%}%>" title="<% if(iconTitle.length){%><%=iconTitle%><%}%>"></div>',"<%- label %>","</span>","</li>"].join("")),this.initialize.call(this,t),this}_.extend(e.prototype,{initialize:function(t){_.extend(this,t)},render:function(){var t=this.template(this);return this.$el=$(t),this.rendered=!0,this.disable(this.disabled),this},isActive:function(){return this.$el.hasClass("active")},activate:function(){this.$el.hasClass("active")||this.$el.addClass("active")},isSelected:function(){return this.$el.hasClass("selected")},deactivate:function(){this.$el.removeClass("active")},on:function(){this.$el.on.apply(this,arguments)},disable:function(t){this.disabled=t,this.rendered&&(t&&!this.$el.hasClass("disabled")?this.$el.addClass("disabled"):this.$el.removeClass("disabled"))},addClass:function(t){t.length&&!this.$el.hasClass(t)&&this.$el.addClass(t)},removeClass:function(t){t.length&&this.$el.hasClass(t)&&this.$el.removeClass(t)},toggleClass:function(t){t.length&&this.$el.toggleClass(t)},hasClass:function(t){return this.$el.hasClass(t)},setCaption:function(t){this.$el.find("> span").text(t)},changeIconState:function(t,e){this.iconCls.length&&(this.iconVisible=t,this.iconTitle=e||"",this[t?"addClass":"removeClass"]("icon-visible"),e&&this.$el.find("."+this.iconCls).attr("title",e))}}),Common.UI.Tab=e}),define("common/main/lib/component/TabBar",["common/main/lib/component/BaseView","common/main/lib/component/Tab"],function(){"use strict";function i(t){this.initialize.call(this,t)}_.extend(i.prototype,{bind:function(){this.o||(this.o=$({})),this.o.on.apply(this.o,arguments)},unbind:function(){this.o&&this.o.off.apply(this.o,arguments)},trigger:function(){this.o||(this.o=$({})),this.o.trigger.apply(this.o,arguments)}}),i.prototype.initialize=function(t){this.bar=t.bar},i.prototype.attach=function(o){o.changeState=$.proxy(function(t){t?(o.toggleClass("selected"),(t=_.find(this.bar.selectTabs,function(t){return t.sheetindex===o.sheetindex}))?this.bar.selectTabs=_.without(this.bar.selectTabs,t):this.bar.selectTabs.push(o)):(o.isSelected()||(this.bar.$el.find("ul > li.selected").removeClass("selected"),o.addClass("selected"),this.bar.selectTabs.length=0,this.bar.selectTabs.push(o)),this.trigger("tab:change",o),this.bar.$el.find("ul > li.active").removeClass("active"),o.activate(),this.bar.trigger("tab:changed",this.bar,this.bar.tabs.indexOf(o),o))},this);o.$el.on({click:$.proxy(function(t){if(!o.disabled)if(t.ctrlKey||t.metaKey)o.isActive()||o.changeState(!0);else if(t.shiftKey){this.bar.$el.find("ul > li.selected").removeClass("selected"),this.bar.selectTabs.length=0;for(var t=this.bar.$el.find("ul > li.active").index(),e=this.bar.tabs.indexOf(o),i=t<e?e:t,s=t<e?t:e;s<=i;s++)this.bar.tabs[s].changeState(!0)}else o.$el.hasClass("active")||(this.bar.tabs.length===this.bar.selectTabs.length&&(this.bar.$el.find("ul > li.selected").removeClass("selected"),this.bar.selectTabs.length=0),"manual"==o.control?this.bar.trigger("tab:manual",this.bar,this.bar.tabs.indexOf(o),o):(o.changeState(),this.bar.isEditFormula&&setTimeout(function(){$("#ce-cell-content").focus();var t=$("#ce-cell-content")[0];t.selectionStart=t.selectionEnd=t.value.length},500)));o.disabled||Common.NotificationCenter.trigger("edit:complete","tab")},this),dblclick:$.proxy(function(){this.trigger("tab:dblclick",this,this.tabs.indexOf(o),o)},this.bar),contextmenu:$.proxy(function(){this.trigger("tab:contextmenu",this,this.tabs.indexOf(o),o,this.selectTabs)},this.bar),mousedown:$.proxy(function(t){var e;3===t.which||t.shiftKey?this.bar.$el.find("ul > li > span").attr("draggable","false"):(e=o.isLockTheDrag,this.bar.selectTabs.forEach(function(t){t.isLockTheDrag&&(e=!0)}),(this.bar.selectTabs.length!==this.bar.tabs.length&&1!==this.bar.tabs.length||t.ctrlKey||Common.Utils.isMac&&t.altKey)&&!this.bar.isEditFormula||(e=!0),this.bar.selectTabs.length===this.bar.tabs.length&&1<this.bar.tabs.length&&!(t.ctrlKey||Common.Utils.isMac&&t.altKey)&&(e=!1,this.bar.$el.find("ul > li.selected").removeClass("selected")),this.bar.$el.find("ul > li > span").attr("draggable",!e),e||t.ctrlKey||t.metaKey||o.changeState()),$("#ce-cell-content").is(":focus")&&(this.bar.isEditFormula?setTimeout(function(){$("#ce-cell-content").focus()},500):$("#ce-cell-content").blur())},this)}),o.$el.children().on({dragstart:$.proxy(function(t){var e,t=t.originalEvent;Common.Utils.isIE||Common.Utils.isSafari?Common.Utils.isIE&&this.bar.selectTabs.forEach(function(t){t.$el.find("span").prop("tabtitle","")}):(e=document.createElement("div"),t.dataTransfer.setDragImage(e,0,0)),t.dataTransfer.effectAllowed="copyMove",this.bar.trigger("tab:dragstart",t.dataTransfer,this.bar.selectTabs)},this),dragenter:$.proxy(function(t){var e=t.originalEvent;this.bar.isEditFormula?e.dataTransfer.dropEffect="none":(this.bar.$el.find(".mousemove").removeClass("mousemove right"),$(t.currentTarget).parent().addClass("mousemove"),e.dataTransfer.dropEffect=e.ctrlKey||Common.Utils.isMac&&e.altKey?"copy":"move")},this),dragover:$.proxy(function(t){var e=t.originalEvent;return e.preventDefault&&e.preventDefault(),this.bar.isEditFormula?e.dataTransfer.dropEffect="none":(this.bar.$el.find(".mousemove").removeClass("mousemove right"),$(t.currentTarget).parent().addClass("mousemove"),e.dataTransfer.dropEffect=e.ctrlKey||Common.Utils.isMac&&e.altKey?"copy":"move"),!1},this),dragleave:$.proxy(function(t){$(t.currentTarget).parent().removeClass("mousemove right")},this),dragend:$.proxy(function(t){Common.Utils.isMac&&t.altKey&&(this.bar.isDragDrop=!0);t=t.originalEvent;"move"!==t.dataTransfer.dropEffect||t.dataTransfer.mozUserCancelled?this.bar.trigger("tab:dragend",!1):this.bar.trigger("tab:dragend",!0),this.bar.$el.find(".mousemove").removeClass("mousemove right")},this),drop:$.proxy(function(t){Common.Utils.isMac&&t.altKey&&(this.bar.isDragDrop=!0);var t=t.originalEvent,e=$(t.currentTarget).data("index");this.bar.$el.find(".mousemove").removeClass("mousemove right"),this.bar.trigger("tab:drop",t.dataTransfer,e,t.ctrlKey||Common.Utils.isMac&&t.altKey),this.bar.isDrop=!0},this)})},Common.UI.TabBar=Common.UI.BaseView.extend({config:{placement:"top",items:[],draggable:!(i.prototype.detach=function(t){t.$el.off()})},tabs:[],template:_.template('<ul id="statusbar_bottom" class="nav nav-tabs <%= placement %>"></ul>'),selectTabs:[],initialize:function(t){_.extend(this.config,t),Common.UI.BaseView.prototype.initialize.call(this,t),this.saved=[]},render:function(){this.$el.html(this.template(this.config)),this.$bar=this.$el.find("ul");function t(t,e,i){t.addEventListener?t.addEventListener(e,i,!1):t.attachEvent("on"+e,i)}var e=/Firefox/i.test(navigator.userAgent)?"DOMMouseScroll":"mousewheel";return t(this.$bar[0],e,_.bind(this._onMouseWheel,this)),t(this.$bar[0],"dragstart",_.bind(function(t){t.dataTransfer.effectAllowed="copyMove"},this)),t(this.$bar[0],"dragenter",_.bind(function(t){this.isEditFormula?t.dataTransfer.dropEffect="none":t.dataTransfer.dropEffect=t.ctrlKey||Common.Utils.isMac&&t.altKey?"copy":"move"},this)),t(this.$bar[0],"dragover",_.bind(function(t){return t.preventDefault&&t.preventDefault(),t.dataTransfer.dropEffect=this.isEditFormula?"none":t.ctrlKey||Common.Utils.isMac&&t.altKey?"copy":"move",this.isEditFormula||this.tabs[this.tabs.length-1].$el.addClass("mousemove right"),!1},this)),t(this.$bar[0],"dragleave",_.bind(function(t){t.dataTransfer.dropEffect="none",this.tabs[this.tabs.length-1].$el.removeClass("mousemove right")},this)),t(this.$bar[0],"drop",_.bind(function(t){this.$el.find(".mousemove").removeClass("mousemove right"),void 0===this.isDrop?(Common.Utils.isMac&&t.altKey&&(this.isDragDrop=!0),this.trigger("tab:drop",t.dataTransfer,"last",t.ctrlKey||Common.Utils.isMac&&t.altKey)):this.isDrop=void 0},this)),this.manager=new i({bar:this}),this.insert(-1,this.config.items),this.insert(-1,this.saved),delete this.saved,Common.Gateway.on("processmouse",_.bind(this.onProcessMouse,this)),this.rendered=!0,this},_onMouseWheel:function(t){var e=this.checkInvisible(!0);(t.detail&&-t.detail||t.wheelDelta)<0?e.last&&this.setTabVisible("forward"):e.first&&this.setTabVisible("backward"),Common.NotificationCenter.trigger("hints:clear")},onProcessMouse:function(t){"mouseup"==t.type&&this.dragging&&(t=this.getActive(!0))&&t.mouseup()},add:function(t){return 0<this.insert(-1,t)},insert:function(t,e){var i=0;if(e&&(e=e instanceof Array?e:[e]).length){if(i=e.length,this.rendered){var s,o=this;if(t<0||t>o.tabs.length)for(var n=0;n<e.length;n++)s=new Common.UI.Tab(e[n]),o.$bar.append(s.render().$el),o.tabs.push(s),o.manager.attach(s),s.isActive()&&(o.selectTabs.length=0,o.selectTabs.push(s));else for(n=e.length;0<n--;)s=new Common.UI.Tab(e[n]),0===t?(o.$bar.prepend(s.render().$el),o.tabs.unshift(s)):(o.$bar.find("li:nth-child("+t+")").before(s.render().$el),o.tabs.splice(t,0,s)),s.isActive()&&(o.selectTabs.length=0,o.selectTabs.push(s)),o.manager.attach(s)}else this.saved.push(e);this.checkInvisible()}return i},remove:function(t){0<=t&&t<this.tabs.length&&(t=this.tabs.splice(t,1)[0],this.manager.detach(t),t.$el.remove(),this.checkInvisible())},empty:function(t){var e=this;this.tabs.forEach(function(t){e.manager.detach(t)}),this.$bar.empty(),e.tabs=[],this.checkInvisible(t)},setActive:function(t){var e;t instanceof Common.UI.Tab?e=t:"number"==typeof t&&0<=t&&t<this.tabs.length&&(e=this.tabs[t]),!e||"manual"==e.control||e.disabled||e.$el.hasClass("active")||e.changeState(),this.checkInvisible()},setSelectAll:function(t){var e=this;e.selectTabs.length=0,t?e.tabs.forEach(function(t){t.isSelected()||t.addClass("selected"),e.selectTabs.push(t)}):e.tabs.forEach(function(t){t.isActive()?e.selectTabs.push(t):t.isSelected()&&t.removeClass("selected")})},getActive:function(t){return t?this.$bar.find("> li.active"):this.$bar.find("> li.active").index()},getAt:function(t){return 0<=t&&t<this.tabs.length?this.tabs[t]:void 0},getCount:function(){return this.tabs.length},addClass:function(t){t.length&&!this.$bar.hasClass(t)&&this.$bar.addClass(t)},removeClass:function(t){t.length&&this.$bar.hasClass(t)&&this.$bar.removeClass(t)},hasClass:function(t){return this.$bar.hasClass(t)},setTabVisible:function(t,e){if(t<=0)this.$bar.scrollLeft(0),this.checkInvisible(e);else if(t>=this.tabs.length-1){var i=this.tabs[this.tabs.length-1].$el;0===this.$bar.find(".separator-item").length&&this.$bar.append('<li class="separator-item"><span></span></li>'),this.$bar.scrollLeft(this.$bar.scrollLeft()+(i.position().left+parseInt(i.css("width"))-this.$bar.width())+(400<this.$bar.width()?20:5)),this.checkInvisible(e)}else{this.isTabVisible(this.tabs.length-1)||0!==this.$bar.find(".separator-item").length||this.$bar.append('<li class="separator-item"><span></span></li>');var s,o,n=this.$bar.width();if("forward"==t){for(var a=0;a<this.tabs.length;a++)if(n<(s=(i=this.tabs[a].$el).position().left+parseInt(i.css("width")))){this.$bar.scrollLeft(this.$bar.scrollLeft()+(s-n)+(400<this.$bar.width()?20:5)),this.checkInvisible(e);break}}else if("backward"==t){for(a=this.tabs.length;0<a--;)if((o=(i=this.tabs[a].$el).position().left)<0){this.$bar.scrollLeft(this.$bar.scrollLeft()+o-26),this.checkInvisible(e);break}}else"number"==typeof t&&(s=(o=(i=this.tabs[t].$el).position().left)+parseInt(i.css("width")),o<0?(this.$bar.scrollLeft(this.$bar.scrollLeft()+o-26),this.checkInvisible(e)):n<s&&(this.$bar.scrollLeft(this.$bar.scrollLeft()+(s-n)+20),this.checkInvisible(e)))}},checkInvisible:function(t){var e={first:!this.isTabVisible(Common.UI.isRTL()?this.tabs.length-1:0),last:!this.isTabVisible(Common.UI.isRTL()?0:this.tabs.length-1)};return t||this.fireEvent("tab:invisible",this,e),e},hasInvisible:function(){for(var t=this.$bar.offset().left,e=t+this.$bar.width(),i=this.tabs.length;0<i--;)if(!this.isTabVisible(i,t,e))return!0;return!1},isTabVisible:function(t){var e,i=arguments[1]||this.$bar.offset().left,s=arguments[2]||i+this.$bar.width();return t<this.tabs.length&&0<=t&&(e=(t=this.tabs[t].$el.get(0).getBoundingClientRect()).left,t=t.right,!(e<i||.5<t-s))},addDataHint:function(t,e){var i=this.$bar.find("[data-hint]"),i=(0<i.length&&(i.removeAttr("data-hint"),i.removeAttr("data-hint-direction"),i.removeAttr("data-hint-offset"),i.removeAttr("data-hint-title")),this.tabs[t].$el);i.attr("data-hint",e||"0"),i.attr("data-hint-direction","top"),i.attr("data-hint-offset","medium"),i.attr("data-hint-title","M")},getWidth:function(){var e=21;return this.tabs.forEach(function(t){e+=t.$el.width()}),e}})}),define("spreadsheeteditor/main/app/view/Statusbar",["text!spreadsheeteditor/main/app/template/StatusBar.template","tip","common/main/lib/component/TabBar","common/main/lib/component/Menu","common/main/lib/component/Window","common/main/lib/component/ThemeColorPalette"],function(t){"use strict";var e,i;SSE.Views.Statusbar&&(e=SSE.Views.Statusbar.RenameDialog,i=SSE.Views.Statusbar.CopyDialog),SSE.Views.Statusbar=Common.UI.BaseView.extend(_.extend({el:"#statusbar",template:_.template(t),events:function(){return{"click #status-btn-tabback":_.bind(this.onBtnTabScroll,this,"backward"),"click #status-btn-tabnext":_.bind(this.onBtnTabScroll,this,"forward")}},api:void 0,initialize:function(t){_.extend(this,t)},render:function(){var s=this,t=($(this.el).html(this.template({scope:this})),this.cntStatusbar=$(".statusbar",this.el),this.isCompact=Common.localStorage.getBool("sse-compact-statusbar",!0),this.isCompact||this.cntStatusbar.addClass("no-compact"),this.editMode=!1,this.rangeSelectionMode=Asc.c_oAscSelectionDialogType.None,this.btnZoomDown=new Common.UI.Button({el:$("#status-btn-zoomdown",this.el),hint:this.tipZoomOut+" (Ctrl+-)",hintAnchor:"top"}),this.btnZoomUp=new Common.UI.Button({el:$("#status-btn-zoomup",this.el),hint:this.tipZoomIn+" (Ctrl++)",hintAnchor:"top-right"}),this.btnScrollBack=new Common.UI.Button({el:$("#status-btn-tabback",this.el),hint:this.tipPrev,disabled:!0,hintAnchor:"top"}),this.btnScrollNext=new Common.UI.Button({el:$("#status-btn-tabnext",this.el),hint:this.tipNext,disabled:!0,hintAnchor:"top"}),this.btnAddWorksheet=new Common.UI.Button({el:$("#status-btn-addtab",this.el),hint:this.tipAddTab,disabled:!0,hintAnchor:"top"}),this.cntSheetList=new Common.UI.Button({el:$(".cnt-tabslist",this.el),hint:this.tipListOfSheets,hintAnchor:"top"}),this.btnSheetList=$("#status-btn-tabslist",this.$el),this.sheetListMenu=new Common.UI.Menu({style:"margin-top:-3px;",menuAlign:"bl-tl",maxHeight:300}),this.sheetListMenu.on("item:click",function(t,e){s.fireEvent("show:tab",[e.value])}),this.cntSheetList.cmpEl.on({"show.bs.dropdown":function(){_.defer(function(){s.cntSheetList.cmpEl.find("ul").focus()},100)},"hide.bs.dropdown":function(){_.defer(function(){s.api.asc_enableKeyEvents(!0)},100)}}),this.sheetListMenu.render($(".cnt-tabslist",this.el)),this.sheetListMenu.cmpEl.attr({tabindex:-1}),this.cntZoom=new Common.UI.Button({el:$(".cnt-zoom",this.el),hint:this.tipZoomFactor,hintAnchor:"top"}),this.cntZoom.cmpEl.on({"show.bs.dropdown":function(){_.defer(function(){s.cntZoom.cmpEl.find("ul").focus()},100)},"hide.bs.dropdown":function(){_.defer(function(){s.api.asc_enableKeyEvents(!0)},100)}}),this.zoomMenu=new Common.UI.Menu({style:"margin-top:-5px;",menuAlign:"bl-tl",items:[{caption:"50%",value:50},{caption:"75%",value:75},{caption:"100%",value:100},{caption:"125%",value:125},{caption:"150%",value:150},{caption:"175%",value:175},{caption:"200%",value:200},{caption:"300%",value:300},{caption:"400%",value:400},{caption:"500%",value:500}]}),this.zoomMenu.render($(".cnt-zoom",this.el)),this.zoomMenu.cmpEl.attr({tabindex:-1}),this.labelZoom=$("#status-label-zoom",this.$el),this.tabBarBox=$("#status-sheets-bar-box",this.el),this.tabbar=new Common.UI.TabBar({el:"#status-sheets-bar",placement:"bottom",draggable:!1}).render(),this.tabbar.on({"tab:invisible":_.bind(this.onTabInvisible,this),"tab:changed":_.bind(this.onSheetChanged,this),"tab:contextmenu":_.bind(this.onTabMenu,this),"tab:dblclick":_.bind(function(){!s.editMode||s.mode&&s.mode.isDisconnected||s.rangeSelectionMode===Asc.c_oAscSelectionDialogType.Chart||s.rangeSelectionMode===Asc.c_oAscSelectionDialogType.FormatTable||s.rangeSelectionMode===Asc.c_oAscSelectionDialogType.PrintTitles||s.fireEvent("sheet:changename")},this),"tab:dragstart":_.bind(function(t,e){Common.Utils.isIE&&(this.isDrop=!1),Common.UI.Menu.Manager.hideAll(),this.api.asc_closeCellEditor();for(var i=[],s=[],o=this.api.asc_getWorksheetsCount(),n=[],a=-1;++a<o;)this.api.asc_isWorksheetHidden(a)||n.push({value:this.api.asc_getWorksheetName(a),inindex:a});var l=[];e.forEach(function(t){l.push(t.sheetindex)}),n.forEach(function(t){-1!==l.indexOf(t.inindex)&&(i.push(t.inindex),s.push(t.value))});var r=[],c=this.api.asc_StartMoveSheet(_.clone(i)),c=(r.push({type:"onlyoffice",value:c}),r.push({type:"indexes",value:i}),r.push({type:"names",value:s}),r.push({type:"key",value:Common.Utils.InternalSettings.get("sse-doc-info-key")}),JSON.stringify(r));Common.Utils.isIE?(t.setData("text","sheet"),this.dataTransfer=c):t.setData("onlyoffice",c),this.dropTabs=e},this),"tab:drop":_.bind(function(t,e,i){if(!(this.isEditFormula||Common.Utils.isIE&&void 0===this.dataTransfer)){Common.Utils.isIE&&(this.isDrop=!0);t=Common.Utils.isIE?this.dataTransfer:t.getData("onlyoffice");if(t){t=JSON.parse(t);if(t){var s=_.findWhere(t,{type:"key"}).value;if(Common.Utils.InternalSettings.get("sse-doc-info-key")===s)this.fireEvent("sheet:move",[_.findWhere(t,{type:"indexes"}).value,!i,!0,_.isNumber(e)?e:this.api.asc_getWorksheetsCount()]),Common.NotificationCenter.trigger("tabs:dragend",this);else{for(var n=[],o=this.api.asc_getWorksheetsCount();o--;)n.push(this.api.asc_getWorksheetName(o).toLowerCase());var a=[],e=(_.findWhere(t,{type:"names"}).value.forEach(function(t){var e=1,i=/^(.*)\((\d)\)$/.exec(t),s=i?i[1]:t+" ",o=[];for(0<a.length&&a.forEach(function(t){o.push(t.toLowerCase())});-1!==n.indexOf(t.toLowerCase())||-1!==o.indexOf(t.toLowerCase());)t=s+"("+ ++e+")";a.push(t)}),_.isNumber(e)?e:this.api.asc_getWorksheetsCount());this.api.asc_EndMoveSheet(e,a,_.findWhere(t,{type:"onlyoffice"}).value)}}}}},this),"tab:dragend":_.bind(function(t){var e;!t||Common.Utils.isIE&&!1===this.isDrop||0<this.dropTabs.length&&(e=[],this.dropTabs.forEach(function(t){e.push(t.sheetindex)}),s.api.asc_deleteWorksheet(e)),this.dropTabs=void 0,Common.Utils.isIE&&(this.isDrop=void 0,this.dataTransfer=void 0),Common.NotificationCenter.trigger("tabs:dragend",this)},this)}),new Common.UI.Menu({maxHeight:267,menuAlign:"tl-tr"}).on("show:after",function(){this.scroller.update({alwaysVisibleY:!0})})),e=(t.on("item:click",function(t,e,i){s.fireEvent("show:hidden",[s,e.value])}),new Common.UI.Menu({menuAlign:"tl-tr",cls:"color-tab",items:[{template:_.template('<div id="id-tab-menu-color" style="width: 164px;display: inline-block;"></div>')},{caption:"--"},{id:"id-tab-menu-new-color",template:_.template('<a tabindex="-1" type="menuitem" style="'+(Common.UI.isRTL()?"padding-right: 12px;":"padding-left: 12px;")+'">'+s.textNewColor+"</a>")}]}));s.mnuTabColor={isDummy:!0,on:function(){}},this.tabMenu=new Common.UI.Menu({menuAlign:"bl-tl",items:[{caption:this.itemInsert,value:"ins"},{caption:this.itemDelete,value:"del"},{caption:this.itemRename,value:"ren"},{caption:this.itemCopy,value:"copy"},{caption:this.itemMove,value:"move"},{caption:this.itemHide,value:"hide"},{caption:this.itemHidden,menu:t},{caption:this.itemProtect,value:"protect"},{caption:this.itemTabColor,menu:e},{caption:"--"},{caption:this.selectAllSheets,value:"selectall"},{caption:this.ungroupSheets,value:"noselect"}]}).on("render:after",function(t){s.mnuTabColor=new Common.UI.ThemeColorPalette({el:$("#id-tab-menu-color"),outerMenu:{menu:e,index:0,focusOnShow:!0},transparent:!0}),e.setInnerMenu([{menu:s.mnuTabColor,index:0}]),s.mnuTabColor.on("select",function(t,e){s.fireEvent("sheet:setcolor",[e]),setTimeout(function(){s.tabMenu.hide()},1)})});t=_.template('<a id="<%= id %>" tabindex="-1" type="menuitem"><div style="position: relative;"><div class="item-caption"><%= caption %></div><label class="item-value"><%= options.exampleval ? options.exampleval : "" %></label></div></a>');return this.customizeStatusBarMenu=new Common.UI.Menu({menuAlign:"bl-tl",menuAlignEl:$(this.el),items:[{id:"saved-status",caption:this.itemStatus,value:"status",checkable:!0,checked:!0,template:t,exampleval:""},{caption:"--"},{id:"math-item-average",caption:this.itemAverage,value:"average",checkable:!0,checked:!0,template:t,exampleval:""},{id:"math-item-count",caption:this.itemCount,value:"count",checkable:!0,checked:!0,template:t,exampleval:""},{id:"math-item-min",caption:this.itemMinimum,value:"min",checkable:!0,checked:!0,template:t,exampleval:""},{id:"math-item-max",caption:this.itemMaximum,value:"max",checkable:!0,checked:!0,template:t,exampleval:""},{id:"math-item-sum",caption:this.itemSum,value:"sum",checkable:!0,checked:!0,template:t,exampleval:""}]}),this.tabbar.$el.append('<div class="dropdown-toggle" data-toggle="dropdown" style="width:0; height:0;"></div>'),this.tabMenu.render(this.tabbar.$el),this.tabMenu.cmpEl.attr({tabindex:-1}),this.tabMenu.on("show:after",_.bind(this.onTabMenuAfterShow,this)),this.tabMenu.on("hide:after",_.bind(this.onTabMenuAfterHide,this)),this.tabMenu.on("item:click",_.bind(this.onTabMenuClick,this)),this.boxMath=$("#status-math-box",this.el),this.labelSum=$("#status-math-sum",this.boxMath),this.labelCount=$("#status-math-count",this.boxMath),this.labelAverage=$("#status-math-average",this.boxMath),this.labelMin=$("#status-math-min",this.boxMath),this.labelMax=$("#status-math-max",this.boxMath),this.boxMath.hide(),this.boxFiltered=$("#status-filtered-box",this.el),this.labelFiltered=$("#status-filtered-records",this.boxFiltered),this.boxFiltered.hide(),this.boxZoom=$("#status-zoom-box",this.el),this.boxZoom.find(".separator").css("border-left-color","transparent"),this.boxNumberSheets=$("#status-number-of-sheet",this.el),this.isCompact&&this.boxNumberSheets.hide(),this.labelNumberSheets=$("#label-sheets",this.boxNumberSheets),this.boxAction=$("#status-action",this.el),this.boxAction.hide(),this.labelAction=$("#label-action",this.boxAction),this.$el.append('<div id="statusbar-menu" style="width:0; height:0;"></div>'),this.$customizeStatusBarMenu=this.$el.find("#statusbar-menu"),this.$customizeStatusBarMenu.on({"show.bs.dropdown":function(){_.defer(function(){s.$customizeStatusBarMenu.find("ul").focus()},100)},"hide.bs.dropdown":function(){_.defer(function(){s.api.asc_enableKeyEvents(!0)},100)}}),this.$customizeStatusBarMenu.append('<div class="dropdown-toggle" data-toggle="dropdown" style="width:0; height:0;"></div>'),this.customizeStatusBarMenu.render(this.$customizeStatusBarMenu),this.customizeStatusBarMenu.cmpEl.attr({tabindex:-1}),this.customizeStatusBarMenu.on("show:after",_.bind(this.onCustomizeStatusBarAfterShow,this)),this.customizeStatusBarMenu.on("hide:after",_.bind(this.onCustomizeStatusBarAfterHide,this)),this.customizeStatusBarMenu.on("item:click",_.bind(this.onCustomizeStatusBarClick,this)),this.$el.on("contextmenu",_.bind(this.showCustomizeStatusBar,this)),this},setApi:function(t){return this.api=t,this.api.asc_registerCallback("asc_onSheetsChanged",_.bind(this.update,this)),this},setMode:function(t){this.mode=_.extend({},this.mode,t),$("#status-addtabs-box")[this.mode.isEdit?"show":"hide"](),this.btnAddWorksheet.setDisabled(this.mode.isDisconnected||this.api&&(this.api.asc_isWorkbookLocked()||this.api.isCellEdited)||this.rangeSelectionMode!=Asc.c_oAscSelectionDialogType.None),this.mode.isEditOle&&(this.btnAddWorksheet.$el.find("button").addBack().filter("button").attr("data-hint","1"),this.btnScrollBack.$el.find("button").addBack().filter("button").attr("data-hint","1"),this.btnScrollNext.$el.find("button").addBack().filter("button").attr("data-hint","1"),this.cntSheetList.$el.find("button").attr("data-hint","1"),this.cntSheetList.$el.find("button").removeAttr("data-hint-title"),this.cntZoom.$el.find(".dropdown-toggle").attr("data-hint","1")),this.updateTabbarBorders()},setVisible:function(t){t?this.show():this.hide()},isVisible:function(){return this.$el&&this.$el.is(":visible")},update:function(){var i=this;if(this.tabbar.empty(!0),this.tabMenu.items[6].menu.removeAll(),this.tabMenu.items[6].hide(),this.btnAddWorksheet.setDisabled(!0),this.sheetListMenu.removeAll(),this.api){for(var t,e,s=this.api.asc_getWorksheetsCount(),o=-1,n=[],a=[],l=[],r=this.api.asc_getActiveWorksheetIndex(),c=this.api.asc_isProtectedWorkbook();++o<s;)t=i.api.asc_isWorksheetLockedOrDeleted(o),e=i.api.asc_getActiveNamedSheetView&&i.api.asc_getActiveNamedSheetView(o)||"",t={sheetindex:o,index:a.length,active:r==o,label:i.api.asc_getWorksheetName(o),cls:t?"coauth-locked":"",isLockTheDrag:t||i.mode.isDisconnected||c,iconCls:"btn-sheet-view",iconTitle:e,iconVisible:""!==e},(this.api.asc_isWorksheetHidden(o)?n:a).push(t),l.push(t);n.length&&(n.forEach(function(t){i.tabMenu.items[6].menu.addItem(new Common.UI.MenuItem({style:"white-space: pre-wrap",caption:Common.Utils.String.htmlEncode(t.label),value:t.sheetindex}))}),this.tabMenu.items[6].show()),this.tabbar.add(a),l.forEach(function(t){var e=i.api.asc_isWorksheetHidden(t.sheetindex);i.sheetListMenu.addItem(new Common.UI.MenuItem({style:"white-space: pre",caption:Common.Utils.String.htmlEncode(t.label),value:t.sheetindex,checkable:!0,checked:t.active,hidden:e,visible:!e||!c,textHidden:i.itemHide,template:_.template(['<a id="<%= id %>" style="<%= style %>" tabindex="-1" type="menuitem" <% if (options.hidden) { %> data-hidden="true" <% } %>>','<div class="color"></div>','<span class="name"><%= caption %></span>','<span class="hidden-mark"><% if (options.hidden) { %><%=  options.textHidden %><% } else { %><% } %></span>',"</a>"].join(""))}))}),_.isUndefined(this.tabBarScroll)||(this.tabbar.$bar.scrollLeft(this.tabBarScroll.scrollLeft),this.tabBarScroll=void 0),this.tabbar.isTabVisible(r)||this.tabbar.setTabVisible(r),this.btnAddWorksheet.setDisabled(i.mode.isDisconnected||i.api.asc_isWorkbookLocked()||c||i.api.isCellEdited),this.mode.isEdit&&this.tabbar.addDataHint(_.findIndex(a,function(t){return t.sheetindex===r}),this.mode.isEditOle?"1":"0"),$("#status-label-zoom").text(Common.Utils.String.format(this.zoomText,Math.floor(100*(this.api.asc_getZoom()+.005)))),this.updateNumberOfSheet(r,s),this.updateTabbarBorders(),i.fireEvent("sheet:changed",[i,r]),i.fireEvent("sheet:updateColors",[!0]),Common.NotificationCenter.trigger("comments:updatefilter",["doc","sheet"+i.api.asc_getActiveWorksheetId()],!1)}},setMathInfo:function(e){1<e.count?(this.boxMath.is(":visible")||this.boxMath.show(),this.labelCount.text(this.textCount+": "+e.count),this.labelMin.text(e.min&&e.min.length?this.textMin+": "+e.min:""),this.labelMax.text(e.max&&e.max.length?this.textMax+": "+e.max:""),this.labelSum.text(e.sum&&e.sum.length?this.textSum+": "+e.sum:""),this.labelAverage.text(e.average&&e.average.length?this.textAverage+": "+e.average:""),this.labelMin[e.min&&0<e.min.length?"show":"hide"](),this.labelMax[e.max&&0<e.max.length?"show":"hide"](),this.labelSum[e.sum&&0<e.sum.length?"show":"hide"](),this.labelAverage[e.average&&0<e.average.length?"show":"hide"](),this.customizeStatusBarMenu.items.forEach(function(t){"math-item-average"===t.options.id?t.options.exampleval=e.average&&e.average.length?e.average:"":"math-item-min"===t.options.id?t.options.exampleval=e.min&&e.min.length?e.min:"":"math-item-max"===t.options.id?t.options.exampleval=e.max&&e.max.length?e.max:"":"math-item-count"===t.options.id?t.options.exampleval=e.count?String(e.count):"":"math-item-sum"===t.options.id&&(t.options.exampleval=e.sum&&e.sum.length?e.sum:""),$(t.el).find("label").text(t.options.exampleval)})):(this.customizeStatusBarMenu.items.forEach(function(t){t.options.exampleval="",$(t.el).find("label").text("")}),this.boxMath.is(":visible")&&this.boxMath.hide());var t=this;_.delay(function(){t.updateVisibleItemsBoxMath(),t.updateTabbarBorders(),t.onTabInvisible(void 0,t.tabbar.checkInvisible(!0))},30)},setFilteredInfo:function(t,e){0<t&&0<e?(this.boxFiltered.is(":visible")||this.boxFiltered.show(),this.labelFiltered.text(Common.Utils.String.format(this.filteredRecordsText,t,e))):t?(this.boxFiltered.is(":visible")||this.boxFiltered.show(),this.labelFiltered.text(this.filteredText)):null!=t?this.boxFiltered.is(":visible")&&this.boxFiltered.hide():(t=!(e=this.api.asc_getCellInfo().asc_getAutoFilterInfo())||!0!==e.asc_getIsApplyAutoFilter(),this.setFilteredInfo(!t));var i=this;_.delay(function(){i.onTabInvisible(void 0,i.tabbar.checkInvisible(!0))},30)},onSheetChanged:function(t,e,i){this.api.asc_showWorksheet(i.sheetindex),this.updateNumberOfSheet(i.sheetindex,this.api.asc_getWorksheetsCount()),this.hasTabInvisible&&!this.tabbar.isTabVisible(e)&&this.tabbar.setTabVisible(e),this.mode.isEdit&&this.tabbar.addDataHint(e,this.mode.isEditOle?"1":"0"),this.fireEvent("sheet:changed",[this,i.sheetindex]),this.fireEvent("sheet:updateColors",[!0])},onTabMenu:function(t,e,i,s){var o,n,a,l,r,c=this;!this.mode.isEdit||this.isEditFormula||this.rangeSelectionMode===Asc.c_oAscSelectionDialogType.Chart||this.rangeSelectionMode===Asc.c_oAscSelectionDialogType.FormatTable||this.rangeSelectionMode===Asc.c_oAscSelectionDialogType.PrintTitles||this.mode.isDisconnected||i&&0<=i.sheetindex&&(o=i.$el.get(0).getBoundingClientRect(),i.$el.offset(),n=i.$el.parent().offset(),i.isActive()||this.tabbar.setActive(i),_.isUndefined(s)?a=c.api.asc_isWorksheetLockedOrDeleted(i.sheetindex):(a=!1,s.forEach(function(t){c.api.asc_isWorksheetLockedOrDeleted(t.sheetindex)&&(a=!0)})),i=this.api.asc_isWorkbookLocked(),l=this.api.asc_isProtectedWorkbook(),this.tabMenu.items[0].setDisabled(i||l),this.tabMenu.items[1].setDisabled(a||l),this.tabMenu.items[2].setDisabled(a||l),this.tabMenu.items[3].setDisabled(a||l),this.tabMenu.items[4].setDisabled(a||l),this.tabMenu.items[5].setDisabled(a||l),this.tabMenu.items[6].setDisabled(i||l),this.tabMenu.items[7].setDisabled(1<s.length),this.tabMenu.items[8].setDisabled(a||l),this.tabMenu.items[7].setVisible(!this.mode.isEditOle&&this.mode.canProtect),this.tabMenu.items[7].setCaption(this.api.asc_isProtectedSheet()?this.itemUnProtect:this.itemProtect),1===s.length?this.tabMenu.items[11].hide():this.tabMenu.items[11].show(),this.tabMenu.items[10].setDisabled(a||l),this.tabMenu.items[11].setDisabled(a||l),this.api.asc_closeCellEditor(),this.api.asc_enableKeyEvents(!1),this.tabMenu.atposition={top:o.top,left:o.left-n.left-2,right:o.right-n.left+2},this.tabMenu.hide(),this.tabMenu.show(),r=this.tabMenu,_.defer(function(){r.cmpEl.focus()},10))},onTabMenuAfterShow:function(t){t.atposition&&t.setOffset(Common.UI.isRTL()?t.atposition.right-$(t.el).width():t.atposition.left),this.enableKeyEvents=!0},onTabMenuAfterHide:function(){_.isUndefined(this.enableKeyEvents)||(this.api&&this.api.asc_enableKeyEvents(this.enableKeyEvents),this.enableKeyEvents=void 0)},onTabMenuClick:function(t,e){e&&this.api&&(this.enableKeyEvents="ins"===e.value||"hide"===e.value,"selectall"===e.value?this.tabbar.setSelectAll(!0):"noselect"===e.value&&this.tabbar.setSelectAll(!1))},onTabInvisible:function(t,e){this.btnScrollBack.isDisabled()!==!e.first&&this.btnScrollBack.setDisabled(!e.first),this.btnScrollNext.isDisabled()!==!e.last&&this.btnScrollNext.setDisabled(!e.last),this.hasTabInvisible=e.first||e.last},onBtnTabScroll:function(t,e){this.tabbar.setTabVisible(t)},updateTabbarBorders:function(){var t,e,i=!1,s=parseInt(this.boxZoom.css("width"));this.boxMath.is(":visible")&&(Common.UI.isRTL()?this.boxMath.css({left:s+"px"}):this.boxMath.css({right:s+"px"}),s+=parseInt(this.boxMath.css("width")),i=!0),this.boxFiltered.is(":visible")&&(Common.UI.isRTL()?this.boxFiltered.css({left:s+"px"}):this.boxFiltered.css({right:s+"px"}),s+=parseInt(this.boxFiltered.css("width")),i=!0),this.isCompact?(this.boxAction.is(":visible")&&(e=this.tabbar.getWidth(),t=this.actionWidth||140,0<Common.Utils.innerWidth()-s-129-t-e?(e=e+129,Common.UI.isRTL()?(this.boxAction.css({left:s+"px",right:e+"px",width:"auto"}),this.boxAction.find(".separator").css("border-right-color","transparent")):(this.boxAction.css({right:s+"px",left:e+"px",width:"auto"}),this.boxAction.find(".separator").css("border-left-color","transparent"))):(Common.UI.isRTL()?(this.boxAction.css({left:s+"px",right:"auto",width:t+"px"}),this.boxAction.find(".separator").css("border-right-color","")):(this.boxAction.css({right:s+"px",left:"auto",width:t+"px"}),this.boxAction.find(".separator").css("border-left-color","")),i=!0),s+=parseInt(this.boxAction.css("width"))),this.boxMath.is(":visible")&&this.boxMath.css({top:"0px",bottom:"auto"}),this.boxFiltered.is(":visible")&&this.boxFiltered.css({top:"0px",bottom:"auto"}),this.boxZoom.css({top:"0px",bottom:"auto"}),Common.UI.isRTL()?this.tabBarBox.css("left",s+"px"):this.tabBarBox.css("right",s+"px")):(this.boxAction.is(":visible")&&(Common.UI.isRTL()?(this.boxAction.css({left:s+"px",right:"135px",width:"auto"}),this.boxAction.find(".separator").css("border-right-color","transparent")):(this.boxAction.css({right:s+"px",left:"135px",width:"auto"}),this.boxAction.find(".separator").css("border-left-color","transparent"))),this.boxMath.is(":visible")&&this.boxMath.css({top:"auto",bottom:"0px"}),this.boxFiltered.is(":visible")&&this.boxFiltered.css({top:"auto",bottom:"0px"}),this.boxZoom.css({top:"auto",bottom:"0px"}),Common.UI.isRTL()?(this.tabBarBox.css("left","0px"),this.boxZoom.find(".separator").css("border-right-color",i?"":"transparent")):(this.tabBarBox.css("right","0px"),this.boxZoom.find(".separator").css("border-left-color",i?"":"transparent"))),this.statusMessage&&(e=this.getStatusMessage(this.statusMessage))!==this.boxAction.text().trim()&&this.labelAction.text(e)},updateVisibleItemsBoxMath:function(){var t=parseInt(this.$el.css("width")),e=parseInt(this.boxZoom.css("width"))+parseInt($("#status-tabs-scroll").css("width"))+parseInt($("#status-addtabs-box").css("width"));for(this.boxFiltered.is(":visible")&&(e+=parseInt(this.boxFiltered.css("width"))),this.$el.find(".over-box").removeClass("over-box");e+parseInt(this.boxMath.css("width"))+100>t;){var i=this.boxMath.find("label:not(.hide, .over-box)");if(0<i.length&&$(i[i.length-1]).addClass("over-box"),i.length<=1)break}},changeViewMode:function(t){var t=t.isEdit,e=Common.UI.isRTL()?"right":"left";t?this.tabBarBox.css(e,"129px"):this.tabBarBox.css(e,""),this.tabbar.options.draggable=t,this.editMode=t},showCustomizeStatusBar:function(t){var e=$(t.target);0<$("#status-zoom-box").find(e).length||0<$(t.target).closest(".statusbar .list-item").length||0<$("#status-tabs-scroll").find(e).length||0<$("#status-addtabs-box").find(e).length||(this.customizeStatusBarMenu.hide(),this.customizeStatusBarMenu.atposition={left:t.clientX*Common.Utils.zoom(),top:t.clientY*Common.Utils.zoom()},this.customizeStatusBarMenu.show())},onCustomizeStatusBarAfterShow:function(t){var e;t.atposition&&(e=$(this.el).height(),e=!this.isCompact&&t.atposition.top-$(this.el).offset().top>e/2?e/2:0,t.setOffset(Common.UI.isRTL()?t.atposition.left-$(this.el).width()+2:t.atposition.left,e)),this.enableKeyEvents=!0},onCustomizeStatusBarAfterHide:function(){_.isUndefined(this.enableKeyEvents)||(this.api&&this.api.asc_enableKeyEvents(this.enableKeyEvents),this.enableKeyEvents=void 0)},onCustomizeStatusBarClick:function(t,e,i){var s=e.value,o=e.checked;"status"===s?this.boxAction[o?"removeClass":"addClass"]("hide"):(this.boxMath.find("#status-math-"+s)[o?"removeClass":"addClass"]("hide"),this.boxMath.find("label").length===this.boxMath.find("label.hide").length?this.boxMath.find(".separator").hide():this.boxMath.find(".separator").is(":hidden")&&this.boxMath.find(".separator").show()),this.updateVisibleItemsBoxMath(),this.updateTabbarBorders(),this.onTabInvisible(void 0,this.tabbar.checkInvisible(!0)),i.stopPropagation(),e.$el.find("a").blur()},onChangeCompact:function(t){(this.isCompact=t)?(this.cntStatusbar.removeClass("no-compact"),this.boxNumberSheets.hide()):(this.cntStatusbar.addClass("no-compact"),this.boxNumberSheets.show()),this.updateTabbarBorders(),0<this.tabbar.getCount()&&this.onTabInvisible(void 0,this.tabbar.checkInvisible(!0))},updateNumberOfSheet:function(t,e){this.labelNumberSheets.text(Common.Utils.String.format(this.sheetIndexText,t+1,e))},getStatusMessage:function(t){t=this.isCompact&&23<t.length&&this.boxAction.width()<180?t.substr(0,23).trim()+"...":t;return t},showStatusMessage:function(e,t){this.statusMessage=e,this.actionWidth||(this.actionWidth=22<e.length?166:140),this.labelAction.text(this.getStatusMessage(e)),this.customizeStatusBarMenu.items.forEach(function(t){"saved-status"===t.options.id&&(t.options.exampleval=e),$(t.el).find("label").text(t.options.exampleval)}),this.boxAction.is(":visible")||this.boxAction.show();var i=this;_.delay(function(){i.updateTabbarBorders(),i.onTabInvisible(void 0,i.tabbar.checkInvisible(!0)),t&&t()},30)},clearStatusMessage:function(){this.labelAction.text(""),this.statusMessage=void 0},getStatusLabel:function(){return this.labelAction},sheetIndexText:"Sheet {0} of {1}",tipZoomIn:"Zoom In",tipZoomOut:"Zoom Out",tipZoomFactor:"Magnification",tipPrev:"Previous Sheet",tipNext:"Next Sheet",tipAddTab:"Add Worksheet",tipListOfSheets:"List of Sheets",itemInsert:"Insert",itemDelete:"Delete",itemRename:"Rename",itemCopy:"Copy",itemMove:"Move",itemHide:"Hide",itemHidden:"Hidden",itemTabColor:"Tab Color",textNoColor:"No Color",textNewColor:"Add New Custom Color",zoomText:"Zoom {0}%",textSum:"Sum",textCount:"Count",textAverage:"Average",textMin:"Min",textMax:"Max",filteredRecordsText:"{0} of {1} records filtered",filteredText:"Filter mode",selectAllSheets:"Select All Sheets",ungroupSheets:"Ungroup Sheets",itemAverage:"Average",itemCount:"Count",itemMinimum:"Minimum",itemMaximum:"Maximum",itemSum:"Sum",itemStatus:"Saving status",itemProtect:"Protect",itemUnProtect:"Unprotect"},SSE.Views.Statusbar||{})),SSE.Views.Statusbar.RenameDialog=Common.UI.Window.extend(_.extend({options:{header:!1,width:280,cls:"modal-dlg",buttons:["ok","cancel"]},template:'<div class="box"><div class="input-row"><label><%= label %></label></div><div class="input-row" id="txt-sheet-name"></div></div>',initialize:function(t){_.extend(this.options,t||{},{label:this.labelSheetName}),this.options.tpl=_.template(this.template)(this.options),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this.getChild();t.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.txtName=new Common.UI.InputField({el:t.find("#txt-sheet-name"),style:"width:100%;",value:this.options.current,allowBlank:!1,maxLength:31,validation:_.bind(this.nameValidator,this)})},show:function(t,e){Common.UI.Window.prototype.show.apply(this,arguments);var i=this.txtName.$el.find("input");_.delay(function(t){i.focus(),i.select()},100,this)},onBtnClick:function(t){this.doClose(t.currentTarget.attributes.result.value)},doClose:function(t){"ok"==t&&!0!==this.txtName.checkValidate()?_.delay(function(t){t.txtName.focus()},100,this):(this.options.handler&&this.options.handler.call(this,t,this.txtName.getValue()),this.close())},onPrimary:function(t){return this.doClose("ok"),!1},nameValidator:function(t){if(!(o=this.options.names)&&this.options.api)for(var e=this.options.api,i=e.asc_getActiveWorksheetIndex(),s=e.asc_getWorksheetsCount(),o=[];s--;)i!==s&&o.push(e.asc_getWorksheetName(s).toLowerCase());if(o)for(var n=t.toLowerCase(),a=o.length-1;0<=a;--a)if(o[a]===n)return this.errNameExists;return!/^(\')|[:\\\/\*\?\[\]]|(\')$/.test(t)||this.errNameWrongChar},errNameExists:"Worksheet with such name already exist.",errNameWrongChar:"A sheet name cannot contains characters: \\, /, *, ?, [, ], : or the character ' as first or last character",labelSheetName:"Sheet Name"},e||{})),SSE.Views.Statusbar.CopyDialog=Common.UI.Window.extend(_.extend({options:{width:270,cls:"modal-dlg",buttons:["ok","cancel"]},template:'<div class="box"><div class="input-row"><label><%= label %></label></div><div id="status-list-names" style="height: 162px;"></div></div>',initialize:function(t){_.extend(this.options,t||{},{label:t.ismove?this.textMoveBefore:this.textCopyBefore}),this.options.tpl=_.template(this.template)(this.options),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this.getChild(),e=(t.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),[]);this.options.names.forEach(function(t){e.push(new Common.UI.DataViewModel(t))},this),e.length&&e.push(new Common.UI.DataViewModel({value:this.options.ismove?this.itemMoveToEnd:this.itemCopyToEnd,inindex:-255})),this.listNames=new Common.UI.ListView({el:$("#status-list-names",t),store:new Common.UI.DataViewStore(e),cls:"dbl-clickable",itemTemplate:_.template('<div id="<%= id %>" class="list-item"><%= Common.Utils.String.htmlEncode(value) %></div>')}),this.listNames.selectByIndex(0),this.listNames.on("entervalue",_.bind(this.onPrimary,this)),this.listNames.on("item:dblclick",_.bind(this.onPrimary,this)),this.mask=$(".modals-mask"),this.mask.on("mousedown",_.bind(this.onUpdateFocus,this))},show:function(t,e){Common.UI.Window.prototype.show.apply(this,arguments),_.delay(function(t){t.listNames.focus()},100,this)},hide:function(){Common.UI.Window.prototype.hide.apply(this,arguments),this.mask.off("mousedown",_.bind(this.onUpdateFocus,this))},onBtnClick:function(t){var e=this.listNames.getSelectedRec();this.options.handler&&this.options.handler.call(this,t.currentTarget.attributes.result.value,e.get("inindex")),this.close()},onPrimary:function(){this.options.handler&&this.options.handler.call(this,"ok",this.listNames.getSelectedRec().get("inindex")),this.close()},onUpdateFocus:function(){_.delay(function(t){t.listNames.focus()},100,this)}},i||{}))}),define("spreadsheeteditor/main/app/controller/Statusbar",["core","spreadsheeteditor/main/app/view/Statusbar"],function(){"use strict";SSE.Controllers.Statusbar=Backbone.Controller.extend(_.extend({models:[],collections:[],views:["Statusbar"],initialize:function(){this.addListeners({Statusbar:{"show:tab":_.bind(this.showTab,this),"show:hidden":_.bind(function(t,e){this.hideWorksheet(!1,e)},this),"sheet:changename":_.bind(function(){this.api.asc_closeCellEditor(),this.renameWorksheet()},this),"sheet:setcolor":_.bind(this.setWorksheetColor,this),"sheet:updateColors":_.bind(this.updateTabsColors,this),"sheet:move":_.bind(this.moveWorksheet,this)},ViewTab:{"statusbar:setcompact":_.bind(this.onChangeViewMode,this)}})},events:function(){return{"click #status-btn-zoomdown":_.bind(this.zoomDocument,this,"down"),"click #status-btn-zoomup":_.bind(this.zoomDocument,this,"up"),"click .cnt-zoom":_.bind(this.onZoomShow,this)}},onLaunch:function(){this.statusbar=this.createView("Statusbar").render(),this.statusbar.$el.css("z-index",10),this.statusbar.labelZoom.css("min-width",80),this.statusbar.labelZoom.text(Common.Utils.String.format(this.zoomText,100)),this.statusbar.zoomMenu.on("item:click",_.bind(this.menuZoomClick,this)),this.bindViewEvents(this.statusbar,this.events),$("#id-tab-menu-new-color",this.statusbar.$el).on("click",_.bind(this.onNewBorderColor,this))},setApi:function(t){this.api=t,this.api.asc_registerCallback("asc_onZoomChanged",_.bind(this.onZoomChange,this)),this.api.asc_registerCallback("asc_onSelectionMathChanged",_.bind(this.onApiMathChanged,this)),this.api.asc_registerCallback("asc_onCoAuthoringDisconnect",_.bind(this.onApiDisconnect,this)),Common.NotificationCenter.on("api:disconnect",_.bind(this.onApiDisconnect,this)),this.api.asc_registerCallback("asc_onUpdateTabColor",_.bind(this.onApiUpdateTabColor,this)),this.api.asc_registerCallback("asc_onEditCell",_.bind(this.onApiEditCell,this)),this.api.asc_registerCallback("asc_onWorkbookLocked",_.bind(this.onWorkbookLocked,this)),this.api.asc_registerCallback("asc_onWorksheetLocked",_.bind(this.onWorksheetLocked,this)),this.api.asc_registerCallback("asc_onChangeProtectWorkbook",_.bind(this.onChangeProtectWorkbook,this)),this.api.asc_registerCallback("asc_onError",_.bind(this.onError,this)),this.api.asc_registerCallback("asc_onFilterInfo",_.bind(this.onApiFilterInfo,this)),this.api.asc_registerCallback("asc_onActiveSheetChanged",_.bind(this.onApiActiveSheetChanged,this)),this.api.asc_registerCallback("asc_onRefreshNamedSheetViewList",_.bind(this.onRefreshNamedSheetViewList,this)),this.statusbar.setApi(t)},zoomDocument:function(t,e){if(this.api){switch(t){case"up":var i=Math.floor(10*this.api.asc_getZoom())/10;5<(i+=.1)||this.api.asc_setZoom(i);break;case"down":i=Math.ceil(10*this.api.asc_getZoom())/10,(i-=.1)<.1||this.api.asc_setZoom(i)}Common.NotificationCenter.trigger("edit:complete",this.statusbar)}},menuZoomClick:function(t,e){this.api&&this.api.asc_setZoom(e.value/100),Common.NotificationCenter.trigger("edit:complete",this.statusbar)},onZoomChange:function(t,e){t=Math.floor(100*(t+.005));this.statusbar.labelZoom.text(Common.Utils.String.format(this.zoomText,t)),Common.localStorage.setItem("sse-last-zoom",t)},onApiDisconnect:function(){this.SetDisabled(!0)},SetDisabled:function(t){this.statusbar.setMode({isDisconnected:t}),this.statusbar.update()},onWorkbookLocked:function(t){this.statusbar.tabbar[t?"addClass":"removeClass"]("coauth-locked"),this.statusbar.btnAddWorksheet.setDisabled(t||this.api.isCellEdited||this.statusbar.rangeSelectionMode==Asc.c_oAscSelectionDialogType.Chart||this.statusbar.rangeSelectionMode==Asc.c_oAscSelectionDialogType.FormatTable||this.statusbar.rangeSelectionMode==Asc.c_oAscSelectionDialogType.PrintTitles||this.api.asc_isProtectedWorkbook());for(var e,i=this.statusbar.tabbar.getCount();0<i--;)0<=(e=this.statusbar.tabbar.getAt(i)).sheetindex||(e.disable(t),e.$el.children(":first-child").attr("draggable",t?"false":"true"))},onWorksheetLocked:function(t,e){for(var i,s=this.statusbar.tabbar.getCount(),o=this.api.asc_isProtectedWorkbook(),n=s;0<n--;)if(t==(i=this.statusbar.tabbar.getAt(n)).sheetindex){i[e?"addClass":"removeClass"]("coauth-locked"),i.isLockTheDrag=e||o||this.statusbar.rangeSelectionMode==Asc.c_oAscSelectionDialogType.FormatTable||this.statusbar.rangeSelectionMode==Asc.c_oAscSelectionDialogType.PrintTitles,i.$el.children(":first-child").attr("draggable",i.isLockTheDrag?"false":"true");break}s=this.statusbar.sheetListMenu.items[t];s&&s.$el&&s.$el.children().first().data("hidden")&&s.setDisabled(e)},onChangeProtectWorkbook:function(){var t=this.api.asc_isProtectedWorkbook();this.statusbar.btnAddWorksheet.setDisabled(this.api.isCellEdited||this.api.asc_isWorkbookLocked()||t||this.statusbar.rangeSelectionMode!=Asc.c_oAscSelectionDialogType.None);for(var e=this.statusbar.tabbar.getCount();0<e--;){var i,s=(i=this.statusbar.tabbar.getAt(e)).hasClass("coauth-locked");i.isLockTheDrag=s||t||this.statusbar.rangeSelectionMode==Asc.c_oAscSelectionDialogType.FormatTable||this.statusbar.rangeSelectionMode==Asc.c_oAscSelectionDialogType.PrintTitles,i.$el.children(":first-child").attr("draggable",i.isLockTheDrag?"false":"true")}this.statusbar.update()},onApiMathChanged:function(t){this.statusbar.setMathInfo({count:t.asc_getCount(),average:t.asc_getAverage(),min:t.asc_getMin(),max:t.asc_getMax(),sum:t.asc_getSum()}),this.statusbar.updateTabbarBorders()},onApiFilterInfo:function(t,e){this.statusbar.setFilteredInfo(t,e),this.statusbar.updateTabbarBorders()},onApiEditCell:function(t){var e=t==Asc.c_oAscCellEditorState.editFormula,t=t!=Asc.c_oAscCellEditorState.editEnd,i=$(".statusbar-mask"),s=this.statusbar;s.isEditFormula=e,s.tabbar&&(s.tabbar.isEditFormula=e),s.btnZoomUp.setDisabled(t),s.btnZoomDown.setDisabled(t),s.labelZoom[t?"addClass":"removeClass"]("disabled"),s.btnAddWorksheet.setDisabled(t||this.api.asc_isWorkbookLocked()||this.api.asc_isProtectedWorkbook()||s.rangeSelectionMode!=Asc.c_oAscSelectionDialogType.None),s.$el.find("#statusbar_bottom li span").attr("oo_editor_input",!e),e&&0<i.length||!e&&0==i.length||(s.$el.find(".statusbar").toggleClass("masked",e),e?$("<div class='statusbar-mask'>").appendTo(s.$el):i.remove())},createDelayedElements:function(){this.statusbar.$el.css("z-index",""),this.statusbar.tabMenu.on("item:click",_.bind(this.onTabMenu,this)),this.statusbar.btnAddWorksheet.on("click",_.bind(this.onAddWorksheetClick,this)),Common.UI.LayoutManager.isElementVisible("statusBar-actionStatus")&&!this.statusbar.mode.isEditOle||(this.statusbar.customizeStatusBarMenu.items[0].setVisible(!1),this.statusbar.customizeStatusBarMenu.items[1].setVisible(!1),this.statusbar.boxAction.addClass("hide")),Common.NotificationCenter.on("window:resize",_.bind(this.onWindowResize,this)),Common.NotificationCenter.on("cells:range",_.bind(this.onRangeDialogMode,this))},onWindowResize:function(t){this.statusbar.updateVisibleItemsBoxMath(),this.statusbar.updateTabbarBorders(),this.statusbar.onTabInvisible(void 0,this.statusbar.tabbar.checkInvisible(!0))},onRangeDialogMode:function(t){var e=this.statusbar.tabbar.hasClass("coauth-locked"),i=this.api.asc_getActiveWorksheetIndex();this.statusbar.btnAddWorksheet.setDisabled(e||this.api.isCellEdited||this.api.asc_isProtectedWorkbook()||t!=Asc.c_oAscSelectionDialogType.None),this.statusbar.btnSheetList[t==Asc.c_oAscSelectionDialogType.FormatTable||t==Asc.c_oAscSelectionDialogType.PrintTitles?"addClass":"removeClass"]("disabled");for(var s,o=this.statusbar.tabbar.getCount(),n=this.api.asc_isProtectedWorkbook();0<o--;)(s=this.statusbar.tabbar.getAt(o)).sheetindex!==i&&s.disable(t==Asc.c_oAscSelectionDialogType.FormatTable||t==Asc.c_oAscSelectionDialogType.PrintTitles),s.isLockTheDrag=s.hasClass("coauth-locked")||n||t!=Asc.c_oAscSelectionDialogType.None;this.statusbar.rangeSelectionMode=t},onTabMenu:function(t,e,i){var s=this,o=this.statusbar.tabbar.selectTabs,n=[];switch(o.forEach(function(t){n.push(t.sheetindex)}),e.value){case"ins":for(var a=[],l=0;l<n.length;l++)a.push(s.createSheetName(a));setTimeout(function(){s.api.asc_insertWorksheet(a)},1);break;case"del":this.deleteWorksheet(n);break;case"ren":this.renameWorksheet();break;case"copy":this.moveWorksheet(n,!1);break;case"move":this.moveWorksheet(n,!0);break;case"hide":setTimeout(function(){s.hideWorksheet(!0,n)},1);break;case"protect":this.protectWorksheet()}},createSheetName:function(t){for(var e=[],i=this.api.asc_getWorksheetsCount();i--;)e.push(this.api.asc_getWorksheetName(i).toLowerCase());for(var s,o=0;s=this.strSheet+ ++o,!(e.indexOf(s.toLowerCase())<0););if(t&&0<t.length){var n=[];for(t.forEach(function(t){n.push(t.toLowerCase())});-1!==n.indexOf(s.toLowerCase())||-1!==e.indexOf(s.toLowerCase());)s=this.strSheet+ ++o}return s},createCopyName:function(t,e){for(var i=this.api.asc_getWorksheetsCount(),s=[];i--;)s.push(this.api.asc_getWorksheetName(i).toLowerCase());for(var o,n=/^(.*)\((\d)\)$/.exec(t),a=n?n[1]:t+" ",l=1;!(s.indexOf((o=a+"("+ ++l+")").toLowerCase())<0););if(e&&0<e.length){var r=[];for(e.forEach(function(t){r.push(t.toLowerCase())});-1!==r.indexOf(o.toLowerCase());)o=a+"("+ ++l+")"}return o},deleteWorksheet:function(e){var i=this;1==this.statusbar.tabbar.tabs.length||e.length===this.statusbar.tabbar.tabs.length?Common.UI.warning({msg:this.errorLastSheet}):Common.UI.warning({msg:this.warnDeleteSheet,buttons:["ok","cancel"],callback:function(t){"ok"!=t||i.api.asc_deleteWorksheet(e)||_.delay(function(){Common.UI.error({msg:i.errorRemoveSheet})},10)}})},hideWorksheet:function(t,e){var i;t?1==this.statusbar.tabbar.tabs.length||e.length===this.statusbar.tabbar.tabs.length?Common.UI.warning({msg:this.errorLastSheet}):this.api.asc_hideWorksheet(e):(this.api.asc_showWorksheet(e),this.loadTabColor(e),i=this,setTimeout(function(){i.statusbar.tabMenu.hide()},1))},renameWorksheet:function(){var i=this,t=i.api.asc_getWorksheetsCount(),e=null;if(0<t){var s=i.api.asc_getActiveWorksheetIndex();if(!i.api.asc_isWorksheetLockedOrDeleted(s)){if(!Common.Utils.InternalSettings.get("sse-settings-coauthmode"))for(e=[];t--;)s!==t&&e.push(i.api.asc_getWorksheetName(t).toLowerCase());var o,n=i.statusbar.tabbar.tabs[i.statusbar.tabbar.getActive()],a=i.statusbar.$el.position().top-115,n=n.$el.offset().left,l=i.api.asc_getWorksheetName(i.api.asc_getActiveWorksheetIndex()),r=new SSE.Views.Statusbar.RenameDialog({current:l,names:e,api:i.api,handler:function(t,e){"ok"==t&&e!=l&&i.api.asc_renameWorksheet(e),i.api.asc_enableKeyEvents(!0)}});"number"==typeof r.options.width&&(o=$("body").width(),n+r.options.width>o&&(n=o-r.options.width-5)),r.show(n,a)}}},moveWorksheet:function(e,s,t,i){for(var o,n=this,a=n.api.asc_getWorksheetsCount(),l=[],r=[],c=-1;++c<a;)this.api.asc_isWorksheetHidden(c)||l.push({value:n.api.asc_getWorksheetName(c),inindex:c});_.isUndefined(e)||l.forEach(function(t){-1!==e.indexOf(t.inindex)&&r.push(t.inindex)}),_.isUndefined(t)?new SSE.Views.Statusbar.CopyDialog({title:s?n.statusbar.itemMove:n.statusbar.itemCopy,ismove:s,names:l,handler:function(t,e){var i;"ok"==t&&(s?n.api.asc_moveWorksheet(-255==e?a:e,r):(i=[],r.forEach(function(t){i.push(n.createCopyName(n.api.asc_getWorksheetName(t),i))}),n.api.asc_copyWorksheet(-255==e?a:e,i,r))),n.api.asc_enableKeyEvents(!0)}}).show():s?(n.api.asc_moveWorksheet(i,r),n.api.asc_enableKeyEvents(!0)):(o=[],r.forEach(function(t){o.push(n.createCopyName(n.api.asc_getWorksheetName(t),o))}),n.api.asc_copyWorksheet(i,o,r))},onAddWorksheetClick:function(t,e,i){this.api&&(this.api.asc_closeCellEditor(),this.api.asc_addWorksheet(this.createSheetName()),Common.NotificationCenter.trigger("comments:updatefilter",["doc","sheet"+this.api.asc_getActiveWorksheetId()],!1)),Common.NotificationCenter.trigger("edit:complete",this.statusbar)},showTab:function(t){this.api&&this.api.asc_getActiveWorksheetIndex()!==t&&(this.api.asc_showWorksheet(t),this.loadTabColor(t));var e=this;setTimeout(function(){e.statusbar.sheetListMenu.hide()},1)},selectTab:function(t){this.api&&!this.api.asc_isWorksheetHidden(t)&&(t=_.findWhere(this.statusbar.tabbar.tabs,{sheetindex:t}))&&this.statusbar.tabbar.setActive(t)},onApiUpdateTabColor:function(t){this.loadTabColor(t)},setWorksheetColor:function(t){var e,i,s,o=this;this.api&&(e=this.statusbar.tabbar.selectTabs,i=[],e.forEach(function(t){i.push(t.sheetindex)}),i&&("transparent"===t?(this.api.asc_setWorksheetTabColor(null,i),e.forEach(function(t){t.$el.find("span").css("box-shadow","")})):(s=Common.Utils.ThemeColor.getRgbColor(t))&&(this.api.asc_setWorksheetTabColor(s,i),e.forEach(function(t){o.setTabLineColor(t,s)}))))},updateThemeColors:function(){if(this.statusbar){var t=this.statusbar.mnuTabColor,e=1;if(t){for(var i,s=Common.Utils.ThemeColor.getEffectColors(),o=0;o<s.length;++o)"object"==typeof t.currentColor&&void 0===i&&t.currentColor.effectId==s[o].effectId&&(i=s[o]);t.updateColors(s,Common.Utils.ThemeColor.getStandartColors()),void 0===t.currentColor?t.currentColor=s[e]:void 0!==i&&(t.currentColor=i)}}},onNewBorderColor:function(){this.statusbar&&this.statusbar.mnuTabColor&&this.statusbar.mnuTabColor.addNewColor()},updateTabsColors:function(t){var e,i=-1,s=-1,o=null,n=null,a=this.api.asc_getWorksheetsCount(),l=this.api.asc_getActiveWorksheetIndex();if(!_.isUndefined(t)&&this.application.getController("Toolbar"))if(this.statusbar.mnuTabColor.updateCustomColors(),(o=this.api.asc_getWorksheetTabColor(l))&&(n=o.get_type()==Asc.c_oAscColor.COLOR_TYPE_SCHEME?{color:Common.Utils.ThemeColor.getHexColor(o.get_r(),o.get_g(),o.get_b()),effectValue:o.get_value()}:Common.Utils.ThemeColor.getHexColor(o.get_r(),o.get_g(),o.get_b())),_.isObject(n)){for(var r=!1,i=0;i<10;i++)if(Common.Utils.ThemeColor.ThemeValues[i]===n.effectValue){this.statusbar.mnuTabColor.select(n,!0),r=!0;break}r||this.statusbar.mnuTabColor.clearSelection()}else this.statusbar.mnuTabColor.select(n||"transparent",!0);for(i=-1;++i<a;)++s,(e=this.api.asc_isWorksheetHidden(i))&&--s,e||this.setTabLineColor(this.statusbar.tabbar.getAt(s),this.api.asc_getWorksheetTabColor(i))},loadTabColor:function(t){var e;this.api&&!this.api.asc_isWorksheetHidden(t)&&(e=_.findWhere(this.statusbar.tabbar.tabs,{sheetindex:t}))&&this.setTabLineColor(e,this.api.asc_getWorksheetTabColor(t))},setTabLineColor:function(t,e){t&&((e=null!==e?"#"+Common.Utils.ThemeColor.getHexColor(e.get_r(),e.get_g(),e.get_b()):"").length?(this.statusbar.sheetListMenu.items[t.sheetindex].$el.find(".color").css("background-color",e),e=t.isActive()?"0px 4px 0 "+e+" inset":"0px 4px 0 "+Common.Utils.RGBColor(e).toRGBA(1)+" inset",t.$el.find("span").css("box-shadow",e)):(t.$el.find("span").css("box-shadow",""),this.statusbar.sheetListMenu.items[t.sheetindex].$el.find(".color").css("background-color","")))},onZoomShow:function(t){if(t.target.classList.contains("disabled"))return!1},onError:function(t,e,i){t==Asc.c_oAscError.ID.LockedWorksheetRename&&this.statusbar.update()},onApiActiveSheetChanged:function(t){this.statusbar.tabMenu.hide(),this.statusbar.sheetListMenu.hide(),this.statusbar.sheetListMenu.items[t]&&(this.statusbar.sheetListMenu.clearAll(),this.statusbar.sheetListMenu.items[t].setChecked(!0)),this._sheetViewTip&&this._sheetViewTip.isVisible()&&this.api.asc_getActiveNamedSheetView&&!this.api.asc_getActiveNamedSheetView(t)&&this._sheetViewTip.hide()},onRefreshNamedSheetViewList:function(){for(var t=this.api.asc_getNamedSheetViews(),e=!1,i="",s=this,o=0;o<t.length;o++)if(t[o].asc_getIsActive()){e=!0,i=t[o].asc_getName();break}var n=this.statusbar.tabbar.getAt(this.statusbar.tabbar.getActive());n&&n.changeIconState(e,i),!e||Common.localStorage.getBool("sse-hide-sheet-view-tip")||Common.Utils.InternalSettings.get("sse-hide-sheet-view-tip")?!e&&this._sheetViewTip&&this._sheetViewTip.isVisible()&&this._sheetViewTip.hide():(this._sheetViewTip||(this._sheetViewTip=new Common.UI.SynchronizeTip({target:$("#editor_sdk"),extCls:"no-arrow",text:this.textSheetViewTipFilters,placement:"target"}),this._sheetViewTip.on({dontshowclick:function(){Common.localStorage.setBool("sse-hide-sheet-view-tip",!0),Common.Utils.InternalSettings.set("sse-hide-sheet-view-tip",!0),this.close(),s._sheetViewTip=void 0},closeclick:function(){Common.Utils.InternalSettings.set("sse-hide-sheet-view-tip",!0),this.close(),s._sheetViewTip=void 0}})),this._sheetViewTip.isVisible()||this._sheetViewTip.show())},onChangeViewMode:function(t,e,i){this.statusbar.fireEvent("view:compact",[this.statusbar,e]),i||Common.localStorage.setBool("sse-compact-statusbar",e),Common.NotificationCenter.trigger("layout:changed","status"),this.statusbar.onChangeCompact(e),Common.NotificationCenter.trigger("edit:complete",this.statusbar)},setStatusCaption:function(t,e,i,s){this.timerCaption&&(new Date<this.timerCaption||0==t.length)&&!e||(this.timerCaption=void 0,t.length?(this.statusbar.showStatusMessage(t,s),0<i&&(this.timerCaption=(new Date).getTime()+i)):this.statusbar.clearStatusMessage())},protectWorksheet:function(){Common.NotificationCenter.trigger("protect:sheet",!this.api.asc_isProtectedSheet())},getIsDragDrop:function(){var t=this.statusbar.tabbar.isDragDrop;return this.statusbar.tabbar.isDragDrop=!1,t},showDisconnectTip:function(){var t,e=this;this.disconnectTip||(t=(t=this.statusbar.getStatusLabel()).is(":visible")?t.parent():this.statusbar.isVisible()?this.statusbar.$el:$(document.body),this.disconnectTip=new Common.UI.SynchronizeTip({target:t,text:this.textDisconnect,placement:"top",position:this.statusbar.isVisible()?void 0:{bottom:0},showLink:!1,style:"max-width: 310px;"}),this.disconnectTip.on({closeclick:function(){e.disconnectTip.hide(),e.disconnectTip=null}})),this.disconnectTip.show()},hideDisconnectTip:function(){this.disconnectTip&&this.disconnectTip.hide(),this.disconnectTip=null},getSelectTabs:function(){var t=this.statusbar.tabbar.selectTabs,e=[];return t.forEach(function(t){e.push(t.sheetindex)}),e},zoomText:"Zoom {0}%",errorLastSheet:"Workbook must have at least one visible worksheet.",errorRemoveSheet:"Can't delete the worksheet.",warnDeleteSheet:"The worksheet maybe has data. Proceed operation?",strSheet:"Sheet",textSheetViewTip:"You are in Sheet View mode. Filters and sorting are visible only to you and those who are still in this view.",textSheetViewTipFilters:"You are in Sheet View mode. Filters are visible only to you and those who are still in this view.",textDisconnect:"<b>Connection is lost</b><br>Trying to connect. Please check connection settings."},SSE.Controllers.Statusbar||{}))}),define("text!spreadsheeteditor/main/app/template/RightMenu.template",[],function(){return'<div id="view-right-menu" class="tool-menu right">\n    <div class="right-panel">\n        <div id="id-table-settings" class="settings-panel">\n        </div>\n        <div id="id-shape-settings" class="settings-panel">\n        </div>\n        <div id="id-image-settings" class="settings-panel">\n        </div>\n        <div id="id-chart-settings" class="settings-panel">\n        </div>\n        <div id="id-paragraph-settings" class="settings-panel">\n        </div>\n        <div id="id-textart-settings" class="settings-panel">\n        </div>\n        <div id="id-pivot-settings" class="settings-panel">\n        </div>\n        <div id="id-signature-settings" class="settings-panel">\n        </div>\n        <div id="id-cell-settings" class="settings-panel">\n        </div>\n        <div id="id-slicer-settings" class="settings-panel">\n        </div>\n    </div>\n    <div class="tool-menu-btns">\n        <div class="ct-btn-category arrow-left"></div>\n        <button id="id-right-menu-cell" class="btn btn-category arrow-left" data-hint="0" data-hint-direction="left" data-hint-offset="big" content-target="id-cell-settings"><i class="icon toolbar__icon btn-menu-cell">&nbsp;</i></button>\n        <button id="id-right-menu-table" class="btn btn-category arrow-left" data-hint="0" data-hint-direction="left" data-hint-offset="big" content-target="id-table-settings"><i class="icon toolbar__icon btn-menu-table">&nbsp;</i></button>\n        <button id="id-right-menu-image" class="btn btn-category arrow-left" data-hint="0" data-hint-direction="left" data-hint-offset="big" content-target="id-image-settings"><i class="icon toolbar__icon btn-menu-image">&nbsp;</i></button>\n        <button id="id-right-menu-shape" class="btn btn-category arrow-left" data-hint="0" data-hint-direction="left" data-hint-offset="big" content-target="id-shape-settings"><i class="icon toolbar__icon btn-menu-shape">&nbsp;</i></button>\n        <button id="id-right-menu-chart" class="btn btn-category arrow-left" data-hint="0" data-hint-direction="left" data-hint-offset="big" content-target="id-chart-settings"><i class="icon toolbar__icon btn-menu-chart">&nbsp;</i></button>\n        <button id="id-right-menu-text" class="btn btn-category arrow-left" data-hint="0" data-hint-direction="left" data-hint-offset="big" content-target="id-paragraph-settings"><i class="icon toolbar__icon btn-paragraph">&nbsp;</i></button>\n        <button id="id-right-menu-textart" class="btn btn-category arrow-left" data-hint="0" data-hint-direction="left" data-hint-offset="big" content-target="id-textart-settings"><i class="icon toolbar__icon btn-menu-textart">&nbsp;</i></button>\n        <button id="id-right-menu-pivot" class="btn btn-category arrow-left" data-hint="0" data-hint-direction="left" data-hint-offset="big" content-target="id-pivot-settings"><i class="icon toolbar__icon btn-pivot-sum">&nbsp;</i></button>\n        <button id="id-right-menu-slicer" class="btn btn-category arrow-left" data-hint="0" data-hint-direction="left" data-hint-offset="big" content-target="id-slicer-settings"><i class="icon toolbar__icon btn-slicer">&nbsp;</i></button>\n        <button id="id-right-menu-signature" class="btn btn-category arrow-left hidden" data-hint="0" data-hint-direction="left" data-hint-offset="big" content-target="id-signature-settings"><i class="icon toolbar__icon btn-menu-signature">&nbsp;</i></button>\n    </div>\n</div>'}),define("text!spreadsheeteditor/main/app/template/ParagraphSettings.template",[],function(){return'<table cols="2">\n    <tr>\n        <td colspan=2>\n            <label class="header"><%= scope.strLineHeight %></label>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" width="50%">\n            <div id="paragraph-combo-line-rule" style="width: 85px;"></div>\n        </td>\n        <td class="padding-small" width="50%">\n            <div id="paragraph-spin-line-height"></div>\n        </td>\n    </tr>\n    <tr>\n        <td colspan=2>\n            <label class="header"><%= scope.strParagraphSpacing %></label>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" width="50%">\n            <label class="input-label"><%= scope.strSpacingBefore %></label>\n            <div id="paragraph-spin-spacing-before"></div>\n        </td>\n        <td class="padding-small" width="50%">\n            <label class="input-label"><%= scope.strSpacingAfter %></label>\n            <div id="paragraph-spin-spacing-after"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" colspan=2>\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr>\n        <td align="center" colspan=2>\n            <label class="link" id="paragraph-advanced-link" data-hint="1" data-hint-direction="bottom" data-hint-offset="medium"><%= scope.textAdvanced %></label>\n        </td>\n    </tr>\n    <tr class="finish-cell"></tr>\n</table>'}),{LINERULE_LEAST:0,LINERULE_AUTO:1,LINERULE_EXACT:2}),Common,Common,Common,Common,Common,Common,SCALE_MIN=(define("spreadsheeteditor/main/app/view/ParagraphSettings",["text!spreadsheeteditor/main/app/template/ParagraphSettings.template","jquery","underscore","backbone","common/main/lib/component/ComboBox","common/main/lib/component/MetricSpinner","spreadsheeteditor/main/app/view/ParagraphSettingsAdvanced"],function(t,e,i,s){"use strict";SSE.Views.ParagraphSettings=s.View.extend(i.extend({el:"#id-paragraph-settings",template:i.template(t),events:{},options:{alias:"ParagraphSettings"},initialize:function(){this._initSettings=!0,this._state={LineRule:c_paragraphLinerule.LINERULE_AUTO,LineHeight:1.5,LineSpacingBefore:0,LineSpacingAfter:.35,DisabledControls:!1},this.spinners=[],this.lockedControls=[],this._locked=!1,this.render()},render:function(){e(this.el).html(this.template({scope:this})),this.linkAdvanced=e("#paragraph-advanced-link")},setApi:function(t){return this.api=t,this.api&&this.api.asc_registerCallback("asc_onParaSpacingLine",i.bind(this._onLineSpacing,this)),this},onNumLineHeightChange:function(t,e,i,s){""!==this.cmbLineRule.getRawValue()&&this.api&&this.api.asc_putPrLineSpacing(this.cmbLineRule.getValue(),this.cmbLineRule.getValue()==c_paragraphLinerule.LINERULE_AUTO?t.getNumberValue():Common.Utils.Metric.fnRecalcToMM(t.getNumberValue()))},onNumSpacingBeforeChange:function(t,e,i,s){this.api&&(t.getNumberValue()<0?this.api.asc_putLineSpacingBeforeAfter(0,-1):this.api.asc_putLineSpacingBeforeAfter(0,Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())))},onNumSpacingAfterChange:function(t,e,i,s){this.api&&(t.getNumberValue()<0?this.api.asc_putLineSpacingBeforeAfter(1,-1):this.api.asc_putLineSpacingBeforeAfter(1,Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())))},onLineRuleSelect:function(t,e){this.api&&this.api.asc_putPrLineSpacing(e.value,e.defaultValue),this.numLineHeight.setDefaultUnit(e.defaultUnit),this.numLineHeight.setMinValue(e.minValue),this.numLineHeight.setStep(e.step),Common.NotificationCenter.trigger("edit:complete",this)},_onLineSpacing:function(t){var e,i;this._initSettings||(e=t.asc_getLineRule(),t=t.asc_getLine(),this._state.LineRule!==e&&(i=(i=this.cmbLineRule.store.findWhere(((i={}).value=e,i)))||this.cmbLineRule.store.at(0),this.cmbLineRule.setValue(null!==e?e:""),this.numLineHeight.setMinValue(i.get("minValue")),this.numLineHeight.setDefaultUnit(i.get("defaultUnit")),this.numLineHeight.setStep(i.get("step")),this._state.LineRule=e),(.001<Math.abs(this._state.LineHeight-t)||(null===this._state.LineHeight||null===t)&&this._state.LineHeight!==t)&&(i="",e==c_paragraphLinerule.LINERULE_AUTO?i=t:null!==e&&null!==t&&(i=Common.Utils.Metric.fnRecalcFromMM(t)),this.numLineHeight.setValue(null!==i?i:"",!0),this._state.LineHeight=t))},ChangeSettings:function(t){var e;this._initSettings&&this.createDelayedElements(),this.disableControls(this._locked),t&&(t={Line:t.asc_getSpacing().asc_getLine(),Before:t.asc_getSpacing().asc_getBefore(),After:t.asc_getSpacing().asc_getAfter(),LineRule:t.asc_getSpacing().asc_getLineRule()},this._state.LineRule!==t.LineRule&&(e=(e=this.cmbLineRule.store.findWhere(((e={}).value=t.LineRule,e)))||this.cmbLineRule.store.at(0),this.cmbLineRule.setValue(null!==t.LineRule?t.LineRule:""),this.numLineHeight.setMinValue(e.get("minValue")),this.numLineHeight.setDefaultUnit(e.get("defaultUnit")),this.numLineHeight.setStep(e.get("step")),this._state.LineRule=t.LineRule),(.001<Math.abs(this._state.LineHeight-t.Line)||(null===this._state.LineHeight||null===t.Line)&&this._state.LineHeight!==t.Line)&&(e="",t.LineRule==c_paragraphLinerule.LINERULE_AUTO?e=t.Line:null!==t.LineRule&&null!==t.Line&&(e=Common.Utils.Metric.fnRecalcFromMM(t.Line)),this.numLineHeight.setValue(null!==e?e:"",!0),this._state.LineHeight=t.Line),(.001<Math.abs(this._state.LineSpacingBefore-t.Before)||(null===this._state.LineSpacingBefore||null===t.Before)&&this._state.LineSpacingBefore!==t.Before)&&(this.numSpacingBefore.setValue(null!==t.Before?t.Before<0?t.Before:Common.Utils.Metric.fnRecalcFromMM(t.Before):"",!0),this._state.LineSpacingBefore=t.Before),(.001<Math.abs(this._state.LineSpacingAfter-t.After)||(null===this._state.LineSpacingAfter||null===t.After)&&this._state.LineSpacingAfter!==t.After)&&(this.numSpacingAfter.setValue(null!==t.After?t.After<0?t.After:Common.Utils.Metric.fnRecalcFromMM(t.After):"",!0),this._state.LineSpacingAfter=t.After))},updateMetricUnit:function(){if(this.spinners){for(var t=0;t<this.spinners.length;t++){var e=this.spinners[t];e.setDefaultUnit(Common.Utils.Metric.getCurrentMetricName()),e.setStep(Common.Utils.Metric.getCurrentMetric()==Common.Utils.Metric.c_MetricUnits.pt?1:.01)}var i=this._state.LineSpacingBefore;this.numSpacingBefore&&this.numSpacingBefore.setValue(null!==i?i<0?i:Common.Utils.Metric.fnRecalcFromMM(i):"",!0),i=this._state.LineSpacingAfter,this.numSpacingAfter&&this.numSpacingAfter.setValue(null!==i?i<0?i:Common.Utils.Metric.fnRecalcFromMM(i):"",!0)}var s,o;this.cmbLineRule&&((o=this.cmbLineRule.store.at(1)).set({defaultUnit:Common.Utils.Metric.getCurrentMetricName(),minValue:parseFloat(Common.Utils.Metric.fnRecalcFromMM(.3).toFixed(2)),step:Common.Utils.Metric.getCurrentMetric()==Common.Utils.Metric.c_MetricUnits.pt?1:.01}),null!==this._state.LineRule&&(o=(o=this.cmbLineRule.store.findWhere(((s={}).value=this._state.LineRule,s)))||this.cmbLineRule.store.at(0),this.numLineHeight.setDefaultUnit(o.get("defaultUnit")),this.numLineHeight.setStep(o.get("step")),i="",this._state.LineRule==c_paragraphLinerule.LINERULE_AUTO?i=this._state.LineHeight:null!==this._state.LineHeight&&(i=Common.Utils.Metric.fnRecalcFromMM(this._state.LineHeight)),this.numLineHeight&&this.numLineHeight.setValue(null!==i?i:"",!0)))},createDelayedControls:function(){var t=this;this._arrLineRule=[{displayValue:this.textAuto,defaultValue:1,value:c_paragraphLinerule.LINERULE_AUTO,minValue:.5,step:.01,defaultUnit:""},{displayValue:this.textExact,defaultValue:5,value:c_paragraphLinerule.LINERULE_EXACT,minValue:.03,step:.01,defaultUnit:"cm"}],this.cmbLineRule=new Common.UI.ComboBox({el:e("#paragraph-combo-line-rule"),cls:"input-group-nr",menuStyle:"min-width: 85px;",editable:!1,data:this._arrLineRule,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbLineRule.setValue(c_paragraphLinerule.LINERULE_AUTO),this.lockedControls.push(this.cmbLineRule),this.numLineHeight=new Common.UI.MetricSpinner({el:e("#paragraph-spin-line-height"),step:.01,width:85,value:"1.5",defaultUnit:"",maxValue:132,minValue:.5,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.lockedControls.push(this.numLineHeight),this.numSpacingBefore=new Common.UI.MetricSpinner({el:e("#paragraph-spin-spacing-before"),step:.1,width:85,value:"0 cm",defaultUnit:"cm",maxValue:55.88,minValue:0,allowAuto:!0,autoText:this.txtAutoText,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.spinners.push(this.numSpacingBefore),this.lockedControls.push(this.numSpacingBefore),this.numSpacingAfter=new Common.UI.MetricSpinner({el:e("#paragraph-spin-spacing-after"),step:.1,width:85,value:"0.35 cm",defaultUnit:"cm",maxValue:55.88,minValue:0,allowAuto:!0,autoText:this.txtAutoText,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.spinners.push(this.numSpacingAfter),this.lockedControls.push(this.numSpacingAfter),this.numLineHeight.on("change",i.bind(this.onNumLineHeightChange,this)),this.numSpacingBefore.on("change",i.bind(this.onNumSpacingBeforeChange,this)),this.numSpacingAfter.on("change",i.bind(this.onNumSpacingAfterChange,this)),this.numLineHeight.on("inputleave",function(){Common.NotificationCenter.trigger("edit:complete",t)}),this.numSpacingBefore.on("inputleave",function(){Common.NotificationCenter.trigger("edit:complete",t)}),this.numSpacingAfter.on("inputleave",function(){Common.NotificationCenter.trigger("edit:complete",t)}),this.cmbLineRule.on("selected",i.bind(this.onLineRuleSelect,this)),this.cmbLineRule.on("hide:after",i.bind(this.onHideMenus,this)),e(this.el).on("click","#paragraph-advanced-link",i.bind(this.openAdvancedSettings,this))},createDelayedElements:function(){this.createDelayedControls(),this.updateMetricUnit(),this._initSettings=!1},openAdvancedSettings:function(t){if(!this.linkAdvanced.hasClass("disabled")){var i=this;if(i.api&&!this._locked){var e=i.api.asc_getGraphicObjectProps();if(e&&0<e.length)for(var s,o,n=e.length-1;0<=n;n--)if(s=e[n].asc_getObjectType(),o=e[n].asc_getObjectValue(),Asc.c_oAscTypeSelectElement.Paragraph==s){new SSE.Views.ParagraphSettingsAdvanced({paragraphProps:o,api:i.api,handler:function(t,e){"ok"==t&&i.api&&(i.borderAdvancedProps=e.borderProps,i.api.asc_setGraphicObjectProps(e.paragraphProps)),Common.NotificationCenter.trigger("edit:complete",i)}}).show();break}}}},onHideMenus:function(t,e,i){i||Common.NotificationCenter.trigger("edit:complete",this)},setLocked:function(t){this._locked=t},disableControls:function(e){this._initSettings||this._state.DisabledControls!==e&&(this._state.DisabledControls=e,i.each(this.lockedControls,function(t){t.setDisabled(e)}),this.linkAdvanced.toggleClass("disabled",e))}},SSE.Views.ParagraphSettings||{}))}),define("text!spreadsheeteditor/main/app/template/ImageSettings.template",[],function(){return'<table cols="3">\n    <tr>\n        <td colspan=3>\n            <label class="header"><%= scope.textSize %></label>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" width="88px">\n            <label class="input-label"><%= scope.textWidth %></label>\n            <div id="image-spin-width"></div>\n        </td>\n        <td class="padding-small" width="28px" style="vertical-align: bottom;">\n            <div id="image-button-ratio"></div>\n        </td>\n        <td class="padding-small" width="88px">\n            <label class="input-label"><%= scope.textHeight %></label>\n            <div id="image-spin-height"></div>\n        </td>\n    </tr>\n</table>\n<table cols="2">\n    <tr>\n        <td class="padding-small" colspan=2>\n            <button type="button" class="btn btn-text-default" id="image-button-original-size" style="min-width:100px;width: auto;" data-hint="1" data-hint-direction="bottom" data-hint-offset="big"><%= scope.textOriginalSize %></button>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" colspan=2>\n            <div id="image-button-crop" style="min-width:100px;"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" colspan=2>\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr>\n        <td colspan=2 class="padding-small">\n            <label class="header"><%= scope.textRotation %></label>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" width="50%">\n            <label class="input-label"><%= scope.textRotate90 %></label>\n            <div>\n                <div id="image-button-270" class="margin-right-4"></div>\n                <div id="image-button-90"></div>\n            </div>\n        </td>\n        <td class="padding-small" width="50%">\n            <label class="input-label"><%= scope.textFlip %></label>\n            <div>\n                <div id="image-button-fliph" class="margin-right-4"></div>\n                <div id="image-button-flipv"></div>\n            </div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" colspan=2>\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr>\n        <td colspan=2>\n            <div id="image-button-replace" style="width:100%;"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" colspan=2>\n            <button type="button" class="btn btn-text-default hidden" id="image-button-edit-object" style="width:100%;"><%= scope.textEditObject %></button>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" colspan=2>\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr>\n        <td align="center" colspan=2>\n            <label class="link" id="image-advanced-link" data-hint="1" data-hint-direction="bottom" data-hint-offset="medium"><%= scope.textAdvanced %></label>\n        </td>\n    </tr>\n    <tr class="finish-cell"></tr>\n</table>'}),define("spreadsheeteditor/main/app/view/ImageSettings",["text!spreadsheeteditor/main/app/template/ImageSettings.template","jquery","underscore","backbone","common/main/lib/component/Button","common/main/lib/component/MetricSpinner","common/main/lib/view/ImageFromUrlDialog","spreadsheeteditor/main/app/view/ImageSettingsAdvanced"],function(t,i,s,e){"use strict";SSE.Views.ImageSettings=e.View.extend(s.extend({el:"#id-image-settings",template:s.template(t),events:{},options:{alias:"ImageSettings"},initialize:function(){this._initSettings=!0,this._nRatio=1,this._state={Width:0,Height:0,DisabledControls:!1,keepRatio:!1,isOleObject:!1,cropMode:!1},this.spinners=[],this.lockedControls=[],this._locked=!1,this._noApply=!1,this._originalProps=null,this.render()},render:function(){i(this.el).html(this.template({scope:this})),this.linkAdvanced=i("#image-advanced-link")},setApi:function(t){if(null!=t)return this.api=t,this.api&&this.api.asc_registerCallback("asc_ChangeCropState",s.bind(this._changeCropState,this)),Common.NotificationCenter.on("storage:image-insert",s.bind(this.insertImageFromStorage,this)),this},setMode:function(t){this.mode=t},updateMetricUnit:function(){if(this.spinners){for(var t=0;t<this.spinners.length;t++){var e=this.spinners[t];e.setDefaultUnit(Common.Utils.Metric.getCurrentMetricName()),e.setStep(Common.Utils.Metric.getCurrentMetric()==Common.Utils.Metric.c_MetricUnits.pt?1:.1)}this.spnWidth&&this.spnWidth.setValue(null!==this._state.Width?Common.Utils.Metric.fnRecalcFromMM(this._state.Width):"",!0),this.spnHeight&&this.spnHeight.setValue(null!==this._state.Height?Common.Utils.Metric.fnRecalcFromMM(this._state.Height):"",!0)}},createDelayedControls:function(){var t=this,e=(this.spnWidth=new Common.UI.MetricSpinner({el:i("#image-spin-width"),step:.1,width:78,defaultUnit:"cm",value:"3 cm",maxValue:55.88,minValue:0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.spinners.push(this.spnWidth),this.lockedControls.push(this.spnWidth),this.spnHeight=new Common.UI.MetricSpinner({el:i("#image-spin-height"),step:.1,width:78,defaultUnit:"cm",value:"3 cm",maxValue:55.88,minValue:0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.spinners.push(this.spnHeight),this.lockedControls.push(this.spnHeight),this.btnRatio=new Common.UI.Button({parentEl:i("#image-button-ratio"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-advanced-ratio",style:"margin-bottom: 1px;",enableToggle:!0,hint:this.textKeepRatio,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.lockedControls.push(this.btnRatio),this.btnRatio.on("click",s.bind(function(t,e){var i;t.pressed&&0<this.spnHeight.getNumberValue()&&(this._nRatio=this.spnWidth.getNumberValue()/this.spnHeight.getNumberValue()),this.api&&((i=new Asc.asc_CImgProperty).asc_putLockAspect(t.pressed),this.api.asc_setGraphicObjectProps(i))},this)),this.btnOriginalSize=new Common.UI.Button({el:i("#image-button-original-size")}),this.lockedControls.push(this.btnOriginalSize),this.btnSelectImage=new Common.UI.Button({parentEl:i("#image-button-replace"),cls:"btn-text-menu-default",caption:this.textInsert,style:"width:100%;",menu:new Common.UI.Menu({style:"min-width: 194px;",maxHeight:200,items:[{caption:this.textFromFile,value:0},{caption:this.textFromUrl,value:1},{caption:this.textFromStorage,value:2}]}),dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.lockedControls.push(this.btnSelectImage),this.btnSelectImage.menu.on("item:click",s.bind(this.onImageSelect,this)),this.btnSelectImage.menu.items[2].setVisible(this.mode.canRequestInsertImage||this.mode.fileChoiceUrl&&-1<this.mode.fileChoiceUrl.indexOf("{documentType}")),this.btnEditObject=new Common.UI.Button({el:i("#image-button-edit-object")}),this.lockedControls.push(this.btnEditObject),this.spnWidth.on("change",s.bind(this.onWidthChange,this)),this.spnHeight.on("change",s.bind(this.onHeightChange,this)),this.spnWidth.on("inputleave",function(){Common.NotificationCenter.trigger("edit:complete",t)}),this.spnHeight.on("inputleave",function(){Common.NotificationCenter.trigger("edit:complete",t)}),this.btnOriginalSize.on("click",s.bind(this.setOriginalSize,this)),this.btnEditObject.on("click",s.bind(function(t){var e,i;this.api&&((e=this.api.asc_canEditTableOleObject(!0))?(i=SSE.getController("Common.Controllers.ExternalOleEditor").getView("Common.Views.ExternalOleEditor"))&&(i.setEditMode(!0),i.show(),i.setOleData(Asc.asc_putBinaryDataToFrameFromTableOleObject(e))):this.api.asc_startEditCurrentOleObject()),Common.NotificationCenter.trigger("edit:complete",this)},this)),this.btnOriginalSize.cmpEl.outerWidth());this.btnCrop=new Common.UI.Button({parentEl:i("#image-button-crop"),cls:"btn-text-split-default",caption:this.textCrop,split:!0,enableToggle:!0,allowDepress:!0,pressed:this._state.cropMode,width:e,menu:new Common.UI.Menu({style:"min-width:"+e+"px;",items:[{caption:this.textCrop,checkable:!0,allowDepress:!0,checked:this._state.cropMode,value:0},{caption:this.textCropToShape,menu:new Common.UI.Menu({menuAlign:"tl-tl",cls:"menu-shapes menu-change-shape",items:[]})},{caption:this.textCropFill,value:1},{caption:this.textCropFit,value:2}]}),dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.btnCrop.on("click",s.bind(this.onCrop,this)),this.btnCrop.menu.on("item:click",s.bind(this.onCropMenu,this)),this.lockedControls.push(this.btnCrop),this.btnChangeShape=this.btnCrop.menu.items[1],this.btnRotate270=new Common.UI.Button({parentEl:i("#image-button-270",t.$el),cls:"btn-toolbar",iconCls:"toolbar__icon btn-rotate-270",value:0,hint:this.textHint270,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.btnRotate270.on("click",s.bind(this.onBtnRotateClick,this)),this.lockedControls.push(this.btnRotate270),this.btnRotate90=new Common.UI.Button({parentEl:i("#image-button-90",t.$el),cls:"btn-toolbar",iconCls:"toolbar__icon btn-rotate-90",value:1,hint:this.textHint90,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.btnRotate90.on("click",s.bind(this.onBtnRotateClick,this)),this.lockedControls.push(this.btnRotate90),this.btnFlipV=new Common.UI.Button({parentEl:i("#image-button-flipv",t.$el),cls:"btn-toolbar",iconCls:"toolbar__icon btn-flip-vert",value:0,hint:this.textHintFlipV,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.btnFlipV.on("click",s.bind(this.onBtnFlipClick,this)),this.lockedControls.push(this.btnFlipV),this.btnFlipH=new Common.UI.Button({parentEl:i("#image-button-fliph",t.$el),cls:"btn-toolbar",iconCls:"toolbar__icon btn-flip-hor",value:1,hint:this.textHintFlipH,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.btnFlipH.on("click",s.bind(this.onBtnFlipClick,this)),this.lockedControls.push(this.btnFlipH),i(this.el).on("click","#image-advanced-link",s.bind(this.openAdvancedSettings,this))},createDelayedElements:function(){this.createDelayedControls(),this.updateMetricUnit(),this.onApiAutoShapes(),this._initSettings=!1},openAdvancedSettings:function(t){if(!this.linkAdvanced.hasClass("disabled")){var i=this;if(i.api&&!this._locked){var e=i.api.asc_getGraphicObjectProps();if(e&&0<e.length)for(var s,o,n=e.length-1;0<=n;n--)if(s=e[n].asc_getObjectType(),o=e[n].asc_getObjectValue(),Asc.c_oAscTypeSelectElement.Image==s){new SSE.Views.ImageSettingsAdvanced({imageProps:o,api:i.api,handler:function(t,e){"ok"==t&&i.api&&i.api.asc_setGraphicObjectProps(e.imageProps),Common.NotificationCenter.trigger("edit:complete",i)}}).show();break}}}},onApiAutoShapes:function(){function e(t){i.fillAutoShapes(),t.off("show:before",e)}var i=this;i.btnChangeShape.menu.on("show:before",e)},fillAutoShapes:function(){var o=this,t=Common.localStorage.getItem("sse-recent-shapes"),e=new Common.UI.MenuItem({template:s.template('<div id="id-img-change-shape-menu" class="menu-insertshape"></div>'),index:0});o.btnChangeShape.menu.addItem(e),new Common.UI.DataViewShape({el:i("#id-img-change-shape-menu"),itemTemplate:s.template('<div class="item-shape" id="<%= id %>"><svg width="20" height="20" class="icon uni-scale"><use xlink:href="#svg-icon-<%= data.shapeType %>"></use></svg></div>'),groups:o.application.getCollection("ShapeGroups"),parentMenu:o.btnChangeShape.menu,restoreHeight:652,textRecentlyUsed:o.textRecentlyUsed,recentShapes:t?JSON.parse(t):null,hideTextRect:!0,hideLines:!0}).on("item:click",function(t,e,i,s){o.api&&(o.api.asc_changeShapeType(i.get("data").shapeType),Common.NotificationCenter.trigger("edit:complete",o)),"click"!==s.type&&o.btnCrop.menu.hide()})},ChangeSettings:function(t){var e;this._initSettings&&this.createDelayedElements(),this.disableControls(this._locked),t&&(this._originalProps=new Asc.asc_CImgProperty(t),e=t.asc_getWidth(),(.001<Math.abs(this._state.Width-e)||(null===this._state.Width||null===e)&&this._state.Width!==e)&&(this.spnWidth.setValue(null!==e?Common.Utils.Metric.fnRecalcFromMM(e):"",!0),this._state.Width=e),e=t.asc_getHeight(),(.001<Math.abs(this._state.Height-e)||(null===this._state.Height||null===e)&&this._state.Height!==e)&&(this.spnHeight.setValue(null!==e?Common.Utils.Metric.fnRecalcFromMM(e):"",!0),this._state.Height=e),0<t.asc_getHeight()&&(this._nRatio=t.asc_getWidth()/t.asc_getHeight()),e=t.asc_getLockAspect(),this._state.keepRatio!==e&&(this.btnRatio.toggle(e),this._state.keepRatio=e),this.btnOriginalSize.setDisabled(null===t.asc_getImageUrl()||void 0===t.asc_getImageUrl()||this._locked),t=t.asc_getPluginGuid(),this._state.isOleObject!==(e=null!=t)&&(this.btnSelectImage.setVisible(!e),this.btnEditObject.setVisible(e),this._state.isOleObject=e),this.btnRotate270.setDisabled(e||this._locked),this.btnRotate90.setDisabled(e||this._locked),this.btnFlipV.setDisabled(e||this._locked),this.btnFlipH.setDisabled(e||this._locked),this._state.isOleObject?(e=SSE.getCollection("Common.Collections.Plugins").findWhere({guid:t}),this.btnEditObject.setDisabled(!this.api.asc_canEditTableOleObject()&&null==e||this._locked)):this.btnSelectImage.setDisabled(null===t||this._locked))},onWidthChange:function(t,e,i,s){var o,t=t.getNumberValue(),n=this.spnHeight.getNumberValue();this.btnRatio.pressed&&((n=t/this._nRatio)>this.spnHeight.options.maxValue&&(t=(n=this.spnHeight.options.maxValue)*this._nRatio,this.spnWidth.setValue(t,!0)),this.spnHeight.setValue(n,!0)),this.api&&((o=new Asc.asc_CImgProperty).asc_putWidth(Common.Utils.Metric.fnRecalcToMM(t)),o.asc_putHeight(Common.Utils.Metric.fnRecalcToMM(n)),this.api.asc_setGraphicObjectProps(o))},onHeightChange:function(t,e,i,s){var o,t=t.getNumberValue(),n=this.spnWidth.getNumberValue();this.btnRatio.pressed&&((n=t*this._nRatio)>this.spnWidth.options.maxValue&&(t=(n=this.spnWidth.options.maxValue)/this._nRatio,this.spnHeight.setValue(t,!0)),this.spnWidth.setValue(n,!0)),this.api&&((o=new Asc.asc_CImgProperty).asc_putWidth(Common.Utils.Metric.fnRecalcToMM(n)),o.asc_putHeight(Common.Utils.Metric.fnRecalcToMM(t)),this.api.asc_setGraphicObjectProps(o))},setOriginalSize:function(){var t,e,i;this.api&&(t=(e=this.api.asc_getOriginalImageSize()).asc_getImageWidth(),e=e.asc_getImageHeight(),(i=new Asc.asc_CImgProperty).asc_putWidth(t),i.asc_putHeight(e),i.put_ResetCrop(!0),i.put_Rot(0),this.api.asc_setGraphicObjectProps(i),Common.NotificationCenter.trigger("edit:complete",this))},setImageUrl:function(t,e){var i=new Asc.asc_CImgProperty;i.asc_putImageUrl(t,e),this.api.asc_setGraphicObjectProps(i)},insertImageFromStorage:function(t){t&&t._urls&&"change"==t.c&&this.setImageUrl(t._urls[0],t.token)},onImageSelect:function(t,e){var i;1==e.value?(i=this,new Common.Views.ImageFromUrlDialog({handler:function(t,e){"ok"==t&&i.api&&(t=e.replace(/ /g,""),s.isEmpty(t)||i.setImageUrl(t)),Common.NotificationCenter.trigger("edit:complete",i)}}).show()):2==e.value?Common.NotificationCenter.trigger("storage:image-load","change"):this._isFromFile||(this._isFromFile=!0,this.api&&this.api.asc_changeImageFromFile(),Common.NotificationCenter.trigger("edit:complete",this),this._isFromFile=!1)},_changeCropState:function(t){this._state.cropMode=t,this.btnCrop&&(this.btnCrop.toggle(t,!0),this.btnCrop.menu.items[0].setChecked(t,!0))},onCrop:function(t,e){this.api&&(t.pressed?this.api.asc_startEditCrop():this.api.asc_endEditCrop()),Common.NotificationCenter.trigger("edit:complete",this)},onCropMenu:function(t,e){this.api&&(1==e.value?this.api.asc_cropFill():2==e.value?this.api.asc_cropFit():e.checked?this.api.asc_startEditCrop():this.api.asc_endEditCrop()),Common.NotificationCenter.trigger("edit:complete",this)},onBtnRotateClick:function(t){var e=new Asc.asc_CImgProperty;e.asc_putRotAdd(3.14159265358979*(1==t.options.value?90:270)/180),this.api.asc_setGraphicObjectProps(e),Common.NotificationCenter.trigger("edit:complete",this)},onBtnFlipClick:function(t){var e=new Asc.asc_CImgProperty;1==t.options.value?e.asc_putFlipHInvert(!0):e.asc_putFlipVInvert(!0),this.api.asc_setGraphicObjectProps(e),Common.NotificationCenter.trigger("edit:complete",this)},setLocked:function(t){this._locked=t},disableControls:function(e){this._initSettings||(this._state.DisabledControls!==e&&(this._state.DisabledControls=e,s.each(this.lockedControls,function(t){t.setDisabled(e)}),this.linkAdvanced.toggleClass("disabled",e)),this.btnCrop.setDisabled(e||!this.api.asc_canEditCrop()))}},SSE.Views.ImageSettings||{}))}),define("text!spreadsheeteditor/main/app/template/ChartSettings.template",[],function(){return'<table cols="3" id="chart-panel-size">\n    <tr>\n        <td colspan=3>\n            <label class="header"><%= scope.textSize %></label>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" width="88px">\n            <label class="input-label"><%= scope.textWidth %></label>\n            <div id="chart-spin-width"></div>\n        </td>\n        <td class="padding-small" width="28px" style="vertical-align: bottom;">\n            <div id="chart-button-ratio"></div>\n        </td>\n        <td class="padding-small" width="88px">\n            <label class="input-label"><%= scope.textHeight %></label>\n            <div id="chart-spin-height"></div>\n        </td>\n    </tr>\n</table>\n<table cols="1" id="chart-panel-types">\n    <tr>\n        <td class="padding-small">\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr class="not-combined">\n        <td class="padding-large">\n            <label class="header" style=""><%= scope.textStyle %></label>\n            <div class="" id="chart-combo-style" style="width: 100%;"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <div id="chart-btn-change-type" style="width:100%;"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <div id="chart-btn-select-data" style="width:100%;"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <div id="chart-btn-switch" style="width:100%;"></div>\n        </td>\n    </tr>\n</table>\n<table cols="1" id="chart-panel-3d-rotate">\n    <tr>\n        <td class="padding-small">\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <label class="header"><%= scope.text3dRotation %></label>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <label class="fixed" style="margin-top: 3px;width: 88px;"><%= scope.textX %></label>\n            <div id="chart-btn-x-right" style="display: inline-block;" class="float-right margin-left-4"></div>\n            <div id="chart-btn-x-left" style="display: inline-block;" class="float-right margin-left-4"></div>\n            <div id="chart-spin-x" style="display: inline-block;" class="float-right"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <label class="fixed" style="margin-top: 3px;width: 88px;"><%= scope.textY %></label>\n            <div id="chart-btn-y-down" style="display: inline-block;" class="float-right margin-left-4"></div>\n            <div id="chart-btn-y-up" style="display: inline-block;" class="float-right margin-left-4"></div>\n            <div id="chart-spin-y" style="display: inline-block;" class="float-right"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <label class="fixed" style="margin-top: 3px;width: 88px;"><%= scope.textPerspective %></label>\n            <div id="chart-btn-widen" style="display: inline-block;" class="float-right margin-left-4"></div>\n            <div id="chart-btn-narrow" style="display: inline-block;" class="float-right margin-left-4"></div>\n            <div id="chart-spin-persp" style="display: inline-block;" class="float-right"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <div id="chart-checkbox-right-angle"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <div id="chart-checkbox-autoscale"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <label class="fixed" style="margin-top: 3px;width: 122px;"><%= scope.text3dDepth %></label>\n            <div id="chart-spin-3d-depth" style="display: inline-block;" class="float-right"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <label class="fixed" style="margin-top: 3px;width: 122px;"><%= scope.text3dHeight %></label>\n            <div id="chart-spin-3d-height" style="display: inline-block;" class="float-right"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <label class="link" id="chart-def-rotate-link" data-hint="1" data-hint-direction="bottom" data-hint-offset="medium"><%= scope.textDefault %></label>\n        </td>\n    </tr>\n</table>\n<table cols="1" id="spark-panel-types">\n    <tr>\n        <td>\n            <label class="header"><%= scope.textType %></label>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <div id="spark-button-type" style=""></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr>\n        <td>\n            <label class="header"><%= scope.textStyle %></label>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <label class="input-label" style=""><%= scope.strTemplate %></label>\n            <div class="" id="spark-combo-style" style="width: 100%;"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <div style="display:inline-block;vertical-align: middle;width:55px;">\n                <label class="input-label" style=""><%= scope.strSparkColor %></label>\n                <div id="spark-color-btn" style=""></div>\n            </div>\n            <div style="display:inline-block;vertical-align: middle;">\n                <label class="input-label" style=""><%= scope.strLineWeight %></label>\n                <div id="spark-combo-line-type" style="width: 93px;"></div>\n            </div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n</table>\n<table cols="1" id="spark-panel-points">\n    <tr>\n        <td class="padding-small">\n            <label class="header" style="margin-bottom: 4px;"><%= scope.textShow %></label>\n            <div style="width: 100%; height: 25px; margin-bottom: 8px;">\n                <div id="spark-checkbox-high" style="display: inline-block;margin-top: 4px;"></div>\n                <div id="spark-high-color-btn" style="display: inline-block;" class="float-right"></div>\n            </div>\n            <div style="width: 100%; height: 25px; margin-bottom: 8px;">\n                <div id="spark-checkbox-low" style="display: inline-block;margin-top: 4px;"></div>\n                <div id="spark-low-color-btn" style="display: inline-block;" class="float-right"></div>\n            </div>\n            <div style="width: 100%; height: 25px; margin-bottom: 8px;">\n                <div id="spark-checkbox-negative" style="display: inline-block;margin-top: 4px;"></div>\n                <div id="spark-negative-color-btn" style="display: inline-block;" class="float-right"></div>\n            </div>\n            <div style="width: 100%; height: 25px; margin-bottom: 8px;">\n                <div id="spark-checkbox-first" style="display: inline-block;margin-top: 4px;"></div>\n                <div id="spark-first-color-btn" style="display: inline-block;" class="float-right"></div>\n            </div>\n            <div style="width: 100%; height: 25px; margin-bottom: 8px;">\n                <div id="spark-checkbox-last" style="display: inline-block;margin-top: 4px;"></div>\n                <div id="spark-last-color-btn" style="display: inline-block;" class="float-right"></div>\n            </div>\n            <div style="width: 100%; height: 25px;">\n                <div id="spark-checkbox-markers" style="display: inline-block;margin-top: 4px;"></div>\n                <div id="spark-markers-color-btn" style="display: inline-block;" class="float-right"></div>\n            </div>\n        </td>\n    </tr>\n</table>\n<table cols="1">\n    <tr>\n        <td class="padding-small">\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr>\n        <td align="center">\n            <label class="link" id="chart-advanced-link" data-hint="1" data-hint-direction="bottom" data-hint-offset="medium"><%= scope.textAdvanced %></label>\n        </td>\n    </tr>\n    <tr class="finish-cell"></tr>\n</table>'}),define("text!spreadsheeteditor/main/app/template/ChartSettingsDlg.template",[],function(){return'<div id="id-chart-settings-dlg-style" class="settings-panel active">\n    <div class="inner-content">\n        <table cols="1" style="">\n            <tr>\n                <td class="padding-large">\n                    <label class="header"><%= scope.textType %></label>\n                    <div id="chart-dlg-button-type" class="margin-right-15"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-chart-settings-dlg-layout" class="settings-panel">\n    <div class="inner-content">\n        <table cols="2" style="width: 100%;">\n            <tr>\n                <td class="padding-small" width="50%">\n                    <label class="input-label"><%= scope.textChartTitle %></label>\n                    <div id="chart-dlg-combo-chart-title" class="input-group-nr margin-right-7"></div>\n                </td>\n                <td class="padding-small" width="50%">\n                    <label class="input-label margin-left-7"><%= scope.textLegendPos %></label>\n                    <div id="chart-dlg-combo-legend-pos" class="input-group-nr margin-left-7"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small" width="50%">\n                    <label class="input-label"><%= scope.textDataLabels %></label>\n                    <div id="chart-dlg-combo-data-labels" class="input-group-nr margin-right-7"></div>\n                </td>\n                <td rowspan="2" class="padding-small" width="50%">\n                    <div id="chart-dlg-check-series"></div>\n                    <div id="chart-dlg-check-category"></div>\n                    <div id="chart-dlg-check-value"></div>\n                    <div id="chart-dlg-check-percent"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small" width="50%">\n                    <label class="input-label"><%= scope.textSeparator %></label>\n                    <div id="chart-dlg-txt-separator" class="input-row margin-right-7"></div>\n                </td>\n            </tr>\n            <tr>\n                <td width="50%">\n                    <label id="chart-dlg-label-lines" class="input-label"><%= scope.textLines %></label>\n                    <div id="chart-dlg-combo-lines" class="input-group-nr margin-right-7"></div>\n                </td>\n                <td style="vertical-align: bottom;" width="50%">\n                    <div id="chart-dlg-check-markers" class="margin-left-7"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-chart-settings-dlg-vert" class="settings-panel">\n</div>\n<div id="id-chart-settings-dlg-vert-sec" class="settings-panel">\n</div>\n<div id="id-chart-settings-dlg-hor" class="settings-panel">\n</div>\n<div id="id-chart-settings-dlg-hor-sec" class="settings-panel">\n</div>\n<div id="id-spark-settings-dlg-style" class="settings-panel">\n    <div class="inner-content padding-large">\n        <table cols="2" style="">\n            <tr>\n                <td class="padding-large">\n                    <label class="header"><%= scope.textType %></label>\n                    <div id="spark-dlg-button-type" class="margin-right-15"></div>\n                </td>\n                <td class="padding-large">\n                    <label class="header"><%= scope.textStyle %></label>\n                    <div id="spark-dlg-combo-style" style="width: 190px;"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n    <div class="inner-content">\n        <table cols="2" style="width: 100%;">\n            <tr>\n                <td colspan=2 class="padding-small">\n                    <label class="header"><%= scope.textEmptyCells %></label>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small" width="230">\n                    <label class="input-label"><%= scope.textShowEmptyCells %></label>\n                    <div id="spark-dlg-combo-empty" class="input-group-nr margin-right-10"></div>\n                </td>\n                <td></td>\n            </tr>\n            <tr>\n                <td colspan=2>\n                    <div id="spark-dlg-check-show-data"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-spark-settings-dlg-axis" class="settings-panel">\n    <div class="inner-content">\n        <div class="padding-large" >\n            <label class="header padding-small" style="display: block;"><%= scope.textHorAxis %></label>\n            <div id="spark-dlg-check-show" class="padding-small" style="display: block;"></div>\n            <div id="spark-dlg-check-reverse" class="padding-small" style="display: block;"></div>\n        </div>\n        <table cols="3" style="width: 100%">\n            <tr>\n                <td colspan="3">\n                    <label class="header  padding-small"><%= scope.textVertAxis %></label>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small" width="100">\n                    <label class="input-label"><%= scope.textMinValue %></label>\n                </td>\n                <td class="padding-small padding-right-10" width="115">\n                    <div id="spark-dlg-combo-mintype"></div>\n                </td>\n                <td class="padding-small" width="90">\n                    <div id="spark-dlg-input-min-value"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-large" width="100">\n                    <label class="input-label"><%= scope.textMaxValue %></label>\n                </td>\n                <td class="padding-large padding-right-10" width="115">\n                    <div id="spark-dlg-combo-maxtype"></div>\n                </td>\n                <td class="padding-large" width="90">\n                    <div id="spark-dlg-input-max-value"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-chart-settings-dlg-snap" class="settings-panel">\n    <div class="inner-content">\n        <table cols="1">\n            <tr>\n                <td class="padding-small">\n                    <div id="chart-dlg-radio-twocell"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="chart-dlg-radio-onecell"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="chart-dlg-radio-absolute"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-chart-settings-dlg-alttext" class="settings-panel">\n    <div class="inner-content">\n        <table cols="1" width="100%">\n            <tr>\n                <td class="padding-large">\n                    <label class="header"><%= scope.textAltTitle %></label>\n                    <div id="chart-advanced-alt-title"></div>\n                </td>\n            </tr>\n            <tr>\n                <td>\n                    <label class="header"><%= scope.textAltDescription %></label>\n                    <textarea id="chart-advanced-alt-description" class="form-control" style="width: 100%; height: 120px;"></textarea>\n                </td>\n            </tr>\n            <tr>\n                <td>\n                    <label><%= scope.textAltTip %></label>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>'}),define("text!spreadsheeteditor/main/app/template/ChartVertAxis.template",[],function(){return'<div class="inner-content">\n    <table cols="2" style="width: 100%">\n        <tr>\n            <td colspan="2" class="padding-small">\n                <div id="chart-dlg-chk-vert-hide-<%=idx%>" class="input-group-nr"></div>\n            </td>\n        </tr>\n        <tr>\n            <td class="padding-large">\n                <label class="input-label"><%= scope.textAxisTitle %></label>\n                <div id="chart-dlg-combo-vert-title-<%=idx%>" class="input-group-nr"></div>\n            </td>\n            <td class="padding-large">\n                <label class="input-label margin-left-15"><%= scope.textGridLines %></label>\n                <div id="chart-dlg-combo-vert-grid-<%=idx%>" class="input-group-nr margin-left-15"></div>\n            </td>\n        </tr>\n    </table>\n    <table cols="3" style="width: 100%">\n        <tr>\n            <td class="padding-small" width="100">\n                <label class="input-label"><%= scope.textMinValue %></label>\n            </td>\n            <td class="padding-small padding-right-10" width="115">\n                <div id="chart-dlg-combo-mintype-<%=idx%>"></div>\n            </td>\n            <td class="padding-small" width="90">\n                <div id="chart-dlg-input-min-value-<%=idx%>"></div>\n            </td>\n        </tr>\n        <tr>\n            <td class="padding-small" width="100">\n                <label class="input-label"><%= scope.textMaxValue %></label>\n            </td>\n            <td class="padding-small padding-right-10" width="115">\n                <div id="chart-dlg-combo-maxtype-<%=idx%>"></div>\n            </td>\n            <td class="padding-small" width="90">\n                <div id="chart-dlg-input-max-value-<%=idx%>"></div>\n            </td>\n        </tr>\n        <tr>\n            <td class="padding-large" width="100">\n                <label class="input-label"><%= scope.textAxisCrosses %></label>\n            </td>\n            <td class="padding-large padding-right-10" width="115">\n                <div id="chart-dlg-combo-v-crosstype-<%=idx%>"></div>\n            </td>\n            <td class="padding-large" width="90">\n                <div id="chart-dlg-input-v-axis-crosses-<%=idx%>"></div>\n            </td>\n        </tr>\n    </table>\n    <table cols="2">\n        <tr>\n            <td class="padding-small padding-right-10" style="min-width: 100px;">\n                <label class="input-label"><%= scope.textUnits %></label>\n            </td>\n            <td class="padding-small padding-right-10" width="115">\n                <div id="chart-dlg-combo-units-<%=idx%>"></div>\n            </td>\n        </tr>\n    </table>\n</div>\n<div class="inner-content">\n    <table cols="2" style="width: 100%;">\n        <tr>\n            <td colspan=2 class="padding-small">\n                <div id="chart-dlg-check-v-reverse-<%=idx%>"></div>\n            </td>\n        </tr>\n        <tr>\n            <td class="padding-large">\n                <div id="chart-dlg-check-v-logscale-<%=idx%>"></div>\n            </td>\n            <td class="padding-large">\n                <div class="base float-right">\n                    <label class="input-label"><%= scope.textBase %></label>\n                    <div id="chart-dlg-input-base-<%=idx%>" class="margin-left-5" style="display: inline-block;"></div>\n                </div>\n            </td>\n        </tr>\n    </table>\n</div>\n<div class="inner-content">\n    <table cols="2" style="width: 100%;">\n        <tr>\n            <td colspan=2 class="padding-small">\n                <label class="header"><%= scope.textTickOptions %></label>\n            </td>\n        </tr>\n        <tr>\n            <td class="padding-large">\n                <label class="input-label"><%= scope.textMajorType %></label>\n                <div id="chart-dlg-combo-v-major-type-<%=idx%>" class="input-group-nr"></div>\n            </td>\n            <td class="padding-large">\n                <label class="input-label margin-left-15"><%= scope.textMinorType %></label>\n                <div id="chart-dlg-combo-v-minor-type-<%=idx%>" class="input-group-nr margin-left-15"></div>\n            </td>\n        </tr>\n        <tr>\n            <td colspan=2 class="padding-small">\n                <label class="header"><%= scope.textLabelOptions %></label>\n            </td>\n        </tr>\n        <tr>\n            <td>\n                <label class="input-label"><%= scope.textLabelPos %></label>\n            </td>\n            <td>\n            </td>\n        </tr>\n        <tr>\n            <td>\n                <div id="chart-dlg-combo-v-label-pos-<%=idx%>" class="input-group-nr"></div>\n            </td>\n            <td>\n                <button type="button" class="btn btn-text-default auto margin-left-15" id="chart-dlg-btn-v-format-<%=idx%>" style="min-width: 100px;"><%= scope.textFormat %></button>\n            </td>\n        </tr>\n    </table>\n</div>'}),define("text!spreadsheeteditor/main/app/template/ChartHorAxis.template",[],function(){return'<div class="inner-content">\n    <table cols="2" style="width: 100%">\n        <tr>\n            <td colspan="2" class="padding-small">\n                <div id="chart-dlg-chk-hor-hide-<%=idx%>" class="input-group-nr"></div>\n            </td>\n        </tr>\n        <tr>\n            <td class="padding-large">\n                <label class="input-label"><%= scope.textAxisTitle %></label>\n                <div id="chart-dlg-combo-hor-title-<%=idx%>" class="input-group-nr"></div>\n            </td>\n            <td class="padding-large">\n                <label class="input-label margin-left-15"><%= scope.textGridLines %></label>\n                <div id="chart-dlg-combo-hor-grid-<%=idx%>" class="input-group-nr margin-left-15"></div>\n            </td>\n        </tr>\n    </table>\n    <table cols="3" style="width: 100%">\n        <tr>\n            <td class="padding-small" width="100">\n                <label class="input-label"><%= scope.textAxisCrosses %></label>\n            </td>\n            <td class="padding-small padding-right-10" width="115">\n                <div id="chart-dlg-combo-h-crosstype-<%=idx%>"></div>\n            </td>\n            <td class="padding-small" width="90">\n                <div id="chart-dlg-input-h-axis-crosses-<%=idx%>"></div>\n            </td>\n        </tr>\n        <tr>\n            <td class="padding-large" width="100">\n                <label class="input-label"><%= scope.textAxisPos %></label>\n            </td>\n            <td colspan=2 class="padding-large">\n                <div id="chart-dlg-combo-axis-pos-<%=idx%>" class="input-group-nr" style="width:140px;"></div>\n            </td>\n        </tr>\n        <tr>\n            <td colspan=3 class="padding-large">\n                <div id="chart-dlg-check-h-reverse-<%=idx%>"></div>\n            </td>\n        </tr>\n    </table>\n</div>\n<div class="inner-content">\n    <table cols="2" style="width: 100%;">\n        <tr>\n            <td colspan=2 class="padding-small">\n                <label class="header"><%= scope.textTickOptions %></label>\n            </td>\n        </tr>\n        <tr>\n            <td class="padding-small" width="140">\n                <label class="input-label"><%= scope.textMajorType %></label>\n                <div id="chart-dlg-combo-h-major-type-<%=idx%>" class="input-group-nr"></div>\n            </td>\n            <td class="padding-small">\n                <label class="input-label margin-left-15"><%= scope.textMinorType %></label>\n                <div id="chart-dlg-combo-h-minor-type-<%=idx%>" class="input-group-nr margin-left-15"></div>\n            </td>\n        </tr>\n        <tr>\n            <td width="100%" colspan="2">\n                <label class="input-label"><%= scope.textMarksInterval %></label>\n            </td>\n        </tr>\n        <tr>\n            <td class="padding-large" width="140">\n                <div id="chart-dlg-input-marks-interval-<%=idx%>"></div>\n            </td>\n            <td class="padding-large">\n            </td>\n        </tr>\n    </table>\n</div>\n<div class="inner-content">\n    <table cols="2" style="width: 100%;">\n        <tr>\n            <td colspan=2 class="padding-small">\n                <label class="header"><%= scope.textLabelOptions %></label>\n            </td>\n        </tr>\n        <tr>\n            <td class="padding-small" width="140">\n                <label class="input-label"><%= scope.textLabelPos %></label>\n                <div id="chart-dlg-combo-h-label-pos-<%=idx%>" class="input-group-nr"></div>\n            </td>\n            <td class="padding-small">\n                <label class="input-label margin-left-15"><%= scope.textLabelDist %></label>\n                <div id="chart-dlg-input-label-dist-<%=idx%>" class="margin-left-15"></div>\n            </td>\n        </tr>\n        <tr>\n            <td width="100%" colspan="2">\n                <label class="input-label"><%= scope.textLabelInterval %></label>\n            </td>\n        </tr>\n        <tr>\n            <td width="100%" colspan="2">\n                <div id="chart-dlg-combo-label-int-<%=idx%>" class="input-group-nr" style="display: inline-block;width: 100px;vertical-align: middle;"></div>\n                <div id="chart-dlg-input-label-int-<%=idx%>" class="margin-left-3" style="display: inline-block;width: 60px;vertical-align: middle;"></div>\n                <button type="button" class="btn btn-text-default auto float-right margin-left-5" id="chart-dlg-btn-h-format-<%=idx%>" style="min-width:100px; vertical-align: middle;"><%= scope.textFormat %></button>\n            </td>\n        </tr>\n    </table>\n</div>'}),void 0===Common&&(Common={}),define("spreadsheeteditor/main/app/view/CellRangeDialog",["common/main/lib/component/InputField","common/main/lib/component/Window"],function(){"use strict";SSE.Views.CellRangeDialog=Common.UI.Window.extend(_.extend({options:{width:350,cls:"modal-dlg",modal:!1,buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:this.txtTitle},t),this.template=['<div class="box">','<div id="id-dlg-cell-range" class="input-row" style="margin-bottom: 5px;"></div>',"</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this.getChild();this.inputRange=new Common.UI.InputField({el:$("#id-dlg-cell-range"),name:"range",style:"width: 100%;",allowBlank:this.options.allowBlank||!1,blankError:this.txtEmpty,validateOnChange:!0}),t.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.on("close",_.bind(this.onClose,this))},onPrimary:function(){return this._handleInput("ok"),!1},setSettings:function(e){var i=this;this.settings=e,this.inputRange.setValue(e.range||""),void 0===e.type&&(e.type=Asc.c_oAscSelectionDialogType.Chart),e.api&&(i.api=e.api,i.wrapEvents={onApiRangeChanged:_.bind(i.onApiRangeChanged,i)},i.api.asc_setSelectionDialogMode(e.type,e.range||""),i.api.asc_registerCallback("asc_onSelectionRangeChanged",i.wrapEvents.onApiRangeChanged),Common.NotificationCenter.trigger("cells:range",e.type)),i.inputRange.validation=function(t){return e.validation?e.validation.call(i,t):(e.type===Asc.c_oAscSelectionDialogType.Function&&(e.argvalues[e.argindex]=t,i.api.asc_insertArgumentsInFormula(e.argvalues)),(e.type===Asc.c_oAscSelectionDialogType.Function||i.api.asc_checkDataRange(e.type,t,!1))!=Asc.c_oAscError.ID.DataRangeError||i.txtInvalidRange)},e.type==Asc.c_oAscSelectionDialogType.Function&&(_.delay(function(){i.inputRange._input.focus(),e.selection&&(i.inputRange._input[0].selectionStart=e.selection.start,i.inputRange._input[0].selectionEnd=e.selection.end)},10),i.inputRange._input.on("focus",function(){i._addedTextLength=0,i.api.asc_cleanSelectRange()}))},getSettings:function(){return this.inputRange.getValue()},onApiRangeChanged:function(t){var e,i,s,o,n;this.settings.type==Asc.c_oAscSelectionDialogType.Function?(n=this._addedTextLength||0,e=this.inputRange.getValue(),s=(i=this.inputRange._input[0]).selectionStart-n,o=i.selectionEnd,n=0<s&&0==n&&!this.api.asc_canEnterWizardRange(e.charAt(s-1))?"+":"",this._addedTextLength=t.length,e=e.substring(0,s)+n+t+e.substring(o,e.length),this.inputRange.setValue(e),i.selectionStart=i.selectionEnd=s+n.length+this._addedTextLength,this.settings.argvalues[this.settings.argindex]=e,this.api.asc_insertArgumentsInFormula(this.settings.argvalues)):this.settings.type==Asc.c_oAscSelectionDialogType.DataValidation||this.settings.type==Asc.c_oAscSelectionDialogType.ConditionalFormattingRule?this.inputRange.setValue("="+t):this.inputRange.setValue(t),this.inputRange.cmpEl.hasClass("error")&&this.inputRange.cmpEl.removeClass("error")},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onClose:function(t){this.api&&(this.api.asc_setSelectionDialogMode(Asc.c_oAscSelectionDialogType.None),this.api.asc_unregisterCallback("asc_onSelectionRangeChanged",this.wrapEvents.onApiRangeChanged)),Common.NotificationCenter.trigger("cells:range",Asc.c_oAscSelectionDialogType.None),SSE.getController("RightMenu").SetDisabled(!1)},_handleInput:function(t){if(this.options.handler){if("ok"==t&&!0!==this.inputRange.checkValidate())return;if(this.options.handler.call(this,this,t))return}this.close()},show:function(){Common.UI.Window.prototype.show.call(this),SSE.getController("RightMenu").SetDisabled(!0)}},SSE.Views.CellRangeDialog||{}))}),void 0===Common&&(Common={}),define("spreadsheeteditor/main/app/view/ChartDataRangeDialog",["common/main/lib/component/InputField","common/main/lib/component/Window"],function(){"use strict";SSE.Views.ChartDataRangeDialog=Common.UI.Window.extend(_.extend({options:{type:0,width:350,cls:"modal-dlg",buttons:["ok","cancel"]},initialize:function(t){this.type=t.type||0,this.isScatter=t.isScatter,_.extend(this.options,{title:1==this.type?this.txtTitleSeries:this.txtTitleCategory},t),this.template=['<div class="box">','<table cols="2" style="width: 100%;">',"<tr>",'<td colspan="2">',"<label>"+(1==this.type?this.txtSeriesName:this.txtAxisLabel)+"</label>","</td>","</tr>","<tr>",'<td style="padding-bottom: 8px;width: 100%;">','<div id="id-dlg-chart-range-range1"></div>',"</td>",'<td style="padding-bottom: 8px;">','<label id="id-dlg-chart-range-lbl1" class="margin-left-5" style="width: 120px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; margin-top: 4px;">'+this.txtChoose+"</label>","</td>","</tr>","<% if (type==1) { %>","<tr>",'<td colspan="2">',"<label>"+(this.isScatter?this.txtXValues:this.txtValues)+"</label>","</td>","</tr>","<tr>",'<td style="padding-bottom: 8px;width: 100%;">','<div id="id-dlg-chart-range-range2"></div>',"</td>",'<td style="padding-bottom: 8px;">','<label id="id-dlg-chart-range-lbl2" class="margin-left-5" style="width: 120px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; margin-top: 4px;"></label>',"</td>","</tr>","<% if (isScatter) { %>","<tr>",'<td colspan="2">',"<label>"+this.txtYValues+"</label>","</td>","</tr>","<tr>",'<td style="padding-bottom: 8px;width: 100%;">','<div id="id-dlg-chart-range-range3"></div>',"</td>",'<td style="padding-bottom: 8px;">','<label id="id-dlg-chart-range-lbl3" class="margin-left-5" style="width: 120px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; margin-top: 4px;"></label>',"</td>","</tr>","<% } %>","<% } %>","</table>","</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this.getChild(),o=this;o.inputRange1=new Common.UI.InputFieldBtn({el:$("#id-dlg-chart-range-range1"),style:"100%",btnHint:this.textSelectData,validateOnBlur:!1}).on("changed:after",function(t,e,i,s){e!=i&&o.updateRangeData(1,e)}).on("changing",function(t,e,i,s){}).on("button:click",_.bind(this.onSelectData,this,1)),this.lblRange1=t.find("#id-dlg-chart-range-lbl1"),o.inputRange2=new Common.UI.InputFieldBtn({el:$("#id-dlg-chart-range-range2"),style:"100%",btnHint:this.textSelectData,validateOnBlur:!1}).on("changed:after",function(t,e,i,s){e!=i&&o.updateRangeData(2,e)}).on("changing",function(t,e,i,s){}).on("button:click",_.bind(this.onSelectData,this,2)),this.lblRange2=t.find("#id-dlg-chart-range-lbl2"),o.inputRange3=new Common.UI.InputFieldBtn({el:$("#id-dlg-chart-range-range3"),style:"100%",btnHint:this.textSelectData,validateOnBlur:!1}).on("changed:after",function(t,e,i,s){e!=i&&o.updateRangeData(3,e)}).on("changing",function(t,e,i,s){}).on("button:click",_.bind(this.onSelectData,this,3)),this.lblRange3=t.find("#id-dlg-chart-range-lbl3"),t.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this))},getFocusedComponents:function(){return[this.inputRange1,this.inputRange2,this.inputRange3]},getDefaultFocusableComponent:function(){if(!this._alreadyRendered)return this._alreadyRendered=!0,this.inputRange1},onPrimary:function(){return this._handleInput("ok"),!1},setSettings:function(t){var e;this.api=t.api,this.props=t.props,this.chartSettings=t.chartSettings,1==this.type?this.props.series&&(t=this.props.series,this.inputRange1.setValue(t.asc_getName()),this.lblRange1.text(""!==this.inputRange1.getValue()?"= "+(t.asc_getNameVal()||""):this.txtChoose),this.props.isScatter?(e=t.asc_getXValuesArr(),this.inputRange2.setValue(t.asc_getXValues()),this.lblRange2.text(""!==this.inputRange2.getValue()?"= "+(e?e.join("; "):""):this.txtChoose),this.inputRange3.setValue(t.asc_getYValues()),e=t.asc_getYValuesArr(),this.lblRange3.text(""!==this.inputRange3.getValue()?"= "+(e?e.join("; "):""):this.txtChoose)):(e=t.asc_getValuesArr(),this.inputRange2.setValue(t.asc_getValues()),this.lblRange2.text(""!==this.inputRange2.getValue()?"= "+(e?e.join("; "):""):this.txtChoose))):(e=this.props.values,this.inputRange1.setValue(this.props.category||""),this.lblRange1.text(""!==this.inputRange1.getValue()?"= "+(e?e.join("; "):""):this.txtChoose))},getSettings:function(){return{name:this.inputRange1.getValue(),valuesX:this.inputRange2.getValue(),valuesY:this.inputRange3.getValue()}},onSelectData:function(i,s){var t,e,o=this;o.api&&(t=new SSE.Views.CellRangeDialog({allowBlank:!0,handler:function(t,e){"ok"==e&&(s.setValue(t.getSettings()),_.delay(function(){o.updateRangeData(i,t.getSettings())},10))}}).on("close",function(){o.show(),_.delay(function(){o._noApply=!0,s.focus(),o._noApply=!1},1)}),e=o.$window.offset(),o.hide(),t.show(e.left+65,e.top+77),t.setSettings({api:o.api,range:_.isEmpty(s.getValue())?"":s.getValue(),type:Asc.c_oAscSelectionDialogType.Chart,validation:function(){return!0}}))},isRangeValid:function(t,e){var i;switch(t){case 1:i=this.props.series?this.props.series.asc_IsValidName(e):this.chartSettings.isValidCatFormula(e);break;case 2:i=this.props.isScatter?this.props.series.asc_IsValidXValues(e):this.props.series.asc_IsValidValues(e);break;case 3:i=this.props.series.asc_IsValidYValues(e)}if(!0===i||i==Asc.c_oAscError.ID.No)return!0;var s=this.textInvalidRange;switch(i){case Asc.c_oAscError.ID.StockChartError:s=this.errorStockChart;break;case Asc.c_oAscError.ID.MaxDataSeriesError:s=this.errorMaxRows;break;case Asc.c_oAscError.ID.MaxDataPointsError:s=this.errorMaxPoints;break;case Asc.c_oAscError.ID.ErrorInFormula:s=this.errorInFormula;break;case Asc.c_oAscError.ID.InvalidReference:s=this.errorInvalidReference;break;case Asc.c_oAscError.ID.NoSingleRowCol:s=this.errorNoSingleRowCol;break;case Asc.c_oAscError.ID.NoValues:s=this.errorNoValues}return Common.UI.warning({msg:s,maxwidth:600}),!1},updateRangeData:function(t,e){if(this.isRangeValid(t,e))if(this.props.series){var i=this.props.series;switch(t){case 1:i.asc_setName(e),this.lblRange1.text(""!==this.inputRange1.getValue()?"= "+(i.asc_getNameVal()||""):this.txtChoose);break;case 2:this.isScatter?(s=i.asc_getXValuesArr(),i.asc_setXValues(e)):(s=i.asc_getValuesArr(),i.asc_setValues(e)),this.lblRange2.text(""!==this.inputRange2.getValue()?"= "+(s?s.join("; "):""):this.txtChoose);break;case 3:var s=i.asc_getYValuesArr();i.asc_setYValues(e),this.lblRange3.text(""!==this.inputRange3.getValue()?"= "+(s?s.join("; "):""):this.txtChoose)}}else{this.chartSettings.setCatFormula(e);s=this.chartSettings.getCatValues();this.lblRange1.text(""!==this.inputRange1.getValue()?"= "+(s?s.join("; "):""):this.txtChoose)}},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},_handleInput:function(t){if(this.options.handler){if("ok"==t){if(!this.isRangeValid(1,this.inputRange1.getValue()))return;if(1==this.type&&!this.isRangeValid(2,this.inputRange2.getValue()))return;if(1==this.type&&this.isScatter&&!this.isRangeValid(3,this.inputRange3.getValue()))return}if(this.options.handler.call(this,this,t))return}this.close()}},SSE.Views.ChartDataRangeDialog||{}))}),define("spreadsheeteditor/main/app/view/ChartSettingsDlg",["text!spreadsheeteditor/main/app/template/ChartSettingsDlg.template","text!spreadsheeteditor/main/app/template/ChartVertAxis.template","text!spreadsheeteditor/main/app/template/ChartHorAxis.template","common/main/lib/view/AdvancedSettingsWindow","common/main/lib/component/CheckBox","common/main/lib/component/InputField","spreadsheeteditor/main/app/view/CellRangeDialog","spreadsheeteditor/main/app/view/ChartDataRangeDialog","spreadsheeteditor/main/app/view/FormatSettingsDialog"],function(t,i,n){"use strict";SSE.Views.ChartSettingsDlg=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:327,height:535,toggleGroup:"chart-settings-dlg-group",storageName:"sse-chart-settings-adv-category"},initialize:function(i){_.extend(this.options,{title:this.textTitle,items:[{panelId:"id-chart-settings-dlg-style",panelCaption:this.textType},{panelId:"id-chart-settings-dlg-layout",panelCaption:this.textLayout},{panelId:"id-chart-settings-dlg-vert",panelCaption:this.textVertAxis},{panelId:"id-chart-settings-dlg-vert-sec",panelCaption:this.textVertAxisSec},{panelId:"id-chart-settings-dlg-hor",panelCaption:this.textHorAxis},{panelId:"id-chart-settings-dlg-hor-sec",panelCaption:this.textHorAxisSec},{panelId:"id-spark-settings-dlg-style",panelCaption:this.textTypeData},{panelId:"id-spark-settings-dlg-axis",panelCaption:this.textAxisOptions},{panelId:"id-chart-settings-dlg-snap",panelCaption:this.textSnap},{panelId:"id-chart-settings-dlg-alttext",panelCaption:this.textAlt}],contentTemplate:_.template(t)({scope:this})},i),this.options.handler=function(t,e){if("ok"==t&&!this.isRangeValid())return!0;i.handler&&i.handler.call(this,t,e)},Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options),this._state={ChartType:Asc.c_oAscChartTypeSettings.barNormal,SparkType:-1},this._noApply=!0,this._changedProps=null,this._changedImageProps=null,this.api=this.options.api,this.chartSettings=this.options.chartSettings,this.imageSettings=this.options.imageSettings,this.sparklineStyles=this.options.sparklineStyles,this.isChart=this.options.isChart,this.isDiagramMode=!!this.options.isDiagramMode,this.vertAxisProps=[],this.vertAxisPropsIndexes=[],this.horAxisProps=[],this.horAxisPropsIndexes=[],this.currentAxisProps=[],this.dataRangeValid="",this.sparkDataRangeValid="",this.dataLocationRangeValid="",this.currentChartType=this._state.ChartType,this.storageName=this.isChart?"sse-chart-settings-adv-category":"sse-spark-settings-adv-category"},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var e=this;this.getChild();this.isDiagramMode&&(this.btnChartType=new Common.UI.Button({cls:"btn-large-dataview",iconCls:"svgicon chart-bar-normal",menu:new Common.UI.Menu({style:"width: 364px;",additionalAlign:this.menuAddAlign,items:[{template:_.template('<div id="id-chart-dlg-menu-type" class="menu-insertchart"></div>')}]})}),this.btnChartType.on("render:after",function(t){e.mnuChartTypePicker=new Common.UI.DataView({el:$("#id-chart-dlg-menu-type"),parentMenu:t.menu,restoreHeight:535,groups:new Common.UI.DataViewGroupStore(Common.define.chartData.getChartGroupData()),store:new Common.UI.DataViewStore(Common.define.chartData.getChartData()),itemTemplate:_.template('<div id="<%= id %>" class="item-chartlist"><svg width="40" height="40" class="icon uni-scale"><use xlink:href="#chart-<%= iconCls %>"></use></svg></div>')})}),this.btnChartType.render($("#chart-dlg-button-type")),this.mnuChartTypePicker.on("item:click",_.bind(this.onSelectType,this,this.btnChartType))),this.cmbChartTitle=new Common.UI.ComboBox({el:$("#chart-dlg-combo-chart-title"),menuStyle:"min-width: 140px;",editable:!1,cls:"input-group-nr",data:[{value:Asc.c_oAscChartTitleShowSettings.none,displayValue:this.textNone},{value:Asc.c_oAscChartTitleShowSettings.overlay,displayValue:this.textOverlay},{value:Asc.c_oAscChartTitleShowSettings.noOverlay,displayValue:this.textNoOverlay}],takeFocusOnClose:!0}),this.cmbLegendPos=new Common.UI.ComboBox({el:$("#chart-dlg-combo-legend-pos"),menuStyle:"min-width: 140px;",editable:!1,cls:"input-group-nr",data:[{value:Asc.c_oAscChartLegendShowSettings.none,displayValue:this.textNone},{value:Asc.c_oAscChartLegendShowSettings.bottom,displayValue:this.textLegendBottom},{value:Asc.c_oAscChartLegendShowSettings.top,displayValue:this.textLegendTop},{value:Asc.c_oAscChartLegendShowSettings.left,displayValue:this.textLegendLeft},{value:Asc.c_oAscChartLegendShowSettings.right,displayValue:this.textLegendRight},{value:Asc.c_oAscChartLegendShowSettings.leftOverlay,displayValue:this.textLeftOverlay},{value:Asc.c_oAscChartLegendShowSettings.rightOverlay,displayValue:this.textRightOverlay}],takeFocusOnClose:!0}),this.cmbDataLabels=new Common.UI.ComboBox({el:$("#chart-dlg-combo-data-labels"),menuStyle:"min-width: 140px;",editable:!1,cls:"input-group-nr",data:[{value:Asc.c_oAscChartDataLabelsPos.none,displayValue:this.textNone},{value:Asc.c_oAscChartDataLabelsPos.ctr,displayValue:this.textCenter},{value:Asc.c_oAscChartDataLabelsPos.inBase,displayValue:this.textInnerBottom},{value:Asc.c_oAscChartDataLabelsPos.inEnd,displayValue:this.textInnerTop},{value:Asc.c_oAscChartDataLabelsPos.outEnd,displayValue:this.textOuterTop}],takeFocusOnClose:!0}),this.cmbDataLabels.on("selected",_.bind(e.onSelectDataLabels,this)),this.txtSeparator=new Common.UI.InputField({el:$("#chart-dlg-txt-separator"),name:"range",style:"width: 100%;",allowBlank:!0,blankError:this.txtEmpty}),this.chSeriesName=new Common.UI.CheckBox({el:$("#chart-dlg-check-series"),labelText:this.textSeriesName}),this.chCategoryName=new Common.UI.CheckBox({el:$("#chart-dlg-check-category"),labelText:this.textCategoryName}),this.chValue=new Common.UI.CheckBox({el:$("#chart-dlg-check-value"),labelText:this.textValue}),this.chPercent=new Common.UI.CheckBox({el:$("#chart-dlg-check-percent"),labelText:this.textPercent}),this.cmbLines=new Common.UI.ComboBox({el:$("#chart-dlg-combo-lines"),menuStyle:"min-width: 140px;",editable:!1,cls:"input-group-nr",data:[{value:0,displayValue:this.textNone},{value:1,displayValue:this.textStraight},{value:2,displayValue:this.textSmooth}],takeFocusOnClose:!0}).on("selected",_.bind(function(t,e){this.chartSettings&&(this.chartSettings.putLine(0!==e.value),0<e.value&&this.chartSettings.putSmooth(2==e.value))},this)),this.chMarkers=new Common.UI.CheckBox({el:$("#chart-dlg-check-markers"),labelText:this.textMarkers}).on("change",_.bind(function(t,e){this.chartSettings&&this.chartSettings.putShowMarker("checked"==e)},this)),this.lblLines=$("#chart-dlg-label-lines"),this.cmbMinType=[],this.spnMinValue=[],this.cmbMaxType=[],this.spnMaxValue=[],this.cmbVCrossType=[],this.spnVAxisCrosses=[],this.cmbUnits=[],this.chVReverse=[],this.cmbVMajorType=[],this.cmbVMinorType=[],this.cmbVLabelPos=[],this.cmbVertTitle=[],this.cmbVertGrid=[],this.chVertHide=[],this.btnVFormat=[],this.chVLogScale=[],this.spnBase=[],this._arrVertTitle=[{value:Asc.c_oAscChartVertAxisLabelShowSettings.none,displayValue:e.textNone},{value:Asc.c_oAscChartVertAxisLabelShowSettings.rotated,displayValue:e.textRotated},{value:Asc.c_oAscChartVertAxisLabelShowSettings.horizontal,displayValue:e.textHorizontal}],this.cmbHCrossType=[],this.cmbAxisPos=[],this.spnHAxisCrosses=[],this.chHReverse=[],this.cmbHMajorType=[],this.cmbHMinorType=[],this.spnMarksInterval=[],this.cmbHLabelPos=[],this.spnLabelDist=[],this.cmbLabelInterval=[],this.spnLabelInterval=[],this.cmbHorTitle=[],this.cmbHorGrid=[],this.chHorHide=[],this.btnHFormat=[],this._arrHorTitle=[{value:Asc.c_oAscChartHorAxisLabelShowSettings.none,displayValue:e.textNone},{value:Asc.c_oAscChartHorAxisLabelShowSettings.noOverlay,displayValue:e.textNoOverlay}],this.btnSparkType=new Common.UI.Button({cls:"btn-large-dataview",iconCls:"svgicon chart-spark-column",menu:new Common.UI.Menu({style:"width: 167px;",additionalAlign:this.menuAddAlign,items:[{template:_.template('<div id="id-spark-dlg-menu-type" class="menu-insertchart"></div>')}]})}),this.btnSparkType.on("render:after",function(t){e.mnuSparkTypePicker=new Common.UI.DataView({el:$("#id-spark-dlg-menu-type"),parentMenu:t.menu,restoreHeight:120,groups:new Common.UI.DataViewGroupStore(Common.define.chartData.getSparkGroupData()),store:new Common.UI.DataViewStore(Common.define.chartData.getSparkData()),itemTemplate:_.template('<div id="<%= id %>" class="item-chartlist"><svg width="40" height="40" class="icon uni-scale"><use xlink:href="#chart-<%= iconCls %>"></use></svg></div>')})}),this.btnSparkType.render($("#spark-dlg-button-type")),this.mnuSparkTypePicker.on("item:click",_.bind(this.onSelectSparkType,this,this.btnSparkType)),this.cmbSparkStyle=new Common.UI.ComboDataView({itemWidth:50,itemHeight:50,menuMaxHeight:272,enableKeyEvents:!0,cls:"combo-spark-style",minWidth:190}),this.cmbSparkStyle.render($("#spark-dlg-combo-style")),this.cmbSparkStyle.openButton.menu.cmpEl.css({"min-width":178,"max-width":178}),this.cmbSparkStyle.on("click",_.bind(this.onSelectSparkStyle,this)),this.cmbSparkStyle.openButton.menu.on("show:after",function(){e.cmbSparkStyle.menuPicker.scroller.update({alwaysVisibleY:!0})}),this._arrEmptyCells=[{value:Asc.c_oAscEDispBlanksAs.Gap,displayValue:this.textGaps},{value:Asc.c_oAscEDispBlanksAs.Zero,displayValue:this.textZero},{value:Asc.c_oAscEDispBlanksAs.Span,displayValue:this.textEmptyLine}],this.cmbEmptyCells=new Common.UI.ComboBox({el:$("#spark-dlg-combo-empty"),menuStyle:"min-width: 220px;",editable:!1,cls:"input-group-nr",takeFocusOnClose:!0}),this.cmbEmptyCells.on("selected",_.bind(function(t,e){this._changedProps&&this._changedProps.asc_setDisplayEmpty(e.value)},this)),this.chShowEmpty=new Common.UI.CheckBox({el:$("#spark-dlg-check-show-data"),labelText:this.textShowData}),this.chShowEmpty.on("change",_.bind(function(t,e,i,s){this._changedProps&&this._changedProps.asc_setDisplayHidden("checked"==t.getValue())},this)),this.chShowAxis=new Common.UI.CheckBox({el:$("#spark-dlg-check-show"),labelText:this.textShowSparkAxis}),this.chShowAxis.on("change",_.bind(function(t,e,i,s){this._changedProps&&this._changedProps.asc_setDisplayXAxis("checked"==t.getValue())},this)),this.chReverse=new Common.UI.CheckBox({el:$("#spark-dlg-check-reverse"),labelText:this.textReverseOrder}),this.chReverse.on("change",_.bind(function(t,e,i,s){this._changedProps&&this._changedProps.asc_setRightToLeft("checked"==t.getValue())},this)),this.cmbSparkMinType=new Common.UI.ComboBox({el:$("#spark-dlg-combo-mintype"),cls:"input-group-nr",menuStyle:"min-width: 100px;",editable:!1,data:[{displayValue:this.textAutoEach,value:Asc.c_oAscSparklineAxisMinMax.Individual},{displayValue:this.textSameAll,value:Asc.c_oAscSparklineAxisMinMax.Group},{displayValue:this.textFixed,value:Asc.c_oAscSparklineAxisMinMax.Custom}],takeFocusOnClose:!0}).on("selected",_.bind(function(t,e){this.spnSparkMinValue.setDisabled(e.value!==Asc.c_oAscSparklineAxisMinMax.Custom),this._changedProps&&this._changedProps.asc_setMinAxisType(e.value),e.value==Asc.c_oAscSparklineAxisMinMax.Custom&&_.isEmpty(this.spnSparkMinValue.getValue())&&this.spnSparkMinValue.setValue(0)},this)),this.spnSparkMinValue=new Common.UI.MetricSpinner({el:$("#spark-dlg-input-min-value"),maxValue:1e6,minValue:-1e6,step:.1,defaultUnit:"",defaultValue:0,value:""}).on("change",_.bind(function(t,e,i){this._changedProps&&this._changedProps.asc_setManualMin(t.getNumberValue())},this)),this.cmbSparkMaxType=new Common.UI.ComboBox({el:$("#spark-dlg-combo-maxtype"),cls:"input-group-nr",menuStyle:"min-width: 100px;",editable:!1,data:[{displayValue:this.textAutoEach,value:Asc.c_oAscSparklineAxisMinMax.Individual},{displayValue:this.textSameAll,value:Asc.c_oAscSparklineAxisMinMax.Group},{displayValue:this.textFixed,value:Asc.c_oAscSparklineAxisMinMax.Custom}],takeFocusOnClose:!0}).on("selected",_.bind(function(t,e){this.spnSparkMaxValue.setDisabled(e.value!==Asc.c_oAscSparklineAxisMinMax.Custom),this._changedProps&&this._changedProps.asc_setMaxAxisType(e.value),e.value==Asc.c_oAscSparklineAxisMinMax.Custom&&_.isEmpty(this.spnSparkMaxValue.getValue())&&this.spnSparkMaxValue.setValue(0)},this)),this.spnSparkMaxValue=new Common.UI.MetricSpinner({el:$("#spark-dlg-input-max-value"),maxValue:1e6,minValue:-1e6,step:.1,defaultUnit:"",defaultValue:0,value:""}).on("change",_.bind(function(t,e,i){this._changedProps&&this._changedProps.asc_setManualMax(t.getNumberValue())},this)),this.radioTwoCell=new Common.UI.RadioBox({el:$("#chart-dlg-radio-twocell"),name:"asc-radio-snap",labelText:this.textTwoCell,value:AscCommon.c_oAscCellAnchorType.cellanchorTwoCell}),this.radioTwoCell.on("change",_.bind(this.onRadioSnapChange,this)),this.radioOneCell=new Common.UI.RadioBox({el:$("#chart-dlg-radio-onecell"),name:"asc-radio-snap",labelText:this.textOneCell,value:AscCommon.c_oAscCellAnchorType.cellanchorOneCell}),this.radioOneCell.on("change",_.bind(this.onRadioSnapChange,this)),this.radioAbsolute=new Common.UI.RadioBox({el:$("#chart-dlg-radio-absolute"),name:"asc-radio-snap",labelText:this.textAbsolute,value:AscCommon.c_oAscCellAnchorType.cellanchorAbsolute}),this.radioAbsolute.on("change",_.bind(this.onRadioSnapChange,this)),this.inputAltTitle=new Common.UI.InputField({el:$("#chart-advanced-alt-title"),allowBlank:!0,validateOnBlur:!1,style:"width: 100%;"}).on("changed:after",function(){e.isAltTitleChanged=!0}),this.textareaAltDescription=this.$window.find("textarea"),this.textareaAltDescription.keydown(function(t){t.keyCode==Common.UI.Keys.RETURN&&t.stopPropagation(),e.isAltDescChanged=!0}),this.afterRender()},onCategoryClick:function(t,e){Common.Views.AdvancedSettingsWindow.prototype.onCategoryClick.call(this,t,e);var i=this;setTimeout(function(){switch(e){case 1:i.cmbChartTitle.focus();break;case 2:case 3:e-=2;var t=i.vertAxisPropsIndexes[e];i.onVCategoryClick(e),(i.vertAxisProps[e].getAxisType()===Asc.c_oAscAxisType.val?i.cmbMinType:i.cmbHCrossType[t].isDisabled()?i.btnHFormat:i.cmbHCrossType)[t].focus();break;case 4:case 5:e-=4;t=i.horAxisPropsIndexes[e];i.onHCategoryClick(e),(i.horAxisProps[e].getAxisType()===Asc.c_oAscAxisType.val?i.cmbMinType:i.cmbHCrossType[t].isDisabled()?i.btnHFormat:i.cmbHCrossType)[t].focus();break;case 6:i.cmbEmptyCells.focus();break;case 7:i.chShowAxis.focus();break;case 8:i.radioTwoCell.focus();break;case 9:i.inputAltTitle.focus()}},10)},afterRender:function(){var t;this._setDefaults(this.chartSettings),this.setTitle(this.isChart?this.textTitle:this.textTitleSparkline),this.btnsCategory[0].setVisible(this.isDiagramMode),(this.isChart?(this.btnsCategory[6].setVisible(!1),this.btnsCategory[7]):(this.btnsCategory[1].setVisible(!1),this.btnsCategory[2].setVisible(!1),this.btnsCategory[3].setVisible(!1),this.btnsCategory[4].setVisible(!1),this.btnsCategory[5].setVisible(!1),this.btnsCategory[8].setVisible(!1),this.btnsCategory[9])).setVisible(!1),this.storageName&&(t=Common.localStorage.getItem(this.storageName),this.setActiveCategory(null!==t?parseInt(t):0),2==(t=this.getActiveCategory())||3==t?this.onVCategoryClick(t-2):4!=t&&5!=t||this.onHCategoryClick(t-4))},addControlsV:function(t){var s=this,o=s.chVertHide.length,e=$(_.template(i)({scope:s,idx:o}));return t.append(e),s.chVertHide[o]=new Common.UI.CheckBox({el:$("#chart-dlg-chk-vert-hide-"+o),labelText:s.textHideAxis}).on("change",_.bind(function(t,e){s.currentAxisProps[o]&&s.currentAxisProps[o].putShow("checked"!==e)},s)),Common.UI.FocusManager.add(this,s.chVertHide[o]),s.cmbVertTitle[o]=new Common.UI.ComboBox({el:$("#chart-dlg-combo-vert-title-"+o),menuStyle:"min-width: 140px;",editable:!1,cls:"input-group-nr",data:s._arrVertTitle,takeFocusOnClose:!0}).on("selected",_.bind(function(t,e){s.currentAxisProps[o]&&s.currentAxisProps[o].putLabel(e.value)},s)),Common.UI.FocusManager.add(this,s.cmbVertTitle[o]),s.cmbVertGrid[o]=new Common.UI.ComboBox({el:$("#chart-dlg-combo-vert-grid-"+o),menuStyle:"min-width: 140px;",editable:!1,cls:"input-group-nr",data:[{value:Asc.c_oAscGridLinesSettings.none,displayValue:s.textNone},{value:Asc.c_oAscGridLinesSettings.major,displayValue:s.textMajor},{value:Asc.c_oAscGridLinesSettings.minor,displayValue:s.textMinor},{value:Asc.c_oAscGridLinesSettings.majorMinor,displayValue:s.textMajorMinor}],takeFocusOnClose:!0}).on("selected",_.bind(function(t,e){s.currentAxisProps[o]&&s.currentAxisProps[o].putGridlines(e.value)},s)),Common.UI.FocusManager.add(this,s.cmbVertGrid[o]),s.cmbMinType[o]=new Common.UI.ComboBox({el:$("#chart-dlg-combo-mintype-"+o),cls:"input-group-nr",menuStyle:"min-width: 100px;",editable:!1,data:[{displayValue:s.textAuto,value:Asc.c_oAscValAxisRule.auto},{displayValue:s.textFixed,value:Asc.c_oAscValAxisRule.fixed}],takeFocusOnClose:!0}).on("selected",_.bind(function(t,e){s.currentAxisProps[o]&&(s.currentAxisProps[o].putMinValRule(e.value),e.value==Asc.c_oAscValAxisRule.auto&&s.spnMinValue[o].setValue(s._originalAxisVValues[o].minAuto,!0))},s)),Common.UI.FocusManager.add(this,s.cmbMinType[o]),s.spnMinValue[o]=new Common.UI.MetricSpinner({el:$("#chart-dlg-input-min-value-"+o),maxValue:1e6,minValue:-1e6,step:.1,defaultUnit:"",defaultValue:0,value:""}).on("change",_.bind(function(t,e,i){s.cmbMinType[o].suspendEvents(),s.cmbMinType[o].setValue(Asc.c_oAscValAxisRule.fixed),s.cmbMinType[o].resumeEvents(),s.currentAxisProps[o]&&(s.currentAxisProps[o].putMinValRule(Asc.c_oAscValAxisRule.fixed),s.currentAxisProps[o].putMinVal(t.getNumberValue()))},s)),Common.UI.FocusManager.add(this,s.spnMinValue[o]),s.cmbMaxType[o]=new Common.UI.ComboBox({el:$("#chart-dlg-combo-maxtype-"+o),cls:"input-group-nr",menuStyle:"min-width: 100px;",editable:!1,data:[{displayValue:s.textAuto,value:Asc.c_oAscValAxisRule.auto},{displayValue:s.textFixed,value:Asc.c_oAscValAxisRule.fixed}],takeFocusOnClose:!0}).on("selected",_.bind(function(t,e){s.currentAxisProps[o]&&(s.currentAxisProps[o].putMaxValRule(e.value),e.value==Asc.c_oAscValAxisRule.auto&&s.spnMaxValue[o].setValue(s._originalAxisVValues[o].maxAuto,!0))},s)),Common.UI.FocusManager.add(this,s.cmbMaxType[o]),s.spnMaxValue[o]=new Common.UI.MetricSpinner({el:$("#chart-dlg-input-max-value-"+o),maxValue:1e6,minValue:-1e6,step:.1,defaultUnit:"",defaultValue:0,value:""}).on("change",_.bind(function(t,e,i){s.cmbMaxType[o].suspendEvents(),s.cmbMaxType[o].setValue(Asc.c_oAscValAxisRule.fixed),s.cmbMaxType[o].resumeEvents(),s.currentAxisProps[o]&&(s.currentAxisProps[o].putMaxValRule(Asc.c_oAscValAxisRule.fixed),s.currentAxisProps[o].putMaxVal(t.getNumberValue()))},s)),Common.UI.FocusManager.add(this,s.spnMaxValue[o]),s.cmbVCrossType[o]=new Common.UI.ComboBox({el:$("#chart-dlg-combo-v-crosstype-"+o),cls:"input-group-nr",menuStyle:"min-width: 100px;",editable:!1,data:[{displayValue:s.textAuto,value:Asc.c_oAscCrossesRule.auto},{displayValue:s.textValue,value:Asc.c_oAscCrossesRule.value},{displayValue:s.textMinValue,value:Asc.c_oAscCrossesRule.minValue},{displayValue:s.textMaxValue,value:Asc.c_oAscCrossesRule.maxValue}],takeFocusOnClose:!0}).on("selected",_.bind(function(t,e){if(s.currentAxisProps[o])switch(s.currentAxisProps[o].putCrossesRule(e.value),e.value){case Asc.c_oAscCrossesRule.minValue:s.spnVAxisCrosses[o].setValue(s.spnMinValue[o].getNumberValue(),!0);break;case Asc.c_oAscCrossesRule.maxValue:s.spnVAxisCrosses[o].setValue(s.spnMaxValue[o].getNumberValue(),!0);break;case Asc.c_oAscCrossesRule.auto:s.spnVAxisCrosses[o].setValue(s._originalAxisVValues[o].crossesAuto,!0)}},s)),Common.UI.FocusManager.add(this,s.cmbVCrossType[o]),s.spnVAxisCrosses[o]=new Common.UI.MetricSpinner({el:$("#chart-dlg-input-v-axis-crosses-"+o),maxValue:1e6,minValue:-1e6,step:.1,defaultUnit:"",defaultValue:0,value:""}).on("change",_.bind(function(t,e,i){s.cmbVCrossType[o].suspendEvents(),s.cmbVCrossType[o].setValue(Asc.c_oAscCrossesRule.value),s.cmbVCrossType[o].resumeEvents(),s.currentAxisProps[o]&&(s.currentAxisProps[o].putCrossesRule(Asc.c_oAscCrossesRule.value),s.currentAxisProps[o].putCrosses(t.getNumberValue()))},s)),Common.UI.FocusManager.add(this,s.spnVAxisCrosses[o]),s.cmbUnits[o]=new Common.UI.ComboBox({el:$("#chart-dlg-combo-units-"+o),cls:"input-group-nr",menuStyle:"min-width: 100%;",editable:!1,data:[{displayValue:s.textNone,value:Asc.c_oAscValAxUnits.none},{displayValue:s.textHundreds,value:Asc.c_oAscValAxUnits.HUNDREDS},{displayValue:s.textThousands,value:Asc.c_oAscValAxUnits.THOUSANDS},{displayValue:s.textTenThousands,value:Asc.c_oAscValAxUnits.TEN_THOUSANDS},{displayValue:s.textHundredThousands,value:Asc.c_oAscValAxUnits.HUNDRED_THOUSANDS},{displayValue:s.textMillions,value:Asc.c_oAscValAxUnits.MILLIONS},{displayValue:s.textTenMillions,value:Asc.c_oAscValAxUnits.TEN_MILLIONS},{displayValue:s.textHundredMil,value:Asc.c_oAscValAxUnits.HUNDRED_MILLIONS},{displayValue:s.textBillions,value:Asc.c_oAscValAxUnits.BILLIONS},{displayValue:s.textTrillions,value:Asc.c_oAscValAxUnits.TRILLIONS}],takeFocusOnClose:!0}).on("selected",_.bind(function(t,e){s.currentAxisProps[o]&&s.currentAxisProps[o].putDispUnitsRule(e.value)},s)),Common.UI.FocusManager.add(this,s.cmbUnits[o]),s.chVReverse[o]=new Common.UI.CheckBox({el:$("#chart-dlg-check-v-reverse-"+o),labelText:s.textReverse}).on("change",_.bind(function(t,e){s.currentAxisProps[o]&&s.currentAxisProps[o].putInvertValOrder("checked"==e)},s)),Common.UI.FocusManager.add(this,s.chVReverse[o]),s.cmbVMajorType[o]=new Common.UI.ComboBox({el:$("#chart-dlg-combo-v-major-type-"+o),cls:"input-group-nr",menuStyle:"min-width: 140px;",editable:!1,data:[{displayValue:s.textNone,value:Asc.c_oAscTickMark.TICK_MARK_NONE},{displayValue:s.textCross,value:Asc.c_oAscTickMark.TICK_MARK_CROSS},{displayValue:s.textIn,value:Asc.c_oAscTickMark.TICK_MARK_IN},{displayValue:s.textOut,value:Asc.c_oAscTickMark.TICK_MARK_OUT}],takeFocusOnClose:!0}).on("selected",_.bind(function(t,e){s.currentAxisProps[o]&&s.currentAxisProps[o].putMajorTickMark(e.value)},s)),Common.UI.FocusManager.add(this,s.cmbVMajorType[o]),s.cmbVMinorType[o]=new Common.UI.ComboBox({el:$("#chart-dlg-combo-v-minor-type-"+o),cls:"input-group-nr",menuStyle:"min-width: 140px;",editable:!1,data:[{displayValue:s.textNone,value:Asc.c_oAscTickMark.TICK_MARK_NONE},{displayValue:s.textCross,value:Asc.c_oAscTickMark.TICK_MARK_CROSS},{displayValue:s.textIn,value:Asc.c_oAscTickMark.TICK_MARK_IN},{displayValue:s.textOut,value:Asc.c_oAscTickMark.TICK_MARK_OUT}],takeFocusOnClose:!0}).on("selected",_.bind(function(t,e){s.currentAxisProps[o]&&s.currentAxisProps[o].putMinorTickMark(e.value)},s)),Common.UI.FocusManager.add(this,s.cmbVMinorType[o]),s.cmbVLabelPos[o]=new Common.UI.ComboBox({el:$("#chart-dlg-combo-v-label-pos-"+o),cls:"input-group-nr",menuStyle:"min-width: 100%;",editable:!1,data:[{displayValue:s.textNone,value:Asc.c_oAscTickLabelsPos.TICK_LABEL_POSITION_NONE},{displayValue:s.textLow,value:Asc.c_oAscTickLabelsPos.TICK_LABEL_POSITION_LOW},{displayValue:s.textHigh,value:Asc.c_oAscTickLabelsPos.TICK_LABEL_POSITION_HIGH},{displayValue:s.textNextToAxis,value:Asc.c_oAscTickLabelsPos.TICK_LABEL_POSITION_NEXT_TO}],takeFocusOnClose:!0}).on("selected",_.bind(function(t,e){s.currentAxisProps[o]&&s.currentAxisProps[o].putTickLabelsPos(e.value)},s)),Common.UI.FocusManager.add(this,s.cmbVLabelPos[o]),s.btnVFormat[o]=new Common.UI.Button({el:$("#chart-dlg-btn-v-format-"+o)}).on("click",_.bind(s.openFormat,s,o)),Common.UI.FocusManager.add(this,s.btnVFormat[o]),s.chVLogScale[o]=new Common.UI.CheckBox({el:$("#chart-dlg-check-v-logscale-"+o),labelText:s.textLogScale}).on("change",_.bind(function(t,e){s.currentAxisProps[o]&&(s.currentAxisProps[o].putLogScale("checked"==e),"checked"==e&&s.currentAxisProps[o].putLogBase(s.spnBase[o].getNumberValue())),s.spnBase[o].setDisabled("checked"!==e)},s)),Common.UI.FocusManager.add(this,s.chVLogScale[o]),s.spnBase[o]=new Common.UI.MetricSpinner({el:$("#chart-dlg-input-base-"+o),maxValue:1e3,minValue:2,step:1,defaultUnit:"",value:10}).on("change",_.bind(function(t,e,i){s.currentAxisProps[o]&&s.currentAxisProps[o].putLogBase(t.getNumberValue())},s)),Common.UI.FocusManager.add(this,s.spnBase[o]),o},addControlsH:function(t){var s=this,o=s.chHorHide.length,e=$(_.template(n)({scope:s,idx:o}));return t.append(e),s.chHorHide[o]=new Common.UI.CheckBox({el:$("#chart-dlg-chk-hor-hide-"+o),labelText:s.textHideAxis}).on("change",_.bind(function(t,e){s.currentAxisProps[o]&&s.currentAxisProps[o].putShow("checked"!==e)},s)),Common.UI.FocusManager.add(this,s.chHorHide[o]),s.cmbHorTitle[o]=new Common.UI.ComboBox({el:$("#chart-dlg-combo-hor-title-"+o),menuStyle:"min-width: 140px;",editable:!1,cls:"input-group-nr",data:s._arrHorTitle,takeFocusOnClose:!0}).on("selected",_.bind(function(t,e){s.currentAxisProps[o]&&s.currentAxisProps[o].putLabel(e.value)},s)),Common.UI.FocusManager.add(this,s.cmbHorTitle[o]),s.cmbHorGrid[o]=new Common.UI.ComboBox({el:$("#chart-dlg-combo-hor-grid-"+o),menuStyle:"min-width: 140px;",editable:!1,cls:"input-group-nr",data:[{value:Asc.c_oAscGridLinesSettings.none,displayValue:s.textNone},{value:Asc.c_oAscGridLinesSettings.major,displayValue:s.textMajor},{value:Asc.c_oAscGridLinesSettings.minor,displayValue:s.textMinor},{value:Asc.c_oAscGridLinesSettings.majorMinor,displayValue:s.textMajorMinor}],takeFocusOnClose:!0}).on("selected",_.bind(function(t,e){s.currentAxisProps[o]&&s.currentAxisProps[o].putGridlines(e.value)},s)),Common.UI.FocusManager.add(this,s.cmbHorGrid[o]),s.cmbHCrossType[o]=new Common.UI.ComboBox({el:$("#chart-dlg-combo-h-crosstype-"+o),cls:"input-group-nr",menuStyle:"min-width: 100px;",editable:!1,data:[{displayValue:s.textAuto,value:Asc.c_oAscCrossesRule.auto},{displayValue:s.textValue,value:Asc.c_oAscCrossesRule.value},{displayValue:s.textMinValue,value:Asc.c_oAscCrossesRule.minValue},{displayValue:s.textMaxValue,value:Asc.c_oAscCrossesRule.maxValue}],takeFocusOnClose:!0}).on("selected",_.bind(function(t,e){s.currentAxisProps[o]&&(s.currentAxisProps[o].putCrossesRule(e.value),e.value==Asc.c_oAscCrossesRule.auto?s.spnHAxisCrosses[o].setValue(s._originalAxisHValues[o].crossesAuto,!0):e.value==Asc.c_oAscCrossesRule.minValue?s.spnHAxisCrosses[o].setValue(s._originalAxisHValues[o].minAuto,!0):e.value==Asc.c_oAscCrossesRule.maxValue&&s.spnHAxisCrosses[o].setValue(s._originalAxisHValues[o].maxAuto,!0))},s)),Common.UI.FocusManager.add(this,s.cmbHCrossType[o]),s.spnHAxisCrosses[o]=new Common.UI.MetricSpinner({el:$("#chart-dlg-input-h-axis-crosses-"+o),maxValue:1e6,minValue:-1e6,step:.1,defaultUnit:"",defaultValue:0,value:""}).on("change",_.bind(function(t,e,i){s.cmbHCrossType[o].suspendEvents(),s.cmbHCrossType[o].setValue(Asc.c_oAscCrossesRule.value),s.cmbHCrossType[o].resumeEvents(),s.currentAxisProps[o]&&(s.currentAxisProps[o].putCrossesRule(Asc.c_oAscCrossesRule.value),s.currentAxisProps[o].putCrosses(t.getNumberValue()))},s)),Common.UI.FocusManager.add(this,s.spnHAxisCrosses[o]),s.cmbAxisPos[o]=new Common.UI.ComboBox({el:$("#chart-dlg-combo-axis-pos-"+o),cls:"input-group-nr",menuStyle:"min-width: 140px;",editable:!1,data:[{displayValue:s.textOnTickMarks,value:Asc.c_oAscLabelsPosition.byDivisions},{displayValue:s.textBetweenTickMarks,value:Asc.c_oAscLabelsPosition.betweenDivisions}],takeFocusOnClose:!0}).on("selected",_.bind(function(t,e){s.currentAxisProps[o]&&s.currentAxisProps[o].putLabelsPosition(e.value)},s)),Common.UI.FocusManager.add(this,s.cmbAxisPos[o]),s.chHReverse[o]=new Common.UI.CheckBox({el:$("#chart-dlg-check-h-reverse-"+o),labelText:s.textReverse}).on("change",_.bind(function(t,e){s.currentAxisProps[o]&&s.currentAxisProps[o].putInvertCatOrder("checked"==e)},s)),Common.UI.FocusManager.add(this,s.chHReverse[o]),s.cmbHMajorType[o]=new Common.UI.ComboBox({el:$("#chart-dlg-combo-h-major-type-"+o),cls:"input-group-nr",menuStyle:"min-width: 140px;",editable:!1,data:[{displayValue:s.textNone,value:Asc.c_oAscTickMark.TICK_MARK_NONE},{displayValue:s.textCross,value:Asc.c_oAscTickMark.TICK_MARK_CROSS},{displayValue:s.textIn,value:Asc.c_oAscTickMark.TICK_MARK_IN},{displayValue:s.textOut,value:Asc.c_oAscTickMark.TICK_MARK_OUT}],takeFocusOnClose:!0}).on("selected",_.bind(function(t,e){s.currentAxisProps[o]&&s.currentAxisProps[o].putMajorTickMark(e.value)},s)),Common.UI.FocusManager.add(this,s.cmbHMajorType[o]),s.cmbHMinorType[o]=new Common.UI.ComboBox({el:$("#chart-dlg-combo-h-minor-type-"+o),cls:"input-group-nr",menuStyle:"min-width: 140px;",editable:!1,data:[{displayValue:s.textNone,value:Asc.c_oAscTickMark.TICK_MARK_NONE},{displayValue:s.textCross,value:Asc.c_oAscTickMark.TICK_MARK_CROSS},{displayValue:s.textIn,value:Asc.c_oAscTickMark.TICK_MARK_IN},{displayValue:s.textOut,value:Asc.c_oAscTickMark.TICK_MARK_OUT}],takeFocusOnClose:!0}).on("selected",_.bind(function(t,e){s.currentAxisProps[o]&&s.currentAxisProps[o].putMinorTickMark(e.value)},s)),Common.UI.FocusManager.add(this,s.cmbHMinorType[o]),s.spnMarksInterval[o]=new Common.UI.MetricSpinner({el:$("#chart-dlg-input-marks-interval-"+o),width:140,maxValue:1e6,minValue:1,step:1,defaultUnit:"",value:""}).on("change",_.bind(function(t,e,i){s.currentAxisProps[o]&&s.currentAxisProps[o].putIntervalBetweenTick(t.getNumberValue())},s)),Common.UI.FocusManager.add(this,s.spnMarksInterval[o]),s.cmbHLabelPos[o]=new Common.UI.ComboBox({el:$("#chart-dlg-combo-h-label-pos-"+o),cls:"input-group-nr",menuStyle:"min-width: 140px;",editable:!1,data:[{displayValue:s.textNone,value:Asc.c_oAscTickLabelsPos.TICK_LABEL_POSITION_NONE},{displayValue:s.textLow,value:Asc.c_oAscTickLabelsPos.TICK_LABEL_POSITION_LOW},{displayValue:s.textHigh,value:Asc.c_oAscTickLabelsPos.TICK_LABEL_POSITION_HIGH},{displayValue:s.textNextToAxis,value:Asc.c_oAscTickLabelsPos.TICK_LABEL_POSITION_NEXT_TO}],takeFocusOnClose:!0}).on("selected",_.bind(function(t,e){s.currentAxisProps[o]&&s.currentAxisProps[o].putTickLabelsPos(e.value)},s)),Common.UI.FocusManager.add(this,s.cmbHLabelPos[o]),s.spnLabelDist[o]=new Common.UI.MetricSpinner({el:$("#chart-dlg-input-label-dist-"+o),width:140,maxValue:1e3,minValue:0,step:1,defaultUnit:"",value:""}).on("change",_.bind(function(t,e,i){s.currentAxisProps[o]&&s.currentAxisProps[o].putLabelsAxisDistance(t.getNumberValue())},s)),Common.UI.FocusManager.add(this,s.spnLabelDist[o]),s.spnLabelInterval[o]=new Common.UI.MetricSpinner({el:$("#chart-dlg-input-label-int-"+o),width:60,maxValue:1e6,minValue:1,step:1,defaultUnit:"",value:""}).on("change",_.bind(function(t,e,i){s.cmbLabelInterval[o].suspendEvents(),s.cmbLabelInterval[o].setValue(Asc.c_oAscBetweenLabelsRule.manual),s.cmbLabelInterval[o].resumeEvents(),s.currentAxisProps[o]&&(s.currentAxisProps[o].putIntervalBetweenLabelsRule(Asc.c_oAscBetweenLabelsRule.manual),s.currentAxisProps[o].putIntervalBetweenLabels(t.getNumberValue()))},s)),Common.UI.FocusManager.add(this,s.spnLabelInterval[o]),s.cmbLabelInterval[o]=new Common.UI.ComboBox({el:$("#chart-dlg-combo-label-int-"+o),cls:"input-group-nr",menuStyle:"min-width: 100px;",editable:!1,data:[{displayValue:s.textAuto,value:Asc.c_oAscBetweenLabelsRule.auto},{displayValue:s.textManual,value:Asc.c_oAscBetweenLabelsRule.manual}],takeFocusOnClose:!0}).on("selected",_.bind(function(t,e){s.currentAxisProps[o]&&(s.currentAxisProps[o].putIntervalBetweenLabelsRule(e.value),e.value==Asc.c_oAscBetweenLabelsRule.auto&&s.spnLabelInterval[o].setValue(1,!0))},s)),Common.UI.FocusManager.add(this,s.cmbLabelInterval[o]),s.btnHFormat[o]=new Common.UI.Button({el:$("#chart-dlg-btn-h-format-"+o)}).on("click",_.bind(s.openFormat,s,o)),Common.UI.FocusManager.add(this,s.btnHFormat[o]),o},onSelectType:function(t,e,i,s){if(!this._noApply){var o={};if(_.isFunction(s.toJSON)){if(!s.get("selected"))return;o=s.toJSON()}else o=s;this.btnChartType.setIconCls("svgicon chart-"+o.iconCls),this.chartSettings.changeType(o.type),this.updateAxisProps(o.type,!0),this.vertAxisProps=this.chartSettings.getVertAxesProps(),this.horAxisProps=this.chartSettings.getHorAxesProps(),this.updateDataLabels(o.type,this.cmbDataLabels.getValue()),this.currentChartType=o.type}},updateAxisProps:function(t,e){var i=t==Asc.c_oAscChartTypeSettings.lineNormal||t==Asc.c_oAscChartTypeSettings.lineStacked||t==Asc.c_oAscChartTypeSettings.lineStackedPer||t==Asc.c_oAscChartTypeSettings.lineNormalMarker||t==Asc.c_oAscChartTypeSettings.lineStackedMarker||t==Asc.c_oAscChartTypeSettings.lineStackedPerMarker||t==Asc.c_oAscChartTypeSettings.scatter||t==Asc.c_oAscChartTypeSettings.scatterSmoothMarker||t==Asc.c_oAscChartTypeSettings.scatterSmooth||t==Asc.c_oAscChartTypeSettings.scatterLineMarker||t==Asc.c_oAscChartTypeSettings.scatterLine;this.chMarkers.setVisible(i),this.cmbLines.setVisible(i),this.lblLines.toggleClass("hidden",!i),i&&(this.chMarkers.setValue(this.chartSettings.getShowMarker(),!0),this.cmbLines.setValue(this.chartSettings.getLine()?this.chartSettings.getSmooth()?2:1:0)),i=t==Asc.c_oAscChartTypeSettings.pie||t==Asc.c_oAscChartTypeSettings.doughnut||t==Asc.c_oAscChartTypeSettings.pie3d,this.btnsCategory[2].setDisabled(i),this.btnsCategory[3].setDisabled(i),this.btnsCategory[4].setDisabled(i),this.btnsCategory[5].setDisabled(i),this.btnsCategory[2].setVisible(0<this.vertAxisProps.length),this.btnsCategory[3].setVisible(1<this.vertAxisProps.length),this.btnsCategory[4].setVisible(0<this.horAxisProps.length),this.btnsCategory[5].setVisible(1<this.horAxisProps.length);for(var i=t==Asc.c_oAscChartTypeSettings.barNormal3d||t==Asc.c_oAscChartTypeSettings.barStacked3d||t==Asc.c_oAscChartTypeSettings.barStackedPer3d||t==Asc.c_oAscChartTypeSettings.hBarNormal3d||t==Asc.c_oAscChartTypeSettings.hBarStacked3d||t==Asc.c_oAscChartTypeSettings.hBarStackedPer3d||t==Asc.c_oAscChartTypeSettings.barNormal3dPerspective,s=0;s<this.cmbAxisPos.length;s++)this.cmbAxisPos[s].setDisabled(i)},updateDataLabels:function(t,e){var i;t!==this.currentChartType&&(i=[{value:Asc.c_oAscChartDataLabelsPos.none,displayValue:this.textNone},{value:Asc.c_oAscChartDataLabelsPos.ctr,displayValue:this.textCenter}],t==Asc.c_oAscChartTypeSettings.barNormal||t==Asc.c_oAscChartTypeSettings.hBarNormal?i.push({value:Asc.c_oAscChartDataLabelsPos.inBase,displayValue:this.textInnerBottom},{value:Asc.c_oAscChartDataLabelsPos.inEnd,displayValue:this.textInnerTop},{value:Asc.c_oAscChartDataLabelsPos.outEnd,displayValue:this.textOuterTop}):t==Asc.c_oAscChartTypeSettings.barStacked||t==Asc.c_oAscChartTypeSettings.barStackedPer||t==Asc.c_oAscChartTypeSettings.hBarStacked||t==Asc.c_oAscChartTypeSettings.hBarStackedPer?i.push({value:Asc.c_oAscChartDataLabelsPos.inBase,displayValue:this.textInnerBottom},{value:Asc.c_oAscChartDataLabelsPos.inEnd,displayValue:this.textInnerTop}):t==Asc.c_oAscChartTypeSettings.lineNormal||t==Asc.c_oAscChartTypeSettings.lineStacked||t==Asc.c_oAscChartTypeSettings.lineStackedPer||t==Asc.c_oAscChartTypeSettings.lineNormalMarker||t==Asc.c_oAscChartTypeSettings.lineStackedMarker||t==Asc.c_oAscChartTypeSettings.lineStackedPerMarker||t==Asc.c_oAscChartTypeSettings.stock||t==Asc.c_oAscChartTypeSettings.scatter||t==Asc.c_oAscChartTypeSettings.scatterSmoothMarker||t==Asc.c_oAscChartTypeSettings.scatterSmooth||t==Asc.c_oAscChartTypeSettings.scatterLineMarker||t==Asc.c_oAscChartTypeSettings.scatterLine?i.push({value:Asc.c_oAscChartDataLabelsPos.l,displayValue:this.textLeft},{value:Asc.c_oAscChartDataLabelsPos.r,displayValue:this.textRight},{value:Asc.c_oAscChartDataLabelsPos.t,displayValue:this.textTop},{value:Asc.c_oAscChartDataLabelsPos.b,displayValue:this.textBottom}):t!=Asc.c_oAscChartTypeSettings.pie&&t!=Asc.c_oAscChartTypeSettings.pie3d||i.push({value:Asc.c_oAscChartDataLabelsPos.bestFit,displayValue:this.textFit},{value:Asc.c_oAscChartDataLabelsPos.inEnd,displayValue:this.textInnerTop},{value:Asc.c_oAscChartDataLabelsPos.outEnd,displayValue:this.textOuterTop}),this.cmbDataLabels.setData(i)),void 0!==e?this.cmbDataLabels.store.findWhere({value:e})||(e=Asc.c_oAscChartDataLabelsPos.ctr):e=Asc.c_oAscChartDataLabelsPos.none,this.cmbDataLabels.setValue(e),this.onSelectDataLabels(this.cmbDataLabels,{value:e})},onVCategoryClick:function(t){this.vertAxisProps[t].getAxisType()==Asc.c_oAscAxisType.val?this.fillVProps(this.vertAxisProps[t],this.vertAxisPropsIndexes[t]):this.fillHProps(this.vertAxisProps[t],this.vertAxisPropsIndexes[t],!0)},onHCategoryClick:function(t){this.horAxisProps[t].getAxisType()==Asc.c_oAscAxisType.val?this.fillVProps(this.horAxisProps[t],this.horAxisPropsIndexes[t],!0):this.fillHProps(this.horAxisProps[t],this.horAxisPropsIndexes[t])},fillVProps:function(t,e,i){if(t.getAxisType()===Asc.c_oAscAxisType.val){null==this._originalAxisVValues&&(this._originalAxisVValues=[]),null==this._originalAxisVValues[e]&&(this._originalAxisVValues[e]={minAuto:null==t.getMinVal()?0:t.getMinVal(),maxAuto:null==t.getMaxVal()?10:t.getMaxVal(),crossesAuto:null==t.getCrosses()?0:t.getCrosses()}),this.chVertHide[e].setValue(!t.getShow()),this.cmbVertGrid[e].setValue(t.getGridlines()),this.cmbVertTitle[e].setData(i?this._arrHorTitle:this._arrVertTitle),this.cmbVertTitle[e].setValue(t.getLabel()),this.cmbVertTitle[e].setDisabled(!!t.isRadarAxis()),this.cmbMinType[e].setValue(t.getMinValRule());var s=t.getMinValRule()==Asc.c_oAscValAxisRule.auto?this._originalAxisVValues[e].minAuto:t.getMinVal();switch(this.spnMinValue[e].setValue(null==s?"":s,!0),this.cmbMaxType[e].setValue(t.getMaxValRule()),s=t.getMaxValRule()==Asc.c_oAscValAxisRule.auto?this._originalAxisVValues[e].maxAuto:t.getMaxVal(),this.spnMaxValue[e].setValue(null==s?"":s,!0),s=t.getCrossesRule(),this.cmbVCrossType[e].setValue(s),s){case Asc.c_oAscCrossesRule.minValue:s=this.spnMinValue[e].getNumberValue();break;case Asc.c_oAscCrossesRule.maxValue:s=this.spnMaxValue[e].getNumberValue();break;case Asc.c_oAscCrossesRule.auto:s=this._originalAxisVValues[e].crossesAuto;break;default:s=t.getCrosses()}this.spnVAxisCrosses[e].setValue(null==s?"":s,!0),this.cmbUnits[e].setValue(t.getDispUnitsRule()),this.chVReverse[e].setValue(t.getInvertValOrder(),!0),this.cmbVMajorType[e].setValue(t.getMajorTickMark()),this.cmbVMinorType[e].setValue(t.getMinorTickMark()),this.cmbVLabelPos[e].setValue(t.getTickLabelsPos()),s=t.getLogScale(),this.chVLogScale[e].setValue(!!s,!0),this.spnBase[e].setDisabled(!s),s&&this.spnBase[e].setValue(t.getLogBase(),!0),this.currentAxisProps[e]=t}},fillHProps:function(t,e,i){if(t.getAxisType()===Asc.c_oAscAxisType.cat){null==this._originalAxisHValues&&(this._originalAxisHValues=[]),null==this._originalAxisHValues[e]&&(this._originalAxisHValues[e]={minAuto:null==t.getCrossMinVal()?0:t.getCrossMinVal(),maxAuto:null==t.getCrossMaxVal()?10:t.getCrossMaxVal(),crossesAuto:null==t.getCrosses()?0:t.getCrosses()}),this.chHorHide[e].setValue(!t.getShow()),this.cmbHorGrid[e].setValue(t.getGridlines()),this.cmbHorTitle[e].setData(i?this._arrVertTitle:this._arrHorTitle),this.cmbHorTitle[e].setValue(t.getLabel());var s=t.getCrossesRule();switch(this.cmbHCrossType[e].setValue(s),s){case Asc.c_oAscCrossesRule.minValue:s=this._originalAxisHValues[e].minAuto;break;case Asc.c_oAscCrossesRule.maxValue:s=this._originalAxisHValues[e].maxAuto;break;case Asc.c_oAscCrossesRule.auto:s=this._originalAxisHValues[e].crossesAuto;break;default:s=t.getCrosses()}this.spnHAxisCrosses[e].setValue(null==s?"":s,!0),this.cmbAxisPos[e].setValue(t.getLabelsPosition()),this.chHReverse[e].setValue(t.getInvertCatOrder(),!0),this.cmbHMajorType[e].setValue(t.getMajorTickMark()),this.cmbHMinorType[e].setValue(t.getMinorTickMark()),this.spnMarksInterval[e].setValue(t.getIntervalBetweenTick(),!0),this.cmbHLabelPos[e].setValue(t.getTickLabelsPos()),this.spnLabelDist[e].setValue(t.getLabelsAxisDistance(),!0),s=t.getIntervalBetweenLabelsRule(),this.cmbLabelInterval[e].setValue(s),this.spnLabelInterval[e].setValue(s===Asc.c_oAscBetweenLabelsRule.manual?t.getIntervalBetweenLabels():1,!0),s=!!t.isRadarAxis(),this.chHorHide[e].setDisabled(s),this.cmbHorTitle[e].setDisabled(s),this.cmbHorGrid[e].setDisabled(s),this.cmbHCrossType[e].setDisabled(s),this.spnHAxisCrosses[e].setDisabled(s),this.chHReverse[e].setDisabled(s),this.cmbHMajorType[e].setDisabled(s),this.cmbHMinorType[e].setDisabled(s),this.spnMarksInterval[e].setDisabled(s),this.cmbHLabelPos[e].setDisabled(s),this.spnLabelDist[e].setDisabled(s),this.cmbLabelInterval[e].setDisabled(s),this.spnLabelInterval[e].setDisabled(s);i=this.currentChartType,s=!!t.isRadarAxis()||i==Asc.c_oAscChartTypeSettings.barNormal3d||i==Asc.c_oAscChartTypeSettings.barStacked3d||i==Asc.c_oAscChartTypeSettings.barStackedPer3d||i==Asc.c_oAscChartTypeSettings.hBarNormal3d||i==Asc.c_oAscChartTypeSettings.hBarStacked3d||i==Asc.c_oAscChartTypeSettings.hBarStackedPer3d||i==Asc.c_oAscChartTypeSettings.barNormal3dPerspective;this.cmbAxisPos[e].setDisabled(s),this.currentAxisProps[e]=t}},updateSparkStyles:function(t){if(t&&1<t.length){var e=this.cmbSparkStyle.menuPicker.store;if(e.length==t.length-1)for(var i=e.models,s=0;s<t.length-1;s++)i[s].set("imageUrl",t[s]);else{for(var o=[],n=t[t.length-1],s=0;s<t.length-1;s++)o.push({imageUrl:t[s],data:s});e.reset(o,{silent:!1}),this.cmbSparkStyle.fillComboView(e.at(n<0?0:n),-1<n)}}},onSelectSparkType:function(t,e,i,s){if(!this._noApply){var o={};if(_.isFunction(s.toJSON)){if(!s.get("selected"))return;o=s.toJSON()}else o=s;this.btnSparkType.setIconCls("svgicon chart-"+o.iconCls),this._changedProps&&this._changedProps.asc_setType(o.type),this._state.SparkType=o.type;var s=!1,n=this.cmbEmptyCells.getValue();o.type!==Asc.c_oAscSparklineType.Line&&2<this._arrEmptyCells.length?(this._arrEmptyCells.pop(),s=!0):o.type==Asc.c_oAscSparklineType.Line&&this._arrEmptyCells.length<3&&(this._arrEmptyCells.push({value:Asc.c_oAscEDispBlanksAs.Span,displayValue:this.textEmptyLine}),s=!0),s&&(this.cmbEmptyCells.setData(this._arrEmptyCells),this.cmbEmptyCells.setValue(o.type!==Asc.c_oAscSparklineType.Line&&n==Asc.c_oAscEDispBlanksAs.Span?this.textEmptyLine:n)),this.updateSparkStyles(this.chartSettings.asc_getStyles(o.type))}},onSelectSparkStyle:function(t,e){this._noApply||this._changedProps&&this._changedProps.asc_setStyle(e.get("data"))},_setDefaults:function(t){if(t)if(this.chartSettings=t,this.isChart){this._state.ChartType=t.getType(),this._noApply=!0,this.isDiagramMode&&(s=this.mnuChartTypePicker.store.findWhere({type:this._state.ChartType}),this.mnuChartTypePicker.selectRecord(s,!0),s?this.btnChartType.setIconCls("svgicon chart-"+s.get("iconCls")):this.btnChartType.setIconCls("svgicon")),this._noApply=!1,this.cmbChartTitle.setValue(t.getTitle()),this.cmbLegendPos.setValue(t.getLegendPos()),this.updateDataLabels(this._state.ChartType,t.getDataLabelsPos()),this.cmbDataLabels.setDisabled(this._state.ChartType==Asc.c_oAscChartTypeSettings.surfaceNormal||this._state.ChartType==Asc.c_oAscChartTypeSettings.surfaceWireframe),this.chSeriesName.setValue(this.chartSettings.getShowSerName(),!0),this.chCategoryName.setValue(this.chartSettings.getShowCatName(),!0),this.chValue.setValue(this.chartSettings.getShowVal(),!0),this.chPercent.setValue(this.chartSettings.getShowPercent(),!0);var e,i=t.getSeparator();if(this.txtSeparator.setValue(i||""),Common.UI.FocusManager.add(this,[this.cmbChartTitle,this.cmbLegendPos,this.cmbDataLabels,this.chSeriesName,this.chCategoryName,this.chValue,this.chPercent,this.txtSeparator,this.cmbLines,this.chMarkers]),this.vertAxisProps=t.getVertAxesProps(),0<this.vertAxisProps.length&&(e=this.$window.find("#id-chart-settings-dlg-vert"),this.vertAxisPropsIndexes[0]=this.vertAxisProps[0].getAxisType()===Asc.c_oAscAxisType.val?this.addControlsV(e):this.addControlsH(e)),1<this.vertAxisProps.length&&(e=this.$window.find("#id-chart-settings-dlg-vert-sec"),this.vertAxisPropsIndexes[1]=this.vertAxisProps[1].getAxisType()===Asc.c_oAscAxisType.val?this.addControlsV(e):this.addControlsH(e)),this.horAxisProps=t.getHorAxesProps(),0<this.horAxisProps.length&&(e=this.$window.find("#id-chart-settings-dlg-hor"),this.horAxisPropsIndexes[0]=this.horAxisProps[0].getAxisType()===Asc.c_oAscAxisType.val?this.addControlsV(e):this.addControlsH(e)),1<this.horAxisProps.length&&(e=this.$window.find("#id-chart-settings-dlg-hor-sec"),this.horAxisPropsIndexes[1]=this.horAxisProps[1].getAxisType()===Asc.c_oAscAxisType.val?this.addControlsV(e):this.addControlsH(e)),Common.UI.FocusManager.add(this,[this.radioTwoCell,this.radioOneCell,this.radioAbsolute,this.inputAltTitle,this.textareaAltDescription]),this.updateAxisProps(this._state.ChartType),this.currentChartType=this._state.ChartType,this.imageSettings)switch(i=this.imageSettings.asc_getTitle(),this.inputAltTitle.setValue(i||""),i=this.imageSettings.asc_getDescription(),this.textareaAltDescription.val(i||""),i=this.imageSettings.asc_getAnchor()){case AscCommon.c_oAscCellAnchorType.cellanchorTwoCell:this.radioTwoCell.setValue(!0,!0);break;case AscCommon.c_oAscCellAnchorType.cellanchorOneCell:this.radioOneCell.setValue(!0,!0);break;case AscCommon.c_oAscCellAnchorType.cellanchorAbsolute:this.radioAbsolute.setValue(!0,!0)}}else{Common.UI.FocusManager.add(this,[this.cmbEmptyCells,this.chShowEmpty,this.chShowAxis,this.chReverse,this.cmbSparkMinType,this.spnSparkMinValue,this.cmbSparkMaxType,this.spnSparkMaxValue]),this._state.SparkType=t.asc_getType();var s=this.mnuSparkTypePicker.store.findWhere({type:this._state.SparkType}),i=(this.mnuSparkTypePicker.selectRecord(s,!0),s?this.btnSparkType.setIconCls("svgicon chart-"+s.get("iconCls")):this.btnSparkType.setIconCls("svgicon"),this.updateSparkStyles(this.sparklineStyles||t.asc_getStyles()),this._state.SparkType!==Asc.c_oAscSparklineType.Line&&this._arrEmptyCells.pop(),this.cmbEmptyCells.setData(this._arrEmptyCells),t.asc_getDisplayEmpty());this.cmbEmptyCells.setValue(this._state.SparkType!==Asc.c_oAscSparklineType.Line&&i==Asc.c_oAscEDispBlanksAs.Span?this.textEmptyLine:i),this.chShowEmpty.setValue(t.asc_getDisplayHidden(),!0),this.chShowAxis.setValue(t.asc_getDisplayXAxis(),!0),this.chReverse.setValue(t.asc_getRightToLeft(),!0),this.cmbSparkMinType.setValue(t.asc_getMinAxisType(),!0),this.cmbSparkMaxType.setValue(t.asc_getMaxAxisType(),!0),this.spnSparkMinValue.setDisabled(t.asc_getMinAxisType()!==Asc.c_oAscSparklineAxisMinMax.Custom),this.spnSparkMaxValue.setDisabled(t.asc_getMaxAxisType()!==Asc.c_oAscSparklineAxisMinMax.Custom),this.spnSparkMinValue.setValue(null!==t.asc_getManualMin()?t.asc_getManualMin():"",!0),this.spnSparkMaxValue.setValue(null!==t.asc_getManualMax()?t.asc_getManualMax():"",!0),this._changedProps=new Asc.sparklineGroup,this._noApply=!1}},getSettings:function(){var t,e;return this.isChart?(t=this.currentChartType,this.isDiagramMode&&(e=this.mnuChartTypePicker.getSelectedRec())&&(t=e.get("type")),this.chartSettings.putType(t),this.chartSettings.putTitle(this.cmbChartTitle.getValue()),this.chartSettings.putLegendPos(this.cmbLegendPos.getValue()),this.chartSettings.putDataLabelsPos(this.cmbDataLabels.getValue()),this.chartSettings.putShowSerName("checked"==this.chSeriesName.getValue()),this.chartSettings.putShowCatName("checked"==this.chCategoryName.getValue()),this.chartSettings.putShowVal("checked"==this.chValue.getValue()),this.chartSettings.putShowPercent("checked"==this.chPercent.getValue()),this.chartSettings.putSeparator(_.isEmpty(this.txtSeparator.getValue())?" ":this.txtSeparator.getValue()),this.chMarkers.isVisible()&&this.chartSettings.putShowMarker("checked"==this.chMarkers.getValue()),(t==Asc.c_oAscChartTypeSettings.lineNormal||t==Asc.c_oAscChartTypeSettings.lineStacked||t==Asc.c_oAscChartTypeSettings.lineStackedPer||t==Asc.c_oAscChartTypeSettings.lineNormalMarker||t==Asc.c_oAscChartTypeSettings.lineStackedMarker||t==Asc.c_oAscChartTypeSettings.lineStackedPerMarker||t==Asc.c_oAscChartTypeSettings.scatter||t==Asc.c_oAscChartTypeSettings.scatterSmoothMarker||t==Asc.c_oAscChartTypeSettings.scatterSmooth||t==Asc.c_oAscChartTypeSettings.scatterLineMarker||t==Asc.c_oAscChartTypeSettings.scatterLine)&&(e=this.cmbLines.getValue(),this.chartSettings.putLine(0!==e),0<e&&this.chartSettings.putSmooth(2==e)),!this.isAltTitleChanged&&!this.isAltDescChanged||this._changedImageProps||(this._changedImageProps=new Asc.asc_CImgProperty),this.isAltTitleChanged&&this._changedImageProps.asc_putTitle(this.inputAltTitle.getValue()),this.isAltDescChanged&&this._changedImageProps.asc_putDescription(this.textareaAltDescription.val()),{chartSettings:this.chartSettings,imageSettings:this._changedImageProps}):{chartSettings:this._changedProps}},onRadioSnapChange:function(t,e,i){e&&(this._changedImageProps||(this._changedImageProps=new Asc.asc_CImgProperty),this._changedImageProps.asc_putAnchor(t.options.value))},isRangeValid:function(){var t,e,i;return!this.isChart||(t=this.chartSettings.getRange(),!!_.isEmpty(t)||(e=this.currentChartType,this.isDiagramMode&&(i=this.mnuChartTypePicker.getSelectedRec())&&(e=i.get("type")),(i=this.api.asc_checkDataRange(Asc.c_oAscSelectionDialogType.Chart,t,!0,this.chartSettings.getInRows(),e))==Asc.c_oAscError.ID.No||(this.setActiveCategory(0),i==Asc.c_oAscError.ID.StockChartError?Common.UI.warning({msg:this.errorStockChart}):i==Asc.c_oAscError.ID.MaxDataSeriesError?Common.UI.warning({msg:this.errorMaxRows}):i==Asc.c_oAscError.ID.MaxDataPointsError&&Common.UI.warning({msg:this.errorMaxPoints}),!1)))},onSelectDataLabels:function(t,e,i){e=e.value==Asc.c_oAscChartDataLabelsPos.none;this.chSeriesName.setDisabled(e),this.chCategoryName.setDisabled(e),this.chValue.setDisabled(e),this.chPercent.setDisabled(e),this.txtSeparator.setDisabled(e),e||"checked"===this.chSeriesName.getValue()||"checked"===this.chCategoryName.getValue()||"checked"===this.chValue.getValue()||"checked"===this.chPercent.getValue()||this.chValue.setValue("checked",!0)},onSelectSparkData:function(){var t,e,i=this;i.api&&(t=new SSE.Views.CellRangeDialog({handler:function(t,e){"ok"==e&&(i.sparkDataRangeValid=t.getSettings(),i.txtSparkDataRange.setValue(i.sparkDataRangeValid),i.txtSparkDataRange.checkValidate())}}).on("close",function(){i.show()}),e=i.$window.offset(),i.hide(),t.show(e.left+160,e.top+125),t.setSettings({api:i.api,range:_.isEmpty(i.txtSparkDataRange.getValue())||1!=i.txtSparkDataRange.checkValidate()?i.sparkDataRangeValid:i.txtSparkDataRange.getValue(),type:Asc.c_oAscSelectionDialogType.Chart}))},onSelectLocationData:function(){var t,e,i=this;i.api&&(t=new SSE.Views.CellRangeDialog({handler:function(t,e){"ok"==e&&(i.dataLocationRangeValid=t.getSettings(),i.txtSparkDataLocation.setValue(i.dataLocationRangeValid),i.txtSparkDataLocation.checkValidate())}}).on("close",function(){i.show()}),e=i.$window.offset(),i.hide(),t.show(e.left+160,e.top+125),t.setSettings({api:i.api,range:_.isEmpty(i.txtSparkDataLocation.getValue())||1!=i.txtSparkDataLocation.checkValidate()?i.dataLocationRangeValid:i.txtSparkDataLocation.getValue(),type:Asc.c_oAscSelectionDialogType.FormatTable}))},openFormat:function(t){var i=this,s=i.currentAxisProps[t].getNumFmt(),t=i.api.asc_getLocale(),e=Common.Utils.InternalSettings.get("sse-config-lang"),t=t||(e?parseInt(Common.util.LanguageInfo.getLocalLanguageCode(e)):1033),e=new SSE.Views.FormatSettingsDialog({api:i.api,handler:function(t,e){"ok"==t&&e&&(s.putSourceLinked(e.linked),s.putFormatCode(e.format),i.chartSettings.endEditData(),i._isEditFormat=!1)},linked:!0,props:{format:s.getFormatCode(),formatInfo:s.getFormatCellsInfo(),langId:t,chartFormat:s}}).on("close",function(){i._isEditFormat&&i.chartSettings.cancelEditData(),i._isEditFormat=!1});i._isEditFormat=!0,i.chartSettings.startEditData(),e.show()},show:function(){Common.Views.AdvancedSettingsWindow.prototype.show.apply(this,arguments)},close:function(){this.api.asc_onCloseChartFrame(),Common.Views.AdvancedSettingsWindow.prototype.close.apply(this,arguments)}},SSE.Views.ChartSettingsDlg||{}))}),define("spreadsheeteditor/main/app/view/ChartDataDialog",["common/main/lib/util/utils","common/main/lib/component/MetricSpinner","common/main/lib/component/ComboBox","common/main/lib/component/ListView","common/main/lib/view/AdvancedSettingsWindow"],function(){"use strict";SSE.Views.ChartDataDialog=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:370,height:490,id:"window-chart-data"},initialize:function(t){_.extend(this.options,{title:this.textTitle,template:['<div class="box" style="height:'+(this.options.height-85)+'px;">','<div class="content-panel" style="padding: 0 10px;"><div class="inner-content">','<div class="settings-panel active">','<table cols="1" style="width: 100%;">',"<tr>","<td>",'<label class="input-label">',this.textData,"</label>","</td>","</tr>","<tr>",'<td class="padding-small" width="200">','<div id="chart-dlg-txt-range" class="input-row" style=""></div>',"</td>","</tr>","<tr>",'<td class="padding-small">','<label class="input-label">',this.textSeries,"</label>",'<div id="chart-dlg-series-list" class="" style="width:100%; height: 93px;"></div>',"</td>","</tr>","<tr>",'<td class="padding-large">','<button type="button" class="btn btn-text-default auto margin-right-5" id="chart-dlg-btn-add">',this.textAdd,"</button>",'<button type="button" class="btn btn-text-default auto margin-right-5" id="chart-dlg-btn-edit">',this.textEdit,"</button>",'<button type="button" class="btn btn-text-default auto margin-right-5" id="chart-dlg-btn-delete">',this.textDelete,"</button>",'<div class="up-down-btns float-right">','<div id="chart-dlg-btn-up" class="margin-right-2"></div>','<div id="chart-dlg-btn-down"></div>',"</div>","</td>","</tr>","<tr>",'<td class="padding-large">','<button type="button" class="btn btn-text-default auto margin-right-5" id="chart-dlg-btn-switch" style="min-width: 70px;">',this.textSwitch,"</button>","</td>","</tr>","<tr>",'<td class="padding-small">','<label class="input-label">',this.textCategory,"</label>",'<div id="chart-dlg-category-list" class="" style="width:100%; height: 93px;"></div>',"</td>","</tr>","<tr>",'<td class="padding-small">','<button type="button" class="btn btn-text-default auto margin-right-5" id="chart-dlg-btn-category-edit" style="min-width: 70px;">',this.textEdit,"</button>","</td>","</tr>","</table>","</div></div>","</div>","</div>",'<div class="separator horizontal"></div>'].join("")},t),this.handler=t.handler,Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options),this._noApply=!0,this._changedProps=null,this.api=this.options.api,this.chartSettings=this.options.chartSettings,this.currentChartType=Asc.c_oAscChartTypeSettings.barNormal,this._isOpen=!1},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var o=this;this.on("animate:after",_.bind(this.onAnimateAfter,this)),this.txtDataRange=new Common.UI.InputFieldBtn({el:$("#chart-dlg-txt-range"),name:"range",style:"width: 100%;",btnHint:this.textSelectData,allowBlank:!0}),this.txtDataRange.on("button:click",_.bind(this.onSelectData,this)),this.txtDataRange.on("changed:after",function(t,e,i,s){e!=i&&o.changeChartRange(e)}),this.seriesList=new Common.UI.ListView({el:$("#chart-dlg-series-list",this.$window),store:new Common.UI.DataViewStore,emptyText:"",scrollAlwaysVisible:!0,itemTemplate:_.template('<div id="<%= id %>" class="list-item" style="min-height: 15px;"><%= Common.Utils.String.htmlEncode(value) %></div>'),tabindex:1}),this.seriesList.onKeyDown=_.bind(this.onListKeyDown,this,"series"),this.seriesList.on("item:select",_.bind(this.onSelectSeries,this)),this.seriesList.store.comparator=function(t){return t.get("order")},this.btnAdd=new Common.UI.Button({el:$("#chart-dlg-btn-add")}),this.btnAdd.on("click",_.bind(this.onAddSeries,this,!1)),this.btnDelete=new Common.UI.Button({el:$("#chart-dlg-btn-delete")}),this.btnDelete.on("click",_.bind(this.onDeleteSeries,this)),this.btnEdit=new Common.UI.Button({el:$("#chart-dlg-btn-edit")}),this.btnEdit.on("click",_.bind(this.onEditSeries,this,!1)),this.btnUp=new Common.UI.Button({parentEl:$("#chart-dlg-btn-up"),cls:"btn-toolbar bg-white",iconCls:"caret-up",scaling:!1,hint:this.textUp}),this.btnUp.on("click",_.bind(this.onMoveClick,this,!0)),this.btnDown=new Common.UI.Button({parentEl:$("#chart-dlg-btn-down"),cls:"btn-toolbar bg-white",iconCls:"caret-down",scaling:!1,hint:this.textDown}),this.btnDown.on("click",_.bind(this.onMoveClick,this,!1)),this.btnSwitch=new Common.UI.Button({el:$("#chart-dlg-btn-switch")}),this.btnSwitch.on("click",_.bind(this.onSwitch,this)),this.categoryList=new Common.UI.ListView({el:$("#chart-dlg-category-list",this.$window),store:new Common.UI.DataViewStore,emptyText:"",scrollAlwaysVisible:!0,itemTemplate:_.template('<div id="<%= id %>" class="list-item" style="min-height: 15px;"><%= Common.Utils.String.htmlEncode(value) %></div>'),tabindex:1}),this.btnEditCategory=new Common.UI.Button({el:$("#chart-dlg-btn-category-edit")}),this.btnEditCategory.on("click",_.bind(this.onEditCategory,this,!1)),this.afterRender()},getFocusedComponents:function(){return[this.txtDataRange,this.seriesList,this.btnAdd,this.btnEdit,this.btnDelete,this.btnUp,this.btnDown,this.btnSwitch,this.categoryList,this.btnEditCategory]},getDefaultFocusableComponent:function(){return this.txtDataRange},afterRender:function(){this._setDefaults(this.chartSettings)},onAnimateAfter:function(){this.chartSettings&&!this._isOpen&&(this.updateCategoryList(this.chartSettings.getCatValues(),!0),this._isOpen=!0)},close:function(){this.clearCategoryListTimer(),this.api.asc_onCloseChartFrame(),Common.Views.AdvancedSettingsWindow.prototype.close.apply(this,arguments)},_setDefaults:function(t){var e;t&&(this.chartSettings=t,this.currentChartType=t.getType(),e=t.getRange(),this.txtDataRange.setValue(e||""),this.txtDataRange.validation=function(t){return!0},this.updateSeriesList(t.getSeries(),0),this.updateCategoryList(t.getCatValues())),this.updateButtons()},getSettings:function(){return{chartSettings:this.chartSettings}},onDlgBtnClick:function(t){t="object"==typeof t?t.currentTarget.attributes.result.value:t;if("ok"==t){if(!this.isRangeValid())return;this.handler&&this.handler.call(this,t,"ok"==t?this.getSettings():void 0)}this.close()},onPrimary:function(){return this.onDlgBtnClick("ok"),!1},isRangeValid:function(){var t=this.chartSettings.isValidRange(this.txtDataRange.getValue());if(!0===t||t==Asc.c_oAscError.ID.No)return!0;var e=this.textInvalidRange;switch(t){case Asc.c_oAscError.ID.StockChartError:e=this.errorStockChart;break;case Asc.c_oAscError.ID.MaxDataSeriesError:e=this.errorMaxRows;break;case Asc.c_oAscError.ID.MaxDataPointsError:e=this.errorMaxPoints;break;case Asc.c_oAscError.ID.ErrorInFormula:e=this.errorInFormula;break;case Asc.c_oAscError.ID.InvalidReference:e=this.errorInvalidReference;break;case Asc.c_oAscError.ID.NoSingleRowCol:e=this.errorNoSingleRowCol;break;case Asc.c_oAscError.ID.NoValues:e=this.errorNoValues}return Common.UI.warning({msg:e,maxwidth:600}),!1},changeChartRange:function(t){this.isRangeValid(t)&&(this.txtDataRange.checkValidate(),this.chartSettings.setRange(t),this.updateSeriesList(this.chartSettings.getSeries(),0),this.updateCategoryList(this.chartSettings.getCatValues()),this.updateButtons())},onSelectData:function(i){var t,e,s=this;s.api&&(t=new SSE.Views.CellRangeDialog({handler:function(t,e){"ok"==e&&(i.setValue(t.getSettings()),_.delay(function(){s.changeChartRange(t.getSettings())},10))}}).on("close",function(){s.show()}),e=s.$window.offset(),s.hide(),t.show(e.left+160,e.top+125),t.setSettings({api:s.api,range:s.txtDataRange.getValue(),type:Asc.c_oAscSelectionDialogType.Chart,validation:function(){return!0}}))},onListKeyDown:function(t,e,i){var s=this.seriesList;s.disabled||(i=_.isUndefined(void 0)?e:i).keyCode==Common.UI.Keys.DELETE&&!this.btnDelete.isDisabled()||Common.UI.DataView.prototype.onKeyDown.call(s,e,i)},onSelectSeries:function(t,e,i){this.updateMoveButtons()},updateRange:function(){this.txtDataRange.setValue(this.chartSettings.getRange()||"")},updateButtons:function(){this.btnEdit.setDisabled(this.seriesList.store.length<1),this.btnDelete.setDisabled(this.seriesList.store.length<1),this.btnSwitch.setDisabled(this.seriesList.store.length<1||!this.chartSettings.getRange()),this.updateMoveButtons()},updateMoveButtons:function(){var t=this.seriesList.getSelectedRec(),t=t?this.seriesList.store.indexOf(t):-1;this.btnUp.setDisabled(t<1),this.btnDown.setDisabled(t<0||t==this.seriesList.store.length-1)},onAddSeries:function(){var i=this,t=(i.chartSettings.startEditData(),i.chartSettings.addSeries()),e=t.asc_IsScatter();this.changeDataRange(1,{series:t,isScatter:e},function(t,e){"ok"==e&&(i.updateRange(),i.updateSeriesList(i.chartSettings.getSeries(),i.seriesList.store.length-1),i.updateCategoryList(i.chartSettings.getCatValues()),i.updateButtons(),i.chartSettings.endEditData(),i._isEditRanges=!1)})},onDeleteSeries:function(){var t,e=this.seriesList.getSelectedRec();e&&(t=e.get("order"),e.get("series").asc_Remove(),this.updateRange(),this.updateSeriesList(this.chartSettings.getSeries(),t),this.updateCategoryList(this.chartSettings.getCatValues()),this.updateButtons())},onEditSeries:function(){var i,t,s,o=this.seriesList.getSelectedRec();o&&(t=(i=o.get("series")).asc_IsScatter(),(s=this).chartSettings.startEditData(),this.changeDataRange(1,{series:i,isScatter:t},function(t,e){"ok"==e&&(o.set("value",i.asc_getSeriesName()),s.updateRange(),s.updateCategoryList(s.chartSettings.getCatValues()),s.updateButtons(),s.chartSettings.endEditData(),s._isEditRanges=!1)}))},onEditCategory:function(){var i=this;i.chartSettings.startEditData(),this.changeDataRange(0,{category:this.chartSettings.getCatFormula(),values:this.chartSettings.getCatValues()},function(t,e){"ok"==e&&(i.updateCategoryList(i.chartSettings.getCatValues()),i.updateRange(),i.updateButtons(),i.chartSettings.endEditData(),i._isEditRanges=!1)})},changeDataRange:function(t,e,i){var s=this,t=new SSE.Views.ChartDataRangeDialog({type:t,isScatter:!!e.isScatter,handler:i}).on("close",function(){s._isEditRanges&&s.chartSettings.cancelEditData(),s._isEditRanges=!1,s.show()}),i=(s._isEditRanges=!0,s.$window.offset());s.hide(),t.show(i.left+160,i.top+125),t.setSettings({api:s.api,props:e,chartSettings:s.chartSettings})},onMoveClick:function(t){var e,i,s,o=this.seriesList.store,n=o.length,a=this.seriesList.getSelectedRec();a&&(i=o.indexOf(a),e=a.get("order"),n=t?Math.max(0,i-1):Math.min(n-1,i+1),s=(i=o.at(n)).get("order"),o.add(o.remove(a),{at:n}),a.set("order",s),i.set("order",e),t?a.get("series").asc_MoveUp():a.get("series").asc_MoveDown(),this.seriesList.selectRecord(a),this.seriesList.scrollToRecord(a),this.updateRange(),this.updateCategoryList(this.chartSettings.getCatValues()),this.updateButtons())},updateSeriesList:function(t,e){this.btnEditCategory.setDisabled(!!(t&&0<t.length)&&t[0].asc_IsScatter());for(var i=[],s=this.seriesList.store,o=0,n=t.length;o<n;o++){var a=t[o],l=new Common.UI.DataViewModel;l.set({value:a.asc_getSeriesName(),index:a.asc_getIdx(),order:a.asc_getOrder(),series:a}),i.push(l)}s.reset(i),0<n&&this.seriesList.selectByIndex(Math.min(e||0,s.length-1))},updateCategoryList:function(e,t){this.clearCategoryListTimer();function i(t){s._categoryListIndex=t,s._loadCategoryListTimer=setInterval(function(){s._categoryListIndex+1>=n?s.clearCategoryListTimer():(o.add(a(e.slice(s._categoryListIndex,s._categoryListIndex+10))),s._categoryListIndex+=10)},10)}var s=this,o=this.categoryList.store,n=e.length,a=function(t){for(var e=[],i=0,s=t.length;i<s;i++){var o=t[i],n=new Common.UI.DataViewModel;n.set({value:o}),e.push(n)}return e};t?n>o.length&&i(10):(e.length<10?o.reset(a(e)):(o.reset(a(e.slice(0,9))),this._isOpen&&_.defer(function(){i(10)},0)),0<n&&this.categoryList.selectByIndex(0))},clearCategoryListTimer:function(){this._loadCategoryListTimer&&(clearInterval(this._loadCategoryListTimer),this._loadCategoryListTimer=void 0)},onSwitch:function(){this.chartSettings.switchRowCol()===Asc.c_oAscError.ID.MaxDataSeriesError?Common.UI.warning({msg:this.errorMaxRows,maxwidth:600}):(this.updateSeriesList(this.chartSettings.getSeries(),0),this.updateCategoryList(this.chartSettings.getCatValues()),this.updateRange(),this.updateButtons())}},SSE.Views.ChartDataDialog||{}))}),define("spreadsheeteditor/main/app/view/ChartSettings",["text!spreadsheeteditor/main/app/template/ChartSettings.template","jquery","underscore","backbone","common/main/lib/component/Button","common/main/lib/component/MetricSpinner","common/main/lib/component/ComboDataView","spreadsheeteditor/main/app/view/ChartSettingsDlg","spreadsheeteditor/main/app/view/ChartDataDialog","spreadsheeteditor/main/app/view/ChartWizardDialog"],function(t,l,d,e){"use strict";SSE.Views.ChartSettings=e.View.extend(d.extend({el:"#id-chart-settings",template:d.template(t),events:{},options:{alias:"ChartSettings"},initialize:function(){this._initSettings=!0,this.txtPt=Common.Utils.Metric.getMetricName(Common.Utils.Metric.c_MetricUnits.pt),this._state={Width:0,Height:0,ChartStyle:1,ChartType:-1,SeveralCharts:!1,DisabledControls:!1,keepRatio:!1,SparkType:-1,SparkStyle:1,LineWeight:1,MarkersPoint:!1,HighPoint:!1,LowPoint:!1,FirstPoint:!1,LastPoint:!1,NegativePoint:!1,SparkColor:"000000",MarkersColor:this.defColor,HighColor:this.defColor,LowColor:this.defColor,FirstColor:this.defColor,LastColor:this.defColor,NegativeColor:this.defColor,SparkId:void 0},this._nRatio=1,this.spinners=[],this.chPoints=[],this.lockedControls=[],this._locked=!1,this.defColor={color:"4f81bd",effectId:24},this.isChart=!0,this._noApply=!1,this._originalProps=null,this.render(),this.ChartSizeContainer=l("#chart-panel-size"),this.ChartTypesContainer=l("#chart-panel-types"),this.SparkTypesContainer=l("#spark-panel-types"),this.SparkPointsContainer=l("#spark-panel-points"),this.NotCombinedSettings=l(".not-combined"),this.Chart3DContainer=l("#chart-panel-3d-rotate")},render:function(){l(this.el).html(this.template({scope:this}))},setApi:function(t){return this.api=t,this.api&&(this.api.asc_registerCallback("asc_onUpdateChartStyles",d.bind(this._onUpdateChartStyles,this)),this.api.asc_registerCallback("asc_onAddChartStylesPreview",d.bind(this.onAddChartStylesPreview,this))),this},ChangeSettings:function(t){if(this._initSettings&&this.createDelayedElements(),this._isEditType)this._props=t;else{var e=!!(t&&t.asc_getChartProperties&&t.asc_getChartProperties()),i=e?this.api.asc_getChartObject(!0):null,s=i?i.getView3d():null;if(this.isChart===e&&this._state.is3D===!!s||this.ShowHideElem(e,!!s),this._state.is3D=!!s,this.disableControls(this._locked),this.api&&t)if(e){this._originalProps=new Asc.asc_CImgProperty(t),this.isChart=!0,this._noApply=!0,this.chartProps=t.asc_getChartProperties();var e=t.asc_getSeveralCharts()||this._locked,o=(this._state.SeveralCharts!==e&&(this.linkAdvanced.toggleClass("disabled",e),this._state.SeveralCharts=e),e=t.asc_getSeveralChartTypes(),this._state.SeveralCharts&&e?null:this.chartProps.getType()),n=(this._state.ChartType!==o&&(this.ShowCombinedProps(o),null!==o&&o!=Asc.c_oAscChartTypeSettings.comboBarLine&&o!=Asc.c_oAscChartTypeSettings.comboBarLineSecondary&&o!=Asc.c_oAscChartTypeSettings.comboAreaBar&&o!=Asc.c_oAscChartTypeSettings.comboCustom&&this.updateChartStyles(this.api.asc_getChartPreviews(o,void 0,!0)),this._state.ChartType=o),o!=Asc.c_oAscChartTypeSettings.comboBarLine&&o!=Asc.c_oAscChartTypeSettings.comboBarLineSecondary&&o!=Asc.c_oAscChartTypeSettings.comboAreaBar&&o!=Asc.c_oAscChartTypeSettings.comboCustom&&(e=t.asc_getSeveralChartStyles(),this._state.SeveralCharts&&e?(this.cmbChartStyle.fieldPicker.deselectAll(),this.cmbChartStyle.menuPicker.deselectAll(),this._state.ChartStyle=null):(e=this.chartProps.getStyle(),this._state.ChartStyle===e&&!this._isChartStylesChanged||(this._state.ChartStyle=e,n=this.selectCurrentChartStyle(),this._isChartStylesChanged&&this.api.asc_generateChartPreviews(this._state.ChartType,n))),this._isChartStylesChanged=!1),this._noApply=!1,e=t.asc_getWidth(),(.001<Math.abs(this._state.Width-e)||(null===this._state.Width||null===e)&&this._state.Width!==e)&&(this.spnWidth.setValue(null!==e?Common.Utils.Metric.fnRecalcFromMM(e):"",!0),this._state.Width=e),e=t.asc_getHeight(),(.001<Math.abs(this._state.Height-e)||(null===this._state.Height||null===e)&&this._state.Height!==e)&&(this.spnHeight.setValue(null!==e?Common.Utils.Metric.fnRecalcFromMM(e):"",!0),this._state.Height=e),0<t.asc_getHeight()&&(this._nRatio=t.asc_getWidth()/t.asc_getHeight()),e=t.asc_getLockAspect(),this._state.keepRatio!==e&&(this.btnRatio.toggle(e),this._state.keepRatio=e),i?i.getSeries():null);this.btnSwitch.setDisabled(this._locked||!n||n.length<1||!i||!i.getRange()),s&&(e=s.asc_getRotX(),((void 0===this._state.X||void 0===e)&&this._state.X!==e||.001<Math.abs(this._state.X-e))&&(this.spnX.setValue(null!=e?e:"",!0),this._state.X=e),e=s.asc_getRotY(),((void 0===this._state.Y||void 0===e)&&this._state.Y!==e||.001<Math.abs(this._state.Y-e))&&(this.spnY.setValue(null!=e?e:"",!0),this._state.Y=e),e=s.asc_getRightAngleAxes(),this._state.RightAngle!==e&&(this.chRightAngle.setValue(null!=e?e:"indeterminate",!0),this._state.RightAngle=e),e=s.asc_getPerspective(),((void 0===this._state.Perspective||void 0===e)&&this._state.Perspective!==e||.001<Math.abs(this._state.Perspective-e))&&(this.spnPerspective.setMinValue(null!=e?.1:0),this.spnPerspective.setValue(null!=e?e:0,!0),this._state.Perspective=e),this.spnPerspective.setDisabled(this._locked||!!this._state.RightAngle),this.btnNarrow.setDisabled(this._locked||!!this._state.RightAngle),this.btnWiden.setDisabled(this._locked||!!this._state.RightAngle),e=s.asc_getDepth(),(.001<Math.abs(this._state.Depth-e)||(void 0===this._state.Depth||void 0===e)&&this._state.Depth!==e)&&(this.spn3DDepth.setValue(null!=e?e:"",!0),this._state.Depth=e),e=s.asc_getHeight(),(.001<Math.abs(this._state.Height3d-e)||(void 0===this._state.Height3d||null===this._state.Height3d||null===e)&&this._state.Height3d!==e)&&(null!==e&&this.spn3DHeight.setValue(e,!0),this.chAutoscale.setValue(null===e,!0),this._state.Height3d=e),this.spn3DHeight.setDisabled(this._locked||null===e))}else{this._originalProps=t,this.isChart=!1,this._state.SparkId=t.asc_getId();var o=t.asc_getType(),n=!1,a=(this._state.SparkType!==o&&(i=this.mnuSparkTypePicker.store.findWhere({type:o}),this.mnuSparkTypePicker.selectRecord(i,!0),i?this.btnSparkType.setIconCls("svgicon chart-"+i.get("iconCls")):this.btnSparkType.setIconCls("svgicon"),this._state.SparkType=o,n=!0),t.asc_getLineWeight()),s=Math.abs(this._state.LineWeight-a)<.001&&!new RegExp(this.txtPt+"\\s*$").test(this.cmbBorderSize.getRawValue()),i=((.001<Math.abs(this._state.LineWeight-a)||s||(null===this._state.LineWeight||null===a)&&this._state.LineWeight!==a)&&((e=null===(this._state.LineWeight=a)?a:d.find(this.cmbBorderSize.store.models,function(t){if(a<t.attributes.value+.01&&a>t.attributes.value-.01)return!0}))?this.cmbBorderSize.selectRecord(e):this.cmbBorderSize.setValue(null!==a?parseFloat(a.toFixed(2))+" "+this.txtPt:""),this.BorderSize=a),this.cmbBorderSize.setDisabled(this._locked||this._state.SparkType!==Asc.c_oAscSparklineType.Line),t.asc_getColorSeries());if(i)if(this.SparkColor=i.asc_getType()==Asc.c_oAscColor.COLOR_TYPE_SCHEME?{color:Common.Utils.ThemeColor.getHexColor(i.asc_getR(),i.asc_getG(),i.asc_getB()),effectValue:i.asc_getValue()}:Common.Utils.ThemeColor.getHexColor(i.asc_getR(),i.asc_getG(),i.asc_getB()),(c=typeof this.SparkColor)!==typeof this._state.SparkColor||"object"==c&&(this.SparkColor.effectValue!==this._state.SparkColor.effectValue||this._state.SparkColor.color.indexOf(this.SparkColor.color)<0)||"object"!=c&&(this._state.SparkColor.indexOf(this.SparkColor)<0||"object"==typeof this.btnSparkColor.color)){if(this.btnSparkColor.setColor(this.SparkColor),"object"==typeof this.SparkColor){for(var l=!1,r=0;r<10;r++)if(Common.Utils.ThemeColor.ThemeValues[r]==this.SparkColor.effectValue){this.colorsSpark.select(this.SparkColor,!0),l=!0;break}l||this.colorsSpark.clearSelection()}else this.colorsSpark.select(this.SparkColor,!0);this._state.SparkColor=this.SparkColor}var c,o=t.asc_getMarkersPoint(),i=t.asc_getColorMarkers();if(this._state.MarkersPoint!==o&&(this.chMarkersPoint.setValue(null!=o?o:"indeterminate",!0),this._state.MarkersPoint=o,n=!0),this.chMarkersPoint.setDisabled(this._locked||this._state.SparkType!==Asc.c_oAscSparklineType.Line),this.btnMarkersColor.setDisabled(this._locked||this._state.SparkType!==Asc.c_oAscSparklineType.Line),i)if(this.MarkersColor=i.asc_getType()==Asc.c_oAscColor.COLOR_TYPE_SCHEME?{color:Common.Utils.ThemeColor.getHexColor(i.asc_getR(),i.asc_getG(),i.asc_getB()),effectValue:i.asc_getValue()}:Common.Utils.ThemeColor.getHexColor(i.asc_getR(),i.asc_getG(),i.asc_getB()),(c=typeof this.MarkersColor)!==typeof this._state.MarkersColor||"object"==c&&(this.MarkersColor.effectValue!==this._state.MarkersColor.effectValue||this._state.MarkersColor.color.indexOf(this.MarkersColor.color)<0)||"object"!=c&&(this._state.MarkersColor.indexOf(this.MarkersColor)<0||"object"==typeof this.btnMarkersColor.color)){if(this.btnMarkersColor.setColor(this.MarkersColor),"object"==typeof this.MarkersColor){for(l=!1,r=0;r<10;r++)if(Common.Utils.ThemeColor.ThemeValues[r]==this.MarkersColor.effectValue){this.colorsMarkers.select(this.MarkersColor,!0),l=!0;break}l||this.colorsMarkers.clearSelection()}else this.colorsMarkers.select(this.MarkersColor,!0);this._state.MarkersColor=this.MarkersColor,n=!0}if(o=t.asc_getHighPoint(),i=t.asc_getColorHigh(),this._state.HighPoint!==o&&(this.chHighPoint.setValue(null!=o?o:"indeterminate",!0),this._state.HighPoint=o,n=!0),i)if(this.HighColor=i.asc_getType()==Asc.c_oAscColor.COLOR_TYPE_SCHEME?{color:Common.Utils.ThemeColor.getHexColor(i.asc_getR(),i.asc_getG(),i.asc_getB()),effectValue:i.asc_getValue()}:Common.Utils.ThemeColor.getHexColor(i.asc_getR(),i.asc_getG(),i.asc_getB()),(c=typeof this.HighColor)!==typeof this._state.HighColor||"object"==c&&(this.HighColor.effectValue!==this._state.HighColor.effectValue||this._state.HighColor.color.indexOf(this.HighColor.color)<0)||"object"!=c&&(this._state.HighColor.indexOf(this.HighColor)<0||"object"==typeof this.btnHighColor.color)){if(this.btnHighColor.setColor(this.HighColor),"object"==typeof this.HighColor){for(l=!1,r=0;r<10;r++)if(Common.Utils.ThemeColor.ThemeValues[r]==this.HighColor.effectValue){this.colorsHigh.select(this.HighColor,!0),l=!0;break}l||this.colorsHigh.clearSelection()}else this.colorsHigh.select(this.HighColor,!0);this._state.HighColor=this.HighColor,n=!0}if(o=t.asc_getLowPoint(),i=t.asc_getColorLow(),this._state.LowPoint!==o&&(this.chLowPoint.setValue(null!=o?o:"indeterminate",!0),this._state.LowPoint=o,n=!0),i)if(this.LowColor=i.asc_getType()==Asc.c_oAscColor.COLOR_TYPE_SCHEME?{color:Common.Utils.ThemeColor.getHexColor(i.asc_getR(),i.asc_getG(),i.asc_getB()),effectValue:i.asc_getValue()}:Common.Utils.ThemeColor.getHexColor(i.asc_getR(),i.asc_getG(),i.asc_getB()),(c=typeof this.LowColor)!==typeof this._state.LowColor||"object"==c&&(this.LowColor.effectValue!==this._state.LowColor.effectValue||this._state.LowColor.color.indexOf(this.LowColor.color)<0)||"object"!=c&&(this._state.LowColor.indexOf(this.LowColor)<0||"object"==typeof this.btnLowColor.color)){if(this.btnLowColor.setColor(this.LowColor),"object"==typeof this.LowColor){for(l=!1,r=0;r<10;r++)if(Common.Utils.ThemeColor.ThemeValues[r]==this.LowColor.effectValue){this.colorsLow.select(this.LowColor,!0),l=!0;break}l||this.colorsLow.clearSelection()}else this.colorsLow.select(this.LowColor,!0);this._state.LowColor=this.LowColor,n=!0}if(o=t.asc_getFirstPoint(),i=t.asc_getColorFirst(),this._state.FirstPoint!==o&&(this.chFirstPoint.setValue(null!=o?o:"indeterminate",!0),this._state.FirstPoint=o,n=!0),i)if(this.FirstColor=i.asc_getType()==Asc.c_oAscColor.COLOR_TYPE_SCHEME?{color:Common.Utils.ThemeColor.getHexColor(i.asc_getR(),i.asc_getG(),i.asc_getB()),effectValue:i.asc_getValue()}:Common.Utils.ThemeColor.getHexColor(i.asc_getR(),i.asc_getG(),i.asc_getB()),(c=typeof this.FirstColor)!==typeof this._state.FirstColor||"object"==c&&(this.FirstColor.effectValue!==this._state.FirstColor.effectValue||this._state.FirstColor.color.indexOf(this.FirstColor.color)<0)||"object"!=c&&(this._state.FirstColor.indexOf(this.FirstColor)<0||"object"==typeof this.btnFirstColor.color)){if(this.btnFirstColor.setColor(this.FirstColor),"object"==typeof this.FirstColor){for(l=!1,r=0;r<10;r++)if(Common.Utils.ThemeColor.ThemeValues[r]==this.FirstColor.effectValue){this.colorsFirst.select(this.FirstColor,!0),l=!0;break}l||this.colorsFirst.clearSelection()}else this.colorsFirst.select(this.FirstColor,!0);this._state.FirstColor=this.FirstColor,n=!0}if(o=t.asc_getLastPoint(),i=t.asc_getColorLast(),this._state.LastPoint!==o&&(this.chLastPoint.setValue(null!=o?o:"indeterminate",!0),this._state.LastPoint=o,n=!0),i)if(this.LastColor=i.asc_getType()==Asc.c_oAscColor.COLOR_TYPE_SCHEME?{color:Common.Utils.ThemeColor.getHexColor(i.asc_getR(),i.asc_getG(),i.asc_getB()),effectValue:i.asc_getValue()}:Common.Utils.ThemeColor.getHexColor(i.asc_getR(),i.asc_getG(),i.asc_getB()),(c=typeof this.LastColor)!==typeof this._state.LastColor||"object"==c&&(this.LastColor.effectValue!==this._state.LastColor.effectValue||this._state.LastColor.color.indexOf(this.LastColor.color)<0)||"object"!=c&&(this._state.LastColor.indexOf(this.LastColor)<0||"object"==typeof this.btnLastColor.color)){if(this.btnLastColor.setColor(this.LastColor),"object"==typeof this.LastColor){for(l=!1,r=0;r<10;r++)if(Common.Utils.ThemeColor.ThemeValues[r]==this.LastColor.effectValue){this.colorsLast.select(this.LastColor,!0),l=!0;break}l||this.colorsLast.clearSelection()}else this.colorsLast.select(this.LastColor,!0);this._state.LastColor=this.LastColor,n=!0}if(o=t.asc_getNegativePoint(),i=t.asc_getColorNegative(),this._state.NegativePoint!==o&&(this.chNegativePoint.setValue(null!=o?o:"indeterminate",!0),this._state.NegativePoint=o,n=!0),i)if(this.NegativeColor=i.asc_getType()==Asc.c_oAscColor.COLOR_TYPE_SCHEME?{color:Common.Utils.ThemeColor.getHexColor(i.asc_getR(),i.asc_getG(),i.asc_getB()),effectValue:i.asc_getValue()}:Common.Utils.ThemeColor.getHexColor(i.asc_getR(),i.asc_getG(),i.asc_getB()),(c=typeof this.NegativeColor)!==typeof this._state.NegativeColor||"object"==c&&(this.NegativeColor.effectValue!==this._state.NegativeColor.effectValue||this._state.NegativeColor.color.indexOf(this.NegativeColor.color)<0)||"object"!=c&&(this._state.NegativeColor.indexOf(this.NegativeColor)<0||"object"==typeof this.btnNegativeColor.color)){if(this.btnNegativeColor.setColor(this.NegativeColor),"object"==typeof this.NegativeColor){for(l=!1,r=0;r<10;r++)if(Common.Utils.ThemeColor.ThemeValues[r]==this.NegativeColor.effectValue){this.colorsNegative.select(this.NegativeColor,!0),l=!0;break}l||this.colorsNegative.clearSelection()}else this.colorsNegative.select(this.NegativeColor,!0);this._state.NegativeColor=this.NegativeColor,n=!0}n&&this.updateSparkStyles(t.asc_getStyles())}}},updateMetricUnit:function(){if(this.spinners){for(var t=0;t<this.spinners.length;t++){var e=this.spinners[t];e.setDefaultUnit(Common.Utils.Metric.getCurrentMetricName()),e.setStep(Common.Utils.Metric.getCurrentMetric()==Common.Utils.Metric.c_MetricUnits.pt?1:.1)}this.spnWidth&&this.spnWidth.setValue(null!==this._state.Width?Common.Utils.Metric.fnRecalcFromMM(this._state.Width):"",!0),this.spnHeight&&this.spnHeight.setValue(null!==this._state.Height?Common.Utils.Metric.fnRecalcFromMM(this._state.Height):"",!0)}},UpdateThemeColors:function(){var t;this._initSettings||(this.btnSparkColor||(t=this.defColor,this.btnSparkColor=new Common.UI.ColorButton({parentEl:l("#spark-color-btn"),color:"000000"}),this.lockedControls.push(this.btnSparkColor),this.colorsSpark=this.btnSparkColor.getPicker(),this.btnSparkColor.on("color:select",d.bind(this.onColorsSparkSelect,this)),this.btnHighColor=new Common.UI.ColorButton({parentEl:l("#spark-high-color-btn")}),this.btnHighColor.setColor(this.defColor.color),this.lockedControls.push(this.btnHighColor),this.colorsHigh=this.btnHighColor.getPicker(),this.btnHighColor.on("color:select",d.bind(this.onColorsPointSelect,this,0)),this.btnLowColor=new Common.UI.ColorButton({parentEl:l("#spark-low-color-btn")}),this.btnLowColor.setColor(this.defColor.color),this.lockedControls.push(this.btnLowColor),this.colorsLow=this.btnLowColor.getPicker(),this.btnLowColor.on("color:select",d.bind(this.onColorsPointSelect,this,1)),this.btnNegativeColor=new Common.UI.ColorButton({parentEl:l("#spark-negative-color-btn")}),this.btnNegativeColor.setColor(this.defColor.color),this.lockedControls.push(this.btnNegativeColor),this.colorsNegative=this.btnNegativeColor.getPicker(),this.btnNegativeColor.on("color:select",d.bind(this.onColorsPointSelect,this,2)),this.btnFirstColor=new Common.UI.ColorButton({parentEl:l("#spark-first-color-btn")}),this.lockedControls.push(this.btnFirstColor),this.btnFirstColor.setColor(this.defColor.color),this.colorsFirst=this.btnFirstColor.getPicker(),this.btnFirstColor.on("color:select",d.bind(this.onColorsPointSelect,this,3)),this.btnLastColor=new Common.UI.ColorButton({parentEl:l("#spark-last-color-btn")}),this.btnLastColor.setColor(this.defColor.color),this.lockedControls.push(this.btnLastColor),this.colorsLast=this.btnLastColor.getPicker(),this.btnLastColor.on("color:select",d.bind(this.onColorsPointSelect,this,4)),this.btnMarkersColor=new Common.UI.ColorButton({parentEl:l("#spark-markers-color-btn")}),this.btnMarkersColor.setColor(this.defColor.color),this.lockedControls.push(this.btnMarkersColor),this.colorsMarkers=this.btnMarkersColor.getPicker(),this.btnMarkersColor.on("color:select",d.bind(this.onColorsPointSelect,this,5))),this.colorsSpark.updateColors(Common.Utils.ThemeColor.getEffectColors(),Common.Utils.ThemeColor.getStandartColors()),this.colorsHigh.updateColors(Common.Utils.ThemeColor.getEffectColors(),Common.Utils.ThemeColor.getStandartColors(),t),this.colorsLow.updateColors(Common.Utils.ThemeColor.getEffectColors(),Common.Utils.ThemeColor.getStandartColors(),t),this.colorsNegative.updateColors(Common.Utils.ThemeColor.getEffectColors(),Common.Utils.ThemeColor.getStandartColors(),t),this.colorsFirst.updateColors(Common.Utils.ThemeColor.getEffectColors(),Common.Utils.ThemeColor.getStandartColors(),t),this.colorsLast.updateColors(Common.Utils.ThemeColor.getEffectColors(),Common.Utils.ThemeColor.getStandartColors(),t),this.colorsMarkers.updateColors(Common.Utils.ThemeColor.getEffectColors(),Common.Utils.ThemeColor.getStandartColors(),t),this.btnSparkColor.setColor(this.colorsSpark.getColor()),this.btnHighColor.setColor(this.colorsHigh.getColor()),this.btnLowColor.setColor(this.colorsLow.getColor()),this.btnNegativeColor.setColor(this.colorsNegative.getColor()),this.btnFirstColor.setColor(this.colorsFirst.getColor()),this.btnLastColor.setColor(this.colorsLast.getColor()),this.btnMarkersColor.setColor(this.colorsMarkers.getColor()))},createDelayedControls:function(){var e=this;this.spnWidth=new Common.UI.MetricSpinner({el:l("#chart-spin-width"),step:.1,width:78,defaultUnit:"cm",value:"3 cm",maxValue:55.88,minValue:0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.spinners.push(this.spnWidth),this.lockedControls.push(this.spnWidth),this.spnHeight=new Common.UI.MetricSpinner({el:l("#chart-spin-height"),step:.1,width:78,defaultUnit:"cm",value:"3 cm",maxValue:55.88,minValue:0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.spinners.push(this.spnHeight),this.lockedControls.push(this.spnHeight),this.spnWidth.on("change",d.bind(this.onWidthChange,this)),this.spnHeight.on("change",d.bind(this.onHeightChange,this)),this.spnWidth.on("inputleave",function(){Common.NotificationCenter.trigger("edit:complete",e)}),this.spnHeight.on("inputleave",function(){Common.NotificationCenter.trigger("edit:complete",e)}),this.btnRatio=new Common.UI.Button({parentEl:l("#chart-button-ratio"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-advanced-ratio",style:"margin-bottom: 1px;",enableToggle:!0,hint:this.textKeepRatio,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.lockedControls.push(this.btnRatio),this.btnRatio.on("click",d.bind(function(t,e){var i;t.pressed&&0<this.spnHeight.getNumberValue()&&(this._nRatio=this.spnWidth.getNumberValue()/this.spnHeight.getNumberValue()),this.api&&((i=new Asc.asc_CImgProperty).asc_putLockAspect(t.pressed),this.api.asc_setGraphicObjectProps(i))},this)),this.btnSparkType=new Common.UI.Button({cls:"btn-large-dataview",iconCls:"svgicon chart-spark-column",menu:new Common.UI.Menu({style:"width: 167px;",items:[{template:d.template('<div id="id-spark-menu-type" class="menu-insertchart"></div>')}]})}),this.btnSparkType.on("render:after",function(t){e.mnuSparkTypePicker=new Common.UI.DataView({el:l("#id-spark-menu-type"),parentMenu:t.menu,restoreHeight:120,allowScrollbar:!1,groups:new Common.UI.DataViewGroupStore(Common.define.chartData.getSparkGroupData()),store:new Common.UI.DataViewStore(Common.define.chartData.getSparkData()),itemTemplate:d.template('<div id="<%= id %>" class="item-chartlist"><svg width="40" height="40" class="icon uni-scale"><use xlink:href="#chart-<%= iconCls %>"></use></svg></div>'),delayRenderTips:!0})}),this.btnSparkType.render(l("#spark-button-type")),this.mnuSparkTypePicker.on("item:click",d.bind(this.onSelectSparkType,this,this.btnSparkType)),this.lockedControls.push(this.btnSparkType),this.cmbBorderSize=new Common.UI.ComboBorderSizeEditable({el:l("#spark-combo-line-type"),style:"width: 90px;",allowNoBorders:!1}).on("selected",d.bind(this.onBorderSizeSelect,this)).on("changed:before",d.bind(this.onBorderSizeChanged,this,!0)).on("changed:after",d.bind(this.onBorderSizeChanged,this,!1)),this.BorderSize=this.cmbBorderSize.store.at(1).get("value"),this.cmbBorderSize.setValue(this.BorderSize),this.lockedControls.push(this.cmbBorderSize),this.chHighPoint=new Common.UI.CheckBox({el:l("#spark-checkbox-high"),labelText:this.textHighPoint}),this.lockedControls.push(this.chHighPoint),this.chPoints.push(this.chHighPoint),this.chLowPoint=new Common.UI.CheckBox({el:l("#spark-checkbox-low"),labelText:this.textLowPoint}),this.lockedControls.push(this.chLowPoint),this.chPoints.push(this.chLowPoint),this.chNegativePoint=new Common.UI.CheckBox({el:l("#spark-checkbox-negative"),labelText:this.textNegativePoint}),this.lockedControls.push(this.chNegativePoint),this.chPoints.push(this.chNegativePoint),this.chFirstPoint=new Common.UI.CheckBox({el:l("#spark-checkbox-first"),labelText:this.textFirstPoint}),this.lockedControls.push(this.chFirstPoint),this.chPoints.push(this.chFirstPoint),this.chLastPoint=new Common.UI.CheckBox({el:l("#spark-checkbox-last"),labelText:this.textLastPoint}),this.lockedControls.push(this.chLastPoint),this.chPoints.push(this.chLastPoint),this.chMarkersPoint=new Common.UI.CheckBox({el:l("#spark-checkbox-markers"),labelText:this.textMarkers}),this.lockedControls.push(this.chMarkersPoint),this.chPoints.push(this.chMarkersPoint),this.chHighPoint.on("change",d.bind(this.onCheckPointChange,this,0)),this.chLowPoint.on("change",d.bind(this.onCheckPointChange,this,1)),this.chNegativePoint.on("change",d.bind(this.onCheckPointChange,this,2)),this.chFirstPoint.on("change",d.bind(this.onCheckPointChange,this,3)),this.chLastPoint.on("change",d.bind(this.onCheckPointChange,this,4)),this.chMarkersPoint.on("change",d.bind(this.onCheckPointChange,this,5)),this.btnChangeType=new Common.UI.Button({parentEl:l("#chart-btn-change-type"),cls:"btn-toolbar align-left",iconCls:"toolbar__icon btn-menu-chart",caption:this.textChangeType,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.btnChangeType.on("click",d.bind(this.onChangeType,this)),this.lockedControls.push(this.btnChangeType),this.btnSelectData=new Common.UI.Button({parentEl:l("#chart-btn-select-data"),cls:"btn-toolbar align-left",iconCls:"toolbar__icon btn-select-range",caption:this.textSelectData,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.btnSelectData.on("click",d.bind(this.onSelectData,this)),this.lockedControls.push(this.btnSelectData),this.btnSwitch=new Common.UI.Button({parentEl:l("#chart-btn-switch"),cls:"btn-toolbar align-left",iconCls:"toolbar__icon btn-switch-row-column",caption:this.textSwitch,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.btnSwitch.on("click",d.bind(this.onSwitch,this)),this.lockedControls.push(this.btnSwitch),this.spnX=new Common.UI.MetricSpinner({el:l("#chart-spin-x"),step:10,width:57,defaultUnit:"°",value:"20 °",maxValue:359.9,minValue:0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.lockedControls.push(this.spnX),this.spnX.on("change",d.bind(this.onXRotation,this)),this.spnX.on("inputleave",function(){Common.NotificationCenter.trigger("edit:complete",e)}),this.btnLeft=new Common.UI.Button({parentEl:l("#chart-btn-x-left",e.$el),cls:"btn-toolbar",iconCls:"toolbar__icon btn-rotate-270",hint:this.textLeft,dataHint:"1",dataHintDirection:"top"}),this.lockedControls.push(this.btnLeft),this.btnLeft.on("click",d.bind(function(){this.spnX.setValue(10*Math.ceil((this.spnX.getNumberValue()-10)/10))},this)),this.btnRight=new Common.UI.Button({parentEl:l("#chart-btn-x-right",e.$el),cls:"btn-toolbar",iconCls:"toolbar__icon btn-rotate-90",hint:this.textRight,dataHint:"1",dataHintDirection:"top"}),this.lockedControls.push(this.btnRight),this.btnRight.on("click",d.bind(function(){this.spnX.setValue(10*Math.floor((this.spnX.getNumberValue()+10)/10))},this)),this.spnY=new Common.UI.MetricSpinner({el:l("#chart-spin-y"),step:10,width:57,defaultUnit:"°",value:"15 °",maxValue:90,minValue:-90,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.lockedControls.push(this.spnY),this.spnY.on("change",d.bind(this.onYRotation,this)),this.spnY.on("inputleave",function(){Common.NotificationCenter.trigger("edit:complete",e)}),this.btnUp=new Common.UI.Button({parentEl:l("#chart-btn-y-up",e.$el),cls:"btn-toolbar",iconCls:"toolbar__icon btn-rotate-y-clockwise",hint:this.textUp,dataHint:"1",dataHintDirection:"top"}),this.lockedControls.push(this.btnUp),this.btnUp.on("click",d.bind(function(){this.spnY.setValue(10*Math.ceil((this.spnY.getNumberValue()-10)/10))},this)),this.btnDown=new Common.UI.Button({parentEl:l("#chart-btn-y-down",e.$el),cls:"btn-toolbar",iconCls:"toolbar__icon btn-rotate-y-counterclockwise",hint:this.textDown,dataHint:"1",dataHintDirection:"top"}),this.lockedControls.push(this.btnDown),this.btnDown.on("click",d.bind(function(){this.spnY.setValue(10*Math.floor((this.spnY.getNumberValue()+10)/10))},this)),this.spnPerspective=new Common.UI.MetricSpinner({el:l("#chart-spin-persp"),step:5,width:57,defaultUnit:"°",value:"0 °",maxValue:100,minValue:.1,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.lockedControls.push(this.spnPerspective),this.spnPerspective.on("change",d.bind(this.onPerspective,this)),this.spnPerspective.on("inputleave",function(){Common.NotificationCenter.trigger("edit:complete",e)}),this.btnNarrow=new Common.UI.Button({parentEl:l("#chart-btn-narrow",e.$el),cls:"btn-toolbar",iconCls:"toolbar__icon btn-rotate-up",hint:this.textNarrow,dataHint:"1",dataHintDirection:"top"}),this.lockedControls.push(this.btnNarrow),this.btnNarrow.on("click",d.bind(function(){this.spnPerspective.setValue(5*Math.ceil((this.spnPerspective.getNumberValue()-5)/5))},this)),this.btnWiden=new Common.UI.Button({parentEl:l("#chart-btn-widen",e.$el),cls:"btn-toolbar",iconCls:"toolbar__icon btn-rotate-down",hint:this.textWiden,dataHint:"1",dataHintDirection:"top"}),this.lockedControls.push(this.btnWiden),this.btnWiden.on("click",d.bind(function(){this.spnPerspective.setValue(5*Math.floor((this.spnPerspective.getNumberValue()+5)/5))},this)),this.chRightAngle=new Common.UI.CheckBox({el:l("#chart-checkbox-right-angle"),labelText:this.textRightAngle}),this.lockedControls.push(this.chRightAngle),this.chRightAngle.on("change",d.bind(function(t,e,i,s){var o,n;this.api&&(o=this.api.asc_getChartObject(!0))&&(n=o.getView3d())&&(n.asc_setRightAngleAxes("checked"==t.getValue()),o.startEdit(),o.setView3d(n),o.endEdit())},this)),this.chAutoscale=new Common.UI.CheckBox({el:l("#chart-checkbox-autoscale"),labelText:this.textAutoscale}),this.lockedControls.push(this.chAutoscale),this.chAutoscale.on("change",d.bind(function(t,e,i,s){var o,n;this.api&&(o=this.api.asc_getChartObject(!0))&&(n=o.getView3d())&&(n.asc_setHeight("checked"==t.getValue()?null:this.spn3DHeight.getNumberValue()),o.startEdit(),o.setView3d(n),o.endEdit())},this)),this.spn3DDepth=new Common.UI.MetricSpinner({el:l("#chart-spin-3d-depth"),step:10,width:70,defaultUnit:"%",value:"0 %",maxValue:2e3,minValue:0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.lockedControls.push(this.spn3DDepth),this.spn3DDepth.on("change",d.bind(this.on3DDepth,this)),this.spn3DDepth.on("inputleave",function(){Common.NotificationCenter.trigger("edit:complete",e)}),this.spn3DHeight=new Common.UI.MetricSpinner({el:l("#chart-spin-3d-height"),step:10,width:70,defaultUnit:"%",value:"50 %",maxValue:500,minValue:5,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.lockedControls.push(this.spn3DHeight),this.spn3DHeight.on("change",d.bind(this.on3DHeight,this)),this.spn3DHeight.on("inputleave",function(){Common.NotificationCenter.trigger("edit:complete",e)}),this.linkDefRotation=l("#chart-def-rotate-link"),l(this.el).on("click","#chart-def-rotate-link",d.bind(this.onDefRotation,this)),this.linkAdvanced=l("#chart-advanced-link"),l(this.el).on("click","#chart-advanced-link",d.bind(this.openAdvancedSettings,this))},createDelayedElements:function(){this._initSettings=!1,this.createDelayedControls(),this.updateMetricUnit(),this.UpdateThemeColors()},ShowHideElem:function(t,e){this.ChartSizeContainer.toggleClass("settings-hidden",!t),this.ChartTypesContainer.toggleClass("settings-hidden",!t),this.SparkTypesContainer.toggleClass("settings-hidden",t),this.SparkPointsContainer.toggleClass("settings-hidden",t),this.Chart3DContainer.toggleClass("settings-hidden",!t||!e),this.fireEvent("updatescroller",this)},ShowCombinedProps:function(t){this.NotCombinedSettings.toggleClass("settings-hidden",null===t||t==Asc.c_oAscChartTypeSettings.comboBarLine||t==Asc.c_oAscChartTypeSettings.comboBarLineSecondary||t==Asc.c_oAscChartTypeSettings.comboAreaBar||t==Asc.c_oAscChartTypeSettings.comboCustom)},onWidthChange:function(t,e,i,s){var o,t=t.getNumberValue(),n=this.spnHeight.getNumberValue();this.btnRatio.pressed&&((n=t/this._nRatio)>this.spnHeight.options.maxValue&&(t=(n=this.spnHeight.options.maxValue)*this._nRatio,this.spnWidth.setValue(t,!0)),this.spnHeight.setValue(n,!0)),this.api&&((o=new Asc.asc_CImgProperty).asc_putWidth(Common.Utils.Metric.fnRecalcToMM(t)),o.asc_putHeight(Common.Utils.Metric.fnRecalcToMM(n)),this.api.asc_setGraphicObjectProps(o))},onHeightChange:function(t,e,i,s){var o,t=t.getNumberValue(),n=this.spnWidth.getNumberValue();this.btnRatio.pressed&&((n=t*this._nRatio)>this.spnWidth.options.maxValue&&(t=(n=this.spnWidth.options.maxValue)/this._nRatio,this.spnHeight.setValue(t,!0)),this.spnWidth.setValue(n,!0)),this.api&&((o=new Asc.asc_CImgProperty).asc_putWidth(Common.Utils.Metric.fnRecalcToMM(n)),o.asc_putHeight(Common.Utils.Metric.fnRecalcToMM(t)),this.api.asc_setGraphicObjectProps(o))},openAdvancedSettings:function(){var i,t;this.linkAdvanced.hasClass("disabled")||(i=this).api&&(t=i.isChart?i.api.asc_getChartObject():i._originalProps)&&new SSE.Views.ChartSettingsDlg({chartSettings:t,imageSettings:i.isChart?i._originalProps:null,sparklineStyles:i.sparklineStyles,isChart:i.isChart,api:i.api,handler:function(t,e){"ok"==t&&i.api&&(i.isChart?(i.api.asc_editChartDrawingObject(e.chartSettings),e.imageSettings&&i.api.asc_setGraphicObjectProps(e.imageSettings)):i.api.asc_setSparklineGroup(i._state.SparkId,e.chartSettings)),Common.NotificationCenter.trigger("edit:complete",i)}}).show()},onSelectData_simple:function(){var i,t,s=this;s.api&&(i=s.api.asc_getChartObject(),(t=new SSE.Views.CellRangeDialog({handler:function(t,e){"ok"==e&&(i.putRange(t.getSettings()),s.api.asc_setSelectionDialogMode(Asc.c_oAscSelectionDialogType.None),s.api.asc_editChartDrawingObject(i)),Common.NotificationCenter.trigger("edit:complete",s.toolbar)}}).on("close",function(){s.api.asc_onCloseChartFrame()})).show(),t.setSettings({api:s.api,range:i.getRange(),validation:function(t){return d.isEmpty(t)?"":(t=s.api.asc_checkDataRange(Asc.c_oAscSelectionDialogType.Chart,t,!0,i.getInRows(),s._state.ChartType))==Asc.c_oAscError.ID.No||(t==Asc.c_oAscError.ID.StockChartError?this.errorStockChart:t==Asc.c_oAscError.ID.MaxDataSeriesError?this.errorMaxRows:this.txtInvalidRange)},type:Asc.c_oAscSelectionDialogType.Chart}))},onSelectData:function(){var i,s=this;s.api&&(i=s.api.asc_getChartObject())&&(s._isEditRanges=!0,i.startEdit(),new SSE.Views.ChartDataDialog({chartSettings:i,api:s.api,handler:function(t,e){"ok"==t&&(i.endEdit(),s._isEditRanges=!1),Common.NotificationCenter.trigger("edit:complete",s)}}).on("close",function(){s._isEditRanges&&i.cancelEdit(),s._isEditRanges=!1}).show())},onChangeType:function(){var i=this;i.api&&new SSE.Views.ChartWizardDialog({api:i.api,props:{recommended:i.api.asc_getRecommendedChartData()},type:i._state.ChartType,isEdit:!0,handler:function(t,e){"ok"==t&&i.api&&i.api.asc_addChartSpace(e),Common.NotificationCenter.trigger("edit:complete",i.toolbar)}}).show()},onSelectStyle:function(t,e){var i;this._noApply||(this.api&&!this._noApply&&this.chartProps&&(i=new Asc.asc_CImgProperty,this.chartProps.putStyle(e.get("data")),i.asc_putChartProperties(this.chartProps),this.api.asc_setGraphicObjectProps(i)),Common.NotificationCenter.trigger("edit:complete",this))},selectCurrentChartStyle:function(){if(this.cmbChartStyle){this.cmbChartStyle.suspendEvents();var t=this.cmbChartStyle.menuPicker.store.findWhere({data:this._state.ChartStyle});if(this.cmbChartStyle.menuPicker.selectRecord(t),this.cmbChartStyle.resumeEvents(),this._isChartStylesChanged){var i,t=t?this.cmbChartStyle.fillComboView(this.cmbChartStyle.menuPicker.getSelectedRec(),!0):this.cmbChartStyle.fillComboView(this.cmbChartStyle.menuPicker.store.at(0),!0);if(t&&0<t.length)return i=[],d.each(t,function(t,e){i.push(t.get("data"))}),i}}},onAddChartStylesPreview:function(t){var s;!this._isEditType&&this.cmbChartStyle&&t&&0<t.length&&(s=this.cmbChartStyle.menuPicker.store)&&d.each(t,function(t,e){var i=s.findWhere({data:t.asc_getName()});i&&i.set("imageUrl",t.asc_getImage())})},_onUpdateChartStyles:function(){this.api&&null!==this._state.ChartType&&-1<this._state.ChartType&&this._state.ChartType!=Asc.c_oAscChartTypeSettings.comboBarLine&&this._state.ChartType!=Asc.c_oAscChartTypeSettings.comboBarLineSecondary&&this._state.ChartType!=Asc.c_oAscChartTypeSettings.comboAreaBar&&this._state.ChartType!=Asc.c_oAscChartTypeSettings.comboCustom&&(this.updateChartStyles(this.api.asc_getChartPreviews(this._state.ChartType,void 0,!0)),this.api.asc_generateChartPreviews(this._state.ChartType,this.selectCurrentChartStyle()))},updateChartStyles:function(t){var e,i,s=this;this._isChartStylesChanged=!0,this.cmbChartStyle||(this.cmbChartStyle=new Common.UI.ComboDataView({itemWidth:50,itemHeight:50,menuMaxHeight:270,enableKeyEvents:!0,cls:"combo-chart-style",dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big",delayRenderTips:!0}),this.cmbChartStyle.render(l("#chart-combo-style")),this.cmbChartStyle.openButton.menu.cmpEl.css({"min-width":178,"max-width":178}),this.cmbChartStyle.on("click",d.bind(this.onSelectStyle,this)),this.cmbChartStyle.openButton.menu.on("show:after",function(){s.cmbChartStyle.menuPicker.scroller.update({alwaysVisibleY:!0})}),this.lockedControls.push(this.cmbChartStyle)),t&&0<t.length?(e=this.cmbChartStyle.menuPicker.store)&&(i=[],d.each(t,function(t,e){i.push({imageUrl:t.asc_getImage(),data:t.asc_getName(),tip:s.textStyle+" "+t.asc_getName()})}),e.reset(i,{silent:!1})):(this.cmbChartStyle.menuPicker.store.reset(),this.cmbChartStyle.clearComboView()),this.cmbChartStyle.setDisabled(!t||t.length<1||this._locked)},updateSparkStyles:function(t){var e=this;if(this.cmbSparkStyle||(this.cmbSparkStyle=new Common.UI.ComboDataView({itemWidth:50,itemHeight:50,menuMaxHeight:272,enableKeyEvents:!0,cls:"combo-spark-style",delayRenderTips:!0}),this.cmbSparkStyle.render(l("#spark-combo-style")),this.cmbSparkStyle.openButton.menu.cmpEl.css({"min-width":178,"max-width":178}),this.cmbSparkStyle.on("click",d.bind(this.onSelectSparkStyle,this)),this.cmbSparkStyle.openButton.menu.on("show:after",function(){e.cmbSparkStyle.menuPicker.scroller.update({alwaysVisibleY:!0})}),this.lockedControls.push(this.cmbSparkStyle)),t&&1<t.length){var i=this.cmbSparkStyle.menuPicker.store,s=t[t.length-1];if(this.sparklineStyles=t,i.length==t.length-1){for(var o=i.models,n=0;n<t.length-1;n++)o[n].set("imageUrl",t[n]);s<0?(this.cmbSparkStyle.fillComboView(i.at(0),!1),this.cmbSparkStyle.fieldPicker.deselectAll(),this.cmbSparkStyle.menuPicker.deselectAll()):this.cmbSparkStyle.menuPicker.selectRecord(i.at(s))}else{for(var a=[],n=0;n<t.length-1;n++)a.push({imageUrl:t[n],data:n});i.reset(a,{silent:!1}),this.cmbSparkStyle.fillComboView(i.at(s<0?0:s),-1<s)}}},onSelectSparkType:function(t,e,i,s){var o={};if(d.isFunction(s.toJSON)){if(!s.get("selected"))return;o=s.toJSON()}else o=s;this.btnSparkType.setIconCls("svgicon chart-"+o.iconCls),this._state.SparkType=-1,this.api&&!this._noApply&&this._originalProps&&((s=new Asc.sparklineGroup).asc_setType(o.type),this.api.asc_setSparklineGroup(this._state.SparkId,s)),Common.NotificationCenter.trigger("edit:complete",this)},onSelectSparkStyle:function(t,e){var i;this._noApply||(this.api&&!this._noApply&&this._originalProps&&((i=new Asc.sparklineGroup).asc_setStyle(e.get("data")),this.api.asc_setSparklineGroup(this._state.SparkId,i)),Common.NotificationCenter.trigger("edit:complete",this))},applyBorderSize:function(t){t=Common.Utils.String.parseFloat(t),t=isNaN(t)?1:Math.max(.01,Math.min(1584,t)),this.BorderSize=t,this.api&&!this._noApply&&this._originalProps&&((t=new Asc.sparklineGroup).asc_setLineWeight(this.BorderSize),this.api.asc_setSparklineGroup(this._state.SparkId,t),Common.NotificationCenter.trigger("edit:complete",this))},onBorderSizeChanged:function(t,e,i,s){var o=this;t?(t=parseFloat(i.value),(!new RegExp("^\\s*(\\d*(\\.|,)?\\d+)\\s*("+o.txtPt+")?\\s*$").exec(i.value)||t<.01||1584<t)&&(this._state.LineWeight=-1,setTimeout(function(){Common.UI.error({msg:o.textBorderSizeErr,callback:function(){d.defer(function(t){Common.NotificationCenter.trigger("edit:complete",o)})}})},10))):this.applyBorderSize(i.value)},onBorderSizeSelect:function(t,e){this.applyBorderSize(e.value)},onColorsSparkSelect:function(t,e){var i;this.api&&!this._noApply&&this._originalProps&&((i=new Asc.sparklineGroup).asc_setColorSeries(Common.Utils.ThemeColor.getRgbColor(e)),this.api.asc_setSparklineGroup(this._state.SparkId,i)),Common.NotificationCenter.trigger("edit:complete",this)},onCheckPointChange:function(t,e,i,s,o){if(this.api&&!this._noApply&&this._originalProps){var n=new Asc.sparklineGroup;switch(t){case 0:n.asc_setHighPoint("checked"==e.getValue());break;case 1:n.asc_setLowPoint("checked"==e.getValue());break;case 2:n.asc_setNegativePoint("checked"==e.getValue());break;case 3:n.asc_setFirstPoint("checked"==e.getValue());break;case 4:n.asc_setLastPoint("checked"==e.getValue());break;case 5:n.asc_setMarkersPoint("checked"==e.getValue())}this.api.asc_setSparklineGroup(this._state.SparkId,n)}Common.NotificationCenter.trigger("edit:complete",this)},onColorsPointSelect:function(t,e,i){if("checked"!==this.chPoints[t].getValue()&&this.chPoints[t].setValue(!0,!0),this.api&&!this._noApply&&this._originalProps){var s=new Asc.sparklineGroup;switch(t){case 0:s.asc_setHighPoint(!0),s.asc_setColorHigh(Common.Utils.ThemeColor.getRgbColor(i));break;case 1:s.asc_setLowPoint(!0),s.asc_setColorLow(Common.Utils.ThemeColor.getRgbColor(i));break;case 2:s.asc_setNegativePoint(!0),s.asc_setColorNegative(Common.Utils.ThemeColor.getRgbColor(i));break;case 3:s.asc_setFirstPoint(!0),s.asc_setColorFirst(Common.Utils.ThemeColor.getRgbColor(i));break;case 4:s.asc_setLastPoint(!0),s.asc_setColorLast(Common.Utils.ThemeColor.getRgbColor(i));break;case 5:s.asc_setMarkersPoint(!0),s.asc_setColorMarkers(Common.Utils.ThemeColor.getRgbColor(i))}this.api.asc_setSparklineGroup(this._state.SparkId,s)}Common.NotificationCenter.trigger("edit:complete",this)},onSwitch:function(){var t;this.api&&(t=this.api.asc_getChartObject(!0))&&(t.startEdit(),t.switchRowCol()===Asc.c_oAscError.ID.MaxDataSeriesError?(t.cancelEdit(),Common.UI.warning({msg:this.errorMaxRows,maxwidth:600})):t.endEdit())},onXRotation:function(t,e,i,s){var o,n;this.api&&(o=this.api.asc_getChartObject(!0))&&(n=o.getView3d())&&(n.asc_setRotX(t.getNumberValue()),o.startEdit(),o.setView3d(n),o.endEdit())},onYRotation:function(t,e,i,s){var o,n;this.api&&(o=this.api.asc_getChartObject(!0))&&(n=o.getView3d())&&(n.asc_setRotY(t.getNumberValue()),o.startEdit(),o.setView3d(n),o.endEdit())},onPerspective:function(t,e,i,s){var o,n;this.api&&(o=this.api.asc_getChartObject(!0))&&(n=o.getView3d())&&(n.asc_setPerspective(t.getNumberValue()),o.startEdit(),o.setView3d(n),o.endEdit())},on3DDepth:function(t,e,i,s){var o,n;this.api&&(o=this.api.asc_getChartObject(!0))&&(n=o.getView3d())&&(n.asc_setDepth(t.getNumberValue()),o.startEdit(),o.setView3d(n),o.endEdit())},on3DHeight:function(t,e,i,s){var o,n;this.api&&(o=this.api.asc_getChartObject(!0))&&(n=o.getView3d())&&(n.asc_setHeight(t.getNumberValue()),o.startEdit(),o.setView3d(n),o.endEdit())},onDefRotation:function(){var t,e;this.api&&(t=this.api.asc_getChartObject(!0))&&(e=t.getView3d())&&(e.asc_setRotX(20),e.asc_setRotY(15),t.startEdit(),t.setView3d(e),t.endEdit())},setLocked:function(t){this._locked=t},disableControls:function(e){this._initSettings||this._state.DisabledControls!==e&&(this._state.DisabledControls=e,d.each(this.lockedControls,function(t){t.setDisabled(e)}),this.linkAdvanced.toggleClass("disabled",e))}},SSE.Views.ChartSettings||{}))}),define("text!spreadsheeteditor/main/app/template/ShapeSettings.template",[],function(){return'<table cols="1">\n    <tr>\n        <td>\n            <label class="header"><%= scope.strFill %></label>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <div id="shape-combo-fill-src" style="width: 100%;"></div>\n        </td>\n    </tr>\n    <tr>\n        <td>\n            <div id="shape-panel-color-fill" class="padding-small" style="width: 100%;">\n                <div id="shape-back-color-btn" style=""></div>\n            </div>\n            <div id="shape-panel-image-fill" class="settings-hidden padding-small" style="width: 100%;">\n                <table cols="2" style="width: 100%;">\n                <tr>\n                    <td colspan="2" class="padding-small">\n                        <div id="shape-button-replace" style="width:100%;"></div>\n                    </td>\n                </tr>\n                <tr>\n                    <td style="vertical-align: top">\n                        <div id="shape-combo-fill-type" style="width: 90px;"></div>\n                    </td>\n                    <td rowspan="2">\n                        <div class="texture-img float-right">\n                            <div id="shape-texture-img" style="width: 50px;height: 50px;"></div>\n                        </div>\n                    </td>\n                </tr>\n                <tr>\n                    <td style="vertical-align: bottom">\n                        <label class="input-label" style=""><%= scope.textTexture %></label>\n                        <div id="shape-combo-fill-texture" style="width: 90px;"></div>\n                    </td>\n                </tr>\n            </table>\n            </div>\n            <div id="shape-panel-pattern-fill" class="settings-hidden padding-small" style="width: 100%;">\n                <label class="input-label" style="margin-top: 3px;"><%= scope.strPattern %></label>\n                <div id="shape-combo-pattern" style="width: 100%; height: 42px; margin-bottom: 8px;"></div>\n                <div style="width: 100%; height: 25px; margin-bottom: 8px;">\n                    <label class="input-label" style="margin-top: 3px;"><%= scope.strForeground %></label>\n                    <div id="shape-foreground-color-btn" class="float-right"></div>\n                </div>\n                <div style="width: 100%; height: 25px;">\n                    <label class="input-label" style="margin-top: 3px;"><%= scope.strBackground %></label>\n                    <div id="shape-background-color-btn" class="float-right"></div>\n                </div>\n            </div>\n            <div id="shape-panel-gradient-fill" class="settings-hidden padding-small" style="width: 100%;">\n                <table cols="3" style="margin-bottom: 10px;">\n                    <tr valign="top">\n                        <td colspan="2">\n                            <div>\n                                <label class="input-label" style=""><%= scope.textStyle %></label>\n                                <div id="shape-combo-grad-type" style="width: 100%;"></div>\n                            </div>\n                        </td>\n                        <td rowspan="2" style="width: 100%;">\n                            <div class="float-right">\n                                <label class="input-label"><%= scope.textDirection %></label>\n                                <div id="shape-button-direction"></div>\n                            </div>\n                        </td>\n                    </tr>\n                    <tr valign="bottom">\n                        <td>\n                            <label class="input-label angle-label"><%= scope.textAngle %></label>\n                        </td>\n                        <td>\n                            <div id="shape-spin-gradient-angle" style="display: inline-block; width: 60px;"></div>\n                        </td>\n                    </tr>\n                </table>\n                <label class="input-label" style="display:block;margin-bottom: 5px;"><%= scope.textGradient %></label>\n                <div style="display: inline-block; margin-top: 3px;">\n                    <div id="shape-slider-gradient" style="display: inline-block; vertical-align: middle;"></div>\n                </div>\n                <div style="height: 40px;margin-top:6px;display:flex;justify-content:space-between;">\n                    <div style="display: flex;">\n                    <div style="">\n                        <label class="input-label" style=""><%= scope.strColor %></label>\n                        <div id="shape-gradient-color-btn"></div>\n                    </div>\n                    <div class="margin-left-10">\n                        <label class="input-label" style=""><%= scope.textPosition %></label>\n                        <div id="shape-gradient-position"></div>\n                    </div>\n                    </div>\n                    <div style="display:flex;padding-top:15px;">\n                        <div id="shape-gradient-add-step"></div>\n                        <div id="shape-gradient-remove-step"></div>\n                    </div>\n                </div>\n            </div>\n        </td>\n    </tr>\n    <tr>\n        <td>\n            <div class="padding-small" id="shape-panel-transparent-fill" style="width: 100%;">\n                <label class="header" style="display:block;"><%= scope.strTransparency %></label>\n                <div style="display: inline-block; margin-top: 3px;">\n                    <label id="shape-lbl-transparency-start">0</label>\n                    <div id="shape-slider-transparency" style="display: inline-block;margin: 0 4px; vertical-align: middle;"></div>\n                    <label id="shape-lbl-transparency-end">100</label>\n                </div>\n                <div id="shape-spin-transparency" class="float-right"></div>\n            </div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr>\n        <td>\n            <label class="header"><%= scope.strStroke %></label>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n        <div style="display:inline-block;width:100px;vertical-align: middle;">\n            <label class="input-label" style=""><%= scope.strSize %></label>\n            <div id="shape-combo-border-size" style="width: 93px;"></div>\n        </div>\n        <div style="display:inline-block;vertical-align: middle;">\n            <label class="input-label" style=""><%= scope.strColor %></label>\n            <div id="shape-border-color-btn" style=""></div>\n        </div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n        <div style="display:inline-block;width:100px;vertical-align: middle;">\n            <label class="input-label" style=""><%= scope.strType %></label>\n            <div id="shape-combo-border-type" style="width: 93px;"></div>\n        </div>\n        </td>\n    </tr>\n    <tr>\n        <td>\n            <div class="padding-small" id="shape-line-panel-transparent-fill" style="width: 100%;">\n                <label class="header" style="display:block;"><%= scope.strTransparency %></label>\n                <div style="display: inline-block; margin-top: 3px;">\n                    <label id="shape-line-lbl-transparency-start">0</label>\n                    <div id="shape-line-slider-transparency" style="display: inline-block;margin: 0 4px; vertical-align: middle;"></div>\n                    <label id="shape-line-lbl-transparency-end">100</label>\n                </div>\n                <div id="shape-line-spin-transparency" class="float-right"></div>\n            </div>\n        </td>\n    </tr>\n    <tr class="shape-rotation">\n        <td class="padding-small">\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr class="shape-rotation">\n        <td class="padding-small">\n            <label class="header"><%= scope.textRotation %></label>\n        </td>\n    </tr>\n    <tr class="shape-rotation">\n        <td>\n            <table cols="2" style="width: 100%;">\n                <tr>\n                    <td class="padding-small" width="50%">\n                        <label class="input-label"><%= scope.textRotate90 %></label>\n                        <div>\n                            <div id="shape-button-270" class="margin-right-4"></div>\n                            <div id="shape-button-90"></div>\n                        </div>\n                    </td>\n                    <td class="padding-small" width="50%">\n                        <label class="input-label"><%= scope.textFlip %></label>\n                        <div>\n                            <div id="shape-button-fliph" class="margin-right-4"></div>\n                            <div id="shape-button-flipv"></div>\n                        </div>\n                    </td>\n                </tr>\n            </table>\n        </td>\n    </tr>\n    <tr class="change-type">\n        <td class="padding-small">\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr class="change-type">\n        <td>\n            <div class="padding-small" id="shape-button-edit-shape-container">\n                <div id="shape-button-edit-shape" style="width:100%;"></div>\n            </div>\n        </td>\n    </tr>\n    <tr class="change-type">\n        <td>\n            <div class="padding-small" id="shape-button-change-shape-container">\n                <div id="shape-button-change-shape" style="width:100%;"></div>\n            </div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" colspan=2>\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" colspan=2>\n            <div id="shape-checkbox-shadow"></div>\n        </td>\n    </tr>\n    <tr class="shape-only">\n        <td class="padding-small">\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr class="shape-only">\n        <td align="center">\n            <label class="link" id="shape-advanced-link" data-hint="1" data-hint-direction="bottom" data-hint-offset="medium"><%= scope.textAdvanced %></label>\n        </td>\n    </tr>\n    <tr class="finish-cell"></tr>\n</table>'}),void 0===Common&&(Common={}),define("common/main/lib/component/ComboBorderSize",["common/main/lib/component/ComboBox"],function(){"use strict";Common.UI.BordersModel=Backbone.Model.extend({defaults:function(){return{value:null,displayValue:null,pxValue:null,id:Common.UI.getId(),imgId:void 0}}}),Common.UI.BordersStore=Backbone.Collection.extend({model:Common.UI.BordersModel}),Common.UI.ComboBorderSize=Common.UI.ComboBox.extend(_.extend({template:_.template(['<div class="input-group combobox combo-border-size input-group-nr <%= cls %>" id="<%= id %>" style="<%= style %>">','<div class="form-control" style="<%= style %>" data-hint="<%= dataHint %>" data-hint-direction="<%= dataHintDirection %>" data-hint-offset="<%= dataHintOffset %>">','<i class="img-line"><svg><use xlink:href="#half-pt"></use></svg></i>','<span class="text"></span>',"</div>",'<div style="display: table-cell;"></div>','<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">','<span class="caret"></span>',"</button>",'<ul class="dropdown-menu <%= menuCls %>" style="<%= menuStyle %>" role="menu">',"<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%= item.value %>"><a tabindex="-1" type="menuitem">',"<span><%= item.displayValue %></span>","<% if(item.imgId!==undefined) { %>",'<span class="border-line">',"<svg>",'<use xlink:href="#<%= item.imgId %>"></use>',"</svg>","</span>","<% } %>","</a></li>","<% }); %>","</ul>","</div>"].join("")),initialize:function(t){var e=Common.Utils.Metric.getMetricName(Common.Utils.Metric.c_MetricUnits.pt),e=[{displayValue:"0.5 "+e,value:.5,pxValue:.5,imgId:"half-pt"},{displayValue:"1 "+e,value:1,pxValue:1,imgId:"one-pt"},{displayValue:"1.5 "+e,value:1.5,pxValue:2,imgId:"one-and-half-pt"},{displayValue:"2.25 "+e,value:2.25,pxValue:3,imgId:"two-and-quarter-pt"},{displayValue:"3 "+e,value:3,pxValue:4,imgId:"three-pt"},{displayValue:"4.5 "+e,value:4.5,pxValue:6,imgId:"four-and-half-pt"},{displayValue:"6 "+e,value:6,pxValue:8,imgId:"six-pt"}];!1!==t.allowNoBorders&&e.unshift({displayValue:this.txtNoBorders,value:0,pxValue:0}),Common.UI.ComboBox.prototype.initialize.call(this,_.extend({editable:!1,store:new Common.UI.BordersStore,data:e,menuStyle:"min-width: 160px;"},t))},render:function(t){return Common.UI.ComboBox.prototype.render.call(this,t),this._formControl=this.cmpEl.find(".form-control"),this},itemClicked:function(t){var e=$(t.currentTarget).parent();this._selectedItem=this.store.findWhere({id:e.attr("id")}),this._selectedItem&&($(".selected",$(this.el)).removeClass("selected"),e.addClass("selected"),this.updateFormControl(this._selectedItem),this.trigger("selected",this,_.extend({},this._selectedItem.toJSON()),t),t.preventDefault())},updateFormControl:function(t){var e=$(this.el).find(".form-control"),i=e.find("> .img-line"),s=e.find("> .text");0<t.get("value")?(0<(e=e.find("use")).length&&e[0].setAttribute("xlink:href","#"+t.get("imgId")),i.show(),s.hide()):(i.hide(),s.text(this.txtNoBorders).show())},setValue:function(e){this._selectedItem=null==e?void 0:_.find(this.store.models,function(t){if(e<t.attributes.value+.01&&e>t.attributes.value-.01)return!0}),$(".selected",$(this.el)).removeClass("selected"),this._selectedItem?(this.updateFormControl(this._selectedItem),$("#"+this._selectedItem.get("id"),$(this.el)).addClass("selected")):$(this.el).find(".form-control > .text").text("").show()},focus:function(){this._formControl&&this._formControl.focus()},txtNoBorders:"No Borders"},Common.UI.ComboBorderSize||{})),Common.UI.ComboBorderSizeEditable=Common.UI.ComboBox.extend(_.extend({template:_.template(['<span class="input-group combobox combo-border-size input-group-nr <%= cls %>" id="<%= id %>" style="<%= style %>">','<input type="text" class="form-control text" data-hint="<%= dataHint %>" data-hint-direction="<%= dataHintDirection %>" data-hint-offset="<%= dataHintOffset %>">','<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">','<span class="caret"></span>',"</button>",'<ul class="dropdown-menu <%= menuCls %>" style="<%= menuStyle %>" role="menu">',"<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%= item.value %>"><a tabindex="-1" type="menuitem">',"<% if (!isRTL) { %>","<span><%= item.displayValue %></span>","<% if (item.imgId!==undefined) { %>",'<span class="border-line">',"<svg>",'<use xlink:href="#<%= item.imgId %>"></use>',"</svg>","</span>","<% } %>","<% } else { %>","<% if (item.imgId!==undefined) { %>",'<span class="border-line">',"<svg>",'<use xlink:href="#<%= item.imgId %>"></use>',"</svg>","</span>","<% } %>","<span><%= item.displayValue %></span>","<% } %>","</a></li>","<% }); %>","</ul>","</span>"].join("")),initialize:function(t){this.txtNoBorders=t.txtNoBorders||this.txtNoBorders;var e=Common.Utils.Metric.getMetricName(Common.Utils.Metric.c_MetricUnits.pt),e=[{displayValue:"0.5 "+e,value:.5,pxValue:.5,imgId:"half-pt"},{displayValue:"1 "+e,value:1,pxValue:1,imgId:"one-pt"},{displayValue:"1.5 "+e,value:1.5,pxValue:2,imgId:"one-and-half-pt"},{displayValue:"2.25 "+e,value:2.25,pxValue:3,imgId:"two-and-quarter-pt"},{displayValue:"3 "+e,value:3,pxValue:4,imgId:"three-pt"},{displayValue:"4.5 "+e,value:4.5,pxValue:6,imgId:"four-and-half-pt"},{displayValue:"6 "+e,value:6,pxValue:8,imgId:"six-pt"}];!1!==t.allowNoBorders&&e.unshift({displayValue:this.txtNoBorders,value:0,pxValue:0}),Common.UI.ComboBox.prototype.initialize.call(this,_.extend({editable:!0,store:new Common.UI.BordersStore,data:e,menuStyle:"min-width: 160px;"},t))},render:function(t){return Common.UI.ComboBox.prototype.render.call(this,t),this},txtNoBorders:"No Borders"},Common.UI.ComboBorderSizeEditable||{})),Common.UI.ComboBorderType=Common.UI.ComboBorderSize.extend(_.extend({template:_.template(['<div class="input-group combobox combo-border-size combo-border-type input-group-nr <%= cls %>" id="<%= id %>" style="<%= style %>">','<div class="form-control" style="<%= style %>" data-hint="<%= dataHint %>" data-hint-direction="<%= dataHintDirection %>" data-hint-offset="<%= dataHintOffset %>">','<i class="img-line"><svg><use xlink:href="#solid"></use></svg></i>',"</div>",'<div style="display: table-cell;"></div>','<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">','<span class="caret"></span>',"</button>",'<ul class="dropdown-menu <%= menuCls %>" style="<%= menuStyle %>" role="menu">',"<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%= item.value %>"><a tabindex="-1" type="menuitem">',"<% if (item.imgId!==undefined) { %>","<span>",'<svg><use xlink:href="#<%= item.imgId %>"></use></svg>',"</span>","<% } %>","</a></li>","<% }); %>","</ul>","</div>"].join("")),initialize:function(t){Common.UI.ComboBorderSize.prototype.initialize.call(this,_.extend({store:new Common.UI.BordersStore,data:[{value:Asc.c_oDashType.solid,imgId:"solid"},{value:Asc.c_oDashType.sysDot,imgId:"dots"},{value:Asc.c_oDashType.sysDash,imgId:"dashes"},{value:Asc.c_oDashType.dash,imgId:"dashes-spaced"},{value:Asc.c_oDashType.dashDot,imgId:"dash-dot"},{value:Asc.c_oDashType.lgDash,imgId:"dashes-wide"},{value:Asc.c_oDashType.lgDashDot,imgId:"wide-dash-dot"},{value:Asc.c_oDashType.lgDashDotDot,imgId:"wide-dash-dot-dot"}]},t))},render:function(t){return Common.UI.ComboBorderSize.prototype.render.call(this,t),this},updateFormControl:function(t){var e,i;t?((e=$(this.el).find(".form-control > .img-line use")).length&&(i=(i=Math.ceil(t.get("pxValue")))||3,e[0].setAttribute("xlink:href","#"+t.get("imgId")),e.parent().css("height",i+"px")),$(this.el).find(".form-control > .img-line").show()):$(this.el).find(".form-control > .img-line").hide()},setValue:function(e){this._selectedItem=null==e?void 0:_.find(this.store.models,function(t){if(e<t.attributes.value+.01&&e>t.attributes.value-.01)return!0}),$(".selected",$(this.el)).removeClass("selected"),this.updateFormControl(this._selectedItem),this._selectedItem&&$("#"+this._selectedItem.get("id"),$(this.el)).addClass("selected")}},Common.UI.ComboBorderType||{})),Common.UI.ComboBoxColor=Common.UI.ComboBox.extend(_.extend({template:_.template(['<div class="input-group combobox combo-color combobox-color input-group-nr <%= cls %>" id="<%= id %>" style="<%= style %>">','<div class="form-control" style="<%= style %>">',"<div></div>","</div>",'<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">','<span class="caret"></span>',"</button>",'<ul class="dropdown-menu <%= menuCls %>" style="<%= menuStyle %>" role="menu">',"<% _.each(items, function(item) { %>","<% if (item.value==-1) { %>",'<li id="<%= item.id %>" data-value="<%= item.value %>"><a tabindex="-1" type="menuitem"><%= scope.getDisplayValue(item) %></a></li>',"<% } else { %>",'<li id="<%= item.id %>" data-value="<%= item.value %>">','<a tabindex="-1" type="menuitem"><div style="<%= item.styleStr %>"><%= scope.getDisplayValue(item) %></div></a>',"</li>","<% } %>","<% }); %>","</ul>","</div>"].join("")),itemClicked:function(t){var e=$(t.currentTarget).parent();this._selectedItem=this.store.findWhere({id:e.attr("id")}),this._selectedItem&&($(".selected",$(this.el)).removeClass("selected"),e.addClass("selected"),this.updateFormControl(this._selectedItem),this.trigger("selected",this,_.extend({},this._selectedItem.toJSON()),t),t.preventDefault())},updateFormControl:function(t){var e=$(this.el).find(".form-control > div");e[0].innerHTML=t.get("displayValue"),-1!=t.get("value")?e.css({"margin-top":"0"}):e.css({"margin-top":"1px"}),e.css(t.get("styleObj"))},setValue:function(t){var e;this._selectedItem=this.store.findWhere(((e={})[this.valueField]=t,e)),$(".selected",$(this.el)).removeClass("selected"),this._selectedItem?(this.updateFormControl(this._selectedItem),$("#"+this._selectedItem.get("id"),$(this.el)).addClass("selected")):((e=$(this.el).find(".form-control > div"))[0].innerHTML=t,e.css("margin-top","1px"),e.css({color:"","text-align":"",background:"",border:""}))},onResetItems:function(){this.itemsTemplate?$(this.el).find("ul").html($(this.itemsTemplate({items:this.store.toJSON(),scope:this}))):$(this.el).find("ul").html(_.template(["<% _.each(items, function(item) { %>","<% if (item.value==-1) { %>",'<li id="<%= item.id %>" data-value="<%= item.value %>"><a tabindex="-1" type="menuitem"><%= scope.getDisplayValue(item) %></a></li>',"<% } else { %>",'<li id="<%= item.id %>" data-value="<%= item.value %>">','<a tabindex="-1" type="menuitem""><div style="<%= item.styleStr %>"><%= scope.getDisplayValue(item) %></div></a>',"</li>","<% } %>","<% }); %>"].join(""))({items:this.store.toJSON(),scope:this})),_.isUndefined(this.scroller)||(this.scroller.destroy(),delete this.scroller),this.scroller=new Common.UI.Scroller(_.extend({el:$(".dropdown-menu",this.cmpEl),minScrollbarLength:40,includePadding:!0,wheelSpeed:10,alwaysVisibleY:this.scrollAlwaysVisible},this.options.scroller))}},Common.UI.ComboBoxColor||{})),Common.UI.ComboBoxIcons=Common.UI.ComboBox.extend(_.extend({template:_.template(['<div class="input-group combobox combobox-icons combo-color input-group-nr <%= cls %>" id="<%= id %>" style="<%= style %>">','<div class="form-control" style="<%= style %>">',"<div></div>","</div>",'<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">','<span class="caret"></span>',"</button>",'<ul class="dropdown-menu <%= menuCls %>" style="<%= menuStyle %>" role="menu">',"<% _.each(items, function(item) { %>","<% if (item.value==-1) { %>",'<li id="<%= item.id %>" data-value="<%= item.value %>"><a tabindex="-1" type="menuitem"><%= scope.getDisplayValue(item) %></a></li>',"<% } else { %>",'<li id="<%= item.id %>" data-value="<%= item.value %>">','<a tabindex="-1" type="menuitem">',"<% _.each(item.data.iconSet, function(icon) { %>","<img src=\"<%= item.data.icons.at(icon-1).get('icon') %>\">","<% }) %>","</a>","</li>","<% } %>","<% }); %>","</ul>","</div>"].join("")),itemClicked:function(t){var e=$(t.currentTarget).parent();this._selectedItem=this.store.findWhere({id:e.attr("id")}),this._selectedItem&&($(".selected",$(this.el)).removeClass("selected"),e.addClass("selected"),this.updateFormControl(this._selectedItem),this.trigger("selected",this,_.extend({},this._selectedItem.toJSON()),t),t.preventDefault())},updateFormControl:function(e){var i,t=$(this.el).find(".form-control > div");-1!=e.get("value")?(i="",_.each(e.get("data").iconSet,function(t){i+='<img src="'+e.get("data").icons.at(t-1).get("icon")+'">'}),t[0].innerHTML=i,t.css({"margin-top":"0"})):(t[0].innerHTML=e.get("displayValue"),t.css({"margin-top":"1px"}))},setValue:function(t){var e;this._selectedItem=this.store.findWhere(((e={})[this.valueField]=t,e)),$(".selected",$(this.el)).removeClass("selected"),this._selectedItem?(this.updateFormControl(this._selectedItem),$("#"+this._selectedItem.get("id"),$(this.el)).addClass("selected")):((e=$(this.el).find(".form-control > div"))[0].innerHTML=t,e.css({"margin-top":"1px"}))},onResetItems:function(){this.itemsTemplate?$(this.el).find("ul").html($(this.itemsTemplate({items:this.store.toJSON(),scope:this}))):$(this.el).find("ul").html(_.template(["<% _.each(items, function(item) { %>","<% if (item.value==-1) { %>",'<li id="<%= item.id %>" data-value="<%= item.value %>"><a tabindex="-1" type="menuitem"><%= scope.getDisplayValue(item) %></a></li>',"<% } else { %>",'<li id="<%= item.id %>" data-value="<%= item.value %>">','<a tabindex="-1" type="menuitem" style="padding: 5px;">',"<% _.each(item.data.iconSet, function(icon) { %>","<img src=\"<%= item.data.icons.at(icon-1).get('icon') %>\">","<% }) %>","</a>","</li>","<% } %>","<% }); %>"].join(""))({items:this.store.toJSON(),scope:this})),_.isUndefined(this.scroller)||(this.scroller.destroy(),delete this.scroller),this.scroller=new Common.UI.Scroller(_.extend({el:$(".dropdown-menu",this.cmpEl),minScrollbarLength:40,includePadding:!0,wheelSpeed:10,alwaysVisibleY:this.scrollAlwaysVisible},this.options.scroller))}},Common.UI.ComboBoxIcons||{}))}),void 0===Common&&(Common={}),define("common/main/lib/component/Slider",["common/main/lib/component/BaseView","underscore"],function(t,c){"use strict";Common.UI.SingleSlider=Common.UI.BaseView.extend({options:{width:100,minValue:0,maxValue:100,step:1,value:100,enableKeyEvents:!1,direction:"horizontal"},disabled:!1,template:c.template(['<div class="slider single-slider <% if (this.options.direction === \'vertical\') { %>vertical<% } %>" style="">','<div class="track"></div>','<div class="thumb" style=""></div>',"<% if (this.options.enableKeyEvents) { %>",'<input type="text" style="position: absolute; top:-10px; width: 1px; height: 1px;">',"<% } %>","</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);t=this;t.width=t.options.width,t.minValue=t.options.minValue,t.maxValue=t.options.maxValue,t.delta=100/(t.maxValue-t.minValue),t.step=t.options.step,t.direction=t.options.direction,t.options.el&&t.render(),this.setValue(t.options.value)},render:function(t){var e,i,s=this,o=(s.rendered?this.cmpEl=s.$el:(this.cmpEl=$(this.template({})),(t?(this.setElement(t,!1),t):s.$el).html(this.cmpEl)),this.cmpEl.find(".track-center").width(s.options.width-14),this.cmpEl["vertical"===s.direction?"height":"width"](s.options.width),this.thumb=this.cmpEl.find(".thumb"),function(t){t.preventDefault(),t.stopPropagation();t=Math.max(0,Math.min(100,Math.round(("vertical"===s.direction?t.pageY*Common.Utils.zoom()-s.cmpEl.offset().top:t.pageX*Common.Utils.zoom()-s.cmpEl.offset().left-s._dragstart)/s.width*100)));s.setThumbPosition(t),s.lastValue=s.value,s.value=t/s.delta+s.minValue,s.thumb.removeClass("active"),$(document).off("mouseup",o),$(document).off("mousemove",n),s._dragstart=void 0,s.trigger("changecomplete",s,Common.UI.isRTL()?s.maxValue-s.value:s.value,s.lastValue)}),n=function(t){s.disabled||void 0!==s._dragstart&&(t.preventDefault(),t.stopPropagation(),t=Math.max(0,Math.min(100,Math.round(("vertical"===s.direction?t.pageY*Common.Utils.zoom()-s.cmpEl.offset().top:t.pageX*Common.Utils.zoom()-s.cmpEl.offset().left-s._dragstart)/s.width*100))),s.setThumbPosition(t),s.lastValue=s.value,s.value=t/s.delta+s.minValue,.001<Math.abs(s.value-s.lastValue)&&s.trigger("change",s,Common.UI.isRTL()?s.maxValue-s.value:s.value,s.lastValue))},a=function(t){s.lastValue=s.value,s.value=Math.max(s.minValue,Math.min(s.maxValue,s.value+(t?s.step:-s.step))),s.setThumbPosition(Math.round((s.value-s.minValue)*s.delta)),s.trigger("change",s,Common.UI.isRTL()?s.maxValue-s.value:s.value,s.lastValue)},l=function(t){s.disabled||t.keyCode!=Common.UI.Keys.UP&&t.keyCode!=Common.UI.Keys.DOWN&&t.keyCode!=Common.UI.Keys.LEFT&&t.keyCode!=Common.UI.Keys.RIGHT||(t.preventDefault(),t.stopPropagation(),i.off("keydown","input",l),e=setInterval(c.bind(a,s,t.keyCode==Common.UI.Keys.UP||t.keyCode==Common.UI.Keys.RIGHT),100))};return s.rendered||((i=s.cmpEl).on("mousedown",".thumb",function(t){s.disabled||(s._dragstart="vertical"===s.direction?t.pageY*Common.Utils.zoom()-s.thumb.offset().top:t.pageX*Common.Utils.zoom()-s.thumb.offset().left-7,s.thumb.addClass("active"),$(document).on("mouseup",o),$(document).on("mousemove",n),s.options.enableKeyEvents&&setTimeout(function(){s.input.focus()},10))}),i.on("mousedown",".track",function(t){s.disabled||(t=Math.max(0,Math.min(100,Math.round(("vertical"===s.direction?t.pageY*Common.Utils.zoom()-s.cmpEl.offset().top:t.pageX*Common.Utils.zoom()-s.cmpEl.offset().left)/s.width*100))),s.setThumbPosition(t),s.lastValue=s.value,s.value=t/s.delta+s.minValue,s.trigger("change",s,Common.UI.isRTL()?s.maxValue-s.value:s.value,s.lastValue),s.trigger("changecomplete",s,Common.UI.isRTL()?s.maxValue-s.value:s.value,s.lastValue))}),this.options.enableKeyEvents&&(i.on("keydown","input",l),i.on("keyup","input",function(t){s.disabled||(t.keyCode==Common.UI.Keys.UP||t.keyCode==Common.UI.Keys.DOWN||Common.UI.Keys.LEFT||Common.UI.Keys.RIGHT)&&(t.stopPropagation(),t.preventDefault(),clearInterval(e),a(t.keyCode==Common.UI.Keys.UP||t.keyCode==Common.UI.Keys.RIGHT),i.on("keydown","input",l),s.trigger("changecomplete",s,Common.UI.isRTL()?s.maxValue-s.value:s.value,s.lastValue))}))),s.rendered=!0,this},setThumbPosition:function(t){"vertical"===this.direction?this.thumb.css({top:t+"%"}):this.thumb.css({left:t+"%"})},setValue:function(t){this.lastValue=this.value,this.value=Math.max(this.minValue,Math.min(this.maxValue,t)),this.setThumbPosition(Math.round(((Common.UI.isRTL()?this.maxValue-t:t)-this.minValue)*this.delta))},getValue:function(){return this.value},setDisabled:function(t){(t=!!t)!==this.disabled&&this.cmpEl.toggleClass("disabled",t),this.disabled=t}}),Common.UI.MultiSlider=Common.UI.BaseView.extend({options:{width:100,minValue:0,maxValue:100,values:[0,100],includeSnap:!1,intervalSnap:void 0,thumbTemplate:'<div class="thumb" style=""></div>'},disabled:!1,template:c.template(['<div class="slider multi-slider">','<div class="track">','<div class="track-left"></div>','<div class="track-center""></div>','<div class="track-right" style=""></div>',"</div>","<% _.each(items, function(item) { %>","<%= thumbTemplate %>","<% }); %>","</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);t=this;t.width=t.options.width,t.minValue=t.options.minValue,t.maxValue=t.options.maxValue,t.delta=100/(t.maxValue-t.minValue),t.includeSnap=t.options.includeSnap,t.intervalSnap=t.options.intervalSnap,t.thumbs=[],t.options.el&&t.render()},render:function(t){var r=this,t=(r.rendered?this.cmpEl=this.$el:(this.cmpEl=$(this.template({items:this.options.values,thumbTemplate:this.options.thumbTemplate})),(t?(this.setElement(t,!1),t):this.$el).html(this.cmpEl)),this.cmpEl),s=(t.find(".track-center").width(r.options.width-14),t.width(r.options.width),function(i){var s,o;r.includeSnap&&(s=r.minValue,o=function(t){return(.01*r.width*t+r.cmpEl.offset().left+r._dragstart)/Common.Utils.zoom()},r.centers=[],c.each(r.thumbs,function(t,e){e!=i&&s!=t.position&&(r.centers.push(o((t.position-s)/2+s)),s=t.position)}),s!=r.maxValue&&r.centers.push(o((r.maxValue-s)/2+s)))}),a=function(e){r.includeSnap&&c.each(r.centers,function(t){e.pageX<=t+r.intervalSnap&&e.pageX>=t-r.intervalSnap&&(e.pageX=t)})},o=function(t){for(var e=100,i=0,s=r.thumbs.length,o=0;o<s;o++){var n,a,l=Math.abs(r.thumbs[o].position-t);Math.abs(l<=e)&&(n=r.thumbs[o+1],void 0!==(a=r.thumbs[o-1])&&t<a.position||void 0!==n&&t>n.position||(i=o,e=l))}return i};return this.binding={onMouseUp:c.bind(function(t){t.preventDefault(),t.stopPropagation(),a(t);var e=t.data.index,i=r.thumbs[e].value,s=e-1<0?0:r.thumbs[e-1].position,o=e+1<r.thumbs.length?r.thumbs[e+1].position:100,t=Math.round((t.pageX*Common.Utils.zoom()-r.cmpEl.offset().left-r._dragstart)/r.width*100),s=t<s||o<t,o=Math.max(0,Math.min(100,t)),t=o/r.delta+r.minValue;r.thumbs.length<3&&(r.isRemoveThumb=!1),r.isRemoveThumb?(r.trigger("removethumb",r,c.findIndex(r.thumbs,{index:e})),r.trigger("change",r,t,i),r.trigger("changecomplete",r,t,i)):(r.setThumbPosition(e,o),r.thumbs[e].value=t,s&&r.sortThumbs()),$(document).off("mouseup",r.binding.onMouseUp),$(document).off("mousemove",r.binding.onMouseMove),r._dragstart=void 0,r.isRemoveThumb||r.trigger("changecomplete",r,t,i),r.isRemoveThumb=void 0},this),onMouseMove:c.bind(function(t){var e,i,s,o,n;r.disabled||void 0!==r._dragstart&&(t.preventDefault(),t.stopPropagation(),a(t),e=t.data.index,i=r.thumbs[e].value,s=e-1<0?0:r.thumbs[e-1].position,n=e+1<r.thumbs.length?r.thumbs[e+1].position:100,s=(o=Math.round((t.pageX*Common.Utils.zoom()-r.cmpEl.offset().left-r._dragstart)/r.width*100))<s||n<o,o=(n=Math.max(0,Math.min(100,o)))/r.delta+r.minValue,r.setThumbPosition(e,n),r.thumbs[e].value=o,s&&r.sortThumbs(),n=t.pageY*Common.Utils.zoom()-r.cmpEl.offset().top,r.isRemoveThumb=n>r.cmpEl.height()||n<0,r.setRemoveThumb(e,r.isRemoveThumb),.001<Math.abs(o-i)&&r.trigger("change",r,o,i))},this),onMouseDown:c.bind(function(t){var i,e;r.disabled||(i=t.data.index,e=r.thumbs[i].thumb,r._dragstart=t.pageX*Common.Utils.zoom()-e.offset().left-e.width()/2,s(i),r.setActiveThumb(i),c.each(r.thumbs,function(t,e){i==e?t.thumb.css("z-index",500):t.thumb.css("z-index","")}),$(document).on("mouseup",null,t.data,r.binding.onMouseUp),$(document).on("mousemove",null,t.data,r.binding.onMouseMove))},this)},this.$thumbs=t.find(".thumb"),c.each(this.$thumbs,function(t,e){t=$(t);r.thumbs.push({thumb:t,index:e}),r.setValue(e,r.options.values[e]),t.on("mousedown",null,r.thumbs[e],r.binding.onMouseDown)}),r.setActiveThumb(0,!0),r.rendered||t.on("mouseup",".track",function(t){var e,i;r.disabled||!c.isUndefined(r._dragstart)||9<r.thumbs.length||(t=Math.max(0,Math.min(100,Math.round((t.pageX*Common.Utils.zoom()-r.cmpEl.offset().left)/r.width*100))),e=o(t),r.thumbs[e].colorValue,r.thumbs[e].value,e=t/r.delta+r.minValue,r.addThumb(),i=r.thumbs.length-1,r.setThumbPosition(i,t),r.thumbs[i].value=e,r.trigger("addthumb",r,i,t),r.trigger("change",r),r.trigger("changecomplete",r))}),r.rendered=!0,this},setActiveThumb:function(t,e){this.currentThumb=t,this.$thumbs=this.cmpEl.find(".thumb"),this.$thumbs.removeClass("active"),this.thumbs[t].thumb.addClass("active"),!0!==e&&this.trigger("thumbclick",this,t)},setRemoveThumb:function(t,e){-1!==c.findIndex(this.thumbs,{index:t})&&(e&&2<this.thumbs.length?this.$el.find(".active").addClass("remove"):this.$el.find(".remove").removeClass("remove"))},setThumbPosition:function(t,e){this.thumbs[t].position=e,this.thumbs[t].thumb.css({left:e+"%"})},setValue:function(t,e){this.thumbs[t].value=Math.max(this.minValue,Math.min(this.maxValue,e)),this.setThumbPosition(t,Math.round((e-this.minValue)*this.delta))},getValue:function(t){return this.thumbs[t].value},getValues:function(){var e=[];return c.each(this.thumbs,function(t){e.push(t.value)}),e},setDisabled:function(t){(t=!!t)!==this.disabled&&this.cmpEl.toggleClass("disabled",t),this.disabled=t},sortThumbs:function(){this.thumbs.sort(function(t,e){return t.position-e.position});var i=[];return c.each(this.thumbs,function(t,e){i.push(t.index),t.index=e}),i},setThumbs:function(t){var e=this.thumbs.length;if(e!=t)for(var i=0;i<Math.abs(t-e);i++)e<t?this.addThumb():this.removeThumb()},addThumb:function(){var t=this.cmpEl,e=$(this.options.thumbTemplate),i=this.thumbs.length;t.append(e),this.thumbs.push({thumb:e,index:i}),0<i&&this.setValue(i,this.getValue(i-1)),e.on("mousedown",null,this.thumbs[i],this.binding.onMouseDown)},removeThumb:function(t){0<(t=void 0===t?this.thumbs.length-1:t)&&(this.thumbs[t].thumb.remove(),this.thumbs.splice(t,1))}})}),void 0===Common&&(Common={}),define("common/main/lib/component/MultiSliderGradient",["common/main/lib/component/Slider","underscore"],function(t,n){"use strict";Common.UI.MultiSliderGradient=Common.UI.MultiSlider.extend({options:{width:100,minValue:0,maxValue:100,values:[0,100],colorValues:["#000000","#ffffff"],currentThumb:0,includeSnap:!0,intervalSnap:5,thumbTemplate:'<div class="thumb" style=""><div class="thumb-top"><div class="thumb-top-inner"></div></div><div class="thumb-bottom"><div class="thumb-bottom-inner"></div></div></div>'},disabled:!1,template:n.template(['<div class="slider multi-slider-gradient">','<div class="track"></div>',"<% _.each(items, function(item) { %>","<%= thumbTemplate %>","<% }); %>","</div>"].join("")),initialize:function(t){this.styleStr={},Common.UI.MultiSlider.prototype.initialize.call(this,t)},render:function(t){Common.UI.MultiSlider.prototype.render.call(this,t);var e=this;e.trackEl=e.cmpEl.find(".track");for(var i=0;i<e.thumbs.length;i++)e.thumbs[i].thumb.on("dblclick",null,function(){e.trigger("thumbdblclick",e)}),e.thumbs[i].thumbcolor=e.thumbs[i].thumb.find("> div"),e.setColorValue(e.options.colorValues[i],i);e.changeSliderStyle(),e.changeGradientStyle(),e.on("change",n.bind(e.changeGradientStyle,e))},setColorValue:function(t,e){e=void 0!==e?e:this.currentThumb;this.thumbs[e].colorValue=t,this.thumbs[e].thumbcolor.css("background-color",t),this.changeGradientStyle()},getColorValue:function(t){t=void 0!==t?t:this.currentThumb;return this.thumbs[t].colorValue},setValue:function(t,e){Common.UI.MultiSlider.prototype.setValue.call(this,t,e),this.changeGradientStyle()},getColorValues:function(){var e=[];return n.each(this.thumbs,function(t){e.push(t.colorValue)}),e},changeGradientStyle:function(){var t;this.rendered&&(this.styleStr.specific&&(t=Common.Utils.String.format(this.styleStr.specific,this.getColorValues().concat(this.getValues())),this.trackEl.css("background",t)),Common.Utils.isIE&&(t=Common.Utils.String.format("progid:DXImageTransform.Microsoft.gradient( startColorstr={0}, endColorstr={1},GradientType=1 )",this.getColorValue(0),this.getColorValue(this.thumbs.length-1)),this.trackEl.css("filter",t)),this.styleStr.common&&(t=Common.Utils.String.format(this.styleStr.common,this.getColorValues().concat(this.getValues())),this.trackEl.css("background",t)))},sortThumbs:function(){var t=Common.UI.MultiSlider.prototype.sortThumbs.call(this);return this.trigger("sortthumbs",this,t),t},findLeftThumb:function(t){for(var e,i,s,o=100,n=0,a=this.thumbs.length,l=0;l<a;l++)0<(s=t-this.thumbs[l].position)&&s<=o&&(e=this.thumbs[l+1],void 0!==(i=this.thumbs[l-1])&&t<i.position||void 0!==e&&t>e.position||(n=l,o=s));return n},calculationNewColor:function(t,e,i){var i=i?i/100:.5,s=1-i,t=Common.Utils.ThemeColor.getRgbColor(t),e=Common.Utils.ThemeColor.getRgbColor(e),t=[Math.round(t.get_r()*s+e.get_r()*i),Math.round(t.get_g()*s+e.get_g()*i),Math.round(t.get_b()*s+e.get_b()*i)];return Common.Utils.ThemeColor.getHexColor(t[0],t[1],t[2])},addThumb:function(){Common.UI.MultiSlider.prototype.addThumb.call(this);var t=this,e=t.thumbs.length-1;t.thumbs[e].thumb.on("dblclick",null,function(){t.trigger("thumbdblclick",t)}),t.thumbs[e].thumbcolor=t.thumbs[e].thumb.find("> div"),0<e&&this.setColorValue(this.getColorValue(e-1),e),t.changeSliderStyle()},addNewThumb:function(t,e,i){var s,o=this.findLeftThumb(e);return n.isUndefined(i)?s=(i=100*(e-this.thumbs[o].value)/(this.thumbs[o+1].value-this.thumbs[o].value))<0?this.thumbs[o].colorValue:this.calculationNewColor(this.thumbs[o].colorValue,this.thumbs[o===t-1?o:o+1].colorValue,i):(this.addThumb(),t=this.thumbs.length-1,s=this.calculationNewColor(this.thumbs[o].colorValue,this.thumbs[o===t-1?o:o+1].colorValue),this.setThumbPosition(t,e),i=e/this.delta+this.minValue,this.thumbs[t].value=i),this.thumbs[t].thumbcolor=this.thumbs[t].thumb.find("> div"),0<t&&this.setColorValue("#"+s,t),this.sortThumbs(),this.changeSliderStyle(),this.changeGradientStyle(),s},removeThumb:function(t){void 0===t&&(t=this.thumbs.length-1),2<this.thumbs.length&&(this.thumbs[t].thumb.remove(),this.thumbs.splice(t,1),this.sortThumbs(),this.changeSliderStyle())},changeSliderStyle:function(){this.styleStr={specific:"",common:"linear-gradient(to right"},Common.Utils.isChrome&&Common.Utils.chromeVersion<10||Common.Utils.isSafari&&Common.Utils.safariVersion<5.1?this.styleStr.specific="-webkit-gradient(linear, left top, right top":Common.Utils.isChrome||Common.Utils.isSafari?this.styleStr.specific="-webkit-linear-gradient(left":Common.Utils.isGecko?this.styleStr.specific="-moz-linear-gradient(left":Common.Utils.isOpera&&11<Common.Utils.operaVersion?this.styleStr.specific="-o-linear-gradient(left":Common.Utils.isIE&&(this.styleStr.specific="-ms-linear-gradient(left");for(var t=0;t<this.thumbs.length;t++)this.styleStr.common+=", {"+t+"} {"+(this.thumbs.length+t)+"}%",Common.Utils.isChrome&&Common.Utils.chromeVersion<10||Common.Utils.isSafari&&Common.Utils.safariVersion<5.1?this.styleStr.specific+=", color-stop({"+(this.thumbs.length+t)+"}%,{"+t+"})":this.styleStr.specific+=", {"+t+"} {"+(this.thumbs.length+t)+"}%";this.styleStr.specific+=")",this.styleStr.common+=")"}})}),define("text!spreadsheeteditor/main/app/template/ShapeSettingsAdvanced.template",[],function(){return'<div id="id-adv-shape-width" class="settings-panel active">\n    <div class="inner-content">\n    <table cols="3">\n        <tr>\n            <td width="108px">\n                <label class="input-label"><%= scope.textWidth %></label>\n                <div id="shape-advanced-spin-width"></div>\n            </td>\n            <td width="28px" style="vertical-align: bottom;">\n                <div id="shape-advanced-button-ratio"></div>\n            </td>\n            <td width="108px">\n                <label class="input-label"><%= scope.textHeight %></label>\n                <div id="shape-advanced-spin-height"></div>\n            </td>\n        </tr>\n    </table>\n    </div>\n</div>\n<div id="id-adv-shape-rotate" class="settings-panel active">\n    <div class="inner-content  padding-large">\n        <div style="width: 100%;">\n            <label class="input-label"><%= scope.textAngle %></label>\n            <div id="shape-advanced-spin-angle" class="margin-left-5" style="display: inline-block;"></div>\n        </div>\n    </div>\n    <div class="separator horizontal padding-large"></div>\n    <div class="inner-content  padding-large">\n        <table cols="2">\n            <tr>\n                <td rowspan="2" class="padding-small" style="vertical-align: top;">\n                    <label class="input-label margin-right-15" style="vertical-align: top;"><%= scope.textFlipped %></label>\n                </td>\n                <td class="padding-small">\n                    <div id="shape-advanced-checkbox-hor"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="shape-advanced-checkbox-vert"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-adv-shape-shape" class="settings-panel">\n    <div class="inner-content">\n        <table cols="2" style="width: 100%;">\n            <tr>\n                <td colspan=2 class="padding-small">\n                    <label class="header"><%= scope.textLineStyle %></label>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-large" width="125px">\n                    <label class="input-label"><%= scope.textCapType %></label>\n                    <div id="shape-advanced-cap-type" style="width: 100px;"></div>\n                </td>\n                <td class="padding-large">\n                    <label class="input-label"><%= scope.textJoinType %></label>\n                    <div id="shape-advanced-join-type" style="width: 100px;"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n    <div class="separator horizontal padding-large"></div>\n    <div class="inner-content">\n        <table cols="2" style="width: 100%;">\n            <tr>\n                <td colspan=2 class="padding-small">\n                    <label class="header"><%= scope.textArrows %></label>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small" width="125px">\n                    <label class="input-label"><%= scope.textBeginStyle %></label>\n                    <div id="shape-advanced-begin-style" style="width: 100px;"></div>\n                </td>\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textEndStyle %></label>\n                    <div id="shape-advanced-end-style" style="width: 100px;"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textBeginSize %></label>\n                    <div id="shape-advanced-begin-size" style="width: 100px;"></div>\n                </td>\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textEndSize %></label>\n                    <div id="shape-advanced-end-size" style="width: 100px;"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-adv-shape-margins" class="settings-panel">\n    <div class="inner-content">\n        <table cols="1" style="width: 100%;">\n            <tr>\n                <td class="padding-small">\n                    <label class="header"><%= scope.textAutofit %></label>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="shape-checkbox-autofit"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-large">\n                    <div id="shape-checkbox-overflow"></div>\n                </td>\n            </tr>\n        </table>\n        <div class="separator horizontal padding-large"></div>\n        <table cols="2" style="width: 100%;">\n            <tr>\n                <td colspan=2 class="padding-small">\n                    <label class="header"><%= scope.strMargins %></label>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small" width="125px">\n                    <label class="input-label"><%= scope.textTop %></label>\n                    <div id="shape-margin-top"></div>\n                </td>\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textLeft %></label>\n                    <div id="shape-margin-left"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textBottom %></label>\n                    <div id="shape-margin-bottom"></div>\n                </td>\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textRight %></label>\n                    <div id="shape-margin-right"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-adv-shape-columns" class="settings-panel">\n    <div class="inner-content">\n        <table cols="1" style="width: 100%;">\n            <tr>\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textColNumber %></label>\n                    <div id="shape-columns-number"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textSpacing %></label>\n                    <div id="shape-columns-spacing"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-adv-shape-snap" class="settings-panel">\n    <div class="inner-content">\n        <table cols="1">\n            <tr>\n                <td class="padding-small">\n                    <div id="shape-radio-twocell"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="shape-radio-onecell"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="shape-radio-absolute"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-adv-shape-alttext" class="settings-panel">\n    <div class="inner-content">\n        <table cols="1" width="100%">\n            <tr>\n                <td class="padding-large">\n                    <label class="header"><%= scope.textAltTitle %></label>\n                    <div id="shape-advanced-alt-title"></div>\n                </td>\n            </tr>\n            <tr>\n                <td>\n                    <label class="header"><%= scope.textAltDescription %></label>\n                    <textarea id="shape-advanced-alt-description" class="form-control" style="width: 100%; height: 70px;"></textarea>\n                </td>\n            </tr>\n            <tr>\n                <td>\n                    <label><%= scope.textAltTip %></label>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>'}),void 0===Common&&(Common={}),define("common/main/lib/component/ComboBoxDataView",["common/main/lib/component/BaseView","common/main/lib/component/Scroller"],function(){"use strict";Common.UI.ComboBoxDataView=Common.UI.BaseView.extend({options:{id:null,cls:"",style:"",hint:!1,formTemplate:null,disabled:!1,menuCls:"",menuStyle:"",restoreHeight:0,takeFocusOnClose:!1,dataHint:"",dataHintDirection:"",dataHintOffset:""},template:_.template(['<div class="input-group combobox combo-dataview-menu input-group-nr dropdown-toggle <%= cls %>" data-toggle="dropdown" id="<%= id %>" style="<%= style %>">',"<%= formTemplate() %>",'<div style="display: table-cell;"></div>','<button type="button" class="btn btn-default dropdown-toggle"><span class="caret"></span></button>',"</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);t=this;t.id=t.options.id||Common.UI.getId(),this.cls=t.options.cls,this.style=t.options.style,this.menuCls=t.options.menuCls,this.menuStyle=t.options.menuStyle,this.dataViewStyle=t.options.dataViewStyle,this.dataViewCls=t.options.dataViewCls,this.template=t.options.template||t.template,this.itemTemplate=t.options.itemTemplate,this.disabled=t.options.disabled,this.groups=t.options.groups||null,this.store=t.options.store||new Common.UI.DataViewStore,this.updateFormControl=t.options.updateFormControl,this.options.data&&t.store.add(this.options.data),this.formTemplate=this.options.formTemplate||_.template(['<div class="form-control" style="width: 100px;" data-hint="<%= dataHint %>" data-hint-direction="<%= dataHintDirection %>" data-hint-offset="<%= dataHintOffset %>">','<i class="img-arrows"><svg><use xlink:href=""></use></svg></i>',"</div>"].join("")),t.rendered=t.options.rendered||!1,t.options.el?t.render():t.options.parentEl&&t.render(t.options.parentEl)},render:function(t){var e=this;return e.rendered?this.cmpEl=e.$el||$(this.el):(this.cmpEl=$(this.template({id:this.id,cls:this.cls,style:this.style,formTemplate:this.formTemplate,dataHintDirection:this.options.dataHintDirection,dataHintOffset:this.options.dataHintOffset,isRTL:Common.UI.isRTL()})),(t?(this.setElement(t,!1),t):this.$el).html(this.cmpEl)),e.rendered||(t=this.cmpEl,this._button=t.find(".btn"),this._formControl=t.find(".form-control"),Common.NotificationCenter.on("menumanager:hideall",_.bind(e.closeMenu,e))),e.getMenu(),e.rendered=!0,e.disabled&&e.setDisabled(e.disabled),this},getMenu:function(e){var t,i,s,o;return"object"!=typeof this.menu&&(e=e||this.options,t=Common.UI.getId(),i=this.$el||$(this.el),s=new Common.UI.Menu({id:t,cls:e.menuCls,style:e.menuStyle,additionalAlign:e.additionalAlign,items:(e.additionalItems||[]).concat([{template:_.template('<div id="'+t+'-data-menu" style="'+e.dataViewStyle+'" class="'+e.dataViewCls+'"></div>')}])}).render(i),this.dataPicker=new Common.UI.DataView({el:i.find("#"+t+"-data-menu"),parentMenu:s,outerMenu:{menu:s,index:e.additionalItems?e.additionalItems.length:0,focusOnShow:!e.additionalItems},groups:e.groups,store:e.store,itemTemplate:e.itemTemplate,restoreHeight:e.restoreHeight}),this.dataPicker.on("item:click",_.bind(this.onClickItem,this)),s.setInnerMenu([{menu:this.dataPicker,index:e.additionalItems?e.additionalItems.length:0}]),o=this,s.on("keydown:before",_.bind(this.onBeforeKeyDown,this)),s.on("show:after",function(t){o.dataPicker&&_.delay(function(){e.additionalItems||o.dataPicker.focus()},10)}).on("hide:after",function(){o.options.takeFocusOnClose&&setTimeout(function(){o.focus()},1)}),this.menu=s),this.menu},getPicker:function(){return this.dataPicker},onClickItem:function(t,e,i){this.updateFormControl&&this.updateFormControl.call(this,i),this.disabled||this.isSuspendEvents||this.trigger("item:click",this,t,e,i)},selectRecord:function(t){this.rendered&&(this.dataPicker&&this.dataPicker.selectRecord(t,!0),this.updateFormControl&&this.updateFormControl.call(this,t))},onBeforeKeyDown:function(t,e){if((e.keyCode==Common.UI.Keys.DOWN||e.keyCode==Common.UI.Keys.SPACE)&&!this.isMenuOpen())return $("button",this.cmpEl).click(),e.preventDefault(),e.stopPropagation(),!1},closeMenu:function(){(this.$el||$(this.el)).removeClass("open")},isMenuOpen:function(){return(this.$el||$(this.el)).hasClass("open")},setTabIndex:function(t){this.rendered&&(this.tabindex=t.toString(),this.disabled||this._formControl.attr("tabindex",this.tabindex))},setDisabled:function(t){this.disabled=t=!!t,this.rendered&&(void 0!==this.tabindex&&(t&&(this.tabindex=this._formControl.attr("tabindex")),this._formControl.attr("tabindex",t?"-1":this.tabindex)),this.cmpEl.toggleClass("disabled",t),this._button.toggleClass("disabled",t),this._formControl.toggleClass("disabled",t))},isDisabled:function(){return this.disabled},focus:function(){this._formControl&&this._formControl.focus()}})}),define("spreadsheeteditor/main/app/view/ShapeSettingsAdvanced",["text!spreadsheeteditor/main/app/template/ShapeSettingsAdvanced.template","common/main/lib/view/AdvancedSettingsWindow","common/main/lib/component/ComboBox","common/main/lib/component/MetricSpinner","common/main/lib/component/CheckBox","common/main/lib/component/ComboBoxDataView"],function(e){"use strict";SSE.Views.ShapeSettingsAdvanced=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:300,height:342,toggleGroup:"shape-adv-settings-group",sizeOriginal:{width:0,height:0},sizeMax:{width:55.88,height:55.88},properties:null,storageName:"sse-shape-settings-adv-category"},initialize:function(t){_.extend(this.options,{title:this.textTitle,items:[{panelId:"id-adv-shape-width",panelCaption:this.textSize},{panelId:"id-adv-shape-rotate",panelCaption:this.textRotation},{panelId:"id-adv-shape-shape",panelCaption:this.textWeightArrows},{panelId:"id-adv-shape-margins",panelCaption:this.textTextBox},{panelId:"id-adv-shape-columns",panelCaption:this.strColumns},{panelId:"id-adv-shape-snap",panelCaption:this.textSnap},{panelId:"id-adv-shape-alttext",panelCaption:this.textAlt}],contentTemplate:_.template(e)({scope:this})},t),Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options),this.spinners=[],this.Margins=void 0,this._nRatio=1,this._originalProps=this.options.shapeProps,this._changedProps=null},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var e=this,t=(this.spnWidth=new Common.UI.MetricSpinner({el:$("#shape-advanced-spin-width"),step:.1,width:100,defaultUnit:"cm",value:"3 cm",maxValue:55.88,minValue:0}),this.spnWidth.on("change",_.bind(function(t,e,i,s){var o,n;this.btnRatio.pressed&&((n=t.getNumberValue()/this._nRatio)>this.spnHeight.options.maxValue&&(o=(n=this.spnHeight.options.maxValue)*this._nRatio,this.spnWidth.setValue(o,!0)),this.spnHeight.setValue(n,!0)),this._changedProps&&(this._changedProps.asc_putWidth(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())),this._changedProps.asc_putHeight(Common.Utils.Metric.fnRecalcToMM(this.spnHeight.getNumberValue())))},this)),this.spinners.push(this.spnWidth),this.spnHeight=new Common.UI.MetricSpinner({el:$("#shape-advanced-spin-height"),step:.1,width:100,defaultUnit:"cm",value:"3 cm",maxValue:55.88,minValue:0}),this.spnHeight.on("change",_.bind(function(t,e,i,s){var o=t.getNumberValue(),n=null;this.btnRatio.pressed&&((n=o*this._nRatio)>this.spnWidth.options.maxValue&&(o=(n=this.spnWidth.options.maxValue)/this._nRatio,this.spnHeight.setValue(o,!0)),this.spnWidth.setValue(n,!0)),this._changedProps&&(this._changedProps.asc_putHeight(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())),this._changedProps.asc_putWidth(Common.Utils.Metric.fnRecalcToMM(this.spnWidth.getNumberValue())))},this)),this.spinners.push(this.spnHeight),this.btnRatio=new Common.UI.Button({parentEl:$("#shape-advanced-button-ratio"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-advanced-ratio",style:"margin-bottom: 1px;",enableToggle:!0,hint:this.textKeepRatio}),this.btnRatio.on("click",_.bind(function(t,e){t.pressed&&0<this.spnHeight.getNumberValue()&&(this._nRatio=this.spnWidth.getNumberValue()/this.spnHeight.getNumberValue()),this._changedProps&&this._changedProps.asc_putLockAspect(t.pressed)},this)),this.spnMarginTop=new Common.UI.MetricSpinner({el:$("#shape-margin-top"),step:.1,width:100,defaultUnit:"cm",value:"0 cm",maxValue:55.87,minValue:0}),this.spnMarginTop.on("change",_.bind(function(t,e,i,s){this._changedProps&&(null!==this._changedProps.asc_getShapeProperties()&&void 0!==this._changedProps.asc_getShapeProperties()||this._changedProps.asc_putShapeProperties(new Asc.asc_CShapeProperty),null===this._changedProps.asc_getShapeProperties().asc_getPaddings()&&this._changedProps.asc_getShapeProperties().asc_putPaddings(new Asc.asc_CPaddings),this._changedProps.asc_getShapeProperties().asc_getPaddings().asc_putTop(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())))},this)),this.spinners.push(this.spnMarginTop),this.spnMarginBottom=new Common.UI.MetricSpinner({el:$("#shape-margin-bottom"),step:.1,width:100,defaultUnit:"cm",value:"0 cm",maxValue:55.87,minValue:0}),this.spnMarginBottom.on("change",_.bind(function(t,e,i,s){this._changedProps&&(null!==this._changedProps.asc_getShapeProperties()&&void 0!==this._changedProps.asc_getShapeProperties()||this._changedProps.asc_putShapeProperties(new Asc.asc_CShapeProperty),null===this._changedProps.asc_getShapeProperties().asc_getPaddings()&&this._changedProps.asc_getShapeProperties().asc_putPaddings(new Asc.asc_CPaddings),this._changedProps.asc_getShapeProperties().asc_getPaddings().asc_putBottom(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())))},this)),this.spinners.push(this.spnMarginBottom),this.spnMarginLeft=new Common.UI.MetricSpinner({el:$("#shape-margin-left"),step:.1,width:100,defaultUnit:"cm",value:"0.19 cm",maxValue:9.34,minValue:0}),this.spnMarginLeft.on("change",_.bind(function(t,e,i,s){this._changedProps&&(null!==this._changedProps.asc_getShapeProperties()&&void 0!==this._changedProps.asc_getShapeProperties()||this._changedProps.asc_putShapeProperties(new Asc.asc_CShapeProperty),null===this._changedProps.asc_getShapeProperties().asc_getPaddings()&&this._changedProps.asc_getShapeProperties().asc_putPaddings(new Asc.asc_CPaddings),this._changedProps.asc_getShapeProperties().asc_getPaddings().asc_putLeft(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())))},this)),this.spinners.push(this.spnMarginLeft),this.spnMarginRight=new Common.UI.MetricSpinner({el:$("#shape-margin-right"),step:.1,width:100,defaultUnit:"cm",value:"0.19 cm",maxValue:9.34,minValue:0}),this.spnMarginRight.on("change",_.bind(function(t,e,i,s){this._changedProps&&(null!==this._changedProps.asc_getShapeProperties()&&void 0!==this._changedProps.asc_getShapeProperties()||this._changedProps.asc_putShapeProperties(new Asc.asc_CShapeProperty),null===this._changedProps.asc_getShapeProperties().asc_getPaddings()&&this._changedProps.asc_getShapeProperties().asc_putPaddings(new Asc.asc_CPaddings),this._changedProps.asc_getShapeProperties().asc_getPaddings().asc_putRight(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())))},this)),this.spinners.push(this.spnMarginRight),this.chAutofit=new Common.UI.CheckBox({el:$("#shape-checkbox-autofit"),labelText:this.textResizeFit}),this.chAutofit.on("change",_.bind(function(t,e,i,s){this._changedProps&&(null!==this._changedProps.asc_getShapeProperties()&&void 0!==this._changedProps.asc_getShapeProperties()||this._changedProps.asc_putShapeProperties(new Asc.asc_CShapeProperty),this._changedProps.asc_getShapeProperties().asc_putTextFitType("checked"==t.getValue()?AscFormat.text_fit_Auto:AscFormat.text_fit_No))},this)),this.chOverflow=new Common.UI.CheckBox({el:$("#shape-checkbox-overflow"),labelText:this.textOverflow}),this.chOverflow.on("change",_.bind(function(t,e,i,s){this._changedProps&&(null!==this._changedProps.asc_getShapeProperties()&&void 0!==this._changedProps.asc_getShapeProperties()||this._changedProps.asc_putShapeProperties(new Asc.asc_CShapeProperty),this._changedProps.asc_getShapeProperties().asc_putVertOverflowType("checked"==t.getValue()?AscFormat.nOTOwerflow:AscFormat.nOTClip))},this)),this.spnAngle=new Common.UI.MetricSpinner({el:$("#shape-advanced-spin-angle"),step:1,width:80,defaultUnit:"°",value:"0 °",maxValue:3600,minValue:-3600}),this.chFlipHor=new Common.UI.CheckBox({el:$("#shape-advanced-checkbox-hor"),labelText:this.textHorizontally}),this.chFlipVert=new Common.UI.CheckBox({el:$("#shape-advanced-checkbox-vert"),labelText:this.textVertically}),this._arrCapType=[{displayValue:this.textFlat,value:Asc.c_oAscLineCapType.Flat},{displayValue:this.textRound,value:Asc.c_oAscLineCapType.Round},{displayValue:this.textSquare,value:Asc.c_oAscLineCapType.Square}],this.cmbCapType=new Common.UI.ComboBox({el:$("#shape-advanced-cap-type"),cls:"input-group-nr",menuStyle:"min-width: 100px;",editable:!1,data:this._arrCapType,takeFocusOnClose:!0}),this.cmbCapType.setValue(Asc.c_oAscLineCapType.Flat),this.cmbCapType.on("selected",_.bind(function(t,e){this._changedProps&&(null!==this._changedProps.asc_getShapeProperties()&&void 0!==this._changedProps.asc_getShapeProperties()||this._changedProps.asc_putShapeProperties(new Asc.asc_CShapeProperty),null===this._changedProps.asc_getShapeProperties().asc_getStroke()&&this._changedProps.asc_getShapeProperties().asc_putStroke(new Asc.asc_CStroke),this._changedProps.asc_getShapeProperties().asc_getStroke().asc_putLinecap(e.value))},this)),this._arrJoinType=[{displayValue:this.textRound,value:Asc.c_oAscLineJoinType.Round},{displayValue:this.textBevel,value:Asc.c_oAscLineJoinType.Bevel},{displayValue:this.textMiter,value:Asc.c_oAscLineJoinType.Miter}],this.cmbJoinType=new Common.UI.ComboBox({el:$("#shape-advanced-join-type"),cls:"input-group-nr",menuStyle:"min-width: 100px;",editable:!1,data:this._arrJoinType,takeFocusOnClose:!0}),this.cmbJoinType.setValue(Asc.c_oAscLineJoinType.Round),this.cmbJoinType.on("selected",_.bind(function(t,e){this._changedProps&&(null!==this._changedProps.asc_getShapeProperties()&&void 0!==this._changedProps.asc_getShapeProperties()||this._changedProps.asc_putShapeProperties(new Asc.asc_CShapeProperty),null===this._changedProps.asc_getShapeProperties().asc_getStroke()&&this._changedProps.asc_getShapeProperties().asc_putStroke(new Asc.asc_CStroke),this._changedProps.asc_getShapeProperties().asc_getStroke().asc_putLinejoin(e.value))},this)),[]),i=[];t.push({type:Asc.c_oAscLineBeginType.None,idsvg:"no-"}),t.push({type:Asc.c_oAscLineBeginType.Triangle,idsvg:""}),t.push({type:Asc.c_oAscLineBeginType.Arrow,idsvg:"open-"}),t.push({type:Asc.c_oAscLineBeginType.Stealth,idsvg:"stealth-"}),t.push({type:Asc.c_oAscLineBeginType.Diamond,idsvg:"dimond-"}),t.push({type:Asc.c_oAscLineBeginType.Oval,idsvg:"oval-"});for(var s=0;s<6;s++)t[s].value=s;for(s=0;s<9;s++)i.push({value:s,typearrow:""});for(i[0].type=Asc.c_oAscLineBeginSize.small_small,i[1].type=Asc.c_oAscLineBeginSize.small_mid,i[2].type=Asc.c_oAscLineBeginSize.small_large,i[3].type=Asc.c_oAscLineBeginSize.mid_small,i[4].type=Asc.c_oAscLineBeginSize.mid_mid,i[5].type=Asc.c_oAscLineBeginSize.mid_large,i[6].type=Asc.c_oAscLineBeginSize.large_small,i[7].type=Asc.c_oAscLineBeginSize.large_mid,i[8].type=Asc.c_oAscLineBeginSize.large_large,this.btnBeginStyle=new Common.UI.ComboBox({el:$("#shape-advanced-begin-style"),template:_.template(['<div class="input-group combobox combo-dataview-menu input-group-nr dropdown-toggle combo-arrow-style"  data-toggle="dropdown">','<div class="form-control" style="width: 100px;">','<i class="img-arrows"><svg><use xlink:href="#no-arrow-5"></use></svg></i>',"</div>",'<div style="display: table-cell;"></div>','<button type="button" class="btn btn-default"><span class="caret"></span></button>',"</div>"].join(""))}),this.btnBeginStyleMenu=new Common.UI.Menu({style:"min-width: 105px;",additionalAlign:this.menuAddAlign,items:[{template:_.template('<div id="shape-advanced-menu-begin-style" style="width: 105px; margin: 0 5px;"></div>')}]}).render($("#shape-advanced-begin-style")),this.mnuBeginStylePicker=new Common.UI.DataView({el:$("#shape-advanced-menu-begin-style"),parentMenu:this.btnBeginStyleMenu,store:new Common.UI.DataViewStore(t),itemTemplate:_.template('<div id="<%= id %>" class="item-arrow img-arrows"><svg><use xlink:href= "#<%= idsvg %>arrow-5"></use></svg></div>')}),this.mnuBeginStylePicker.on("item:click",_.bind(this.onSelectBeginStyle,this)),this._selectStyleItem(this.btnBeginStyle,null),this.btnBeginSize=new Common.UI.ComboBox({el:$("#shape-advanced-begin-size"),template:_.template(['<div class="input-group combobox combo-dataview-menu input-group-nr dropdown-toggle combo-arrow-style"  data-toggle="dropdown">','<div class="form-control" style="width: 100px;">','<i class="img-arrows"><svg><use xlink:href=""></use></svg></i>',"</div>",'<div style="display: table-cell;"></div>','<button type="button" class="btn btn-default"><span class="caret"></span></button>',"</div>"].join(""))}),this.btnBeginSizeMenu=new Common.UI.Menu({style:"min-width: 160px;",additionalAlign:this.menuAddAlign,items:[{template:_.template('<div id="shape-advanced-menu-begin-size" style="width: 160px; margin: 0 5px;"></div>')}]}).render($("#shape-advanced-begin-size")),this.mnuBeginSizePicker=new Common.UI.DataView({el:$("#shape-advanced-menu-begin-size"),parentMenu:this.btnBeginSizeMenu,store:new Common.UI.DataViewStore(i),itemTemplate:_.template('<div id="<%= id %>" class="item-arrow img-arrows"><svg><use xlink:href="#<%= typearrow %>arrow-<%= (value+1) %>"></use></svg></div>')}),this.mnuBeginSizePicker.on("item:click",_.bind(this.onSelectBeginSize,this)),this._selectStyleItem(this.btnBeginSize,null),s=0;s<t.length;s++)t[s].offsety+=200;for(s=0;s<i.length;s++)i[s].offsety+=200;this.btnEndStyle=new Common.UI.ComboBox({el:$("#shape-advanced-end-style"),template:_.template(['<div class="input-group combobox combo-dataview-menu input-group-nr dropdown-toggle combo-arrow-style"  data-toggle="dropdown">','<div class="form-control" style="width: 100px;">','<i class="img-arrows"><svg class ="svg-mirror"><use xlink:href="#no-arrow-5"></use></svg></i>',"</div>",'<div style="display: table-cell;"></div>','<button type="button" class="btn btn-default"><span class="caret"></span></button>',"</div>"].join(""))}),this.btnEndStyleMenu=new Common.UI.Menu({style:"min-width: 105px;",additionalAlign:this.menuAddAlign,items:[{template:_.template('<div id="shape-advanced-menu-end-style" style="width: 105px; margin: 0 5px;"></div>')}]}).render($("#shape-advanced-end-style")),this.mnuEndStylePicker=new Common.UI.DataView({el:$("#shape-advanced-menu-end-style"),parentMenu:this.btnEndStyleMenu,store:new Common.UI.DataViewStore(t),itemTemplate:_.template('<div id="<%= id %>" class="item-arrow img-arrows"><svg class ="svg-mirror"><use xlink:href="#<%= idsvg %>arrow-5"></use></svg></div>')}),this.mnuEndStylePicker.on("item:click",_.bind(this.onSelectEndStyle,this)),this._selectStyleItem(this.btnEndStyle,null),this.btnEndSize=new Common.UI.ComboBox({el:$("#shape-advanced-end-size"),template:_.template(['<div class="input-group combobox combo-dataview-menu input-group-nr dropdown-toggle combo-arrow-style"  data-toggle="dropdown">','<div class="form-control" style="width: 100px;">','<i class="img-arrows"><svg class ="svg-mirror"><use xlink:href=""></use></svg></i>',"</div>",'<div style="display: table-cell;"></div>','<button type="button" class="btn btn-default"><span class="caret"></span></button>',"</div>"].join(""))}),this.btnEndSizeMenu=new Common.UI.Menu({style:"min-width: 160px;",additionalAlign:this.menuAddAlign,items:[{template:_.template('<div id="shape-advanced-menu-end-size" style="width: 160px; margin: 0 5px;"></div>')}]}).render($("#shape-advanced-end-size")),this.mnuEndSizePicker=new Common.UI.DataView({el:$("#shape-advanced-menu-end-size"),parentMenu:this.btnEndSizeMenu,store:new Common.UI.DataViewStore(i),itemTemplate:_.template('<div id="<%= id %>" class="item-arrow img-arrows"><svg class ="svg-mirror"><use xlink:href="#<%= typearrow %>arrow-<%= (value + 1) %>"></use></svg></div>')}),this.mnuEndSizePicker.on("item:click",_.bind(this.onSelectEndSize,this)),this._selectStyleItem(this.btnEndSize,null),this.spnColumns=new Common.UI.MetricSpinner({el:$("#shape-columns-number"),step:1,allowDecimal:!1,width:100,defaultUnit:"",value:"1",maxValue:16,minValue:1}),this.spnColumns.on("change",_.bind(function(t,e,i,s){this._changedProps&&(null!==this._changedProps.asc_getShapeProperties()&&void 0!==this._changedProps.asc_getShapeProperties()||this._changedProps.asc_putShapeProperties(new Asc.asc_CShapeProperty),this._changedProps.asc_getShapeProperties().asc_putColumnNumber(t.getNumberValue()))},this)),this.spnSpacing=new Common.UI.MetricSpinner({el:$("#shape-columns-spacing"),step:.1,width:100,defaultUnit:"cm",value:"0 cm",maxValue:40.64,minValue:0}),this.spnSpacing.on("change",_.bind(function(t,e,i,s){this._changedProps&&(null!==this._changedProps.asc_getShapeProperties()&&void 0!==this._changedProps.asc_getShapeProperties()||this._changedProps.asc_putShapeProperties(new Asc.asc_CShapeProperty),this._changedProps.asc_getShapeProperties().asc_putColumnSpace(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())))},this)),this.spinners.push(this.spnSpacing),this.radioTwoCell=new Common.UI.RadioBox({el:$("#shape-radio-twocell"),name:"asc-radio-snap",labelText:this.textTwoCell,value:AscCommon.c_oAscCellAnchorType.cellanchorTwoCell}),this.radioTwoCell.on("change",_.bind(this.onRadioSnapChange,this)),this.radioOneCell=new Common.UI.RadioBox({el:$("#shape-radio-onecell"),name:"asc-radio-snap",labelText:this.textOneCell,value:AscCommon.c_oAscCellAnchorType.cellanchorOneCell}),this.radioOneCell.on("change",_.bind(this.onRadioSnapChange,this)),this.radioAbsolute=new Common.UI.RadioBox({el:$("#shape-radio-absolute"),name:"asc-radio-snap",labelText:this.textAbsolute,value:AscCommon.c_oAscCellAnchorType.cellanchorAbsolute}),this.radioAbsolute.on("change",_.bind(this.onRadioSnapChange,this)),this.inputAltTitle=new Common.UI.InputField({el:$("#shape-advanced-alt-title"),allowBlank:!0,validateOnBlur:!1,style:"width: 100%;"}).on("changed:after",function(){e.isAltTitleChanged=!0}),this.textareaAltDescription=this.$window.find("textarea"),this.textareaAltDescription.keydown(function(t){t.keyCode==Common.UI.Keys.RETURN&&t.stopPropagation(),e.isAltDescChanged=!0}),this.afterRender()},getFocusedComponents:function(){return[this.spnWidth,this.btnRatio,this.spnHeight,this.spnAngle,this.chFlipHor,this.chFlipVert,this.cmbCapType,this.cmbJoinType,this.chAutofit,this.chOverflow,this.spnMarginTop,this.spnMarginLeft,this.spnMarginBottom,this.spnMarginRight,this.spnColumns,this.spnSpacing,this.radioTwoCell,this.radioOneCell,this.radioAbsolute,this.inputAltTitle,this.textareaAltDescription]},onCategoryClick:function(t,e){Common.Views.AdvancedSettingsWindow.prototype.onCategoryClick.call(this,t,e);var i=this;setTimeout(function(){switch(e){case 0:i.spnWidth.focus();break;case 1:i.spnAngle.focus();break;case 2:i.cmbCapType.focus();break;case 3:i.spnMarginTop.focus();break;case 4:i.spnColumns.focus();break;case 5:i.radioTwoCell.focus();break;case 6:i.inputAltTitle.focus()}},10)},afterRender:function(){var t;this.updateMetricUnit(),this._setDefaults(this._originalProps),this.storageName&&(t=Common.localStorage.getItem(this.storageName),this.setActiveCategory(null!==t?parseInt(t):0))},_setDefaults:function(t){if(t&&t.asc_getShapeProperties()){var e=t.asc_getShapeProperties(),i=(e.asc_getFromSmartArt()&&this.btnsCategory[1].setDisabled(!0),e.asc_getFromSmartArtInternal()&&(this.chAutofit.setDisabled(!0),this.chOverflow.setDisabled(!0),this.chFlipHor.setDisabled(!0),this.chFlipVert.setDisabled(!0),this.btnsCategory[0].setDisabled(!0)),this.spnWidth.setValue(Common.Utils.Metric.fnRecalcFromMM(t.asc_getWidth()).toFixed(2),!0),this.spnHeight.setValue(Common.Utils.Metric.fnRecalcFromMM(t.asc_getHeight()).toFixed(2),!0),0<t.asc_getHeight()&&(this._nRatio=t.asc_getWidth()/t.asc_getHeight()),t.asc_getLockAspect()),s=(this.btnRatio.toggle(i||e.asc_getFromSmartArt()),this.btnRatio.setDisabled(!!e.asc_getFromSmartArt()),this._setShapeDefaults(e),e.asc_getPaddings()),o=(s&&(o=s.asc_getLeft(),this.spnMarginLeft.setValue(null!=o?Common.Utils.Metric.fnRecalcFromMM(o):"",!0),o=s.asc_getTop(),this.spnMarginTop.setValue(null!=o?Common.Utils.Metric.fnRecalcFromMM(o):"",!0),o=s.asc_getRight(),this.spnMarginRight.setValue(null!=o?Common.Utils.Metric.fnRecalcFromMM(o):"",!0),o=s.asc_getBottom(),this.spnMarginBottom.setValue(null!=o?Common.Utils.Metric.fnRecalcFromMM(o):"",!0)),this.btnsCategory[3].setDisabled(null===s),this.chAutofit.setValue(e.asc_getTextFitType()==AscFormat.text_fit_Auto),this.chOverflow.setValue(e.asc_getVertOverflowType()==AscFormat.nOTOwerflow),e.asc_getType());switch(this.btnsCategory[4].setDisabled(e.asc_getFromSmartArtInternal()||"line"==o||"bentConnector2"==o||"bentConnector3"==o||"bentConnector4"==o||"bentConnector5"==o||"curvedConnector2"==o||"curvedConnector3"==o||"curvedConnector4"==o||"curvedConnector5"==o||"straightConnector1"==o),i=e.asc_getColumnNumber(),this.spnColumns.setValue(null!=i?i:"",!0),i=e.asc_getColumnSpace(),this.spnSpacing.setValue(null!=i?Common.Utils.Metric.fnRecalcFromMM(i):"",!0),i=t.asc_getTitle(),this.inputAltTitle.setValue(i||""),i=t.asc_getDescription(),this.textareaAltDescription.val(i||""),i=t.asc_getRot(),this.spnAngle.setValue(null==i||null===i?"":Math.floor(180*i/3.14159265358979+.5),!0),this.chFlipHor.setValue(t.asc_getFlipH()),this.chFlipVert.setValue(t.asc_getFlipV()),t.asc_getAnchor()){case AscCommon.c_oAscCellAnchorType.cellanchorTwoCell:this.radioTwoCell.setValue(!0,!0);break;case AscCommon.c_oAscCellAnchorType.cellanchorOneCell:this.radioOneCell.setValue(!0,!0);break;case AscCommon.c_oAscCellAnchorType.cellanchorAbsolute:this.radioAbsolute.setValue(!0,!0)}this._changedProps=new Asc.asc_CImgProperty}},getSettings:function(){return this.isAltTitleChanged&&this._changedProps.asc_putTitle(this.inputAltTitle.getValue()),this.isAltDescChanged&&this._changedProps.asc_putDescription(this.textareaAltDescription.val()),this._changedProps.asc_putRot(3.14159265358979*this.spnAngle.getNumberValue()/180),this._changedProps.asc_putFlipH("checked"==this.chFlipHor.getValue()),this._changedProps.asc_putFlipV("checked"==this.chFlipVert.getValue()),{shapeProps:this._changedProps}},_setShapeDefaults:function(t){if(t){t=t.asc_getStroke();if(t){this.btnsCategory[2].setDisabled(t.asc_getType()==Asc.c_oAscStrokeType.STROKE_NONE);for(var e=t.asc_getLinejoin(),i=0;i<this._arrJoinType.length;i++)if(e==this._arrJoinType[i].value){this.cmbJoinType.setValue(e);break}for(e=t.asc_getLinecap(),i=0;i<this._arrCapType.length;i++)if(e==this._arrCapType[i].value){this.cmbCapType.setValue(e);break}var s=t.asc_getCanChangeArrows();this.btnBeginStyle.setDisabled(!s),this.btnEndStyle.setDisabled(!s),this.btnBeginSize.setDisabled(!s),this.btnEndSize.setDisabled(!s),s?(e=t.asc_getLinebeginsize(),(s=this.mnuBeginSizePicker.store.findWhere({type:e}))?this._beginSizeIdx=s.get("value"):(this._beginSizeIdx=null,this._selectStyleItem(this.btnBeginSize,null)),e=t.asc_getLinebeginstyle(),(s=this.mnuBeginStylePicker.store.findWhere({type:e}))?(this.mnuBeginStylePicker.selectRecord(s,!0),this._updateSizeArr(this.btnBeginSize,this.mnuBeginSizePicker,s,this._beginSizeIdx),this._selectStyleItem(this.btnBeginStyle,s)):this._selectStyleItem(this.btnBeginStyle,null),e=t.asc_getLineendsize(),(s=this.mnuEndSizePicker.store.findWhere({type:e}))?this._endSizeIdx=s.get("value"):(this._endSizeIdx=null,this._selectStyleItem(this.btnEndSize,null)),e=t.asc_getLineendstyle(),(s=this.mnuEndStylePicker.store.findWhere({type:e}))?(this.mnuEndStylePicker.selectRecord(s,!0),this._updateSizeArr(this.btnEndSize,this.mnuEndSizePicker,s,this._endSizeIdx),this._selectStyleItem(this.btnEndStyle,s)):this._selectStyleItem(this.btnEndStyle,null)):(this._selectStyleItem(this.btnBeginStyle),this._selectStyleItem(this.btnEndStyle),this._selectStyleItem(this.btnBeginSize),this._selectStyleItem(this.btnEndSize))}}},updateMetricUnit:function(){if(this.spinners)for(var t=0;t<this.spinners.length;t++){var e=this.spinners[t];e.setDefaultUnit(Common.Utils.Metric.getCurrentMetricName()),e.setStep(Common.Utils.Metric.getCurrentMetric()==Common.Utils.Metric.c_MetricUnits.pt?1:.01)}this.sizeMax={width:Common.Utils.Metric.fnRecalcFromMM(10*this.options.sizeMax.width),height:Common.Utils.Metric.fnRecalcFromMM(10*this.options.sizeMax.height)},this.options.sizeOriginal&&(this.sizeOriginal={width:Common.Utils.Metric.fnRecalcFromMM(this.options.sizeOriginal.width),height:Common.Utils.Metric.fnRecalcFromMM(this.options.sizeOriginal.height)})},_updateSizeArr:function(t,e,i,s){0<i.get("value")?(e.store.each(function(t){t.set({typearrow:i.get("idsvg")})},this),t.setDisabled(!1),null!==s?(e.selectByIndex(s,!0),this._selectStyleItem(t,e.store.at(s))):this._selectStyleItem(t,null)):(this._selectStyleItem(t,null),t.setDisabled(!0))},_selectStyleItem:function(t,e){var i,s,t=$(t.el).find(".form-control > .img-arrows use");t.length&&(s="",e&&(s=void 0!==(i=e.get("idsvg"))?i+"arrow-5":e.get("typearrow")+"arrow-"+(e.get("value")+1)),t[0].setAttribute("xlink:href","#"+s))},onSelectBeginStyle:function(t,e,i){this._changedProps&&(null!==this._changedProps.asc_getShapeProperties()&&void 0!==this._changedProps.asc_getShapeProperties()||this._changedProps.asc_putShapeProperties(new Asc.asc_CShapeProperty),null===this._changedProps.asc_getShapeProperties().asc_getStroke()&&this._changedProps.asc_getShapeProperties().asc_putStroke(new Asc.asc_CStroke),this._changedProps.asc_getShapeProperties().asc_getStroke().asc_putLinebeginstyle(i.get("type"))),null!==this._beginSizeIdx&&void 0!==this._beginSizeIdx||(this._beginSizeIdx=4),this._updateSizeArr(this.btnBeginSize,this.mnuBeginSizePicker,i,this._beginSizeIdx),this._selectStyleItem(this.btnBeginStyle,i)},onSelectBeginSize:function(t,e,i){this._changedProps&&(null!==this._changedProps.asc_getShapeProperties()&&void 0!==this._changedProps.asc_getShapeProperties()||this._changedProps.asc_putShapeProperties(new Asc.asc_CShapeProperty),null===this._changedProps.asc_getShapeProperties().asc_getStroke()&&this._changedProps.asc_getShapeProperties().asc_putStroke(new Asc.asc_CStroke),this._changedProps.asc_getShapeProperties().asc_getStroke().asc_putLinebeginsize(i.get("type"))),this._beginSizeIdx=i.get("value"),this._selectStyleItem(this.btnBeginSize,i)},onSelectEndStyle:function(t,e,i){this._changedProps&&(null!==this._changedProps.asc_getShapeProperties()&&void 0!==this._changedProps.asc_getShapeProperties()||this._changedProps.asc_putShapeProperties(new Asc.asc_CShapeProperty),null===this._changedProps.asc_getShapeProperties().asc_getStroke()&&this._changedProps.asc_getShapeProperties().asc_putStroke(new Asc.asc_CStroke),this._changedProps.asc_getShapeProperties().asc_getStroke().asc_putLineendstyle(i.get("type"))),null!==this._endSizeIdx&&void 0!==this._endSizeIdx||(this._endSizeIdx=4),this._updateSizeArr(this.btnEndSize,this.mnuEndSizePicker,i,this._endSizeIdx),this._selectStyleItem(this.btnEndStyle,i)},onSelectEndSize:function(t,e,i){this._changedProps&&(null!==this._changedProps.asc_getShapeProperties()&&void 0!==this._changedProps.asc_getShapeProperties()||this._changedProps.asc_putShapeProperties(new Asc.asc_CShapeProperty),null===this._changedProps.asc_getShapeProperties().asc_getStroke()&&this._changedProps.asc_getShapeProperties().asc_putStroke(new Asc.asc_CStroke),this._changedProps.asc_getShapeProperties().asc_getStroke().asc_putLineendsize(i.get("type"))),this._endSizeIdx=i.get("value"),this._selectStyleItem(this.btnEndSize,i)},onRadioSnapChange:function(t,e,i){e&&this._changedProps&&this._changedProps.asc_putAnchor(t.options.value)}},SSE.Views.ShapeSettingsAdvanced||{}))}),define("spreadsheeteditor/main/app/view/ShapeSettings",["text!spreadsheeteditor/main/app/template/ShapeSettings.template","jquery","underscore","backbone","common/main/lib/component/ComboBox","common/main/lib/component/ComboBorderSize","common/main/lib/component/MetricSpinner","common/main/lib/component/ThemeColorPalette","common/main/lib/component/ColorButton","common/main/lib/component/ComboDataView","common/main/lib/component/Slider","common/main/lib/component/MultiSliderGradient","common/main/lib/view/ImageFromUrlDialog","spreadsheeteditor/main/app/view/ShapeSettingsAdvanced"],function(t,C,f,e){"use strict";SSE.Views.ShapeSettings=e.View.extend(f.extend({el:"#id-shape-settings",template:f.template(t),events:{},options:{alias:"ShapeSettings"},initialize:function(){this._initSettings=!0,this._originalProps=null,this._noApply=!0,this.imgprops=null,this._sendUndoPoint=!0,this._sliderChanged=!1,this._texturearray=null,this.txtPt=Common.Utils.Metric.getMetricName(Common.Utils.Metric.c_MetricUnits.pt),this._state={Transparency:null,FillType:Asc.c_oAscFill.FILL_TYPE_SOLID,ShapeColor:"transparent",BlipFillType:Asc.c_oAscFillBlipType.STRETCH,StrokeType:Asc.c_oAscStrokeType.STROKE_COLOR,StrokeWidth:this._pt2mm(1),StrokeColor:"000000",StrokeBorderType:Asc.c_oDashType.solid,FGColor:"000000",BGColor:"ffffff",GradColor:"000000",GradFillType:Asc.c_oAscFillGradType.GRAD_LINEAR,DisabledFillPanels:!1,DisabledControls:!1,HideShapeOnlySettings:!1,HideChangeTypeSettings:!1,HideRotationSettings:!1,isFromImage:!1,isFromSmartArtInternal:!1},this.lockedControls=[],this._locked=!1,this.OriginalFillType=Asc.c_oAscFill.FILL_TYPE_SOLID,this.ShapeColor={Value:1,Color:"transparent"},this.BlipFillType=Asc.c_oAscFillBlipType.STRETCH,this.GradFillType=Asc.c_oAscFillGradType.GRAD_LINEAR,this.GradColor={values:[0,100],colors:["000000","ffffff"],currentIdx:0},this.GradRadialDirectionIdx=0,this.GradLinearDirectionType=0,this.PatternFillType=0,this.FGColor={Value:1,Color:"000000"},this.BGColor={Value:1,Color:"ffffff"},this.BorderColor={Value:1,Color:"transparent"},this.BorderSize=0,this.BorderType=Asc.c_oDashType.solid,this.textureNames=[this.txtCanvas,this.txtCarton,this.txtDarkFabric,this.txtGrain,this.txtGranite,this.txtGreyPaper,this.txtKnit,this.txtLeather,this.txtBrownPaper,this.txtPapyrus,this.txtWood],this.fillControls=[],this.gradientColorsStr="#000, #fff",this.typeGradient=90,this.shapeRestoreHeight=615,this.render(),this.FillColorContainer=C("#shape-panel-color-fill"),this.FillImageContainer=C("#shape-panel-image-fill"),this.FillPatternContainer=C("#shape-panel-pattern-fill"),this.FillGradientContainer=C("#shape-panel-gradient-fill"),this.TransparencyContainer=C("#shape-panel-transparent-fill"),this.EditShapeContainer=C("#shape-button-edit-shape-container"),this.EditChangeShapeContainer=C("#shape-button-change-shape-container"),this.ShapeOnlySettings=C(".shape-only"),this.CanChangeType=C(".change-type"),this.RotationSettings=C(".shape-rotation")},render:function(){C(this.el).html(this.template({scope:this}))},setApi:function(t){return this.api=t,this.api&&(this.api.asc_setInterfaceDrawImagePlaceShape("shape-texture-img"),this.api.asc_registerCallback("asc_onInitStandartTextures",f.bind(this.onInitStandartTextures,this))),Common.NotificationCenter.on("storage:image-insert",f.bind(this.insertImageFromStorage,this)),this},setMode:function(t){this.mode=t},onFillSrcSelect:function(t,e){switch(this.ShowHideElem(e.value),e.value){case Asc.c_oAscFill.FILL_TYPE_SOLID:this._state.FillType=Asc.c_oAscFill.FILL_TYPE_SOLID,this._noApply||(o=new Asc.asc_CShapeProperty,(n=new Asc.asc_CShapeFill).asc_putType(Asc.c_oAscFill.FILL_TYPE_SOLID),n.asc_putFill(new Asc.asc_CFillSolid),n.asc_getFill().asc_putColor(Common.Utils.ThemeColor.getRgbColor("transparent"==this.ShapeColor.Color?{color:"4f81bd",effectId:24}:this.ShapeColor.Color)),o.asc_putFill(n),this.imgprops.asc_putShapeProperties(o),this.api.asc_setGraphicObjectProps(this.imgprops));break;case Asc.c_oAscFill.FILL_TYPE_GRAD:var i;this._state.FillType=Asc.c_oAscFill.FILL_TYPE_GRAD,this._noApply||(o=new Asc.asc_CShapeProperty,(n=new Asc.asc_CShapeFill).asc_putType(Asc.c_oAscFill.FILL_TYPE_GRAD),n.asc_putFill(new Asc.asc_CFillGrad),n.asc_getFill().asc_putGradType(this.GradFillType),this.GradFillType==Asc.c_oAscFillGradType.GRAD_LINEAR&&(n.asc_getFill().asc_putLinearAngle(6e4*this.GradLinearDirectionType),n.asc_getFill().asc_putLinearScale(!0)),this.OriginalFillType!==Asc.c_oAscFill.FILL_TYPE_GRAD&&(this.GradColor.values=[0,100],this.GradColor.colors=[this.GradColor.colors[0],this.GradColor.colors[this.GradColor.colors.length-1]],this.GradColor.currentIdx=0,i=Common.Utils.ThemeColor.getRgbColor(this.GradColor.colors[0]).get_color().get_hex(),s=Common.Utils.ThemeColor.getRgbColor(this.GradColor.colors[1]).get_color().get_hex(),i="ffffff"===i&&"ffffff"===s?{color:"4f81bd",effectId:24}:this.GradColor.colors[0],n.asc_getFill().asc_putPositions([1e3*this.GradColor.values[0],1e3*this.GradColor.values[1]]),n.asc_getFill().asc_putColors([Common.Utils.ThemeColor.getRgbColor(i),Common.Utils.ThemeColor.getRgbColor(this.GradColor.colors[1])])),o.asc_putFill(n),this.imgprops.asc_putShapeProperties(o),this.api.asc_setGraphicObjectProps(this.imgprops));break;case Asc.c_oAscFill.FILL_TYPE_BLIP:this._state.FillType=Asc.c_oAscFill.FILL_TYPE_BLIP;break;case Asc.c_oAscFill.FILL_TYPE_PATT:var s;this._state.FillType=Asc.c_oAscFill.FILL_TYPE_PATT,this._noApply||(o=new Asc.asc_CShapeProperty,(n=new Asc.asc_CShapeFill).asc_putType(Asc.c_oAscFill.FILL_TYPE_PATT),n.asc_putFill(new Asc.asc_CFillHatch),n.asc_getFill().asc_putPatternType(this.PatternFillType),s=Common.Utils.ThemeColor.getRgbColor(this.FGColor.Color).get_color().get_hex(),s="ffffff"===Common.Utils.ThemeColor.getRgbColor(this.BGColor.Color).get_color().get_hex()&&"ffffff"===s?{color:"4f81bd",effectId:24}:this.FGColor.Color,n.asc_getFill().asc_putColorFg(Common.Utils.ThemeColor.getRgbColor(s)),n.asc_getFill().asc_putColorBg(Common.Utils.ThemeColor.getRgbColor(this.BGColor.Color)),o.asc_putFill(n),this.imgprops.asc_putShapeProperties(o),this.api.asc_setGraphicObjectProps(this.imgprops));break;case Asc.c_oAscFill.FILL_TYPE_NOFILL:var o,n;this._state.FillType=Asc.c_oAscFill.FILL_TYPE_NOFILL,this._noApply||(o=new Asc.asc_CShapeProperty,(n=new Asc.asc_CShapeFill).asc_putType(Asc.c_oAscFill.FILL_TYPE_NOFILL),n.asc_putFill(null),o.asc_putFill(n),this.imgprops.asc_putShapeProperties(o),this.api.asc_setGraphicObjectProps(this.imgprops))}Common.NotificationCenter.trigger("edit:complete",this)},onColorsBackSelect:function(t,e){var i;this.ShapeColor={Value:1,Color:e},this.api&&!this._noApply&&(e=new Asc.asc_CShapeProperty,i=new Asc.asc_CShapeFill,"transparent"==this.ShapeColor.Color?(i.asc_putType(Asc.c_oAscFill.FILL_TYPE_NOFILL),i.asc_putFill(null)):(i.asc_putType(Asc.c_oAscFill.FILL_TYPE_SOLID),i.asc_putFill(new Asc.asc_CFillSolid),i.asc_getFill().asc_putColor(Common.Utils.ThemeColor.getRgbColor(this.ShapeColor.Color))),e.asc_putFill(i),this.imgprops.asc_putShapeProperties(e),this.api.asc_setGraphicObjectProps(this.imgprops)),Common.NotificationCenter.trigger("edit:complete",this)},onPatternSelect:function(t,e){var i;this.api&&!this._noApply&&(this.PatternFillType=e.get("type"),e=new Asc.asc_CShapeProperty,(i=new Asc.asc_CShapeFill).asc_putType(Asc.c_oAscFill.FILL_TYPE_PATT),i.asc_putFill(new Asc.asc_CFillHatch),i.asc_getFill().asc_putPatternType(this.PatternFillType),this.OriginalFillType!==Asc.c_oAscFill.FILL_TYPE_PATT&&(i.asc_getFill().asc_putColorFg(Common.Utils.ThemeColor.getRgbColor(this.FGColor.Color)),i.asc_getFill().asc_putColorBg(Common.Utils.ThemeColor.getRgbColor(this.BGColor.Color))),e.asc_putFill(i),this.imgprops.asc_putShapeProperties(e),this.api.asc_setGraphicObjectProps(this.imgprops)),Common.NotificationCenter.trigger("edit:complete",this)},onColorsFGSelect:function(t,e){var i;this.FGColor={Value:1,Color:e},this.api&&!this._noApply&&(e=new Asc.asc_CShapeProperty,(i=new Asc.asc_CShapeFill).asc_putType(Asc.c_oAscFill.FILL_TYPE_PATT),i.asc_putFill(new Asc.asc_CFillHatch),i.asc_getFill().asc_putColorFg(Common.Utils.ThemeColor.getRgbColor(this.FGColor.Color)),this.OriginalFillType!==Asc.c_oAscFill.FILL_TYPE_PATT&&(i.asc_getFill().asc_putPatternType(this.PatternFillType),i.asc_getFill().asc_putColorBg(Common.Utils.ThemeColor.getRgbColor(this.BGColor.Color))),e.asc_putFill(i),this.imgprops.asc_putShapeProperties(e),this.api.asc_setGraphicObjectProps(this.imgprops)),Common.NotificationCenter.trigger("edit:complete",this)},onColorsBGSelect:function(t,e){var i;this.BGColor={Value:1,Color:e},this.api&&!this._noApply&&(e=new Asc.asc_CShapeProperty,(i=new Asc.asc_CShapeFill).asc_putType(Asc.c_oAscFill.FILL_TYPE_PATT),i.asc_putFill(new Asc.asc_CFillHatch),this.OriginalFillType!==Asc.c_oAscFill.FILL_TYPE_PATT&&(i.asc_getFill().asc_putPatternType(this.PatternFillType),i.asc_getFill().asc_putColorFg(Common.Utils.ThemeColor.getRgbColor(this.FGColor.Color))),i.asc_getFill().asc_putColorBg(Common.Utils.ThemeColor.getRgbColor(this.BGColor.Color)),e.asc_putFill(i),this.imgprops.asc_putShapeProperties(e),this.api.asc_setGraphicObjectProps(this.imgprops)),Common.NotificationCenter.trigger("edit:complete",this)},onFillTypeSelect:function(t,e){var i;this.BlipFillType=e.value,this.api&&!0!==this._fromTextureCmb&&this.OriginalFillType==Asc.c_oAscFill.FILL_TYPE_BLIP&&(e=new Asc.asc_CShapeProperty,(i=new Asc.asc_CShapeFill).asc_putType(Asc.c_oAscFill.FILL_TYPE_BLIP),i.asc_putFill(new Asc.asc_CFillBlip),i.asc_getFill().asc_putType(this.BlipFillType),e.asc_putFill(i),this.imgprops.asc_putShapeProperties(e),this.api.asc_setGraphicObjectProps(this.imgprops)),Common.NotificationCenter.trigger("edit:complete",this)},onNumTransparencyChange:function(t,e,i,s){var o,n;this.sldrTransparency.setValue(t.getNumberValue(),!0),this.api&&(t=t.getNumberValue(),o=new Asc.asc_CShapeProperty,(n=new Asc.asc_CShapeFill).asc_putTransparent(2.55*t),o.asc_putFill(n),this.imgprops.asc_putShapeProperties(o),this.api.asc_setGraphicObjectProps(this.imgprops))},onTransparencyChange:function(t,e,i){this._sliderChanged=e,this.numTransparency.setValue(e,!0),this._sendUndoPoint&&(this.api.setStartPointHistory(),this._sendUndoPoint=!1,this.updateslider=setInterval(f.bind(this._transparencyApplyFunc,this),100))},onTransparencyChangeComplete:function(t,e,i){clearInterval(this.updateslider),this._sliderChanged=e,this._sendUndoPoint||(this.api.setEndPointHistory(),this._transparencyApplyFunc()),this._sendUndoPoint=!0},_transparencyApplyFunc:function(){var t,e;void 0!==this._sliderChanged&&(t=new Asc.asc_CShapeProperty,(e=new Asc.asc_CShapeFill).asc_putTransparent(2.55*this._sliderChanged),t.asc_putFill(e),this.imgprops.asc_putShapeProperties(t),this.api.asc_setGraphicObjectProps(this.imgprops),this._sliderChanged=void 0)},onGradTypeSelect:function(t,e){var i;this.GradFillType=e.value,this.GradFillType==Asc.c_oAscFillGradType.GRAD_LINEAR?(this.mnuDirectionPicker.store.reset(this._viewDataLinear),this.mnuDirectionPicker.cmpEl.width(175),this.mnuDirectionPicker.restoreHeight=174,e=this.mnuDirectionPicker.store.findWhere({type:this.GradLinearDirectionType}),this.mnuDirectionPicker.selectRecord(e,!0),this.typeGradient=e?this.GradLinearDirectionType+90:-1,this.numGradientAngle.setValue(this.GradLinearDirectionType,!0),this.numGradientAngle.setDisabled(this._locked)):this.GradFillType==Asc.c_oAscFillGradType.GRAD_PATH&&(this.mnuDirectionPicker.store.reset(this._viewDataRadial),this.mnuDirectionPicker.cmpEl.width(60),this.mnuDirectionPicker.restoreHeight=58,this.mnuDirectionPicker.selectByIndex(this.GradRadialDirectionIdx,!0),0<=this.GradRadialDirectionIdx?this.typeGradient=this._viewDataRadial[this.GradRadialDirectionIdx].type:this.typeGradient=-1,this.numGradientAngle.setValue(0,!0),this.numGradientAngle.setDisabled(!0)),this.api&&!this._noApply&&(e=new Asc.asc_CShapeProperty,(i=new Asc.asc_CShapeFill).asc_putType(Asc.c_oAscFill.FILL_TYPE_GRAD),i.asc_putFill(new Asc.asc_CFillGrad),i.asc_getFill().asc_putGradType(this.GradFillType),this.GradFillType==Asc.c_oAscFillGradType.GRAD_LINEAR&&(i.asc_getFill().asc_putLinearAngle(6e4*this.GradLinearDirectionType),i.asc_getFill().asc_putLinearScale(!0)),e.asc_putFill(i),this.imgprops.asc_putShapeProperties(e),this.api.asc_setGraphicObjectProps(this.imgprops)),Common.NotificationCenter.trigger("edit:complete",this)},onSelectGradient:function(t,e,i,s){if(!this._noApply){var o,n={};if(f.isFunction(s.toJSON)){if(!s.get("selected"))return;n=s.toJSON()}else n=s;this.GradFillType===Asc.c_oAscFillGradType.GRAD_LINEAR?(this.GradLinearDirectionType=n.type,this.typeGradient=n.type+90):(this.GradRadialDirectionIdx=0,this.typeGradient=n.type),this.api&&this.GradFillType==Asc.c_oAscFillGradType.GRAD_LINEAR&&(this.numGradientAngle.setValue(n.type,!0),s=new Asc.asc_CShapeProperty,(o=new Asc.asc_CShapeFill).asc_putType(Asc.c_oAscFill.FILL_TYPE_GRAD),o.asc_putFill(new Asc.asc_CFillGrad),o.asc_getFill().asc_putGradType(this.GradFillType),o.asc_getFill().asc_putLinearAngle(6e4*n.type),o.asc_getFill().asc_putLinearScale(!0),s.asc_putFill(o),this.imgprops.asc_putShapeProperties(s),this.api.asc_setGraphicObjectProps(this.imgprops)),Common.NotificationCenter.trigger("edit:complete",this)}},onColorsGradientSelect:function(t,e){var i,s;this.GradColor.colors[this.GradColor.currentIdx]=e,this.sldrGradient.setColorValue(Common.Utils.String.format("#{0}","object"==typeof e?e.color:e)),this.api&&!this._noApply&&(e=new Asc.asc_CShapeProperty,(i=new Asc.asc_CShapeFill).asc_putType(Asc.c_oAscFill.FILL_TYPE_GRAD),i.asc_putFill(new Asc.asc_CFillGrad),i.asc_getFill().asc_putGradType(this.GradFillType),s=[],this.GradColor.colors.forEach(function(t){s.push(Common.Utils.ThemeColor.getRgbColor(t))}),i.asc_getFill().asc_putColors(s),this.OriginalFillType!==Asc.c_oAscFill.FILL_TYPE_GRAD&&(this.GradFillType==Asc.c_oAscFillGradType.GRAD_LINEAR&&(i.asc_getFill().asc_putLinearAngle(6e4*this.GradLinearDirectionType),i.asc_getFill().asc_putLinearScale(!0)),s=[],this.GradColor.values.forEach(function(t){s.push(1e3*t)}),i.asc_getFill().asc_putPositions(s)),e.asc_putFill(i),this.imgprops.asc_putShapeProperties(e),this.api.asc_setGraphicObjectProps(this.imgprops)),Common.NotificationCenter.trigger("edit:complete",this)},onGradientChange:function(t,e,i){this.GradColor.values=t.getValues();t=this.GradColor.values[this.GradColor.currentIdx];this.spnGradPosition.setValue(Common.UI.isRTL()?this.sldrGradient.maxValue-t:t,!0),this._sliderChanged=!0,this.api&&!this._noApply&&this._sendUndoPoint&&(this.api.setStartPointHistory(),this._sendUndoPoint=!1,this.updateslider=setInterval(f.bind(this._gradientApplyFunc,this),100))},onGradientChangeComplete:function(t,e,i){clearInterval(this.updateslider),this._sliderChanged=!0,this._sendUndoPoint||(this.api.setEndPointHistory(),this._gradientApplyFunc()),this._sendUndoPoint=!0},_gradientApplyFunc:function(){var t,e,i;this._sliderChanged&&(t=new Asc.asc_CShapeProperty,(e=new Asc.asc_CShapeFill).asc_putType(Asc.c_oAscFill.FILL_TYPE_GRAD),e.asc_putFill(new Asc.asc_CFillGrad),e.asc_getFill().asc_putGradType(this.GradFillType),i=[],this.GradColor.values.forEach(function(t){i.push(1e3*t)}),e.asc_getFill().asc_putPositions(i),this.GradFillType==Asc.c_oAscFillGradType.GRAD_LINEAR&&(e.asc_getFill().asc_putLinearAngle(6e4*this.GradLinearDirectionType),e.asc_getFill().asc_putLinearScale(!0)),i=[],this.GradColor.colors.forEach(function(t){i.push(Common.Utils.ThemeColor.getRgbColor(t))}),e.asc_getFill().asc_putColors(i),t.asc_putFill(e),this.imgprops.asc_putShapeProperties(t),this.api.asc_setGraphicObjectProps(this.imgprops),this._sliderChanged=!1)},applyBorderSize:function(t){var e;t=Common.Utils.String.parseFloat(t),t=isNaN(t)?0:Math.max(0,Math.min(1584,t)),this.BorderSize=t,this.api&&!this._noApply&&(t=new Asc.asc_CShapeProperty,e=new Asc.asc_CStroke,this.BorderSize<1e-5?(e.asc_putType(Asc.c_oAscStrokeType.STROKE_NONE),this._state.StrokeType=this._state.StrokeWidth=-1):(e.asc_putType(Asc.c_oAscStrokeType.STROKE_COLOR),"transparent"==this.BorderColor.Color||"transparent"==this.BorderColor.Color.color?e.asc_putColor(Common.Utils.ThemeColor.getRgbColor({color:"000000",effectId:29})):this._state.StrokeType!=Asc.c_oAscStrokeType.STROKE_NONE&&null!==this._state.StrokeType||e.asc_putColor(Common.Utils.ThemeColor.getRgbColor(Common.Utils.ThemeColor.colorValue2EffectId(this.BorderColor.Color))),e.asc_putPrstDash(this.BorderType),e.asc_putWidth(this._pt2mm(this.BorderSize)),e.asc_putTransparent(this._state.LineTransparency)),t.asc_putStroke(e),this.imgprops.asc_putShapeProperties(t),this.api.asc_setGraphicObjectProps(this.imgprops),Common.NotificationCenter.trigger("edit:complete",this))},onComboBlur:function(){Common.NotificationCenter.trigger("edit:complete",this)},onBorderSizeChanged:function(t,e,i,s){var o=this;t?(t=parseFloat(i.value),(!new RegExp("^\\s*(\\d*(\\.|,)?\\d+)\\s*("+o.txtPt+")?\\s*$").exec(i.value)||t<0||1584<t)&&(this._state.StrokeType=this._state.StrokeWidth=-1,setTimeout(function(){Common.UI.error({msg:o.textBorderSizeErr,callback:function(){f.defer(function(t){Common.NotificationCenter.trigger("edit:complete",o)})}})},10))):this.applyBorderSize(i.value)},onBorderSizeSelect:function(t,e){this.applyBorderSize(e.value)},onBorderTypeSelect:function(t,e){var i;this.BorderType=e.value,this.api&&!this._noApply&&(e=new Asc.asc_CShapeProperty,i=new Asc.asc_CStroke,this.BorderSize<1e-5?i.put_type(Asc.c_oAscStrokeType.STROKE_NONE):(i.put_type(Asc.c_oAscStrokeType.STROKE_COLOR),i.put_color(Common.Utils.ThemeColor.getRgbColor(this.BorderColor.Color)),i.put_width(this._pt2mm(this.BorderSize)),i.asc_putPrstDash(this.BorderType),i.asc_putTransparent(this._state.LineTransparency)),e.put_stroke(i),this.imgprops.asc_putShapeProperties(e),this.api.asc_setGraphicObjectProps(this.imgprops)),Common.NotificationCenter.trigger("edit:complete",this)},onColorsBorderSelect:function(t,e){var i;this.BorderColor={Value:1,Color:e},this.api&&0<this.BorderSize&&!this._noApply&&(e=new Asc.asc_CShapeProperty,i=new Asc.asc_CStroke,this.BorderSize<1e-5?i.asc_putType(Asc.c_oAscStrokeType.STROKE_NONE):(i.asc_putType(Asc.c_oAscStrokeType.STROKE_COLOR),i.asc_putColor(Common.Utils.ThemeColor.getRgbColor(this.BorderColor.Color)),i.asc_putWidth(this._pt2mm(this.BorderSize)),i.asc_putPrstDash(this.BorderType),i.asc_putTransparent(this._state.LineTransparency)),e.asc_putStroke(i),this.imgprops.asc_putShapeProperties(e),this.api.asc_setGraphicObjectProps(this.imgprops)),Common.NotificationCenter.trigger("edit:complete",this)},onNumLineTransparencyChange:function(t,e,i,s){var o;this.sldrLineTransparency.setValue(t.getNumberValue(),!0),this._state.LineTransparency=2.55*t.getNumberValue(),this.api&&!this._noApply&&(t=new Asc.asc_CShapeProperty,(o=new Asc.asc_CStroke).asc_putTransparent(this._state.LineTransparency),t.asc_putStroke(o),this.imgprops.asc_putShapeProperties(t),this.api.asc_setGraphicObjectProps(this.imgprops))},onLineTransparencyChange:function(t,e,i){this._sliderChangedLine=e,this.numLineTransparency.setValue(e,!0),this._sendUndoPoint&&(this.api.setStartPointHistory(),this._sendUndoPoint=!1,this.updatesliderline=setInterval(f.bind(this._transparencyLineApplyFunc,this),100))},onLineTransparencyChangeComplete:function(t,e,i){clearInterval(this.updatesliderline),this._sliderChangedLine=e,this._sendUndoPoint||(this.api.setEndPointHistory(),this._transparencyLineApplyFunc()),this._sendUndoPoint=!0},_transparencyLineApplyFunc:function(){var t,e;void 0!==this._sliderChangedLine&&(this._state.LineTransparency=2.55*this._sliderChangedLine,t=new Asc.asc_CShapeProperty,(e=new Asc.asc_CStroke).asc_putTransparent(this._state.LineTransparency),t.asc_putStroke(e),this.imgprops.asc_putShapeProperties(t),this.api.asc_setGraphicObjectProps(this.imgprops),this._sliderChangedLine=void 0)},setImageUrl:function(t,e){var i,s;null!==this.BlipFillType&&(i=new Asc.asc_CShapeProperty,(s=new Asc.asc_CShapeFill).asc_putType(Asc.c_oAscFill.FILL_TYPE_BLIP),s.asc_putFill(new Asc.asc_CFillBlip),s.asc_getFill().asc_putType(this.BlipFillType),s.asc_getFill().asc_putUrl(t,e),i.asc_putFill(s),this.imgprops.asc_putShapeProperties(i),this.api.asc_setGraphicObjectProps(this.imgprops))},insertImageFromStorage:function(t){t&&t._urls&&"fill"==t.c&&this.setImageUrl(t._urls[0],t.token)},onImageSelect:function(t,e){var i;1==e.value?(i=this,new Common.Views.ImageFromUrlDialog({handler:function(t,e){"ok"==t&&i.api&&(t=e.replace(/ /g,""),f.isEmpty(t)||i.setImageUrl(t)),Common.NotificationCenter.trigger("edit:complete",i)}}).show()):2==e.value?Common.NotificationCenter.trigger("storage:image-load","fill"):(this.api&&this.api.asc_changeShapeImageFromFile(this.BlipFillType),Common.NotificationCenter.trigger("edit:complete",this))},openAdvancedSettings:function(t){if(!this.linkAdvanced.hasClass("disabled")){var i=this;if(i.api&&!this._locked){var e=i.api.asc_getGraphicObjectProps();if(e&&0<e.length)for(var s,o,n=e.length-1;0<=n;n--)if(s=e[n].asc_getObjectType(),o=e[n].asc_getObjectValue(),Asc.c_oAscTypeSelectElement.Image==s&&o.asc_getShapeProperties()){new SSE.Views.ShapeSettingsAdvanced({shapeProps:o,handler:function(t,e){"ok"==t&&i.api&&i.api.asc_setGraphicObjectProps(e.shapeProps),Common.NotificationCenter.trigger("edit:complete",i)}}).show();break}}}},ChangeSettings:function(t){if(this._initSettings&&this.createDelayedElements(),null==this.imgprops&&(this.imgprops=new Asc.asc_CImgProperty),t&&t.asc_getShapeProperties()){var t=t.asc_getShapeProperties(),e=t.asc_getType(),e=(this._originalProps=t,this._noApply=!0,this._state.isFromImage=!!t.get_FromImage(),this._state.isFromSmartArtInternal=!!t.asc_getFromSmartArtInternal(),this.disableControls(this._locked,!t.asc_getCanFill()),this.hideShapeOnlySettings(t.asc_getFromChart()||!!t.asc_getFromImage()),this.hideRotationSettings(t.asc_getFromChart()||!!t.asc_getFromImage()||t.asc_getFromSmartArt()),this.canEditPoint=this.api&&this.api.asc_canEditGeometry(),this.toggleBtnEditShape(),t.get_FromChart()||t.asc_getFromSmartArt()||"line"==e||"bentConnector2"==e||"bentConnector3"==e||"bentConnector4"==e||"bentConnector5"==e||"curvedConnector2"==e||"curvedConnector3"==e||"curvedConnector4"==e||"curvedConnector5"==e||"straightConnector1"==e),e=(this.hideChangeTypeSettings(e),!e&&this.btnChangeShape.menu.items.length&&this.btnChangeShape.shapePicker.hideTextRect(t.get_FromImage()||this._state.isFromSmartArtInternal),null),i=(n=t.asc_getFill()).asc_getType(),s=null,o=n.asc_getTransparent();if(!(.001<Math.abs(this._state.Transparency-o)||.001<Math.abs(this.numTransparency.getNumberValue()-o))&&(null!==this._state.Transparency&&null!==o||this._state.Transparency===o&&this.numTransparency.getNumberValue()===o)||(void 0!==o&&(this.sldrTransparency.setValue(null===o?100:o/255*100,!0),this.numTransparency.setValue(this.sldrTransparency.getValue(),!0)),this._state.Transparency=o),null===n||null===i)this.OriginalFillType=null;else if(i==Asc.c_oAscFill.FILL_TYPE_NOFILL)this.OriginalFillType=Asc.c_oAscFill.FILL_TYPE_NOFILL;else if(i==Asc.c_oAscFill.FILL_TYPE_SOLID)(s=(n=n.asc_getFill()).asc_getColor())?s.asc_getType()==Asc.c_oAscColor.COLOR_TYPE_SCHEME?this.ShapeColor={Value:1,Color:{color:Common.Utils.ThemeColor.getHexColor(s.asc_getR(),s.asc_getG(),s.asc_getB()),effectValue:s.asc_getValue()}}:this.ShapeColor={Value:1,Color:Common.Utils.ThemeColor.getHexColor(s.asc_getR(),s.asc_getG(),s.asc_getB())}:this.ShapeColor={Value:0,Color:"transparent"},this.OriginalFillType=Asc.c_oAscFill.FILL_TYPE_SOLID,this.FGColor="transparent"!==this.ShapeColor.Color?{Value:1,Color:Common.Utils.ThemeColor.colorValue2EffectId(this.ShapeColor.Color)}:{Value:1,Color:"000000"},this.BGColor={Value:1,Color:"ffffff"},this.GradColor.colors[0]="transparent"!==this.ShapeColor.Color?Common.Utils.ThemeColor.colorValue2EffectId(this.ShapeColor.Color):"000000",this.GradColor.colors[this.GradColor.colors.length-1]="ffffff";else if(i==Asc.c_oAscFill.FILL_TYPE_BLIP)n=n.asc_getFill(),this.BlipFillType=n.asc_getType(),this._state.BlipFillType!==this.BlipFillType&&(this.BlipFillType==Asc.c_oAscFillBlipType.STRETCH||this.BlipFillType==Asc.c_oAscFillBlipType.TILE?this.cmbFillType.setValue(this.BlipFillType):this.cmbFillType.setValue(""),this._state.BlipFillType=this.BlipFillType),this.OriginalFillType=Asc.c_oAscFill.FILL_TYPE_BLIP;else if(i==Asc.c_oAscFill.FILL_TYPE_PATT){var n=n.asc_getFill();this.PatternFillType=n.asc_getPatternType(),this._state.PatternFillType!==this.PatternFillType&&(this.cmbPattern.suspendEvents(),e=this.cmbPattern.menuPicker.store.findWhere({type:this.PatternFillType}),this.cmbPattern.menuPicker.selectRecord(e),this.cmbPattern.resumeEvents(),this._state.PatternFillType=this.PatternFillType),(s=n.asc_getColorFg())?s.asc_getType()==Asc.c_oAscColor.COLOR_TYPE_SCHEME?this.FGColor={Value:1,Color:{color:Common.Utils.ThemeColor.getHexColor(s.asc_getR(),s.asc_getG(),s.asc_getB()),effectValue:s.asc_getValue()}}:this.FGColor={Value:1,Color:Common.Utils.ThemeColor.getHexColor(s.asc_getR(),s.asc_getG(),s.asc_getB())}:this.FGColor={Value:1,Color:"000000"},(s=n.asc_getColorBg())?s.asc_getType()==Asc.c_oAscColor.COLOR_TYPE_SCHEME?this.BGColor={Value:1,Color:{color:Common.Utils.ThemeColor.getHexColor(s.asc_getR(),s.asc_getG(),s.asc_getB()),effectValue:s.asc_getValue()}}:this.BGColor={Value:1,Color:Common.Utils.ThemeColor.getHexColor(s.asc_getR(),s.asc_getG(),s.asc_getB())}:this.BGColor={Value:1,Color:"ffffff"},this.OriginalFillType=Asc.c_oAscFill.FILL_TYPE_PATT,this.ShapeColor={Value:1,Color:Common.Utils.ThemeColor.colorValue2EffectId(this.FGColor.Color)},this.GradColor.colors[0]=Common.Utils.ThemeColor.colorValue2EffectId(this.FGColor.Color),this.GradColor.colors[this.GradColor.colors.length-1]="ffffff"}else if(i==Asc.c_oAscFill.FILL_TYPE_GRAD){for(var i=(n=n.asc_getFill()).asc_getGradType(),a=(this._state.GradFillType===i&&this.GradFillType===i||(this.GradFillType=i,e=void 0,this.GradFillType==Asc.c_oAscFillGradType.GRAD_LINEAR||this.GradFillType==Asc.c_oAscFillGradType.GRAD_PATH?(this.cmbGradType.setValue(this.GradFillType),e=this.cmbGradType.store.findWhere({value:this.GradFillType}),this.onGradTypeSelect(this.cmbGradType,e.attributes)):(this.cmbGradType.setValue(""),this.typeGradient=-1),this._state.GradFillType=this.GradFillType),this.GradFillType==Asc.c_oAscFillGradType.GRAD_LINEAR?(i=Math.floor(n.asc_getLinearAngle()/6e4),.001<Math.abs(this.GradLinearDirectionType-i)&&(this.GradLinearDirectionType=i,e=this.mnuDirectionPicker.store.findWhere({type:i}),this.mnuDirectionPicker.selectRecord(e,!0),this.typeGradient=e?i+90:-1,this.numGradientAngle.setValue(i,!0))):this.numGradientAngle.setValue(0,!0),this),e=n.asc_getColors(),l=n.asc_getPositions(),r=(e||this.GradColor.colors).length,c=(this.sldrGradient.setThumbs(r),this.GradColor.colors.length>r&&(this.GradColor.colors.splice(r,this.GradColor.colors.length-r),this.GradColor.values.splice(r,this.GradColor.colors.length-r),this.GradColor.currentIdx=0),e&&e.forEach(function(t,e){t?t.asc_getType()==Asc.c_oAscColor.COLOR_TYPE_SCHEME?(a.GradColor.colors[e]={color:Common.Utils.ThemeColor.getHexColor(t.asc_getR(),t.asc_getG(),t.asc_getB()),effectValue:t.asc_getValue()},Common.Utils.ThemeColor.colorValue2EffectId(a.GradColor.colors[e])):a.GradColor.colors[e]=Common.Utils.ThemeColor.getHexColor(t.asc_getR(),t.asc_getG(),t.asc_getB()):a.GradColor.colors[e]="000000";t=l[e];null!==t&&(a.GradColor.values[e]=t/=1e3)}),[]),d=this.GradFillType==Asc.c_oAscFillGradType.GRAD_LINEAR?1:.7,h=0;h<r;h++)a.sldrGradient.setColorValue(Common.Utils.String.format("#{0}","object"==typeof a.GradColor.colors[h]?a.GradColor.colors[h].color:a.GradColor.colors[h]),h),a.sldrGradient.setValue(h,a.GradColor.values[h]),c.push(a.sldrGradient.getColorValue(h)+" "+a.sldrGradient.getValue(h)*d+"%");this.btnDirectionRedraw(a.sldrGradient,c.join(", ")),(f.isUndefined(a.GradColor.currentIdx)||a.GradColor.currentIdx>=this.GradColor.colors.length)&&(a.GradColor.currentIdx=0),a.sldrGradient.setActiveThumb(a.GradColor.currentIdx);i=a.GradColor.values[a.GradColor.currentIdx];this.spnGradPosition.setValue(Common.UI.isRTL()?a.sldrGradient.maxValue-i:i),this.OriginalFillType=Asc.c_oAscFill.FILL_TYPE_GRAD,this.FGColor={Value:1,Color:this.GradColor.colors[0]},this.BGColor={Value:1,Color:"ffffff"},this.ShapeColor={Value:1,Color:this.GradColor.colors[0]}}this._state.FillType!==this.OriginalFillType&&(this.cmbFillSrc.setValue(null===this.OriginalFillType?"":this.OriginalFillType),this._state.FillType=this.OriginalFillType,this.ShowHideElem(this.OriginalFillType)),C(this.btnTexture.el).find(".form-control").prop("innerHTML",this.textSelectTexture);n=typeof this.ShapeColor.Color;if(n!=typeof this._state.ShapeColor||"object"==n&&(this.ShapeColor.Color.effectValue!==this._state.ShapeColor.effectValue||this._state.ShapeColor.color.indexOf(this.ShapeColor.Color.color)<0)||"object"!=n&&this._state.ShapeColor.indexOf(this.ShapeColor.Color)<0){if(this.btnBackColor.setColor(this.ShapeColor.Color),"object"==typeof this.ShapeColor.Color){for(var p=!1,m=0;m<10;m++)if(Common.Utils.ThemeColor.ThemeValues[m]==this.ShapeColor.Color.effectValue){this.colorsBack.select(this.ShapeColor.Color,!0),p=!0;break}p||this.colorsBack.clearSelection()}else this.colorsBack.select(this.ShapeColor.Color,!0);this._state.ShapeColor=this.ShapeColor.Color}var u,g,e=t.asc_getStroke(),i=e.asc_getType(),b="transparent"==this._state.StrokeColor&&"transparent"!==this.BorderColor.Color;if(e?(o=e.asc_getTransparent(),(.001<Math.abs(this._state.LineTransparency-o)||.001<Math.abs(this.numLineTransparency.getNumberValue()-o)||!(null!==this._state.LineTransparency&&null!==o||this._state.LineTransparency===o&&this.numLineTransparency.getNumberValue()===o))&&(void 0!==o&&(this.sldrLineTransparency.setValue(null===o?100:o/255*100,!0),this.numLineTransparency.setValue(this.sldrLineTransparency.getValue(),!0)),this._state.LineTransparency=o),i==Asc.c_oAscStrokeType.STROKE_COLOR&&(s=e.asc_getColor())?s.asc_getType()==Asc.c_oAscColor.COLOR_TYPE_SCHEME?this.BorderColor={Value:1,Color:{color:Common.Utils.ThemeColor.getHexColor(s.asc_getR(),s.asc_getG(),s.asc_getB()),effectValue:s.asc_getValue()}}:this.BorderColor={Value:1,Color:Common.Utils.ThemeColor.getHexColor(s.asc_getR(),s.asc_getG(),s.asc_getB())}:this.BorderColor={Value:1,Color:"transparent"},u=e.asc_getPrstDash()):(i=null,this.BorderColor={Value:0,Color:"transparent"}),n=typeof this.BorderColor.Color,o=typeof this._state.StrokeColor,b||n!=o||"object"==n&&(this.BorderColor.Color.effectValue!==this._state.StrokeColor.effectValue||this._state.StrokeColor.color.indexOf(this.BorderColor.Color.color)<0)||"object"!=n&&(this._state.StrokeColor.indexOf(this.BorderColor.Color)<0||"object"==typeof this.btnBorderColor.color)){if(this.btnBorderColor.setColor(this.BorderColor.Color),"object"==typeof this.BorderColor.Color){for(p=!1,m=0;m<10;m++)if(Common.Utils.ThemeColor.ThemeValues[m]==this.BorderColor.Color.effectValue){this.colorsBorder.select(this.BorderColor.Color,!0),p=!0;break}p||this.colorsBorder.clearSelection()}else this.colorsBorder.select(this.BorderColor.Color,!0);this._state.StrokeColor=this.BorderColor.Color}if(this._state.StrokeType===i&&i!=Asc.c_oAscStrokeType.STROKE_COLOR||(i==Asc.c_oAscStrokeType.STROKE_COLOR?(g=e.asc_getWidth(),b=Math.abs(this._state.StrokeWidth-g)<1e-5&&!new RegExp(this.txtPt+"\\s*$").test(this.cmbBorderSize.getRawValue()),(1e-5<Math.abs(this._state.StrokeWidth-g)||b||(null===this._state.StrokeWidth||null===g)&&this._state.StrokeWidth!==g)&&((o=null===(g=null!==(this._state.StrokeWidth=g)?this._mm2pt(g):g)?g:f.find(this.cmbBorderSize.store.models,function(t){if(g<t.attributes.value+1e-4&&g>t.attributes.value-1e-4)return!0}))?this.cmbBorderSize.selectRecord(o):this.cmbBorderSize.setValue(null!==g?parseFloat(g.toFixed(2))+" "+this.txtPt:""),this.BorderSize=g)):i==Asc.c_oAscStrokeType.STROKE_NONE?(this._state.StrokeWidth=0,this.BorderSize=this.cmbBorderSize.store.at(0).get("value"),this.cmbBorderSize.setValue(this.BorderSize)):(this._state.StrokeWidth=null,this.BorderSize=-1,this.cmbBorderSize.setValue(null)),this._state.StrokeType=i),this._state.StrokeBorderType!==u&&(this.BorderType=this._state.StrokeBorderType=u,this.cmbBorderType.setValue(u)),(n=typeof this.FGColor.Color)!=typeof this._state.FGColor||"object"==n&&(this.FGColor.Color.effectValue!==this._state.FGColor.effectValue||this._state.FGColor.color.indexOf(this.FGColor.Color.color)<0)||"object"!=n&&this._state.FGColor.indexOf(this.FGColor.Color)<0){if(this.btnFGColor.setColor(this.FGColor.Color),"object"==typeof this.FGColor.Color){for(p=!1,m=0;m<10;m++)if(Common.Utils.ThemeColor.ThemeValues[m]==this.FGColor.Color.effectValue){this.colorsFG.select(this.FGColor.Color,!0),p=!0;break}p||this.colorsFG.clearSelection()}else this.colorsFG.select(this.FGColor.Color,!0);this._state.FGColor=this.FGColor.Color}if((n=typeof this.BGColor.Color)!=typeof this._state.BGColor||"object"==n&&(this.BGColor.Color.effectValue!==this._state.BGColor.effectValue||this._state.BGColor.color.indexOf(this.BGColor.Color.color)<0)||"object"!=n&&this._state.BGColor.indexOf(this.BGColor.Color)<0){if(this.btnBGColor.setColor(this.BGColor.Color),"object"==typeof this.BGColor.Color){for(p=!1,m=0;m<10;m++)if(Common.Utils.ThemeColor.ThemeValues[m]==this.BGColor.Color.effectValue){this.colorsBG.select(this.BGColor.Color,!0),p=!0;break}p||this.colorsBG.clearSelection()}else this.colorsBG.select(this.BGColor.Color,!0);this._state.BGColor=this.BGColor.Color}if((n=typeof(s=this.GradColor.colors[this.GradColor.currentIdx]))!=typeof this._state.GradColor||"object"==n&&(s.effectValue!==this._state.GradColor.effectValue||this._state.GradColor.color.indexOf(s.color)<0)||"object"!=n&&this._state.GradColor.indexOf(s)<0){if(this.btnGradColor.setColor(s),"object"==typeof s){for(p=!1,m=0;m<10;m++)if(Common.Utils.ThemeColor.ThemeValues[m]==s.effectValue){this.colorsGrad.select(s,!0),p=!0;break}p||this.colorsGrad.clearSelection()}else this.colorsGrad.select(s,!0);this._state.GradColor=s}this.chShadow.setDisabled(!!t.get_FromChart()||this._locked),this.chShadow.setValue(!!t.asc_getShadow(),!0),this._noApply=!1}},btnDirectionRedraw:function(t,e){this.gradientColorsStr=e,f.each(this._viewDataLinear,function(t){t.gradientColorsStr=e}),this._viewDataRadial.gradientColorsStr=this.gradientColorsStr,this.mnuDirectionPicker.store.each(function(t){t.set("gradientColorsStr",e)},this),-1==this.typeGradient?this.btnDirection.$icon.css({background:"none"}):2==this.typeGradient?this.btnDirection.$icon.css({background:"radial-gradient("+e+")"}):this.btnDirection.$icon.css({background:"linear-gradient("+this.typeGradient+"deg, "+e+")"})},createDelayedControls:function(){var o=this;this._arrFillSrc=[{displayValue:this.textNoFill,value:Asc.c_oAscFill.FILL_TYPE_NOFILL},{displayValue:this.textColor,value:Asc.c_oAscFill.FILL_TYPE_SOLID},{displayValue:this.textGradientFill,value:Asc.c_oAscFill.FILL_TYPE_GRAD},{displayValue:this.textImageTexture,value:Asc.c_oAscFill.FILL_TYPE_BLIP},{displayValue:this.textPatternFill,value:Asc.c_oAscFill.FILL_TYPE_PATT}],this.cmbFillSrc=new Common.UI.ComboBox({el:C("#shape-combo-fill-src"),cls:"input-group-nr",style:"width: 100%;",menuStyle:"min-width: 100%;",editable:!1,data:this._arrFillSrc,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbFillSrc.setValue(this._arrFillSrc[0].value),this.cmbFillSrc.on("selected",f.bind(this.onFillSrcSelect,this)),this.fillControls.push(this.cmbFillSrc);this.cmbPattern=new Common.UI.ComboDataView({itemWidth:28,itemHeight:28,menuMaxHeight:300,enableKeyEvents:!0,cls:"combo-pattern",dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big",itemTemplate:f.template(['<div class="style" id="<%= id %>">','<img src="data:image/gif;base64,R0lGODlhAQABAID/AMDAwAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" class="combo-pattern-item" ','width="28" height="28" ','style="background-position: -<%= offsetx %>px -<%= offsety %>px;"/>',"</div>"].join(""))}),this.cmbPattern.render(C("#shape-combo-pattern")),this.cmbPattern.openButton.menu.cmpEl.css({"min-width":178,"max-width":178}),this.cmbPattern.on("click",f.bind(this.onPatternSelect,this)),this.cmbPattern.openButton.menu.on("show:after",function(){o.cmbPattern.menuPicker.scroller.update({alwaysVisibleY:!0})}),this.fillControls.push(this.cmbPattern),this.btnSelectImage=new Common.UI.Button({parentEl:C("#shape-button-replace"),cls:"btn-text-menu-default",caption:this.textSelectImage,style:"width:100%;",menu:new Common.UI.Menu({style:"min-width: 194px;",maxHeight:200,items:[{caption:this.textFromFile,value:0},{caption:this.textFromUrl,value:1},{caption:this.textFromStorage,value:2}]}),dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.fillControls.push(this.btnSelectImage),this.btnSelectImage.menu.on("item:click",f.bind(this.onImageSelect,this)),this.btnSelectImage.menu.items[2].setVisible(this.mode.canRequestInsertImage||this.mode.fileChoiceUrl&&-1<this.mode.fileChoiceUrl.indexOf("{documentType}")),this._arrFillType=[{displayValue:this.textStretch,value:Asc.c_oAscFillBlipType.STRETCH},{displayValue:this.textTile,value:Asc.c_oAscFillBlipType.TILE}],this.cmbFillType=new Common.UI.ComboBox({el:C("#shape-combo-fill-type"),cls:"input-group-nr",menuStyle:"min-width: 90px;",editable:!1,data:this._arrFillType,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbFillType.setValue(this._arrFillType[0].value),this.cmbFillType.on("selected",f.bind(this.onFillTypeSelect,this)),this.fillControls.push(this.cmbFillType),this.numTransparency=new Common.UI.MetricSpinner({el:C("#shape-spin-transparency"),step:1,width:62,value:"100 %",defaultUnit:"%",maxValue:100,minValue:0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.numTransparency.on("change",f.bind(this.onNumTransparencyChange,this)),this.numTransparency.on("inputleave",function(){Common.NotificationCenter.trigger("edit:complete",o)}),this.fillControls.push(this.numTransparency),this.sldrTransparency=new Common.UI.SingleSlider({el:C("#shape-slider-transparency"),width:75,minValue:0,maxValue:100,value:100}),this.sldrTransparency.on("change",f.bind(this.onTransparencyChange,this)),this.sldrTransparency.on("changecomplete",f.bind(this.onTransparencyChangeComplete,this)),this.fillControls.push(this.sldrTransparency),this.lblTransparencyStart=C(this.el).find("#shape-lbl-transparency-start"),this.lblTransparencyEnd=C(this.el).find("#shape-lbl-transparency-end"),this._arrGradType=[{displayValue:this.textLinear,value:Asc.c_oAscFillGradType.GRAD_LINEAR},{displayValue:this.textRadial,value:Asc.c_oAscFillGradType.GRAD_PATH}],this.cmbGradType=new Common.UI.ComboBox({el:C("#shape-combo-grad-type"),cls:"input-group-nr",menuStyle:"min-width: 100%;",editable:!1,data:this._arrGradType,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbGradType.setValue(this._arrGradType[0].value),this.cmbGradType.on("selected",f.bind(this.onGradTypeSelect,this)),this.fillControls.push(this.cmbGradType),this._viewDataLinear=[{type:45,subtype:-1},{type:90,subtype:4},{type:135,subtype:5},{type:0,subtype:6,cls:"item-gradient-separator",selected:!0},{type:180,subtype:1},{type:315,subtype:2},{type:270,subtype:3},{type:225,subtype:7}],f.each(this._viewDataLinear,function(t){t.gradientColorsStr=o.gradientColorsStr}),this._viewDataRadial=[{type:2,subtype:5,gradientColorsStr:this.gradientColorsStr}],this.btnDirection=new Common.UI.Button({cls:"btn-large-dataview",scaling:!1,iconCls:"item-gradient gradient-left",menu:new Common.UI.Menu({style:"min-width: 60px;",menuAlign:"tr-br",items:[{template:f.template('<div id="id-shape-menu-direction" style="width: 175px; margin: 0 5px;"></div>')}]}),dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.btnDirection.on("render:after",function(t){o.mnuDirectionPicker=new Common.UI.DataView({el:C("#id-shape-menu-direction"),parentMenu:t.menu,restoreHeight:174,store:new Common.UI.DataViewStore(o._viewDataLinear),itemTemplate:f.template('<div id="<%= id %>" class="item-gradient" style="background: <% if(type!=2) {%>linear-gradient(<%= type + 90 %>deg,<%= gradientColorsStr %>) <%} else {%> radial-gradient(<%= gradientColorsStr %>) <%}%>;"></div>')})}),this.btnDirection.render(C("#shape-button-direction")),this.mnuDirectionPicker.on("item:click",f.bind(this.onSelectGradient,this,this.btnDirection)),this.fillControls.push(this.btnDirection),this.sldrGradient=new Common.UI.MultiSliderGradient({el:C("#shape-slider-gradient"),width:192,minValue:0,maxValue:100,values:[0,100]}),this.sldrGradient.on("change",f.bind(this.onGradientChange,this)),this.sldrGradient.on("changecomplete",f.bind(this.onGradientChangeComplete,this)),this.sldrGradient.on("thumbclick",function(t,e){o.GradColor.currentIdx=e;e=o.GradColor.colors[o.GradColor.currentIdx],o.btnGradColor.setColor(e),o.colorsGrad.select(e,!1),e=o.GradColor.values[o.GradColor.currentIdx];o.spnGradPosition.setValue(Common.UI.isRTL()?o.sldrGradient.maxValue-e:e,!0)}),this.sldrGradient.on("thumbdblclick",function(t){o.btnGradColor.cmpEl.find("button").dropdown("toggle")}),this.sldrGradient.on("sortthumbs",function(t,e){var i,s=[];f.each(e,function(t,e){s.push(o.GradColor.colors[t]),o.GradColor.currentIdx==t&&(i=e)}),o.OriginalFillType=null,o.GradColor.colors=s,o.GradColor.currentIdx=i}),this.sldrGradient.on("addthumb",function(t,e,i){o.GradColor.colors[e]=o.GradColor.colors[o.GradColor.currentIdx],o.GradColor.currentIdx=e;e=o.sldrGradient.addNewThumb(e,i);o.GradColor.colors[o.GradColor.currentIdx]=e}),this.sldrGradient.on("removethumb",function(t,e){o.sldrGradient.removeThumb(e),o.GradColor.values.splice(e,1),o.sldrGradient.changeGradientStyle(),(f.isUndefined(o.GradColor.currentIdx)||o.GradColor.currentIdx>=o.GradColor.colors.length)&&(e=0===(e=0<e?e-1:e)&&2<o.GradColor.values.length?o.GradColor.values.length-2:e,o.GradColor.currentIdx=e),o.sldrGradient.setActiveThumb(o.GradColor.currentIdx)}),this.fillControls.push(this.sldrGradient),this.spnGradPosition=new Common.UI.MetricSpinner({el:C("#shape-gradient-position"),step:1,width:60,defaultUnit:"%",value:"50 %",allowDecimal:!1,maxValue:100,minValue:0,disabled:this._locked,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.fillControls.push(this.spnGradPosition),this.spnGradPosition.on("change",f.bind(this.onPositionChange,this)),this.spnGradPosition.on("inputleave",function(){Common.NotificationCenter.trigger("edit:complete",o)}),this.btnAddGradientStep=new Common.UI.Button({parentEl:C("#shape-gradient-add-step"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-add-breakpoint",disabled:this._locked,hint:this.tipAddGradientPoint,dataHint:"1",dataHintDirection:"bottom"}),this.btnAddGradientStep.on("click",f.bind(this.onAddGradientStep,this)),this.fillControls.push(this.btnAddGradientStep),this.btnRemoveGradientStep=new Common.UI.Button({parentEl:C("#shape-gradient-remove-step"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-remove-breakpoint",disabled:this._locked,hint:this.tipRemoveGradientPoint,dataHint:"1",dataHintDirection:"bottom"}),this.btnRemoveGradientStep.on("click",f.bind(this.onRemoveGradientStep,this)),this.fillControls.push(this.btnRemoveGradientStep),this.numGradientAngle=new Common.UI.MetricSpinner({el:C("#shape-spin-gradient-angle"),step:10,width:60,defaultUnit:"°",value:"0 °",allowDecimal:!0,maxValue:359.9,minValue:0,disabled:this._locked,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.fillControls.push(this.numGradientAngle),this.numGradientAngle.on("change",f.bind(this.onGradientAngleChange,this)),this.numGradientAngle.on("inputleave",function(){Common.NotificationCenter.trigger("edit:complete",o)}),this.cmbBorderSize=new Common.UI.ComboBorderSizeEditable({el:C("#shape-combo-border-size"),style:"width: 93px;",txtNoBorders:this.txtNoBorders,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}).on("selected",f.bind(this.onBorderSizeSelect,this)).on("changed:before",f.bind(this.onBorderSizeChanged,this,!0)).on("changed:after",f.bind(this.onBorderSizeChanged,this,!1)).on("combo:blur",f.bind(this.onComboBlur,this,!1)),this.BorderSize=this.cmbBorderSize.store.at(2).get("value"),this.cmbBorderSize.setValue(this.BorderSize),this.lockedControls.push(this.cmbBorderSize),this.cmbBorderType=new Common.UI.ComboBorderType({el:C("#shape-combo-border-type"),style:"width: 93px;",menuStyle:"min-width: 93px;",dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}).on("selected",f.bind(this.onBorderTypeSelect,this)).on("combo:blur",f.bind(this.onComboBlur,this,!1)),this.BorderType=Asc.c_oDashType.solid,this.cmbBorderType.setValue(this.BorderType),this.lockedControls.push(this.cmbBorderType),this.numLineTransparency=new Common.UI.MetricSpinner({el:C("#shape-line-spin-transparency"),step:1,width:62,value:"100 %",defaultUnit:"%",maxValue:100,minValue:0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.numLineTransparency.on("change",f.bind(this.onNumLineTransparencyChange,this)),this.numLineTransparency.on("inputleave",function(){Common.NotificationCenter.trigger("edit:complete",o)}),this.lockedControls.push(this.numLineTransparency),this.sldrLineTransparency=new Common.UI.SingleSlider({el:C("#shape-line-slider-transparency"),width:75,minValue:0,maxValue:100,value:100}),this.sldrLineTransparency.on("change",f.bind(this.onLineTransparencyChange,this)),this.sldrLineTransparency.on("changecomplete",f.bind(this.onLineTransparencyChangeComplete,this)),this.lockedControls.push(this.sldrLineTransparency),this.lblLineTransparencyStart=C(this.el).find("#shape-line-lbl-transparency-start"),this.lblLineTransparencyEnd=C(this.el).find("#shape-line-lbl-transparency-end"),this.btnRotate270=new Common.UI.Button({parentEl:C("#shape-button-270",o.$el),cls:"btn-toolbar",iconCls:"toolbar__icon btn-rotate-270",value:0,hint:this.textHint270,dataHint:"1",dataHintDirection:"bottom"}),this.btnRotate270.on("click",f.bind(this.onBtnRotateClick,this)),this.lockedControls.push(this.btnRotate270),this.btnRotate90=new Common.UI.Button({parentEl:C("#shape-button-90",o.$el),cls:"btn-toolbar",iconCls:"toolbar__icon btn-rotate-90",value:1,hint:this.textHint90,dataHint:"1",dataHintDirection:"bottom"}),this.btnRotate90.on("click",f.bind(this.onBtnRotateClick,this)),this.lockedControls.push(this.btnRotate90),this.btnFlipV=new Common.UI.Button({parentEl:C("#shape-button-flipv",o.$el),cls:"btn-toolbar",iconCls:"toolbar__icon btn-flip-vert",value:0,hint:this.textHintFlipV,dataHint:"1",dataHintDirection:"bottom"}),this.btnFlipV.on("click",f.bind(this.onBtnFlipClick,this)),this.lockedControls.push(this.btnFlipV),this.btnFlipH=new Common.UI.Button({parentEl:C("#shape-button-fliph",o.$el),cls:"btn-toolbar",iconCls:"toolbar__icon btn-flip-hor",value:1,hint:this.textHintFlipH,dataHint:"1",dataHintDirection:"bottom"}),this.btnFlipH.on("click",f.bind(this.onBtnFlipClick,this)),this.lockedControls.push(this.btnFlipH),this.btnEditShape=new Common.UI.Button({parentEl:C("#shape-button-edit-shape"),cls:"btn-toolbar align-left",caption:this.textEditShape,iconCls:"toolbar__icon btn-menu-shape",style:"width:100%;",menu:new Common.UI.Menu({style:"min-width: 194px;",maxHeight:200,items:[{caption:this.textEditPoints,value:0,iconCls:"toolbar__icon btn-edit-points"},{caption:this.strChange,menu:new Common.UI.Menu({menuAlign:"tl-tl",cls:"menu-shapes menu-change-shape",items:[],restoreHeightAndTop:!0,additionalAlign:function(t,e,i){t.css({left:e,top:Math.max(C(o.el).parent().offset().top,Common.Utils.innerHeight()-10-o.shapeRestoreHeight)-parseInt(t.css("margin-top"))})}})}]}),dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.lockedControls.push(this.btnEditShape),this.btnChangeShape=this.btnEditShape.menu.items[1],this.btnEditShape.menu.items[0].on("click",f.bind(this.onShapeEditPoints,this)),this.btnEditChangeShape=new Common.UI.Button({parentEl:C("#shape-button-change-shape"),cls:"btn-toolbar align-left",caption:this.textEditShape,iconCls:"toolbar__icon btn-menu-shape",style:"width:100%;",menu:new Common.UI.Menu({menuAlign:"tr-br",cls:"menu-shapes menu-change-shape",items:[]}),dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.lockedControls.push(this.btnEditChangeShape),this.chShadow=new Common.UI.CheckBox({el:C("#shape-checkbox-shadow"),labelText:this.strShadow,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.chShadow.on("change",f.bind(this.onCheckShadow,this)),this.lockedControls.push(this.chShadow),C(this.el).on("click","#shape-advanced-link",f.bind(this.openAdvancedSettings,this)),this.linkAdvanced=C("#shape-advanced-link")},createDelayedElements:function(){this._initSettings=!1,this.createDelayedControls();var t=[0,1,3,2,4,53,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,22,23,24,25,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,49,50,51,52];this.patternViewData=[];for(var e=0;e<13;e++)for(var i=0;i<4;i++){var s=4*e+i;this.patternViewData[s]={offsetx:28*i,offsety:28*e,type:t[s]}}this.patternViewData.splice(this.patternViewData.length-2,2);for(e=0;e<this.patternViewData.length;e++)this.patternViewData[e].id=Common.UI.getId();this.cmbPattern.menuPicker.store.add(this.patternViewData),0<this.cmbPattern.menuPicker.store.length&&(this.cmbPattern.fillComboView(this.cmbPattern.menuPicker.store.at(0),!0),this.PatternFillType=this.patternViewData[0].type),this.onInitStandartTextures(),this.onApiAutoShapes(this.btnEditShape.menu.items[1]),this.onApiAutoShapes(this.btnEditChangeShape),this.UpdateThemeColors()},onInitStandartTextures:function(t){var e,i=this;t&&0<t.length&&(i._texturearray=[],f.each(t,function(t){i._texturearray.push({imageUrl:t.asc_getImage(),name:i.textureNames[t.asc_getId()],type:t.asc_getId(),selected:!1})})),!i._texturearray||i._texturearray.length<1||this._initSettings||this.btnTexture||(this.btnTexture=new Common.UI.ComboBox({el:C("#shape-combo-fill-texture"),template:f.template(['<div class="input-group combobox combo-dataview-menu input-group-nr dropdown-toggle" tabindex="0" data-toggle="dropdown">','<div class="form-control text" style="width: 90px;" data-hint="1" data-hint-direction="bottom" data-hint-offset="big">'+this.textSelectTexture+"</div>",'<div style="display: table-cell;"></div>','<button type="button" class="btn btn-default">','<span class="caret" />',"</button>","</div>"].join(""))}),this.textureMenu=new Common.UI.Menu({items:[{template:f.template('<div id="id-shape-menu-texture" style="width: 233px; margin: 0 5px;"></div>')}]}),this.textureMenu.render(C("#shape-combo-fill-texture")),this.fillControls.push(this.btnTexture),e=function(t){new Common.UI.DataView({el:C("#id-shape-menu-texture"),restoreHeight:174,parentMenu:t,showLast:!1,store:new Common.UI.DataViewStore(i._texturearray||[]),itemTemplate:f.template('<div class="item-texture"><img src="<%= imageUrl %>" id="<%= id %>"></div>')}).on("item:click",f.bind(i.onSelectTexture,i)),t.off("show:before",e)},this.textureMenu.on("show:before",e))},onSelectTexture:function(t,e,i){var s,o;this._fromTextureCmb=!0,this.cmbFillType.setValue(this._arrFillType[1].value),this._fromTextureCmb=!1,this.api&&(s=new Asc.asc_CShapeProperty,(o=new Asc.asc_CShapeFill).asc_putType(Asc.c_oAscFill.FILL_TYPE_BLIP),o.asc_putFill(new Asc.asc_CFillBlip),o.asc_getFill().asc_putType(Asc.c_oAscFillBlipType.TILE),o.asc_getFill().asc_putTextureId(i.get("type")),s.asc_putFill(o),this.imgprops.asc_putShapeProperties(s),this.api.asc_setGraphicObjectProps(this.imgprops)),C(this.btnTexture.el).find(".form-control").prop("innerHTML",i.get("name")),Common.NotificationCenter.trigger("edit:complete",this)},onApiAutoShapes:function(t){function e(t){i.fillAutoShapes(),t.off("show:before",e)}var i=this;t.menu.on("show:before",e)},fillAutoShapes:function(){var o=this,t=Common.localStorage.getItem("sse-recent-shapes"),e=o.canEditPoint?"id-edit-shape-menu":"id-change-shape-menu",i=new Common.UI.MenuItem({template:f.template('<div id="'+e+'" class="menu-insertshape"></div>')});o.btnChangeShape.menu.addItem(i),o.btnChangeShape.shapePicker=new Common.UI.DataViewShape({el:C("#"+e),itemTemplate:f.template('<div class="item-shape" id="<%= id %>"><svg width="20" height="20" class="icon uni-scale"><use xlink:href="#svg-icon-<%= data.shapeType %>"></use></svg></div>'),groups:o.application.getCollection("ShapeGroups"),parentMenu:o.btnChangeShape.menu,restoreHeight:o.shapeRestoreHeight,textRecentlyUsed:o.textRecentlyUsed,recentShapes:t?JSON.parse(t):null,hideTextRect:o._state.isFromImage||o._state.isFromSmartArtInternal,hideLines:!0}),o.btnChangeShape.shapePicker.on("item:click",function(t,e,i,s){o.api&&(o.api.asc_changeShapeType(i.get("data").shapeType),Common.NotificationCenter.trigger("edit:complete",o)),"click"!==s.type&&(o.canEditPoint?o.btnEditShape:o.btnEditChangeShape).menu.hide()})},onBtnRotateClick:function(t){var e=new Asc.asc_CShapeProperty;e.asc_putRotAdd(3.14159265358979*(1==t.options.value?90:270)/180),this.imgprops.asc_putShapeProperties(e),this.api.asc_setGraphicObjectProps(this.imgprops),Common.NotificationCenter.trigger("edit:complete",this)},toggleBtnEditShape:function(){this.EditShapeContainer.toggleClass("settings-hidden",!this.canEditPoint),this.EditChangeShapeContainer.toggleClass("settings-hidden",this.canEditPoint),this.btnChangeShape=this.canEditPoint?this.btnEditShape.menu.items[1]:this.btnEditChangeShape},onBtnFlipClick:function(t){var e=new Asc.asc_CShapeProperty;1==t.options.value?e.asc_putFlipHInvert(!0):e.asc_putFlipVInvert(!0),this.imgprops.asc_putShapeProperties(e),this.api.asc_setGraphicObjectProps(this.imgprops),Common.NotificationCenter.trigger("edit:complete",this)},onShapeEditPoints:function(){this.api&&this.api.asc_editPointsGeometry()},onCheckShadow:function(t,e,i,s){var o;this.api&&((o=new Asc.asc_CShapeProperty).asc_putShadow("checked"==t.getValue()?new Asc.asc_CShadowProperty:null),this.imgprops.asc_putShapeProperties(o),this.api.asc_setGraphicObjectProps(this.imgprops)),Common.NotificationCenter.trigger("edit:complete",this)},UpdateThemeColors:function(){this._initSettings||(this.btnBackColor||(this.btnBackColor=new Common.UI.ColorButton({parentEl:C("#shape-back-color-btn"),transparent:!0,color:"transparent",eyeDropper:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"medium"}),this.fillControls.push(this.btnBackColor),this.colorsBack=this.btnBackColor.getPicker(),this.btnBackColor.on("color:select",f.bind(this.onColorsBackSelect,this)),this.btnBackColor.on("eyedropper:start",f.bind(this.onEyedropperStart,this)),this.btnBackColor.on("eyedropper:end",f.bind(this.onEyedropperEnd,this)),this.btnBorderColor=new Common.UI.ColorButton({parentEl:C("#shape-border-color-btn"),color:"000000",eyeDropper:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.lockedControls.push(this.btnBorderColor),this.colorsBorder=this.btnBorderColor.getPicker(),this.btnBorderColor.on("color:select",f.bind(this.onColorsBorderSelect,this)),this.btnBorderColor.on("eyedropper:start",f.bind(this.onEyedropperStart,this)),this.btnBorderColor.on("eyedropper:end",f.bind(this.onEyedropperEnd,this)),this.btnFGColor=new Common.UI.ColorButton({parentEl:C("#shape-foreground-color-btn"),color:"000000",eyeDropper:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.fillControls.push(this.btnFGColor),this.colorsFG=this.btnFGColor.getPicker(),this.btnFGColor.on("color:select",f.bind(this.onColorsFGSelect,this)),this.btnFGColor.on("eyedropper:start",f.bind(this.onEyedropperStart,this)),this.btnFGColor.on("eyedropper:end",f.bind(this.onEyedropperEnd,this)),this.btnBGColor=new Common.UI.ColorButton({parentEl:C("#shape-background-color-btn"),color:"ffffff",eyeDropper:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.fillControls.push(this.btnBGColor),this.colorsBG=this.btnBGColor.getPicker(),this.btnBGColor.on("color:select",f.bind(this.onColorsBGSelect,this)),this.btnBGColor.on("eyedropper:start",f.bind(this.onEyedropperStart,this)),this.btnBGColor.on("eyedropper:end",f.bind(this.onEyedropperEnd,this)),this.btnGradColor=new Common.UI.ColorButton({parentEl:C("#shape-gradient-color-btn"),color:"000000",eyeDropper:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.fillControls.push(this.btnGradColor),this.colorsGrad=this.btnGradColor.getPicker(),this.btnGradColor.on("color:select",f.bind(this.onColorsGradientSelect,this)),this.btnGradColor.on("eyedropper:start",f.bind(this.onEyedropperStart,this)),this.btnGradColor.on("eyedropper:end",f.bind(this.onEyedropperEnd,this))),this.colorsBorder.updateColors(Common.Utils.ThemeColor.getEffectColors(),Common.Utils.ThemeColor.getStandartColors()),this.colorsBack.updateColors(Common.Utils.ThemeColor.getEffectColors(),Common.Utils.ThemeColor.getStandartColors()),this.colorsFG.updateColors(Common.Utils.ThemeColor.getEffectColors(),Common.Utils.ThemeColor.getStandartColors()),this.colorsBG.updateColors(Common.Utils.ThemeColor.getEffectColors(),Common.Utils.ThemeColor.getStandartColors()),this.colorsGrad.updateColors(Common.Utils.ThemeColor.getEffectColors(),Common.Utils.ThemeColor.getStandartColors()))},_pt2mm:function(t){return 25.4*t/72},_mm2pt:function(t){return 72*t/25.4},disableFillPanels:function(e){this._state.DisabledFillPanels!==e&&(this._state.DisabledFillPanels=e,f.each(this.fillControls,function(t){t.setDisabled(e)}),this.lblTransparencyStart.toggleClass("disabled",e),this.lblTransparencyEnd.toggleClass("disabled",e),this.numGradientAngle.setDisabled(e||this.GradFillType!==Asc.c_oAscFillGradType.GRAD_LINEAR))},ShowHideElem:function(t){this.FillColorContainer.toggleClass("settings-hidden",t!==Asc.c_oAscFill.FILL_TYPE_SOLID),this.FillImageContainer.toggleClass("settings-hidden",t!==Asc.c_oAscFill.FILL_TYPE_BLIP),this.FillPatternContainer.toggleClass("settings-hidden",t!==Asc.c_oAscFill.FILL_TYPE_PATT),this.FillGradientContainer.toggleClass("settings-hidden",t!==Asc.c_oAscFill.FILL_TYPE_GRAD),this.TransparencyContainer.toggleClass("settings-hidden",t===Asc.c_oAscFill.FILL_TYPE_NOFILL||null===t)},setLocked:function(t){this._locked=t},disableControls:function(e,t){this._initSettings||(this.disableFillPanels(e||t),this._state.DisabledControls!==e&&(this._state.DisabledControls=e,f.each(this.lockedControls,function(t){t.setDisabled(e)}),this.linkAdvanced.toggleClass("disabled",e),this.lblLineTransparencyStart.toggleClass("disabled",e),this.lblLineTransparencyEnd.toggleClass("disabled",e)),this.btnFlipV.setDisabled(e||this._state.isFromSmartArtInternal),this.btnFlipH.setDisabled(e||this._state.isFromSmartArtInternal))},hideShapeOnlySettings:function(t){this._state.HideShapeOnlySettings!==t&&(this._state.HideShapeOnlySettings=t,this.ShapeOnlySettings.toggleClass("hidden",1==t))},hideChangeTypeSettings:function(t){this._state.HideChangeTypeSettings!==t&&(this._state.HideChangeTypeSettings=t,this.CanChangeType.toggleClass("hidden",1==t))},hideRotationSettings:function(t){this._state.HideRotationSettings!==t&&(this._state.HideRotationSettings=t,this.RotationSettings.toggleClass("hidden",1==t))},onPositionChange:function(t){var e,t=t.getNumberValue(),i=(Common.UI.isRTL()&&(t=this.sldrGradient.maxValue-t),this.GradColor.currentIdx-1<0?0:this.GradColor.values[this.GradColor.currentIdx-1]),s=this.GradColor.currentIdx+1<this.GradColor.values.length?this.GradColor.values[this.GradColor.currentIdx+1]:100,i=t<i||s<t;this.api&&(this.GradColor.values[this.GradColor.currentIdx]=t,s=new Asc.asc_CShapeProperty,(t=new Asc.asc_CShapeFill).asc_putType(Asc.c_oAscFill.FILL_TYPE_GRAD),t.asc_putFill(new Asc.asc_CFillGrad),t.asc_getFill().asc_putGradType(this.GradFillType),e=[],this.GradColor.values.forEach(function(t){e.push(1e3*t)}),t.asc_getFill().asc_putPositions(e),s.asc_putFill(t),this.imgprops.asc_putShapeProperties(s),this.api.asc_setGraphicObjectProps(this.imgprops),i&&(this.sldrGradient.sortThumbs(),this.sldrGradient.trigger("change",this.sldrGradient),this.sldrGradient.trigger("changecomplete",this.sldrGradient)))},onAddGradientStep:function(){var t,e;9<this.GradColor.colors.length||(t=this.GradColor.currentIdx,e=(this.GradColor.values[t]+this.GradColor.values[t<this.GradColor.colors.length-1?t+1:t-1])/2,this.GradColor.colors[this.GradColor.colors.length]=this.GradColor.colors[t],this.GradColor.currentIdx=this.GradColor.colors.length-1,e=this.sldrGradient.addNewThumb(void 0,e,t),this.GradColor.colors[this.GradColor.currentIdx]=e,this.sldrGradient.trigger("change",this.sldrGradient),this.sldrGradient.trigger("changecomplete",this.sldrGradient))},onRemoveGradientStep:function(){var t;this.GradColor.values.length<3||(t=this.GradColor.currentIdx,this.GradColor.values.splice(this.GradColor.currentIdx,1),this.sldrGradient.removeThumb(this.GradColor.currentIdx),(f.isUndefined(this.GradColor.currentIdx)||this.GradColor.currentIdx>=this.GradColor.colors.length)&&(t=0===(t=0<t?t-1:t)&&2<this.GradColor.values.length?this.GradColor.values.length-2:t,this.GradColor.currentIdx=t),this.sldrGradient.setActiveThumb(this.GradColor.currentIdx),this.sldrGradient.trigger("change",this.sldrGradient),this.sldrGradient.trigger("changecomplete",this.sldrGradient))},onGradientAngleChange:function(t,e,i,s){var o,n;this.api&&!this._noApply&&(o=new Asc.asc_CShapeProperty,(n=new Asc.asc_CShapeFill).asc_putType(Asc.c_oAscFill.FILL_TYPE_GRAD),n.asc_putFill(new Asc.asc_CFillGrad),n.asc_getFill().asc_putGradType(this.GradFillType),n.asc_getFill().asc_putLinearAngle(6e4*t.getNumberValue()),n.asc_getFill().asc_putLinearScale(!0),o.asc_putFill(n),this.imgprops.asc_putShapeProperties(o),this.api.asc_setGraphicObjectProps(this.imgprops))},onEyedropperStart:function(t){this.api.asc_startEyedropper(f.bind(t.eyedropperEnd,t)),this.fireEvent("eyedropper",!0)},onEyedropperEnd:function(){this.fireEvent("eyedropper",!1)}},SSE.Views.ShapeSettings||{}))}),define("text!spreadsheeteditor/main/app/template/TextArtSettings.template",[],function(){return'<table cols="1">\n    <tr>\n        <td>\n            <label class="header"><%= scope.textTemplate %></label>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <div class="" id="textart-combo-template" style="width: 100%; height: 64px;"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr>\n        <td>\n            <label class="header"><%= scope.strFill %></label>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <div id="textart-combo-fill-src" style="width: 100%;"></div>\n        </td>\n    </tr>\n    <tr>\n        <td>\n            <div id="textart-panel-color-fill" class="padding-small" style="width: 100%;">\n                <div id="textart-back-color-btn" style=""></div>\n            </div>\n            <div id="textart-panel-image-fill" class="settings-hidden padding-small" style="width: 100%;">\n                <table cols="2" style="width: 100%;">\n                <tr>\n                    <td class="padding-small" width="50%">\n                        <button type="button" class="btn btn-text-default" id="textart-button-from-file" style="width:90px;" data-hint="1" data-hint-direction="bottom" data-hint-offset="big"><%= scope.textFromFile %></button>\n                    </td>\n                    <td class="padding-small" width="50%">\n                        <button type="button" class="btn btn-text-default float-right" id="textart-button-from-url" style="width:90px;" data-hint="1" data-hint-direction="bottom" data-hint-offset="big"><%= scope.textFromUrl %></button>\n                    </td>\n                </tr>\n                <tr>\n                    <td style="vertical-align: top">\n                        <div id="textart-combo-fill-type" style="width: 90px;"></div>\n                    </td>\n                    <td rowspan="2">\n                        <div class="texture-img float-right" style="width: 90px; height: 80px;">\n                            <div id="textart-texture-img" style="width: 50px;height: 50px;"></div>\n                        </div>\n                    </td>\n                </tr>\n                <tr>\n                    <td style="vertical-align: bottom">\n                        <label class="input-label" style=""><%= scope.textTexture %></label>\n                        <div id="textart-combo-fill-texture" style="width: 90px;"></div>\n                    </td>\n                </tr>\n            </table>\n            </div>\n            <div id="textart-panel-pattern-fill" class="settings-hidden padding-small" style="width: 100%;">\n                <label class="input-label" style="margin-top: 3px;"><%= scope.strPattern %></label>\n                <div id="textart-combo-pattern" style="width: 100%; height: 42px; margin-bottom: 8px;"></div>\n                <div style="width: 100%; height: 25px; margin-bottom: 8px;">\n                    <label class="input-label" style="margin-top: 3px;"><%= scope.strForeground %></label>\n                    <div id="textart-foreground-color-btn" class="float-right"></div>\n                </div>\n                <div style="width: 100%; height: 25px;">\n                    <label class="input-label" style="margin-top: 3px;"><%= scope.strBackground %></label>\n                    <div id="textart-background-color-btn" class="float-right"></div>\n                </div>\n            </div>\n            <div id="textart-panel-gradient-fill" class="settings-hidden padding-small" style="width: 100%;">\n                <table cols="3" style="margin-bottom: 10px;">\n                    <tr valign="top">\n                        <td colspan="2">\n                            <div>\n                                <label class="input-label" style=""><%= scope.textStyle %></label>\n                                <div id="textart-combo-grad-type" style="width: 100%;"></div>\n                            </div>\n                        </td>\n                        <td rowspan="2" style="width: 100%;">\n                            <div class="float-right">\n                                <label class="input-label"><%= scope.textDirection %></label>\n                                <div id="textart-button-direction"></div>\n                            </div>\n                        </td>\n                    </tr>\n                    <tr valign="bottom">\n                        <td>\n                            <label class="input-label angle-label"><%= scope.textAngle %></label>\n                        </td>\n                        <td>\n                            <div id="textart-spin-gradient-angle" style="display: inline-block; width: 60px;"></div>\n                        </td>\n                    </tr>\n                </table>\n                <label class="input-label" style="display:block;margin-bottom: 5px;"><%= scope.textGradient %></label>\n                <div style="display: inline-block; margin-top: 3px;">\n                    <div id="textart-slider-gradient" style="display: inline-block; vertical-align: middle;"></div>\n                </div>\n                <div style="height: 40px;margin-top:6px;display:flex;justify-content:space-between;">\n                    <div style="display: flex;">\n                    <div style="">\n                        <label class="input-label" style=""><%= scope.strColor %></label>\n                        <div id="textart-gradient-color-btn"></div>\n                    </div>\n                    <div class="margin-left-10">\n                        <label class="input-label" style=""><%= scope.textPosition %></label>\n                        <div id="textart-gradient-position"></div>\n                    </div>\n                    </div>\n                    <div style="display:flex;padding-top:15px;">\n                        <div id="textart-gradient-add-step"></div>\n                        <div id="textart-gradient-remove-step"></div>\n                    </div>\n                </div>\n            </div>\n        </td>\n    </tr>\n    <tr>\n        <td>\n            <div class="padding-small" id="textart-panel-transparent-fill" style="width: 100%;">\n                <label class="header" style="display:block;"><%= scope.strTransparency %></label>\n                <div style="display: inline-block; margin-top: 3px;">\n                    <label id="textart-lbl-transparency-start">0</label>\n                    <div id="textart-slider-transparency" style="display: inline-block;margin: 0 4px; vertical-align: middle;"></div>\n                    <label id="textart-lbl-transparency-end">100</label>\n                </div>\n                <div id="textart-spin-transparency" class="float-right"></div>\n            </div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr>\n        <td>\n            <label class="header"><%= scope.strStroke %></label>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n        <div style="display:inline-block;width:100px;vertical-align: middle;">\n            <label class="input-label" style=""><%= scope.strSize %></label>\n            <div id="textart-combo-border-size" style="width: 93px;"></div>\n        </div>\n        <div style="display:inline-block;vertical-align: middle;">\n            <label class="input-label" style=""><%= scope.strColor %></label>\n            <div id="textart-border-color-btn" style=""></div>\n        </div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n        <div style="display:inline-block;width:100px;vertical-align: middle;">\n            <label class="input-label" style=""><%= scope.strType %></label>\n            <div id="textart-combo-border-type" style="width: 93px;"></div>\n        </div>\n        </td>\n    </tr>\n    <tr>\n        <td>\n            <div class="padding-small" id="textart-line-panel-transparent-fill" style="width: 100%;">\n                <label class="header" style="display:block;"><%= scope.strTransparency %></label>\n                <div style="display: inline-block; margin-top: 3px;">\n                    <label id="textart-line-lbl-transparency-start">0</label>\n                    <div id="textart-line-slider-transparency" style="display: inline-block;margin: 0 4px; vertical-align: middle;"></div>\n                    <label id="textart-line-lbl-transparency-end">100</label>\n                </div>\n                <div id="textart-line-spin-transparency" class="float-right"></div>\n            </div>\n        </td>\n    </tr>\n    <tr class="textart-transform">\n        <td class="padding-small">\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr class="textart-transform">\n        <td>\n            <label class="header"><%= scope.textTransform %></label>\n        </td>\n    </tr>\n    <tr class="textart-transform">\n        <td class="padding-small">\n            <div class="" id="textart-combo-transform" style="width: 100%; height: 42px;"></div>\n        </td>\n    </tr>\n    <tr class="finish-cell"></tr>\n</table>'}),define("spreadsheeteditor/main/app/view/TextArtSettings",["text!spreadsheeteditor/main/app/template/TextArtSettings.template","jquery","underscore","backbone","common/main/lib/component/ComboBox","common/main/lib/component/ComboBorderSize","common/main/lib/component/MetricSpinner","common/main/lib/component/ThemeColorPalette","common/main/lib/component/ColorButton","common/main/lib/component/ComboDataView","common/main/lib/component/Slider","common/main/lib/component/MultiSliderGradient","common/main/lib/view/ImageFromUrlDialog"],function(t,f,S,e){"use strict";SSE.Views.TextArtSettings=e.View.extend(S.extend({el:"#id-textart-settings",template:S.template(t),events:{},options:{alias:"TextArtSettings"},initialize:function(){this._initSettings=!0,this._noApply=!0,this.imgprops=null,this.shapeprops=null,this._sendUndoPoint=!0,this._sliderChanged=!1,this._texturearray=null,this.txtPt=Common.Utils.Metric.getMetricName(Common.Utils.Metric.c_MetricUnits.pt),this._state={Transparency:null,FillType:Asc.c_oAscFill.FILL_TYPE_SOLID,ShapeColor:"transparent",BlipFillType:Asc.c_oAscFillBlipType.STRETCH,StrokeType:Asc.c_oAscStrokeType.STROKE_COLOR,StrokeWidth:this._pt2mm(1),StrokeColor:"000000",StrokeBorderType:Asc.c_oDashType.solid,FGColor:"000000",BGColor:"ffffff",GradColor:"000000",GradFillType:Asc.c_oAscFillGradType.GRAD_LINEAR,FormId:null,DisabledControls:!1,applicationPixelRatio:Common.Utils.applicationPixelRatio(),isFromSmartArtInternal:!1,HideTransformSettings:!1},this.lockedControls=[],this._locked=!1,this.OriginalFillType=Asc.c_oAscFill.FILL_TYPE_SOLID,this.ShapeColor={Value:1,Color:"transparent"},this.BlipFillType=Asc.c_oAscFillBlipType.STRETCH,this.GradFillType=Asc.c_oAscFillGradType.GRAD_LINEAR,this.GradColor={values:[0,100],colors:["000000","ffffff"],currentIdx:0},this.GradRadialDirectionIdx=0,this.GradLinearDirectionType=0,this.PatternFillType=0,this.FGColor={Value:1,Color:"000000"},this.BGColor={Value:1,Color:"ffffff"},this.BorderColor={Value:1,Color:"transparent"},this.BorderSize=0,this.BorderType=Asc.c_oDashType.solid,this.textureNames=[this.txtCanvas,this.txtCarton,this.txtDarkFabric,this.txtGrain,this.txtGranite,this.txtGreyPaper,this.txtKnit,this.txtLeather,this.txtBrownPaper,this.txtPapyrus,this.txtWood],this.render(),this.FillColorContainer=f("#textart-panel-color-fill"),this.FillImageContainer=f("#textart-panel-image-fill"),this.FillPatternContainer=f("#textart-panel-pattern-fill"),this.FillGradientContainer=f("#textart-panel-gradient-fill"),this.TransparencyContainer=f("#textart-panel-transparent-fill"),this.TransformSettings=f(".textart-transform"),this.gradientColorsStr="#000, #fff",this.typeGradient=90,SSE.getCollection("Common.Collections.TextArt").bind({reset:this.fillTextArt.bind(this)})},render:function(){f(this.el).html(this.template({scope:this})),f(window).on("resize",S.bind(this.onWindowResize,this))},setApi:function(t){return this.api=t,this.api&&(this.api.asc_setInterfaceDrawImagePlaceTextArt("textart-texture-img"),this.api.asc_registerCallback("asc_onInitStandartTextures",S.bind(this.onInitStandartTextures,this))),this},onFillSrcSelect:function(t,e){switch(this.ShowHideElem(e.value),e.value){case Asc.c_oAscFill.FILL_TYPE_SOLID:this._state.FillType=Asc.c_oAscFill.FILL_TYPE_SOLID,this._noApply||(o=new Asc.asc_TextArtProperties,(n=new Asc.asc_CShapeFill).asc_putType(Asc.c_oAscFill.FILL_TYPE_SOLID),n.asc_putFill(new Asc.asc_CFillSolid),n.asc_getFill().asc_putColor(Common.Utils.ThemeColor.getRgbColor("transparent"==this.ShapeColor.Color?{color:"4f81bd",effectId:24}:this.ShapeColor.Color)),o.asc_putFill(n),this.shapeprops.put_TextArtProperties(o),this.api.asc_setGraphicObjectProps(this.imgprops));break;case Asc.c_oAscFill.FILL_TYPE_GRAD:var i;this._state.FillType=Asc.c_oAscFill.FILL_TYPE_GRAD,this._noApply||(o=new Asc.asc_TextArtProperties,(n=new Asc.asc_CShapeFill).asc_putType(Asc.c_oAscFill.FILL_TYPE_GRAD),n.asc_putFill(new Asc.asc_CFillGrad),n.asc_getFill().asc_putGradType(this.GradFillType),this.GradFillType==Asc.c_oAscFillGradType.GRAD_LINEAR&&(n.asc_getFill().asc_putLinearAngle(6e4*this.GradLinearDirectionType),n.asc_getFill().asc_putLinearScale(!0)),this.OriginalFillType!==Asc.c_oAscFill.FILL_TYPE_GRAD&&(this.GradColor.values=[0,100],this.GradColor.colors=[this.GradColor.colors[0],this.GradColor.colors[this.GradColor.colors.length-1]],this.GradColor.currentIdx=0,i=Common.Utils.ThemeColor.getRgbColor(this.GradColor.colors[0]).get_color().get_hex(),s=Common.Utils.ThemeColor.getRgbColor(this.GradColor.colors[1]).get_color().get_hex(),i="ffffff"===i&&"ffffff"===s?{color:"4f81bd",effectId:24}:this.GradColor.colors[0],n.asc_getFill().asc_putPositions([1e3*this.GradColor.values[0],1e3*this.GradColor.values[1]]),n.asc_getFill().asc_putColors([Common.Utils.ThemeColor.getRgbColor(i),Common.Utils.ThemeColor.getRgbColor(this.GradColor.colors[1])])),o.asc_putFill(n),this.shapeprops.put_TextArtProperties(o),this.api.asc_setGraphicObjectProps(this.imgprops));break;case Asc.c_oAscFill.FILL_TYPE_BLIP:this._state.FillType=Asc.c_oAscFill.FILL_TYPE_BLIP;break;case Asc.c_oAscFill.FILL_TYPE_PATT:var s;this._state.FillType=Asc.c_oAscFill.FILL_TYPE_PATT,this._noApply||(o=new Asc.asc_TextArtProperties,(n=new Asc.asc_CShapeFill).asc_putType(Asc.c_oAscFill.FILL_TYPE_PATT),n.asc_putFill(new Asc.asc_CFillHatch),n.asc_getFill().asc_putPatternType(this.PatternFillType),s=Common.Utils.ThemeColor.getRgbColor(this.FGColor.Color).get_color().get_hex(),s="ffffff"===Common.Utils.ThemeColor.getRgbColor(this.BGColor.Color).get_color().get_hex()&&"ffffff"===s?{color:"4f81bd",effectId:24}:this.FGColor.Color,n.asc_getFill().asc_putColorFg(Common.Utils.ThemeColor.getRgbColor(s)),n.asc_getFill().asc_putColorBg(Common.Utils.ThemeColor.getRgbColor(this.BGColor.Color)),o.asc_putFill(n),this.shapeprops.put_TextArtProperties(o),this.api.asc_setGraphicObjectProps(this.imgprops));break;case Asc.c_oAscFill.FILL_TYPE_NOFILL:var o,n;this._state.FillType=Asc.c_oAscFill.FILL_TYPE_NOFILL,this._noApply||(o=new Asc.asc_TextArtProperties,(n=new Asc.asc_CShapeFill).asc_putType(Asc.c_oAscFill.FILL_TYPE_NOFILL),n.asc_putFill(null),o.asc_putFill(n),this.shapeprops.put_TextArtProperties(o),this.api.asc_setGraphicObjectProps(this.imgprops))}Common.NotificationCenter.trigger("edit:complete",this)},onColorsBackSelect:function(t,e){var i;this.ShapeColor={Value:1,Color:e},this.api&&!this._noApply&&(e=new Asc.asc_TextArtProperties,i=new Asc.asc_CShapeFill,"transparent"==this.ShapeColor.Color?(i.asc_putType(Asc.c_oAscFill.FILL_TYPE_NOFILL),i.asc_putFill(null)):(i.asc_putType(Asc.c_oAscFill.FILL_TYPE_SOLID),i.asc_putFill(new Asc.asc_CFillSolid),i.asc_getFill().asc_putColor(Common.Utils.ThemeColor.getRgbColor(this.ShapeColor.Color))),e.asc_putFill(i),this.shapeprops.put_TextArtProperties(e),this.api.asc_setGraphicObjectProps(this.imgprops)),Common.NotificationCenter.trigger("edit:complete",this)},onPatternSelect:function(t,e){var i;this.api&&!this._noApply&&(this.PatternFillType=e.get("type"),e=new Asc.asc_TextArtProperties,(i=new Asc.asc_CShapeFill).asc_putType(Asc.c_oAscFill.FILL_TYPE_PATT),i.asc_putFill(new Asc.asc_CFillHatch),i.asc_getFill().asc_putPatternType(this.PatternFillType),this.OriginalFillType!==Asc.c_oAscFill.FILL_TYPE_PATT&&(i.asc_getFill().asc_putColorFg(Common.Utils.ThemeColor.getRgbColor(this.FGColor.Color)),i.asc_getFill().asc_putColorBg(Common.Utils.ThemeColor.getRgbColor(this.BGColor.Color))),e.asc_putFill(i),this.shapeprops.put_TextArtProperties(e),this.api.asc_setGraphicObjectProps(this.imgprops)),Common.NotificationCenter.trigger("edit:complete",this)},onColorsFGSelect:function(t,e){var i;this.FGColor={Value:1,Color:e},this.api&&!this._noApply&&(e=new Asc.asc_TextArtProperties,(i=new Asc.asc_CShapeFill).asc_putType(Asc.c_oAscFill.FILL_TYPE_PATT),i.asc_putFill(new Asc.asc_CFillHatch),i.asc_getFill().asc_putColorFg(Common.Utils.ThemeColor.getRgbColor(this.FGColor.Color)),this.OriginalFillType!==Asc.c_oAscFill.FILL_TYPE_PATT&&(i.asc_getFill().asc_putPatternType(this.PatternFillType),i.asc_getFill().asc_putColorBg(Common.Utils.ThemeColor.getRgbColor(this.BGColor.Color))),e.asc_putFill(i),this.shapeprops.put_TextArtProperties(e),this.api.asc_setGraphicObjectProps(this.imgprops)),Common.NotificationCenter.trigger("edit:complete",this)},onColorsBGSelect:function(t,e){var i;this.BGColor={Value:1,Color:e},this.api&&!this._noApply&&(e=new Asc.asc_TextArtProperties,(i=new Asc.asc_CShapeFill).asc_putType(Asc.c_oAscFill.FILL_TYPE_PATT),i.asc_putFill(new Asc.asc_CFillHatch),this.OriginalFillType!==Asc.c_oAscFill.FILL_TYPE_PATT&&(i.asc_getFill().asc_putPatternType(this.PatternFillType),i.asc_getFill().asc_putColorFg(Common.Utils.ThemeColor.getRgbColor(this.FGColor.Color))),i.asc_getFill().asc_putColorBg(Common.Utils.ThemeColor.getRgbColor(this.BGColor.Color)),e.asc_putFill(i),this.shapeprops.put_TextArtProperties(e),this.api.asc_setGraphicObjectProps(this.imgprops)),Common.NotificationCenter.trigger("edit:complete",this)},onFillTypeSelect:function(t,e){var i;this.BlipFillType=e.value,this.api&&!0!==this._fromTextureCmb&&this.OriginalFillType==Asc.c_oAscFill.FILL_TYPE_BLIP&&(e=new Asc.asc_TextArtProperties,(i=new Asc.asc_CShapeFill).asc_putType(Asc.c_oAscFill.FILL_TYPE_BLIP),i.asc_putFill(new Asc.asc_CFillBlip),i.asc_getFill().asc_putType(this.BlipFillType),e.asc_putFill(i),this.shapeprops.put_TextArtProperties(e),this.api.asc_setGraphicObjectProps(this.imgprops)),Common.NotificationCenter.trigger("edit:complete",this)},onNumTransparencyChange:function(t,e,i,s){var o,n;this.sldrTransparency.setValue(t.getNumberValue(),!0),this.api&&(t=t.getNumberValue(),o=new Asc.asc_TextArtProperties,(n=new Asc.asc_CShapeFill).asc_putTransparent(2.55*t),o.asc_putFill(n),this.shapeprops.put_TextArtProperties(o),this.api.asc_setGraphicObjectProps(this.imgprops))},onTransparencyChange:function(t,e,i){this._sliderChanged=e,this.numTransparency.setValue(e,!0),this._sendUndoPoint&&(this.api.setStartPointHistory(),this._sendUndoPoint=!1,this.updateslider=setInterval(S.bind(this._transparencyApplyFunc,this),100))},onTransparencyChangeComplete:function(t,e,i){clearInterval(this.updateslider),this._sliderChanged=e,this._sendUndoPoint||(this.api.setEndPointHistory(),this._transparencyApplyFunc()),this._sendUndoPoint=!0},_transparencyApplyFunc:function(){var t,e;void 0!==this._sliderChanged&&(t=new Asc.asc_TextArtProperties,(e=new Asc.asc_CShapeFill).asc_putTransparent(2.55*this._sliderChanged),t.asc_putFill(e),this.shapeprops.put_TextArtProperties(t),this.api.asc_setGraphicObjectProps(this.imgprops),this._sliderChanged=void 0)},onGradTypeSelect:function(t,e){var i;this.GradFillType=e.value,this.GradFillType==Asc.c_oAscFillGradType.GRAD_LINEAR?(this.mnuDirectionPicker.store.reset(this._viewDataLinear),this.mnuDirectionPicker.cmpEl.width(175),this.mnuDirectionPicker.restoreHeight=174,e=this.mnuDirectionPicker.store.findWhere({type:this.GradLinearDirectionType}),this.mnuDirectionPicker.selectRecord(e,!0),this.typeGradient=e?this.GradLinearDirectionType+90:-1,this.numGradientAngle.setValue(this.GradLinearDirectionType,!0),this.numGradientAngle.setDisabled(this._locked)):this.GradFillType==Asc.c_oAscFillGradType.GRAD_PATH&&(this.mnuDirectionPicker.store.reset(this._viewDataRadial),this.mnuDirectionPicker.cmpEl.width(60),this.mnuDirectionPicker.restoreHeight=58,this.mnuDirectionPicker.selectByIndex(this.GradRadialDirectionIdx,!0),0<=this.GradRadialDirectionIdx?this.typeGradient=this._viewDataRadial[this.GradRadialDirectionIdx].type:this.typeGradient=-1,this.numGradientAngle.setValue(0,!0),this.numGradientAngle.setDisabled(!0)),this.api&&!this._noApply&&(e=new Asc.asc_TextArtProperties,(i=new Asc.asc_CShapeFill).asc_putType(Asc.c_oAscFill.FILL_TYPE_GRAD),i.asc_putFill(new Asc.asc_CFillGrad),i.asc_getFill().asc_putGradType(this.GradFillType),this.GradFillType==Asc.c_oAscFillGradType.GRAD_LINEAR&&(i.asc_getFill().asc_putLinearAngle(6e4*this.GradLinearDirectionType),i.asc_getFill().asc_putLinearScale(!0)),e.asc_putFill(i),this.shapeprops.put_TextArtProperties(e),this.api.asc_setGraphicObjectProps(this.imgprops)),Common.NotificationCenter.trigger("edit:complete",this)},onSelectGradient:function(t,e,i,s){if(!this._noApply){var o,n={};if(S.isFunction(s.toJSON)){if(!s.get("selected"))return;n=s.toJSON()}else n=s;this.GradFillType===Asc.c_oAscFillGradType.GRAD_LINEAR?(this.GradLinearDirectionType=n.type,this.typeGradient=n.type+90):(this.GradRadialDirectionIdx=0,this.typeGradient=n.type),this.GradFillType==Asc.c_oAscFillGradType.GRAD_LINEAR?this.GradLinearDirectionType=n.type:this.GradRadialDirectionIdx=0,this.api&&this.GradFillType==Asc.c_oAscFillGradType.GRAD_LINEAR&&(this.numGradientAngle.setValue(n.type,!0),s=new Asc.asc_TextArtProperties,(o=new Asc.asc_CShapeFill).asc_putType(Asc.c_oAscFill.FILL_TYPE_GRAD),o.asc_putFill(new Asc.asc_CFillGrad),o.asc_getFill().asc_putGradType(this.GradFillType),o.asc_getFill().asc_putLinearAngle(6e4*n.type),o.asc_getFill().asc_putLinearScale(!0),s.asc_putFill(o),this.shapeprops.put_TextArtProperties(s),this.api.asc_setGraphicObjectProps(this.imgprops)),Common.NotificationCenter.trigger("edit:complete",this)}},onColorsGradientSelect:function(t,e){var i,s;this.GradColor.colors[this.GradColor.currentIdx]=e,this.sldrGradient.setColorValue(Common.Utils.String.format("#{0}","object"==typeof e?e.color:e)),this.api&&!this._noApply&&(e=new Asc.asc_TextArtProperties,(i=new Asc.asc_CShapeFill).asc_putType(Asc.c_oAscFill.FILL_TYPE_GRAD),i.asc_putFill(new Asc.asc_CFillGrad),i.asc_getFill().asc_putGradType(this.GradFillType),s=[],this.GradColor.colors.forEach(function(t){s.push(Common.Utils.ThemeColor.getRgbColor(t))}),i.asc_getFill().asc_putColors(s),this.OriginalFillType!==Asc.c_oAscFill.FILL_TYPE_GRAD&&(this.GradFillType==Asc.c_oAscFillGradType.GRAD_LINEAR&&(i.asc_getFill().asc_putLinearAngle(6e4*this.GradLinearDirectionType),i.asc_getFill().asc_putLinearScale(!0)),s=[],this.GradColor.values.forEach(function(t){s.push(1e3*t)}),i.asc_getFill().asc_putPositions(s)),e.asc_putFill(i),this.shapeprops.put_TextArtProperties(e),this.api.asc_setGraphicObjectProps(this.imgprops)),Common.NotificationCenter.trigger("edit:complete",this)},onGradientChange:function(t,e,i){this.GradColor.values=t.getValues();t=this.GradColor.values[this.GradColor.currentIdx];this.spnGradPosition.setValue(Common.UI.isRTL()?this.sldrGradient.maxValue-t:t,!0),this._sliderChanged=!0,this.api&&!this._noApply&&this._sendUndoPoint&&(this.api.setStartPointHistory(),this._sendUndoPoint=!1,this.updateslider=setInterval(S.bind(this._gradientApplyFunc,this),100))},onGradientChangeComplete:function(t,e,i){clearInterval(this.updateslider),this._sliderChanged=!0,this._sendUndoPoint||(this.api.setEndPointHistory(),this._gradientApplyFunc()),this._sendUndoPoint=!0},_gradientApplyFunc:function(){var t,e,i;this._sliderChanged&&(t=new Asc.asc_TextArtProperties,(e=new Asc.asc_CShapeFill).asc_putType(Asc.c_oAscFill.FILL_TYPE_GRAD),e.asc_putFill(new Asc.asc_CFillGrad),e.asc_getFill().asc_putGradType(this.GradFillType),i=[],this.GradColor.values.forEach(function(t){i.push(1e3*t)}),e.asc_getFill().asc_putPositions(i),this.OriginalFillType!==Asc.c_oAscFill.FILL_TYPE_GRAD&&(this.GradFillType==Asc.c_oAscFillGradType.GRAD_LINEAR&&(e.asc_getFill().asc_putLinearAngle(6e4*this.GradLinearDirectionType),e.asc_getFill().asc_putLinearScale(!0)),i=[],this.GradColor.colors.forEach(function(t){i.push(Common.Utils.ThemeColor.getRgbColor(t))}),e.asc_getFill().asc_putColors(i)),t.asc_putFill(e),this.shapeprops.put_TextArtProperties(t),this.api.asc_setGraphicObjectProps(this.imgprops),this._sliderChanged=!1)},applyBorderSize:function(t){var e;t=Common.Utils.String.parseFloat(t),t=isNaN(t)?0:Math.max(0,Math.min(1584,t)),this.BorderSize=t,this.api&&!this._noApply&&(t=new Asc.asc_TextArtProperties,e=new Asc.asc_CStroke,this.BorderSize<1e-5?(e.asc_putType(Asc.c_oAscStrokeType.STROKE_NONE),this._state.StrokeType=this._state.StrokeWidth=-1):(e.asc_putType(Asc.c_oAscStrokeType.STROKE_COLOR),"transparent"==this.BorderColor.Color||"transparent"==this.BorderColor.Color.color?e.asc_putColor(Common.Utils.ThemeColor.getRgbColor({color:"000000",effectId:29})):this._state.StrokeType!=Asc.c_oAscStrokeType.STROKE_NONE&&null!==this._state.StrokeType||e.asc_putColor(Common.Utils.ThemeColor.getRgbColor(Common.Utils.ThemeColor.colorValue2EffectId(this.BorderColor.Color))),e.asc_putPrstDash(this.BorderType),e.asc_putWidth(this._pt2mm(this.BorderSize)),e.asc_putTransparent(this._state.LineTransparency)),t.asc_putLine(e),this.shapeprops.put_TextArtProperties(t),this.api.asc_setGraphicObjectProps(this.imgprops)),Common.NotificationCenter.trigger("edit:complete",this)},onComboBlur:function(){Common.NotificationCenter.trigger("edit:complete",this)},onBorderSizeChanged:function(t,e,i,s){var o=this;t?(t=parseFloat(i.value),(!new RegExp("^\\s*(\\d*(\\.|,)?\\d+)\\s*("+o.txtPt+")?\\s*$").exec(i.value)||t<0||1584<t)&&(this._state.StrokeType=this._state.StrokeWidth=-1,setTimeout(function(){Common.UI.error({msg:o.textBorderSizeErr,callback:function(){S.defer(function(t){Common.NotificationCenter.trigger("edit:complete",o)})}})},10))):this.applyBorderSize(i.value)},onBorderSizeSelect:function(t,e){this.applyBorderSize(e.value)},onBorderTypeSelect:function(t,e){var i;this.BorderType=e.value,this.api&&!this._noApply&&(e=new Asc.asc_TextArtProperties,i=new Asc.asc_CStroke,this.BorderSize<1e-5?i.put_type(Asc.c_oAscStrokeType.STROKE_NONE):(i.put_type(Asc.c_oAscStrokeType.STROKE_COLOR),i.put_color(Common.Utils.ThemeColor.getRgbColor(this.BorderColor.Color)),i.put_width(this._pt2mm(this.BorderSize)),i.asc_putPrstDash(this.BorderType),i.asc_putTransparent(this._state.LineTransparency)),e.asc_putLine(i),this.shapeprops.put_TextArtProperties(e),this.api.asc_setGraphicObjectProps(this.imgprops)),Common.NotificationCenter.trigger("edit:complete",this)},onColorsBorderSelect:function(t,e){var i;this.BorderColor={Value:1,Color:e},this.api&&0<this.BorderSize&&!this._noApply&&(e=new Asc.asc_TextArtProperties,i=new Asc.asc_CStroke,this.BorderSize<1e-5?i.asc_putType(Asc.c_oAscStrokeType.STROKE_NONE):(i.asc_putType(Asc.c_oAscStrokeType.STROKE_COLOR),i.asc_putColor(Common.Utils.ThemeColor.getRgbColor(this.BorderColor.Color)),i.asc_putWidth(this._pt2mm(this.BorderSize)),i.asc_putPrstDash(this.BorderType),i.asc_putTransparent(this._state.LineTransparency)),e.asc_putLine(i),this.shapeprops.put_TextArtProperties(e),this.api.asc_setGraphicObjectProps(this.imgprops)),Common.NotificationCenter.trigger("edit:complete",this)},onNumLineTransparencyChange:function(t,e,i,s){var o;this.sldrLineTransparency.setValue(t.getNumberValue(),!0),this._state.LineTransparency=2.55*t.getNumberValue(),this.api&&0<this.BorderSize&&!this._noApply&&(t=new Asc.asc_TextArtProperties,(o=new Asc.asc_CStroke).asc_putTransparent(this._state.LineTransparency),t.asc_putLine(o),this.shapeprops.put_TextArtProperties(t),this.api.asc_setGraphicObjectProps(this.imgprops))},onLineTransparencyChange:function(t,e,i){this._sliderChangedLine=e,this.numLineTransparency.setValue(e,!0),this._sendUndoPoint&&(this.api.setStartPointHistory(),this._sendUndoPoint=!1,this.updatesliderline=setInterval(S.bind(this._transparencyLineApplyFunc,this),100))},onLineTransparencyChangeComplete:function(t,e,i){clearInterval(this.updatesliderline),this._sliderChangedLine=e,this._sendUndoPoint||(this.api.setEndPointHistory(),this._transparencyLineApplyFunc()),this._sendUndoPoint=!0},_transparencyLineApplyFunc:function(){var t,e;void 0!==this._sliderChangedLine&&(this._state.LineTransparency=2.55*this._sliderChangedLine,t=new Asc.asc_TextArtProperties,(e=new Asc.asc_CStroke).asc_putTransparent(this._state.LineTransparency),t.asc_putLine(e),this.shapeprops.put_TextArtProperties(t),this.api.asc_setGraphicObjectProps(this.imgprops),this._sliderChangedLine=void 0)},insertFromUrl:function(){var s=this;new Common.Views.ImageFromUrlDialog({handler:function(t,e){var i;"ok"==t&&s.api&&(t=e.replace(/ /g,""),S.isEmpty(t)||null!==s.BlipFillType&&(e=new Asc.asc_TextArtProperties,(i=new Asc.asc_CShapeFill).asc_putType(Asc.c_oAscFill.FILL_TYPE_BLIP),i.asc_putFill(new Asc.asc_CFillBlip),i.asc_getFill().asc_putType(s.BlipFillType),i.asc_getFill().asc_putUrl(t),e.asc_putFill(i),s.shapeprops.put_TextArtProperties(e),s.api.asc_setGraphicObjectProps(s.imgprops))),Common.NotificationCenter.trigger("edit:complete",s)}}).show()},ChangeSettings:function(t){if(null==this.imgprops&&(this.imgprops=new Asc.asc_CImgProperty,this.imgprops.asc_putShapeProperties(new Asc.asc_CShapeProperty),this.shapeprops=this.imgprops.asc_getShapeProperties()),this._initSettings&&this.createDelayedElements(),this._state.isFromSmartArtInternal=t.asc_getShapeProperties()&&t.asc_getShapeProperties().asc_getFromSmartArtInternal(),this.hideTransformSettings(this._state.isFromSmartArtInternal),t&&t.asc_getShapeProperties()&&t.asc_getShapeProperties().get_TextArtProperties()){var t=t.asc_getShapeProperties().get_TextArtProperties(),e=(this._noApply=!0,this.disableControls(this._locked),null),i=(o=t.asc_getFill())?o.asc_getType():null,s=null;if(o&&(b=o.asc_getTransparent(),(.001<Math.abs(this._state.Transparency-b)||.001<Math.abs(this.numTransparency.getNumberValue()-b)||!(null!==this._state.Transparency&&null!==b||this._state.Transparency===b&&this.numTransparency.getNumberValue()===b))&&(void 0!==b&&(this.sldrTransparency.setValue(null===b?100:b/255*100,!0),this.numTransparency.setValue(this.sldrTransparency.getValue(),!0)),this._state.Transparency=b)),null==o||null===i)this.OriginalFillType=null;else if(i==Asc.c_oAscFill.FILL_TYPE_NOFILL)this.OriginalFillType=Asc.c_oAscFill.FILL_TYPE_NOFILL;else if(i==Asc.c_oAscFill.FILL_TYPE_SOLID)(s=(o=o.asc_getFill()).asc_getColor())?s.asc_getType()==Asc.c_oAscColor.COLOR_TYPE_SCHEME?this.ShapeColor={Value:1,Color:{color:Common.Utils.ThemeColor.getHexColor(s.asc_getR(),s.asc_getG(),s.asc_getB()),effectValue:s.asc_getValue()}}:this.ShapeColor={Value:1,Color:Common.Utils.ThemeColor.getHexColor(s.asc_getR(),s.asc_getG(),s.asc_getB())}:this.ShapeColor={Value:0,Color:"transparent"},this.OriginalFillType=Asc.c_oAscFill.FILL_TYPE_SOLID,this.FGColor="transparent"!==this.ShapeColor.Color?{Value:1,Color:Common.Utils.ThemeColor.colorValue2EffectId(this.ShapeColor.Color)}:{Value:1,Color:"000000"},this.BGColor={Value:1,Color:"ffffff"},this.GradColor.colors[0]="transparent"!==this.ShapeColor.Color?Common.Utils.ThemeColor.colorValue2EffectId(this.ShapeColor.Color):"000000",this.GradColor.colors[this.GradColor.colors.length-1]="ffffff";else if(i==Asc.c_oAscFill.FILL_TYPE_BLIP)o=o.asc_getFill(),this.BlipFillType=o.asc_getType(),this._state.BlipFillType!==this.BlipFillType&&(this.BlipFillType==Asc.c_oAscFillBlipType.STRETCH||this.BlipFillType==Asc.c_oAscFillBlipType.TILE?this.cmbFillType.setValue(this.BlipFillType):this.cmbFillType.setValue(""),this._state.BlipFillType=this.BlipFillType),this.OriginalFillType=Asc.c_oAscFill.FILL_TYPE_BLIP;else if(i==Asc.c_oAscFill.FILL_TYPE_PATT){var o=o.asc_getFill();this.PatternFillType=o.asc_getPatternType(),this._state.PatternFillType!==this.PatternFillType&&(this.cmbPattern.suspendEvents(),e=this.cmbPattern.menuPicker.store.findWhere({type:this.PatternFillType}),this.cmbPattern.menuPicker.selectRecord(e),this.cmbPattern.resumeEvents(),this._state.PatternFillType=this.PatternFillType),(s=o.asc_getColorFg())?s.asc_getType()==Asc.c_oAscColor.COLOR_TYPE_SCHEME?this.FGColor={Value:1,Color:{color:Common.Utils.ThemeColor.getHexColor(s.asc_getR(),s.asc_getG(),s.asc_getB()),effectValue:s.asc_getValue()}}:this.FGColor={Value:1,Color:Common.Utils.ThemeColor.getHexColor(s.asc_getR(),s.asc_getG(),s.asc_getB())}:this.FGColor={Value:1,Color:"000000"},(s=o.asc_getColorBg())?s.asc_getType()==Asc.c_oAscColor.COLOR_TYPE_SCHEME?this.BGColor={Value:1,Color:{color:Common.Utils.ThemeColor.getHexColor(s.asc_getR(),s.asc_getG(),s.asc_getB()),effectValue:s.asc_getValue()}}:this.BGColor={Value:1,Color:Common.Utils.ThemeColor.getHexColor(s.asc_getR(),s.asc_getG(),s.asc_getB())}:this.BGColor={Value:1,Color:"ffffff"},this.OriginalFillType=Asc.c_oAscFill.FILL_TYPE_PATT,this.ShapeColor={Value:1,Color:Common.Utils.ThemeColor.colorValue2EffectId(this.FGColor.Color)},this.GradColor.colors[0]=Common.Utils.ThemeColor.colorValue2EffectId(this.FGColor.Color),this.GradColor.colors[this.GradColor.colors.length-1]="ffffff"}else if(i==Asc.c_oAscFill.FILL_TYPE_GRAD){for(var i=(o=o.asc_getFill()).asc_getGradType(),n=(this._state.GradFillType===i&&this.GradFillType===i||(this.GradFillType=i,e=void 0,this.GradFillType==Asc.c_oAscFillGradType.GRAD_LINEAR||this.GradFillType==Asc.c_oAscFillGradType.GRAD_PATH?(this.cmbGradType.setValue(this.GradFillType),e=this.cmbGradType.store.findWhere({value:this.GradFillType}),this.onGradTypeSelect(this.cmbGradType,e.attributes)):(this.cmbGradType.setValue(""),this.typeGradient=-1),this._state.GradFillType=this.GradFillType),this.GradFillType==Asc.c_oAscFillGradType.GRAD_LINEAR?(i=Math.floor(o.asc_getLinearAngle()/6e4),.001<Math.abs(this.GradLinearDirectionType-i)&&(this.GradLinearDirectionType=i,a=this.mnuDirectionPicker.store.findWhere({type:i}),this.mnuDirectionPicker.selectRecord(a,!0),this.typeGradient=a?i+90:-1,this.numGradientAngle.setValue(i,!0))):this.numGradientAngle.setValue(0,!0),this),a=o.asc_getColors(),l=o.asc_getPositions(),r=(a||this.GradColor.colors).length,c=(this.sldrGradient.setThumbs(r),this.GradColor.colors.length>r&&(this.GradColor.colors.splice(r,this.GradColor.colors.length-r),this.GradColor.values.splice(r,this.GradColor.colors.length-r),this.GradColor.currentIdx=0),a&&a.forEach(function(t,e){t?t.asc_getType()==Asc.c_oAscColor.COLOR_TYPE_SCHEME?(n.GradColor.colors[e]={color:Common.Utils.ThemeColor.getHexColor(t.asc_getR(),t.asc_getG(),t.asc_getB()),effectValue:t.asc_getValue()},Common.Utils.ThemeColor.colorValue2EffectId(n.GradColor.colors[e])):n.GradColor.colors[e]=Common.Utils.ThemeColor.getHexColor(t.asc_getR(),t.asc_getG(),t.asc_getB()):n.GradColor.colors[e]="000000";t=l[e];null!==t&&(n.GradColor.values[e]=t/=1e3)}),[]),d=this.GradFillType==Asc.c_oAscFillGradType.GRAD_LINEAR?1:.7,h=0;h<r;h++)n.sldrGradient.setColorValue(Common.Utils.String.format("#{0}","object"==typeof n.GradColor.colors[h]?n.GradColor.colors[h].color:n.GradColor.colors[h]),h),n.sldrGradient.setValue(h,n.GradColor.values[h]),c.push(n.sldrGradient.getColorValue(h)+" "+n.sldrGradient.getValue(h)*d+"%");this.btnDirectionRedraw(n.sldrGradient,c.join(", ")),(S.isUndefined(n.GradColor.currentIdx)||n.GradColor.currentIdx>=this.GradColor.colors.length)&&(n.GradColor.currentIdx=0),n.sldrGradient.setActiveThumb(n.GradColor.currentIdx);i=n.GradColor.values[n.GradColor.currentIdx];this.spnGradPosition.setValue(Common.UI.isRTL()?n.sldrGradient.maxValue-i:i),this.OriginalFillType=Asc.c_oAscFill.FILL_TYPE_GRAD,this.FGColor={Value:1,Color:this.GradColor.colors[0]},this.BGColor={Value:1,Color:"ffffff"},this.ShapeColor={Value:1,Color:this.GradColor.colors[0]}}this._state.FillType!==this.OriginalFillType&&(this.cmbFillSrc.setValue(null===this.OriginalFillType?"":this.OriginalFillType),this._state.FillType=this.OriginalFillType,this.ShowHideElem(this.OriginalFillType)),f(this.btnTexture.el).find(".form-control").prop("innerHTML",this.textSelectTexture);o=typeof this.ShapeColor.Color;if(o!=typeof this._state.ShapeColor||"object"==o&&(this.ShapeColor.Color.effectValue!==this._state.ShapeColor.effectValue||this._state.ShapeColor.color.indexOf(this.ShapeColor.Color.color)<0)||"object"!=o&&this._state.ShapeColor.indexOf(this.ShapeColor.Color)<0){if(this.btnBackColor.setColor(this.ShapeColor.Color),"object"==typeof this.ShapeColor.Color){for(var p=!1,m=0;m<10;m++)if(Common.Utils.ThemeColor.ThemeValues[m]==this.ShapeColor.Color.effectValue){this.colorsBack.select(this.ShapeColor.Color,!0),p=!0;break}p||this.colorsBack.clearSelection()}else this.colorsBack.select(this.ShapeColor.Color,!0);this._state.ShapeColor=this.ShapeColor.Color}var u,g,b,a=t.asc_getLine(),i=a?a.asc_getType():null,C="transparent"==this._state.StrokeColor&&"transparent"!==this.BorderColor.Color;if(a?(b=a.asc_getTransparent(),(.001<Math.abs(this._state.LineTransparency-b)||.001<Math.abs(this.numLineTransparency.getNumberValue()-b)||!(null!==this._state.LineTransparency&&null!==b||this._state.LineTransparency===b&&this.numLineTransparency.getNumberValue()===b))&&(void 0!==b&&(this.sldrLineTransparency.setValue(null===b?100:b/255*100,!0),this.numLineTransparency.setValue(this.sldrLineTransparency.getValue(),!0)),this._state.LineTransparency=b),i==Asc.c_oAscStrokeType.STROKE_COLOR&&(s=a.asc_getColor())?s.asc_getType()==Asc.c_oAscColor.COLOR_TYPE_SCHEME?this.BorderColor={Value:1,Color:{color:Common.Utils.ThemeColor.getHexColor(s.asc_getR(),s.asc_getG(),s.asc_getB()),effectValue:s.asc_getValue()}}:this.BorderColor={Value:1,Color:Common.Utils.ThemeColor.getHexColor(s.asc_getR(),s.asc_getG(),s.asc_getB())}:this.BorderColor={Value:1,Color:"transparent"},u=a.asc_getPrstDash()):this.BorderColor={Value:0,Color:"transparent"},o=typeof this.BorderColor.Color,b=typeof this._state.StrokeColor,C||o!=b||"object"==o&&(this.BorderColor.Color.effectValue!==this._state.StrokeColor.effectValue||this._state.StrokeColor.color.indexOf(this.BorderColor.Color.color)<0)||"object"!=o&&(this._state.StrokeColor.indexOf(this.BorderColor.Color)<0||"object"==typeof this.btnBorderColor.color)){if(this.btnBorderColor.setColor(this.BorderColor.Color),"object"==typeof this.BorderColor.Color){for(p=!1,m=0;m<10;m++)if(Common.Utils.ThemeColor.ThemeValues[m]==this.BorderColor.Color.effectValue){this.colorsBorder.select(this.BorderColor.Color,!0),p=!0;break}p||this.colorsBorder.clearSelection()}else this.colorsBorder.select(this.BorderColor.Color,!0);this._state.StrokeColor=this.BorderColor.Color}if(this._state.StrokeType===i&&i!=Asc.c_oAscStrokeType.STROKE_COLOR||(i==Asc.c_oAscStrokeType.STROKE_COLOR?(g=a.asc_getWidth(),C=Math.abs(this._state.StrokeWidth-g)<1e-5&&!new RegExp(this.txtPt+"\\s*$").test(this.cmbBorderSize.getRawValue()),(1e-5<Math.abs(this._state.StrokeWidth-g)||C||(null===this._state.StrokeWidth||null===g)&&this._state.StrokeWidth!==g)&&((b=null===(g=null!==(this._state.StrokeWidth=g)?this._mm2pt(g):g)?g:S.find(this.cmbBorderSize.store.models,function(t){if(g<t.attributes.value+1e-4&&g>t.attributes.value-1e-4)return!0}))?this.cmbBorderSize.selectRecord(b):this.cmbBorderSize.setValue(null!==g?parseFloat(g.toFixed(2))+" "+this.txtPt:""),this.BorderSize=g)):i==Asc.c_oAscStrokeType.STROKE_NONE?(this._state.StrokeWidth=0,this.BorderSize=this.cmbBorderSize.store.at(0).get("value"),this.cmbBorderSize.setValue(this.BorderSize)):(this._state.StrokeWidth=null,this.BorderSize=-1,this.cmbBorderSize.setValue(null)),this._state.StrokeType=i),this._state.StrokeBorderType!==u&&(this.BorderType=this._state.StrokeBorderType=u,this.cmbBorderType.setValue(u)),(o=typeof this.FGColor.Color)!=typeof this._state.FGColor||"object"==o&&(this.FGColor.Color.effectValue!==this._state.FGColor.effectValue||this._state.FGColor.color.indexOf(this.FGColor.Color.color)<0)||"object"!=o&&this._state.FGColor.indexOf(this.FGColor.Color)<0){if(this.btnFGColor.setColor(this.FGColor.Color),"object"==typeof this.FGColor.Color){for(p=!1,m=0;m<10;m++)if(Common.Utils.ThemeColor.ThemeValues[m]==this.FGColor.Color.effectValue){this.colorsFG.select(this.FGColor.Color,!0),p=!0;break}p||this.colorsFG.clearSelection()}else this.colorsFG.select(this.FGColor.Color,!0);this._state.FGColor=this.FGColor.Color}if((o=typeof this.BGColor.Color)!=typeof this._state.BGColor||"object"==o&&(this.BGColor.Color.effectValue!==this._state.BGColor.effectValue||this._state.BGColor.color.indexOf(this.BGColor.Color.color)<0)||"object"!=o&&this._state.BGColor.indexOf(this.BGColor.Color)<0){if(this.btnBGColor.setColor(this.BGColor.Color),"object"==typeof this.BGColor.Color){for(p=!1,m=0;m<10;m++)if(Common.Utils.ThemeColor.ThemeValues[m]==this.BGColor.Color.effectValue){this.colorsBG.select(this.BGColor.Color,!0),p=!0;break}p||this.colorsBG.clearSelection()}else this.colorsBG.select(this.BGColor.Color,!0);this._state.BGColor=this.BGColor.Color}if((o=typeof(s=this.GradColor.colors[this.GradColor.currentIdx]))!=typeof this._state.GradColor||"object"==o&&(s.effectValue!==this._state.GradColor.effectValue||this._state.GradColor.color.indexOf(s.color)<0)||"object"!=o&&this._state.GradColor.indexOf(s)<0){if(this.btnGradColor.setColor(s),"object"==typeof s){for(p=!1,m=0;m<10;m++)if(Common.Utils.ThemeColor.ThemeValues[m]==s.effectValue){this.colorsGrad.select(s,!0),p=!0;break}p||this.colorsGrad.clearSelection()}else this.colorsGrad.select(s,!0);this._state.GradColor=s}a=t.asc_getForm();this._state.FormId!==a&&(this.cmbTransform.suspendEvents(),e=this.cmbTransform.menuPicker.store.findWhere({type:a}),this.cmbTransform.menuPicker.selectRecord(e),this.cmbTransform.resumeEvents(),this._state.FormId=a),this._noApply=!1}},btnDirectionRedraw:function(t,e){this.gradientColorsStr=e,S.each(this._viewDataLinear,function(t){t.gradientColorsStr=e}),this._viewDataRadial.gradientColorsStr=this.gradientColorsStr,this.mnuDirectionPicker.store.each(function(t){t.set("gradientColorsStr",e)},this),-1==this.typeGradient?this.btnDirection.$icon.css({background:"none"}):2==this.typeGradient?this.btnDirection.$icon.css({background:"radial-gradient("+e+")"}):this.btnDirection.$icon.css({background:"linear-gradient("+this.typeGradient+"deg, "+e+")"})},createDelayedControls:function(){var o=this;this._arrFillSrc=[{displayValue:this.textNoFill,value:Asc.c_oAscFill.FILL_TYPE_NOFILL},{displayValue:this.textColor,value:Asc.c_oAscFill.FILL_TYPE_SOLID},{displayValue:this.textGradientFill,value:Asc.c_oAscFill.FILL_TYPE_GRAD},{displayValue:this.textImageTexture,value:Asc.c_oAscFill.FILL_TYPE_BLIP},{displayValue:this.textPatternFill,value:Asc.c_oAscFill.FILL_TYPE_PATT}],this.cmbFillSrc=new Common.UI.ComboBox({el:f("#textart-combo-fill-src"),cls:"input-group-nr",style:"width: 100%;",menuStyle:"min-width: 100%;",editable:!1,data:this._arrFillSrc,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbFillSrc.setValue(this._arrFillSrc[0].value),this.cmbFillSrc.on("selected",S.bind(this.onFillSrcSelect,this)),this.lockedControls.push(this.cmbFillSrc);this.cmbPattern=new Common.UI.ComboDataView({itemWidth:28,itemHeight:28,menuMaxHeight:300,enableKeyEvents:!0,cls:"combo-pattern",dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big",itemTemplate:S.template(['<div class="style" id="<%= id %>">','<img src="data:image/gif;base64,R0lGODlhAQABAID/AMDAwAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" class="combo-pattern-item" ','width="28" height="28" ','style="background-position: -<%= offsetx %>px -<%= offsety %>px;"/>',"</div>"].join(""))}),this.cmbPattern.render(f("#textart-combo-pattern")),this.cmbPattern.openButton.menu.cmpEl.css({"min-width":178,"max-width":178}),this.cmbPattern.on("click",S.bind(this.onPatternSelect,this)),this.cmbPattern.openButton.menu.on("show:after",function(){o.cmbPattern.menuPicker.scroller.update({alwaysVisibleY:!0})}),this.lockedControls.push(this.cmbPattern),this.btnInsertFromFile=new Common.UI.Button({el:f("#textart-button-from-file")}),this.lockedControls.push(this.btnInsertFromFile),this.btnInsertFromUrl=new Common.UI.Button({el:f("#textart-button-from-url")}),this.lockedControls.push(this.btnInsertFromUrl),this.btnInsertFromFile.on("click",S.bind(function(t){this.api&&this.api.asc_changeArtImageFromFile(this.BlipFillType),Common.NotificationCenter.trigger("edit:complete",this)},this)),this.btnInsertFromUrl.on("click",S.bind(this.insertFromUrl,this)),this._arrFillType=[{displayValue:this.textStretch,value:Asc.c_oAscFillBlipType.STRETCH},{displayValue:this.textTile,value:Asc.c_oAscFillBlipType.TILE}],this.cmbFillType=new Common.UI.ComboBox({el:f("#textart-combo-fill-type"),cls:"input-group-nr",menuStyle:"min-width: 90px;",editable:!1,data:this._arrFillType,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbFillType.setValue(this._arrFillType[0].value),this.cmbFillType.on("selected",S.bind(this.onFillTypeSelect,this)),this.lockedControls.push(this.cmbFillType),this.numTransparency=new Common.UI.MetricSpinner({el:f("#textart-spin-transparency"),step:1,width:62,value:"100 %",defaultUnit:"%",maxValue:100,minValue:0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.numTransparency.on("change",S.bind(this.onNumTransparencyChange,this)),this.numTransparency.on("inputleave",function(){Common.NotificationCenter.trigger("edit:complete",o)}),this.lockedControls.push(this.numTransparency),this.sldrTransparency=new Common.UI.SingleSlider({el:f("#textart-slider-transparency"),width:75,minValue:0,maxValue:100,value:100}),this.sldrTransparency.on("change",S.bind(this.onTransparencyChange,this)),this.sldrTransparency.on("changecomplete",S.bind(this.onTransparencyChangeComplete,this)),this.lockedControls.push(this.sldrTransparency),this.lblTransparencyStart=f(this.el).find("#textart-lbl-transparency-start"),this.lblTransparencyEnd=f(this.el).find("#textart-lbl-transparency-end"),this._arrGradType=[{displayValue:this.textLinear,value:Asc.c_oAscFillGradType.GRAD_LINEAR},{displayValue:this.textRadial,value:Asc.c_oAscFillGradType.GRAD_PATH}],this.cmbGradType=new Common.UI.ComboBox({el:f("#textart-combo-grad-type"),cls:"input-group-nr",menuStyle:"min-width: 100%;",editable:!1,data:this._arrGradType,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbGradType.setValue(this._arrGradType[0].value),this.cmbGradType.on("selected",S.bind(this.onGradTypeSelect,this)),this.lockedControls.push(this.cmbGradType),this._viewDataLinear=[{type:45,subtype:-1},{type:90,subtype:4},{type:135,subtype:5},{type:0,subtype:6,cls:"item-gradient-separator",selected:!0},{type:180,subtype:1},{type:315,subtype:2},{type:270,subtype:3},{type:225,subtype:7}],S.each(this._viewDataLinear,function(t){t.gradientColorsStr=o.gradientColorsStr}),this._viewDataRadial=[{type:2,subtype:5,gradientColorsStr:this.gradientColorsStr}],this.btnDirection=new Common.UI.Button({cls:"btn-large-dataview",scaling:!1,iconCls:"item-gradient gradient-left",menu:new Common.UI.Menu({style:"min-width: 60px;",menuAlign:"tr-br",items:[{template:S.template('<div id="id-textart-menu-direction" style="width: 175px; margin: 0 5px;"></div>')}]}),dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.btnDirection.on("render:after",function(t){o.mnuDirectionPicker=new Common.UI.DataView({el:f("#id-textart-menu-direction"),parentMenu:t.menu,restoreHeight:174,store:new Common.UI.DataViewStore(o._viewDataLinear),itemTemplate:S.template('<div id="<%= id %>" class="item-gradient" style="background: <% if(type!=2) {%>linear-gradient(<%= type + 90 %>deg,<%= gradientColorsStr %>) <%} else {%> radial-gradient(<%= gradientColorsStr %>) <%}%>;"></div>')})}),this.btnDirection.render(f("#textart-button-direction")),this.mnuDirectionPicker.on("item:click",S.bind(this.onSelectGradient,this,this.btnDirection)),this.lockedControls.push(this.btnDirection),this.sldrGradient=new Common.UI.MultiSliderGradient({el:f("#textart-slider-gradient"),width:192,minValue:0,maxValue:100,values:[0,100]}),this.sldrGradient.on("change",S.bind(this.onGradientChange,this)),this.sldrGradient.on("changecomplete",S.bind(this.onGradientChangeComplete,this)),this.sldrGradient.on("thumbclick",function(t,e){o.GradColor.currentIdx=e;e=o.GradColor.colors[o.GradColor.currentIdx],o.btnGradColor.setColor(e),o.colorsGrad.select(e,!1),e=o.GradColor.values[o.GradColor.currentIdx];o.spnGradPosition.setValue(Common.UI.isRTL()?o.sldrGradient.maxValue-e:e,!0)}),this.sldrGradient.on("thumbdblclick",function(t){o.btnGradColor.cmpEl.find("button").dropdown("toggle")}),this.sldrGradient.on("sortthumbs",function(t,e){var i,s=[];S.each(e,function(t,e){s.push(o.GradColor.colors[t]),o.GradColor.currentIdx==t&&(i=e)}),o.OriginalFillType=null,o.GradColor.colors=s,o.GradColor.currentIdx=i}),this.sldrGradient.on("addthumb",function(t,e,i){o.GradColor.colors[e]=o.GradColor.colors[o.GradColor.currentIdx],o.GradColor.currentIdx=e;e=o.sldrGradient.addNewThumb(e,i);o.GradColor.colors[o.GradColor.currentIdx]=e}),this.sldrGradient.on("removethumb",function(t,e){o.sldrGradient.removeThumb(e),o.GradColor.values.splice(e,1),o.sldrGradient.changeGradientStyle(),(S.isUndefined(o.GradColor.currentIdx)||o.GradColor.currentIdx>=o.GradColor.colors.length)&&(e=0===(e=0<e?e-1:e)&&2<o.GradColor.values.length?o.GradColor.values.length-2:e,o.GradColor.currentIdx=e),o.sldrGradient.setActiveThumb(o.GradColor.currentIdx)}),this.lockedControls.push(this.sldrGradient),this.spnGradPosition=new Common.UI.MetricSpinner({el:f("#textart-gradient-position"),step:1,width:60,defaultUnit:"%",value:"50 %",allowDecimal:!1,maxValue:100,minValue:0,disabled:this._locked,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.lockedControls.push(this.spnGradPosition),this.spnGradPosition.on("change",S.bind(this.onPositionChange,this)),this.spnGradPosition.on("inputleave",function(){Common.NotificationCenter.trigger("edit:complete",o)}),this.btnAddGradientStep=new Common.UI.Button({parentEl:f("#textart-gradient-add-step"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-add-breakpoint",disabled:this._locked,hint:this.tipAddGradientPoint,dataHint:"1",dataHintDirection:"bottom"}),this.btnAddGradientStep.on("click",S.bind(this.onAddGradientStep,this)),this.lockedControls.push(this.btnAddGradientStep),this.btnRemoveGradientStep=new Common.UI.Button({parentEl:f("#textart-gradient-remove-step"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-remove-breakpoint",disabled:this._locked,hint:this.tipRemoveGradientPoint,dataHint:"1",dataHintDirection:"bottom"}),this.btnRemoveGradientStep.on("click",S.bind(this.onRemoveGradientStep,this)),this.lockedControls.push(this.btnRemoveGradientStep),this.numGradientAngle=new Common.UI.MetricSpinner({el:f("#textart-spin-gradient-angle"),step:10,width:60,defaultUnit:"°",value:"0 °",allowDecimal:!0,maxValue:359.9,minValue:0,disabled:this._locked,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.lockedControls.push(this.numGradientAngle),this.numGradientAngle.on("change",S.bind(this.onGradientAngleChange,this)),this.numGradientAngle.on("inputleave",function(){Common.NotificationCenter.trigger("edit:complete",o)}),this.cmbBorderSize=new Common.UI.ComboBorderSizeEditable({el:f("#textart-combo-border-size"),style:"width: 93px;",txtNoBorders:this.txtNoBorders,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}).on("selected",S.bind(this.onBorderSizeSelect,this)).on("changed:before",S.bind(this.onBorderSizeChanged,this,!0)).on("changed:after",S.bind(this.onBorderSizeChanged,this,!1)).on("combo:blur",S.bind(this.onComboBlur,this,!1)),this.BorderSize=this.cmbBorderSize.store.at(2).get("value"),this.cmbBorderSize.setValue(this.BorderSize),this.lockedControls.push(this.cmbBorderSize),this.cmbBorderType=new Common.UI.ComboBorderType({el:f("#textart-combo-border-type"),style:"width: 93px;",menuStyle:"min-width: 93px;",dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}).on("selected",S.bind(this.onBorderTypeSelect,this)).on("combo:blur",S.bind(this.onComboBlur,this,!1)),this.BorderType=Asc.c_oDashType.solid,this.cmbBorderType.setValue(this.BorderType),this.lockedControls.push(this.cmbBorderType),this.numLineTransparency=new Common.UI.MetricSpinner({el:f("#textart-line-spin-transparency"),step:1,width:62,value:"100 %",defaultUnit:"%",maxValue:100,minValue:0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.numLineTransparency.on("change",S.bind(this.onNumLineTransparencyChange,this)),this.numLineTransparency.on("inputleave",function(){Common.NotificationCenter.trigger("edit:complete",o)}),this.lockedControls.push(this.numLineTransparency),this.sldrLineTransparency=new Common.UI.SingleSlider({el:f("#textart-line-slider-transparency"),width:75,minValue:0,maxValue:100,value:100}),this.sldrLineTransparency.on("change",S.bind(this.onLineTransparencyChange,this)),this.sldrLineTransparency.on("changecomplete",S.bind(this.onLineTransparencyChangeComplete,this)),this.lockedControls.push(this.sldrLineTransparency),this.lblLineTransparencyStart=f(this.el).find("#textart-line-lbl-transparency-start"),this.lblLineTransparencyEnd=f(this.el).find("#textart-line-lbl-transparency-end"),this.cmbTransform=new Common.UI.ComboDataView({itemWidth:50,itemHeight:50,menuMaxHeight:300,enableKeyEvents:!0,cls:"combo-textart",dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbTransform.render(f("#textart-combo-transform")),this.cmbTransform.openButton.menu.cmpEl.css({"min-width":178,"max-width":178}),this.cmbTransform.on("click",S.bind(this.onTransformSelect,this)),this.cmbTransform.openButton.menu.on("show:after",function(){o.cmbTransform.menuPicker.scroller.update({alwaysVisibleY:!0})}),this.lockedControls.push(this.cmbTransform)},createDelayedElements:function(){this._initSettings=!1,this.createDelayedControls();var t=[0,1,3,2,4,53,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,22,23,24,25,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,49,50,51,52];this.patternViewData=[];for(var e=0;e<13;e++)for(var i=0;i<4;i++){var s=4*e+i;this.patternViewData[s]={offsetx:28*i,offsety:28*e,type:t[s]}}this.patternViewData.splice(this.patternViewData.length-2,2);for(e=0;e<this.patternViewData.length;e++)this.patternViewData[e].id=Common.UI.getId();this.cmbPattern.menuPicker.store.add(this.patternViewData),0<this.cmbPattern.menuPicker.store.length&&(this.cmbPattern.fillComboView(this.cmbPattern.menuPicker.store.at(0),!0),this.PatternFillType=this.patternViewData[0].type),this.UpdateThemeColors(),this.onInitStandartTextures(),this.fillTextArt(),this.fillTransform(this.api.asc_getPropertyEditorTextArts())},onInitStandartTextures:function(t){var e,i=this;t&&0<t.length&&(i._texturearray=[],S.each(t,function(t){i._texturearray.push({imageUrl:t.get_image(),name:i.textureNames[t.get_id()],type:t.get_id(),selected:!1})})),!i._texturearray||i._texturearray.length<1||this._initSettings||this.btnTexture||(this.btnTexture=new Common.UI.ComboBox({el:f("#textart-combo-fill-texture"),template:S.template(['<div class="input-group combobox combo-dataview-menu input-group-nr dropdown-toggle" tabindex="0" data-toggle="dropdown">','<div class="form-control text" style="width: 90px;" data-hint="1" data-hint-direction="bottom" data-hint-offset="big">'+this.textSelectTexture+"</div>",'<div style="display: table-cell;"></div>','<button type="button" class="btn btn-default">','<span class="caret" />',"</button>","</div>"].join(""))}),this.textureMenu=new Common.UI.Menu({items:[{template:S.template('<div id="id-textart-menu-texture" style="width: 233px; margin: 0 5px;"></div>')}]}),this.textureMenu.render(f("#textart-combo-fill-texture")),this.lockedControls.push(this.btnTexture),e=function(t){new Common.UI.DataView({el:f("#id-textart-menu-texture"),restoreHeight:174,parentMenu:t,showLast:!1,store:new Common.UI.DataViewStore(i._texturearray||[]),itemTemplate:S.template('<div><img src="<%= imageUrl %>" id="<%= id %>"></div>')}).on("item:click",S.bind(i.onSelectTexture,i)),t.off("show:before",e)},this.textureMenu.on("show:before",e))},onSelectTexture:function(t,e,i){var s,o;this._fromTextureCmb=!0,this.cmbFillType.setValue(this._arrFillType[1].value),this._fromTextureCmb=!1,this.api&&(s=new Asc.asc_TextArtProperties,(o=new Asc.asc_CShapeFill).asc_putType(Asc.c_oAscFill.FILL_TYPE_BLIP),o.asc_putFill(new Asc.asc_CFillBlip),o.asc_getFill().asc_putType(Asc.c_oAscFillBlipType.TILE),o.asc_getFill().asc_putTextureId(i.get("type")),s.asc_putFill(o),this.shapeprops.put_TextArtProperties(s),this.api.asc_setGraphicObjectProps(this.imgprops)),f(this.btnTexture.el).find(".form-control").prop("innerHTML",i.get("name")),Common.NotificationCenter.trigger("edit:complete",this)},fillTextArt:function(){var t,e,i,s;this._initSettings||((t=this).cmbTextArt||(this.cmbTextArt=new Common.UI.ComboDataView({itemWidth:50,itemHeight:50,menuMaxHeight:300,enableKeyEvents:!0,showLast:!1,cls:"combo-textart",dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbTextArt.render(f("#textart-combo-template")),this.cmbTextArt.openButton.menu.cmpEl.css({"min-width":178,"max-width":178}),this.cmbTextArt.on("click",S.bind(this.onTextArtSelect,this)),this.cmbTextArt.openButton.menu.on("show:after",function(){t.cmbTextArt.menuPicker.scroller.update({alwaysVisibleY:!0})}),this.lockedControls.push(this.cmbTextArt)),e=this.application.getCollection("Common.Collections.TextArt").models,i=this.cmbTextArt.menuPicker.store.length,e.length<1?SSE.getController("Main").fillTextArt(this.api.asc_getTextArtPreviews()):0<i&&i==e.length?(s=this.cmbTextArt.menuPicker.store.models,S.each(e,function(t,e){s[e].set("imageUrl",t.get("imageUrl"))})):(this.cmbTextArt.menuPicker.store.reset(e),0<this.cmbTextArt.menuPicker.store.length&&this.cmbTextArt.fillComboView(this.cmbTextArt.menuPicker.store.at(0))))},onTextArtSelect:function(t,e){var i;this.api&&!this._noApply&&((i=new Asc.asc_TextArtProperties).asc_putStyle(e.get("data")),this.shapeprops.put_TextArtProperties(i),this.api.asc_setGraphicObjectProps(this.imgprops)),Common.NotificationCenter.trigger("edit:complete",this)},fillTransform:function(t){if(t){for(var e=[],i=0;i<t.length;i++){var s=t[i];e.push({imageUrl:s.Image,type:s.Type,selected:!1})}this.cmbTransform.menuPicker.store.reset(e),0<this.cmbTransform.menuPicker.store.length&&this.cmbTransform.fillComboView(this.cmbTransform.menuPicker.store.at(0),!0)}},onTransformSelect:function(t,e){var i;this.api&&!this._noApply&&((i=new Asc.asc_TextArtProperties).asc_putForm(e.get("type")),this.shapeprops.put_TextArtProperties(i),this.api.asc_setGraphicObjectProps(this.imgprops)),Common.NotificationCenter.trigger("edit:complete",this)},UpdateThemeColors:function(){this._initSettings||(this.btnBackColor||(this.btnBorderColor=new Common.UI.ColorButton({parentEl:f("#textart-border-color-btn"),color:"000000",eyeDropper:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.lockedControls.push(this.btnBorderColor),this.colorsBorder=this.btnBorderColor.getPicker(),this.btnBorderColor.on("color:select",S.bind(this.onColorsBorderSelect,this)),this.btnBorderColor.on("eyedropper:start",S.bind(this.onEyedropperStart,this)),this.btnBorderColor.on("eyedropper:end",S.bind(this.onEyedropperEnd,this)),this.btnBackColor=new Common.UI.ColorButton({parentEl:f("#textart-back-color-btn"),transparent:!0,color:"transparent",eyeDropper:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"medium"}),this.lockedControls.push(this.btnBackColor),this.colorsBack=this.btnBackColor.getPicker(),this.btnBackColor.on("color:select",S.bind(this.onColorsBackSelect,this)),this.btnBackColor.on("eyedropper:start",S.bind(this.onEyedropperStart,this)),this.btnBackColor.on("eyedropper:end",S.bind(this.onEyedropperEnd,this)),this.btnFGColor=new Common.UI.ColorButton({parentEl:f("#textart-foreground-color-btn"),color:"000000",eyeDropper:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.lockedControls.push(this.btnFGColor),this.colorsFG=this.btnFGColor.getPicker(),this.btnFGColor.on("color:select",S.bind(this.onColorsFGSelect,this)),this.btnFGColor.on("eyedropper:start",S.bind(this.onEyedropperStart,this)),this.btnFGColor.on("eyedropper:end",S.bind(this.onEyedropperEnd,this)),this.btnBGColor=new Common.UI.ColorButton({parentEl:f("#textart-background-color-btn"),color:"ffffff",eyeDropper:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.lockedControls.push(this.btnBGColor),this.colorsBG=this.btnBGColor.getPicker(),this.btnBGColor.on("color:select",S.bind(this.onColorsBGSelect,this)),this.btnBGColor.on("eyedropper:start",S.bind(this.onEyedropperStart,this)),this.btnBGColor.on("eyedropper:end",S.bind(this.onEyedropperEnd,this)),this.btnGradColor=new Common.UI.ColorButton({parentEl:f("#textart-gradient-color-btn"),color:"000000",eyeDropper:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.lockedControls.push(this.btnGradColor),this.colorsGrad=this.btnGradColor.getPicker(),this.btnGradColor.on("color:select",S.bind(this.onColorsGradientSelect,this)),this.btnGradColor.on("eyedropper:start",S.bind(this.onEyedropperStart,this)),this.btnGradColor.on("eyedropper:end",S.bind(this.onEyedropperEnd,this))),this.colorsBorder.updateColors(Common.Utils.ThemeColor.getEffectColors(),Common.Utils.ThemeColor.getStandartColors()),this.colorsBack.updateColors(Common.Utils.ThemeColor.getEffectColors(),Common.Utils.ThemeColor.getStandartColors()),this.colorsFG.updateColors(Common.Utils.ThemeColor.getEffectColors(),Common.Utils.ThemeColor.getStandartColors()),this.colorsBG.updateColors(Common.Utils.ThemeColor.getEffectColors(),Common.Utils.ThemeColor.getStandartColors()),this.colorsGrad.updateColors(Common.Utils.ThemeColor.getEffectColors(),Common.Utils.ThemeColor.getStandartColors()))},_pt2mm:function(t){return 25.4*t/72},_mm2pt:function(t){return 72*t/25.4},ShowHideElem:function(t){this.FillColorContainer.toggleClass("settings-hidden",t!==Asc.c_oAscFill.FILL_TYPE_SOLID),this.FillImageContainer.toggleClass("settings-hidden",t!==Asc.c_oAscFill.FILL_TYPE_BLIP),this.FillPatternContainer.toggleClass("settings-hidden",t!==Asc.c_oAscFill.FILL_TYPE_PATT),this.FillGradientContainer.toggleClass("settings-hidden",t!==Asc.c_oAscFill.FILL_TYPE_GRAD),this.TransparencyContainer.toggleClass("settings-hidden",t===Asc.c_oAscFill.FILL_TYPE_NOFILL||null===t)},setLocked:function(t){this._locked=t},disableControls:function(e){this._initSettings||this._state.DisabledControls!==e&&(this._state.DisabledControls=e,S.each(this.lockedControls,function(t){t.setDisabled(e)}),this.numGradientAngle.setDisabled(e||this.GradFillType!==Asc.c_oAscFillGradType.GRAD_LINEAR),this.lblLineTransparencyStart.toggleClass("disabled",e),this.lblLineTransparencyEnd.toggleClass("disabled",e))},onPositionChange:function(t){var e,t=t.getNumberValue(),i=(Common.UI.isRTL()&&(t=this.sldrGradient.maxValue-t),this.GradColor.currentIdx-1<0?0:this.GradColor.values[this.GradColor.currentIdx-1]),s=this.GradColor.currentIdx+1<this.GradColor.values.length?this.GradColor.values[this.GradColor.currentIdx+1]:100,i=t<i||s<t;this.api&&(this.GradColor.values[this.GradColor.currentIdx]=t,s=new Asc.asc_TextArtProperties,(t=new Asc.asc_CShapeFill).asc_putType(Asc.c_oAscFill.FILL_TYPE_GRAD),t.asc_putFill(new Asc.asc_CFillGrad),t.asc_getFill().asc_putGradType(this.GradFillType),e=[],this.GradColor.values.forEach(function(t){e.push(1e3*t)}),t.asc_getFill().asc_putPositions(e),s.asc_putFill(t),this.shapeprops.put_TextArtProperties(s),this.api.asc_setGraphicObjectProps(this.imgprops),i&&(this.sldrGradient.sortThumbs(),this.sldrGradient.trigger("change",this.sldrGradient),this.sldrGradient.trigger("changecomplete",this.sldrGradient)))},onAddGradientStep:function(){var t,e;9<this.GradColor.colors.length||(t=this.GradColor.currentIdx,e=(this.GradColor.values[t]+this.GradColor.values[t<this.GradColor.colors.length-1?t+1:t-1])/2,this.GradColor.colors[this.GradColor.colors.length]=this.GradColor.colors[t],this.GradColor.currentIdx=this.GradColor.colors.length-1,e=this.sldrGradient.addNewThumb(void 0,e,t),this.GradColor.colors[this.GradColor.currentIdx]=e,this.sldrGradient.trigger("change",this.sldrGradient),this.sldrGradient.trigger("changecomplete",this.sldrGradient))},onRemoveGradientStep:function(){var t;this.GradColor.values.length<3||(t=this.GradColor.currentIdx,this.GradColor.values.splice(this.GradColor.currentIdx,1),this.sldrGradient.removeThumb(this.GradColor.currentIdx),(S.isUndefined(this.GradColor.currentIdx)||this.GradColor.currentIdx>=this.GradColor.colors.length)&&(t=0===(t=0<t?t-1:t)&&2<this.GradColor.values.length?this.GradColor.values.length-2:t,this.GradColor.currentIdx=t),this.sldrGradient.setActiveThumb(this.GradColor.currentIdx),this.sldrGradient.trigger("change",this.sldrGradient),this.sldrGradient.trigger("changecomplete",this.sldrGradient))},onGradientAngleChange:function(t,e,i,s){var o,n;this.api&&!this._noApply&&(o=new Asc.asc_TextArtProperties,(n=new Asc.asc_CShapeFill).asc_putType(Asc.c_oAscFill.FILL_TYPE_GRAD),n.asc_putFill(new Asc.asc_CFillGrad),n.asc_getFill().asc_putGradType(this.GradFillType),n.asc_getFill().asc_putLinearAngle(6e4*t.getNumberValue()),n.asc_getFill().asc_putLinearScale(!0),o.asc_putFill(n),this.shapeprops.put_TextArtProperties(o),this.api.asc_setGraphicObjectProps(this.imgprops))},onWindowResize:function(){this._initSettings||this._state.applicationPixelRatio===Common.Utils.applicationPixelRatio()||this.fillTransform(this.api.asc_getPropertyEditorTextArts()),this._state.applicationPixelRatio=Common.Utils.applicationPixelRatio()},hideTransformSettings:function(t){this._state.HideTransformSettings!==t&&(this._state.HideTransformSettings=t,this.TransformSettings.toggleClass("hidden",!0===t))},onEyedropperStart:function(t){this.api.asc_startEyedropper(S.bind(t.eyedropperEnd,t)),this.fireEvent("eyedropper",!0)},onEyedropperEnd:function(){this.fireEvent("eyedropper",!1)}},SSE.Views.TextArtSettings||{}))}),define("text!spreadsheeteditor/main/app/template/TableSettings.template",[],function(){return'<table cols="2">\n    <tr>\n        <td width="50%">\n            <label class="header"><%= scope.textRows %></label>\n        </td>\n        <td width="50%">\n            <label class="header"><%= scope.textColumns %></label>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <div id="table-checkbox-header"></div>\n        </td>\n        <td class="padding-small">\n            <div id="table-checkbox-first"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <div id="table-checkbox-total"></div>\n        </td>\n        <td class="padding-small">\n            <div id="table-checkbox-last"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <div id="table-checkbox-banded"></div>\n        </td>\n        <td class="padding-small">\n            <div id="table-checkbox-col-banded"></div>\n        </td>\n    </tr>\n    <tr>\n        <td colspan=2 class="padding-small">\n            <div id="table-checkbox-filter"></div>\n        </td>\n    </tr>\n    <tr>\n        <td colspan=2>\n            <label class="header"><%= scope.textTemplate %></label>\n        </td>\n    </tr>\n    <tr>\n        <td colspan=2 class="padding-small">\n            <div class="" id="table-btn-template" style="width: 100%; height: 52px;"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" colspan=2>\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr class="hidden">\n        <td colspan=2>\n            <label class="header"><%= scope.textTableName %></label>\n        </td>\n    </tr>\n    <tr class="hidden">\n        <td colspan=2 class="padding-small">\n            <div id="table-txt-name" class="input-row"  style="width: 100%;"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" colspan=2>\n            <div id="table-btn-select-data" style="width:100%;"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" colspan=2>\n            <div id="table-btn-edit" style="width:100%;"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" colspan=2>\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n</table>\n<table cols="2">\n    <tr>\n        <td class="padding-small" colspan=2>\n            <label class="header"><%= scope.textActions %></label>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" colspan=2>\n            <div id="table-btn-rem-duplicates" style="width:100%;"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" colspan=2>\n            <div id="table-btn-convert-range" style="width:100%;"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" colspan=2>\n            <div id="table-btn-slicer" style="width:100%;"></div>\n        </td>\n    </tr>\n    <tr class="pivot-only">\n        <td class="padding-small" colspan=2>\n            <div id="table-btn-pivot" style="width:100%;"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" colspan=2>\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr>\n        <td align="center" colspan=2>\n            <label class="link" id="table-advanced-link" data-hint="1" data-hint-direction="bottom" data-hint-offset="medium"><%= scope.textAdvanced %></label>\n        </td>\n    </tr>\n    <tr class="finish-cell"></tr>\n</table>'}),define("text!spreadsheeteditor/main/app/template/TableSettingsAdvanced.template",[],function(){return'<div id="id-adv-table-alttext" class="settings-panel active">\n    <div class="inner-content">\n        <table cols="1" width="100%">\n            <tr>\n                <td class="padding-large">\n                    <label class="header"><%= scope.textAltTitle %></label>\n                    <div id="table-advanced-alt-title"></div>\n                </td>\n            </tr>\n            <tr>\n                <td>\n                    <label class="header"><%= scope.textAltDescription %></label>\n                    <textarea id="table-advanced-alt-description" class="form-control" style="width: 100%; height: 70px;"></textarea>\n                </td>\n            </tr>\n            <tr>\n                <td>\n                    <label><%= scope.textAltTip %></label>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>'}),define("spreadsheeteditor/main/app/view/TableSettingsAdvanced",["text!spreadsheeteditor/main/app/template/TableSettingsAdvanced.template","common/main/lib/view/AdvancedSettingsWindow","common/main/lib/component/InputField"],function(e){"use strict";SSE.Views.TableSettingsAdvanced=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:300,height:342,toggleGroup:"table-adv-settings-group",properties:null,storageName:"sse-table-settings-adv-category"},initialize:function(t){_.extend(this.options,{title:this.textTitle,items:[{panelId:"id-adv-table-alttext",panelCaption:this.textAlt}],contentTemplate:_.template(e)({scope:this})},t),Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options),this._originalProps=this.options.tableProps,this._changedProps=null},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var e=this;this.inputAltTitle=new Common.UI.InputField({el:$("#table-advanced-alt-title"),allowBlank:!0,validateOnBlur:!1,style:"width: 100%;"}).on("changed:after",function(){e.isAltTitleChanged=!0}),this.textareaAltDescription=this.$window.find("textarea"),this.textareaAltDescription.keydown(function(t){t.keyCode==Common.UI.Keys.RETURN&&t.stopPropagation(),e.isAltDescChanged=!0}),this.afterRender()},getFocusedComponents:function(){return[this.inputAltTitle,this.textareaAltDescription]},onCategoryClick:function(t,e){Common.Views.AdvancedSettingsWindow.prototype.onCategoryClick.call(this,t,e);var i=this;setTimeout(function(){0===e&&i.inputAltTitle.focus()},10)},afterRender:function(){var t;this._setDefaults(this._originalProps),this.storageName&&(t=Common.localStorage.getItem(this.storageName),this.setActiveCategory(null!==t?parseInt(t):0))},_setDefaults:function(t){var e;t&&(e=t.asc_getTitle(),this.inputAltTitle.setValue(e||""),e=t.asc_getDescription(),this.textareaAltDescription.val(e||""))},getSettings:function(){var t;if(this.isAltTitleChanged||this.isAltDescChanged)return(t=new Asc.AdvancedTableInfoSettings).asc_setTitle(this.inputAltTitle.getValue()),t.asc_setDescription(this.textareaAltDescription.val()),t}},SSE.Views.TableSettingsAdvanced||{}))}),define("spreadsheeteditor/main/app/view/TableSettings",["text!spreadsheeteditor/main/app/template/TableSettings.template","jquery","underscore","backbone","common/main/lib/component/Button","common/main/lib/component/CheckBox","common/main/lib/component/ComboDataView","spreadsheeteditor/main/app/view/TableOptionsDialog","spreadsheeteditor/main/app/view/TableSettingsAdvanced","spreadsheeteditor/main/app/view/SlicerAddDialog"],function(t,l,o,e){"use strict";SSE.Views.TableSettings=e.View.extend(o.extend({el:"#id-table-settings",template:o.template(t),events:{},options:{alias:"TableSettings"},initialize:function(){this._initSettings=!0,this._state={TableName:"",TemplateName:"",Range:"",CheckHeader:!1,CheckTotal:!1,CheckBanded:!1,CheckFirst:!1,CheckLast:!1,CheckColBanded:!1,CheckFilter:!1,DisabledControls:!1,TableNameError:!1},this.lockedControls=[],this._locked=!1,this.wsLock=!1,this.wsProps=[],this.isEditCell=!1,this._originalProps=null,this._noApply=!1,this.render()},onCheckTemplateChange:function(t,e,i,s,o,n){this._state[e]=void 0,this.api&&this.api.asc_changeFormatTableInfo(this._state.TableName,t,"checked"==s),Common.NotificationCenter.trigger("edit:complete",this)},onTableTemplateSelect:function(t,e,i,s){this.api&&!this._noApply&&this.api.asc_changeAutoFilter(this._state.TableName,Asc.c_oAscChangeFilterOptions.style,s.get("name")),Common.NotificationCenter.trigger("edit:complete",this)},onEditClick:function(t,e,i){this.api&&(0<=e.options.idx&&e.options.idx<4?this.api.asc_changeSelectionFormatTable(this._state.TableName,e.value):4<=e.options.idx&&e.options.idx<8?this.api.asc_insertCellsInTable(this._state.TableName,e.value):this.api.asc_deleteCellsInTable(this._state.TableName,e.value)),Common.NotificationCenter.trigger("edit:complete",this)},onTableNameChanged:function(t,e,i){var s=this._state.TableName;if(this._state.TableName="",s.toLowerCase()==e.toLowerCase())Common.NotificationCenter.trigger("edit:complete",this);else{var o=this,n=this.api.asc_checkDefinedName(e,null);if(!0===n.asc_getStatus())n=!0;else switch(n.asc_getReason()){case Asc.c_oAscDefinedNameReason.IsLocked:n=this.textIsLocked;break;case Asc.c_oAscDefinedNameReason.Existed:n=this.textExistName;break;case Asc.c_oAscDefinedNameReason.NameReserved:n=this.textReservedName;break;default:n=this.textInvalidName}!0===n?(this.api.asc_changeDisplayNameTable(s,e),Common.NotificationCenter.trigger("edit:complete",this)):this._state.TableNameError||(this._state.TableNameError=!0,Common.UI.alert({msg:n,title:this.notcriticalErrorTitle,iconCls:"warn",buttons:["ok"],callback:function(t){Common.NotificationCenter.trigger("edit:complete",this),o._state.TableNameError=!1}}))}},render:function(){l(this.el).html(this.template({scope:this})),this.linkAdvanced=l("#table-advanced-link")},setApi:function(t){return(this.api=t)&&(this.api.asc_registerCallback("asc_onSendThemeColors",o.bind(this.onSendThemeColors,this)),this.api.asc_registerCallback("asc_onEditCell",this.onApiEditCell.bind(this))),this},setMode:function(t){this.mode=t},createDelayedControls:function(){this.chHeader=new Common.UI.CheckBox({el:l("#table-checkbox-header"),labelText:this.textHeader,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.lockedControls.push(this.chHeader),this.chTotal=new Common.UI.CheckBox({el:l("#table-checkbox-total"),labelText:this.textTotal,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.lockedControls.push(this.chTotal),this.chBanded=new Common.UI.CheckBox({el:l("#table-checkbox-banded"),labelText:this.textBanded,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.lockedControls.push(this.chBanded),this.chFirst=new Common.UI.CheckBox({el:l("#table-checkbox-first"),labelText:this.textFirst,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.lockedControls.push(this.chFirst),this.chLast=new Common.UI.CheckBox({el:l("#table-checkbox-last"),labelText:this.textLast,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.lockedControls.push(this.chLast),this.chColBanded=new Common.UI.CheckBox({el:l("#table-checkbox-col-banded"),labelText:this.textColBanded,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.lockedControls.push(this.chColBanded),this.chFilter=new Common.UI.CheckBox({el:l("#table-checkbox-filter"),labelText:this.textFilter,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.lockedControls.push(this.chFilter),this.chHeader.on("change",o.bind(this.onCheckTemplateChange,this,Asc.c_oAscChangeTableStyleInfo.rowHeader,"CheckHeader")),this.chTotal.on("change",o.bind(this.onCheckTemplateChange,this,Asc.c_oAscChangeTableStyleInfo.rowTotal,"CheckTotal")),this.chBanded.on("change",o.bind(this.onCheckTemplateChange,this,Asc.c_oAscChangeTableStyleInfo.rowBanded,"CheckBanded")),this.chFirst.on("change",o.bind(this.onCheckTemplateChange,this,Asc.c_oAscChangeTableStyleInfo.columnFirst,"CheckFirst")),this.chLast.on("change",o.bind(this.onCheckTemplateChange,this,Asc.c_oAscChangeTableStyleInfo.columnLast,"CheckLast")),this.chColBanded.on("change",o.bind(this.onCheckTemplateChange,this,Asc.c_oAscChangeTableStyleInfo.columnBanded,"CheckColBanded")),this.chFilter.on("change",o.bind(this.onCheckTemplateChange,this,Asc.c_oAscChangeTableStyleInfo.filterButton,"CheckFilter")),this.txtTableName=new Common.UI.InputField({el:l("#table-txt-name"),name:"tablename",style:"width: 100%;",validateOnBlur:!1}),this.txtTableName.on("changed:after",o.bind(this.onTableNameChanged,this)),this.lockedControls.push(this.txtTableName),this.btnSelectData=new Common.UI.Button({parentEl:l("#table-btn-select-data"),cls:"btn-toolbar align-left",iconCls:"toolbar__icon btn-resize-table",caption:this.textResize,style:"width: 100%;",dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.btnSelectData.on("click",o.bind(this.onSelectData,this)),this.lockedControls.push(this.btnSelectData),this.btnEdit=new Common.UI.Button({parentEl:l("#table-btn-edit"),cls:"btn-toolbar align-left",iconCls:"toolbar__icon btn-rows-and-columns",caption:this.textEdit,style:"width: 100%;",menu:new Common.UI.Menu({menuAlign:"tr-br",items:[{caption:this.selectRowText,value:Asc.c_oAscChangeSelectionFormatTable.row,idx:0},{caption:this.selectColumnText,value:Asc.c_oAscChangeSelectionFormatTable.column,idx:1},{caption:this.selectDataText,value:Asc.c_oAscChangeSelectionFormatTable.data,idx:2},{caption:this.selectTableText,value:Asc.c_oAscChangeSelectionFormatTable.all,idx:3},{caption:"--"},{caption:this.insertColumnLeftText,value:Asc.c_oAscInsertOptions.InsertTableColLeft,idx:6},{caption:this.insertColumnRightText,value:Asc.c_oAscInsertOptions.InsertTableColRight,idx:7},{caption:this.insertRowAboveText,value:Asc.c_oAscInsertOptions.InsertTableRowAbove,idx:4},{caption:this.insertRowBelowText,value:Asc.c_oAscInsertOptions.InsertTableRowBelow,idx:5},{caption:"--"},{caption:this.deleteRowText,value:Asc.c_oAscDeleteOptions.DeleteRows,idx:8},{caption:this.deleteColumnText,value:Asc.c_oAscDeleteOptions.DeleteColumns,idx:9},{caption:this.deleteTableText,value:Asc.c_oAscDeleteOptions.DeleteTable,idx:10}]}),dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.btnEdit.menu.on("show:after",o.bind(function(t){this.api&&(t.items[5].setDisabled(!this._originalProps.asc_getIsInsertRowAbove()),t.items[6].setDisabled(!this._originalProps.asc_getIsInsertRowBelow()),t.items[7].setDisabled(!this._originalProps.asc_getIsInsertColumnLeft()),t.items[8].setDisabled(!this._originalProps.asc_getIsInsertColumnRight()),t.items[10].setDisabled(!this._originalProps.asc_getIsDeleteRow()),t.items[11].setDisabled(!this._originalProps.asc_getIsDeleteColumn()),t.items[12].setDisabled(!this._originalProps.asc_getIsDeleteTable()))},this)),this.btnEdit.menu.on("item:click",o.bind(this.onEditClick,this)),this.lockedControls.push(this.btnEdit),this.btnConvertRange=new Common.UI.Button({parentEl:l("#table-btn-convert-range"),cls:"btn-toolbar align-left",iconCls:"toolbar__icon btn-convert-to-range",caption:this.textConvertRange,style:"width: 100%;",dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.btnConvertRange.on("click",o.bind(function(t){this.api&&this.api.asc_convertTableToRange(this._state.TableName),Common.NotificationCenter.trigger("edit:complete",this)},this)),this.lockedControls.push(this.btnConvertRange),this.btnRemDuplicates=new Common.UI.Button({parentEl:l("#table-btn-rem-duplicates"),cls:"btn-toolbar align-left",iconCls:"toolbar__icon btn-remove-duplicates",caption:this.textRemDuplicates,style:"width: 100%;",dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.btnRemDuplicates.on("click",o.bind(function(t){Common.NotificationCenter.trigger("data:remduplicates",this)},this)),this.lockedControls.push(this.btnRemDuplicates),this.btnSlicer=new Common.UI.Button({parentEl:l("#table-btn-slicer"),cls:"btn-toolbar align-left",iconCls:"toolbar__icon btn-slicer",caption:this.textSlicer,style:"width: 100%;",dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.btnSlicer.on("click",o.bind(this.onInsertSlicerClick,this)),this.lockedControls.push(this.btnSlicer),this.btnPivot=new Common.UI.Button({parentEl:l("#table-btn-pivot"),cls:"btn-toolbar align-left",iconCls:"toolbar__icon btn-pivot-sum",caption:this.textPivot,style:"width: 100%;",dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.btnPivot.on("click",o.bind(this.onInsertPivotClick,this)),this.lockedControls.push(this.btnPivot),this.$el.find(".pivot-only").toggleClass("hidden",!this.mode.canFeaturePivot),l(this.el).on("click","#table-advanced-link",o.bind(this.openAdvancedSettings,this)),this._initSettings=!1},openAdvancedSettings:function(t){var i;this.linkAdvanced.hasClass("disabled")||(i=this).api&&!this._locked&&new SSE.Views.TableSettingsAdvanced({tableProps:i._originalProps,api:i.api,handler:function(t,e){"ok"==t&&i.api&&e&&i.api.asc_changeFormatTableInfo(i._state.TableName,Asc.c_oAscChangeTableStyleInfo.advancedSettings,e),Common.NotificationCenter.trigger("edit:complete",i)}}).show()},ChangeSettings:function(t,e,i){this._initSettings&&this.createDelayedControls(),this.wsLock=e,this.wsProps=i,this.disableControls(this._locked),t&&(e=(this._originalProps=t).asc_getTableName(),this._state.TableName!==e&&(this.txtTableName.setValue(e),this._state.TableName=e),this._state.Range=t.asc_getTableRange(),i=!1,e=t.asc_getFirstRow(),this._state.CheckHeader!==e&&(this.chHeader.setValue(e,!0),this._state.CheckHeader=e,i=!0),e=t.asc_getLastRow(),this._state.CheckTotal!==e&&(this.chTotal.setValue(e,!0),this._state.CheckTotal=e,i=!0),e=t.asc_getBandHor(),this._state.CheckBanded!==e&&(this.chBanded.setValue(e,!0),this._state.CheckBanded=e,i=!0),e=t.asc_getFirstCol(),this._state.CheckFirst!==e&&(this.chFirst.setValue(e,!0),this._state.CheckFirst=e,i=!0),e=t.asc_getLastCol(),this._state.CheckLast!==e&&(this.chLast.setValue(e,!0),this._state.CheckLast=e,i=!0),e=t.asc_getBandVer(),this._state.CheckColBanded!==e&&(this.chColBanded.setValue(e,!0),this._state.CheckColBanded=e,i=!0),e=t.asc_getFilterButton(),this._state.CheckFilter!==e&&(this.chFilter.setValue(e,!0),this._state.CheckFilter=e),this.chFilter.isDisabled()!==(!this._state.CheckHeader||this._locked||null===e)&&this.chFilter.setDisabled(!this._state.CheckHeader||this._locked||null===e||this.wsLock),!i&&this.mnuTableTemplatePicker||this.onApiInitTableTemplates(this.api.asc_getTablePictures(t)),e=t.asc_getTableStyleName(),this._state.TemplateName===e&&!this._isTemplatesChanged||(i=(i=this.mnuTableTemplatePicker.store.findWhere({name:e}))||this.mnuTableTemplatePicker.store.at(0),this.btnTableTemplate.suspendEvents(),this.mnuTableTemplatePicker.selectRecord(i,!0),this.btnTableTemplate.resumeEvents(),this.$el.find(".icon-template-table").css({"background-image":"url("+i.get("imageUrl")+")",height:"44px",width:"60px","background-position":"center","background-size":"cover"}),this._state.TemplateName=e),this._isTemplatesChanged=!1)},onSendThemeColors:function(){this.btnTableTemplate&&this.onApiInitTableTemplates(this.api.asc_getTablePictures(this._originalProps))},onApiInitTableTemplates:function(t){var s,e,n,a=this,i=(this._isTemplatesChanged=!0,this.btnTableTemplate||(this.btnTableTemplate=new Common.UI.Button({cls:"btn-large-dataview sheet-template-table",iconCls:"icon-template-table",scaling:!1,menu:new Common.UI.Menu({items:[{template:o.template('<div id="id-table-menu-template" class="menu-table-template"  style="margin: 0 4px;"></div>')}]}),dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.btnTableTemplate.on("render:after",function(t){a.mnuTableTemplatePicker=new Common.UI.DataView({el:l("#id-table-menu-template"),parentMenu:t.menu,restoreHeight:325,groups:new Common.UI.DataViewGroupStore,store:new Common.UI.DataViewStore,itemTemplate:o.template('<div id="<%= id %>" class="item-template"><img src="<%= imageUrl %>" height="44" width="60"></div>'),style:"max-height: 325px;",cls:"classic",delayRenderTips:!0})}),this.btnTableTemplate.menu.on("show:before",function(t){var e,i,s,o;t&&a.mnuTableTemplatePicker&&((e=a.mnuTableTemplatePicker).cmpEl&&((s=7*(8+(i=(i=l(e.cmpEl.find(".dataview.inner .item-template").get(0)).parent()).is(":visible")?parseFloat(i.css("width")):60))+11)+(o=parseFloat(e.cmpEl.css("margin-left"))+parseFloat(e.cmpEl.css("margin-right")))>Common.Utils.innerWidth()&&(s=Math.max(Math.floor((Common.Utils.innerWidth()-o-11)/(8+i)),2)*(8+i)+11),e.cmpEl.css({width:s}),t.alignPosition()))}),this.btnTableTemplate.render(l("#table-btn-template")),this.lockedControls.push(this.btnTableTemplate),this.mnuTableTemplatePicker.on("item:click",o.bind(this.onTableTemplateSelect,this,this.btnTableTemplate)),this._locked&&this.btnTableTemplate.setDisabled(this._locked||this.wsProps.FormatCells)),a.mnuTableTemplatePicker.store.length);0<i&&i==t.length?(s=a.mnuTableTemplatePicker.dataViewItems,s&&o.each(t,function(t,e){var i=t.asc_getImage(),t=function(t){for(var e=0;e<s.length;e++){if(s[e].model.get("name")&&s[e].model.get("name")===t.asc_getName())return s[e];if(s[e].model.get("caption")===t.asc_getDisplayName())return s[e]}}(t);t&&t.model.set("imageUrl",i,{silent:!0}),t&&l(t.el).find("img").attr("src",i)})):(e=[],n=[{id:"menu-table-group-custom",caption:a.txtGroupTable_Custom,templates:[]},{id:"menu-table-group-light",caption:a.txtGroupTable_Light,templates:[]},{id:"menu-table-group-medium",caption:a.txtGroupTable_Medium,templates:[]},{id:"menu-table-group-dark",caption:a.txtGroupTable_Dark,templates:[]},{id:"menu-table-group-no-name",caption:"&nbsp",templates:[]}],o.each(t,function(t){var e,i=t.asc_getDisplayName(),s="",o=null;0==t.asc_getType()?(o=(e=i.split(" ")).pop(),null===t.asc_getName()?s="menu-table-group-light":(0<e.length&&(s="menu-table-group-"+e[e.length-1].toLowerCase()),0==n.some(function(t){return t.id===s})&&(s="menu-table-group-no-name")),e="txtTable_"+e.join(""),i=a[e]?a[e]+" "+o:i,o=parseInt(o)):s="menu-table-group-custom",n.filter(function(t){return t.id==s})[0].templates.push({id:Common.UI.getId(),name:t.asc_getName(),caption:t.asc_getDisplayName(),type:t.asc_getType(),imageUrl:t.asc_getImage(),group:s,allowSelected:!0,selected:!1,tip:i,numInGroup:null==o||isNaN(o)?null:o})}),n[1].templates.sort(i=function(t,e){return t.numInGroup-e.numInGroup}),n[2].templates.sort(i),n[3].templates.sort(i),(n=n.filter(function(t,e){return 0<t.templates.length})).forEach(function(t){e=e.concat(t.templates),delete t.templates}),a.mnuTableTemplatePicker.groups.reset(n),a.mnuTableTemplatePicker.store.reset(e))},onSelectData:function(){var t,s=this;s.api&&((t=new SSE.Views.TableOptionsDialog({handler:function(t,e){var i;"ok"==e&&(s.api.asc_setSelectionDialogMode(Asc.c_oAscSelectionDialogType.None),(i=t.getSettings()).selectionType==Asc.c_oAscSelectionType.RangeMax||i.selectionType==Asc.c_oAscSelectionType.RangeRow||i.selectionType==Asc.c_oAscSelectionType.RangeCol?Common.UI.warning({title:s.textLongOperation,msg:s.warnLongOperation,buttons:["ok","cancel"],callback:function(t){"ok"==t&&setTimeout(function(){s.api.asc_changeTableRange(s._state.TableName,i.range)},1),Common.NotificationCenter.trigger("edit:complete",s)}}):s.api.asc_changeTableRange(s._state.TableName,i.range)),Common.NotificationCenter.trigger("edit:complete",s)}})).show(),t.setSettings({api:s.api,range:s._state.Range,title:s.textResize}))},onInsertSlicerClick:function(){var i=this,t=i.api.asc_beforeInsertSlicer();t&&new SSE.Views.SlicerAddDialog({props:t,handler:function(t,e){i&&i.api&&"ok"==t&&i.api.asc_insertSlicer(e),Common.NotificationCenter.trigger("edit:complete",i)}}).show()},onInsertPivotClick:function(){this.fireEvent("pivottable:create")},onApiEditCell:function(t){this.isEditCell=t!=Asc.c_oAscCellEditorState.editEnd,t!=Asc.c_oAscCellEditorState.editStart&&t!=Asc.c_oAscCellEditorState.editEnd||this.disableControls(this._locked)},setLocked:function(t){this._locked=t},disableControls:function(e){var i;this._initSettings||(e=e||this.isEditCell,o.each((i=this).lockedControls,function(t){t.setDisabled(e||i.wsLock)}),this.linkAdvanced.toggleClass("disabled",e||this.wsLock),this.btnTableTemplate&&this.btnTableTemplate.setDisabled(e||this.wsProps.FormatCells),this.chBanded.setDisabled(e||this.wsProps.FormatCells),this.chFirst.setDisabled(e||this.wsProps.FormatCells),this.chLast.setDisabled(e||this.wsProps.FormatCells),this.chColBanded.setDisabled(e||this.wsProps.FormatCells))}},SSE.Views.TableSettings||{}))}),define("text!spreadsheeteditor/main/app/template/PivotSettings.template",[],function(){return'<table cols="2">\n    <tr>\n        <td colspan=2>\n            <label class="header"><%= scope.textFields %></label>\n        </td>\n    </tr>\n    <tr>\n        <td colspan=2 class="padding-large">\n            <div id="pivot-list-fields" class="pivot-check-listview"></div>\n        </td>\n    </tr>\n    <tr>\n        <td width="50%">\n            <label class="header"><%= scope.textFilters %></label>\n        </td>\n        <td width="50%">\n            <label class="header"><%= scope.textColumns %></label>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <div id="pivot-list-filters" class="pivot-listview"></div>\n        </td>\n        <td class="padding-small">\n            <div id="pivot-list-columns" class="pivot-listview margin-left-3"></div>\n        </td>\n    </tr>\n    <tr>\n        <td width="50%">\n            <label class="header"><%= scope.textRows %></label>\n        </td>\n        <td width="50%">\n            <label class="header"><%= scope.textValues %></label>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-large">\n            <div id="pivot-list-rows" class="pivot-listview"></div>\n        </td>\n        <td class="padding-large">\n            <div id="pivot-list-values" class="pivot-listview margin-left-3"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" colspan=2>\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr>\n        <td align="center" colspan=2>\n            <label class="link" id="pivot-advanced-link" data-hint="1" data-hint-direction="bottom" data-hint-offset="medium"><%= scope.textAdvanced %></label>\n        </td>\n    </tr>\n    <tr class="finish-cell"></tr>\n</table>'}),define("spreadsheeteditor/main/app/view/PivotSettings",["text!spreadsheeteditor/main/app/template/PivotSettings.template","jquery","underscore","backbone","common/main/lib/component/Button","common/main/lib/component/ListView","spreadsheeteditor/main/app/view/FieldSettingsDialog","spreadsheeteditor/main/app/view/ValueFieldSettingsDialog","spreadsheeteditor/main/app/view/PivotSettingsAdvanced"],function(t,p,m,e,i){"use strict";SSE.Views.PivotSettings=e.View.extend(m.extend({el:"#id-pivot-settings",template:m.template(t),events:{},options:{alias:"PivotSettings"},initialize:function(){this._initSettings=!0,this._state={names:[],DisabledControls:!1,field:{}},this.lockedControls=[],this._locked=!1,this._originalProps=null,this._noApply=!1,this.render()},render:function(){p(this.el).html(this.template({scope:this})),this.linkAdvanced=p("#pivot-advanced-link")},setApi:function(t){return this.api=t,this},createDelayedControls:function(){this.fieldsList=new Common.UI.ListView({el:p("#pivot-list-fields"),store:new Common.UI.DataViewStore,simpleAddMode:!0,template:m.template(['<div class="listview inner no-focus" style=""></div>'].join("")),itemTemplate:m.template(["<div>",'<label class="checkbox-indeterminate" style="position:absolute;">','<input id="pvcheckbox-<%= id %>" type="checkbox" class="button__checkbox">','<label for="pvcheckbox-<%= id %>" class="checkbox__shape"></label>',"</label>",'<div id="<%= id %>" class="list-item" style="pointer-events:none;"><span style="background-color: transparent;"><%= Common.Utils.String.htmlEncode(value) %></span></div>','<div class="listitem-icon img-commonctrl"></div>',"</div>"].join(""))}),this.fieldsList.on({"item:change":this.onItemChanged.bind(this),"item:add":this.onItemChanged.bind(this),"item:click":this.onFieldsCheck.bind(this)}),this.fieldsList.$el.on("dragenter",m.bind(this.onDragEnter,this)),this.fieldsList.$el.on("dragover",m.bind(this.onDragOver,this,this.fieldsList)),this.fieldsList.$el.on("dragleave",m.bind(this.onDragLeave,this,this.fieldsList)),this.fieldsList.$el.on("drop",m.bind(this.onDrop,this)),this.lockedControls.push(this.fieldsList);var t=m.template(['<div id="<%= id %>" class="list-item" style="display:inline-block;" title="<%= Common.Utils.String.htmlEncode(value) %>">','<div style=""><span><%= Common.Utils.String.htmlEncode(value) %></span></div>','<div class="listitem-icon img-commonctrl"></div>',"</div>"].join(""));this.columnsList=new Common.UI.ListView({el:p("#pivot-list-columns"),store:new Common.UI.DataViewStore,simpleAddMode:!0,template:m.template(['<div class="listview inner no-focus" style=""></div>'].join("")),itemTemplate:t}),this.columnsList.on("item:click",m.bind(this.onColumnsSelect,this,0)),this.columnsList.$el.on("dragenter",m.bind(this.onDragEnter,this)),this.columnsList.$el.on("dragover",m.bind(this.onDragOver,this,this.columnsList)),this.columnsList.$el.on("dragleave",m.bind(this.onDragLeave,this,this.columnsList)),this.columnsList.$el.on("drop",m.bind(this.onDrop,this)),this.lockedControls.push(this.columnsList),this.rowsList=new Common.UI.ListView({el:p("#pivot-list-rows"),store:new Common.UI.DataViewStore,simpleAddMode:!0,template:m.template(['<div class="listview inner no-focus" style=""></div>'].join("")),itemTemplate:t}),this.rowsList.on("item:click",m.bind(this.onColumnsSelect,this,1)),this.rowsList.$el.on("dragenter",m.bind(this.onDragEnter,this)),this.rowsList.$el.on("dragover",m.bind(this.onDragOver,this,this.rowsList)),this.rowsList.$el.on("dragleave",m.bind(this.onDragLeave,this,this.rowsList)),this.rowsList.$el.on("drop",m.bind(this.onDrop,this)),this.lockedControls.push(this.rowsList),this.valuesList=new Common.UI.ListView({el:p("#pivot-list-values"),store:new Common.UI.DataViewStore,simpleAddMode:!0,template:m.template(['<div class="listview inner no-focus" style=""></div>'].join("")),itemTemplate:t}),this.valuesList.on("item:click",m.bind(this.onColumnsSelect,this,2)),this.valuesList.$el.on("dragenter",m.bind(this.onDragEnter,this)),this.valuesList.$el.on("dragover",m.bind(this.onDragOver,this,this.valuesList)),this.valuesList.$el.on("dragleave",m.bind(this.onDragLeave,this,this.valuesList)),this.valuesList.$el.on("drop",m.bind(this.onDrop,this)),this.lockedControls.push(this.valuesList),this.filtersList=new Common.UI.ListView({el:p("#pivot-list-filters"),store:new Common.UI.DataViewStore,simpleAddMode:!0,template:m.template(['<div class="listview inner no-focus" style=""></div>'].join("")),itemTemplate:t}),this.filtersList.on("item:click",m.bind(this.onColumnsSelect,this,3)),this.filtersList.$el.on("dragenter",m.bind(this.onDragEnter,this)),this.filtersList.$el.on("dragover",m.bind(this.onDragOver,this,this.filtersList)),this.filtersList.$el.on("dragleave",m.bind(this.onDragLeave,this,this.filtersList)),this.filtersList.$el.on("drop",m.bind(this.onDrop,this)),this.lockedControls.push(this.filtersList),p(this.el).on("click","#pivot-advanced-link",m.bind(this.openAdvancedSettings,this)),this._initSettings=!1},getDragElement:function(t){return this._dragEl=p('<div style="font-weight: bold;position: absolute;left:-10000px;z-index: 10000;">'+t+"</div>"),p(document.body).append(this._dragEl),this._dragEl[0]},onDragEnd:function(){this._dragEl&&this._dragEl.remove(),this._dragEl=null},onFieldsDragStart:function(t,e,i){this._state.field={record:t.model},i.originalEvent.dataTransfer.effectAllowed="move",Common.Utils.isIE||i.originalEvent.dataTransfer.setDragImage(this.getDragElement(t.model.get("value")),14,14),this.pivotIndex=e,this.fromListView=this.fieldsList.$el[0].id},onItemsDragStart:function(t,e,i,s,o){this._state.field={record:i.model,type:t},o.originalEvent.dataTransfer.effectAllowed="move",Common.Utils.isIE||o.originalEvent.dataTransfer.setDragImage(this.getDragElement(i.model.get("value")),14,14),this.itemIndex=s,this.pivotIndex=e.store.at(s).attributes.pivotIndex,this.fromListView=e.$el[0].id},onDragItemEnter:function(t,e,i){i.preventDefault(),t.$el.addClass("insert"),this.indexMoveTo=e},onDragItemLeave:function(t,e,i){t.$el.removeClass("insert"),this.indexMoveTo=void 0},onDragItemOver:function(t,e,i,s){var o,n,a;if(-2!==this.pivotIndex||"pivot-list-filters"!==this.enterListView&&"pivot-list-values"!==this.enterListView)return s.preventDefault(),s.originalEvent.dataTransfer.dropEffect="move",e.$el.addClass("insert"),this.indexMoveTo=i,o=e.$el.parent().height(),n=e.$el.position().top,a=e.$el.outerHeight(),e=e.$el.parent().scrollTop(),n<a&&0<e&&t.scrollToRecord(t.store.at(0===i?0:i-1)),o-a<n&&i<t.store.length&&t.scrollToRecord(t.store.at(i===t.store.length-1?i:i+1)),!1;s.originalEvent.dataTransfer.dropEffect="none"},onDragEnter:function(t){this.enterListView=t.currentTarget.id},onDragOver:function(t,e){if("onlyoffice"!==e.originalEvent.dataTransfer.types[0]&&(-2!==this.pivotIndex||"pivot-list-filters"!==this.enterListView&&"pivot-list-values"!==this.enterListView)&&("pivot-list-fields"!==this.fromListView||"pivot-list-fields"!==this.enterListView))return e.preventDefault(),e.originalEvent.dataTransfer.dropEffect="move",t.$el.find(".item").last().addClass("insert last"),!1;e.originalEvent.dataTransfer.dropEffect="none"},onDragLeave:function(t,e){t.$el.find(".item").removeClass("insert last")},onDrop:function(t){if(t.stopPropagation(),this.onDragEnd(),"pivot-list-fields"===this.fromListView&&"pivot-list-fields"!==this.enterListView){if(m.isNumber(this.pivotIndex)){switch(this.enterListView){case"pivot-list-columns":this.onAddColumn(this.pivotIndex,this.indexMoveTo);break;case"pivot-list-rows":this.onAddRow(this.pivotIndex,this.indexMoveTo);break;case"pivot-list-filters":this.onAddFilter(this.pivotIndex,this.indexMoveTo);break;case"pivot-list-values":this.onAddValues(this.pivotIndex,this.indexMoveTo)}this.pivotIndex=void 0,this.indexMoveTo=void 0}}else if("pivot-list-fields"===this.enterListView)m.isNumber(this.pivotIndex)&&("pivot-list-values"===this.fromListView&&m.isNumber(this.itemIndex)?this.onRemove(this.pivotIndex,this.itemIndex):this.onRemove(this.pivotIndex),this.pivotIndex=void 0);else if(this.fromListView!==this.enterListView){if(m.isNumber(this.itemIndex)&&this.enterListView){switch(this.enterListView){case"pivot-list-columns":this.onMoveTo(0,this.pivotIndex,this.indexMoveTo);break;case"pivot-list-rows":this.onMoveTo(1,this.pivotIndex,this.indexMoveTo);break;case"pivot-list-filters":this.onMoveTo(3,this.pivotIndex,this.indexMoveTo);break;case"pivot-list-values":this.onMoveTo(2,this.pivotIndex,this.indexMoveTo)}this.itemIndex=void 0,this.indexMoveTo=void 0}}else if(this.fromListView===this.enterListView&&m.isNumber(this.itemIndex)&&this.enterListView){if(this.itemIndex!==this.indexMoveTo)switch(this.enterListView){case"pivot-list-columns":this.onMove(0,this.itemIndex,m.isNumber(this.indexMoveTo)?0!==this.indexMoveTo&&this.itemIndex<this.indexMoveTo?this.indexMoveTo-1:this.indexMoveTo:this.columnsList.store.length-1);break;case"pivot-list-rows":this.onMove(1,this.itemIndex,m.isNumber(this.indexMoveTo)?0!==this.indexMoveTo&&this.itemIndex<this.indexMoveTo?this.indexMoveTo-1:this.indexMoveTo:this.rowsList.store.length-1);break;case"pivot-list-filters":this.onMove(3,this.itemIndex,m.isNumber(this.indexMoveTo)?0!==this.indexMoveTo&&this.itemIndex<this.indexMoveTo?this.indexMoveTo-1:this.indexMoveTo:this.filtersList.store.length-1);break;case"pivot-list-values":this.onMove(2,this.itemIndex,m.isNumber(this.indexMoveTo)?0!==this.indexMoveTo&&this.itemIndex<this.indexMoveTo?this.indexMoveTo-1:this.indexMoveTo:this.valuesList.store.length-1)}else p(this.el).find(".item").removeClass("insert last");this.itemIndex=void 0,this.indexMoveTo=void 0}},openAdvancedSettings:function(t){var i;this.linkAdvanced.hasClass("disabled")||(i=this).api&&!this._locked&&new SSE.Views.PivotSettingsAdvanced({props:i._originalProps,api:i.api,handler:function(t,e){"ok"==t&&i.api&&e&&(i._originalProps.asc_set(i.api,e),Common.NotificationCenter.trigger("edit:complete",i)),Common.NotificationCenter.trigger("edit:complete",i)}}).show()},ChangeSettings:function(t){var r,c,i,e,s,o,n,a;this._initSettings&&this.createDelayedControls(),this.disableControls(this._locked),t&&(this._originalProps=t,this._state.TableName=t.asc_getName(),r=this,c=[],i=t.asc_getCacheFields(),e=t.asc_getPivotFields(),this._state.names=[],e.forEach(function(t,e){r._state.names[e]=t.asc_getName()||i[e].asc_getName()}),(e=function(t,i,s,o){var n=[],a=i.store.models,l=i.store.length===(t?t.length:0);t&&t.forEach(function(t,e){var i=t.asc_getIndex(),t=o?o(i):t.asc_getName();l?a[e].set({pivotIndex:i,index:e,value:t||"",tip:t&&10<t.length?t:""}):n.push(new Common.UI.DataViewModel({selected:!1,allowSelected:!1,pivotIndex:i,index:e,value:t||"",tip:t&&10<t.length?t:""})),c[o?t:r._state.names[i]]=!0}),l||(i.store.reset(n),i.scroller.update({minScrollbarLength:i.minScrollbarLength,alwaysVisibleY:!0,suppressScrollX:!0}),i.dataViewItems.forEach(function(t,e){t.$el.attr("draggable",!0),t.$el.on("dragstart",m.bind(r.onItemsDragStart,r,s,i,t,e)),t.$el.on("dragenter",m.bind(r.onDragItemEnter,r,t,e)),t.$el.on("dragleave",m.bind(r.onDragItemLeave,r,t,e)),t.$el.on("dragover",m.bind(r.onDragItemOver,r,i,t,e)),t.$el.on("drop",m.bind(r.onDrop,r)),t.$el.on("dragend",m.bind(r.onDragEnd,r))}),i.$el.find(".item").last().css({"margin-bottom":"10px"}))})(s=(s=t.asc_getColumnFields())&&m.filter(s,function(t){t=t.asc_getIndex();return-1<t||-2==t}),this.columnsList,0,function(t){return-1<t?r._state.names[t]:r.textValues}),e(s=(s=t.asc_getRowFields())&&m.filter(s,function(t){t=t.asc_getIndex();return-1<t||-2==t}),this.rowsList,1,function(t){return-1<t?r._state.names[t]:r.textValues}),e(s=(s=t.asc_getDataFields())&&m.filter(s,function(t){return-1<t.asc_getIndex()}),this.valuesList,2),e(s=(s=t.asc_getPageFields())&&m.filter(s,function(t){return-1<t.asc_getIndex()}),this.filtersList,3,function(t){return r._state.names[t]}),o=[],n=this.fieldsList.store.models,a=this.fieldsList.store.length===r._state.names.length,r._state.names.forEach(function(t,e){a?n[e].set({value:t,index:e,tip:25<t.length?t:"",check:c[t]}):o.push(new Common.UI.DataViewModel({selected:!1,allowSelected:!1,value:t,index:e,tip:25<t.length?t:"",check:c[t]}))}),a||(this.fieldsList.store.reset(o),this.fieldsList.scroller.update({minScrollbarLength:this.fieldsList.minScrollbarLength,alwaysVisibleY:!0,suppressScrollX:!0}),this.fieldsList.dataViewItems.forEach(function(t,e){t.$el.attr("draggable",!0),t.$el.on("dragstart",m.bind(r.onFieldsDragStart,r,t,e)),t.$el.on("dragend",m.bind(r.onDragEnd,r))})))},onFieldsCheck:function(t,e,i){var s="",o=!1,n=null,a=window.event||window._event;if(a){var l=p(a.target);if(l&&l.hasClass("listitem-icon")){if(this._state.field={record:i},this.pivotFieldsMenu){if(this.pivotFieldsMenu.isVisible())return void this.pivotFieldsMenu.hide()}else this.miAddFilter=new Common.UI.MenuItem({caption:this.txtAddFilter,checkable:!1}),this.miAddFilter.on("click",m.bind(this.onAddFilter,this)),this.miAddRow=new Common.UI.MenuItem({caption:this.txtAddRow,checkable:!1}),this.miAddRow.on("click",m.bind(this.onAddRow,this)),this.miAddColumn=new Common.UI.MenuItem({caption:this.txtAddColumn,checkable:!1}),this.miAddColumn.on("click",m.bind(this.onAddColumn,this)),this.miAddValues=new Common.UI.MenuItem({caption:this.txtAddValues,checkable:!1}),this.miAddValues.on("click",m.bind(this.onAddValues,this)),this.pivotFieldsMenu=new Common.UI.Menu({menuAlign:"tr-br",items:[this.miAddFilter,this.miAddRow,this.miAddColumn,this.miAddValues]});null!=i&&i.get("index");var r=this.pivotFieldsMenu,l=p(a.currentTarget),c=p(this.el),d=l.offset(),h=c.offset(),d=(d.left,h.left,l.width(),d.top,h.top,l.height(),c.find("#menu-pivot-fields-container"));r.rendered||(d.length<1&&(d=p('<div id="menu-pivot-fields-container" style="position: absolute; z-index: 10000;"><div class="dropdown-toggle" data-toggle="dropdown"></div></div>',r.id),c.append(d)),r.render(d),r.cmpEl.attr({tabindex:"-1"}),r.on("show:after",function(t){t&&t.menuAlignEl&&t.menuAlignEl.toggleClass("over",!0)}).on("hide:after",function(t){t&&t.menuAlignEl&&t.menuAlignEl.toggleClass("over",!1)})),r.menuAlignEl=l,r.setOffset(-20,-l.height()/2-3),r.show(),m.delay(function(){r.cmpEl.focus()},10),a.stopPropagation(),a.preventDefault()}else(s=p(a.currentTarget).find(".list-item")).length&&(n=s.get(0).getBoundingClientRect(),h=a.clientX*Common.Utils.zoom(),c=a.clientY*Common.Utils.zoom(),n.left<h&&h<n.right&&n.top<c&&c<n.bottom&&(o=!0)),(o||a.target.className.match("checkbox")&&"input"!==a.target.localName)&&this.updateFieldCheck(t,i)}},updateFieldCheck:function(t,e){e&&t&&(e.set("check",!e.get("check")),this.api&&!this._locked&&(e.get("check")?this._originalProps.asc_addField(this.api,e.get("index")):this._originalProps.asc_removeField(this.api,e.get("index")),Common.NotificationCenter.trigger("edit:complete",this)),t.scroller.update({minScrollbarLength:t.minScrollbarLength,alwaysVisibleY:!0,suppressScrollX:!0}))},onColumnsSelect:function(t,e,i,s,o){if(this._state.field={record:s,type:t,length:e.store.length},this.fieldsMenu){if(this.fieldsMenu.isVisible())return void this.fieldsMenu.hide()}else this.miMoveUp=new Common.UI.MenuItem({caption:this.txtMoveUp,checkable:!1}),this.miMoveUp.on("click",m.bind(this.onMoveUp,this)),this.miMoveDown=new Common.UI.MenuItem({caption:this.txtMoveDown,checkable:!1}),this.miMoveDown.on("click",m.bind(this.onMoveDown,this)),this.miMoveBegin=new Common.UI.MenuItem({caption:this.txtMoveBegin,checkable:!1}),this.miMoveBegin.on("click",m.bind(this.onMoveBegin,this)),this.miMoveEnd=new Common.UI.MenuItem({caption:this.txtMoveEnd,checkable:!1}),this.miMoveEnd.on("click",m.bind(this.onMoveEnd,this)),this.miMoveFilter=new Common.UI.MenuItem({caption:this.txtMoveFilter,checkable:!1}),this.miMoveFilter.on("click",m.bind(this.onMoveTo,this,3)),this.miMoveRow=new Common.UI.MenuItem({caption:this.txtMoveRow,checkable:!1}),this.miMoveRow.on("click",m.bind(this.onMoveTo,this,1)),this.miMoveColumn=new Common.UI.MenuItem({caption:this.txtMoveColumn,checkable:!1}),this.miMoveColumn.on("click",m.bind(this.onMoveTo,this,0)),this.miMoveValues=new Common.UI.MenuItem({caption:this.txtMoveValues,checkable:!1}),this.miMoveValues.on("click",m.bind(this.onMoveTo,this,2)),this.miRemove=new Common.UI.MenuItem({caption:this.txtRemove,checkable:!1}),this.miRemove.on("click",m.bind(this.onRemove,this)),this.miFieldSettings=new Common.UI.MenuItem({caption:this.txtFieldSettings,checkable:!1}),this.miFieldSettings.on("click",m.bind(this.onFieldSettings,this)),this.fieldsMenu=new Common.UI.Menu({menuAlign:"tr-br",items:[this.miMoveUp,this.miMoveDown,this.miMoveBegin,this.miMoveEnd,{caption:"--"},this.miMoveFilter,this.miMoveRow,this.miMoveColumn,this.miMoveValues,{caption:"--"},this.miRemove,{caption:"--"},this.miFieldSettings]});var n=null!=s?s.get("index"):-1,e=e.store.length,s=s.get("pivotIndex"),a=(this.miMoveUp.setDisabled(n<1),this.miMoveDown.setDisabled(e-2<n||n<0),this.miMoveBegin.setDisabled(n<1),this.miMoveEnd.setDisabled(e-2<n||n<0),this.miMoveFilter.setDisabled(3==t||-2==s),this.miMoveRow.setDisabled(1==t),this.miMoveColumn.setDisabled(0==t),this.miMoveValues.setDisabled(2==t||-2==s),this.miFieldSettings.setDisabled(-2==s),this.fieldsMenu),e=p(o.currentTarget),n=p(this.el),t=e.offset(),s=n.offset(),t=(t.left,s.left,e.width(),t.top,s.top,e.height(),n.find("#menu-pivot-container"));a.rendered||(t.length<1&&(t=p('<div id="menu-pivot-container" style="position: absolute; z-index: 10000;"><div class="dropdown-toggle" data-toggle="dropdown"></div></div>',a.id),n.append(t)),a.render(t),a.cmpEl.attr({tabindex:"-1"}),a.on("show:after",function(t){t&&t.menuAlignEl&&t.menuAlignEl.toggleClass("over",!0)}).on("hide:after",function(t){t&&t.menuAlignEl&&t.menuAlignEl.toggleClass("over",!1)})),a.menuAlignEl=e,a.setOffset(-20,-e.height()/2-3),a.show(),m.delay(function(){a.cmpEl.focus()},10),o.stopPropagation(),o.preventDefault()},setLocked:function(t){this._locked=t},onFieldSettings:function(t,e,i){var s,o,n,a,l=this;l.api&&!this._locked&&l._state.field&&(2==l._state.field.type?(s=l._state.field.record.get("index"),o=l._originalProps.asc_getDataFields()[s],new SSE.Views.ValueFieldSettingsDialog({props:l._originalProps,field:o,api:l.api,handler:function(t,e){"ok"==t&&l.api&&e&&(o.asc_set(l.api,l._originalProps,s,e),Common.NotificationCenter.trigger("edit:complete",l)),Common.NotificationCenter.trigger("edit:complete",l)}})):(n=l._state.field.record.get("pivotIndex"),a=l._originalProps.asc_getPivotFields()[n],new SSE.Views.FieldSettingsDialog({props:l._originalProps,fieldIndex:n,api:l.api,type:l._state.field.type,handler:function(t,e){"ok"==t&&l.api&&e&&(a.asc_set(l.api,l._originalProps,n,e),Common.NotificationCenter.trigger("edit:complete",l)),Common.NotificationCenter.trigger("edit:complete",l)}}))).show()},onAddFilter:function(t,e){this.api&&!this._locked&&this._state.field&&(this._originalProps.asc_addPageField(this.api,m.isNumber(t)?t:this._state.field.record.get("index"),m.isNumber(e)?e:void 0),Common.NotificationCenter.trigger("edit:complete",this))},onAddRow:function(t,e){this.api&&!this._locked&&this._state.field&&(this._originalProps.asc_addRowField(this.api,m.isNumber(t)?t:this._state.field.record.get("index"),m.isNumber(e)?e:void 0),Common.NotificationCenter.trigger("edit:complete",this))},onAddColumn:function(t,e){this.api&&!this._locked&&this._state.field&&(this._originalProps.asc_addColField(this.api,m.isNumber(t)?t:this._state.field.record.get("index"),m.isNumber(e)?e:void 0),Common.NotificationCenter.trigger("edit:complete",this))},onAddValues:function(t,e){this.api&&!this._locked&&this._state.field&&(this._originalProps.asc_addDataField(this.api,m.isNumber(t)?t:this._state.field.record.get("index"),m.isNumber(e)?e:void 0),Common.NotificationCenter.trigger("edit:complete",this))},onRemove:function(t,e){this.api&&!this._locked&&this._state.field&&(2==this._state.field.type||m.isNumber(e)?this._originalProps.asc_removeDataField(this.api,m.isNumber(t)?t:this._state.field.record.get("pivotIndex"),m.isNumber(e)?e:this._state.field.record.get("index")):this._originalProps.asc_removeNoDataField(this.api,m.isNumber(t)?t:this._state.field.record.get("pivotIndex")),Common.NotificationCenter.trigger("edit:complete",this))},onMoveUp:function(){var t;this.api&&!this._locked&&this._state.field&&(t=this._state.field.record.get("index"),this.onMove(this._state.field.type,t,t-1))},onMoveDown:function(){var t;this.api&&!this._locked&&this._state.field&&(t=this._state.field.record.get("index"),this.onMove(this._state.field.type,t,t+1))},onMoveBegin:function(){var t;this.api&&!this._locked&&this._state.field&&(t=this._state.field.record.get("index"),this.onMove(this._state.field.type,t,0))},onMoveEnd:function(){var t;this.api&&!this._locked&&this._state.field&&(t=this._state.field.record.get("index"),this.onMove(this._state.field.type,t,this._state.field.length-1))},onMove:function(t,e,i){switch(t){case 0:this._originalProps.asc_moveColField(this.api,e,i);break;case 1:this._originalProps.asc_moveRowField(this.api,e,i);break;case 2:this._originalProps.asc_moveDataField(this.api,e,i);break;case 3:this._originalProps.asc_movePageField(this.api,e,i)}Common.NotificationCenter.trigger("edit:complete",this)},onMoveTo:function(t,e,i){if(this.api&&!this._locked&&this._state.field){var s=m.isNumber(e)?e:this._state.field.record.get("pivotIndex"),o=m.isNumber(i)?i:2==this._state.field.type?this._state.field.record.get("index"):void 0;switch(t){case 0:this._originalProps.asc_moveToColField(this.api,s,o);break;case 1:this._originalProps.asc_moveToRowField(this.api,s,o);break;case 2:this._originalProps.asc_moveToDataField(this.api,s,o);break;case 3:this._originalProps.asc_moveToPageField(this.api,s,o)}Common.NotificationCenter.trigger("edit:complete",this)}},disableControls:function(e){this._initSettings||this._state.DisabledControls!==e&&(this._state.DisabledControls=e,m.each(this.lockedControls,function(t){t.setDisabled(e)}),this.linkAdvanced.toggleClass("disabled",e))},onItemChanged:function(t,e){var i=e.model.get("check");"indeterminate"==i?p("input[type=checkbox]",e.$el).prop("indeterminate",!0):p("input[type=checkbox]",e.$el).prop({checked:i,indeterminate:!1})}},SSE.Views.PivotSettings||{}))}),define("text!spreadsheeteditor/main/app/template/SignatureSettings.template",[],function(){return'<table cols="2">\n    <tr>\n        <td class="padding-large">\n            <label style="font-size: 18px;"><%= scope.strSignature %></label>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-large">\n            <div id="signature-invisible-sign" style="width:100%;"></div>\n        </td>\n    </tr>\n    <tr class="requested">\n        <td class="padding-small">\n            <label class="header"><%= scope.strRequested %></label>\n        </td>\n    </tr>\n    <tr class="requested">\n        <td class="padding-large">\n            <div id="signature-requested-sign"></div>\n        </td>\n    </tr>\n    <tr class="valid">\n        <td class="padding-small">\n            <label class="header"><%= scope.strValid %></label>\n        </td>\n    </tr>\n    <tr class="valid">\n        <td class="padding-large">\n            <div id="signature-valid-sign"></div>\n        </td>\n    </tr>\n    <tr class="invalid">\n        <td class="padding-small">\n            <label class="header" style="color:#bb3d3d;"><%= scope.strInvalid %></label>\n        </td>\n    </tr>\n    <tr class="invalid">\n        <td><div id="signature-invalid-sign"></div></td>\n    </tr>\n    <tr class="finish-cell"></tr>\n</table>'}),define("spreadsheeteditor/main/app/view/SignatureSettings",["text!spreadsheeteditor/main/app/template/SignatureSettings.template","jquery","underscore","backbone","common/main/lib/component/Button"],function(t,r,c,e){"use strict";SSE.Views.SignatureSettings=e.View.extend(c.extend({el:"#id-signature-settings",template:c.template(t),events:{},options:{alias:"SignatureSettings"},initialize:function(){this._state={DisabledEditing:!1,ready:!1,hasValid:!1,hasInvalid:!1,hasRequested:!1,tip:void 0},this._locked=!1,this.render()},render:function(){this.$el.html(this.template({scope:this}));var t=SSE.getController("Common.Controllers.Protection").getView();this.btnAddInvisibleSign=t.getButton("signature"),this.btnAddInvisibleSign.render(this.$el.find("#signature-invisible-sign")),this.viewRequestedList=new Common.UI.DataView({el:r("#signature-requested-sign"),enableKeyEvents:!1,itemTemplate:c.template(['<div id="<%= id %>" class="signature-item requested">','<div class="caret img-commonctrl nomargin"></div>','<div class="name"><%= Common.Utils.String.htmlEncode(name) %></div>',"</div>"].join(""))}),this.viewValidList=new Common.UI.DataView({el:r("#signature-valid-sign"),enableKeyEvents:!1,itemTemplate:c.template(['<div id="<%= id %>" class="signature-item">','<div class="caret img-commonctrl img-colored <% if (name == "" || date == "") { %>nomargin<% } %>"></div>','<div class="name"><%= Common.Utils.String.htmlEncode(name) %></div>','<div class="date"><%= Common.Utils.String.htmlEncode(date) %></div>',"</div>"].join(""))}),this.viewInvalidList=new Common.UI.DataView({el:r("#signature-invalid-sign"),enableKeyEvents:!1,itemTemplate:c.template(['<div id="<%= id %>" class="signature-item">','<div class="caret img-commonctrl <% if (name == "" || date == "") { %>nomargin<% } %>"></div>','<div class="name"><%= Common.Utils.String.htmlEncode(name) %></div>','<div class="date"><%= Common.Utils.String.htmlEncode(date) %></div>',"</div>"].join(""))}),this.viewRequestedList.on("item:click",c.bind(this.onSelectSignature,this)),this.viewValidList.on("item:click",c.bind(this.onSelectSignature,this)),this.viewInvalidList.on("item:click",c.bind(this.onSelectSignature,this)),this.viewRequestedList.on("item:contextmenu",c.bind(this.onItemContextMenu,this)),this.viewValidList.on("item:contextmenu",c.bind(this.onItemContextMenu,this)),this.viewInvalidList.on("item:contextmenu",c.bind(this.onItemContextMenu,this)),this.signatureMenu=new Common.UI.Menu({menuAlign:"tr-br",items:[{caption:this.strSign,value:0},{caption:this.strDetails,value:1},{caption:this.strSetup,value:2},{caption:this.strDelete,value:3}]}),this.signatureMenu.on("item:click",c.bind(this.onMenuSignatureClick,this))},setApi:function(t){return this.api=t,this.api&&this.api.asc_registerCallback("asc_onUpdateSignatures",c.bind(this.onApiUpdateSignatures,this)),Common.NotificationCenter.on("document:ready",c.bind(this.onDocumentReady,this)),this},ChangeSettings:function(t){this._state.hasRequested||this._state.hasValid||this._state.hasInvalid||this.updateSignatures(this.api.asc_getSignatures(),this.api.asc_getRequestSignatures())},setLocked:function(t){this._locked=t},setMode:function(t){this.mode=t},onApiUpdateSignatures:function(t,e){this._state.ready&&(this.updateSignatures(t,e),this.showSignatureTooltip(this._state.hasValid,this._state.hasInvalid))},updateSignatures:function(t,e){var s=this,o=[],n=[],a=[],l=1;c.each(e,function(t,e){var i=t.asc_getSigner1();o.push({name:""!==i?i:s.strSigner+" "+l++,guid:t.asc_getGuid(),requested:!0})}),c.each(t,function(t,e){var i=t.asc_getDate(),i={name:t.asc_getSigner1(),certificateId:t.asc_getId(),guid:t.asc_getGuid(),date:c.isEmpty(i)?"":new Date(i).toLocaleString(),invisible:!t.asc_getVisible()};(0==t.asc_getValid()?n:a).push(i)}),s._state.hasValid=0<n.length,s._state.hasInvalid=0<a.length,s._state.hasRequested=0<o.length,this.viewRequestedList.store.reset(o),this.viewValidList.store.reset(n),this.viewInvalidList.store.reset(a),this.$el.find(".requested").toggleClass("hidden",!s._state.hasRequested),this.$el.find(".valid").toggleClass("hidden",!s._state.hasValid),this.$el.find(".invalid").toggleClass("hidden",!s._state.hasInvalid),s.disableEditing(s._state.hasValid||s._state.hasInvalid)},onItemContextMenu:function(t,e,i,s){var o=this.signatureMenu,n=(o.isVisible()&&o.hide(),r(this.el).offset()),s=[s.clientX*Common.Utils.zoom()-n.left+5,s.clientY*Common.Utils.zoom()-n.top+5];this.showSignatureMenu(i,s),o.menuAlign=Common.UI.isRTL()?"tr-br":"tl-bl",o.menuAlignEl=null,o.setOffset(15,5),o.show(),c.delay(function(){o.cmpEl.focus()},10)},onSelectSignature:function(t,e,i,s){var o,n,a,l;i&&((n=r(s.target))&&n.hasClass("caret")?(o=this.signatureMenu).isVisible()?o.hide():(l=(n=r(s.currentTarget)).offset(),a=r(this.el).offset(),l=[l.left-a.left+n.width(),l.top-a.top+n.height()/2],this.showSignatureMenu(i,l),o.menuAlign=Common.UI.isRTL()?"tl-bl":"tr-br",o.menuAlignEl=n,o.setOffset(-20,-n.height()/2+3),o.show(),c.delay(function(){o.cmpEl.focus()},10),s.stopPropagation(),s.preventDefault()):this.api.asc_gotoSignature(i.get("guid")))},showSignatureMenu:function(t,e){this.api.asc_gotoSignature(t.get("guid"));var i=this.signatureMenu,s=r(this.el),o=s.find("#menu-signature-container"),s=(i.rendered||(o.length<1&&(o=r('<div id="menu-signature-container" style="position: absolute; z-index: 10000;"><div class="dropdown-toggle" data-toggle="dropdown"></div></div>',i.id),s.append(o)),i.render(o),i.cmpEl.attr({tabindex:"-1"}),i.on({"show:after":function(t){t&&t.menuAlignEl&&t.menuAlignEl.toggleClass("over",!0)},"hide:after":function(t){t&&t.menuAlignEl&&t.menuAlignEl.toggleClass("over",!1)}})),t.get("requested")),n=this._state.hasValid||this._state.hasInvalid;i.items[0].setVisible(s),i.items[1].setVisible(!s),i.items[2].setVisible(s||!t.get("invisible")),i.items[3].setVisible(!s),i.items[0].setDisabled(this._locked),i.items[3].setDisabled(this._locked),i.items[1].cmpEl.attr("data-value",t.get("certificateId")),i.items[2].cmpEl.attr("data-value",n?1:0),i.cmpEl.attr("data-value",t.get("guid")),o.css({left:e[0],top:e[1]})},onMenuSignatureClick:function(t,e){var i=t.cmpEl.attr("data-value");switch(e.value){case 0:Common.NotificationCenter.trigger("protect:sign",i);break;case 1:this.api.asc_ViewCertificate(e.cmpEl.attr("data-value"));break;case 2:Common.NotificationCenter.trigger("protect:signature","visible",!!parseInt(e.cmpEl.attr("data-value")),i);break;case 3:var s=this;Common.UI.warning({title:this.notcriticalErrorTitle,msg:this.txtRemoveWarning,buttons:["ok","cancel"],primary:"ok",callback:function(t){"ok"==t&&s.api.asc_RemoveSignature(i)}})}},onDocumentReady:function(){this._state.ready=!0,this.updateSignatures(this.api.asc_getSignatures(),this.api.asc_getRequestSignatures()),this.showSignatureTooltip(this._state.hasValid,this._state.hasInvalid,this._state.hasRequested)},showSignatureTooltip:function(t,e,i){var s,o=this,n=o._state.tip;t||e||i?(s=t||e,e=e?o.txtSignedInvalid:t?o.txtSigned:"",i&&(e=o.txtRequestedSignatures+"<br><br>"+e),n&&n.isVisible()&&(e!==n.text||s!==n.showLink)&&(n.close(),o._state.tip=void 0),o._state.tip||((n=new Common.UI.SynchronizeTip({target:SSE.getController("RightMenu").getView("RightMenu").btnSignature.btnEl,text:e,showLink:s,textLink:this.txtContinueEditing,placement:"left-bottom"})).on({dontshowclick:function(){Common.UI.warning({title:o.notcriticalErrorTitle,msg:o.txtEditWarning,buttons:["ok","cancel"],primary:"ok",callback:function(t){"ok"==t&&(n.close(),o._state.tip=void 0,o.api.asc_RemoveAllSignatures())}})},closeclick:function(){n.close(),o._state.tip=void 0}}),(o._state.tip=n).show())):n&&n.isVisible()&&(n.close(),o._state.tip=void 0)},hideSignatureTooltip:function(){var t=this._state.tip;t&&t.isVisible()&&(t.close(),this._state.tip=void 0)},disableEditing:function(t){this._state.DisabledEditing!=t&&(this._state.DisabledEditing=t,Common.NotificationCenter.trigger("editing:disable",t,{viewMode:t,allowSignature:!0,allowProtect:!0,rightMenu:{clear:!1,disable:!0},statusBar:!0,leftMenu:{disable:!1,previewMode:!0},fileMenu:!1,comments:{disable:!1,previewMode:!0},chat:!1,review:!0,viewport:!0,documentHolder:{clear:!0,disable:!0},toolbar:!0,celleditor:{previewMode:!0}},"signature"))}},SSE.Views.SignatureSettings||{}))}),define("text!spreadsheeteditor/main/app/template/CellSettings.template",[],function(){return'<table cols="2">\n    <tr>\n        <td>\n            <label class="header"><%= scope.textFill %></label>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <div id="cell-combo-fill-src" style="width: 100%;"></div>\n        </td>\n    </tr>\n    <tr>\n        <td>\n            <div id="cell-panel-color-fill" class="settings-hidden padding-small" style="width: 100%;">\n                <div id="cell-back-color-btn" style=""></div>\n            </div>\n            <div id="cell-panel-pattern-fill" class="settings-hidden padding-small" style="width: 100%;">\n                <label class="input-label" style="margin-top: 3px;"><%= scope.textPattern %></label>\n                <div id="cell-combo-pattern" style="width: 100%; height: 42px; margin-bottom: 8px;"></div>\n                <div style="width: 100%; height: 25px; margin-bottom: 8px;">\n                    <label class="input-label" style="margin-top: 3px;"><%= scope.textForeground %></label>\n                    <div id="cell-foreground-color-btn" class="float-right"></div>\n                </div>\n                <div style="width: 100%; height: 25px;">\n                    <label class="input-label" style="margin-top: 3px;"><%= scope.textBackground %></label>\n                    <div id="cell-background-color-btn" class="float-right"></div>\n                </div>\n            </div>\n            <div id="cell-panel-gradient-fill" class="settings-hidden padding-small" style="width: 100%;">\n                <div style="height:80px;">\n                    <div style="display: inline-block;">\n                        <label class="input-label" ><%= scope.textAngle %></label>\n                        <div id="cell-spin-gradient-angle" style="width: 90px;"></div>\n                    </div>\n                    <div class="cell-direction float-right">\n                        <label class="input-label"><%= scope.textDirection %></label>\n                        <div id="cell-button-direction"></div>\n                    </div>\n                </div>\n                <label class="header" style="display:block;margin-bottom: 5px;"><%= scope.textGradient %></label>\n                <div style="display: inline-block; margin-top: 3px;">\n                    <div id="cell-slider-gradient" style="display: inline-block; vertical-align: middle;"></div>\n                </div>\n                <div style="height: 40px;margin-top:6px;display:flex;justify-content:space-between;">\n                    <div style="display: flex;">\n                    <div style="">\n                        <label class="input-label" style=""><%= scope.textGradientColor %></label>\n                        <div id="cell-gradient-color-btn"></div>\n                    </div>\n                    <div class="margin-left-10">\n                        <label class="input-label" style=""><%= scope.textPosition %></label>\n                        <div id="cell-gradient-position"></div>\n                    </div>\n                    </div>\n                    <div style="display:flex;padding-top:15px;">\n                        <div id="cell-gradient-add-step"></div>\n                        <div id="cell-gradient-remove-step"></div>\n                    </div>\n                </div>\n            </div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" colspan=2>\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr>\n        <td colspan=2 class="padding-small">\n            <label class="header"><%= scope.textBorders %></label>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" colspan=2>\n            <div id="cell-combo-border-type"></div>\n            <div class="border-color color-btn-wrap float-right">\n                <label class="input-label margin-right-5"><%= scope.textBorderColor %></label>\n                <div id="cell-border-color-btn"></div>\n            </div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" colspan=2>\n            <label class="input-label"><%= scope.textSelectBorders %></label>\n        </td>\n    </tr>\n    <tr>\n        <td colspan=2 class="padding-small">\n            <div id="cell-button-border-all" style="display: inline-block;"></div>\n            <div id="cell-button-border-none" style="display: inline-block;"></div>\n            <div id="cell-button-border-inner" style="display: inline-block;"></div>\n            <div id="cell-button-border-outer" style="display: inline-block;"></div>\n            <div id="cell-button-border-diagu" style="display: inline-block;"></div>\n            <div id="cell-button-border-diagd" style="display: inline-block;"></div>\n        </td>\n    </tr>\n    <tr>\n        <td colspan=2 class="padding-small">\n            <div id="cell-button-border-left" style="display: inline-block;"></div>\n            <div id="cell-button-border-inner-vert" style="display: inline-block;"></div>\n            <div id="cell-button-border-right" style="display: inline-block;"></div>\n            <div id="cell-button-border-top" style="display: inline-block;"></div>\n            <div id="cell-button-border-inner-hor" style="display: inline-block;"></div>\n            <div id="cell-button-border-bottom" style="display: inline-block;"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" colspan=2>\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr>\n        <td colspan=2 class="">\n            <label class="header"><%= scope.textIndent %></label>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-large" colspan=2>\n            <div id="cell-spin-indent" style="display: inline-block;"></div>\n        </td>\n    </tr>\n    <tr>\n        <td colspan=2 class="padding-small">\n            <label class="header"><%= scope.textOrientation %></label>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-large" colspan=2>\n            <label class="input-label"><%= scope.textAngle %></label>\n            <div id="cell-spin-angle" class="margin-left-5"></div>\n        </td>\n    </tr>\n    <tr>\n        <td colspan=2 class="padding-small">\n            <label class="header"><%= scope.textControl %></label>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" colspan=2>\n            <div id="cell-checkbox-wrap"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" colspan=2>\n            <div id="cell-checkbox-shrink"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" colspan=2>\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" colspan=2>\n            <div id="cell-btn-cond-format" style="width:100%;"></div>\n        </td>\n    </tr>\n    <tr class="finish-cell"></tr>\n</table>'}),define("spreadsheeteditor/main/app/view/CellSettings",["text!spreadsheeteditor/main/app/template/CellSettings.template","jquery","underscore","backbone","common/main/lib/component/Button","common/main/lib/component/ThemeColorPalette","common/main/lib/component/ColorButton","common/main/lib/component/ComboBorderSize","common/main/lib/view/OpenDialog"],function(t,l,d,e){"use strict";SSE.Views.CellSettings=e.View.extend(d.extend({el:"#id-cell-settings",template:d.template(t),events:{},options:{alias:"CellSettings"},initialize:function(){this._initSettings=!0,this._noApply=!0,this._sendUndoPoint=!0,this._state={DisabledControls:!0,DisabledFillPanels:!0,CellAngle:void 0,CellIndent:void 0,GradFillType:Asc.c_oAscFillGradType.GRAD_LINEAR,CellColor:"transparent",FillType:Asc.c_oAscFill.FILL_TYPE_NOFILL,FGColor:"000000",BGColor:"ffffff",GradColor:"000000"},this.lockedControls=[],this._locked=!0,this.isEditCell=!1,this.BorderType=1,this.GradFillType=Asc.c_oAscFillGradType.GRAD_LINEAR,this.GradLinearDirectionType=0,this.GradRadialDirectionIdx=0,this.GradColor={values:[0,100],colors:["000000","ffffff"],currentIdx:0},this.fillControls=[],this.gradientColorsStr="#000, #fff",this.typeGradient=90,this.render(),this.createDelayedControls(),this.FillColorContainer=l("#cell-panel-color-fill"),this.FillPatternContainer=l("#cell-panel-pattern-fill"),this.FillGradientContainer=l("#cell-panel-gradient-fill")},onColorsBackSelect:function(t,e){this.api&&this.api.asc_setCellBackgroundColor("transparent"==e?null:Common.Utils.ThemeColor.getRgbColor(e)),Common.NotificationCenter.trigger("edit:complete",this)},onBtnBordersClick:function(t,e){var i,s,o;this.api&&(i=[],s=this.BorderType,this.btnBorderColor.isAutoColor()?(o=new Asc.asc_CColor).put_auto(!0):o=Common.Utils.ThemeColor.getRgbColor(this.btnBorderColor.color),"inner"==t.options.borderId?(i[Asc.c_oAscBorderOptions.InnerV]=new Asc.asc_CBorder(s,o),i[Asc.c_oAscBorderOptions.InnerH]=new Asc.asc_CBorder(s,o)):"all"==t.options.borderId?(i[Asc.c_oAscBorderOptions.InnerV]=new Asc.asc_CBorder(s,o),i[Asc.c_oAscBorderOptions.InnerH]=new Asc.asc_CBorder(s,o),i[Asc.c_oAscBorderOptions.Left]=new Asc.asc_CBorder(s,o),i[Asc.c_oAscBorderOptions.Top]=new Asc.asc_CBorder(s,o),i[Asc.c_oAscBorderOptions.Right]=new Asc.asc_CBorder(s,o),i[Asc.c_oAscBorderOptions.Bottom]=new Asc.asc_CBorder(s,o)):"outer"==t.options.borderId?(i[Asc.c_oAscBorderOptions.Left]=new Asc.asc_CBorder(s,o),i[Asc.c_oAscBorderOptions.Top]=new Asc.asc_CBorder(s,o),i[Asc.c_oAscBorderOptions.Right]=new Asc.asc_CBorder(s,o),i[Asc.c_oAscBorderOptions.Bottom]=new Asc.asc_CBorder(s,o)):"none"!=t.options.borderId&&(i[t.options.borderId]=new Asc.asc_CBorder(s,o)),this.api.asc_setCellBorders(i)),Common.NotificationCenter.trigger("edit:complete",this)},onBorderTypeSelect:function(t,e){this.BorderType=e.value},onAngleChange:function(t,e,i,s){this.api&&e!==i&&this.api.asc_setCellAngle(t.getNumberValue())},onIndentChange:function(t,e,i,s){this.api&&e!==i&&this.api.asc_setCellIndent(t.getNumberValue())},render:function(){l(this.el).html(this.template({scope:this}))},setApi:function(t){return(this.api=t)&&this.api.asc_registerCallback("asc_onEditCell",this.onApiEditCell.bind(this)),this},createDelayedControls:function(){for(var o=this,t=(this._arrFillSrc=[{displayValue:this.textNoFill,value:Asc.c_oAscFill.FILL_TYPE_NOFILL},{displayValue:this.textColor,value:Asc.c_oAscFill.FILL_TYPE_SOLID},{displayValue:this.textGradientFill,value:Asc.c_oAscFill.FILL_TYPE_GRAD},{displayValue:this.textPatternFill,value:Asc.c_oAscFill.FILL_TYPE_PATT}],this.cmbFillSrc=new Common.UI.ComboBox({el:l("#cell-combo-fill-src"),cls:"input-group-nr",style:"width: 100%;",menuStyle:"min-width: 100%;",editable:!1,data:this._arrFillSrc,disabled:this._locked,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbFillSrc.setValue(Asc.c_oAscFill.FILL_TYPE_NOFILL),this.fillControls.push(this.cmbFillSrc),this.cmbFillSrc.on("selected",d.bind(this.onFillSrcSelect,this)),this.numGradientAngle=new Common.UI.MetricSpinner({el:l("#cell-spin-gradient-angle"),step:10,width:90,defaultUnit:"°",value:"0 °",allowDecimal:!0,maxValue:359.9,minValue:0,disabled:this._locked,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.lockedControls.push(this.numGradientAngle),this.numGradientAngle.on("change",d.bind(this.onGradientAngleChange,this)),this.numGradientAngle.on("inputleave",function(){Common.NotificationCenter.trigger("edit:complete",o)}),this._viewDataLinear=[{offsetx:0,offsety:0,type:45,subtype:-1},{offsetx:50,offsety:0,type:90,subtype:4},{offsetx:100,offsety:0,type:135,subtype:5},{offsetx:0,offsety:50,type:0,subtype:6,cls:"item-gradient-separator",selected:!0},{offsetx:100,offsety:50,type:180,subtype:1},{offsetx:0,offsety:100,type:315,subtype:2},{offsetx:50,offsety:100,type:270,subtype:3},{offsetx:100,offsety:100,type:225,subtype:7}],d.each(this._viewDataLinear,function(t){t.gradientColorsStr=o.gradientColorsStr}),this.btnDirection=new Common.UI.Button({cls:"btn-large-dataview",scaling:!1,iconCls:"item-gradient gradient-left",menu:new Common.UI.Menu({style:"min-width: 60px;",menuAlign:"tr-br",items:[{template:d.template('<div id="id-cell-menu-direction" style="width: 175px; margin: 0 5px;"></div>')}]}),dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.btnDirection.on("render:after",function(t){o.mnuDirectionPicker=new Common.UI.DataView({el:l("#id-cell-menu-direction"),parentMenu:t.menu,restoreHeight:174,store:new Common.UI.DataViewStore(o._viewDataLinear),itemTemplate:d.template('<div id="<%= id %>" class="item-gradient" style="background: linear-gradient(<%= type + 90 %>deg,<%= gradientColorsStr %>);"></div>')})}),this.btnDirection.render(l("#cell-button-direction")),this.fillControls.push(this.btnDirection),this.mnuDirectionPicker.on("item:click",d.bind(this.onSelectGradient,this,this.btnDirection)),this.sldrGradient=new Common.UI.MultiSliderGradient({el:l("#cell-slider-gradient"),width:192,minValue:0,maxValue:100,values:[0,100]}),this.sldrGradient.on("change",d.bind(this.onGradientChange,this)),this.sldrGradient.on("changecomplete",d.bind(this.onGradientChangeComplete,this)),this.sldrGradient.on("thumbclick",function(t,e){o.GradColor.currentIdx=e;e=o.GradColor.colors[o.GradColor.currentIdx],o.btnGradColor.setColor(e),o.colorsGrad.select(e,!1),e=o.GradColor.values[o.GradColor.currentIdx];o.spnGradPosition.setValue(Common.UI.isRTL()?o.sldrGradient.maxValue-e:e)}),this.sldrGradient.on("thumbdblclick",function(t){o.btnGradColor.cmpEl.find("button").dropdown("toggle")}),this.sldrGradient.on("sortthumbs",function(t,e){var i,s=[];d.each(e,function(t,e){s.push(o.GradColor.colors[t]),o.GradColor.currentIdx==t&&(i=e)}),o.OriginalFillType=null,o.GradColor.colors=s,o.GradColor.currentIdx=i}),this.sldrGradient.on("addthumb",function(t,e,i){o.GradColor.colors[e]=o.GradColor.colors[o.GradColor.currentIdx],o.GradColor.currentIdx=e;e=o.sldrGradient.addNewThumb(e,i);o.GradColor.colors[o.GradColor.currentIdx]=e}),this.sldrGradient.on("removethumb",function(t,e){o.sldrGradient.removeThumb(e),o.GradColor.values.splice(e,1),o.sldrGradient.changeGradientStyle(),(d.isUndefined(o.GradColor.currentIdx)||o.GradColor.currentIdx>=o.GradColor.colors.length)&&(e=0===(e=0<e?e-1:e)&&2<o.GradColor.values.length?o.GradColor.values.length-2:e,o.GradColor.currentIdx=e),o.sldrGradient.setActiveThumb(o.GradColor.currentIdx)}),this.fillControls.push(this.sldrGradient),this.cmbPattern=new Common.UI.ComboDataView({itemWidth:28,itemHeight:28,menuMaxHeight:300,enableKeyEvents:!0,cls:"combo-pattern",dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big",itemTemplate:d.template(['<div class="style" id="<%= id %>">','<img src="data:image/gif;base64,R0lGODlhAQABAID/AMDAwAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" class="combo-pattern-item" ','width="28" height="28" ','style="background-position: -<%= offsetx %>px -<%= offsety %>px;"/>',"</div>"].join(""))}),this.cmbPattern.render(l("#cell-combo-pattern")),this.cmbPattern.openButton.menu.cmpEl.css({"min-width":178,"max-width":178}),this.cmbPattern.on("click",d.bind(this.onPatternSelect,this)),this.cmbPattern.openButton.menu.on("show:after",function(){o.cmbPattern.menuPicker.scroller.update({alwaysVisibleY:!0})}),this.fillControls.push(this.cmbPattern),[-1,-1,-1,-1,-1,-1,-1,-1,-1,8,9,10,11,-1,-1,-1,21,-1,-1,-1,-1,20,22,23,-1,-1,27,28,29,30,-1,-1,33,-1,35,-1,-1,-1,-1,-1,41,-1,43,-1,-1,46,-1,-1,-1,-1]),e=(this.patternViewData=[],0),i=0;i<13;i++)for(var s=0;s<4;s++){var n=4*i+s;-1<t[n]&&(this.patternViewData[e++]={offsetx:28*s,offsety:28*i,type:t[n]})}for(i=0;i<this.patternViewData.length;i++)this.patternViewData[i].id=Common.UI.getId();this.cmbPattern.menuPicker.store.add(this.patternViewData),0<this.cmbPattern.menuPicker.store.length&&(this.cmbPattern.fillComboView(this.cmbPattern.menuPicker.store.at(0),!0),this.PatternFillType=this.patternViewData[0].type);var a=[[Asc.c_oAscBorderOptions.Left,"toolbar__icon btn-border-left","cell-button-border-left",this.tipLeft,"bottom"],[Asc.c_oAscBorderOptions.InnerV,"toolbar__icon btn-border-insidevert","cell-button-border-inner-vert",this.tipInnerVert,"bottom"],[Asc.c_oAscBorderOptions.Right,"toolbar__icon btn-border-right","cell-button-border-right",this.tipRight,"bottom"],[Asc.c_oAscBorderOptions.Top,"toolbar__icon btn-border-top","cell-button-border-top",this.tipTop,"bottom"],[Asc.c_oAscBorderOptions.InnerH,"toolbar__icon btn-border-insidehor","cell-button-border-inner-hor",this.tipInnerHor,"bottom"],[Asc.c_oAscBorderOptions.Bottom,"toolbar__icon btn-border-bottom","cell-button-border-bottom",this.tipBottom,"bottom"],[Asc.c_oAscBorderOptions.DiagU,"toolbar__icon btn-border-diagup","cell-button-border-diagu",this.tipDiagU,"top"],[Asc.c_oAscBorderOptions.DiagD,"toolbar__icon btn-border-diagdown","cell-button-border-diagd",this.tipDiagD,"top"],["inner","toolbar__icon btn-border-inside","cell-button-border-inner",this.tipInner,"top"],["outer","toolbar__icon btn-border-out","cell-button-border-outer",this.tipOuter,"top"],["all","toolbar__icon btn-border-all","cell-button-border-all",this.tipAll,"top"],["none","toolbar__icon btn-border-no","cell-button-border-none",this.tipNone,"top"]];d.each(a,function(t,e,i){t=new Common.UI.Button({parentEl:l("#"+t[2]),cls:"btn-toolbar borders--small",iconCls:t[1],borderId:t[0],hint:t[3],disabled:this._locked,dataHint:"1",dataHintDirection:t[4],dataHintOffset:"small"});t.on("click",d.bind(this.onBtnBordersClick,this)),this.lockedControls.push(t)},this),this.cmbBorderType=new Common.UI.ComboBorderType({el:l("#cell-combo-border-type"),cls:"cell-border-type",style:"width: 93px;",menuStyle:"min-width: 93px;",disabled:this._locked,data:[{value:Asc.c_oAscBorderStyles.Thin,imgId:"solid-s"},{value:Asc.c_oAscBorderStyles.Hair,imgId:"dots-s"},{value:Asc.c_oAscBorderStyles.Dotted,imgId:"dashes-s"},{value:Asc.c_oAscBorderStyles.Dashed,imgId:"dashes-m"},{value:Asc.c_oAscBorderStyles.DashDot,imgId:"dash-dot-s"},{value:Asc.c_oAscBorderStyles.DashDotDot,imgId:"dash-dot-dot-s"},{value:Asc.c_oAscBorderStyles.Medium,imgId:"solid-m"},{value:Asc.c_oAscBorderStyles.MediumDashed,imgId:"dashes-l"},{value:Asc.c_oAscBorderStyles.MediumDashDot,imgId:"dash-dot-m"},{value:Asc.c_oAscBorderStyles.MediumDashDotDot,imgId:"dash-dot-dot-m"},{value:Asc.c_oAscBorderStyles.Thick,imgId:"solid-l"}],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}).on("selected",d.bind(this.onBorderTypeSelect,this)),this.BorderType=Asc.c_oAscBorderStyles.Thin,this.cmbBorderType.setValue(this.BorderType),this.lockedControls.push(this.cmbBorderType),this.btnBorderColor=new Common.UI.ColorButton({parentEl:l("#cell-border-color-btn"),disabled:this._locked,menu:!0,color:"auto",auto:!0,eyeDropper:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"medium"}),this.lockedControls.push(this.btnBorderColor),this.btnBackColor=new Common.UI.ColorButton({parentEl:l("#cell-back-color-btn"),disabled:this._locked,menu:!0,transparent:!0,color:"transparent",eyeDropper:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"medium"}),this.lockedControls.push(this.btnBackColor),this.spnIndent=new Common.UI.MetricSpinner({el:l("#cell-spin-indent"),step:1,width:60,defaultUnit:"",value:"0",allowDecimal:!1,maxValue:250,minValue:0,disabled:this._locked,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.lockedControls.push(this.spnIndent),this.spnIndent.on("change",d.bind(this.onIndentChange,this)),this.spnIndent.on("inputleave",function(){Common.NotificationCenter.trigger("edit:complete",o)}),this.spnAngle=new Common.UI.MetricSpinner({el:l("#cell-spin-angle"),step:1,width:60,defaultUnit:"°",value:"0 °",allowDecimal:!1,maxValue:90,minValue:-90,disabled:this._locked,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.lockedControls.push(this.spnAngle),this.spnAngle.on("change",d.bind(this.onAngleChange,this)),this.spnAngle.on("inputleave",function(){Common.NotificationCenter.trigger("edit:complete",o)}),this.spnGradPosition=new Common.UI.MetricSpinner({el:l("#cell-gradient-position"),step:1,width:60,defaultUnit:"%",value:"50 %",allowDecimal:!1,maxValue:100,minValue:0,disabled:this._locked,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.lockedControls.push(this.spnGradPosition),this.spnGradPosition.on("change",d.bind(this.onPositionChange,this)),this.spnGradPosition.on("inputleave",function(){Common.NotificationCenter.trigger("edit:complete",o)}),this.btnAddGradientStep=new Common.UI.Button({parentEl:l("#cell-gradient-add-step"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-add-breakpoint",disabled:this._locked,hint:this.tipAddGradientPoint,dataHint:"1",dataHintDirection:"bottom"}),this.btnAddGradientStep.on("click",d.bind(this.onAddGradientStep,this)),this.lockedControls.push(this.btnAddGradientStep),this.btnRemoveGradientStep=new Common.UI.Button({parentEl:l("#cell-gradient-remove-step"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-remove-breakpoint",disabled:this._locked,hint:this.tipRemoveGradientPoint,dataHint:"1",dataHintDirection:"bottom"}),this.btnRemoveGradientStep.on("click",d.bind(this.onRemoveGradientStep,this)),this.lockedControls.push(this.btnRemoveGradientStep),this.chWrap=new Common.UI.CheckBox({el:l("#cell-checkbox-wrap"),labelText:this.strWrap,disabled:this._locked,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.lockedControls.push(this.chWrap),this.chWrap.on("change",this.onWrapChange.bind(this)),this.chShrink=new Common.UI.CheckBox({el:l("#cell-checkbox-shrink"),labelText:this.strShrink,disabled:this._locked,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.lockedControls.push(this.chShrink),this.chShrink.on("change",this.onShrinkChange.bind(this)),this.btnCondFormat=new Common.UI.Button({parentEl:l("#cell-btn-cond-format"),cls:"btn-toolbar align-left",iconCls:"toolbar__icon btn-cond-format",caption:this.textCondFormat,style:"width: 100%;",menu:!0,disabled:this._locked,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.lockedControls.push(this.btnCondFormat)},createDelayedElements:function(){this.UpdateThemeColors(),this.btnCondFormat.setMenu(new Common.UI.Menu({items:[{caption:Common.define.conditionalData.textValue,menu:new Common.UI.Menu({menuAlign:"tl-tr",items:[{caption:Common.define.conditionalData.textGreater,type:Asc.c_oAscCFType.cellIs,value:Asc.c_oAscCFOperator.greaterThan},{caption:Common.define.conditionalData.textGreaterEq,type:Asc.c_oAscCFType.cellIs,value:Asc.c_oAscCFOperator.greaterThanOrEqual},{caption:Common.define.conditionalData.textLess,type:Asc.c_oAscCFType.cellIs,value:Asc.c_oAscCFOperator.lessThan},{caption:Common.define.conditionalData.textLessEq,type:Asc.c_oAscCFType.cellIs,value:Asc.c_oAscCFOperator.lessThanOrEqual},{caption:Common.define.conditionalData.textEqual,type:Asc.c_oAscCFType.cellIs,value:Asc.c_oAscCFOperator.equal},{caption:Common.define.conditionalData.textNotEqual,type:Asc.c_oAscCFType.cellIs,value:Asc.c_oAscCFOperator.notEqual},{caption:Common.define.conditionalData.textBetween,type:Asc.c_oAscCFType.cellIs,value:Asc.c_oAscCFOperator.between},{caption:Common.define.conditionalData.textNotBetween,type:Asc.c_oAscCFType.cellIs,value:Asc.c_oAscCFOperator.notBetween}]})},{caption:Common.define.conditionalData.textTop+"/"+Common.define.conditionalData.textBottom,type:Asc.c_oAscCFType.top10,menu:new Common.UI.Menu({menuAlign:"tl-tr",items:[{caption:Common.define.conditionalData.textTop+" 10 "+this.textItems,type:Asc.c_oAscCFType.top10,value:0,percent:!1},{caption:Common.define.conditionalData.textTop+" 10%",type:Asc.c_oAscCFType.top10,value:0,percent:!0},{caption:Common.define.conditionalData.textBottom+" 10 "+this.textItems,type:Asc.c_oAscCFType.top10,value:1,percent:!1},{caption:Common.define.conditionalData.textBottom+" 10%",type:Asc.c_oAscCFType.top10,value:1,percent:!0}]})},{caption:Common.define.conditionalData.textAverage,menu:new Common.UI.Menu({menuAlign:"tl-tr",items:[{caption:Common.define.conditionalData.textAbove,type:Asc.c_oAscCFType.aboveAverage,value:0},{caption:Common.define.conditionalData.textBelow,type:Asc.c_oAscCFType.aboveAverage,value:1},{caption:Common.define.conditionalData.textEqAbove,type:Asc.c_oAscCFType.aboveAverage,value:2},{caption:Common.define.conditionalData.textEqBelow,type:Asc.c_oAscCFType.aboveAverage,value:3},{caption:Common.define.conditionalData.text1Above,type:Asc.c_oAscCFType.aboveAverage,value:4},{caption:Common.define.conditionalData.text1Below,type:Asc.c_oAscCFType.aboveAverage,value:5},{caption:Common.define.conditionalData.text2Above,type:Asc.c_oAscCFType.aboveAverage,value:6},{caption:Common.define.conditionalData.text2Below,type:Asc.c_oAscCFType.aboveAverage,value:7},{caption:Common.define.conditionalData.text3Above,type:Asc.c_oAscCFType.aboveAverage,value:8},{caption:Common.define.conditionalData.text3Below,type:Asc.c_oAscCFType.aboveAverage,value:9}]})},{caption:Common.define.conditionalData.textText,menu:new Common.UI.Menu({menuAlign:"tl-tr",items:[{caption:Common.define.conditionalData.textContains,type:Asc.c_oAscCFType.containsText},{caption:Common.define.conditionalData.textNotContains,type:Asc.c_oAscCFType.notContainsText},{caption:Common.define.conditionalData.textBegins,type:Asc.c_oAscCFType.beginsWith},{caption:Common.define.conditionalData.textEnds,type:Asc.c_oAscCFType.endsWith}]})},{caption:Common.define.conditionalData.textDate,menu:new Common.UI.Menu({menuAlign:"tl-tr",items:[{caption:Common.define.conditionalData.textYesterday,type:Asc.c_oAscCFType.timePeriod,value:Asc.c_oAscTimePeriod.yesterday},{caption:Common.define.conditionalData.textToday,type:Asc.c_oAscCFType.timePeriod,value:Asc.c_oAscTimePeriod.today},{caption:Common.define.conditionalData.textTomorrow,type:Asc.c_oAscCFType.timePeriod,value:Asc.c_oAscTimePeriod.tomorrow},{caption:Common.define.conditionalData.textLast7days,type:Asc.c_oAscCFType.timePeriod,value:Asc.c_oAscTimePeriod.last7Days},{caption:Common.define.conditionalData.textLastWeek,type:Asc.c_oAscCFType.timePeriod,value:Asc.c_oAscTimePeriod.lastWeek},{caption:Common.define.conditionalData.textThisWeek,type:Asc.c_oAscCFType.timePeriod,value:Asc.c_oAscTimePeriod.thisWeek},{caption:Common.define.conditionalData.textNextWeek,type:Asc.c_oAscCFType.timePeriod,value:Asc.c_oAscTimePeriod.nextWeek},{caption:Common.define.conditionalData.textLastMonth,type:Asc.c_oAscCFType.timePeriod,value:Asc.c_oAscTimePeriod.lastMonth},{caption:Common.define.conditionalData.textThisMonth,type:Asc.c_oAscCFType.timePeriod,value:Asc.c_oAscTimePeriod.thisMonth},{caption:Common.define.conditionalData.textNextMonth,type:Asc.c_oAscCFType.timePeriod,value:Asc.c_oAscTimePeriod.nextMonth}]})},{caption:Common.define.conditionalData.textBlank+"/"+Common.define.conditionalData.textError,menu:new Common.UI.Menu({menuAlign:"tl-tr",items:[{caption:Common.define.conditionalData.textBlanks,type:Asc.c_oAscCFType.containsBlanks},{caption:Common.define.conditionalData.textNotBlanks,type:Asc.c_oAscCFType.notContainsBlanks},{caption:Common.define.conditionalData.textErrors,type:Asc.c_oAscCFType.containsErrors},{caption:Common.define.conditionalData.textNotErrors,type:Asc.c_oAscCFType.notContainsErrors}]})},{caption:Common.define.conditionalData.textDuplicate+"/"+Common.define.conditionalData.textUnique,menu:new Common.UI.Menu({menuAlign:"tl-tr",items:[{caption:Common.define.conditionalData.textDuplicate,type:Asc.c_oAscCFType.duplicateValues},{caption:Common.define.conditionalData.textUnique,type:Asc.c_oAscCFType.uniqueValues}]})},{caption:"--"},this.mnuDataBars=new Common.UI.MenuItem({caption:this.textDataBars,type:Asc.c_oAscCFType.dataBar,menu:new Common.UI.Menu({menuAlign:"tl-tr",style:"min-width: auto;",items:[]})}),this.mnuColorScales=new Common.UI.MenuItem({caption:this.textColorScales,type:Asc.c_oAscCFType.colorScale,menu:new Common.UI.Menu({menuAlign:"tl-tr",style:"min-width: auto;",items:[]})}),this.mnuIconSets=new Common.UI.MenuItem({caption:Common.define.conditionalData.textIconSets,type:Asc.c_oAscCFType.iconSet,menu:new Common.UI.Menu({menuAlign:"tl-tr",style:"min-width: auto;",items:[]})}),{caption:"--"},{caption:Common.define.conditionalData.textFormula,type:Asc.c_oAscCFType.expression},{caption:"--"},{caption:this.textNewRule,value:"new"},{caption:this.textClearRule,menu:new Common.UI.Menu({menuAlign:"tl-tr",items:[{value:"clear",type:Asc.c_oAscSelectionForCFType.selection,caption:this.textSelection},{value:"clear",type:Asc.c_oAscSelectionForCFType.worksheet,caption:this.textThisSheet},{value:"clear",type:Asc.c_oAscSelectionForCFType.table,caption:this.textThisTable},{value:"clear",type:Asc.c_oAscSelectionForCFType.pivot,caption:this.textThisPivot}]})},{caption:this.textManageRule,value:"manage"}]})),this.btnCondFormat.menu.on("show:before",d.bind(function(){this.fireEvent("cf:init",[this,"cell"])},this)),this._initSettings=!1},ChangeSettings:function(t){if(this._initSettings&&this.createDelayedElements(),this.disableControls(this._locked),t){this._noApply=!0;var t=t.asc_getXfs(),e=t.asc_getAngle();if((.1<Math.abs(this._state.CellAngle-e)||void 0===this._state.CellAngle&&this._state.CellAngle!==e)&&(this.spnAngle.setValue(null!==e?255==e?0:e:"",!0),this._state.CellAngle=e),e=t.asc_getIndent(),(.1<Math.abs(this._state.CellIndent-e)||void 0===this._state.CellIndent&&this._state.CellIndent!==e)&&(this.spnIndent.setValue(null!==e?e:"",!0),this._state.CellIndent=e),e=t.asc_getWrapText(),this._state.Wrap!==e&&(this.chWrap.setValue(null!=e?e:"indeterminate",!0),this._state.Wrap=e),this.chWrap.setDisabled(t.asc_getHorAlign()==AscCommon.align_Justify||this._locked),e=t.asc_getShrinkToFit(),this._state.Shrink!==e&&(this.chShrink.setValue(null!=e?e:"indeterminate",!0),this._state.Shrink=e),this.chShrink.setDisabled("checked"==this.chWrap.getValue()||this._locked),this.fill=t.asc_getFill(),this.fill){if(this.pattern=this.fill.asc_getPatternFill(),this.gradient=this.fill.asc_getGradientFill(),null===this.pattern&&null===this.gradient)this.CellColor={Value:0,Color:"transparent"},this.FGColor={Value:1,Color:{color:"4f81bd",effectId:24}},this.BGColor={Value:1,Color:"ffffff"},this.sldrGradient.setThumbs(2),this.GradColor.colors.length=0,this.GradColor.values.length=0,this.GradColor.colors[0]={color:"4f81bd",effectId:24},this.GradColor.colors[1]="ffffff",this.GradColor.values=[0,100],this.GradColor.currentIdx=0,this.OriginalFillType=Asc.c_oAscFill.FILL_TYPE_NOFILL;else if(null!==this.pattern)-1===this.pattern.asc_getType()?((a=this.pattern.asc_getFgColor())?(a.asc_getType()==Asc.c_oAscColor.COLOR_TYPE_SCHEME?this.CellColor={Value:1,Color:{color:Common.Utils.ThemeColor.getHexColor(a.asc_getR(),a.asc_getG(),a.asc_getB()),effectValue:a.asc_getValue()}}:this.CellColor={Value:1,Color:Common.Utils.ThemeColor.getHexColor(a.asc_getR(),a.asc_getG(),a.asc_getB())},this.FGColor={Value:1,Color:Common.Utils.ThemeColor.colorValue2EffectId(this.CellColor.Color)}):this.FGColor=this.CellColor={Value:1,Color:"ffffff"},this.BGColor={Value:1,Color:"ffffff"},this.sldrGradient.setThumbs(2),this.GradColor.colors.length=0,this.GradColor.values.length=0,this.GradColor.values=[0,100],this.GradColor.colors[0]=Common.Utils.ThemeColor.colorValue2EffectId(this.CellColor.Color),this.GradColor.colors[1]="ffffff",this.GradColor.currentIdx=0,this.OriginalFillType=Asc.c_oAscFill.FILL_TYPE_SOLID):(this.PatternFillType=this.pattern.asc_getType(),this._state.PatternFillType!==this.PatternFillType&&(this.cmbPattern.suspendEvents(),t=this.cmbPattern.menuPicker.store.findWhere({type:this.PatternFillType}),this.cmbPattern.menuPicker.selectRecord(t),this.cmbPattern.resumeEvents(),this._state.PatternFillType=this.PatternFillType),(a=this.pattern.asc_getFgColor())?a.asc_getType()==Asc.c_oAscColor.COLOR_TYPE_SCHEME?this.FGColor={Value:1,Color:{color:Common.Utils.ThemeColor.getHexColor(a.asc_getR(),a.asc_getG(),a.asc_getB()),effectValue:a.asc_getValue()}}:this.FGColor={Value:1,Color:Common.Utils.ThemeColor.getHexColor(a.asc_getR(),a.asc_getG(),a.asc_getB())}:this.FGColor={Value:1,Color:{color:"000000",effectId:24}},(a=this.pattern.asc_getBgColor())?a.asc_getType()==Asc.c_oAscColor.COLOR_TYPE_SCHEME?this.BGColor={Value:1,Color:{color:Common.Utils.ThemeColor.getHexColor(a.asc_getR(),a.asc_getG(),a.asc_getB()),effectValue:a.asc_getValue()}}:this.BGColor={Value:1,Color:Common.Utils.ThemeColor.getHexColor(a.asc_getR(),a.asc_getG(),a.asc_getB())}:this.BGColor={Value:1,Color:"ffffff"},this.CellColor={Value:1,Color:Common.Utils.ThemeColor.colorValue2EffectId(this.FGColor.Color)},this.sldrGradient.setThumbs(2),this.GradColor.colors.length=0,this.GradColor.values.length=0,this.GradColor.values=[0,100],this.GradColor.colors[0]=Common.Utils.ThemeColor.colorValue2EffectId(this.FGColor.Color),this.GradColor.colors[1]="ffffff",this.GradColor.currentIdx=0,this.OriginalFillType=Asc.c_oAscFill.FILL_TYPE_PATT);else if(null!==this.gradient){for(var t=this.gradient.asc_getType(),i=(this._state.GradFillType===t&&this.GradFillType===t||(this.GradFillType=t,this._state.GradFillType=this.GradFillType),this.GradFillType==Asc.c_oAscFillGradType.GRAD_LINEAR&&(e=this.gradient.asc_getDegree(),.001<Math.abs(this.GradLinearDirectionType-e)&&(this.GradLinearDirectionType=e,a=this.mnuDirectionPicker.store.findWhere({type:e}),this.mnuDirectionPicker.selectRecord(a,!0),this.typeGradient=a?e+90:-1,this.numGradientAngle.setValue(e,!0))),this),t=this.gradient.asc_getGradientStops(),s=t.length,o=(this.sldrGradient.setThumbs(s),this.GradColor.colors.length=0,this.GradColor.values.length=0,t.forEach(function(t){var e=t.asc_getColor(),t=t.asc_getPosition();i.GradColor.colors.push(e.asc_getType()==Asc.c_oAscColor.COLOR_TYPE_SCHEME?{color:Common.Utils.ThemeColor.getHexColor(e.asc_getR(),e.asc_getG(),e.asc_getB()),effectValue:e.asc_getValue()}:Common.Utils.ThemeColor.getHexColor(e.asc_getR(),e.asc_getG(),e.asc_getB())),i.GradColor.values.push(100*t)}),[]),n=0;n<s;n++)i.sldrGradient.setColorValue(Common.Utils.String.format("#{0}","object"==typeof i.GradColor.colors[n]?i.GradColor.colors[n].color:i.GradColor.colors[n]),n),i.sldrGradient.setValue(n,i.GradColor.values[n]),o.push(i.sldrGradient.getColorValue(n)+" "+i.sldrGradient.getValue(n)+"%");this.btnDirectionRedraw(i.sldrGradient,o.join(", ")),(d.isUndefined(i.GradColor.currentIdx)||i.GradColor.currentIdx>=i.GradColor.colors.length)&&(i.GradColor.currentIdx=0),i.sldrGradient.setActiveThumb(i.GradColor.currentIdx);var a=this.GradColor.values[this.GradColor.currentIdx];this.spnGradPosition.setValue(Common.UI.isRTL()?this.sldrGradient.maxValue-a:a),this.OriginalFillType=Asc.c_oAscFill.FILL_TYPE_GRAD,this.FGColor={Value:1,Color:Common.Utils.ThemeColor.colorValue2EffectId(this.GradColor.colors[0])},this.BGColor={Value:1,Color:"ffffff"},this.CellColor={Value:1,Color:Common.Utils.ThemeColor.colorValue2EffectId(this.GradColor.colors[0])}}this._state.FillType!==this.OriginalFillType&&(this.cmbFillSrc.setValue(null===this.OriginalFillType?"":this.OriginalFillType),this._state.FillType=this.OriginalFillType,this.ShowHideElem(this.OriginalFillType));e=typeof this.CellColor.Color;if(e!=typeof this._state.CellColor||"object"==e&&(this.CellColor.Color.effectValue!==this._state.CellColor.effectValue||this._state.CellColor.color.indexOf(this.CellColor.Color)<0)||"object"!=e&&void 0!==this._state.CellColor&&this._state.CellColor.indexOf(this.CellColor.Color)<0){if(this.btnBackColor.setColor(this.CellColor.Color),d.isObject(this.CellColor.Color)){for(var l=!1,r=0;r<10;r++)if(Common.Utils.ThemeColor.ThemeValues[r]==this.CellColor.Color.effectValue){this.colorsBack.select(this.CellColor.Color,!0),l=!0;break}l||this.colorsBack.clearSelection()}else this.colorsBack.select(this.CellColor.Color,!0);this._state.CellColor=this.CellColor.Color}if((e=typeof this.FGColor.Color)!=typeof this._state.FGColor||"object"==e&&(this.FGColor.Color.effectValue!==this._state.FGColor.effectValue||this._state.FGColor.color.indexOf(this.FGColor.Color.color)<0)||"object"!=e&&this._state.FGColor.indexOf(this.FGColor.Color)<0){if(this.btnFGColor.setColor(this.FGColor.Color),"object"==typeof this.FGColor.Color){for(l=!1,r=0;r<10;r++)if(Common.Utils.ThemeColor.ThemeValues[r]==this.FGColor.Color.effectValue){this.colorsFG.select(this.FGColor.Color,!0),l=!0;break}l||this.colorsFG.clearSelection()}else this.colorsFG.select(this.FGColor.Color,!0);this._state.FGColor=this.FGColor.Color}if((e=typeof this.BGColor.Color)!=typeof this._state.BGColor||"object"==e&&(this.BGColor.Color.effectValue!==this._state.BGColor.effectValue||this._state.BGColor.color.indexOf(this.BGColor.Color.color)<0)||"object"!=e&&this._state.BGColor.indexOf(this.BGColor.Color)<0){if(this.btnBGColor.setColor(this.BGColor.Color),"object"==typeof this.BGColor.Color){for(l=!1,r=0;r<10;r++)if(Common.Utils.ThemeColor.ThemeValues[r]==this.BGColor.Color.effectValue){this.colorsBG.select(this.BGColor.Color,!0),l=!0;break}l||this.colorsBG.clearSelection()}else this.colorsBG.select(this.BGColor.Color,!0);this._state.BGColor=this.BGColor.Color}var c=this.GradColor.colors[this.GradColor.currentIdx];if((e=typeof c)!=typeof this._state.GradColor||"object"==e&&(c.effectValue!==this._state.GradColor.effectValue||this._state.GradColor.color.indexOf(c.color)<0)||"object"!=e&&this._state.GradColor.indexOf(c)<0){if(this.btnGradColor.setColor(c),"object"==typeof c){for(l=!1,r=0;r<10;r++)if(Common.Utils.ThemeColor.ThemeValues[r]==c.effectValue){this.colorsGrad.select(c,!0),l=!0;break}l||this.colorsGrad.clearSelection()}else this.colorsGrad.select(c,!0);this._state.GradColor=c}this._noApply=!1}}},btnDirectionRedraw:function(t,e){this.gradientColorsStr=e,d.each(this._viewDataLinear,function(t){t.gradientColorsStr=e}),this.mnuDirectionPicker.store.each(function(t){t.set("gradientColorsStr",e)},this),-1==this.typeGradient?this.btnDirection.$icon.css({background:"none"}):2==this.typeGradient?this.btnDirection.$icon.css({background:"radial-gradient("+e+")"}):this.btnDirection.$icon.css({background:"linear-gradient("+this.typeGradient+"deg, "+e+")"})},UpdateThemeColors:function(){this.borderColor||(this.btnBorderColor.setMenu(),this.borderColor=this.btnBorderColor.getPicker(),this.btnBorderColor.on("eyedropper:start",d.bind(this.onEyedropperStart,this)),this.btnBorderColor.on("eyedropper:end",d.bind(this.onEyedropperEnd,this)),this.btnBackColor.setMenu(),this.btnBackColor.on("color:select",d.bind(this.onColorsBackSelect,this)),this.btnBackColor.on("eyedropper:start",d.bind(this.onEyedropperStart,this)),this.btnBackColor.on("eyedropper:end",d.bind(this.onEyedropperEnd,this)),this.colorsBack=this.btnBackColor.getPicker(),this.fillControls.push(this.btnBackColor),this.btnGradColor=new Common.UI.ColorButton({parentEl:l("#cell-gradient-color-btn"),color:"000000",eyeDropper:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.fillControls.push(this.btnGradColor),this.colorsGrad=this.btnGradColor.getPicker(),this.btnGradColor.on("color:select",d.bind(this.onColorsGradientSelect,this)),this.btnGradColor.on("eyedropper:start",d.bind(this.onEyedropperStart,this)),this.btnGradColor.on("eyedropper:end",d.bind(this.onEyedropperEnd,this)),this.btnFGColor=new Common.UI.ColorButton({parentEl:l("#cell-foreground-color-btn"),color:"000000",eyeDropper:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"medium"}),this.fillControls.push(this.btnFGColor),this.colorsFG=this.btnFGColor.getPicker(),this.btnFGColor.on("color:select",d.bind(this.onColorsFGSelect,this)),this.btnFGColor.on("eyedropper:start",d.bind(this.onEyedropperStart,this)),this.btnFGColor.on("eyedropper:end",d.bind(this.onEyedropperEnd,this)),this.btnBGColor=new Common.UI.ColorButton({parentEl:l("#cell-background-color-btn"),color:"ffffff",eyeDropper:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"medium"}),this.fillControls.push(this.btnBGColor),this.colorsBG=this.btnBGColor.getPicker(),this.btnBGColor.on("color:select",d.bind(this.onColorsBGSelect,this)),this.btnBGColor.on("eyedropper:start",d.bind(this.onEyedropperStart,this)),this.btnBGColor.on("eyedropper:end",d.bind(this.onEyedropperEnd,this))),this.colorsBack.updateColors(Common.Utils.ThemeColor.getEffectColors(),Common.Utils.ThemeColor.getStandartColors()),this.borderColor.updateColors(Common.Utils.ThemeColor.getEffectColors(),Common.Utils.ThemeColor.getStandartColors()),this.btnBorderColor.isAutoColor()||this.btnBorderColor.setColor(this.borderColor.getColor()),this.colorsGrad.updateColors(Common.Utils.ThemeColor.getEffectColors(),Common.Utils.ThemeColor.getStandartColors()),this.colorsFG.updateColors(Common.Utils.ThemeColor.getEffectColors(),Common.Utils.ThemeColor.getStandartColors()),this.colorsBG.updateColors(Common.Utils.ThemeColor.getEffectColors(),Common.Utils.ThemeColor.getStandartColors())},onApiEditCell:function(t){this.isEditCell=t!=Asc.c_oAscCellEditorState.editEnd,t!=Asc.c_oAscCellEditorState.editStart&&t!=Asc.c_oAscCellEditorState.editEnd||this.disableControls(this._locked)},setLocked:function(t){this._locked=t},disableFillPanels:function(e){this._state.DisabledFillPanels!==e&&(this._state.DisabledFillPanels=e,d.each(this.fillControls,function(t){t.setDisabled(e)}))},disableControls:function(e){this._initSettings||(e=e||this.isEditCell,this.disableFillPanels(e),this._state.DisabledControls!==e&&(this._state.DisabledControls=e,d.each(this.lockedControls,function(t){t.setDisabled(e)})))},onFillSrcSelect:function(t,e){var i,s,o,n=this;switch(this.ShowHideElem(e.value),e.value){case Asc.c_oAscFill.FILL_TYPE_SOLID:this._state.FillType=Asc.c_oAscFill.FILL_TYPE_SOLID,this._noApply||(null==this.pattern&&(this.pattern=new Asc.asc_CPatternFill),this.pattern.asc_setType(-1),this.pattern.asc_setFgColor(Common.Utils.ThemeColor.getRgbColor("transparent"==this.CellColor.Color?{color:"4f81bd",effectId:24}:this.CellColor.Color)),this.fill.asc_setPatternFill(this.pattern),this.api.asc_setCellFill(this.fill));break;case Asc.c_oAscFill.FILL_TYPE_GRAD:this._state.FillType=Asc.c_oAscFill.FILL_TYPE_GRAD,this._noApply||(null==this.gradient&&(this.gradient=new Asc.asc_CGradientFill),this.gradient.asc_setType(this.GradFillType),this.GradFillType==Asc.c_oAscFillGradType.GRAD_LINEAR&&this.gradient.asc_setDegree(this.GradLinearDirectionType),this.OriginalFillType!==Asc.c_oAscFill.FILL_TYPE_GRAD&&(this.GradColor.currentIdx=0,2===this.GradColor.colors.length&&(o=Common.Utils.ThemeColor.getRgbColor(this.GradColor.colors[0]).get_color().get_hex(),i=Common.Utils.ThemeColor.getRgbColor(this.GradColor.colors[1]).get_color().get_hex(),"ffffff"===o&&"ffffff"===i&&(this.GradColor.colors[0]={color:"4f81bd",effectId:24})),s=[],this.GradColor.colors.forEach(function(t,e){var i=new Asc.asc_CGradientStop;i.asc_setColor(Common.Utils.ThemeColor.getRgbColor(n.GradColor.colors[e])),i.asc_setPosition(n.GradColor.values[e]/100),s.push(i)}),this.gradient.asc_putGradientStops(s)),this.fill.asc_setGradientFill(this.gradient),this.api.asc_setCellFill(this.fill));break;case Asc.c_oAscFill.FILL_TYPE_PATT:this._state.FillType=Asc.c_oAscFill.FILL_TYPE_PATT,this._noApply||(o=Common.Utils.ThemeColor.getRgbColor(this.FGColor.Color).get_color().get_hex(),o="ffffff"===Common.Utils.ThemeColor.getRgbColor(this.BGColor.Color).get_color().get_hex()&&"ffffff"===o?{color:"4f81bd",effectId:24}:this.FGColor.Color,null==this.pattern&&(this.pattern=new Asc.asc_CPatternFill),this.pattern.asc_setType(this.PatternFillType),this.pattern.asc_setFgColor(Common.Utils.ThemeColor.getRgbColor(o)),this.pattern.asc_setBgColor(Common.Utils.ThemeColor.getRgbColor(this.BGColor.Color)),this.fill.asc_setPatternFill(this.pattern),this.api.asc_setCellFill(this.fill));break;case Asc.c_oAscFill.FILL_TYPE_NOFILL:this._state.FillType=Asc.c_oAscFill.FILL_TYPE_NOFILL,this._noApply||(this.fill.asc_setPatternFill(null),this.fill.asc_setGradientFill(null),this.api.asc_setCellFill(this.fill))}Common.NotificationCenter.trigger("edit:complete",this)},ShowHideElem:function(t){this.FillColorContainer.toggleClass("settings-hidden",t!==Asc.c_oAscFill.FILL_TYPE_SOLID),this.FillPatternContainer.toggleClass("settings-hidden",t!==Asc.c_oAscFill.FILL_TYPE_PATT),this.FillGradientContainer.toggleClass("settings-hidden",t!==Asc.c_oAscFill.FILL_TYPE_GRAD)},onSelectGradient:function(t,e,i,s){var o=this;if(!this._noApply){var n,a={};if(d.isFunction(s.toJSON)){if(!s.get("selected"))return;a=s.toJSON()}else a=s;this.typeGradient=a.type+90,this.GradLinearDirectionType=a.type,this.numGradientAngle.setValue(a.type,!0),this.api&&this.GradFillType==Asc.c_oAscFillGradType.GRAD_LINEAR&&(null==this.gradient&&(this.gradient=new Asc.asc_CGradientFill,this.gradient.asc_setType(this.GradFillType),n=[],this.GradColor.values.forEach(function(t,e){var i=new Asc.asc_CGradientStop;i.asc_setColor(Common.Utils.ThemeColor.getRgbColor(o.GradColor.colors[e])),i.asc_setPosition(o.GradColor.values[e]/100),n.push(i)}),this.gradient.asc_putGradientStops(n)),this.gradient.asc_setDegree(a.type),this.fill.asc_setGradientFill(this.gradient),this.api.asc_setCellFill(this.fill)),Common.NotificationCenter.trigger("edit:complete",this)}},onColorsGradientSelect:function(t,e){var s,o=this;this.GradColor.colors[this.GradColor.currentIdx]=e,this.sldrGradient.setColorValue(Common.Utils.String.format("#{0}","object"==typeof e?e.color:e)),this.api&&!this._noApply&&(null==this.gradient&&(this.gradient=new Asc.asc_CGradientFill,this.gradient.asc_setType(this.GradFillType),this.GradFillType==Asc.c_oAscFillGradType.GRAD_LINEAR&&this.gradient.asc_setDegree(this.GradLinearDirectionType)),s=[],this.GradColor.values.forEach(function(t,e){var i=new Asc.asc_CGradientStop;i.asc_setColor(Common.Utils.ThemeColor.getRgbColor(Common.Utils.ThemeColor.colorValue2EffectId(o.GradColor.colors[e]))),i.asc_setPosition(o.GradColor.values[e]/100),s.push(i)}),this.gradient.asc_putGradientStops(s),this.fill.asc_setGradientFill(this.gradient),this.api.asc_setCellFill(this.fill)),Common.NotificationCenter.trigger("edit:complete",this)},onGradientAngleChange:function(t,e,i,s){this.api&&!this._noApply&&(null==this.gradient&&(this.gradient=new Asc.asc_CGradientFill,this.gradient.asc_setType(this.GradFillType)),this.GradFillType==Asc.c_oAscFillGradType.GRAD_LINEAR&&this.gradient.asc_setDegree(t.getNumberValue()),this.fill.asc_setGradientFill(this.gradient),this.api.asc_setCellFill(this.fill))},onGradientChange:function(t,e,i){this.GradColor.values=t.getValues();t=this.GradColor.values[this.GradColor.currentIdx];this.spnGradPosition.setValue(Common.UI.isRTL()?this.sldrGradient.maxValue-t:t,!0),this._sliderChanged=!0,this.api&&!this._noApply&&this._sendUndoPoint&&(this.api.setStartPointHistory(),this._sendUndoPoint=!1,this.updateslider=setInterval(d.bind(this._gradientApplyFunc,this),100))},onGradientChangeComplete:function(t,e,i){clearInterval(this.updateslider),this._sliderChanged=!0,this._sendUndoPoint||(this.api.setEndPointHistory(),this._gradientApplyFunc()),this._sendUndoPoint=!0},_gradientApplyFunc:function(){var s,o;this._sliderChanged&&(null==(s=this).gradient&&(this.gradient=new Asc.asc_CGradientFill),o=[],this.GradColor.colors.forEach(function(t,e){var i=new Asc.asc_CGradientStop;i.asc_setColor(Common.Utils.ThemeColor.getRgbColor(Common.Utils.ThemeColor.colorValue2EffectId(s.GradColor.colors[e]))),i.asc_setPosition(s.GradColor.values[e]/100),o.push(i)}),this.gradient.asc_putGradientStops(o),this.fill.asc_setGradientFill(this.gradient),this.api.asc_setCellFill(this.fill),this._sliderChanged=!1)},onPatternSelect:function(t,e){this.api&&!this._noApply&&(this.PatternFillType=e.get("type"),null==this.pattern&&(this.pattern=new Asc.asc_CPatternFill,this.pattern.asc_setFgColor(Common.Utils.ThemeColor.getRgbColor(this.FGColor.Color)),this.pattern.asc_setBgColor(Common.Utils.ThemeColor.getRgbColor(this.BGColor.Color))),this.pattern.asc_setType(this.PatternFillType),this.fill.asc_setPatternFill(this.pattern),this.api.asc_setCellFill(this.fill)),Common.NotificationCenter.trigger("edit:complete",this)},onColorsFGSelect:function(t,e){this.FGColor={Value:1,Color:e},this.api&&!this._noApply&&(null==this.pattern&&(this.pattern=new Asc.asc_CPatternFill,this.pattern.asc_setType(this.PatternFillType),this.pattern.asc_setBgColor(Common.Utils.ThemeColor.getRgbColor(this.BGColor.Color))),this.pattern.asc_setFgColor(Common.Utils.ThemeColor.getRgbColor(this.FGColor.Color)),this.fill.asc_setPatternFill(this.pattern),this.api.asc_setCellFill(this.fill)),Common.NotificationCenter.trigger("edit:complete",this)},onColorsBGSelect:function(t,e){this.BGColor={Value:1,Color:e},this.api&&!this._noApply&&(null==this.pattern&&(this.pattern=new Asc.asc_CPatternFill,this.pattern.asc_setFgColor(Common.Utils.ThemeColor.getRgbColor(this.FGColor.Color)),this.pattern.asc_setType(this.PatternFillType)),this.pattern.asc_setBgColor(Common.Utils.ThemeColor.getRgbColor(this.BGColor.Color)),this.fill.asc_setPatternFill(this.pattern),this.api.asc_setCellFill(this.fill)),Common.NotificationCenter.trigger("edit:complete",this)},onWrapChange:function(t,e,i,s){this.api&&!this._noApply&&this.api.asc_setCellTextWrap("checked"==t.getValue()),this.chShrink.setDisabled("checked"==t.getValue()||this._locked),Common.NotificationCenter.trigger("edit:complete",this)},onShrinkChange:function(t,e,i,s){this.api&&!this._noApply&&this.api.asc_setCellTextShrink("checked"==t.getValue()),Common.NotificationCenter.trigger("edit:complete",this)},onPositionChange:function(t){var s,o=this,t=t.getNumberValue(),e=(Common.UI.isRTL()&&(t=this.sldrGradient.maxValue-t),this.GradColor.currentIdx-1<0?0:this.GradColor.values[this.GradColor.currentIdx-1]),i=this.GradColor.currentIdx+1<this.GradColor.values.length?this.GradColor.values[this.GradColor.currentIdx+1]:100,e=t<e||i<t;this.api&&(this.GradColor.values[this.GradColor.currentIdx]=t,null==this.gradient&&(this.gradient=new Asc.asc_CGradientFill,this.gradient.asc_setType(this.GradFillType)),s=[],this.GradColor.values.forEach(function(t,e){var i=new Asc.asc_CGradientStop;i.asc_setColor(Common.Utils.ThemeColor.getRgbColor(Common.Utils.ThemeColor.colorValue2EffectId(o.GradColor.colors[e]))),i.asc_setPosition(o.GradColor.values[e]/100),s.push(i)}),this.gradient.asc_putGradientStops(s),this.fill.asc_setGradientFill(this.gradient),this.api.asc_setCellFill(this.fill),e&&(this.sldrGradient.sortThumbs(),this.sldrGradient.trigger("change",this.sldrGradient),this.sldrGradient.trigger("changecomplete",this.sldrGradient)))},onAddGradientStep:function(){var t,e;9<this.GradColor.colors.length||(t=this.GradColor.currentIdx,e=(this.GradColor.values[t]+this.GradColor.values[t<this.GradColor.colors.length-1?t+1:t-1])/2,this.GradColor.colors[this.GradColor.colors.length]=this.GradColor.colors[t],this.GradColor.currentIdx=this.GradColor.colors.length-1,e=this.sldrGradient.addNewThumb(void 0,e,t),this.GradColor.colors[this.GradColor.currentIdx]=e,this.sldrGradient.trigger("change",this.sldrGradient),this.sldrGradient.trigger("changecomplete",this.sldrGradient))},onRemoveGradientStep:function(){var t;this.GradColor.values.length<3||(t=this.GradColor.currentIdx,this.GradColor.values.splice(this.GradColor.currentIdx,1),this.sldrGradient.removeThumb(this.GradColor.currentIdx),(d.isUndefined(this.GradColor.currentIdx)||this.GradColor.currentIdx>=this.GradColor.colors.length)&&(t=0===(t=0<t?t-1:t)&&2<this.GradColor.values.length?this.GradColor.values.length-2:t,this.GradColor.currentIdx=t),this.sldrGradient.setActiveThumb(this.GradColor.currentIdx))},onEyedropperStart:function(t){this.api.asc_startEyedropper(d.bind(t.eyedropperEnd,t)),this.fireEvent("eyedropper",!0)},onEyedropperEnd:function(){this.fireEvent("eyedropper",!1)}},SSE.Views.CellSettings||{}))}),define("text!spreadsheeteditor/main/app/template/SlicerSettings.template",[],function(){return'<table cols="3">\n    <tr>\n        <td class="padding-large" width="88px">\n            <label class="input-label"><%= scope.textWidth %></label>\n            <div id="slicer-spin-width"></div>\n        </td>\n        <td class="padding-large" width="28px" style="vertical-align: bottom;">\n            <div id="slicer-button-ratio"></div>\n        </td>\n        <td class="padding-large" width="88px">\n            <label class="input-label"><%= scope.textHeight %></label>\n            <div id="slicer-spin-height"></div>\n        </td>\n    </tr>\n</table>\n<table cols="2">\n    <tr>\n        <td class="padding-small" colspan=2>\n            <label class="header"><%= scope.textPosition %></label>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" width="50%">\n            <label class="input-label"><%= scope.textHor %></label>\n            <div id="slicer-spin-hor"></div>\n        </td>\n        <td class="padding-small" width="50%">\n            <label class="input-label"><%= scope.textVert %></label>\n            <div id="slicer-spin-vert"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" colspan=2>\n            <div id="slicer-checkbox-disable-resize"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" colspan=2>\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr>\n        <td colspan=2>\n            <label class="header"><%= scope.textButtons %></label>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" colspan=2>\n            <label class="input-label"><%= scope.textColumns %></label>\n            <div id="slicer-spin-cols" class="margin-left-5"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" width="50%">\n            <label class="input-label"><%= scope.textWidth %></label>\n            <div id="slicer-spin-col-width"></div>\n        </td>\n        <td class="padding-small" width="50%">\n            <label class="input-label"><%= scope.textHeight %></label>\n            <div id="slicer-spin-col-height"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" colspan=2>\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr>\n        <td colspan=2>\n            <label class="header"><%= scope.textStyle %></label>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" colspan=2>\n            <div id="slicer-btn-style" style="width: 100%;"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" colspan=2>\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" colspan=2>\n            <label class="header"><%= scope.strSorting %></label>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" colspan=2>\n            <div id="slicer-radio-asc"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-large" colspan=2>\n            <div id="slicer-radio-desc"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" colspan=2>\n            <div id="slicer-check-hide-nodata"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" colspan=2>\n            <div id="slicer-check-indicate-nodata"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" colspan=2>\n            <div id="slicer-check-show-nodata-last"></div>\n        </td>\n    </tr>\n    \x3c!--<tr>--\x3e\n        \x3c!--<td class="padding-small" colspan=2>--\x3e\n            \x3c!--<div id="slicer-check-show-deleted"></div>--\x3e\n        \x3c!--</td>--\x3e\n    \x3c!--</tr>--\x3e\n    <tr>\n        <td class="padding-small" colspan=2>\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr>\n        <td align="center" colspan=2>\n            <label class="link" id="slicer-advanced-link" data-hint="1" data-hint-direction="bottom" data-hint-offset="medium"><%= scope.textAdvanced %></label>\n        </td>\n    </tr>\n    <tr class="finish-cell"></tr>\n</table>'}),define("spreadsheeteditor/main/app/view/SlicerSettings",["text!spreadsheeteditor/main/app/template/SlicerSettings.template","jquery","underscore","backbone","common/main/lib/component/Button","common/main/lib/component/MetricSpinner","spreadsheeteditor/main/app/view/SlicerSettingsAdvanced"],function(t,a,l,e){"use strict";SSE.Views.SlicerSettings=e.View.extend(l.extend({el:"#id-slicer-settings",template:l.template(t),events:{},options:{alias:"SlicerSettings"},initialize:function(){this._initSettings=!0,this._nRatio=1,this._state={Width:0,Height:0,DisabledControls:!1,keepRatio:!1,ColCount:0,ColWidth:0,ColHeight:0,PosVert:0,PosHor:0,PosLocked:!1,SortOrder:void 0,IndNoData:!1,ShowNoData:!1,HideNoData:!1,DisabledSizeControls:!1},this.spinners=[],this.lockedControls=[],this.sizeControls=[],this._locked=!1,this._noApply=!1,this._originalProps=null,this.styles=null,this.render()},render:function(){a(this.el).html(this.template({scope:this})),this.linkAdvanced=a("#slicer-advanced-link")},setApi:function(t){if(null!=t)return this.api=t,this.api.asc_registerCallback("asc_onSendThemeColors",l.bind(this.onSendThemeColors,this)),this},setMode:function(t){this.mode=t},updateMetricUnit:function(){if(this.spinners){for(var t=0;t<this.spinners.length;t++){var e=this.spinners[t];e.setDefaultUnit(Common.Utils.Metric.getCurrentMetricName()),e.setStep(Common.Utils.Metric.getCurrentMetric()==Common.Utils.Metric.c_MetricUnits.pt?1:.1)}this.spnWidth&&this.spnWidth.setValue(null!==this._state.Width?Common.Utils.Metric.fnRecalcFromMM(this._state.Width):"",!0),this.spnHeight&&this.spnHeight.setValue(null!==this._state.Height?Common.Utils.Metric.fnRecalcFromMM(this._state.Height):"",!0),this.spnColWidth&&this.spnColWidth.setValue(null!==this._state.ColWidth?Common.Utils.Metric.fnRecalcFromMM(this._state.ColWidth):"",!0),this.spnColHeight&&this.spnColHeight.setValue(null!==this._state.ColHeight?Common.Utils.Metric.fnRecalcFromMM(this._state.ColHeight):"",!0);var i=this._state.PosHor;this.spnHor&&this.spnHor.setValue(null!=i?Common.Utils.Metric.fnRecalcFromMM(i):"",!0),i=this._state.PosVert,this.spnVert&&this.spnVert.setValue(null!=i?Common.Utils.Metric.fnRecalcFromMM(i):"",!0)}},createDelayedControls:function(){var t=this;this.spnWidth=new Common.UI.MetricSpinner({el:a("#slicer-spin-width"),step:.1,width:78,defaultUnit:"cm",value:"0 cm",maxValue:5963.9,minValue:0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.spinners.push(this.spnWidth),this.sizeControls.push(this.spnWidth),this.spnHeight=new Common.UI.MetricSpinner({el:a("#slicer-spin-height"),step:.1,width:78,defaultUnit:"cm",value:"0 cm",maxValue:5963.9,minValue:0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.spinners.push(this.spnHeight),this.sizeControls.push(this.spnHeight),this.btnRatio=new Common.UI.Button({parentEl:a("#slicer-button-ratio"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-advanced-ratio",style:"margin-bottom: 1px;",enableToggle:!0,hint:this.textKeepRatio,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.sizeControls.push(this.btnRatio),this.btnRatio.on("click",l.bind(function(t,e){t.pressed&&0<this.spnHeight.getNumberValue()&&(this._nRatio=this.spnWidth.getNumberValue()/this.spnHeight.getNumberValue()),this.api&&this._originalProps&&(this._originalProps.asc_putLockAspect(t.pressed),this.api.asc_setGraphicObjectProps(this._originalProps)),Common.NotificationCenter.trigger("edit:complete",this)},this)),this.spnWidth.on("change",l.bind(this.onWidthChange,this)),this.spnHeight.on("change",l.bind(this.onHeightChange,this)),this.spnWidth.on("inputleave",function(){Common.NotificationCenter.trigger("edit:complete",t)}),this.spnHeight.on("inputleave",function(){Common.NotificationCenter.trigger("edit:complete",t)}),this.spnHor=new Common.UI.MetricSpinner({el:a("#slicer-spin-hor"),step:.1,width:85,defaultUnit:"cm",value:"0 cm",maxValue:5963.9,minValue:0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.spinners.push(this.spnHor),this.sizeControls.push(this.spnHor),this.spnVert=new Common.UI.MetricSpinner({el:a("#slicer-spin-vert"),step:.1,width:85,defaultUnit:"cm",value:"0 cm",maxValue:5963.9,minValue:0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.spinners.push(this.spnVert),this.sizeControls.push(this.spnVert),this.spnHor.on("change",l.bind(this.onHorChange,this)),this.spnVert.on("change",l.bind(this.onVertChange,this)),this.spnHor.on("inputleave",function(){Common.NotificationCenter.trigger("edit:complete",t)}),this.spnVert.on("inputleave",function(){Common.NotificationCenter.trigger("edit:complete",t)}),this.chLock=new Common.UI.CheckBox({el:a("#slicer-checkbox-disable-resize"),labelText:this.textLock,disabled:this._locked,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.lockedControls.push(this.chLock),this.chLock.on("change",this.onLockSlicerChange.bind(this)),this.spnColWidth=new Common.UI.MetricSpinner({el:a("#slicer-spin-col-width"),step:.1,width:85,defaultUnit:"cm",value:"0 cm",maxValue:5963.9,minValue:0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.spinners.push(this.spnColWidth),this.sizeControls.push(this.spnColWidth),this.spnColHeight=new Common.UI.MetricSpinner({el:a("#slicer-spin-col-height"),step:.1,width:85,defaultUnit:"cm",value:"0 cm",maxValue:5963.9,minValue:0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.spinners.push(this.spnColHeight),this.sizeControls.push(this.spnColHeight),this.numCols=new Common.UI.MetricSpinner({el:a("#slicer-spin-cols"),step:1,width:55,defaultUnit:"",defaultValue:1,value:"1",allowDecimal:!1,maxValue:2e4,minValue:1,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.sizeControls.push(this.numCols),this.spnColWidth.on("change",l.bind(this.onColWidthChange,this)),this.spnColHeight.on("change",l.bind(this.onColHeightChange,this)),this.numCols.on("change",l.bind(this.onColChange,this)),this.spnColWidth.on("inputleave",function(){Common.NotificationCenter.trigger("edit:complete",t)}),this.spnColHeight.on("inputleave",function(){Common.NotificationCenter.trigger("edit:complete",t)}),this.numCols.on("inputleave",function(){Common.NotificationCenter.trigger("edit:complete",t)}),this.radioAsc=new Common.UI.RadioBox({el:a("#slicer-radio-asc"),name:"asc-radio-slicer-sort",labelText:this.textAsc+" ("+this.textAZ+")",checked:!0,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.radioAsc.on("change",l.bind(function(t,e,i){e&&this.api&&(this._originalProps&&(this._originalProps.asc_getSlicerProperties().asc_setSortOrder(Asc.ST_tabularSlicerCacheSortOrder.Ascending),this.api.asc_setGraphicObjectProps(this._originalProps)),Common.NotificationCenter.trigger("edit:complete",this))},this)),this.lockedControls.push(this.radioAsc),this.radioDesc=new Common.UI.RadioBox({el:a("#slicer-radio-desc"),name:"asc-radio-slicer-sort",labelText:this.textDesc+" ("+this.textZA+")",checked:!1,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.radioDesc.on("change",l.bind(function(t,e,i){e&&this.api&&(this._originalProps&&(this._originalProps.asc_getSlicerProperties().asc_setSortOrder(Asc.ST_tabularSlicerCacheSortOrder.Descending),this.api.asc_setGraphicObjectProps(this._originalProps)),Common.NotificationCenter.trigger("edit:complete",this))},this)),this.lockedControls.push(this.radioDesc),this.chHideNoData=new Common.UI.CheckBox({el:a("#slicer-check-hide-nodata"),labelText:this.strHideNoData,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.chHideNoData.on("change",l.bind(function(t,e,i,s){t="checked"==t.getValue();this._originalProps&&this.api&&(this._originalProps.asc_getSlicerProperties().asc_setHideItemsWithNoData(t),this.api.asc_setGraphicObjectProps(this._originalProps)),Common.NotificationCenter.trigger("edit:complete",this)},this)),this.lockedControls.push(this.chHideNoData),this.chIndNoData=new Common.UI.CheckBox({el:a("#slicer-check-indicate-nodata"),labelText:this.strIndNoData,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.chIndNoData.on("change",l.bind(function(t,e,i,s){t="checked"==t.getValue();this._originalProps&&this.api&&(this._originalProps.asc_getSlicerProperties().asc_setIndicateItemsWithNoData(t),this.api.asc_setGraphicObjectProps(this._originalProps)),Common.NotificationCenter.trigger("edit:complete",this)},this)),this.lockedControls.push(this.chIndNoData),this.chShowNoData=new Common.UI.CheckBox({el:a("#slicer-check-show-nodata-last"),disabled:!0,labelText:this.strShowNoData,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.chShowNoData.on("change",l.bind(function(t,e,i,s){this._originalProps&&this.api&&(this._originalProps.asc_getSlicerProperties().asc_setShowItemsWithNoDataLast("checked"==t.getValue()),this.api.asc_setGraphicObjectProps(this._originalProps)),Common.NotificationCenter.trigger("edit:complete",this)},this)),this.lockedControls.push(this.chShowNoData),this.chShowDel=new Common.UI.CheckBox({el:a("#slicer-check-show-deleted"),labelText:this.strShowDel,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.chShowDel.on("change",l.bind(function(t,e,i,s){},this)),this.lockedControls.push(this.chShowDel),a(this.el).on("click","#slicer-advanced-link",l.bind(this.openAdvancedSettings,this))},createDelayedElements:function(){this.createDelayedControls(),this.updateMetricUnit(),this._initSettings=!1},onSendThemeColors:function(){this.btnSlicerStyle&&this._originalProps&&this.onInitStyles(this._originalProps.asc_getSlicerProperties().asc_getStylesPictures())},openAdvancedSettings:function(t){if(!this.linkAdvanced.hasClass("disabled")){var i=this;if(i.api&&!this._locked){var e=i.api.asc_getGraphicObjectProps();if(e&&0<e.length)for(var s,o,n=e.length-1;0<=n;n--)if(s=e[n].asc_getObjectType(),o=e[n].asc_getObjectValue(),Asc.c_oAscTypeSelectElement.Image==s){new SSE.Views.SlicerSettingsAdvanced({imageProps:o,api:i.api,styles:i.styles||i._originalProps.asc_getSlicerProperties().asc_getStylesPictures(),handler:function(t,e){"ok"==t&&i.api&&i.api.asc_setGraphicObjectProps(e.imageProps),Common.NotificationCenter.trigger("edit:complete",i)}}).show();break}}}},ChangeSettings:function(t){var e,i;this._initSettings&&this.createDelayedElements(),t&&(this._originalProps=new Asc.asc_CImgProperty(t),i=t.asc_getWidth(),(.001<Math.abs(this._state.Width-i)||(null===this._state.Width||null===i)&&this._state.Width!==i)&&(this.spnWidth.setValue(null!==i?Common.Utils.Metric.fnRecalcFromMM(i):"",!0),this._state.Width=i),i=t.asc_getHeight(),(.001<Math.abs(this._state.Height-i)||(null===this._state.Height||null===i)&&this._state.Height!==i)&&(this.spnHeight.setValue(null!==i?Common.Utils.Metric.fnRecalcFromMM(i):"",!0),this._state.Height=i),0<t.asc_getHeight()&&(this._nRatio=t.asc_getWidth()/t.asc_getHeight()),i=t.asc_getLockAspect(),this._state.keepRatio!==i&&(this.btnRatio.toggle(i),this._state.keepRatio=i),(i=t.get_Position())?(e={X:i.get_X(),Y:i.get_Y()},this.spnHor.setValue(null!=e.X?Common.Utils.Metric.fnRecalcFromMM(e.X):"",!0),this.spnVert.setValue(null!=e.Y?Common.Utils.Metric.fnRecalcFromMM(e.Y):"",!0),this._state.PosHor=e.X,this._state.PosVert=e.Y):(this.spnHor.setValue("",!0),this.spnVert.setValue("",!0),this._state.PosHor=this._state.PosVert=null),e=t.asc_getSlicerProperties(),this.disableControls(this._locked,!!e&&e.asc_getLockedPosition()),e&&(i=e.asc_getColumnCount(),(.1<Math.abs(this._state.ColCount-i)||(null===this._state.ColCount||null===i)&&this._state.ColCount!==i)&&(this.numCols.setValue(null!==i?i:"",!0),this._state.ColCount=i),i=e.asc_getButtonWidth()/36e3,(.001<Math.abs(this._state.ColWidth-i)||(null===this._state.ColWidth||null===i)&&this._state.ColWidth!==i)&&(this.spnColWidth.setValue(null!==i?Common.Utils.Metric.fnRecalcFromMM(i):"",!0),this._state.ColWidth=i),i=e.asc_getRowHeight()/36e3,(.001<Math.abs(this._state.ColHeight-i)||(null===this._state.ColHeight||null===i)&&this._state.ColHeight!==i)&&(this.spnColHeight.setValue(null!==i?Common.Utils.Metric.fnRecalcFromMM(i):"",!0),this._state.ColHeight=i),this.btnSlicerStyle||this.onInitStyles(e.asc_getStylesPictures()),i=e.asc_getStyle(),this._state.StyleType===i&&!this._isTemplatesChanged||(this.btnSlicerStyle.suspendEvents(),t=this.btnSlicerStyle.menuPicker.store.findWhere({type:i}),this.btnSlicerStyle.menuPicker.selectRecord(t),this.btnSlicerStyle.resumeEvents(),t?this.btnSlicerStyle.fillComboView(this.btnSlicerStyle.menuPicker.getSelectedRec(),!0):this.btnSlicerStyle.fillComboView(this.btnSlicerStyle.menuPicker.store.at(0),!0),this._state.StyleType=i),this._isTemplatesChanged=!1,i=e.asc_getLockedPosition(),this.chLock.setValue(null!=i?!!i:"indeterminate",!0),((i=e.asc_getSortOrder())==Asc.ST_tabularSlicerCacheSortOrder.Ascending?this.radioAsc:this.radioDesc).setValue(!0,!0),i=e.asc_getIndicateItemsWithNoData(),this._state.IndNoData!==i&&(this.chIndNoData.setValue(null!=i?!!i:"indeterminate",!0),this._state.IndNoData=i),i=e.asc_getShowItemsWithNoDataLast(),this._state.ShowNoData!==i&&(this.chShowNoData.setValue(null!=i?!!i:"indeterminate",!0),this._state.ShowNoData=i),i=e.asc_getHideItemsWithNoData(),this._state.HideNoData!==i&&(this.chHideNoData.setValue(null!=i?!!i:"indeterminate",!0),this._state.HideNoData=i),this.chIndNoData.setDisabled(i||this._locked),this.chShowNoData.setDisabled(i||"checked"!=this.chIndNoData.getValue()||this._locked),this.chShowDel.setDisabled(i||this._locked)))},onWidthChange:function(t,e,i,s){var t=t.getNumberValue(),o=this.spnHeight.getNumberValue();this.btnRatio.pressed&&((o=t/this._nRatio)>this.spnHeight.options.maxValue&&(t=(o=this.spnHeight.options.maxValue)*this._nRatio,this.spnWidth.setValue(t,!0)),this.spnHeight.setValue(o,!0)),this.api&&this._originalProps&&(this._originalProps.asc_putWidth(Common.Utils.Metric.fnRecalcToMM(t)),this._originalProps.asc_putHeight(Common.Utils.Metric.fnRecalcToMM(o)),this.api.asc_setGraphicObjectProps(this._originalProps)),Common.NotificationCenter.trigger("edit:complete",this)},onHeightChange:function(t,e,i,s){var t=t.getNumberValue(),o=this.spnWidth.getNumberValue();this.btnRatio.pressed&&((o=t*this._nRatio)>this.spnWidth.options.maxValue&&(t=(o=this.spnWidth.options.maxValue)/this._nRatio,this.spnHeight.setValue(t,!0)),this.spnWidth.setValue(o,!0)),this.api&&this._originalProps&&(this._originalProps.asc_putWidth(Common.Utils.Metric.fnRecalcToMM(o)),this._originalProps.asc_putHeight(Common.Utils.Metric.fnRecalcToMM(t)),this.api.asc_setGraphicObjectProps(this._originalProps)),Common.NotificationCenter.trigger("edit:complete",this)},onHorChange:function(t,e,i,s){var o=new Asc.CPosition;""!==t.getValue()&&o.put_X(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())),""!==this.spnVert.getValue()&&o.put_Y(Common.Utils.Metric.fnRecalcToMM(this.spnVert.getNumberValue())),this.api&&this._originalProps&&(this._originalProps.put_Position(o),this.api.asc_setGraphicObjectProps(this._originalProps)),Common.NotificationCenter.trigger("edit:complete",this)},onVertChange:function(t,e,i,s){var o=new Asc.CPosition;""!==this.spnHor.getValue()&&o.put_X(Common.Utils.Metric.fnRecalcToMM(this.spnHor.getNumberValue())),""!==t.getValue()&&o.put_Y(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())),this.api&&this._originalProps&&(this._originalProps.put_Position(o),this.api.asc_setGraphicObjectProps(this._originalProps)),Common.NotificationCenter.trigger("edit:complete",this)},onColWidthChange:function(t,e,i,s){this.api&&this._originalProps&&(this._originalProps.asc_getSlicerProperties().asc_setButtonWidth(36e3*Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())),this.api.asc_setGraphicObjectProps(this._originalProps)),Common.NotificationCenter.trigger("edit:complete",this)},onColHeightChange:function(t,e,i,s){this.api&&this._originalProps&&(this._originalProps.asc_getSlicerProperties().asc_setRowHeight(36e3*Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())),this.api.asc_setGraphicObjectProps(this._originalProps)),Common.NotificationCenter.trigger("edit:complete",this)},onColChange:function(t,e,i,s){this.api&&this._originalProps&&(this._originalProps.asc_getSlicerProperties().asc_setColumnCount(t.getNumberValue()),this.api.asc_setGraphicObjectProps(this._originalProps)),Common.NotificationCenter.trigger("edit:complete",this)},onInitStyles:function(t){var e,i,s,o,n=this;this._isTemplatesChanged=!0,this.styles=t,this.btnSlicerStyle||(this.btnSlicerStyle=new Common.UI.ComboDataView({itemWidth:36,itemHeight:48,menuMaxHeight:235,enableKeyEvents:!0,cls:"combo-slicer-style",dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.btnSlicerStyle.render(a("#slicer-btn-style")),this.btnSlicerStyle.openButton.menu.cmpEl.css({"min-width":178,"max-width":178}),this.btnSlicerStyle.on("click",l.bind(this.onSelectSlicerStyle,this)),this.btnSlicerStyle.openButton.menu.on("show:after",function(){n.btnSlicerStyle.menuPicker.scroller.update({alwaysVisibleY:!0})}),this.lockedControls.push(this.btnSlicerStyle),this._locked&&this.btnSlicerStyle.setDisabled(this._locked)),t&&0<t.length?(e=this.btnSlicerStyle.menuPicker.store)&&(0<(i=e.length)&&i==this.styles.length?(s=e.models,l.each(t,function(t,e){s[e].set("imageUrl",t.asc_getImage())})):(o=[],l.each(t,function(t,e){o.push({type:t.asc_getName(),imageUrl:t.asc_getImage()})}),e.reset(o,{silent:!1}))):(this.btnSlicerStyle.menuPicker.store.reset(),this.btnSlicerStyle.clearComboView()),this.btnSlicerStyle.setDisabled(this.btnSlicerStyle.menuPicker.store.length<1||this._locked)},onSelectSlicerStyle:function(t,e){this._noApply||(this._originalProps&&(this._originalProps.asc_getSlicerProperties().asc_setStyle(e.get("type")),this.api.asc_setGraphicObjectProps(this._originalProps)),Common.NotificationCenter.trigger("edit:complete",this))},onLockSlicerChange:function(t,e,i,s){this.api&&this._originalProps&&(this._originalProps.asc_getSlicerProperties().asc_setLockedPosition("checked"==t.getValue()),this.api.asc_setGraphicObjectProps(this._originalProps)),Common.NotificationCenter.trigger("edit:complete",this)},setLocked:function(t){this._locked=t},disableControls:function(e,t){this._initSettings||(this.disableSizeControls(e||t),this._state.DisabledControls!==e&&(this._state.DisabledControls=e,l.each(this.lockedControls,function(t){t.setDisabled(e)}),this.linkAdvanced.toggleClass("disabled",e)))},disableSizeControls:function(e){this._state.DisabledSizeControls!==e&&(this._state.DisabledSizeControls=e,l.each(this.sizeControls,function(t){t.setDisabled(e)}))}},SSE.Views.SlicerSettings||{}))}),40),MENU_SCALE_PART=260,Common,Common,Common,Common,Common,Common,Common,Common,Common,Common,Common,Common,Common,Common,Common,Common,Common,Common,Common,Common,Common,Common,Common,Common,Common,Common,Common,Common,Common,Common,Common,reqerr;define("spreadsheeteditor/main/app/view/RightMenu",["text!spreadsheeteditor/main/app/template/RightMenu.template","jquery","underscore","backbone","common/main/lib/component/Button","common/main/lib/component/MetricSpinner","common/main/lib/component/CheckBox","spreadsheeteditor/main/app/view/ParagraphSettings","spreadsheeteditor/main/app/view/ImageSettings","spreadsheeteditor/main/app/view/ChartSettings","spreadsheeteditor/main/app/view/ShapeSettings","spreadsheeteditor/main/app/view/TextArtSettings","spreadsheeteditor/main/app/view/TableSettings","spreadsheeteditor/main/app/view/PivotSettings","spreadsheeteditor/main/app/view/SignatureSettings","spreadsheeteditor/main/app/view/CellSettings","spreadsheeteditor/main/app/view/SlicerSettings","common/main/lib/component/Scroller"],function(t,o,s,e){"use strict";SSE.Views.RightMenu=e.View.extend(s.extend({el:"#right-menu",template:s.template(t),events:{},initialize:function(){return this.minimizedMode=!0,this.btnText=new Common.UI.Button({hint:this.txtParagraphSettings,asctype:Common.Utils.documentSettingsType.Paragraph,enableToggle:!0,disabled:!0,iconCls:"btn-paragraph",toggleGroup:"tabpanelbtnsGroup",allowMouseEventsOnDisabled:!0}),this.btnImage=new Common.UI.Button({hint:this.txtImageSettings,asctype:Common.Utils.documentSettingsType.Image,enableToggle:!0,disabled:!0,iconCls:"btn-menu-image",toggleGroup:"tabpanelbtnsGroup",allowMouseEventsOnDisabled:!0}),this.btnChart=new Common.UI.Button({hint:this.txtChartSettings,asctype:Common.Utils.documentSettingsType.Chart,enableToggle:!0,disabled:!0,iconCls:"btn-menu-chart",toggleGroup:"tabpanelbtnsGroup",allowMouseEventsOnDisabled:!0}),this.btnShape=new Common.UI.Button({hint:this.txtShapeSettings,asctype:Common.Utils.documentSettingsType.Shape,enableToggle:!0,disabled:!0,iconCls:"btn-menu-shape",toggleGroup:"tabpanelbtnsGroup",allowMouseEventsOnDisabled:!0}),this.btnTextArt=new Common.UI.Button({hint:this.txtTextArtSettings,asctype:Common.Utils.documentSettingsType.TextArt,enableToggle:!0,disabled:!0,iconCls:"btn-menu-textart",toggleGroup:"tabpanelbtnsGroup",allowMouseEventsOnDisabled:!0}),this.btnTable=new Common.UI.Button({hint:this.txtTableSettings,asctype:Common.Utils.documentSettingsType.Table,enableToggle:!0,disabled:!0,iconCls:"btn-menu-table",toggleGroup:"tabpanelbtnsGroup",allowMouseEventsOnDisabled:!0}),this.btnPivot=new Common.UI.Button({hint:this.txtPivotSettings,asctype:Common.Utils.documentSettingsType.Pivot,enableToggle:!0,disabled:!0,iconCls:"btn-pivot-sum",visible:!1,toggleGroup:"tabpanelbtnsGroup",allowMouseEventsOnDisabled:!0}),this.btnCell=new Common.UI.Button({hint:this.txtCellSettings,asctype:Common.Utils.documentSettingsType.Cell,enableToggle:!0,disabled:!0,iconCls:"btn-menu-cell",toggleGroup:"tabpanelbtnsGroup",allowMouseEventsOnDisabled:!0}),this.btnSlicer=new Common.UI.Button({hint:this.txtSlicerSettings,asctype:Common.Utils.documentSettingsType.Slicer,enableToggle:!0,disabled:!0,iconCls:"btn-slicer",toggleGroup:"tabpanelbtnsGroup",allowMouseEventsOnDisabled:!0}),this._settings=[],this._settings[Common.Utils.documentSettingsType.Paragraph]={panel:"id-paragraph-settings",btn:this.btnText},this._settings[Common.Utils.documentSettingsType.Image]={panel:"id-image-settings",btn:this.btnImage},this._settings[Common.Utils.documentSettingsType.Shape]={panel:"id-shape-settings",btn:this.btnShape},this._settings[Common.Utils.documentSettingsType.Chart]={panel:"id-chart-settings",btn:this.btnChart},this._settings[Common.Utils.documentSettingsType.TextArt]={panel:"id-textart-settings",btn:this.btnTextArt},this._settings[Common.Utils.documentSettingsType.Table]={panel:"id-table-settings",btn:this.btnTable},this._settings[Common.Utils.documentSettingsType.Pivot]={panel:"id-pivot-settings",btn:this.btnPivot},this._settings[Common.Utils.documentSettingsType.Cell]={panel:"id-cell-settings",btn:this.btnCell},this._settings[Common.Utils.documentSettingsType.Slicer]={panel:"id-slicer-settings",btn:this.btnSlicer},this},render:function(t){var e=o(this.el),i=(this.trigger("render:before",this),this.defaultHideRightMenu=t.customization&&!!t.customization.hideRightMenu,!Common.localStorage.getBool("sse-hide-right-settings",this.defaultHideRightMenu));return Common.Utils.InternalSettings.set("sse-hide-right-settings",!i),e.css("width",(i?MENU_SCALE_PART:SCALE_MIN)+"px"),e.css("z-index",101),e.show(),e.html(this.template({})),this.btnText.setElement(o("#id-right-menu-text"),!1),this.btnText.render(),this.btnImage.setElement(o("#id-right-menu-image"),!1),this.btnImage.render(),this.btnChart.setElement(o("#id-right-menu-chart"),!1),this.btnChart.render(),this.btnShape.setElement(o("#id-right-menu-shape"),!1),this.btnShape.render(),this.btnTextArt.setElement(o("#id-right-menu-textart"),!1),this.btnTextArt.render(),this.btnTable.setElement(o("#id-right-menu-table"),!1),this.btnTable.render(),this.btnPivot.setElement(o("#id-right-menu-pivot"),!1),this.btnPivot.render(),this.btnCell.setElement(o("#id-right-menu-cell"),!1),this.btnCell.render(),this.btnSlicer.setElement(o("#id-right-menu-slicer"),!1),this.btnSlicer.render(),this.btnText.on("click",s.bind(this.onBtnMenuClick,this)),this.btnImage.on("click",s.bind(this.onBtnMenuClick,this)),this.btnChart.on("click",s.bind(this.onBtnMenuClick,this)),this.btnShape.on("click",s.bind(this.onBtnMenuClick,this)),this.btnTextArt.on("click",s.bind(this.onBtnMenuClick,this)),this.btnTable.on("click",s.bind(this.onBtnMenuClick,this)),this.btnPivot.on("click",s.bind(this.onBtnMenuClick,this)),this.btnCell.on("click",s.bind(this.onBtnMenuClick,this)),this.btnSlicer.on("click",s.bind(this.onBtnMenuClick,this)),this.paragraphSettings=new SSE.Views.ParagraphSettings,this.imageSettings=new SSE.Views.ImageSettings,this.chartSettings=new SSE.Views.ChartSettings,this.shapeSettings=new SSE.Views.ShapeSettings,this.textartSettings=new SSE.Views.TextArtSettings,this.tableSettings=new SSE.Views.TableSettings,this.pivotSettings=new SSE.Views.PivotSettings,this.cellSettings=new SSE.Views.CellSettings,this.slicerSettings=new SSE.Views.SlicerSettings,t&&t.isSignatureSupport&&(this.btnSignature=new Common.UI.Button({hint:this.txtSignatureSettings,asctype:Common.Utils.documentSettingsType.Signature,enableToggle:!0,disabled:!0,iconCls:"btn-menu-signature",toggleGroup:"tabpanelbtnsGroup",allowMouseEventsOnDisabled:!0}),this._settings[Common.Utils.documentSettingsType.Signature]={panel:"id-signature-settings",btn:this.btnSignature},this.btnSignature.setElement(o("#id-right-menu-signature"),!1),this.btnSignature.render().setVisible(!0),this.btnSignature.on("click",s.bind(this.onBtnMenuClick,this)),this.signatureSettings=new SSE.Views.SignatureSettings),t&&t.canFeaturePivot&&this.btnPivot.setVisible(!0),s.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:o(this.el).find(".right-panel"),suppressScrollX:!0,useKeyboard:!1})),i&&(o("#id-cell-settings").parent().css("display","inline-block"),o("#id-cell-settings").addClass("active")),this.trigger("render:after",this),this},setApi:function(t){this.api=t;function e(t){this._isEyedropperStart=t}return this.paragraphSettings.setApi(t),this.imageSettings.setApi(t),this.chartSettings.setApi(t),this.shapeSettings.setApi(t).on("eyedropper",s.bind(e,this)),this.textartSettings.setApi(t).on("eyedropper",s.bind(e,this)),this.tableSettings.setApi(t),this.pivotSettings.setApi(t),this.cellSettings.setApi(t).on("eyedropper",s.bind(e,this)),this.slicerSettings.setApi(t),this.signatureSettings&&this.signatureSettings.setApi(t),this},setMode:function(t){return this.mode=t,this.imageSettings&&this.imageSettings.setMode(t),this.shapeSettings&&this.shapeSettings.setMode(t),this.tableSettings&&this.tableSettings.setMode(t),this},onBtnMenuClick:function(t,e){var i=o("#"+this._settings[t.options.asctype].panel),s=i.parent();t.pressed?(this.minimizedMode&&(o(this.el).width(MENU_SCALE_PART),s.css("display","inline-block"),this.minimizedMode=!1,Common.localStorage.setItem("sse-hide-right-settings",0),Common.Utils.InternalSettings.set("sse-hide-right-settings",!1)),s.find("> .active").removeClass("active"),i.addClass("active"),this.scroller&&this.scroller.scrollTop(0)):(s.css("display","none"),o(this.el).width(SCALE_MIN),this.minimizedMode=!0,Common.localStorage.setItem("sse-hide-right-settings",1),Common.Utils.InternalSettings.set("sse-hide-right-settings",!0)),this.fireEvent("rightmenuclick",[this,t.options.asctype,this.minimizedMode,e])},SetActivePane:function(t,e){this.minimizedMode&&!0!==e||void 0===this._settings[t]||(this.minimizedMode?(this._settings[t].btn.toggle(!0,!1),this._settings[t].btn.trigger("click",this._settings[t].btn)):((e=o("#"+this._settings[t].panel)).hasClass("active")||(e.parent().find("> .active").removeClass("active"),e.addClass("active"),this.scroller&&(this.scroller.update(),this.scroller.scrollTop(0))),this._settings[t].btn.isActive()||this._settings[t].btn.toggle(!0,!1)))},GetActivePane:function(){return this.minimizedMode?null:this.$el.find(".settings-panel.active")[0].id},clearSelection:function(){var t=o(".right-panel");t.find("> .active").removeClass("active"),this._settings.forEach(function(t){t.btn.isActive()&&t.btn.toggle(!1,!0)}),t.css("display","none"),o(this.el).width(SCALE_MIN),this.minimizedMode=!0,Common.NotificationCenter.trigger("layout:changed","rightmenu")}},SSE.Views.RightMenu||{}))}),define("spreadsheeteditor/main/app/controller/RightMenu",["core","spreadsheeteditor/main/app/view/RightMenu"],function(){"use strict";SSE.Controllers.RightMenu=Backbone.Controller.extend({models:[],collections:[],views:["RightMenu"],initialize:function(){this.editMode=!0,this._state={wsLock:!1,wsProps:[]},this.addListeners({Toolbar:{insertimage:this.onInsertImage.bind(this),insertshape:this.onInsertShape.bind(this),insertchart:this.onInsertChart.bind(this),inserttextart:this.onInsertTextArt.bind(this),inserttable:this.onInsertTable.bind(this)},RightMenu:{rightmenuclick:this.onRightMenuClick},PivotTable:{insertpivot:this.onInsertPivot},ViewTab:{"rightmenu:hide":this.onRightMenuHide.bind(this)}}),Common.Utils.InternalSettings.set("sse-rightpanel-active-table",1),Common.Utils.InternalSettings.set("sse-rightpanel-active-pivot",1),Common.Utils.InternalSettings.set("sse-rightpanel-active-spark",1)},onLaunch:function(){this.rightmenu=this.createView("RightMenu"),this.rightmenu.on("render:after",_.bind(this.onRightMenuAfterRender,this))},onRightMenuAfterRender:function(t){t.imageSettings.application=t.shapeSettings.application=t.textartSettings.application=this.getApplication(),this._settings=[],this._settings[Common.Utils.documentSettingsType.Paragraph]={panelId:"id-paragraph-settings",panel:t.paragraphSettings,btn:t.btnText,hidden:1,locked:!1},this._settings[Common.Utils.documentSettingsType.Image]={panelId:"id-image-settings",panel:t.imageSettings,btn:t.btnImage,hidden:1,locked:!1},this._settings[Common.Utils.documentSettingsType.Shape]={panelId:"id-shape-settings",panel:t.shapeSettings,btn:t.btnShape,hidden:1,locked:!1},this._settings[Common.Utils.documentSettingsType.TextArt]={panelId:"id-textart-settings",panel:t.textartSettings,btn:t.btnTextArt,hidden:1,locked:!1},this._settings[Common.Utils.documentSettingsType.Chart]={panelId:"id-chart-settings",panel:t.chartSettings,btn:t.btnChart,hidden:1,locked:!1},this._settings[Common.Utils.documentSettingsType.Table]={panelId:"id-table-settings",panel:t.tableSettings,btn:t.btnTable,hidden:1,locked:!1},this._settings[Common.Utils.documentSettingsType.Pivot]={panelId:"id-pivot-settings",panel:t.pivotSettings,btn:t.btnPivot,hidden:1,locked:!1},this._settings[Common.Utils.documentSettingsType.Signature]={panelId:"id-signature-settings",panel:t.signatureSettings,btn:t.btnSignature,hidden:1,props:{},locked:!1},this._settings[Common.Utils.documentSettingsType.Cell]={panelId:"id-cell-settings",panel:t.cellSettings,btn:t.btnCell,hidden:1,locked:!1},this._settings[Common.Utils.documentSettingsType.Slicer]={panelId:"id-slicer-settings",panel:t.slicerSettings,btn:t.btnSlicer,hidden:1,locked:!1}},setApi:function(t){this.api=t,this.api.asc_registerCallback("asc_onUpdateSignatures",_.bind(this.onApiUpdateSignatures,this)),this.api.asc_registerCallback("asc_onCoAuthoringDisconnect",_.bind(this.onCoAuthoringDisconnect,this)),Common.NotificationCenter.on("api:disconnect",_.bind(this.onCoAuthoringDisconnect,this)),Common.NotificationCenter.on("cells:range",_.bind(this.onCellsRange,this)),Common.NotificationCenter.on("protect:wslock",_.bind(this.onChangeProtectSheet,this))},setMode:function(t){this.editMode=t.isEdit},onRightMenuClick:function(t,e,i,s){!i&&this.editMode&&(s&&(e==Common.Utils.documentSettingsType.Table?(Common.Utils.InternalSettings.set("sse-rightpanel-active-table",2),this._settings[Common.Utils.documentSettingsType.Chart].hidden||Common.Utils.InternalSettings.set("sse-rightpanel-active-spark",Math.min(Common.Utils.InternalSettings.get("sse-rightpanel-active-spark"),1))):e==Common.Utils.documentSettingsType.Pivot?Common.Utils.InternalSettings.set("sse-rightpanel-active-pivot",1):e!=Common.Utils.documentSettingsType.Chart||this._settings[Common.Utils.documentSettingsType.Cell].hidden?Common.Utils.documentSettingsType.Cell&&(this._settings[Common.Utils.documentSettingsType.Table].hidden||Common.Utils.InternalSettings.set("sse-rightpanel-active-table",0),this._settings[Common.Utils.documentSettingsType.Pivot].hidden||Common.Utils.InternalSettings.set("sse-rightpanel-active-pivot",0),this._settings[Common.Utils.documentSettingsType.Chart].hidden||Common.Utils.InternalSettings.set("sse-rightpanel-active-spark",0)):(Common.Utils.InternalSettings.set("sse-rightpanel-active-spark",2),this._settings[Common.Utils.documentSettingsType.Table].hidden||Common.Utils.InternalSettings.set("sse-rightpanel-active-table",Math.min(Common.Utils.InternalSettings.get("sse-rightpanel-active-table"),1)))),i=this._settings[e].panel,(s=this._settings[e].props)&&i&&i.ChangeSettings.call(i,e==Common.Utils.documentSettingsType.Signature?void 0:s,this._state.wsLock,this._state.wsProps)),Common.NotificationCenter.trigger("layout:changed","rightmenu")},onSelectionChanged:function(t){var e,i,s,o,n;!this.rangeSelectionMode&&t&&(e=[],i=t.asc_getSelectionType(),s=t.asc_getFormatTableInfo(),o=t.asc_getSparklineInfo(),n=(t=t).asc_getPivotTableInfo(),!((e=i!=Asc.c_oAscSelectionType.RangeImage&&i!=Asc.c_oAscSelectionType.RangeShape&&i!=Asc.c_oAscSelectionType.RangeSlicer&&i!=Asc.c_oAscSelectionType.RangeChart&&i!=Asc.c_oAscSelectionType.RangeChartText&&i!=Asc.c_oAscSelectionType.RangeShapeText?e:this.api.asc_getGraphicObjectProps()).length<=0)||t||s||o||n||this.rightmenu.minimizedMode||"id-signature-settings"===this.rightmenu.GetActivePane()||(this.rightmenu.clearSelection(),this._openRightMenu=!0),this.onFocusObject(e,t,s,o,n))},onFocusObject:function(t,e,i,s,o,n){if(this.editMode||n){for(var a=e&&e.asc_getLocked()||this._state.wsProps.FormatCells,l=e&&!0===e.asc_getLockedTable()||!this.rightmenu.mode.canModifyFilter||this._state.wsProps.FormatCells,r=e&&!0===e.asc_getLockedSparkline()||this._state.wsLock,c=e&&!0===e.asc_getLockedPivotTable()||this._state.wsProps.PivotTables,d=e&&!0===e.asc_getUserProtected(),h=0;h<this._settings.length;++h)h!=Common.Utils.documentSettingsType.Signature&&this._settings[h]&&(this._settings[h].hidden=1,this._settings[h].locked=!1);for(var p=this._settings[Common.Utils.documentSettingsType.Signature].locked=!1,h=0;h<t.length;++h){var m=t[h].asc_getObjectType(),u=this.getDocumentSettingsType(m);void 0===u||u>=this._settings.length||void 0===this._settings[u]||(m=t[h].asc_getObjectValue(),u==Common.Utils.documentSettingsType.Image?(p=p||m.asc_getProtectionLockText(),null!==m.asc_getChartProperties()?(u=Common.Utils.documentSettingsType.Chart,this._settings[u].btn.updateHint(this.rightmenu.txtChartSettings)):null!==m.asc_getShapeProperties()?(u=Common.Utils.documentSettingsType.Shape,m.asc_getShapeProperties().asc_getTextArtProperties()&&(this._settings[Common.Utils.documentSettingsType.TextArt].props=m,this._settings[Common.Utils.documentSettingsType.TextArt].hidden=0,this._settings[Common.Utils.documentSettingsType.TextArt].locked=m.asc_getLocked()||this._state.wsProps.Objects&&m.asc_getProtectionLockText())):null!==m.asc_getSlicerProperties()&&(u=Common.Utils.documentSettingsType.Slicer),this._settings[u].locked=m.asc_getLocked()||this._state.wsProps.Objects&&m.asc_getProtectionLocked()):this._settings[u].locked=m.asc_getLocked(),this._settings[u].props=m,this._settings[u].hidden=0,this._settings[Common.Utils.documentSettingsType.Signature].locked||(this._settings[Common.Utils.documentSettingsType.Signature].locked=m.asc_getLocked()),this._settings[Common.Utils.documentSettingsType.Paragraph].locked||(this._settings[Common.Utils.documentSettingsType.Paragraph].locked=this._state.wsProps.Objects&&p))}i&&(u=Common.Utils.documentSettingsType.Table,this._settings[u].props=i,this._settings[u].locked=l,this._settings[u].hidden=0),s&&(u=Common.Utils.documentSettingsType.Chart,this._settings[u].props=s,this._settings[u].locked=r,this._settings[u].hidden=0,this._settings[u].btn.updateHint(this.rightmenu.txtSparklineSettings)),o&&this.rightmenu.mode.canFeaturePivot&&(u=Common.Utils.documentSettingsType.Pivot,this._settings[u].props=o,this._settings[u].locked=c,this._settings[u].hidden=0,this._openRightMenu=!0),t.length<=0&&e&&(u=Common.Utils.documentSettingsType.Cell,this._settings[u].props=e,this._settings[u].locked=a||d,this._settings[u].hidden=0);var g,b,C,f=-1,S=-1,v=this.rightmenu.GetActivePane();for(h=0;h<this._settings.length;++h)void 0!==(C=this._settings[h])&&void 0!==C.btn&&void 0!==C.panel&&(C.hidden?(C.btn.isDisabled()||C.btn.setDisabled(!0),v==C.panelId&&(g=-1)):(C.btn.isDisabled()&&C.btn.setDisabled(!1),h!=Common.Utils.documentSettingsType.Signature&&(f=h),C.needShow?(C.needShow=!1,S=h):v==C.panelId&&(g=h),C.panel.setLocked(C.locked)));this.rightmenu.minimizedMode&&!this._openRightMenu||(S<0&&void 0!==this._lastVisibleSettings&&(void 0===(C=this._settings[this._lastVisibleSettings])||void 0===C.btn||void 0===C.panel||C.hidden||(S=this._lastVisibleSettings)),S<0&&!(this._settings[Common.Utils.documentSettingsType.Cell].hidden||this._settings[Common.Utils.documentSettingsType.Table].hidden&&this._settings[Common.Utils.documentSettingsType.Pivot].hidden&&this._settings[Common.Utils.documentSettingsType.Chart].hidden)&&(i=Common.Utils.InternalSettings.get("sse-rightpanel-active-table"),l=Common.Utils.InternalSettings.get("sse-rightpanel-active-pivot"),s=Common.Utils.InternalSettings.get("sse-rightpanel-active-spark"),this._settings[Common.Utils.documentSettingsType.Table].hidden||this._settings[Common.Utils.documentSettingsType.Chart].hidden?this._settings[Common.Utils.documentSettingsType.Table].hidden?this._settings[Common.Utils.documentSettingsType.Chart].hidden||(S=0===s?Common.Utils.documentSettingsType.Cell:Common.Utils.documentSettingsType.Chart):S=0===i?Common.Utils.documentSettingsType.Cell:Common.Utils.documentSettingsType.Table:S=i==s?0===i?Common.Utils.documentSettingsType.Cell:Common.Utils.documentSettingsType.Chart:s<i?Common.Utils.documentSettingsType.Table:Common.Utils.documentSettingsType.Chart,this._settings[Common.Utils.documentSettingsType.Pivot].hidden||(S=0===l?Common.Utils.documentSettingsType.Cell:Common.Utils.documentSettingsType.Pivot)),-1<S?b=S:0<=f&&g<0?b=f:0<=g?b=g:n&&!this._settings[Common.Utils.documentSettingsType.Signature].hidden&&(b=Common.Utils.documentSettingsType.Signature),void 0!==(b=null==b&&this._openRightMenu&&0<=f?f:b)&&(this.rightmenu.SetActivePane(b,this._openRightMenu),b!=Common.Utils.documentSettingsType.Signature?this._settings[b].panel.ChangeSettings.call(this._settings[b].panel,this._settings[b].props,this._state.wsLock,this._state.wsProps):this._settings[b].panel.ChangeSettings.call(this._settings[b].panel),this._openRightMenu=!1)),this._settings[Common.Utils.documentSettingsType.Image].needShow=!1,this._settings[Common.Utils.documentSettingsType.Chart].needShow=!1,this._settings[Common.Utils.documentSettingsType.Table].needShow=!1,this._settings[Common.Utils.documentSettingsType.Pivot].needShow=!1}},onCoAuthoringDisconnect:function(){this.SetDisabled(!0),this.setMode({isEdit:!1})},onInsertImage:function(){this._settings[Common.Utils.documentSettingsType.Image].needShow=!0},onInsertChart:function(){this._settings[Common.Utils.documentSettingsType.Chart].needShow=!0},onInsertShape:function(){this._settings[Common.Utils.documentSettingsType.Shape].needShow=!0},onInsertTextArt:function(){this._settings[Common.Utils.documentSettingsType.TextArt].needShow=!0},onInsertTable:function(){},onInsertPivot:function(){},UpdateThemeColors:function(){this.rightmenu.shapeSettings.UpdateThemeColors(),this.rightmenu.textartSettings.UpdateThemeColors(),this.rightmenu.chartSettings.UpdateThemeColors(),this.rightmenu.cellSettings.UpdateThemeColors()},updateMetricUnit:function(){this.rightmenu.paragraphSettings.updateMetricUnit(),this.rightmenu.chartSettings.updateMetricUnit(),this.rightmenu.imageSettings.updateMetricUnit(),this.rightmenu.slicerSettings.updateMetricUnit()},createDelayedElements:function(){this.api&&(this._openRightMenu=!Common.localStorage.getBool("sse-hide-right-settings",this.rightmenu.defaultHideRightMenu),Common.Utils.InternalSettings.set("sse-hide-right-settings",!this._openRightMenu),this.api.asc_registerCallback("asc_onSelectionChanged",_.bind(this.onSelectionChanged,this)),this.api.asc_registerCallback("asc_doubleClickOnObject",_.bind(this.onDoubleClickOnObject,this)),this.onChangeProtectSheet())},onDoubleClickOnObject:function(t){var e;this.editMode&&(e=t.asc_getObjectType(),void 0===(e=this.getDocumentSettingsType(e))||e>=this._settings.length||void 0===this._settings[e]||(t=t.asc_getObjectValue(),e==Common.Utils.documentSettingsType.Image&&(null!==t.asc_getChartProperties()?e=Common.Utils.documentSettingsType.Chart:null!==t.asc_getShapeProperties()&&(e=Common.Utils.documentSettingsType.Shape)),e!==Common.Utils.documentSettingsType.Paragraph&&(this.rightmenu.SetActivePane(e,!0),this._settings[e].panel.ChangeSettings.call(this._settings[e].panel,this._settings[e].props,this._state.wsLock,this._state.wsProps))))},getDocumentSettingsType:function(t){switch(t){case Asc.c_oAscTypeSelectElement.Paragraph:return Common.Utils.documentSettingsType.Paragraph;case Asc.c_oAscTypeSelectElement.Image:return Common.Utils.documentSettingsType.Image}},onApiUpdateSignatures:function(t,e){this.rightmenu.signatureSettings&&(t=(!t||t.length<1)&&(!e||e.length<1),e=Common.Utils.documentSettingsType.Signature,this._settings[e].hidden=t?1:0,this._settings[e].btn.setDisabled(t),this._settings[e].panel.setLocked(this._settings[e].locked))},SetDisabled:function(t,e){this.setMode({isEdit:!t}),this.rightmenu&&this.rightmenu.paragraphSettings&&(this.rightmenu.paragraphSettings.disableControls(t),this.rightmenu.shapeSettings.disableControls(t),this.rightmenu.imageSettings.disableControls(t),this.rightmenu.chartSettings.disableControls(t),this.rightmenu.tableSettings.disableControls(t),this.rightmenu.pivotSettings.disableControls(t),this.rightmenu.cellSettings.disableControls(t),this.rightmenu.slicerSettings.disableControls(t),this.rightmenu.signatureSettings&&(e||this.rightmenu.btnSignature.setDisabled(t),e&&t&&this.onFocusObject([],void 0,void 0,void 0,void 0,!0)),t?(this.rightmenu.btnText.setDisabled(t),this.rightmenu.btnTable.setDisabled(t),this.rightmenu.btnImage.setDisabled(t),this.rightmenu.btnShape.setDisabled(t),this.rightmenu.btnTextArt.setDisabled(t),this.rightmenu.btnChart.setDisabled(t),this.rightmenu.btnPivot.setDisabled(t),this.rightmenu.btnCell.setDisabled(t),this.rightmenu.btnSlicer.setDisabled(t)):this.onSelectionChanged(this.api.asc_getCellInfo()))},onCellsRange:function(t){this.rangeSelectionMode=t!=Asc.c_oAscSelectionDialogType.None},onChangeProtectSheet:function(t){var e;(t=t?t:(e=this.getApplication().getController("WBProtection"))?e.getWSProps():null)&&(this._state.wsProps=t.wsProps,this._state.wsLock=t.wsLock),this.onSelectionChanged(this.api.asc_getCellInfo())},onRightMenuHide:function(t,e){if(this.rightmenu){if(e)this.rightmenu.show(),this._openRightMenu=!Common.Utils.InternalSettings.get("sse-hide-right-settings"),this.onSelectionChanged(this.api.asc_getCellInfo()),this._lastVisibleSettings=void 0;else{var i,s=this.rightmenu.GetActivePane();if(s){for(var o=0;o<this._settings.length;o++)if(this._settings[o]&&this._settings[o].panelId===s){i=o;break}this._lastVisibleSettings=i}this.rightmenu.clearSelection(),this.rightmenu.hide(),this.rightmenu.signatureSettings&&this.rightmenu.signatureSettings.hideSignatureTooltip()}Common.localStorage.setBool("sse-hidden-rightmenu",!e)}Common.NotificationCenter.trigger("layout:changed","main"),Common.NotificationCenter.trigger("edit:complete",this.rightmenu)}})}),define("common/main/lib/view/SaveAsDlg",["common/main/lib/component/Window","common/main/lib/component/LoadMask"],function(){"use strict";Common.Views.SaveAsDlg=Common.UI.Window.extend(_.extend({initialize:function(t){var e={};_.extend(e,{title:this.textTitle,width:420,height:681,header:!0},t),this.template=['<div id="id-saveas-folder-placeholder"></div>'].join(""),e.tpl=_.template(this.template)(e),this.saveFolderUrl=t.saveFolderUrl||"",this.saveFileUrl=t.saveFileUrl||"",this.defFileName=t.defFileName||"",this.saveFolderUrl=this.saveFolderUrl.replace("{title}",encodeURIComponent(this.defFileName)).replace("{fileuri}",encodeURIComponent(this.saveFileUrl)),Common.UI.Window.prototype.initialize.call(this,e)},render:function(){Common.UI.Window.prototype.render.call(this),this.$window.find("> .body").css({height:"auto",overflow:"hidden"});var t=document.createElement("iframe"),e=(t.width="100%",t.height=645,t.align="top",t.frameBorder=0,t.scrolling="no",t.onload=_.bind(this._onLoad,this),$("#id-saveas-folder-placeholder").append(t),this.loadMask=new Common.UI.LoadMask({owner:$("#id-saveas-folder-placeholder")}),this.loadMask.setTitle(this.textLoading),this.loadMask.show(),t.src=this.saveFolderUrl,this);this._eventfunc=function(t){e._onWindowMessage(t)},this._bindWindowEvents.call(this),this.on("close",function(t){e._unbindWindowEvents()})},_bindWindowEvents:function(){window.addEventListener?window.addEventListener("message",this._eventfunc,!1):window.attachEvent&&window.attachEvent("onmessage",this._eventfunc)},_unbindWindowEvents:function(){window.removeEventListener?window.removeEventListener("message",this._eventfunc):window.detachEvent&&window.detachEvent("onmessage",this._eventfunc)},_onWindowMessage:function(t){if(t&&window.JSON)try{this._onMessage.call(this,window.JSON.parse(t.data))}catch(t){}},_onMessage:function(t){t&&"onlyoffice"==t.Referer&&(_.isEmpty(t.error)?_.isEmpty(t.message)||Common.NotificationCenter.trigger("showmessage",{msg:t.message}):this.trigger("saveaserror",this,t.error),Common.NotificationCenter.trigger("window:close",this))},_onLoad:function(){this.loadMask&&this.loadMask.hide()}},Common.Views.SaveAsDlg||{}))}),define("text!spreadsheeteditor/main/app/template/LeftMenu.template",[],function(){return'<div id="view-left-menu" class="tool-menu left">\n    <div class="tool-menu-btns">\n        <button id="left-btn-searchbar" class="btn btn-category" data-hint="0" data-hint-direction="right" data-hint-offset="big" content-target="left-panel-search"><i class="icon toolbar__icon btn-menu-search">&nbsp;</i></button>\n        \x3c!-- /** coauthoring begin **/ --\x3e\n        <button id="left-btn-comments" class="btn btn-category" content-target="left-panel-comments" data-hint="0" data-hint-direction="right" data-hint-offset="big"><i class="icon toolbar__icon btn-menu-comments">&nbsp;</i></button>\n        <button id="left-btn-chat" class="btn btn-category" content-target="left-panel-chat" data-hint="0" data-hint-direction="right" data-hint-offset="big"><i class="icon toolbar__icon btn-menu-chat">&nbsp;</i></button>\n        \x3c!-- /** coauthoring end **/ --\x3e\n        <button id="left-btn-plugins" class="btn btn-category" content-target="" data-hint="0" data-hint-direction="right" data-hint-offset="big"><i class="icon toolbar__icon btn-menu-plugin">&nbsp;</i></button>\n        <button id="left-btn-spellcheck" class="btn btn-category" content-target="left-panel-spellcheck" data-hint="0" data-hint-direction="right" data-hint-offset="big" data-layout-name="leftMenu-spellcheck"><i class="icon toolbar__icon btn-ic-docspell">&nbsp;</i></button>\n        <button id="left-btn-support" class="btn btn-category" content-target="" data-hint="0" data-hint-direction="right" data-hint-offset="big"><i class="icon toolbar__icon btn-menu-support">&nbsp;</i></button>\n        <button id="left-btn-about" class="btn btn-category" content-target="" data-hint="0" data-hint-direction="right" data-hint-offset="big"><i class="icon toolbar__icon btn-menu-about">&nbsp;</i></button>\n    </div>\n    <div class="left-panel" style="">\n        <div id="left-panel-search" class="" style="display: none;"></div>\n        \x3c!-- /** coauthoring begin **/ --\x3e\n        <div id="left-panel-comments" class="" style="display: none;"></div>\n        <div id="left-panel-chat" class="" style="display: none;"></div>\n        <div id="left-panel-spellcheck" class="" style="display: none; height: 100%;"></div>\n        \x3c!-- /** coauthoring end **/ --\x3e\n        <div id="left-panel-plugins" class="" style="display: none; height: 100%; position: relative;"></div>\n    </div>\n</div>'}),define("common/main/lib/view/SearchDialog",["common/main/lib/component/Window"],function(){"use strict";Common.UI.SearchDialog=Common.UI.Window.extend(_.extend({options:{width:550,title:"Search & Replace",modal:!1,cls:"search",toolclose:"hide",alias:"SearchDialog"},initialize:function(t){_.extend(this.options,t||{}),this.template=['<div class="box">','<div class="input-row">','<span class="btn-placeholder" id="search-placeholder-btn-options"></span>','<input type="text" id="sd-text-search" class="input-field form-control" maxlength="255" placeholder="'+this.textSearchStart+'" autocomplete="off">',"</div>",'<div class="input-row">','<input type="text" id="sd-text-replace" class="input-field form-control" maxlength="255" placeholder="'+this.textReplaceDef+'" autocomplete="off">',"</div>",'<div class="input-row">','<label class="link" id="search-label-replace" result="replaceshow">'+this.txtBtnReplace+"</label>","</div>","</div>",'<div class="separator horizontal"></div>','<div class="footer right">','<button class="btn normal dlg-btn" result="replace">'+this.txtBtnReplace+"</button>",'<button class="btn normal dlg-btn margin-left-6" result="replaceall" style="width: auto;min-width: 100px;">'+this.txtBtnReplaceAll+"</button>",'<button class="btn normal dlg-btn iconic" result="back"><span class="icon img-commonctrl back"></span></button>','<button class="btn normal dlg-btn iconic margin-left-6" result="next"><span class="icon img-commonctrl next"></span></button>',"</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){return Common.UI.Window.prototype.render.call(this),this.miMatchCase=new Common.UI.MenuItem({caption:this.textMatchCase,checkable:!0}),this.miMatchWord=new Common.UI.MenuItem({caption:this.options.matchwordstr||this.textWholeWords,checkable:!0}),this.miHighlight=new Common.UI.MenuItem({caption:this.textHighlight,checkable:!0}),this.btnOptions=new Common.UI.Button({id:"search-btn-options",cls:"btn-toolbar",iconCls:"toolbar__icon btn-settings",menu:new Common.UI.Menu({items:[this.miMatchCase,this.miMatchWord,this.miHighlight]})}),this.options.extraoptions&&(this.btnOptions.menu.addItem({caption:"--"}),this.options.extraoptions.forEach(function(t){this.btnOptions.menu.addItem(t)},this)),this.btnOptions.render(this.$window.find("#search-placeholder-btn-options")),this.options.matchcase||this.miMatchCase.hide(),this.options.matchword||this.miMatchWord.hide(),this.options.markresult?this.options.markresult.applied&&this.miHighlight.setChecked(!0,!0):this.miHighlight.hide(),"search"===this.options.mode&&$(this.$window.find(".input-row").get(2)).hide(),this.txtSearch=this.$window.find("#sd-text-search"),this.txtReplace=this.$window.find("#sd-text-replace"),this.lblReplace=this.$window.find("#search-label-replace"),this.miHighlight.on("toggle",_.bind(this.onHighlight,this)),this.$window.find(".btn[result=back]").on("click",_.bind(this.onBtnClick,this,"back")),this.$window.find(".btn[result=next]").on("click",_.bind(this.onBtnClick,this,"next")),this.$window.find(".btn[result=replace]").on("click",_.bind(this.onBtnClick,this,"replace")),this.$window.find(".btn[result=replaceall]").on("click",_.bind(this.onBtnClick,this,"replaceall")),this.$window.find("label[result=replaceshow]").on("click",_.bind(this.onShowReplace,this)),this.txtSearch.on("keydown",null,"search",_.bind(this.onKeyPress,this)),this.txtReplace.on("keydown",null,"replace",_.bind(this.onKeyPress,this)),this.on("animate:before",_.bind(this.onAnimateBefore,this)),this},show:function(t,e){Common.UI.Window.prototype.show.call(this),(t=this.mode?t:t||"search")&&this.mode!=t&&this.setMode(t),e&&this.setSearchText(e),this.options.markresult&&this.miHighlight.checked&&this.fireEvent("search:highlight",[this,!0]),this.focus()},focus:function(t){var e="replace"===t?this.txtReplace:this.txtSearch;setTimeout(function(){e.focus(),e.select()},10)},onAnimateBefore:function(){this.focus()},onKeyPress:function(t){this.isLocked()||(t.keyCode==Common.UI.Keys.RETURN?("search"==t.data?this.onBtnClick("next",t):"replace"==t.data&&"replace"==this.mode&&this.onBtnClick("replace",t),t.preventDefault(),t.stopPropagation()):t.keyCode==Common.UI.Keys.ESC&&$(".asc-loadmask").length<1&&(this.hide(),t.preventDefault(),t.stopPropagation()))},onBtnClick:function(t,e){var i;$(".asc-loadmask").length||(i={textsearch:this.txtSearch.val(),textreplace:this.txtReplace.val(),matchcase:this.miMatchCase.checked,matchword:this.miMatchWord.checked,highlight:this.miHighlight.checked},this.fireEvent("search:"+t,[this,i]))},setMode:function(t){this.mode=t;var e=this.$window.find(".input-row");"no-replace"===t?(this.setTitle(this.textTitle2),e.eq(1).hide(),e.eq(2).hide(),this.$window.find(".btn[result=replace]").hide(),this.$window.find(".btn[result=replaceall]").hide(),this.options.matchcase||this.options.matchword||this.options.markresult||(this.txtSearch.addClass("clear"),this.btnOptions.hide()),this.menuLookin&&this.menuLookin.menu.items[1].setDisabled(!1),this.setHeight(170)):(this.txtSearch.removeClass("clear"),this.setTitle(this.textTitle),"search"===t?(e.eq(2).show(),this.lblReplace.text(this.txtBtnReplace),e.eq(1).hide(),this.$window.find(".btn[result=replace]").hide(),this.$window.find(".btn[result=replaceall]").hide(),this.menuLookin&&this.menuLookin.menu.items[1].setDisabled(!1),this.setHeight(200)):(e.eq(2).show(),this.lblReplace.text(this.txtBtnHideReplace),e.eq(1).show(),this.$window.find(".btn[result=replace]").show(),this.$window.find(".btn[result=replaceall]").show(),this.menuLookin&&(this.menuLookin.menu.items[0].setChecked(!0),this.menuLookin.menu.items[1].setDisabled(!0)),this.setHeight(230)))},setSearchText:function(t){this.txtSearch&&this.txtSearch.val(t)},onShowReplace:function(t){this.setMode("replace"==this.mode?"search":"replace");var e=this;_.defer(function(){("replace"==e.mode?e.txtReplace:e.txtSearch).focus()},300)},onHighlight:function(t,e){this.fireEvent("search:highlight",[this,e])},getSettings:function(){return{textsearch:this.txtSearch.val(),matchcase:this.miMatchCase.checked,matchword:this.miMatchWord.checked}}},Common.UI.SearchDialog||{}))}),define("text!spreadsheeteditor/main/app/template/FileMenu.template",[],function(){return'<div class="panel-menu">\n    <li class="fm-first-item"></li>\n    <li id="fm-btn-return" class="fm-btn" data-layout-name="toolbar-file-close"></li>\n    <li class="devider"></li>\n    <li id="fm-btn-create" class="fm-btn"></li>\n    <li id="fm-btn-recent" class="fm-btn"></li>\n    <li class="devider"></li>\n    <li id="fm-btn-save" class="fm-btn" data-layout-name="toolbar-file-save"></li>\n    <li id="fm-btn-edit" class="fm-btn"></li>\n    <li id="fm-btn-download" class="fm-btn"></li>\n    <li id="fm-btn-save-copy" class="fm-btn"></li>\n    <li id="fm-btn-save-desktop" class="fm-btn"></li>\n    <li id="fm-btn-print-with-preview" class="fm-btn"></li>\n    <li id="fm-btn-rename" class="fm-btn"></li>\n    <li id="fm-btn-protect" class="fm-btn"></li>\n    <li class="devider"></li>\n    <li id="fm-btn-info" class="fm-btn" data-layout-name="toolbar-file-info"></li>\n    <li id="fm-btn-rights" class="fm-btn"></li>\n    <li id="fm-btn-history" class="fm-btn"></li>\n    <li class="devider" class="fm-btn"></li>\n    <li id="fm-btn-set-default" class="fm-btn"></li>\n    <li id="fm-btn-settings" class="fm-btn" data-layout-name="toolbar-file-settings"></li>\n    <li id="fm-btn-feedback" class="fm-btn"></li>\n    <li id="fm-btn-uninstall" class="fm-btn"></li>\n    <li id="fm-btn-toggle-online" class="fm-btn"></li>\n    <li id="fm-btn-download-online" class="fm-btn"></li>\n    <li class="devider"></li>\n    <li id="fm-btn-help" class="fm-btn"></li>\n    <li class="devider"></li>\n    <li id="fm-btn-back" class="fm-btn"></li>\n</div>\n<div class="panel-context">\n    <div id="panel-saveas" class="content-box"></div>\n    <div id="panel-savecopy" class="content-box"></div>\n    <div id="panel-recentfiles" class="content-box"></div>\n    <div id="panel-createnew" class="content-box"></div>\n    <div id="panel-info" class="content-box"></div>\n    <div id="panel-rights" class="content-box"></div>\n    <div id="panel-settings" class="content-box"></div>\n    <div id="panel-help" class="content-box"></div>\n    <div id="panel-protect" class="content-box"></div>\n    <div id="panel-print" class="content-box"></div>\n</div>'}),void 0===Common&&(Common={}),Common.Views=Common.Views||{},define("common/main/lib/view/RecentFiles",["common/main/lib/component/BaseView"],function(){"use strict";Common.Views.RecentFiles=Common.UI.BaseView.extend(_.extend({menu:void 0,template:_.template(['<div class="header"><%= scope.txtOpenRecent %><button type="button" class="btn btn-text-default" id="fms-btn-clear-recent" style="width:auto; display: inline-block;margin-left:10px;padding-right: 5px;padding-left: 5px;" data-hint="2" data-hint-direction="bottom" data-hint-offset="medium">清除列表</button></div>','<div id="id-recent-view"></div>'].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.menu=t.menu,this.recent=t.recent,this.el=t.el,Common.NotificationCenter.on("update:recents",function(t){var e;this.viewRecentPicker&&(e=this.viewRecentPicker.store)&&(e.reset(this.recent.concat(t)),this.btnClearRecent.setDisabled(0===this.recent.length))}.bind(this)),Common.NotificationCenter.on("reset:recents",function(t){var e;this.viewRecentPicker&&(e=this.viewRecentPicker.store)&&(this.recent=t,e.reset(this.recent),this.btnClearRecent.setDisabled(0===this.recent.length))}.bind(this))},render:function(){return this.$el.html(this.template({scope:this})),this.viewRecentPicker=new Common.UI.DataView({el:$("#id-recent-view"),store:new Common.UI.DataViewStore(this.recent),itemTemplate:_.template(['<div class="recent-wrap">','<div class="recent-icon">',"<div>",'<div class= <% if (typeof format !== "undefined") {%> "default-icon img-format-<%=format %>"<% } else {%> "svg-file-recent"<%} %>></div>',"</div>","</div>",'<div class="file-name"><% if (typeof title !== "undefined") {%><%= Common.Utils.String.htmlEncode(title || "") %><% } %></div>','<div class="file-info"><% if (typeof folder !== "undefined") {%><%= Common.Utils.String.htmlEncode(folder || "") %><% } %></div>','<div class="file-date"><% if (typeof update_time !== "undefined") {%><%= update_time %><% } %></div>',"</div>"].join(""))}),this.viewRecentPicker.on("item:click",_.bind(this.onRecentFileClick,this)),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:this.$el,suppressScrollX:!0,alwaysVisibleY:!0})),this.btnClearRecent=new Common.UI.Button({el:this.$el.findById("#fms-btn-clear-recent")}),this.btnClearRecent.on("click",_.bind(this.onClearRecentClick,this)),this.btnClearRecent.setDisabled(0===this.recent.length),this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this.scroller&&this.scroller.update()},onRecentFileClick:function(t,e,i){this.menu&&(this.menu.hide(),Common.Gateway._postMessage({event:"onOpenRecent",data:{url:i.get("url")}}))},onClearRecentClick:function(){this.menu.hide(),Common.Gateway._postMessage({event:"onClearRecent"}),Common.NotificationCenter.trigger("reset:recents",[])}},Common.Views.RecentFiles||{}))}),define("spreadsheeteditor/main/app/view/FileMenu",["text!spreadsheeteditor/main/app/template/FileMenu.template","underscore","common/main/lib/component/BaseView","common/main/lib/view/RecentFiles"],function(t,s){"use strict";SSE.Views.FileMenu=Common.UI.BaseView.extend(s.extend({el:"#file-menu-panel",rendered:!1,options:{alias:"FileMenu"},template:s.template(t),events:function(){return{"click .fm-btn":s.bind(function(t){var e=$(t.currentTarget),e=(e.hasClass("active")||($(".fm-btn",this.el).removeClass("active"),e.addClass("active")),s.findWhere(this.items,{el:t.currentTarget}));if(e){var i,t=this.panels[e.options.action];if("help"===e.options.action)if(!0===t.noHelpContents&&navigator.onLine)return this.fireEvent("item:click",[this,"external-help",!0]),void((i=Common.Utils.InternalSettings.get("url-help-center"))&&window.open(i,"_blank"));this.fireEvent("item:click",[this,e.options.action,!!t]),t&&(this.$el.find(".content-box:visible").hide(),this.active=e.options.action,t.show())}},this)}},initialize:function(){},render:function(){var t,e=$(this.template());return this.miClose=new Common.UI.MenuItem({el:e.elementById("#fm-btn-return"),action:"back",caption:this.btnCloseMenuCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[2,14]}),this.miSave=new Common.UI.MenuItem({el:e.elementById("#fm-btn-save"),action:"save",caption:this.btnSaveCaption,canFocused:!1,disabled:!0,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[2,14],dataHintTitle:"S"}),this.options.miSave&&(this.miSave.setDisabled(this.options.miSave.isDisabled()),delete this.options.miSave),this.miEdit=new Common.UI.MenuItem({el:e.elementById("#fm-btn-edit"),action:"edit",caption:this.btnToEditCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[2,14]}),this.miDownload=new Common.UI.MenuItem({el:e.elementById("#fm-btn-download"),action:"saveas",caption:this.btnDownloadCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[2,14]}),this.miSaveCopyAs=new Common.UI.MenuItem({el:e.elementById("#fm-btn-save-copy"),action:"save-copy",caption:this.btnSaveCopyAsCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[2,14]}),this.miSaveAs=new Common.UI.MenuItem({el:e.elementById("#fm-btn-save-desktop"),action:"save-desktop",caption:this.btnSaveAsCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[2,14]}),this.miExportToPDF=new Common.UI.MenuItem({el:e.elementById("#fm-btn-export-pdf"),action:"export-pdf",caption:this.btnExportToPDFCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[2,14]}),this.miPrintWithPreview=new Common.UI.MenuItem({el:e.elementById("#fm-btn-print-with-preview"),action:"printpreview",caption:this.btnPrintCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[2,14],dataHintTitle:"P"}),this.miRename=new Common.UI.MenuItem({el:e.elementById("#fm-btn-rename"),action:"rename",caption:this.btnRenameCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[2,14]}),this.options.miRename&&(this.miRename.setDisabled(this.options.miRename.isDisabled()),delete this.options.miRename),this.miProtect=new Common.UI.MenuItem({el:e.elementById("#fm-btn-protect"),action:"protect",caption:this.btnProtectCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[2,14]}),this.options.miProtect&&(this.miProtect.setDisabled(this.options.miProtect.isDisabled()),delete this.options.miProtect),this.miRecent=new Common.UI.MenuItem({el:e.elementById("#fm-btn-recent"),action:"recent",caption:this.btnRecentFilesCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[2,14]}),this.miNew=new Common.UI.MenuItem({el:e.elementById("#fm-btn-create"),action:"new",caption:this.btnCreateNewCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[2,14]}),this.miInfo=new Common.UI.MenuItem({el:e.elementById("#fm-btn-info"),action:"info",caption:this.btnInfoCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[2,14]}),this.miAccess=new Common.UI.MenuItem({el:e.elementById("#fm-btn-rights"),action:"rights",caption:this.btnRightsCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[2,14]}),this.miSettings=new Common.UI.MenuItem({el:e.elementById("#fm-btn-settings"),action:"opts",caption:this.btnSettingsCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[2,14]}),this.miSetDefault=new Common.UI.MenuItem({el:e.elementById("#fm-btn-set-default"),action:"set-default",caption:this.btnSetDefaultCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[2,14]}),this.miFeedback=new Common.UI.MenuItem({el:e.elementById("#fm-btn-feedback"),action:"feedback",caption:this.btnFeedbackCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[2,14]}),this.miUnInstall=new Common.UI.MenuItem({el:e.elementById("#fm-btn-uninstall"),action:"uninstall",caption:this.btnUnInstallCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[2,14]}),this.miToggleOnline=new Common.UI.MenuItem({el:e.elementById("#fm-btn-toggle-online"),action:"toggle-online",caption:this.btnDisableOnlineCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[2,14]}),this.miDownloadOnline=new Common.UI.MenuItem({el:e.elementById("#fm-btn-download-online"),action:"download-online",caption:this.btnDownloadOnlineCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[2,14]}),this.miHelp=new Common.UI.MenuItem({el:e.elementById("#fm-btn-help"),action:"help",caption:this.btnHelpCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[2,14]}),this.miHistory=new Common.UI.MenuItem({el:e.elementById("#fm-btn-history"),action:"history",caption:this.btnHistoryCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[2,14]}),this.miBack=new Common.UI.MenuItem({el:e.elementById("#fm-btn-back"),action:"exit",caption:this.btnBackCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[2,14]}),this.items=[],this.items.push(this.miClose,this.miSave,this.miEdit,this.miDownload,this.miSaveCopyAs,this.miSaveAs,this.miExportToPDF,this.miPrintWithPreview,this.miRename,this.miProtect,this.miRecent,this.miNew,this.miInfo,this.miAccess,this.miHistory,this.miSettings,this.miHelp,this.miBack,this.miSetDefault,this.miFeedback,this.miUnInstall,this.miToggleOnline,this.miDownloadOnline),this.rendered=!0,this.$el.html(e),this.$el.find(".content-box").hide(),s.isUndefined(this.scroller)&&((t=this).scroller=new Common.UI.Scroller({el:this.$el.find(".panel-menu"),suppressScrollX:!0,alwaysVisibleY:!0}),Common.NotificationCenter.on("window:resize",function(){t.scroller.update()})),this.applyMode(),this.api&&(this.panels.info.setApi(this.api),this.panels.protect&&this.panels.protect.setApi(this.api),this.panels.opts&&this.panels.opts.setApi(this.api)),this.fireEvent("render:after",this),this},show:function(t,e){var i;this.isVisible()&&void 0===t||!this.mode||(this.rendered||this.render(),i=!this.mode.canDownload||this.mode.isDesktopApp&&this.mode.isOffline?"info":"saveas",i=this.mode.canOpenRecent&&this.mode.recent?"recent":i,this.miToggleOnline.setCaption(Common.localStorage.getBool("sse-disable-online")?this.btnEnableOnlineCaption:this.btnDisableOnlineCaption),t=t||this.active||i,this.$el.show(),this.scroller.update(),this.selectMenu(t,e,i),this.api.asc_enableKeyEvents(!1),this.fireEvent("menu:show",[this]))},hide:function(){this.$el.hide(),this.api&&this.api.asc_enableKeyEvents(!0),this.fireEvent("menu:hide",[this])},applyMode:function(){var t,e,i,s;this.rendered&&(this.panels||(this.panels={opts:new SSE.Views.FileMenuPanels.MainSettingsGeneral({menu:this}).render(this.$el.find("#panel-settings")),info:new SSE.Views.FileMenuPanels.DocumentInfo({menu:this}).render(this.$el.find("#panel-info")),rights:new SSE.Views.FileMenuPanels.DocumentRights({menu:this}).render(this.$el.find("#panel-rights"))}),this.mode&&(s=!1,e=Common.UI.LayoutManager.isElementVisible("toolbar-file-close"),this.miClose[e?"show":"hide"](),this.miClose.$el.find("+.devider")[e?"show":"hide"](),e&&(t=this.miClose.$el.find("+.devider")),this.miDownload[!this.mode.canDownload||this.mode.isDesktopApp&&this.mode.isOffline?"hide":"show"](),i=!!window.AscDesktopEditor&&window.AscDesktopEditor.isBlockchainSupport(),this.miSaveCopyAs[!this.mode.canDownload||this.mode.isDesktopApp&&this.mode.isOffline||!this.mode.canRequestSaveAs&&!this.mode.saveAsUrl||i?"hide":"show"](),this.miSaveAs[this.mode.canDownload&&this.mode.isDesktopApp&&this.mode.isOffline?"show":"hide"](),this.miExportToPDF[this.mode.canDownload&&this.mode.isDesktopApp&&this.mode.isOffline?"show":"hide"](),this.miSave[this.mode.isEdit&&Common.UI.LayoutManager.isElementVisible("toolbar-file-save")?"show":"hide"](),this.miEdit[!this.mode.isEdit&&this.mode.canEdit&&this.mode.canRequestEditRights?"show":"hide"](),this.miPrintWithPreview[this.mode.canPrint?"show":"hide"](),this.miRename[this.mode.canRename&&!this.mode.isDesktopApp?"show":"hide"](),this.miProtect[this.mode.isSignatureSupport||this.mode.isPasswordSupport?"show":"hide"](),s=(this.mode.canDownload||this.mode.isEdit&&Common.UI.LayoutManager.isElementVisible("toolbar-file-save")||this.mode.canPrint||this.mode.isSignatureSupport||this.mode.isPasswordSupport||!this.mode.isEdit&&this.mode.canEdit&&this.mode.canRequestEditRights||this.mode.canRename&&!this.mode.isDesktopApp)&&!this.mode.isDisconnected,this.miProtect.$el.find("+.devider")[s?"show":"hide"](),s&&(t=this.miProtect.$el.find("+.devider")),this.miRecent[this.mode.canOpenRecent?"show":"hide"](),this.miNew[this.mode.canCreateNew?"show":"hide"](),s=this.mode.canCreateNew,this.miNew.$el.find("+.devider")[s?"show":"hide"](),s&&(t=this.miNew.$el.find("+.devider")),e=Common.UI.LayoutManager.isElementVisible("toolbar-file-info"),this.miInfo[(s=e)?"show":"hide"](),e=!this.mode.isOffline&&this.document&&this.document.info&&(this.document.info.sharingSettings&&0<this.document.info.sharingSettings.length||this.mode.sharingSettingsUrl&&this.mode.sharingSettingsUrl.length||this.mode.canRequestSharingSettings),s=s||e,this.miAccess[e?"show":"hide"](),e=this.mode.canUseHistory&&!this.mode.isDisconnected,s=s||e,this.miHistory[e?"show":"hide"](),this.miHistory.$el.find("+.devider")[s?"show":"hide"](),s&&(t=this.miHistory.$el.find("+.devider")),e=Common.UI.LayoutManager.isElementVisible("toolbar-file-settings"),this.miSettings[e?"show":"hide"](),this.miSettings.$el.find("+.devider")[e?"show":"hide"](),e&&(t=this.miSettings.$el.find("+.devider")),e=this.mode.canHelp,this.miHelp[e?"show":"hide"](),this.miHelp.$el.find("+.devider")[e?"show":"hide"](),e&&(t=this.miHelp.$el.find("+.devider")),e=this.mode.canBack,this.miBack[e?"show":"hide"](),t&&!e&&t.hide(),e=this.mode.customization.canSetDefault,this.miSetDefault[e?"show":"hide"](),e=this.mode.customization.canUnInstall,this.miUnInstall[e?"show":"hide"](),e=this.mode.customization.canToggleOnline,this.miToggleOnline[e?"show":"hide"](),!(i=this.mode.document&&this.mode.document.url).startsWith("file:///")&&i.includes(":")?this.miDownloadOnline.show():this.miDownloadOnline.hide(),this.customizationDone||(this.customizationDone=!0,Common.Utils.applyCustomization(this.mode.customization,{goback:"#fm-btn-back > a"})),this.panels.opts.setMode(this.mode),this.panels.info.setMode(this.mode),this.mode.isDisconnected||this.panels.info.updateInfo(this.document),this.panels.rights.setMode(this.mode),this.mode.isDisconnected||this.panels.rights.updateInfo(this.document),this.panels.printpreview&&this.panels.printpreview.setMode(this.mode),this.mode.canCreateNew&&this.mode.templates&&this.mode.templates.length&&(this.panels.new||(this.panels.new=new SSE.Views.FileMenuPanels.CreateNew({menu:this,docs:this.mode.templates,blank:this.mode.canRequestCreateNew||!!this.mode.createUrl}).render())),this.mode.canOpenRecent&&this.mode.recent&&(this.panels.recent||(this.panels.recent=new Common.Views.RecentFiles({el:"#panel-recentfiles",menu:this,recent:this.mode.recent}).render())),(this.mode.isSignatureSupport||this.mode.isPasswordSupport)&&(this.panels.protect||(this.panels.protect=new SSE.Views.FileMenuPanels.ProtectDoc({menu:this}).render()),this.panels.protect.setMode(this.mode)),this.mode.canDownload&&!this.panels.saveas&&(this.panels.saveas=new SSE.Views.FileMenuPanels.ViewSaveAs({menu:this,fileType:this.document.fileType}).render()),this.mode.canDownload&&(this.mode.canRequestSaveAs||this.mode.saveAsUrl)&&!this.panels["save-copy"]&&(this.panels["save-copy"]=new SSE.Views.FileMenuPanels.ViewSaveCopy({menu:this,fileType:this.document.fileType}).render()),this.mode.canHelp&&!this.panels.help&&(this.panels.help=new SSE.Views.FileMenuPanels.Help({menu:this}).render(),this.panels.help.setLangConfig(this.mode.lang)),null!=this.mode.disableEditing&&(this.panels.opts.SetDisabled(this.mode.disableEditing),delete this.mode.disableEditing),this.mode.canPrint&&!((s=SSE.getController("Print").getView("PrintWithPreview")).menu=this).panels.printpreview&&(this.panels.printpreview=s.render(this.$el.find("#panel-print"))),this.mode.canCreateNew&&($('<li id="fm-btn-local-open" class="fm-btn"/>').insertAfter($("#fm-btn-create",this.$el)),this.items.push(new Common.UI.MenuItem({el:$("#fm-btn-local-open",this.$el),action:"file:open",caption:this.btnFileOpenCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[2,14]})))))},setMode:function(t,e){t.isDisconnected?(this.mode.canEdit=this.mode.isEdit=!1,this.mode.canOpenRecent=this.mode.canCreateNew=!1,this.mode.isDisconnected=t.isDisconnected,this.mode.canRename=!1,t.enableDownload||(this.mode.canPrint=this.mode.canDownload=!1)):this.mode=t,e||this.applyMode()},setApi:function(t){this.api=t,this.rendered&&(this.panels.info.setApi(t),this.panels.opts&&this.panels.opts.setApi(t),this.panels.protect&&this.panels.protect.setApi(t)),this.api.asc_registerCallback("asc_onDocumentName",s.bind(this.onDocumentName,this))},loadDocument:function(t){this.document=t.doc},selectMenu:function(t,e,i){var s,o;t&&(o=this._getMenuItem(t),s=this.panels[t],!o.isDisabled()&&o.isVisible()||(o=this._getMenuItem(i),s=this.panels[i]),o&&s&&($(".fm-btn",this.el).removeClass("active"),o.$el.addClass("active"),this.$el.find(".content-box:visible").hide(),s.show(e),this.scroller&&(i=o.$el.position().top,s=o.$el.outerHeight(),e=this.$el.outerHeight(),(i<0||e<i+s)&&(o=this.scroller.$el.scrollTop()+i+(s-e)/2,o=Math.floor(o/s)*s,this.scroller.scrollTop(o))),this.active=t))},_getMenuItem:function(e){return s.find(this.items,function(t){return t.options.action==e})},onDocumentName:function(t){this.document.title=t,this.rendered&&this.panels.info.updateInfo(this.document)},isVisible:function(){return!this.$el.is(":hidden")},getButton:function(t){return this.rendered?"save"==t?this.miSave:"rename"==t?this.miRename:"protect"==t?this.miProtect:void 0:"save"==t?this.options.miSave||(this.options.miSave=new Common.UI.MenuItem({})):"rename"==t?this.options.miRename||(this.options.miRename=new Common.UI.MenuItem({})):"protect"==t?this.options.miProtect||(this.options.miProtect=new Common.UI.MenuItem({})):void 0},SetDisabled:function(t,e){var i;this.mode&&(this.panels?this.panels.opts.SetDisabled(t):this.mode.disableEditing=t,i=this.getButton("protect"),e&&e.protect&&i.setDisabled(t||!this.mode.isEdit))}},SSE.Views.FileMenu||{}))}),define("spreadsheeteditor/main/app/view/LeftMenu",["text!spreadsheeteditor/main/app/template/LeftMenu.template","jquery","underscore","backbone","common/main/lib/component/Button","common/main/lib/view/SearchDialog","spreadsheeteditor/main/app/view/FileMenu"],function(t,o,n,e){"use strict";SSE.Views.LeftMenu=e.View.extend(n.extend({el:"#left-menu",template:n.template(t),events:function(){return{}},initialize:function(){this.minimizedMode=!0,this._state={disabled:!1}},render:function(){var t=o(this.template({}));return this.btnSearchBar=new Common.UI.Button({action:"advancedsearch",el:t.elementById("#left-btn-searchbar"),hint:this.tipSearch,disabled:!0,iconCls:"btn-menu-search",enableToggle:!0,toggleGroup:"leftMenuGroup"}),this.btnSearchBar.on("click",n.bind(this.onBtnMenuClick,this)),this.btnAbout=new Common.UI.Button({action:"about",el:t.elementById("#left-btn-about"),hint:this.tipAbout,enableToggle:!0,disabled:!0,iconCls:"btn-menu-about",toggleGroup:"leftMenuGroup"}),this.btnSupport=new Common.UI.Button({action:"support",el:t.elementById("#left-btn-support"),hint:this.tipSupport,disabled:!0,iconCls:"btn-menu-support"}),this.btnComments=new Common.UI.Button({el:t.elementById("#left-btn-comments"),hint:this.tipComments+Common.Utils.String.platformKey("Ctrl+Shift+H"),enableToggle:!0,disabled:!0,iconCls:"btn-menu-comments",toggleGroup:"leftMenuGroup"}),this.btnComments.on("toggle",this.onBtnCommentsToggle.bind(this)),this.btnComments.on("click",this.onBtnMenuClick.bind(this)),this.btnChat=new Common.UI.Button({el:t.elementById("#left-btn-chat"),hint:this.tipChat+Common.Utils.String.platformKey("Alt+Q"," ("+(Common.Utils.isMac?Common.Utils.String.textCtrl+"+":"")+"{0})"),enableToggle:!0,disabled:!0,iconCls:"btn-menu-chat",toggleGroup:"leftMenuGroup"}),this.btnChat.on("click",this.onBtnMenuClick.bind(this)),this.btnComments.hide(),this.btnChat.hide(),this.btnPlugins=new Common.UI.Button({el:t.elementById("#left-btn-plugins"),hint:this.tipPlugins,enableToggle:!0,disabled:!0,iconCls:"btn-menu-plugin",toggleGroup:"leftMenuGroup"}),this.btnPlugins.hide(),this.btnPlugins.on("click",n.bind(this.onBtnMenuClick,this)),this.btnSpellcheck=new Common.UI.Button({el:t.elementById("#left-btn-spellcheck"),hint:this.tipSpellcheck,enableToggle:!0,disabled:!0,iconCls:"btn-ic-docspell",toggleGroup:"leftMenuGroup"}),this.btnSpellcheck.hide(),this.btnSpellcheck.on("click",n.bind(this.onBtnMenuClick,this)),this.menuFile=new SSE.Views.FileMenu({}),this.$el.html(t),this},onBtnMenuToggle:function(t,e){e?(t.panel.show(),this._state.pluginIsRunning||this.$el.width(40)):t.panel.hide(),SSE.getController("Toolbar").DisableToolbar(1==e),Common.NotificationCenter.trigger("layout:changed","leftmenu")},onBtnCommentsToggle:function(t,e){e||this.fireEvent("comments:hide",this)},onBtnMenuClick:function(t,e){var i;this.btnAbout.toggle(!1),t.pressed?40<this.$el.width()||this.$el.width(Common.localStorage.getItem("sse-mainmenu-width")||300):this._state.pluginIsRunning||(i=this.$el.width(),this.isVisible()&&40<i&&Common.localStorage.setItem("sse-mainmenu-width",i),this.$el.width(40)),this.onCoauthOptions(),t.pressed&&"advancedsearch"==t.options.action&&this.fireEvent("search:aftershow",this),Common.NotificationCenter.trigger("layout:changed","leftmenu")},onCoauthOptions:function(t){this.mode.canCoAuthoring&&(this.mode.canViewComments&&(this.btnComments.pressed&&this.btnComments.$el.hasClass("notify")&&this.btnComments.$el.removeClass("notify"),this.panelComments[this.btnComments.pressed?"show":"hide"](),this.fireEvent(this.btnComments.pressed?"comments:show":"comments:hide",this)),this.mode.canChat&&(this.btnChat.pressed?(this.btnChat.$el.hasClass("notify")&&this.btnChat.$el.removeClass("notify"),this.panelChat.show(),this.panelChat.focus()):this.panelChat.hide())),this.panelSpellcheck&&(this.btnSpellcheck.pressed?this.panelSpellcheck.show():this.panelSpellcheck.hide()),this.panelSearch&&(this.btnSearchBar.pressed?(this.panelSearch.show(),this.panelSearch.focus()):this.panelSearch.hide())},setOptionsPanel:function(t,e){"chat"==t?this.panelChat=e.render("#left-panel-chat"):"comment"==t?this.panelComments=e:"plugins"!=t||this.panelPlugins?"spellcheck"!=t||this.panelSpellcheck?"history"==t?this.panelHistory=e.render("#left-panel-history"):"advancedsearch"==t&&(this.panelSearch=e.render("#left-panel-search")):this.panelSpellcheck=e.render("#left-panel-spellcheck"):this.panelPlugins=e.render("#left-panel-plugins")},markCoauthOptions:function(t,e){"chat"!=t||!this.btnChat.isVisible()||this.btnChat.isDisabled()||this.btnChat.pressed||this.btnChat.$el.addClass("notify"),"comments"!=t||!this.btnComments.isVisible()||this.btnComments.pressed||this.btnComments.isDisabled()&&!e||this.btnComments.$el.addClass("notify")},close:function(t){this.btnAbout.toggle(!1),this._state.pluginIsRunning||this.$el.width(40),this.mode.canCoAuthoring&&(this.mode.canViewComments&&(this.panelComments.hide(),this.btnComments.pressed&&this.fireEvent("comments:hide",this),this.btnComments.toggle(!1,!0)),this.mode.canChat&&(this.panelChat.hide(),this.btnChat.toggle(!1))),this.mode.canPlugins&&this.panelPlugins&&!this._state.pluginIsRunning&&(this.panelPlugins.hide(),this.btnPlugins.toggle(!1,!0)),this.panelSpellcheck&&(this.panelSpellcheck.hide(),this.btnSpellcheck.toggle(!1,!0)),this.panelSearch&&(this.panelSearch.hide(),this.btnSearchBar.toggle(!1,!0))},isOpened:function(){return this.btnSearchBar.pressed||this.btnComments.pressed||this.btnChat.pressed},disableMenu:function(t,e){this.btnAbout.setDisabled(!1),this.btnSupport.setDisabled(!1),this.btnSearchBar.setDisabled(!1),this.btnComments.setDisabled(!1),this.btnChat.setDisabled(!1),this.btnPlugins.setDisabled(!1),this.btnSpellcheck.setDisabled(!1)},showMenu:function(t,e){var i=/^(\w+):?(\w*)$/.exec(t);"file"==i[1]?this.menuFile.show(i[2].length?i[2]:void 0,e):"chat"==t?!this.btnChat.isVisible()||this.btnChat.isDisabled()||this.btnChat.pressed||(this.btnChat.toggle(!0),this.onBtnMenuClick(this.btnChat),this.panelChat.focus()):"comments"==t?!this.btnComments.isVisible()||this.btnComments.isDisabled()||this.btnComments.pressed||(this.btnComments.toggle(!0),this.onBtnMenuClick(this.btnComments),this.btnComments.$el.focus()):"advancedsearch"!=t||!this.btnSearchBar.isVisible()||this.btnSearchBar.isDisabled()||this.btnSearchBar.pressed||(this.btnSearchBar.toggle(!0),this.onBtnMenuClick(this.btnSearchBar))},getMenu:function(t){switch(t){case"file":return this.menuFile;case"about":return this.btnAbout.panel;default:return null}},setMode:function(t){return this.mode=t,this},setDeveloperMode:function(t,e,i){var s;this.$el.is(":visible")&&((t&Asc.c_oLicenseMode.Trial||t&Asc.c_oLicenseMode.Developer)&&!this.developerHint&&(s="",t&Asc.c_oLicenseMode.Trial&&t&Asc.c_oLicenseMode.Developer?s=this.txtTrialDev:0!=(t&Asc.c_oLicenseMode.Trial)?s=this.txtTrial:0!=(t&Asc.c_oLicenseMode.Developer)&&(s=this.txtDeveloper),s=s.toUpperCase(),this.developerHint=o('<div id="developer-hint">'+s+"</div>").appendTo(this.$el),this.devHeight=this.developerHint.outerHeight(),this.devHintInited||o(window).on("resize",n.bind(this.onWindowResize,this)),this.devHintInited=!0),this.developerHint&&this.developerHint.toggleClass("hidden",!(t&Asc.c_oLicenseMode.Trial||t&Asc.c_oLicenseMode.Developer)),e&&!this.betaHint&&(s=t?'style="margin-top: 4px;"':"",t="",0<(i=(i||"").split(".")).length&&(t+="v. "+i[0]),1<i.length&&(t+="."+i[1]),this.betaHint=o('<div id="beta-hint"'+s+">"+t+" (beta)</div>").appendTo(this.$el),this.betaHeight=this.betaHint.outerHeight(),this.devHintInited||o(window).on("resize",n.bind(this.onWindowResize,this)),this.devHintInited=!0),this.betaHint&&this.betaHint.toggleClass("hidden",!e),s=0<(i=this.$el.find("button.btn-category:visible")).length?o(i[i.length-1]):null,this.minDevPosition=s?s.offset().top-s.offsetParent().offset().top+s.height()+20:20,this.onWindowResize())},setLimitMode:function(){var t;this.$el.is(":visible")&&(this.limitHint||(t=this.txtLimit.toUpperCase(),this.limitHint=o('<div id="limit-hint" style="margin-top: 4px;">'+t+"</div>").appendTo(this.$el),this.limitHeight=this.limitHint.outerHeight(),this.devHintInited||o(window).on("resize",n.bind(this.onWindowResize,this)),this.devHintInited=!0),this.limitHint&&this.limitHint.toggleClass("hidden",!1),t=0<(t=this.$el.find("button.btn-category:visible")).length?o(t[t.length-1]):null,this.minDevPosition=t?t.offset().top-t.offsetParent().offset().top+t.height()+20:20,this.onWindowResize())},onWindowResize:function(){var t=(this.devHeight||0)+(this.betaHeight||0)+(this.limitHeight||0),t=Math.max((this.$el.height()-t)/2,this.minDevPosition);this.developerHint&&(this.developerHint.css("top",t),t+=this.devHeight),this.betaHint&&(this.betaHint.css("top",t),t+=this.betaHeight+4),this.limitHint&&this.limitHint.css("top",t)},showHistory:function(){this._state.pluginIsRunning=!1,this._state.historyIsRunning=!0,this.panelHistory.show(),this.panelHistory.$el.width((parseInt(Common.localStorage.getItem("sse-mainmenu-width"))||300)-40),Common.NotificationCenter.trigger("layout:changed","history")},isVisible:function(){return this.$el&&this.$el.is(":visible")}},SSE.Views.LeftMenu||{}))}),define("spreadsheeteditor/main/app/controller/LeftMenu",["core","common/main/lib/util/Shortcuts","common/main/lib/view/SaveAsDlg","spreadsheeteditor/main/app/view/LeftMenu","spreadsheeteditor/main/app/view/FileMenu"],function(){"use strict";SSE.Controllers.LeftMenu=Backbone.Controller.extend(_.extend({views:["LeftMenu","FileMenu"],initialize:function(){this.addListeners({"Common.Views.Chat":{hide:_.bind(this.onHideChat,this)},"Common.Views.Plugins":{"plugin:open":_.bind(this.onPluginOpen,this),hide:_.bind(this.onHidePlugins,this)},"Common.Views.Header":{"history:show":function(){this.leftMenu.panelHistory.isVisible()||this.clickMenuFileItem("header","history")}.bind(this),rename:_.bind(function(t){this.mode&&this.mode.wopi&&this.api?this.api.asc_wopi_renameFile(t):Common.Gateway.requestRename(t)},this)},LeftMenu:{"file:show":_.bind(this.fileShowHide,this,!0),"file:hide":_.bind(this.fileShowHide,this,!1),"comments:show":_.bind(this.commentsShowHide,this,!0),"comments:hide":_.bind(this.commentsShowHide,this,!1)},"Common.Views.About":{show:_.bind(this.aboutShowHide,this,!0),hide:_.bind(this.aboutShowHide,this,!1)},FileMenu:{"menu:hide":_.bind(this.menuFilesShowHide,this,"hide"),"menu:show":_.bind(this.menuFilesShowHide,this,"show"),"item:click":_.bind(this.clickMenuFileItem,this),"saveas:format":_.bind(this.clickSaveAsFormat,this),"savecopy:format":_.bind(this.clickSaveCopyAsFormat,this),"settings:apply":_.bind(this.applySettings,this),"spellcheck:apply":_.bind(this.applySpellcheckSettings,this),"create:new":_.bind(this.onCreateNew,this),"recent:open":_.bind(this.onOpenRecent,this)},Toolbar:{"file:settings":_.bind(this.clickToolbarSettings,this),"file:open":this.clickToolbarTab.bind(this,"file"),"file:close":this.clickToolbarTab.bind(this,"other"),"save:disabled":this.changeToolbarSaveState.bind(this)},"Common.Views.ReviewChanges":{"collaboration:chat":_.bind(this.onShowHideChat,this)},SearchBar:{"search:show":_.bind(this.onShowHideSearch,this)},ViewTab:{"leftmenu:hide":_.bind(this.onLeftMenuHide,this)}}),Common.NotificationCenter.on("app:comment:add",_.bind(this.onAppAddComment,this)),Common.NotificationCenter.on("leftmenu:change",_.bind(this.onMenuChange,this)),Common.NotificationCenter.on("collaboration:history",_.bind(function(){this.leftMenu.panelHistory.isVisible()||this.clickMenuFileItem(null,"history")},this)),Common.NotificationCenter.on("file:print",_.bind(this.clickToolbarPrint,this))},onLaunch:function(){this.leftMenu=this.createView("LeftMenu").render(),this.leftMenu.btnSearchBar.on("toggle",_.bind(this.onMenuSearchBar,this));var t={"command+shift+s,ctrl+shift+s":_.bind(this.onShortcut,this,"save"),"command+f,ctrl+f":_.bind(this.onShortcut,this,"search"),"ctrl+h":_.bind(this.onShortcut,this,"replace"),esc:_.bind(this.onShortcut,this,"escape"),"command+shift+h,ctrl+shift+h":_.bind(this.onShortcut,this,"comments"),f1:_.bind(this.onShortcut,this,"help")},e=(t[Common.Utils.isMac?"ctrl+alt+f":"alt+f"]=_.bind(this.onShortcut,this,"file"),t[Common.Utils.isMac?"ctrl+alt+q":"alt+q"]=_.bind(this.onShortcut,this,"chat"),Common.util.Shortcuts.delegateShortcuts({shortcuts:t}),Common.util.Shortcuts.suspendEvents(),this);this.leftMenu.$el.find("button").each(function(){$(this).on("keydown",function(t){Common.UI.Keys.RETURN!==t.keyCode&&Common.UI.Keys.SPACE!==t.keyCode||(e.leftMenu.btnAbout.toggle(!1),this.blur(),t.preventDefault(),e.api.asc_enableKeyEvents(!0))})})},setApi:function(t){if(this.api=t,this.api.asc_registerCallback("asc_onCoAuthoringDisconnect",_.bind(this.onApiServerDisconnect,this)),Common.NotificationCenter.on("api:disconnect",_.bind(this.onApiServerDisconnect,this)),this.api.asc_registerCallback("asc_onDownloadUrl",_.bind(this.onDownloadUrl,this)),Common.NotificationCenter.on("download:cancel",_.bind(this.onDownloadCancel,this)),this.mode.canCoAuthoring&&(this.mode.canChat&&this.api.asc_registerCallback("asc_onCoAuthoringChatReceiveMessage",_.bind(this.onApiChatMessage,this)),this.mode.canComments)){this.api.asc_registerCallback("asc_onAddComment",_.bind(this.onApiAddComment,this)),this.api.asc_registerCallback("asc_onAddComments",_.bind(this.onApiAddComments,this));var e,i=this.getApplication().getController("Common.Controllers.Comments").groupCollection;for(e in i)for(var s=i[e],o=Common.Utils.InternalSettings.get("sse-settings-resolvedcomment"),n=0;n<s.length;++n){var a=s.at(n);if(!a.get("hide")&&a.get("userid")!==this.mode.user.id&&(o||!a.get("resolved"))){this.leftMenu.markCoauthOptions("comments",!0);break}}}return this.mode.isEditMailMerge||this.mode.isEditDiagram||this.mode.isEditOle||this.api.asc_registerCallback("asc_onEditCell",_.bind(this.onApiEditCell,this)),this.leftMenu.getMenu("file").setApi(t),this.mode.canUseHistory&&this.getApplication().getController("Common.Controllers.History").setApi(this.api).setMode(this.mode),this.getApplication().getController("Search").setApi(this.api).setMode(this.mode),this.leftMenu.setOptionsPanel("advancedsearch",this.getApplication().getController("Search").getView("Common.Views.SearchPanel")),this},setMode:function(t){return this.mode=t,this.leftMenu.setMode(t),this.leftMenu.getMenu("file").setMode(t),t.isEdit||Common.util.Shortcuts.removeShortcuts({shortcuts:{"command+shift+s,ctrl+shift+s":_.bind(this.onShortcut,this,"save"),"alt+f":_.bind(this.onShortcut,this,"file"),"ctrl+alt+f":_.bind(this.onShortcut,this,"file")}}),this},SetDisabled:function(t,e){this.leftMenu._state.disabled!==t&&((this.leftMenu._state.disabled=t)?(this.previsEdit=this.mode.isEdit,this.prevcanEdit=this.mode.canEdit,this.mode.isEdit=this.mode.canEdit=!t):(this.mode.isEdit=this.previsEdit,this.mode.canEdit=this.prevcanEdit)),t&&this.leftMenu.close(),(!e||e.comments&&e.comments.disable)&&this.leftMenu.btnComments.setDisabled(t),e&&!e.chat||this.leftMenu.btnChat.setDisabled(t),this.leftMenu.btnPlugins.setDisabled(t),this.leftMenu.btnSpellcheck.setDisabled(t)},createDelayedElements:function(){return this.mode.canCoAuthoring?(this.leftMenu.btnComments[this.mode.canViewComments&&!this.mode.isLightVersion?"show":"hide"](),this.mode.canViewComments&&this.leftMenu.setOptionsPanel("comment",this.getApplication().getController("Common.Controllers.Comments").getView("Common.Views.Comments")),this.leftMenu.btnChat[this.mode.canChat&&!this.mode.isLightVersion?"show":"hide"](),this.mode.canChat&&this.leftMenu.setOptionsPanel("chat",this.getApplication().getController("Common.Controllers.Chat").getView("Common.Views.Chat"))):(this.leftMenu.btnChat.hide(),this.leftMenu.btnComments.hide()),this.mode.isEdit&&Common.UI.FeaturesManager.canChange("spellcheck")&&(Common.UI.LayoutManager.isElementVisible("leftMenu-spellcheck")&&this.leftMenu.btnSpellcheck.show(),this.leftMenu.setOptionsPanel("spellcheck",this.getApplication().getController("Spellcheck").getView("Spellcheck"))),this.mode.canUseHistory&&this.leftMenu.setOptionsPanel("history",this.getApplication().getController("Common.Controllers.History").getView("Common.Views.History")),(this.mode.trialMode||this.mode.isBeta)&&this.leftMenu.setDeveloperMode(this.mode.trialMode,this.mode.isBeta,this.mode.buildVersion),Common.util.Shortcuts.resumeEvents(),this.mode.isEditMailMerge||this.mode.isEditDiagram||this.mode.isEditOle||Common.NotificationCenter.on("cells:range",_.bind(this.onCellsRange,this)),this},enablePlugins:function(){this.mode.canPlugins?this.leftMenu.setOptionsPanel("plugins",this.getApplication().getController("Common.Controllers.Plugins").getView("Common.Views.Plugins")):this.leftMenu.btnPlugins.hide(),(this.mode.trialMode||this.mode.isBeta)&&this.leftMenu.setDeveloperMode(this.mode.trialMode,this.mode.isBeta,this.mode.buildVersion)},clickMenuFileItem:function(t,e,i){var s=!0;switch(e){case"back":break;case"save":this.api.asc_Save();break;case"save-desktop":this.api.asc_DownloadAs();break;case"export-pdf":Common.NotificationCenter.trigger("export:to",this.leftMenu,Asc.c_oAscFileType.PDF);break;case"print":Common.NotificationCenter.trigger("print",this.leftMenu);break;case"exit":Common.NotificationCenter.trigger("goback");break;case"edit":this.getApplication().getController("Statusbar").setStatusCaption(this.requestEditRightsText),Common.Gateway.requestEditRights();break;case"new":i?s=!1:this.onCreateNew(void 0,"blank");break;case"file:open":i?s=!1:this.onOpenFile(void 0,"blank");break;case"set-default":i?s=!1:this.onSetDefault();break;case"feedback":i?s=!1:this.onFeedback();break;case"uninstall":i?s=!1:this.onUnInstall();break;case"toggle-online":i?s=!1:this.onToggleOnline();break;case"download-online":i?s=!1:this.onDownloadOnline();break;case"rename":var o,n=(o=this).api.asc_getDocumentName();new Common.Views.RenameDialog({filename:n,maxLength:this.mode.wopi?this.mode.wopi.FileNameMaxLength:void 0,handler:function(t,e){"ok"!=t||_.isEmpty(e.trim())||n===e.trim()||(o.mode.wopi?o.api.asc_wopi_renameFile(e):Common.Gateway.requestRename(e)),Common.NotificationCenter.trigger("edit:complete",o)}}).show();break;case"history":this.leftMenu.panelHistory.isVisible()||(this.api.asc_isDocumentModified()?((o=this).api.asc_stopSaving(),Common.UI.warning({closable:!1,width:500,title:this.notcriticalErrorTitle,msg:this.leavePageText,buttons:["ok","cancel"],primary:"ok",callback:function(t){"ok"==t?(o.api.asc_undoAllChanges(),o.api.asc_continueSaving(),o.showHistory()):o.api.asc_continueSaving()}})):this.showHistory());break;case"external-help":s=!0;break;default:s=!1}s&&t&&t.hide()},showLostDataWarning:function(e){Common.UI.warning({title:this.textWarning,msg:this.warnDownloadAs,buttons:["ok","cancel"],callback:_.bind(function(t){"ok"==t&&e.call()},this)})},clickSaveAsFormat:function(e,i){var s;i==Asc.c_oAscFileType.CSV?1<(s=this).api.asc_getWorksheetsCount()?Common.UI.warning({title:this.textWarning,msg:this.warnDownloadCsvSheets,buttons:[{value:"ok",caption:this.textSave},"cancel"],callback:_.bind(function(t){"ok"==t&&s.showLostDataWarning(function(){s.api.asc_DownloadAs(new Asc.asc_CDownloadOptions(i)),e.hide()})},this)}):this.showLostDataWarning(function(){s.api.asc_DownloadAs(new Asc.asc_CDownloadOptions(i)),e.hide()}):i==Asc.c_oAscFileType.PDF||i==Asc.c_oAscFileType.PDFA?(e.hide(),Common.NotificationCenter.trigger("download:settings",this.leftMenu,i)):(this.api.asc_DownloadAs(new Asc.asc_CDownloadOptions(i)),e.hide())},clickSaveCopyAsFormat:function(e,i,s){var o;i==Asc.c_oAscFileType.CSV?1<(o=this).api.asc_getWorksheetsCount()?Common.UI.warning({title:this.textWarning,msg:this.warnDownloadCsvSheets,buttons:[{value:"ok",caption:this.textSave},"cancel"],callback:_.bind(function(t){"ok"==t&&o.showLostDataWarning(function(){o.isFromFileDownloadAs=s,Common.NotificationCenter.trigger("download:advanced",Asc.c_oAscAdvancedOptionsID.CSV,o.api.asc_getAdvancedOptions(),2,new Asc.asc_CDownloadOptions(i,!0)),e.hide()})},this)}):o.showLostDataWarning(function(){o.isFromFileDownloadAs=s,Common.NotificationCenter.trigger("download:advanced",Asc.c_oAscAdvancedOptionsID.CSV,o.api.asc_getAdvancedOptions(),2,new Asc.asc_CDownloadOptions(i,!0)),e.hide()}):i==Asc.c_oAscFileType.PDF||i==Asc.c_oAscFileType.PDFA?(this.isFromFileDownloadAs=s,e.hide(),Common.NotificationCenter.trigger("download:settings",this.leftMenu,i,!0)):(this.isFromFileDownloadAs=s,this.api.asc_DownloadAs(new Asc.asc_CDownloadOptions(i,!0)),e.hide())},onDownloadUrl:function(t,e){var i,s,o;this.isFromFileDownloadAs&&(o=(o=(i=this).getApplication().getController("Viewport").getView("Common.Views.Header").getDocumentCaption())||i.txtUntitled,"string"==typeof this.isFromFileDownloadAs&&0<(s=o.lastIndexOf("."))&&(o=o.substring(0,s)+this.isFromFileDownloadAs),i.mode.canRequestSaveAs?Common.Gateway.requestSaveAs(t,o,e):(i._saveCopyDlg=new Common.Views.SaveAsDlg({saveFolderUrl:i.mode.saveAsUrl,saveFileUrl:t,defFileName:o}),i._saveCopyDlg.on("saveaserror",function(t,e){e={closable:!1,title:i.textWarning,msg:e,iconCls:"warn",buttons:["ok"],callback:function(t){Common.NotificationCenter.trigger("edit:complete",i)}};Common.UI.alert(e)}).on("close",function(t){i._saveCopyDlg=void 0}),i._saveCopyDlg.show())),this.isFromFileDownloadAs=!1},onDownloadCancel:function(){this.isFromFileDownloadAs=!1},applySettings:function(t){var e=Common.localStorage.getBool("sse-settings-cachemode",!0),i=(Common.Utils.InternalSettings.set("sse-settings-cachemode",e),this.api.asc_setDefaultBlitMode(e),e=Common.localStorage.getItem("sse-settings-fontrender"),Common.Utils.InternalSettings.set("sse-settings-fontrender",e),this.api.asc_setFontRenderingMode(parseInt(e)),e=Common.localStorage.getBool("sse-settings-livecomment",!0),Common.Utils.InternalSettings.set("sse-settings-livecomment",e),Common.localStorage.getBool("sse-settings-resolvedcomment")),i=(Common.Utils.InternalSettings.set("sse-settings-resolvedcomment",i),(e=this.mode.canViewComments&&this.leftMenu.panelComments&&this.leftMenu.panelComments.isVisible()?i=!0:e)?this.api.asc_showComments(i):this.api.asc_hideComments(),this.getApplication().getController("Common.Controllers.ReviewChanges").commentsShowHide(e?"show":"hide"),e=Common.localStorage.getBool("sse-settings-r1c1"),Common.Utils.InternalSettings.set("sse-settings-r1c1",e),this.api.asc_setR1C1Mode(e),Common.Utils.InternalSettings.get("sse-settings-coauthmode")),i=(this.mode.isEdit&&!this.mode.isOffline&&this.mode.canCoAuthoring?this.mode.canChangeCoAuthoring&&(i=Common.localStorage.getBool("sse-settings-coauthmode",!0),Common.Utils.InternalSettings.set("sse-settings-coauthmode",i),this.api.asc_SetFastCollaborative(i)):this.mode.canLiveView&&!this.mode.isOffline&&this.mode.canChangeCoAuthoring&&(i=Common.localStorage.getBool("sse-settings-view-coauthmode",!1),Common.Utils.InternalSettings.set("sse-settings-coauthmode",i),this.api.asc_SetFastCollaborative(i)),this.mode.isEdit&&(!this.mode.canChangeCoAuthoring&&i||(e=parseInt(Common.localStorage.getItem("sse-settings-autosave")),Common.Utils.InternalSettings.set("sse-settings-autosave",e),this.api.asc_setAutoSaveGap(e)),e=parseInt(Common.localStorage.getItem("sse-settings-paste-button")),Common.Utils.InternalSettings.set("sse-settings-paste-button",e),this.api.asc_setVisiblePasteButton(!!e)),Common.localStorage.getItem("sse-settings-reg-settings")),e=Common.Utils.InternalSettings.get("sse-settings-use-base-separator");null===i&&(i=this.api.asc_getLocale()),e?this.api.asc_setLocale(parseInt(i),void 0,void 0):this.api.asc_setLocale(parseInt(i),Common.localStorage.getItem("sse-settings-decimal-separator"),Common.localStorage.getItem("sse-settings-group-separator")),t.hide(),this.leftMenu.fireEvent("settings:apply")},applySpellcheckSettings:function(t){var e;this.mode.isEdit&&this.api&&Common.UI.FeaturesManager.canChange("spellcheck")&&(e=Common.localStorage.getBool("sse-spellcheck-ignore-uppercase-words"),this.api.asc_ignoreUppercase(e),e=Common.localStorage.getBool("sse-spellcheck-ignore-numbers-words"),this.api.asc_ignoreNumbers(e),(e=Common.localStorage.getItem("sse-spellcheck-locale"))&&this.api.asc_setDefaultLanguage(parseInt(e))),t.hide(),this.leftMenu.fireEvent("spellcheck:update")},onCreateNew:function(t,e){Common.Gateway.requestCreateNew({type:e})},onOpenFile:function(t){Common.Gateway._postMessage({event:"onRequestOpenFile",data:{type:"excel"}})},onSetDefault:function(){Common.Gateway._postMessage({event:"onRequestSetDefault",data:{type:"excel"}})},onFeedback:function(){Common.Gateway._postMessage({event:"onRequestFeedback",data:{type:"excel"}})},onUnInstall:function(){Common.Gateway._postMessage({event:"onRequestUnInstall",data:{type:"excel"}})},onToggleOnline:function(){Common.Gateway._postMessage({event:"onRequestToggleOnline",data:{type:"excel"}})},onDownloadOnline:function(){Common.Gateway._postMessage({event:"onRequestDownloadOnline",data:{type:"excel"}})},onOpenRecent:function(t,e){t&&t.hide();t=window.open(e);t&&t.focus(),Common.component.Analytics.trackEvent("Open Recent")},clickToolbarSettings:function(t){this.leftMenu.showMenu("file:opts")},clickToolbarTab:function(t,e){"file"==t?this.leftMenu.showMenu("file"):this.leftMenu.menuFile.hide()},clickToolbarPrint:function(){this.leftMenu.showMenu("file:printpreview")},changeToolbarSaveState:function(t){var e=this.leftMenu.menuFile.getButton("save");e&&e.setDisabled(t)},onHideChat:function(){$(this.leftMenu.btnChat.el).blur(),Common.NotificationCenter.trigger("layout:changed","leftmenu")},onHidePlugins:function(){Common.NotificationCenter.trigger("layout:changed","leftmenu")},setPreviewMode:function(t){this.viewmode!==t&&(this.viewmode=t,this.leftMenu.panelSearch&&this.leftMenu.panelSearch.setSearchMode(this.viewmode?"no-replace":"search"))},onApiServerDisconnect:function(t){this.mode.isEdit=!1,this.leftMenu.close(),this.leftMenu.btnComments.setDisabled(!0),this.leftMenu.btnChat.setDisabled(!0),this.leftMenu.btnPlugins.setDisabled(!0),this.leftMenu.btnSpellcheck.setDisabled(!0),this.leftMenu.getMenu("file").setMode({isDisconnected:!0,enableDownload:!!t})},onApiChatMessage:function(){this.leftMenu.markCoauthOptions("chat")},onApiAddComment:function(t,e){var i=Common.Utils.InternalSettings.get("sse-settings-resolvedcomment");e&&e.asc_getUserId()!==this.mode.user.id&&(i||!e.asc_getSolved())&&AscCommon.UserInfoParser.canViewComment(e.asc_getUserName())&&this.leftMenu.markCoauthOptions("comments")},onApiAddComments:function(t){for(var e=Common.Utils.InternalSettings.get("sse-settings-resolvedcomment"),i=0;i<t.length;++i)if(t[i].asc_getUserId()!==this.mode.user.id&&(e||!t[i].asc_getSolved())&&AscCommon.UserInfoParser.canViewComment(t[i].asc_getUserName())){this.leftMenu.markCoauthOptions("comments");break}},onAppAddComment:function(t,e){var i;e&&(i=this,new Promise(function(t,e){t()}).then(function(){Common.UI.Menu.Manager.hideAll(),i.leftMenu.showMenu("comments");var t=SSE.getController("Common.Controllers.Comments");t.getView().showEditContainer(!0),t.onAfterShow()}))},commentsShowHide:function(t){var e,i;this.api&&(e=Common.Utils.InternalSettings.get("sse-settings-livecomment"),i=Common.Utils.InternalSettings.get("sse-settings-resolvedcomment"),e&&i||(t?this.api.asc_showComments(!0):e?this.api.asc_showComments(i):this.api.asc_hideComments()),t&&this.getApplication().getController("Common.Controllers.Comments").onAfterShow(),t||$(this.leftMenu.btnComments.el).blur())},fileShowHide:function(t){this.api&&(this.api.asc_closeCellEditor(),this.api.asc_enableKeyEvents(!t))},aboutShowHide:function(t){this.api&&(this.api.asc_closeCellEditor(),this.api.asc_enableKeyEvents(!t),t||$(this.leftMenu.btnAbout.el).blur(),!t&&this.leftMenu._state.pluginIsRunning&&(this.leftMenu.panelPlugins.show(),this.mode.canCoAuthoring&&(this.mode.canViewComments&&this.leftMenu.panelComments.hide(),this.mode.canChat&&this.leftMenu.panelChat.hide())))},menuFilesShowHide:function(t){this.api&&(this.api.asc_closeCellEditor(),this.api.asc_enableKeyEvents(!("show"==t))),this.dlgSearch&&("show"==t?this.dlgSearch.suspendKeyEvents():Common.Utils.asyncCall(this.dlgSearch.resumeKeyEvents,this.dlgSearch))},onShortcut:function(t,e){if(this.mode){if(this.mode.isEditDiagram&&"escape"!=t)return!1;if(this.mode.isEditMailMerge&&"escape"!=t&&"search"!=t)return!1;if(this.mode.isEditOle&&"escape"!=t&&"search"!=t)return!1;switch(t){case"replace":case"search":if(this.mode.isEditMailMerge||this.mode.isEditOle)this.leftMenu.fireEvent("search:show");else if(!this.leftMenu.btnSearchBar.isDisabled()){Common.UI.Menu.Manager.hideAll(),this.leftMenu.btnAbout.toggle(!1),this.leftMenu.menuFile.isVisible()&&this.leftMenu.menuFile.hide();var i=this.api.asc_GetSelectedText();if(this.isSearchPanelVisible())return i&&this.leftMenu.panelSearch.setFindText(i),this.leftMenu.panelSearch.focus(""!==i?t:"search"),this.leftMenu.fireEvent("search:aftershow",[i||void 0]),!1;if(this.getApplication().getController("Viewport").isSearchBarVisible()){var s=this.getApplication().getController("Viewport");if("replace"!==t)return i&&s.searchBar.setText(i),s.searchBar.focus(),!1;s.header.btnSearch.toggle(!1),this.onShowHideSearch(!0,s.searchBar.inputSearch.val())}else{if("search"===t)return Common.NotificationCenter.trigger("search:show"),!1;this.onShowHideSearch(!0,i||void 0)}this.leftMenu.btnSearchBar.toggle(!0,!0),this.leftMenu.panelSearch.focus(i?t:"search")}return!1;case"save":return this.mode.canDownload&&(this.mode.isDesktopApp&&this.mode.isOffline?this.api.asc_DownloadAs():(Common.UI.Menu.Manager.hideAll(),this.leftMenu.showMenu("file:saveas"))),!1;case"help":return this.mode.isEdit&&this.mode.canHelp&&(Common.UI.Menu.Manager.hideAll(),this.api.asc_closeCellEditor(),this.leftMenu.showMenu("file:help")),!1;case"file":return Common.UI.Menu.Manager.hideAll(),this.leftMenu.showMenu("file"),!1;case"escape":s=this.getApplication().getController("Viewport").header.btnSearch;if(s.pressed&&s.toggle(!1),this.leftMenu.menuFile.isVisible())return Common.UI.HintManager.needCloseFileMenu()&&this.leftMenu.menuFile.hide(),!1;if((i=SSE.getController("Statusbar").statusbar.$el.find('.open > [data-toggle="dropdown"]')).length)return $.fn.dropdown.Constructor.prototype.keydown.call(i[0],e),!1;if(this.mode.canPlugins&&this.leftMenu.panelPlugins&&!0!==this.api.isCellEdited&&(i=this.leftMenu.panelPlugins.$el.find('#menu-plugin-container.open > [data-toggle="dropdown"]')).length)return $.fn.dropdown.Constructor.prototype.keydown.call(i[0],e),!1;if(this.leftMenu.btnAbout.pressed||($(e.target).parents("#left-menu").length||this.leftMenu.btnPlugins.pressed||this.leftMenu.btnComments.pressed)&&!0!==this.api.isCellEdited)return Common.UI.HintManager.isHintVisible()||(this.leftMenu.close(),Common.NotificationCenter.trigger("layout:changed","leftmenu")),!1;if(this.mode.isEditDiagram||this.mode.isEditMailMerge||this.mode.isEditOle){var s=(this.mode.isEditMailMerge||this.mode.isEditOle)&&this.getApplication().getController("Toolbar").toolbar.btnSearch,o=s&&s.pressed,i=$(document.body).find(".open > .dropdown-menu");if(!this.api.isCellEdited&&!i.length&&!o)return this.mode.isEditOle&&Common.NotificationCenter.trigger("oleedit:close"),Common.Gateway.internalMessage("shortcut",{key:"escape"}),!1;o&&s.toggle(!1)}break;case"chat":return this.mode.canCoAuthoring&&this.mode.canChat&&!this.mode.isLightVersion&&(Common.UI.Menu.Manager.hideAll(),this.leftMenu.showMenu("chat")),!1;case"comments":return this.mode.canCoAuthoring&&this.mode.canViewComments&&!this.mode.isLightVersion&&(Common.UI.Menu.Manager.hideAll(),this.leftMenu.showMenu("comments"),this.getApplication().getController("Common.Controllers.Comments").onAfterShow()),!1}}},onCellsRange:function(t){t=t!=Asc.c_oAscSelectionDialogType.None;this.leftMenu.btnAbout.setDisabled(t),this.leftMenu.btnSearchBar.setDisabled(t),this.leftMenu.btnSpellcheck.setDisabled(t),this.mode.canPlugins&&this.leftMenu.panelPlugins&&(Common.Utils.lockControls(Common.enumLock.selRangeEdit,t,{array:this.leftMenu.panelPlugins.lockedControls}),this.leftMenu.panelPlugins.setLocked(t))},onApiEditCell:function(t){t=t==Asc.c_oAscCellEditorState.editFormula;this.leftMenu.btnAbout.setDisabled(t),this.leftMenu.btnSearchBar.setDisabled(t),this.leftMenu.btnSpellcheck.setDisabled(t),this.mode.canPlugins&&this.leftMenu.panelPlugins&&(Common.Utils.lockControls(Common.enumLock.editFormula,t,{array:this.leftMenu.panelPlugins.lockedControls}),this.leftMenu.panelPlugins.setLocked(t))},onPluginOpen:function(t,e,i){"onboard"==e&&("open"==i?(this.tryToShowLeftMenu(),this.leftMenu.close(),this.leftMenu.panelPlugins.show(),this.leftMenu.onBtnMenuClick({pressed:!0,options:{action:"plugins"}}),this.leftMenu._state.pluginIsRunning=!0):(this.leftMenu._state.pluginIsRunning=!1,this.leftMenu.close()))},onShowHideChat:function(t){this.mode.canCoAuthoring&&this.mode.canChat&&!this.mode.isLightVersion&&(t?(Common.UI.Menu.Manager.hideAll(),this.tryToShowLeftMenu(),this.leftMenu.showMenu("chat")):(this.leftMenu.btnChat.toggle(!1,!0),this.leftMenu.onBtnMenuClick(this.leftMenu.btnChat)))},onShowHideSearch:function(t,e){t?(Common.UI.Menu.Manager.hideAll(),this.tryToShowLeftMenu(),this.leftMenu.showMenu("advancedsearch"),this.leftMenu.fireEvent("search:aftershow",[e])):(this.leftMenu.btnSearchBar.toggle(!1,!0),this.leftMenu.onBtnMenuClick(this.leftMenu.btnSearchBar))},onMenuSearchBar:function(t,e){e&&(e=this.mode.isEdit&&!this.viewmode?void 0:"no-replace",this.leftMenu.panelSearch.setSearchMode(e))},isSearchPanelVisible:function(){return this.leftMenu&&this.leftMenu.panelSearch&&this.leftMenu.panelSearch.isVisible()},onMenuChange:function(t){"hide"===t&&(this.leftMenu.btnComments.isActive()&&this.api?(this.leftMenu.btnComments.toggle(!1),this.leftMenu.onBtnMenuClick(this.leftMenu.btnComments),this.api.asc_enableKeyEvents(!0)):this.leftMenu.btnSearchBar.isActive()&&this.api?(this.leftMenu.btnSearchBar.toggle(!1),this.leftMenu.onBtnMenuClick(this.leftMenu.btnSearchBar)):this.leftMenu.btnSpellcheck.isActive()&&this.api&&(this.leftMenu.btnSpellcheck.toggle(!1),this.leftMenu.onBtnMenuClick(this.leftMenu.btnSpellcheck)))},showHistory:function(){var t;this.mode.wopi||((t=this.getApplication().getController("Main")).loadMask||(t.loadMask=new Common.UI.LoadMask({owner:$("#viewport")})),t.loadMask.setTitle(this.textLoadHistory),t.loadMask.show()),Common.Gateway.requestHistory()},isCommentsVisible:function(){return this.leftMenu&&this.leftMenu.panelComments&&this.leftMenu.panelComments.isVisible()},onLeftMenuHide:function(t,e){this.leftMenu&&(e||this.leftMenu.close(),e?this.leftMenu.show():this.leftMenu.hide(),Common.localStorage.setBool("sse-hidden-leftmenu",!e),t||this.leftMenu.fireEvent("view:hide",[this,!e])),Common.NotificationCenter.trigger("layout:changed","main"),Common.NotificationCenter.trigger("edit:complete",this.leftMenu)},tryToShowLeftMenu:function(){this.mode.canBrandingExt&&this.mode.customization&&!1===this.mode.customization.leftMenu||!Common.UI.LayoutManager.isElementVisible("leftMenu")||this.onLeftMenuHide(null,!0)},textNoTextFound:"Text not found",newDocumentTitle:"Unnamed document",textItemEntireCell:"Entire cell contents",requestEditRightsText:"Requesting editing rights...",warnDownloadAs:"If you continue saving in this format all features except the text will be lost.<br>Are you sure you want to continue?",textWarning:"Warning",textSheet:"Sheet",textWorkbook:"Workbook",textByColumns:"By columns",textByRows:"By rows",textFormulas:"Formulas",textValues:"Values",textWithin:"Within",textSearch:"Search",textLookin:"Look in",txtUntitled:"Untitled",textLoadHistory:"Loading version history...",leavePageText:"All unsaved changes in this document will be lost.<br> Click 'Cancel' then 'Save' to save them. Click 'OK' to discard all the unsaved changes.",warnDownloadCsvSheets:"The CSV format does not support saving a multi-sheet file.<br>To keep the selected format and save only the current sheet, press Save.<br>To save the current spreadsheet, click Cancel and save it in a different format.",textSave:"Save"},SSE.Controllers.LeftMenu||{}))}),define("spreadsheeteditor/main/app/view/Spellcheck",["common/main/lib/util/utils","common/main/lib/component/BaseView","common/main/lib/component/Layout","common/main/lib/component/Button","common/main/lib/component/ListView","common/main/lib/component/InputField","common/main/lib/component/ComboBox","common/main/lib/component/ComboDataView"],function(t){"use strict";SSE.Views.Spellcheck=Common.UI.BaseView.extend(_.extend({el:"#left-panel-spellcheck",template:_.template(['<div id="spellcheck-box" class="layout-ct active">','<div class="spellcheck-settings">','<div class="spellcheck-settings-inner">','<div style="display: flex; width: 100%; padding-bottom: 8px; padding-top: 16px;">','<div id="spellcheck-current-word"></div>','<div id="spellcheck-next" style=""></div>',"</div>",'<div id="spellcheck-suggestions-list"></div>','<div id="spellcheck-change" style=""></div>','<div id="spellcheck-ignore" class="padding-large margin-left-9"></div>','<button class="btn btn-text-default auto" id="spellcheck-add-to-dictionary" data-hint="1" data-hint-direction="bottom" data-hint-offset="big"><%= scope.txtAddToDictionary %></button>','<label class="header" style="display: block;"><%= scope.txtDictionaryLanguage %></label>','<div id="spellcheck-dictionary-language"></div>','<div id="spellcheck-complete" class="hidden">','<i class="btn-resolve margin-right-10"></i>',"<%= scope.txtComplete %>","</div>","</div>","</div>",'<div id="spellcheck-header">',"<label><%= scope.txtSpelling %></label>",'<div id="spellcheck-btn-close" class="float-right margin-left-4"></div>',"</div>","</div>"].join("")),initialize:function(t){_.extend(this,t),Common.UI.BaseView.prototype.initialize.call(this,arguments)},render:function(t){return t=t||this.el,this.$el=$(t),this.$el.html(this.template({scope:this})),this.buttonClose=new Common.UI.Button({parentEl:$("#spellcheck-btn-close",this.$el),cls:"btn-toolbar",iconCls:"toolbar__icon btn-close",hint:this.txtClosePanel,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.buttonClose.on("click",_.bind(this.onClickClosePanel,this)),this.currentWord=new Common.UI.InputField({el:$("#spellcheck-current-word"),allowBlank:!0,validateOnBlur:!1,disabled:!0,dataHint:"1",dataHintDirection:"left",dataHintOffset:"big"}),this.buttonNext=new Common.UI.Button({parentEl:$("#spellcheck-next"),cls:"btn-toolbar bg-white",iconCls:"toolbar__icon btn-nextitem",hint:this.txtNextTip,dataHint:"1",dataHintDirection:"bottom"}),this.suggestionList=new Common.UI.ListView({el:$("#spellcheck-suggestions-list"),emptyText:this.noSuggestions,store:new Common.UI.DataViewStore,scrollAlwaysVisible:!0,dataHint:"1",dataHintDirection:"left",dataHintOffset:"big"}),this.btnChange=new Common.UI.Button({parentEl:$("#spellcheck-change"),cls:"btn-text-split-default",caption:this.textChange,split:!0,width:110,disabled:!0,menu:new Common.UI.Menu({style:"min-width: 110px",items:[{caption:this.textChange,value:0},{caption:this.textChangeAll,value:1}]}),dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.btnIgnore=new Common.UI.Button({parentEl:$("#spellcheck-ignore"),cls:"btn-text-split-default",caption:this.textIgnore,split:!0,width:110,disabled:!0,menu:new Common.UI.Menu({style:"min-width: 110px;",items:[{caption:this.textIgnore,value:0},{caption:this.textIgnoreAll,value:1}]}),dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbDictionaryLanguage=new Common.UI.ComboBox({el:$("#spellcheck-dictionary-language"),style:"width: 100%",menuStyle:"width: 100%;max-height: 163px;",editable:!1,cls:"input-group-nr",scroller:{suppressScrollX:!0},search:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.btnToDictionary=new Common.UI.Button({el:$("#spellcheck-add-to-dictionary"),disabled:!0}),this.lblComplete=this.$el.find("#spellcheck-complete"),this.trigger("render:after",this),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:this.$el.find(".spellcheck-settings-inner"),suppressScrollX:!0,alwaysVisibleY:!0})),$(window).on("resize",_.bind(function(){this.scroller.update({alwaysVisibleY:!0})},this)),this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this.fireEvent("show",this)},hide:function(){Common.UI.BaseView.prototype.hide.call(this,arguments),this.fireEvent("hide",this)},ChangeSettings:function(t){},onClickClosePanel:function(){Common.NotificationCenter.trigger("leftmenu:change","hide")}},SSE.Views.Spellcheck||{}))}),define("spreadsheeteditor/main/app/controller/Spellcheck",["core","spreadsheeteditor/main/app/view/Spellcheck"],function(){"use strict";SSE.Controllers.Spellcheck=Backbone.Controller.extend(_.extend({models:[],collections:[],views:["Spellcheck"],initialize:function(){var t=this;this.addListeners({Spellcheck:{show:function(){t._initSettings&&t.loadLanguages(),t.updateLanguages(),t.onClickNext()},hide:function(){t.api&&t.api.asc_cancelSpellCheck()}},LeftMenu:{"spellcheck:update":function(){t.updateLanguages()}}})},events:function(){},onLaunch:function(){this.panelSpellcheck=this.createView("Spellcheck",{}),this.panelSpellcheck.on("render:after",_.bind(this.onAfterRender,this)),this._isDisabled=!1,this._initSettings=!0},setApi:function(t){return this.api=t,this.api.asc_registerCallback("asc_onSpellCheckVariantsFound",_.bind(this.onSpellCheckVariantsFound,this)),this.api.asc_registerCallback("asc_onEditCell",_.bind(this.onApiEditCell,this)),this},setMode:function(t){return this.mode=t,this.panelSpellcheck&&this.panelSpellcheck.btnToDictionary.setVisible(t.isDesktopApp),this},onAfterRender:function(t){t.buttonNext.on("click",_.bind(this.onClickNext,this)),t.btnToDictionary.on("click",_.bind(this.onDictionary,this)),t.cmbDictionaryLanguage.on("selected",_.bind(this.onSelectLanguage,this)),t.btnChange.on("click",_.bind(this.onClickChange,this)),t.btnIgnore.on("click",_.bind(this.onClickIgnore,this)),t.btnChange.menu.on("item:click",_.bind(this.onClickChangeMenu,this)),t.btnIgnore.menu.on("item:click",_.bind(this.onClickIgnoreMenu,this))},onClickNext:function(){this.api&&this.api.asc_nextWord(),Common.NotificationCenter.trigger("edit:complete",this,{restorefocus:!0})},onDictionary:function(){var t;this.api&&(t=this.panelSpellcheck.currentWord.getValue())&&this.api.asc_spellCheckAddToDictionary(t)},SetDisabled:function(t){this._isDisabled=t},setLanguages:function(t){this.languages=t,this._initSettings=!0,this.panelSpellcheck.cmbDictionaryLanguage&&0<this.panelSpellcheck.cmbDictionaryLanguage.store.length&&this.panelSpellcheck.cmbDictionaryLanguage.store.reset()},loadLanguages:function(){var e,i,s=this,t=(this._initSettings&&Common.Utils.InternalSettings.set("sse-spellcheck-locale",Common.localStorage.getItem("sse-spellcheck-locale")),this.languages&&0<this.languages.length?(e=[],this.allLangs=Common.util.LanguageInfo.getLanguages(),this.languages.forEach(function(t){t=parseInt(t),s.allLangs.hasOwnProperty(t)&&(i=s.allLangs[t],e.push({displayValue:i[1],shortName:i[0],value:t}))}),e.sort(function(t,e){return t.shortName<e.shortName?-1:t.shortName>e.shortName?1:0}),this.langs=e):this.langs=void 0,this._initSettings=!1,0===this.panelSpellcheck.cmbDictionaryLanguage.store.length);return[this.allLangs,this.langs,t]},updateLanguages:function(){var t,e=Common.Utils.InternalSettings.get("sse-spellcheck-locale"),i=!1,s=e?parseInt(e):this.mode.lang?parseInt(Common.util.LanguageInfo.getLocalLanguageCode(this.mode.lang)):1033,o=this.panelSpellcheck.cmbDictionaryLanguage;this.langs&&0<this.langs.length?(0===o.store.length&&(o.setData(this.langs),i=!0),!(t=o.store.findWhere({value:s}))&&this.allLangs[s]&&(s=this.allLangs[s][0].split(/[\-\_]/)[0],t=o.store.find(function(t){return 0==t.get("shortName").indexOf(s)})),o.setValue(t?t.get("value"):this.langs[0].value),s=o.getValue()):(o.setValue(Common.util.LanguageInfo.getLocalLanguageName(s)[1]),o.setDisabled(!0)),i&&this.api&&(this.api.asc_setDefaultLanguage(s),s!==parseInt(e)&&Common.Utils.InternalSettings.set("sse-spellcheck-locale",s))},onSelectLanguage:function(t,e){var e=e.value;this.api&&e&&(this.api.asc_setDefaultLanguage(e),e=this.panelSpellcheck.cmbDictionaryLanguage.getValue(),Common.localStorage.setItem("sse-spellcheck-locale",e),Common.Utils.InternalSettings.set("sse-spellcheck-locale",e)),Common.NotificationCenter.trigger("edit:complete",this,{restorefocus:!0})},onClickChange:function(t,e){var i;this.api&&(i=this.panelSpellcheck.suggestionList.getSelectedRec())&&this.api.asc_replaceMisspelledWord(i.get("value"),this._currentSpellObj),Common.NotificationCenter.trigger("edit:complete",this,{restorefocus:!0})},onClickChangeMenu:function(t,e){var i;this.api&&(i=this.panelSpellcheck.suggestionList.getSelectedRec(),0==e.value?i&&this.api.asc_replaceMisspelledWord(i.get("value"),this._currentSpellObj):1==e.value&&i&&this.api.asc_replaceMisspelledWord(i.get("value"),this._currentSpellObj,!0)),Common.NotificationCenter.trigger("edit:complete",this,{restorefocus:!0})},onClickIgnore:function(){this.api&&this.api.asc_ignoreMisspelledWord(this._currentSpellObj,!1),Common.NotificationCenter.trigger("edit:complete",this,{restorefocus:!0})},onClickIgnoreMenu:function(t,e){this.api&&(0==e.value?this.api.asc_ignoreMisspelledWord(this._currentSpellObj,!1):1==e.value&&this.api.asc_ignoreMisspelledWord(this._currentSpellObj,!0)),Common.NotificationCenter.trigger("edit:complete",this,{restorefocus:!0})},onSpellCheckVariantsFound:function(t){var i,e,s;(null!==t||this._currentSpellObj!==t||this.panelSpellcheck&&this.panelSpellcheck.isVisible())&&(this._currentSpellObj=t,i=[],t&&(e=t.get_Word(),(s=t.get_Variants())&&s.forEach(function(t){var e=new Common.UI.DataViewModel;e.set({value:t}),i.push(e)})),s=this.api.isCellEdited,this.panelSpellcheck.currentWord.setValue(e||""),this.panelSpellcheck.suggestionList.store.reset(i),0<i.length&&this.panelSpellcheck.suggestionList.selectByIndex(0),this.panelSpellcheck.currentWord.setDisabled(!e||s),this.panelSpellcheck.btnChange.setDisabled(i.length<1||s),this.panelSpellcheck.btnIgnore.setDisabled(!e||s),this.panelSpellcheck.btnToDictionary.setDisabled(!e||s),this.panelSpellcheck.lblComplete.toggleClass("hidden",!t||!!e),this.panelSpellcheck.buttonNext.setDisabled(!this.panelSpellcheck.lblComplete.hasClass("hidden")))},onApiEditCell:function(t){t==Asc.c_oAscCellEditorState.editEnd?(this.panelSpellcheck.buttonNext.setDisabled(!this.panelSpellcheck.lblComplete.hasClass("hidden")),this.panelSpellcheck.cmbDictionaryLanguage.setDisabled(!(this.languages&&0<this.languages.length))):(this.panelSpellcheck.buttonNext.setDisabled(!0),this.panelSpellcheck.currentWord.setDisabled(!0),this.panelSpellcheck.btnChange.setDisabled(!0),this.panelSpellcheck.btnIgnore.setDisabled(!0),this.panelSpellcheck.btnToDictionary.setDisabled(!0),this.panelSpellcheck.cmbDictionaryLanguage.setDisabled(!0))}},SSE.Controllers.Spellcheck||{}))}),void 0===Common&&(Common={}),Common.IrregularStack=function(t){function e(t,e){return"object"==typeof t&&"object"==typeof e&&window.JSON?window.JSON.stringify(t)===window.JSON.stringify(e):t===e}function i(t,e){for(var i=s.length-1;0<=i;i--)if(e(s[i],t))return i;return-1}var s=[],o=(t=t||{}).strongCompare||e,n=t.weakCompare||e;return{push:function(t){s.push(t)},pop:function(t){t=i(t,o);if(-1!=t)return s.splice(t,1)[0]},get:function(t){t="object"==typeof t?i(t,n):t;if(-1!=t)return s[t]},exist:function(t){return!(i(t,o)<0)},length:function(){return s.length}}},define("irregularstack",function(){}),void 0===Common&&(Common={}),Common.Controllers=Common.Controllers||{},define("common/main/lib/controller/Fonts",["core","common/main/lib/collection/Fonts"],function(){"use strict";function t(t,e){if(t.showlastused)for(var i,s=t.store,t=e,o=t.get("type")==r,n=-1,a=s.length,l=t.get("name");!o&&++n<a&&(i=s.at(n)).get("type")==r;)o=i.get("name")==l}function e(t){Common.NotificationCenter.trigger("fonts:change",t)}function i(t,e){var i=[];_.each(t,function(t){var e=t.asc_getFontId();i.push({id:_.isEmpty(e)?Common.UI.getId():e,name:t.asc_getFontName(),imgidx:t.asc_getFontThumbnail(),type:t.asc_getFontType()})});const s=window.__fonts_sort;i.sort((t,e)=>s.indexOf(t.name)-s.indexOf(e.name));t=this.getCollection("Common.Collections.Fonts");t&&t.add(i),Common.NotificationCenter.trigger("fonts:load",t,e)}var r;Common.Controllers.Fonts=Backbone.Controller.extend((r=4,{models:["Common.Models.Fonts"],collections:["Common.Collections.Fonts"],views:[],initialize:function(){Common.NotificationCenter.on("fonts:select",_.bind(t,this))},onLaunch:function(){},setApi:function(t){this.api=t,this.api.asc_registerCallback("asc_onInitEditorFonts",_.bind(i,this)),this.api.asc_registerCallback("asc_onFontFamily",_.bind(e,this))}}))}),void 0===Common&&(Common={}),Common.Collections=Common.Collections||{},define("common/main/lib/collection/TextArt",["backbone"],function(t){"use strict";Common.Collections.TextArt=t.Collection.extend({model:t.Model.extend({defaults:function(){return{id:Common.UI.getId(),imageUrl:null,data:null}}})})}),define("common/main/lib/view/UserNameDialog",["common/main/lib/component/Window","common/main/lib/component/InputField"],function(){"use strict";Common.Views.UserNameDialog=Common.UI.Window.extend(_.extend({options:{width:330,header:!1,modal:!1,cls:"modal-dlg",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,t||{}),this.template=['<div class="box">','<div style="margin-bottom: 2px;">'+(this.options.label||this.textLabel)+"</div>",'<div id="id-dlg-username-caption" class="input-row"></div>','<div id="id-dlg-username-chk-use" class="" style="margin-top: 10px;"></div>',"</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);this.inputLabel=new Common.UI.InputField({el:$("#id-dlg-username-caption"),allowBlank:!0,style:"width: 100%;",maxLength:128,validateOnBlur:!1,validation:this.options.validation||function(t){return!!t||""}}),this.inputLabel.setValue(this.options.value||""),this.chDontShow=new Common.UI.CheckBox({el:$("#id-dlg-username-chk-use"),labelText:this.textDontShow,value:this.options.check}),this.getChild().find(".dlg-btn").on("click",_.bind(this.onBtnClick,this))},show:function(){Common.UI.Window.prototype.show.apply(this,arguments);var t=this;_.delay(function(){t.getChild("input").focus()},50)},onPrimary:function(t){return this._handleInput("ok"),!1},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},_handleInput:function(t){if(this.options.handler){if("ok"==t&&!0!==this.inputLabel.checkValidate())return void this.inputLabel.cmpEl.find("input").focus();this.options.handler.call(this,t,{input:this.inputLabel.getValue(),checkbox:"checked"==this.chDontShow.getValue()})}this.close()}},Common.Views.UserNameDialog||{}))}),void 0===window.Common&&(window.Common={}),Common.util=Common.util||{},Common.util.LanguageInfo=new function(){var i={54:["af","Afrikaans"],1078:["af-ZA","Afrikaans (Suid Afrika)","Afrikaans (South Africa)"],28:["sq","Shqipe"],1052:["sq-AL","Shqipe (Shqipëria)","Albanian (Albania)"],132:["gsw","Elsässisch"],1156:["gsw-FR","Elsässisch (Frànkrisch)","Alsatian (France)"],94:["am","አማርኛ"],1118:["am-ET","አማርኛ (ኢትዮጵያ)","Amharic (Ethiopia)"],1:["ar","العربية‏"],5121:["ar-DZ","العربية (الجزائر)‏","Arabic (Algeria)"],15361:["ar-BH","العربية (البحرين)‏","Arabic (Bahrain)"],3073:["ar-EG","العربية (مصر)‏","Arabic (Egypt)"],2049:["ar-IQ","العربية (العراق)‏","Arabic (Iraq)"],11265:["ar-JO","العربية (الأردن)‏","Arabic (Jordan)"],13313:["ar-KW","العربية (الكويت)‏","Arabic (Kuwait)"],12289:["ar-LB","العربية (لبنان)‏","Arabic (Lebanon)"],4097:["ar-LY","العربية (ليبيا)‏","Arabic (Libya)"],6145:["ar-MA","العربية (المملكة المغربية)‏","Arabic (Morocco)"],8193:["ar-OM","العربية (عمان)‏","Arabic (Oman)"],16385:["ar-QA","العربية (قطر)‏","Arabic (Qatar)"],1025:["ar-SA","العربية (المملكة العربية السعودية)‏","Arabic (Saudi Arabia)"],10241:["ar-SY","العربية (سوريا)‏","Arabic (Syria)"],7169:["ar-TN","العربية (تونس)‏","Arabic (Tunisia)"],14337:["ar-AE","العربية (الإمارات العربية المتحدة)‏","Arabic (U.A.E.)"],9217:["ar-YE","العربية (اليمن)‏","Arabic (Yemen)"],43:["hy","Հայերեն"],1067:["hy-AM","Հայերեն (Հայաստան)","Armenian (Armenia)"],77:["as","অসমীয়া"],1101:["as-IN","অসমীয়া (ভাৰত)","Assamese (India)"],44:["az","Azərbaycan­ılı"],29740:["az-Cyrl","Азәрбајҹан дили"],2092:["az-Cyrl-AZ","Азәрбајҹан (Азәрбајҹан)","Azeri (Cyrillic, Azerbaijan)"],30764:["az-Latn","Azərbaycan­ılı"],1068:["az-Latn-AZ","Azərbaycan­ılı (Azərbaycan)","Azeri (Latin, Azerbaijan)"],109:["ba","Башҡорт"],1133:["ba-RU","Башҡорт (Россия)","Bashkir (Russia)"],45:["eu","Euskara"],1069:["eu-ES","Euskara (Euskara)","Basque (Basque)"],35:["be","Беларускі"],1059:["be-BY","Беларускі (Беларусь)","Belarusian (Belarus)"],69:["bn","বাংলা"],2117:["bn-BD","বাংলা (বাংলাদেশ)","Bengali (Bangladesh)"],1093:["bn-IN","বাংলা (ভারত)","Bengali (India)"],30746:["bs","bosanski"],25626:["bs-Cyrl","Босански (Ћирилица)"],8218:["bs-Cyrl-BA","Босански (Босна и Херцеговина)","Bosnian (Cyrillic) (Bosnia and Herzegovina)"],26650:["bs-Latn","Bosanski (Latinica)"],5146:["bs-Latn-BA","Bosanski (Bosna i Hercegovina)","Bosnian (Latin) (Bosnia and Herzegovina)"],126:["br","Brezhoneg"],1150:["br-FR","Brezhoneg (Frañs)","Breton (France)"],2:["bg","Български"],1026:["bg-BG","Български (България)","Bulgarian (Bulgaria)"],3:["ca","Català"],1027:["ca-ES","Català (Català)","Catalan (Catalan)"],2051:["ca-ES-valencia","Català (Valencià)","Catalan (Valencia)"],30724:["zh","中文"],4:["zh-Hans","中文(简体)","Chinese (Simplified)"],2052:["zh-CN","中文(中华人民共和国)","Chinese (People's Republic of China)"],4100:["zh-SG","中文(新加坡)","Chinese (Simplified, Singapore)"],31748:["zh-Hant","中文(繁體)","Chinese (Traditional)"],3076:["zh-HK","中文(香港特別行政區)","Chinese (Traditional, Hong Kong S.A.R.)"],5124:["zh-MO","中文(澳門特別行政區)","Chinese (Traditional, Macao S.A.R.)"],1028:["zh-TW","中文(台灣)","Chinese (Traditional, Taiwan)"],131:["co","Corsu"],1155:["co-FR","Corsu (France)","Corsican (France)"],26:["hr","Hrvatski"],1050:["hr-HR","Hrvatski (Hrvatska)","Croatian (Croatia)"],4122:["hr-BA","Hrvatski (Bosna i Hercegovina)","Croatian (Bosnia and Herzegovina)"],5:["cs","Čeština"],1029:["cs-CZ","Čeština (Česká republika)","Czech (Czech Republic)"],6:["da","Dansk"],1030:["da-DK","Dansk (Danmark)","Danish (Denmark)"],140:["prs","درى‏"],1164:["prs-AF","درى (افغانستان)‏","Dari (Afghanistan)"],101:["dv","ދިވެހިބަސް‏"],1125:["dv-MV","ދިވެހިބަސް (ދިވެހި ރާއްޖެ)‏","Divehi (Maldives)"],19:["nl","Nederlands"],2067:["nl-BE","Nederlands (België)","Dutch (Belgium)"],1043:["nl-NL","Nederlands (Nederland)","Dutch (Netherlands)"],9:["en","English"],3081:["en-AU","English (Australia)","English (Australia)"],10249:["en-BZ","English (Belize)","English (Belize)"],4105:["en-CA","English (Canada)","English (Canada)"],9225:["en-029","English (Caribbean)","English (Caribbean)"],16393:["en-IN","English (India)","English (India)"],6153:["en-IE","English (Ireland)","English (Ireland)"],8201:["en-JM","English (Jamaica)","English (Jamaica)"],17417:["en-MY","English (Malaysia)","English (Malaysia)"],5129:["en-NZ","English (New Zealand)","English (New Zealand)"],13321:["en-PH","English (Philippines)","English (Philippines)"],18441:["en-SG","English (Singapore)","English (Singapore)"],7177:["en-ZA","English (South Africa)","English (South Africa)"],11273:["en-TT","English (Trinidad y Tobago)","English (Trinidad y Tobago)"],2057:["en-GB","English (United Kingdom)","English (United Kingdom)"],1033:["en-US","English (United States)","English (United States)"],12297:["en-ZW","English (Zimbabwe)","English (Zimbabwe)"],15369:["en-HK","English (Hong Kong)","English (Hong Kong)"],14345:["en-ID","English (Indonesia)","English (Indonesia)"],37:["et","Eesti"],1061:["et-EE","Eesti (Eesti)","Estonian (Estonia)"],56:["fo","Føroyskt"],1080:["fo-FO","Føroyskt (Føroyar)","Faroese (Faroe Islands)"],100:["fil","Filipino"],1124:["fil-PH","Filipino (Pilipinas)","Filipino (Philippines)"],11:["fi","Suomi"],1035:["fi-FI","Suomi (Suomi)","Finnish (Finland)"],12:["fr","Français"],2060:["fr-BE","Français (Belgique)","French (Belgium)"],3084:["fr-CA","Français (Canada)","French (Canada)"],1036:["fr-FR","Français (France)","French (France)"],5132:["fr-LU","Français (Luxembourg)","French (Luxembourg)"],6156:["fr-MC","Français (Principauté de Monaco)","French (Principality of Monaco)"],4108:["fr-CH","Français (Suisse)","French (Switzerland)"],15372:["fr-HT","Français (Haïti)","French (Haiti)"],9228:["fr-CG","Français (Congo-Brazzaville)","French (Congo)"],12300:["fr-CI","Français (Côte d’Ivoire)","French (Cote d'Ivoire)"],11276:["fr-CM","Français (Cameroun)","French (Cameroon)"],14348:["fr-MA","Français (Maroc)","French (Morocco)"],13324:["fr-ML","Français (Mali)","French (Mali)"],8204:["fr-RE","Français (La Réunion)","French (Reunion)"],10252:["fr-SN","Français (Sénégal)","French (Senegal)"],7180:["fr-West","French"],98:["fy","Frysk"],1122:["fy-NL","Frysk (Nederlân)","Frisian (Netherlands)"],86:["gl","Galego"],1110:["gl-ES","Galego (Galego)","Galician (Galician)"],55:["ka","ქართული"],1079:["ka-GE","ქართული (საქართველო)","Georgian (Georgia)"],7:["de","Deutsch"],3079:["de-AT","Deutsch (Österreich)","German (Austria)"],1031:["de-DE","Deutsch (Deutschland)","German (Germany)"],5127:["de-LI","Deutsch (Liechtenstein)","German (Liechtenstein)"],4103:["de-LU","Deutsch (Luxemburg)","German (Luxembourg)"],2055:["de-CH","Deutsch (Schweiz)","German (Switzerland)"],8:["el","Ελληνικά"],1032:["el-GR","Ελληνικά (Ελλάδα)","Greek (Greece)"],111:["kl","Kalaallisut"],1135:["kl-GL","Kalaallisut (Kalaallit Nunaat)","Greenlandic (Greenland)"],71:["gu","ગુજરાતી"],1095:["gu-IN","ગુજરાતી (ભારત)","Gujarati (India)"],104:["ha","Hausa"],31848:["ha-Latn","Hausa (Latin)"],1128:["ha-Latn-NG","Hausa (Nigeria)","Hausa (Latin) (Nigeria)"],13:["he","עברית‏"],1037:["he-IL","עברית (ישראל)‏","Hebrew (Israel)"],57:["hi","हिंदी"],1081:["hi-IN","हिंदी (भारत)","Hindi (India)"],14:["hu","Magyar"],1038:["hu-HU","Magyar (Magyarország)","Hungarian (Hungary)"],15:["is","Íslenska"],1039:["is-IS","Íslenska (Ísland)","Icelandic (Iceland)"],112:["ig","Igbo"],1136:["ig-NG","Igbo (Nigeria)","Igbo (Nigeria)"],33:["id","Bahasa Indonesia"],1057:["id-ID","Bahasa Indonesia (Indonesia)","Indonesian (Indonesia)"],93:["iu","Inuktitut"],31837:["iu-Latn","Inuktitut (Qaliujaaqpait)"],2141:["iu-Latn-CA","Inuktitut (Kanatami) (kanata)","Inuktitut (Latin) (Canada)"],30813:["iu-Cans","ᐃᓄᒃᑎᑐᑦ (ᖃᓂᐅᔮᖅᐸᐃᑦ)"],1117:["iu-Cans-CA","ᐃᓄᒃᑎᑐᑦ (ᑲᓇᑕᒥ)","Inuktitut (Canada)"],60:["ga","Gaeilge"],2108:["ga-IE","Gaeilge (Éire)","Irish (Ireland)"],52:["xh","isiXhosa"],1076:["xh-ZA","isiXhosa (uMzantsi Afrika)","isiXhosa (South Africa)"],53:["zu","isiZulu"],1077:["zu-ZA","isiZulu (iNingizimu Afrika)","isiZulu (South Africa)"],16:["it","Italiano"],1040:["it-IT","Italiano (Italia)","Italian (Italy)"],2064:["it-CH","Italiano (Svizzera)","Italian (Switzerland)"],17:["ja","日本語"],1041:["ja-JP","日本語 (日本)","Japanese (Japan)"],75:["kn","ಕನ್ನಡ"],1099:["kn-IN","ಕನ್ನಡ (ಭಾರತ)","Kannada (India)"],63:["kk","Қазақ"],1087:["kk-KZ","Қазақ (Қазақстан)","Kazakh (Kazakhstan)"],83:["km","ខ្មែរ"],1107:["km-KH","ខ្មែរ (កម្ពុជា)","Khmer (Cambodia)"],134:["qut","K'iche"],1158:["qut-GT","K'iche (Guatemala)","K'iche (Guatemala)"],135:["rw","Kinyarwanda"],1159:["rw-RW","Kinyarwanda (Rwanda)","Kinyarwanda (Rwanda)"],65:["sw","Kiswahili"],1089:["sw-KE","Kiswahili (Kenya)","Kiswahili (Kenya)"],87:["kok","कोंकणी"],1111:["kok-IN","कोंकणी (भारत)","Konkani (India)"],18:["ko","한국어"],1042:["ko-KR","한국어 (대한민국)","Korean (Korea)"],64:["ky","Кыргыз"],1088:["ky-KG","Кыргыз (Кыргызстан)","Kyrgyz (Kyrgyzstan)"],84:["lo","ລາວ"],1108:["lo-LA","ລາວ (ສ.ປ.ປ. ລາວ)","Lao (Lao P.D.R.)"],38:["lv","Latviešu"],1062:["lv-LV","Latviešu (Latvija)","Latvian (Latvia)"],39:["lt","Lietuvių"],1063:["lt-LT","Lietuvių (Lietuva)","Lithuanian (Lithuania)"],31790:["dsb","Dolnoserbšćina"],2094:["dsb-DE","Dolnoserbšćina (Nimska)","Lower Sorbian (Germany)"],110:["lb","Lëtzebuergesch"],1134:["lb-LU","Lëtzebuergesch (Luxembourg)","Luxembourgish (Luxembourg)"],1071:["mk-MK","Македонски јазик (Македонија)","Macedonian (Former Yugoslav Republic of Macedonia)"],47:["mk","Македонски јазик"],62:["ms","Bahasa Melayu"],2110:["ms-BN","Bahasa Melayu (Brunei Darussalam)","Malay (Brunei Darussalam)"],1086:["ms-MY","Bahasa Melayu (Malaysia)","Malay (Malaysia)"],76:["ml","മലയാളം"],1100:["ml-IN","മലയാളം (ഭാരതം)","Malayalam (India)"],58:["mt","Malti"],1082:["mt-MT","Malti (Malta)","Maltese (Malta)"],129:["mi","Reo Māori"],1153:["mi-NZ","Reo Māori (Aotearoa)","Maori (New Zealand)"],122:["arn","Mapudungun"],1146:["arn-CL","Mapudungun (Chile)","Mapudungun (Chile)"],78:["mr","मराठी"],1102:["mr-IN","मराठी (भारत)","Marathi (India)"],124:["moh","Kanien'kéha"],1148:["moh-CA","Kanien'kéha (Canada)","Mohawk (Canada)"],80:["mn","Монгол хэл"],30800:["mn-Cyrl","Монгол хэл"],1104:["mn-MN","Монгол хэл (Монгол улс)","Mongolian (Cyrillic, Mongolia)"],31824:["mn-Mong","ᠮᠤᠨᠭᠭᠤᠯ ᠬᠡᠯᠡ"],2128:["mn-Mong-CN","ᠮᠤᠨᠭᠭᠤᠯ ᠬᠡᠯᠡ (ᠪᠦᠭᠦᠳᠡ ᠨᠠᠢᠷᠠᠮᠳᠠᠬᠤ ᠳᠤᠮᠳᠠᠳᠤ ᠠᠷᠠᠳ ᠣᠯᠣᠰ)","Mongolian (Traditional Mongolian) (People's Republic of China)"],97:["ne","नेपाली"],1121:["ne-NP","नेपाली (नेपाल)","Nepali (Nepal)"],2145:["ne-IN","नेपाली (भारत)","Nepali (India)"],20:["no","Norsk"],31764:["nb","Norsk (bokmål)"],1044:["nb-NO","Norsk, bokmål (Norge)","Norwegian, Bokmål (Norway)"],30740:["nn","Norsk (Nynorsk)"],2068:["nn-NO","Norsk, nynorsk (Noreg)","Norwegian, Nynorsk (Norway)"],130:["oc","Occitan"],1154:["oc-FR","Occitan (França)","Occitan (France)"],72:["or","ଓଡ଼ିଆ"],1096:["or-IN","ଓଡ଼ିଆ (ଭାରତ)","Oriya (India)"],99:["ps","پښتو‏"],1123:["ps-AF","پښتو (افغانستان)‏","Pashto (Afghanistan)"],41:["fa","فارسى‏"],1065:["fa-IR","فارسى (ایران)‏","Persian (Iran)"],21:["pl","Polski"],1045:["pl-PL","Polski (Polska)","Polish (Poland)"],22:["pt","Português"],1046:["pt-BR","Português (Brasil)","Portuguese (Brazil)"],2070:["pt-PT","Português (Portugal)","Portuguese (Portugal)"],70:["pa","ਪੰਜਾਬੀ"],1094:["pa-IN","ਪੰਜਾਬੀ (ਭਾਰਤ)","Punjabi (India)"],107:["quz","Runasimi"],1131:["quz-BO","Runasimi (Qullasuyu)","Quechua (Bolivia)"],2155:["quz-EC","Runasimi (Ecuador)","Quechua (Ecuador)"],3179:["quz-PE","Runasimi (Piruw)","Quechua (Peru)"],24:["ro","Română"],1048:["ro-RO","Română (România)","Romanian (Romania)"],2072:["ro-MD","Română (Moldova)","Romanian (Republic of Moldova)"],23:["rm","Rumantsch"],1047:["rm-CH","Rumantsch (Svizra)","Romansh (Switzerland)"],25:["ru","Русский"],1049:["ru-RU","Русский (Россия)","Russian (Russia)"],2073:["ru-MD","Русский (Молдавия)","Russian (Republic of Moldova)"],28731:["smn","Sämikielâ"],9275:["smn-FI","Sämikielâ (Suomâ)","Sami (Inari) (Finland)"],31803:["smj","Julevusámegiella"],4155:["smj-NO","Julevusámegiella (Vuodna)","Sami (Lule) (Norway)"],5179:["smj-SE","Julevusámegiella (Svierik)","Sami (Lule) (Sweden)"],59:["se","Davvisámegiella"],3131:["se-FI","Davvisámegiella (Suopma)","Sami (Northern) (Finland)"],1083:["se-NO","Davvisámegiella (Norga)","Sami (Northern) (Norway)"],2107:["se-SE","Davvisámegiella (Ruoŧŧa)","Sami (Northern) (Sweden)"],29755:["sms","Sääm´ǩiõll"],8251:["sms-FI","Sääm´ǩiõll (Lää´ddjânnam)","Sami (Skolt) (Finland)"],30779:["sma","åarjelsaemiengiele"],6203:["sma-NO","åarjelsaemiengiele (Nöörje)","Sami (Southern) (Norway)"],7227:["sma-SE","åarjelsaemiengiele (Sveerje)","Sami (Southern) (Sweden)"],79:["sa","संस्कृत"],1103:["sa-IN","संस्कृत (भारतम्)","Sanskrit (India)"],145:["gd","Gàidhlig"],1169:["gd-GB","Gàidhlig (An Rìoghachd Aonaichte)","Scottish Gaelic (United Kingdom)"],31770:["sr","Srpski"],27674:["sr-Cyrl","Српски (Ћирилица)"],7194:["sr-Cyrl-BA","Српски (Босна и Херцеговина)","Serbian (Cyrillic) (Bosnia and Herzegovina)"],12314:["sr-Cyrl-ME","Српски (Црна Гора)","Serbian (Cyrillic, Montenegro)"],3098:["sr-Cyrl-CS","Српски (Србија и Црна Гора (Претходно))","Serbian (Cyrillic, Serbia and Montenegro (Former))"],10266:["sr-Cyrl-RS","Српски (Србија)","Serbian (Cyrillic, Serbia)"],28698:["sr-Latn","Srpski (Latinica)"],6170:["sr-Latn-BA","Srpski (Bosna i Hercegovina)","Serbian (Latin, Bosnia and Herzegovina)"],11290:["sr-Latn-ME","Srpski (Crna Gora)","Serbian (Latin, Montenegro)"],2074:["sr-Latn-CS","Srpski (Srbija i Crna Gora (Prethodno))","Serbian (Latin, Serbia and Montenegro (Former))"],9242:["sr-Latn-RS","Srpski (Srbija, Latinica)","Serbian (Latin, Serbia)"],108:["nso","Sesotho sa Leboa"],1132:["nso-ZA","Sesotho sa Leboa (Afrika Borwa)","Sesotho sa Leboa (South Africa)"],50:["tn","Setswana"],1074:["tn-ZA","Setswana (Aforika Borwa)","Setswana (South Africa)"],91:["si","සිංහ"],1115:["si-LK","සිංහල (ශ්‍රී ලංකාව)","Sinhala (Sri Lanka)"],27:["sk","Slovenčina"],1051:["sk-SK","Slovenčina (Slovenská republika)","Slovak (Slovakia)"],36:["sl","Slovenski"],1060:["sl-SI","Slovenski (Slovenija)","Slovenian (Slovenia)"],10:["es","Español"],11274:["es-AR","Español (Argentina)","Spanish (Argentina)"],16394:["es-BO","Español (Bolivia)","Spanish (Bolivia)"],13322:["es-CL","Español (Chile)","Spanish (Chile)"],9226:["es-CO","Español (Colombia)","Spanish (Colombia)"],5130:["es-CR","Español (Costa Rica)","Spanish (Costa Rica)"],7178:["es-DO","Español (República Dominicana)","Spanish (Dominican Republic)"],12298:["es-EC","Español (Ecuador)","Spanish (Ecuador)"],17418:["es-SV","Español (El Salvador)","Spanish (El Salvador)"],4106:["es-GT","Español (Guatemala)","Spanish (Guatemala)"],18442:["es-HN","Español (Honduras)","Spanish (Honduras)"],2058:["es-MX","Español (México)","Spanish (Mexico)"],19466:["es-NI","Español (Nicaragua)","Spanish (Nicaragua)"],6154:["es-PA","Español (Panamá)","Spanish (Panama)"],15370:["es-PY","Español (Paraguay)","Spanish (Paraguay)"],10250:["es-PE","Español (Perú)","Spanish (Peru)"],20490:["es-PR","Español (Puerto Rico)","Spanish (Puerto Rico)"],3082:["es-ES","Español (España, alfabetización internacional)","Spanish (Spain)"],21514:["es-US","Español (Estados Unidos)","Spanish (United States)"],14346:["es-UY","Español (Uruguay)","Spanish (Uruguay)"],8202:["es-VE","Español (Republica Bolivariana de Venezuela)","Spanish (Venezuela)"],1034:["es-ES_tradnl","Spanish"],22538:["es-419","Español (América Latina y el Caribe)","Spanish (Latin America and the Caribbean)"],23562:["es-CU","Español (Cuba)","Spanish (Cuba)"],29:["sv","Svenska"],2077:["sv-FI","Svenska (Finland)","Swedish (Finland)"],1053:["sv-SE","Svenska (Sverige)","Swedish (Sweden)"],90:["syr","ܣܘܪܝܝܐ‏"],1114:["syr-SY","ܣܘܪܝܝܐ (سوريا)‏","Syriac (Syria)"],40:["tg","Тоҷикӣ"],31784:["tg-Cyrl","Тоҷикӣ"],1064:["tg-Cyrl-TJ","Тоҷикӣ (Тоҷикистон)","Tajik (Cyrillic) (Tajikistan)"],95:["tzm","Tamazight"],31839:["tzm-Latn","Tamazight (Latin)"],2143:["tzm-Latn-DZ","Tamazight (Djazaïr)","Tamazight (Latin) (Algeria)"],73:["ta","தமிழ்"],1097:["ta-IN","தமிழ் (இந்தியா)","Tamil (India)"],68:["tt","Татар"],1092:["tt-RU","Татар (Россия)","Tatar (Russia)"],74:["te","తెలుగు"],1098:["te-IN","తెలుగు (భారత దేశం)","Telugu (India)"],30:["th","ไทย"],1054:["th-TH","ไทย (ไทย)","Thai (Thailand)"],81:["bo","བོད་ཡིག"],1105:["bo-CN","བོད་ཡིག (ཀྲུང་ཧྭ་མི་དམངས་སྤྱི་མཐུན་རྒྱལ་ཁབ།)","Tibetan (People's Republic of China)"],2129:["bo-BT","Tibetan (Bhutan)","Tibetan (Bhutan)"],31:["tr","Türkçe"],1055:["tr-TR","Türkçe (Türkiye)","Turkish (Turkey)"],66:["tk","Türkmençe"],1090:["tk-TM","Türkmençe (Türkmenistan)","Turkmen (Turkmenistan)"],34:["uk","Українська"],1058:["uk-UA","Українська (Україна)","Ukrainian (Ukraine)"],46:["hsb","Hornjoserbšćina"],1070:["hsb-DE","Hornjoserbšćina (Němska)","Upper Sorbian (Germany)"],32:["ur","اُردو‏"],1056:["ur-PK","اُردو (پاکستان)‏","Urdu (Islamic Republic of Pakistan)"],2080:["ur-IN","اُردو (بھارت)‏","Urdu (India)"],128:["ug","ئۇيغۇر يېزىقى‏"],1152:["ug-CN","(ئۇيغۇر يېزىقى (جۇڭخۇا خەلق جۇمھۇرىيىتى‏","Uighur (People's Republic of China)"],30787:["uz-Cyrl","Ўзбек"],2115:["uz-Cyrl-UZ","Ўзбек (Ўзбекистон)","Uzbek (Cyrillic, Uzbekistan)"],67:["uz","U'zbek"],31811:["uz-Latn","U'zbek"],1091:["uz-Latn-UZ","U'zbek (U'zbekiston Respublikasi)","Uzbek (Latin, Uzbekistan)"],42:["vi","Tiếng Việt"],1066:["vi-VN","Tiếng Việt (Việt Nam)","Vietnamese (Vietnam)"],82:["cy","Cymraeg"],1106:["cy-GB","Cymraeg (y Deyrnas Unedig)","Welsh (United Kingdom)"],136:["wo","Wolof"],1160:["wo-SN","Wolof (Sénégal)","Wolof (Senegal)"],133:["sah","Саха"],1157:["sah-RU","Саха (Россия)","Yakut (Russia)"],120:["ii","ꆈꌠꁱꂷ"],1144:["ii-CN","ꆈꌠꁱꂷ (ꍏꉸꏓꂱꇭꉼꇩ)","Yi (People's Republic of China)"],106:["yo","Yoruba"],1130:["yo-NG","Yoruba (Nigeria)","Yoruba (Nigeria)"],1126:["bin-NG","Bini (Nigeria)","Bini (Nigeria)"],1116:["chr-US","ᏣᎳᎩ (ᏌᏊ ᎢᏳᎾᎵᏍᏔᏅ ᏍᎦᏚᎩ)","Cherokee (United States)"],1127:["fuv-NG","Nigerian Fulfulde (Nigeria)","Nigerian Fulfulde (Nigeria)"],1138:["gaz-ET","West Central Oromo (Ethiopia)","West Central Oromo (Ethiopia)"],1140:["gn-PY","Guarani (Paraguay)","Guarani (Paraguay)"],1141:["haw-US","ʻŌlelo Hawaiʻi (ʻAmelika Hui Pū ʻIa)","Hawaiian (United States)"],1129:["ibb-NG","Ibibio (Nigeria)","Ibibio (Nigeria)"],1137:["kr-NG","Kanuri (Nigeria)","Kanuri (Nigeria)"],1112:["mni","Manipuri","Manipuri"],1109:["my-MM","Burmese (Myanmar)","Burmese (Myanmar)"],1145:["pap-AN","Papiamento, Netherlands Antilles","Papiamento, Netherlands Antilles"],2118:["pa-PK","Panjabi (Pakistan)","Panjabi (Pakistan)"],1165:["plt-MG","Plateau Malagasy (Madagascar)","Plateau Malagasy (Madagascar)"],1113:["sd-IN","Sindhi (India)","Sindhi (India)"],2137:["sd-PK","Sindhi (Pakistan)","Sindhi (Pakistan)"],1143:["so-SO","Soomaali (Soomaaliya)","Somali (Somalia)"],1072:["st-ZA","Southern Sotho (South Africa)","Southern Sotho (South Africa)"],1139:["ti-ER","ትግርኛ (ኤርትራ)","Tigrinya (Eritrea)"],2163:["ti-ET","ትግርኛ (ኢትዮጵያ)","Tigrinya (Ethiopia)"],1119:["tmz","Tamanaku"],3167:["tmz-MA","Tamaziɣt n laṭlaṣ (Meṛṛuk)","Tamanaku (Morocco)"],1073:["ts-ZA","Tsonga (South Africa)","Tsonga (South Africa)"],1075:["ven-ZA","South Africa","South Africa"]};return{getLocalLanguageName:function(t){return i[t]||["",t]},getLocalLanguageCode:function(t){if(t)for(var e in i)if(i[e][0].toLowerCase()===t.toLowerCase())return e;return null},getLanguages:function(){return i}}},define("common/main/lib/util/LanguageInfo",function(){}),define("spreadsheeteditor/main/app/model/ShapeGroup",["backbone"],function(t){"use strict";SSE.Models=SSE.Models||{},SSE.Models.ShapeModel=t.Model.extend({defaults:function(){return{id:Common.UI.getId(),imageUrl:null,data:null}}}),SSE.Models.ShapeGroup=t.Model.extend({defaults:function(){return{id:Common.UI.getId(),groupName:null,groupId:null,groupStore:null}}})}),define("spreadsheeteditor/main/app/collection/ShapeGroups",["backbone","spreadsheeteditor/main/app/model/ShapeGroup"],function(t){"use strict";var e;(e=void 0===e?{}:e).Collections=e.Collections||{},SSE.Collections.ShapeGroups=t.Collection.extend({model:SSE.Models.ShapeGroup})}),define("spreadsheeteditor/main/app/model/EquationGroup",["backbone"],function(t){"use strict";SSE.Models=SSE.Models||{},SSE.Models.EquationModel=t.Model.extend({defaults:function(){return{id:Common.UI.getId(),data:null,width:0,height:0,posX:0,posY:0}}}),SSE.Models.EquationGroup=t.Model.extend({defaults:function(){return{id:Common.UI.getId(),groupName:null,groupId:null,groupStore:null}}})}),define("spreadsheeteditor/main/app/collection/EquationGroups",["backbone","spreadsheeteditor/main/app/model/EquationGroup"],function(t){"use strict";var e;(e=void 0===e?{}:e).Collections=e.Collections||{},SSE.Collections.EquationGroups=t.Collection.extend({model:SSE.Models.EquationGroup})}),define("spreadsheeteditor/main/app/collection/ConditionalFormatIcons",["backbone"],function(t){"use strict";SSE.Collections.ConditionalFormatIcons=t.Collection.extend({model:t.Model.extend({defaults:function(){return{id:Common.UI.getId(),index:0,icon:null}}})}),SSE.Collections.ConditionalFormatIconsPresets=t.Collection.extend({model:t.Model.extend({defaults:function(){return{id:Common.UI.getId(),data:0,icons:null}}})})}),define("spreadsheeteditor/main/app/model/Formula",["backbone"],function(t){"use strict";SSE.Models=SSE.Models||{},SSE.Models.FormulaModel=t.Model.extend({defaults:function(){return{id:Common.UI.getId(),index:0,group:null,name:null,origin:null,args:null}}}),SSE.Models.FormulaGroup=t.Model.extend({defaults:function(){return{id:Common.UI.getId(),index:0,name:null,store:null,functions:[]}}})}),define("spreadsheeteditor/main/app/collection/FormulaGroups",["backbone","spreadsheeteditor/main/app/model/Formula"],function(t){"use strict";SSE.Collections=SSE.Collections||{},SSE.Collections.FormulaGroups=t.Collection.extend({model:SSE.Models.FormulaGroup})}),define("spreadsheeteditor/main/app/view/FormulaDialog",["common/main/lib/component/Window","spreadsheeteditor/main/app/collection/FormulaGroups"],function(){"use strict";SSE.Views=SSE.Views||{},SSE.Views.FormulaDialog=Common.UI.Window.extend(_.extend({applyFunction:void 0,initialize:function(t){var e={};_.extend(e,{width:375,height:490,header:!0,cls:"formula-dlg",contentTemplate:"",title:this.txtTitle,items:[],buttons:null},t),this.template=t.template||['<div class="box" style="height:'+(e.height-85)+'px;">','<div class="content-panel" >','<div id="formula-dlg-search" style="height:22px; margin-bottom:10px;"></div>','<label class="header">'+this.textGroupDescription+"</label>",'<div id="formula-dlg-combo-group" class="input-group-nr" style=""></div>','<label class="header" style="margin-top: 10px">'+this.textListDescription+"</label>",'<div id="formula-dlg-combo-functions" class="combo-functions"></div>','<label id="formula-dlg-args" style="margin-top: 7px"></label>','<label id="formula-dlg-desc" style="margin-top: 4px; display: block;"></label>',"</div>","</div>",'<div class="separator horizontal"></div>','<div class="footer center">','<button id="formula-dlg-btn-ok" class="btn normal dlg-btn primary" result="ok" style="width: 86px;">'+this.okButtonText+"</button>",'<button class="btn normal dlg-btn" result="cancel" style="width: 86px;">'+this.cancelButtonText+"</button>","</div>"].join(""),this.api=t.api,this.formulasGroups=t.formulasGroups,this.handler=t.handler,e.tpl=_.template(this.template)(e),Common.UI.Window.prototype.initialize.call(this,e)},render:function(){Common.UI.Window.prototype.render.call(this),this.$window.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this));var i=this;this.inputSearch=new Common.UI.InputField({el:$("#formula-dlg-search",this.$window),allowBlank:!0,placeHolder:this.txtSearch,validateOnChange:!0,validation:function(){return!0}}).on("changing",function(t,e){e.length?(e=e.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1"),i.filter=e.toLowerCase()):i.filter=void 0,i.filterFormulas()}),this.btnOk=new Common.UI.Button({el:$("#formula-dlg-btn-ok")}),this.syntaxLabel=$("#formula-dlg-args"),this.descLabel=$("#formula-dlg-desc"),this.fillFormulasGroups()},getFocusedComponents:function(){return[this.inputSearch,this.cmbFuncGroup,this.cmbListFunctions]},getDefaultFocusableComponent:function(){return this.inputSearch},show:function(t){var e,i,s;this.$window&&(s=this.initConfig.height,i=void 0===window.innerHeight?(e=document.documentElement.offsetWidth,document.documentElement.offsetHeight):(e=Common.Utils.innerWidth(),Common.Utils.innerHeight()),i=(parseInt(i,10)-parseInt(s,10))/2,s=(parseInt(e,10)-parseInt(this.initConfig.width,10))/2,this.$window.css("left",Math.floor(s)),this.$window.css("top",Math.floor(i))),Common.UI.Window.prototype.show.call(this),t&&this.cmbFuncGroup.setValue(t),!t&&"Last10"!=this.cmbFuncGroup.getValue()||this.fillFunctions(this.cmbFuncGroup.getValue()),this.inputSearch.setValue(""),this._preventCloseCellEditor=!1},hide:function(){var t=this.cmbFuncGroup.getValue();"Recommended"==t&&(t="Last10"),0<this.cmbFuncGroup.store.length&&"Recommended"==this.cmbFuncGroup.store.at(0).get("value")&&(this.cmbFuncGroup.store.shift(),this.cmbFuncGroup.onResetItems()),this.cmbFuncGroup.setValue(t),this.recommended=this.filter=void 0,Common.UI.Window.prototype.hide.call(this),this._preventCloseCellEditor||this.api.asc_closeCellEditor(!0)},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onDblClickFunction:function(){this._handleInput("ok")},onSelectGroup:function(t,e){_.isUndefined(e)||_.isUndefined(e.value)||e.value&&this.fillFunctions(e.value),this.onUpdateFocus()},onSelectFunction:function(t,e,i){this.formulasGroups&&i&&(this.applyFunction={name:i.get("value"),origin:i.get("origin")},this.syntaxLabel.text(this.applyFunction.name+i.get("args")),this.descLabel.text(i.get("desc")))},onPrimary:function(t,e,i){this._handleInput("ok")},_handleInput:function(t){if(this.handler&&"ok"==t){if(this.btnOk.isDisabled())return;this._preventCloseCellEditor=!0,this.handler.call(this,this.applyFunction)}this.hide()},onUpdateFocus:function(){this.cmbListFunctions&&_.delay(function(t){t.cmbListFunctions.focus()},100,this)},fillFormulasGroups:function(){if(this.formulasGroups){var t=Common.Utils.InternalSettings.get("sse-settings-func-locale");_.isEmpty(t);for(var e,i=[],s=this.formulasGroups.length,o=0;o<s;++o)(e=this.formulasGroups.at(o)).get("functions").length&&i.push({value:e.get("name"),displayValue:e.get("caption")});this.cmbFuncGroup?this.cmbFuncGroup.setData(i):(this.cmbFuncGroup=new Common.UI.ComboBox({el:$("#formula-dlg-combo-group"),menuStyle:"min-width: 100%;",cls:"input-group-nr",data:i,editable:!1,takeFocusOnClose:!0}),this.cmbFuncGroup.on("selected",_.bind(this.onSelectGroup,this))),this.cmbFuncGroup.setValue("Last10"),this.fillFunctions("Last10"),this.allFunctions=new Common.UI.DataViewStore,(e=this.formulasGroups.findWhere({name:"All"}))&&this.allFunctions.reset(e.get("functions"))}},fillFunctions:function(t){if(this.formulasGroups&&(this.cmbListFunctions||this.functions||(this.functions=new Common.UI.DataViewStore,this.cmbListFunctions=new Common.UI.ListView({el:$("#formula-dlg-combo-functions"),store:this.functions,tabindex:1,cls:"dbl-clickable"}),this.cmbListFunctions.on("item:select",_.bind(this.onSelectFunction,this)),this.cmbListFunctions.on("item:dblclick",_.bind(this.onDblClickFunction,this)),this.cmbListFunctions.on("entervalue",_.bind(this.onPrimary,this)),this.cmbListFunctions.onKeyDown=_.bind(this.onKeyDown,this),this.onUpdateFocus()),this.functions)){this.functions.reset();for(var e=null,i=("Recommended"==t?e=this.recommended:(t=this.formulasGroups.findWhere({name:t}))&&(e=t.get("functions")),e?e.length:0),s=0;s<i;++s)this.functions.push(new Common.UI.DataViewModel({id:e[s].get("index"),selected:s<1,allowSelected:!0,value:e[s].get("name"),args:e[s].get("args"),desc:e[s].get("desc"),origin:e[s].get("origin")}));this.applyFunction=i?{name:e[0].get("name"),origin:e[0].get("origin")}:void 0,this.syntaxLabel.text(i?this.applyFunction.name+e[0].get("args"):""),this.descLabel.text(i?e[0].get("desc"):""),this.cmbListFunctions.scroller.update({minScrollbarLength:40,alwaysVisibleY:!0}),this.btnOk.setDisabled(!i)}},filterFormulas:function(){var e,i,t,s;this.filter?(e=this,i=new RegExp(e.filter,"ig"),0<(t=this.allFunctions.filter(function(t){return!!t.get("name").match(i)})).length?("Recommended"!=this.cmbFuncGroup.store.at(0).get("value")&&(this.cmbFuncGroup.store.unshift({value:"Recommended",displayValue:this.txtRecommended}),this.cmbFuncGroup.onResetItems()),0<(s=_.findIndex(t,function(t){return t.get("name").toLowerCase()===e.filter}))&&(s=t.splice(s,1),t.unshift(s[0]))):0==t.length&&0<this.cmbFuncGroup.store.length&&"Recommended"==this.cmbFuncGroup.store.at(0).get("value")&&(this.cmbFuncGroup.store.shift(),this.cmbFuncGroup.onResetItems()),this.cmbFuncGroup.setValue("Recommended",this.txtRecommended),this.recommended=t,this.fillFunctions("Recommended")):(this.cmbFuncGroup.setValue("Last10"),this.fillFunctions("Last10"))},onKeyDown:function(t,e){var i=0,s=null,o=this,n=this.cmbListFunctions,a="",l="",r=null,c=null,d=!1,h=null;if(!n.disabled){if(_.isUndefined(void 0)&&(e=t),a=t.key,64<t.keyCode&&t.keyCode<91&&a&&a.length){for(a=a.toLocaleLowerCase(),(h=n.store.findWhere({selected:!0}))&&(d=(l=h.get("value"))&&l.length&&l[0].toLocaleLowerCase()===a),i=0;i<n.store.length;++i)if((l=(s=n.store.at(i)).get("value"))[0].toLocaleLowerCase()===a)if(null===r&&(r=s),d)h===s&&(d=!1);else if(!s.get("selected"))return void p(s);if(r)return void p(r)}Common.UI.DataView.prototype.onKeyDown.call(n,t,e)}function p(t){n.selectRecord(t),o.onScrollToRecordCustom.call(n,t),c=$(n.el).find(".inner"),n.scroller.scrollTop(c.scrollTop(),0),e.preventDefault(),e.stopPropagation()}},onScrollToRecordCustom:function(t){var e=$(this.el).find(".inner"),i=e.offset().top,t=e.find("#"+t.get("id")).parent(),s=t.offset().top;(s<i||s+t.height()>i+e.height())&&(this.scroller?this.scroller.scrollTop(e.scrollTop()+s-i,0):e.scrollTop(e.scrollTop()+s-i))}},SSE.Views.FormulaDialog||{}))}),define("spreadsheeteditor/main/app/view/FormulaTab",["common/main/lib/util/utils","common/main/lib/component/BaseView","common/main/lib/component/Layout"],function(){"use strict";SSE.Views.FormulaTab=Common.UI.BaseView.extend(_.extend({options:{},initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this),this.toolbar=t.toolbar,this.formulasGroups=t.formulasGroups,this.lockedControls=[],this.formulaControls=[];var t=this.toolbar.$el,e=Common.enumLock,i=SSE.getController("FormulaDialog");this.btnFinancial=new Common.UI.Button({parentEl:t.find("#slot-btn-financial"),cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-finance",caption:i.sCategoryFinancial,hint:i.sCategoryFinancial,menu:!0,split:!1,disabled:!0,lock:[e.editText,e.selChart,e.selChartText,e.selShape,e.selShapeText,e.selImage,e.selSlicer,e.selRangeEdit,e.lostConnect,e.coAuth,e.noSubitems,e.userProtected],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.lockedControls.push(this.btnFinancial),this.formulaControls.push(this.btnFinancial),this.btnLogical=new Common.UI.Button({parentEl:t.find("#slot-btn-logical"),cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-logic",caption:i.sCategoryLogical,hint:i.sCategoryLogical,menu:!0,split:!1,disabled:!0,lock:[e.editText,e.selChart,e.selChartText,e.selShape,e.selShapeText,e.selImage,e.selSlicer,e.selRangeEdit,e.lostConnect,e.coAuth,e.noSubitems,e.userProtected],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.lockedControls.push(this.btnLogical),this.formulaControls.push(this.btnLogical),this.btnTextData=new Common.UI.Button({parentEl:t.find("#slot-btn-text"),cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-func-text",caption:i.sCategoryTextAndData,hint:i.sCategoryTextAndData,menu:!0,split:!1,disabled:!0,lock:[e.editText,e.selChart,e.selChartText,e.selShape,e.selShapeText,e.selImage,e.selSlicer,e.selRangeEdit,e.lostConnect,e.coAuth,e.noSubitems,e.userProtected],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.lockedControls.push(this.btnTextData),this.formulaControls.push(this.btnTextData),this.btnDateTime=new Common.UI.Button({parentEl:t.find("#slot-btn-datetime"),cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-datetime",caption:i.sCategoryDateAndTime,hint:i.sCategoryDateAndTime,menu:!0,split:!1,disabled:!0,lock:[e.editText,e.selChart,e.selChartText,e.selShape,e.selShapeText,e.selImage,e.selSlicer,e.selRangeEdit,e.lostConnect,e.coAuth,e.noSubitems,e.userProtected],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.lockedControls.push(this.btnDateTime),this.formulaControls.push(this.btnDateTime),this.btnReference=new Common.UI.Button({parentEl:t.find("#slot-btn-lookup"),cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-lookup",caption:i.sCategoryLookupAndReference,hint:i.sCategoryLookupAndReference,menu:!0,split:!1,disabled:!0,lock:[e.editText,e.selChart,e.selChartText,e.selShape,e.selShapeText,e.selImage,e.selSlicer,e.selRangeEdit,e.lostConnect,e.coAuth,e.noSubitems,e.userProtected],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.lockedControls.push(this.btnReference),this.formulaControls.push(this.btnReference),this.btnMath=new Common.UI.Button({parentEl:t.find("#slot-btn-math"),cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-func-math",caption:i.sCategoryMathematic,hint:i.sCategoryMathematic,menu:!0,split:!1,disabled:!0,lock:[e.editText,e.selChart,e.selChartText,e.selShape,e.selShapeText,e.selImage,e.selSlicer,e.selRangeEdit,e.lostConnect,e.coAuth,e.noSubitems,e.userProtected],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.lockedControls.push(this.btnMath),this.formulaControls.push(this.btnMath),this.btnRecent=new Common.UI.Button({parentEl:t.find("#slot-btn-recent"),cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-recent",caption:this.txtRecent,hint:this.txtRecent,menu:!0,split:!1,disabled:!0,lock:[e.editText,e.selChart,e.selChartText,e.selShape,e.selShapeText,e.selImage,e.selSlicer,e.selRangeEdit,e.lostConnect,e.coAuth,e.noSubitems,e.userProtected],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.lockedControls.push(this.btnRecent),this.formulaControls.push(this.btnRecent),this.btnAutosum=new Common.UI.Button({parentEl:t.find("#slot-btn-autosum"),cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-autosum",caption:this.txtAutosum,hint:[this.txtAutosumTip+Common.Utils.String.platformKey("Alt+="),this.txtFormulaTip+Common.Utils.String.platformKey("Shift+F3")],split:!0,disabled:!0,lock:[e.editText,e.selChart,e.selChartText,e.selShape,e.selShapeText,e.selImage,e.selSlicer,e.selRangeEdit,e.lostConnect,e.coAuth,e.userProtected],menu:new Common.UI.Menu({items:[{caption:"SUM",value:"SUM"},{caption:"AVERAGE",value:"AVERAGE"},{caption:"MIN",value:"MIN"},{caption:"MAX",value:"MAX"},{caption:"COUNT",value:"COUNT"},{caption:"--"},{caption:this.txtAdditional,value:"more",hint:this.txtFormulaTip+Common.Utils.String.platformKey("Shift+F3")}]}),dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.lockedControls.push(this.btnAutosum),this.formulaControls.push(this.btnAutosum),this.btnFormula=new Common.UI.Button({parentEl:t.find("#slot-btn-additional-formula"),cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-ins-formula",caption:this.txtFormula,hint:this.txtFormulaTip+Common.Utils.String.platformKey("Shift+F3"),disabled:!0,lock:[e.editText,e.selChart,e.selChartText,e.selShape,e.selShapeText,e.selImage,e.selSlicer,e.selRangeEdit,e.lostConnect,e.coAuth,e.userProtected],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.lockedControls.push(this.btnFormula),this.formulaControls.push(this.btnFormula),this.btnMore=new Common.UI.Button({parentEl:t.find("#slot-btn-more"),cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-more",caption:this.txtMore,hint:this.txtMore,menu:!0,split:!1,disabled:!0,lock:[e.editText,e.selChart,e.selChartText,e.selShape,e.selShapeText,e.selImage,e.selSlicer,e.selRangeEdit,e.lostConnect,e.coAuth,e.noSubitems,e.userProtected],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.lockedControls.push(this.btnMore),this.formulaControls.push(this.btnMore),this.btnCalculate=new Common.UI.Button({parentEl:t.find("#slot-btn-calculate"),cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-calculation",caption:this.txtCalculation,split:!0,menu:!0,disabled:!0,lock:[e.editCell,e.selRangeEdit,e.lostConnect,e.coAuth],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.lockedControls.push(this.btnCalculate),this.formulaControls.push(this.btnCalculate),this.btnNamedRange=new Common.UI.Button({parentEl:t.find("#slot-btn-named-range-huge"),cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-big-named-range",caption:this.toolbar.txtNamedRange,hint:this.toolbar.txtNamedRange,split:!1,disabled:!0,lock:[e.selChart,e.selChartText,e.selShape,e.selShapeText,e.selImage,e.lostConnect,e.coAuth,e.selRangeEdit,e.wsLock],menu:new Common.UI.Menu({items:[{caption:this.toolbar.txtManageRange,lock:[e.editCell],value:"manage"},{caption:this.toolbar.txtNewRange,lock:[e.editCell],value:"new"},{caption:this.toolbar.txtPasteRange,lock:[e.userProtected],value:"paste"}]}),dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.lockedControls.push(this.btnNamedRange),this.btnWatch=new Common.UI.Button({parentEl:t.find("#slot-btn-watch-window"),cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-watch-window",caption:this.txtWatch,hint:this.tipWatch,disabled:!0,enableToggle:!0,lock:[e.editCell,e.lostConnect,e.coAuth],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.lockedControls.push(this.btnWatch),this.btnTracePrec=new Common.UI.Button({parentEl:t.find("#slot-btn-trace-prec"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-trace-precedents",lock:[e.editCell,e.editText,e.selChart,e.selChartText,e.selShape,e.selShapeText,e.selImage,e.selSlicer,e.selRangeEdit,e.lostConnect,e.coAuth,e.wsLock],caption:this.capBtnTracePrec,dataHint:"1",dataHintDirection:"left",dataHintOffset:"medium"}),this.lockedControls.push(this.btnTracePrec),this.btnTraceDep=new Common.UI.Button({parentEl:t.find("#slot-btn-trace-dep"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-trace-dependents",lock:[e.editCell,e.editText,e.selChart,e.selChartText,e.selShape,e.selShapeText,e.selImage,e.selSlicer,e.selRangeEdit,e.lostConnect,e.coAuth,e.wsLock],caption:this.capBtnTraceDep,dataHint:"1",dataHintDirection:"left",dataHintOffset:"medium"}),this.lockedControls.push(this.btnTraceDep),this.btnRemArrows=new Common.UI.Button({parentEl:t.find("#slot-btn-remove-arrows"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-remove-trace-arrows",lock:[e.editCell,e.editText,e.selChart,e.selChartText,e.selShape,e.selShapeText,e.selImage,e.selSlicer,e.selRangeEdit,e.lostConnect,e.coAuth,e.wsLock],caption:this.capBtnRemoveArr,split:!0,menu:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"0, -8"}),this.lockedControls.push(this.btnRemArrows),this.btnShowFormulas=new Common.UI.Button({parentEl:t.find("#slot-btn-show-formulas"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-show-formulas",caption:this.txtShowFormulas,disabled:!0,enableToggle:!0,lock:[e.sheetLock,e.editCell,e.lostConnect,e.coAuth],dataHint:"1",dataHintDirection:"left",dataHintOffset:"medium"}),this.lockedControls.push(this.btnShowFormulas),Common.NotificationCenter.on("app:ready",this.onAppReady.bind(this))},render:function(t){return this},onAppReady:function(t){var e=this;new Promise(function(t,e){t()}).then(function(){e.btnCalculate.updateHint([e.tipCalculateTheEntireWorkbook+Common.Utils.String.platformKey("F9"),e.tipCalculate]);var t=new Common.UI.Menu({items:[{caption:e.textCalculateWorkbook,value:Asc.c_oAscCalculateType.All},{caption:e.textCalculateCurrentSheet,value:Asc.c_oAscCalculateType.ActiveSheet}]});e.btnCalculate.setMenu(t),e.btnShowFormulas.updateHint(e.tipShowFormulas+Common.Utils.String.format(" ({0}+`)",Common.Utils.String.textCtrl)),e.btnTracePrec.updateHint(e.tipTracePrec),e.btnTraceDep.updateHint(e.tipTraceDep),e.btnRemArrows.updateHint(e.tipRemoveArr),e.btnRemArrows.setMenu(new Common.UI.Menu({items:[{caption:e.capBtnRemoveArr,value:Asc.c_oAscRemoveArrowsType.all},{caption:e.txtRemPrec,value:Asc.c_oAscRemoveArrowsType.precedent},{caption:e.txtRemDep,value:Asc.c_oAscRemoveArrowsType.dependent}]})),function(){var s=this;s.btnAutosum.on("click",function(){s.fireEvent("function:apply",[{name:s.api.asc_getFormulaLocaleName("SUM"),origin:"SUM"},!0])}),s.btnAutosum.menu.on("item:click",function(t,e,i){s.fireEvent("function:apply",[{name:e.caption,origin:e.value},!0])}),s.btnFormula.on("click",function(){s.fireEvent("function:apply",[{name:"more",origin:"more"}])}),s.btnCalculate.on("click",function(){s.fireEvent("function:calculate",[{type:Asc.c_oAscCalculateType.All}])}),s.btnCalculate.menu.on("item:click",function(t,e,i){s.fireEvent("function:calculate",[{type:e.value}])}),s.btnNamedRange.menu.on("show:after",function(t){s.fireEvent("function:namedrange-open",[t])}),s.btnNamedRange.menu.on("item:click",function(t,e,i){s.fireEvent("function:namedrange",[t,e,i])}),s.btnWatch.on("click",function(t,e){s.fireEvent("function:watch",[t.pressed])}),s.btnTracePrec.on("click",function(t,e){s.fireEvent("function:precedents")}),s.btnTraceDep.on("click",function(t,e){s.fireEvent("function:dependents")}),s.btnRemArrows.menu.on("item:click",function(t,e,i){s.fireEvent("function:remove-arrows",[e.value])}),s.btnRemArrows.on("click",function(t,e){s.fireEvent("function:remove-arrows",[Asc.c_oAscRemoveArrowsType.all])}),s.btnShowFormulas&&this.btnShowFormulas.on("click",function(t,e){s.fireEvent("function:showformula",[t.pressed])})}.call(e)})},show:function(){Common.UI.BaseView.prototype.show.call(this),this.fireEvent("show",this)},getButtons:function(t){return"formula"==t?this.formulaControls:"range"==t?this.btnNamedRange:this.lockedControls},SetDisabled:function(e){this.lockedControls&&this.lockedControls.forEach(function(t){t&&t.setDisabled(e)},this)},setButtonMenu:function(t,s){var e,o=this,i=[],n=o.formulasGroups.findWhere({name:s});n&&(n=n.get("functions"))&&n.forEach(function(t){i.push(new Common.UI.MenuItem({caption:t.get("name"),value:t.get("origin")}))}),i.length&&(t.menu&&t.menu.rendered?(e=t.menu._innerMenu)&&(e.removeAll(),i.forEach(function(t){e.addItem(t)})):(t.setMenu(new Common.UI.Menu({items:[{template:_.template('<div id="id-toolbar-formula-menu-'+s+'" style="display: flex;" class="open"></div>')},{caption:"--"},{caption:o.txtAdditional,value:"more",hint:o.txtFormulaTip+Common.Utils.String.platformKey("Shift+F3")}]})),t.menu.items[2].on("click",function(t,e){o.fireEvent("function:apply",[{name:t.caption,origin:t.value},!1,s])}),t.menu.on("show:after",function(t,e){t._innerMenu.scroller.update({alwaysVisibleY:!0}),_.delay(function(){t._innerMenu&&t._innerMenu.cmpEl.focus()},10)}),(e=new Common.UI.Menu({maxHeight:300,cls:"internal-menu",items:i,outerMenu:{menu:t.menu,index:0}})).render(t.menu.items[0].cmpEl.children(":first")),e.cmpEl.css({display:"block",position:"relative",left:0,top:0}),e.cmpEl.attr({tabindex:"-1"}),e.on("item:click",function(t,e,i){o.fireEvent("function:apply",[{name:e.caption,origin:e.value},!1,s])}),t.menu._innerMenu=e,t.menu.setInnerMenu([{menu:e,index:0}]))),Common.Utils.lockControls(Common.enumLock.noSubitems,i.length<1,{array:[t]})},setMenuItemMenu:function(s){var o=this,e=[],t=SSE.getController("FormulaDialog"),i=o.formulasGroups.findWhere({name:s});if(i){var i=i.get("functions");if(i&&i.forEach(function(t){e.push(new Common.UI.MenuItem({caption:t.get("name"),value:t.get("origin")}))}),e.length)return(i=new Common.UI.MenuItem({caption:t["sCategory"+s]||s,menu:new Common.UI.Menu({menuAlign:"tl-tr",items:[{template:_.template('<div id="id-toolbar-formula-menu-'+s+'" style="display: flex;" class="open"></div>')},{caption:"--"},{caption:o.txtAdditional,value:"more",hint:o.txtFormulaTip+Common.Utils.String.platformKey("Shift+F3")}]})})).menu.items[2].on("click",function(t,e){o.fireEvent("function:apply",[{name:t.caption,origin:t.value},!1,s])}),i.menu.on("show:after",function(t,e){t._innerMenu.scroller.update({alwaysVisibleY:!0}),_.delay(function(){t._innerMenu&&t._innerMenu.items[0].cmpEl.find("> a").focus()},10)}).on("keydown:before",function(t,e){e.keyCode!=Common.UI.Keys.LEFT&&e.keyCode!=Common.UI.Keys.ESC||(e=t.cmpEl.parent()).hasClass("dropdown-submenu")&&e.hasClass("over")&&(e.removeClass("over"),e.find("> a").focus())}),(t=new Common.UI.Menu({maxHeight:300,cls:"internal-menu",items:e,outerMenu:{menu:i.menu,index:0}})).on("item:click",function(t,e,i){o.fireEvent("function:apply",[{name:e.caption,origin:e.value},!1,s])}),i.menu._innerMenu=t,i.menu.setInnerMenu([{menu:t,index:0}]),i}},fillFunctions:function(){if(this.formulasGroups){this.setButtonMenu(this.btnFinancial,"Financial"),this.setButtonMenu(this.btnLogical,"Logical"),this.setButtonMenu(this.btnTextData,"TextAndData"),this.setButtonMenu(this.btnDateTime,"DateAndTime"),this.setButtonMenu(this.btnReference,"LookupAndReference"),this.setButtonMenu(this.btnMath,"Mathematic"),this.setButtonMenu(this.btnRecent,"Last10");for(var t=this.btnAutosum.menu.items,e=0;e<Math.min(4,t.length);e++)this.api&&t[e].setCaption(this.api.asc_getFormulaLocaleName(t[e].value));var i=this,s=[],o=(["Cube","Database","Engineering","Information","Statistical"].forEach(function(t){t=i.setMenuItemMenu(t);t&&s.push(t)}),this.btnMore);s.length&&(o.menu&&o.menu.rendered?(o.menu.removeAll(),s.forEach(function(t){o.menu.addItem(t)})):o.setMenu(new Common.UI.Menu({items:s})),o.menu.items.forEach(function(t){var e=t.menu.items[0].cmpEl.children(":first"),t=t.menu._innerMenu;t.render(e),t.cmpEl.css({display:"block",position:"relative",left:0,top:0}),t.cmpEl.attr({tabindex:"-1"})})),Common.Utils.lockControls(Common.enumLock.noSubitems,s.length<1,{array:[o]})}},updateRecent:function(){this.formulasGroups&&this.setButtonMenu(this.btnRecent,"Last10")},setApi:function(t){this.api=t}},SSE.Views.FormulaTab||{}))}),define("spreadsheeteditor/main/app/view/FormulaWizard",["common/main/lib/view/AdvancedSettingsWindow","common/main/lib/component/MetricSpinner"],function(){"use strict";SSE.Views.FormulaWizard=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:580,height:397},initialize:function(t){_.extend(this.options,{title:this.textTitle,template:['<div class="box" style="height:'+(this.options.height-85)+'px;">','<div class="content-panel" style="padding: 0;"><div class="inner-content">','<div class="settings-panel active">','<table style="height:'+(this.options.height-85-7)+'px;">',"<tr><td>",'<label id="formula-wizard-name" style="display: block;margin-bottom: 8px;"></label>','<div id="formula-wizard-panel-args" style="">','<div style="overflow: hidden;position: relative;">','<table cols="3" id="formula-wizard-tbl-args" style="width: 100%;">',"</table>","</div>",'<div style="margin-top: 4px;">','<label id="formula-wizard-lbl-func-res">'+this.textFunctionRes+"</label>",'<div id="formula-wizard-lbl-val-func" class="input-label float-right" style="width: 200px;overflow: hidden;text-overflow: ellipsis;white-space: nowrap;"></div>',"</div>","</div>","</td></tr>",'<tr><td style="height:100%;padding-bottom: 12px;"></td></tr>',"<tr><td>",'<div id="formula-wizard-panel-desc" style="word-break: break-word;">','<label id="formula-wizard-args" style="display: block;margin-bottom: 0px;"></label>','<label id="formula-wizard-desc" style="display: block;margin-bottom: 8px;"></label>','<label id="formula-wizard-value" style="display: block;margin-bottom: 8px;"><b>Formula result:</b></label>','<label style="display: none; margin-bottom: 8px;"><a id="formula-wizard-help" style="cursor: pointer;">'+this.textHelp+"</a></label>","</div>","</td></tr>","</table>","</div></div>","</div>","</div>",'<div class="separator horizontal"></div>'].join("")},t),this.props=this.options.props,this.funcprops=this.options.funcprops,this.api=this.options.api,this.lang=this.options.lang,this._noApply=!1,this.args=[],this.argsNames=[],this.repeatedIdx=1,this.repeatedArg=void 0,this.helpUrl=void 0,this.minArgCount=1,this.maxArgCount=1,this.minArgWidth=50,Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var t=this.getChild();t.find("input").on("keypress",_.bind(this.onKeyPress,this)),this.contentPanel=t.find(".content-panel"),this.innerPanel=t.find(".inner-content"),this.panelArgs=t.find("#formula-wizard-panel-args"),this.tableArgs=t.find("#formula-wizard-tbl-args"),this.panelDesc=t.find("#formula-wizard-panel-desc"),this.lblArgDesc=t.find("#formula-wizard-arg-desc"),this.lblFormulaResult=t.find("#formula-wizard-value"),this.lblFunctionResult=t.find("#formula-wizard-lbl-val-func"),this._preventCloseCellEditor=!1,this.afterRender()},afterRender:function(){this._setDefaults()},_handleInput:function(t){this.options.handler&&this.options.handler.call(this,t,"ok"==t?this.getSettings():void 0),this._preventCloseCellEditor="ok"==t,this.close()},onDlgBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onKeyPress:function(t){t.keyCode==Common.UI.Keys.RETURN&&this._handleInput("ok")},onPrimary:function(){return this._handleInput("ok"),!1},_setDefaults:function(){var e=this;if(this.funcprops&&((t=this.funcprops).args?$("#formula-wizard-args").html("<b>"+t.name+"</b>"+t.args):$("#formula-wizard-args").addClass("hidden"),t.desc?$("#formula-wizard-desc").text(t.desc):$("#formula-wizard-desc").addClass("hidden"),t.name?$("#formula-wizard-name").html(this.textFunction+": "+t.name):$("#formula-wizard-name").addClass("hidden"),this.parseArgsDesc(t.args),this.$window.find("#formula-wizard-help").on("click",function(t){e.showHelp()})),this.recalcArgTableSize(),this.minArgWidth=this.$window.find("#formula-wizard-lbl-func-res").width(),this.props){var t=this.props,i=(this.minArgCount=t.asc_getArgumentMin(),this.maxArgCount=t.asc_getArgumentMax(),t.asc_getFunctionResult()),s=(this.lblFunctionResult.html("= "+(null!=i?i:"")),i=t.asc_getFormulaResult(),this.lblFormulaResult.html("<b>"+this.textValue+": </b>"+(null!=i?i:"")),t.asc_getArgumentsResult()),o=t.asc_getArgumentsType(),n=t.asc_getArgumentsValue();if(o){for(var a=0;a<o.length;a++){var l=o[a],r=[];"object"==typeof l?(this.repeatedArg=l,this.fillRepeatedNames(),r=l):r.push(l),this.fillArgs(r,n,s)}if(n&&this.args.length<n.length&&this.repeatedArg)for(;this.args.length<n.length;)this.fillArgs(this.repeatedArg,n,s);this.scrollerY.update(),this.scrollerY.scrollTop(0)}}this.args.length<1?(this.panelArgs.text(this.textNoArgs),this.lblArgDesc.addClass("hidden")):(1==this.args.length&&this.repeatedArg&&this.repeatedArg.length<this.maxArgCount&&(this.fillArgs(this.repeatedArg),this.scrollerY.update()),_.delay(function(){e._noApply=!0,e.args[0].argInput.focus(),e._noApply=!1},100))},recalcArgTableSize:function(){var t=this.panelDesc.outerHeight(),t=this.$window.find(".box").height()-7-t-54;t=30*parseInt(t/30),this.tableArgs.parent().css("max-height",t),this.scrollerY?this.scrollerY.update():this.scrollerY=new Common.UI.Scroller({el:this.tableArgs.parent(),minScrollbarLength:20,alwaysVisibleY:!0})},checkDescriptionSize:function(){this.contentPanel.height()<this.innerPanel.height()&&this.recalcArgTableSize()},parseArgsDesc:function(t){var i=(t=")"==(t="("==t.charAt(0)?t.substring(1):t).charAt(t.length-1)?t.substring(0,t.length-1):t).split(this.api.asc_getFunctionArgumentSeparator());i.forEach(function(t,e){t=(t="]"==(t="["==(t=t.trim()).charAt(0)?t.substring(1):t).charAt(t.length-1)?t.substring(0,t.length-1):t).trim();i[e]=t.charAt(0).toUpperCase().concat(t.substring(1))}),this.argsNames=i},fillRepeatedNames:function(){if(!(this.argsNames.length<1)&&this.repeatedArg&&0<this.repeatedArg.length&&"..."===this.argsNames[this.argsNames.length-1]){this.argsNames.length,this.repeatedArg.length;for(var t=0;t<this.repeatedArg.length;t++){var e=this.argsNames[this.argsNames.length-2-t],i=e.charAt(e.length-1);-1<"123456789".indexOf(i)&&(this.repeatedIdx=parseInt(i),this.argsNames[this.argsNames.length-2-t]=e.substring(0,e.length-1))}}},getArgumentName:function(t){var e,i,s,o=this.argsNames.length;return(!this.repeatedArg||this.repeatedArg.length<1)&&t<o&&"..."!==this.argsNames[t]?this.argsNames[t]:this.repeatedArg&&0<this.repeatedArg.length&&"..."===this.argsNames[o-1]?t<(s=o-1-(e=this.repeatedArg.length))?this.argsNames[t]:(i=e-(t-s)%e,s=Math.floor((t-s)/e)+this.repeatedIdx,this.argsNames[o-1-i]+s):this.textArgument+(1<this.maxArgCount?" "+(t+1):"")},fillArgs:function(t,e,i){for(var s=this.args.length,o=0;o<t.length;o++)this.setControls(s,t[o],e?e[s]:void 0,i?i[s]:void 0),s++},setControls:function(t,e,i,s){var o=this,n='<tr><td class="padding-right-10" style="padding-bottom: 8px;vertical-align: middle;"><div id="formula-wizard-lbl-name-arg{0}" style="min-width:'+this.minArgWidth+'px;white-space: nowrap;margin-top: 1px;"></div></td><td class="padding-right-5" style="padding-bottom: 8px;width: 100%;vertical-align: middle;"><div id="formula-wizard-txt-arg{0}"></div></td><td style="padding-bottom: 8px;vertical-align: middle;"><div id="formula-wizard-lbl-val-arg{0}" class="input-label" style="margin-top: 1px;width: 200px;overflow: hidden;text-overflow: ellipsis;white-space: nowrap;"></div></td></tr>',n=$(Common.Utils.String.format(n,t)),a=(this.tableArgs.append(n),new Common.UI.InputFieldBtn({el:n.find("#formula-wizard-txt-arg"+t),index:t,validateOnChange:!0,validateOnBlur:!1}).on("changed:after",function(t,e,i,s){}).on("changing",function(t,e,i,s){e!=i&&o.onInputChanging(t,e,i)}).on("button:click",_.bind(this.onSelectData,this)));a.setValue(null!=i?i:""),a._input.on("focus",_.bind(this.onSelectArgument,this,a)),o.args.push({index:t,lblName:n.find("#formula-wizard-lbl-name-arg"+t),lblValue:n.find("#formula-wizard-lbl-val-arg"+t),argInput:a,argName:o.getArgumentName(t),argType:e,argTypeName:o.getArgType(e)}),t<o.minArgCount?o.args[t].lblName.html("<b>"+o.args[t].argName+"</b>"):o.args[t].lblName.html(o.args[t].argName),o.args[t].lblValue.html("= "+(null!=s?s:'<span style="opacity: 0.6; font-weight: bold;">'+o.args[t].argTypeName+"</span>")),Common.UI.FocusManager.add(this,a)},onInputChanging:function(t,e,i,s){var t=t.options.index,o=this.args[t],n=this.api.asc_insertArgumentsInFormula(this.getArgumentsValue(),t,o.argType,this.funcprops?this.funcprops.origin:void 0),a=(a=n?n.asc_getArgumentsResult():void 0)?a[t]:void 0,t=(o.lblValue.html("= "+(null!=a?a:'<span style="opacity: 0.6; font-weight: bold;">'+o.argTypeName+"</span>")),n?n.asc_getFunctionResult():void 0);this.lblFunctionResult.html("= "+(null!=t?t:"")),t=n?n.asc_getFormulaResult():void 0,this.lblFormulaResult.html("<b>"+this.textValue+": </b>"+(null!=t?t:""))},getArgumentsValue:function(){for(var t=[],e=!0,i=this.args.length-1;0<=i;i--){var s=this.args[i].argInput.getValue();(e=e&&!s)||(t[i]=s)}return t},getArgType:function(t){var e="";switch(t){case Asc.c_oAscFormulaArgumentType.number:e=this.textNumber;break;case Asc.c_oAscFormulaArgumentType.text:e=this.textText;break;case Asc.c_oAscFormulaArgumentType.reference:e=this.textRef;break;case Asc.c_oAscFormulaArgumentType.any:e=this.textAny;break;case Asc.c_oAscFormulaArgumentType.logical:e=this.textLogical}return e},onSelectArgument:function(t){var t=t.options.index,e=this.args[t];e.argDesc?this.lblArgDesc.html("<b>"+e.argName+": </b>"+e.argDesc):this.lblArgDesc.addClass("hidden"),!this._noApply&&t==this.args.length-1&&this.repeatedArg&&t+this.repeatedArg.length<this.maxArgCount&&(this.fillArgs(this.repeatedArg),this.scrollerY.update()),this.checkDescriptionSize()},onSelectData:function(t){this.onSelectArgument(t);var i,e,s,o=this;o.api&&(i=t.getValue(),e=new SSE.Views.CellRangeDialog({allowBlank:!0,handler:function(t,e){"ok"==e&&(i=t.getSettings())}}).on("close",function(){t.setValue(i),o.onInputChanging(t),o.show(),_.delay(function(){o._noApply=!0,t.focus(),o._noApply=!1},1)}),s=o.$window.offset(),o.hide(),e.show(s.left+65,s.top+77),e.setSettings({api:o.api,range:_.isEmpty(t.getValue())?"":t.getValue(),type:Asc.c_oAscSelectionDialogType.Function,selection:{start:t._input[0].selectionStart,end:t._input[0].selectionEnd},argvalues:o.getArgumentsValue(),argindex:t.options.index}))},showHelp:function(){if(null==this.helpUrl)if(this.funcprops&&this.funcprops.origin){var t,e=(e=Common.Utils.InternalSettings.get("sse-settings-func-help"))||(this.lang?this.lang.split(/[\-\_]/)[0]:"en"),i=this,s=this.funcprops.origin.toLocaleLowerCase().replace(/\./g,"-"),o="/Functions/"+s+".htm",n="resources/help/"+e+o;if(Common.Controllers.Desktop.isActive()){if(!Common.Controllers.Desktop.isHelpAvailable())return(t=Common.Utils.InternalSettings.get("url-help-center"))&&((t=new URL(t)).searchParams&&t.searchParams.set("function",s),window.open(t.toString(),"_blank")),void(i.helpUrl=null);n=Common.Controllers.Desktop.helpUrl()+o}fetch(n).then(function(t){t.ok?(Common.Utils.InternalSettings.set("sse-settings-func-help",e),i.helpUrl=n,i.showHelp()):(n="resources/help/zh"+o,fetch(n).then(function(t){t.ok?(Common.Utils.InternalSettings.set("sse-settings-func-help","zh"),i.helpUrl=n,i.showHelp()):i.helpUrl=null}))})}else this.helpUrl=null;else this.helpUrl&&window.open(this.helpUrl)},getSettings:function(){return{}},close:function(){Common.Views.AdvancedSettingsWindow.prototype.close.call(this),this.api.asc_closeCellEditor(!this._preventCloseCellEditor)}},SSE.Views.FormulaWizard||{}))}),define("text!spreadsheeteditor/main/app/template/WatchDialog.template",[],function(){return'<div class="settings-panel active">\n    <div class="inner-content">\n        <table cols="1" style="width: 100%;">\n            <tr>\n                <td class="padding-large">\n                    <button type="button" class="btn btn-text-default auto sort-dialog-btn-text" id="watch-dialog-btn-add"><%= scope.textAdd %></button>\n                    <div id="watch-dialog-btn-delete" style="display: inline-block;"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="watch-dialog-list" class="range-tableview" style="width:100%; height: 164px;"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>'}),define("spreadsheeteditor/main/app/view/WatchDialog",["text!spreadsheeteditor/main/app/template/WatchDialog.template","common/main/lib/view/AdvancedSettingsWindow","common/main/lib/component/ListView"],function(e){"use strict";SSE.Views=SSE.Views||{},SSE.Views.WatchDialog=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{alias:"WatchDialog",contentWidth:560,height:294,modal:!1,buttons:null},initialize:function(t){_.extend(this.options,{title:this.txtTitle,template:['<div class="box" style="height:'+(this.options.height-85)+'px;">','<div class="content-panel" style="padding: 0;">'+_.template(e)({scope:this})+"</div>","</div>",'<div class="footer center">','<button class="btn normal dlg-btn" result="cancel" style="width: 86px;">'+this.closeButtonText+"</button>","</div>"].join("")},t),this.api=t.api,this.handler=t.handler,this.wrapEvents={onRefreshWatchList:_.bind(this.refreshList,this)},Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);this.watchList=new Common.UI.ListView({el:$("#watch-dialog-list",this.$window),multiSelect:!0,store:new Common.UI.DataViewStore,simpleAddMode:!0,headers:[{name:this.textBook,width:70},{name:this.textSheet,width:70},{name:this.textName,width:70},{name:this.textCell,width:70},{name:this.textValue,width:110},{name:this.textFormula,width:135}],itemTemplate:_.template(['<div id="<%= id %>" class="list-item" style="width: 100%;display:inline-block;">','<div class="padding-right-5" style="width:70px;"><%= Common.Utils.String.htmlEncode(book) %></div>','<div class="padding-right-5" style="width:70px;"><%= Common.Utils.String.htmlEncode(sheet) %></div>','<div class="padding-right-5" style="width:70px;"><%= Common.Utils.String.htmlEncode(name) %></div>','<div class="padding-right-5" style="width:70px;"><%= cell %></div>','<div class="padding-right-5" style="width:110px;" data-toggle="tooltip"><%= Common.Utils.String.htmlEncode(value) %></div>','<div style="width:135px;" data-toggle="tooltip"><%= formula %></div>',"</div>"].join("")),tabindex:1}),this.watchList.on("item:select",_.bind(this.onSelectWatch,this)).on("item:deselect",_.bind(this.onSelectWatch,this)).on("item:keydown",_.bind(this.onKeyDown,this)).on("item:dblclick",_.bind(this.onDblClickWatch,this)).on("entervalue",_.bind(this.onEnterValue,this)).on("item:add",_.bind(this.addTooltips,this)).on("item:change",_.bind(this.addTooltips,this)).on("reset:before",_.bind(this.resetItemsBefore,this)),this.btnAdd=new Common.UI.Button({el:$("#watch-dialog-btn-add",this.$window)}),this.btnAdd.on("click",_.bind(this.onAddWatch,this,!1)),this.btnDelete=new Common.UI.Button({parentEl:$("#watch-dialog-btn-delete",this.$window),cls:"btn-text-split-default auto",caption:this.textDelete,split:!0,menu:new Common.UI.Menu({style:"min-width:100px;",items:[{caption:this.textDelete,value:0},{caption:this.textDeleteAll,value:1}]})}),$(this.btnDelete.cmpEl.find("button")[0]).css("min-width","87px"),this.btnDelete.on("click",_.bind(this.onDeleteWatch,this)),this.btnDelete.menu.on("item:click",_.bind(this.onDeleteMenu,this)),this.afterRender()},afterRender:function(){this._setDefaults()},getFocusedComponents:function(){return[this.btnAdd,this.btnDelete,this.watchList]},getDefaultFocusableComponent:function(){return this.watchList},_setDefaults:function(t){this.refreshList(),this.api.asc_registerCallback("asc_onUpdateCellWatches",this.wrapEvents.onRefreshWatchList)},refreshList:function(t){if(t)for(var e in t){var i;t.hasOwnProperty(e)&&(i=parseInt(e),e=t[e],s=this.watchList.store,0<=i&&i<s.length&&s.at(i).set({book:e.asc_getWorkbook(),sheet:e.asc_getSheet(),name:e.asc_getName(),cell:e.asc_getCell(),value:e.asc_getValue(),formula:e.asc_getFormula(),props:e}))}else{var s,o,n=[];if(t=this.api.asc_getCellWatches())for(var a=0;a<t.length;a++){var l=t[a];n.push({book:l.asc_getWorkbook(),sheet:l.asc_getSheet(),name:l.asc_getName(),cell:l.asc_getCell(),value:l.asc_getValue(),formula:l.asc_getFormula(),props:l})}this.watchList.store.reset(n),void 0!==this._deletedIndex&&(0<(s=this.watchList.store).length&&this.watchList.selectByIndex(this._deletedIndex<s.length?this._deletedIndex:s.length-1),(o=this.watchList.getSelectedRec())&&0<o.length&&this.watchList.scrollToRecord(o[0]),this._fromKeyDown&&this.watchList.focus(),this._fromKeyDown=!1,this._deletedIndex=void 0),this.updateButtons()}},onAddWatch:function(){var t,e,i=this;i.api&&(t=new SSE.Views.CellRangeDialog({handler:function(t,e){"ok"==e&&i.api.asc_addCellWatches(t.getSettings())}}).on("close",function(){i.show()}),e=i.$window.offset(),i.hide(),t.show(e.left+65,e.top+77),t.setSettings({api:i.api,range:i.api.asc_getEscapeSheetName(i.api.asc_getWorksheetName(i.api.asc_getActiveWorksheetIndex()))+"!"+i.api.asc_getActiveRangeStr(Asc.referenceType.A),type:Asc.c_oAscSelectionDialogType.Chart}))},onDeleteWatch:function(){var i,s=this,t=this.watchList.getSelectedRec();t&&(i=[],_.each(t,function(t,e){s._deletedIndex=s.watchList.store.indexOf(t)-i.length,i[e]=t.get("props")}),this.api.asc_deleteCellWatches(i))},onDeleteMenu:function(t,e){1==e.value?this.api.asc_deleteCellWatches(void 0,!0):this.onDeleteWatch()},onSelectWatch:function(t,e,i){this.updateButtons()},onDblClickWatch:function(t,e,i){i&&this.api.asc_findCell("'"+i.get("sheet")+"'!"+i.get("cell"))},onEnterValue:function(t,e){0!==this.watchList.store.length&&e&&this.api.asc_findCell("'"+e.get("sheet")+"'!"+e.get("cell"))},onKeyDown:function(t,e,i){i.keyCode!=Common.UI.Keys.DELETE||this.btnDelete.isDisabled()||(this._fromKeyDown=!0,this.onDeleteWatch())},updateButtons:function(){var t=this.watchList.getSelectedRec();this.btnDelete.setDisabled(!(t&&0<t.length)),this.watchList.scroller&&this.watchList.scroller.update({alwaysVisibleY:!0})},close:function(){this.api.asc_unregisterCallback("asc_onUpdateCellWatches",this.wrapEvents.onRefreshWatchList),Common.Views.AdvancedSettingsWindow.prototype.close.call(this)},resetItemsBefore:function(t){t.dataViewItems&&_.each(t.dataViewItems,function(t){t.tipsArray&&t.tipsArray.forEach(function(t){t&&(void 0===t.dontShow&&(t.dontShow=!0),t.tip().remove())})},this)},addTooltips:function(t,e,i){e.tipsArray&&e.tipsArray.forEach(function(t){t&&(void 0===t.dontShow&&(t.dontShow=!0),t.tip().remove())});var s=document.createElement("span"),o=(s.style.fontSize=document.documentElement.style.getPropertyValue("--font-size-base-app-custom")||"11px",s.style.fontFamily=document.documentElement.style.getPropertyValue("--font-family-base-custom")||'Arial, Helvetica, "Helvetica Neue", sans-serif',s.style.position="absolute",s.style.top="-1000px",s.style.left="-1000px",document.body.appendChild(s),$(e.el).find(".list-item > div"));this.checkTextOfItem(s,e,$(o[4]),i.get("value"),this.watchList.options.headers[4].width),this.checkTextOfItem(s,e,$(o[5]),i.get("formula"),this.watchList.options.headers[5].width),document.body.removeChild(s),e.tipsArray=[]},checkTextOfItem:function(t,e,i,s,o){t.innerHTML=Common.Utils.String.htmlEncode(s);var n=this.watchList;t.offsetWidth>o&&i.one("mouseenter",function(t){t=$(t.target);t.tooltip({title:s,placement:"cursor",zIndex:n.tipZIndex}),t.mouseenter(),e.tipsArray.push(t.data("bs.tooltip"))})}},SSE.Views.WatchDialog||{}))}),define("spreadsheeteditor/main/app/controller/FormulaDialog",["core","spreadsheeteditor/main/app/collection/FormulaGroups","spreadsheeteditor/main/app/view/FormulaDialog","spreadsheeteditor/main/app/view/FormulaTab","spreadsheeteditor/main/app/view/FormulaWizard","spreadsheeteditor/main/app/view/WatchDialog"],function(){"use strict";SSE.Controllers=SSE.Controllers||{},SSE.Controllers.FormulaDialog=Backbone.Controller.extend(_.extend({models:[],views:["FormulaDialog","FormulaTab"],collections:["FormulaGroups"],initialize:function(){var e=this;e.langJson={},e.langDescJson={},this.addListeners({FileMenu:{"settings:apply":function(){e.needUpdateFormula=!0;var t=Common.localStorage.getItem("sse-settings-func-locale");Common.Utils.InternalSettings.set("sse-settings-func-locale",t),e.formulasGroups.reset(),e.reloadTranslations(t)}},FormulaTab:{"function:apply":this.applyFunction,"function:calculate":this.onCalculate,"function:watch":this.onWatch,"function:precedents":this.onPrecedents,"function:dependents":this.onDependents,"function:remove-arrows":this.onRemArrows,"function:showformula":this.onShowFormula},Toolbar:{"function:apply":this.applyFunction,"tab:active":this.onTabActive},Statusbar:{"sheet:changed":this.onApiSheetChanged.bind(this)}})},applyFunction:function(t,e,i){t&&("more"===t.origin?this.showDialog(i):(e?this.api.asc_insertInCell(t.name,Asc.c_oAscPopUpSelectorType.Func,!!e):this.api.asc_startWizard(t.name,this._cleanCell),e||this.updateLast10Formulas(t.origin)))},setConfig:function(t){return this.toolbar=t.toolbar,this.formulaTab=this.createView("FormulaTab",{toolbar:this.toolbar.toolbar,formulasGroups:this.formulasGroups}),this},setApi:function(t){if(this.api=t,this.formulasGroups){if(Common.Utils.InternalSettings.set("sse-settings-func-last",Common.localStorage.getItem("sse-settings-func-last")),this.reloadTranslations(Common.localStorage.getItem("sse-settings-func-locale")||this.appOptions.lang,!0),!this.mode.isEdit)return;var e=this;this.formulas=new SSE.Views.FormulaDialog({api:this.api,toolclose:"hide",formulasGroups:this.formulasGroups,handler:_.bind(this.applyFunction,this)}),this.formulas.on({hide:function(){e._cleanCell=void 0,e.api.asc_enableKeyEvents(!0)}})}return this.formulaTab&&(this.formulaTab.setApi(this.api),this.api.asc_registerCallback("asc_onWorksheetLocked",this.onWorksheetLocked.bind(this)),this.api.asc_registerCallback("asc_onSheetsChanged",this.onApiSheetChanged.bind(this)),this.api.asc_registerCallback("asc_onUpdateFormulasViewSettings",this.onUpdateFormulasViewSettings.bind(this)),this.onApiSheetChanged()),this.api.asc_registerCallback("asc_onSendFunctionWizardInfo",_.bind(this.onSendFunctionWizardInfo,this)),this},setMode:function(t){return this.mode=t,this},onLaunch:function(){this.formulasGroups=this.getApplication().getCollection("FormulaGroups"),SSE.Collections.formulasLangs=["en","be","bg","ca","zh","cs","da","nl","fi","fr","de","el","hu","hy","id","it","ja","ko","lv","lo","nb","pl","pt-br","pt","ro","ru","sk","sl","sv","es","tr","uk","vi"];Common.Gateway.on("init",this.loadConfig.bind(this))},loadConfig:function(t){this.appOptions={},this.appOptions.lang=t.config.lang},reloadTranslations:function(e,i){e=(e||"en").toLowerCase();var t=_.indexOf(SSE.Collections.formulasLangs,e),s=(t<0&&(e=e.split(/[\-_]/)[0],t=_.indexOf(SSE.Collections.formulasLangs,e)),e=0<=t?SSE.Collections.formulasLangs[t]:"en",this);Common.Utils.InternalSettings.set("sse-settings-func-locale",e),s.langJson[e]?(s.api.asc_setLocalization(s.langJson[e]),Common.NotificationCenter.trigger("formula:settings",this)):"en"==e?(s.api.asc_setLocalization(void 0),Common.NotificationCenter.trigger("formula:settings",this)):Common.Utils.loadConfig("resources/formula-lang/"+e+".json",function(t){"error"!=t&&(s.langJson[e]=t,s.api.asc_setLocalization(t),Common.NotificationCenter.trigger("formula:settings",this))}),this.mode.isEdit&&(s.langDescJson[e]?s.loadingFormulas(s.langDescJson[e],i):Common.Utils.loadConfig("resources/formula-lang/"+e+"_desc.json",function(t){"error"!=t?(s.langDescJson[e]=t,s.loadingFormulas(t,i)):Common.Utils.loadConfig("resources/formula-lang/en_desc.json",function(t){s.langDescJson[e]="error"!=t?t:null,s.loadingFormulas(s.langDescJson[e],i)})}))},getDescription:function(t){return t?(t=t.toLowerCase(),this.langDescJson[t]||null):""},showDialog:function(t,e){this.formulas&&(this.needUpdateFormula&&(this.needUpdateFormula=!1,this.formulas.$window&&this.formulas.fillFormulasGroups()),this._formulagroup=t,this._cleanCell=e,this.api.asc_startWizard())},onSendFunctionWizardInfo:function(t){var e,i;t?(i={name:e=t.asc_getName(),origin:e=this.api.asc_getFormulaNameByLocale(e),args:((i=this.getDescription(Common.Utils.InternalSettings.get("sse-settings-func-locale")))&&i[e]?i[e].a:"").replace(/[,;]/g,this.api.asc_getFunctionArgumentSeparator()),desc:i&&i[e]?i[e].d:""},new SSE.Views.FormulaWizard({api:this.api,lang:this.appOptions.lang,funcprops:i,props:t,handler:function(t,e,i){}}).show(),this._cleanCell=void 0):this.formulas.show(this._formulagroup),this._formulagroup=void 0},hideDialog:function(){this.formulas&&this.formulas.isVisible()&&this.formulas.hide()},updateLast10Formulas:function(t){var e=(e=Common.Utils.InternalSettings.get("sse-settings-func-last")||"SUM;AVERAGE;IF;HYPERLINK;COUNT;MAX;SIN;SUMIF;PMT;STDEV").split(";"),i=_.indexOf(e,t),i=(e.splice(i<0?e.length-1:i,1),e.unshift(t),e.join(";"));Common.localStorage.setItem("sse-settings-func-last",i),Common.Utils.InternalSettings.set("sse-settings-func-last",i),this.formulasGroups&&((t=this.formulasGroups.findWhere({name:"Last10"}))&&t.set("functions",this.loadingLast10Formulas(this.getDescription(Common.Utils.InternalSettings.get("sse-settings-func-locale")))),this.formulaTab&&this.formulaTab.updateRecent())},loadingLast10Formulas:function(t){for(var e=(Common.Utils.InternalSettings.get("sse-settings-func-last")||"SUM;AVERAGE;IF;HYPERLINK;COUNT;MAX;SIN;SUMIF;PMT;STDEV").split(";"),i=this.api.asc_getFunctionArgumentSeparator(),s=[],o=0;o<e.length;o++){var n=e[o];s.push(new SSE.Models.FormulaModel({index:o,group:"Last10",name:this.api.asc_getFormulaLocaleName(n),origin:n,args:(t&&t[n]?t[n].a:"").replace(/[,;]/g,i),desc:t&&t[n]?t[n].d:""}))}return s},loadingFormulas:function(t,e){var i,s,o,n=0,a=0,l=this.formulasGroups,r=null,c=0,d=0,h=null,p=[],m=null,u=null,g=this.api.asc_getFunctionArgumentSeparator();if(l&&(i="Last10",(u=new SSE.Models.FormulaGroup({name:i,index:c,store:l,caption:this["sCategory"+i]||i}))&&(u.set("functions",this.loadingLast10Formulas(t)),l.push(u),c+=1),i="All",(m=new SSE.Models.FormulaGroup({name:i,index:c,store:l,caption:this["sCategory"+i]||i}))&&(l.push(m),c+=1),m)){for(h=this.api.asc_getFormulasInfo(),n=0;n<h.length;n+=1){for(i=h[n].asc_getGroupName(),s=h[n].asc_getFormulasArray(),r=new SSE.Models.FormulaGroup({name:i,index:c,store:l,caption:this["sCategory"+i]||i}),c+=1,o=[],a=0;a<s.length;a+=1){var b=s[a].asc_getName(),b=new SSE.Models.FormulaModel({index:d,group:i,name:s[a].asc_getLocaleName(),origin:b,args:(t&&t[b]?t[b].a:"").replace(/[,;]/g,g),desc:t&&t[b]?t[b].d:""});d+=1,o.push(b),p.push(b)}r.set("functions",_.sortBy(o,function(t){return t.get("name")})),l.push(r)}m.set("functions",_.sortBy(p,function(t){return t.get("name")}))}e&&!this._formulasInited||!this.formulaTab||this.formulaTab.fillFunctions()},onTabActive:function(t){"formula"==t&&!this._formulasInited&&this.formulaTab&&(this.formulaTab.fillFunctions(),this._formulasInited=!0)},onCalculate:function(t){t=t.type;t!==Asc.c_oAscCalculateType.All&&t!==Asc.c_oAscCalculateType.ActiveSheet||this.api&&this.api.asc_calculate(t)},onWatch:function(t){var e;t?((e=this)._watchDlg=new SSE.Views.WatchDialog({api:this.api,handler:function(t){Common.NotificationCenter.trigger("edit:complete")}}),this._watchDlg.on("close",function(t){e.formulaTab.btnWatch.toggle(!1,!0),e._watchDlg=null,Common.NotificationCenter.trigger("edit:complete")}).show()):this._watchDlg&&this._watchDlg.close()},onPrecedents:function(t){this.api&&this.api.asc_TracePrecedents(),Common.NotificationCenter.trigger("edit:complete",this.toolbar)},onDependents:function(t){this.api&&this.api.asc_TraceDependents(),Common.NotificationCenter.trigger("edit:complete",this.toolbar)},onRemArrows:function(t){this.api&&this.api.asc_RemoveTraceArrows(t),Common.NotificationCenter.trigger("edit:complete",this.toolbar)},onShowFormula:function(t){this.api&&this.api.asc_setShowFormulas(!!t),Common.NotificationCenter.trigger("edit:complete")},onWorksheetLocked:function(t,e){t==this.api.asc_getActiveWorksheetIndex()&&this.formulaTab&&Common.Utils.lockControls(Common.enumLock.sheetLock,e,{array:[this.formulaTab.btnShowFormulas]})},onApiSheetChanged:function(){var t;!this.mode||!this.mode.isEdit||this.mode.isEditDiagram||this.mode.isEditMailMerge||this.mode.isEditOle||(this.formulaTab&&this.formulaTab.btnShowFormulas.toggle(this.api.asc_getShowFormulas(),!0),t=this.api.asc_getActiveWorksheetIndex(),this.onWorksheetLocked(t,this.api.asc_isWorksheetLockedOrDeleted(t)))},onUpdateFormulasViewSettings:function(){!this.mode||!this.mode.isEdit||this.mode.isEditDiagram||this.mode.isEditMailMerge||this.mode.isEditOle||this.formulaTab&&this.formulaTab.btnShowFormulas.toggle(this.api.asc_getShowFormulas(),!0)}},SSE.Controllers.FormulaDialog||{}))}),void 0===Common&&(Common={}),void 0===Common.UI&&(Common.UI={}),Common.UI.HintManager=new function(){function r(){y="",0===S&&Common.NotificationCenter.trigger("toolbar:collapse"),(0===x.length||$("#file-menu-panel").is(":visible")&&1===S)&&a(),0<x.length?(n||P(!0),f=!0,x.forEach(function(t){t.show()}),t=setInterval(function(){0<y.length&&(y="")},5e3)):f=!1,Common.NotificationCenter.trigger("hints:show",f,S)}function c(t){R(),x.length=0,void(w.length=0)!==t?S=t:S++}function g(t){return t.hasClass("disabled")||t.parent().hasClass("disabled")||t.attr("disabled")}function e(){w=[],I=[];var e=[],i=[],t=(_.isArray(v)?v.forEach(function(t){e=e.concat($(t).find("[data-hint="+S+"]").toArray()),i=i.concat($(t).find("[data-hint-title][data-hint="+S+"]").toArray())}):(e=$(v).find("[data-hint="+S+"]").toArray(),i=$(v).find("[data-hint-title][data-hint="+S+"]").toArray()),e.filter(function(t){return $(t).is(":visible")})),s=i.filter(function(t){return $(t).is(":visible")});if(t.length===s.length)t.forEach(function(t){t=$(t);if("en"!==h){var e=t.attr("data-hint-title").toLowerCase(),i=e.charAt(0);if(-1===p.indexOf(i)){for(var s="",o=0;o<e.length;o++){var n=e.charAt(o);s+=M(n)}t.attr("data-hint-title",s.toUpperCase())}}w.push(t)});else{var o=[],a=[];if(0===S)for(var n in D){n=D[n].charAt(0).toLowerCase(),n=(I.push(n),p.indexOf(n));a.indexOf(n)<0&&a.push(n)}o=t.length+(0===S?_.size(D):0)>p.length?(s.forEach(function(t){t=$(t).data("hint-title").charAt(0).toLowerCase(),t=M(t);I.indexOf(t)<0&&I.push(t)}),function(t){for(var e,i,s=p.slice(),o=0;p.length,!e;o++)-1===I.indexOf(p[o])&&(e=p[o],i=o);s[i]=e+p[0];for(o=0;s.length<t;o++)e+p[o]!==s[i]&&s.push(e+p[o]);return s}(t.length+(0===S?_.size(D):0))):p.slice(),0<i.length&&t.forEach(function(t){t=$(t);if(e=t.attr("data-hint-title")){var e,i=(e=e.toLowerCase()).charAt(0),s=m.indexOf(i);if(-1===s)n=p.indexOf(i),a.indexOf(n)<0&&a.push(n);else if(a.indexOf(s)<0&&a.push(s),"en"!==h){for(var o="",n=0;n<e.length;n++)o+=M(e.charAt(n));t.attr("data-hint-title",o.toUpperCase())}}});var l=0;t.forEach(function(t){for(t=$(t);-1!==a.indexOf(l);)l++;t.attr("data-hint-title")||l>o.length||(t.attr("data-hint-title",o[l].toUpperCase()),l++),w.push(t)})}}function i(t){if(!(Common.Utils.isIE||Common.UI.isMac&&Common.Utils.isGecko)&&(f&&F(),0<x.length&&U(),n&&P(!1),t&&(A=!0),0<$(".hint-div").length&&$(".hint-div").remove(),0<$("iframe").length))try{$("iframe").contents().find(".hint-div").remove()}catch(t){}}function s(t){E!==t&&(E=t)}var t,d,o,h="en",p=[],m=[],u=[],b=[],C=!1,f=!1,S=0,v=document,w=[],x=[],y="",A=!1,n=!1,T=!1,k=!1,E=!0,I=[],D={"scroll-right":"R","scroll-left":"V"},V=function(t,e){e?v=e:"esc"===t?0===S&&(v=document):v=k?[$(window.parent.document).find(".advanced-settings-dlg:visible")[0],window.document]:$("#file-menu-panel").is(":visible")?$("#file-menu-panel"):t&&t.closest(".hint-section")||document},P=function(t){o&&(n=t,o.asc_enableKeyEvents(!t))},F=function(){f=!1,x&&x.forEach(function(t){t.remove()}),clearInterval(t),Common.NotificationCenter.trigger("hints:show",!1)},M=function(t){var e;return-1===p.indexOf(t)&&(e=m.indexOf(t),t=p[e]),t},a=function(){var h=k?window.parent.innerHeight*Common.Utils.zoom():Common.Utils.innerHeight()-20,p=k?window.parent.innerWidth*Common.Utils.zoom():Common.Utils.innerWidth(),t=k?v[0]:v,m=0!==S&&0<$(t).length&&!k?$(t).offset().top:0,u=0!==S&&0<$(t).length&&!k?m+$(t).height():h;"toolbar"===$(t).prop("id")&&$(t).outerHeight()<$(t).find(".box-controls").outerHeight()&&(u+=$(t).find(".box-controls").outerHeight()),0===w.length&&e(),w.forEach(function(t,e){if(!g(t)){var i=0,s=p;if(!(!k&&"toolbar"===$(v).prop("id")&&0<$(v).find(".toolbar-mask").length||$("#about-menu-panel").is(":visible")&&"right-menu"===t.closest(".hint-section").prop("id"))){if(window.SSE&&"statusbar_bottom"===t.parent().prop("id")){var o=t.parent();if(t.offset().left>o.offset().left+o.width())return}0===S&&0<t.closest(".tabs.short").length&&(s=(i=(o=t.closest(".tabs.short")).offset().left)+o.width(),t.hasClass("scroll")||(i+=20,s-=20));var o=$('<div style="" class="hint-div">'+t.attr("data-hint-title")+"</div>"),n=t.attr("data-hint-direction"),a=(window.SSE&&!k&&9!==v.nodeType&&"toolbar"===v.prop("id")&&"data"===t.closest(".panel").attr("data-tab")&&(t.parent().hasClass("slot-sortdesc")||t.parent().hasClass("slot-btn-setfilter")?t.attr("data-hint-direction",n="top"):(t.parent().hasClass("slot-btn-clear-filter")||t.parent().hasClass("slot-sortasc"))&&t.attr("data-hint-direction",n="bottom")),h),l=($("#file-menu-panel").is(":visible")&&1<S&&($(".fms-flex-apply").is(":visible")||$("#fms-flex-apply").is(":visible"))&&t.closest(".fms-flex-apply").length<1&&t.closest("#fms-flex-apply").length<1&&(a=h-$(".fms-flex-apply").height()),t.attr("data-hint-offset")),r="big"===l?6:"medium"===l?4:"small"===l?2:0;if(r)switch(n){case"bottom":l=[-r,0];break;case"top":l=[r,0];break;case"right":l=[0,-r];break;case"left":l=[0,r]}else l=l?t.attr("data-hint-offset").split(",").map(function(t){return parseInt(t)}):[0,0];var c,d=t.offset(),n="left-top"===n?(c=d.top-10+l[0],d.left-10+l[1]):"top"===n?(c=d.top-18+l[0],d.left+(t.outerWidth()-18)/2+l[1]):"right"===n?(c=d.top+(t.outerHeight()-18)/2+l[0],d.left+t.outerWidth()+l[1]):"left"===n?(c=d.top+(t.outerHeight()-18)/2+l[0],d.left-18+l[1]):(c=d.top+t.outerHeight()+l[0],d.left+(t.outerWidth()-18)/2+l[1]);c<a&&n<p&&m<c&&c<u&&i<n&&n+18<s&&(o.css({top:c,left:n}),(k&&e<2?(o.css("z-index","1060"),$(window.parent.document.body)):$(document.body)).append(o)),x.push(o)}}})},R=function(){x&&x.forEach(function(t){t.remove()})},U=function(){S=$("#file-menu-panel").is(":visible")||k?1:0,V(),x.length=0,w.length=0};return{init:function(t){Common.Utils.isIE||Common.UI.isMac&&Common.Utils.isGecko||(o=t,t=Common.localStorage.getKeysFilter(),d=t&&t.length?t.split(",")[0]:"",Common.NotificationCenter.on({"app:ready":function(t){var n,t=t.lang?t.lang.toLowerCase():"en";n=t,cacheFiles={"../../common/main/resources/alphabetletters/alphabetletters.json":{en:["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],ru:["а","б","в","г","д","е","ж","з","и","й","к","л","м","н","о","п","р","с","т","у","ф","х","ц","ч","ш","щ","э","ю","я"]},"../../common/main/resources/alphabetletters/qwertyletters.json":{en:["q","w","e","r","t","y","u","i","o","p","[","]","a","s","d","f","g","h","j","k","l",";","'","z","x","c","v","b","n","m",",","."],ru:["й","ц","у","к","е","н","г","ш","щ","з","х","ъ","ф","ы","в","а","п","р","о","л","д","ж","э","я","ч","с","м","и","т","ь","б","ю"],de:["q","w","e","r","t","z","u","i","o","p","ü","a","s","d","f","g","h","j","k","l","ö","ä","z","x","c","v","b","n","m"],fr:["a","z","e","r","t","y","u","i","o","p","q","s","d","f","g","h","j","k","l","m","w","x","c","v","b","n"]}},Common.Utils.loadConfig2=function(t,e){e(cacheFiles[t])},Common.Utils.loadConfig2("../../common/main/resources/alphabetletters/alphabetletters.json",function(e){m=e.en;function t(t){return p=e[h=t]}var i=!!t(n)||(!!t(n.split(/[\-_]/)[0])||t("en"));if(i&&"en"!==h)for(var s in D){var o=M(D[s].toLowerCase());o&&(D[s]=o.toUpperCase())}return i}),Common.Utils.loadConfig2("../../common/main/resources/alphabetletters/qwertyletters.json",function(t){u=t[h],"en"!==h&&(b=t.en)}),T=!0},"hints:clear":i,"window:resize":i}),$("#editor_sdk").on("click",function(){i()}),$(document).on("mousedown",function(){i()}),$(document).on("keyup",function(t){t.keyCode!=Common.UI.Keys.ALT&&91!==t.keyCode||!C||window.SSE&&window.SSE.getController("Statusbar").getIsDragDrop()?f&&t.preventDefault():(t.preventDefault(),f?(F(),U(),n&&(n=!1,o.asc_enableKeyEvents(!0))):($("input:focus").blur(),S=$("#file-menu-panel").is(":visible")||k?1:0,V(),r())),C=!1}),$(document).on("keydown",function(t){if(f)if(t.preventDefault(),t.keyCode==Common.UI.Keys.ESC)setTimeout(function(){0===S?(F(),U(),P(!1)):(R(),x.length=0,w.length=0,S--,V("esc"),r())},10);else{var e,i=null,s=!1,o=t.keyCode;if(i=16!==o&&17!==o&&18!==o&&91!==o?"en"===h?47<o&&o<58||64<o&&o<91?String.fromCharCode(t.keyCode):null:/[.*+?^${}()|[\]\\]/g.test(t.key)?null:t.key:i){"en"===h||-1!==p.indexOf(i.toLowerCase())||-1!==(o=b.indexOf(i.toLowerCase()))&&(i=u[o]),y+=i.toUpperCase();for(var n=0;n<w.length;n++){var a=w[n];if(!g(a)){var l=a.attr("data-hint-title");if(new RegExp("^"+y).test(l)&&(s=!0),l===y){e=a;break}}}if(e){o=e.prop("tagName").toLowerCase();if(window.SSE&&"statusbar_bottom"===e.parent().prop("id"))F(),e.contextmenu(),U();else if("input"===o||"textarea"===o)F(),e.trigger(jQuery.Event("click",{which:1})),e.focus(),U();else if(e.hasClass("listview"))F(),e.focus(),U();else{if(A=!1,F(),!k&&"toolbar"===$(v).prop("id")&&0<$(v).find(".toolbar-mask").length)return void U();i=e.attr("content-target")&&!$("#"+e.attr("content-target")).is(":visible")||"slot-btn-chat"===e.parent().prop("id")&&!$("#left-panel-chat").is(":visible")||e.parent().hasClass("ribtab")&&!$("#toolbar").children(".toolbar").hasClass("expanded");if((e.attr("content-target")||"slot-btn-chat"===e.parent().prop("id"))&&!i||$("#file-menu-panel").is(":visible")&&("fm-btn-info"===e.parent().prop("id")&&$("#panel-info").is(":visible")||"fm-btn-settings"===e.parent().prop("id")&&$("#panel-settings").is(":visible"))||(e.attr("for")?$("#"+e.attr("for")).trigger(jQuery.Event("click",{which:1})):(e.trigger(jQuery.Event("click",{which:1})),i&&(A=!1))),"btn-go-back"===e.prop("id")||"slot-btn-options"===e.closest(".btn-slot").prop("id")||"slot-btn-mode"===e.closest(".btn-slot").prop("id")||"id-btn-favorite"===e.prop("id")||"tlb-box-users"===e.parent().prop("id")||"left-btn-thumbs"===e.prop("id")||e.hasClass("scroll")||"left-btn-about"===e.prop("id")||"left-btn-support"===e.prop("id")||"slot-btn-search"===e.closest(".btn-slot").prop("id")||"slot-btn-pdf-mode"===e.closest(".btn-slot").prop("id"))return void U();if("add-comment-doc"===e.prop("id"))return R(),x.length=0,w.length=0,void r();A||("slot-btn-chat"===e.parent().prop("id")?(c(1),V(void 0,$("#left-menu.hint-section"))):("id-right-menu-signature"===e.prop("id")?c(2):c(),V(e)),r(),x.length<1&&U())}}else s||(y="")}}C=Common.Utils.InternalSettings.get(d+"settings-show-alt-hints")&&!t.shiftKey&&t.keyCode==Common.UI.Keys.ALT&&!Common.Utils.ModalWindow.isVisible()&&T&&0<p.length&&!(window.PE&&$("#pe-preview").is(":visible")),Common.Utils.InternalSettings.get(d+"settings-show-alt-hints")&&t.altKey&&115!==t.keyCode&&E&&t.preventDefault()}))},setMode:function(t){k=t.isEditDiagram||t.isEditMailMerge||t.isEditOle,s(!!k)},clearHints:i,needCloseFileMenu:function(){return!(f&&1<S)},isHintVisible:function(){return f},getStaticHint:function(t){return D[t]},setInternalEditorLoading:s}},define("common/main/lib/controller/HintManager",function(){}),void 0===Common&&(Common={}),void 0===Common.UI&&(Common.UI={}),Common.UI.LayoutManager=new function(){function o(t,e,i){if(t=t||a,l&&t)for(var s in t)t.hasOwnProperty(s)&&("object"==typeof t[s]?o(t[s],e,(i||"")+s+"-"):!1===t[s]&&(s="[data-layout-name="+(i||"")+s+"]",(s=e?e.find(s):$(s))&&s.hide&&s.hide()))}function n(t,e,i){if(e=e||a,!l||!e)return!0;var s,o=!0;for(s in e)if(e.hasOwnProperty(s)&&("object"==typeof e[s]?o=n(t,e[s],(i||"")+s+"-"):t===(i||"")+s&&(o=e[s]),!1===o))return o;return o}var a,l;return{init:function(t,e){a=t,l=e},applyCustomization:o,isElementVisible:n,getInitValue:function(t){if(l&&a){for(var e=t.split("-"),i=0,s=a,i=0;i<e.length&&("object"==typeof s[e[i]]&&s[e[i]]);i++)s=s[e[i]];if(i===e.length)return"object"==typeof s&&s?s.mode:s}}}},Common.UI.FeaturesManager=new function(){var i,s;return{init:function(t,e){i=t,s=e},canChange:function(t,e){return!((s||e)&&i&&"object"==typeof i[t]&&i[t]&&!1===i[t].change)},getInitValue:function(t,e){if((s||e)&&i&&void 0!==i[t])return"object"==typeof i[t]&&i[t]?void 0!==i[t].mode?i[t].mode:void 0:i[t]}}},define("common/main/lib/controller/LayoutManager",function(){}),void 0===Common&&(Common={}),void 0===Common.UI&&(Common.UI={}),Common.UI.ExternalUsers=new function(){var i=[],s=!1;return{init:function(t){t&&(Common.Gateway.on("setusers",function(t){var e;null===t.users?i=[]:(e=t.c||"mention",i[e]=t.users||[],s=!1,Common.NotificationCenter.trigger("mentions:setusers",e,i[e]))}),Common.NotificationCenter.on("mentions:clearusers",function(){i=[]}))},get:function(t){s||(void 0===i[t=t||"mention"]?(s=!0,Common.Gateway.requestUsers(t||"mention")):Common.NotificationCenter.trigger("mentions:setusers",t,i[t]))}}},define("common/main/lib/controller/ExternalUsers",function(){}),define("spreadsheeteditor/main/app/controller/Main",["core","irregularstack","common/main/lib/component/Window","common/main/lib/component/LoadMask","common/main/lib/component/Tooltip","common/main/lib/controller/Fonts","common/main/lib/collection/TextArt","common/main/lib/view/OpenDialog","common/main/lib/view/UserNameDialog","common/main/lib/util/LanguageInfo","common/main/lib/util/LocalStorage","spreadsheeteditor/main/app/collection/ShapeGroups","spreadsheeteditor/main/app/collection/TableTemplates","spreadsheeteditor/main/app/collection/EquationGroups","spreadsheeteditor/main/app/collection/ConditionalFormatIcons","spreadsheeteditor/main/app/controller/FormulaDialog","common/main/lib/controller/FocusManager","common/main/lib/controller/HintManager","common/main/lib/controller/LayoutManager","common/main/lib/controller/ExternalUsers"],function(){"use strict";var e,i;SSE.Controllers.Main=Backbone.Controller.extend(_.extend((e={about:"button#left-btn-about",feedback:"button#left-btn-support",goback:"#fm-btn-back > a, #header-back > div"},i={toolbar:"#viewport #toolbar",leftMenu:"#viewport #left-menu, #viewport #id-toolbar-full-placeholder-btn-settings, #viewport #id-toolbar-short-placeholder-btn-settings",rightMenu:"#viewport #right-menu",statusBar:"#statusbar"},Common.localStorage.setId("table"),Common.localStorage.setKeysFilter("sse-,asc.table"),Common.localStorage.sync(),{models:[],collections:["ShapeGroups","EquationGroups","TableTemplates","ConditionalFormatIcons","ConditionalFormatIconsPresets","Common.Collections.TextArt","Common.Collections.HistoryUsers"],views:[],initialize:function(){this.addListeners({FileMenu:{"settings:apply":_.bind(this.applySettings,this)},"Common.Views.ReviewChanges":{"settings:apply":_.bind(this.applySettings,this)}});var e=this,i={Series:this.txtSeries,"Diagram Title":this.txtDiagramTitle,"X Axis":this.txtXAxis,"Y Axis":this.txtYAxis,"Your text here":this.txtArt,Table:this.txtTable,Print_Area:this.txtPrintArea,Confidential:this.txtConfidential,"Prepared by ":this.txtPreparedBy+" ",Page:this.txtPage,"Page %1 of %2":this.txtPageOf,Pages:this.txtPages,Date:this.txtDate,Time:this.txtTime,Tab:this.txtTab,File:this.txtFile,Column:this.txtColumn,Row:this.txtRow,"%1 of %2":this.txtByField,"(All)":this.txtAll,Values:this.txtValues,"Grand Total":this.txtGrandTotal,"Row Labels":this.txtRowLbls,"Column Labels":this.txtColLbls,"Multi-Select (Alt+S)":this.txtMultiSelect+Common.Utils.String.platformKey("Alt+S"," ("+(Common.Utils.isMac?Common.Utils.String.textCtrl+"+":"")+"{0})"),"Clear Filter (Alt+C)":this.txtClearFilter+Common.Utils.String.platformKey("Alt+C"," ("+(Common.Utils.isMac?Common.Utils.String.textCtrl+"+":"")+"{0})"),"(blank)":this.txtBlank,Group:this.txtGroup,Seconds:this.txtSeconds,Minutes:this.txtMinutes,Hours:this.txtHours,Days:this.txtDays,Months:this.txtMonths,Quarters:this.txtQuarters,Years:this.txtYears,"%1 or %2":this.txtOr,Qtr:this.txtQuarter,Text:this.textText,Sheet:this.txtSheet,None:this.txtNone,Slicer:this.txtSlicer,Info:this.txtInfo,Picture:this.txtPicture,"(Multiple Items)":this.txtMultipleItems,Sum:this.txtSum,Count:this.txtCount,Average:this.txtAverage,Max:this.txtMax,Min:this.txtMin,Product:this.txtProduct,CountNums:this.txtCountNums,StdDev:this.txtStdDev,StdDevp:this.txtStdDevp,Var:this.txtVar,Varp:this.txtVarp};["Normal","Neutral","Bad","Good","Input","Output","Calculation","Check Cell","Explanatory Text","Note","Linked Cell","Warning Text","Heading 1","Heading 2","Heading 3","Heading 4","Title","Total","Currency","Percent","Comma"].forEach(function(t){i[t]=e["txtStyle_"+t.replace(/ /g,"_")]||t}),i["Currency [0]"]=e.txtStyle_Currency+" [0]",i["Comma [0]"]=e.txtStyle_Comma+" [0]";for(var t=1;t<7;t++)i["Accent"+t]=e.txtAccent+t,i["20% - Accent"+t]="20% - "+e.txtAccent+t,i["40% - Accent"+t]="40% - "+e.txtAccent+t,i["60% - Accent"+t]="60% - "+e.txtAccent+t;e.translationTable=i},onLaunch:function(){var t,i=this;this._state={isDisconnected:!1,usersCount:1,fastCoauth:!0,lostEditingRights:!1,licenseType:!1,isDocModified:!1},Common.Utils.isBrowserSupported()?(this.api=this.getApplication().getController("Viewport").getApi(),Common.UI.FocusManager.init(),Common.UI.HintManager.init(this.api),Common.UI.Themes.init(this.api),t=Common.localStorage.getBool("sse-settings-cachemode",!0),Common.Utils.InternalSettings.set("sse-settings-cachemode",t),this.api.asc_setDefaultBlitMode(!!t),t=Common.localStorage.getItem("sse-settings-fontrender"),Common.Utils.InternalSettings.set("sse-settings-fontrender",t=null===t?"3":t),this.api.asc_setFontRenderingMode(parseInt(t)),t=Common.localStorage.getBool("sse-settings-show-alt-hints",!0),Common.Utils.InternalSettings.set("sse-settings-show-alt-hints",t),Common.Utils.isIE||/^https?:\/\//.test("https://helpcenter.onlyoffice.com/userguides/docs-se.aspx")&&((t=new URL("https://helpcenter.onlyoffice.com/userguides/docs-se.aspx")).searchParams&&t.searchParams.set("lang",Common.Locale.getCurrentLanguage()),Common.Utils.InternalSettings.set("url-help-center",t.toString())),this.api.asc_registerCallback("asc_onOpenDocumentProgress",_.bind(this.onOpenDocument,this)),this.api.asc_registerCallback("asc_onEndAction",_.bind(this.onLongActionEnd,this)),this.api.asc_registerCallback("asc_onError",_.bind(this.onError,this)),this.api.asc_registerCallback("asc_onCoAuthoringDisconnect",_.bind(this.onCoAuthoringDisconnect,this)),this.api.asc_registerCallback("asc_onAdvancedOptions",_.bind(this.onAdvancedOptions,this)),this.api.asc_registerCallback("asc_onDocumentUpdateVersion",_.bind(this.onUpdateVersion,this)),this.api.asc_registerCallback("asc_onServerVersion",_.bind(this.onServerVersion,this)),this.api.asc_registerCallback("asc_onDocumentName",_.bind(this.onDocumentName,this)),this.api.asc_registerCallback("asc_onPrintUrl",_.bind(this.onPrintUrl,this)),this.api.asc_registerCallback("asc_onMeta",_.bind(this.onMeta,this)),this.api.asc_registerCallback("asc_onSpellCheckInit",_.bind(this.loadLanguages,this)),this.api.asc_registerCallback("asc_onOleEditorReady",_.bind(this.onOleEditorReady,this)),this.api.asc_registerCallback("asc_onTriggerEvent",t=>{Common.Gateway._postMessage(t)}),this.api.asc_registerCallback("asc_onImageDoubleClick",(t,e)=>{log.verbose("asc_onImageDoubleClick: ",t,e)}),Common.NotificationCenter.on("api:disconnect",_.bind(this.onCoAuthoringDisconnect,this)),Common.NotificationCenter.on("goback",_.bind(this.goBack,this)),Common.NotificationCenter.on("namedrange:locked",_.bind(this.onNamedRangeLocked,this)),Common.NotificationCenter.on("protectedrange:locked",_.bind(this.onProtectedRangeLocked,this)),Common.NotificationCenter.on("download:cancel",_.bind(this.onDownloadCancel,this)),Common.NotificationCenter.on("download:advanced",_.bind(this.onAdvancedOptions,this)),Common.NotificationCenter.on("showmessage",_.bind(this.onExternalMessage,this)),Common.NotificationCenter.on("markfavorite",_.bind(this.markFavorite,this)),Common.NotificationCenter.on("protect:check",_.bind(this.checkProtectedRange,this)),Common.NotificationCenter.on("editing:disable",_.bind(this.onEditingDisable,this)),Common.NotificationCenter.on("showerror",_.bind(this.onError,this)),this.stackLongActions=new Common.IrregularStack({strongCompare:this._compareActionStrong,weakCompare:this._compareActionWeak}),this.stackLongActions.push({id:-254,type:Asc.c_oAscAsyncActionType.BlockInteraction}),this.stackDisableActions=new Common.IrregularStack({strongCompare:this._compareActionWeak,weakCompare:this._compareActionWeak}),this.stackMacrosRequests=[],this.isShowOpenDialog=!1,this.editorConfig={},Common.Gateway.on("init",_.bind(this.loadConfig,this)),Common.Gateway.on("showmessage",_.bind(this.onExternalMessage,this)),Common.Gateway.on("opendocument",_.bind(this.loadDocument,this)),Common.Gateway.on("asc_CloseFile",_.bind(this.asc_CloseFile,this)),Common.Gateway.on("asc_openDocument",_.bind(this.openDocument,this)),Common.Gateway.on("asc_setImageUrls",_.bind(this.asc_setImageUrls,this)),Common.Gateway.on("asc_openEmptyDocument",_.bind(this.api._openEmptyDocument,this.api)),Common.Gateway.on("asc_TextToColumns",_.bind(this.asc_TextToColumns,this)),Common.Gateway.on("asc_OpenCSV",_.bind(this.asc_OpenCSV,this)),Common.Gateway.on("asc_showPasswordDialog",()=>{this.api.asc_showPasswordDialog()}),Common.Gateway.on("asc_Alert",e=>{this.onLongActionEnd(Asc.c_oAscAsyncActionType.BlockInteraction,-256);var t=$.extend({},e);t.callback=t=>{e.button=t,Common.Gateway._postMessage({event:"onAlertOK",data:e})},Common.UI.alert(t)}),Common.Gateway.on("asc_Toast",t=>{const e=new Common.UI.SynchronizeTip({extCls:"no-arrow",placement:"bottom",target:$(".toolbar"),text:t.text,showLink:!1}).on("closeclick",function(){this.close()});e.show(),setTimeout(()=>{e.close()},t.duration||3e3)}),Common.Gateway.on("asc_trackEvent",t=>{Common.Analytics.send(t.gif,[i.document.fileType,t._referer])}),Common.Gateway.on("asc_setDocumentName",_.bind(this.onDocumentName,this)),Common.Gateway.on("asc_setUnchangedDocument",()=>{this.api.SetUnchangedDocument()}),Common.Gateway.on("asc_updateRecent",t=>{this.appOptions.recent=t.recent,Common.NotificationCenter.trigger("reset:recents",t.recent)}),Common.Gateway.on("internalcommand",_.bind(this.onInternalCommand,this)),Common.Gateway.on("grabfocus",_.bind(this.onGrabFocus,this)),Common.Gateway.appReady(),log.verbose("编辑器Ready","controller/Main/onLaunch/appReady()",Date.now()-window.__start),this.getApplication().getController("Viewport").setApi(this.api),$(document.body).on("focus","input, textarea:not(#ce-cell-content)",function(t){!0!==i.isAppDisabled&&t&&t.target&&!/area_id/.test(t.target.id)&&(/msg-reply/.test(t.target.className)?i.dontCloseDummyComment=!0:/textarea-control/.test(t.target.className)?i.inTextareaControl=!0:!Common.Utils.ModalWindow.isVisible()&&/form-control/.test(t.target.className)&&(i.inFormControl=!0))}),$(document.body).on("blur","input, textarea",function(t){!0===i.isAppDisabled||i.isFrameClosed||Common.Utils.ModalWindow.isVisible()&&!(0<$(".asc-window.enable-key-events:visible").length)||i.loadMask&&i.loadMask.isVisible()||(/form-control/.test(t.target.className)&&(i.inFormControl=!1),i.getApplication().getController("LeftMenu").getView("LeftMenu").getMenu("file").isVisible()&&0===$(".asc-window.enable-key-events:visible").length||t.relatedTarget&&(/area_id/.test(t.target.id)||"input"==t.target.localName&&0<$(t.target).parent().find(t.relatedTarget).length||"textarea"==t.target.localName&&0<$(t.target).closest(".asc-window").find(".dropdown-menu").find(t.relatedTarget).length||"input"==t.relatedTarget.localName&&/form-control/.test(t.relatedTarget.className)||"textarea"==t.relatedTarget.localName&&!/area_id/.test(t.relatedTarget.id))||Common.Utils.isIE&&t.originalEvent&&t.originalEvent.target&&/area_id/.test(t.originalEvent.target.id)&&t.originalEvent.target===t.originalEvent.srcElement||(Common.Utils.isLinux&&i.appOptions&&i.appOptions.isDesktopApp&&!t.relatedTarget&&t.originalEvent&&!t.originalEvent.sourceCapabilities||i.api.asc_enableKeyEvents(!0),/msg-reply/.test(t.target.className)?i.dontCloseDummyComment=!1:/textarea-control/.test(t.target.className)&&(i.inTextareaControl=!1)))}).on("dragover",function(t){t=t.originalEvent;if(t.target&&$(t.target).closest("#editor_sdk").length<1&&!$(t.target).is("#statusbar_bottom")&&!$.contains($("#statusbar_bottom"),$(t.target)))return t.preventDefault(),!(t.dataTransfer.dropEffect="none")}).on("dragstart",function(t){var e,t=t.originalEvent;t.target&&(0<(e=$(t.target)).closest(".combobox").length||0<e.closest(".dropdown-menu").length||0<e.closest(".input-field").length||0<e.closest(".spinner").length||0<e.closest(".textarea-field").length||0<e.closest(".ribtab").length||0<e.closest(".combo-dataview").length)&&t.preventDefault()}),Common.Utils.isChrome&&$(document.body).on("keydown","textarea",function(t){t.keyCode!==Common.UI.Keys.PAGEUP&&t.keyCode!==Common.UI.Keys.PAGEDOWN||setTimeout(function(){$("#viewport").scrollLeft(0),$("#viewport").scrollTop(0)},0)}),Common.NotificationCenter.on({"modal:show":function(t){Common.Utils.ModalWindow.show(),i.api.asc_enableKeyEvents(!1)},"modal:close":function(t){Common.Utils.ModalWindow.close(),Common.Utils.ModalWindow.isVisible()||i.api.asc_enableKeyEvents(!0)},"modal:hide":function(t){Common.Utils.ModalWindow.close(),Common.Utils.ModalWindow.isVisible()||i.api.asc_enableKeyEvents(!0)},"dataview:focus":function(t){},"dataview:blur":function(t){Common.Utils.ModalWindow.isVisible()||i.api.asc_enableKeyEvents(!0)},"menu:show":function(t){},"menu:hide":function(t,e){Common.Utils.ModalWindow.isVisible()||t&&t.cmpEl.hasClass("from-cell-edit")||e||(i.api.asc_InputClearKeyboardElement(),i.api.asc_enableKeyEvents(!0))},"edit:complete":_.bind(this.onEditComplete,this),"settings:unitschanged":_.bind(this.unitsChanged,this)}),this.initNames(),Common.util.Shortcuts.delegateShortcuts({shortcuts:{"command+s,ctrl+s,command+p,ctrl+p,command+k,ctrl+k,command+d,ctrl+d":_.bind(function(t){t.preventDefault(),t.stopPropagation()},this)}}),i.defaultTitleText="",i.warnNoLicense=i.warnNoLicense.replace(/%1/g,"ONLYOFFICE"),i.warnNoLicenseUsers=i.warnNoLicenseUsers.replace(/%1/g,"ONLYOFFICE"),i.textNoLicenseTitle=i.textNoLicenseTitle.replace(/%1/g,"ONLYOFFICE"),i.warnLicenseExceeded=i.warnLicenseExceeded.replace(/%1/g,"ONLYOFFICE"),i.warnLicenseUsersExceeded=i.warnLicenseUsersExceeded.replace(/%1/g,"ONLYOFFICE")):(Common.Utils.showBrowserRestriction(),Common.Gateway.reportError(void 0,this.unsupportedBrowserErrorText))},loadConfig:function(t){if(this.editorConfig=$.extend(this.editorConfig,t.config),this.appOptions={},this.appOptions.customization=this.editorConfig.customization,this.appOptions.canRenameAnonymous=!("object"==typeof this.appOptions.customization&&"object"==typeof this.appOptions.customization.anonymous&&!1===this.appOptions.customization.anonymous.request),this.appOptions.guestName="object"==typeof this.appOptions.customization&&"object"==typeof this.appOptions.customization.anonymous&&"string"==typeof this.appOptions.customization.anonymous.label&&""!==this.appOptions.customization.anonymous.label.trim()?Common.Utils.String.htmlEncode(this.appOptions.customization.anonymous.label):this.textGuest,this.appOptions.canRenameAnonymous&&(o=Common.localStorage.getItem("guest-username"),Common.Utils.InternalSettings.set("guest-username",o),Common.Utils.InternalSettings.set("save-guest-username",!!o)),this.appOptions.customization.font){if(this.appOptions.customization.font.name&&"string"==typeof this.appOptions.customization.font.name){for(var e=this.appOptions.customization.font.name.split(","),i=0;i<e.length;i++){var s=e[i].trim();s&&/[\s0-9\.]/.test(s)&&(e[i]="'"+s+"'")}document.documentElement.style.setProperty("--font-family-base-custom",e.join(","))}this.appOptions.customization.font.size&&(t=parseInt(this.appOptions.customization.font.size),isNaN(t)||document.documentElement.style.setProperty("--font-size-base-app-custom",t+"px"))}this.editorConfig.user=this.appOptions.user=Common.Utils.fillUserInfo(this.editorConfig.user,this.editorConfig.lang,o?o+" ("+this.appOptions.guestName+")":this.textAnonymous,Common.localStorage.getItem("guest-id")||"uid-"+Date.now()),this.appOptions.user.anonymous&&Common.localStorage.setItem("guest-id",this.appOptions.user.id),this.appOptions.isDesktopApp="desktop"==this.editorConfig.targetApp,this.appOptions.canCreateNew=this.editorConfig.canRequestCreateNew||!_.isEmpty(this.editorConfig.createUrl)||this.editorConfig.templates&&this.editorConfig.templates.length,this.appOptions.canOpenRecent=void 0!==this.editorConfig.recent&&!this.appOptions.isDesktopApp,this.appOptions.templates=this.editorConfig.templates,this.appOptions.recent=this.editorConfig.recent,this.appOptions.createUrl=this.editorConfig.createUrl,this.appOptions.canRequestCreateNew=this.editorConfig.canRequestCreateNew,this.appOptions.lang=this.editorConfig.lang,this.appOptions.location="string"==typeof this.editorConfig.location?this.editorConfig.location.toLowerCase():"",this.appOptions.region="string"==typeof this.editorConfig.region?this.editorConfig.region.toLowerCase():this.editorConfig.region,this.appOptions.canAutosave=!1,this.appOptions.canAnalytics=!1,this.appOptions.sharingSettingsUrl=this.editorConfig.sharingSettingsUrl,this.appOptions.saveAsUrl=this.editorConfig.saveAsUrl,this.appOptions.fileChoiceUrl=this.editorConfig.fileChoiceUrl,this.appOptions.isEditDiagram="editdiagram"==this.editorConfig.mode,this.appOptions.isEditMailMerge="editmerge"==this.editorConfig.mode,this.appOptions.isEditOle="editole"==this.editorConfig.mode,this.appOptions.canRequestClose=this.editorConfig.canRequestClose,this.appOptions.canBackToFolder=!1!==this.editorConfig.canBackToFolder&&"object"==typeof this.editorConfig.customization&&"object"==typeof this.editorConfig.customization.goback&&(!_.isEmpty(this.editorConfig.customization.goback.url)||this.editorConfig.customization.goback.requestClose&&this.appOptions.canRequestClose),this.appOptions.canBack=!0===this.appOptions.canBackToFolder,this.appOptions.canPlugins=!1,this.appOptions.canRequestUsers=this.editorConfig.canRequestUsers,this.appOptions.canRequestSendNotify=this.editorConfig.canRequestSendNotify,this.appOptions.canRequestSaveAs=this.editorConfig.canRequestSaveAs,this.appOptions.canRequestInsertImage=this.editorConfig.canRequestInsertImage,this.appOptions.compatibleFeatures="object"==typeof this.appOptions.customization&&!!this.appOptions.customization.compatibleFeatures,this.appOptions.canRequestSharingSettings=this.editorConfig.canRequestSharingSettings,this.appOptions.mentionShare=!("object"==typeof this.appOptions.customization&&0==this.appOptions.customization.mentionShare),this.appOptions.canMakeActionLink=this.editorConfig.canMakeActionLink,this.appOptions.canFeaturePivot=!0,this.appOptions.canFeatureViews=!0,this.appOptions.uiRtl=!1,this.appOptions.canRequestReferenceData=this.editorConfig.canRequestReferenceData,this.appOptions.canRequestOpen=this.editorConfig.canRequestOpen,this.appOptions.canRequestReferenceSource=this.editorConfig.canRequestReferenceSource,!this.appOptions.user.guest||!this.appOptions.canRenameAnonymous||this.appOptions.isEditDiagram||this.appOptions.isEditMailMerge||this.appOptions.isEditOle||Common.NotificationCenter.on("user:rename",_.bind(this.showRenameUserDialog,this)),this.headerView=this.getApplication().getController("Viewport").getView("Common.Views.Header"),this.headerView.setCanBack(!0===this.appOptions.canBackToFolder,this.appOptions.canBackToFolder?this.editorConfig.customization.goback.text:"");var o,t=Common.localStorage.getItem("sse-settings-reg-settings"),n=Common.localStorage.getBool("sse-settings-use-base-separator",!0),a=void 0,l=void 0;Common.Utils.InternalSettings.set("sse-settings-use-base-separator",n),n||(a=Common.localStorage.getItem("sse-settings-decimal-separator"),l=Common.localStorage.getItem("sse-settings-group-separator")),null!==t?this.api.asc_setLocale(parseInt(t),a,l):(t=this.appOptions.region,t=null!==(t=Common.util.LanguageInfo.getLanguages().hasOwnProperty(t)?t:Common.util.LanguageInfo.getLocalLanguageCode(t))?parseInt(t):this.editorConfig.lang?parseInt(Common.util.LanguageInfo.getLocalLanguageCode(this.editorConfig.lang)):1033,this.api.asc_setLocale(t,a,l)),Common.Utils.InternalSettings.set("sse-config-lang",this.editorConfig.lang),o=Common.localStorage.getBool("sse-settings-r1c1"),Common.Utils.InternalSettings.set("sse-settings-r1c1",o),this.api.asc_setR1C1Mode(o),"us"!=this.appOptions.location&&"ca"!=this.appOptions.location||Common.Utils.Metric.setDefaultMetric(Common.Utils.Metric.c_MetricUnits.inch),this.editorConfig.customization&&(this.editorConfig.customization.toolbarNoTabs||"desktop"!==this.editorConfig.targetApp&&(this.editorConfig.customization.loaderName||this.editorConfig.customization.loaderLogo))||($("#editor_sdk").append('<div class="doc-placeholder">'+'<div class="columns"></div>'.repeat(2)+"</div>"),window.__append_placeholder=Date.now(),log.verbose("开始显示骨架图")),o=null===(o=Common.localStorage.getItem("sse-macros-mode"))?"enable"==(o=this.editorConfig.customization?this.editorConfig.customization.macrosMode:"warn")?1:"disable"==o?2:0:parseInt(o),Common.Utils.InternalSettings.set("sse-macros-mode",o),o=Common.localStorage.getItem("sse-allow-macros-request"),Common.Utils.InternalSettings.set("sse-allow-macros-request",null!==o?parseInt(o):0),this.appOptions.wopi=this.editorConfig.wopi,this.headerView.setWopi(this.appOptions.wopi),this.isFrameClosed=this.appOptions.isEditDiagram||this.appOptions.isEditMailMerge||this.appOptions.isEditOle,Common.Controllers.Desktop.init(this.appOptions),Common.UI.HintManager.setMode(this.appOptions)},loadDocument:function(t){log.verbose("加载编辑器配置","controller/Main/loadDocument()",t),this.appOptions.spreadsheet=t.doc,this.appOptions.document=this.document=t.doc,this.permissions={};var e,i,s={};t.doc&&(this.permissions=_.extend(this.permissions,t.doc.permissions),e=$.extend({},t.doc.options,this.editorConfig.actionLink||{}),(i=new Asc.asc_CUserInfo).put_Id(this.appOptions.user.id),i.put_FullName(this.appOptions.user.fullname),i.put_IsAnonymousUser(!!this.appOptions.user.anonymous),(s=new Asc.asc_CDocInfo).put_Id(t.doc.key),s.put_Url(t.doc.url),s.put_DirectUrl(t.doc.directUrl),s.put_Title(t.doc.title),s.put_Format(t.doc.fileType),s.put_VKey(t.doc.vkey),s.put_Options(e),s.put_UserInfo(i),s.put_CallbackUrl(this.editorConfig.callbackUrl),s.put_Token(t.doc.token),s.put_Permissions(t.doc.permissions),s.put_EncryptedInfo(this.editorConfig.encryptionKeys),s.put_Lang(this.editorConfig.lang),s.put_Mode(this.editorConfig.mode),s.put_ReferenceData(t.doc.referenceData),e=this.editorConfig.coEditing&&"object"==typeof this.editorConfig.coEditing&&("view"!==this.editorConfig.mode||!1===this.editorConfig.coEditing.change)&&this.editorConfig.coEditing.mode||"fast",s.put_CoEditingMode(e),i=!this.editorConfig.customization||!1!==this.editorConfig.customization.macros,s.asc_putIsEnabledMacroses(!!i),i=!this.editorConfig.customization||!1!==this.editorConfig.customization.plugins,s.asc_putIsEnabledPlugins(!!i),this.headerView&&this.headerView.setDocumentCaption(t.doc.title),Common.Utils.InternalSettings.set("sse-doc-info-key",t.doc.key)),this.api.asc_registerCallback("asc_onGetEditorPermissions",_.bind(this.onEditorPermissions,this)),this.api.asc_registerCallback("asc_onLicenseChanged",_.bind(this.onLicenseChanged,this)),this.api.asc_registerCallback("asc_onMacrosPermissionRequest",_.bind(this.onMacrosPermissionRequest,this)),this.api.asc_registerCallback("asc_onRunAutostartMacroses",_.bind(this.onRunAutostartMacroses,this)),this.api.asc_setDocInfo(s),this.api.asc_getEditorPermissions(this.editorConfig.licenseUrl,this.editorConfig.customerId),Common.localStorage.setBool("sse-hide-quick-print-warning",!0),"_chart_"!=t.doc.url&&(this.api._onLicense({type:"license",license:{type:3,light:!0,rights:1,branding:!0,customization:!0}}),this.api._onAuth({type:"auth",result:1}),Common.component.Analytics.init("EXCEL",this.document))},asc_CloseFile:function(){try{this.api.asc_CloseFile()}catch(t){}},openDocument:function(t){this.api.asc_setLocalRestrictions(t.localRestrintions||0),this.api.onEndLoadFile({bSerFormat:!0,data:t.buf,originData:t.originBuffer})},asc_setImageUrls:function(t){AscCommon.g_oDocumentUrls.init(t.urls)},writeFile:function(t,e,i){Common.Gateway.off("asc_writeFileCallback"),Common.Gateway.on("asc_writeFileCallback",t=>{i(t,!0,"ok")}),Common.Gateway._postMessage({event:"writeFile",data:{file:t,data:e}})},asc_TextToColumns:function(t){var e=new Asc.asc_CTextOptions(46,4,null);e.asc_setNumberDecimalSeparator("."),e.asc_setNumberGroupSeparator(","),e.asc_setTextQualifier('"'),this.api.asc_TextToColumns(e,t.text,"$A$1")},asc_OpenCSV:function({buf:t}){var e=new FileReader;e.onload=t=>{t=t.target.result;this.asc_TextToColumns({text:t})},e.readAsText(new Blob([t.buffer]),"GBK")},onProcessSaveResult:function(t){this.api.asc_OnSaveEnd(t.result),t&&!1===t.result&&Common.UI.error({title:this.criticalErrorTitle,msg:_.isEmpty(t.message)?this.errorProcessSaveResult:t.message})},onProcessRightsChange:function(t){var e,i;t&&!1===t.enabled&&(i=(e=this)._state.lostEditingRights,this._state.lostEditingRights=!this._state.lostEditingRights,this.api.asc_coAuthoringDisconnect(),Common.NotificationCenter.trigger("collaboration:sharingdeny"),Common.NotificationCenter.trigger("api:disconnect"),i||Common.UI.warning({title:this.notcriticalErrorTitle,maxwidth:600,msg:_.isEmpty(t.message)?this.warnProcessRightsChange:t.message,callback:function(){e._state.lostEditingRights=!1,e.onEditComplete()}}))},onDownloadAs:function(t){var e;this.appOptions.canDownload?(this._state.isFromGatewayDownloadAs=!0,t=t&&"string"==typeof t?Asc.c_oAscFileType[t.toUpperCase()]:null,e=[Asc.c_oAscFileType.XLSX,Asc.c_oAscFileType.ODS,Asc.c_oAscFileType.CSV,Asc.c_oAscFileType.PDF,Asc.c_oAscFileType.PDFA,Asc.c_oAscFileType.XLTX,Asc.c_oAscFileType.OTS,Asc.c_oAscFileType.XLSM,Asc.c_oAscFileType.JPG,Asc.c_oAscFileType.PNG],(t=!t||e.indexOf(t)<0?Asc.c_oAscFileType.XLSX:t)==Asc.c_oAscFileType.PDF||t==Asc.c_oAscFileType.PDFA?Common.NotificationCenter.trigger("download:settings",this,t,!0):this.api.asc_DownloadAs(new Asc.asc_CDownloadOptions(t,!0))):Common.Gateway.reportError(Asc.c_oAscError.ID.AccessDeny,this.errorAccessDeny)},onProcessMouse:function(t){var e,i;"mouseup"==t.type&&(e=document.getElementById("editor_sdk"))&&(e=e.getBoundingClientRect(),i=t.event||{},this.api.asc_onMouseUp(i,t.x-e.left,t.y-e.top))},onRequestClose:function(){var e=this;this.api.asc_isDocumentModified()?(this.api.asc_stopSaving(),Common.UI.warning({closable:!1,width:500,title:this.notcriticalErrorTitle,msg:this.leavePageTextOnClose,buttons:["ok","cancel"],primary:"ok",callback:function(t){"ok"==t?(e.api.asc_undoAllChanges(),e.api.asc_continueSaving(),Common.Gateway.requestClose()):e.api.asc_continueSaving()}})):Common.Gateway.requestClose()},goBack:function(t){var e;Common.Controllers.Desktop.process("goback")||(this.appOptions.customization.goback.requestClose&&this.appOptions.canRequestClose?this.onRequestClose():(e=this.appOptions.customization.goback.url,t||!1===this.appOptions.customization.goback.blank?parent.location.href=e:window.open(e,"_blank")))},markFavorite:function(t){Common.Controllers.Desktop.process("markfavorite")||Common.Gateway.metaChange({favorite:t})},onSetFavorite:function(t){this.appOptions.canFavorite&&this.headerView&&this.headerView.setFavorite(!!t)},onEditComplete:function(t,e){e&&e.restorefocus&&this.api.isCEditorFocused?(i=this,setTimeout(function(){i.formulaInput.blur(),i.formulaInput.focus()},0)):(this.getApplication().getController("DocumentHolder").getView("DocumentHolder").focus(),this.api.isCEditorFocused=!1);var i,e=this.getApplication(),s=e.getController("Toolbar").getView("Toolbar"),e=e.getController("RightMenu").getView("RightMenu");this.appOptions.isEdit&&(s&&s._isEyedropperStart||e&&e._isEyedropperStart)&&(s._isEyedropperStart?s._isEyedropperStart=!1:e._isEyedropperStart=!1,this.api.asc_cancelEyedropper()),Common.UI.HintManager.clearHints(!0)},onSelectionChanged:function(t){!t||this._isChartDataReady||t.asc_getSelectionType()!=Asc.c_oAscSelectionType.RangeChart||(this._isChartDataReady=!0,Common.Gateway.internalMessage("chartDataReady"))},onLongActionBegin:function(t,e){e={id:e,type:t};this.stackLongActions.push(e),this.setLongActionView(e)},onLongActionEnd:function(t,e){var i,s;this.stackLongActions.pop({id:e,type:t}),this.headerView&&this.headerView.setDocumentCaption(this.api.asc_getDocumentName()),this.updateWindowTitle(this.api.asc_isDocumentModified(),!0),t===Asc.c_oAscAsyncActionType.BlockInteraction&&e==Asc.c_oAscAsyncAction.Open&&(Common.Gateway.internalMessage("documentReady",{}),this.onDocumentContentReady()),(i=this.stackLongActions.get({type:Asc.c_oAscAsyncActionType.Information}))?this.setLongActionView(i):(s=this,e!=Asc.c_oAscAsyncAction.Save&&e!=Asc.c_oAscAsyncAction.ForceSaveButton||this.appOptions.isOffline?this.getApplication().getController("Statusbar").setStatusCaption(""):this._state.fastCoauth&&1<this._state.usersCount?s._state.timerSave=setTimeout(function(){s.getApplication().getController("Statusbar").setStatusCaption(s.textChangesSaved,!1,3e3)},500):s.getApplication().getController("Statusbar").setStatusCaption(s.textChangesSaved,!1,3e3)),e==Asc.c_oAscAsyncAction.Save&&this.synchronizeChanges(),(i=this.stackLongActions.get({type:Asc.c_oAscAsyncActionType.BlockInteraction}))?this.setLongActionView(i):(this.loadMask&&(!this.loadMask.isVisible()||this.dontCloseDummyComment||this.inTextareaControl||Common.Utils.ModalWindow.isVisible()||this.inFormControl||(this.appOptions.isEditMailMerge||this.appOptions.isEditDiagram||this.appOptions.isEditOle)&&Common.UI.HintManager.setInternalEditorLoading(!1),this.api.asc_enableKeyEvents(!0),this.loadMask.hide()),t!=Asc.c_oAscAsyncActionType.BlockInteraction||(e==Asc.c_oAscAsyncAction.LoadDocumentFonts||e==Asc.c_oAscAsyncAction.ApplyChanges)&&(this.dontCloseDummyComment||this.inTextareaControl||Common.Utils.ModalWindow.isVisible()||this.inFormControl)||this.onEditComplete(this.loadMask,{restorefocus:!0})),e==Asc.c_oAscAsyncAction.Disconnect&&(this._state.timerDisconnect&&clearTimeout(this._state.timerDisconnect),this.disableEditing(!1,!0),this.getApplication().getController("Statusbar").hideDisconnectTip(),this.getApplication().getController("Statusbar").setStatusCaption(this.textReconnect))},setLongActionView:function(t){var e="",i="",s=!1,o=null;switch(t.id){case Asc.c_oAscAsyncAction.Open:e=this.openTitleText,i=this.openTextText;break;case Asc.c_oAscAsyncAction.Save:case Asc.c_oAscAsyncAction.ForceSaveButton:case Asc.c_oAscAsyncAction.ForceSaveTimeout:clearTimeout(this._state.timerSave),s=!0,e=this.saveTitleText,i=this.appOptions.isOffline?"":this.saveTextText;break;case Asc.c_oAscAsyncAction.LoadDocumentFonts:e=this.loadFontsTitleText,i=this.loadFontsTextText;break;case Asc.c_oAscAsyncAction.LoadDocumentImages:e=this.loadImagesTitleText,i=this.loadImagesTextText;break;case Asc.c_oAscAsyncAction.LoadFont:e=this.loadFontTitleText,i=this.loadFontTextText;break;case Asc.c_oAscAsyncAction.LoadImage:e=this.loadImageTitleText,i=this.loadImageTextText;break;case Asc.c_oAscAsyncAction.DownloadAs:e=this.downloadTitleText,i=this.downloadTextText;break;case Asc.c_oAscAsyncAction.Print:e=this.printTitleText,i=this.printTextText;break;case Asc.c_oAscAsyncAction.UploadImage:e=this.uploadImageTitleText,i=this.uploadImageTextText;break;case Asc.c_oAscAsyncAction.SlowOperation:e=this.textPleaseWait,i=this.textPleaseWait;break;case Asc.c_oAscAsyncAction.Waiting:e=this.waitText,i=this.waitText;break;case-255:e=this.txtEditingMode,i=this.waitText;break;case-256:e=this.loadingDocumentTitleText+"           ",i=this.loadingDocumentTitleText;break;case Asc.c_oAscAsyncAction.Disconnect:e=this.textDisconnect,i=this.textDisconnect,Common.UI.Menu.Manager.hideAll(),this.disableEditing(!0,!0);var n=this,o=function(){n._state.timerDisconnect=setTimeout(function(){n.getApplication().getController("Statusbar").showDisconnectTip()},n._state.unloadTimer||0)};break;default:"string"==typeof t.id&&(e=t.id,i=t.id)}t.type==Asc.c_oAscAsyncActionType.BlockInteraction?(this.loadMask||(this.loadMask=new Common.UI.LoadMask({owner:$("#viewport")})),this.loadMask.setTitle(e),this.isShowOpenDialog||(this.api.asc_enableKeyEvents(!1),this.loadMask.show())):this.getApplication().getController("Statusbar").setStatusCaption(i,s,0,o)},onApplyEditRights:function(t){this.getApplication().getController("Statusbar").setStatusCaption(""),t&&!t.allowed&&Common.UI.info({title:this.requestEditFailedTitleText,msg:t.message||this.requestEditFailedMessageText})},onDocumentContentReady:function(){var e,t,i,s,o,n,a,l,r,c,d,h,p,m,u;function g(){var t;window.AscDesktopEditor||(t=[],Common.Utils.isIE9m&&t.push(e.warnBrowserIE9),t.length&&e.showTips(t)),document.removeEventListener("visibilitychange",g)}this._isDocReady||(this._state.openDlg&&this._state.openDlg.close(),(e=this)._isDocReady=!0,Common.NotificationCenter.trigger("app:ready",this.appOptions),e.hidePreloader(),e.onLongActionEnd(Asc.c_oAscAsyncActionType.BlockInteraction,-256),t=this.appOptions.isEditMailMerge||this.appOptions.isEditDiagram||this.appOptions.isEditOle?100:Common.localStorage.getItem("sse-settings-zoom"),Common.Utils.InternalSettings.set("sse-settings-zoom",t),o=null!==t?parseInt(t)/100:this.appOptions.customization&&this.appOptions.customization.zoom?parseInt(this.appOptions.customization.zoom)/100:1,n=null!==(t=Common.localStorage.getItem("sse-last-zoom"))?parseInt(t)/100:1,this.api.asc_setZoom(0<o?o:o<0&&0<n?n:1),this.isLiveCommenting=Common.localStorage.getBool("sse-settings-livecomment",!0),Common.Utils.InternalSettings.set("sse-settings-livecomment",this.isLiveCommenting),t=Common.localStorage.getBool("sse-settings-resolvedcomment"),Common.Utils.InternalSettings.set("sse-settings-resolvedcomment",t),this.isLiveCommenting?this.api.asc_showComments(t):this.api.asc_hideComments(),this._state.fastCoauth=Common.Utils.InternalSettings.get("sse-settings-coauthmode"),this.api.asc_SetFastCollaborative(e._state.fastCoauth),this.api.asc_setAutoSaveGap(Common.Utils.InternalSettings.get("sse-settings-autosave")),Common.UI.FeaturesManager.canChange("spellcheck")&&(o=Common.localStorage.getBool("sse-spellcheck-ignore-uppercase-words",!0),Common.Utils.InternalSettings.set("sse-spellcheck-ignore-uppercase-words",o),this.api.asc_ignoreUppercase(o),n=Common.localStorage.getBool("sse-spellcheck-ignore-numbers-words",!0),Common.Utils.InternalSettings.set("sse-spellcheck-ignore-numbers-words",n),this.api.asc_ignoreNumbers(n)),e.api.asc_registerCallback("asc_onStartAction",_.bind(e.onLongActionBegin,e)),e.api.asc_registerCallback("asc_onConfirmAction",_.bind(e.onConfirmAction,e)),e.api.asc_registerCallback("asc_onActiveSheetChanged",_.bind(e.onActiveSheetChanged,e)),e.api.asc_registerCallback("asc_onPrint",_.bind(e.onPrint,e)),e.api.asc_registerCallback("asc_onSave",_.bind(e.onSave,e)),e.api.asc_registerCallback("asc_writeFile",_.bind(e.writeFile,e)),i=e.getApplication(),e.headerView.setDocumentCaption(e.api.asc_getDocumentName()),e.updateWindowTitle(e.api.asc_isDocumentModified(),!0),s=i.getController("Toolbar"),o=i.getController("Statusbar"),n=i.getController("DocumentHolder"),a=i.getController("RightMenu"),p=i.getController("LeftMenu"),l=i.getController("CellEditor"),r=o.getView("Statusbar"),u=p.getView("LeftMenu"),c=n.getView("DocumentHolder"),i.getController("Common.Controllers.Chat"),i.getController("Common.Controllers.Plugins"),d=i.getController("Spellcheck"),u.getMenu("file").loadDocument({doc:e.appOptions.spreadsheet}),p.setMode(e.appOptions).createDelayedElements().setApi(e.api),e.appOptions.isEditMailMerge||e.appOptions.isEditDiagram||e.appOptions.isEditOle||(this.api&&this.api.asc_setFrozenPaneBorderType(Common.localStorage.getBool("sse-freeze-shadow",!0)?Asc.c_oAscFrozenPaneBorderType.shadow:Asc.c_oAscFrozenPaneBorderType.line),i.getController("Common.Controllers.ExternalOleEditor").setApi(this.api).loadConfig({config:this.editorConfig,customization:this.editorConfig.customization})),u.disableMenu("all",!1),n.setApi(e.api).loadConfig({config:e.editorConfig}),o.createDelayedElements(),o.setApi(e.api),c.setApi(e.api),r.update(),this.formulaInput=l.getView("CellEditor").$el.find("textarea"),e.appOptions.isEdit?(Common.UI.FeaturesManager.canChange("spellcheck")&&d.setApi(e.api).setMode(e.appOptions),e.appOptions.canForcesave&&(e.appOptions.forcesave=Common.localStorage.getBool("sse-settings-forcesave",e.appOptions.canForcesave),Common.Utils.InternalSettings.set("sse-settings-forcesave",e.appOptions.forcesave),e.api.asc_setIsForceSaveOnUserSave(e.appOptions.forcesave)),null===(t=Common.localStorage.getItem("sse-settings-paste-button"))&&(t="1"),Common.Utils.InternalSettings.set("sse-settings-paste-button",parseInt(t)),e.api.asc_setVisiblePasteButton(!!parseInt(t)),e.loadAutoCorrectSettings(),e.needToUpdateVersion&&(Common.NotificationCenter.trigger("api:disconnect"),s.onApiCoAuthoringDisconnect()),h=setInterval(function(){var t;(window.styles_loaded||e.appOptions.isEditDiagram||e.appOptions.isEditMailMerge||e.appOptions.isEditOle)&&(clearInterval(h),Common.NotificationCenter.trigger("comments:updatefilter",["doc","sheet"+e.api.asc_getActiveWorksheetId()]),c.createDelayedElements(),s.createDelayedElements(),e.setLanguages(),e.appOptions.isEditMailMerge||e.appOptions.isEditDiagram||e.appOptions.isEditOle?e.appOptions.isEditOle&&e.updateThemeColors():((t=e.api.asc_getPropertyEditorShapes())&&e.fillAutoShapes(t[0],t[1]),e.updateThemeColors(),s.activateControls()),a.createDelayedElements(),e.api.asc_registerCallback("asc_onDocumentCanSaveChanged",_.bind(e.onDocumentCanSaveChanged,e)),e.api.asc_registerCallback("asc_OnTryUndoInFastCollaborative",_.bind(e.onTryUndoInFastCollaborative,e)),e.onDocumentModifiedChanged(e.api.asc_isDocumentModified()),(t=i.getController("FormulaDialog"))&&t.setMode(e.appOptions).setApi(e.api),e.needToUpdateVersion&&s.onApiCoAuthoringDisconnect(),Common.NotificationCenter.trigger("document:ready","main"),e.applyLicense())},50)):((p=i.getController("FormulaDialog"))&&p.setMode(e.appOptions).setApi(e.api),c.createDelayedElementsViewer(),Common.NotificationCenter.trigger("document:ready","main"),e.applyLicense()),e.appOptions.isEditMailMerge||e.appOptions.isEditDiagram||e.appOptions.isEditOle||(m=~~(1e6*Math.random()),$(".toolbar").prepend(Common.Utils.String.format('<div class="lazy-{0} x-huge"><div class="toolbar__icon" style="position: absolute; width: 1px; height: 1px;"></div>',m)),setTimeout(function(){$(Common.Utils.String.format(".toolbar .lazy-{0}",m)).remove()},10)),e.appOptions.canAnalytics,Common.Gateway.on("applyeditrights",_.bind(e.onApplyEditRights,e)),Common.Gateway.on("processsaveresult",_.bind(e.onProcessSaveResult,e)),Common.Gateway.on("processrightschange",_.bind(e.onProcessRightsChange,e)),Common.Gateway.on("processmouse",_.bind(e.onProcessMouse,e)),Common.Gateway.on("downloadas",_.bind(e.onDownloadAs,e)),Common.Gateway.on("setfavorite",_.bind(e.onSetFavorite,e)),Common.Gateway.on("requestclose",_.bind(e.onRequestClose,e)),Common.Gateway.on("refreshhistory",_.bind(e.onRefreshHistory,e)),Common.Gateway.sendInfo({mode:e.appOptions.isEdit?"edit":"view"}),$(document).on("contextmenu",_.bind(e.onContextMenu,e)),void 0!==document.hidden&&document.hidden?document.addEventListener("visibilitychange",g):g(),Common.Gateway.documentReady(),u=Date.now()-window.__append_placeholder,log.debug("删除骨架图",Date.now()-window.__start,"骨架图显示时间：",u),Common.Analytics.trackPerf(u),!this.appOptions.user.guest||!this.appOptions.canRenameAnonymous||this.appOptions.isEditDiagram||this.appOptions.isEditMailMerge||this.appOptions.isEditOle||null!==Common.Utils.InternalSettings.get("guest-username")||this.showRenameUserDialog(),this._needToSaveAsFile&&this.getApplication().getController("LeftMenu").leftMenu.showMenu("file:saveas"))},onLicenseChanged:function(t){this.appOptions.isEditDiagram||this.appOptions.isEditMailMerge||this.appOptions.isEditOle||(void 0!==(t=t.asc_getLicenseType())&&(this.appOptions.canEdit||this.appOptions.isRestrictedEdit)&&"view"!==this.editorConfig.mode&&(t===Asc.c_oLicenseResult.Connections||t===Asc.c_oLicenseResult.UsersCount||t===Asc.c_oLicenseResult.ConnectionsOS||t===Asc.c_oLicenseResult.UsersCountOS||t===Asc.c_oLicenseResult.SuccessLimit&&0!=(this.appOptions.trialMode&Asc.c_oLicenseMode.Limited))&&(this._state.licenseType=t),void 0===t||!this.appOptions.canLiveView||t!==Asc.c_oLicenseResult.ConnectionsLive&&t!==Asc.c_oLicenseResult.ConnectionsLiveOS&&t!==Asc.c_oLicenseResult.UsersViewCount&&t!==Asc.c_oLicenseResult.UsersViewCountOS||(this._state.licenseType=t),this._isDocReady&&this.applyLicense())},applyLicense:function(){},disableEditing:function(t,e){Common.NotificationCenter.trigger("editing:disable",t,{viewMode:t,allowSignature:!1,allowProtect:!1,rightMenu:{clear:!e,disable:!0},statusBar:!0,leftMenu:{disable:!0,previewMode:!0},fileMenu:{protect:!0,history:e},comments:{disable:!e,previewMode:!0},chat:!0,review:!0,viewport:!0,documentHolder:{clear:!e,disable:!0},toolbar:!0,celleditor:{previewMode:!0}},e?"reconnect":"disconnect")},onEditingDisable:function(t,e,i){var s=this.getApplication(),o={type:i,disable:t,options:e},o=(t&&!this.stackDisableActions.get({type:i})&&this.stackDisableActions.push(o),t||this.stackDisableActions.pop({type:i}),!t&&0<this.stackDisableActions.length()?this.stackDisableActions.get(this.stackDisableActions.length()-1):null);e.rightMenu&&s.getController("RightMenu")&&(e.rightMenu.clear&&s.getController("RightMenu").getView("RightMenu").clearSelection(),e.rightMenu.disable&&s.getController("RightMenu").SetDisabled(t,e.allowSignature)),e.statusBar&&s.getController("Statusbar").SetDisabled(t),e.review&&s.getController("Common.Controllers.ReviewChanges").SetDisabled(t),e.viewport&&s.getController("Viewport").SetDisabled(t),e.toolbar&&s.getController("Toolbar").DisableToolbar(t,e.viewMode),e.documentHolder&&(e.documentHolder.clear&&s.getController("DocumentHolder").clearSelection(),e.documentHolder.disable&&s.getController("DocumentHolder").SetDisabled(t,e.allowProtect)),e.leftMenu&&(e.leftMenu.disable&&s.getController("LeftMenu").SetDisabled(t,e),e.leftMenu.previewMode&&s.getController("LeftMenu").setPreviewMode(t)),e.fileMenu&&(s.getController("LeftMenu").leftMenu.getMenu("file").SetDisabled(t,e.fileMenu),e.leftMenu.disable&&s.getController("LeftMenu").leftMenu.getMenu("file").applyMode()),e.comments&&(i=this.getApplication().getController("Common.Controllers.Comments"))&&e.comments.previewMode&&i.setPreviewMode(t),e.celleditor&&e.celleditor.previewMode&&s.getController("CellEditor").setPreviewMode(t),o&&this.onEditingDisable(o.disable,o.options,o.type)},disableLiveViewing:function(t){this.appOptions.canLiveView=!t,this.api.asc_SetFastCollaborative(!t),Common.Utils.InternalSettings.set("sse-settings-coauthmode",!t)},onOpenDocument:function(t){},onEditorPermissions:function(t){var e=t?t.asc_getLicenseType():Asc.c_oLicenseResult.Error;if(t&&!(this.appOptions.isEditDiagram||this.appOptions.isEditMailMerge||this.appOptions.isEditOle)){if(Asc.c_oLicenseResult.Expired===e||Asc.c_oLicenseResult.Error===e||Asc.c_oLicenseResult.ExpiredTrial===e||Asc.c_oLicenseResult.NotBefore===e||Asc.c_oLicenseResult.ExpiredLimited===e)return void Common.UI.warning({title:Asc.c_oLicenseResult.NotBefore===e?this.titleLicenseNotActive:this.titleLicenseExp,msg:Asc.c_oLicenseResult.NotBefore===e?this.warnLicenseBefore:this.warnLicenseExp,buttons:[],closable:!1});if(this.onServerVersion(t.asc_getBuildVersion())||!this.onLanguageLoaded())return;t.asc_getRights()!==Asc.c_oRights.Edit&&(this.permissions.edit=!1),this.appOptions.permissionsLicense=e,this.appOptions.canAutosave=!0,this.appOptions.canAnalytics=t.asc_getIsAnalyticsEnable(),this.appOptions.isOffline=this.api.asc_isOffline(),this.appOptions.isCrypted=this.api.asc_isCrypto(),this.appOptions.canLicense=e===Asc.c_oLicenseResult.Success||e===Asc.c_oLicenseResult.SuccessLimit,this.appOptions.isLightVersion=t.asc_getIsLight(),this.appOptions.canCoAuthoring=!this.appOptions.isLightVersion,this.appOptions.canComments=this.appOptions.canLicense&&(void 0===this.permissions.comment?!1!==this.permissions.edit:this.permissions.comment)&&"view"!==this.editorConfig.mode,this.appOptions.canComments=this.appOptions.canComments&&!("object"==typeof this.editorConfig.customization&&!1===this.editorConfig.customization.comments),this.appOptions.canViewComments=this.appOptions.canComments||!("object"==typeof this.editorConfig.customization&&!1===this.editorConfig.customization.comments),this.appOptions.canChat=this.appOptions.canLicense&&!this.appOptions.isOffline&&!(!1===this.permissions.chat||void 0===this.permissions.chat&&"object"==typeof this.editorConfig.customization&&!1===this.editorConfig.customization.chat),"object"==typeof this.editorConfig.customization&&this.editorConfig.customization.chat,this.appOptions.canRename=this.editorConfig.canRename,this.appOptions.buildVersion=t.asc_getBuildVersion(),this.appOptions.trialMode=t.asc_getLicenseMode(),this.appOptions.isBeta=t.asc_getIsBeta(),this.appOptions.canModifyFilter=!1!==this.permissions.modifyFilter,this.appOptions.canBranding=t.asc_getCustomization(),this.appOptions.canBranding&&this.headerView.setBranding(this.editorConfig.customization),this.appOptions.canFavorite=this.appOptions.spreadsheet.info&&void 0!==this.appOptions.spreadsheet.info.favorite&&null!==this.appOptions.spreadsheet.info.favorite,this.appOptions.canFavorite&&this.headerView&&this.headerView.setFavorite(this.appOptions.spreadsheet.info.favorite),this.appOptions.canRename&&this.headerView.setCanRename(!0),this.appOptions.canUseReviewPermissions=this.appOptions.canLicense&&(!!this.permissions.reviewGroups||this.appOptions.canLicense&&this.editorConfig.customization&&this.editorConfig.customization.reviewPermissions&&"object"==typeof this.editorConfig.customization.reviewPermissions),this.appOptions.canUseCommentPermissions=this.appOptions.canLicense&&!!this.permissions.commentGroups,this.appOptions.canUseUserInfoPermissions=this.appOptions.canLicense&&!!this.permissions.userInfoGroups}else this.appOptions.canModifyFilter=!0;this.appOptions.canRequestEditRights=this.editorConfig.canRequestEditRights,this.appOptions.canEdit=!1!==this.permissions.edit&&(this.editorConfig.canRequestEditRights||"view"!==this.editorConfig.mode),this.appOptions.isEdit=(this.appOptions.canLicense||this.appOptions.isEditDiagram||this.appOptions.isEditMailMerge||this.appOptions.isEditOle)&&!1!==this.permissions.edit&&"view"!==this.editorConfig.mode,this.appOptions.canDownload=!1!==this.permissions.download,this.appOptions.canPrint=!1!==this.permissions.print&&!(this.appOptions.isEditDiagram||this.appOptions.isEditMailMerge||this.appOptions.isEditOle),this.appOptions.canQuickPrint=this.appOptions.canPrint&&!Common.Utils.isMac,this.appOptions.canForcesave=this.appOptions.isEdit&&!this.appOptions.isOffline&&!(this.appOptions.isEditDiagram||this.appOptions.isEditMailMerge||this.appOptions.isEditOle||("object"!=typeof this.editorConfig.customization||!this.editorConfig.customization.forcesave)),this.appOptions.forcesave=this.appOptions.canForcesave,this.appOptions.canEditComments=this.appOptions.isOffline||!this.permissions.editCommentAuthorOnly,this.appOptions.canDeleteComments=this.appOptions.isOffline||!this.permissions.deleteCommentAuthorOnly,"object"==typeof this.editorConfig.customization&&!0===this.editorConfig.customization.commentAuthorOnly&&void 0===this.permissions.editCommentAuthorOnly&&void 0===this.permissions.deleteCommentAuthorOnly&&(this.appOptions.canEditComments=this.appOptions.canDeleteComments=this.appOptions.isOffline),this.appOptions.isSignatureSupport=this.appOptions.isEdit&&this.appOptions.isDesktopApp&&this.appOptions.isOffline&&this.api.asc_isSignaturesSupport()&&!1!==this.permissions.protect&&!(this.appOptions.isEditDiagram||this.appOptions.isEditMailMerge||this.appOptions.isEditOle),this.appOptions.isPasswordSupport=this.appOptions.isEdit&&this.api.asc_isProtectionSupport()&&!1!==this.permissions.protect&&!(this.appOptions.isEditDiagram||this.appOptions.isEditMailMerge||this.appOptions.isEditOle),this.appOptions.canProtect=!1!==this.permissions.protect&&!(this.appOptions.isEditDiagram||this.appOptions.isEditMailMerge||this.appOptions.isEditOle),this.appOptions.canHelp=!("object"==typeof this.editorConfig.customization&&!1===this.editorConfig.customization.help),this.appOptions.isRestrictedEdit=!this.appOptions.isEdit&&this.appOptions.canComments,this.appOptions.canLiveView=!!t.asc_getLiveViewerSupport()&&"view"===this.editorConfig.mode,this.appOptions.canChangeCoAuthoring=this.appOptions.isEdit&&!(this.appOptions.isEditDiagram||this.appOptions.isEditMailMerge||this.appOptions.isEditOle)&&this.appOptions.canCoAuthoring&&!(this.editorConfig.coEditing&&"object"==typeof this.editorConfig.coEditing&&!1===this.editorConfig.coEditing.change)||this.appOptions.canLiveView&&!(this.editorConfig.coEditing&&"object"==typeof this.editorConfig.coEditing&&!1===this.editorConfig.coEditing.change),this.appOptions.isAnonymousSupport=!!this.api.asc_isAnonymousSupport(),this.appOptions.isEditDiagram||this.appOptions.isEditMailMerge||this.appOptions.isEditOle||(this.appOptions.canBrandingExt=t.asc_getCanBranding()&&("object"==typeof this.editorConfig.customization||this.editorConfig.plugins),this.getApplication().getController("Common.Controllers.Plugins").setMode(this.appOptions),this.editorConfig.customization&&Common.UI.LayoutManager.init(this.editorConfig.customization.layout,this.appOptions.canBrandingExt),this.editorConfig.customization&&Common.UI.FeaturesManager.init(this.editorConfig.customization.features,this.appOptions.canBrandingExt),Common.UI.ExternalUsers.init(this.appOptions.canRequestUsers)),this.appOptions.canUseHistory=this.appOptions.canLicense&&this.editorConfig.canUseHistory&&this.appOptions.canCoAuthoring&&!this.appOptions.isOffline,this.appOptions.canHistoryClose=this.editorConfig.canHistoryClose,this.appOptions.canHistoryRestore=this.editorConfig.canHistoryRestore,this.appOptions.isLightVersion&&(this.appOptions.canUseHistory=!1),this.loadCoAuthSettings(),this.applyModeCommonElements(),this.applyModeEditorElements(),this.appOptions.isEdit||(Common.NotificationCenter.trigger("app:face",this.appOptions),this.hidePreloader(),this.onLongActionBegin(Asc.c_oAscAsyncActionType.BlockInteraction,-256)),this.api.asc_setViewMode(!this.appOptions.isEdit&&!this.appOptions.isRestrictedEdit),this.appOptions.isRestrictedEdit&&this.appOptions.canComments&&this.api.asc_setRestriction(Asc.c_oAscRestrictionType.OnlyComments),this.api.asc_LoadDocument()},loadCoAuthSettings:function(){var t,e=!0,i=1;this.appOptions.isEdit&&!this.appOptions.isOffline&&this.appOptions.canCoAuthoring?(this.appOptions.canChangeCoAuthoring?null===(t=Common.localStorage.getItem("sse-settings-coauthmode"))&&null===(t=this.editorConfig.coEditing&&void 0!==this.editorConfig.coEditing.mode?"strict"===this.editorConfig.coEditing.mode?0:1:null)&&!Common.localStorage.itemExists("sse-settings-autosave")&&this.appOptions.customization&&!1===this.appOptions.customization.autosave&&(t=0):null===(t=this.editorConfig.coEditing&&void 0!==this.editorConfig.coEditing.mode?"strict"===this.editorConfig.coEditing.mode?0:1:null)&&this.appOptions.customization&&!1===this.appOptions.customization.autosave&&(t=0),e=null===t||1==parseInt(t)):!this.appOptions.isEdit&&this.appOptions.isRestrictedEdit?e=!0:this.appOptions.canLiveView&&!this.appOptions.isOffline?(t=Common.localStorage.getItem("sse-settings-view-coauthmode"),this.appOptions.canChangeCoAuthoring&&null!==t||(t=this.editorConfig.coEditing&&"strict"===this.editorConfig.coEditing.mode?0:1),e=1==parseInt(t)):(e=!1,i=0),this.appOptions.isEdit&&this.appOptions.canAutosave&&(null===(t=Common.localStorage.getItem("sse-settings-autosave"))&&this.appOptions.customization&&!1===this.appOptions.customization.autosave&&(t=0),i=e||null===t?this.appOptions.canCoAuthoring?1:0:parseInt(t)),Common.Utils.InternalSettings.set("sse-settings-coauthmode",e),Common.Utils.InternalSettings.set("sse-settings-autosave",i)},applyModeCommonElements:function(){window.editor_elements_prepared=!0;var t=this.getApplication(),e=t.getController("Viewport").getView("Viewport"),i=t.getController("Statusbar").getView("Statusbar"),i=(this.headerView&&this.headerView.setVisible(!(this.appOptions.isEditMailMerge||this.appOptions.isDesktopApp||this.appOptions.isEditDiagram||this.appOptions.isEditOle)),e&&e.setMode(this.appOptions,!0),i&&i.setMode(this.appOptions),t.getController("Toolbar").setMode(this.appOptions),t.getController("DocumentHolder").setMode(this.appOptions),e&&e.applyCommonMode(),(this.appOptions.isEditMailMerge||this.appOptions.isEditDiagram)&&i.hide(),(this.appOptions.isEditMailMerge||this.appOptions.isEditDiagram||this.appOptions.isEditOle)&&(t.getController("LeftMenu").getView("LeftMenu").hide(),$(window).mouseup(function(t){Common.Gateway.internalMessage("processMouse",{event:"mouse:up"})}).mousemove($.proxy(function(t){(this.isDiagramDrag||this.isDiagramResize)&&Common.Gateway.internalMessage("processMouse",{event:"mouse:move",pagex:t.pageX*Common.Utils.zoom(),pagey:t.pageY*Common.Utils.zoom()})},this))),this.appOptions.isEditMailMerge||this.appOptions.isEditDiagram||this.appOptions.isEditOle?(this.api.asc_registerCallback("asc_sendFromFrameToGeneralEditor",_.bind(this.onSendFromFrameToGeneralEditor,this)),this.appOptions.isEditOle&&this.api.asc_registerCallback("asc_onSendThemeColors",_.bind(this.onSendThemeColors,this))):(this.api.asc_registerCallback("asc_onSendThemeColors",_.bind(this.onSendThemeColors,this)),this.api.asc_registerCallback("asc_onDownloadUrl",_.bind(this.onDownloadUrl,this)),this.api.asc_registerCallback("asc_onDocumentModifiedChanged",_.bind(this.onDocumentModifiedChanged,this)),(e=t.getController("Print"))&&this.api&&e.setApi(this.api).setMode(this.appOptions)),this.getApplication().getController("CellEditor"));i&&i.setApi(this.api).setMode(this.appOptions)},applyModeEditorElements:function(t){var e,i,s,o=this.getApplication().getController("Common.Controllers.Comments"),o=(o&&(o.setMode(this.appOptions),o.setConfig({config:this.editorConfig,sdkviewname:"#ws-canvas-outer",fullInfoHintMode:!0,hintmode:!0},this.api)),this),n=this.getApplication(),a=(n.getController("Common.Controllers.ReviewChanges").setMode(o.appOptions).setConfig({config:o.editorConfig},o.api).loadDocument({doc:o.appOptions.spreadsheet}),Common.localStorage.getItem("sse-settings-unit")),a=(void 0===(a=null!==a?parseInt(a):o.appOptions.customization&&o.appOptions.customization.unit?Common.Utils.Metric.c_MetricUnits[o.appOptions.customization.unit.toLocaleLowerCase()]:Common.Utils.Metric.getDefaultMetric())&&(a=Common.Utils.Metric.getDefaultMetric()),Common.Utils.Metric.setCurrentMetric(a),Common.Utils.InternalSettings.set("sse-settings-unit",a),n.getController("Toolbar"));a&&a.setApi(o.api),this.appOptions.isRestrictedEdit?n.getController("WBProtection").setMode(o.appOptions).setConfig({config:o.editorConfig},o.api):this.appOptions.isEdit&&(e=n.getController("Statusbar"),i=n.getController("RightMenu"),(s=n.getController("Common.Controllers.Fonts"))&&s.setApi(o.api),i&&i.setApi(o.api),n.getController("Common.Controllers.Protection").setMode(o.appOptions).setConfig({config:o.editorConfig},o.api),n.getController("WBProtection").setMode(o.appOptions).setConfig({config:o.editorConfig},o.api),e&&(e.getView("Statusbar").changeViewMode(o.appOptions),o.appOptions.isEditOle&&e.onChangeViewMode(null,!0,!0)),o.appOptions.isEditMailMerge||o.appOptions.isEditDiagram||o.appOptions.isEditOle||!o.appOptions.canFeaturePivot||n.getController("PivotTable").setMode(o.appOptions),this.getApplication().getController("Viewport").getView("Viewport").applyEditorMode(),i.getView("RightMenu").setMode(o.appOptions).setApi(o.api),this.toolbarView=a.getView("Toolbar"),o.appOptions.isEditMailMerge||o.appOptions.isEditDiagram||o.appOptions.isEditOle?i.getView("RightMenu").hide():(s={},JSON.parse(Common.localStorage.getItem("sse-hidden-formula"))&&(s.formula=!0),n.getController("Toolbar").hideElements(s)),o.api.asc_registerCallback("asc_onCollaborativeChanges",_.bind(o.onCollaborativeChanges,o)),o.api.asc_registerCallback("asc_onAuthParticipantsChanged",_.bind(o.onAuthParticipantsChanged,o)),o.api.asc_registerCallback("asc_onParticipantsChanged",_.bind(o.onAuthParticipantsChanged,o)),o.api.asc_registerCallback("asc_onConvertEquationToMath",_.bind(o.onConvertEquationToMath,o)),o.appOptions.isEditDiagram&&o.api.asc_registerCallback("asc_onSelectionChanged",_.bind(o.onSelectionChanged,o)),o.api.asc_setFilteringMode&&o.api.asc_setFilteringMode(o.appOptions.canModifyFilter),o.stackLongActions.exist({id:-255,type:Asc.c_oAscAsyncActionType.BlockInteraction})?o.onLongActionEnd(Asc.c_oAscAsyncActionType.BlockInteraction,-255):this._isDocReady||(Common.NotificationCenter.trigger("app:face",this.appOptions),o.hidePreloader(),o.onLongActionBegin(Asc.c_oAscAsyncActionType.BlockInteraction,-256)),window.onbeforeunload=_.bind(o.onBeforeUnload,o),window.onunload=_.bind(o.onUnload,o))},onExternalMessage:function(t,e){t&&t.msg&&(t.msg=t.msg.toString(),this.showTips([t.msg.charAt(0).toUpperCase()+t.msg.substring(1)],e),Common.component.Analytics.trackEvent("External Error"))},onError:function(e,t,i,s){if(this.isFrameClosed)this.lastFrameError={id:e,level:t,errData:i,callback:s};else if(e==Asc.c_oAscError.ID.LoadingScriptError)this.showTips([this.scriptLoadError]),this.tooltip&&this.tooltip.getBSTip().$tip.css("z-index",1e4);else if(e==Asc.c_oAscError.ID.CanNotPasteImage)this.showTips([this.errorCannotPasteImg],{timeout:7e3,hideCloseTip:!0});else{this.hidePreloader(),this.onLongActionEnd(Asc.c_oAscAsyncActionType.BlockInteraction,-256);var o={closable:!0};switch(e){case Asc.c_oAscError.ID.Unknown:o.msg=this.unknownErrorText;break;case Asc.c_oAscError.ID.ConvertationTimeout:o.msg=this.convertationTimeoutText;break;case Asc.c_oAscError.ID.ConvertationOpenError:o.msg=this.openErrorText;break;case Asc.c_oAscError.ID.ConvertationSaveError:o.msg=this.appOptions.isDesktopApp&&this.appOptions.isOffline?this.saveErrorTextDesktop:this.saveErrorText;break;case Asc.c_oAscError.ID.DownloadError:o.msg=this.downloadErrorText;break;case Asc.c_oAscError.ID.UplImageSize:o.msg=this.uploadImageSizeMessage;break;case Asc.c_oAscError.ID.UplImageExt:o.msg=this.uploadImageExtMessage;break;case Asc.c_oAscError.ID.UplImageFileCount:o.msg=this.uploadImageFileCountMessage;break;case Asc.c_oAscError.ID.PastInMergeAreaError:o.msg=this.pastInMergeAreaError;break;case Asc.c_oAscError.ID.FrmlWrongCountParentheses:o.msg=this.errorWrongBracketsCount;break;case Asc.c_oAscError.ID.FrmlWrongOperator:o.msg=this.errorWrongOperator;break;case Asc.c_oAscError.ID.FrmlWrongMaxArgument:o.msg=this.errorCountArgExceed;break;case Asc.c_oAscError.ID.FrmlWrongCountArgument:o.msg=this.errorCountArg;break;case Asc.c_oAscError.ID.FrmlWrongFunctionName:o.msg=this.errorFormulaName;break;case Asc.c_oAscError.ID.FrmlAnotherParsingError:o.msg=this.errorFormulaParsing;break;case Asc.c_oAscError.ID.FrmlWrongArgumentRange:o.msg=this.errorArgsRange;break;case Asc.c_oAscError.ID.FrmlOperandExpected:o.msg=this.errorOperandExpected;break;case Asc.c_oAscError.ID.FrmlWrongReferences:o.msg=this.errorFrmlWrongReferences;break;case Asc.c_oAscError.ID.UnexpectedGuid:o.msg=this.errorUnexpectedGuid;break;case Asc.c_oAscError.ID.Database:o.msg=this.errorDatabaseConnection;break;case Asc.c_oAscError.ID.FileRequest:o.msg=this.errorFileRequest;break;case Asc.c_oAscError.ID.FileVKey:o.msg=this.errorFileVKey;break;case Asc.c_oAscError.ID.StockChartError:o.msg=this.errorStockChart;break;case Asc.c_oAscError.ID.MaxDataSeriesError:o.msg=this.getApplication().getController("Toolbar").errorMaxRows;break;case Asc.c_oAscError.ID.ComboSeriesError:o.msg=this.getApplication().getController("Toolbar").errorComboSeries;break;case Asc.c_oAscError.ID.DataRangeError:o.msg=this.errorDataRange;break;case Asc.c_oAscError.ID.MaxDataPointsError:o.msg=this.errorMaxPoints;break;case Asc.c_oAscError.ID.VKeyEncrypt:o.msg=this.errorToken;break;case Asc.c_oAscError.ID.KeyExpire:o.msg=this.errorTokenExpire;break;case Asc.c_oAscError.ID.UserCountExceed:o.msg=this.errorUsersExceed;break;case Asc.c_oAscError.ID.CannotMoveRange:o.msg=this.errorMoveRange;break;case Asc.c_oAscError.ID.UplImageUrl:o.msg=this.errorBadImageUrl;break;case Asc.c_oAscError.ID.CoAuthoringDisconnect:o.msg=this.errorViewerDisconnect;break;case Asc.c_oAscError.ID.ConvertationPassword:o.msg=this.errorFilePassProtect;break;case Asc.c_oAscError.ID.AutoFilterDataRangeError:o.msg=this.errorAutoFilterDataRange;break;case Asc.c_oAscError.ID.AutoFilterChangeFormatTableError:o.msg=this.errorAutoFilterChangeFormatTable;break;case Asc.c_oAscError.ID.AutoFilterChangeError:o.msg=this.errorAutoFilterChange;break;case Asc.c_oAscError.ID.AutoFilterMoveToHiddenRangeError:o.msg=this.errorAutoFilterHiddenRange;break;case Asc.c_oAscError.ID.CannotFillRange:o.msg=this.errorFillRange;break;case Asc.c_oAscError.ID.UserDrop:if(this._state.lostEditingRights)return void(this._state.lostEditingRights=!1);this._state.lostEditingRights=!0,o.msg=this.errorUserDrop,Common.NotificationCenter.trigger("collaboration:sharingdeny");break;case Asc.c_oAscError.ID.InvalidReferenceOrName:o.msg=this.errorInvalidRef;break;case Asc.c_oAscError.ID.LockCreateDefName:o.msg=this.errorCreateDefName;break;case Asc.c_oAscError.ID.PasteMaxRangeError:o.msg=this.errorPasteMaxRange;break;case Asc.c_oAscError.ID.LockedAllError:o.msg=this.errorLockedAll;break;case Asc.c_oAscError.ID.Warning:o.msg=this.errorConnectToServer,o.closable=!1;break;case Asc.c_oAscError.ID.LockedWorksheetRename:o.msg=this.errorLockedWorksheetRename;break;case Asc.c_oAscError.ID.OpenWarning:o.msg=this.errorOpenWarning;break;case Asc.c_oAscError.ID.CopyMultiselectAreaError:o.msg=this.errorCopyMultiselectArea;break;case Asc.c_oAscError.ID.PrintMaxPagesCount:o.msg=this.errorPrintMaxPagesCount;break;case Asc.c_oAscError.ID.SessionAbsolute:o.msg=this.errorSessionAbsolute;break;case Asc.c_oAscError.ID.SessionIdle:o.msg=this.errorSessionIdle;break;case Asc.c_oAscError.ID.SessionToken:o.msg=this.errorSessionToken;break;case Asc.c_oAscError.ID.AccessDeny:o.msg=this.errorAccessDeny;break;case Asc.c_oAscError.ID.LockedCellPivot:o.msg=this.errorLockedCellPivot;break;case Asc.c_oAscError.ID.PivotLabledColumns:o.msg=this.errorLabledColumnsPivot;break;case Asc.c_oAscError.ID.PivotOverlap:o.msg=this.errorPivotOverlap;break;case Asc.c_oAscError.ID.ForceSaveButton:case Asc.c_oAscError.ID.ForceSaveTimeout:o.msg=this.errorForceSave,o.maxwidth=600;break;case Asc.c_oAscError.ID.DataEncrypted:o.msg=this.errorDataEncrypted;break;case Asc.c_oAscError.ID.EditingError:o.msg=this.appOptions.isDesktopApp&&this.appOptions.isOffline?this.errorEditingSaveas:this.errorEditingDownloadas;break;case Asc.c_oAscError.ID.CannotChangeFormulaArray:o.msg=this.errorChangeArray;break;case Asc.c_oAscError.ID.MultiCellsInTablesFormulaArray:o.msg=this.errorMultiCellFormula;break;case Asc.c_oAscError.ID.MailToClientMissing:o.msg=this.errorEmailClient;break;case Asc.c_oAscError.ID.NoDataToParse:o.msg=this.errorNoDataToParse;break;case Asc.c_oAscError.ID.CannotUngroupError:o.msg=this.errorCannotUngroup;break;case Asc.c_oAscError.ID.FrmlMaxTextLength:o.msg=this.errorFrmlMaxTextLength;break;case Asc.c_oAscError.ID.FrmlMaxReference:o.msg=this.errorFrmlMaxReference;break;case Asc.c_oAscError.ID.DataValidate:var n=i?i.asc_getErrorStyle():void 0;void 0!==n&&(o.iconCls=n==Asc.c_oAscEDataValidationErrorStyle.Stop?"error":n==Asc.c_oAscEDataValidationErrorStyle.Information?"info":"warn"),i&&i.asc_getErrorTitle()&&(o.title=Common.Utils.String.htmlEncode(i.asc_getErrorTitle())),o.buttons=["ok","cancel"],o.msg=i&&i.asc_getError()?Common.Utils.String.htmlEncode(i.asc_getError()):this.errorDataValidate,o.maxwidth=600;break;case Asc.c_oAscError.ID.ConvertationOpenLimitError:o.msg=this.errorFileSizeExceed;break;case Asc.c_oAscError.ID.UpdateVersion:o.msg=this.errorUpdateVersionOnDisconnect,o.maxwidth=600;break;case Asc.c_oAscError.ID.FTChangeTableRangeError:o.msg=this.errorFTChangeTableRangeError;break;case Asc.c_oAscError.ID.FTRangeIncludedOtherTables:o.msg=this.errorFTRangeIncludedOtherTables;break;case Asc.c_oAscError.ID.PasteSlicerError:o.msg=this.errorPasteSlicerError;break;case Asc.c_oAscError.ID.RemoveDuplicates:o.iconCls="info",o.title=Common.UI.Window.prototype.textInformation,o.buttons=["ok"],o.msg=null!==i.asc_getDuplicateValues()&&null!==i.asc_getUniqueValues()?Common.Utils.String.format(this.errRemDuplicates,i.asc_getDuplicateValues(),i.asc_getUniqueValues()):this.errNoDuplicates,o.maxwidth=600;break;case Asc.c_oAscError.ID.FrmlMaxLength:o.msg=this.errorFrmlMaxLength,o.maxwidth=600;break;case Asc.c_oAscError.ID.MoveSlicerError:o.msg=this.errorMoveSlicerError;break;case Asc.c_oAscError.ID.LockedEditView:o.msg=this.errorEditView;break;case Asc.c_oAscError.ID.ChangeFilteredRangeError:o.msg=this.errorChangeFilteredRange;break;case Asc.c_oAscError.ID.Password:o.msg=this.errorSetPassword;break;case Asc.c_oAscError.ID.PivotGroup:o.msg=this.errorPivotGroup;break;case Asc.c_oAscError.ID.PasteMultiSelectError:o.msg=this.errorPasteMultiSelect;break;case Asc.c_oAscError.ID.PivotWithoutUnderlyingData:o.msg=this.errorPivotWithoutUnderlying;break;case Asc.c_oAscError.ID.ChangeOnProtectedSheet:o.msg=this.errorChangeOnProtectedSheet;break;case Asc.c_oAscError.ID.SingleColumnOrRowError:o.msg=this.errorSingleColumnOrRowError;break;case Asc.c_oAscError.ID.LocationOrDataRangeError:o.msg=this.errorLocationOrDataRangeError;break;case Asc.c_oAscError.ID.PasswordIsNotCorrect:o.msg=this.errorPasswordIsNotCorrect;break;case Asc.c_oAscError.ID.UplDocumentSize:o.msg=this.uploadDocSizeMessage;break;case Asc.c_oAscError.ID.DeleteColumnContainsLockedCell:o.msg=this.errorDeleteColumnContainsLockedCell;break;case Asc.c_oAscError.ID.UplDocumentExt:o.msg=this.uploadDocExtMessage;break;case Asc.c_oAscError.ID.DeleteRowContainsLockedCell:o.msg=this.errorDeleteRowContainsLockedCell;break;case Asc.c_oAscError.ID.UplDocumentFileCount:o.msg=this.uploadDocFileCountMessage;break;case Asc.c_oAscError.ID.LoadingFontError:o.msg=this.errorLoadingFont;break;case Asc.c_oAscError.ID.FillAllRowsWarning:var a,n=i[0],l=i[1],r=(this.appOptions.lang||"en").replace("_","-").toLowerCase();try{a=n.toLocaleString(r)}catch(t){a=n.toLocaleString(r="en")}this.appOptions.isDesktopApp&&this.appOptions.isOffline?(o.msg=l<n?Common.Utils.String.format(this.textFormulaFilledAllRowsWithEmpty,a):Common.Utils.String.format(this.textFormulaFilledAllRows,a),o.buttons=[{caption:this.textFillOtherRows,primary:!0,value:"fillOther"},"close"]):(o.msg=l<=n?Common.Utils.String.format(this.textFormulaFilledFirstRowsOtherIsEmpty,a):Common.Utils.String.format(this.textFormulaFilledFirstRowsOtherHaveData,a,(l-n).toLocaleString(r)),o.buttons=["ok"]),o.maxwidth=400;break;case Asc.c_oAscError.ID.CannotUseCommandProtectedSheet:o.msg=this.errorCannotUseCommandProtectedSheet;break;case Asc.c_oAscError.ID.DirectUrl:o.msg=this.errorDirectUrl;break;case Asc.c_oAscError.ID.ConvertationOpenFormat:o.maxwidth=600,Common.Utils.InternalSettings.get("import-xml-start")?o.msg=this.errorConvertXml:o.msg="pdf"===i?this.errorInconsistentExtPdf.replace("%1",this.appOptions.spreadsheet.fileType||""):"docx"===i?this.errorInconsistentExtDocx.replace("%1",this.appOptions.spreadsheet.fileType||""):"xlsx"===i?this.errorInconsistentExtXlsx.replace("%1",this.appOptions.spreadsheet.fileType||""):"pptx"===i?this.errorInconsistentExtPptx.replace("%1",this.appOptions.spreadsheet.fileType||""):this.errorInconsistentExt;break;case Asc.c_oAscError.ID.ProtectedRangeByOtherUser:o.msg=this.errorProtectedRange;break;case Asc.c_oAscError.ID.TraceDependentsNoFormulas:o.msg=this.errorDependentsNoFormulas;break;case Asc.c_oAscError.ID.TracePrecedentsNoValidReference:o.msg=this.errorPrecedentsNoValidRef,o.maxwidth=600;break;default:o.msg="string"==typeof e?e:this.errorDefaultMessage.replace("%1",e)}t==Asc.c_oAscError.Level.Critical?(Common.Gateway.reportError(e,o.msg),o.title=this.criticalErrorTitle,o.iconCls="error",o.closable=!1,this.appOptions.canBackToFolder&&!this.appOptions.isDesktopApp&&"string"!=typeof e&&(o.msg+="<br><br>"+this.criticalErrorExtText,o.callback=function(t){"ok"==t&&Common.NotificationCenter.trigger("goback",!0)}),/^https?:\/\//i.test(this.appOptions.document&&this.appOptions.document.url)&&(o.msg+=`，<a href="${this.appOptions.document.url}" download><b class="download">下载到本地</b></a>`),o.callback=t=>{Common.Gateway._postMessage({event:"onAlertOK",data:{button:t,type:"closeWindow"}})},e!=Asc.c_oAscError.ID.DataEncrypted&&e!=Asc.c_oAscError.ID.ConvertationOpenLimitError||(this.api.asc_coAuthoringDisconnect(),Common.NotificationCenter.trigger("api:disconnect"))):(Common.Gateway.reportWarning(e,o.msg),o.title=o.title||this.notcriticalErrorTitle,o.iconCls=o.iconCls||"warn",o.buttons=o.buttons||["ok"],o.callback=_.bind(function(t){e==Asc.c_oAscError.ID.Warning&&"ok"==t&&this.appOptions.canDownload?(Common.UI.Menu.Manager.hideAll(),this.appOptions.isDesktopApp&&this.appOptions.isOffline?this.api.asc_DownloadAs():this._isDocReady?this.getApplication().getController("LeftMenu").leftMenu.showMenu("file:saveas"):this._needToSaveAsFile=!0):e==Asc.c_oAscError.ID.EditingError?(this.disableEditing(!0),Common.NotificationCenter.trigger("api:disconnect",!0)):e==Asc.c_oAscError.ID.DataValidate&&"ok"!==t?this.api.asc_closeCellEditor(!0):e==Asc.c_oAscError.ID.FillAllRowsWarning&&"fillOther"===t&&_.isFunction(s)&&s(),this._state.lostEditingRights=!1,this.onEditComplete()},this)),(!Common.Utils.ModalWindow.isVisible()||$(".asc-window.modal.alert[data-value="+e+"]").length<1)&&setTimeout(function(){Common.UI.alert(o).$window.attr("data-value",e)},1),void 0!==e&&Common.component.Analytics.trackEvent("Internal Error",e.toString())}},onCoAuthoringDisconnect:function(){this.getApplication().getController("Viewport").getView("Viewport").setMode({isDisconnected:!0}),this.getApplication().getController("Viewport").getView("Common.Views.Header").setCanRename(!1),this.appOptions.canRename=!1,this._state.isDisconnected=!0},showTips:function(e,i){var s=this;function o(t){s.tipTimeout&&clearTimeout(s.tipTimeout),setTimeout(n,300)}function n(){var t=e.shift();t&&(i&&i.hideCloseTip||(t+="\n"+s.textCloseTip),s.tooltip.setTitle(t),s.tooltip.show(),s.tipTimeout&&clearTimeout(s.tipTimeout),i&&i.timeout&&(s.tipTimeout=setTimeout(function(){s.tooltip.hide(),o()},i.timeout)))}e.length&&("object"!=typeof e&&(e=[e]),this.tooltip||(this.tooltip=new Common.UI.Tooltip({owner:this.getApplication().getController("Toolbar").getView("Toolbar"),hideonclick:!0,placement:"bottom",cls:"main-info",offset:30}),this.tooltip.on("tooltip:hideonclick",o)),n())},updateWindowTitle:function(t,e){var i;this._state.isDocModified===t&&!e||(this.headerView&&(e=this.defaultTitleText,_.isEmpty(this.headerView.getDocumentCaption())||(e=this.headerView.getDocumentCaption()+(e?" - ":"")+e),t?(clearTimeout(this._state.timerCaption),_.isUndefined(e)||(e="* "+e,this.headerView.setDocumentCaption(this.headerView.getDocumentCaption(),!0))):this._state.fastCoauth&&1<this._state.usersCount?(i=this)._state.timerCaption=setTimeout(function(){i.headerView.setDocumentCaption(i.headerView.getDocumentCaption(),!1)},500):this.headerView.setDocumentCaption(this.headerView.getDocumentCaption(),!1),window.parent.document.title!=e&&(window.parent.document.title=e)),this._isDocReady&&this._state.isDocModified!==t&&Common.Gateway.setDocumentModified(t),t&&(!this._state.fastCoauth||this._state.usersCount<2)&&this.getApplication().getController("Statusbar").setStatusCaption("",!0),this._state.isDocModified=t)},onDocumentChanged:function(){},onDocumentModifiedChanged:function(t){var e;this._state.isDocModified!==t&&this._isDocReady&&Common.Gateway.setDocumentModified(t),this.updateWindowTitle(t),this.toolbarView&&this.toolbarView.btnCollabChanges&&this.api&&(t=this.toolbarView.btnCollabChanges.cmpEl.hasClass("notify"),e=this.appOptions.forcesave,t=!this.api.asc_isDocumentCanSave()&&!t&&!e||this._state.isDisconnected||this._state.fastCoauth&&1<this._state.usersCount&&!e,this.toolbarView.btnSave.setDisabled(t))},onDocumentCanSaveChanged:function(t){var e,i;this.toolbarView&&this.toolbarView.btnCollabChanges&&(i=this.toolbarView.btnCollabChanges.cmpEl.hasClass("notify"),e=this.appOptions.forcesave,i=!t&&!i&&!e||this._state.isDisconnected||this._state.fastCoauth&&1<this._state.usersCount&&!e,this.toolbarView.btnSave.setDisabled(i)),Common.Gateway._postMessage({event:"onDocumentCanSaveChanged",data:{isCanSave:t}})},onBeforeUnload:function(){var t;if(Common.localStorage.save(),!1!==this.permissions.edit&&"view"!==this.editorConfig.mode&&"editdiagram"!==this.editorConfig.mode&&"editmerge"!==this.editorConfig.mode&&"editole"!==this.editorConfig.mode&&this.api.asc_isDocumentModified())return(t=this).api.asc_stopSaving(),this._state.unloadTimer=1e3,this.continueSavingTimer=window.setTimeout(function(){t.api.asc_continueSaving(),t._state.unloadTimer=0},500),this.leavePageText;this._state.unloadTimer=1e4},onUnload:function(){this.continueSavingTimer&&clearTimeout(this.continueSavingTimer)},hidePreloader:function(){var t;this._state.customizationDone||(this._state.customizationDone=!0,this.appOptions.customization&&(this.appOptions.isDesktopApp?this.appOptions.customization.about=!1:this.appOptions.canBrandingExt||(this.appOptions.customization.about=!0)),Common.Utils.applyCustomization(this.appOptions.customization,e),this.appOptions.canBrandingExt&&(Common.Utils.applyCustomization(this.appOptions.customization,i),Common.UI.LayoutManager.applyCustomization(),this.appOptions.customization&&"object"==typeof this.appOptions.customization&&(this.appOptions.customization.leftMenu,this.appOptions.customization.rightMenu,this.appOptions.customization.statusBar,this.appOptions.customization.toolbar),t=this.getApplication().getController("Common.Controllers.Plugins").applyUICustomization())),this.stackLongActions.pop({id:-254,type:Asc.c_oAscAsyncActionType.BlockInteraction}),Common.NotificationCenter.trigger("layout:changed","main"),(t||new Promise(function(t,e){t()})).then(function(){$("#loading-mask").hide().remove()})},onDownloadUrl:function(t,e){this._state.isFromGatewayDownloadAs&&Common.Gateway.downloadAs(t,e),this._state.isFromGatewayDownloadAs=!1},onDownloadCancel:function(){this._state.isFromGatewayDownloadAs=!1},onUpdateVersion:function(t){var e=this;e.needToUpdateVersion=!0,e.onLongActionEnd(Asc.c_oAscAsyncActionType.BlockInteraction,-256),Common.UI.warning({msg:this.errorUpdateVersion,callback:function(){_.defer(function(){Common.Gateway.updateVersion(),t&&t.call(e),e.onLongActionBegin(Asc.c_oAscAsyncActionType.BlockInteraction,-256)})}})},onServerVersion:function(t){return!1},onAdvancedOptions:function(i,t,s,o){var n;this._state.openDlg||(n=this,i==Asc.c_oAscAdvancedOptionsID.CSV?n._state.openDlg=new Common.Views.OpenDialog({title:Common.Views.OpenDialog.prototype.txtTitle.replace("%1","CSV"),closable:2==s,type:Common.Utils.importTextType.CSV,preview:t.asc_getData(),codepages:t.asc_getCodePages(),settings:t.asc_getRecommendedSettings(),api:n.api,handler:function(t,e){n.isShowOpenDialog=!1,"ok"==t&&n&&n.api&&(2==s?(o&&o.asc_setAdvancedOptions(e.textOptions),n.api.asc_DownloadAs(o)):n.api.asc_setAdvancedOptions(i,e.textOptions),n.loadMask&&n.loadMask.show()),n._state.openDlg=null}}):i==Asc.c_oAscAdvancedOptionsID.DRM&&(n._state.openDlg=new Common.Views.OpenDialog({title:Common.Views.OpenDialog.prototype.txtTitleProtected,closeFile:n.appOptions.canRequestClose,type:Common.Utils.importTextType.DRM,warning:!(n.appOptions.isDesktopApp&&n.appOptions.isOffline)&&"string"==typeof t,warningMsg:t,validatePwd:!!n._state.isDRM,handler:function(t,e){n.isShowOpenDialog=!1,"ok"==t?n&&n.api&&(n.api.asc_setAdvancedOptions(i,e.drmOptions),n.loadMask&&n.loadMask.show()):(Common.Gateway.requestClose(),Common.Controllers.Desktop.requestClose()),n._state.openDlg=null}}),n._state.isDRM=!0),n._state.openDlg&&(this.isShowOpenDialog=!0,this.loadMask&&this.loadMask.hide(),this.onLongActionEnd(Asc.c_oAscAsyncActionType.BlockInteraction,-256),n._state.openDlg.show()))},onActiveSheetChanged:function(t){this.appOptions.isEditMailMerge||this.appOptions.isEditDiagram||!window.editor_elements_prepared||(this.application.getController("Statusbar").selectTab(t),this.appOptions.isEditOle||!this.appOptions.canViewComments||this.dontCloseDummyComment||Common.NotificationCenter.trigger("comments:updatefilter",["doc","sheet"+this.api.asc_getWorksheetId(t)],!1))},onConfirmAction:function(t,i,s){var o=this;switch(t){case Asc.c_oAscConfirm.ConfirmReplaceRange:case Asc.c_oAscConfirm.ConfirmReplaceFormulaInTable:Common.UI.warning({title:this.notcriticalErrorTitle,msg:t==Asc.c_oAscConfirm.ConfirmReplaceRange?this.confirmMoveCellRange:this.confirmReplaceFormulaInTable,buttons:["yes","no"],primary:"yes",callback:_.bind(function(t){i&&i("yes"===t),"yes"==t&&o.onEditComplete(o.application.getController("DocumentHolder").getView("DocumentHolder"))},this)});break;case Asc.c_oAscConfirm.ConfirmPutMergeRange:Common.UI.warning({closable:!1,title:this.notcriticalErrorTitle,msg:this.confirmPutMergeRange,buttons:["ok"],primary:"ok",callback:_.bind(function(t){i&&i(),o.onEditComplete(o.application.getController("DocumentHolder").getView("DocumentHolder"))},this)});break;case Asc.c_oAscConfirm.ConfirmChangeProtectRange:new Common.Views.OpenDialog({title:this.txtUnlockRange,closable:!0,type:Common.Utils.importTextType.DRM,warning:!0,warningMsg:this.txtUnlockRangeWarning,txtOpenFile:this.txtUnlockRangeDescription,validatePwd:!1,handler:function(t,e){o.api&&i&&("ok"==t?o.api.asc_checkProtectedRangesPassword(e.drmOptions.asc_getPassword(),s,function(t){i(t,!1)}):i(!1,!0)),o.onEditComplete(o.application.getController("DocumentHolder").getView("DocumentHolder"))}}).show();break;case Asc.c_oAscConfirm.ConfirmAddCellWatches:Common.UI.warning({title:this.notcriticalErrorTitle,msg:s>Asc.c_nAscMaxAddCellWatchesCount?Common.Utils.String.format(this.confirmAddCellWatchesMax,Asc.c_nAscMaxAddCellWatchesCount):Common.Utils.String.format(this.confirmAddCellWatches,s),buttons:["yes","no"],primary:"yes",callback:_.bind(function(t){i&&i("yes"===t)},this)});break;case Asc.c_oAscConfirm.ConfirmMaxChangesSize:Common.UI.warning({title:this.notcriticalErrorTitle,msg:this.confirmMaxChangesSize,buttons:[{value:"ok",caption:this.textUndo,primary:!0},{value:"cancel",caption:this.textContinue}],maxwidth:600,callback:_.bind(function(t){i&&i("ok"===t),o.onEditComplete(o.application.getController("DocumentHolder").getView("DocumentHolder"))},this)});break;case Asc.c_oAscConfirm.ConfirmReplaceHeaderFooterPicture:Common.UI.warning({title:this.notcriticalErrorTitle,msg:this.confirmReplaceHFPicture,buttons:[{value:"ok",caption:this.textReplace,primary:!0},{value:"cancel",caption:this.textKeep}],maxwidth:600,callback:_.bind(function(t){i&&i("ok"===t)},this)})}},checkProtectedRange:function(i,s,o){var n,t=!(!this.api.asc_isProtectedSheet()||!this.api.asc_checkLockedCells())&&this.api.asc_checkProtectedRange();null===t?this.onError(Asc.c_oAscError.ID.ChangeOnProtectedSheet,Asc.c_oAscError.Level.NoCritical):t?new Common.Views.OpenDialog({title:(n=this).txtUnlockRange,closable:!0,type:Common.Utils.importTextType.DRM,warning:!0,warningMsg:this.txtUnlockRangeWarning,txtOpenFile:this.txtUnlockRangeDescription,validatePwd:!1,handler:function(t,e){"ok"==t&&n.api&&n.api.asc_checkActiveCellPassword(e.drmOptions.asc_getPassword(),function(t){t?i&&setTimeout(function(){i.apply(s,o)},1):Common.UI.warning({msg:n.errorWrongPassword,callback:function(){Common.NotificationCenter.trigger("edit:complete",n.toolbar)}})}),Common.NotificationCenter.trigger("edit:complete",n.toolbar)}}).show():i&&setTimeout(function(){i.apply(s,o)},1)},initNames:function(){this.shapeGroupNames=[this.txtLines,this.txtRectangles,this.txtBasicShapes,this.txtFiguredArrows,this.txtMath,this.txtCharts,this.txtStarsRibbons,this.txtCallouts,this.txtButtons]},fillAutoShapes:function(t,a){var l,r,e,c;_.isEmpty(a)||_.isEmpty(t)||a.length!=t.length||(r=[],e=(l=this).getCollection("ShapeGroups"),c={},e.reset(),_.each(t,function(t,e){var i=new Backbone.Collection([],{model:SSE.Models.ShapeModel}),s=[],o=18<a[e].length?7:6,n=35*Math.ceil(a[e].length/o)+3,o=30*o;_.each(a[e],function(t,e){var i=l["txtShape_"+t.Type];s.push({data:{shapeType:t.Type},tip:i||l.textShape+" "+(e+1),allowSelected:!0,selected:!1}),i&&(c[t.Type]=i)}),i.add(s),r.push({groupName:l.shapeGroupNames[e],groupStore:i,groupWidth:o,groupHeight:n})}),e.add(r),setTimeout(function(){l.getApplication().getController("Toolbar").onApiAutoShapes()},50),this.api.asc_setShapeNames(c))},fillTextArt:function(t){var i=[],e=this.getCollection("Common.Collections.TextArt");!t&&0<e.length&&(t=this.api.asc_getTextArtPreviews()),_.isEmpty(t)||(_.each(t,function(t,e){i.push({imageUrl:t,data:e,allowSelected:!0,selected:!1})}),e.reset(i))},fillCondFormatIcons:function(t){var i,e;_.isEmpty(t)||(i=[],e=this.getCollection("ConditionalFormatIcons"),_.each(t,function(t,e){i.push({icon:t,index:e})}),e.reset(i))},fillCondFormatIconsPresets:function(t){var i,e;_.isEmpty(t)||(i=[],e=this.getCollection("ConditionalFormatIconsPresets"),_.each(t,function(t,e){i.push({icons:t,data:e})}),e.reset(i))},updateThemeColors:function(){var t=this;t.appOptions.isEditOle||setTimeout(function(){t.getApplication().getController("RightMenu").UpdateThemeColors()},50),setTimeout(function(){t.getApplication().getController("Toolbar").updateThemeColors()},50),setTimeout(function(){t.getApplication().getController("Statusbar").updateThemeColors()},50)},onSendThemeColors:function(t,e){var i;Common.Utils.ThemeColor.setColors(t,e),window.styles_loaded&&(this.appOptions.isEditMailMerge||this.appOptions.isEditDiagram||this.updateThemeColors(),this.appOptions.isEditMailMerge||this.appOptions.isEditDiagram||this.appOptions.isEditOle||(i=this,setTimeout(function(){i.fillTextArt()},1)))},loadLanguages:function(t){this.languages=t,window.styles_loaded&&this.setLanguages()},setLanguages:function(){this.getApplication().getController("Spellcheck").setLanguages(this.languages)},onInternalCommand:function(t){if(t)switch(t.command){case"setChartData":this.setChartData(t.data);break;case"getChartData":this.getChartData();break;case"clearChartData":this.clearChartData();break;case"setMergeData":this.setMergeData(t.data);break;case"getMergeData":this.getMergeData();break;case"setOleData":this.setOleData(t.data);break;case"getOleData":this.getOleData();break;case"setAppDisabled":void 0!==this.isAppDisabled||t.data||(Common.NotificationCenter.trigger("layout:changed","main"),this.loadMask&&this.loadMask.isVisible()&&this.loadMask.updatePosition()),this.isAppDisabled=t.data;break;case"queryClose":Common.Utils.ModalWindow.isVisible()?Common.Gateway.internalMessage("canClose",{answer:!1}):(this.isFrameClosed=!0,this.api.asc_closeCellEditor(),this.appOptions.isEditOle&&Common.NotificationCenter.trigger("oleedit:close"),Common.UI.Menu.Manager.hideAll(),Common.Gateway.internalMessage("canClose",{mr:t.data.mr,answer:!0}));break;case"window:drag":this.isDiagramDrag=t.data;break;case"window:resize":this.isDiagramResize=t.data;break;case"processmouse":this.onProcessMouse(t.data);break;case"theme:change":document.documentElement.className=document.documentElement.className.replace(/theme-\w+\s?/,t.data),this.api.asc_setSkin("theme-dark"==t.data?"flatDark":"flat");break;case"generalToFrameData":this.api.asc_getInformationBetweenFrameAndGeneralEditor(t.data)}},setChartData:function(t){"object"==typeof t&&this.api&&(this.api.asc_addChartDrawingObject(t),this.isFrameClosed=!1,this.lastFrameError&&(this.onError(this.lastFrameError.id,this.lastFrameError.level,this.lastFrameError.errData,this.lastFrameError.callback),this.lastFrameError=void 0))},getChartData:function(){var t;this.api&&"object"==typeof(t=this.api.asc_getWordChartObject())&&Common.Gateway.internalMessage("chartData",{data:t})},clearChartData:function(){this.api&&this.api.asc_closeCellEditor()},setOleData:function(t){"object"!=typeof t&&"empty"!==t||!this.api||(this.api.asc_addTableOleObjectInOleEditor("object"==typeof t?t:void 0),this.isFrameClosed=!1,this.lastFrameError&&(this.onError(this.lastFrameError.id,this.lastFrameError.level,this.lastFrameError.errData,this.lastFrameError.callback),this.lastFrameError=void 0))},getOleData:function(){var t;this.api&&"object"==typeof(t=this.api.asc_getBinaryInfoOleObject())&&Common.Gateway.internalMessage("oleData",{data:t})},onOleEditorReady:function(){Common.Gateway.internalMessage("oleEditorReady",{})},setMergeData:function(t){"object"==typeof t&&this.api&&(this.api.asc_setData(t),this.isFrameClosed=!1,this.lastFrameError&&(this.onError(this.lastFrameError.id,this.lastFrameError.level,this.lastFrameError.errData,this.lastFrameError.callback),this.lastFrameError=void 0))},getMergeData:function(){var t;this.api&&"object"==typeof(t=this.api.asc_getData())&&Common.Gateway.internalMessage("mergeData",{data:t})},onSendFromFrameToGeneralEditor:function(t){Common.Gateway.internalMessage("frameToGeneralData",t)},unitsChanged:function(t){var e=null!==(e=Common.localStorage.getItem("sse-settings-unit"))?parseInt(e):Common.Utils.Metric.getDefaultMetric();Common.Utils.Metric.setCurrentMetric(e),Common.Utils.InternalSettings.set("sse-settings-unit",e),this.appOptions.isEdit&&(this.getApplication().getController("RightMenu").updateMetricUnit(),this.getApplication().getController("Toolbar").getView("Toolbar").updateMetricUnit()),this.getApplication().getController("Print").getView("PrintWithPreview").updateMetricUnit()},_compareActionStrong:function(t,e){return t.id===e.id&&t.type===e.type},_compareActionWeak:function(t,e){return t.type===e.type},onContextMenu:function(t){var e=t.target.getAttribute("data-can-copy"),i=t.target instanceof HTMLInputElement||t.target instanceof HTMLTextAreaElement;if(i&&"false"===e||!i&&"true"!==e)return t.stopPropagation(),t.preventDefault(),!1},onNamedRangeLocked:function(){$(".asc-window.modal.alert:visible").length<1&&Common.UI.alert({msg:this.errorCreateDefName,title:this.notcriticalErrorTitle,iconCls:"warn",buttons:["ok"],callback:_.bind(function(t){this.onEditComplete()},this)})},onProtectedRangeLocked:function(){$(".asc-window.modal.alert:visible").length<1&&Common.UI.alert({msg:this.errorCreateRange,title:this.notcriticalErrorTitle,iconCls:"warn",buttons:["ok"],callback:_.bind(function(t){this.onEditComplete()},this)})},onTryUndoInFastCollaborative:function(){var t=window.localStorage.getItem("sse-hide-try-undoredo");t&&1==parseInt(t)||Common.UI.info({width:500,msg:this.appOptions.canChangeCoAuthoring?this.textTryUndoRedo:this.textTryUndoRedoWarn,iconCls:"info",buttons:this.appOptions.canChangeCoAuthoring?["custom","cancel"]:["ok"],primary:this.appOptions.canChangeCoAuthoring?"custom":"ok",customButtonText:this.textStrict,dontshow:!0,callback:_.bind(function(t,e){e&&window.localStorage.setItem("sse-hide-try-undoredo",1),"custom"==t&&(Common.localStorage.setItem("sse-settings-coauthmode",0),this.api.asc_SetFastCollaborative(!1),Common.Utils.InternalSettings.set("sse-settings-coauthmode",!1),this.getApplication().getController("Common.Controllers.ReviewChanges").applySettings(),this._state.fastCoauth=!1),this.onEditComplete()},this)})},onAuthParticipantsChanged:function(t){var e=0;_.each(t,function(t){t.asc_getView()||e++}),this._state.usersCount=e},applySettings:function(){var t,e;this.appOptions.isEdit&&!this.appOptions.isOffline&&this.appOptions.canCoAuthoring&&(t=Common.localStorage.getItem("sse-settings-coauthmode"),e=this._state.fastCoauth,this._state.fastCoauth=null===t||1==parseInt(t),this._state.fastCoauth&&!e&&this.synchronizeChanges()),this.appOptions.canForcesave&&(this.appOptions.forcesave=Common.localStorage.getBool("sse-settings-forcesave",this.appOptions.canForcesave),Common.Utils.InternalSettings.set("sse-settings-forcesave",this.appOptions.forcesave),this.api.asc_setIsForceSaveOnUserSave(this.appOptions.forcesave))},onDocumentName:function(t){this.api.asc_setDocumentName(t),this.headerView.setDocumentCaption(t),this.updateWindowTitle(this.api.asc_isDocumentModified(),!0)},onMeta:function(t){var e=this.getApplication(),i=e.getController("LeftMenu").getView("LeftMenu").getMenu("file");e.getController("Viewport").getView("Common.Views.Header").setDocumentCaption(t.title),this.updateWindowTitle(this.api.asc_isDocumentModified(),!0),this.appOptions.spreadsheet.title=t.title,i.loadDocument({doc:this.appOptions.spreadsheet}),i.panels&&i.panels.info&&i.panels.info.updateInfo(this.appOptions.spreadsheet),e.getController("Common.Controllers.ReviewChanges").loadDocument({doc:this.appOptions.spreadsheet}),Common.Gateway.metaChange(t),this.appOptions.wopi&&(i=t.title.lastIndexOf("."),Common.Gateway.requestRename(0<i?t.title.substring(0,i):t.title))},onSave:function(e,t,i){Common.Gateway.off("asc_onSaveCallback"),Common.Gateway.on("asc_onSaveCallback",t=>{i({type:e.c,data:t},!0,"ok")}),Common.Gateway._postMessage({event:"onSave",data:{option:e,data:t}})},onPrint:function(){this.appOptions.canPrint&&!Common.Utils.ModalWindow.isVisible()&&Common.NotificationCenter.trigger("file:print",this)},onPrintUrl:function(e){if(this.iframePrint&&(this.iframePrint.parentNode.removeChild(this.iframePrint),this.iframePrint=null),!this.iframePrint){var i=this;this.iframePrint=document.createElement("iframe"),this.iframePrint.id="id-print-frame",this.iframePrint.style.display="none",this.iframePrint.style.visibility="hidden",this.iframePrint.style.position="fixed",this.iframePrint.style.right="0",this.iframePrint.style.bottom="0",document.body.appendChild(this.iframePrint),this.iframePrint.onload=function(){clearTimeout(t);try{i.iframePrint.contentWindow.focus(),i.iframePrint.contentWindow.print(),i.iframePrint.contentWindow.blur(),window.focus()}catch(t){i.onSave({actionType:101,downloadUrl:e})}};let t=setTimeout(this.iframePrint.onload,500)}e&&(this.iframePrint.src=e)},onPrintQuick:function(){var t,i,s;this.appOptions.canQuickPrint&&(t=Common.localStorage.getBool("sse-hide-quick-print-warning"),i=this,s=function(){var t=new Asc.asc_CAdjustPrint,e=(t.asc_setNativeOptions({quickPrint:!0}),new Asc.asc_CDownloadOptions(null,!0));e.asc_setAdvancedOptions(t),i.api.asc_Print(e),Common.component.Analytics.trackEvent("Print")},t?s.call(this):Common.UI.warning({msg:this.textTryQuickPrint,buttons:["yes","no"],primary:"yes",dontshow:!0,maxwidth:500,callback:function(t,e){e&&Common.localStorage.setBool("sse-hide-quick-print-warning",!0),"yes"===t&&setTimeout(s,1)}}))},warningDocumentIsLocked:function(){var e=this;Common.Utils.warningDocumentIsLocked({disablefunc:function(t){e.disableEditing(t,!0)}})},onRunAutostartMacroses:function(){var t,i=this;this.editorConfig.customization&&!1===this.editorConfig.customization.macros||(1==(t=Common.Utils.InternalSettings.get("sse-macros-mode"))?this.api.asc_runAutostartMacroses():0===t&&Common.UI.warning({msg:this.textHasMacros+"<br>",buttons:["yes","no"],primary:"yes",dontshow:!0,textDontShow:this.textRemember,callback:function(t,e){e&&(Common.Utils.InternalSettings.set("sse-macros-mode","yes"==t?1:2),Common.localStorage.setItem("sse-macros-mode","yes"==t?1:2)),"yes"==t&&setTimeout(function(){i.api.asc_runAutostartMacroses()},1)}}))},onMacrosPermissionRequest:function(t,i){if(t&&i){if(this.stackMacrosRequests.push({url:t,callback:i}),1<this.stackMacrosRequests.length)return}else{if(!(0<this.stackMacrosRequests.length))return;t=this.stackMacrosRequests[0].url,i=this.stackMacrosRequests[0].callback}var s=this,e=Common.Utils.InternalSettings.get("sse-allow-macros-request");0<e?(i&&i(1===e),this.stackMacrosRequests.shift(),this.onMacrosPermissionRequest()):Common.UI.warning({msg:this.textRequestMacros.replace("%1",t),buttons:["yes","no"],primary:"yes",dontshow:!0,textDontShow:this.textRememberMacros,maxwidth:600,callback:function(t,e){e&&(Common.Utils.InternalSettings.set("sse-allow-macros-request","yes"==t?1:2),Common.localStorage.setItem("sse-allow-macros-request","yes"==t?1:2)),setTimeout(function(){i&&i("yes"==t),s.stackMacrosRequests.shift(),s.onMacrosPermissionRequest()},1)}})},loadAutoCorrectSettings:function(){var t=Common.localStorage.getItem("sse-settings-math-correct-add"),e=(Common.Utils.InternalSettings.set("sse-settings-math-correct-add",t),t?JSON.parse(t):[]),t=Common.localStorage.getItem("sse-settings-math-correct-rem"),i=(Common.Utils.InternalSettings.set("sse-settings-math-correct-rem",t),t?JSON.parse(t):[]);t=Common.localStorage.getBool("sse-settings-math-correct-replace-type",!0),Common.Utils.InternalSettings.set("sse-settings-math-correct-replace-type",t),this.api.asc_refreshOnStartAutoCorrectMathSymbols(i,e,t),t=Common.localStorage.getItem("sse-settings-rec-functions-add"),Common.Utils.InternalSettings.set("sse-settings-rec-functions-add",t),e=t?JSON.parse(t):[],t=Common.localStorage.getItem("sse-settings-rec-functions-rem"),Common.Utils.InternalSettings.set("sse-settings-rec-functions-rem",t),i=t?JSON.parse(t):[],this.api.asc_refreshOnStartAutoCorrectMathFunctions(i,e),t=Common.localStorage.getBool("sse-settings-autoformat-new-rows",!0),Common.Utils.InternalSettings.set("sse-settings-autoformat-new-rows",t),this.api.asc_setIncludeNewRowColTable(t),t=Common.localStorage.getBool("sse-settings-autoformat-hyperlink",!0),Common.Utils.InternalSettings.set("sse-settings-autoformat-hyperlink",t),this.api.asc_SetAutoCorrectHyperlinks(t)},showRenameUserDialog:function(){var s;this._renameDialog||((s=this)._renameDialog=new Common.Views.UserNameDialog({label:this.textRenameLabel,error:this.textRenameError,value:Common.Utils.InternalSettings.get("guest-username")||"",check:Common.Utils.InternalSettings.get("save-guest-username")||!1,validation:function(t){return t.length<128||s.textLongName},handler:function(t,e){var i;"ok"==t&&(t=e.input?e.input+" ("+s.textGuest+")":s.textAnonymous,(i=new Asc.asc_CUserInfo).put_FullName(t),(t=new Asc.asc_CDocInfo).put_UserInfo(i),s.api.asc_changeDocInfo(t),e.checkbox?Common.localStorage.setItem("guest-username",e.input):Common.localStorage.removeItem("guest-username"),Common.Utils.InternalSettings.set("guest-username",e.input),Common.Utils.InternalSettings.set("save-guest-username",e.checkbox))}}),this._renameDialog.on("close",function(){s._renameDialog=void 0}),this._renameDialog.show(Common.Utils.innerWidth()-this._renameDialog.options.width-15,30))},onRefreshHistory:function(t){if(this.appOptions.canUseHistory)if(this.loadMask&&this.loadMask.hide(),t.data.error||!t.data.history)(e=this.getApplication().getCollection("Common.Collections.HistoryVersions"))&&0<e.size()&&e.each(function(t){t.set("canRestore",!1)}),Common.UI.alert({title:this.notcriticalErrorTitle,msg:t.data.error||this.txtErrorLoadHistory,iconCls:"warn",buttons:["ok"],callback:_.bind(function(t){this.onEditComplete()},this)});else{this.api.asc_coAuthoringDisconnect(),this.headerView.setCanRename(!1),this.headerView.getButton("users")&&this.headerView.getButton("users").hide(),this.headerView.getButton("share")&&this.headerView.getButton("share").setVisible(!1),this.getApplication().getController("LeftMenu").getView("LeftMenu").showHistory(),this.disableEditing(!0),this._renameDialog&&this._renameDialog.close();var e,i=t.data.history,s=null;if(e=this.getApplication().getCollection("Common.Collections.HistoryVersions")){for(var o,n,a=[],l=-1,r=-1,c=[],d=this.getApplication().getCollection("Common.Collections.HistoryUsers"),h=null,p=0,m=i.length-1;0<=m;m--)if(void 0!==(o=i[m]).versionGroup&&null!==o.versionGroup||(o.versionGroup=o.version),o){if(o.user||(o.user={}),n=0<m&&i[m-1]?i[m-1].key:o.key+"0",(h=d.findUser(o.user.id))||(h=new Common.Models.User({id:o.user.id,username:o.user.name,colorval:Asc.c_oAscArrUserColors[p],color:this.generateUserColor(Asc.c_oAscArrUserColors[p++])}),d.add(h)),a.push(new Common.Models.HistoryVersion({version:o.versionGroup,revision:o.version,userid:o.user.id,username:o.user.name,usercolor:h.get("color"),created:o.created,docId:o.key,markedAsVersion:l!==o.versionGroup,selected:t.data.currentVersion==o.version,canRestore:this.appOptions.canHistoryRestore&&m<i.length-1,isExpanded:!0,serverVersion:o.serverVersion,fileType:"xslx"})),t.data.currentVersion==o.version&&(s=a[a.length-1]),l=o.versionGroup,r!==o.version){for(r=o.version,c.reverse(),g=0;g<c.length;g++)a[a.length-g-2].set("arrColors",c);c=[]}c.push(h.get("colorval"));var u,g,b=o.changes;if(b&&0<b.length){if(a[a.length-1].set("docIdPrev",n),!_.isEmpty(o.serverVersion)&&o.serverVersion==this.appOptions.buildVersion)for(a[a.length-1].set("changeid",b.length-1),a[a.length-1].set("hasChanges",1<b.length),g=b.length-2;0<=g;g--)u=b[g],(h=d.findUser(u.user.id))||(h=new Common.Models.User({id:u.user.id,username:u.user.name,colorval:Asc.c_oAscArrUserColors[p],color:this.generateUserColor(Asc.c_oAscArrUserColors[p++])}),d.add(h)),a.push(new Common.Models.HistoryVersion({version:o.versionGroup,revision:o.version,changeid:g,userid:u.user.id,username:u.user.name,usercolor:h.get("color"),created:u.created,docId:o.key,docIdPrev:n,selected:!1,canRestore:this.appOptions.canHistoryRestore&&this.appOptions.canDownload,isRevision:!1,isVisible:!0,serverVersion:o.serverVersion,fileType:"xslx"})),c.push(h.get("colorval"))}else 0==m&&1==i.length&&a[a.length-1].set("docId",o.key+"1")}if(0<c.length){for(c.reverse(),g=0;g<c.length;g++)a[a.length-g-1].set("arrColors",c);c=[]}e.reset(a),null===s&&0<e.size()&&(s=e.at(0)).set("selected",!0)}}},DisableVersionHistory:function(){this.editorConfig.canUseHistory=!1,this.appOptions.canUseHistory=!1},generateUserColor:function(t){return"#"+("000000"+t.toString(16)).substr(-6)},onGrabFocus:function(){this.getApplication().getController("DocumentHolder").getView().focus()},onLanguageLoaded:function(){return!!Common.Locale.getCurrentLanguage()||(Common.UI.warning({msg:this.errorLang,buttons:[],closable:!1}),!1)},onCollaborativeChanges:function(){this._state.hasCollaborativeChanges||(this._state.hasCollaborativeChanges=!0,this.appOptions.isEdit&&this.getApplication().getController("Statusbar").setStatusCaption(this.textNeedSynchronize,!0))},synchronizeChanges:function(){this.toolbarView&&this.toolbarView.synchronizeChanges(),this._state.hasCollaborativeChanges=!1},onConvertEquationToMath:function(i){var e=this,t=this.textConvertEquation+'<br><br><a id="id-equation-convert-help" style="cursor: pointer;">'+this.textLearnMore+"</a>",s=Common.UI.warning({width:500,msg:t,buttons:["yes","cancel"],primary:"yes",dontshow:!0,textDontShow:this.textApplyAll,callback:_.bind(function(t,e){"yes"==t&&this.api.asc_ConvertEquationToMath(i,e),this.onEditComplete()},this)});s.$window.find("#id-equation-convert-help").on("click",function(t){s&&s.close(),e.getApplication().getController("LeftMenu").getView("LeftMenu").showMenu("file:help","UsageInstructions/InsertEquation.htm#convertequation")})}}),SSE.Controllers.Main||{}))}),define("common/main/lib/view/DocumentAccessDialog",["common/main/lib/component/Window","common/main/lib/component/LoadMask"],function(){"use strict";Common.Views.DocumentAccessDialog=Common.UI.Window.extend(_.extend({initialize:function(t){var e={};_.extend(e,{title:this.textTitle,width:600,height:536,header:!0},t),this.template=['<div id="id-sharing-placeholder"></div>'].join(""),e.tpl=_.template(this.template)(e),this.settingsurl=t.settingsurl||"",Common.UI.Window.prototype.initialize.call(this,e)},render:function(){Common.UI.Window.prototype.render.call(this),this.$window.find("> .body").css({height:"auto",overflow:"hidden"});var t=document.createElement("iframe"),e=(t.width="100%",t.height=500,t.align="top",t.frameBorder=0,t.scrolling="no",t.onload=_.bind(this._onLoad,this),$("#id-sharing-placeholder").append(t),this.loadMask=new Common.UI.LoadMask({owner:$("#id-sharing-placeholder")}),this.loadMask.setTitle(this.textLoading),this.loadMask.show(),t.src=this.settingsurl,this);this._eventfunc=function(t){e._onWindowMessage(t)},this._bindWindowEvents.call(this),this.on("close",function(t){e._unbindWindowEvents()})},_bindWindowEvents:function(){window.addEventListener?window.addEventListener("message",this._eventfunc,!1):window.attachEvent&&window.attachEvent("onmessage",this._eventfunc)},_unbindWindowEvents:function(){window.removeEventListener?window.removeEventListener("message",this._eventfunc):window.detachEvent&&window.detachEvent("onmessage",this._eventfunc)},_onWindowMessage:function(t){if(t&&window.JSON)try{this._onMessage.call(this,window.JSON.parse(t.data))}catch(t){}},_onMessage:function(t){t&&"onlyoffice"==t.Referer&&(t.needUpdate&&this.trigger("accessrights",this,t.sharingSettings),Common.NotificationCenter.trigger("window:close",this))},_onLoad:function(){this.loadMask&&this.loadMask.hide()}},Common.Views.DocumentAccessDialog||{}))}),define("text!common/main/lib/template/AutoCorrectDialog.template",[],function(){return'<div id="id-autocorrect-dialog-settings-math" class="settings-panel active">\n    <div class="inner-content">\n        <table cols="1" style="width: 100%;">\n        <tr>\n            <td style="padding-bottom: 8px;">\n                <div id="auto-correct-chb-replace-type"></div>\n            </td>\n        </tr>\n        <tr>\n            <td>\n                <label style="width: 117px;"><%= scope.textReplace %>:</label>\n                <label><%= scope.textBy %>:</label>\n                </td>\n            </tr>\n        <tr>\n            <td>\n                <div id="auto-correct-replace" class="margin-right-2" style="height:22px;width: 115px;display: inline-block;"></div>\n                <div id="auto-correct-by" style="height:22px;width: 234px;display: inline-block;"></div>\n                </td>\n            </tr>\n        <tr>\n            <td style="padding-bottom: 8px;">\n                <div id="auto-correct-math-list" class="" style="width:100%; height: 208px;"></div>\n                </td>\n            </tr>\n        <tr>\n            <td style="padding-bottom: 8px;">\n                <button type="button" class="btn btn-text-default auto" id="auto-correct-btn-reset" style="min-width: 86px;"><%= scope.textResetAll %></button>\n                <button type="button" class="btn btn-text-default auto float-right" id="auto-correct-btn-delete" style="min-width: 86px;"><%= scope.textDelete %></button>\n                <button type="button" class="btn btn-text-default auto float-right margin-right-5" id="auto-correct-btn-edit" style="min-width: 86px;"><%= scope.textAdd %></button>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-autocorrect-dialog-settings-recognized" class="settings-panel">\n    <div class="inner-content">\n        <table cols="1" style="width: 100%;">\n            <tr>\n                <td style="padding-bottom: 8px;">\n                    <label><%= scope.textRecognizedDesc %></label>\n                </td>\n            </tr>\n            <tr>\n                <td>\n                    <div id="auto-correct-rec-find" style="height:22px;width: 100%;margin-bottom: 4px;"></div>\n                </td>\n            </tr>\n            <tr>\n                <td style="padding-bottom: 8px;">\n                    <div id="auto-correct-recognized-list" class="" style="width:100%; height: 208px;"></div>\n                </td>\n            </tr>\n            <tr>\n                <td style="padding-bottom: 8px;">\n                    <button type="button" class="btn btn-text-default auto" id="auto-correct-btn-rec-reset" style="min-width: 86px;"><%= scope.textResetAll %></button>\n                    <button type="button" class="btn btn-text-default auto float-right" id="auto-correct-btn-rec-delete" style="min-width: 86px;"><%= scope.textDelete %></button>\n                    <button type="button" class="btn btn-text-default auto float-right margin-right-5" id="auto-correct-btn-rec-edit" style="min-width: 86px;"><%= scope.textAdd %></button>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-autocorrect-dialog-settings-de-autoformat" class="settings-panel">\n    <div class="inner-content" style="width: 100%;">\n        <div class="padding-small">\n            <label class="header"><%= scope.textReplaceText %></label>\n        </div>\n        <div class="padding-small">\n            <div class="padding-small" id="id-autocorrect-dialog-chk-quotes"></div>\n            <div class="padding-small" id="id-autocorrect-dialog-chk-hyphens"></div>\n            <div class="padding-small"  id="id-autocorrect-dialog-chk-hyperlink"></div>\n            <div class="padding-small" id="id-autocorrect-dialog-chk-double-space"></div>\n        </div>\n        <div class="padding-small">\n            <label class="header"><%= scope.textApplyText %></label>\n        </div>\n        <div class="padding-small">\n            <div class="padding-small" id="id-autocorrect-dialog-chk-bulleted"></div>\n            <div class="padding-small" id="id-autocorrect-dialog-chk-numbered"></div>\n        </div>\n    </div>\n</div>\n<div id="id-autocorrect-dialog-settings-sse-autoformat" class="settings-panel">\n    <div class="inner-content" style="width: 100%;">\n        <div class="padding-small">\n            <label class="header"><%= scope.textReplaceText %></label>\n        </div>\n        <div class="padding-small">\n            <div class="padding-small" id="id-autocorrect-dialog-chk-hyperlink"></div>\n        </div>\n        <div class="padding-small">\n            <label class="header"><%= scope.textApplyAsWork %></label>\n        </div>\n        <div class="padding-small">\n            <div class="padding-small" id="id-autocorrect-dialog-chk-new-rows"></div>\n        </div>\n    </div>\n</div>\n<div id="id-autocorrect-dialog-settings-exceptions" class="settings-panel">\n    <div class="inner-content">\n        <table cols="1" style="width: 100%;">\n            <tr>\n                <td style="padding-bottom: 12px;">\n                    <div id="auto-correct-exceptions-chk-sentence" style="padding-bottom: 8px;"></div>\n                    <div id="auto-correct-exceptions-chk-cells"></div>\n                </td>\n            </tr>\n            <tr>\n                <td>\n                    <label><%= scope.textForLangFL %></label>\n                </td>\n            </tr>\n            <tr>\n                <td style="padding-bottom: 12px;">\n                    <div id="auto-correct-exceptions-lang" style="display: inline-block;vertical-align: middle;"></div>\n                </td>\n            </tr>\n            <tr>\n                <td>\n                    <label><%= scope.textFLDont %></label>\n                    <div id="auto-correct-exceptions-find" style="height:22px;width: 100%;margin-bottom: 4px;"></div>\n                </td>\n            </tr>\n            <tr>\n                <td style="padding-bottom: 8px;">\n                    <div id="auto-correct-exceptions-list" class="" style="width:100%; height: 139px;"></div>\n                </td>\n            </tr>\n            <tr>\n                <td style="padding-bottom: 18px;">\n                    <button type="button" class="btn btn-text-default auto" id="auto-correct-btn-exceptions-reset" style="min-width: 86px;"><%= scope.textResetAll %></button>\n                    <button type="button" class="btn btn-text-default auto float-right" id="auto-correct-btn-exceptions-delete" style="min-width: 86px;"><%= scope.textDelete %></button>\n                    <button type="button" class="btn btn-text-default auto float-right margin-right-5" id="auto-correct-btn-exceptions-edit" style="min-width: 86px;"><%= scope.textAdd %></button>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n'}),void 0===Common&&(Common={}),define("common/main/lib/view/AutoCorrectDialog",["text!common/main/lib/template/AutoCorrectDialog.template","common/main/lib/component/ListView","common/main/lib/component/Window","common/main/lib/component/CheckBox"],function(n){"use strict";var r=new Common.UI.DataViewStore,a=new Common.UI.DataViewStore,l=new Common.UI.DataViewStore,c=[1033,1049];Common.Views.AutoCorrectDialog=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:375,height:430,buttons:null,toggleGroup:"autocorrect-dialog-group"},initialize:function(t){var e=Common.localStorage.getKeysFilter(),i=this,e=(this.appPrefix=e&&e.length?e.split(",")[0]:"",[{panelId:"id-autocorrect-dialog-settings-math",panelCaption:this.textMathCorrect},{panelId:"id-autocorrect-dialog-settings-recognized",panelCaption:this.textRecognized}]),s=("de-"==this.appPrefix||"pe-"==this.appPrefix?(e.push({panelId:"id-autocorrect-dialog-settings-de-autoformat",panelCaption:this.textAutoFormat}),e.push({panelId:"id-autocorrect-dialog-settings-exceptions",panelCaption:this.textAutoCorrect})):"sse-"==this.appPrefix&&e.push({panelId:"id-autocorrect-dialog-settings-sse-autoformat",panelCaption:this.textAutoFormat}),_.extend(this.options,{title:this.textTitle,storageName:this.appPrefix+"autocorrect-dialog-category",items:e,template:['<div class="box" style="height:'+(this.options.height-85)+'px;">','<div class="menu-panel" style="overflow: hidden;">',"<% _.each(items, function(item) { %>",'<button class="btn btn-category" content-target="<%= item.panelId %>"><span class=""><%= item.panelCaption %></span></button>',"<% }); %>","</div>",'<div class="separator"></div>','<div class="content-panel">'+_.template(n)({scope:this})+"</div>","</div>",'<div class="separator horizontal"></div>','<div class="footer center">','<button class="btn normal dlg-btn" result="cancel" style="width: 86px;">'+this.closeButtonText+"</button>","</div>"].join("")},t||{}),this.api=this.options.api,this.appPrefix+"settings-math-correct"),o=Common.Utils.InternalSettings.get(s+"-add");this.arrAdd=o?JSON.parse(o):[],o=Common.Utils.InternalSettings.get(s+"-rem"),this.arrRem=o?JSON.parse(o):[],s=this.appPrefix+"settings-rec-functions",o=Common.Utils.InternalSettings.get(s+"-add"),this.arrAddRec=o?JSON.parse(o):[],o=Common.Utils.InternalSettings.get(s+"-rem"),this.arrRemRec=o?JSON.parse(o):[],this.arrAddExceptions={},this.arrRemExceptions={},c.forEach(function(t){s=i.appPrefix+"settings-letter-exception",o=Common.Utils.InternalSettings.get(s+"-add-"+t),i.arrAddExceptions[t]=o?JSON.parse(o):[],o=Common.Utils.InternalSettings.get(s+"-rem-"+t),i.arrRemExceptions[t]=o?JSON.parse(o):[]}),Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var i,e,t,s=this.getChild(),o=this,n=s.find("#id-autocorrect-dialog-settings-"+("pe-"==this.appPrefix?"de-":this.appPrefix)+"autoformat");this.chReplaceType=new Common.UI.CheckBox({el:s.find("#auto-correct-chb-replace-type"),labelText:this.textReplaceType,value:Common.Utils.InternalSettings.get(this.appPrefix+"settings-math-correct-replace-type")}).on("change",function(t,e,i,s){t="checked"===t.getValue();Common.localStorage.setBool(o.appPrefix+"settings-math-correct-replace-type",t),Common.Utils.InternalSettings.set(o.appPrefix+"settings-math-correct-replace-type",t),o.api.asc_updateFlagAutoCorrectMathSymbols(t)}),this.onInitList(),this.mathList=new Common.UI.ListView({el:s.find("#auto-correct-math-list"),store:new Common.UI.DataViewStore(r.slice(0,9)),simpleAddMode:!1,template:_.template(['<div class="listview inner" style=""></div>'].join("")),itemTemplate:_.template(['<div id="<%= id %>" class="list-item" style="pointer-events:none;width: 100%;display:flex;">','<div class="padding-right-5" style="width:110px;overflow: hidden;text-overflow: ellipsis;<% if (defaultDisabled) { %> font-style:italic; opacity: 0.5;<% } %>"><%= replaced %></div>','<div style="width:230px;overflow-x: clip;overflow-y:visible;text-overflow: ellipsis;flex-grow:1;font-family: Cambria Math;font-size:13px;white-space: nowrap;<% if (defaultDisabled) { %> font-style:italic; opacity: 0.5;<% } %>"><%= by %></div>',"</div>"].join("")),scrollAlwaysVisible:!0,tabindex:1}),this.mathList.on("item:select",_.bind(this.onSelectMathItem,this)),this.inputReplace=new Common.UI.InputField({el:s.find("#auto-correct-replace"),allowBlank:!0,validateOnChange:!0,maxLength:31,validation:function(){return!0}}).on("changing",function(t,e){var i;e.length&&(i=o.mathList.store.find(function(t){if(0==t.get("replaced").indexOf(e))return!0}))&&(o.mathList.scrollToRecord(i,!0),i.get("replaced")==e?o.mathList.selectRecord(i,!0):i=null),i||o.mathList.deselectAll(),o.updateControls(i)}),this.inputReplace.cmpEl.find("input").on("keydown",function(t){"ArrowDown"==t.key&&((t=o.mathList.getSelectedRec()||o.mathList.store.at(0))&&(o.mathList.selectRecord(t),o.mathList.scrollToRecord(t)),_.delay(function(){o.mathList.focus()},10))}),this.inputBy=new Common.UI.InputField({el:s.find("#auto-correct-by"),allowBlank:!0,validateOnChange:!0,maxLength:255,validation:function(){return!0}}).on("changing",function(t,e){o.updateControls()}),this.btnReset=new Common.UI.Button({el:s.find("#auto-correct-btn-reset")}),this.btnReset.on("click",_.bind(this.onResetToDefault,this)),this.btnEdit=new Common.UI.Button({el:s.find("#auto-correct-btn-edit")}),this.btnEdit.on("click",_.bind(this.onEdit,this,!1)),this.btnDelete=new Common.UI.Button({el:s.find("#auto-correct-btn-delete")}),this.btnDelete.on("click",_.bind(this.onDelete,this,!1)),this.onInitRecList(),this.mathRecList=new Common.UI.ListView({el:s.find("#auto-correct-recognized-list"),store:new Common.UI.DataViewStore(a.slice(0,9)),simpleAddMode:!1,template:_.template(['<div class="listview inner" style=""></div>'].join("")),itemTemplate:_.template(['<div id="<%= id %>" class="list-item" style="width: 340px;text-overflow: ellipsis;overflow: hidden;<% if (defaultDisabled) { %> font-style:italic; opacity: 0.5;<% } %>"><%= value %></div>'].join("")),scrollAlwaysVisible:!0,tabindex:1}),this.mathRecList.on("item:select",_.bind(this.onSelectRecItem,this)),this.inputRecFind=new Common.UI.InputField({el:s.find("#auto-correct-rec-find"),allowBlank:!0,validateOnChange:!0,maxLength:255,validation:function(){return!0}}).on("changing",function(t,e){var i;e.length&&(i=o.mathRecList.store.find(function(t){if(0==t.get("value").indexOf(e))return!0}))&&(o.mathRecList.scrollToRecord(i,!0),i.get("value")==e?o.mathRecList.selectRecord(i,!0):i=null),i||o.mathRecList.deselectAll(),o.updateRecControls(i)}),this.inputRecFind.cmpEl.find("input").on("keydown",function(t){"ArrowDown"==t.key&&((t=o.mathRecList.getSelectedRec()||o.mathRecList.store.at(0))&&(o.mathRecList.selectRecord(t),o.mathRecList.scrollToRecord(t)),_.delay(function(){o.mathRecList.focus()},10))}),this.btnResetRec=new Common.UI.Button({el:s.find("#auto-correct-btn-rec-reset")}),this.btnResetRec.on("click",_.bind(this.onResetRecToDefault,this)),this.btnAddRec=new Common.UI.Button({el:s.find("#auto-correct-btn-rec-edit")}),this.btnAddRec.on("click",_.bind(this.onAddRec,this,!1)),this.btnDeleteRec=new Common.UI.Button({el:s.find("#auto-correct-btn-rec-delete")}),this.btnDeleteRec.on("click",_.bind(this.onDeleteRec,this,!1)),"de-"==this.appPrefix||"pe-"==this.appPrefix?(this.chQuotes=new Common.UI.CheckBox({el:s.find("#id-autocorrect-dialog-chk-quotes"),labelText:this.textQuotes,value:Common.Utils.InternalSettings.get(this.appPrefix+"settings-autoformat-smart-quotes")}).on("change",function(t,e,i,s){t="checked"===t.getValue();Common.localStorage.setBool(o.appPrefix+"settings-autoformat-smart-quotes",t),Common.Utils.InternalSettings.set(o.appPrefix+"settings-autoformat-smart-quotes",t),o.api.asc_SetAutoCorrectSmartQuotes(t)}),this.chHyphens=new Common.UI.CheckBox({el:s.find("#id-autocorrect-dialog-chk-hyphens"),labelText:this.textHyphens,value:Common.Utils.InternalSettings.get(this.appPrefix+"settings-autoformat-hyphens")}).on("change",function(t,e,i,s){t="checked"===t.getValue();Common.localStorage.setBool(o.appPrefix+"settings-autoformat-hyphens",t),Common.Utils.InternalSettings.set(o.appPrefix+"settings-autoformat-hyphens",t),o.api.asc_SetAutoCorrectHyphensWithDash(t)}),this.chBulleted=new Common.UI.CheckBox({el:s.find("#id-autocorrect-dialog-chk-bulleted"),labelText:this.textBulleted,value:Common.Utils.InternalSettings.get(this.appPrefix+"settings-autoformat-bulleted")}).on("change",function(t,e,i,s){t="checked"===t.getValue();Common.localStorage.setBool(o.appPrefix+"settings-autoformat-bulleted",t),Common.Utils.InternalSettings.set(o.appPrefix+"settings-autoformat-bulleted",t),o.api.asc_SetAutomaticBulletedLists(t)}),this.chNumbered=new Common.UI.CheckBox({el:s.find("#id-autocorrect-dialog-chk-numbered"),labelText:this.textNumbered,value:Common.Utils.InternalSettings.get(this.appPrefix+"settings-autoformat-numbered")}).on("change",function(t,e,i,s){t="checked"===t.getValue();Common.localStorage.setBool(o.appPrefix+"settings-autoformat-numbered",t),Common.Utils.InternalSettings.set(o.appPrefix+"settings-autoformat-numbered",t),o.api.asc_SetAutomaticNumberedLists(t)}),this.chDoubleSpaces=new Common.UI.CheckBox({el:n.find("#id-autocorrect-dialog-chk-double-space"),labelText:this.textDoubleSpaces,value:Common.Utils.InternalSettings.get(this.appPrefix+"settings-autoformat-double-space")}).on("change",function(t,e,i,s){t="checked"===t.getValue();Common.localStorage.setBool(o.appPrefix+"settings-autoformat-double-space",t),Common.Utils.InternalSettings.set(o.appPrefix+"settings-autoformat-double-space",t),o.api.asc_SetAutoCorrectDoubleSpaceWithPeriod(t)}),i=Common.Utils.InternalSettings.get("settings-letter-exception-lang"),this.exceptionsLangCmb=new Common.UI.ComboBox({el:s.find("#auto-correct-exceptions-lang"),style:"width: 145px;",menuStyle:"min-width:100%;",editable:!1,takeFocusOnClose:!0,menuCls:"menu-aligned",cls:"input-group-nr",dataHintDirection:"bottom",data:c.map(function(t){var e=Common.util.LanguageInfo.getLocalLanguageName(t);return{displayValue:e[1],shortName:e[0],value:t}})}).on("selected",function(t,e){i!=e.value&&(i=e.value,Common.Utils.InternalSettings.set("settings-letter-exception-lang",i),o.onInitExceptionsList(!0),o.onChangeInputException(o.exceptionsFindInput,o.exceptionsFindInput.getValue()))}),i||((t=this.exceptionsLangCmb.store.findWhere({value:this.api.asc_getDefaultLanguage()}))||(e=Common.util.LanguageInfo.getLocalLanguageName(this.api.asc_getDefaultLanguage())[0].split(/[\-\_]/)[0],t=this.exceptionsLangCmb.store.find(function(t){return 0==t.get("shortName").indexOf(e)})),t&&(i=t.get("value"))),this.exceptionsLangCmb.setValue(i||c[0]),this.onInitExceptionsList(!0),this.exceptionsList=new Common.UI.ListView({el:s.find("#auto-correct-exceptions-list"),store:new Common.UI.DataViewStore(l.slice(0,6)),simpleAddMode:!1,template:_.template(['<div class="listview inner" style=""></div>'].join("")),itemTemplate:_.template(['<div id="<%= id %>" class="list-item" style="width: 340px;text-overflow: ellipsis;overflow: hidden;<% if (defaultDisabled) { %> font-style:italic; opacity: 0.5;<% } %>"><%= value + "."%></div>'].join("")),scrollAlwaysVisible:!0,tabindex:1}),this.exceptionsList.on("item:select",_.bind(this.onSelectExceptionItem,this)),this.exceptionsFindInput=new Common.UI.InputField({el:s.find("#auto-correct-exceptions-find"),allowBlank:!0,validateOnChange:!0,maxLength:255,validation:function(){return!0}}).on("changing",_.bind(this.onChangeInputException,this)),this.exceptionsFindInput.cmpEl.find("input").on("keydown",function(t){"ArrowDown"==t.key&&((t=o.exceptionsList.getSelectedRec()||o.exceptionsList.store.at(0))&&(o.exceptionsList.selectRecord(t),o.exceptionsList.scrollToRecord(t)),_.delay(function(){o.exceptionsList.focus()},10))}),this.btnResetExceptions=new Common.UI.Button({el:s.find("#auto-correct-btn-exceptions-reset")}),this.btnResetExceptions.on("click",_.bind(this.onResetExceptionsToDefault,this)),this.btnAddExceptions=new Common.UI.Button({el:s.find("#auto-correct-btn-exceptions-edit")}),this.btnAddExceptions.on("click",_.bind(this.onAddException,this,!1)),this.btnDeleteExceptions=new Common.UI.Button({el:s.find("#auto-correct-btn-exceptions-delete")}),this.btnDeleteExceptions.on("click",_.bind(this.onDeleteException,this,!1)),this.chkSentenceExceptions=new Common.UI.CheckBox({el:s.find("#auto-correct-exceptions-chk-sentence"),labelText:this.textFLSentence,value:Common.Utils.InternalSettings.get(this.appPrefix+"settings-letter-exception-sentence")}).on("change",function(t,e,i,s){t="checked"===t.getValue();Common.localStorage.setBool(o.appPrefix+"settings-letter-exception-sentence",t),Common.Utils.InternalSettings.set(o.appPrefix+"settings-letter-exception-sentence",t),o.api.asc_SetAutoCorrectFirstLetterOfSentences&&o.api.asc_SetAutoCorrectFirstLetterOfSentences(t)}),this.chkSentenceCells=new Common.UI.CheckBox({el:s.find("#auto-correct-exceptions-chk-cells"),labelText:this.textFLCells,value:Common.Utils.InternalSettings.get(this.appPrefix+"settings-letter-exception-cells")}).on("change",function(t,e,i,s){t="checked"===t.getValue();Common.localStorage.setBool(o.appPrefix+"settings-letter-exception-cells",t),Common.Utils.InternalSettings.set(o.appPrefix+"settings-letter-exception-cells",t),o.api.asc_SetAutoCorrectFirstLetterOfSentences&&o.api.asc_SetAutoCorrectFirstLetterOfSentences(t)}),this.btnsCategory[3].on("click",_.bind(this.onAutocorrectCategoryClick,this,!1))):"sse-"==this.appPrefix&&(this.chNewRows=new Common.UI.CheckBox({el:s.find("#id-autocorrect-dialog-chk-new-rows"),labelText:this.textNewRowCol,value:Common.Utils.InternalSettings.get(this.appPrefix+"settings-autoformat-new-rows")}).on("change",function(t,e,i,s){t="checked"===t.getValue();Common.localStorage.setBool(o.appPrefix+"settings-autoformat-new-rows",t),Common.Utils.InternalSettings.set(o.appPrefix+"settings-autoformat-new-rows",t),o.api.asc_setIncludeNewRowColTable(t)})),this.chHyperlink=new Common.UI.CheckBox({el:n.find("#id-autocorrect-dialog-chk-hyperlink"),labelText:this.textHyperlink,value:Common.Utils.InternalSettings.get(this.appPrefix+"settings-autoformat-hyperlink")}).on("change",function(t,e,i,s){t="checked"===t.getValue();Common.localStorage.setBool(o.appPrefix+"settings-autoformat-hyperlink",t),Common.Utils.InternalSettings.set(o.appPrefix+"settings-autoformat-hyperlink",t),o.api.asc_SetAutoCorrectHyperlinks(t)}),this.btnsCategory[0].on("click",_.bind(this.onMathCategoryClick,this,!1)),this.btnsCategory[1].on("click",_.bind(this.onRecCategoryClick,this,!1)),this.btnsCategory[2].on("click",_.bind(this.onAutoformatCategoryClick,this,!1)),this.afterRender()},afterRender:function(){var t;this.updateControls(),this.updateRecControls(),this.updateExceptionsControls(),this.storageName&&(t=Common.localStorage.getItem(this.storageName),this.setActiveCategory(null!==t?parseInt(t):0))},getFocusedComponents:function(){var t=[this.chReplaceType,this.inputReplace,this.inputBy,this.mathList,this.btnReset,this.btnEdit,this.btnDelete,this.inputRecFind,this.mathRecList,this.btnResetRec,this.btnAddRec,this.btnDeleteRec];return t=(t=t.concat(this.chNewRows?[this.chHyperlink,this.chNewRows]:[this.chQuotes,this.chHyphens,this.chHyperlink,this.chDoubleSpaces,this.chBulleted,this.chNumbered])).concat(this.chkSentenceExceptions?[this.chkSentenceExceptions,this.chkSentenceCells,this.exceptionsLangCmb,this.exceptionsFindInput,this.exceptionsList,this.btnResetExceptions,this.btnAddExceptions,this.btnDeleteExceptions]:[])},getSettings:function(){},onSelectMathItem:function(t,e,i){i&&(this.inputReplace.setValue(i.get("replaced")),this.inputBy.setValue(i.get("by"))),this.updateControls(i)},updateControls:function(t){var e,i,s,o;this.mathList&&(t=t||this.mathList.getSelectedRec(),e=this.inputBy.getValue(),i=this.inputReplace.getValue(),t?(s=t.get("defaultDisabled"),o=t.get("defaultValue")&&t.get("defaultValueStr")!==t.get("by"),this.btnDelete.setCaption(s?this.textRestore:this.textDelete),this.btnEdit.setDisabled(s||e===t.get("by")&&!o||!e||!i),this.btnEdit.setCaption(o&&e===t.get("by")?this.textReset:this.textReplace)):(this.btnDelete.setCaption(this.textDelete),this.btnEdit.setDisabled(!e||!i),this.btnEdit.setCaption(this.textAdd)),this.btnDelete.setDisabled(!t))},show:function(){Common.Views.AdvancedSettingsWindow.prototype.show.apply(this,arguments);var t=this.getActiveCategory();0==t?this.onMathCategoryClick(!0):1==t?this.onRecCategoryClick(!0):2==t?this.onAutoformatCategoryClick(!0):3==t&&this.onAutocorrectCategoryClick(!0)},close:function(){Common.Views.AdvancedSettingsWindow.prototype.close.apply(this,arguments),this.mathList&&this.mathList.deselectAll(),this.mathRecList&&this.mathRecList.deselectAll()},onMathCategoryClick:function(t){var e=this;_.delay(function(){$("input",e.inputReplace.cmpEl).select().focus()},t?50:0),e.mathList.store.length<r.length&&_.delay(function(){e.mathList.setStore(r),e.mathList.onResetItems()},t?100:10)},onAutoformatCategoryClick:function(t){var e=this;_.delay(function(){("sse-"==e.appPrefix?e.chHyperlink:e.chQuotes).focus()},t?50:0)},onAutocorrectCategoryClick:function(t){var e=this;_.delay(function(){$("input",e.exceptionsFindInput.cmpEl).select().focus()},t?50:0),e.exceptionsList.store.length<l.length&&_.delay(function(){e.exceptionsList.setStore(l),e.exceptionsList.onResetItems()},t?100:10)},onDelete:function(){var t,e,i=this.mathList.getSelectedRec(),s="";i&&(i.get("defaultValue")?(s=this.appPrefix+"settings-math-correct-rem",e=!i.get("defaultDisabled"),i.set("defaultDisabled",e),e?this.arrRem.push(i.get("replaced")):this.arrRem.splice(this.arrRem.indexOf(i.get("replaced")),1),t=JSON.stringify(this.arrRem),Common.Utils.InternalSettings.set(s,t),Common.localStorage.setItem(s,t),this.btnDelete.setCaption(e?this.textRestore:this.textDelete),e?this.api.asc_deleteFromAutoCorrectMathSymbols(i.get("replaced")):this.api.asc_AddOrEditFromAutoCorrectMathSymbols(i.get("replaced"),i.get("defaultValue"))):(r.remove(i),this.arrAdd.splice(this.arrAdd.indexOf(i.get("replaced")),1),s=this.appPrefix+"settings-math-correct-add",t=JSON.stringify(this.arrAdd),Common.Utils.InternalSettings.set(s,t),Common.localStorage.setItem(s,t),this.mathList.scroller&&this.mathList.scroller.update({}),this.api.asc_deleteFromAutoCorrectMathSymbols(i.get("replaced"))),this.updateControls())},onEdit:function(){function i(t,e){var i=l.appPrefix+"settings-math-correct-add",s=JSON.stringify(l.arrAdd);Common.Utils.InternalSettings.set(i,s),Common.localStorage.setItem(i,s),l.api.asc_AddOrEditFromAutoCorrectMathSymbols(t.get("replaced"),e),l.mathList.selectRecord(t),l.mathList.scrollToRecord(t)}var s,o,n=this.mathList.getSelectedRec(),a="",l=this;(n=n||r.findWhere({replaced:this.inputReplace.getValue()}))?(s=_.findIndex(this.arrAdd,function(t){return t[0]==n.get("replaced")}),o=n.get("defaultValue")&&n.get("defaultValueStr")!==n.get("by")&&this.inputBy.getValue()===n.get("by"),Common.UI.warning({maxwidth:500,msg:(o?this.warnRestore:this.warnReplace).replace("%1",n.get("replaced")),buttons:["yes","no"],primary:"yes",callback:_.bind(function(t,e){"yes"==t&&(o?(a=n.get("defaultValue"),n.set("by",n.get("defaultValueStr")),0<=s&&this.arrAdd.splice(s,1)):(a=this.inputBy.getValue(),n.set("by",a),s<0?this.arrAdd.push([n.get("replaced"),a]):this.arrAdd[s][1]=a),i(n,a))},this)})):(n=r.add({replaced:this.inputReplace.getValue(),by:this.inputBy.getValue(),defaultDisabled:!1}),a=n.get("by"),this.arrAdd.push([n.get("replaced"),a]),i(n,a))},onResetToDefault:function(){Common.UI.warning({maxwidth:500,msg:this.warnReset,buttons:["yes","no"],primary:"yes",callback:_.bind(function(t,e){"yes"==t&&(this.api.asc_resetToDefaultAutoCorrectMathSymbols(),this.onResetList())},this)})},onResetList:function(){var t=this.appPrefix+"settings-math-correct",e=JSON.stringify([]);Common.Utils.InternalSettings.set(t+"-add",e),Common.localStorage.setItem(t+"-add",e),Common.Utils.InternalSettings.set(t+"-rem",e),Common.localStorage.setItem(t+"-rem",e),this.arrAdd=[],this.arrRem=[],r.remove(r.where({defaultValue:void 0})),r.each(function(t,e){t.set("by",t.get("defaultValueStr")),t.set("defaultDisabled",!1)}),this.mathList.deselectAll(),this.mathList.scroller&&(this.mathList.scroller.update(),this.mathList.scroller.scrollTop(0)),this.updateControls()},onInitList:function(){var t,s,e,o,n;0<r.length||(r.comparator=function(t,e){t=t.get("replaced").toLowerCase(),e=e.get("replaced").toLowerCase();return t==e?0:t<e?-1:1},t=this.arrAdd,s=this.arrRem,e=this.api?this.api.asc_getAutoCorrectMathSymbols():[],o=[],_.each(e,function(t,e){var i={replaced:t[0],defaultValue:t[1],defaultDisabled:-1<s.indexOf(t[0])};"object"==typeof t[1]?(i.defaultValueStr="",_.each(t[1],function(t){i.defaultValueStr+=Common.Utils.String.encodeSurrogateChar(t)}),i.by=i.defaultValueStr):i.by=i.defaultValueStr=Common.Utils.String.encodeSurrogateChar(t[1]),o.push(i)}),n=[],_.each(t,function(t,e){var i=_.findIndex(o,{replaced:t[0]});i<0?n.push({replaced:t[0],by:t[1],defaultDisabled:!1}):o[i].by=t[1]}),r.reset(o.concat(n)),this.updateControls())},onInitRecList:function(){var t,i,e,s,o;0<a.length||(a.comparator=function(t,e){t=t.get("value").toLowerCase(),e=e.get("value").toLowerCase();return t==e?0:t<e?-1:1},t=this.arrAddRec,i=this.arrRemRec,e=this.api?this.api.asc_getAutoCorrectMathFunctions():[],s=[],_.each(e,function(t,e){s.push({value:t,defaultValue:!0,defaultDisabled:-1<i.indexOf(t)})}),o=[],_.each(t,function(t,e){_.findIndex(s,{value:t})<0&&o.push({value:t,defaultValue:!1,defaultDisabled:!1})}),a.reset(s.concat(o)),this.updateRecControls())},onResetRecToDefault:function(){Common.UI.warning({maxwidth:500,msg:this.textWarnResetRec,buttons:["yes","no"],primary:"yes",callback:_.bind(function(t,e){"yes"==t&&(this.api.asc_resetToDefaultAutoCorrectMathFunctions(),this.onResetRecList())},this)})},onResetRecList:function(){var t=this.appPrefix+"settings-rec-functions",e=JSON.stringify([]);Common.Utils.InternalSettings.set(t+"-add",e),Common.localStorage.setItem(t+"-add",e),Common.Utils.InternalSettings.set(t+"-rem",e),Common.localStorage.setItem(t+"-rem",e),this.arrAddRec=[],this.arrRemRec=[],a.remove(a.where({defaultValue:!1})),a.each(function(t,e){t.set("defaultDisabled",!1)}),this.mathRecList.deselectAll(),this.mathRecList.scroller&&(this.mathRecList.scroller.update(),this.mathRecList.scroller.scrollTop(0)),this.updateRecControls()},onRecCategoryClick:function(t){var e=this;_.delay(function(){$("input",e.inputRecFind.cmpEl).select().focus()},t?50:0),e.mathRecList.store.length<a.length&&_.delay(function(){e.mathRecList.setStore(a),e.mathRecList.onResetItems()},t?100:10)},onDeleteRec:function(){var t,e,i,s=this.mathRecList.getSelectedRec();s&&(s.get("defaultValue")?(e=this.appPrefix+"settings-rec-functions-rem",i=!s.get("defaultDisabled"),s.set("defaultDisabled",i),i?this.arrRemRec.push(s.get("value")):this.arrRemRec.splice(this.arrRemRec.indexOf(s.get("value")),1),t=JSON.stringify(this.arrRemRec),Common.Utils.InternalSettings.set(e,t),Common.localStorage.setItem(e,t),this.btnDeleteRec.setCaption(i?this.textRestore:this.textDelete),i?this.api.asc_deleteFromAutoCorrectMathFunctions(s.get("value")):this.api.asc_AddFromAutoCorrectMathFunctions(s.get("value"))):(a.remove(s),this.arrAddRec.splice(this.arrAddRec.indexOf(s.get("value")),1),e=this.appPrefix+"settings-rec-functions-add",t=JSON.stringify(this.arrAddRec),Common.Utils.InternalSettings.set(e,t),Common.localStorage.setItem(e,t),this.mathRecList.scroller&&this.mathRecList.scroller.update({}),this.api.asc_deleteFromAutoCorrectMathFunctions(s.get("value"))),this.updateRecControls())},onAddRec:function(){var t,e,i=this.mathRecList.getSelectedRec(),s=this;(i=i||a.findWhere({value:this.inputRecFind.getValue()}))?(s.mathRecList.selectRecord(i),s.mathRecList.scrollToRecord(i)):/^[A-Z]+$/i.test(this.inputRecFind.getValue())?(i=a.add({value:this.inputRecFind.getValue(),defaultValue:!1,defaultDisabled:!1}),this.arrAddRec.push(i.get("value")),i=i,t=s.appPrefix+"settings-rec-functions-add",e=JSON.stringify(s.arrAddRec),Common.Utils.InternalSettings.set(t,e),Common.localStorage.setItem(t,e),s.api.asc_AddFromAutoCorrectMathFunctions(i.get("value")),s.mathRecList.selectRecord(i),s.mathRecList.scrollToRecord(i)):Common.UI.warning({maxwidth:500,msg:this.textWarnAddRec})},onSelectRecItem:function(t,e,i){i&&this.inputRecFind.setValue(i.get("value")),this.updateRecControls(i)},updateRecControls:function(t){var e;this.mathRecList&&(t=t||this.mathRecList.getSelectedRec(),e=this.inputRecFind.getValue(),this.btnDeleteRec.setCaption(t&&t.get("defaultDisabled")?this.textRestore:this.textDelete),this.btnDeleteRec.setDisabled(!t),this.btnAddRec.setDisabled(!!t||!e))},onInitExceptionsList:function(t){var e,i,s,o;0<l.length&&!t||(l.comparator=function(t,e){t=t.get("value").toLowerCase(),e=e.get("value").toLowerCase();return t==e?0:t<e?-1:1},t=this.exceptionsLangCmb.getValue(),e=this.arrAddExceptions[t]||[],i=this.arrRemExceptions[t]||[],t=this.api?this.api.asc_GetAutoCorrectSettings().get_FirstLetterExceptionManager().get_DefaultExceptions(t):[],s=[],_.each(t,function(t,e){s.push({value:t,defaultValue:!0,defaultDisabled:-1<i.indexOf(t)})}),o=[],_.each(e,function(t,e){_.findIndex(s,{value:t})<0&&o.push({value:t,defaultValue:!1,defaultDisabled:!1})}),l.reset(s.concat(o)),this.updateExceptionsControls())},onResetExceptionsToDefault:function(){var i=this.api.asc_GetAutoCorrectSettings().get_FirstLetterExceptionManager(),s=this.exceptionsLangCmb.getValue();Common.UI.warning({maxwidth:500,msg:this.textWarnResetFL,buttons:["yes","no"],primary:"yes",callback:_.bind(function(t,e){"yes"==t&&(i.put_Exceptions(i.get_DefaultExceptions(s),s),this.onResetExceptionsList())},this)})},onResetExceptionsList:function(){var t=this.appPrefix+"settings-letter-exception",e=this.exceptionsLangCmb.getValue(),i=JSON.stringify([]);Common.Utils.InternalSettings.set(t+"-add-"+e,i),Common.localStorage.setItem(t+"-add-"+e,i),Common.Utils.InternalSettings.set(t+"-rem-"+e,i),Common.localStorage.setItem(t+"-rem-"+e,i),this.arrAddExceptions[e]=[],this.arrRemExceptions[e]=[],l.remove(l.where({defaultValue:!1})),l.each(function(t,e){t.set("defaultDisabled",!1)}),this.exceptionsList.deselectAll(),this.exceptionsList.scroller&&(this.exceptionsList.scroller.update(),this.exceptionsList.scroller.scrollTop(0)),this.updateExceptionsControls()},onDeleteException:function(){var t,e,i,s=this.exceptionsList.getSelectedRec(),o=this.api.asc_GetAutoCorrectSettings().get_FirstLetterExceptionManager(),n=this.exceptionsLangCmb.getValue();s&&(i="",s.get("defaultValue")?(e=!s.get("defaultDisabled"),i=this.appPrefix+"settings-letter-exception-rem-"+n,s.set("defaultDisabled",e),e?this.arrRemExceptions[n].push(s.get("value")):this.arrRemExceptions[n].splice(this.arrRemExceptions[n].indexOf(s.get("value")),1),t=JSON.stringify(this.arrRemExceptions[n]),Common.Utils.InternalSettings.set(i,t),Common.localStorage.setItem(i,t),this.btnDeleteExceptions.setCaption(e?this.textRestore:this.textDelete),e?o.remove_Exception(s.get("value"),n):o.add_Exception(s.get("value"),n)):(l.remove(s),this.arrAddExceptions[n].splice(this.arrAddExceptions[n].indexOf(s.get("value")),1),i=this.appPrefix+"settings-letter-exception-add-"+n,t=JSON.stringify(this.arrAddExceptions[n]),Common.Utils.InternalSettings.set(i,t),Common.localStorage.setItem(i,t),this.exceptionsList.scroller&&this.exceptionsList.scroller.update({}),o.remove_Exception(s.get("value"),n)),this.updateExceptionsControls())},onAddException:function(){var t,e=this.exceptionsList.getSelectedRec(),i=this.exceptionsLangCmb.getValue(),s=this,o=this.exceptionsFindInput.getValue().trim();(e=e||l.findWhere({value:o}))?(s.exceptionsList.selectRecord(e),s.exceptionsList.scrollToRecord(e)):("."===o[o.length-1]&&(o=o.slice(0,-1)),/^[^\%/\\&\?\,\.\s\d\'\;:!-+!@#\$\^*)(]{1,20}$/.test(o)?(e=l.add({value:o,defaultValue:!1,defaultDisabled:!1}),this.arrAddExceptions[i].push(e.get("value")),o=e,e=s.appPrefix+"settings-letter-exception-add-"+i,t=JSON.stringify(s.arrAddExceptions[i]),Common.Utils.InternalSettings.set(e,t),Common.localStorage.setItem(e,t),s.api.asc_GetAutoCorrectSettings().get_FirstLetterExceptionManager().add_Exception(o.get("value"),i),s.exceptionsList.selectRecord(o),s.exceptionsList.scrollToRecord(o)):Common.UI.warning({maxwidth:500,msg:this.textWarnAddFL}))},onSelectExceptionItem:function(t,e,i){i&&this.exceptionsFindInput.setValue(i.get("value")),this.updateExceptionsControls(i)},onChangeInputException:function(t,e){var i;(e=e.trim()).length&&("."===e[e.length-1]&&(e=e.slice(0,-1)),(i=this.exceptionsList.store.find(function(t){if(0==t.get("value").indexOf(e))return!0}))&&(this.exceptionsList.scrollToRecord(i,!0),i.get("value")==e?this.exceptionsList.selectRecord(i,!0):i=null)),i||this.exceptionsList.deselectAll(),this.updateExceptionsControls(i)},updateExceptionsControls:function(t){var e;this.exceptionsList&&(t=t||this.exceptionsList.getSelectedRec(),e=this.exceptionsFindInput.getValue(),this.btnDeleteExceptions.setCaption(t&&t.get("defaultDisabled")?this.textRestore:this.textDelete),this.btnDeleteExceptions.setDisabled(!t),this.btnAddExceptions.setDisabled(!!t||!e))}},Common.Views.AutoCorrectDialog||{}))}),define("spreadsheeteditor/main/app/view/FileMenuPanels",["common/main/lib/view/DocumentAccessDialog","common/main/lib/view/AutoCorrectDialog"],function(){"use strict";SSE.Views.FileMenuPanels||(SSE.Views.FileMenuPanels={}),SSE.Views.FileMenuPanels.ViewSaveAs=Common.UI.BaseView.extend({el:"#panel-saveas",menu:void 0,formats:[[{name:"XLSX",imgCls:"xlsx",type:Asc.c_oAscFileType.XLSX},{name:"CSV",imgCls:"csv",type:Asc.c_oAscFileType.CSV},{name:"PDF",imgCls:"pdf",type:Asc.c_oAscFileType.PDF}],[{name:"XLTX",imgCls:"xltx",type:Asc.c_oAscFileType.XLTX}],[]],template:_.template(['<div class="content-container">','<div class="header"><%= header %></div>','<div class="format-items">',"<% _.each(rows, function(row) { %>","<% _.each(row, function(item) { %>",'<% if (item.type!==Asc.c_oAscFileType.XLSM || fileType=="xlsm") { %>','<div class="format-item float-left"><div class="btn-doc-format" format="<%= item.type %>" data-hint="2" data-hint-direction="left-top" data-hint-offset="4, 4">','<div class ="svg-format-<%= item.imgCls %>"></div>',"</div></div>","<% } %>","<% }) %>",'<div class="divider"></div>',"<% }) %>","</div>","</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.menu=t.menu,this.fileType=t.fileType,Common.NotificationCenter.on({"window:resize":_.bind(function(){var t=Common.Utils.innerWidth()>=this.maxWidth;this.isDivided!==t&&(this.$el.find(".divider").css("width",t?"100%":"0"),this.isDivided=t)},this)})},render:function(){this.$el.html(this.template({rows:this.formats,fileType:(this.fileType||"xlsx").toLowerCase(),header:Common.Locale.get("btnDownloadCaption",{name:"SSE.Views.FileMenu",default:this.textDownloadAs})})),$(".btn-doc-format",this.el).on("click",_.bind(this.onFormatClick,this)),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:this.$el,suppressScrollX:!0,alwaysVisibleY:!0}));var i=0;return this.formats.forEach(_.bind(function(t,e){t=t.length;i<t&&(i=t)},this)),this.maxWidth=$("#file-menu-panel .panel-menu").outerWidth()+20+10+94*i,Common.Utils.innerWidth()>=this.maxWidth&&(this.$el.find(".divider").css("width","100%"),this.isDivided=!0),this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this.scroller&&this.scroller.update()},onFormatClick:function(t){t=t.currentTarget.attributes.format;!_.isUndefined(t)&&this.menu&&this.menu.fireEvent("saveas:format",[this.menu,parseInt(t.value)])},textDownloadAs:"Download as"}),SSE.Views.FileMenuPanels.ViewSaveCopy=Common.UI.BaseView.extend({el:"#panel-savecopy",menu:void 0,formats:[[{name:"XLSX",imgCls:"xlsx",type:Asc.c_oAscFileType.XLSX,ext:".xlsx"},{name:"ODS",imgCls:"ods",type:Asc.c_oAscFileType.ODS,ext:".ods"},{name:"CSV",imgCls:"csv",type:Asc.c_oAscFileType.CSV,ext:".csv"},{name:"PDF",imgCls:"pdf",type:Asc.c_oAscFileType.PDF,ext:".pdf"}],[{name:"XLTX",imgCls:"xltx",type:Asc.c_oAscFileType.XLTX,ext:".xltx"},{name:"OTS",imgCls:"ots",type:Asc.c_oAscFileType.OTS,ext:".ots"},{name:"XLSM",imgCls:"xlsm",type:Asc.c_oAscFileType.XLSM,ext:".xlsm"},{name:"PDFA",imgCls:"pdfa",type:Asc.c_oAscFileType.PDFA,ext:".pdf"}],[{name:"JPG",imgCls:"jpg",type:Asc.c_oAscFileType.JPG,ext:".zip"},{name:"PNG",imgCls:"png",type:Asc.c_oAscFileType.PNG,ext:".zip"}]],template:_.template(['<div class="content-container">','<div class="header"><%= header %></div>','<div class="format-items">',"<% _.each(rows, function(row) { %>","<% _.each(row, function(item) { %>",'<% if (item.type!==Asc.c_oAscFileType.XLSM || fileType=="xlsm") { %>','<div class="format-item float-left"><div class="btn-doc-format" format="<%= item.type %>" format-ext="<%= item.ext %>" data-hint="2" data-hint-direction="left-top" data-hint-offset="4, 4">','<div class ="svg-format-<%= item.imgCls %>"></div>',"</div></div>","<% } %>","<% }) %>",'<div class="divider"></div>',"<% }) %>","</div>","</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.menu=t.menu,this.fileType=t.fileType,Common.NotificationCenter.on({"window:resize":_.bind(function(){var t=Common.Utils.innerWidth()>=this.maxWidth;this.isDivided!==t&&(this.$el.find(".divider").css("width",t?"100%":"0"),this.isDivided=t)},this)})},render:function(){this.$el.html(this.template({rows:this.formats,fileType:(this.fileType||"xlsx").toLowerCase(),header:Common.Locale.get("btnSaveCopyAsCaption",{name:"SSE.Views.FileMenu",default:this.textSaveCopyAs})})),$(".btn-doc-format",this.el).on("click",_.bind(this.onFormatClick,this)),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:this.$el,suppressScrollX:!0,alwaysVisibleY:!0}));var i=0;return this.formats.forEach(_.bind(function(t,e){t=t.length;i<t&&(i=t)},this)),this.maxWidth=$("#file-menu-panel .panel-menu").outerWidth()+20+10+94*i,Common.Utils.innerWidth()>=this.maxWidth&&(this.$el.find(".divider").css("width","100%"),this.isDivided=!0),this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this.scroller&&this.scroller.update()},onFormatClick:function(t){var e=t.currentTarget.attributes.format,t=t.currentTarget.attributes["format-ext"];_.isUndefined(e)||_.isUndefined(t)||!this.menu||this.menu.fireEvent("savecopy:format",[this.menu,parseInt(e.value),t.value])},textSaveCopyAs:"Save Copy as"}),SSE.Views.FileMenuPanels.MainSettingsGeneral=Common.UI.BaseView.extend(_.extend({el:"#panel-settings",menu:void 0,template:_.template(['<div class="flex-settings">','<div class="header"><%= scope.txtAdvancedSettings %></div>','<table class="main"><tbody>','<tr class="editsave">','<td class="group-name top" colspan="2"><label><%= scope.txtEditingSaving %></label></td>',"</tr>",'<tr class="autosave">','<td colspan = "2"><span id="fms-chb-autosave"></span></td>',"</tr>",'<tr class="forcesave">','<td colspan="2"><span id="fms-chb-forcesave"></span></td>',"</tr>",'<tr class="edit">','<td colspan = "2"><div id="fms-chb-paste-settings"></div></td>',"</tr>",'<tr class ="editsave divider-group"></tr>','<tr class="collaboration" >','<td class="group-name" colspan="2"><label><%= scope.txtCollaboration %></label></td>',"</tr>",'<tr class="coauth changes">','<td class="subgroup-name" colspan="2"><label><%= scope.strCoAuthMode %></label></td>',"</tr>",'<tr class="coauth changes">','<td colspan="2"><div style="display: flex;">','<div id="fms-rb-coauth-mode-fast"></div>','<span style ="display: flex; flex-direction: column;"><label><%= scope.strFast %></label>','<label class="comment-text"><%= scope.txtFastTip %></label></span>',"</div></td>","</tr>",'<tr class="coauth changes">','<td colspan="2"><div style="display: flex; ">','<div id="fms-rb-coauth-mode-strict"></div>','<span style ="display: flex; flex-direction: column;"><label><%= scope.strStrict %></label>','<label class="comment-text"><%= scope.txtStrictTip %></label></span>',"</div></td>","</div></tr>",'<tr class ="divider coauth changes"></tr>','<tr class="live-viewer">','<td colspan="2"><div id="fms-chb-live-viewer"></div></td>',"</tr>",'<tr class="divider live-viewer"></tr>','<tr class="comments">','<td colspan="2"><div id="fms-chb-live-comment"></div></td>',"</tr>",'<tr class="comments">','<td colspan="2"><div id="fms-chb-resolved-comment"></div></td>',"</tr>",'<tr class ="collaboration divider-group"></tr>',"<tr >",'<td class="group-name" colspan="2"><label><%= scope.txtWorkspace %></label></td>',"</tr>","<tr>",'<td colspan="2"><div id="fms-chb-r1c1-style"></div></td>',"</tr>","<tr>",'<td colspan="2"><div id="fms-chb-use-alt-key"></div></td>',"</tr>",'<tr class="ui-rtl">','<td colspan="2"><div id="fms-chb-rtl-ui"></div></td>',"</tr>",'<tr class="quick-print">','<td colspan="2"><div style="display: flex;"><div id="fms-chb-quick-print"></div>','<span style ="display: flex; flex-direction: column;"><label><%= scope.txtQuickPrint %></label>','<label class="comment-text"><%= scope.txtQuickPrintTip %></label></span></div>',"</td>","</tr>",'<tr class="themes">',"<td><label><%= scope.strTheme %></label></td>",'<td><span id="fms-cmb-theme"></span></td>',"</tr>","<tr>","<td><label><%= scope.strUnit %></label></td>",'<td><span id="fms-cmb-unit"></span></td>',"</tr>","<tr>","<td><label><%= scope.strZoom %></label></td>",'<td><div id="fms-cmb-zoom" class="input-group-nr"></div></td>',"</tr>","<tr>","<td><label><%= scope.strFontRender %></label></td>",'<td><span id="fms-cmb-font-render"></span></td>',"</tr>",'<tr class="macros">',"<td><label><%= scope.strMacrosSettings %></label></td>","<td>",'<div><div id="fms-cmb-macros"></div>',"</td>","</tr>",'<tr class ="divider-group"></tr>',"<tr>",'<td class="group-name" colspan="2"><label><%= scope.strRegSettings %></label></td>',"</tr>",'<tr class="">',"<td><label><%= scope.strFuncLocale %></label></td>","<td>",'<div><div id="fms-cmb-func-locale"></div>','<label id="fms-lbl-func-locale"><%= scope.strFuncLocaleEx %></label></div></td>',"</tr>","<tr>","<td><label><%= scope.txtRegion %></label></td>","<td>",'<div><div id="fms-cmb-reg-settings"></div>','<label id="fms-lbl-reg-settings"></label></div></td>',"</tr>","<tr>",'<td colspan="2"><div id="fms-chb-separator-settings"></div></td>',"</tr>","<tr>",'<td><label class = "label-separator"><%= scope.strDecimalSeparator %></label></td>','<td><div id="fms-decimal-separator"></div></td>',"</tr>","<tr>",'<td><label class = "label-separator"><%= scope.strThousandsSeparator %></label></td>','<td><div id="fms-thousands-separator"></div></td>',"</tr>",'<tr class ="divider-group"></tr>','<tr class="edit">','<td colspan="2" class="group-name"><label><%= scope.txtProofing %></label></td>',"</tr>",'<tr class="spellcheck">',"<td><label><%= scope.strDictionaryLanguage %></label></td>",'<td><span id="fms-cmb-dictionary-language"></span></td>',"</tr>",'<tr class="spellcheck">','<td colspan="2"><span id="fms-chb-ignore-uppercase-words"></span></td>',"</tr>",'<tr class="spellcheck">','<td colspan="2"><span id="fms-chb-ignore-numbers-words"></span></td>',"</tr>",'<tr  class="edit">','<td colspan="2"><button type="button" class="btn btn-text-default" id="fms-btn-auto-correct" style="width:auto; display: inline-block;padding-right: 10px;padding-left: 10px;" data-hint="2" data-hint-direction="bottom" data-hint-offset="big"><%= scope.txtAutoCorrect %></button></div></td>',"</tr>",'<tr class ="edit divider-group"></tr>','<tr class="edit">','<td colspan="2" class="group-name"><label><%= scope.txtCalculating %></label></td>',"</tr>",'<tr class="edit">','<td colspan="2"><span id="fms-chb-date-1904"></span></td>',"</tr>",'<tr class ="edit divider-group"></tr>','<tr class="fms-btn-apply">','<td style="padding-top:15px; padding-bottom: 15px;"><button class="btn normal dlg-btn primary" data-hint="3" data-hint-direction="bottom" data-hint-offset="big"><%= scope.okButtonText %></button></td>',"<td></td>","</tr>","</tbody></table>","</div>",'<div class="fms-flex-apply hidden">','<table class="main" style="margin: 10px 20px; width: 100%"><tbody>',"<tr>",'<td><button class="btn normal dlg-btn primary" data-hint="2" data-hint-direction="bottom" data-hint-offset="big"><%= scope.okButtonText %></button></td>',"<td></td>","</tr>","</tbody></table>","</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.menu=t.menu},render:function(t){function e(t){var e=t.key,i=t.target.value;"ArrowLeft"!==e&&"ArrowDown"!==e&&"ArrowUp"!==e&&"ArrowRight"!==e&&"Home"!==e&&"End"!==e&&"Backspace"!==e&&"Delete"!==e&&0<i.length&&t.target.selectionEnd-t.target.selectionStart==0&&t.preventDefault()}var o=this,i=$(this.template({scope:this})),s=(this.chLiveComment=new Common.UI.CheckBox({el:i.findById("#fms-chb-live-comment"),labelText:this.strShowComments,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}).on("change",function(t,e,i,s){o.chResolvedComment.setDisabled("checked"!==t.getValue())}),this.chResolvedComment=new Common.UI.CheckBox({el:i.findById("#fms-chb-resolved-comment"),labelText:this.strShowResolvedComments,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.chR1C1Style=new Common.UI.CheckBox({el:i.findById("#fms-chb-r1c1-style"),labelText:this.strReferenceStyle,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.chUseAltKey=new Common.UI.CheckBox({el:i.findById("#fms-chb-use-alt-key"),labelText:Common.Utils.isMac?this.txtUseOptionKey:this.txtUseAltKey,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),(Common.Utils.isIE||Common.Utils.isMac&&Common.Utils.isGecko)&&this.chUseAltKey.$el.parent().parent().hide(),this.rbCoAuthModeFast=new Common.UI.RadioBox({el:i.findById("#fms-rb-coauth-mode-fast"),name:"coauth-mode",dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}).on("change",function(){o.chAutosave.setValue(1)}),this.rbCoAuthModeFast.$el.parent().on("click",function(){o.rbCoAuthModeFast.setValue(!0)}),this.rbCoAuthModeStrict=new Common.UI.RadioBox({el:i.findById("#fms-rb-coauth-mode-strict"),name:"coauth-mode",dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.rbCoAuthModeStrict.$el.parent().on("click",function(){o.rbCoAuthModeStrict.setValue(!0)}),this.chLiveViewer=new Common.UI.CheckBox({el:i.findById("#fms-chb-live-viewer"),labelText:this.strShowOthersChanges,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.cmbZoom=new Common.UI.ComboBox({el:i.findById("#fms-cmb-zoom"),style:"width: 160px;",editable:!1,menuCls:"menu-aligned",cls:"input-group-nr",menuStyle:"min-width:100%; max-height: 157px;",data:[{value:-3,displayValue:this.txtLastUsed},{value:50,displayValue:"50%"},{value:60,displayValue:"60%"},{value:70,displayValue:"70%"},{value:80,displayValue:"80%"},{value:90,displayValue:"90%"},{value:100,displayValue:"100%"},{value:110,displayValue:"110%"},{value:120,displayValue:"120%"},{value:150,displayValue:"150%"},{value:175,displayValue:"175%"},{value:200,displayValue:"200%"},{value:300,displayValue:"300%"},{value:400,displayValue:"400%"},{value:500,displayValue:"500%"}],dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),_.template(["<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%= item.value %>" <% if (item.value === "custom") { %> class="border-top" style="margin-top: 5px;padding-top: 5px;" <% } %> ><a tabindex="-1" type="menuitem" <% if (typeof(item.checked) !== "undefined" && item.checked) { %> class="checked" <% } %> ><%= scope.getDisplayValue(item) %></a></li>',"<% }); %>"].join(""))),n=(this.cmbFontRender=new Common.UI.ComboBox({el:i.findById("#fms-cmb-font-render"),style:"width: 160px;",editable:!1,menuCls:"menu-aligned",cls:"input-group-nr",menuStyle:"min-width:100%;",itemsTemplate:s,data:[{value:Asc.c_oAscFontRenderingModeType.hintingAndSubpixeling,displayValue:this.txtWin},{value:Asc.c_oAscFontRenderingModeType.noHinting,displayValue:this.txtMac},{value:Asc.c_oAscFontRenderingModeType.hinting,displayValue:this.txtNative},{value:"custom",displayValue:this.txtCacheMode}],dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbFontRender.on("selected",_.bind(this.onFontRenderSelected,this)),this.chAutosave=new Common.UI.CheckBox({el:i.findById("#fms-chb-autosave"),labelText:this.textAutoSave,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}).on("change",function(t,e,i,s){"checked"!==t.getValue()&&o.rbCoAuthModeFast.getValue()&&o.rbCoAuthModeStrict.setValue(!0)}),this.chForcesave=new Common.UI.CheckBox({el:i.findById("#fms-chb-forcesave"),labelText:this.textForceSave,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.cmbUnit=new Common.UI.ComboBox({el:i.findById("#fms-cmb-unit"),style:"width: 160px;",editable:!1,menuCls:"menu-aligned",menuStyle:"min-width:100%;",cls:"input-group-nr",data:[{value:Common.Utils.Metric.c_MetricUnits.cm,displayValue:this.txtCm},{value:Common.Utils.Metric.c_MetricUnits.pt,displayValue:this.txtPt},{value:Common.Utils.Metric.c_MetricUnits.inch,displayValue:this.txtInch}],dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),[]),s=(SSE.Collections.formulasLangs.forEach(function(t){var e=(e=t.replace(/[\-_]/,"")).charAt(0).toUpperCase()+e.substring(1,e.length);n.push({value:t,displayValue:o["txt"+e+"lang"]||o["txt"+e],exampleValue:o["txtExample"+e]||o.txtExampleEn})}),n.sort(function(t,e){return t.displayValue<e.displayValue?-1:t.displayValue>e.displayValue?1:0}),this.cmbFuncLocale=new Common.UI.ComboBox({el:i.findById("#fms-cmb-func-locale"),style:"width: 200px;",menuStyle:"min-width:100%; max-height: 185px;",editable:!1,menuCls:"menu-aligned",cls:"input-group-nr",data:n,dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}).on("selected",function(t,e){o.updateFuncExample(e.exampleValue)}),[{value:1068},{value:1026},{value:1029},{value:1030},{value:3079},{value:1031},{value:2055},{value:1032},{value:3081},{value:2057},{value:1033},{value:3082},{value:2058},{value:1035},{value:1036},{value:4108},{value:1040},{value:2064},{value:1041},{value:1042},{value:1062},{value:1038},{value:1043},{value:1045},{value:1046},{value:2070},{value:1049},{value:1051},{value:1060},{value:2077},{value:1053},{value:1055},{value:1058},{value:1066},{value:2052}]);s.forEach(function(t){var e=Common.util.LanguageInfo.getLocalLanguageName(t.value);t.displayValue=e[1],t.langName=e[0]}),this.cmbRegSettings=new Common.UI.ComboBox({el:i.findById("#fms-cmb-reg-settings"),style:"width: 200px;",menuStyle:"min-width:100%; max-height: 185px;",menuCls:"menu-aligned",editable:!1,cls:"input-group-nr",data:s,template:_.template(['<span class="input-group combobox <%= cls %> combo-langs" id="<%= id %>" style="<%= style %>">','<input type="text" class="form-control" style="'+(Common.UI.isRTL()?"padding-right":"padding-left")+':25px !important;" data-hint="2" data-hint-direction="bottom" data-hint-offset="big">','<span class="icon input-icon lang-flag"></span>','<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">','<span class="caret" />',"</button>",'<ul class="dropdown-menu <%= menuCls %>" style="<%= menuStyle %>" role="menu">',"<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%= item.value %>">','<a tabindex="-1" type="menuitem" style="'+(Common.UI.isRTL()?"padding-right":"padding-left")+':26px !important;">','<i class="icon lang-flag <%= item.langName %>" style="position: absolute;"></i>',"<%= scope.getDisplayValue(item) %>","</a>","</li>","<% }); %>","</ul>","</span>"].join(""))}).on("selected",function(t,e){o.updateRegionalExample(e.value),"checked"===o.chSeparator.getValue()&&(o.inputDecimalSeparator.setValue(o.api.asc_getDecimalSeparator(e.value),!0),o.inputThousandsSeparator.setValue(o.api.asc_getGroupSeparator(e.value),!0))}),this.cmbRegSettings.scroller&&this.cmbRegSettings.scroller.update({alwaysVisibleY:!0}),this.chSeparator=new Common.UI.CheckBox({el:i.findById("#fms-chb-separator-settings"),labelText:this.strUseSeparatorsBasedOnRegionalSettings,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}).on("change",_.bind(function(t,e,i,s){var o,n,t="checked"===t.getValue();t&&(n=this.cmbRegSettings.getValue(),o=this.api.asc_getDecimalSeparator(_.isNumber(n)?n:void 0),n=this.api.asc_getGroupSeparator(_.isNumber(n)?n:void 0),this.inputDecimalSeparator.setValue(o),this.inputThousandsSeparator.setValue(n)),this.inputDecimalSeparator.setDisabled(t),this.inputThousandsSeparator.setDisabled(t),t?this.$el.find(".label-separator").addClass("disabled"):this.$el.find(".label-separator").removeClass("disabled")},this));return this.inputDecimalSeparator=new Common.UI.InputField({el:i.findById("#fms-decimal-separator"),style:"width: 35px;",validateOnBlur:!1,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.inputDecimalSeparator.$el.find("input").on("keydown",e),this.inputThousandsSeparator=new Common.UI.InputField({el:i.findById("#fms-thousands-separator"),style:"width: 35px;",validateOnBlur:!1,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.inputThousandsSeparator.$el.find("input").on("keydown",e),this.cmbMacros=new Common.UI.ComboBox({el:i.findById("#fms-cmb-macros"),style:"width: 160px;",editable:!1,menuCls:"menu-aligned",menuStyle:"min-width:100%;",cls:"input-group-nr",data:[{value:2,displayValue:this.txtStopMacros,descValue:this.txtStopMacrosDesc},{value:0,displayValue:this.txtWarnMacros,descValue:this.txtWarnMacrosDesc},{value:1,displayValue:this.txtRunMacros,descValue:this.txtRunMacrosDesc}],itemsTemplate:_.template(["<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%- item.value %>"><a tabindex="-1" type="menuitem" style ="display: flex; flex-direction: column;">','<label class="font-weight-bold"><%= scope.getDisplayValue(item) %></label><label><%= item.descValue %></label></a></li>',"<% }); %>"].join("")),dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.chPaste=new Common.UI.CheckBox({el:i.findById("#fms-chb-paste-settings"),labelText:this.strPasteButton,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.cmbTheme=new Common.UI.ComboBox({el:i.findById("#fms-cmb-theme"),style:"width: 160px;",editable:!1,menuCls:"menu-aligned",menuStyle:"min-width:100%;",cls:"input-group-nr",dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbDictionaryLanguage=new Common.UI.ComboBox({el:i.findById("#fms-cmb-dictionary-language"),cls:"input-group-nr",style:"width: 200px;",editable:!1,menuCls:"menu-aligned",menuStyle:"min-width: 100%; max-height: 209px;",dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.chIgnoreUppercase=new Common.UI.CheckBox({el:i.findById("#fms-chb-ignore-uppercase-words"),labelText:this.strIgnoreWordsInUPPERCASE,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.chIgnoreNumbers=new Common.UI.CheckBox({el:i.findById("#fms-chb-ignore-numbers-words"),labelText:this.strIgnoreWordsWithNumbers,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.chDateSystem=new Common.UI.CheckBox({el:i.findById("#fms-chb-date-1904"),labelText:this.strDateFormat1904,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.btnAutoCorrect=new Common.UI.Button({el:i.findById("#fms-btn-auto-correct")}),this.btnAutoCorrect.on("click",_.bind(this.autoCorrect,this)),this.chRTL=new Common.UI.CheckBox({el:i.findById("#fms-chb-rtl-ui"),labelText:this.strRTLSupport,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),i.find(".btn.primary").each(function(t,e){new Common.UI.Button({el:$(e)}).on("click",_.bind(o.applySettings,o))}),this.chQuickPrint=new Common.UI.CheckBox({el:i.findById("#fms-chb-quick-print"),labelText:"",dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.chQuickPrint.$el.parent().on("click",function(){o.chQuickPrint.setValue(!o.chQuickPrint.isChecked())}),this.pnlSettings=i.find(".flex-settings").addBack().filter(".flex-settings"),this.pnlApply=i.find(".fms-flex-apply").addBack().filter(".fms-flex-apply"),this.pnlTable=this.pnlSettings.find("table"),this.trApply=i.find(".fms-btn-apply"),this.$el=$(t).html(i),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:this.pnlSettings,suppressScrollX:!0,alwaysVisibleY:!0})),Common.NotificationCenter.on({"window:resize":function(){o.isVisible()&&o.updateScroller()}}),this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this.updateSettings(),this.updateScroller()},isVisible:function(){return(this.$el||$(this.el)).is(":visible")},updateScroller:function(){var t;this.scroller&&(Common.UI.Menu.Manager.hideAll(),t=this.$el.height()<this.pnlTable.parent().height()+25+this.pnlApply.height(),this.pnlApply.toggleClass("hidden",!t),this.trApply.toggleClass("hidden",t),this.pnlSettings.css("overflow",t?"hidden":"visible"),this.scroller.update(),this.pnlSettings.toggleClass("bordered",this.scroller.isVisible()))},setMode:function(t){this.mode=t;var e=Common.Utils.InternalSettings.get("sse-settings-coauthmode");$("tr.editsave",this.el)[t.isEdit||t.canForcesave?"show":"hide"](),$("tr.collaboration",this.el)[t.canCoAuthoring?"show":"hide"](),$("tr.edit",this.el)[t.isEdit?"show":"hide"](),$("tr.autosave",this.el)[!t.isEdit||!t.canChangeCoAuthoring&&e?"hide":"show"](),this.mode.isDesktopApp&&this.mode.isOffline&&this.chAutosave.setCaption(this.textAutoRecover),$("tr.forcesave",this.el)[t.canForcesave?"show":"hide"](),$("tr.comments",this.el)[t.canCoAuthoring?"show":"hide"](),$("tr.coauth.changes",this.el)[t.isEdit&&!t.isOffline&&t.canCoAuthoring&&t.canChangeCoAuthoring?"show":"hide"](),$("tr.live-viewer",this.el)[t.canLiveView&&!t.isOffline&&t.canChangeCoAuthoring?"show":"hide"](),$("tr.macros",this.el)[t.customization&&!1===t.customization.macros?"hide":"show"](),$("tr.quick-print",this.el)[!t.canQuickPrint||t.customization&&t.customization.compactHeader&&t.isEdit?"hide":"show"](),Common.UI.Themes.available()||$("tr.themes, tr.themes + tr.divider",this.el).hide(),$("tr.spellcheck",this.el)[Common.UI.FeaturesManager.canChange("spellcheck")&&t.isEdit?"show":"hide"](),$("tr.ui-rtl",this.el)[t.uiRtl?"show":"hide"]()},setApi:function(t){this.api=t},updateSettings:function(){var t,e,i,s,o=Common.Utils.InternalSettings.get("sse-settings-zoom"),n=(o=null!==o?parseInt(o):this.mode.customization&&this.mode.customization.zoom?parseInt(this.mode.customization.zoom):100,this.cmbZoom.store.findWhere({value:o})),a=(this.cmbZoom.setValue(n?parseInt(n.get("value")):0<o?o+"%":100),this.chUseAltKey.setValue(Common.Utils.InternalSettings.get("sse-settings-show-alt-hints")),this.chLiveComment.setValue(Common.Utils.InternalSettings.get("sse-settings-livecomment")),this.chResolvedComment.setValue(Common.Utils.InternalSettings.get("sse-settings-resolvedcomment")),this.chR1C1Style.setValue(Common.Utils.InternalSettings.get("sse-settings-r1c1")),Common.Utils.InternalSettings.get("sse-settings-coauthmode")),a=(this.rbCoAuthModeFast.setValue(a),this.rbCoAuthModeStrict.setValue(!a),this.chLiveViewer.setValue(Common.Utils.InternalSettings.get("sse-settings-coauthmode")),o=Common.Utils.InternalSettings.get("sse-settings-fontrender"),n=this.cmbFontRender.store.findWhere({value:parseInt(o)}),this.cmbFontRender.setValue(n?n.get("value"):Asc.c_oAscFontRenderingModeType.hintingAndSubpixeling),this._fontRender=this.cmbFontRender.getValue(),o=Common.Utils.InternalSettings.get("sse-settings-cachemode"),(n=this.cmbFontRender.store.findWhere({value:"custom"}))&&o&&n.set("checked",!!o),n&&o&&this.cmbFontRender.cmpEl.find("#"+n.get("id")+" a").addClass("checked"),o=Common.Utils.InternalSettings.get("sse-settings-unit"),n=this.cmbUnit.store.findWhere({value:o}),this.cmbUnit.setValue(n?parseInt(n.get("value")):Common.Utils.Metric.getDefaultMetric()),this._oldUnits=this.cmbUnit.getValue(),o=Common.Utils.InternalSettings.get("sse-settings-autosave"),this.chAutosave.setValue(1==o),this.mode.canForcesave&&this.chForcesave.setValue(Common.Utils.InternalSettings.get("sse-settings-forcesave")),o=Common.Utils.InternalSettings.get("sse-settings-func-locale"),!(n=this.cmbFuncLocale.store.findWhere({value:o}))&&o&&(n=this.cmbFuncLocale.store.findWhere({value:o.split(/[\-\_]/)[0]})),this.cmbFuncLocale.setValue(n?n.get("value"):"en"),this.updateFuncExample(n?n.get("exampleValue"):this.txtExampleEn),(o=this.api.asc_getLocale())?(n=this.cmbRegSettings.store.findWhere({value:o}),this.cmbRegSettings.setValue(n?n.get("value"):Common.util.LanguageInfo.getLocalLanguageName(o)[1]),n&&(o=this.cmbRegSettings.getValue())):(o=this.mode.lang?parseInt(Common.util.LanguageInfo.getLocalLanguageCode(this.mode.lang)):1033,this.cmbRegSettings.setValue(Common.util.LanguageInfo.getLocalLanguageName(o)[1])),this.updateRegionalExample(o),Common.Utils.InternalSettings.get("sse-settings-use-base-separator")),l=(this.chSeparator.setValue(a,!0),e=a?(e=this.cmbRegSettings.getValue(),i=this.api.asc_getDecimalSeparator(_.isNumber(e)?e:void 0),this.api.asc_getGroupSeparator(_.isNumber(e)?e:void 0)):(i=Common.Utils.InternalSettings.get("sse-settings-decimal-separator")||this.api.asc_getDecimalSeparator(),Common.Utils.InternalSettings.get("sse-settings-group-separator")||this.api.asc_getGroupSeparator()),this.inputDecimalSeparator.setValue(i),this.inputThousandsSeparator.setValue(e),this.inputDecimalSeparator.setDisabled(a),this.inputThousandsSeparator.setDisabled(a),a?this.$el.find(".label-separator").addClass("disabled"):this.$el.find(".label-separator").removeClass("disabled"),n=this.cmbMacros.store.findWhere({value:Common.Utils.InternalSettings.get("sse-macros-mode")}),this.cmbMacros.setValue(n?n.get("value"):0),this.chPaste.setValue(Common.Utils.InternalSettings.get("sse-settings-paste-button")),this.chRTL.setValue(Common.localStorage.getBool("ui-rtl")),this.chQuickPrint.setValue(Common.Utils.InternalSettings.get("sse-settings-quick-print-button")),[]);for(t in Common.UI.Themes.map())l.push({value:t,displayValue:Common.UI.Themes.get(t).text});l.length&&(this.cmbTheme.setData(l),n=this.cmbTheme.store.findWhere({value:Common.UI.Themes.currentThemeId()}),this.cmbTheme.setValue(n?n.get("value"):Common.UI.Themes.defaultThemeId())),Common.UI.FeaturesManager.canChange("spellcheck")&&this.mode.isEdit&&(e=(i=SSE.getController("Spellcheck").loadLanguages())[0],a=i[1],i=i[2],s=Common.Utils.InternalSettings.get("sse-spellcheck-locale"),o=s?parseInt(s):this.mode.lang?parseInt(Common.util.LanguageInfo.getLocalLanguageCode(this.mode.lang)):1033,a&&0<a.length?(0!==this.cmbDictionaryLanguage.store.length&&!i||this.cmbDictionaryLanguage.setData(a),!(n=this.cmbDictionaryLanguage.store.findWhere({value:o}))&&e[o]&&(o=e[o][0].split(/[\-\_]/)[0],n=(n=this.cmbDictionaryLanguage.store.find(function(t){return 0==t.get("shortName").indexOf(o)}))||this.cmbDictionaryLanguage.store.findWhere({shortName:"en-US"})),this.cmbDictionaryLanguage.setValue(n?n.get("value"):a[0].value),(o=this.cmbDictionaryLanguage.getValue())!==parseInt(s)&&Common.Utils.InternalSettings.set("sse-spellcheck-locale",o)):(this.cmbDictionaryLanguage.setValue(Common.util.LanguageInfo.getLocalLanguageName(o)[1]),this.cmbDictionaryLanguage.setDisabled(!0)),this.chIgnoreUppercase.setValue(Common.Utils.InternalSettings.get("sse-spellcheck-ignore-uppercase-words")),this.chIgnoreNumbers.setValue(Common.Utils.InternalSettings.get("sse-spellcheck-ignore-numbers-words")),this.chDateSystem.setValue(this.api.asc_getDate1904()))},applySettings:function(){Common.UI.Themes.setTheme(this.cmbTheme.getValue()),Common.localStorage.setItem("sse-settings-show-alt-hints",this.chUseAltKey.isChecked()?1:0),Common.Utils.InternalSettings.set("sse-settings-show-alt-hints",Common.localStorage.getBool("sse-settings-show-alt-hints")),Common.localStorage.setItem("sse-settings-zoom",this.cmbZoom.getValue()),Common.Utils.InternalSettings.set("sse-settings-zoom",Common.localStorage.getItem("sse-settings-zoom")),Common.localStorage.setItem("sse-settings-livecomment",this.chLiveComment.isChecked()?1:0),Common.localStorage.setItem("sse-settings-resolvedcomment",this.chResolvedComment.isChecked()?1:0),this.mode.isEdit&&!this.mode.isOffline&&this.mode.canCoAuthoring&&this.mode.canChangeCoAuthoring?Common.localStorage.setItem("sse-settings-coauthmode",this.rbCoAuthModeFast.getValue()?1:0):this.mode.canLiveView&&!this.mode.isOffline&&this.mode.canChangeCoAuthoring&&Common.localStorage.setItem("sse-settings-view-coauthmode",this.chLiveViewer.isChecked()?1:0),Common.localStorage.setItem("sse-settings-r1c1",this.chR1C1Style.isChecked()?1:0),Common.localStorage.setItem("sse-settings-fontrender",this.cmbFontRender.getValue());var t=this.cmbFontRender.store.findWhere({value:"custom"});Common.localStorage.setItem("sse-settings-cachemode",t&&!t.get("checked")?0:1),Common.localStorage.setItem("sse-settings-unit",this.cmbUnit.getValue()),!this.mode.isEdit||!this.mode.canChangeCoAuthoring&&Common.Utils.InternalSettings.get("sse-settings-coauthmode")||Common.localStorage.setItem("sse-settings-autosave",this.chAutosave.isChecked()?1:0),this.mode.canForcesave&&Common.localStorage.setItem("sse-settings-forcesave",this.chForcesave.isChecked()?1:0),Common.localStorage.setItem("sse-settings-func-locale",this.cmbFuncLocale.getValue()),this.cmbRegSettings.getSelectedRecord()&&Common.localStorage.setItem("sse-settings-reg-settings",this.cmbRegSettings.getValue());var e,t=this.chSeparator.isChecked(),t=(t||(0<(e=this.inputDecimalSeparator.getValue()).length&&(Common.localStorage.setItem("sse-settings-decimal-separator",e),Common.Utils.InternalSettings.set("sse-settings-decimal-separator",e)),0<(e=this.inputThousandsSeparator.getValue()).length&&(Common.localStorage.setItem("sse-settings-group-separator",e),Common.Utils.InternalSettings.set("sse-settings-group-separator",e))),Common.localStorage.setBool("sse-settings-use-base-separator",t),Common.Utils.InternalSettings.set("sse-settings-use-base-separator",t),Common.localStorage.setItem("sse-macros-mode",this.cmbMacros.getValue()),Common.Utils.InternalSettings.set("sse-macros-mode",this.cmbMacros.getValue()),Common.localStorage.setItem("sse-settings-paste-button",this.chPaste.isChecked()?1:0),this.chRTL.$el.is(":visible")&&Common.localStorage.getBool("ui-rtl")!==this.chRTL.isChecked());Common.localStorage.setBool("ui-rtl",this.chRTL.isChecked()),Common.localStorage.setBool("sse-settings-quick-print-button",this.chQuickPrint.isChecked()),Common.localStorage.save(),this.menu&&(this.menu.fireEvent("settings:apply",[this.menu]),this._oldUnits!==this.cmbUnit.getValue()&&Common.NotificationCenter.trigger("settings:unitschanged",this)),Common.UI.FeaturesManager.canChange("spellcheck")&&this.mode.isEdit&&(e=this.chIgnoreUppercase.isChecked(),Common.localStorage.setBool("sse-spellcheck-ignore-uppercase-words",e),Common.Utils.InternalSettings.set("sse-spellcheck-ignore-uppercase-words",e),e=this.chIgnoreNumbers.isChecked(),Common.localStorage.setBool("sse-spellcheck-ignore-numbers-words",e),Common.Utils.InternalSettings.set("sse-spellcheck-ignore-numbers-words",e),this.cmbDictionaryLanguage.isDisabled()||(e=this.cmbDictionaryLanguage.getValue(),Common.localStorage.setItem("sse-spellcheck-locale",e),Common.Utils.InternalSettings.set("sse-spellcheck-locale",e)),Common.localStorage.save(),this.menu&&this.menu.fireEvent("spellcheck:apply",[this.menu])),this.mode.isEdit&&this.api.asc_setDate1904(this.chDateSystem.isChecked()),t&&(e={title:this.txtWorkspaceSettingChange,msg:this.txtRestartEditor,iconCls:"warn",buttons:["ok"]},Common.UI.alert(e))},updateRegionalExample:function(t){this.api&&(i="",t&&((e=new Asc.asc_CFormatCellsInfo).asc_setType(Asc.c_oAscNumFormatType.None),e.asc_setSymbol(t),e=this.api.asc_getFormatCells(e),i=(i=(i=this.api.asc_getLocaleExample(e[4],1000.01,t))+" "+this.api.asc_getLocaleExample(e[5],Asc.cDate().getExcelDateWithTime(),t))+" "+this.api.asc_getLocaleExample(e[7],Asc.cDate().getExcelDateWithTime(),t)),$("#fms-lbl-reg-settings").text(_.isEmpty(i)?"":this.strRegSettingsEx+i));var e=this.cmbRegSettings.$el.find(".input-icon"),i=e.attr("lang"),t=Common.util.LanguageInfo.getLocalLanguageName(t)[0];i&&e.removeClass(i),e.addClass(t).attr("lang",t)},updateFuncExample:function(t){$("#fms-lbl-func-locale").text(_.isEmpty(t)?"":this.strRegSettingsEx+" "+t)},onFontRenderSelected:function(t,e){var i;"custom"==e.value&&((i=t.store.findWhere({value:"custom"}))&&i.set("checked",!e.checked),t.cmpEl.find("#"+e.id+" a").toggleClass("checked",!e.checked),t.setValue(this._fontRender)),this._fontRender=t.getValue()},autoCorrect:function(){this.dlgAutoCorrect&&this.dlgAutoCorrect.isVisible()||(this.dlgAutoCorrect=new Common.Views.AutoCorrectDialog({api:this.api}),this.dlgAutoCorrect.show())},SetDisabled:function(t){t?this.$el.hide():this.mode.isEdit&&this.$el.show()}},SSE.Views.FileMenuPanels.MainSettingsGeneral||{})),SSE.Views.FileMenuPanels.CreateNew=Common.UI.BaseView.extend(_.extend({el:"#panel-createnew",menu:void 0,events:function(){return{"click .blank-document-btn":_.bind(this._onBlankDocument,this),"click .thumb-list .thumb-wrap":_.bind(this._onDocumentTemplate,this)}},template:_.template(['<div class="header"><%= scope.txtCreateNew %></div>','<div class="thumb-list">',"<% if (blank) { %> ",'<div class="blank-document">','<div class="blank-document-btn" data-hint="2" data-hint-direction="left-top" data-hint-offset="10, 1">','<div class="btn-blank-format"><div class="svg-format-blank"></div></div>',"</div>",'<div class="title"><%= scope.txtBlank %></div>',"</div>","<% } %>","<% _.each(docs, function(item, index) { %>",'<div class="thumb-wrap" template="<%= item.url %>" data-hint="2" data-hint-direction="left-top" data-hint-offset="22, 13">','<div class="thumb" ',"<% if (!_.isEmpty(item.image)) {%> ",' style="background-image: url(<%= item.image %>);">'," <%} else {print(\"><div class='btn-blank-format'><div class='svg-file-template'></div></div>\") } %>","</div>",'<div class="title"><%= Common.Utils.String.htmlEncode(item.title || item.name || "") %></div>',"</div>","<% }) %>","</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.menu=t.menu,this.docs=t.docs,this.blank=!!t.blank},render:function(){this.$el.html(this.template({scope:this,docs:this.docs,blank:this.blank}));var i=(this.blank?[{title:this.txtBlank}]:[]).concat(this.docs),t=this.$el.find(".thumb-wrap, .blank-document");return _.each(t,function(t,e){$(t).find(".title").tooltip({title:i[e].title,placement:"cursor"})}),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:this.$el,suppressScrollX:!0,alwaysVisibleY:!0})),this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this.scroller&&this.scroller.update()},_onBlankDocument:function(){this.menu&&this.menu.fireEvent("create:new",[this.menu,"blank"])},_onDocumentTemplate:function(t){this.menu&&this.menu.fireEvent("create:new",[this.menu,t.currentTarget.attributes.template.value])},txtBlank:"Blank spreadsheet",txtCreateNew:"Create New"},SSE.Views.FileMenuPanels.CreateNew||{})),SSE.Views.FileMenuPanels.DocumentInfo=Common.UI.BaseView.extend(_.extend({el:"#panel-info",menu:void 0,initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.rendered=!1,this.template=_.template(['<div class="flex-settings">','<div class="header">'+this.txtSpreadsheetInfo+"</div>",'<table class="main">',"<tr>",'<td class="left"><label>'+this.txtPlacement+"</label></td>",'<td class="right"><label id="id-info-placement">-</label></td>',"</tr>","<tr>",'<td class="left"><label>'+this.txtOwner+"</label></td>",'<td class="right"><label id="id-info-owner">-</label></td>',"</tr>","<tr>",'<td class="left"><label>'+this.txtUploaded+"</label></td>",'<td class="right"><label id="id-info-uploaded">-</label></td>',"</tr>",'<tr class="divider general"></tr>','<tr class="divider general"></tr>',"<tr>",'<td class="left"><label>'+this.txtTitle+"</label></td>",'<td class="right"><div id="id-info-title"></div></td>',"</tr>","<tr>",'<td class="left"><label>'+this.txtTags+"</label></td>",'<td class="right"><div id="id-info-tags"></div></td>',"</tr>","<tr>",'<td class="left"><label>'+this.txtSubject+"</label></td>",'<td class="right"><div id="id-info-subject"></div></td>',"</tr>","<tr>",'<td class="left"><label>'+this.txtComment+"</label></td>",'<td class="right"><div id="id-info-comment"></div></td>',"</tr>",'<tr class="divider"></tr>','<tr class="divider"></tr>',"<tr>",'<td class="left"><label>'+this.txtModifyDate+"</label></td>",'<td class="right"><label id="id-info-modify-date"></label></td>',"</tr>","<tr>",'<td class="left"><label>'+this.txtModifyBy+"</label></td>",'<td class="right"><label id="id-info-modify-by"></label></td>',"</tr>",'<tr class="divider modify">','<tr class="divider modify">',"<tr>",'<td class="left"><label>'+this.txtCreated+"</label></td>",'<td class="right"><label id="id-info-date"></label></td>',"</tr>","<tr>",'<td class="left" style="vertical-align: top;"><label style="margin-top: 3px;">'+this.txtAuthor+"</label></td>",'<td class="right" style="vertical-align: top;"><div id="id-info-author">',"<table>","<tr>",'<td><div id="id-info-add-author"><input type="text" spellcheck="false" class="form-control" placeholder="'+this.txtAddAuthor+'"></div></td>',"</tr>","</table>","</div></td>","</tr>",'<tr style="height: 5px;"></tr>',"</table>","</div>",'<div id="fms-flex-apply">','<table class="main" style="margin: 10px 0;">',"<tr>",'<td class="left"></td>','<td class="right"><button id="fminfo-btn-apply" class="btn normal dlg-btn primary" data-hint="2" data-hint-direction="bottom" data-hint-offset="medium"><%= scope.okButtonText %></button></td>',"</tr>","</table>","</div>"].join("")),this.menu=t.menu,this.coreProps=null,this.authors=[],this._locked=!1},render:function(t){function e(t,e){var i;e.keyCode===Common.UI.Keys.ESC&&t._input.val()!==(i=t.getValue())&&(t.setValue(i),e.stopPropagation())}var n=this,i=$(n.template({scope:n}));this.lblPlacement=i.findById("#id-info-placement"),this.lblOwner=i.findById("#id-info-owner"),this.lblUploaded=i.findById("#id-info-uploaded");return this.inputTitle=new Common.UI.InputField({el:i.findById("#id-info-title"),style:"width: 200px;",placeHolder:this.txtAddText,validateOnBlur:!1,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}).on("keydown:before",e),this.inputTags=new Common.UI.InputField({el:i.findById("#id-info-tags"),style:"width: 200px;",placeHolder:this.txtAddText,validateOnBlur:!1,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}).on("keydown:before",e),this.inputSubject=new Common.UI.InputField({el:i.findById("#id-info-subject"),style:"width: 200px;",placeHolder:this.txtAddText,validateOnBlur:!1,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}).on("keydown:before",e),this.inputComment=new Common.UI.InputField({el:i.findById("#id-info-comment"),style:"width: 200px;",placeHolder:this.txtAddText,validateOnBlur:!1,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}).on("keydown:before",e),this.lblModifyDate=i.findById("#id-info-modify-date"),this.lblModifyBy=i.findById("#id-info-modify-by"),this.lblDate=i.findById("#id-info-date"),this.lblApplication=i.findById("#id-info-appname"),this.tblAuthor=i.findById("#id-info-author table"),this.trAuthor=i.findById("#id-info-add-author").closest("tr"),this.authorTpl='<tr><td><div style="display: inline-block;width: 200px;"><input type="text" spellcheck="false" class="form-control" readonly="true" value="{0}" ></div><div class="tool close img-commonctrl img-colored" data-hint="2" data-hint-direction="right" data-hint-offset="small"></div></td></tr>',this.tblAuthor.on("click",function(t){var e,t=i.find(t.target);t.hasClass("close")&&!t.hasClass("disabled")&&(t=t.closest("tr"),e=n.tblAuthor.find("tr").index(t),t.remove(),n.authors.splice(e,1),n.updateScroller(!0))}),this.inputAuthor=new Common.UI.InputField({el:i.findById("#id-info-add-author"),style:"width: 200px;",validateOnBlur:!1,placeHolder:this.txtAddAuthor,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}).on("changed:after",function(t,e,i,s){var o;e!=i&&(e=e.trim())&&e!==i.trim()&&(o=s&&s.relatedTarget&&"fminfo-btn-apply"==s.relatedTarget.id,e.split(/\s*[,;]\s*/).forEach(function(t){var e=t.trim();e&&(n.authors.push(t),o||(t=$(Common.Utils.String.format(n.authorTpl,Common.Utils.String.htmlEncode(e))),n.trAuthor.before(t),n.updateScroller()))}),o||n.inputAuthor.setValue(""))}).on("keydown:before",e),this.btnApply=new Common.UI.Button({el:i.findById("#fminfo-btn-apply")}),this.btnApply.on("click",_.bind(this.applySettings,this)),this.pnlInfo=i.find(".flex-settings").addBack().filter(".flex-settings"),this.pnlApply=i.findById("#fms-flex-apply"),this.rendered=!0,this.updateInfo(this.doc),this.$el=$(t).html(i),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:this.pnlInfo,suppressScrollX:!0,alwaysVisibleY:!0})),Common.NotificationCenter.on({"window:resize":function(){n.isVisible()&&n.updateScroller()}}),this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this.updateFileInfo(),this.scroller&&this.scroller.scrollTop(0),this.updateScroller()},hide:function(){Common.UI.BaseView.prototype.hide.call(this,arguments)},updateScroller:function(t){this.scroller&&(this.scroller.update(t?{}:void 0),this.pnlInfo.toggleClass("bordered",this.scroller.isVisible()))},updateInfo:function(t){if(this.doc=t,this.rendered){var e,i=!1,t=((t=t||{}).info?(t.info.folder&&this.lblPlacement.text(t.info.folder),i=this._ShowHideInfoItem(this.lblPlacement,void 0!==t.info.folder&&null!==t.info.folder)||i,(e=t.info.owner)&&this.lblOwner.text(e),i=this._ShowHideInfoItem(this.lblOwner,!!e)||i,(e=t.info.uploaded)&&this.lblUploaded.text(e),i=this._ShowHideInfoItem(this.lblUploaded,!!e)||i):this._ShowHideDocInfo(!1),$("tr.divider.general",this.el)[i?"show":"hide"](),this.api?this.api.asc_getAppProps():null);if(t&&(t=(t.asc_getApplication()||"")+(t.asc_getAppVersion()?" ":"")+(t.asc_getAppVersion()||""),this.lblApplication.text(t)),this._ShowHideInfoItem(this.lblApplication,!!t),this.coreProps=this.api?this.api.asc_getCoreProps():null,this.coreProps){if(e=this.coreProps.asc_getCreated()){i=(this.mode.lang||"en").replace("_","-").toLowerCase();try{this.lblDate.text(e.toLocaleString(i,{year:"numeric",month:"2-digit",day:"2-digit"})+" "+e.toLocaleString(i,{timeStyle:"short"}))}catch(t){this.lblDate.text(e.toLocaleString("en",{year:"numeric",month:"2-digit",day:"2-digit"})+" "+e.toLocaleString("en",{timeStyle:"short"}))}}this._ShowHideInfoItem(this.lblDate,!!e)}}},updateFileInfo:function(){if(this.rendered){var i=this,t=this.api?this.api.asc_getCoreProps():null;if(this.coreProps=t){var e;if(e=t.asc_getModified()){var s=(this.mode.lang||"en").replace("_","-").toLowerCase();try{this.lblModifyDate.text(e.toLocaleString(s,{year:"numeric",month:"2-digit",day:"2-digit"})+" "+e.toLocaleString(s,{timeStyle:"short"}))}catch(t){this.lblModifyDate.text(e.toLocaleString("en",{year:"numeric",month:"2-digit",day:"2-digit"})+" "+e.toLocaleString("en",{timeStyle:"short"}))}}s=this._ShowHideInfoItem(this.lblModifyDate,!!e)||!1,(e=t.asc_getLastModifiedBy())&&this.lblModifyBy.text(AscCommon.UserInfoParser.getParsedName(e)),s=this._ShowHideInfoItem(this.lblModifyBy,!!e)||s,$("tr.divider.modify",this.el)[s?"show":"hide"](),e=t.asc_getTitle(),this.inputTitle.setValue(e||""),e=t.asc_getKeywords(),this.inputTags.setValue(e||""),e=t.asc_getSubject(),this.inputSubject.setValue(e||""),e=t.asc_getDescription(),this.inputComment.setValue(e||""),this.inputAuthor.setValue(""),this.tblAuthor.find("tr:not(:last-of-type)").remove(),this.authors=[],(e=t.asc_getCreator())&&e.split(/\s*[,;]\s*/).forEach(function(t){var e=$(Common.Utils.String.format(i.authorTpl,Common.Utils.String.htmlEncode(t)));i.trAuthor.before(e),i.authors.push(t)}),this.tblAuthor.find(".close").toggleClass("hidden",!this.mode.isEdit),this.mode.isEdit||this._ShowHideInfoItem(this.tblAuthor,!!this.authors.length)}this.SetDisabled()}},_ShowHideInfoItem:function(t,e){return t.closest("tr")[e?"show":"hide"](),e},_ShowHideDocInfo:function(t){this._ShowHideInfoItem(this.lblPlacement,t),this._ShowHideInfoItem(this.lblOwner,t),this._ShowHideInfoItem(this.lblUploaded,t)},setMode:function(t){return this.mode=t,this.inputAuthor.setVisible(t.isEdit),this.pnlApply.toggleClass("hidden",!t.isEdit),this.tblAuthor.find(".close").toggleClass("hidden",!t.isEdit),t.isEdit||(this.inputTitle._input.attr("placeholder",""),this.inputTags._input.attr("placeholder",""),this.inputSubject._input.attr("placeholder",""),this.inputComment._input.attr("placeholder",""),this.inputAuthor._input.attr("placeholder","")),this.SetDisabled(),this},setApi:function(t){return this.api=t,this.api.asc_registerCallback("asc_onLockCore",_.bind(this.onLockCore,this)),this.updateInfo(this.doc),this},onLockCore:function(t){this._locked=t,this.updateFileInfo()},SetDisabled:function(){var t=!this.mode.isEdit||this._locked;this.inputTitle.setDisabled(t),this.inputTags.setDisabled(t),this.inputSubject.setDisabled(t),this.inputComment.setDisabled(t),this.inputAuthor.setDisabled(t),this.tblAuthor.find(".close").toggleClass("disabled",this._locked),this.tblAuthor.toggleClass("disabled",t),this.btnApply.setDisabled(this._locked)},applySettings:function(){this.coreProps&&this.api&&(this.coreProps.asc_putTitle(this.inputTitle.getValue()),this.coreProps.asc_putKeywords(this.inputTags.getValue()),this.coreProps.asc_putSubject(this.inputSubject.getValue()),this.coreProps.asc_putDescription(this.inputComment.getValue()),this.coreProps.asc_putCreator(this.authors.join(";")),this.api.asc_setCoreProps(this.coreProps)),this.menu.hide()}},SSE.Views.FileMenuPanels.DocumentInfo||{})),SSE.Views.FileMenuPanels.DocumentRights=Common.UI.BaseView.extend(_.extend({el:"#panel-rights",menu:void 0,initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.rendered=!1,this.template=_.template(['<div class="header">'+this.txtAccessRights+"</div>",'<table class="main">','<tr class="rights">','<td class="left" style="vertical-align: top;"><label>'+this.txtRights+"</label></td>",'<td class="right"><div id="id-info-rights"></div></td>',"</tr>",'<tr class="edit-rights">','<td class="left"></td><td class="right"><button id="id-info-btn-edit" class="btn normal dlg-btn primary custom">'+this.txtBtnAccessRights+"</button></td>","</tr>","</table>"].join("")),this.templateRights=_.template(["<table>","<% _.each(users, function(item) { %>","<tr>",'<td><span class="userLink img-commonctrl <% if (item.isLink) { %>sharedLink<% } %>"></span><span><%= Common.Utils.String.htmlEncode(item.user) %></span></td>',"<td><%= Common.Utils.String.htmlEncode(item.permissions) %></td>","</tr>","<% }); %>","</table>"].join("")),this.menu=t.menu},render:function(t){var e=$(this.template());return this.cntRights=e.findById("#id-info-rights"),this.btnEditRights=new Common.UI.Button({el:e.findById("#id-info-btn-edit")}),this.btnEditRights.on("click",_.bind(this.changeAccessRights,this)),this.rendered=!0,this.updateInfo(this.doc),this.$el=$(t).html(e),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:this.$el,suppressScrollX:!0,alwaysVisibleY:!0})),Common.NotificationCenter.on("collaboration:sharingupdate",this.updateSharingSettings.bind(this)),Common.NotificationCenter.on("collaboration:sharingdeny",this.onLostEditRights.bind(this)),this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this.scroller&&this.scroller.update()},hide:function(){Common.UI.BaseView.prototype.hide.call(this,arguments)},updateInfo:function(t){this.doc=t,this.rendered&&((t=t||{}).info?(t.info.sharingSettings&&this.cntRights.html(this.templateRights({users:t.info.sharingSettings})),this._ShowHideInfoItem("rights",void 0!==t.info.sharingSettings&&null!==t.info.sharingSettings&&0<t.info.sharingSettings.length),this._ShowHideInfoItem("edit-rights",(!!this.sharingSettingsUrl&&this.sharingSettingsUrl.length||this.mode.canRequestSharingSettings)&&!0!==this._readonlyRights)):this._ShowHideDocInfo(!1))},_ShowHideInfoItem:function(t,e){$("tr."+t,this.el)[e?"show":"hide"]()},_ShowHideDocInfo:function(t){this._ShowHideInfoItem("rights",t),this._ShowHideInfoItem("edit-rights",t)},setMode:function(t){return this.mode=t,this.sharingSettingsUrl=t.sharingSettingsUrl,this},changeAccessRights:function(t,e,i){Common.NotificationCenter.trigger("collaboration:sharing")},updateSharingSettings:function(t){this._ShowHideInfoItem("rights",void 0!==this.doc.info.sharingSettings&&null!==this.doc.info.sharingSettings&&0<this.doc.info.sharingSettings.length),this.cntRights.html(this.templateRights({users:this.doc.info.sharingSettings}))},onLostEditRights:function(){this._readonlyRights=!0,this.rendered&&this._ShowHideInfoItem("edit-rights",!1)},txtRights:"Persons who have rights",txtBtnAccessRights:"Change access rights",txtAccessRights:"Access Rights"},SSE.Views.FileMenuPanels.DocumentRights||{})),SSE.Views.FileMenuPanels.Help=Common.UI.BaseView.extend({el:"#panel-help",menu:void 0,template:_.template(['<div style="width:100%; height:100%; position: relative;">','<div id="id-help-contents" style="position: absolute; width:220px; top: 0; bottom: 0;" class="no-padding"></div>','<div id="id-help-frame" class="no-padding"></div>',"</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.menu=t.menu,this.urlPref="resources/help/zh/",this.openUrl=null,this.en_data=[{src:"ProgramInterface/ProgramInterface.htm",name:"Introducing Spreadsheet Editor user interface",headername:"Program Interface"},{src:"ProgramInterface/FileTab.htm",name:"File tab"},{src:"ProgramInterface/HomeTab.htm",name:"Home Tab"},{src:"ProgramInterface/InsertTab.htm",name:"Insert tab"},{src:"ProgramInterface/PluginsTab.htm",name:"Plugins tab"},{src:"UsageInstructions/OpenCreateNew.htm",name:"Create a new spreadsheet or open an existing one",headername:"Basic operations"},{src:"UsageInstructions/CopyPasteData.htm",name:"Cut/copy/paste data"},{src:"UsageInstructions/UndoRedo.htm",name:"Undo/redo your actions"},{src:"UsageInstructions/ManageSheets.htm",name:"Manage sheets",headername:"Operations with sheets"},{src:"UsageInstructions/FontTypeSizeStyle.htm",name:"Set font type, size, style, and colors",headername:"Cell text formatting"},{src:"UsageInstructions/AddHyperlinks.htm",name:"Add hyperlinks"},{src:"UsageInstructions/ClearFormatting.htm",name:"Clear text, format in a cell, copy cell format"},{src:"UsageInstructions/AddBorders.htm",name:"Add borders",headername:"Editing cell properties"},{src:"UsageInstructions/AlignText.htm",name:"Align data in cells"},{src:"UsageInstructions/MergeCells.htm",name:"Merge cells"},{src:"UsageInstructions/ChangeNumberFormat.htm",name:"Change number format"},{src:"UsageInstructions/InsertDeleteCells.htm",name:"Manage cells, rows, and columns",headername:"Editing rows/columns"},{src:"UsageInstructions/SortData.htm",name:"Sort and filter data"},{src:"UsageInstructions/InsertFunction.htm",name:"Insert function",headername:"Work with functions"},{src:"UsageInstructions/UseNamedRanges.htm",name:"Use named ranges"},{src:"UsageInstructions/InsertImages.htm",name:"Insert images",headername:"Operations on objects"},{src:"UsageInstructions/InsertChart.htm",name:"Insert chart"},{src:"UsageInstructions/InsertAutoshapes.htm",name:"Insert and format autoshapes"},{src:"UsageInstructions/InsertTextObjects.htm",name:"Insert text objects"},{src:"UsageInstructions/ManipulateObjects.htm",name:"Manipulate objects"},{src:"UsageInstructions/InsertEquation.htm",name:"Insert equations",headername:"Math equations"},{src:"HelpfulHints/CollaborativeEditing.htm",name:"Collaborative spreadsheet editing",headername:"Spreadsheet co-editing"},{src:"UsageInstructions/ViewDocInfo.htm",name:"View file information",headername:"Tools and settings"},{src:"UsageInstructions/SavePrintDownload.htm",name:"Save/print/download your spreadsheet"},{src:"HelpfulHints/AdvancedSettings.htm",name:"Advanced settings of Spreadsheet Editor"},{src:"HelpfulHints/Navigation.htm",name:"View settings and navigation tools"},{src:"HelpfulHints/Search.htm",name:"Search and replace functions"},{src:"HelpfulHints/About.htm",name:"About Spreadsheet Editor",headername:"Helpful hints"},{src:"HelpfulHints/SupportedFormats.htm",name:"Supported formats of spreadsheets"},{src:"HelpfulHints/KeyboardShortcuts.htm",name:"Keyboard shortcuts"}],Common.Utils.isIE&&(window.onhelp=function(){return!1})},render:function(){var s=this;return this.$el.html(this.template()),this.viewHelpPicker=new Common.UI.DataView({el:$("#id-help-contents"),store:new Common.UI.DataViewStore([]),keyMoveDirection:"vertical",itemTemplate:_.template(['<div id="<%= id %>" class="help-item-wrap">','<div class="caption"><%= name %></div>',"</div>"].join(""))}),this.viewHelpPicker.on("item:add",function(t,e,i){i.has("headername")&&$(e.el).before('<div class="header-name">'+i.get("headername")+"</div>")}),this.viewHelpPicker.on("item:select",function(t,e,i){s.onSelectItem(i.get("src"))}),this.iFrame=document.createElement("iframe"),this.iFrame.src="",this.iFrame.align="top",this.iFrame.frameBorder="0",this.iFrame.width="100%",this.iFrame.height="100%",(Common.Utils.isChrome||Common.Utils.isOpera||Common.Utils.isGecko&&86<Common.Utils.firefoxVersion)&&(this.iFrame.onload=function(){try{s.findUrl(s.iFrame.contentWindow.location.href)}catch(t){}}),Common.Gateway.on("internalcommand",function(t){"help:hyperlink"==t.type&&s.findUrl(t.data)}),$("#id-help-frame").append(this.iFrame),this},setLangConfig:function(t){var e,i=this,s=this.viewHelpPicker.store;t&&(t=t.split(/[\-\_]/)[0],e={dataType:"json",error:function(){i.urlPref.indexOf("resources/help/zh/")<0?(i.urlPref="resources/help/zh/",s.url="resources/help/zh/Contents.json",s.fetch(e)):(i.urlPref="resources/help/zh/",s.reset(i.en_data))},success:function(){var t=i.openUrl?s.find(function(t){return 0<=i.openUrl.indexOf(t.get("src"))}):s.at(0);t&&(i.viewHelpPicker.selectRecord(t,!0),i.viewHelpPicker.scrollToRecord(t)),i.onSelectItem(i.openUrl||t.get("src"))}},Common.Controllers.Desktop.isActive()?Common.Controllers.Desktop.isHelpAvailable()?(i.urlPref=Common.Controllers.Desktop.helpUrl()+"/",s.url=i.urlPref+"Contents.json",s.fetch(e)):(i.noHelpContents=!0,i.iFrame.src="../../common/main/resources/help/download.html"):(s.url="resources/help/"+t+"/Contents.json",s.fetch(e),this.urlPref="resources/help/"+t+"/"))},show:function(t){Common.UI.BaseView.prototype.show.call(this),this._scrollerInited||(this.viewHelpPicker.scroller.update(),this._scrollerInited=!0),t&&(0<this.viewHelpPicker.store.length?(this.findUrl(t),this.onSelectItem(t)):this.openUrl=t)},onSelectItem:function(t){this.iFrame.src=this.urlPref+t},findUrl:function(e){var t=this.viewHelpPicker.store.find(function(t){return 0<=e.indexOf(t.get("src"))});t&&(this.viewHelpPicker.selectRecord(t,!0),this.viewHelpPicker.scrollToRecord(t))}}),SSE.Views.FileMenuPanels.ProtectDoc=Common.UI.BaseView.extend(_.extend({el:"#panel-protect",menu:void 0,template:_.template(['<label id="id-fms-lbl-protect-header"><%= scope.strProtect %></label>','<div id="id-fms-password">','<label class="header"><%= scope.strEncrypt %></label>','<div class="encrypt-block">','<div class="description"><%= scope.txtProtectSpreadsheet %></div>','<div id="fms-btn-add-pwd"></div>',"</div>",'<div class="encrypted-block">','<div class="description"><%= scope.txtEncrypted %></div>','<div class="buttons">','<div id="fms-btn-change-pwd"></div>','<div id="fms-btn-delete-pwd" class="margin-left-16"></div>',"</div>","</div>","</div>",'<div id="id-fms-signature">','<label class="header"><%= scope.strSignature %></label>','<div class="add-signature-block">','<div class="description"><%= scope.txtAddSignature %></div>','<div id="fms-btn-invisible-sign"></div>',"</div>",'<div class="added-signature-block">','<div class="description"><%= scope.txtAddedSignature %></div>',"</div>",'<div id="id-fms-signature-view"></div>',"</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.menu=t.menu;this.templateSignature=_.template(['<div class="<% if (!hasRequested && !hasSigned) { %>hidden<% } %>"">','<div class="signature-tip"><%= tipText %></div>','<div class="buttons">','<label class="link signature-view-link margin-right-20" data-hint="2" data-hint-direction="bottom" data-hint-offset="medium">'+this.txtView+"</label>",'<label class="link signature-edit-link <% if (!hasSigned) { %>hidden<% } %>" data-hint="2" data-hint-direction="bottom" data-hint-offset="medium">'+this.txtEdit+"</label>","</div>","</div>"].join(""))},render:function(){this.$el.html(this.template({scope:this}));var t=SSE.getController("Common.Controllers.Protection").getView();return this.btnAddPwd=t.getButton("add-password"),this.btnAddPwd.render(this.$el.find("#fms-btn-add-pwd")),this.btnAddPwd.on("click",_.bind(this.closeMenu,this)),this.btnChangePwd=t.getButton("change-password"),this.btnChangePwd.render(this.$el.find("#fms-btn-change-pwd")),this.btnChangePwd.on("click",_.bind(this.closeMenu,this)),this.btnDeletePwd=t.getButton("del-password"),this.btnDeletePwd.render(this.$el.find("#fms-btn-delete-pwd")),this.btnDeletePwd.on("click",_.bind(this.closeMenu,this)),this.cntPassword=$("#id-fms-password"),this.cntEncryptBlock=this.$el.find(".encrypt-block"),this.cntEncryptedBlock=this.$el.find(".encrypted-block"),this.btnAddInvisibleSign=t.getButton("signature"),this.btnAddInvisibleSign.render(this.$el.find("#fms-btn-invisible-sign")),this.btnAddInvisibleSign.on("click",_.bind(this.closeMenu,this)),this.cntSignature=$("#id-fms-signature"),this.cntSignatureView=$("#id-fms-signature-view"),this.cntAddSignature=this.$el.find(".add-signature-block"),this.cntAddedSignature=this.$el.find(".added-signature-block"),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:this.$el,suppressScrollX:!0,alwaysVisibleY:!0})),this.$el.on("click",".signature-edit-link",_.bind(this.onEdit,this)),this.$el.on("click",".signature-view-link",_.bind(this.onView,this)),this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this.updateSignatures(),this.updateEncrypt(),this.scroller&&this.scroller.update()},setMode:function(t){this.mode=t,this.cntSignature.toggleClass("hidden",!this.mode.isSignatureSupport),this.cntPassword.toggleClass("hidden",!this.mode.isPasswordSupport)},setApi:function(t){return this.api=t,this},closeMenu:function(){this.menu&&this.menu.hide()},onEdit:function(){this.menu&&this.menu.hide();var e=this;Common.UI.warning({title:this.notcriticalErrorTitle,msg:this.txtEditWarning,buttons:["ok","cancel"],primary:"ok",callback:function(t){"ok"==t&&e.api.asc_RemoveAllSignatures()}})},onView:function(){this.menu&&this.menu.hide(),SSE.getController("RightMenu").rightmenu.SetActivePane(Common.Utils.documentSettingsType.Signature,!0)},updateSignatures:function(){var t=this.api.asc_getRequestSignatures(),e=this.api.asc_getSignatures(),t=t&&0<t.length,i=!1,s=!1,e=(_.each(e,function(t,e){0==t.asc_getValid()?i=!0:s=!0}),s?this.txtSignedInvalid:i?this.txtSigned:""),e=(t&&(e=this.txtRequestedSignatures+(""!=e?"<br><br>":"")+e),this.cntSignatureView.html(this.templateSignature({tipText:e,hasSigned:i||s,hasRequested:t})),this.btnAddInvisibleSign.$el.find("button").hasClass("hidden"));this.cntAddSignature.toggleClass("hidden",e),this.cntAddedSignature.toggleClass("hidden",!e)},updateEncrypt:function(){var t=this.btnAddPwd.$el.find("button").hasClass("hidden");this.cntEncryptBlock.toggleClass("hidden",t),this.cntEncryptedBlock.toggleClass("hidden",!t)}},SSE.Views.FileMenuPanels.ProtectDoc||{})),SSE.Views.PrintWithPreview=Common.UI.BaseView.extend(_.extend({el:"#panel-print",menu:void 0,template:_.template(['<div style="width:100%; height:100%; position: relative;">','<div id="id-print-settings" class="no-padding">','<div class="print-settings">','<div class="flex-settings ps-container oo settings-container">','<div class="main-header"><%= scope.txtPrint %></div>','<table style="width: 100%;">',"<tbody>",'<tr><td><label class="font-weight-bold"><%= scope.txtPrintRange %></label></td></tr>','<tr><td class="padding-small"><div id="print-combo-range" style="width: 248px;"></div></td></tr>','<tr><td class="padding-large"><div id="print-chb-ignore" style="width: 248px;"></div></td></tr>','<tr><td class="padding-large">','<div class="pages">',"<label><%= scope.txtPages %></label>",'<div id="print-spin-pages-from"></div>',"<label><%= scope.txtTo %></label>",'<div id="print-spin-pages-to"></div>',"</div>","</td></tr>",'<tr class="desktop-settings"><td class="padding-large">','<div class="pages">',"<label><%= scope.txtCopies %>:</label>",'<div id="print-txt-copies"></div>',"</div>","</td></tr>",'<tr class="desktop-settings"><td><label class="font-weight-bold"><%= scope.txtPrintSides %></label></td></tr>','<tr class="desktop-settings"><td class="padding-large"><div id="print-combo-sides" style="width: 248px;"></div></td></tr>','<tr class="desktop-settings"><td class="padding-large"><div class="separator horizontal" style="width: 248px;"></div></td></tr>','<tr><td><label class="font-weight-bold"><%= scope.txtSettingsOfSheet %></label></td></tr>','<tr><td class="padding-large"><div id="print-combo-sheets" style="width: 248px;"></div></td></tr>','<tr><td><label class="font-weight-bold"><%= scope.txtPageSize %></label></td></tr>','<tr><td class="padding-large"><div id="print-combo-pages" style="width: 248px;"></div></td></tr>','<tr><td><label class="font-weight-bold"><%= scope.txtPageOrientation %></label></td></tr>','<tr><td class="padding-large"><div id="print-combo-orient" style="width: 134px;"></div></td></tr>','<tr><td><label class="font-weight-bold"><%= scope.txtMargins %></label></td></tr>','<tr><td class="padding-large"><div id="print-combo-margins" style="width: 248px;"></div></td></tr>','<tr><td><label class="font-weight-bold"><%= scope.txtScaling %></label></td></tr>','<tr><td class="padding-large"><div id="print-combo-layout" style="width: 248px;"></div></td></tr>','<tr><td class="padding-large">','<table class="print-titles-container"><tbody>','<tr class="print-titles-header"><td>','<span class="print-titles-caret img-commonctrl"></span>','<label class="font-weight-bold"><%= scope.txtPrintTitles %></label>',"</td></tr>",'<tr class="print-titles-options"><td><label><%= scope.txtRepeatRowsAtTop %></label></td></tr>','<tr class="print-titles-options"><td class="padding-small">',"<table><tbody><tr>",'<td><div id="print-txt-top" style="width: 145px;"></div></td>','<td><div id="print-presets-top" style="width: 95px;"></div></td>',"</tr></tbody></table>","</td></tr>",'<tr class="print-titles-options"><td><label><%= scope.txtRepeatColumnsAtLeft %></label></td></tr>','<tr class="print-titles-options"><td>',"<table><tbody><tr>",'<td><div id="print-txt-left" style="width: 145px;"></div></td>','<td><div id="print-presets-left" style="width: 95px;"></div></td>',"</tr></tbody></table>","</td></tr>","</tbody></table>","</td></tr>",'<tr><td class="padding-small"><label class="font-weight-bold"><%= scope.txtGridlinesAndHeadings %></label></td></tr>','<tr><td class="padding-small"><div id="print-chb-grid" style="width: 248px;"></div></td></tr>','<tr><td class="padding-large"><div id="print-chb-rows" style="width: 248px;"></div></td></tr>','<tr class="header-settings"><td class="padding-large"><label class="link" id="print-header-footer-settings" data-hint="2" data-hint-direction="bottom" data-hint-offset="medium"><%= scope.txtHeaderFooterSettings %></label></td></tr>','<tr><td class="padding-large first-page">',"<label><%= scope.txtFirstPageNumber %></label>",'<div id="print-spin-first-page"></div>',"</td></tr>",'<tr class="fms-btn-apply"><td>','<div class="footer justify">','<button id="print-btn-print-0" class="btn normal dlg-btn primary" result="print" style="width: 96px;" data-hint="2" data-hint-direction="bottom" data-hint-offset="big"><%= scope.txtPrint %></button>','<button id="print-btn-save-0" class="btn normal dlg-btn" result="save" style="width: 96px;" data-hint="2" data-hint-direction="bottom" data-hint-offset="big"><%= scope.txtSave %></button>',"</div>","</td></tr>","</tbody>","</table>","</div>",'<div class="fms-flex-apply hidden">','<div class="footer justify">','<button id="print-btn-print-1" class="btn normal dlg-btn primary" result="print" style="width: 96px;" data-hint="2" data-hint-direction="bottom" data-hint-offset="big"><%= scope.txtPrint %></button>','<button id="print-btn-save-1" class="btn normal dlg-btn" result="save" style="width: 96px;" data-hint="2" data-hint-direction="bottom" data-hint-offset="big"><%= scope.txtSave %></button>',"</div>","</div>","</div>","</div>",'<div id="print-preview-box" class="no-padding">','<div id="print-preview"></div>','<div id="print-navigation">',"<% if (!isRTL) { %>",'<div id="print-prev-page"></div>','<div id="print-next-page"></div>',"<% } else { %>",'<div id="print-next-page"></div>','<div id="print-prev-page"></div>',"<% } %>",'<div class="page-number margin-left-10">',"<label><%= scope.txtPage %></label>",'<div id="print-number-page" class="margin-left-4"></div>','<label id="print-count-page" class="margin-left-4"><%= scope.txtOf %></label>',"</div>",'<label id="print-active-sheet"><%= scope.txtSheet %></label>',"</div>","</div>",'<div id="print-preview-empty" class="hidden">',"<div><%= scope.txtEmptyTable %></div>","</div>","</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.menu=t.menu,this._initSettings=!0,this.extendedPrintTitles=Common.localStorage.getBool("sse-print-titles-extended",!0)},render:function(t){var e=this,i=$(this.template({scope:this,isRTL:Common.UI.isRTL()})),s=(this.cmbRange=new Common.UI.ComboBox({el:i.findById("#print-combo-range"),menuStyle:"min-width: 248px;max-height: 280px;",editable:!1,takeFocusOnClose:!0,cls:"input-group-nr",data:[{value:Asc.c_oAscPrintType.ActiveSheets,displayValue:this.txtActiveSheets},{value:Asc.c_oAscPrintType.EntireWorkbook,displayValue:this.txtAllSheets},{value:Asc.c_oAscPrintType.Selection,displayValue:this.txtSelection}],dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbRange.on("selected",_.bind(this.comboRangeChange,this)),this.chIgnorePrintArea=new Common.UI.CheckBox({el:i.findById("#print-chb-ignore"),labelText:this.txtIgnore,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.spnPagesFrom=new Common.UI.MetricSpinner({el:i.findById("#print-spin-pages-from"),step:1,width:60,defaultUnit:"",value:"",maxValue:1e6,minValue:1,allowDecimal:!1,maskExp:/[0-9]/,dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.spnPagesTo=new Common.UI.MetricSpinner({el:i.findById("#print-spin-pages-to"),step:1,width:60,defaultUnit:"",value:"",maxValue:1e6,minValue:1,allowDecimal:!1,maskExp:/[0-9]/,dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.spnCopies=new Common.UI.MetricSpinner({el:i.findById("#print-txt-copies"),step:1,width:60,defaultUnit:"",value:1,maxValue:32767,minValue:1,allowDecimal:!1,maskExp:/[0-9]/,dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbSides=new Common.UI.ComboBox({el:i.findById("#print-combo-sides"),menuStyle:"width:100%;",editable:!1,takeFocusOnClose:!0,cls:"input-group-nr",data:[{value:"one",displayValue:this.txtOneSide,descValue:this.txtOneSideDesc},{value:"both-long",displayValue:this.txtBothSides,descValue:this.txtBothSidesLongDesc},{value:"both-short",displayValue:this.txtBothSides,descValue:this.txtBothSidesShortDesc}],itemsTemplate:_.template(["<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%- item.value %>"><a tabindex="-1" type="menuitem" style ="display: flex; flex-direction: column;">','<label class="font-weight-bold"><%= scope.getDisplayValue(item) %></label><label class="comment-text"><%= item.descValue %></label></a></li>',"<% }); %>"].join("")),dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbSides.setValue("one"),this.cmbSheet=new Common.UI.ComboBox({el:i.findById("#print-combo-sheets"),menuStyle:"min-width: 248px;max-height: 280px;",editable:!1,cls:"input-group-nr",data:[],takeFocusOnClose:!0,dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbPaperSize=new Common.UI.ComboBox({el:i.findById("#print-combo-pages"),menuStyle:"max-height: 280px; min-width: 248px;",editable:!1,takeFocusOnClose:!0,cls:"input-group-nr",data:[{value:"215.9|279.4",displayValue:"US Letter (21,59 cm x 27,94 cm)",caption:"US Letter"},{value:"215.9|355.6",displayValue:"US Legal (21,59 cm x 35,56 cm)",caption:"US Legal"},{value:"210|297",displayValue:"A4 (21 cm x 29,7 cm)",caption:"A4"},{value:"148|210",displayValue:"A5 (14,8 cm x 21 cm)",caption:"A5"},{value:"176|250",displayValue:"B5 (17,6 cm x 25 cm)",caption:"B5"},{value:"104.8|241.3",displayValue:"Envelope #10 (10,48 cm x 24,13 cm)",caption:"Envelope #10"},{value:"110|220",displayValue:"Envelope DL (11 cm x 22 cm)",caption:"Envelope DL"},{value:"279.4|431.8",displayValue:"Tabloid (27,94 cm x 43,18 cm)",caption:"Tabloid"},{value:"297|420",displayValue:"A3 (29,7 cm x 42 cm)",caption:"A3"},{value:"304.8|457.1",displayValue:"Tabloid Oversize (30,48 cm x 45,71 cm)",caption:"Tabloid Oversize"},{value:"196.8|273",displayValue:"ROC 16K (19,68 cm x 27,3 cm)",caption:"ROC 16K"},{value:"119.9|234.9",displayValue:"Envelope Choukei 3 (11,99 cm x 23,49 cm)",caption:"Envelope Choukei 3"},{value:"330.2|482.5",displayValue:"Super B/A3 (33,02 cm x 48,25 cm)",caption:"Super B/A3"}],dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbPaperOrientation=new Common.UI.ComboBox({el:i.findById("#print-combo-orient"),menuStyle:"min-width: 134px;",editable:!1,takeFocusOnClose:!0,cls:"input-group-nr",data:[{value:Asc.c_oAscPageOrientation.PagePortrait,displayValue:this.txtPortrait},{value:Asc.c_oAscPageOrientation.PageLandscape,displayValue:this.txtLandscape}],dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),_.template(["<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%= item.value %>" <% if (item.value === "customoptions") { %> class="border-top" style="margin-top: 5px;padding-top: 5px;" <% } %> ><a tabindex="-1" type="menuitem">',"<%= scope.getDisplayValue(item) %>","</a></li>","<% }); %>"].join("")));if(this.cmbLayout=new Common.UI.ComboBox({el:i.findById("#print-combo-layout"),menuStyle:"min-width: 248px;",editable:!1,takeFocusOnClose:!0,cls:"input-group-nr",data:[{value:0,displayValue:this.txtActualSize},{value:1,displayValue:this.txtFitPage},{value:2,displayValue:this.txtFitCols},{value:3,displayValue:this.txtFitRows},{value:"customoptions",displayValue:this.txtCustomOptions}],itemsTemplate:s,dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.txtRangeTop=new Common.UI.InputField({el:i.findById("#print-txt-top"),allowBlank:!0,validateOnChange:!0,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.btnPresetsTop=new Common.UI.Button({parentEl:i.findById("#print-presets-top"),cls:"btn-text-menu-default",caption:this.txtRepeat,style:"width: 95px;",menu:!0,dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.txtRangeLeft=new Common.UI.InputField({el:i.findById("#print-txt-left"),allowBlank:!0,validateOnChange:!0,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.btnPresetsLeft=new Common.UI.Button({parentEl:i.findById("#print-presets-left"),cls:"btn-text-menu-default",caption:this.txtRepeat,style:"width: 95px;",menu:!0,dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.$printTitlesHeader=i.find(".print-titles-header"),this.$printTitlesHeader.on("click",_.bind(this.expandPrintTitles,this)),this.$printTitlesBlock=i.find(".print-titles-container"),this.extendedPrintTitles||this.$printTitlesBlock.addClass("no-expand"),this.cmbPaperMargins=new Common.UI.ComboBox({el:i.findById("#print-combo-margins"),menuStyle:"max-height: 280px; min-width: 248px;",editable:!1,takeFocusOnClose:!0,cls:"input-group-nr",data:[{value:0,displayValue:this.txtMarginsNormal,size:[19.1,17.8,19.1,17.8]},{value:1,displayValue:this.txtMarginsNarrow,size:[19.1,6.4,19.1,6.4]},{value:2,displayValue:this.txtMarginsWide,size:[25.4,25.4,25.4,25.4]},{value:-1,displayValue:this.txtCustom,size:null}],itemsTemplate:_.template(["<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%- item.value %>"><a tabindex="-1" type="menuitem">',"<div><b><%= scope.getDisplayValue(item) %></b></div>",'<% if (item.size !== null) { %><div style="display: inline-block;margin-right: 20px;min-width: 80px;"><label style="display: block;">'+this.txtTop+': <%= parseFloat(Common.Utils.Metric.fnRecalcFromMM(item.size[0]).toFixed(2)) %> <%= Common.Utils.Metric.getCurrentMetricName() %></label><label style="display: block;">'+this.txtLeft+': <%= parseFloat(Common.Utils.Metric.fnRecalcFromMM(item.size[1]).toFixed(2)) %> <%= Common.Utils.Metric.getCurrentMetricName() %></label></div><div style="display: inline-block;"><label style="display: block;">'+this.txtBottom+': <%= parseFloat(Common.Utils.Metric.fnRecalcFromMM(item.size[2]).toFixed(2)) %> <%= Common.Utils.Metric.getCurrentMetricName() %></label><label style="display: block;">'+this.txtRight+": <%= parseFloat(Common.Utils.Metric.fnRecalcFromMM(item.size[3]).toFixed(2)) %> <%= Common.Utils.Metric.getCurrentMetricName() %></label></div><% } %>","<% }); %>"].join("")),dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.chPrintGrid=new Common.UI.CheckBox({el:i.findById("#print-chb-grid"),labelText:this.txtPrintGrid,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.chPrintRows=new Common.UI.CheckBox({el:i.findById("#print-chb-rows"),labelText:this.txtPrintHeadings,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.spnFirstPage=new Common.UI.MetricSpinner({el:i.findById("#print-spin-first-page"),step:1,width:60,defaultUnit:"",value:"1",maxValue:32767,minValue:-32767,allowDecimal:!1,maskExp:/[0-9,\-]/,dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.pnlSettings=i.find(".flex-settings").addBack().filter(".flex-settings"),this.pnlApply=i.find(".fms-flex-apply").addBack().filter(".fms-flex-apply"),this.pnlTable=$(this.pnlSettings.find("table")[0]),this.trApply=i.find(".fms-btn-apply"),this.btnsSave=[],this.btnsPrint=[],this.mode.isDesktopApp){this.btnsPrintPDF=[];for(var o=0;o<2;o++){var n=["<table>","<tr>",'<td><button id="print-btn-print-<%= index %>" class="btn normal dlg-btn primary btn-text-default auto" result="print" data-hint="2" data-hint-direction="bottom" data-hint-offset="big"><%= scope.txtPrint %></button></td>','<td><button id="print-btn-print-pdf-<%= index %>" class="btn normal dlg-btn btn-text-default auto" result="save-pdf" data-hint="2" data-hint-direction="bottom" data-hint-offset="big"><%= scope.txtPrintToPDF %></button></td>','<td><button id="print-btn-save-<%= index %>" class="btn normal dlg-btn btn-text-default auto" result="save" data-hint="2" data-hint-direction="bottom" data-hint-offset="big"><%= scope.txtSave %></button></td>',"</tr>","</table>"].join(""),n=_.template(n)({scope:this,index:o});$(i.find(".footer")[o]).html(n),this.btnsPrintPDF.push(new Common.UI.Button({el:i.findById("#print-btn-print-pdf-"+o)}))}i.find(".footer").addClass("footer-with-pdf")}for(o=0;o<2;o++)this.btnsSave.push(new Common.UI.Button({el:i.findById("#print-btn-save-"+o)})),this.btnsPrint.push(new Common.UI.Button({el:i.findById("#print-btn-print-"+o)}));return this.btnPrevPage=new Common.UI.Button({parentEl:i.findById("#print-prev-page"),cls:"btn-prev-page",iconCls:"arrow",scaling:!1,dataHint:"2",dataHintDirection:"top"}),this.btnNextPage=new Common.UI.Button({parentEl:i.findById("#print-next-page"),cls:"btn-next-page",iconCls:"arrow",scaling:!1,dataHint:"2",dataHintDirection:"top"}),this.countOfPages=i.findById("#print-count-page"),this.txtNumberPage=new Common.UI.InputField({el:i.findById("#print-number-page"),allowBlank:!0,validateOnChange:!0,style:"width: 50px;",maskExp:/[0-9]/,validation:function(t){return!!(/(^[0-9]+$)/.test(t)&&void 0!==(t=parseInt(t))&&0<t&&t<=e.pageCount)||e.txtPageNumInvalid},dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.txtActiveSheet=i.findById("#print-active-sheet"),this.$el=$(t).html(i),this.$el.on("click","#print-header-footer-settings",_.bind(this.openHeaderSettings,this)),this.$previewBox=$("#print-preview-box"),this.$previewEmpty=$("#print-preview-empty"),this.applyMode(),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:this.pnlSettings,suppressScrollX:!0,alwaysVisibleY:!0})),Common.NotificationCenter.on({"window:resize":function(){e.isVisible()&&e.updateScroller()}}),this.updateMetricUnit(),this.fireEvent("render:after",this),this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this._initSettings&&(this.updateMetricUnit(),this._initSettings=!1),this.updateScroller(),this.fireEvent("show",this)},updateScroller:function(){var t;this.scroller&&(Common.UI.Menu.Manager.hideAll(),t=this.$el.height()<this.pnlTable.height()+25+this.pnlApply.height()+this.$el.find(".main-header").outerHeight(!0),this.pnlApply.toggleClass("hidden",!t),this.trApply.toggleClass("hidden",t),this.pnlSettings.css("overflow",t?"hidden":"visible"),this.scroller.update(),this.pnlSettings.toggleClass("bordered",this.scroller.isVisible()))},setMode:function(t){this.mode=t,this._initSettings||this.applyMode()},applyMode:function(){this.mode&&this.$el&&(this.$el.find(".header-settings")[this.mode.isEdit?"show":"hide"](),this.mode.isDesktopApp||this.$el.find(".desktop-settings").hide())},setApi:function(t){},updateMetricUnit:function(){for(var t=this.cmbPaperSize.store,e=0;e<t.length;e++){var i=t.at(e),s=i.get("value"),o=/^\d{3}\.?\d*/.exec(s),s=/\d{3}\.?\d*$/.exec(s);i.set("displayValue",i.get("caption")+" ("+parseFloat(Common.Utils.Metric.fnRecalcFromMM(o).toFixed(2))+" "+Common.Utils.Metric.getCurrentMetricName()+" x "+parseFloat(Common.Utils.Metric.fnRecalcFromMM(s).toFixed(2))+" "+Common.Utils.Metric.getCurrentMetricName()+")")}this.cmbPaperSize.onResetItems(),this.cmbPaperMargins.onResetItems()},addCustomScale:function(t){t?this.cmbLayout.setData([{value:0,displayValue:this.txtActualSize},{value:1,displayValue:this.txtFitPage},{value:2,displayValue:this.txtFitCols},{value:3,displayValue:this.txtFitRows},{value:4,displayValue:this.txtCustom},{value:"customoptions",displayValue:this.txtCustomOptions}]):this.cmbLayout.setData([{value:0,displayValue:this.txtActualSize},{value:1,displayValue:this.txtFitPage},{value:2,displayValue:this.txtFitCols},{value:3,displayValue:this.txtFitRows},{value:"customoptions",displayValue:this.txtCustomOptions}])},applySettings:function(){this.menu&&this.menu.hide()},isVisible:function(){return(this.$el||$(this.el)).is(":visible")},setRange:function(t){this.cmbRange.setValue(t)},getRange:function(){return this.cmbRange.getValue()},setIgnorePrintArea:function(t){this.chIgnorePrintArea.setValue(t)},getIgnorePrintArea:function(){return"checked"==this.chIgnorePrintArea.getValue()},getPagesFrom:function(){return this.spnPagesFrom.getNumberValue()},getPagesTo:function(){return this.spnPagesTo.getNumberValue()},comboRangeChange:function(t,e){this.fireEvent("changerange",this)},openHeaderSettings:function(){this.fireEvent("openheader",this)},updateCountOfPages:function(t){this.countOfPages.text(Common.Utils.String.format(this.txtOf,t)),this.pageCount=t},updateActiveSheet:function(t){this.txtActiveSheet.text(Common.Utils.String.format(this.txtSheet,t))},updateCurrentPage:function(t){this.txtNumberPage.setValue(t+1)},expandPrintTitles:function(){this.extendedPrintTitles=!this.extendedPrintTitles,this.$printTitlesBlock[this.extendedPrintTitles?"removeClass":"addClass"]("no-expand"),Common.localStorage.setBool("sse-print-titles-extended",this.extendedPrintTitles)}},SSE.Views.PrintWithPreview||{}))}),define("text!spreadsheeteditor/main/app/template/PrintSettings.template",[],function(){return'<div class="settings-panel active">\n    <div class="padding-large inner-content" >\n        <div id="printadv-dlg-combo-range" class="input-group-nr"></div>\n        <div id="printadv-dlg-chb-ignore" style="margin-top: 5px;"></div>\n        <div id="printadv-dlg-pages">\n            <label class="margin-right-6"><%= scope.textPages %></label>\n            <div id="printadv-dlg-spin-pages-from" class="margin-right-6"></div>\n            <label class="margin-right-6"><%= scope.textTo %></label>\n            <div id="printadv-dlg-spin-pages-to"></div>\n        </div>\n    </div>\n    <div class="padding-large inner-content" >\n        <div id="printadv-dlg-combo-sheets" class="input-group-nr"></div>\n    </div>\n    <div class="padding-large inner-content" >\n        <div id="printadv-dlg-combo-pages" class="input-group-nr"></div>\n    </div>\n    <div class="padding-large inner-content" >\n        <span id="printadv-dlg-combo-orient"></span>\n    </div>\n    <div class="padding-large inner-content" >\n        <span id="printadv-dlg-combo-layout"></span>\n    </div>\n    <div id="printadv-dlg-content-to-hide">\n        <div class="padding-large inner-content" >\n            <table cols="2" class="no-padding">\n                <tr>\n                    <td colspan="2" ><label><%= scope.textRepeatTop %></label></td>\n                </tr>\n                <tr>\n                    <td class="padding-small"><div id="printadv-dlg-txt-top" class="margin-right-10"></div></td>\n                    <td class="padding-small"><div id="printadv-dlg-presets-top"></div></td>\n                </tr>\n                <tr>\n                    <td colspan="2" ><label><%= scope.textRepeatLeft %></label></td>\n                </tr>\n                <tr>\n                    <td><div id="printadv-dlg-txt-left" class="margin-right-10"></div></td>\n                    <td><div id="printadv-dlg-presets-left"></div></td>\n                </tr>\n            </table>\n        </div>\n        <div class="padding-large inner-content" >\n            <span id="printadv-dlg-combo-margins"></span>\n        </div>\n        <div class="padding-small"></div>\n        <div class="inner-content">\n            <div id="printadv-dlg-chb-grid" style="margin-bottom: 10px;"></div>\n            <div id="printadv-dlg-chb-rows"></div>\n        </div>\n    </div>\n</div>\n'}),define("spreadsheeteditor/main/app/view/PrintSettings",["text!spreadsheeteditor/main/app/template/PrintSettings.template","common/main/lib/view/AdvancedSettingsWindow","common/main/lib/component/MetricSpinner","common/main/lib/component/CheckBox","common/main/lib/component/RadioBox","common/main/lib/component/ListView"],function(i){"use strict";SSE.Views.PrintSettings=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{alias:"PrintSettings",contentWidth:280,height:513,buttons:null},initialize:function(t){this.type=t.type||"print";var e="print"==this.type?this.btnPrint:"export"==this.type?this.btnExport:this.btnDownload;_.extend(this.options,{title:"print"==this.type?this.textTitle:this.textTitlePDF,template:['<div class="box" style="height:'+(this.options.height-85)+'px;">','<div class="menu-panel" style="overflow: hidden;">','<div style="height: 84px; line-height: 42px;" class="div-category">'+("print"==this.type?this.textPrintRange:this.textRange)+"</div>",'<div style="height: 52px; line-height: 66px;" class="div-category">'+this.textSettings+"</div>",'<div style="height: 38px; line-height: 38px;" class="div-category">'+this.textPageSize+"</div>",'<div style="height: 38px; line-height: 38px;" class="div-category">'+this.textPageOrientation+"</div>",'<div style="height: 38px; line-height: 38px;" class="div-category">'+this.textPageScaling+"</div>",'<div style="height: 98px; line-height: 33px;" class="div-category">'+this.strPrintTitles+"</div>",'<div style="height: 41px; line-height: 41px;" class="div-category">'+this.strMargins+"</div>",'<div style="height: 58px; line-height: 44px;" class="div-category">'+("print"==this.type?this.strPrint:this.strShow)+"</div>","</div>",'<div class="content-panel">'+_.template(i)({scope:this})+"</div>","</div>",'<div class="separator horizontal"></div>','<div class="footer justify">','<button id="printadv-dlg-btn-hide" class="btn btn-text-default" style="min-width: 100px;width: auto;">'+this.textHideDetails+"</button>",'<button class="btn normal dlg-btn float-right" result="cancel" style="width: 86px;">'+this.cancelButtonText+"</button>",'<button class="btn normal dlg-btn primary float-right margin-left-10" result="ok" style="min-width: 150px;width: auto;">'+e+"</button>","</div>"].join("")},t),Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this),this.cmbRange=new Common.UI.ComboBox({el:$("#printadv-dlg-combo-range"),style:"width: 132px;",menuStyle:"min-width: 132px;max-height: 280px;",editable:!1,takeFocusOnClose:!0,cls:"input-group-nr",data:[{value:Asc.c_oAscPrintType.ActiveSheets,displayValue:this.textActiveSheets},{value:Asc.c_oAscPrintType.EntireWorkbook,displayValue:this.textAllSheets},{value:Asc.c_oAscPrintType.Selection,displayValue:this.textSelection}]}),this.cmbRange.on("selected",_.bind(this.comboRangeChange,this)),this.chIgnorePrintArea=new Common.UI.CheckBox({el:$("#printadv-dlg-chb-ignore"),labelText:this.textIgnore}),this.spnPagesFrom=new Common.UI.MetricSpinner({el:$("#printadv-dlg-spin-pages-from"),step:1,width:60,defaultUnit:"",value:"",maxValue:1e6,minValue:1,dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.spnPagesTo=new Common.UI.MetricSpinner({el:$("#printadv-dlg-spin-pages-to"),step:1,width:60,defaultUnit:"",value:"",maxValue:1e6,minValue:1,dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbSheet=new Common.UI.ComboBox({el:$("#printadv-dlg-combo-sheets"),style:"width: 242px;",menuStyle:"min-width: 242px;max-height: 280px;",editable:!1,cls:"input-group-nr",data:[],takeFocusOnClose:!0}),this.cmbPaperSize=new Common.UI.ComboBox({el:$("#printadv-dlg-combo-pages"),style:"width: 242px;",menuStyle:"max-height: 280px; min-width: 242px;",editable:!1,takeFocusOnClose:!0,cls:"input-group-nr",data:[{value:"215.9|279.4",displayValue:"US Letter (21,59 cm x 27,94 cm)",caption:"US Letter"},{value:"215.9|355.6",displayValue:"US Legal (21,59 cm x 35,56 cm)",caption:"US Legal"},{value:"210|297",displayValue:"A4 (21 cm x 29,7 cm)",caption:"A4"},{value:"148|210",displayValue:"A5 (14,8 cm x 21 cm)",caption:"A5"},{value:"176|250",displayValue:"B5 (17,6 cm x 25 cm)",caption:"B5"},{value:"104.8|241.3",displayValue:"Envelope #10 (10,48 cm x 24,13 cm)",caption:"Envelope #10"},{value:"110|220",displayValue:"Envelope DL (11 cm x 22 cm)",caption:"Envelope DL"},{value:"279.4|431.8",displayValue:"Tabloid (27,94 cm x 43,18 cm)",caption:"Tabloid"},{value:"297|420",displayValue:"A3 (29,7 cm x 42 cm)",caption:"A3"},{value:"304.8|457.1",displayValue:"Tabloid Oversize (30,48 cm x 45,71 cm)",caption:"Tabloid Oversize"},{value:"196.8|273",displayValue:"ROC 16K (19,68 cm x 27,3 cm)",caption:"ROC 16K"},{value:"119.9|234.9",displayValue:"Envelope Choukei 3 (11,99 cm x 23,49 cm)",caption:"Envelope Choukei 3"},{value:"330.2|482.5",displayValue:"Super B/A3 (33,02 cm x 48,25 cm)",caption:"Super B/A3"}]}),this.cmbPaperOrientation=new Common.UI.ComboBox({el:$("#printadv-dlg-combo-orient"),style:"width: 132px;",menuStyle:"min-width: 132px;",editable:!1,takeFocusOnClose:!0,cls:"input-group-nr",data:[{value:Asc.c_oAscPageOrientation.PagePortrait,displayValue:this.strPortrait},{value:Asc.c_oAscPageOrientation.PageLandscape,displayValue:this.strLandscape}]}),this.chPrintGrid=new Common.UI.CheckBox({el:$("#printadv-dlg-chb-grid"),labelText:"print"==this.type?this.textPrintGrid:this.textShowGrid}),this.chPrintRows=new Common.UI.CheckBox({el:$("#printadv-dlg-chb-rows"),labelText:"print"==this.type?this.textPrintHeadings:this.textShowHeadings}),this.cmbPaperMargins=new Common.UI.ComboBox({el:$("#printadv-dlg-combo-margins"),style:"width: 242px;",menuStyle:"max-height: 280px; min-width: 242px;",editable:!1,takeFocusOnClose:!0,cls:"input-group-nr",data:[{value:0,displayValue:this.textMarginsNormal,size:[19.1,17.8,19.1,17.8]},{value:1,displayValue:this.textMarginsNarrow,size:[19.1,6.4,19.1,6.4]},{value:2,displayValue:this.textMarginsWide,size:[25.4,25.4,25.4,25.4]},{value:-1,displayValue:this.textCustom,size:null}],itemsTemplate:_.template(["<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%- item.value %>"><a tabindex="-1" type="menuitem">',"<div><b><%= scope.getDisplayValue(item) %></b></div>",'<% if (item.size !== null) { %><div style="display: inline-block;margin-right: 20px;min-width: 80px;"><label style="display: block;">'+this.strTop+': <%= parseFloat(Common.Utils.Metric.fnRecalcFromMM(item.size[0]).toFixed(2)) %> <%= Common.Utils.Metric.getCurrentMetricName() %></label><label style="display: block;">'+this.strLeft+': <%= parseFloat(Common.Utils.Metric.fnRecalcFromMM(item.size[1]).toFixed(2)) %> <%= Common.Utils.Metric.getCurrentMetricName() %></label></div><div style="display: inline-block;"><label style="display: block;">'+this.strBottom+': <%= parseFloat(Common.Utils.Metric.fnRecalcFromMM(item.size[2]).toFixed(2)) %> <%= Common.Utils.Metric.getCurrentMetricName() %></label><label style="display: block;">'+this.strRight+": <%= parseFloat(Common.Utils.Metric.fnRecalcFromMM(item.size[3]).toFixed(2)) %> <%= Common.Utils.Metric.getCurrentMetricName() %></label></div><% } %>","<% }); %>"].join(""))});var t=_.template(["<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%= item.value %>" <% if (item.value === "customoptions") { %> class="border-top" style="margin-top: 5px;" <% } %> ><a tabindex="-1" type="menuitem">',"<%= scope.getDisplayValue(item) %>","</a></li>","<% }); %>"].join("")),t=(this.cmbLayout=new Common.UI.ComboBox({el:$("#printadv-dlg-combo-layout"),style:"width: 242px;",menuStyle:"min-width: 242px;",editable:!1,takeFocusOnClose:!0,cls:"input-group-nr",data:[{value:0,displayValue:this.textActualSize},{value:1,displayValue:this.textFitPage},{value:2,displayValue:this.textFitCols},{value:3,displayValue:this.textFitRows},{value:"customoptions",displayValue:this.textCustomOptions}],itemsTemplate:t}),this.txtRangeTop=new Common.UI.InputFieldBtn({el:$("#printadv-dlg-txt-top"),style:"width: 137px;",allowBlank:!0,validateOnChange:!0}),this.btnPresetsTop=new Common.UI.Button({parentEl:$("#printadv-dlg-presets-top"),cls:"btn-text-menu-default",caption:this.textRepeat,style:"width: 95px;",menu:!0}),this.txtRangeLeft=new Common.UI.InputFieldBtn({el:$("#printadv-dlg-txt-left"),style:"width: 137px;",allowBlank:!0,validateOnChange:!0}),this.btnPresetsLeft=new Common.UI.Button({parentEl:$("#printadv-dlg-presets-left"),cls:"btn-text-menu-default",caption:this.textRepeat,style:"width: 95px;",menu:!0}),this.btnHide=new Common.UI.Button({el:$("#printadv-dlg-btn-hide")}),this.btnHide.on("click",_.bind(this.handlerShowDetails,this)),this.panelDetails=$("#printadv-dlg-content-to-hide"),this.updateMetricUnit(),this.options.afterrender&&this.options.afterrender.call(this),Common.localStorage.getItem("sse-hide-print-settings"));this.extended=null!==t&&0==parseInt(t),this.handlerShowDetails(this.btnHide)},getFocusedComponents:function(){return[this.cmbRange,this.chIgnorePrintArea,this.cmbSheet,this.cmbPaperSize,this.cmbPaperOrientation,this.cmbLayout,this.txtRangeTop,this.txtRangeLeft,this.spnMarginTop,this.spnMarginBottom,this.spnMarginLeft,this.spnMarginRight,this.chPrintGrid,this.chPrintRows]},getDefaultFocusableComponent:function(){if(!this._alreadyRendered)return this._alreadyRendered=!0,this.cmbRange},addCustomScale:function(t){t?this.cmbLayout.setData([{value:0,displayValue:this.textActualSize},{value:1,displayValue:this.textFitPage},{value:2,displayValue:this.textFitCols},{value:3,displayValue:this.textFitRows},{value:4,displayValue:this.textCustom},{value:"customoptions",displayValue:this.textCustomOptions}]):this.cmbLayout.setData([{value:0,displayValue:this.textActualSize},{value:1,displayValue:this.textFitPage},{value:2,displayValue:this.textFitCols},{value:3,displayValue:this.textFitRows},{value:"customoptions",displayValue:this.textCustomOptions}])},setRange:function(t){this.cmbRange.setValue(t)},getRange:function(){return this.cmbRange.getValue()},setIgnorePrintArea:function(t){this.chIgnorePrintArea.setValue(t)},getIgnorePrintArea:function(){return"checked"==this.chIgnorePrintArea.getValue()},getPagesFrom:function(){return this.spnPagesFrom.getNumberValue()},getPagesTo:function(){return this.spnPagesTo.getNumberValue()},comboRangeChange:function(t,e){this.fireEvent("changerange",this)},updateMetricUnit:function(){for(var t=this.cmbPaperSize.store,e=0;e<t.length;e++){var i=t.at(e),s=i.get("value"),o=/^\d{3}\.?\d*/.exec(s),s=/\d{3}\.?\d*$/.exec(s);i.set("displayValue",i.get("caption")+" ("+parseFloat(Common.Utils.Metric.fnRecalcFromMM(o).toFixed(2))+" "+Common.Utils.Metric.getCurrentMetricName()+" x "+parseFloat(Common.Utils.Metric.fnRecalcFromMM(s).toFixed(2))+" "+Common.Utils.Metric.getCurrentMetricName()+")")}this.cmbPaperSize.onResetItems(),this.cmbPaperMargins.onResetItems()},handlerShowDetails:function(t){this.extended?(this.extended=!1,this.panelDetails.css({display:"block"}),this.setHeight(553),t.setCaption(this.textHideDetails),Common.localStorage.setItem("sse-hide-print-settings",0)):(this.extended=!0,this.panelDetails.css({display:"none"}),this.setHeight(344),t.setCaption(this.textShowDetails),Common.localStorage.setItem("sse-hide-print-settings",1))}},SSE.Views.PrintSettings||{}))}),define("spreadsheeteditor/main/app/controller/Print",["core","spreadsheeteditor/main/app/view/FileMenuPanels","spreadsheeteditor/main/app/view/PrintSettings"],function(){"use strict";SSE.Controllers.Print=Backbone.Controller.extend(_.extend({views:["MainSettingsPrint","PrintWithPreview"],initialize:function(){var t=null!==(t=Common.localStorage.getItem("sse-print-settings-range"))?parseInt(t):Asc.c_oAscPrintType.ActiveSheets;this._currentPrintType=t,this.adjPrintParams=new Asc.asc_CAdjustPrint,this.adjPrintParams.asc_setPrintType(t),this._changedProps=null,this._originalPageSettings=null,this._margins=[],this._navigationPreview={pageCount:!1,currentPage:0},this._isPreviewVisible=!1,this.addListeners({PrintWithPreview:{show:_.bind(this.onShowMainSettingsPrint,this),"render:after":_.bind(this.onAfterRender,this),changerange:_.bind(this.onChangeRange,this,!1),openheader:_.bind(this.onOpenHeaderSettings,this)},PrintSettings:{changerange:_.bind(this.onChangeRange,this,!0)}}),Common.NotificationCenter.on("print",_.bind(this.openPrintSettings,this,"print")),Common.NotificationCenter.on("download:settings",_.bind(this.openPrintSettings,this,"download")),Common.NotificationCenter.on("export:to",_.bind(this.openPrintSettings,this,"export"))},onLaunch:function(){this.printSettings=this.createView("PrintWithPreview")},onAfterRender:function(t){var e=this,i=(this.printSettings.menu.on("menu:hide",_.bind(this.onHidePrintMenu,this)),this.printSettings.cmbSheet.on("selected",_.bind(function(t,e){this.comboSheetsChange(this.printSettings,t,e),this._isPreviewVisible&&(this.notUpdateSheetSettings=!0,this.api.asc_drawPrintPreview(void 0,e.value))},this)),this.printSettings.btnsSave.forEach(function(t){t.on("click",_.bind(e.querySavePrintSettings,e,"save"))}),this.printSettings.btnsPrint.forEach(function(t){t.on("click",_.bind(e.querySavePrintSettings,e,"print"))}),this.mode.isDesktopApp&&this.printSettings.btnsPrintPDF.forEach(function(t){t.on("click",_.bind(e.querySavePrintSettings,e,"print-pdf"))}),this.printSettings.btnPrevPage.on("click",_.bind(this.onChangePreviewPage,this,!1)),this.printSettings.btnNextPage.on("click",_.bind(this.onChangePreviewPage,this,!0)),this.printSettings.txtNumberPage.on({"keypress:after":_.bind(this.onKeypressPageNumber,this),"keyup:after":_.bind(this.onKeyupPageNumber,this)}),this.printSettings.txtNumberPage.cmpEl.find("input").on("blur",_.bind(this.onBlurPageNumber,this)),this.printSettings.chIgnorePrintArea.on("change",_.bind(this.updatePreview,this,!0)),this.fillComponents(this.printSettings),this.registerControlEvents(this.printSettings),Common.NotificationCenter.on("window:resize",_.bind(function(){this._isPreviewVisible&&(this.notUpdateSheetSettings=!0)},this)),Common.NotificationCenter.on("margins:update",_.bind(this.onUpdateLastCustomMargins,this)),/Firefox/i.test(navigator.userAgent)?"DOMMouseScroll":"mousewheel");this.printSettings.$previewBox.on(i,_.bind(this.onPreviewWheel,this))},setMode:function(t){this.mode=t,this.printSettings&&this.printSettings.setMode(t)},setApi:function(t){return this.api=t,this.api.asc_registerCallback("asc_onSheetsChanged",_.bind(this.updateSheetsInfo,this)),this.api.asc_registerCallback("asc_onPrintPreviewSheetChanged",_.bind(this.onApiChangePreviewSheet,this)),this.api.asc_registerCallback("asc_onPrintPreviewPageChanged",_.bind(this.onApiChangePreviewPage,this)),this.api.asc_registerCallback("asc_onPrintPreviewSheetDataChanged",_.bind(this.onApiPreviewSheetDataChanged,this)),this},updateSheetsInfo:function(){this.printSettings.isVisible()?this.updateSettings(this.printSettings):this.isFillSheets=!1},resetSheets:function(t){for(var e=this.api.asc_getWorksheetsCount(),i=-1,s=[],o=t.cmbRange.getSelectedRecord(),n=o&&o.value,a=SSE.getController("Statusbar").getSelectTabs();++i<e;)this.api.asc_isWorksheetHidden(i)||(o&&n!==Asc.c_oAscPrintType.ActiveSheets||-1!==a.indexOf(i))&&(s.push({displayValue:this.api.asc_getWorksheetName(i),value:i}),this._changedProps[i]||(this._changedProps[i]=this.api.asc_getPageOptions(i,!0,!0)));t.cmbSheet.store.reset(s)},updateSettings:function(t){this.resetSheets(t);var e=t.cmbSheet.store.findWhere({value:t.cmbSheet.getValue()})||t.cmbSheet.store.findWhere({value:this.api.asc_getActiveWorksheetIndex()});e&&(t.cmbSheet.setValue(e.get("value")),t.updateActiveSheet&&t.updateActiveSheet(e.get("displayValue")))},comboSheetsChange:function(t,e,i){i=i.value;this.fillPageOptions(t,this._changedProps[i]||this.api.asc_getPageOptions(i,!0),i)},fillPageOptions:function(t,e,i){var s=e.asc_getPageSetup();this._originalPageSettings=s;(l=t.cmbPaperOrientation.store.findWhere({value:s.asc_getOrientation()}))&&t.cmbPaperOrientation.setValue(l.get("value"));for(var o=s.asc_getWidth(),n=s.asc_getHeight(),a=t.cmbPaperSize.store,l=null,r=0;r<a.length;r++){var c=a.at(r),d=c.get("value"),h=parseFloat(/^\d{3}\.?\d*/.exec(d)),p=parseFloat(/\d{3}\.?\d*$/.exec(d));if(Math.abs(h-o)<.1&&Math.abs(p-n)<.1){l=c;break}}l?t.cmbPaperSize.setValue(l.get("value")):t.cmbPaperSize.setValue(this.txtCustom+" ("+parseFloat(Common.Utils.Metric.fnRecalcFromMM(o).toFixed(2))+Common.Utils.Metric.getCurrentMetricName()+" x "+parseFloat(Common.Utils.Metric.fnRecalcFromMM(n).toFixed(2))+Common.Utils.Metric.getCurrentMetricName()+")"),this.fitWidth=s.asc_getFitToWidth(),this.fitHeight=s.asc_getFitToHeight(),this.fitScale=s.asc_getScale(),this.setScaling(t,this.fitWidth,this.fitHeight,this.fitScale),(l=t.cmbPaperOrientation.store.findWhere({value:s.asc_getOrientation()}))&&t.cmbPaperOrientation.setValue(l.get("value")),t.spnFirstPage&&(d=s.asc_getFirstPageNumber(),t.spnFirstPage.setValue(d||1,!0)),s=e.asc_getPageMargins(),this._margins[i]=s,this.setMargins(t,s),t.chPrintGrid.setValue(e.asc_getGridLines(),!0),t.chPrintRows.setValue(e.asc_getHeadings(),!0);d=e.asc_getPrintTitlesHeight();t.txtRangeTop.setValue(d||""),this._noApply=!0,t.txtRangeTop.checkValidate(),this._noApply=!1,t.dataRangeTop=d,d=e.asc_getPrintTitlesWidth(),t.txtRangeLeft.setValue(d||""),this._noApply=!0,t.txtRangeLeft.checkValidate(),this._noApply=!1,t.dataRangeLeft=d,d=this.api.asc_getActiveWorksheetIndex()==i,"select"==t.btnPresetsTop.menu.items[0].value&&(t.btnPresetsTop.menu.items[0].setVisible(d),t.txtRangeTop.setBtnDisabled&&t.txtRangeTop.setBtnDisabled(!d)),"select"==t.btnPresetsLeft.menu.items[0].value&&(t.btnPresetsLeft.menu.items[0].setVisible(d),t.txtRangeLeft.setBtnDisabled&&t.txtRangeLeft.setBtnDisabled(!d)),t.btnPresetsTop.menu.items["frozen"==t.btnPresetsTop.menu.items[0].value?0:1].setDisabled(!this.api.asc_getPrintTitlesRange(Asc.c_oAscPrintTitlesRangeType.frozen,!1,i)),t.btnPresetsLeft.menu.items["frozen"==t.btnPresetsLeft.menu.items[0].value?0:1].setDisabled(!this.api.asc_getPrintTitlesRange(Asc.c_oAscPrintTitlesRangeType.frozen,!0,i))},fillPrintOptions:function(t,e){var i=e?this.printSettingsDlg:this.printSettings;i.setRange(t.asc_getPrintType()),i.setIgnorePrintArea(!!t.asc_getIgnorePrintArea()),this.onChangeRange(e)},onChangeRange:function(t){var e=t?this.printSettingsDlg:this.printSettings,i=e.getRange(),s=(this.resetSheets(e),e.cmbSheet.store),s=i!==Asc.c_oAscPrintType.EntireWorkbook?s.findWhere({value:this.api.asc_getActiveWorksheetIndex()}):s.at(0);s&&(e.cmbSheet.setValue(s.get("value")),this.comboSheetsChange(e,e.cmbSheet,s.toJSON())),e.cmbSheet.setDisabled(i===Asc.c_oAscPrintType.Selection||i===Asc.c_oAscPrintType.ActiveSheets&&e.cmbSheet.store.length<2),e.chIgnorePrintArea.setDisabled(i==Asc.c_oAscPrintType.Selection),t||this.updatePreview(!0)},getPageOptions:function(t,e){var i=this._changedProps[e]||new Asc.asc_CPageOptions,s=(i.asc_setGridLines("checked"===t.chPrintGrid.getValue()),i.asc_setHeadings("checked"===t.chPrintRows.getValue()),this._changedProps[e]?this._changedProps[e].asc_getPageSetup():new Asc.asc_CPageSetup),o=(s.asc_setOrientation("-"==t.cmbPaperOrientation.getValue()?void 0:t.cmbPaperOrientation.getValue()),/^\d{3}\.?\d*/.exec(t.cmbPaperSize.getValue())),n=/\d{3}\.?\d*$/.exec(t.cmbPaperSize.getValue()),o=(s.asc_setWidth(o?parseFloat(o[0]):this._originalPageSettings?this._originalPageSettings.asc_getWidth():void 0),s.asc_setHeight(n?parseFloat(n[0]):this._originalPageSettings?this._originalPageSettings.asc_getHeight():void 0),t.cmbLayout.getValue()),a=(4!==o?(n=1==o||3==o?1:0,s.asc_setFitToWidth(a=1==o||2==o?1:0),s.asc_setFitToHeight(n),a||n||s.asc_setScale(100),this.setScaling(t,a,n,100)):(s.asc_setFitToWidth(this.fitWidth),s.asc_setFitToHeight(this.fitHeight),s.asc_setScale(this.fitScale)),t.spnFirstPage&&s.asc_setFirstPageNumber(t.spnFirstPage.getNumberValue()),this._changedProps[e]||i.asc_setPageSetup(s),s=this._changedProps[e]?this._changedProps[e].asc_getPageMargins():new Asc.asc_CPageMargins,t.cmbPaperMargins.getSelectedRecord()),n=(a&&a.size?(o=a.size,s.asc_setTop(o[0]),s.asc_setLeft(o[1]),s.asc_setBottom(o[2]),s.asc_setRight(o[3])):(s.asc_setTop(this._margins[e].asc_getTop()),s.asc_setLeft(this._margins[e].asc_getLeft()),s.asc_setBottom(this._margins[e].asc_getBottom()),s.asc_setRight(this._margins[e].asc_getRight())),this._changedProps[e]||i.asc_setPageMargins(s),this.api.asc_checkDataRange(Asc.c_oAscSelectionDialogType.PrintTitles,t.txtRangeTop.getValue(),!1)!==Asc.c_oAscError.ID.DataRangeError);return i.asc_setPrintTitlesHeight(n?t.txtRangeTop.getValue():t.dataRangeTop),n=this.api.asc_checkDataRange(Asc.c_oAscSelectionDialogType.PrintTitles,t.txtRangeLeft.getValue(),!1)!==Asc.c_oAscError.ID.DataRangeError,i.asc_setPrintTitlesWidth(n?t.txtRangeLeft.getValue():t.dataRangeLeft),i},savePageOptions:function(t){this.api.asc_savePagePrintOptions(this._changedProps),Common.NotificationCenter.trigger("page:settings")},onShowMainSettingsPrint:function(){this._changedProps=[],this.printSettings.$previewBox.removeClass("hidden"),this.onUpdateLastCustomMargins(this._lastMargins,this.printSettings),this.isFillSheets?this.resetSheets(this.printSettings):(this.isFillSheets=!0,this.updateSettings(this.printSettings)),this.adjPrintParams.asc_setPageOptionsMap(this._changedProps),this.fillPrintOptions(this.adjPrintParams,!1),this.adjPrintParams.asc_setActiveSheetsArray(this.printSettings.getRange()===Asc.c_oAscPrintType.ActiveSheets?SSE.getController("Statusbar").getSelectTabs():null);var t=new Asc.asc_CDownloadOptions(null,Common.Utils.isChrome||Common.Utils.isOpera||Common.Utils.isGecko&&86<Common.Utils.firefoxVersion),t=(t.asc_setAdvancedOptions(this.adjPrintParams),this.api.asc_initPrintPreview("print-preview",t));this.printSettings.$previewBox.toggleClass("hidden",!t),this.printSettings.$previewEmpty.toggleClass("hidden",!!t),t&&(this.updateNavigationButtons(0,t),this.printSettings.txtNumberPage.checkValidate()),this._isPreviewVisible=!0},openPrintSettings:function(t,e,i,s){this.printSettingsDlg&&this.printSettingsDlg.isVisible()?s&&Common.NotificationCenter.trigger("download:cancel"):this.api&&(Common.UI.Menu.Manager.hideAll(),this.asUrl=s,this.downloadFormat=i,this.printSettingsDlg=new SSE.Views.PrintSettings({type:t,handler:_.bind(this.resultPrintSettings,this),afterrender:_.bind(function(){this._changedProps=[],this.onUpdateLastCustomMargins(this._lastMargins,this.printSettingsDlg),this.updateSettings(this.printSettingsDlg),this.printSettingsDlg.cmbSheet.on("selected",_.bind(this.comboSheetsChange,this,this.printSettingsDlg)),this.fillComponents(this.printSettingsDlg,!0),this.fillPrintOptions(this.adjPrintParams,!0),this.registerControlEvents(this.printSettingsDlg)},this)}),this.printSettingsDlg.show())},findPagePreset:function(t,e,i){for(var s=e<i?e:i,o=e<i?i:e,n=t.cmbPaperSize.store,a=null,l=0;l<n.length-1;l++){var r=n.at(l),c=r.get("value"),d=parseFloat(/^\d{3}\.?\d*/.exec(c)),c=parseFloat(/\d{3}\.?\d*$/.exec(c));if(Math.abs(d-s)<.1&&Math.abs(c-o)<.1){a=r;break}}return a?a.get("caption"):void 0},resultPrintSettings:function(t,e){var i,s,o,n,a=SSE.getController("Toolbar").getView("Toolbar");"ok"==t?(this.savePageOptions(this.printSettingsDlg),t=this.printSettingsDlg.getRange(),this.adjPrintParams.asc_setPrintType(t),this.adjPrintParams.asc_setPageOptionsMap(this._changedProps),this.adjPrintParams.asc_setIgnorePrintArea(this.printSettingsDlg.getIgnorePrintArea()),this.adjPrintParams.asc_setActiveSheetsArray(t===Asc.c_oAscPrintType.ActiveSheets?SSE.getController("Statusbar").getSelectTabs():null),s=this.printSettingsDlg.getPagesFrom(),(o=this.printSettingsDlg.getPagesTo())<s&&(i=s,s=o,o=i),this.adjPrintParams.asc_setStartPageIndex(0<s?s-1:null),this.adjPrintParams.asc_setEndPageIndex(0<o?o-1:null),Common.localStorage.setItem("sse-print-settings-range",t),i=t===Asc.c_oAscPrintType.EntireWorkbook?0:this.api.asc_getActiveWorksheetIndex(),o=[(s=(this._changedProps[i]||this.api.asc_getPageOptions(i)).asc_getPageSetup()).asc_getWidth(),s.asc_getHeight()],t=s.asc_getOrientation(),this.adjPrintParams.asc_setNativeOptions({paperSize:{w:o[0],h:o[1],preset:this.findPagePreset(this.printSettingsDlg,o[0],o[1])},paperOrientation:t?"landscape":"portrait"}),"print"==this.printSettingsDlg.type?((n=new Asc.asc_CDownloadOptions(null,Common.Utils.isChrome||Common.Utils.isOpera||Common.Utils.isGecko&&86<Common.Utils.firefoxVersion)).asc_setAdvancedOptions(this.adjPrintParams),this.api.asc_Print(n)):((n=new Asc.asc_CDownloadOptions(this.downloadFormat,this.asUrl)).asc_setAdvancedOptions(this.adjPrintParams),this.api.asc_DownloadAs(n)),Common.component.Analytics.trackEvent("print"==this.printSettingsDlg.type?"Print":"DownloadAs"),Common.component.Analytics.trackEvent("ToolBar","print"==this.printSettingsDlg.type?"Print":"DownloadAs")):this.asUrl&&Common.NotificationCenter.trigger("download:cancel"),Common.NotificationCenter.trigger("edit:complete",a),this.printSettingsDlg=null},querySavePrintSettings:function(t){var e,i=SSE.getController("Toolbar").getView("Toolbar"),s=(this.savePageOptions(this.printSettings),this._isPrint="print"===t,this.printSettings.applySettings(),this.printSettings.getRange()),o=(this.adjPrintParams.asc_setPrintType(s),this.adjPrintParams.asc_setPageOptionsMap(this._changedProps),this.adjPrintParams.asc_setIgnorePrintArea(this.printSettings.getIgnorePrintArea()),this.adjPrintParams.asc_setActiveSheetsArray(s===Asc.c_oAscPrintType.ActiveSheets?SSE.getController("Statusbar").getSelectTabs():null),this.printSettings.getPagesFrom()),n=this.printSettings.getPagesTo(),a=(n<o&&(a=o,o=n,n=a),this.adjPrintParams.asc_setStartPageIndex(0<o?o-1:null),this.adjPrintParams.asc_setEndPageIndex(0<n?n-1:null),Common.localStorage.setItem("sse-print-settings-range",s),s===Asc.c_oAscPrintType.EntireWorkbook?0:this.api.asc_getActiveWorksheetIndex()),o=(this._changedProps[a]||this.api.asc_getPageOptions(a)).asc_getPageSetup(),n=[o.asc_getWidth(),o.asc_getHeight()],s=o.asc_getOrientation();this.adjPrintParams.asc_setNativeOptions({paperSize:{w:n[0],h:n[1],preset:this.findPagePreset(this.printSettings,n[0],n[1])},paperOrientation:s?"landscape":"portrait",copies:this.printSettings.spnCopies&&this.printSettings.spnCopies.getNumberValue()||1,sides:this.printSettings.cmbSides?this.printSettings.cmbSides.getValue():"one"}),"print"===t?((e=new Asc.asc_CDownloadOptions(null,Common.Utils.isChrome||Common.Utils.isOpera||Common.Utils.isGecko&&86<Common.Utils.firefoxVersion)).asc_setAdvancedOptions(this.adjPrintParams),this.api.asc_Print(e),this._isPrint=!1):"print-pdf"===t&&((e=new Asc.asc_CDownloadOptions(Asc.c_oAscFileType.PDF)).asc_setAdvancedOptions(this.adjPrintParams),this.api.asc_DownloadAs(e)),Common.NotificationCenter.trigger("edit:complete",i)},registerControlEvents:function(t){t.cmbPaperSize.on("selected",_.bind(this.propertyChange,this,t)),t.cmbPaperOrientation.on("selected",_.bind(this.propertyChange,this,t)),t.cmbLayout.on("selected",_.bind(this.propertyChange,this,t,"scale")),t.cmbPaperMargins.on("selected",_.bind(this.propertyChange,this,t,"margins")),t.chPrintGrid.on("change",_.bind(this.propertyChange,this,t)),t.chPrintRows.on("change",_.bind(this.propertyChange,this,t)),t.txtRangeTop.on("changed:after",_.bind(this.propertyChange,this,t)),t.txtRangeLeft.on("changed:after",_.bind(this.propertyChange,this,t)),t.txtRangeTop.on("button:click",_.bind(this.onPresetSelect,this,t,"top",t.btnPresetsTop.menu,{value:"select"})),t.txtRangeLeft.on("button:click",_.bind(this.onPresetSelect,this,t,"left",t.btnPresetsLeft.menu,{value:"select"})),t.btnPresetsTop.menu.on("item:click",_.bind(this.onPresetSelect,this,t,"top")),t.btnPresetsLeft.menu.on("item:click",_.bind(this.onPresetSelect,this,t,"left")),t.spnFirstPage&&t.spnFirstPage.on("change",_.bind(this.propertyChange,this,t))},propertyChange:function(s,t,e,i){function o(){var t;l._changedProps&&(t=s.cmbSheet.getValue(),l._changedProps[t]=l.getPageOptions(s,t),l.updatePreview())}var n,a,l=this;"scale"===t&&"customoptions"===i.value?(n=0<l._changedProps.length&&l._changedProps[s.cmbSheet.getValue()]?l._changedProps[s.cmbSheet.getValue()]:l.api.asc_getPageOptions(s.cmbSheet.getValue(),!0),(a=new SSE.Views.ScaleDialog({api:l.api,props:n,handler:function(t,e){var i;"ok"==t?l.api&&e&&(l.fitWidth=e.width,l.fitHeight=e.height,l.fitScale=e.scale,l.setScaling(s,l.fitWidth,l.fitHeight,l.fitScale),o()):(e=(t=n.asc_getPageSetup()).asc_getFitToWidth(),i=t.asc_getFitToHeight(),t=t.asc_getScale(),l.setScaling(s,e,i,t)),Common.NotificationCenter.trigger("edit:complete")}})).show(),Common.NotificationCenter.trigger("edit:complete",this.toolbar)):"margins"===t&&-1===i.value?(n=0<l._changedProps.length&&l._changedProps[s.cmbSheet.getValue()]?l._changedProps[s.cmbSheet.getValue()]:l.api.asc_getPageOptions(s.cmbSheet.getValue(),!0),(a=new SSE.Views.PageMarginsDialog({api:l.api,handler:function(t,e){"ok"==e?(e=t.getSettings(),Common.localStorage.setItem("sse-pgmargins-top",e.asc_getTop()),Common.localStorage.setItem("sse-pgmargins-left",e.asc_getLeft()),Common.localStorage.setItem("sse-pgmargins-bottom",e.asc_getBottom()),Common.localStorage.setItem("sse-pgmargins-right",e.asc_getRight()),Common.NotificationCenter.trigger("margins:update",e,s),l.setMargins(s,e),l._margins[s.cmbSheet.getValue()]=e,o(),Common.NotificationCenter.trigger("edit:complete")):l.setMargins(s,n.asc_getPageMargins())}})).show(),a.setSettings(n)):o()},getPrintParams:function(){return this.adjPrintParams},setScaling:function(t,e,i,s){s=e||i||100!==s?1===e&&1===i?1:1!==e||i?e||1!==i?4:3:2:0;t.addCustomScale(4===s),t.cmbLayout.setValue(s,!0)},setMargins:function(t,e){if(e){for(var i=e.asc_getLeft(),s=e.asc_getTop(),o=e.asc_getRight(),n=e.asc_getBottom(),a=t.cmbPaperMargins.store,l=null,r=0;r<a.length-1;r++){var c=a.at(r),d=c.get("size");"object"==typeof d&&Math.abs(d[0]-s)<.1&&Math.abs(d[1]-i)<.1&&Math.abs(d[2]-n)<.1&&Math.abs(d[3]-o)<.1&&(l=c)}l?t.cmbPaperMargins.setValue(l.get("value")):t.cmbPaperMargins.setValue(this.txtCustom)}},onUpdateLastCustomMargins:function(t,e){var i,s,o,n;this._lastMargins=t,e&&(i=t?t.asc_getTop():Common.localStorage.getItem("sse-pgmargins-top"),s=t?t.asc_getLeft():Common.localStorage.getItem("sse-pgmargins-left"),o=t?t.asc_getBottom():Common.localStorage.getItem("sse-pgmargins-bottom"),t=t?t.asc_getRight():Common.localStorage.getItem("sse-pgmargins-right"),null!==i&&null!==s&&null!==o&&null!==t&&(-2===(n=e.cmbPaperMargins.store.at(0)).get("value")?n.set("size",[parseFloat(i),parseFloat(s),parseFloat(o),parseFloat(t)]):e.cmbPaperMargins.store.unshift({value:-2,displayValue:e.txtMarginsLast,size:[parseFloat(i),parseFloat(s),parseFloat(o),parseFloat(t)]}),e.cmbPaperMargins.onResetItems()))},fillComponents:function(t,e){var i=this,s=(t.txtRangeTop.validation=function(t){return!!_.isEmpty(t)||(i.api.asc_checkDataRange(Asc.c_oAscSelectionDialogType.PrintTitles,t,!1)!=Asc.c_oAscError.ID.DataRangeError||i.textInvalidRange)},e&&t.txtRangeTop.updateBtnHint(this.textSelectRange),t.txtRangeLeft.validation=function(t){return!!_.isEmpty(t)||(i.api.asc_checkDataRange(Asc.c_oAscSelectionDialogType.PrintTitles,t,!1)!=Asc.c_oAscError.ID.DataRangeError||i.textInvalidRange)},e&&t.txtRangeLeft.updateBtnHint(this.textSelectRange),(e?[{caption:this.textSelectRange+"...",value:"select"}]:[]).concat([{caption:this.textFrozenRows,value:"frozen"},{caption:this.textFirstRow,value:"first"},{caption:"--"},{caption:this.textNoRepeat,value:"empty"}]));t.btnPresetsTop.setMenu(new Common.UI.Menu({style:"min-width: 100px;",maxHeight:200,additionalAlign:t.menuAddAlign,items:s})),s=(e?[{caption:this.textSelectRange+"...",value:"select"}]:[]).concat([{caption:this.textFrozenCols,value:"frozen"},{caption:this.textFirstCol,value:"first"},{caption:"--"},{caption:this.textNoRepeat,value:"empty"}]),t.btnPresetsLeft.setMenu(new Common.UI.Menu({style:"min-width: 100px;",maxHeight:200,additionalAlign:t.menuAddAlign,items:s}))},onPresetSelect:function(i,s,t,e){var o,n,a="top"==s?i.txtRangeTop:i.txtRangeLeft;"select"==e.value?this.api&&(i.btnPresetsTop.menu.options.additionalAlign=i.menuAddAlign,i.btnPresetsLeft.menu.options.additionalAlign=i.menuAddAlign,o=new SSE.Views.CellRangeDialog({handler:function(t,e){"ok"==e&&(e=t.getSettings(),"top"==s?i.dataRangeTop=e:i.dataRangeLeft=e,a.setValue(e),a.checkValidate())}}).on("close",function(){i.show(),_.delay(function(){a.focus()},1)}),n=i.$window.offset(),i.hide(),o.show(n.left+160,n.top+125),o.setSettings({api:this.api,range:_.isEmpty(a.getValue())||1!=a.checkValidate()?"top"==s?i.dataRangeTop:i.dataRangeLeft:a.getValue(),type:Asc.c_oAscSelectionDialogType.PrintTitles})):(n="","frozen"==e.value?n=this.api.asc_getPrintTitlesRange(Asc.c_oAscPrintTitlesRangeType.frozen,"left"==s,i.cmbSheet.getValue()):"first"==e.value&&(n=this.api.asc_getPrintTitlesRange(Asc.c_oAscPrintTitlesRangeType.first,"left"==s,i.cmbSheet.getValue())),a.setValue(n),a.checkValidate(),"top"==s?i.dataRangeTop=n:i.dataRangeLeft=n,_.delay(function(){a.focus()},1))},onHidePrintMenu:function(){this._isPreviewVisible&&(this.api.asc_closePrintPreview(this._isPrint),this._isPreviewVisible=!1)},onChangePreviewPage:function(t){var e=this._navigationPreview.currentPage,e=t?(e++,Math.min(e,this._navigationPreview.pageCount-1)):(e--,Math.max(e,0));this.api.asc_drawPrintPreview(e),this.updateNavigationButtons(e,this._navigationPreview.pageCount)},onPreviewWheel:function(t){t.ctrlKey&&(t.preventDefault(),t.stopImmediatePropagation()),this.printSettings.txtRangeTop.cmpEl.find("input:focus").blur(),this.printSettings.txtRangeLeft.cmpEl.find("input:focus").blur();t=(t.deltaY||t.detail&&-t.detail||t.wheelDelta)<0;this.onChangePreviewPage(t)},onKeypressPageNumber:function(t,e){var i,s;if(e.keyCode===Common.UI.Keys.RETURN)return i=(e=this.printSettings.$el.find("#print-number-page")).find("input[type=text]"),!(s=parseInt(i.val()))||s>this._navigationPreview.pageCount||s<0?(i.select(),this.printSettings.txtNumberPage.setValue(this._navigationPreview.currentPage+1),this.printSettings.txtNumberPage.checkValidate()):(e.focus(),this.api.asc_drawPrintPreview(s-1),this.updateNavigationButtons(s-1,this._navigationPreview.pageCount)),!1},onKeyupPageNumber:function(t,e){if(e.keyCode===Common.UI.Keys.ESC)return this.printSettings.$el.find("#print-number-page").focus(),this.api.asc_enableKeyEvents(!0),!1},onBlurPageNumber:function(){this.printSettings.txtNumberPage.getValue()!=this._navigationPreview.currentPage+1&&(this.printSettings.txtNumberPage.setValue(this._navigationPreview.currentPage+1),this.printSettings.txtNumberPage.checkValidate())},updatePreview:function(t){var e,i,s,o,n,a;this._isPreviewVisible&&(this.printSettings.$previewBox.removeClass("hidden"),e=new Asc.asc_CAdjustPrint,i=this.printSettings.getRange(),e.asc_setPrintType(i),e.asc_setPageOptionsMap(this._changedProps),e.asc_setIgnorePrintArea(this.printSettings.getIgnorePrintArea()),e.asc_setActiveSheetsArray(i===Asc.c_oAscPrintType.ActiveSheets?SSE.getController("Statusbar").getSelectTabs():null),n=this.printSettings.getPagesFrom(),(s=this.printSettings.getPagesTo())<n&&(o=n,n=s,s=o),e.asc_setStartPageIndex(0<n?n-1:null),e.asc_setEndPageIndex(0<s?s-1:null),(o=new Asc.asc_CDownloadOptions(null,Common.Utils.isChrome||Common.Utils.isOpera||Common.Utils.isGecko&&86<Common.Utils.firefoxVersion)).asc_setAdvancedOptions(e),n=this.api.asc_updatePrintPreview(o),this.printSettings.$previewBox.toggleClass("hidden",!n),this.printSettings.$previewEmpty.toggleClass("hidden",!!n),this._currentPrintType!==i?(a=0,this._currentPrintType=i):a=this._navigationPreview.currentPage>n-1?Math.max(0,n-1):this._navigationPreview.currentPage,this.notUpdateSheetSettings=!t,this.api.asc_drawPrintPreview(a),this.updateNavigationButtons(a,n))},onApiChangePreviewSheet:function(t){t=this.printSettings.cmbSheet.store.findWhere({value:t});this.printSettings.updateActiveSheet(t.get("displayValue")),this.notUpdateSheetSettings?this.notUpdateSheetSettings=!1:t&&(this.printSettings.cmbSheet.setValue(t.get("value")),this.comboSheetsChange(this.printSettings,this.printSettings.cmbSheet,t.toJSON()))},updateNavigationButtons:function(t,e){this._navigationPreview.currentPage=t,this.printSettings.updateCurrentPage(t),this._navigationPreview.pageCount=e,this.printSettings.updateCountOfPages(e),this.disableNavButtons()},disableNavButtons:function(t){var e;t?(this.printSettings.btnPrevPage.setDisabled(!0),this.printSettings.btnNextPage.setDisabled(!0)):(t=this._navigationPreview.currentPage,e=this._navigationPreview.pageCount,this.printSettings.btnPrevPage.setDisabled(t<1),this.printSettings.btnNextPage.setDisabled(e-2<t))},onOpenHeaderSettings:function(){var t=this._changedProps[this.printSettings.cmbSheet.getValue()].asc_getPageSetup();SSE.getController("Toolbar").onEditHeaderClick(t)},onApiChangePreviewPage:function(t){this._navigationPreview.currentPage!==t&&(this._navigationPreview.currentPage=t,this.updateNavigationButtons(t,this._navigationPreview.pageCount),this.disableNavButtons())},onApiPreviewSheetDataChanged:function(t){t?this.updatePreview():(this.notUpdateSheetSettings=!0,this.api.asc_drawPrintPreview(this._navigationPreview.currentPage),this.updateNavigationButtons(this._navigationPreview.currentPage,this._navigationPreview.pageCount))}},SSE.Controllers.Print||{}))}),define("spreadsheeteditor/main/app/view/DataTab",["common/main/lib/util/utils","common/main/lib/component/BaseView","common/main/lib/component/Layout"],function(){"use strict";SSE.Views.DataTab=Common.UI.BaseView.extend(_.extend({options:{},initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this),this.toolbar=t.toolbar,this.lockedControls=[];var t=this.toolbar.$el,e=Common.enumLock;this.btnDataFromText=new Common.UI.Button({parentEl:t.find("#slot-btn-data-from-text"),cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-import-data",caption:this.capDataFromText,menu:!0,disabled:!0,lock:[e.editCell,e.selChart,e.selChartText,e.selShape,e.selShapeText,e.selImage,e.selSlicer,e.sheetLock,e.wbLock,e.lostConnect,e.coAuth,e.wsLock],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.lockedControls.push(this.btnDataFromText),this.btnGroup=new Common.UI.Button({parentEl:t.find("#slot-btn-group"),cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-cell-group",caption:this.capBtnGroup,split:!0,menu:!0,disabled:!0,lock:[e.editCell,e.selChart,e.selChartText,e.selShape,e.selShapeText,e.selImage,e.selSlicer,e.sheetLock,e.lostConnect,e.coAuth,e.wsLock,e.userProtected],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.lockedControls.push(this.btnGroup),this.btnUngroup=new Common.UI.Button({parentEl:t.find("#slot-btn-ungroup"),cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-cell-ungroup",caption:this.capBtnUngroup,split:!0,menu:!0,disabled:!0,lock:[e.editCell,e.selChart,e.selChartText,e.selShape,e.selShapeText,e.selImage,e.selSlicer,e.sheetLock,e.lostConnect,e.coAuth,e.wsLock,e.userProtected],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.lockedControls.push(this.btnUngroup),this.btnTextToColumns=new Common.UI.Button({parentEl:t.find("#slot-btn-text-column"),cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-to-columns",caption:this.capBtnTextToCol,split:!1,disabled:!0,lock:[e.multiselect,e.multiselectCols,e.editCell,e.selChart,e.selChartText,e.selShape,e.selShapeText,e.selImage,e.selSlicer,e.lostConnect,e.coAuth,e.wsLock,e.userProtected],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.lockedControls.push(this.btnTextToColumns),this.btnRemoveDuplicates=new Common.UI.Button({parentEl:t.find("#slot-btn-rem-duplicates"),cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-big-remove-duplicates",caption:this.capBtnTextRemDuplicates,disabled:!0,lock:[e.editCell,e.selChart,e.selChartText,e.selShape,e.selShapeText,e.selImage,e.selSlicer,e.lostConnect,e.coAuth,e.ruleFilter,e.editPivot,e.cantModifyFilter,e.sheetLock,e.wsLock,e.userProtected],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.lockedControls.push(this.btnRemoveDuplicates),this.btnDataValidation=new Common.UI.Button({parentEl:t.find("#slot-btn-data-validation"),cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-data-validation",caption:this.capBtnTextDataValidation,disabled:!0,lock:[e.editCell,e.selChart,e.selChartText,e.selShape,e.selShapeText,e.selImage,e.selSlicer,e.lostConnect,e.coAuth,e.editPivot,e.cantModifyFilter,e.sheetLock,e.wsLock,e.userProtected],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.lockedControls.push(this.btnDataValidation),this.btnCustomSort=new Common.UI.Button({parentEl:t.find("#slot-btn-custom-sort"),cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-custom-sort",caption:this.capBtnTextCustomSort,disabled:!0,lock:[e.editCell,e.selChart,e.selChartText,e.selShape,e.selShapeText,e.selImage,e.selSlicer,e.lostConnect,e.coAuth,e.ruleFilter,e.cantModifyFilter,e.sheetLock,e.Sort,e.userProtected],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.lockedControls.push(this.btnCustomSort),this.btnExternalLinks=new Common.UI.Button({parentEl:t.find("#slot-btn-data-external-links"),cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-edit-links",caption:this.capDataExternalLinks,disabled:!0,lock:[e.editCell,e.sheetLock,e.wbLock,e.lostConnect,e.coAuth,e.wsLock],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.lockedControls.push(this.btnExternalLinks),this.btnsSortDown=Common.Utils.injectButtons(t.find(".slot-sortdesc"),"","toolbar__icon btn-sort-down","",[e.editCell,e.selChart,e.selChartText,e.selShape,e.selShapeText,e.selImage,e.lostConnect,e.coAuth,e.ruleFilter,e.cantModifyFilter,e.sheetLock,e.cantSort,e.Sort,e.userProtected],void 0,void 0,void 0,"1","top",void 0,"D"),this.btnsSortUp=Common.Utils.injectButtons(t.find(".slot-sortasc"),"","toolbar__icon btn-sort-up","",[e.editCell,e.selChart,e.selChartText,e.selShape,e.selShapeText,e.selImage,e.lostConnect,e.coAuth,e.ruleFilter,e.cantModifyFilter,e.sheetLock,e.cantSort,e.Sort,e.userProtected],void 0,void 0,void 0,"1","top",void 0,"U"),this.btnsSetAutofilter=Common.Utils.injectButtons(t.find(".slot-btn-setfilter"),"","toolbar__icon btn-autofilter","",[e.editCell,e.selChart,e.selChartText,e.selShape,e.selShapeText,e.selImage,e.selSlicer,e.lostConnect,e.coAuth,e.ruleFilter,e.editPivot,e.cantModifyFilter,e.tableHasSlicer,e.wsLock,e.userProtected],!1,!1,!0,"1","bottom",void 0,"F"),this.btnsClearAutofilter=Common.Utils.injectButtons(t.find(".slot-btn-clear-filter"),"","toolbar__icon btn-clear-filter","",[e.editCell,e.selChart,e.selChartText,e.selShape,e.selShapeText,e.selImage,e.lostConnect,e.coAuth,e.ruleDelFilter,e.wsLock,e.userProtected],void 0,void 0,void 0,"1","bottom",void 0,"N"),Array.prototype.push.apply(this.lockedControls,this.btnsSortDown.concat(this.btnsSortUp,this.btnsSetAutofilter,this.btnsClearAutofilter)),Common.NotificationCenter.on("app:ready",this.onAppReady.bind(this))},render:function(t){return this},onAppReady:function(t){var e=this;new Promise(function(t,e){t()}).then(function(){e.btnUngroup.updateHint(e.tipUngroup);var t=new Common.UI.Menu({items:[{caption:e.textRows,value:"rows"},{caption:e.textColumns,value:"columns"},{caption:e.textClear,value:"clear"}]});e.btnUngroup.setMenu(t),e.btnGroup.updateHint(e.tipGroup),t=new Common.UI.Menu({items:[{caption:e.textGroupRows,value:"rows"},{caption:e.textGroupColumns,value:"columns"},{caption:"--"},{caption:e.textBelow,value:"below",checkable:!0},{caption:e.textRightOf,value:"right",checkable:!0}]}),e.btnGroup.setMenu(t),e.btnDataFromText.updateHint(e.tipDataFromText),e.btnDataFromText.menu&&e.btnDataFromText.setMenu(new Common.UI.Menu({items:[{caption:e.mniFromFile,value:"file"}]})),e.toolbar.mode.isDesktopApp&&e.btnDataFromText.menu.items[1].setVisible(!1),e.btnTextToColumns.updateHint(e.tipToColumns),e.btnRemoveDuplicates.updateHint(e.tipRemDuplicates),e.btnDataValidation.updateHint(e.tipDataValidation),e.btnExternalLinks.updateHint(e.tipExternalLinks),e.btnsSortDown.forEach(function(t){t.updateHint(e.toolbar.txtSortAZ)}),e.btnsSortUp.forEach(function(t){t.updateHint(e.toolbar.txtSortZA)}),e.btnsSetAutofilter.forEach(function(t){t.updateHint(e.toolbar.txtFilter+" (Ctrl+Shift+L)")}),e.btnsClearAutofilter.forEach(function(t){t.updateHint(e.toolbar.txtClearFilter)}),e.btnCustomSort.updateHint(e.tipCustomSort),function(){var s=this;s.btnUngroup.menu.on("item:click",function(t,e,i){s.fireEvent("data:ungroup",[e.value])}),s.btnUngroup.on("click",function(t,e){s.fireEvent("data:ungroup")}),s.btnGroup.menu.on("item:click",function(t,e,i){s.fireEvent("data:group",[e.value,e.checked])}),s.btnGroup.on("click",function(t,e){s.fireEvent("data:group")}),s.btnGroup.menu.on("show:before",function(t,e){s.fireEvent("data:groupsettings",[t])}),s.btnTextToColumns.on("click",function(t,e){s.fireEvent("data:tocolumns")}),s.btnRemoveDuplicates.on("click",function(t,e){s.fireEvent("data:remduplicates")}),s.btnDataValidation.on("click",function(t,e){s.fireEvent("data:datavalidation")}),s.btnsSortDown.forEach(function(t){t.on("click",function(t,e){s.fireEvent("data:sort",[Asc.c_oAscSortOptions.Ascending])})}),s.btnsSortUp.forEach(function(t){t.on("click",function(t,e){s.fireEvent("data:sort",[Asc.c_oAscSortOptions.Descending])})}),s.btnsSetAutofilter.forEach(function(t){t.on("click",function(t,e){s.fireEvent("data:setfilter",[Asc.c_oAscSortOptions.Descending])})}),s.btnsClearAutofilter.forEach(function(t){t.on("click",function(t,e){s.fireEvent("data:clearfilter",[Asc.c_oAscSortOptions.Descending])})}),s.btnCustomSort.on("click",function(t,e){s.fireEvent("data:sortcustom")}),s.btnExternalLinks.on("click",function(t,e){s.fireEvent("data:externallinks")}),s.btnDataFromText.menu?s.btnDataFromText.menu.on("item:click",function(t,e,i){s.fireEvent("data:fromtext",[e.value])}):s.btnDataFromText.on("click",function(t,e){s.fireEvent("data:fromtext",["file"])})}.call(e)})},show:function(){Common.UI.BaseView.prototype.show.call(this),this.fireEvent("show",this)},getButtons:function(t){return"sort-down"==t?this.btnsSortDown:"sort-up"==t?this.btnsSortUp:"sort-custom"==t?this.btnCustomSort:"set-filter"==t?this.btnsSetAutofilter:"clear-filter"==t?this.btnsClearAutofilter:"rem-duplicates"==t?this.btnRemoveDuplicates:"data-validation"==t?this.btnDataValidation:void 0===t?this.lockedControls:[]},SetDisabled:function(e){this.lockedControls&&this.lockedControls.forEach(function(t){t&&t.setDisabled(e)},this)}},SSE.Views.DataTab||{}))}),define("text!spreadsheeteditor/main/app/template/SortDialog.template",[],function(){return'<div class="settings-panel active">\n    <div class="inner-content">\n        <table cols="2" style="width: 100%;">\n            <tr>\n                <td>\n                    <label style="margin-bottom: 4px;"><%= scope.textLevels %></label>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <button type="button" class="btn btn-text-default auto sort-dialog-btn-text" id="sort-dialog-btn-add"><%= scope.textBtnNew %></button>\n                    <button type="button" class="btn btn-text-default auto sort-dialog-btn-text" id="sort-dialog-btn-copy"><%= scope.textBtnCopy %></button>\n                    <button type="button" class="btn btn-text-default auto sort-dialog-btn-text" id="sort-dialog-btn-options"><%= scope.textOptions %></button>\n                    <div id="sort-dialog-btn-up" style="display: inline-block;"></div>\n                    <div id="sort-dialog-btn-down" style="display: inline-block;"></div>\n                </td>\n                <td style="width:80px;" class="padding-small">\n                    <button type="button" class="btn btn-text-default auto" id="sort-dialog-btn-delete" style="min-width: 80px;"><%= scope.textBtnDelete %></button>\n                </td>\n            </tr>\n            <tr>\n                <td colspan="2" class="padding-small">\n                    <div id="sort-dialog-list" class="" style="width:100%; height: 173px;"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>'}),define("spreadsheeteditor/main/app/view/SortOptionsDialog",["common/main/lib/util/utils","common/main/lib/component/CheckBox","common/main/lib/component/RadioBox","common/main/lib/view/AdvancedSettingsWindow"],function(){"use strict";SSE.Views.SortOptionsDialog=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:230,height:200},initialize:function(t){_.extend(this.options,{title:this.textTitle,template:['<div class="box" style="height:'+(this.options.height-85)+'px;">','<div class="content-panel"><div class="inner-content">','<div class="settings-panel active">','<table cols="1" style="width: 100%;">',"<tr>",'<td class="padding-large">','<div id="sort-options-chk-headers"></div>',"</td>","</tr>","<tr>",'<td class="padding-small">','<label class="input-label">'+this.textOrientation+"</label>","</td>","</tr>","<tr>",'<td class="padding-small">','<div id="sort-options-radio-row"></div>',"</td>","</tr>","<tr>",'<td class="padding-small">','<div id="sort-options-radio-col"></div>',"</td>","</tr>","</table>","</div></div>","</div>","</div>"].join("")},t),this.props=t.props,Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this),this.chHeaders=new Common.UI.CheckBox({el:$("#sort-options-chk-headers"),labelText:this.textHeaders}),this.radioTop=new Common.UI.RadioBox({el:$("#sort-options-radio-row"),labelText:this.textTopBottom,name:"asc-radio-sort-orient"}).on("change",_.bind(function(t,e,i){e&&this.chHeaders.setDisabled(this.props.lockHeaders)},this)),this.radioLeft=new Common.UI.RadioBox({el:$("#sort-options-radio-col"),labelText:this.textLeftRight,name:"asc-radio-sort-orient"}).on("change",_.bind(function(t,e,i){e&&this.chHeaders.setDisabled(!0)},this)),this.afterRender()},getFocusedComponents:function(){return[this.chHeaders,this.radioTop,this.radioLeft]},getDefaultFocusableComponent:function(){return this.radioTop},afterRender:function(){this._setDefaults(this.props)},_setDefaults:function(t){t&&(this.chHeaders.setValue(t.headers),(t.sortcol||t.lockOrientation?this.radioTop:this.radioLeft).setValue(!0),this.radioLeft.setDisabled(t.lockOrientation))},getSettings:function(){return{headers:this.radioTop.getValue()&&"checked"==this.chHeaders.getValue(),sortcol:this.radioTop.getValue(),lockHeaders:this.props.lockHeaders,lockOrientation:this.props.lockOrientation}}},SSE.Views.SortOptionsDialog||{}))}),define("spreadsheeteditor/main/app/view/SortDialog",["text!spreadsheeteditor/main/app/template/SortDialog.template","common/main/lib/view/AdvancedSettingsWindow","common/main/lib/component/ComboBox","common/main/lib/component/ListView","spreadsheeteditor/main/app/view/SortOptionsDialog"],function(t){"use strict";SSE.Views=SSE.Views||{};var i=Common.UI.DataViewItem.extend({initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);var e=this;e.template=e.options.template||e.template,e.listenTo(e.model,"change:sort",function(){e.render(),e.trigger("change",e,e.model)}),e.listenTo(e.model,"change:selected",function(){(e.$el||$(e.el)).toggleClass("selected",e.model.get("selected")&&e.model.get("allowSelected")),e.onSelectChange(e.model,e.model.get("selected")&&e.model.get("allowSelected"))}),e.listenTo(e.model,"remove",e.remove)}});SSE.Views.SortDialog=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{alias:"SortDialog",contentWidth:560,height:315,buttons:["ok","cancel"]},initialize:function(i){_.extend(this.options,{title:this.txtTitle,template:['<div class="box" style="height:'+(this.options.height-85)+'px;">','<div class="content-panel" style="padding: 0;">'+_.template(t)({scope:this})+"</div>","</div>"].join("")},i),this.api=i.api,this.handler=i.handler,this.props=i.props,this.levels=[],this.sortOptions={},this.options.handler=function(t,e){if(e||(e=new Asc.CSortProperties).asc_setSelection(i.props.asc_getSelection()),"ok"==t&&!this.isListValid())return!0;i.handler&&i.handler.call(this,t,e)},Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var t=$('<span style="position: absolute; visibility: hidden;"></span>'),e=(this.$window.append(t),t.text(this.textSortBy),t.width());t.text(this.textThenBy),e=Math.ceil(Math.max(e,t.width()))+10,t.remove(),this.sortList=new Common.UI.ListView({el:$("#sort-dialog-list",this.$window),store:new Common.UI.DataViewStore,emptyText:"",enableKeyEvents:!1,headers:[{name:this.textColumn,width:212},{name:this.textSort,width:157},{name:this.textOrder,width:156}],template:_.template(['<div class="listview inner" style=""></div>'].join("")),itemTemplate:_.template(['<div class="list-item" style="width: 100%;display: flex;align-items:center;" id="sort-dialog-item-<%= levelIndex %>">','<label class="level-caption" style="width: '+e+'px;flex-shrink:0;cursor: pointer;"></label>','<div style="display:inline-block;flex-grow: 1;">','<div style="width: 33%;padding: 0 5px;display: inline-block;vertical-align: top;"><div id="sort-dialog-cmb-col-<%= levelIndex %>" class="input-group-nr" style=""></div></div>','<div style="width: 33%;padding: 0 5px;display: inline-block;vertical-align: top;"><div id="sort-dialog-cmb-sort-<%= levelIndex %>" class="input-group-nr"></div></div>',"<% if (sort==Asc.c_oAscSortOptions.ByColorFill || sort==Asc.c_oAscSortOptions.ByColorFont) { %>",'<div style="width: 17%;padding: 0 5px;display: inline-block;vertical-align: top;"><div id="sort-dialog-btn-color-<%= levelIndex %>" class="input-group-nr"></div></div>','<div style="width: 17%;padding: 0 5px;display: inline-block;vertical-align: top;"><div id="sort-dialog-cmb-order-<%= levelIndex %>" class="input-group-nr" style=""></div></div>',"<% } else { %>",'<div style="width: 34%;padding: 0 5px;display: inline-block;vertical-align: top;"><div id="sort-dialog-cmb-order-<%= levelIndex %>" class="input-group-nr" style=""></div></div>',"<% } %>","</div>","</div>"].join("")),tabindex:1}),this.sortList.createNewItem=function(t){return new i({template:this.itemTemplate,model:t})},this.sortList.on("item:select",_.bind(this.onSelectLevel,this)).on("item:keydown",_.bind(this.onKeyDown,this)),this.btnAdd=new Common.UI.Button({el:$("#sort-dialog-btn-add")}),this.btnAdd.on("click",_.bind(this.onAddLevel,this,!1)),this.btnDelete=new Common.UI.Button({el:$("#sort-dialog-btn-delete")}),this.btnDelete.on("click",_.bind(this.onDeleteLevel,this)),this.btnCopy=new Common.UI.Button({el:$("#sort-dialog-btn-copy")}),this.btnCopy.on("click",_.bind(this.onCopyLevel,this,!1)),this.btnOptions=new Common.UI.Button({el:$("#sort-dialog-btn-options")}),this.btnOptions.on("click",_.bind(this.onOptions,this,!1)),this.btnUp=new Common.UI.Button({parentEl:$("#sort-dialog-btn-up"),cls:"btn-toolbar bg-white",iconCls:"caret-up",scaling:!1,hint:this.textUp}),this.btnUp.on("click",_.bind(this.onMoveClick,this,!0)),this.btnDown=new Common.UI.Button({parentEl:$("#sort-dialog-btn-down"),cls:"btn-toolbar bg-white",iconCls:"caret-down",scaling:!1,hint:this.textDown}),this.btnDown.on("click",_.bind(this.onMoveClick,this,!1)),this.afterRender()},afterRender:function(){this._setDefaults(this.props)},getFocusedComponents:function(){return[this.btnAdd,this.btnDelete,this.btnCopy,this.btnOptions,this.btnUp,this.btnDown,this.sortList]},getDefaultFocusableComponent:function(){return this.sortList},_setDefaults:function(t){t&&(this.sortOptions={headers:t.asc_getHasHeaders(),sortcol:t.asc_getColumnSort(),lockHeaders:!!t.asc_getLockChangeHeaders(),lockOrientation:!!t.asc_getLockChangeOrientation()},this.sortList.setHeaderName(0,t.asc_getColumnSort()?this.textColumn:this.textRow),this.fillSortValues(),this.sort_data=[{value:Asc.c_oAscSortOptions.ByValue,displayValue:this.textValues},{value:Asc.c_oAscSortOptions.ByColorFill,displayValue:this.textCellColor},{value:Asc.c_oAscSortOptions.ByColorFont,displayValue:this.textFontColor}],this.order_data=[{value:Asc.c_oAscSortOptions.Ascending,displayValue:this.textAZ},{value:Asc.c_oAscSortOptions.Descending,displayValue:this.textZA}],this.sortList.on("item:add",_.bind(this.addControls,this)),this.sortList.on("item:change",_.bind(this.addControls,this)),this.refreshList(t.asc_getLevels()),this.initListHeaders())},refreshList:function(t){this.levels=[];var e=[];if(t=t||1!=this.column_data.length?t:[{columnIndex:this.column_data[0].value,sort:Asc.c_oAscSortOptions.ByValue,order:Asc.c_oAscSortOptions.Ascending}])for(var i=0;i<t.length;i++){var s,o,n=t[i],a=n.asc_getIndex?n.asc_getIndex():n.columnIndex,l=this.props.asc_getLevelProps(a),r=n.asc_getSortBy?n.asc_getSortBy():n.sort,c=!l||l.asc_getIsTextData(),d=r!==Asc.c_oAscSortOptions.ByValue;e.push({columnIndex:a,levelIndex:i,sort:r,order:n.asc_getDescending?n.asc_getDescending():n.order,color:n.asc_getColor?n.asc_getColor():void 0}),d&&(s=[],o=this,l&&(r==Asc.c_oAscSortOptions.ByColorFill?l.asc_getColorsFill():l.asc_getColorsFont()).forEach(function(t,e){var i;t?(i=Common.Utils.ThemeColor.getHexColor(t.get_r(),t.get_g(),t.get_b()).toLocaleUpperCase(),s.push({value:i,displayValue:"",color:t,styleObj:{"background-color":"#"+i},styleStr:"background-color: #"+i+";"})):s.unshift({value:-1,displayValue:r==Asc.c_oAscSortOptions.ByColorFill?o.textNone:o.textAuto,color:null,styleObj:{"background-color":"transparent"},styleStr:"background-color:transparent;"})})),this.levels[i]={levelProps:l,order_data:[{value:Asc.c_oAscSortOptions.Ascending,displayValue:d?this.sortOptions.sortcol?this.textTop:this.textLeft:c?this.textAZ:this.textAsc},{value:Asc.c_oAscSortOptions.Descending,displayValue:d?this.sortOptions.sortcol?this.textBelow:this.textRight:c?this.textZA:this.textDesc}],color_data:s}}else e.push({columnIndex:null,levelIndex:0,sort:Asc.c_oAscSortOptions.ByValue,order:Asc.c_oAscSortOptions.Ascending});this.sortList.store.reset(e),0<this.sortList.store.length&&this.sortList.selectByIndex(0),this.updateButtons()},initListHeaders:function(){var t=Common.UI.isRTL(),e=0,i=0,s=this.sortList.cmpEl.find("#sort-dialog-cmb-sort-0"),o=this.sortList.headerEl.width(),n=parseFloat(this.sortList.headerEl.css(t?"padding-right":"padding-left")),a=s.position();t?a&&(e=o+n-(Math.floor(a.left)+s.width())):a&&(e=Math.floor(a.left)-n),a=(s=(s=this.sortList.cmpEl.find("#sort-dialog-btn-color-0"))[0]?s:this.sortList.cmpEl.find("#sort-dialog-cmb-order-0")).position(),t?a&&(i=o+n-(Math.floor(a.left)+s.width())-e):a&&(i=Math.floor(a.left)-n-e),t=o-e-i,this.sortList.setHeaderWidth(0,e),this.sortList.setHeaderWidth(1,i),this.sortList.setHeaderWidth(2,t)},addControls:function(t,e,s){var o,n,i,a,l,r,c;s&&(o=this,n=s.get("levelIndex"),i=this.sortList.cmpEl.find("#sort-dialog-item-"+n),this.levels[n]||(this.levels[n]={order_data:this.order_data}),a=this.levels[n],l=new Common.UI.ComboBox({el:i.find("#sort-dialog-cmb-col-"+n),editable:!1,cls:"input-group-nr no-highlighted",menuCls:"menu-absolute",menuStyle:"max-height: 135px;",data:this.column_data}).on("selected",function(t,e){var i;-1==e.value?(i=s.get("columnIndex"),t.setValue(null!==i?i:""),o.onSelectOther(t,s)):(s.set("columnIndex",e.value),a.levelProps=o.props.asc_getLevelProps(e.value),o.updateOrderList(n,s,!0))}),null!==(r=s.get("columnIndex"))&&l.setValue(s.get("columnIndex")),a.cmbColumn=l,l=new Common.UI.ComboBox({el:i.find("#sort-dialog-cmb-sort-"+n),editable:!1,cls:"input-group-nr no-highlighted",menuCls:"menu-absolute",data:this.sort_data}).on("selected",function(t,e){s.set("sort",e.value),o.updateOrderList(n,s)}),null!==(r=s.get("sort"))&&l.setValue(r),a.cmbSort=l,(c=s.get("sort"))!=Asc.c_oAscSortOptions.ByColorFill&&c!=Asc.c_oAscSortOptions.ByColorFont||(l=new Common.UI.ComboBoxColor({el:i.find("#sort-dialog-btn-color-"+n),editable:!1,menuCls:"menu-absolute",cls:"no-highlighted",menuStyle:"max-height: 135px;",data:a.color_data,disabled:!a.color_data||a.color_data.length<1}).on("selected",function(t,e){s.set("color",e.color)}),r=s.get("color"),l.setValue(r?Common.Utils.ThemeColor.getHexColor(r.get_r(),r.get_g(),r.get_b()).toLocaleUpperCase():-1),(c=l.getSelectedRecord())&&s.set("color",c.color),a.cmbColor=l),l=new Common.UI.ComboBox({el:i.find("#sort-dialog-cmb-order-"+n),editable:!1,cls:"input-group-nr no-highlighted",menuCls:"menu-absolute",data:a.order_data}).on("selected",function(t,e){s.set("order",e.value)}),null!==(r=s.get("order"))&&l.setValue(r),a.cmbOrder=l,i.on("mousedown",".combobox",function(){o.sortList.selectRecord(s)}),this.updateLevelCaptions(!0))},onOptions:function(){var i=this;new SSE.Views.SortOptionsDialog({props:i.sortOptions,handler:function(t,e){"ok"==t&&e&&(i.sortList.setHeaderName(0,e.sortcol?i.textColumn:i.textRow),i.props.asc_setHasHeaders(e.headers),i.props.asc_setColumnSort(e.sortcol),t=i.sortOptions.sortcol==e.sortcol,i.props.asc_updateSortList(t),i.sortOptions=e,i.updateSortValues(t))}}).show()},fillSortValues:function(){var t=this.props.asc_getSortList(),e=t.length;this.column_data=[];for(var i=0;i<e;i++)null!=t[i]&&this.column_data.push({value:i,displayValue:t[i]});500<=this.column_data.length&&this.column_data.push({value:-1,displayValue:this.sortOptions.sortcol?this.textMoreCols:this.textMoreRows})},updateSortValues:function(s){this.fillSortValues();var o=this;this.sortList.store.each(function(t){var e=s?t.get("columnIndex"):0,i=t.get("levelIndex");s||(t.set("columnIndex",e,{silent:!0}),t.set("color",null,{silent:!0})),o.levels[i].levelProps=null!==e?o.props.asc_getLevelProps(e):void 0,o.addControls(null,null,t),o.updateOrderList(i,t,!0)})},onAddLevel:function(){var t,e,i=this.sortList.store,s=this.sortList.getSelectedRec(),o=1==this.column_data.length?this.column_data[0].value:null,n=this.levels.length;null!==o&&(e=!(t=this.props.asc_getLevelProps(o))||t.asc_getIsTextData(),this.levels[n]={levelProps:t,order_data:[{value:Asc.c_oAscSortOptions.Ascending,displayValue:e?this.textAZ:this.textAsc},{value:Asc.c_oAscSortOptions.Descending,displayValue:e?this.textZA:this.textDesc}]}),(s=i.add({columnIndex:o,levelIndex:n,sort:Asc.c_oAscSortOptions.ByValue,order:Asc.c_oAscSortOptions.Ascending},{at:s?i.indexOf(s)+1:i.length}))&&(this.sortList.selectRecord(s),this.sortList.scrollToRecord(s)),this.updateButtons()},onCopyLevel:function(){var t=this.sortList.store,e=this.sortList.getSelectedRec(),i=this.levels.length,s=this.levels[e?e.get("levelIndex"):null];this.levels[i]={levelProps:s?s.levelProps:null,order_data:s?s.order_data:null,color_data:s?s.color_data:null},(e=t.add({levelIndex:i,columnIndex:e?e.get("columnIndex"):null,sort:e?e.get("sort"):Asc.c_oAscSortOptions.ByValue,order:e?e.get("order"):Asc.c_oAscSortOptions.Ascending,color:e?e.get("color"):null},{at:e?t.indexOf(e)+1:t.length}))&&(this.sortList.selectRecord(e),this.sortList.scrollToRecord(e)),this.updateButtons()},onDeleteLevel:function(){var t,e=this.sortList.store,i=this.sortList.getSelectedRec();i&&(t=i.get("levelIndex"),this.levels[t]=void 0,t=e.indexOf(i),e.remove(i),0<e.length&&this.sortList.selectByIndex(t<e.length?t:e.length-1),this.sortList.scrollToRecord(this.sortList.getSelectedRec())),this.updateButtons()},onMoveClick:function(t){var e,i=this.sortList.store,s=i.length,o=this.sortList.getSelectedRec();o&&(e=i.indexOf(o),i.add(i.remove(o),{at:t?Math.max(0,e-1):Math.min(s-1,e+1)}),this.sortList.selectRecord(o),this.sortList.scrollToRecord(o)),this.updateMoveButtons(),this.updateLevelCaptions()},onSelectLevel:function(t,e,i){this.updateMoveButtons()},updateOrderList:function(t,e,i){var s,o,n,a=this.levels[t],t=!a.levelProps||a.levelProps.asc_getIsTextData(),l=a.cmbSort.getValue()!==Asc.c_oAscSortOptions.ByValue,r=a.cmbOrder.getValue();a.order_data=[{value:Asc.c_oAscSortOptions.Ascending,displayValue:l?this.sortOptions.sortcol?this.textTop:this.textLeft:t?this.textAZ:this.textAsc},{value:Asc.c_oAscSortOptions.Descending,displayValue:l?this.sortOptions.sortcol?this.textBelow:this.textRight:t?this.textZA:this.textDesc}],a.cmbOrder.setData(a.order_data),a.cmbOrder.setValue(r),l&&(a.color_data=[],t=e?e.get("color"):null,s=t?Common.Utils.ThemeColor.getHexColor(t.get_r(),t.get_g(),t.get_b()).toLocaleUpperCase():-1,a.levelProps&&(n=this,(a.cmbSort.getValue()==Asc.c_oAscSortOptions.ByColorFill?a.levelProps.asc_getColorsFill():a.levelProps.asc_getColorsFont()).forEach(function(t,e){var i=t?Common.Utils.ThemeColor.getHexColor(t.get_r(),t.get_g(),t.get_b()).toLocaleUpperCase():-1,i={value:i,displayValue:t?"":a.cmbSort.getValue()==Asc.c_oAscSortOptions.ByColorFill?n.textNone:n.textAuto,color:t,styleObj:{"background-color":t?"#"+i:"transparent"},styleStr:t?"background-color: #"+i+";":"background-color:transparent;"};t?a.color_data.push(i):a.color_data.unshift(i),s==i.value&&(o=s)})),a.cmbColor.setData(a.color_data),a.cmbColor.setDisabled(a.color_data.length<1),0<a.color_data.length&&a.cmbColor.setValue(o&&i?o:a.color_data[0].value),(r=a.cmbColor.getSelectedRecord())&&e&&e.set("color",r.color))},getSettings:function(){var t=new Asc.CSortProperties,s=(t.asc_setHasHeaders(this.sortOptions.headers),t.asc_setColumnSort(this.sortOptions.sortcol),this),o=[];return this.sortList.store.each(function(t){var e,i=t.get("columnIndex"),t=s.levels[t.get("levelIndex")];null!==i&&t&&((e=new Asc.CSortPropertiesLevel).asc_setIndex(i),e.asc_setSortBy(t.cmbSort.getValue()),e.asc_setDescending(t.cmbOrder.getValue()),t.cmbSort.getValue()!=Asc.c_oAscSortOptions.ByColorFill&&t.cmbSort.getValue()!=Asc.c_oAscSortOptions.ByColorFont||(i=t.cmbColor.getSelectedRecord())&&e.asc_setColor(i.color),o.push(e))}),t.asc_setLevels(o),t.asc_setSelection(this.props.asc_getSelection()),t},isListValid:function(){var t=this.sortList.store.findWhere({columnIndex:null});if(t)Common.UI.warning({msg:this.errorEmpty});else{for(var e=this.sortList.store,i=e.length,s=0;s<i;s++){for(var o=e.at(s),n=this.levels[o.get("levelIndex")],a=n.cmbSort.getValue(),l=a==Asc.c_oAscSortOptions.ByColorFill||a==Asc.c_oAscSortOptions.ByColorFont?n.cmbColor.getSelectedRecord():null,r=s-1;0<=r;r--){var c=e.at(r),d=this.levels[c.get("levelIndex")];if(o.get("columnIndex")==c.get("columnIndex")&&a==d.cmbSort.getValue()){if(a!=Asc.c_oAscSortOptions.ByColorFill&&a!=Asc.c_oAscSortOptions.ByColorFont){t=n.cmbColumn.getSelectedRecord().displayValue,t=this.errorSameColumnValue.replace("%1",t);break}c=d.cmbColor.getSelectedRecord();if(l&&c&&l.value==c.value){t=n.cmbColumn.getSelectedRecord().displayValue,t=this.errorSameColumnColor.replace("%1",t);break}}}if(t)break}t&&Common.UI.warning({msg:t})}return!t},close:function(){Common.Views.AdvancedSettingsWindow.prototype.close.call(this)},onKeyDown:function(t,e,i){i.keyCode!=Common.UI.Keys.DELETE||this.btnDelete.isDisabled()||this.onDeleteLevel()},updateButtons:function(){this.btnAdd.setDisabled(63<this.sortList.store.length),this.btnCopy.setDisabled(this.sortList.store.length<1),this.btnDelete.setDisabled(this.sortList.store.length<1),this.updateMoveButtons(),this.updateLevelCaptions(!0),this.sortList.scroller&&this.sortList.scroller.update()},updateMoveButtons:function(){var t=this.sortList.getSelectedRec(),t=t?this.sortList.store.indexOf(t):-1;this.btnUp.setDisabled(t<1),this.btnDown.setDisabled(t<0||t==this.sortList.store.length-1)},updateLevelCaptions:function(t){var e=this.$window.find(".level-caption");e.length<1||(t?e.text(this.textThenBy):1<e.length&&(e[1].innerText=this.textThenBy),e[0].innerText=this.textSortBy)},onSelectOther:function(s,o){var t,e,n=this;n.api&&(t=new SSE.Views.CellRangeDialog({handler:function(t,e){var i;if("ok"==e)return e=t.getSettings(),(i=_.isEmpty(e)?i:n.api.asc_checkDataRange(Asc.c_oAscSelectionDialogType.CustomSort,e,!0,!n.sortOptions.sortcol))==Asc.c_oAscError.ID.No?(t=n.props.asc_addBySortList(e),n.fillSortValues(),s.setData(n.column_data),s.setValue(t),o.set("columnIndex",t),n.levels[o.get("levelIndex")].levelProps=n.props.asc_getLevelProps(t),n.updateOrderList(o.get("levelIndex"),o,!0),!1):(i==Asc.c_oAscError.ID.CustomSortMoreOneSelectedError?Common.UI.warning({msg:n.sortOptions.sortcol?n.errorMoreOneCol:n.errorMoreOneRow}):i==Asc.c_oAscError.ID.CustomSortNotOriginalSelectError?Common.UI.warning({msg:n.sortOptions.sortcol?n.errorNotOriginalCol:n.errorNotOriginalRow}):Common.UI.warning({msg:n.txtInvalidRange}),!0)}}).on("close",function(){n.show()}),e=n.$window.offset(),n.hide(),t.show(e.left+65,e.top+77),t.setSettings({api:n.api,range:n.props.asc_getRangeStr(),type:Asc.c_oAscSelectionDialogType.CustomSort}))}},SSE.Views.SortDialog||{}))}),define("spreadsheeteditor/main/app/view/RemoveDuplicatesDialog",["common/main/lib/component/Window","common/main/lib/component/CheckBox","common/main/lib/component/ListView"],function(){"use strict";SSE.Views.RemoveDuplicatesDialog=Common.UI.Window.extend(_.extend({options:{width:350,style:"min-width: 230px;",cls:"modal-dlg",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:this.txtTitle},t||{}),this.template=['<div class="box" style="height: 260px;">','<div style="margin-bottom: 16px;">',"<label>"+this.textDescription+"</label>","</div>",'<div class="input-row">','<div id="rem-duplicates-dlg-headers"></div>',"</div>",'<div class="input-row">','<label class="font-weight-bold">'+this.textColumns+"</label>","</div>",'<div id="rem-duplicates-dlg-columns" class="" style="width: 100%; height: 162px; overflow: hidden;"></div>',"</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),this.api=this.options.api,this.props=this.options.props,this.handler=this.options.handler,Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this),this.chHeaders=new Common.UI.CheckBox({el:$("#rem-duplicates-dlg-headers"),labelText:this.textHeaders}),this.chHeaders.on("change",_.bind(function(t,e,i,s){this.props.asc_setHasHeaders("checked"==t.getValue()),this.props.asc_updateColumnList(),this.updateColumnsList()},this)),this.columnsList=new Common.UI.ListView({el:$("#rem-duplicates-dlg-columns",this.$window),store:new Common.UI.DataViewStore,simpleAddMode:!0,scrollAlwaysVisible:!0,tabindex:1,template:_.template(['<div class="listview inner" style=""></div>'].join("")),itemTemplate:_.template(["<div>",'<label class="checkbox-indeterminate" style="position:absolute;">','<input id="rdcheckbox-<%= id %>" type="checkbox" class="button__checkbox">','<label for="rdcheckbox-<%= id %>" class="checkbox__shape"></label>',"</label>",'<div id="<%= id %>" class="list-item margin-left-20" style="pointer-events:none; display: flex;">','<div style="flex-grow: 1;"><%= Common.Utils.String.htmlEncode(value) %></div>',"</div>","</div>"].join(""))}),this.columnsList.on({"item:change":this.onItemChanged.bind(this),"item:add":this.onItemChanged.bind(this),"item:select":this.onCellCheck.bind(this)}),this.columnsList.onKeyDown=_.bind(this.onListKeyDown,this),this.columnsList.on("entervalue",_.bind(this.onPrimary,this)),this.$window.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.afterRender()},updateColumnsList:function(){var t=!1,s=0,o=[],i=this.columnsList.store;i.length<1?(this.props.asc_getColumnList().forEach(function(t,e){var i=t.asc_getVisible();o.push(new Common.UI.DataViewModel({id:e,selected:!1,allowSelected:!0,value:t.asc_getVal(),groupid:"1",check:i})),i&&s++}),s==o.length?t=!0:0<s&&(t="indeterminate"),0<o.length&&o.unshift(new Common.UI.DataViewModel({id:o.length,selected:!1,allowSelected:!0,value:this.textSelectAll,groupid:"0",check:t,throughIndex:0})),this.columnsList.store.reset(o),this.columnsList.scroller.update({minScrollbarLength:this.columnsList.minScrollbarLength,alwaysVisibleY:!0,suppressScrollX:!0})):this.props.asc_getColumnList().forEach(function(t,e){i.at(e+1).set("value",t.asc_getVal())})},onItemChanged:function(t,e){var i=e.model.get("check");"indeterminate"==i?$("input[type=checkbox]",e.$el).prop("indeterminate",!0):$("input[type=checkbox]",e.$el).prop({checked:i,indeterminate:!1})},onCellCheck:function(t,e,i){var s,o,n,a,l;this.checkCellTrigerBlock||(l="",s=!1,n=null,(o=window.event||window._event)&&((l=$(o.currentTarget).find(".list-item")).length&&(n=l.get(0).getBoundingClientRect(),l=o.clientX*Common.Utils.zoom(),a=o.clientY*Common.Utils.zoom(),n.left<l&&l<n.right&&n.top<a&&a<n.bottom&&(s=!0)),(s||o.target.className.match("checkbox")&&"input"!==o.target.localName)&&(this.updateCellCheck(t,i),_.delay(function(){t.focus()},100,this))))},onListKeyDown:function(t,e){var i=this.columnsList;i.disabled||((e=_.isUndefined(void 0)?t:e).keyCode==Common.UI.Keys.SPACE?(e.preventDefault(),e.stopPropagation(),this.updateCellCheck(i,i.getSelectedRec())):Common.UI.DataView.prototype.onKeyDown.call(this.columnsList,t,e))},updateCellCheck:function(t,e){if(e&&t){var i=t.store,s=!e.get("check");if("0"==e.get("groupid"))i.each(function(t){t.set("check",s)});else{e.set("check",s);for(var o=s,n=0;n<i.length;n++){var a=i.at(n);if("1"==a.get("groupid")&&a.get("check")!==s){o="indeterminate";break}}this.checkCellTrigerBlock=!0,i.at(0).set("check",o),this.checkCellTrigerBlock=void 0}t.scroller.update({minScrollbarLength:t.minScrollbarLength,alwaysVisibleY:!0,suppressScrollX:!0})}},getFocusedComponents:function(){return[this.chHeaders,this.columnsList]},getDefaultFocusableComponent:function(){return this.columnsList},afterRender:function(){this._setDefaults(this.props)},_setDefaults:function(t){t&&(this.chHeaders.setValue(!!t.asc_getHasHeaders(),!0),this.updateColumnsList())},getSettings:function(){var t=this.columnsList.store,i=this.props.asc_getColumnList();return t.each(function(t,e){"1"==t.get("groupid")&&i[e-1].asc_setVisible(t.get("check"))}),this.props},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onDblClickFormat:function(){this._handleInput("ok")},onPrimary:function(t){return this._handleInput("ok"),!1},_handleInput:function(t){this.options.handler&&this.options.handler.call(this,t,"ok"==t?this.getSettings():this.props),this.close()}},SSE.Views.RemoveDuplicatesDialog||{}))}),define("text!spreadsheeteditor/main/app/template/DataValidationDialog.template",[],function(){return'<div id="id-data-validation-settings" class="settings-panel active" style="height: 100%;">\n    <div class="inner-content" style="height: 100%;">\n        <table cols="2" style="width: 100%;height: 100%;">\n            <tr>\n                <td class="padding-small padding-right-5">\n                    <label class="input-label"><%= scope.textAllow %></label>\n                    <div id="data-validation-cmb-allow"></div>\n                </td>\n                <td class="padding-small padding-left-5">\n                    <label class="input-label"><%= scope.textData %></label>\n                    <div id="data-validation-cmb-data"></div>\n                </td>\n            </tr>\n            <tr>\n                <td colspan=2 class="padding-small">\n                    <div id="data-validation-ch-ignore"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small padding-right-5">\n                    <label id="data-validation-label-min" class="input-label"><%= scope.textMin %></label>\n                    <div id="data-validation-txt-min"></div>\n                </td>\n                <td class="padding-small padding-left-5">\n                    <label id="data-validation-label-max" class="input-label"><%= scope.textMax %></label>\n                    <div id="data-validation-txt-max"></div>\n                </td>\n            </tr>\n            <tr>\n                <td colspan=2 class="padding-small">\n                    <div id="data-validation-ch-show-dropdown"></div>\n                </td>\n            </tr>\n            <tr class="data-source">\n                <td colspan=2 class="padding-small">\n                    <label id="data-validation-label-source" class="input-label"><%= scope.textSource %></label>\n                    <div id="data-validation-txt-source"></div>\n                </td>\n            </tr>\n            <tr style="height: 100%;vertical-align: bottom;">\n                <td colspan=2 style="padding-bottom: 20px;">\n                    <div id="data-validation-ch-apply"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-data-validation-input" class="settings-panel">\n    <div class="inner-content">\n        <table cols="1" style="width: 100%;">\n            <tr>\n                <td class="padding-small">\n                    <div id="data-validation-ch-show-input"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <label><%= scope.textCellSelected %></label>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textTitle %></label>\n                    <div id="data-validation-input-title"></div>\n                </td>\n            </tr>\n            <tr>\n                <td>\n                    <label class="input-label"><%= scope.textInput %></label>\n                    <div id="data-validation-input-msg"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-data-validation-error" class="settings-panel">\n    <div class="inner-content">\n        <table cols="1" style="width: 100%;">\n            <tr>\n                <td class="padding-small">\n                    <div id="data-validation-ch-show-error"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <label><%= scope.textUserEnters %></label>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div class="margin-right-5" style="display: inline-block; vertical-align: bottom;">\n                        <div id="data-validation-img-style" class="icon  error" style="margin-bottom: -1px;"></div>\n                    </div>\n                    <div class="float-right">\n                        <label class="input-label"><%= scope.textTitle %></label>\n                        <div id="data-validation-error-title"></div>\n                    </div>\n                    <div class="float-right margin-right-5">\n                        <label class="input-label"><%= scope.textStyle %></label>\n                        <div id="data-validation-cmb-style"></div>\n                    </div>\n                </td>\n            </tr>\n            <tr>\n                <td>\n                    <label class="input-label"><%= scope.textError %></label>\n                    <div id="data-validation-error-msg"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n'}),void 0===Common&&(Common={}),define("common/main/lib/component/TextareaField",["common/main/lib/component/BaseView","common/main/lib/component/Tooltip"],function(){"use strict";Common.UI.TextareaField=Common.UI.BaseView.extend({options:{id:null,cls:"",style:"",value:"",maxlength:void 0,placeHolder:"",spellcheck:!1,disabled:!1,resize:!1},template:_.template(['<div class="textarea-field" style="<%= style %>">',"<textarea ",'spellcheck="<%= spellcheck %>" ','class="form-control <%= cls %>" ','placeholder="<%= placeHolder %>" ',"<% if (dataHint) {%>",'data-hint="<%= dataHint %>" ',"<% } %>","<% if (dataHintDirection) {%>",'data-hint-direction="<%= dataHintDirection %>" ',"<% } %>","<% if (dataHintOffset) {%>",'data-hint-offset="<%= dataHintOffset %>" ',"<% } %>","></textarea>","</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);t=this;this.id=t.options.id||Common.UI.getId(),this.cls=t.options.cls,this.style=t.options.style,this.value=t.options.value,this.placeHolder=t.options.placeHolder,this.template=t.options.template||t.template,this.disabled=t.options.disabled,this.spellcheck=t.options.spellcheck,this.maxLength=t.options.maxLength,t.rendered=t.options.rendered||!1,t.options.el&&t.render()},render:function(t){return this.rendered?this.cmpEl=this.$el:(this.cmpEl=$(this.template({id:this.id,cls:this.cls,style:this.style,placeHolder:this.placeHolder,spellcheck:this.spellcheck,dataHint:this.options.dataHint,dataHintDirection:this.options.dataHintDirection,dataHintOffset:this.options.dataHintOffset,scope:this})),(t?(this.setElement(t,!1),t):this.$el).html(this.cmpEl)),this.rendered||(this.cmpEl,this._input=this.cmpEl.find("textarea").addBack().filter("textarea"),this._input.on("blur",_.bind(this.onInputChanged,this)),this._input.on("keydown",_.bind(this.onKeyDown,this)),this.maxLength&&this._input.attr("maxlength",this.maxLength),this.resize||this._input.css("resize","none"),this.disabled&&this.setDisabled(this.disabled)),this.rendered=!0,this.value&&this.setValue(this.value),this},_doChange:function(t,e){var i;e&&e.synthetic||(e=$(t.target).val(),i=this.value,this.trigger("changed:before",this,e,i,t),t.isDefaultPrevented()||(this.value=e,this.trigger("changed:after",this,e,i,t)))},onInputChanged:function(t,e){this._doChange(t,e)},onKeyDown:function(t){this.trigger("keydown:before",this,t),t.isDefaultPrevented()||(t.keyCode===Common.UI.Keys.RETURN&&t.stopPropagation(),t.keyCode==Common.UI.Keys.ESC&&this.setValue(this.value),t.keyCode==Common.UI.Keys.ESC&&this.trigger("inputleave",this))},setDisabled:function(t){this.disabled=t=!!t,$(this.el).toggleClass("disabled",t),t?this._input.attr("disabled",!0):this._input.removeAttr("disabled")},isDisabled:function(){return this.disabled},setValue:function(t){this.value=t,this.rendered&&this._input.val(t)},getValue:function(){return this.value},focus:function(){this._input.focus()}})}),define("spreadsheeteditor/main/app/view/DataValidationDialog",["text!spreadsheeteditor/main/app/template/DataValidationDialog.template","common/main/lib/util/utils","common/main/lib/component/InputField","common/main/lib/component/ComboBox","common/main/lib/component/CheckBox","common/main/lib/component/TextareaField","common/main/lib/view/AdvancedSettingsWindow"],function(e){"use strict";SSE.Views.DataValidationDialog=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:320,height:330,toggleGroup:"data-validation-group",storageName:"sse-data-validation-category"},initialize:function(t){_.extend(this.options,{title:this.options.title,items:[{panelId:"id-data-validation-settings",panelCaption:this.strSettings},{panelId:"id-data-validation-input",panelCaption:this.strInput},{panelId:"id-data-validation-error",panelCaption:this.strError}],contentTemplate:_.template(e)({scope:this})},t),this.api=t.api,this.handler=t.handler,this.props=t.props,this._noApply=!0,Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var t=this,e=this.getChild();this.cmbAllow=new Common.UI.ComboBox({el:e.find("#data-validation-cmb-allow"),cls:"input-group-nr",editable:!1,data:[{value:Asc.c_oAscEDataValidationType.None,displayValue:this.txtAny},{value:Asc.c_oAscEDataValidationType.Whole,displayValue:this.txtWhole},{value:Asc.c_oAscEDataValidationType.Decimal,displayValue:this.txtDecimal},{value:Asc.c_oAscEDataValidationType.List,displayValue:this.txtList},{value:Asc.c_oAscEDataValidationType.Date,displayValue:this.txtDate},{value:Asc.c_oAscEDataValidationType.Time,displayValue:this.txtTime},{value:Asc.c_oAscEDataValidationType.TextLength,displayValue:this.txtTextLength},{value:Asc.c_oAscEDataValidationType.Custom,displayValue:this.txtOther}],style:"width: 100%;",menuStyle:"min-width: 100%;",takeFocusOnClose:!0}),this.cmbAllow.setValue(Asc.c_oAscEDataValidationType.None),this.cmbAllow.on("selected",_.bind(this.onAllowSelect,this)),this.cmbData=new Common.UI.ComboBox({el:e.find("#data-validation-cmb-data"),cls:"input-group-nr",editable:!1,data:[{value:Asc.EDataValidationOperator.Between,displayValue:this.txtBetween},{value:Asc.EDataValidationOperator.NotBetween,displayValue:this.txtNotBetween},{value:Asc.EDataValidationOperator.Equal,displayValue:this.txtEqual},{value:Asc.EDataValidationOperator.NotEqual,displayValue:this.txtNotEqual},{value:Asc.EDataValidationOperator.GreaterThan,displayValue:this.txtGreaterThan},{value:Asc.EDataValidationOperator.LessThan,displayValue:this.txtLessThan},{value:Asc.EDataValidationOperator.GreaterThanOrEqual,displayValue:this.txtGreaterThanOrEqual},{value:Asc.EDataValidationOperator.LessThanOrEqual,displayValue:this.txtLessThanOrEqual}],style:"width: 100%;",menuStyle:"min-width: 100%;",takeFocusOnClose:!0}),this.cmbData.setValue(Asc.EDataValidationOperator.Between),this.cmbData.on("selected",_.bind(this.onDataSelect,this)),this.chIgnore=new Common.UI.CheckBox({el:e.find("#data-validation-ch-ignore"),labelText:this.textIgnore,value:!0}),this.chIgnore.on("change",_.bind(this.onIgnoreChange,this)),this.lblRangeMin=e.find("#data-validation-label-min"),this.inputRangeMin=new Common.UI.InputFieldBtn({el:e.find("#data-validation-txt-min"),style:"100%",btnHint:this.textSelectData,validateOnBlur:!1}).on("changed:after",_.bind(this.onRangeChange,this,1)).on("button:click",_.bind(this.onSelectData,this,1)),this.lblRangeMax=e.find("#data-validation-label-max"),this.inputRangeMax=new Common.UI.InputFieldBtn({el:e.find("#data-validation-txt-max"),style:"100%",btnHint:this.textSelectData,validateOnBlur:!1}).on("changed:after",_.bind(this.onRangeChange,this,2)).on("button:click",_.bind(this.onSelectData,this,2)),this.chShowDropDown=new Common.UI.CheckBox({el:e.find("#data-validation-ch-show-dropdown"),labelText:this.textShowDropDown,value:!0}),this.chShowDropDown.on("change",_.bind(this.onDropDownChange,this)),this.lblRangeSource=e.find("#data-validation-label-source"),this.inputRangeSource=new Common.UI.InputFieldBtn({el:e.find("#data-validation-txt-source"),style:"100%",btnHint:this.textSelectData,validateOnBlur:!1}).on("changed:after",_.bind(this.onRangeChange,this,3)).on("button:click",_.bind(this.onSelectData,this,3)),this.chApply=new Common.UI.CheckBox({el:e.find("#data-validation-ch-apply"),labelText:this.textApply,disabled:!0}),this.chApply.on("change",_.bind(this.onApplyChange,this)),this.chShowInput=new Common.UI.CheckBox({el:e.find("#data-validation-ch-show-input"),labelText:this.textShowInput,value:!0}),this.chShowInput.on("change",_.bind(this.onShowInputChange,this)),this.inputInputTitle=new Common.UI.InputField({el:e.find("#data-validation-input-title"),allowBlank:!0,validateOnBlur:!1,maxLength:32,style:"width: 100%;"}).on("changed:after",function(){t.isInputTitleChanged=!0}),this.textareaInput=new Common.UI.TextareaField({el:e.find("#data-validation-input-msg"),style:"width: 100%; height: 70px;",maxLength:255,value:""}),this.textareaInput.on("changed:after",function(){t.isInputChanged=!0}),this.chShowError=new Common.UI.CheckBox({el:e.find("#data-validation-ch-show-error"),labelText:this.textShowError,value:!0}),this.chShowError.on("change",_.bind(this.onShowErrorChange,this)),this.cmbStyle=new Common.UI.ComboBox({el:e.find("#data-validation-cmb-style"),cls:"input-group-nr",editable:!1,data:[{value:Asc.c_oAscEDataValidationErrorStyle.Stop,clsText:"error",displayValue:this.textStop},{value:Asc.c_oAscEDataValidationErrorStyle.Warning,clsText:"warn",displayValue:this.textAlert},{value:Asc.c_oAscEDataValidationErrorStyle.Information,clsText:"info",displayValue:this.textMessage}],style:"width: 110px;",menuStyle:"min-width: 110px;",takeFocusOnClose:!0}),this.cmbStyle.setValue(Asc.c_oAscEDataValidationErrorStyle.Stop),this.cmbStyle.on("selected",_.bind(this.onStyleSelect,this)),this.inputErrorTitle=new Common.UI.InputField({el:e.find("#data-validation-error-title"),allowBlank:!0,validateOnBlur:!1,maxLength:32,style:"width: 140px;"}).on("changed:after",function(){t.isErrorTitleChanged=!0}),this.textareaError=new Common.UI.TextareaField({el:e.find("#data-validation-error-msg"),style:"width: 100%; height: 70px;",maxLength:255,value:""}),this.textareaError.on("changed:after",function(){t.isErrorChanged=!0}),this.minMaxTr=e.find("#data-validation-txt-min").closest("tr"),this.sourceTr=e.find("#data-validation-txt-source").closest("tr"),this.dropdownTr=e.find("#data-validation-ch-show-dropdown").closest("tr"),this.errorIcon=e.find("#data-validation-img-style"),this.afterRender()},afterRender:function(){var t;this._setDefaults(this.props),this.storageName&&(t=Common.localStorage.getItem(this.storageName),this.setActiveCategory(null!==t?parseInt(t):0))},getFocusedComponents:function(){return[this.cmbAllow,this.cmbData,this.chIgnore,this.chShowDropDown,this.inputRangeSource,this.inputRangeMin,this.inputRangeMax,this.chApply,this.chShowInput,this.inputInputTitle,this.textareaInput,this.chShowError,this.cmbStyle,this.inputErrorTitle,this.textareaError]},onCategoryClick:function(t,e){Common.Views.AdvancedSettingsWindow.prototype.onCategoryClick.call(this,t,e);var i=this;setTimeout(function(){switch(e){case 0:i.cmbAllow.focus();break;case 1:(i.inputInputTitle.isDisabled()?i.chShowInput:i.inputInputTitle).focus();break;case 2:(i.cmbStyle.isDisabled()?i.chShowError:i.cmbStyle).focus()}},10)},show:function(){Common.Views.AdvancedSettingsWindow.prototype.show.apply(this,arguments)},onSelectData:function(i,s){var t,e,o=this;o.api&&(t=new SSE.Views.CellRangeDialog({handler:function(t,e){"ok"==e&&(e=t.getSettings(),s.setValue(e),o.onRangeChange(i,s,e))}}).on("close",function(){o.show(),setTimeout(function(){o._noApply=!0,s.focus(),o._noApply=!1},1)}),e=o.$window.offset(),o.hide(),t.show(e.left+160,e.top+125),t.setSettings({api:o.api,range:s.getValue(),type:Asc.c_oAscSelectionDialogType.DataValidation,validation:function(){return!0}}))},onRangeChange:function(t,e,i,s,o){i==s||this._noApply||(1==t||3==t?(this.props.asc_getFormula1()||this.props.asc_setFormula1(new Asc.CDataFormula),this.props.asc_getFormula1().asc_setValue(i)):2==t&&(this.props.asc_getFormula2()||this.props.asc_setFormula2(new Asc.CDataFormula),this.props.asc_getFormula2().asc_setValue(i)))},onAllowSelect:function(t,e){this.ShowHideElem(),this._noApply||this.props.asc_setType(e.value),this.inputRangeMin.setValue(this.props.asc_getFormula1()&&this.props.asc_getFormula1().asc_getValue()||""),this.inputRangeSource.setValue(this.props.asc_getFormula1()&&this.props.asc_getFormula1().asc_getValue()||""),this.inputRangeMax.setValue(this.props.asc_getFormula2()&&this.props.asc_getFormula2().asc_getValue()||"")},onDataSelect:function(t,e){this.ShowHideElem(),this._noApply||this.props.asc_setOperator(e.value),this.inputRangeMin.setValue(this.props.asc_getFormula1()&&this.props.asc_getFormula1().asc_getValue()||""),this.inputRangeSource.setValue(this.props.asc_getFormula1()&&this.props.asc_getFormula1().asc_getValue()||""),this.inputRangeMax.setValue(this.props.asc_getFormula2()&&this.props.asc_getFormula2().asc_getValue()||"")},onStyleSelect:function(t,e){this.errorIcon.removeClass("error warn info"),this.errorIcon.addClass(e.clsText),this._noApply||this.props.asc_setErrorStyle(e.value)},onIgnoreChange:function(t,e,i,s){this._noApply||this.props.asc_setAllowBlank("checked"==t.getValue())},onDropDownChange:function(t,e,i,s){this._noApply||this.props.asc_setShowDropDown("checked"!==t.getValue())},onShowInputChange:function(t,e,i,s){var o="checked"==t.getValue();this.inputInputTitle.setDisabled(!o),this.textareaInput.setDisabled(!o),this.api&&!this._noApply&&this.props.asc_setShowInputMessage("checked"==t.getValue())},onShowErrorChange:function(t,e,i,s){var o="checked"==t.getValue();this.inputErrorTitle.setDisabled(!o),this.cmbStyle.setDisabled(!o),this.textareaError.setDisabled(!o),this.api&&!this._noApply&&this.props.asc_setShowErrorMessage("checked"==t.getValue())},onApplyChange:function(t,e,i,s){this.api&&!this._noApply&&this.api.asc_setDataValidation(this.getSettings(),"checked"==t.getValue())},_setDefaults:function(t){var e;this._noApply=!0,t&&(e=t.asc_getAllowBlank(),this.chIgnore.setValue(e,!0),e=t.asc_getShowDropDown(),this.chShowDropDown.setValue(!e,!0),e=t.asc_getType(),this.cmbAllow.setValue(null!==e?e:Asc.c_oAscEDataValidationType.None,!0),this.chApply.setDisabled(e===Asc.c_oAscEDataValidationType.None),e=t.asc_getOperator(),this.cmbData.setValue(null!==e?e:Asc.EDataValidationOperator.Between,!0),this.inputRangeMin.setValue(t.asc_getFormula1()&&t.asc_getFormula1().asc_getValue()||""),this.inputRangeSource.setValue(t.asc_getFormula1()&&t.asc_getFormula1().asc_getValue()||""),this.inputRangeMax.setValue(t.asc_getFormula2()&&t.asc_getFormula2().asc_getValue()||""),this.chShowInput.setValue(!!t.asc_getShowInputMessage()),this.inputInputTitle.setValue(t.asc_getPromptTitle()||""),this.textareaInput.setValue(t.asc_getPrompt()||""),this.chShowError.setValue(!!t.asc_getShowErrorMessage()),this.inputErrorTitle.setValue(t.asc_getErrorTitle()||""),this.textareaError.setValue(t.asc_getError()||""),e=t.asc_getErrorStyle(),this.cmbStyle.setValue(null!==e?e:Asc.EDataValidationErrorStyle.Stop),(t=this.cmbStyle.getSelectedRecord())&&(this.errorIcon.removeClass("error warn info"),this.errorIcon.addClass(t.clsText))),this.ShowHideElem(),this._noApply=!1},getSettings:function(){return this.isInputTitleChanged&&this.props.asc_setPromptTitle(this.inputInputTitle.getValue()),this.isInputChanged&&this.props.asc_setPrompt(this.textareaInput.getValue()),this.isErrorTitleChanged&&this.props.asc_setErrorTitle(this.inputErrorTitle.getValue()),this.isErrorChanged&&this.props.asc_setError(this.textareaError.getValue()),this.props},onDlgBtnClick:function(t){var e=this,i="object"==typeof t?t.currentTarget.attributes.result.value:t;"ok"==i?this.isRangeValid(function(){e.handler&&e.handler.call(e,i,"ok"==i?e.getSettings():void 0),e.close()}):this.close()},onPrimary:function(){return this.onDlgBtnClick("ok"),!1},ShowHideElem:function(){var t=this.cmbAllow.getValue(),e=this.cmbData.getValue(),i=e==Asc.EDataValidationOperator.Between||e==Asc.EDataValidationOperator.NotBetween,s=t==Asc.c_oAscEDataValidationType.Custom||t==Asc.c_oAscEDataValidationType.List,s=(this.minMaxTr.toggleClass("hidden",t==Asc.c_oAscEDataValidationType.None||s||!i),this._isMinMaxVisible=!(t==Asc.c_oAscEDataValidationType.None||s||!i),this.sourceTr.toggleClass("hidden",t==Asc.c_oAscEDataValidationType.None||!s&&i),this.dropdownTr.toggleClass("hidden",t!=Asc.c_oAscEDataValidationType.List),this.chIgnore.setDisabled(t===Asc.c_oAscEDataValidationType.None),this.cmbData.setDisabled(t===Asc.c_oAscEDataValidationType.None||t===Asc.c_oAscEDataValidationType.Custom||t===Asc.c_oAscEDataValidationType.List),this.textSource),i=(t==Asc.c_oAscEDataValidationType.List?s=this.textSource:t==Asc.c_oAscEDataValidationType.Custom?s=this.textFormula:e==Asc.EDataValidationOperator.Equal||e==Asc.EDataValidationOperator.NotEqual?s=t==Asc.c_oAscEDataValidationType.Date?this.txtDate:t==Asc.c_oAscEDataValidationType.TextLength?this.txtLength:t==Asc.c_oAscEDataValidationType.Time?this.txtElTime:this.textCompare:e==Asc.EDataValidationOperator.GreaterThan||e==Asc.EDataValidationOperator.GreaterThanOrEqual?s=t==Asc.c_oAscEDataValidationType.Date?this.txtStartDate:t==Asc.c_oAscEDataValidationType.Time?this.txtStartTime:this.textMin:e!=Asc.EDataValidationOperator.LessThan&&e!=Asc.EDataValidationOperator.LessThanOrEqual||(s=t==Asc.c_oAscEDataValidationType.Date?this.txtEndDate:t==Asc.c_oAscEDataValidationType.Time?this.txtEndTime:this.textMax),this.lblRangeSource.text(s),this.textMin),e=this.textMax;t==Asc.c_oAscEDataValidationType.Date?(i=this.txtStartDate,e=this.txtEndDate):t==Asc.c_oAscEDataValidationType.Time&&(i=this.txtStartTime,e=this.txtEndTime),this.lblRangeMin.text(i),this.lblRangeMax.text(e)},isRangeValid:function(e){var i,s,o,n,a,l,t,r=this,c=(Asc.c_oAscError.ID.No,this.cmbAllow.getValue());c!==Asc.c_oAscEDataValidationType.None?(n=this._isMinMaxVisible,a=function(t){switch(t===Asc.c_oAscError.ID.No&&(t=r.props.asc_checkValid())!==Asc.c_oAscError.ID.No&&(i=n?r.inputRangeMin:r.inputRangeSource),t){case Asc.c_oAscError.ID.DataValidateNotNumeric:o=Common.Utils.String.format(r.errorNotNumeric,s.text());break;case Asc.c_oAscError.ID.DataValidateNegativeTextLength:o=Common.Utils.String.format(r.errorNegativeTextLength,r.cmbAllow.getDisplayValue(r.cmbAllow.getSelectedRecord()));break;case Asc.c_oAscError.ID.DataValidateMustEnterValue:o=n?Common.Utils.String.format(r.errorMustEnterBothValues,r.lblRangeMin.text(),r.lblRangeMax.text()):Common.Utils.String.format(r.errorMustEnterValue,r.lblRangeSource.text());break;case Asc.c_oAscError.ID.DataValidateMinGreaterMax:o=Common.Utils.String.format(r.errorMinGreaterMax,r.lblRangeMin.text(),r.lblRangeMax.text());break;case Asc.c_oAscError.ID.DataValidateInvalid:o=Common.Utils.String.format(c==Asc.c_oAscEDataValidationType.Time?r.errorInvalidTime:c==Asc.c_oAscEDataValidationType.Date?r.errorInvalidDate:r.errorInvalid,s.text());break;case Asc.c_oAscError.ID.NamedRangeNotFound:o=r.errorNamedRange;break;case Asc.c_oAscError.ID.DataValidateInvalidList:o=r.errorInvalidList}o&&Common.UI.warning({msg:o,maxwidth:600,callback:function(t){i.focus()}}),t===Asc.c_oAscError.ID.No&&e.call(r)},l=function(t){r._isMinMaxVisible&&t===Asc.c_oAscError.ID.No&&((t=r.api.asc_checkDataRange(Asc.c_oAscSelectionDialogType.DataValidation,r.props.asc_getFormula2()?r.props.asc_getFormula2().asc_getValue():null,!0,void 0,c))!==Asc.c_oAscError.ID.No&&(i=r.inputRangeMax,s=r.lblRangeMax),t===Asc.c_oAscError.ID.FormulaEvaluateError)?Common.UI.warning({msg:r.errorFormula,maxwidth:600,buttons:["yes","no"],primary:"yes",callback:function(t){"yes"==t?a(Asc.c_oAscError.ID.No):i.focus()}}):a(t)},(t=this.api.asc_checkDataRange(Asc.c_oAscSelectionDialogType.DataValidation,this.props.asc_getFormula1()?this.props.asc_getFormula1().asc_getValue():null,!0,void 0,c))!==Asc.c_oAscError.ID.No&&(i=n?r.inputRangeMin:r.inputRangeSource,s=n?r.lblRangeMin:r.lblRangeSource),t===Asc.c_oAscError.ID.FormulaEvaluateError?Common.UI.warning({msg:this.errorFormula,maxwidth:600,buttons:["yes","no"],primary:"yes",callback:function(t){"yes"==t?l(Asc.c_oAscError.ID.No):i.focus()}}):l(t)):e.call(r)}},SSE.Views.DataValidationDialog||{}))}),define("spreadsheeteditor/main/app/view/ExternalLinksDlg",["common/main/lib/view/AdvancedSettingsWindow","common/main/lib/component/ListView"],function(){"use strict";SSE.Views=SSE.Views||{},SSE.Views.ExternalLinksDlg=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{alias:"ExternalLinksDlg",contentWidth:450,height:294,buttons:null},initialize:function(t){_.extend(this.options,{title:this.txtTitle,template:['<div class="box" style="height:'+(this.options.height-85)+'px;">','<div class="content-panel" style="padding: 0;"><div class="inner-content">','<div class="settings-panel active">','<table cols="1" style="width: 100%;">',"<tr>",'<td class="padding-large">','<div id="external-links-btn-update" class="float-left margin-right-5"></div>','<div id="external-links-btn-change" class="float-left margin-right-5"></div>','<div id="external-links-btn-open" class="float-left margin-right-5"></div>','<div id="external-links-btn-delete" class="float-left"></div>',"</td>","</tr>","<tr>",'<td class="padding-small">','<div id="external-links-list" class="range-tableview" style="width:100%; height: 171px;"></div>',"</td>","</tr>","</table>","</div></div>","</div>","</div>",'<div class="footer center">','<button class="btn normal dlg-btn" result="cancel" style="width: 86px;">'+this.closeButtonText+"</button>","</div>"].join("")},t),this.api=t.api,this.handler=t.handler,this.isUpdating=t.isUpdating||!1,this.canRequestReferenceData=t.canRequestReferenceData||!1,this.canRequestOpen=t.canRequestOpen||!1,this.canRequestReferenceSource=t.canRequestReferenceSource||!1,this.isOffline=t.isOffline||!1,this.linkStatus=[],this.wrapEvents={onUpdateExternalReferenceList:_.bind(this.refreshList,this)},Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);this.linksList=new Common.UI.ListView({el:$("#external-links-list",this.$window),store:new Common.UI.DataViewStore,simpleAddMode:!0,headers:[{name:this.textSource,width:240},{name:this.textStatus,width:175}],itemTemplate:_.template(['<div id="<%= id %>" class="list-item" style="width: 100%;display:inline-block;">','<div class="padding-right-5" style="width:240px;" data-toggle="tooltip"><%= value %></div>','<div style="width:175px;" data-toggle="tooltip"><%= status %></div>',"</div>"].join("")),tabindex:1}),this.linksList.on("item:add",_.bind(this.addTooltips,this)),this.linksList.on("item:change",_.bind(this.addTooltips,this)),this.linksList.on("reset:before",_.bind(this.resetItemsBefore,this)),this.btnUpdate=new Common.UI.Button({parentEl:$("#external-links-btn-update",this.$window),cls:"btn-text-split-default auto",caption:this.textUpdate,split:!0,visible:!!this.canRequestReferenceData,menu:new Common.UI.Menu({style:"min-width:100px;",items:[{caption:this.textUpdate,value:0},{caption:this.textUpdateAll,value:1}]})});var t=$(this.btnUpdate.cmpEl.find("button")[0]);t.css("min-width",Math.max(87,t.outerWidth())+"px"),this.btnUpdate.on("click",_.bind(this.onUpdate,this)),this.btnUpdate.menu.on("item:click",_.bind(this.onUpdateMenu,this)),this.btnDelete=new Common.UI.Button({parentEl:$("#external-links-btn-delete",this.$window),cls:"btn-text-split-default auto",caption:this.textDelete,split:!0,menu:new Common.UI.Menu({style:"min-width:100px;",items:[{caption:this.textDelete,value:0},{caption:this.textDeleteAll,value:1}]})}),$(this.btnDelete.cmpEl.find("button")[0]).css("min-width","87px"),this.btnDelete.on("click",_.bind(this.onDelete,this)),this.btnDelete.menu.on("item:click",_.bind(this.onDeleteMenu,this)),this.btnOpen=new Common.UI.Button({parentEl:$("#external-links-btn-open",this.$window),cls:"btn-text-default auto",caption:this.textOpen,visible:!!this.canRequestOpen}),this.btnOpen.on("click",_.bind(this.onOpen,this)),this.btnChange=new Common.UI.Button({parentEl:$("#external-links-btn-change",this.$window),cls:"btn-text-default auto",caption:this.textChange,visible:!!this.canRequestReferenceSource}),this.btnChange.on("click",_.bind(this.onChange,this)),this.afterRender()},afterRender:function(){this._setDefaults(),this.api.asc_registerCallback("asc_onUpdateExternalReferenceList",this.wrapEvents.onUpdateExternalReferenceList),this.isUpdating&&this.setIsUpdating(this.isUpdating,!0)},getFocusedComponents:function(){return[this.btnUpdate,this.btnChange,this.btnOpen,this.btnDelete,this.linksList]},close:function(){this.api.asc_unregisterCallback("asc_onUpdateExternalReferenceList",this.wrapEvents.onUpdateExternalReferenceList),Common.Views.AdvancedSettingsWindow.prototype.close.call(this)},getDefaultFocusableComponent:function(){return this.linksList},_setDefaults:function(t){this.refreshList()},refreshList:function(){var t=[],e=this.api.asc_getExternalReferences();if(e)for(var i=0;i<e.length;i++)t.push({linkid:e[i].asc_getId(),value:(e[i].asc_getSource()||"").replace(new RegExp("%20","g")," "),idx:i,externalRef:e[i],status:this.linkStatus[e[i].asc_getId()]||this.textUnknown});this.linksList.store.reset(t),0<this.linksList.store.length&&this.linksList.selectByIndex(0),this.updateButtons()},onUpdate:function(){var t;this.isUpdating||(t=this.linksList.getSelectedRec())&&(this.isOffline&&this.setLinkStatus(t.get("linkid"),this.textOk),this.api.asc_updateExternalReferences([t.get("externalRef")]))},onUpdateMenu:function(t,e){var i,s;this.isUpdating||(1==e.value?(i=[],(s=this).linksList.store.each(function(t){i.push(t.get("externalRef")),s.isOffline&&s.setLinkStatus(t.get("linkid"),s.textOk)},this),0<i.length&&this.api.asc_updateExternalReferences(i)):this.onUpdate())},onDelete:function(){var t;this.isUpdating||((t=this.linksList.getSelectedRec())&&this.api.asc_removeExternalReferences([t.get("externalRef")]),this.refreshList())},onDeleteMenu:function(t,e){var i;this.isUpdating||(1==e.value?(i=[],this.linksList.store.each(function(t){i.push(t.get("externalRef"))},this),0<i.length&&this.api.asc_removeExternalReferences(i),this.refreshList()):this.onDelete())},onOpen:function(){var t=this.linksList.getSelectedRec();if(t){var e=this.api.asc_openExternalReference(t.get("externalRef"));if(e){switch(e.asc_getType()){case Asc.c_oAscExternalReferenceType.link:e={link:e.asc_getData()};break;case Asc.c_oAscExternalReferenceType.path:e={path:e.asc_getData()};break;case Asc.c_oAscExternalReferenceType.referenceData:e={referenceData:e.asc_getData(),path:e.asc_getPath()}}e.windowName="wname-"+Date.now(),window.open("",e.windowName),Common.Gateway.requestOpen(e)}}},onChange:function(){var t=this.linksList.getSelectedRec();t&&(this.isOffline?this.api.asc_changeExternalReference(t.get("externalRef")):this.fireEvent("change:source",this,t.get("externalRef")))},updateButtons:function(){var t=0<this.linksList.store.length&&!!this.linksList.getSelectedRec();this.btnUpdate.setDisabled(!t||this.isUpdating),this.btnDelete.setDisabled(!t||this.isUpdating),this.btnOpen.setDisabled(!t||this.isUpdating),this.btnChange.setDisabled(!t||this.isUpdating)},setIsUpdating:function(t,e){var i;e=e||!t,!(this.isUpdating=t)&&this.timerId&&(clearTimeout(this.timerId),this.timerId=0),e?(this.updateButtons(),this.btnUpdate.setCaption(t?this.textUpdating:this.textUpdate)):this.timerId||((i=this).timerId=setTimeout(function(){i.updateButtons(),i.btnUpdate.setCaption(t?i.textUpdating:i.textUpdate)},500)),t||this.refreshList()},setLinkStatus:function(t,e){t&&(this.linkStatus[t]=e||this.textOk)},resetItemsBefore:function(t){t.dataViewItems&&_.each(t.dataViewItems,function(t){t.tipsArray&&t.tipsArray.forEach(function(t){t&&(void 0===t.dontShow&&(t.dontShow=!0),t.tip().remove())})},this)},addTooltips:function(t,e,i){e.tipsArray&&e.tipsArray.forEach(function(t){t&&(void 0===t.dontShow&&(t.dontShow=!0),t.tip().remove())});var s=document.createElement("span"),o=(s.style.fontSize=document.documentElement.style.getPropertyValue("--font-size-base-app-custom")||"11px",s.style.fontFamily=document.documentElement.style.getPropertyValue("--font-family-base-custom")||'Arial, Helvetica, "Helvetica Neue", sans-serif',s.style.position="absolute",s.style.top="-1000px",s.style.left="-1000px",document.body.appendChild(s),$(e.el).find(".list-item > div"));this.checkTextOfItem(s,e,$(o[0]),i.get("value"),this.linksList.options.headers[0].width),this.checkTextOfItem(s,e,$(o[1]),i.get("status"),this.linksList.options.headers[1].width),document.body.removeChild(s),e.tipsArray=[]},checkTextOfItem:function(t,e,i,s,o){t.innerHTML=s;var n=this.linksList;t.offsetWidth>o&&i.one("mouseenter",function(t){t=$(t.target);t.tooltip({title:s,placement:"cursor",zIndex:n.tipZIndex}),t.mouseenter(),e.tipsArray.push(t.data("bs.tooltip"))})}},SSE.Views.ExternalLinksDlg||{}))}),define("spreadsheeteditor/main/app/view/ImportFromXmlDialog",["common/main/lib/util/utils","common/main/lib/component/InputField","common/main/lib/component/RadioBox","common/main/lib/view/AdvancedSettingsWindow"],function(){"use strict";SSE.Views.ImportFromXmlDialog=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:310,height:200},initialize:function(i){_.extend(this.options,{title:this.textTitle,template:['<div class="box" style="height:'+(this.options.height-85)+'px;">','<div class="content-panel" style="padding: 0 10px;"><div class="inner-content">','<div class="settings-panel active">','<table cols="1" style="width: 100%;">',"<tr>",'<td class="padding-small">','<label class="input-label">'+this.textDestination+"</label>","</td>","</tr>","<tr>",'<td class="padding-small">','<div id="import-xml-radio-new"></div>',"</td>","</tr>","<tr>",'<td class="padding-small">','<div id="import-xml-radio-exist"></div>',"</td>","</tr>","<tr>",'<td class="padding-left-22">','<div id="import-xml-input-dest" class="input-row" style=""></div>',"</td>","</tr>","</table>","</div></div>","</div>","</div>"].join("")},i),this.api=i.api,this.options.handler=function(t,e){if("ok"==t&&!this.isRangeValid())return!0;i.handler&&i.handler.call(this,t,e)},this.dataDestValid="",Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var i=this;this.txtDestRange=new Common.UI.InputFieldBtn({el:$("#import-xml-input-dest"),name:"range",style:"width: 100%;",btnHint:this.textSelectData,allowBlank:!0,validateOnChange:!0,validateOnBlur:!1}),this.txtDestRange.on("button:click",_.bind(this.onSelectData,this,"dest")),this.radioNew=new Common.UI.RadioBox({el:$("#import-xml-radio-new"),labelText:this.textNew,name:"asc-radio-xml-dest"}).on("change",function(t,e){i.txtDestRange.setDisabled(e),i.txtDestRange.showError()}),this.radioExist=new Common.UI.RadioBox({el:$("#import-xml-radio-exist"),labelText:this.textExist,name:"asc-radio-xml-dest",checked:!0}).on("change",function(t,e){i.txtDestRange.setDisabled(!e),i.txtDestRange.cmpEl.find("input").focus()}),this.afterRender()},getFocusedComponents:function(){return[this.radioNew,this.radioExist,this.txtDestRange]},getDefaultFocusableComponent:function(){if(!this._alreadyRendered)return this._alreadyRendered=!0,this.txtDestRange},afterRender:function(){this._setDefaults()},_setDefaults:function(){var e=this,t=(this.txtDestRange.validation=function(t){return e.api.asc_checkDataRange(Asc.c_oAscSelectionDialogType.ImportXml,t,!1)!=Asc.c_oAscError.ID.DataRangeError||e.textInvalidRange},this.api.asc_getActiveRangeStr(Asc.referenceType.A));this.txtDestRange.setValue(t),this.dataDestValid=t},getSettings:function(){return{destination:this.radioExist.getValue()?this.txtDestRange.getValue():null}},isRangeValid:function(){var t=!0,e="";return this.radioExist.getValue()&&(_.isEmpty(this.txtDestRange.getValue())?(t=!1,e=this.txtEmpty):(t=(t=this.api.asc_checkDataRange(Asc.c_oAscSelectionDialogType.ImportXml,this.txtDestRange.getValue()))==Asc.c_oAscError.ID.No)||(e=this.textInvalidRange),t||(this.txtDestRange.showError([e]),this.txtDestRange.cmpEl.find("input").focus())),t},onSelectData:function(t){var e,i,s=this,o=s.txtDestRange;s.api&&(e=new SSE.Views.CellRangeDialog({handler:function(t,e){"ok"==e&&(e=t.getSettings(),s.dataDestValid=e,o.setValue(e),o.checkValidate())}}).on("close",function(){s.show(),_.delay(function(){o.focus()},1)}),i=s.$window.offset(),s.hide(),e.show(i.left+160,i.top+125),e.setSettings({api:s.api,range:_.isEmpty(o.getValue())||1!=o.checkValidate()?s.dataDestValid:o.getValue(),type:Asc.c_oAscSelectionDialogType.ImportXml}))}},SSE.Views.ImportFromXmlDialog||{}))}),define("spreadsheeteditor/main/app/controller/DataTab",["core","spreadsheeteditor/main/app/view/DataTab","spreadsheeteditor/main/app/view/SortDialog","spreadsheeteditor/main/app/view/RemoveDuplicatesDialog","spreadsheeteditor/main/app/view/DataValidationDialog","spreadsheeteditor/main/app/view/ExternalLinksDlg","spreadsheeteditor/main/app/view/ImportFromXmlDialog","common/main/lib/view/OptionsDialog"],function(){"use strict";SSE.Controllers.DataTab=Backbone.Controller.extend(_.extend({models:[],collections:[],views:["DataTab"],sdkViewName:"#id_main",initialize:function(){this._state={CSVOptions:new Asc.asc_CTextOptions(0,4,"")},this.externalData={stackRequests:[],stackResponse:[],callback:void 0,isUpdating:!1,linkStatus:{}},this.externalSource={externalRef:void 0}},onLaunch:function(){},setApi:function(t){return t&&(this.api=t,this.api.asc_registerCallback("asc_onSelectionChanged",_.bind(this.onSelectionChanged,this)),this.api.asc_registerCallback("asc_onWorksheetLocked",_.bind(this.onWorksheetLocked,this)),this.api.asc_registerCallback("asc_onChangeProtectWorkbook",_.bind(this.onChangeProtectWorkbook,this)),this.api.asc_registerCallback("asc_onCoAuthoringDisconnect",_.bind(this.onCoAuthoringDisconnect,this)),Common.NotificationCenter.on("api:disconnect",_.bind(this.onCoAuthoringDisconnect,this)),Common.NotificationCenter.on("protect:wslock",_.bind(this.onChangeProtectSheet,this)),Common.NotificationCenter.on("document:ready",_.bind(this.onDocumentReady,this))),this},setConfig:function(t){this.toolbar=t.toolbar,this.view=this.createView("DataTab",{toolbar:this.toolbar.toolbar}),this.addListeners({DataTab:{"data:group":this.onGroup,"data:ungroup":this.onUngroup,"data:tocolumns":this.onTextToColumn,"data:show":this.onShowClick,"data:hide":this.onHideClick,"data:groupsettings":this.onGroupSettings,"data:sortcustom":this.onCustomSort,"data:remduplicates":this.onRemoveDuplicates,"data:datavalidation":this.onDataValidation,"data:fromtext":this.onDataFromText,"data:externallinks":this.onExternalLinks},Statusbar:{"sheet:changed":this.onApiSheetChanged}}),Common.NotificationCenter.on("data:remduplicates",_.bind(this.onRemoveDuplicates,this)),Common.NotificationCenter.on("data:sortcustom",_.bind(this.onCustomSort,this)),(this.toolbar.mode.canRequestReferenceData||this.toolbar.mode.isOffline)&&this.api&&(this.api.asc_registerCallback("asc_onNeedUpdateExternalReferenceOnOpen",_.bind(this.onNeedUpdateExternalReferenceOnOpen,this)),this.api.asc_registerCallback("asc_onStartUpdateExternalReference",_.bind(this.onStartUpdateExternalReference,this)),this.api.asc_registerCallback("asc_onUpdateExternalReference",_.bind(this.onUpdateExternalReference,this)),this.api.asc_registerCallback("asc_onErrorUpdateExternalReference",_.bind(this.onErrorUpdateExternalReference,this)),this.api.asc_registerCallback("asc_onNeedUpdateExternalReference",_.bind(this.onNeedUpdateExternalReference,this)),Common.Gateway.on("setreferencedata",_.bind(this.setReferenceData,this))),this.toolbar.mode.canRequestReferenceSource&&Common.Gateway.on("setreferencesource",_.bind(this.setReferenceSource,this))},SetDisabled:function(t){this.view&&this.view.SetDisabled(t)},getView:function(t){return!t&&this.view?this.view:Backbone.Controller.prototype.getView.call(this,t)},onCoAuthoringDisconnect:function(){this.SetDisabled(!0)},onSelectionChanged:function(t){var e;this.toolbar.editMode&&this.view&&(e=this.view,Common.Utils.lockControls(Common.enumLock.multiselectCols,1<t.asc_getSelectedColsCount(),{array:[e.btnTextToColumns]}),Common.Utils.lockControls(Common.enumLock.multiselect,t.asc_getMultiselect(),{array:[e.btnTextToColumns]}),Common.Utils.lockControls(Common.enumLock.userProtected,t.asc_getUserProtected(),{array:e.lockedControls}))},onUngroup:function(t){var i=this;"rows"==t?void 0!==i.api.asc_checkAddGroup(!0)&&i.api.asc_ungroup(!0):"columns"==t?void 0!==i.api.asc_checkAddGroup(!0)&&i.api.asc_ungroup(!1):"clear"==t?i.api.asc_clearOutline():null===(t=i.api.asc_checkAddGroup(!0))?new Common.Views.OptionsDialog({title:i.view.capBtnUngroup,items:[{caption:this.textRows,value:!0,checked:!0},{caption:this.textColumns,value:!1,checked:!1}],handler:function(t,e){"ok"==e&&i.api.asc_ungroup(t.getSettings()),Common.NotificationCenter.trigger("edit:complete",i.toolbar)}}).show():void 0!==t&&i.api.asc_ungroup(t),Common.NotificationCenter.trigger("edit:complete",i.toolbar)},onGroup:function(t,e){var i;"rows"==t?void 0!==this.api.asc_checkAddGroup()&&this.api.asc_group(!0):"columns"==t?void 0!==this.api.asc_checkAddGroup()&&this.api.asc_group(!1):"below"==t?this.api.asc_setGroupSummary(e,!1):"right"==t?this.api.asc_setGroupSummary(e,!0):null===(t=(i=this).api.asc_checkAddGroup())?new Common.Views.OptionsDialog({title:i.view.capBtnGroup,items:[{caption:this.textRows,value:!0,checked:!0},{caption:this.textColumns,value:!1,checked:!1}],handler:function(t,e){"ok"==e&&i.api.asc_group(t.getSettings()),Common.NotificationCenter.trigger("edit:complete",i.toolbar)}}).show():void 0!==t&&i.api.asc_group(t),Common.NotificationCenter.trigger("edit:complete",this.toolbar)},onGroupSettings:function(t){var e=this.api.asc_getGroupSummaryBelow();t.items[3].setChecked(!!e,!0),e=this.api.asc_getGroupSummaryRight(),t.items[4].setChecked(!!e,!0)},onTextToColumn:function(){this.api.asc_TextImport(this._state.CSVOptions,_.bind(this.onTextToColumnCallback,this),!1)},onTextToColumnCallback:function(t){var i;t&&t.length&&new Common.Views.OpenDialog({title:(i=this).textWizard,closable:!0,type:Common.Utils.importTextType.Columns,preview:!0,previewData:t,settings:i._state.CSVOptions,api:i.api,handler:function(t,e){"ok"==t&&i.api&&i.api.asc_TextToColumns(e.textOptions)}}).show()},onDataFromText:function(t){var i=this;"file"===t?(this.api&&this.api.asc_TextFromFileOrUrl(this._state.CSVOptions,_.bind(this.onDataFromTextCallback,this)),Common.NotificationCenter.trigger("edit:complete",this.toolbar)):"url"===t?new Common.Views.ImageFromUrlDialog({title:i.txtUrlTitle,handler:function(t,e){"ok"==t&&(i.api&&(t=e.replace(/\s/g,""),_.isEmpty(t)?Common.UI.warning({msg:i.textEmptyUrl}):i.api.asc_TextFromFileOrUrl(i._state.CSVOptions,_.bind(i.onDataFromTextCallback,i),t)),Common.NotificationCenter.trigger("edit:complete",i.toolbar))}}).show():"storage"!==t&&"xml"===t&&(Common.Utils.InternalSettings.set("import-xml-start",!0),this.api&&this.api.asc_ImportXmlStart(_.bind(this.onDataFromXMLCallback,this)))},onDataFromTextCallback:function(t){var i=this;new Common.Views.OpenDialog({title:i.txtImportWizard,closable:!0,type:Common.Utils.importTextType.Data,preview:t.asc_getData(),settings:t?t.asc_getRecommendedSettings():i._state.CSVOptions,codepages:t?t.asc_getCodePages():null,api:i.api,handler:function(t,e){"ok"==t&&i.api&&i.api.asc_TextToColumns(e.textOptions,e.data,e.range)}}).show()},onDataFromXMLCallback:function(i){var s;setTimeout(function(){Common.Utils.InternalSettings.set("import-xml-start",!1)},500),i&&(s=this,new SSE.Views.ImportFromXmlDialog({api:s.api,handler:function(t,e){"ok"==t&&e&&(e.destination?s.api.asc_ImportXmlEnd(i,e.destination,s.api.asc_getWorksheetName(s.api.asc_getActiveWorksheetIndex())):s.api.asc_ImportXmlEnd(i,null,s.createSheetName())),Common.NotificationCenter.trigger("edit:complete",s)}}).show())},createSheetName:function(){for(var t=[],e=this.api.asc_getWorksheetsCount();e--;)t.push(this.api.asc_getWorksheetName(e).toLowerCase());for(var i,s=0;++s<1e3&&(i=this.strSheet+s,!(t.indexOf(i.toLowerCase())<0)););return i},onShowClick:function(){this.api.asc_changeGroupDetails(!0)},onHideClick:function(){this.api.asc_changeGroupDetails(!1)},onCustomSort:function(){Common.NotificationCenter.trigger("protect:check",this.onCustomSortCallback,this)},onCustomSortCallback:function(){var e=this;if(this.api){var t=this.api.asc_sortCellsRangeExpand();switch(t){case Asc.c_oAscSelectionSortExpand.showExpandMessage:var i={width:500,title:this.toolbar.txtSorting,msg:this.toolbar.txtExpandSort,buttons:[{caption:this.toolbar.txtExpand,primary:!0,value:"expand"},{caption:this.toolbar.txtSortSelected,primary:!0,value:"sort"},"cancel"],callback:function(t){"expand"!=t&&"sort"!=t||setTimeout(function(){e.showCustomSort("expand"==t)},1)}};Common.UI.alert(i);break;case Asc.c_oAscSelectionSortExpand.showLockMessage:i={width:500,title:this.toolbar.txtSorting,msg:this.toolbar.txtLockSort,buttons:["yes","no"],primary:"yes",callback:function(t){"yes"==t&&setTimeout(function(){e.showCustomSort(!1)},1)}};Common.UI.alert(i);break;case Asc.c_oAscSelectionSortExpand.expandAndNotShowMessage:case Asc.c_oAscSelectionSortExpand.notExpandAndNotShowMessage:e.showCustomSort(t===Asc.c_oAscSelectionSortExpand.expandAndNotShowMessage)}}},showCustomSort:function(t){var e,i,s;this.api.asc_getCellInfo().asc_getPivotTableInfo()?(s=this.api.asc_getPivotInfo())&&((e=new SSE.Views.SortFilterDialog({api:this.api}).on({close:function(){Common.NotificationCenter.trigger("edit:complete")}})).setSettings({filter:s.asc_getFilter(),rowFilter:s.asc_getFilterRow(),colFilter:s.asc_getFilterCol()}),e.show()):(s=(i=this).api.asc_getSortProps(t))&&new SSE.Views.SortDialog({props:s,api:i.api,handler:function(t,e){i&&i.api&&i.api.asc_setSortProps(e,"ok"!=t)}}).show()},onRemoveDuplicates:function(){var t,e,i=this;this.api&&((t=this.api.asc_sortCellsRangeExpand())===Asc.c_oAscSelectionSortExpand.showExpandMessage?(e={width:500,title:this.txtRemDuplicates,msg:this.txtExpandRemDuplicates,buttons:[{caption:this.txtExpand,primary:!0,value:"expand"},{caption:this.txtRemSelected,primary:!0,value:"remove"},"cancel"],callback:function(t){"expand"!=t&&"remove"!=t||setTimeout(function(){i.showRemDuplicates("expand"==t)},1)}},Common.UI.alert(e)):t!==Asc.c_oAscSelectionSortExpand.showLockMessage&&i.showRemDuplicates(t===Asc.c_oAscSelectionSortExpand.expandAndNotShowMessage))},showRemDuplicates:function(t){var i=this,t=i.api.asc_getRemoveDuplicates(t);t&&new SSE.Views.RemoveDuplicatesDialog({props:t,api:i.api,handler:function(t,e){i&&i.api&&i.api.asc_setRemoveDuplicates(e,"ok"!=t)}}).show()},onDataValidation:function(){var t,e,i=this;this.api&&("object"!=typeof(t=this.api.asc_getDataValidationProps())?(e={maxwidth:500,title:this.txtDataValidation,msg:t===Asc.c_oAscError.ID.MoreOneTypeDataValidate?this.txtRemoveDataValidation:this.txtExtendDataValidation,buttons:t===Asc.c_oAscError.ID.MoreOneTypeDataValidate?["ok","cancel"]:["yes","no","cancel"],primary:t===Asc.c_oAscError.ID.MoreOneTypeDataValidate?"ok":["yes","no"],callback:function(e){"yes"!=e&&"no"!=e&&"ok"!=e||setTimeout(function(){var t=i.api.asc_getDataValidationProps("ok"==e?null:"yes"==e);i.showDataValidation(t)},1)}},Common.UI.alert(e)):i.showDataValidation(t))},showDataValidation:function(t){var i=this;t&&new SSE.Views.DataValidationDialog({title:this.txtDataValidation,props:t,api:i.api,handler:function(t,e){i&&i.api&&"ok"==t&&i.api.asc_setDataValidation(e)}}).show()},onExternalLinks:function(){var i=this;this.externalLinksDlg=new SSE.Views.ExternalLinksDlg({api:this.api,isUpdating:this.externalData.isUpdating,canRequestReferenceData:this.toolbar.mode.canRequestReferenceData||this.toolbar.mode.isOffline,canRequestOpen:this.toolbar.mode.canRequestOpen||this.toolbar.mode.isOffline,canRequestReferenceSource:this.toolbar.mode.canRequestReferenceSource||this.toolbar.mode.isOffline,isOffline:this.toolbar.mode.isOffline,handler:function(t){Common.NotificationCenter.trigger("edit:complete")}}),this.externalLinksDlg.on("close",function(t){i.externalLinksDlg=null}),this.externalLinksDlg.on("change:source",function(t,e){i.externalSource={externalRef:e},Common.Gateway.requestReferenceSource()}),this.externalLinksDlg.show()},onUpdateExternalReference:function(t,e){var i;this.toolbar.mode.isEdit&&this.toolbar.editMode&&((i=this).externalData={stackRequests:[],stackResponse:[],callback:void 0,isUpdating:!1,linkStatus:{}},t&&0<t.length&&t.forEach(function(t){var e;switch(t.asc_getType()){case Asc.c_oAscExternalReferenceType.link:e={link:t.asc_getData()};break;case Asc.c_oAscExternalReferenceType.path:e={path:t.asc_getData()};break;case Asc.c_oAscExternalReferenceType.referenceData:e={referenceData:t.asc_getData(),path:t.asc_getPath()}}e&&i.externalData.stackRequests.push({data:e,id:t.asc_getId(),isExternal:t.asc_isExternalLink()})}),i.externalData.callback=e,i.requestReferenceData())},requestReferenceData:function(){var t;0<this.externalData.stackRequests.length&&(t=this.externalData.stackRequests.shift(),this.externalData.linkStatus.id=t.id,this.externalData.linkStatus.isExternal=t.isExternal,Common.Gateway.requestReferenceData(t.data))},setReferenceData:function(t){this.toolbar.mode.isEdit&&this.toolbar.editMode&&(t&&(this.externalData.stackResponse.push(t),this.externalData.linkStatus.result=!this.externalData.linkStatus.isExternal&&t.error||"",this.externalLinksDlg&&this.externalLinksDlg.setLinkStatus(this.externalData.linkStatus.id,this.externalData.linkStatus.result)),0<this.externalData.stackRequests.length?this.requestReferenceData():this.externalData.callback&&this.externalData.callback(this.externalData.stackResponse))},onStartUpdateExternalReference:function(t){this.externalData.isUpdating=t,this.externalLinksDlg&&this.externalLinksDlg.setIsUpdating(t)},onNeedUpdateExternalReferenceOnOpen:function(){Common.UI.warning({msg:this.warnUpdateExternalData,buttons:[{value:"ok",caption:this.textUpdate,primary:!0},{value:"cancel",caption:this.textDontUpdate}],maxwidth:600,callback:_.bind(function(t){"ok"===t&&(t=this.api.asc_getExternalReferences())&&0<t.length&&this.api.asc_updateExternalReferences(t)},this)})},onErrorUpdateExternalReference:function(t){this.externalLinksDlg&&this.externalLinksDlg.setLinkStatus(t,this.txtErrorExternalLink)},onNeedUpdateExternalReference:function(){Common.NotificationCenter.trigger("showmessage",{msg:this.textAddExternalData})},setReferenceSource:function(t){this.toolbar.mode.isEdit&&this.toolbar.editMode&&this.api.asc_changeExternalReference(this.externalSource.externalRef,t)},onWorksheetLocked:function(t,e){t==this.api.asc_getActiveWorksheetIndex()&&Common.Utils.lockControls(Common.enumLock.sheetLock,e,{array:this.view.btnsSortDown.concat(this.view.btnsSortUp,this.view.btnCustomSort,this.view.btnGroup,this.view.btnUngroup)})},onChangeProtectWorkbook:function(){Common.Utils.lockControls(Common.enumLock.wbLock,this.api.asc_isProtectedWorkbook(),{array:[this.view.btnDataFromText,this.view.btnExternalLinks]})},onApiSheetChanged:function(){var t;!this.toolbar.mode||!this.toolbar.mode.isEdit||this.toolbar.mode.isEditDiagram||this.toolbar.mode.isEditMailMerge||this.toolbar.mode.isEditOle||(t=this.api.asc_getActiveWorksheetIndex(),this.onWorksheetLocked(t,this.api.asc_isWorksheetLockedOrDeleted(t)))},onChangeProtectSheet:function(t){var e;(t=t?t:(e=this.getApplication().getController("WBProtection"))?e.getWSProps():null)&&t.wsProps&&Common.Utils.lockControls(Common.enumLock.Sort,t.wsProps.Sort,{array:this.view.btnsSortDown.concat(this.view.btnsSortUp,this.view.btnCustomSort)})},onDocumentReady:function(){this.onChangeProtectSheet()}},SSE.Controllers.DataTab||{}))}),define("spreadsheeteditor/main/app/view/ViewTab",["common/main/lib/util/utils","common/main/lib/component/BaseView","common/main/lib/component/Layout"],function(){"use strict";SSE.Views.ViewTab=Common.UI.BaseView.extend(_.extend({options:{},initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this),this.toolbar=t.toolbar,this.appConfig=t.mode,this.lockedControls=[];var e=Common.enumLock;this.appConfig.canFeatureViews&&this.appConfig.isEdit&&(this.btnSheetView=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-sheet-view",caption:this.capBtnSheetView,lock:[e.lostConnect,e.coAuth,e.editCell],menu:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.lockedControls.push(this.btnSheetView),this.btnCreateView=new Common.UI.Button({id:"id-toolbar-btn-createview",cls:"btn-toolbar",iconCls:"toolbar__icon btn-sheet-view-new",caption:this.textCreate,lock:[e.coAuth,e.lostConnect,e.editCell],dataHint:"1",dataHintDirection:"left",dataHintOffset:"big"}),this.lockedControls.push(this.btnCreateView),this.btnCloseView=new Common.UI.Button({id:"id-toolbar-btn-closeview",cls:"btn-toolbar",iconCls:"toolbar__icon btn-sheet-view-close",caption:this.textClose,lock:[e.sheetView,e.coAuth,e.lostConnect,e.editCell],dataHint:"1",dataHintDirection:"left",dataHintOffset:"big"}),this.lockedControls.push(this.btnCloseView)),this.appConfig.isEdit&&(this.btnFreezePanes=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-freeze-panes",caption:this.capBtnFreeze,menu:!0,lock:[e.sheetLock,e.lostConnect,e.coAuth,e.editCell],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.lockedControls.push(this.btnFreezePanes),this.chHeadings=new Common.UI.CheckBox({labelText:this.textHeadings,lock:[e.sheetLock,e.lostConnect,e.coAuth,e.editCell],dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.lockedControls.push(this.chHeadings),this.chGridlines=new Common.UI.CheckBox({labelText:this.textGridlines,lock:[e.sheetLock,e.lostConnect,e.coAuth,e.editCell],dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.lockedControls.push(this.chGridlines),this.chZeros=new Common.UI.CheckBox({labelText:this.textZeros,lock:[e.sheetLock,e.lostConnect,e.coAuth,e.editCell],dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.lockedControls.push(this.chZeros),this.btnViewNormal=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-normal-view",enableToggle:!0,allowDepress:!1,caption:this.txtViewNormal,lock:[e.sheetLock,e.lostConnect,e.coAuth,e.editCell],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.lockedControls.push(this.btnViewNormal),this.btnViewPageBreak=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-page-break-preview",enableToggle:!0,allowDepress:!1,caption:this.txtViewPageBreak,lock:[e.sheetLock,e.lostConnect,e.coAuth,e.editCell],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.lockedControls.push(this.btnViewPageBreak)),this.cmbZoom=new Common.UI.ComboBox({cls:"input-group-nr",menuStyle:"min-width: 55px;",hint:this.tipFontSize,editable:!0,lock:[e.lostConnect,e.editCell],data:[{displayValue:"50%",value:50},{displayValue:"75%",value:75},{displayValue:"100%",value:100},{displayValue:"125%",value:125},{displayValue:"150%",value:150},{displayValue:"175%",value:175},{displayValue:"200%",value:200},{displayValue:"300%",value:300},{displayValue:"400%",value:400},{displayValue:"500%",value:500}],dataHint:"1",dataHintDirection:"top",dataHintOffset:"small"}),this.lockedControls.push(this.cmbZoom),this.btnInterfaceTheme=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-day",caption:this.textInterfaceTheme,menu:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.lockedControls.push(this.btnInterfaceTheme),this.chFormula=new Common.UI.CheckBox({labelText:this.textFormula,value:!Common.localStorage.getBool("sse-hidden-formula"),lock:[e.lostConnect,e.editCell],dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.lockedControls.push(this.chFormula),this.chStatusbar=new Common.UI.CheckBox({labelText:this.textCombineSheetAndStatusBars,value:Common.localStorage.getBool("sse-compact-statusbar",!0),lock:[e.lostConnect,e.editCell],dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.lockedControls.push(this.chStatusbar),this.chToolbar=new Common.UI.CheckBox({labelText:this.textAlwaysShowToolbar,value:!t.compactToolbar,lock:[e.lostConnect,e.editCell],dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.lockedControls.push(this.chToolbar),this.chRightMenu=new Common.UI.CheckBox({lock:[e.lostConnect],labelText:this.textRightMenu,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.lockedControls.push(this.chRightMenu),this.chLeftMenu=new Common.UI.CheckBox({lock:[e.lostConnect],labelText:this.textLeftMenu,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.lockedControls.push(this.chLeftMenu),Common.NotificationCenter.on("app:ready",this.onAppReady.bind(this))},render:function(t){return t&&t.html(this.getPanel()),this},getPanel:function(){this.$el=$(_.template('<section class="panel" data-tab="view"><div class="group sheet-views"><span class="btn-slot text x-huge" id="slot-btn-sheet-view"></span></div><div class="group sheet-views small"><div class="elset"><span class="btn-slot text" id="slot-createview"></span></div><div class="elset"><span class="btn-slot text" id="slot-closeview"></span></div></div><div class="separator long sheet-views"></div><div class="group doc-preview"><span class="btn-slot text x-huge" id="slot-btn-view-normal"></span><span class="btn-slot text x-huge" id="slot-btn-view-pagebreak"></span></div><div class="separator long doc-preview"></div><div class="group small"><div class="elset" style="display: flex;"><span class="btn-slot" id="slot-field-zoom" style="flex-grow: 1;"></span></div><div class="elset" style="text-align: center;"><span class="btn-slot text font-size-normal" id="slot-lbl-zoom" style="text-align: center;margin-top: 4px;"></span></div></div><div class="separator long"></div><div class="group"><span class="btn-slot text x-huge" id="slot-btn-interface-theme"></span></div><div class="separator long separator-theme"></div><div class="group sheet-freeze"><span class="btn-slot text x-huge" id="slot-btn-freeze"></span></div><div class="separator long sheet-freeze"></div><div class="group small sheet-formula"><div class="elset"><span class="btn-slot text" id="slot-chk-formula"></span></div><div class="elset"><span class="btn-slot text" id="slot-chk-heading"></span></div></div><div class="group small sheet-gridlines"><div class="elset"><span class="btn-slot text" id="slot-chk-gridlines"></span></div><div class="elset"><span class="btn-slot text" id="slot-chk-zeros"></span></div></div><div class="separator long separator-formula"></div><div class="group small"><div class="elset"><span class="btn-slot text" id="slot-chk-toolbar"></span></div><div class="elset"><span class="btn-slot text" id="slot-chk-statusbar"></span></div></div><div class="group small"><div class="elset"><span class="btn-slot text" id="slot-chk-leftmenu"></span></div><div class="elset"><span class="btn-slot text" id="slot-chk-rightmenu"></span></div></div></section>')({}));var t=this.$el;return this.btnSheetView&&this.btnSheetView.render(t.find("#slot-btn-sheet-view")),this.btnCreateView&&this.btnCreateView.render(t.find("#slot-createview")),this.btnCloseView&&this.btnCloseView.render(t.find("#slot-closeview")),this.btnFreezePanes&&this.btnFreezePanes.render(t.find("#slot-btn-freeze")),this.cmbZoom.render(t.find("#slot-field-zoom")),this.cmbZoom.setValue(100),t.find("#slot-lbl-zoom").text(this.textZoom),this.btnInterfaceTheme.render(t.find("#slot-btn-interface-theme")),this.chFormula.render(t.find("#slot-chk-formula")),this.chStatusbar.render(t.find("#slot-chk-statusbar")),this.chToolbar.render(t.find("#slot-chk-toolbar")),this.chHeadings&&this.chHeadings.render(t.find("#slot-chk-heading")),this.chGridlines&&this.chGridlines.render(t.find("#slot-chk-gridlines")),this.chZeros&&this.chZeros.render(t.find("#slot-chk-zeros")),this.chLeftMenu.render(t.find("#slot-chk-leftmenu")),this.chRightMenu.render(t.find("#slot-chk-rightmenu")),this.btnViewNormal&&this.btnViewNormal.render(t.find("#slot-btn-view-normal")),this.btnViewPageBreak&&this.btnViewPageBreak.render(t.find("#slot-btn-view-pagebreak")),this.$el},onAppReady:function(i){var s=this;new Promise(function(t,e){t()}).then(function(){i.canFeatureViews&&s.appConfig.isEdit?(s.btnSheetView.updateHint(s.tipSheetView),s.setButtonMenu(s.btnSheetView),s.btnCreateView.updateHint(s.tipCreate),s.btnCloseView.updateHint(s.tipClose)):(s.toolbar&&s.toolbar.$el.find(".group.sheet-views").hide(),s.toolbar&&s.toolbar.$el.find(".separator.sheet-views").hide()),s.btnInterfaceTheme.updateHint(s.tipInterfaceTheme),i.isEdit?(s.btnFreezePanes.setMenu(new Common.UI.Menu({items:[{caption:s.toolbar&&s.toolbar.api&&s.toolbar.api.asc_getSheetViewSettings().asc_getIsFreezePane()?s.textUnFreeze:s.capBtnFreeze,value:void 0},{caption:s.textFreezeRow,value:Asc.c_oAscFrozenPaneAddType.firstRow},{caption:s.textFreezeCol,value:Asc.c_oAscFrozenPaneAddType.firstCol},{caption:"--"},{caption:s.textShowFrozenPanesShadow,value:"shadow",checkable:!0,checked:Common.localStorage.getBool("sse-freeze-shadow",!0)}]})),s.btnFreezePanes.updateHint(s.tipFreeze),s.btnViewNormal.updateHint(s.tipViewNormal),s.btnViewPageBreak.updateHint(s.tipViewPageBreak)):(s.toolbar&&s.toolbar.$el.find(".group.doc-preview").hide(),s.toolbar&&s.toolbar.$el.find(".separator.doc-preview").hide(),s.toolbar&&s.toolbar.$el.find(".group.sheet-freeze").hide(),s.toolbar&&s.toolbar.$el.find(".separator.sheet-freeze").hide(),s.toolbar&&s.toolbar.$el.find(".group.sheet-gridlines").hide()),Common.UI.Themes.available()||(s.btnInterfaceTheme.$el.closest(".group").remove(),s.$el.find(".separator-theme").remove());var t=[];function e(){var t,e=this.btnInterfaceTheme,i=("object"==typeof e.menu?e.menu.removeAll():e.setMenu(new Common.UI.Menu),Common.UI.Themes.currentThemeId()||Common.UI.Themes.defaultThemeId());for(t in Common.UI.Themes.map())e.menu.addItem({value:t,caption:Common.UI.Themes.get(t).text,checked:t===i,checkable:!0,toggleGroup:"interface-theme"})}(i.canBrandingExt&&i.customization&&!1===i.customization.statusBar||!Common.UI.LayoutManager.isElementVisible("statusBar"))&&(t.push(s.chStatusbar.$el.closest(".elset")),s.chStatusbar.$el.remove()),i.canBrandingExt&&i.customization&&!1===i.customization.leftMenu||!Common.UI.LayoutManager.isElementVisible("leftMenu")?(t.push(s.chLeftMenu.$el.closest(".elset")),s.chLeftMenu.$el.remove()):0<t.length&&(t.push(s.chLeftMenu.$el.closest(".elset")),t.shift().append(s.chLeftMenu.$el[0])),!i.isEdit||i.canBrandingExt&&i.customization&&!1===i.customization.rightMenu||!Common.UI.LayoutManager.isElementVisible("rightMenu")?(t.push(s.chRightMenu.$el.closest(".elset")),s.chRightMenu.$el.remove()):0<t.length&&(t.push(s.chRightMenu.$el.closest(".elset")),t.shift().append(s.chRightMenu.$el[0])),1<t.length&&t[t.length-1].closest(".group").remove(),Common.UI.Themes.available()&&(Common.NotificationCenter.on("uitheme:countchanged",e.bind(s)),e.call(s),s.btnInterfaceTheme.menu.items.length&&s.btnInterfaceTheme.menu.on("item:click",_.bind(function(t,e){e=e.value;Common.UI.Themes.setTheme(e)},s)));t=Common.UI.LayoutManager.getInitValue("leftMenu");s.chLeftMenu.setValue(!Common.localStorage.getBool("sse-hidden-leftmenu",void 0!==t&&!t)),t=Common.UI.LayoutManager.getInitValue("rightMenu"),s.chRightMenu.setValue(!Common.localStorage.getBool("sse-hidden-rightmenu",void 0!==t&&!t)),function(){var s=this;s.appConfig.canFeatureViews&&s.appConfig.isEdit&&(s.btnCloseView.on("click",function(t,e){s.fireEvent("viewtab:openview",[{name:"default",value:"default"}])}),s.btnCreateView.on("click",function(t,e){s.fireEvent("viewtab:createview")})),s.btnFreezePanes&&s.btnFreezePanes.menu.on("item:click",function(t,e,i){"shadow"===e.value?s.fireEvent("viewtab:freezeshadow",[e.checked]):s.fireEvent("viewtab:freeze",[e.value])}),this.chFormula.on("change",function(t,e){s.fireEvent("viewtab:formula",[0,"checked"==e])}),this.chHeadings&&this.chHeadings.on("change",function(t,e){s.fireEvent("viewtab:headings",[1,"checked"==e])}),this.chGridlines&&this.chGridlines.on("change",function(t,e){s.fireEvent("viewtab:gridlines",[2,"checked"==e])}),this.chZeros&&this.chZeros.on("change",function(t,e){s.fireEvent("viewtab:zeros",[3,"checked"==e])}),this.chToolbar.on("change",function(t,e){s.fireEvent("viewtab:showtoolbar",[t,"checked"!==e])}),this.chStatusbar.on("change",function(t,e){s.fireEvent("statusbar:setcompact",[t,"checked"===e])}),this.cmbZoom.on("selected",function(t,e){s.fireEvent("zoom:selected",[t,e])}).on("changed:before",function(t,e){s.fireEvent("zoom:changedbefore",[!0,t,e])}).on("changed:after",function(t,e){s.fireEvent("zoom:changedafter",[!1,t,e])}).on("combo:blur",function(){s.fireEvent("editcomplete",s)}).on("combo:focusin",_.bind(this.onComboOpen,this,!1)).on("show:after",_.bind(this.onComboOpen,this,!0)),s.chLeftMenu.on("change",_.bind(function(t,e){s.fireEvent("leftmenu:hide",[s.chLeftMenu,"checked"===e])},s)),s.chRightMenu.on("change",_.bind(function(t,e){s.fireEvent("rightmenu:hide",[s.chRightMenu,"checked"===e])},s)),s.btnViewNormal&&s.btnViewNormal.on("click",function(t,e){t.pressed&&s.fireEvent("viewtab:viewmode",[Asc.c_oAscESheetViewType.normal])}),s.btnViewPageBreak&&s.btnViewPageBreak.on("click",function(t,e){t.pressed&&s.fireEvent("viewtab:viewmode",[Asc.c_oAscESheetViewType.pageBreakPreview])})}.call(s)})},setButtonMenu:function(t){var o=this,e=[{caption:o.textDefault,value:"default",checkable:!0,allowDepress:!1}],e=(t.setMenu(new Common.UI.Menu({items:[{template:_.template('<div id="id-toolbar-sheet-view-menu-" style="display: flex;" class="open"></div>')},{caption:"--"},{caption:o.textManager,value:"manager"}]})),t.menu.items[2].on("click",function(t,e){o.fireEvent("viewtab:manager")}),t.menu.on("show:after",function(t,e){t._innerMenu.scroller.update({alwaysVisibleY:!0}),_.delay(function(){t._innerMenu&&t._innerMenu.cmpEl.focus()},10)}).on("show:before",function(t,e){o.fireEvent("viewtab:showview")}),new Common.UI.Menu({maxHeight:300,cls:"internal-menu",items:e,outerMenu:{menu:t.menu,index:0}}));e.render(t.menu.items[0].cmpEl.children(":first")),e.cmpEl.css({display:"block",position:"relative",left:0,top:0}),e.cmpEl.attr({tabindex:"-1"}),e.on("item:toggle",function(t,e,i,s){i&&o.fireEvent("viewtab:openview",[{name:e.caption,value:e.value}])}),t.menu._innerMenu=e,t.menu.setInnerMenu([{menu:e,index:0}])},show:function(){Common.UI.BaseView.prototype.show.call(this),this.fireEvent("show",this)},getButtons:function(t){return void 0===t?this.lockedControls:[]},SetDisabled:function(e){this.lockedControls&&this.lockedControls.forEach(function(t){t&&t.setDisabled(e)},this)},onComboOpen:function(e,i,t,s){s&&s.fromKeyDown||_.delay(function(){var t=$("input",i.cmpEl).select();e?t.focus():i.isMenuOpen()||t.one("mouseup",function(t){t.preventDefault()})},10)}},SSE.Views.ViewTab||{}))}),define("common/main/lib/view/EditNameDialog",["common/main/lib/component/Window","common/main/lib/component/InputField"],function(){"use strict";Common.Views.EditNameDialog=Common.UI.Window.extend(_.extend({options:{width:330,header:!1,cls:"modal-dlg",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,t||{}),this.template=['<div class="box">','<div class="input-row">',"<label>"+(this.options.label||this.textLabel)+"</label>","</div>",'<div id="id-dlg-label-caption" class="input-row"></div>',"</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);this.inputLabel=new Common.UI.InputField({el:$("#id-dlg-label-caption"),allowBlank:!1,blankError:this.options.error||this.textLabelError,style:"width: 100%;",validateOnBlur:!1,validation:this.options.validation||function(t){return!!t||""}}),this.inputLabel.setValue(this.options.value||""),this.getChild().find(".dlg-btn").on("click",_.bind(this.onBtnClick,this))},show:function(){Common.UI.Window.prototype.show.apply(this,arguments);var t=this;_.delay(function(){t.getChild("input").focus()},50)},onPrimary:function(t){return this._handleInput("ok"),!1},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},_handleInput:function(t){if(this.options.handler){if("ok"==t&&!0!==this.inputLabel.checkValidate())return void this.inputLabel.cmpEl.find("input").focus();this.options.handler.call(this,t,this.inputLabel.getValue())}this.close()}},Common.Views.EditNameDialog||{}))}),define("spreadsheeteditor/main/app/view/ViewManagerDlg",["common/main/lib/view/EditNameDialog","common/main/lib/view/AdvancedSettingsWindow","common/main/lib/component/ComboBox","common/main/lib/component/ListView","common/main/lib/component/InputField"],function(){"use strict";SSE.Views=SSE.Views||{},SSE.Views.ViewManagerDlg=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{alias:"ViewManagerDlg",contentWidth:460,height:330,buttons:null},initialize:function(t){_.extend(this.options,{title:this.txtTitle,template:['<div class="box" style="height:'+(this.options.height-85)+'px;">','<div class="content-panel" style="padding: 0;">','<div class="settings-panel active">','<div class="inner-content">','<table cols="1" style="width: 100%;">',"<tr>",'<td class="padding-small">','<label class="header">'+this.textViews+"</label>",'<div id="view-manager-list" class="range-tableview" style="width:440px; height: 166px;"></div>',"</td>","</tr>","<tr>",'<td class="padding-large">','<button type="button" class="btn btn-text-default auto margin-right-5" id="view-manager-btn-new" style="min-width: 80px;">'+this.textNew+"</button>",'<button type="button" class="btn btn-text-default auto margin-right-5" id="view-manager-btn-rename" style="min-width: 80px;">'+this.textRename+"</button>",'<button type="button" class="btn btn-text-default auto" id="view-manager-btn-duplicate" style="min-width: 80px;">'+this.textDuplicate+"</button>",'<button type="button" class="btn btn-text-default auto float-right" id="view-manager-btn-delete" style="min-width: 80px;">'+this.textDelete+"</button>","</td>","</tr>","</table>","</div>","</div>","</div>","</div>",'<div class="separator horizontal"></div>','<div class="footer center">','<button class="btn normal dlg-btn primary" result="ok" style="min-width: 86px;width: auto;">'+this.textGoTo+"</button>",'<button class="btn normal dlg-btn" result="cancel" style="width: 86px;">'+this.closeButtonText+"</button>","</div>"].join("")},t),this.api=t.api,this.views=t.views||[],this.userTooltip=!0,this.currentView=void 0,this.wrapEvents={onRefreshNamedSheetViewList:_.bind(this.onRefreshNamedSheetViewList,this)},Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);this.viewList=new Common.UI.ListView({el:$("#view-manager-list",this.$window),store:new Common.UI.DataViewStore,simpleAddMode:!0,emptyText:this.textEmpty,itemTemplate:_.template(['<div id="<%= id %>" class="list-item" style="width: 100%;height: 20px;display:inline-block;<% if (!lock) { %>pointer-events:none;<% } %>">','<div style="width:100%;"><%= Common.Utils.String.htmlEncode(name) %></div>',"<% if (lock) { %>",'<div class="lock-user"><%=lockuser%></div>',"<% } %>","</div>"].join("")),tabindex:1}),this.viewList.on("item:select",_.bind(this.onSelectItem,this)).on("item:keydown",_.bind(this.onKeyDown,this)).on("item:dblclick",_.bind(this.onDblClickItem,this)).on("entervalue",_.bind(this.onDblClickItem,this)),this.btnNew=new Common.UI.Button({el:$("#view-manager-btn-new")}),this.btnNew.on("click",_.bind(this.onNew,this,!1)),this.btnRename=new Common.UI.Button({el:$("#view-manager-btn-rename")}),this.btnRename.on("click",_.bind(this.onRename,this)),this.btnDuplicate=new Common.UI.Button({el:$("#view-manager-btn-duplicate")}),this.btnDuplicate.on("click",_.bind(this.onNew,this,!0)),this.btnDelete=new Common.UI.Button({el:$("#view-manager-btn-delete")}),this.btnDelete.on("click",_.bind(this.onDelete,this)),this.btnOk=new Common.UI.Button({el:this.$window.find(".primary"),disabled:!0}),this.afterRender()},getFocusedComponents:function(){return[this.viewList,this.btnNew,this.btnRename,this.btnDuplicate,this.btnDelete]},getDefaultFocusableComponent:function(){return this.viewList},afterRender:function(){this._setDefaults()},_setDefaults:function(t){this.refreshList(this.views),this.api.asc_registerCallback("asc_onRefreshNamedSheetViewList",this.wrapEvents.onRefreshNamedSheetViewList)},onRefreshNamedSheetViewList:function(){this.refreshList(this.api.asc_getNamedSheetViews(),this.currentView)},refreshList:function(t,e){var i=0;if(t){this.views=t;for(var s=[],o=0;o<this.views.length;o++){var n=this.views[o],a=n.asc_getIsLock();s.push({name:n.asc_getName(!0),active:n.asc_getIsActive(),view:n,lock:null!=a,lockuser:a?this.isUserVisible(a)?this.getUserName(a):this.lockText:this.guestText}),n.asc_getIsActive()&&(i=o)}this.viewList.store.reset(s)}var t=this.viewList.store.length,l=(this.btnRename.setDisabled(!t),this.btnDuplicate.setDisabled(!t),this.btnDelete.setDisabled(!t),this.btnOk.setDisabled(!t),0<t&&(null==e&&(e=i),_.isNumber(e)&&(t-1<e&&(e=t-1),this.viewList.selectByIndex(e),setTimeout(function(){l.viewList.scrollToRecord(l.viewList.store.at(e))},50)),!0===this.userTooltip&&0<this.viewList.cmpEl.find(".lock-user").length&&this.viewList.cmpEl.on("mouseover",_.bind(this.onMouseOverLock,this)).on("mouseout",_.bind(this.onMouseOutLock,this))),this);_.delay(function(){l.viewList.cmpEl.find(".listview").focus(),l.viewList.scroller.update({alwaysVisibleY:!0})},100,this)},onMouseOverLock:function(t,e,i){var s;!0===this.userTooltip&&$(t.target).hasClass("lock-user")&&(s=this,t=$(t.target).tooltip({title:this.tipIsLocked,trigger:"manual"}).data("bs.tooltip"),this.userTooltip=t.tip(),this.userTooltip.css("z-index",parseInt(this.$window.css("z-index"))+10),t.show(),setTimeout(function(){s.userTipHide()},5e3))},userTipHide:function(){"object"==typeof this.userTooltip&&(this.userTooltip.remove(),this.userTooltip=void 0,this.viewList.cmpEl.off("mouseover").off("mouseout"))},onMouseOutLock:function(t,e,i){"object"==typeof this.userTooltip&&this.userTipHide()},onNew:function(t){t=t?this.viewList.getSelectedRec().get("view"):void 0;this.currentView=this.viewList.store.length,this.api.asc_addNamedSheetView(t)},onDelete:function(){var e=this,i=this.viewList.getSelectedRec();i&&(i.get("active")?Common.UI.warning({msg:this.warnDeleteView.replace("%1",i.get("name")),buttons:["yes","no"],primary:"yes",callback:function(t){"yes"==t&&e.api.asc_deleteNamedSheetViews([i.get("view")])}}):this.api.asc_deleteNamedSheetViews([i.get("view")]))},onRename:function(){var e,i=this.viewList.getSelectedRec();i&&new Common.Views.EditNameDialog({label:(e=this).textRenameLabel,error:this.textRenameError,value:i.get("name"),validation:function(t){return t.length<128||e.textLongName},handler:function(t,e){"ok"==t&&i.get("view").asc_setName(e)}}).on("close",function(){e.getDefaultFocusableComponent().focus()}).show()},getSettings:function(){var t=this.viewList.getSelectedRec();return t?t.get("name"):null},getUserName:function(t){var e=SSE.getCollection("Common.Collections.Users");if(e){e=e.findUser(t);if(e)return AscCommon.UserInfoParser.getParsedName(e.get("username"))}return this.guestText},isUserVisible:function(t){var e=SSE.getCollection("Common.Collections.Users");if(e){e=e.findUser(t);if(e)return!e.get("hidden")}return!0},onSelectItem:function(t,e,i){var s;i&&(this.userTipHide(),s={},_.isFunction(i.toJSON)&&i.get("selected")&&(s=i.toJSON(),this.currentView=_.indexOf(this.viewList.store.models,i),this.btnRename.setDisabled(s.lock),this.btnDelete.setDisabled(s.lock)))},close:function(){this.userTipHide(),this.api.asc_unregisterCallback("asc_onRefreshNamedSheetViewList",this.wrapEvents.onRefreshNamedSheetViewList),Common.Views.AdvancedSettingsWindow.prototype.close.call(this)},onKeyDown:function(t,e,i){i.keyCode!=Common.UI.Keys.DELETE||this.btnDelete.isDisabled()||this.onDelete()},onDblClickItem:function(t,e,i){this.onPrimary()},onPrimary:function(){return!this.btnOk.isDisabled()&&(this.handler&&this.handler.call(this,"ok",this.getSettings())?void 0:(this.close(),!1))}},SSE.Views.ViewManagerDlg||{}))}),define("spreadsheeteditor/main/app/controller/ViewTab",["core","spreadsheeteditor/main/app/view/ViewTab","spreadsheeteditor/main/app/view/ViewManagerDlg"],function(){"use strict";SSE.Controllers.ViewTab=Backbone.Controller.extend(_.extend({models:[],collections:[],views:["ViewTab"],sdkViewName:"#id_main",initialize:function(){},onLaunch:function(){this._state={},Common.NotificationCenter.on("uitheme:changed",this.onThemeChanged.bind(this))},setApi:function(t){return t&&(this.api=t,this.api.asc_registerCallback("asc_onZoomChanged",this.onApiZoomChange.bind(this)),this.api.asc_registerCallback("asc_onSelectionChanged",_.bind(this.onSelectionChanged,this)),this.api.asc_registerCallback("asc_onWorksheetLocked",_.bind(this.onWorksheetLocked,this)),this.api.asc_registerCallback("asc_onSheetsChanged",this.onApiSheetChanged.bind(this)),this.api.asc_registerCallback("asc_onUpdateSheetViewSettings",this.onApiSheetChanged.bind(this)),this.api.asc_registerCallback("asc_updateSheetViewType",this.onApiUpdateSheetViewType.bind(this)),this.api.asc_registerCallback("asc_onCoAuthoringDisconnect",_.bind(this.onCoAuthoringDisconnect,this)),Common.NotificationCenter.on("api:disconnect",_.bind(this.onCoAuthoringDisconnect,this))),this},setConfig:function(t){this.toolbar=t.toolbar;t=t.mode;this.view=this.createView("ViewTab",{toolbar:this.toolbar.toolbar,mode:t,compactToolbar:this.toolbar.toolbar.isCompactView}),this.addListeners({ViewTab:{"zoom:selected":_.bind(this.onSelectedZoomValue,this),"zoom:changedbefore":_.bind(this.onZoomChanged,this),"zoom:changedafter":_.bind(this.onZoomChanged,this),"viewtab:freeze":this.onFreeze,"viewtab:freezeshadow":this.onFreezeShadow,"viewtab:formula":this.onViewSettings,"viewtab:headings":this.onViewSettings,"viewtab:gridlines":this.onViewSettings,"viewtab:zeros":this.onViewSettings,"viewtab:zoom":this.onZoom,"viewtab:showview":this.onShowView,"viewtab:openview":this.onOpenView,"viewtab:createview":this.onCreateView,"viewtab:manager":this.onOpenManager,"viewtab:viewmode":this.onPreviewMode},Statusbar:{"sheet:changed":this.onApiSheetChanged.bind(this),"view:compact":_.bind(function(t,e){this.view.chStatusbar.setValue(e,!0)},this)},Toolbar:{"view:compact":_.bind(function(t,e){this.view.chToolbar.setValue(!e,!0)},this)},LeftMenu:{"view:hide":_.bind(function(t,e){this.view.chLeftMenu.setValue(!e,!0)},this)}}),Common.NotificationCenter.on("layout:changed",_.bind(this.onLayoutChanged,this))},SetDisabled:function(t){this.view&&this.view.SetDisabled(t)},createToolbarPanel:function(){return this.view.getPanel()},getView:function(t){return!t&&this.view?this.view:Backbone.Controller.prototype.getView.call(this,t)},onCoAuthoringDisconnect:function(){this.SetDisabled(!0)},onSelectionChanged:function(t){this.toolbar.editMode&&this.view&&Common.Utils.lockControls(Common.enumLock.sheetView,this.api.asc_getActiveNamedSheetView&&!this.api.asc_getActiveNamedSheetView(this.api.asc_getActiveWorksheetIndex()),{array:[this.view.btnCloseView]})},onFreeze:function(t){this.api&&this.api.asc_freezePane(t),Common.NotificationCenter.trigger("edit:complete",this.view)},onFreezeShadow:function(t){this.api.asc_setFrozenPaneBorderType(t?Asc.c_oAscFrozenPaneBorderType.shadow:Asc.c_oAscFrozenPaneBorderType.line),Common.localStorage.setBool("sse-freeze-shadow",t),Common.NotificationCenter.trigger("edit:complete",this.view)},applyZoom:function(t){t=Math.max(10,Math.min(500,t));this._state.zoomValue===t&&this.view.cmbZoom.setValue(this._state.zoomValue,this._state.zoomValue+"%"),this.api.asc_setZoom(t/100),Common.NotificationCenter.trigger("edit:complete",this.view)},onSelectedZoomValue:function(t,e){this.applyZoom(e.value)},onZoomChanged:function(t,e,i,s){var o=parseFloat(i.value);void 0===this._state.zoomValue&&(this._state.zoomValue=100),t?new RegExp("^\\s*(\\d*(\\.|,)?\\d+)\\s*(%)?\\s*$").exec(i.value)||(this.view.cmbZoom.setValue(this._state.zoomValue,this._state.zoomValue+"%"),Common.NotificationCenter.trigger("edit:complete",this.view)):this._state.zoomValue===o||isNaN(o)?i.value!==this._state.zoomValue+"%"&&this.view.cmbZoom.setValue(this._state.zoomValue,this._state.zoomValue+"%"):this.applyZoom(o)},onViewSettings:function(t,e){if(this.api)switch(t){case 1:this.api.asc_setDisplayHeadings(e);break;case 2:this.api.asc_setDisplayGridlines(e);break;case 3:this.api.asc_setShowZeros(e)}Common.NotificationCenter.trigger("edit:complete",this.view)},onShowView:function(){var t=this.api.asc_getNamedSheetViews(),i=this.view.btnSheetView.menu._innerMenu,s=!1;i.removeItems(1,i.items.length-1),_.each(t,function(t,e){i.addItem(new Common.UI.MenuItem({caption:t.asc_getName(),checkable:!0,allowDepress:!1,checked:t.asc_getIsActive(),template:_.template(['<a id="<%= id %>" style="<%= style %>" tabindex="-1" type="menuitem">',"<%= Common.Utils.String.htmlEncode(caption) %>","</a>"].join(""))})),t.asc_getIsActive()&&(s=!0)}),i.items[0].setChecked(!s,!0)},onOpenView:function(t){this.api&&this.api.asc_setActiveNamedSheetView("default"==t.value?null:t.name)},onCreateView:function(t){this.api&&this.api.asc_addNamedSheetView(null,!0)},onOpenManager:function(t){var i=this;new SSE.Views.ViewManagerDlg({api:this.api,handler:function(t,e){"ok"==t&&e&&i.api&&i.api.asc_setActiveNamedSheetView(e),Common.NotificationCenter.trigger("edit:complete",i.view)},views:this.api.asc_getNamedSheetViews()}).on("close",function(t){}).show()},onWorksheetLocked:function(t,e){t==this.api.asc_getActiveWorksheetIndex()&&Common.Utils.lockControls(Common.enumLock.sheetLock,e,{array:[this.view.chHeadings,this.view.chGridlines,this.view.btnFreezePanes,this.view.chZeros,this.view.btnViewNormal,this.view.btnViewPageBreak]})},onApiSheetChanged:function(){var t;!this.toolbar.mode||!this.toolbar.mode.isEdit||this.toolbar.mode.isEditDiagram||this.toolbar.mode.isEditMailMerge||this.toolbar.mode.isEditOle||(t=this.api.asc_getSheetViewSettings(),this.view.chHeadings.setValue(!!t.asc_getShowRowColHeaders(),!0),this.view.chGridlines.setValue(!!t.asc_getShowGridLines(),!0),this.view.btnFreezePanes.menu.items&&this.view.btnFreezePanes.menu.items[0].setCaption(t.asc_getIsFreezePane()?this.view.textUnFreeze:this.view.capBtnFreeze),this.view.chZeros.setValue(!!t.asc_getShowZeros(),!0),t=this.api.asc_getActiveWorksheetIndex(),this.onWorksheetLocked(t,this.api.asc_isWorksheetLockedOrDeleted(t)),this.onApiUpdateSheetViewType(t))},onLayoutChanged:function(t){"celleditor"==t&&arguments[1]&&this.view.chFormula.setValue("showed"==arguments[1],!0)},onApiZoomChange:function(t,e){t=Math.floor(100*(t+.005));this.view.cmbZoom.setValue(t,t+"%"),this._state.zoomValue=t},onThemeChanged:function(){var t;this.view&&Common.UI.Themes.available()&&(t=Common.UI.Themes.currentThemeId()||Common.UI.Themes.defaultThemeId(),(t=_.findWhere(this.view.btnInterfaceTheme.menu.items,{value:t}))&&(this.view.btnInterfaceTheme.menu.clearAll(),t.setChecked(!0,!0)))},onPreviewMode:function(t){this.api&&this.api.asc_SetSheetViewType(t)},onApiUpdateSheetViewType:function(t){this.view&&this.api&&t===this.api.asc_getActiveWorksheetIndex()&&(t=this.api.asc_GetSheetViewType(t),this.view.btnViewPageBreak&&this.view.btnViewPageBreak.toggle(t===Asc.c_oAscESheetViewType.pageBreakPreview,!0),this.view.btnViewNormal&&this.view.btnViewNormal.toggle(t===Asc.c_oAscESheetViewType.normal,!0))}},SSE.Controllers.ViewTab||{}))}),define("text!common/main/lib/template/SearchPanel.template",[],function(){return'<div id="search-box" class="layout-ct vbox search-panel">\n    <div id="search-header">\n        <label id="search-adv-title"></label>\n        <div id="search-btn-close" class="float-right"></div>\n    </div>\n    <div id="search-container">\n    <div id="search-adv-settings">\n        <table cols="1">\n            <tbody>\n                <tr>\n                    <td class="padding-small"><div id="search-adv-text"></div></td>\n                </tr>\n                <tr class="edit-setting">\n                    <td class="padding-large"><div id="search-adv-replace-text"></div></td>\n                </tr>\n                <tr>\n                    <td class="padding-large">\n                        <label id="search-adv-results-number" style="display: inline-block;">\n                            <%= scope.textSearchResults %>\n                        </label>\n                        <div class="search-nav-btns float-right">\n                            <div id="search-adv-back"></div>\n                            <div id="search-adv-next"></div>\n                        </div>\n                    </td>\n                </tr>\n                <tr class="edit-setting">\n                    <td class="padding-large">\n                       <button type="button" class="btn btn-text-default" id="search-adv-replace" data-hint="1" data-hint-direction="bottom" data-hint-offset="big"><%= scope.textReplace %></button>\n                       <button type="button" class="btn btn-text-default" id="search-adv-replace-all" data-hint="1" data-hint-direction="bottom" data-hint-offset="big"><%= scope.textReplaceAll %></button>\n                    </td>\n                </tr>\n                <tr class="search-options-block">\n                    <td class="padding-large">\n                        <div id="open-search-options" data-hint="1" data-hint-direction="left" data-hint-offset="0, -15">\n                            <div class="search-options-caret img-commonctrl"></div>\n                            <div class="search-options-txt"><%= scope.textSearchOptions %></div>\n                        </div>\n                        <div id="search-options">\n                            <label class="input-label"><%= scope.textWithin %></label>\n                            <div id="search-adv-cmb-within"></div>\n                            <div id="search-adv-select-range"></div>\n                            <label class="input-label"><%= scope.textSearch %></label>\n                            <div id="search-adv-cmb-search"></div>\n                            <label class="input-label"><%= scope.textLookIn %></label>\n                            <div id="search-adv-cmb-look-in"></div>\n                        </div>\n                    </td>\n                </tr>\n                <tr>\n                    <td class="padding-small"><div id="search-adv-case-sensitive"></div></td>\n                </tr>\n                \x3c!---<tr>\n                    <td class="padding-small"><div id="search-adv-use-regexp"></div></td>\n                </tr>--\x3e\n                <tr>\n                    <td class="padding-large"><div id="search-adv-match-word"></div></td>\n                </tr>\n            </tbody>\n        </table>\n    </div>\n    <div id="search-results" class="ps-container oo">\n    </div>\n    </div>\n</div>'}),define("common/main/lib/view/SearchPanel",["text!common/main/lib/template/SearchPanel.template","common/main/lib/util/utils","common/main/lib/component/BaseView","common/main/lib/component/Layout"],function(t){"use strict";Common.Views.SearchPanel=Common.UI.BaseView.extend(_.extend({el:"#left-panel-search",template:_.template(t),initialize:function(t){_.extend(this,t),Common.UI.BaseView.prototype.initialize.call(this,arguments),this.mode=!1,window.SSE&&(this.extendedOptions=Common.localStorage.getBool("sse-search-options-extended",!0))},render:function(t){var i=this;return this.rendered||(t=t||this.el,$(t).html(this.template({scope:this})),this.$el=$(t),this.inputText=new Common.UI.InputField({el:$("#search-adv-text"),placeHolder:this.textFind,allowBlank:!0,validateOnBlur:!1,style:"width: 100%;",dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.inputText._input.on("input",_.bind(function(){this.fireEvent("search:input",[this.inputText._input.val()])},this)).on("keydown",_.bind(function(t){this.fireEvent("search:keydown",[this.inputText._input.val(),t])},this)),this.inputReplace=new Common.UI.InputField({el:$("#search-adv-replace-text"),placeHolder:this.textReplaceWith,allowBlank:!0,validateOnBlur:!1,style:"width: 100%;",dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.inputReplace._input.on("keydown",_.bind(function(t){t.keyCode!==Common.UI.Keys.RETURN||this.btnReplace.isDisabled()||this.onReplaceClick("replace")},this)),this.btnBack=new Common.UI.Button({parentEl:$("#search-adv-back"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-arrow-up",hint:this.tipPreviousResult,dataHint:"1",dataHintDirection:"bottom"}),this.btnBack.on("click",_.bind(this.onBtnNextClick,this,"back")),this.btnNext=new Common.UI.Button({parentEl:$("#search-adv-next"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-arrow-down",hint:this.tipNextResult,dataHint:"1",dataHintDirection:"bottom"}),this.btnNext.on("click",_.bind(this.onBtnNextClick,this,"next")),this.btnReplace=new Common.UI.Button({el:$("#search-adv-replace")}),this.btnReplace.on("click",_.bind(this.onReplaceClick,this,"replace")),this.btnReplaceAll=new Common.UI.Button({el:$("#search-adv-replace-all")}),this.btnReplaceAll.on("click",_.bind(this.onReplaceClick,this,"replaceall")),this.$reaultsNumber=$("#search-adv-results-number"),this.updateResultsNumber("no-results"),this.chCaseSensitive=new Common.UI.CheckBox({el:$("#search-adv-case-sensitive"),labelText:this.textCaseSensitive,value:!1,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}).on("change",function(t){i.fireEvent("search:options",["case-sensitive","checked"===t.getValue()])}),this.chMatchWord=new Common.UI.CheckBox({el:$("#search-adv-match-word"),labelText:window.SSE?this.textItemEntireCell:this.textWholeWords,value:!1,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}).on("change",function(t){i.fireEvent("search:options",["match-word","checked"===t.getValue()])}),this.buttonClose=new Common.UI.Button({parentEl:$("#search-btn-close",this.$el),cls:"btn-toolbar",iconCls:"toolbar__icon btn-close",hint:this.textCloseSearch,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"medium"}),this.buttonClose.on("click",_.bind(this.onClickClosePanel,this)),this.$resultsContainer=$("#search-results"),this.$resultsContainer.hide(),this.$searchContainer=$("#search-container"),this.$searchContainer.scroller=new Common.UI.Scroller({el:$("#search-container"),useKeyboard:!0,minScrollbarLength:40}),Common.NotificationCenter.on("search:updateresults",_.bind(this.disableNavButtons,this)),window.SSE?(this.cmbWithin=new Common.UI.ComboBox({el:$("#search-adv-cmb-within"),menuStyle:"min-width: 100%;",style:"width: 219px;",editable:!1,cls:"input-group-nr",data:[{value:0,displayValue:this.textSheet},{value:1,displayValue:this.textWorkbook},{value:2,displayValue:this.textSpecificRange}],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}).on("selected",function(t,e){i.fireEvent("search:options",["within",e.value])}),this.inputSelectRange=new Common.UI.InputFieldBtn({el:$("#search-adv-select-range"),placeHolder:this.textSelectDataRange,allowBlank:!0,validateOnChange:!0,validateOnBlur:!0,style:"width: 219px; margin-top: 8px",disabled:!0,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}).on("keyup:after",function(t,e){i.fireEvent("search:options",["range",t.getValue(),e.keyCode!==Common.UI.Keys.RETURN])}),this.inputSelectRange.$el.hide(),this.cmbSearch=new Common.UI.ComboBox({el:$("#search-adv-cmb-search"),menuStyle:"min-width: 100%;",style:"width: 219px;",editable:!1,cls:"input-group-nr",data:[{value:0,displayValue:this.textByRows},{value:1,displayValue:this.textByColumns}],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}).on("selected",function(t,e){i.fireEvent("search:options",["search",!e.value])}),this.cmbLookIn=new Common.UI.ComboBox({el:$("#search-adv-cmb-look-in"),menuStyle:"min-width: 100%;",style:"width: 219px;",editable:!1,cls:"input-group-nr",data:[{value:0,displayValue:this.textFormulas},{value:1,displayValue:this.textValues}],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}).on("selected",function(t,e){i.fireEvent("search:options",["lookIn",!e.value])}),this.$searchOptionsBlock=$(".search-options-block"),this.$searchOptionsBlock.show(),$("#open-search-options").on("click",_.bind(this.expandSearchOptions,this)),this.extendedOptions||this.$searchOptionsBlock.addClass("no-expand"),this.cmbWithin.setValue(0),this.cmbSearch.setValue(0),this.cmbLookIn.setValue(0),t='<div class="search-table"><div class="header-items"><div class="header-item">'+this.textSheet+'</div><div class="header-item">'+this.textName+'</div><div class="header-item">'+this.textCell+'</div><div class="header-item">'+this.textValue+'</div><div class="header-item">'+this.textFormula+'</div></div><div class="ps-container oo search-items"></div></div>',t=$(t).appendTo(this.$resultsContainer),this.$resultsContainer.scroller=new Common.UI.Scroller({el:t.find(".search-items"),includePadding:!0,useKeyboard:!0,minScrollbarLength:40,alwaysVisibleY:!0}),this.$resultsTable=this.$resultsContainer.find(".search-table")):this.$resultsContainer.scroller=new Common.UI.Scroller({el:this.$resultsContainer,includePadding:!0,useKeyboard:!0,minScrollbarLength:40,alwaysVisibleY:!0}),Common.NotificationCenter.on("window:resize",function(){i.updateResultsContainerHeight()})),this.rendered=!0,this.trigger("render:after",this),this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this.fireEvent("show",this),this.updateResultsContainerHeight()},hide:function(){Common.UI.BaseView.prototype.hide.call(this,arguments),this.fireEvent("hide",this)},focus:function(t){var e=("replace"===t?this.inputReplace:"range"===t?this.inputSelectRange:this.inputText).$el;setTimeout(function(){e.find("input").focus(),e.find("input").select()},10)},setSearchMode:function(t){this.mode!==t&&(this.$el.find(".edit-setting")["no-replace"!==t?"show":"hide"](),this.$el.find("#search-adv-title").text("no-replace"!==t?this.textFindAndReplace:this.textFind),this.mode=t)},ChangeSettings:function(t){},updateScrollers:function(){this.$resultsContainer.scroller.update({alwaysVisibleY:!0}),this.$searchContainer.scroller.update({alwaysVisibleY:!0}),setTimeout(_.bind(function(){this.$searchContainer.find("> .ps-scrollbar-y-rail").is(":visible")?this.$resultsContainer.find(".ps-scrollbar-y-rail").addClass("set-left"):this.$resultsContainer.find(".ps-scrollbar-y-rail").removeClass("set-left")},this),100)},updateResultsContainerHeight:function(){this.$resultsContainer&&(this.$resultsContainer.outerHeight(Math.max($("#search-box").outerHeight()-$("#search-header").outerHeight()-$("#search-adv-settings").outerHeight(),112)),this.updateScrollers())},updateResultsNumber:function(t,e){var i,s;this.$resultsContainer&&"content-changed"!==t&&"replace-all"!==t&&"replace"!==t&&(300<e?this.showToManyResults():(this.$resultsContainer.find(".many-results").remove(),window.SSE&&this.$resultsTable.show())),i="no-results"===t?this.textNoSearchResults:"stop"===t?this.textSearchHasStopped:"content-changed"===t?this.textContentChanged+" "+Common.Utils.String.format(this.textSearchAgain,'<a class="search-again">',"</a>"):"replace-all"===t?Common.Utils.String.format(this.textItemsSuccessfullyReplaced,e):"replace"===t?Common.Utils.String.format(this.textPartOfItemsNotReplaced,e[0],e[1],e[2]):e?Common.Utils.String.format(this.textSearchResults,t+1,e):this.textNoMatches,"content-changed"===t?((s=this).$reaultsNumber.html(i),this.$reaultsNumber.find(".search-again").on("click",function(){s.fireEvent("search:next",[s.inputText.getValue(),!0])})):this.$reaultsNumber.text(i),this.updateResultsContainerHeight(),window.SSE||this.disableReplaceButtons(!e)},showToManyResults:function(){window.SSE?(this.$resultsTable.hide(),this.$resultsTable.find(".search-items").empty(),this.$resultsContainer.find(".many-results").remove()):this.$resultsContainer.empty(),this.$resultsContainer.append('<div class="many-results">'+this.textTooManyResults+"</div>"),this.$resultsContainer.is(":visible")||this.$resultsContainer.show()},onClickClosePanel:function(){Common.NotificationCenter.trigger("leftmenu:change","hide"),this.fireEvent("hide",this)},onBtnNextClick:function(t){this.fireEvent("search:"+t,[this.inputText.getValue(),!0])},onReplaceClick:function(t){this.fireEvent("search:"+t,[this.inputText.getValue(),this.inputReplace.getValue()])},getSettings:function(){return{textsearch:this.inputText.getValue(),matchcase:this.chCaseSensitive.checked,matchword:this.chMatchWord.checked}},expandSearchOptions:function(){this.extendedOptions=!this.extendedOptions,this.$searchOptionsBlock[this.extendedOptions?"removeClass":"addClass"]("no-expand"),Common.localStorage.setBool("sse-search-options-extended",this.extendedOptions),this.updateResultsContainerHeight()},setFindText:function(t){this.inputText.setValue(t)},clearResultsNumber:function(){this.updateResultsNumber("no-results")},disableNavButtons:function(t,e){e=""===this.inputText._input.val()&&!window.SSE||!e;this.btnBack.setDisabled(e),this.btnNext.setDisabled(e)},disableReplaceButtons:function(t){this.btnReplace.setDisabled(t),this.btnReplaceAll.setDisabled(t)}},Common.Views.SearchPanel||{}))}),define("spreadsheeteditor/main/app/controller/Search",["core","common/main/lib/view/SearchPanel"],function(){"use strict";SSE.Controllers.Search=Backbone.Controller.extend(_.extend({sdkViewName:"#id_main",views:["Common.Views.SearchPanel"],initialize:function(){this.addListeners({SearchBar:{"search:back":_.bind(this.onSearchNext,this,"back"),"search:next":_.bind(this.onSearchNext,this,"next"),"search:input":_.bind(function(t,e){e&&!t?this._state.isResults&&(this._state.noSearchEmptyCells=!0,this.onQuerySearch()):this._state.searchText===t?Common.NotificationCenter.trigger("search:updateresults",this._state.currentResult,this._state.resultsNumber):this.onInputSearchChange(t)},this),"search:keydown":_.bind(this.onSearchNext,this,"keydown"),show:_.bind(this.onSelectSearchingResults,this,!0),hide:_.bind(this.onSelectSearchingResults,this,!1)},"Common.Views.SearchPanel":{"search:back":_.bind(this.onSearchNext,this,"back"),"search:next":_.bind(this.onSearchNext,this,"next"),"search:replace":_.bind(this.onQueryReplace,this),"search:replaceall":_.bind(this.onQueryReplaceAll,this),"search:input":_.bind(this.onInputSearchChange,this),"search:options":_.bind(this.onChangeSearchOption,this),"search:keydown":_.bind(this.onSearchNext,this,"keydown"),show:_.bind(this.onShowPanel,this),hide:_.bind(this.onHidePanel,this)},LeftMenu:{"search:aftershow":_.bind(this.onShowAfterSearch,this)}})},onLaunch:function(){this._state={searchText:void 0,matchCase:!1,matchWord:!1,useRegExp:!1,withinSheet:Asc.c_oAscSearchBy.Sheet,searchByRows:!0,lookInFormulas:!0,isValidSelectedRange:!0,lastSelectedItem:void 0,isContentChanged:!1,isResults:!1,noSearchEmptyCells:!1,isReturnPressed:!1}},setMode:function(t){this.view=this.createView("Common.Views.SearchPanel",{mode:t}),this.view.on("render:after",_.bind(this.onAfterRender,this))},setApi:function(t){return t&&(this.api=t,this.api.asc_registerCallback("asc_onRenameCellTextEnd",_.bind(this.onRenameText,this)),this.api.asc_registerCallback("asc_onSetSearchCurrent",_.bind(this.onUpdateSearchCurrent,this)),this.api.asc_registerCallback("asc_onStartTextAroundSearch",_.bind(this.onStartTextAroundSearch,this)),this.api.asc_registerCallback("asc_onEndTextAroundSearch",_.bind(this.onEndTextAroundSearch,this)),this.api.asc_registerCallback("asc_onGetTextAroundSearchPack",_.bind(this.onApiGetTextAroundSearch,this)),this.api.asc_registerCallback("asc_onRemoveTextAroundSearch",_.bind(this.onApiRemoveTextAroundSearch,this)),this.api.asc_registerCallback("asc_onActiveSheetChanged",_.bind(this.onActiveSheetChanged,this)),this.api.asc_registerCallback("asc_onModifiedDocument",_.bind(this.onApiModifiedDocument,this)),this.api.asc_registerCallback("asc_onUpdateSearchElem",_.bind(this.onApiUpdateSearchElem,this))),this},getView:function(t){return!t&&this.view?this.view:Backbone.Controller.prototype.getView.call(this,t)},onAfterRender:function(){var e=this;this.view.inputSelectRange.validation=function(t){return!!_.isEmpty(t)||(t=e.api.asc_checkDataRange(void 0,t),e._state.isValidSelectedRange=t!==Asc.c_oAscError.ID.DataRangeError,t!==Asc.c_oAscError.ID.DataRangeError||e.textInvalidRange)},this.view.inputSelectRange.on("button:click",_.bind(this.onRangeSelect,this))},onChangeSearchOption:function(t,e,i){var s=!0;switch(t){case"case-sensitive":this._state.matchCase=e;break;case"match-word":this._state.matchWord=e;break;case"regexp":this._state.useRegExp=e;break;case"within":this._state.withinSheet=0===e?Asc.c_oAscSearchBy.Sheet:1===e?Asc.c_oAscSearchBy.Workbook:Asc.c_oAscSearchBy.Range,this.view.inputSelectRange.setDisabled(e!==Asc.c_oAscSearchBy.Range),e===Asc.c_oAscSearchBy.Range&&(s=this._state.isValidSelectedRange&&!!this._state.selectedRange),this.view.inputSelectRange.$el[e===Asc.c_oAscSearchBy.Range?"show":"hide"](),this.view.updateResultsContainerHeight();break;case"range":this._state.selectedRange=e,s=!i;break;case"search":this._state.searchByRows=e;break;case"lookIn":this._state.lookInFormulas=e}s&&this.onQuerySearch()},onRangeSelect:function(){var i;this.rangeSelectDlg||((i=this).rangeSelectDlg=new SSE.Views.CellRangeDialog({handler:function(t,e){"ok"==e&&(e=t.getSettings(),i.view.inputSelectRange.setValue(e),i.view.inputSelectRange.checkValidate(),i.onChangeSearchOption("range",e))}}).on("close",function(){i.rangeSelectDlg=void 0,_.delay(function(){i.view.inputSelectRange.focus()},1)}),this.rangeSelectDlg.show(),this.rangeSelectDlg.setSettings({api:i.api,range:_.isEmpty(i.view.inputSelectRange.getValue())||1!=i.view.inputSelectRange.checkValidate()?i._state.selectedRange:i.view.inputSelectRange.getValue(),type:Asc.c_oAscSelectionDialogType.PrintTitles}))},onSearchNext:function(t,e,i){i="keydown"===t&&i.keyCode===Common.UI.Keys.RETURN;!i&&"keydown"===t||(this._state.searchText=e,this.onQuerySearch(t)),this._state.isReturnPressed=i},onInputSearchChange:function(t){t||this._state.isReturnPressed||(this._state.noSearchEmptyCells=!0),this._state.isReturnPressed=!1;var e=this;this._state.searchText!==t&&(this._state.newSearchText=t,this._lastInputChange=new Date,void 0===this.searchTimer&&(this.searchTimer=setInterval(function(){new Date-e._lastInputChange<400||(e._state.searchText=e._state.newSearchText,e.onQuerySearch()||""!==e._state.newSearchText||(e.view.updateResultsNumber("no-results"),e.view.disableNavButtons(),Common.NotificationCenter.trigger("search:updateresults",void 0,0)))},10)))},onQuerySearch:function(t,e){this.searchTimer&&clearInterval(this.searchTimer),this.searchTimer=void 0;var i,s=this;if(this._state.withinSheet!==Asc.c_oAscSearchBy.Range||this._state.isValidSelectedRange)return this.hideResults(),this.api.asc_closeCellEditor(),(i=new Asc.asc_CFindOptions).asc_setFindWhat(this._state.searchText),i.asc_setScanForward("back"!=t),i.asc_setIsMatchCase(this._state.matchCase),i.asc_setIsWholeCell(this._state.matchWord),i.asc_setScanOnOnlySheet(this._state.withinSheet),this._state.withinSheet===Asc.c_oAscSearchBy.Range&&i.asc_setSpecificRange(this._state.selectedRange),i.asc_setScanByRows(this._state.searchByRows),i.asc_setLookIn(this._state.lookInFormulas?Asc.c_oAscFindLookIn.Formulas:Asc.c_oAscFindLookIn.Value),i.asc_setNeedRecalc(e),this._state.isContentChanged&&(i.asc_setLastSearchElem(this._state.lastSelectedItem),this.view.disableReplaceButtons(!1),this._state.isContentChanged=!1,this.view.$el.is(":visible")||(this.resultItems=[])),i.asc_setNotSearchEmptyCells(this._state.noSearchEmptyCells),this.api.asc_findText(i)?(this._state.isResults=!0,this.view.$el.is(":visible")&&this.api.asc_StartTextAroundSearch(),!0):(this._state.isResults=!1,this._state.noSearchEmptyCells?(this.removeResultItems("no-results"),this._state.noSearchEmptyCells=!1):this.removeResultItems(),Common.NotificationCenter.trigger("search:updateresults"),!1);Common.UI.warning({title:this.notcriticalErrorTitle,msg:this.textInvalidRange,buttons:["ok"],callback:function(){s.view.focus("range")}})},onQueryReplace:function(t,e){this.api.isReplaceAll=!1;var i=new Asc.asc_CFindOptions;i.asc_setFindWhat(t),i.asc_setReplaceWith(e),i.asc_setIsMatchCase(this._state.matchCase),i.asc_setIsWholeCell(this._state.matchWord),i.asc_setScanOnOnlySheet(this._state.withinSheet),this._state.withinSheet===Asc.c_oAscSearchBy.Range&&i.asc_setSpecificRange(this._state.selectedRange),i.asc_setScanByRows(this._state.searchByRows),i.asc_setLookIn(this._state.lookIn?Asc.c_oAscFindLookIn.Formulas:Asc.c_oAscFindLookIn.Value),i.asc_setIsReplaceAll(!1),this.api.asc_replaceText(i)},onQueryReplaceAll:function(t,e){this.api.isReplaceAll=!0;var i=new Asc.asc_CFindOptions;i.asc_setFindWhat(t),i.asc_setReplaceWith(e),i.asc_setIsMatchCase(this._state.matchCase),i.asc_setIsWholeCell(this._state.matchWord),i.asc_setScanOnOnlySheet(this._state.withinSheet),this._state.withinSheet===Asc.c_oAscSearchBy.Range&&i.asc_setSpecificRange(this._state.selectedRange),i.asc_setScanByRows(this._state.searchByRows),i.asc_setLookIn(this._state.lookIn?Asc.c_oAscFindLookIn.Formulas:Asc.c_oAscFindLookIn.Value),i.asc_setIsReplaceAll(!0),this.api.asc_replaceText(i)},onRenameText:function(t,e){this.api.isReplaceAll?t?(t-e||this.removeResultItems("replace-all"),!(t-e)||t<e?this.view.updateResultsNumber("replace-all",e):this.view.updateResultsNumber("replace",[e,t,t-e])):this.removeResultItems("replace-all",!0):this.onQuerySearch()},removeResultItems:function(t,e){this.resultItems=[],"replace-all"!==t&&this.view.updateResultsNumber(t,0),e||(this.hideResults(),this._state.currentResult=0,this._state.resultsNumber=0,this.view.disableNavButtons(),Common.NotificationCenter.trigger("search:updateresults",void 0,0))},onApiRemoveTextAroundSearch:function(t){var e;!this.resultItems||this.resultItems&&0===this.resultItems.length||(e=this,t.forEach(function(t){t=_.findIndex(e.resultItems,{id:t});-1!==t&&(e.resultItems[t].$el.remove(),e.resultItems.splice(t,1))}),0===this.resultItems.length&&this.removeResultItems())},onUpdateSearchCurrent:function(t,e){-1!==t&&(this._state.currentResult=t,this._state.resultsNumber=e,this.view&&(this.view.updateResultsNumber(t,e),this.view.disableNavButtons(t,e),this.resultItems&&0<this.resultItems.length&&(this.resultItems.forEach(function(t){t.selected=!1}),this.resultItems[t]&&(this._state.lastSelectedItem=this.resultItems[t].data,this.resultItems[t].selected=!0,$("#search-results").find(".item").removeClass("selected"),this.resultItems[t].$el.addClass("selected")))),Common.NotificationCenter.trigger("search:updateresults",t,e))},scrollToSelectedResult:function(t){var e,i,s,t=void 0!==t?t:_.findIndex(this.resultItems,{selected:!0});-1!==t&&(e=(t=this.resultItems[t].$el).outerHeight(),t=t.position().top,i=(s=this.view.$resultsContainer.find(".search-items")).outerHeight(),s=s.scrollTop(),t<0||0===s&&i<t?this.view.$resultsContainer.scroller.scrollTop(s+t-12):i<t+e&&this.view.$resultsContainer.scroller.scrollTop(s+e))},onStartTextAroundSearch:function(){this.view&&(this._state.isStartedAddingResults=!0)},onEndTextAroundSearch:function(){this.view&&(this._state.isStartedAddingResults=!1,this.view.updateScrollers())},onApiGetTextAroundSearch:function(t){var n,a,l;this.view&&this._state.isStartedAddingResults&&(300<t.length||!t.length||(a=(n=this).view.$resultsContainer.find(".search-items"),n.resultItems=[],t.forEach(function(i,t){var e=t===n._state.currentResult,s='<div class="item" style="width: 100%;"><div class="sheet">'+(i[1]||"")+'</div><div class="name">'+(i[2]||"")+'</div><div class="cell">'+(i[3]||"")+'</div><div class="value">'+(i[4]?Common.Utils.String.htmlEncode(i[4]):"")+'</div><div class="formula">'+(i[5]||"")+"</div></div>",o=$(s).appendTo(a),t=(e&&(o.addClass("selected"),n._state.lastSelectedItem=i,l=t),{id:i[0],$el:o,el:s,selected:e,data:i});n.resultItems.push(t),o.on("click",_.bind(function(t){var e;n._state.isContentChanged?(n._state.lastSelectedItem=i,n.onQuerySearch()):(e=i[0],n.api.asc_SelectSearchElement(e))},n)),n.addTooltips(o,i)}),this.view.$resultsContainer.show(),this.scrollToSelectedResult(l)))},addTooltips:function(t,e){var t=[t.find(".sheet"),t.find(".name"),t.find(".cell"),t.find(".value"),t.find(".formula")],s=[e[1],e[2],e[3],e[4],e[5]];t.forEach(function(t,e){t.data("bs.tooltip")&&t.removeData("bs.tooltip");var i=s[e];i&&(t.off("mouseenter"),t.one("mouseenter",function(){t.attr("data-toggle","tooltip"),t.tooltip({title:i,placement:"cursor",zIndex:1e3}),t.mouseenter()}))})},hideResults:function(){this.view&&(0===this.view.$resultsContainer.find(".many-results").length&&this.view.$resultsContainer.hide(),this.view.$resultsContainer.find(".search-items").empty())},onShowAfterSearch:function(t){var e=""===t,i=this.getApplication().getController("Viewport"),i=(i.isSearchBarVisible()&&i.searchBar.hide(),this.api.asc_GetSelectedText()),t="string"==typeof t?t:i&&i.trim()||this._state.searchText;if(this.resultItems&&0<this.resultItems.length||!t&&this._state.isResults){if(!t&&!this.view.inputText.getValue())return this._state.noSearchEmptyCells=!0,void this.onQuerySearch();if(!this._state.matchCase&&t&&t.toLowerCase()===this.view.inputText.getValue().toLowerCase()||this._state.matchCase&&t===this.view.inputText.getValue())return}t?this.view.setFindText(t):e&&(this.view.setFindText(""),this._state.isResults||(this._state.searchText=void 0)),this.hideResults(),void 0!==this._state.searchText&&t&&t===this._state.searchText&&this._state.isResults?this.api.asc_StartTextAroundSearch():this._state.searchText?(this._state.searchText=t,this.onQuerySearch()):(this.resultItems=[],this.view.clearResultsNumber()),this.view.disableNavButtons(this._state.currentResult,this._state.resultsNumber)},onShowPanel:function(){var i,s;this.onSelectSearchingResults(!0),this.resultItems&&0<this.resultItems.length&&!this._state.isStartedAddingResults&&(s=(i=this).view.$resultsContainer.find(".search-items"),this.view.$resultsContainer.show(),this.resultItems.forEach(function(e){var t=$(e.el).appendTo(s);e.$el=t,e.selected&&t.addClass("selected"),t.on("click",function(t){i.api.asc_SelectSearchElement(e.id),$("#search-results").find(".item").removeClass("selected"),$(t.currentTarget).addClass("selected")}),i.addTooltips(t,e.data)}),this.scrollToSelectedResult())},onHidePanel:function(){this.hideResults(),this.onSelectSearchingResults(!1)},onSelectSearchingResults:function(t){!t&&this.getApplication().getController("LeftMenu").isSearchPanelVisible()||this._state.isHighlightedResults!==t&&(this.api.asc_selectSearchingResults(t),this._state.isHighlightedResults=t)},onApiModifiedDocument:function(){this._state.isContentChanged=!0,this.view.updateResultsNumber("content-changed"),this.view.disableReplaceButtons(!0)},onActiveSheetChanged:function(t){this._state.isHighlightedResults&&this._state.withinSheet===Asc.c_oAscSearchBy.Sheet&&this.onQuerySearch(void 0,!0)},getSearchText:function(){return this._state.searchText},getResultsNumber:function(){return[this._state.currentResult,this._state.resultsNumber]},onApiUpdateSearchElem:function(t){var i;this.resultItems&&0<this.resultItems.length&&(i=this,t.forEach(function(t){var e=_.findWhere(i.resultItems,{id:t[0]});e&&(e.data=t,e.el='<div class="item" style="width: 100%;"><div class="sheet">'+(t[1]||"")+'</div><div class="name">'+(t[2]||"")+'</div><div class="cell">'+(t[3]||"")+'</div><div class="value">'+(t[4]||"")+'</div><div class="formula">'+(t[5]||"")+"</div></div>",i.view.$el.is(":visible")&&(e.$el.find(".sheet").text(t[1]||""),e.$el.find(".name").text(t[2]||""),e.$el.find(".cell").text(t[3]||""),e.$el.find(".value").text(t[4]||""),e.$el.find(".formula").text(t[5]||""),i.addTooltips(e.$el,t)))}))},textNoTextFound:"The data you have been searching for could not be found. Please adjust your search options.",textReplaceSuccess:"Search has been done. {0} occurrences have been replaced",textReplaceSkipped:"The replacement has been made. {0} occurrences were skipped.",textInvalidRange:"ERROR! Invalid cells range"},SSE.Controllers.Search||{}))}),void 0===Common&&(Common={}),Common.Views=Common.Views||{},define("common/main/lib/view/Protection",["common/main/lib/util/utils","common/main/lib/component/BaseView","common/main/lib/component/Layout","common/main/lib/component/Window"],function(t){"use strict";Common.Views.Protection=Common.UI.BaseView.extend(_.extend({options:{},initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t),this.appConfig=t.mode,this.btnsInvisibleSignature=[],this.btnsAddPwd=[],this.btnsDelPwd=[],this.btnsChangePwd=[],this._state={disabled:!1,hasPassword:!1,disabledPassword:!1,invisibleSignDisabled:!1};t=Common.localStorage.getKeysFilter();this.appPrefix=t&&t.length?t.split(",")[0]:"",this.appConfig.isPasswordSupport&&(this.btnAddPwd=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-ic-protect",caption:this.txtEncrypt,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.btnsAddPwd.push(this.btnAddPwd),this.btnPwd=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-ic-protect",caption:this.txtEncrypt,split:!0,enableToggle:!0,menu:!0,visible:!1,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"})),this.appConfig.isSignatureSupport&&(this.btnSignature=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-ic-signature",caption:this.txtSignature,menu:"pe-"!==this.appPrefix,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.btnSignature.menu||this.btnsInvisibleSignature.push(this.btnSignature)),Common.NotificationCenter.on("app:ready",this.onAppReady.bind(this))},render:function(t){return this.boxSdk=$("#editor_sdk"),t&&t.html(this.getPanel()),this},onAppReady:function(t){var e=this;new Promise(function(t,e){t()}).then(function(){t.canProtect&&(t.isPasswordSupport&&(e.btnAddPwd.updateHint(e.hintAddPwd),e.btnPwd.updateHint([e.hintDelPwd,e.hintPwd]),e.btnPwd.setMenu(new Common.UI.Menu({items:[{caption:e.txtChangePwd,value:"add"},{caption:e.txtDeletePwd,value:"delete"}]}))),e.btnSignature&&(e.btnSignature.updateHint(e.btnSignature.menu?e.hintSignature:e.txtInvisibleSignature),e.btnSignature.menu&&e.btnSignature.setMenu(new Common.UI.Menu({items:[{caption:e.txtInvisibleSignature,value:"invisible"},{caption:e.txtSignatureLine,value:"visible",disabled:e._state.disabled}]}))),Common.NotificationCenter.trigger("tab:visible","protect",Common.UI.LayoutManager.isElementVisible("toolbar-protect"))),function(){var s=this;s.appConfig.isPasswordSupport&&(this.btnsAddPwd.concat(this.btnsChangePwd).forEach(function(t){t.on("click",function(t,e){s.fireEvent("protect:password",[t,"add"])})}),this.btnsDelPwd.forEach(function(t){t.on("click",function(t,e){s.fireEvent("protect:password",[t,"delete"])})}),this.btnPwd.on("click",function(t,e){t.pressed||s.fireEvent("protect:password",[t,"delete"])}),this.btnPwd.menu.on("item:click",function(t,e,i){s.fireEvent("protect:password",[t,e.value])})),s.appConfig.isSignatureSupport&&(this.btnSignature.menu&&(this.btnSignature.menu.on("item:click",function(t,e,i){s.fireEvent("protect:signature",[e.value,!1])}),this.btnSignature.menu.on("show:after",function(t,e){var i;s._state&&(i=!!s._state.docProtection&&(s._state.docProtection.isReadOnly||s._state.docProtection.isFormsOnly||s._state.docProtection.isCommentsOnly),t.items&&t.items[1].setDisabled(i||s._state.disabled))})),this.btnsInvisibleSignature.forEach(function(t){t.on("click",function(t,e){s.fireEvent("protect:signature",["invisible"])})})),s._isSetEvents=!0}.call(e)})},getPanel:function(){return this.$el=$(_.template('<section id="protection-panel" class="panel" data-tab="protect"><div class="group"><span id="slot-btn-add-password" class="btn-slot text x-huge"></span><span id="slot-btn-change-password" class="btn-slot text x-huge"></span><span id="slot-btn-signature" class="btn-slot text x-huge"></span></div></section>')({})),this.appConfig.canProtect&&(this.btnAddPwd&&this.btnAddPwd.render(this.$el.find("#slot-btn-add-password")),this.btnPwd&&this.btnPwd.render(this.$el.find("#slot-btn-change-password")),this.btnSignature&&this.btnSignature.render(this.$el.find("#slot-btn-signature"))),this.$el},show:function(){Common.UI.BaseView.prototype.show.call(this),this.fireEvent("show",this)},getButton:function(t,e){var i,s=this;return"signature"==t?(i=new Common.UI.Button({cls:"btn-text-default auto",caption:this.txtInvisibleSignature,disabled:this._state.invisibleSignDisabled,dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"medium"}),this.btnsInvisibleSignature.push(i),this._isSetEvents&&i.on("click",function(t,e){s.fireEvent("protect:signature",["invisible"])}),i):"add-password"==t?(i=new Common.UI.Button({cls:"btn-text-default auto",caption:this.txtAddPwd,disabled:this._state.disabled||this._state.disabledPassword,visible:!this._state.hasPassword,dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"medium"}),this.btnsAddPwd.push(i),this._isSetEvents&&i.on("click",function(t,e){s.fireEvent("protect:password",[t,"add"])}),i):"del-password"==t?(i=new Common.UI.Button({cls:"btn-text-default auto",caption:this.txtDeletePwd,disabled:this._state.disabled||this._state.disabledPassword,visible:this._state.hasPassword,dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"medium"}),this.btnsDelPwd.push(i),this._isSetEvents&&i.on("click",function(t,e){s.fireEvent("protect:password",[t,"delete"])}),i):"change-password"==t?(i=new Common.UI.Button({cls:"btn-text-default auto",caption:this.txtChangePwd,disabled:this._state.disabled||this._state.disabledPassword,visible:this._state.hasPassword,dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"medium"}),this.btnsChangePwd.push(i),this._isSetEvents&&i.on("click",function(t,e){s.fireEvent("protect:password",[t,"add"])}),i):void 0},SetDisabled:function(e,i){this._state.disabled=e,this._state.invisibleSignDisabled=e&&!i;var t=!!this._state.docProtection&&(this._state.docProtection.isReadOnly||this._state.docProtection.isFormsOnly||this._state.docProtection.isCommentsOnly);this.btnsInvisibleSignature&&this.btnsInvisibleSignature.forEach(function(t){t&&t.setDisabled(e&&!i)},this),this.btnSignature&&this.btnSignature.menu&&(this.btnSignature.menu.items&&this.btnSignature.menu.items[1].setDisabled(e||t),this.btnSignature.setDisabled(e&&!i)),this.btnsAddPwd.concat(this.btnsDelPwd,this.btnsChangePwd).forEach(function(t){t&&t.setDisabled(e||this._state.disabledPassword)},this)},onDocumentPassword:function(e,t){this._state.hasPassword=e,this._state.disabledPassword=!!t;var i=this._state.disabledPassword||this._state.disabled;this.btnsAddPwd&&this.btnsAddPwd.forEach(function(t){t&&(t.setVisible(!e),t.setDisabled(i))},this),this.btnsDelPwd.concat(this.btnsChangePwd).forEach(function(t){t&&(t.setVisible(e),t.setDisabled(i))},this),this.btnPwd.setVisible(e),this.btnPwd.toggle(e,!0)}},Common.Views.Protection||{}))}),define("spreadsheeteditor/main/app/view/WBProtection",["common/main/lib/util/utils","common/main/lib/component/BaseView","common/main/lib/component/Layout","common/main/lib/component/Window"],function(t){"use strict";SSE.Views.WBProtection=Common.UI.BaseView.extend(_.extend({options:{},initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t),this.appConfig=t.mode;t=Common.enumLock;this.lockedControls=[],this._state={disabled:!1},this.btnProtectWB=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-protect-workbook",enableToggle:!0,caption:this.txtProtectWB,lock:[t.editCell,t.selRangeEdit,t.lostConnect,t.coAuth],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.lockedControls.push(this.btnProtectWB),this.btnProtectSheet=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-protect-sheet",enableToggle:!0,caption:this.txtProtectSheet,lock:[t.editCell,t.selRangeEdit,t.lostConnect,t.coAuth],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.lockedControls.push(this.btnProtectSheet),this.btnAllowRanges=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-allow-edit-ranges",caption:this.txtAllowRanges,lock:[t.editCell,t.selRangeEdit,t.lostConnect,t.coAuth,t.wsLock],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.lockedControls.push(this.btnAllowRanges),this.chLockedCell=new Common.UI.CheckBox({labelText:this.txtLockedCell,lock:[t.editCell,t.selRangeEdit,t.selChart,t.selChartText,t.selShape,t.selShapeText,t.selImage,t.selSlicer,t.wsLock,t.wbLock,t.lostConnect,t.coAuth,t.userProtected],dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.lockedControls.push(this.chLockedCell),this.chLockedShape=new Common.UI.CheckBox({labelText:this.txtLockedShape,lock:[t.selRange,t.selRangeEdit,t.wbLock,t.lostConnect,t.coAuth,t.Objects,t.wsLockShape],dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.lockedControls.push(this.chLockedShape),this.chLockedText=new Common.UI.CheckBox({labelText:this.txtLockedText,lock:[t.selRange,t.selRangeEdit,t.selRangeEdit,t.selImage,t.selSlicer,t.wbLock,t.lostConnect,t.coAuth,t.Objects,t.wsLockText],dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.lockedControls.push(this.chLockedText),this.chHiddenFormula=new Common.UI.CheckBox({labelText:this.txtHiddenFormula,lock:[t.editCell,t.selRangeEdit,t.selChart,t.selChartText,t.selShape,t.selShapeText,t.selImage,t.selSlicer,t.wsLock,t.wbLock,t.lostConnect,t.coAuth,t.userProtected],dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.lockedControls.push(this.chHiddenFormula),this.btnProtectRange=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-protect-range",caption:this.txtProtectRange,lock:[t.editCell,t.selRangeEdit,t.lostConnect,t.coAuth,t.wsLock],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small",visible:!this.appConfig.isOffline}),this.lockedControls.push(this.btnProtectRange),Common.NotificationCenter.on("app:ready",this.onAppReady.bind(this))},render:function(t){return this},onAppReady:function(t){var e=this;new Promise(function(t,e){t()}).then(function(){e.btnProtectWB.updateHint(e.hintProtectWB),e.btnProtectSheet.updateHint(e.hintProtectSheet),e.btnAllowRanges.updateHint(e.hintAllowRanges),e.btnProtectRange.updateHint(e.hintProtectRange),t.isOffline&&e.btnProtectRange.cmpEl.parents(".group").hide().prev(".separator").hide(),function(){var i=this;this.btnProtectWB.on("click",function(t,e){i.fireEvent("protect:workbook",[t.pressed])}),this.btnProtectSheet.on("click",function(t,e){i.fireEvent("protect:sheet",[t.pressed])}),this.btnAllowRanges.on("click",function(t,e){i.fireEvent("protect:allow-ranges")}),this.chLockedCell.on("change",function(t,e){i.fireEvent("protect:lock-options",[0,e])}),this.chLockedShape.on("change",function(t,e){i.fireEvent("protect:lock-options",[1,e])}),this.chLockedText.on("change",function(t,e){i.fireEvent("protect:lock-options",[2,e])}),this.chHiddenFormula.on("change",function(t,e){i.fireEvent("protect:lock-options",[3,e])}),this.btnProtectRange.on("click",function(t,e){i.fireEvent("protect:range")}),i._isSetEvents=!0}.call(e)})},getPanel:function(){return this.$el=$(_.template('<div class="group"><span id="slot-btn-protect-wb" class="btn-slot text x-huge margin-right-2"></span><span id="slot-btn-protect-sheet" class="btn-slot text x-huge"></span></div><div class="separator long invisible"></div><div class="group small"><div class="elset"><span class="btn-slot text" id="slot-chk-locked-cell"></span></div><div class="elset"><span class="btn-slot text" id="slot-chk-hidden-formula"></span></div></div><div class="separator long invisible"></div><div class="group small"><div class="elset"><span class="btn-slot text" id="slot-chk-locked-shape"></span></div><div class="elset"><span class="btn-slot text" id="slot-chk-locked-text"></span></div></div><div class="separator long"></div><div class="group"><span id="slot-btn-protect-range" class="btn-slot text x-huge"></span></div>')({})),this.btnProtectWB.render(this.$el.find("#slot-btn-protect-wb")),this.btnProtectSheet.render(this.$el.find("#slot-btn-protect-sheet")),this.btnAllowRanges.render(this.$el.find("#slot-btn-allow-ranges")),this.chLockedCell.render(this.$el.find("#slot-chk-locked-cell")),this.chLockedShape.render(this.$el.find("#slot-chk-locked-shape")),this.chLockedText.render(this.$el.find("#slot-chk-locked-text")),this.chHiddenFormula.render(this.$el.find("#slot-chk-hidden-formula")),this.btnProtectRange.render(this.$el.find("#slot-btn-protect-range")),this.$el},getButtons:function(t){return void 0===t?this.lockedControls:[]},show:function(){Common.UI.BaseView.prototype.show.call(this),this.fireEvent("show",this)}},SSE.Views.WBProtection||{}))}),define("spreadsheeteditor/main/app/view/ProtectDialog",["common/main/lib/component/Window"],function(){"use strict";SSE.Views.ProtectDialog=Common.UI.Window.extend(_.extend({initialize:function(t){var e=this,i={};_.extend(i,{title:t.title||("sheet"==t.type?this.txtSheetTitle:this.txtWBTitle),cls:"modal-dlg",width:"sheet"==t.type?380:350,height:"auto",buttons:t.buttons||[{value:"ok",caption:this.txtProtect},"cancel"]},t),this.handler=t.handler,this.txtDescription=t.txtDescription||"",this.type=t.type||"workbook",this.props=t.props,this.names=t.names,this.isEdit=t.isEdit,this.api=t.api,this.winId=Common.UI.getId(),this.template=t.template||['<div class="box">','<% if (type=="range") { %>','<div class="input-row">',"<label>"+e.txtRangeName+"</label>","</div>",'<div id="'+e.winId+'-id-range-name-txt" class="input-row" style="margin-bottom: 5px;"></div>','<div class="input-row">',"<label>"+e.txtRange+"</label>","</div>",'<div id="'+e.winId+'-id-range-txt" class="input-row" style="margin-bottom: 10px;"></div>','<% } else if (type=="sheet") { %>','<div class="" style="margin-bottom: 10px;">',"<label>"+e.txtSheetDescription+" "+e.txtAllowDescription+"</label>","</div>",'<button type="button" class="btn btn-text-default auto" id="'+e.winId+'-id-range-btn-allow" style="min-width: 100px;margin-bottom: 15px;">'+e.txtAllowRanges+"</button>","<% } else { %>",'<div class="" style="margin-bottom: 10px;">',"<label>"+e.txtWBDescription+"</label>","</div>","<% } %>",'<% if (type=="sheet") { %>','<table cols="2" style="width: 100%;">',"<tr>",'<td class="padding-right-5" style="width:50%;">','<label class="input-label">'+e.txtPassword+" ("+e.txtOptional+")</label>",'<div id="'+e.winId+'-id-password-txt" class="input-row" style="width: 100%;margin-bottom: 10px;"></div>',"</td>",'<td class="padding-left-5" style="width:50%;">','<label class="input-label">'+e.txtRepeat+"</label>",'<div id="'+e.winId+'-id-repeat-txt" class="input-row" style="width: 100%;margin-bottom: 10px;"></div>',"</td>","</tr>","<tr>",'<td colspan="2" style="padding-bottom: 10px;">','<label class="light">'+e.txtWarning+"</label>","</td>","</tr>","</table>",'<div class="input-row">',"<label>"+e.txtAllow+"</label>","</div>",'<div id="'+e.winId+'-protect-dlg-options" class="" style="width: 100%; height: 116px; overflow: hidden;"></div>',"<% } else { %>",'<div class="input-row">',"<label>"+e.txtPassword+" ("+e.txtOptional+")</label>","</div>",'<div id="'+e.winId+'-id-password-txt" class="input-row" style="margin-bottom: 5px;"></div>','<div class="input-row">',"<label>"+e.txtRepeat+"</label>","</div>",'<div id="'+e.winId+'-id-repeat-txt" class="input-row" style="margin-bottom: 10px;"></div>','<label class="light">'+e.txtWarning+"</label>","<% } %>","</div>"].join(""),i.tpl=_.template(this.template)(i),Common.UI.Window.prototype.initialize.call(this,i)},render:function(){Common.UI.Window.prototype.render.call(this);var e=this;this.$window.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.repeatPwd=new Common.UI.InputField({el:$("#"+this.winId+"-id-repeat-txt"),type:"password",allowBlank:!0,style:"width: 100%;",maxLength:255,validateOnBlur:!1,validation:function(t){return e.txtIncorrectPwd}}),this.inputPwd=new Common.UI.InputFieldBtnPassword({el:$("#"+this.winId+"-id-password-txt"),type:"password",allowBlank:!0,style:"width: 100%;",maxLength:255,validateOnBlur:!1,repeatInput:this.repeatPwd,showPwdOnClick:!0}),"sheet"==this.type&&(this.optionsList=new Common.UI.ListView({el:$("#"+this.winId+"-protect-dlg-options",this.$window),store:new Common.UI.DataViewStore,simpleAddMode:!0,scrollAlwaysVisible:!0,template:_.template(['<div class="listview inner protect-sheet-options" style=""></div>'].join("")),itemTemplate:_.template(["<div>",'<label class="checkbox-indeterminate">','<input id="pdcheckbox-<%= id %>" type="checkbox" class="button__checkbox">','<label for="pdcheckbox-<%= id %>" class="checkbox__shape" ></label>',"</label>",'<div id="<%= id %>" class="list-item margin-left-20">','<div style="flex-grow: 1;"><%= Common.Utils.String.htmlEncode(value) %></div>',"</div>","</div>"].join(""))}),this.optionsList.on({"item:change":this.onItemChanged.bind(this),"item:add":this.onItemChanged.bind(this),"item:select":this.onCellCheck.bind(this)}),this.optionsList.onKeyDown=_.bind(this.onListKeyDown,this),this.optionsList.on("entervalue",_.bind(this.onPrimary,this)),this.btnAllowRanges=new Common.UI.Button({el:$("#"+this.winId+"-id-range-btn-allow",this.$window)}),this.btnAllowRanges.on("click",_.bind(this.onAllowRangesClick,this,!1))),"range"==this.type&&(this.inputRangeName=new Common.UI.InputField({el:$("#"+this.winId+"-id-range-name-txt"),allowBlank:!1,blankError:this.txtEmpty,style:"width: 100%;",maxLength:255,validateOnBlur:!1,validateOnChange:!1,validation:function(t){if(""==t)return!0;switch(e.api.asc_checkProtectedRangeName(t)){case Asc.c_oAscDefinedNameReason.WrongName:return e.textInvalidName;case Asc.c_oAscDefinedNameReason.Existed:return!(!e.isEdit||e.props.asc_getName().toLowerCase()!=t.toLowerCase())||e.textExistName;case Asc.c_oAscDefinedNameReason.OK:return!!(e.names.indexOf(t.toLowerCase())<0||e.isEdit&&e.props.asc_getName().toLowerCase()==t.toLowerCase())||e.textExistName;default:return e.textInvalidName}}}),this.txtDataRange=new Common.UI.InputFieldBtn({el:$("#"+this.winId+"-id-range-txt"),name:"range",style:"width: 100%;",allowBlank:!1,btnHint:this.textSelectData,blankError:this.txtEmpty,validateOnChange:!0,validateOnBlur:!1,validation:function(t){return e.api.asc_checkDataRange(Asc.c_oAscSelectionDialogType.ConditionalFormattingRule,t,!0)!==Asc.c_oAscError.ID.DataRangeError||e.textInvalidRange}}),this.txtDataRange.on("button:click",_.bind(this.onSelectData,this))),this.afterRender()},getFocusedComponents:function(){var t=[],t=(t="range"==this.type?t.concat([this.inputRangeName,this.txtDataRange]):t).concat([this.inputPwd,this.repeatPwd]);return t="sheet"==this.type?[this.btnAllowRanges].concat(t).concat([this.optionsList]):t},getDefaultFocusableComponent:function(){return"range"==this.type?this.inputRangeName:this.inputPwd},afterRender:function(){this._setDefaults(this.props)},onPrimary:function(t){return this._handleInput("ok"),!1},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},_handleInput:function(t){if(this.handler){if("ok"==t){if(this.inputRangeName&&!0!==this.inputRangeName.checkValidate())return void this.inputRangeName.focus();if(this.txtDataRange&&!0!==this.txtDataRange.checkValidate())return void this.txtDataRange.focus();if(!0!==this.inputPwd.checkValidate())return void this.inputPwd.focus();if(this.inputPwd.getValue()!==this.repeatPwd.getValue())return this.repeatPwd.checkValidate(),void this.repeatPwd.focus()}this.handler.call(this,t,this.inputPwd.getValue(),"ok"==t?this.getSettings():void 0)}this.close()},_setDefaults:function(t){this.optionsList&&this.updateOptionsList(t),"range"==this.type&&this.updateRangeSettings(t)},onItemChanged:function(t,e){var i=e.model.get("check");"indeterminate"==i?$("input[type=checkbox]",e.$el).prop("indeterminate",!0):$("input[type=checkbox]",e.$el).prop({checked:i,indeterminate:!1})},onCellCheck:function(t,e,i){var s,o,n,a,l;this.checkCellTrigerBlock||(l="",s=!1,n=null,(o=window.event||window._event)&&((l=$(o.currentTarget).find(".list-item")).length&&(n=l.get(0).getBoundingClientRect(),l=o.clientX*Common.Utils.zoom(),a=o.clientY*Common.Utils.zoom(),n.left<l&&l<n.right&&n.top<a&&a<n.bottom&&(s=!0)),(s||o.target.className.match("checkbox")&&"input"!==o.target.localName)&&(this.updateCellCheck(t,i),_.delay(function(){t.focus()},100,this))))},onListKeyDown:function(t,e){var i=this.optionsList;i.disabled||((e=_.isUndefined(void 0)?t:e).keyCode==Common.UI.Keys.SPACE?(e.preventDefault(),e.stopPropagation(),this.updateCellCheck(i,i.getSelectedRec())):Common.UI.DataView.prototype.onKeyDown.call(this.optionsList,t,e))},updateCellCheck:function(t,e){e&&t&&(e.set("check",!e.get("check")),"SelectLockedCells"==e.get("optionName")&&e.get("check")&&this.optionsList.store.findWhere({optionName:"SelectUnlockedCells"}).set("check",!0),"SelectUnlockedCells"!=e.get("optionName")||e.get("check")||this.optionsList.store.findWhere({optionName:"SelectLockedCells"}).set("check",!1))},updateRangeSettings:function(t){t&&(this.inputRangeName.setValue(t.asc_getName()),this.txtDataRange.setValue(t.asc_getSqref()))},updateOptionsList:function(i){var t=[{value:this.txtSelLocked,optionName:"SelectLockedCells"},{value:this.txtSelUnLocked,optionName:"SelectUnlockedCells"},{value:this.txtFormatCells,optionName:"FormatCells"},{value:this.txtFormatCols,optionName:"FormatColumns"},{value:this.txtFormatRows,optionName:"FormatRows"},{value:this.txtInsCols,optionName:"InsertColumns"},{value:this.txtInsRows,optionName:"InsertRows"},{value:this.txtInsHyper,optionName:"InsertHyperlinks"},{value:this.txtDelCols,optionName:"DeleteColumns"},{value:this.txtDelRows,optionName:"DeleteRows"},{value:this.txtSort,optionName:"Sort"},{value:this.txtAutofilter,optionName:"AutoFilter"},{value:this.txtPivot,optionName:"PivotTables"},{value:this.txtObjs,optionName:"Objects"},{value:this.txtScen,optionName:"Scenarios"}],s=[];t.forEach(function(t,e){s.push(new Common.UI.DataViewModel({selected:!1,allowSelected:!0,value:t.value,optionName:t.optionName,check:!(!i||!i["asc_get"+t.optionName])&&!i["asc_get"+t.optionName]()}))}),this.optionsList.store.reset(s),this.optionsList.scroller.update({minScrollbarLength:this.optionsList.minScrollbarLength,alwaysVisibleY:!0,suppressScrollX:!0})},getSettings:function(){return"sheet"==this.type?this.getSheetSettings():"range"==this.type?this.getRangeSettings():void 0},getSheetSettings:function(){var i=this.props||new Asc.CSheetProtection;return this.optionsList.store.each(function(t,e){i&&i["asc_set"+t.get("optionName")]&&i["asc_set"+t.get("optionName")](!t.get("check"))}),i},getRangeSettings:function(){var t=this.props||new Asc.CProtectedRange;return t.asc_setName(this.inputRangeName.getValue()),t.asc_setSqref(this.txtDataRange.getValue()),t},onSelectData:function(){var t,e,i=this;i.api&&(t=new SSE.Views.CellRangeDialog({handler:function(t,e){"ok"==e&&(i.dataRangeValid=t.getSettings(),i.txtDataRange.setValue(i.dataRangeValid),i.txtDataRange.checkValidate())}}).on("close",function(){i.show(),_.delay(function(){i.txtDataRange.focus()},1)}),e=i.$window.offset(),i.hide(),t.show(e.left+65,e.top+77),t.setSettings({api:i.api,range:_.isEmpty(i.txtDataRange.getValue())||1!=i.txtDataRange.checkValidate()?i.dataRangeValid:i.txtDataRange.getValue(),type:Asc.c_oAscSelectionDialogType.ConditionalFormattingRule,validation:function(){return!0}}))},onAllowRangesClick:function(){var i=this,t=i.$window.offset(),e=i.api.asc_getProtectedRanges(),e=new SSE.Views.ProtectRangesDlg({api:i.api,props:e,handler:function(t,e){"ok"==t&&i.api.asc_setProtectedRanges(e.arr,e.deletedArr)}}).on("close",function(){i.show(),setTimeout(function(){i.getDefaultFocusableComponent().focus()},100)});i.hide(),e.show(t.left-65,t.top+45)}},SSE.Views.ProtectDialog||{}))}),define("text!spreadsheeteditor/main/app/template/ProtectRangesDlg.template",[],function(){return'<div class="settings-panel active">\n    <div class="inner-content">\n        <table cols="2" style="width: 100%;">\n            <tr>\n                <td colspan=2 class="padding-small"></td>\n            </tr>\n            <tr>\n                <td colspan=2 class="padding-small">\n                    <label><%= scope.textRangesDesc %></label>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <button type="button" class="btn btn-text-default auto margin-right-5" id="protect-ranges-btn-new" style="min-width: 80px;"><%= scope.textNew %></button>\n                    <button type="button" class="btn btn-text-default auto" id="protect-ranges-btn-edit" style="min-width: 80px;"><%= scope.textEdit %></button>\n                </td>\n                <td class="padding-small text-align-right" style="width:90px;">\n                    <button type="button" class="btn btn-text-default auto" id="protect-ranges-btn-delete" style="min-width: 80px;"><%= scope.textDelete %></button>\n                </td>\n            </tr>            \n            <tr>\n                <td colspan=2 class="padding-small">\n                    <div id="protect-ranges-list" class="range-tableview" style="width:100%; height: 164px;"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>'}),define("spreadsheeteditor/main/app/view/ProtectRangesDlg",["text!spreadsheeteditor/main/app/template/ProtectRangesDlg.template","common/main/lib/view/AdvancedSettingsWindow","common/main/lib/component/ListView"],function(e){"use strict";SSE.Views=SSE.Views||{},SSE.Views.ProtectRangesDlg=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{alias:"ProtectRangesDlg",contentWidth:480,height:333,id:"window-protect-ranges"},initialize:function(t){_.extend(this.options,{title:this.txtTitle,template:['<div class="box" style="height:'+(this.options.height-85)+'px;">','<div class="content-panel" style="padding: 0;">'+_.template(e)({scope:this})+"</div>","</div>"].join(""),buttons:["ok","cancel"]},t),this.api=t.api,this.handler=t.handler,this.props=t.props,this.locked=t.locked||!1,this.userTooltip=!0,this.currentRange=void 0,this.deletedArr=[],this.wrapEvents={onLockProtectedRangeManager:_.bind(this.onLockProtectedRangeManager,this),onUnLockProtectedRangeManager:_.bind(this.onUnLockProtectedRangeManager,this),onLockProtectedRange:_.bind(this.onLockProtectedRange,this),onUnLockProtectedRange:_.bind(this.onUnLockProtectedRange,this)},Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);this.rangeList=new Common.UI.ListView({el:$("#protect-ranges-list",this.$window),store:new Common.UI.DataViewStore,emptyText:this.textEmpty,headers:[{name:this.textTitle,width:184},{name:this.textRange,width:180},{name:this.textPwd,width:82}],itemTemplate:_.template(['<div id="<%= id %>" class="list-item" style="width: 100%;display:inline-block;<% if (!lock) { %>pointer-events:none;<% } %>">','<div class="padding-right-5" style="width:184px;"><%= Common.Utils.String.htmlEncode(name) %></div>','<div class="padding-right-5" style="width:180px;"><%= range %></div>','<div style="width:70px;"><% if (pwd) { %>',this.txtYes,"<% } else { %>",this.txtNo,"<% } %></div>","<% if (lock) { %>",'<div class="lock-user"><%=lockuser%></div>',"<% } %>","</div>"].join("")),tabindex:1}),this.rangeList.store.comparator=function(t,e){t=t.get("name").toLowerCase(),e=e.get("name").toLowerCase();return t==e?0:t<e?-1:1},this.rangeList.on("item:select",_.bind(this.onSelectRangeItem,this)).on("item:keydown",_.bind(this.onKeyDown,this)).on("item:dblclick",_.bind(this.onDblClickItem,this)).on("entervalue",_.bind(this.onDblClickItem,this)),this.btnNewRange=new Common.UI.Button({el:$("#protect-ranges-btn-new")}),this.btnNewRange.on("click",_.bind(this.onEditRange,this,!1)),this.btnEditRange=new Common.UI.Button({el:$("#protect-ranges-btn-edit")}),this.btnEditRange.on("click",_.bind(this.onEditRange,this,!0)),this.btnDeleteRange=new Common.UI.Button({el:$("#protect-ranges-btn-delete")}),this.btnDeleteRange.on("click",_.bind(this.onDeleteRange,this)),this.afterRender()},getFocusedComponents:function(){return[this.btnNewRange,this.btnEditRange,this.btnDeleteRange,this.rangeList]},getDefaultFocusableComponent:function(){return this.rangeList},afterRender:function(){this._setDefaults(this.props)},_setDefaults:function(t){this.refreshRangeList(t,0),this.currentSheet=this.api.asc_getActiveWorksheetIndex(),this.api.asc_registerCallback("asc_onLockProtectedRangeManager",this.wrapEvents.onLockProtectedRangeManager),this.api.asc_registerCallback("asc_onUnLockProtectedRangeManager",this.wrapEvents.onUnLockProtectedRangeManager),this.api.asc_registerCallback("asc_onLockProtectedRange",this.wrapEvents.onLockProtectedRange),this.api.asc_registerCallback("asc_onUnLockProtectedRange",this.wrapEvents.onUnLockProtectedRange)},refreshRangeList:function(t,e){if(t){for(var i=[],s=0;s<t.length;s++){var o=t[s].asc_getIsLock();i.push({name:t[s].asc_getName()||"",pwd:t[s].asc_isPassword(),range:t[s].asc_getSqref()||"",rangeId:t[s].asc_getId(),props:t[s],rangeChanged:!1,lock:null!=o,lockuser:o?this.isUserVisible(o)?this.getUserName(o):this.lockText:this.guestText})}this.rangeList.store.reset(i)}var n,a=this,l=this.rangeList.store,r=l.length;0<r&&(null==e&&(e=0),_.isNumber(e)?(r-1<e&&(e=r-1),this.rangeList.selectByIndex(e),setTimeout(function(){a.rangeList.scrollToRecord(l.at(e))},50)):e&&(n=l.findWhere({name:e.asc_getName(!0)}))&&(this.rangeList.selectRecord(n),setTimeout(function(){a.rangeList.scrollToRecord(n)},50)),!0===this.userTooltip&&0<this.rangeList.cmpEl.find(".lock-user").length&&this.rangeList.cmpEl.on("mouseover",_.bind(a.onMouseOverLock,a)).on("mouseout",_.bind(a.onMouseOutLock,a))),this.updateButtons(),_.delay(function(){a.rangeList.scroller.update({alwaysVisibleY:!0})},100,this)},onMouseOverLock:function(t,e,i){var s;!0===this.userTooltip&&$(t.target).hasClass("lock-user")&&(s=this,t=$(t.target).tooltip({title:this.tipIsLocked,trigger:"manual"}).data("bs.tooltip"),this.userTooltip=t.tip(),this.userTooltip.css("z-index",parseInt(this.$window.css("z-index"))+10),t.show(),setTimeout(function(){s.userTipHide()},5e3))},userTipHide:function(){"object"==typeof this.userTooltip&&(this.userTooltip.remove(),this.userTooltip=void 0,this.rangeList.cmpEl.off("mouseover").off("mouseout"))},onMouseOutLock:function(t,e,i){"object"==typeof this.userTooltip&&this.userTipHide()},onEditRange:function(s){var o,t,n,e,i;this._isWarningVisible||(this.locked?Common.NotificationCenter.trigger("protectedrange:locked"):(t=(o=this).$window.offset(),n=this.rangeList.getSelectedRec(),s?i=n.get("props"):(i=new Asc.CProtectedRange).asc_setSqref(o.api.asc_getActiveRangeStr(Asc.referenceType.A)),e=[],this.rangeList.store.each(function(t){e.push(t.get("name").toLowerCase())}),i=new SSE.Views.ProtectDialog({title:s?o.txtEditRange:o.txtNewRange,type:"range",props:i,names:e,isEdit:s,api:o.api,buttons:["ok","cancel"],handler:function(t,e,i){"ok"==t&&(e&&i.asc_setPassword(e),s?(n.set("props",i),n.set("name",i.asc_getName()),n.set("range",i.asc_getSqref()),n.set("pwd",i.asc_isPassword()),n.set("rangeChanged",!0)):(n=o.rangeList.store.add({name:i.asc_getName(),pwd:i.asc_isPassword(),range:i.asc_getSqref(),props:i,isNew:!0,rangeChanged:!0,lock:!1,lockuser:this.guestText}),o.rangeList.selectRecord(n),o.rangeList.scrollToRecord(o.rangeList.getSelectedRec()),o.updateButtons()))}}).on("close",function(){o.show(),setTimeout(function(){o.getDefaultFocusableComponent().focus()},100)}),o.hide(),i.show(t.left+65,t.top)))},onDeleteRange:function(){var t,e=this.rangeList.store,i=this.rangeList.getSelectedRec();i&&(i.get("isNew")||this.deletedArr.push(i.get("props")),t=e.indexOf(i),e.remove(i),0<e.length&&this.rangeList.selectByIndex(t),this.rangeList.scrollToRecord(this.rangeList.getSelectedRec())),this.updateButtons()},getSettings:function(){var e=[];return this.rangeList.store.each(function(t){t.get("rangeChanged")&&e.push(t.get("props"))}),{arr:e,deletedArr:this.deletedArr}},onPrimary:function(){return!0},onDlgBtnClick:function(t){this.handler&&this.handler.call(this,t.currentTarget.attributes.result.value,this.getSettings()),this.close()},getUserName:function(t){var e=SSE.getCollection("Common.Collections.Users");if(e){e=e.findUser(t);if(e)return AscCommon.UserInfoParser.getParsedName(e.get("username"))}return this.guestText},isUserVisible:function(t){var e=SSE.getCollection("Common.Collections.Users");if(e){e=e.findUser(t);if(e)return!e.get("hidden")}return!0},onSelectRangeItem:function(t,e,i){if(i){this.userTipHide();if(_.isFunction(i.toJSON)){if(!i.get("selected"))return;i.toJSON(),this.currentNamedRange=_.indexOf(this.rangeList.store.models,i)}this.updateButtons()}},hide:function(){this.userTipHide(),Common.UI.Window.prototype.hide.call(this)},close:function(){this.userTipHide(),this.api.asc_unregisterCallback("asc_onLockProtectedRangeManager",this.wrapEvents.onLockProtectedRangeManager),this.api.asc_unregisterCallback("asc_onUnLockProtectedRangeManager",this.wrapEvents.onUnLockProtectedRangeManager),this.api.asc_unregisterCallback("asc_onLockProtectedRange",this.wrapEvents.onLockProtectedRange),this.api.asc_unregisterCallback("asc_onUnLockProtectedRange",this.wrapEvents.onUnLockProtectedRange),Common.UI.Window.prototype.close.call(this)},onKeyDown:function(t,e,i){i.keyCode!=Common.UI.Keys.DELETE||this.btnDeleteRange.isDisabled()||this.onDeleteRange()},onDblClickItem:function(t,e,i){this.btnEditRange.isDisabled()||this.onEditRange(!0)},onLockProtectedRangeManager:function(t){this.currentSheet===t&&(this.locked=!0,this.updateButtons(),!0===this.userTooltip&&0<this.rangeList.cmpEl.find(".lock-user").length&&this.rangeList.cmpEl.on("mouseover",_.bind(this.onMouseOverLock,this)).on("mouseout",_.bind(this.onMouseOutLock,this)))},onUnLockProtectedRangeManager:function(t){this.currentSheet===t&&(this.locked=!1,this.updateButtons())},onLockProtectedRange:function(t,e,i){this.currentSheet===t&&((t=this.rangeList.store.findWhere({rangeId:e}))&&(t.set("lockuser",i?this.isUserVisible(i)?this.getUserName(i):this.lockText:this.guestText),t.set("lock",!0),this.updateButtons()),!0===this.userTooltip&&0<this.rangeList.cmpEl.find(".lock-user").length&&this.rangeList.cmpEl.on("mouseover",_.bind(this.onMouseOverLock,this)).on("mouseout",_.bind(this.onMouseOutLock,this)))},onUnLockProtectedRange:function(t,e){this.currentSheet===t&&(t=this.rangeList.store.findWhere({rangeId:e}))&&(t.set("lockuser",""),t.set("lock",!1),this.updateButtons())},updateButtons:function(){var t=this.rangeList.getSelectedRec(),t=!!t&&t.get("lock"),e=this.rangeList.store.length;this.btnDeleteRange.setDisabled(e<1||t),this.btnEditRange.setDisabled(e<1||t)}},SSE.Views.ProtectRangesDlg||{}))}),define("text!spreadsheeteditor/main/app/template/ProtectedRangesManagerDlg.template",[],function(){return'<div class="settings-panel active">\n    <div class="inner-content">\n        <table cols="2" style="width: 100%;">\n            <tr>\n                <td colspan=2 class="padding-very-small">\n                    <label><%= scope.textRangesDesc %></label>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <label class="header"><%= scope.textFilter %></label>\n                    <div id="protect-edit-ranges-combo-filter" class="input-group-nr" style="width:170px;"></div>\n                </td>\n                <td id="protect-edit-group-btn" class="padding-small">\n                    <button type="button" class="btn btn-text-default margin-right-5" id="protect-edit-ranges-btn-new" style="min-width: 80px;"><%= scope.textNew %></button>\n                    <button type="button" class="btn btn-text-default margin-right-15" id="protect-edit-ranges-btn-edit" style="min-width: 80px;"><%= scope.textEdit %></button>\n                    <button type="button" class="btn btn-text-default" id="protect-edit-ranges-btn-delete" style="min-width: 80px;"><%= scope.textDelete %></button>\n                </td>\n            </tr>\n            <tr>\n                <td colspan=2 class="padding-very-small"></td>\n            </tr>\n            <tr>\n                <td colspan=2 class="padding-small">\n                    <div id="protect-edit-ranges-list" class="range-tableview" style="width:100%; height: 188px;"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>'}),define("spreadsheeteditor/main/app/view/ProtectedRangesManagerDlg",["text!spreadsheeteditor/main/app/template/ProtectedRangesManagerDlg.template","common/main/lib/view/AdvancedSettingsWindow","common/main/lib/component/ListView"],function(e){"use strict";SSE.Views=SSE.Views||{},SSE.Views.ProtectedRangesManagerDlg=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{alias:"ProtectedRangesManagerDlg",contentWidth:490,height:365,buttons:null},initialize:function(t){_.extend(this.options,{title:this.txtTitle,template:['<div class="box" style="height:'+(this.options.height-85)+'px;">','<div class="content-panel" style="padding: 0;">'+_.template(e)({scope:this})+"</div>","</div>",'<div class="footer center">','<button class="btn normal dlg-btn" result="cancel" style="width: 86px;">'+this.closeButtonText+"</button>","</div>"].join("")},t),this.api=t.api,this.handler=t.handler,this.locked=t.locked||!1,this.userTooltip=!0,this.currentRange=0,this.currentUser=t.currentUser,this.canRequestUsers=t.canRequestUsers,this.wrapEvents={onRefreshUserProtectedRangesList:_.bind(this.onRefreshUserProtectedRangesList,this),onLockUserProtectedManager:_.bind(this.onLockUserProtectedManager,this),onApiSheetChanged:_.bind(this.onApiSheetChanged,this)},Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var i=this;this.cmbFilter=new Common.UI.ComboBox({el:$("#protect-edit-ranges-combo-filter"),menuStyle:"min-width: 100%;",editable:!1,cls:"input-group-nr",data:[],takeFocusOnClose:!0}).on("selected",function(t,e){i.refreshRangeList(0)}),this.rangeList=new Common.UI.ListView({el:$("#protect-edit-ranges-list",this.$window),store:new Common.UI.DataViewStore,multiSelect:!0,simpleAddMode:!0,emptyText:this.textEmpty,headers:[{name:this.textTitle,width:184},{name:this.textRange,width:191},{name:this.textYouCan,width:70}],itemTemplate:_.template(['<div id="<%= id %>" class="list-item" style="width: 100%;display:inline-block;<% if (!lock) { %>pointer-events:none;<% } %>">','<div class="padding-right-5" style="width:184px;"><%= Common.Utils.String.htmlEncode(name) %></div>','<div class="padding-right-5" style="width:191px;"><%= range %></div>','<div style="width:70px;"><% if (canEdit) { %>',i.txtEdit,"<% } else { %>",i.txtView,"<% } %></div>","<% if (lock) { %>",'<div class="lock-user"><%=lockuser%></div>',"<% } %>","</div>"].join("")),tabindex:1}),this.rangeList.on("item:select",_.bind(this.onSelectRangeItem,this)).on("item:deselect",_.bind(this.onDeselectRangeItem,this)).on("item:keydown",_.bind(this.onKeyDown,this)).on("item:dblclick",_.bind(this.onDblClickItem,this)).on("entervalue",_.bind(this.onDblClickItem,this)),this.btnNewRange=new Common.UI.Button({el:$("#protect-edit-ranges-btn-new")}),this.btnNewRange.on("click",_.bind(this.onEditRange,this,!1)),this.btnEditRange=new Common.UI.Button({el:$("#protect-edit-ranges-btn-edit")}),this.btnEditRange.on("click",_.bind(this.onEditRange,this,!0)),this.btnDeleteRange=new Common.UI.Button({el:$("#protect-edit-ranges-btn-delete")}),this.btnDeleteRange.on("click",_.bind(this.onDeleteRange,this)),this.afterRender()},getFocusedComponents:function(){return[this.cmbFilter,this.btnNewRange,this.btnEditRange,this.btnDeleteRange,this.rangeList]},getDefaultFocusableComponent:function(){return this.rangeList},afterRender:function(){this._setDefaults()},_setDefaults:function(){this.onApiSheetChanged(),this.api.asc_registerCallback("asc_onRefreshUserProtectedRangesList",this.wrapEvents.onRefreshUserProtectedRangesList),this.api.asc_registerCallback("asc_onLockUserProtectedManager",this.wrapEvents.onLockUserProtectedManager),this.api.asc_registerCallback("asc_onSheetsChanged",this.wrapEvents.onApiSheetChanged)},refreshRangeList:function(t){var e=this.cmbFilter.getValue(),i=this.api.asc_getUserProtectedRanges(0<=e?this.api.asc_getWorksheetName(e):void 0);if(i){for(var s=[],o=this.currentUser.id,n=0;n<i.length;n++){var a=i[n].asc_getIsLock(),l=i[n].asc_getUsers();s.push({name:i[n].asc_getName()||"",range:i[n].asc_getRef()||"",rangeId:i[n].asc_getId()||"",users:l,props:i[n],canEdit:!!_.find(l,function(t){return t.asc_getId()===o}),lock:null!=a,lockuser:a?this.isUserVisible(a)?this.getUserName(a):this.lockText:this.guestText})}this.rangeList.store.reset(s)}var r,c=this,d=this.rangeList.store,e=d.length;0<e&&(null==t&&(t=0),_.isNumber(t)?(e-1<t&&(t=e-1),this.rangeList.selectByIndex(t),setTimeout(function(){c.rangeList.scrollToRecord(d.at(t))},50)):t&&(r=d.findWhere({rangeId:t.asc_getId()}))&&(this.rangeList.selectRecord(r),setTimeout(function(){c.rangeList.scrollToRecord(r)},50)),!0===this.userTooltip&&0<this.rangeList.cmpEl.find(".lock-user").length&&this.rangeList.cmpEl.on("mouseover",_.bind(c.onMouseOverLock,c)).on("mouseout",_.bind(c.onMouseOutLock,c))),this.updateButtons(),_.delay(function(){c.rangeList.scroller.update({alwaysVisibleY:!0})},100,this)},onMouseOverLock:function(t,e,i){var s;!0===this.userTooltip&&$(t.target).hasClass("lock-user")&&(s=this,t=$(t.target).tooltip({title:this.tipIsLocked,trigger:"manual"}).data("bs.tooltip"),this.userTooltip=t.tip(),this.userTooltip.css("z-index",parseInt(this.$window.css("z-index"))+10),t.show(),setTimeout(function(){s.userTipHide()},5e3))},userTipHide:function(){"object"==typeof this.userTooltip&&(this.userTooltip.remove(),this.userTooltip=void 0,this.rangeList.cmpEl.off("mouseover").off("mouseout"))},onMouseOutLock:function(t,e,i){"object"==typeof this.userTooltip&&this.userTipHide()},onEditRange:function(i){if(!this._isWarningVisible)if(this.locked)Common.NotificationCenter.trigger("protectedrange:locked");else{var s,o=this,t=o.$window.offset(),e=this.rangeList.getSelectedRec();if(i){if(!e||1!==e.length)return;s=e[0].get("props")}else(s=new Asc.CUserProtectedRange).asc_setRef(o.api.asc_getActiveRangeStr(Asc.referenceType.A));e=new SSE.Views.ProtectedRangesEditDlg({title:i?o.txtEditRange:o.txtNewRange,props:s,isEdit:i,api:o.api,canRequestUsers:o.canRequestUsers,currentUser:{id:o.currentUser.id,name:o.getUserName(o.currentUser.id,!0)},handler:function(t,e){"ok"==t&&(o.currentRange=e,i?o.api.asc_changeUserProtectedRange(s,e):o.api.asc_addUserProtectedRange(e))}}).on("close",function(){o.show(),setTimeout(function(){o.getDefaultFocusableComponent().focus()},100)});o.hide(),e.show(t.left+65,t.top)}},onDeleteRange:function(){var e,i=this.rangeList.getSelectedRec();i&&0<i.length&&((e=this)._isWarningVisible=!0,Common.UI.warning({msg:1<i.length?e.warnDeleteRanges:Common.Utils.String.format(e.warnDelete,i[0].get("name")),maxwidth:500,buttons:["ok","cancel"],callback:function(t){"ok"==t&&(e.currentRange=_.indexOf(e.rangeList.store.models,i[i.length-1])-i.length+1,e.api.asc_deleteUserProtectedRange(_.map(i,function(t){return t.get("props")}))),setTimeout(function(){e.getDefaultFocusableComponent().focus()},100),e._isWarningVisible=!1}}))},getSettings:function(){},onPrimary:function(){return!0},onDlgBtnClick:function(t){this.handler&&this.handler.call(this,t.currentTarget.attributes.result.value,this.getSettings()),this.close()},getUserName:function(t,e){var i=SSE.getCollection("Common.Collections.Users");if(i){e=e?i.findOriginalUser(t):i.findUser(t);if(e)return AscCommon.UserInfoParser.getParsedName(e.get("username"))}return this.guestText},isUserVisible:function(t){var e=SSE.getCollection("Common.Collections.Users");if(e){e=e.findUser(t);if(e)return!e.get("hidden")}return!0},onSelectRangeItem:function(t,e,i){if(i){this.userTipHide();if(_.isFunction(i.toJSON)){if(!i.get("selected"))return;i.toJSON(),this.currentRange=_.indexOf(this.rangeList.store.models,i)}this.updateButtons()}},onDeselectRangeItem:function(t,e,i){this.userTipHide(),this.updateButtons()},hide:function(){this.userTipHide(),Common.UI.Window.prototype.hide.call(this)},close:function(){this.userTipHide(),this.api.asc_unregisterCallback("asc_onRefreshUserProtectedRangesList",this.wrapEvents.onRefreshUserProtectedRangesList),this.api.asc_unregisterCallback("asc_onLockUserProtectedManager",this.wrapEvents.onLockUserProtectedManager),this.api.asc_unregisterCallback("asc_onSheetsChanged",this.wrapEvents.onApiSheetChanged),Common.UI.Window.prototype.close.call(this)},onKeyDown:function(t,e,i){i.keyCode!=Common.UI.Keys.DELETE||this.btnDeleteRange.isDisabled()||this.onDeleteRange()},onDblClickItem:function(t,e,i){this.btnEditRange.isDisabled()||this.onEditRange(!0)},onRefreshUserProtectedRangesList:function(){this.refreshRangeList(this.currentRange)},onLockUserProtectedManager:function(t){this.locked=!!t,this.updateButtons(),this.locked&&!0===this.userTooltip&&0<this.rangeList.cmpEl.find(".lock-user").length&&this.rangeList.cmpEl.on("mouseover",_.bind(this.onMouseOverLock,this)).on("mouseout",_.bind(this.onMouseOutLock,this))},updateButtons:function(){var t=this.rangeList.getSelectedRec(),e=!(t&&0<t.length)||_.find(t,function(t){return!!t.get("lock")}),i=this.rangeList.store.length,s=!!(t&&0<t.length)&&!_.find(t,function(t){return!t.get("canEdit")});this.btnDeleteRange.setDisabled(i<1||e||!s||!!this.currentUser.anonymous),this.btnEditRange.setDisabled(i<1||!(t&&1===t.length)||e||!s||!!this.currentUser.anonymous),this.btnNewRange.setDisabled(!!this.currentUser.anonymous)},onApiSheetChanged:function(){for(var t=0<this.cmbFilter.store.length?this.cmbFilter.getValue():this.api.asc_getActiveWorksheetIndex(),e=this.api.asc_getWorksheetsCount(),i=-1,s=[];++i<e;)this.api.asc_isWorksheetHidden(i)||s.push({displayValue:this.api.asc_getWorksheetName(i),value:i});this.cmbFilter.setData([{value:-1,displayValue:this.textFilterAll}].concat(s)),this.cmbFilter.setValue(t,-1),this.refreshRangeList(this.cmbFilter.getValue()!==t?0:this.currentRange)}},SSE.Views.ProtectedRangesManagerDlg||{}))}),define("spreadsheeteditor/main/app/view/ProtectedRangesEditDlg",["common/main/lib/component/Window"],function(){"use strict";SSE.Views.ProtectedRangesEditDlg=Common.UI.Window.extend(_.extend({initialize:function(t){var e={};_.extend(e,{title:t.title,cls:"modal-dlg",width:300,height:"auto",buttons:["ok","cancel"]},t),this.handler=t.handler,this.props=t.props,this.isEdit=t.isEdit,this.api=t.api,this.currentUser=t.currentUser,this.canRequestUsers=t.canRequestUsers,this.template=t.template||['<div class="box">','<div class="input-row">',"<label>"+this.txtRangeName+"</label>","</div>",'<div id="id-protected-range-name-txt" class="input-row" style="margin-bottom: 5px;"></div>','<div class="input-row">',"<label>"+this.txtRange+"</label>","</div>",'<div id="id-protected-range-txt" class="input-row" style="margin-bottom: 8px;"></div>',"<% if (canRequestUsers) { %>",'<div class="input-row">',"<label>"+this.txtWhoCanEdit+"</label>","</div>",'<div id="id-protected-range-cmb-user" class="input-row input-group-nr" style="margin-bottom: 8px;"></div>','<div id="id-protected-range-list-user" class="input-group-nr" style="height: 95px;"></div>',"<% } else { %>",'<div class="input-row" style="margin-bottom: 8px;">',"<label>"+this.txtYouCanEdit+"</label>","</div>","<% } %>","</div>"].join(""),e.tpl=_.template(this.template)(e),this._userStr="",this._initSettings=!0,Common.UI.Window.prototype.initialize.call(this,e)},render:function(){Common.UI.Window.prototype.render.call(this);var e=this;this.$window.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.inputRangeName=new Common.UI.InputField({el:this.$window.find("#id-protected-range-name-txt"),allowBlank:!1,blankError:this.txtEmpty,style:"width: 100%;",maxLength:255,validateOnBlur:!1,validateOnChange:!1,validation:function(t){return""==t||(e.api.asc_checkUserProtectedRangeName(t)===Asc.c_oAscDefinedNameReason.OK||e.textInvalidName)}}),this.txtDataRange=new Common.UI.InputFieldBtn({el:this.$window.find("#id-protected-range-txt"),name:"range",style:"width: 100%;",allowBlank:!1,btnHint:this.textSelectData,blankError:this.txtEmpty,validateOnChange:!0,validateOnBlur:!1,validation:function(t){return e.api.asc_checkDataRange(Asc.c_oAscSelectionDialogType.Chart,t,!0)!==Asc.c_oAscError.ID.DataRangeError||e.textInvalidRange}}),this.txtDataRange.on("button:click",_.bind(this.onSelectData,this)),this.cmbUser=new Common.UI.ComboBox({el:this.$window.find("#id-protected-range-cmb-user"),cls:"input-group-nr",menuStyle:"min-width: 100%;max-height: 233px;",editable:!0,data:[],placeHolder:this.txtYouCanEdit,disabled:!0,takeFocusOnClose:!0,itemsTemplate:_.template(["<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%- item.value %>" <% if (item.hasDivider) { %> class="border-top" style="margin-top: 5px;padding-top: 5px;" <% } %>><a tabindex="-1" type="menuitem" style ="display: flex; flex-direction: column;">','<label><%= scope.getDisplayValue(item) %></label><label class="comment-text"><%= Common.Utils.String.htmlEncode(item.value) %></label></a></li>',"<% }); %>"].join(""))}),this.cmbUser.on("selected",this.onUserSelected.bind(this)),this.cmbUser.on("changing",this.onUserChanging.bind(this)),this.cmbUser.on("show:after",_.bind(this.onCmbUserOpen,this)),this.cmbUser.on("show:before",_.bind(this.onCmbUserBeforeOpen,this)),this.cmbUser.on("hide:after",_.bind(this.onCmbUserAfterHide,this)),Common.Utils.isChrome&&this.cmbUser._input&&this.cmbUser._input.attr("autocomplete","1"),this.listUser=new Common.UI.ListView({el:this.$window.find("#id-protected-range-list-user"),store:new Common.UI.DataViewStore,itemTemplate:_.template(['<div id="<%= id %>" class="list-item" style="width: 100%;display:inline-block;">','<div class="margin-right-4" style="width:115px;display: inline-block;vertical-align: middle; overflow: hidden; text-overflow: ellipsis;white-space: pre;"><%= Common.Utils.String.htmlEncode(displayName) %></div>','<div style="width:135px;display: inline-block;vertical-align: middle; overflow: hidden; text-overflow: ellipsis;white-space: pre;"><%= Common.Utils.String.htmlEncode(email) %></div>','<% if (typeof isCurrent === "undefined" || !isCurrent) { %>','<div class="listitem-icon toolbar__icon btn-cc-remove"></div>',"<% } %>","</div>"].join("")),emptyText:"",tabindex:1}),this.listUser.on("item:keydown",_.bind(this.onKeyDown,this)),this.listUser.on("item:click",_.bind(this.onListUserClick,this)),this.afterRender()},getFocusedComponents:function(){return[this.inputRangeName,this.txtDataRange,this.cmbUser,this.listUser]},getDefaultFocusableComponent:function(){return this.inputRangeName},close:function(){this.canRequestUsers&&Common.NotificationCenter.off("mentions:setusers",this.binding.onUserMenuCallback),Common.UI.Window.prototype.close.apply(this,arguments)},afterRender:function(){this.canRequestUsers&&(this.binding||(this.binding={}),this.binding.onUserMenuCallback=_.bind(this.onUserMenuCallback,this),Common.NotificationCenter.on("mentions:setusers",this.binding.onUserMenuCallback)),this._setDefaults(this.props)},onPrimary:function(t){return this._handleInput("ok"),!1},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},_handleInput:function(t){if(this.handler){if("ok"==t){if(this.inputRangeName&&!0!==this.inputRangeName.checkValidate())return void this.inputRangeName.focus();if(this.txtDataRange&&!0!==this.txtDataRange.checkValidate())return void this.txtDataRange.focus()}this.handler.call(this,t,this.getSettings())}this.close()},_setDefaults:function(t){var e,i,s;t&&(this.inputRangeName.setValue(t.asc_getName()),this.txtDataRange.setValue(t.asc_getRef()),this.listUser.store.add({value:this.currentUser.id,name:this.currentUser.name,displayName:this.currentUser.name+" ("+this.textYou+")",email:"",isCurrent:!0}),(t=(e=this).props.asc_getUsers())&&0<t.length&&(i=e.listUser.store,s=1,t.forEach(function(t){t.asc_getId()!==e.currentUser.id&&i.add({value:t.asc_getId(),name:t.asc_getName()||e.textAnonymous,displayName:t.asc_getName()||e.textAnonymous+" "+s++,email:""})})),this.onUserMenu(!0))},getSettings:function(){var t=new Asc.CUserProtectedRange,i=(t.asc_setName(this.inputRangeName.getValue()),t.asc_setRef(this.txtDataRange.getValue()),[]);return this.listUser.store.each(function(t){var e=new Asc.CUserProtectedRangeUserInfo;e.asc_setId(t.get("value")),e.asc_setName(t.get("name")),i.push(e)}),t.asc_setUsers(i),t},onSelectData:function(){var t,e,i=this;i.api&&(t=new SSE.Views.CellRangeDialog({handler:function(t,e){"ok"==e&&(i.dataRangeValid=t.getSettings(),i.txtDataRange.setValue(i.dataRangeValid),i.txtDataRange.checkValidate())}}).on("close",function(){i.show(),_.delay(function(){i.txtDataRange.focus()},1)}),e=i.$window.offset(),i.hide(),t.show(e.left+65,e.top+77),t.setSettings({api:i.api,range:_.isEmpty(i.txtDataRange.getValue())||1!=i.txtDataRange.checkValidate()?i.dataRangeValid:i.txtDataRange.getValue(),type:Asc.c_oAscSelectionDialogType.Chart,validation:function(){return!0}}))},onUserSelected:function(t,e,i){var s=this.listUser.store,o=e.userId;void 0===o||""===o||s.findWhere({value:o})||s.add({value:o,name:e.displayValue,displayName:e.displayValue,email:e.value}),this.cmbUser.setRawValue(this._userStr)},onCmbUserAfterHide:function(t,e,i){this._forceOpen=!1},onUserChanging:function(t,e){this._userStr=e,this.onUserMenu()},onCmbUserBeforeOpen:function(t,e,i){t.store.length<1&&(e.preventDefault(),this.onUserMenu())},onCmbUserOpen:function(t,e,i){this.onUserMenu()},onUserMenu:function(t){this._forceOpen=!t,Common.UI.ExternalUsers.get("protect")},onUserMenuCallback:function(t,i){var s,o,e,n;"protect"===t&&(this._initSettings&&(s=this,i&&_.find(i,function(t){return void 0!==t.id&&null!==t.id})&&(s.cmbUser.setDisabled(!1),s.cmbUser._input&&s.cmbUser._input.attr("placeholder",s.userPlaceholder)),i&&0<i.length&&this.listUser.store.each(function(t){var e;t.get("value")!==s.currentUser.id&&(e=_.findWhere(i,{id:t.get("value")}))&&(e.name&&t.set("name",e.name),e.name&&t.set("displayName",e.name),e.email&&t.set("email",e.email))}),this._initSettings=!1),(this._forceOpen||this.cmbUser.isMenuOpen())&&(o=[],t=this.cmbUser.getRawValue(),i&&0<i.length&&(e=t.toLowerCase(),i=_.filter(i,function(t){return void 0!==t.id&&null!==t.id&&(!e||t.email&&0===t.email.toLowerCase().indexOf(e)||t.name&&0===t.name.toLowerCase().indexOf(e))}),n=!1,_.each(i,function(t,e){o.push({value:t.email||"",displayValue:t.name||"",userId:t.id,hasDivider:!t.hasAccess&&!n&&0<e}),t.hasAccess||(n=!0)})),this.cmbUser.setData(o),this.cmbUser.setRawValue(t),0<o.length?this.cmbUser.openMenu():(this.cmbUser.closeMenu(),this.cmbUser.focus())))},onKeyDown:function(t,e,i){i.keyCode==Common.UI.Keys.DELETE&&this.onDeleteUser()},onDeleteUser:function(t){(t=t||this.listUser.getSelectedRec())&&!t.get("isCurrent")&&this.listUser.store.remove(t)},onListUserClick:function(t,e,i,s){s&&(s=$(s.target))&&s.hasClass("listitem-icon")&&this.onDeleteUser(i)}},SSE.Views.ProtectedRangesEditDlg||{}))}),define("spreadsheeteditor/main/app/controller/WBProtection",["core","common/main/lib/view/Protection","spreadsheeteditor/main/app/view/WBProtection","spreadsheeteditor/main/app/view/ProtectDialog","spreadsheeteditor/main/app/view/ProtectRangesDlg","spreadsheeteditor/main/app/view/ProtectedRangesManagerDlg","spreadsheeteditor/main/app/view/ProtectedRangesEditDlg"],function(){"use strict";SSE.Controllers.WBProtection=Backbone.Controller.extend(_.extend({models:[],collections:[],views:["WBProtection"],sdkViewName:"#id_main",initialize:function(){this.addListeners({WBProtection:{"protect:workbook":_.bind(this.onWorkbookClick,this),"protect:sheet":_.bind(this.onSheetClick,this),"protect:allow-ranges":_.bind(this.onAllowRangesClick,this),"protect:lock-options":_.bind(this.onLockOptionClick,this),"protect:range":_.bind(this.onProtectRangeClick,this)}})},onLaunch:function(){this._state={},this.wsLockOptions=["SelectLockedCells","SelectUnlockedCells","FormatCells","FormatColumns","FormatRows","InsertColumns","InsertRows","InsertHyperlinks","DeleteColumns","DeleteRows","Sort","AutoFilter","PivotTables","Objects","Scenarios"],Common.enumLock&&this.wsLockOptions.forEach(function(t){Common.enumLock[t]=t}),Common.NotificationCenter.on("app:ready",this.onAppReady.bind(this)),Common.NotificationCenter.on("protect:sheet",_.bind(this.onSheetClick,this))},setConfig:function(t,e){this.setApi(e),t&&(this.sdkViewName=t.sdkviewname||this.sdkViewName)},setApi:function(t){t&&(this.api=t,this.api.asc_registerCallback("asc_onChangeProtectWorkbook",_.bind(this.onChangeProtectWorkbook,this)),this.api.asc_registerCallback("asc_onChangeProtectWorksheet",_.bind(this.onChangeProtectSheet,this)),this.api.asc_registerCallback("asc_onActiveSheetChanged",_.bind(this.onActiveSheetChanged,this)),this.api.asc_registerCallback("asc_onSelectionChanged",_.bind(this.onApiSelectionChanged,this)))},setMode:function(t){return this.appConfig=t,this.appConfig.isEdit&&this.appConfig.canProtect&&(this.view=this.createView("WBProtection",{mode:t})),this},createToolbarPanel:function(){if(this.view)return this.view.getPanel()},getView:function(t){return!t&&this.view?this.view:Backbone.Controller.prototype.getView.call(this,t)},onWorkbookClick:function(t){var i,s,o;this.view.btnProtectWB.toggle(!t,!0),t?(i=this,new SSE.Views.ProtectDialog({type:"workbook",handler:function(t,e){"ok"==(s=t)&&((t=i.api.asc_getProtectedWorkbook()).asc_setLockStructure(e),i.api.asc_setProtectedWorkbook(t)),Common.NotificationCenter.trigger("edit:complete")}}).on("close",function(){"ok"!==s&&i.view.btnProtectWB.toggle(!1,!0)}).show()):(o=(i=this).api.asc_getProtectedWorkbook()).asc_isPassword()?new Common.Views.OpenDialog({title:i.view.txtWBUnlockTitle,closable:!0,type:Common.Utils.importTextType.DRM,txtOpenFile:i.view.txtWBUnlockDescription,validatePwd:!1,handler:function(t,e){"ok"==(s=t)&&(i.api&&(o.asc_setLockStructure(e&&e.drmOptions?e.drmOptions.asc_getPassword():void 0),i.api.asc_setProtectedWorkbook(o)),Common.NotificationCenter.trigger("edit:complete"))}}).on("close",function(){"ok"!==s&&i.view.btnProtectWB.toggle(!0,!0)}).show():(o.asc_setLockStructure(),i.api.asc_setProtectedWorkbook(o))},onSheetClick:function(t){var s,o,i;this.view.btnProtectSheet.toggle(!t,!0),t?(i=(s=this).api.asc_getProtectedSheet(),new SSE.Views.ProtectDialog({type:"sheet",props:i,api:s.api,handler:function(t,e,i){"ok"==(o=t)&&(i.asc_setSheet(e),s.api.asc_setProtectedSheet(i)),Common.NotificationCenter.trigger("edit:complete")}}).on("close",function(){"ok"!==o&&s.view.btnProtectSheet.toggle(!1,!0)}).show()):(i=(s=this).api.asc_getProtectedSheet()).asc_isPassword()?new Common.Views.OpenDialog({title:s.view.txtSheetUnlockTitle,closable:!0,type:Common.Utils.importTextType.DRM,txtOpenFile:s.view.txtSheetUnlockDescription,validatePwd:!1,handler:function(t,e){"ok"==(o=t)&&(s.api&&(i.asc_setSheet(e&&e.drmOptions?e.drmOptions.asc_getPassword():void 0),s.api.asc_setProtectedSheet(i)),Common.NotificationCenter.trigger("edit:complete"))}}).on("close",function(){"ok"!==o&&s.view.btnProtectSheet.toggle(!0,!0)}).show():(i.asc_setSheet(),s.api.asc_setProtectedSheet(i))},onAllowRangesClick:function(){var i=this,t=i.api.asc_getProtectedRanges();new SSE.Views.ProtectRangesDlg({api:i.api,props:t,handler:function(t,e){"protect-sheet"==t?(i.api.asc_setProtectedRanges(e.arr,e.deletedArr),i.onSheetClick(!0)):"ok"==t&&i.api.asc_setProtectedRanges(e.arr,e.deletedArr),Common.NotificationCenter.trigger("edit:complete")}}).show()},onLockOptionClick:function(t,e){switch(t){case 0:this.api.asc_setCellLocked("checked"==e);break;case 1:(i=new Asc.asc_CImgProperty).asc_putProtectionLocked("checked"==e),this.api.asc_setGraphicObjectProps(i);break;case 2:var i;(i=new Asc.asc_CImgProperty).asc_putProtectionLockText("checked"==e),this.api.asc_setGraphicObjectProps(i);break;case 3:this.api.asc_setCellHiddenFormulas("checked"==e)}Common.NotificationCenter.trigger("edit:complete",this)},onProtectRangeClick:function(){new SSE.Views.ProtectedRangesManagerDlg({api:this.api,canRequestUsers:this.appConfig.canRequestUsers,currentUser:this.appConfig.user,handler:function(t,e){Common.NotificationCenter.trigger("edit:complete")}}).show()},onAppReady:function(t){var e;this.view&&(e=this,new Promise(function(t){t()}).then(function(){e.view.btnProtectWB.toggle(e.api.asc_isProtectedWorkbook(),!0);var t=e.getWSProps();e.view.btnProtectSheet.toggle(t.wsLock,!0),Common.Utils.lockControls(Common.enumLock.Objects,t.wsProps.Objects,{array:[e.view.chLockedText,e.view.chLockedShape]}),Common.Utils.lockControls(Common.enumLock.wsLock,t.wsLock,{array:[e.view.btnAllowRanges]})}))},onChangeProtectWorkbook:function(){this.view&&this.view.btnProtectWB.toggle(this.api.asc_isProtectedWorkbook(),!0)},onChangeProtectSheet:function(){var t=this.getWSProps(!0);this.view&&t&&(this.view.btnProtectSheet.toggle(t.wsLock,!0),Common.Utils.lockControls(Common.enumLock.Objects,t.wsProps.Objects,{array:[this.view.chLockedText,this.view.chLockedShape]}),Common.Utils.lockControls(Common.enumLock.wsLock,t.wsLock,{array:[this.view.btnAllowRanges]})),Common.NotificationCenter.trigger("protect:wslock",t)},onActiveSheetChanged:function(){this.onChangeProtectSheet()},getWSProps:function(t){var e,i;if(this.appConfig&&(this.appConfig.isEdit||this.appConfig.isRestrictedEdit))return!t&&this._state.protection||(t=!!this.api.asc_isProtectedSheet(),e=[],t?(e=[],(i=this.api.asc_getProtectedSheet())&&this.wsLockOptions.forEach(function(t){e[t]=!!i["asc_get"+t]&&i["asc_get"+t]()})):this.wsLockOptions.forEach(function(t){e[t]=!1}),this._state.protection={wsLock:t,wsProps:e}),this._state.protection},onApiSelectionChanged:function(t){if(this.view&&t&&!(0<$(".asc-window.enable-key-events:visible").length)){var e=t.asc_getSelectionType(),i=e===Asc.c_oAscSelectionType.RangeCells||e===Asc.c_oAscSelectionType.RangeCol||e===Asc.c_oAscSelectionType.RangeRow||e===Asc.c_oAscSelectionType.RangeMax,i=(Common.Utils.lockControls(Common.enumLock.selRange,i,{array:[this.view.chLockedText,this.view.chLockedShape]}),t.asc_getXfs());if(this.view.chLockedCell.setValue(!!i.asc_getLocked(),!0),this.view.chHiddenFormula.setValue(!!i.asc_getHidden(),!0),e===Asc.c_oAscSelectionType.RangeSlicer||e===Asc.c_oAscSelectionType.RangeImage||e===Asc.c_oAscSelectionType.RangeShape||e===Asc.c_oAscSelectionType.RangeShapeText||e===Asc.c_oAscSelectionType.RangeChart||e===Asc.c_oAscSelectionType.RangeChartText)for(var s=this.api.asc_getGraphicObjectProps(),o=0;o<s.length;o++)if(s[o].asc_getObjectType()==Asc.c_oAscTypeSelectElement.Image){var n=s[o].asc_getObjectValue(),a=n.asc_getProtectionLockText(),n=n.asc_getProtectionLocked();this.view.chLockedText.setValue(void 0!==a?!!a:"indeterminate",!0),this.view.chLockedShape.setValue(void 0!==n?!!n:"indeterminate",!0),Common.Utils.lockControls(Common.enumLock.wsLockText,null===a,{array:[this.view.chLockedText]}),Common.Utils.lockControls(Common.enumLock.wsLockShape,null===n,{array:[this.view.chLockedShape]});break}Common.Utils.lockControls(Common.enumLock.userProtected,!!t.asc_getUserProtected(),{array:[this.view.chLockedCell,this.view.chHiddenFormula]})}}},SSE.Controllers.WBProtection||{}))}),void 0===Common&&(Common={}),Common.Models=Common.Models||{},define("common/main/lib/model/HistoryVersion",["underscore","backbone","common/main/lib/component/BaseView"],function(t,e){"use strict";Common.Models.HistoryVersion=e.Model.extend({defaults:function(){return{version:0,revision:0,changeid:void 0,userid:void 0,username:"Guest",usercolor:"#ff0000",created:void 0,id:Common.UI.getId(),url:"",urlDiff:"",urlGetTime:"",docId:"",docIdPrev:"",token:"",arrColors:[],markedAsVersion:!1,canRestore:!1,isRevision:!0,hasChanges:!1,isExpanded:!0,isVisible:!0,allowSelected:!0,selected:!1,serverVersion:0,fileType:"docx"}}})}),void 0===Common&&(Common={}),Common.Collections=Common.Collections||{},define("common/main/lib/collection/HistoryVersions",["underscore","backbone","common/main/lib/model/HistoryVersion"],function(t,e){"use strict";Common.Collections.HistoryVersions=e.Collection.extend({model:Common.Models.HistoryVersion,findRevision:function(t){return this.findWhere({revision:t})},findRevisions:function(t){return this.where({revision:t})},hasChanges:function(){return!!this.findWhere({isRevision:!1})},hasCollapsed:function(){return!!this.findWhere({isRevision:!0,hasChanges:!0,isExpanded:!1})}})}),void 0===Common&&(Common={}),Common.Views=Common.Views||{},define("common/main/lib/view/History",["common/main/lib/util/utils","common/main/lib/component/BaseView","common/main/lib/component/Layout"],function(t){"use strict";Common.Views.History=Common.UI.BaseView.extend(_.extend({el:"#left-panel-history",storeHistory:void 0,template:_.template(['<div id="history-box" class="layout-ct vbox">','<div id="history-header" class="">','<div id="history-btn-back"><%=scope.textCloseHistory%></div>',"</div>",'<div id="history-list" class="">',"</div>",'<div id="history-expand-changes" class="">','<div id="history-btn-expand"><%=scope.textHideAll%></div>',"</div>","</div>"].join("")),initialize:function(t){_.extend(this,t),Common.UI.BaseView.prototype.initialize.call(this,arguments);t=Common.localStorage.getKeysFilter();this.appPrefix=t&&t.length?t.split(",")[0]:""},render:function(t){t=t||this.el,$(t).html(this.template({scope:this})).width((parseInt(Common.localStorage.getItem(this.appPrefix+"mainmenu-width"))||MENU_SCALE_PART)-SCALE_MIN),this.viewHistoryList=new Common.UI.DataView({el:$("#history-list"),store:this.storeHistory,enableKeyEvents:!1,itemTemplate:_.template(['<div id="<%= id %>" class="history-item-wrap <% if (!isVisible) { %>hidden<% } %>" ','style="display: block; <% if (!isRevision) { %>'+(Common.UI.isRTL()?"padding-right: 40px;":"padding-left: 40px;")+'<% } %><% if (canRestore && selected) { %>padding-bottom: 6px;<% } %>">','<div class="user-date"><%= created %></div>',"<% if (markedAsVersion) { %>",'<div class="user-version">'+this.textVer+"<%=version%></div>","<% } %>","<% if (isRevision && hasChanges) { %>",'<div class="revision-expand  <% if (isExpanded) { %>up<% } %>"></div>',"<% } %>",'<div class="user-name">','<div class="color" style="display: inline-block; background-color:<%=usercolor%>;" >',"</div><%= Common.Utils.String.htmlEncode(AscCommon.UserInfoParser.getParsedName(username)) %>","</div>","<% if (canRestore && selected) { %>",'<label class="revision-restore" role="presentation" tabindex="-1">'+this.textRestore+"</label>","<% } %>","</div>"].join(""))});function e(t,e,i){i.get("isRevision")&&(e.btnTip&&(e.btnTip.dontShow=!0,e.btnTip.tip().remove(),e.btnTip=null),0<(i=$(e.el).find(".revision-expand").tooltip({title:i.get("isExpanded")?l.textHide:l.textShow,placement:"cursor"})).length&&(e.btnTip=i.data("bs.tooltip")))}var l=this;this.viewHistoryList.onClickItem=function(t,e,i){var s=$(i.target);if(s&&s.hasClass("revision-expand")){var o=!e.get("isExpanded");e.set("isExpanded",o);var n=l.storeHistory.findRevisions(e.get("revision"));if(n&&1<n.length)for(var a=1;a<n.length;a++)n[a].set("isVisible",o);this.scroller.update({minScrollbarLength:this.minScrollbarLength})}else Common.UI.DataView.prototype.onClickItem.call(this,t,e,i);l.btnExpand.cmpEl.text(l.storeHistory.hasCollapsed()?l.textShowAll:l.textHideAll)};return this.viewHistoryList.on("item:add",e),this.viewHistoryList.on("item:change",e),this.btnBackToDocument=new Common.UI.Button({el:$("#history-btn-back"),enableToggle:!1}),this.btnExpand=new Common.UI.Button({el:$("#history-btn-expand"),enableToggle:!1}),this.trigger("render:after",this),this}},Common.Views.History||{}))}),define("common/main/lib/controller/History",["core","common/main/lib/collection/HistoryVersions","common/main/lib/view/History"],function(){"use strict";Common.Controllers.History=Backbone.Controller.extend(_.extend({models:[],collections:["Common.Collections.HistoryVersions"],views:["Common.Views.History"],initialize:function(){this.currentChangeId=-1,this.currentArrColors=[],this.currentDocId="",this.currentDocIdPrev="",this.currentRev=0,this.currentServerVersion=0,this.currentUserId="",this.currentUserName="",this.currentUserColor="",this.currentDateCreated=""},events:{},onLaunch:function(){this.panelHistory=this.createView("Common.Views.History",{storeHistory:this.getApplication().getCollection("Common.Collections.HistoryVersions")}),this.panelHistory.storeHistory.on("reset",_.bind(this.onResetStore,this)),this.panelHistory.on("render:after",_.bind(this.onAfterRender,this)),Common.Gateway.on("sethistorydata",_.bind(this.onSetHistoryData,this))},setApi:function(t){return this.api=t,this.api.asc_registerCallback("asc_onDownloadUrl",_.bind(this.onDownloadUrl,this)),this.api.asc_registerCallback("asc_onExpiredToken",_.bind(this.onExpiredToken,this)),this},setMode:function(t){(this.mode=t).canHistoryClose||(this.panelHistory.$el.find("#history-header").hide(),this.panelHistory.$el.find("#history-list").css("padding-top",0))},onAfterRender:function(t){t.viewHistoryList.on("item:click",_.bind(this.onSelectRevision,this)),t.btnBackToDocument.on("click",_.bind(this.onClickBackToDocument,this)),t.btnExpand.on("click",_.bind(this.onClickExpand,this))},onResetStore:function(){var t=this.panelHistory.storeHistory.hasChanges();this.panelHistory.$el.find("#history-expand-changes")[t?"show":"hide"](),this.panelHistory.$el.find("#history-list").css("padding-bottom",t?"45px":0)},onDownloadUrl:function(t,e){void 0!==this.isFromSelectRevision&&Common.Gateway.requestRestore(this.isFromSelectRevision,t,e),this.isFromSelectRevision=void 0},onSelectRevision:function(t,e,i,s){if(s){var s=$(s.target);if(s&&s.hasClass("revision-restore"))return void(i.get("isRevision")?Common.Gateway.requestRestore(i.get("revision"),void 0,i.get("fileType")):(this.isFromSelectRevision=i.get("revision"),s=Asc.c_oAscFileType[(i.get("fileType")||"").toUpperCase()]||Asc.c_oAscFileType.DOCX,this.api.asc_DownloadAs(new Asc.asc_CDownloadOptions(s,!0))))}!t&&i&&this.panelHistory.viewHistoryList.scrollToRecord(i);var o,n,s=i.get("url"),a=i.get("revision"),t=new Date;this.currentChangeId=i.get("changeid"),this.currentArrColors=i.get("arrColors"),this.currentDocId=i.get("docId"),this.currentDocIdPrev=i.get("docIdPrev"),this.currentRev=a,this.currentServerVersion=i.get("serverVersion"),this.currentUserId=i.get("userid"),this.currentUserName=i.get("username"),this.currentUserColor=i.get("usercolor"),this.currentDateCreated=i.get("created"),_.isEmpty(s)||3e5<t-i.get("urlGetTime")?(o=this).timerId||(o.timerId=setTimeout(function(){o.timerId=0},3e4),_.delay(function(){Common.Gateway.requestHistoryData(a)},10)):((t=this.getApplication().getController("Common.Controllers.Comments"))&&(t.onApiHideComment(),t.clearCollections()),t=i.get("urlDiff"),i=i.get("token"),(n=new Asc.asc_CVersionHistory).asc_setDocId(_.isEmpty(t)?this.currentDocId:this.currentDocIdPrev),n.asc_setUrl(s),n.asc_setUrlChanges(t),n.asc_setCurrentChangeId(this.currentChangeId),n.asc_setArrColors(this.currentArrColors),n.asc_setToken(i),n.asc_setIsRequested(!1),n.asc_setServerVersion(this.currentServerVersion),n.asc_SetUserId(this.currentUserId),n.asc_SetUserName(this.currentUserName),n.asc_SetUserColor(this.currentUserColor),n.asc_SetDateOfRevision(this.currentDateCreated),this.api.asc_showRevision(n),(s=this.getApplication().getController("Common.Controllers.ReviewChanges"))&&s.onApiShowChange())},onSetHistoryData:function(t){if(this.mode.canUseHistory)if(this.timerId&&(clearTimeout(this.timerId),this.timerId=0),t.data.error){var e={title:this.notcriticalErrorTitle,msg:t.data.error,iconCls:"warn",buttons:["ok"]};Common.UI.alert(e)}else{var e=this.getApplication().getController("Common.Controllers.Comments"),e=(e&&(e.onApiHideComment(),e.clearCollections()),t.data),i=this.getApplication().getCollection("Common.Collections.HistoryVersions");if(i&&null!==e){var s,o=i.findRevisions(e.version),n=new Date,a=t.data.previous&&void 0!==this.currentChangeId?t.data.changesUrl:null,l=(!_.isEmpty(a)&&t.data.previous?t.data.previous:t.data).url,r=(!_.isEmpty(a)&&t.data.previous?t.data.previous:t.data).fileType,c=t.data.key||this.currentDocId,d=t.data.previous&&t.data.previous.key?t.data.previous.key:this.currentDocIdPrev,h=t.data.token;if(o&&0<o.length)for(var p=0;p<o.length;p++)(s=o[p]).set("url",l,{silent:!0}),s.set("urlDiff",a,{silent:!0}),s.set("urlGetTime",n,{silent:!0}),t.data.key&&(s.set("docId",c,{silent:!0}),s.set("docIdPrev",d,{silent:!0})),s.set("token",h,{silent:!0}),r&&s.set("fileType",r,{silent:!0});i=new Asc.asc_CVersionHistory,i=(i.asc_setUrl(l),i.asc_setUrlChanges(a),i.asc_setDocId(_.isEmpty(a)?c:d),i.asc_setCurrentChangeId(this.currentChangeId),i.asc_setArrColors(this.currentArrColors),i.asc_setToken(h),i.asc_setIsRequested(!0),i.asc_setServerVersion(this.currentServerVersion),i.asc_SetUserId(this.currentUserId),i.asc_SetUserName(this.currentUserName),i.asc_SetUserColor(this.currentUserColor),i.asc_SetDateOfRevision(this.currentDateCreated),this.api.asc_showRevision(i),this.currentRev=e.version,this.getApplication().getController("Common.Controllers.ReviewChanges"));i&&i.onApiShowChange()}}},onExpiredToken:function(){var t=this;_.delay(function(){Common.Gateway.requestHistoryData(t.currentRev)},10)},onClickBackToDocument:function(){Common.Gateway.requestHistoryClose()},onClickExpand:function(){var t=this.panelHistory.storeHistory,e=t.hasCollapsed();t.where({isRevision:!0,hasChanges:!0,isExpanded:!e}).forEach(function(t){t.set("isExpanded",e)}),t.where({isRevision:!1}).forEach(function(t){t.set("isVisible",e)}),this.panelHistory.viewHistoryList.scroller.update({minScrollbarLength:this.panelHistory.viewHistoryList.minScrollbarLength}),this.panelHistory.btnExpand.cmpEl.text(e?this.panelHistory.textHideAll:this.panelHistory.textShowAll)}},Common.Controllers.History||{}))}),void 0===Common&&(Common={}),Common.Models=Common.Models||{},define("common/main/lib/model/User",["underscore","backbone","common/main/lib/component/BaseView"],function(t,e){"use strict";Common.Models.User=e.Model.extend({defaults:function(){return{iid:Common.UI.getId(),id:void 0,idOriginal:void 0,username:"Guest",color:"#fff",colorval:null,online:!1,view:!1,hidden:!1}}})}),define("common/main/lib/collection/Users",["backbone","common/main/lib/model/User"],function(t){"use strict";Common.Collections=Common.Collections||{},Common.Collections.Users=t.Collection.extend({model:Common.Models.User,getOnlineCount:function(){var e=0;return this.each(function(t){t.get("online")&&++e}),e},getEditingCount:function(){return this.filter(function(t){return t.get("online")&&!t.get("view")}).length},getVisibleEditingCount:function(){return this.filter(function(t){return t.get("online")&&!t.get("view")&&!t.get("hidden")}).length},getEditingOriginalCount:function(){return this.chain().filter(function(t){return t.get("online")&&!t.get("view")}).groupBy(function(t){return t.get("idOriginal")}).size().value()},getVisibleEditingOriginalCount:function(){return this.chain().filter(function(t){return t.get("online")&&!t.get("view")&&!t.get("hidden")}).groupBy(function(t){return t.get("idOriginal")}).size().value()},findUser:function(e){return this.find(function(t){return t.get("id")==e})},findOriginalUser:function(e){return this.find(function(t){return t.get("idOriginal")==e})}}),Common.Collections.HistoryUsers=t.Collection.extend({model:Common.Models.User,findUser:function(e){return this.find(function(t){return t.get("id")==e})}})}),define("common/main/lib/model/ChatMessage",["backbone"],function(t){"use strict";Common.Models=Common.Models||{},Common.Models.ChatMessage=t.Model.extend({defaults:{type:0,userid:null,username:"",message:""}})}),define("common/main/lib/collection/ChatMessages",["backbone","common/main/lib/model/ChatMessage"],function(t){"use strict";Common.Collections||(Common.Collections={}),Common.Collections.ChatMessages=t.Collection.extend({model:Common.Models.ChatMessage})}),define("text!common/main/lib/template/Chat.template",[],function(){return'<div id="chat-box" class="layout-ct vbox">\n    <div id="chat-users" class="layout-item area">\n        <div id="chat-user-ct"></div>\n    </div>\n    <div id="chat-messages" class="layout-item area">\n        <div id="chat-message-ct"></div>\n    </div>\n    <div id="chat-options" class="layout-item">\n        <div id="chat-options-ct">\n            <textarea id="chat-msg-text" class="user-select textarea-control" maxlength="<%=maxMsgLength%>" data-hint="1" data-hint-direction="left-top"></textarea>\n            <button id="chat-msg-btn-add" class="btn normal dlg-btn primary" data-hint="1" data-hint-direction="bottom" data-hint-offset="big"><%=scope.textSend%></button>\n        </div>\n    </div>\n</div>'}),void 0===Common&&(Common={}),Common.Views=Common.Views||{},define("common/main/lib/view/Chat",["text!common/main/lib/template/Chat.template","common/main/lib/util/utils","common/main/lib/component/BaseView","common/main/lib/component/Layout"],function(t){"use strict";Common.Views.Chat=Common.UI.BaseView.extend(_.extend({el:"#left-panel-chat",template:_.template(t),storeUsers:void 0,storeMessages:void 0,tplUser:['<li id="<%= user.get("iid") %>"<% if (!user.get("online")) { %> class="offline"<% } %>>','<div class="name"><div class="color" style="background-color: <%= user.get("color") %>;" ></div><%= scope.getUserName(user.get("username")) %>',"</div>","</li>"].join(""),templateUserList:_.template("<ul><% for (originalId in users) { %><%= _.template(usertpl)({user: users[originalId][0], scope: scope}) %><% } %></ul>"),tplMsg:["<li>",'<% if (msg.get("type")==1) { %>','<div class="message service" data-can-copy="true"><%= msg.get("message") %></div>',"<% } else { %>",'<div class="user-name" data-can-copy="true">','<div class="color" style="display: inline-block; background-color: <% if (msg.get("usercolor")!==null) { %><%=msg.get("usercolor")%><% } else { %> #cfcfcf <% } %>; " ></div><%= scope.getUserName(msg.get("username")) %>',"</div>",'<label class="message user-select" data-can-copy="true" tabindex="-1" oo_editor_input="true"><%= msg.get("message") %></label>',"<% } %>","</li>"].join(""),templateMsgList:_.template("<ul><% _.each(messages, function(item) { %><%= _.template(msgtpl)({msg: item, scope: scope}) %><% }); %></ul>"),events:{},usersBoxHeight:72,messageBoxHeight:70,addMessageBoxHeight:110,initialize:function(t){_.extend(this,t),Common.UI.BaseView.prototype.initialize.call(this,arguments),this.storeUsers.bind({add:_.bind(this._onResetUsers,this),change:_.bind(this._onResetUsers,this),reset:_.bind(this._onResetUsers,this)}),this.storeMessages.bind({add:_.bind(this._onAddMessage,this),reset:_.bind(this._onResetMessages,this)})},render:function(t){return t=t||this.el,$(t).html(this.template({scope:this,maxMsgLength:Asc.c_oAscMaxCellOrCommentLength})),this.panelBox=$("#chat-box",this.el),this.panelUsers=$("#chat-users",this.el),this.panelMessages=$("#chat-messages",this.el),this.txtMessage=$("#chat-msg-text",this.el),this.panelOptions=$("#chat-options",this.el),this.panelUsers.scroller=new Common.UI.Scroller({el:$("#chat-users"),useKeyboard:!0,minScrollbarLength:25}),this.panelMessages.scroller=new Common.UI.Scroller({el:$("#chat-messages"),includePadding:!0,useKeyboard:!0,minScrollbarLength:40}),this.panelOptions.scroller=new Common.UI.Scroller({el:$("#chat-options")}),$("#chat-msg-btn-add",this.el).on("click",_.bind(this._onBtnAddMessage,this)),this.txtMessage.on("keydown",_.bind(this._onKeyDown,this)),this.setupLayout(),this.trigger("render:after",this),this},focus:function(){var t=this;_.defer(function(){t.txtMessage.focus()},100),this.updateLayout(!0),this.setupAutoSizingTextBox()},_onKeyDown:function(t){t.keyCode==Common.UI.Keys.RETURN?!t.ctrlKey&&!t.metaKey||t.altKey||this._onBtnAddMessage(t):t.keyCode!=Common.UI.Keys.ESC||Common.UI.HintManager.isHintVisible()||this.hide()},_onResetUsers:function(t,e){this.panelUsers&&(this.panelUsers.html(this.templateUserList({users:this.storeUsers.chain().filter(function(t){return t.get("online")}).groupBy(function(t){return t.get("idOriginal")}).value(),usertpl:this.tplUser,scope:this})),this.panelUsers.scroller.update({minScrollbarLength:25,alwaysVisibleY:!0}))},_onAddMessage:function(t,e,i){var s;this.panelMessages&&(s=this.panelMessages.find("ul"))&&s.length&&(this._prepareMessage(t),s.append(_.template(this.tplMsg)({msg:t,scope:this})),this.panelMessages.scroller.update({minScrollbarLength:40,alwaysVisibleY:!0}),this.panelMessages.scroller.scrollTop(s.get(0).getBoundingClientRect().height))},_onResetMessages:function(t,e){this.panelMessages&&(t.each(function(t){this._prepareMessage(t)},this),this.panelMessages.html(this.templateMsgList({messages:t.models,msgtpl:this.tplMsg,scope:this})),this.panelMessages.scroller.update({minScrollbarLength:40,alwaysVisibleY:!0}))},_onBtnAddMessage:function(t){this.txtMessage&&(this.fireEvent("message:add",[this,this.txtMessage.val().trim()]),this.txtMessage.val(""),this.focus())},_prepareMessage:function(t){var e=this.storeUsers.findOriginalUser(t.get("userid"));t.set({usercolor:e?e.get("color"):null,message:this._pickLink(t.get("message"))},{silent:!0})},_pickLink:function(t){for(var i,s,o=[],e=(t.replace(Common.Utils.ipStrongRe,function(t){var e=/[\.,\?\+;:=!\(\)]+$/.exec(t);return e&&(t=t.substring(0,e.index)),i=arguments[arguments.length-2],o.push({start:i,end:t.length+i,str:'<a href="'+t+'" target="_blank" data-can-copy="true">'+t+"</a>"}),""}),(t.length<1e3||t.search(/\S{255,}/)<0)&&t.replace(Common.Utils.hostnameStrongRe,function(t){var e=/[\.,\?\+;:=!\(\)]+$/.exec(t),e=(e&&(t=t.substring(0,e.index)),/(((^https?)|(^ftp)):\/\/)/i.test(t)?t:"http://"+t);return i=arguments[arguments.length-2],s=t.length,_.find(o,function(t){return i>=t.start&&i<t.end||i<=t.start&&i+s>t.start})||o.push({start:i,end:s+i,str:'<a href="'+e+'" target="_blank" data-can-copy="true">'+t+"</a>"}),""}),t.replace(Common.Utils.emailStrongRe,function(t){var e=/((^mailto:)\/\/)/i.test(t)?t:"mailto:"+t;return i=arguments[arguments.length-2],s=t.length,_.find(o,function(t){return i>=t.start&&i<t.end||i<=t.start&&i+s>t.start})||o.push({start:i,end:s+i,str:'<a href="'+e+'">'+t+"</a>"}),""}),0<(o=_.sortBy(o,function(t){return t.start})).length?Common.Utils.String.htmlEncode(t.substring(0,o[0].start))+o[0].str:Common.Utils.String.htmlEncode(t)),n=1;n<o.length;n++)e+=Common.Utils.String.htmlEncode(t.substring(o[n-1].end,o[n].start))+o[n].str;return 0<o.length&&(e+=Common.Utils.String.htmlEncode(t.substring(o[n-1].end,t.length))),e},getUserName:function(t){return Common.Utils.String.htmlEncode(AscCommon.UserInfoParser.getParsedName(t))},hide:function(){Common.UI.BaseView.prototype.hide.call(this,arguments),this.fireEvent("hide",this),this.textBoxAutoSizeLocked=void 0},setupLayout:function(){var e=this,t=$(e.el),i=this.panelBox.find(" > .layout-item"),i=(e.layout=new Common.UI.VBoxLayout({box:this.panelBox,items:[{el:i[0],rely:!0,behaviour:"splitter",resize:{hidden:!1,autohide:!1,fmin:function(){return e.usersBoxHeight},fmax:function(){return.5*e.panelBox.height()-e.messageBoxHeight}}},{el:i[1],rely:!0,behaviour:"splitter",resize:{hidden:!1,autohide:!1,fmin:function(){return Math.max(e.messageBoxHeight+e.usersBoxHeight,.5*e.panelBox.height())},fmax:function(){return e.panelBox.height()-e.addMessageBoxHeight}}},{el:i[2],stretch:!0}]}),e.layout.on("layout:resizedrag",function(t){e.updateScrolls(),e.usersCachedHeigt=e.panelUsers.height()+8+1,t.index||(e.textBoxAutoSizeLocked=!0)},this),$(window).on("resize",function(){"none"!==t.css("display")&&e.updateLayout()}),this.updateLayout(),this.panelBox.height());this.layout.setResizeValue(0,this.usersBoxHeight),this.layout.setResizeValue(1,Math.max(this.addMessageBoxHeight,Math.max(.5*i,i-e.panelOptions.height()-4))),this.setupAutoSizingTextBox(),this.disableTextBoxButton($(this.txtMessage)),this.txtMessage.bind("input propertychange",_.bind(this.onTextareaInput,this))},onTextareaInput:function(t){this.updateHeightTextBox(t),this.disableTextBoxButton($(t.target))},disableTextBoxButton:function(t){var e=$(t.siblings("#chat-msg-btn-add")[0]);0<t.val().trim().length?(e.removeAttr("disabled"),e.removeClass("disabled")):(e.attr("disabled",!0),e.addClass("disabled"))},updateLayout:function(t){var e=this,i=this.panelBox.height();e.layout.setResizeValue(1,Math.max(e.addMessageBoxHeight,Math.max(.5*i,i-e.panelOptions.height()-4))),t?(this.panelUsers.css("height"),this.panelUsers.css("height","1px"),t=this.panelUsers.get(0).scrollHeight,e.layout.setResizeValue(0,Math.max(e.usersBoxHeight,Math.min(t+2,Math.floor(.5*i)-e.messageBoxHeight)))):e.layout.setResizeValue(0,Math.max(e.usersBoxHeight,Math.min(e.usersCachedHeigt+2,Math.floor(.5*i)-e.messageBoxHeight))),e.updateScrolls(),e.updateHeightTextBox(null)},setupAutoSizingTextBox:function(){this.lineHeight=0,this.minHeight=44,this.lineHeight=1.25*parseInt(this.txtMessage.css("lineHeight"),10),this.updateHeightTextBox(!0)},updateHeightTextBox:function(t){var e=this.txtMessage,i=this.panelBox.height();t&&0==e.val().length?(this.layout.setResizeValue(1,Math.max(this.addMessageBoxHeight,i-this.addMessageBoxHeight)),this.textBoxAutoSizeLocked=void 0,this.updateScrolls()):_.isUndefined(this.textBoxAutoSizeLocked)&&(e.height(),e.get(0).scrollHeight,e.css({height:this.minHeight+"px"}),e.height(),t=Math.max(e.get(0).scrollHeight+this.lineHeight,1),e.css({height:"100%"}),i=this.panelBox.height(),this.layout.setResizeValue(1,Math.max(this.addMessageBoxHeight,Math.min(i-t-40,i-this.addMessageBoxHeight)))&&this.updateScrolls())},updateScrolls:function(){this.panelUsers&&this.panelUsers.scroller&&this.panelMessages&&this.panelMessages.scroller&&(this.panelUsers.scroller.update({minScrollbarLength:25,alwaysVisibleY:!0}),this.panelMessages.scroller.update({minScrollbarLength:40,alwaysVisibleY:!0}))}},Common.Views.Chat||{}))}),define("common/main/lib/controller/Chat",["core","common/main/lib/collection/Users","common/main/lib/collection/ChatMessages","common/main/lib/view/Chat"],function(){"use strict";Common.Controllers.Chat=Backbone.Controller.extend(_.extend({models:[],collections:["Common.Collections.Users","Common.Collections.ChatMessages"],views:["Common.Views.Chat"],initialize:function(){this.addListeners({"Common.Views.Chat":{"message:add":_.bind(this.onSendMessage,this)}});var e=this;Common.NotificationCenter.on("layout:changed",function(t){Common.Utils.asyncCall(function(t){"toolbar"!=t&&"status"!=t||!e.panelChat.$el.is(":visible")||(e.panelChat.updateLayout(!0),e.panelChat.setupAutoSizingTextBox())},this,t)})},events:{},onLaunch:function(){this.panelChat=this.createView("Common.Views.Chat",{storeUsers:this.getApplication().getCollection("Common.Collections.Users"),storeMessages:this.getApplication().getCollection("Common.Collections.ChatMessages")}),this.panelChat.on("render:after",_.bind(this.onAfterRender,this))},onAfterRender:function(t){this.getApplication().getController("Viewport").getView("Viewport").hlayout.on("layout:resizedrag",_.bind(function(){t&&t.updateScrolls()},this))},setMode:function(t){return this.mode=t,this.currentUserId=t.user.id,this.api&&(this.mode.canCoAuthoring&&this.mode.canChat&&this.api.asc_registerCallback("asc_onCoAuthoringChatReceiveMessage",_.bind(this.onReceiveMessage,this)),this.mode.isEditDiagram||this.mode.isEditMailMerge||this.mode.isEditOle||(this.api.asc_registerCallback("asc_onAuthParticipantsChanged",_.bind(this.onUsersChanged,this)),this.api.asc_registerCallback("asc_onConnectionStateChanged",_.bind(this.onUserConnection,this)),this.api.asc_coAuthoringGetUsers()),this.mode.canCoAuthoring&&this.mode.canChat&&this.api.asc_coAuthoringChatGetMessages()),this},setApi:function(t){return this.api=t,this},onUsersChanged:function(t,e){if(!this.mode.canLicense||!this.mode.canCoAuthoring){var i=0;for(o in t)void 0!==o&&i++;if(1<i&&null==this._isCoAuthoringStopped)return this._isCoAuthoringStopped=!0,this.api.asc_coAuthoringDisconnect(),void Common.NotificationCenter.trigger("api:disconnect")}var s=this.getApplication().getCollection("Common.Collections.Users");if(s){var o,n,a,l=[];for(o in t)void 0!==o&&(a=t[o])&&(n=new Common.Models.User({id:a.asc_getId(),idOriginal:a.asc_getIdOriginal(),username:a.asc_getUserName(),online:!0,color:a.asc_getColor(),view:a.asc_getView(),hidden:!(a.asc_getIdOriginal()===this.currentUserId||AscCommon.UserInfoParser.isUserVisible(a.asc_getUserName()))}),l[a.asc_getId()==e?"unshift":"push"](n));s[0<s.size()?"add":"reset"](l)}},onUserConnection:function(t){var e,i=this.getApplication().getCollection("Common.Collections.Users");i&&((e=i.findUser(t.asc_getId()))?(e.set({online:t.asc_getState()}),e.set({username:t.asc_getUserName()})):i.add(new Common.Models.User({id:t.asc_getId(),idOriginal:t.asc_getIdOriginal(),username:t.asc_getUserName(),online:t.asc_getState(),color:t.asc_getColor(),view:t.asc_getView(),hidden:!(t.asc_getIdOriginal()===this.currentUserId||AscCommon.UserInfoParser.isUserVisible(t.asc_getUserName()))})))},onReceiveMessage:function(t,e){var i,s=this.getApplication().getCollection("Common.Collections.ChatMessages");s&&(i=[],t.forEach(function(t){i.push(new Common.Models.ChatMessage({userid:t.useridoriginal,message:t.message,username:t.username}))}),s[s.size()<1||e?"reset":"add"](i))},onSendMessage:function(t,e){var i;0<e.length&&(i=this,function(t,e){for(var i=[];t;){if(t.length<e){i.push(t);break}i.push(t.substr(0,e)),t=t.substr(e)}return i}(e,2048).forEach(function(t){i.api.asc_coAuthoringChatSendMessage(t)}))}},Common.Controllers.Chat||{}))}),void 0===Common&&(Common={}),Common.Models=Common.Models||{},define("common/main/lib/model/Plugin",["underscore","backbone","common/main/lib/component/BaseView"],function(t,e){"use strict";Common.Models.PluginVariation=e.Model.extend({defaults:function(){return{description:"",url:"",index:0,icons:void 0,isSystem:!1,isViewer:!1,isDisplayedInViewer:!0,EditorsSupport:["word","cell","slide"],isVisual:!1,isCustomWindow:!1,isModal:!0,isInsideMode:!1,initDataType:0,initData:"",isUpdateOleOnResize:!1,buttons:[],size:[800,600],initOnSelectionChanged:!1,visible:!0}}}),Common.Models.Plugin=e.Model.extend({defaults:function(){return{id:Common.UI.getId(),name:"",baseUrl:"",guid:Common.UI.getId(),variations:[],currentVariation:0,pluginObj:void 0,allowSelected:!1,selected:!1,visible:!0,groupName:"",groupRank:0}}})}),void 0===Common&&(Common={}),Common.Collections=Common.Collections||{},define("common/main/lib/collection/Plugins",["underscore","backbone","common/main/lib/model/Plugin"],function(t,e){"use strict";Common.Collections.Plugins=e.Collection.extend({model:Common.Models.Plugin,hasVisible:function(){return!!this.findWhere({visible:!0})}})}),void 0===Common&&(Common={}),Common.Views=Common.Views||{},define("common/main/lib/view/Plugins",["common/main/lib/util/utils","common/main/lib/component/BaseView","common/main/lib/component/Layout","common/main/lib/component/Window"],function(t){"use strict";Common.Views.Plugins=Common.UI.BaseView.extend(_.extend({el:"#left-panel-plugins",storePlugins:void 0,template:_.template(['<div id="plugins-box" class="layout-ct vbox">','<label id="plugins-header"><%= scope.strPlugins %></label>','<div id="plugins-list" class="">',"</div>","</div>",'<div id="current-plugin-box" class="layout-ct vbox hidden">','<div id="current-plugin-frame" class="">',"</div>",'<div id="current-plugin-header">',"<label></label>",'<div id="id-plugin-close" class="close"></div>',"</div>","</div>",'<div id="plugins-mask" style="display: none;">'].join("")),initialize:function(t){_.extend(this,t),this._locked=!1,this._state={DisabledControls:!1,docProtection:{isReadOnly:!1,isReviewOnly:!1,isFormsOnly:!1,isCommentsOnly:!1}},this.lockedControls=[],Common.UI.BaseView.prototype.initialize.call(this,arguments)},render:function(t){return t&&(this.$el=$(t)),this.$el.html(this.template({scope:this})),this.pluginName=$("#current-plugin-header label"),this.pluginsPanel=$("#plugins-box"),this.pluginsMask=$("#plugins-mask",this.$el),this.currentPluginPanel=$("#current-plugin-box"),this.currentPluginFrame=$("#current-plugin-frame"),this.pluginClose=new Common.UI.Button({parentEl:$("#id-plugin-close"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-close",hint:this.textClosePanel}),this.pluginMenu=new Common.UI.Menu({menuAlign:"tr-br",items:[]}),this.trigger("render:after",this),this},getPanel:function(){var t=$('<section id="plugins-panel" class="panel" data-tab="plugins"></section>'),e=$('<div class="group"></div>');return this.storePlugins.isEmpty()||this.storePlugins.each(function(t){}),e.appendTo(t),t},renderTo:function(t){var o,n,a,e;this.storePlugins.isEmpty()||(o=this,n=$('<div class="group"></div>'),a=Common.enumLock,this.storePlugins.each(function(t){var e,i,s;t.get("visible")&&(s=t.get("variations"),e=t.get("guid"),i=s[t.get("currentVariation")].get("icons"),i=t.get("baseUrl")+o.parseIcons(i),i=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconImg:i,caption:t.get("name"),menu:s&&1<s.length,split:s&&1<s.length,value:e,hint:t.get("name"),lock:t.get("isDisplayedInViewer")?[a.viewMode,a.previewReviewMode,a.viewFormMode,a.selRangeEdit,a.editFormula]:[a.viewMode,a.previewReviewMode,a.viewFormMode,a.lostConnect,a.docLockView,a.docLockForms,a.docLockComments,a.selRangeEdit,a.editFormula],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),s=$('<span class="btn-slot text x-huge"></span>').appendTo(n),i.render(s),t.set("button",i),o.lockedControls.push(i))}),e=o._state.docProtection,Common.Utils.lockControls(Common.enumLock.docLockView,e.isReadOnly,{array:o.lockedControls}),Common.Utils.lockControls(Common.enumLock.docLockForms,e.isFormsOnly,{array:o.lockedControls}),Common.Utils.lockControls(Common.enumLock.docLockComments,e.isCommentsOnly,{array:o.lockedControls}),t.html(n),$('<div class="separator long"></div>').prependTo(t))},setLocked:function(t){this._locked=t},ChangeSettings:function(t){this.disableControls(this._locked)},disableControls:function(e){this._state.DisabledControls!==e&&(this._state.DisabledControls=e,_.each(this.lockedControls,function(t){t.setDisabled(e)}),this.pluginsMask&&this.pluginsMask.css("display",e?"block":"none"))},SetDisabled:function(t,e,i){e?Common.Utils.lockControls(Common.enumLock.previewReviewMode,t,{array:this.lockedControls}):i?Common.Utils.lockControls(Common.enumLock.viewFormMode,t,{array:this.lockedControls}):Common.Utils.lockControls(Common.enumLock.viewMode,t,{array:this.lockedControls})},openInsideMode:function(t,e,i,s){return!!this.pluginsPanel&&(this.pluginsPanel.toggleClass("hidden",!0),this.currentPluginPanel.toggleClass("hidden",!1),this.pluginName.text(t),this.iframePlugin||(this.iframePlugin=document.createElement("iframe"),this.iframePlugin.id=void 0===i?"plugin_iframe":i,this.iframePlugin.name="pluginFrameEditor",this.iframePlugin.width="100%",this.iframePlugin.height="100%",this.iframePlugin.align="top",this.iframePlugin.frameBorder=0,this.iframePlugin.scrolling="no",this.iframePlugin.allow="camera; microphone; display-capture",this.iframePlugin.onload=_.bind(this._onLoad,this),this.currentPluginFrame.append(this.iframePlugin),this.loadMask||(this.loadMask=new Common.UI.LoadMask({owner:this.currentPluginFrame})),this.loadMask.setTitle(this.textLoading),this.loadMask.show(),this.iframePlugin.src=e),this._state.insidePlugin=s,this.fireEvent("plugin:open",[this,"onboard","open"]),!0)},closeInsideMode:function(){this.pluginsPanel&&(this.iframePlugin&&(this.currentPluginFrame.empty(),this.iframePlugin=null),this.currentPluginPanel.toggleClass("hidden",!0),this._state.insidePlugin=void 0,this.fireEvent("plugin:open",[this,"onboard","close"]))},openedPluginMode:function(t){var e,t=this.storePlugins.findWhere({guid:t});t&&(e=t.get("button"))&&(e.toggle(!0),this.updatePluginButton(t),e.menu&&0<e.menu.items.length&&e.menu.items[0].setCaption(this.textStop))},closedPluginMode:function(t){var e,t=this.storePlugins.findWhere({guid:t});t&&(e=t.get("button"))&&(e.toggle(!1),this.updatePluginButton(t),e.menu&&0<e.menu.items.length&&e.menu.items[0].setCaption(this.textStart))},_onLoad:function(){this.loadMask&&this.loadMask.hide()},parseIcons:function(t){var e;if(t.length&&"string"!=typeof t[0]){for(var i=Common.UI.Themes.currentThemeId().toLowerCase(),s=Common.UI.Themes.isDarkTheme()?"dark":"light",o=-1,n=0;n<t.length;n++)if(t[n].theme&&t[n].theme.toLowerCase()==i){o=n;break}if(o<0)for(n=0;n<t.length;n++)if(t[n].style&&t[n].style.toLowerCase()==s){o=n;break}o<0&&(o=0);var a,l,r,c,d=100*Common.Utils.applicationPixelRatio(),h=t[o],p=1e4;for(c in h)h.hasOwnProperty(c)&&("default"==c?l=h[c]:isNaN(parseInt(c))||(a=Math.abs(d-parseInt(c)))<p-.01&&(p=a,r=h[c]));return{normal:(r=.01<p&&l?l:r).normal,hover:r.hover||r.normal,active:r.active||r.normal}}return{normal:e=t[(1<Common.Utils.applicationPixelRatio()?1:0)+(2<t.length?2:0)],hover:e,active:e}},updatePluginIcons:function(t){if(!t.get("visible"))return null;var e=t.get("variations")[t.get("currentVariation")].get("icons");t.set("parsedIcons",this.parseIcons(e)),this.updatePluginButton(t)},updatePluginButton:function(t){if(!t.get("visible"))return null;var e=t.get("button");e&&e.cmpEl&&e.cmpEl.find(".inner-box-icon img").attr("src",t.get("baseUrl")+t.get("parsedIcons")[e.isActive()?"active":"normal"])},createPluginButton:function(t){var s,e,i,o,n;return t.get("visible")?(s=this,o=t.get("variations"),e=t.get("guid"),o=o[t.get("currentVariation")].get("icons"),o=this.parseIcons(o),n=t.get("baseUrl")+o.normal,t.set("parsedIcons",o),i=[],_.each(t.get("variations"),function(t,e){t.get("visible")&&i.push({caption:0<e?t.get("description"):s.textStart,value:parseInt(t.get("index"))})}),o=Common.enumLock,(n=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconImg:n,caption:t.get("name"),menu:1<i.length,split:1<i.length,value:e,hint:t.get("name"),lock:t.get("isDisplayedInViewer")?[o.viewMode,o.previewReviewMode,o.viewFormMode,o.selRangeEdit,o.editFormula]:[o.viewMode,o.previewReviewMode,o.viewFormMode,o.docLockView,o.docLockForms,o.docLockComments,o.selRangeEdit,o.editFormula],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"})).split&&(n.setMenu(new Common.UI.Menu({items:i,pluginGuid:t.get("guid")})),n.menu.on("item:click",function(t,e,i){s.fireEvent("plugin:select",[t.options.pluginGuid,e.value])})),n.on("click",function(t,e){s.fireEvent("plugin:select",[t.options.value,0])}),t.set("button",n),s.lockedControls.push(n),n):null},hide:function(){Common.UI.BaseView.prototype.hide.call(this,arguments),this.fireEvent("hide",this)}},Common.Views.Plugins||{}))}),void 0===Common&&(Common={}),Common.Views=Common.Views||{},define("common/main/lib/view/PluginDlg",["common/main/lib/util/utils","common/main/lib/component/BaseView","common/main/lib/component/Layout","common/main/lib/component/Window"],function(t){"use strict";Common.Views.PluginDlg=Common.UI.Window.extend(_.extend({initialize:function(t){var e={},i=(_.extend(e,{header:!0,enableKeyEvents:!1,automove:!1},t),e.buttons&&0<_.size(e.buttons)?85:34);e.header||(i-=34),this.bordersOffset=40,e.width=Common.Utils.innerWidth()-2*this.bordersOffset-e.width<0?Common.Utils.innerWidth()-2*this.bordersOffset:e.width,e.height+=i,e.height=Common.Utils.innerHeight()-2*this.bordersOffset-e.height<0?Common.Utils.innerHeight()-2*this.bordersOffset:e.height,e.cls+=" advanced-settings-dlg invisible-borders",this.template=['<div id="id-plugin-container" class="box" style="height:'+(e.height-i)+'px;">','<div id="id-plugin-placeholder" style="width: 100%;height: 100%;"></div>',"</div>",'<% if ((typeof buttons !== "undefined") && _.size(buttons) > 0) { %>','<div class="separator horizontal"></div>',"<% } %>"].join(""),e.tpl=_.template(this.template)(e),this.url=t.url||"",this.loader=void 0===t.loader||t.loader,this.frameId=t.frameId||"plugin_iframe",Common.UI.Window.prototype.initialize.call(this,e)},render:function(){Common.UI.Window.prototype.render.call(this),this.$window.find("> .body").css({height:"auto",overflow:"hidden"}),this.boxEl=this.$window.find(".body > .box"),this._headerFooterHeight=this.options.buttons&&0<_.size(this.options.buttons)?85:34,this.options.header||(this._headerFooterHeight-=34),this._headerFooterHeight+=parseInt(this.$window.css("border-top-width"))+parseInt(this.$window.css("border-bottom-width")),this.$window.find(".header").prepend($('<div class="tools left hidden"></div>'));function t(){i.onWindowResize()}var e=document.createElement("iframe"),i=(e.id=this.frameId,e.name="pluginFrameEditor",e.width="100%",e.height="100%",e.align="top",e.frameBorder=0,e.scrolling="no",e.allow="camera; microphone; display-capture",e.onload=_.bind(this._onLoad,this),this),s=this.$window.find("#id-plugin-placeholder");this.loader&&setTimeout(function(){i.isLoaded||(i.loadMask=new Common.UI.LoadMask({owner:s}),i.loadMask.setTitle(i.textLoading),i.loadMask.show(),i.isLoaded&&i.loadMask.hide())},500),e.src=this.url,s.append(e),this.on("resizing",function(t){i.boxEl.css("height",parseInt(i.$window.css("height"))-i._headerFooterHeight)});$(window).on("resize",t),this.on("close",function(){$(window).off("resize",t)})},_onLoad:function(){this.isLoaded=!0,this.loadMask&&this.loadMask.hide()},setInnerSize:function(t,e){var i=Common.Utils.innerHeight(),s=Common.Utils.innerWidth(),o=parseInt(this.$window.css("border-left-width"))+parseInt(this.$window.css("border-right-width")),n=2*this.bordersOffset;i-n<e+this._headerFooterHeight&&(e=i-n-this._headerFooterHeight),s-n<t+o&&(t=s-n-o),this.boxEl.css("height",e),Common.UI.Window.prototype.setHeight.call(this,e+this._headerFooterHeight),Common.UI.Window.prototype.setWidth.call(this,t+o),this.$window.css("left",(s-t-o)/2),this.$window.css("top",(i-e-this._headerFooterHeight)/2),this._restoreHeight=this._restoreWidth=void 0},onWindowResize:function(){var t,e=Common.Utils.innerWidth(),i=Common.Utils.innerHeight(),s=this.getWidth(),o=this.getHeight(),n=this.resizable?0:this.bordersOffset;o<i-2*n+.1?(!this.resizable&&0<this._restoreHeight&&o<this._restoreHeight&&(t=Math.max(Math.min(this._restoreHeight,i-2*n),this.initConfig.minheight),this.setHeight(t),this.boxEl.css("height",t-this._headerFooterHeight)),(t=this.getTop())<n?this.$window.css("top",n):i-n<t+o&&this.$window.css("top",i-n-o)):(void 0===this._restoreHeight&&(this._restoreHeight=o),this.setHeight(Math.max(i-2*n,this.initConfig.minheight)),this.boxEl.css("height",Math.max(i-2*n,this.initConfig.minheight)-this._headerFooterHeight),this.$window.css("top",n)),s<e-2*n+.1?(!this.resizable&&0<this._restoreWidth&&s<this._restoreWidth&&this.setWidth(Math.max(Math.min(this._restoreWidth,e-2*n),this.initConfig.minwidth)),(t=this.getLeft())<n?this.$window.css("left",n):e-n<t+s&&this.$window.css("left",e-n-s)):(void 0===this._restoreWidth&&(this._restoreWidth=s),this.setWidth(Math.max(e-2*n,this.initConfig.minwidth)),this.$window.css("left",n))},showButton:function(t,e){var i,e=this.$window.find(e?".header .tools:not(.left)":".header .tools.left"),s=e.find("#id-plugindlg-"+t);s.length<1&&(i="back"===t?"btn-promote":"btn-"+Common.Utils.String.htmlEncode(t),(s=$('<div id="id-plugindlg-'+t+'" class="tool custom toolbar__icon '+i+'"></div>')).on("click",_.bind(function(){this.fireEvent("header:click",t)},this)),e.append(s)),s.show(),e.removeClass("hidden")},hideButton:function(t){t=this.$window.find(".header #id-plugindlg-"+t);0<t.length&&t.hide()}},Common.Views.PluginDlg||{}))}),define("common/main/lib/controller/Plugins",["core","common/main/lib/collection/Plugins","common/main/lib/view/Plugins","common/main/lib/view/PluginDlg"],function(){"use strict";Common.Controllers.Plugins=Backbone.Controller.extend(_.extend({models:[],appOptions:{},configPlugins:{autostart:[]},serverPlugins:{autostart:[]},collections:["Common.Collections.Plugins"],views:["Common.Views.Plugins"],initialize:function(){var i=this;this.addListeners({Toolbar:{"render:before":function(t){var e=i.getApplication().getController("Main").appOptions;e.isEditMailMerge||e.isEditDiagram||e.isEditOle||(e={action:"plugins",caption:i.panelPlugins.groupCaption,dataHintTitle:"E",layoutname:"toolbar-plugins"},i.$toolbarPanelPlugins=i.panelPlugins.getPanel(),(i.toolbar=t).addTab(e,i.$toolbarPanelPlugins,10))}},"Common.Views.Plugins":{"plugin:select":function(t,e){i.api.asc_pluginRun(t,e,"")}}})},events:function(){return{"click #id-plugin-close":_.bind(this.onToolClose,this)}},onLaunch:function(){var t=this.getApplication().getCollection("Common.Collections.Plugins");this.panelPlugins=this.createView("Common.Views.Plugins",{storePlugins:t}),this.panelPlugins.on("render:after",_.bind(this.onAfterRender,this)),t.on({add:this.onAddPlugin.bind(this),reset:this.onResetPlugins.bind(this)}),this._moveOffset={x:0,y:0},this.autostart=[],this.customPluginsDlg=[],Common.Gateway.on("init",this.loadConfig.bind(this)),Common.NotificationCenter.on("app:face",this.onAppShowed.bind(this)),Common.NotificationCenter.on("uitheme:changed",this.updatePluginsButtons.bind(this)),Common.NotificationCenter.on("window:resize",this.updatePluginsButtons.bind(this)),Common.NotificationCenter.on("app:ready",this.onAppReady.bind(this))},loadConfig:function(t){this.configPlugins.config=t.config.plugins,this.editor=window.DE||window.PDFE?"word":window.PE?"slide":"cell",this.isPDFEditor=!!window.PDFE},loadPlugins:function(){var e;this.configPlugins.plugins=this.serverPlugins.plugins=!1,this.configPlugins.config&&this.getPlugins(this.configPlugins.config.pluginsData).then(function(t){e.configPlugins.plugins=t,e.mergePlugins()}).catch(function(t){e.configPlugins.plugins=!1}),Common.Controllers.Desktop.isActive()&&Common.Controllers.Desktop.isOffline()||(e=this,Common.Utils.loadConfig("../../../../plugins.json",function(t){"error"!=t&&(e.serverPlugins.config=t,e.getPlugins(e.serverPlugins.config.pluginsData).then(function(t){e.serverPlugins.plugins=t,e.mergePlugins()}).catch(function(t){e.serverPlugins.plugins=!1}))}))},onAppShowed:function(t){},onAppReady:function(t){var e=this;new Promise(function(t,e){t()}).then(function(){e.onChangeProtectDocument(),Common.NotificationCenter.on("protect:doclock",_.bind(e.onChangeProtectDocument,e))})},setApi:function(t){return this.api=t,this.appOptions.customization&&!1===this.appOptions.customization.plugins||(this.api.asc_registerCallback("asc_onPluginShow",_.bind(this.onPluginShow,this)),this.api.asc_registerCallback("asc_onPluginClose",_.bind(this.onPluginClose,this)),this.api.asc_registerCallback("asc_onPluginResize",_.bind(this.onPluginResize,this)),this.api.asc_registerCallback("asc_onPluginMouseUp",_.bind(this.onPluginMouseUp,this)),this.api.asc_registerCallback("asc_onPluginMouseMove",_.bind(this.onPluginMouseMove,this)),this.api.asc_registerCallback("asc_onPluginsReset",_.bind(this.resetPluginsList,this)),this.api.asc_registerCallback("asc_onPluginsInit",_.bind(this.onPluginsInit,this)),this.api.asc_registerCallback("asc_onPluginShowButton",_.bind(this.onPluginShowButton,this)),this.api.asc_registerCallback("asc_onPluginHideButton",_.bind(this.onPluginHideButton,this)),this.api.asc_registerCallback("asc_onPluginWindowShow",_.bind(this.onPluginWindowShow,this)),this.api.asc_registerCallback("asc_onPluginWindowClose",_.bind(this.onPluginWindowClose,this)),this.api.asc_registerCallback("asc_onPluginWindowResize",_.bind(this.onPluginWindowResize,this)),this.api.asc_registerCallback("asc_onPluginWindowMouseUp",_.bind(this.onPluginWindowMouseUp,this)),this.api.asc_registerCallback("asc_onPluginWindowMouseMove",_.bind(this.onPluginWindowMouseMove,this))),this},setMode:function(t,e){return this.appOptions=t,this.api=e,this.customPluginsComplete=!this.appOptions.canBrandingExt,this.appOptions.canBrandingExt&&this.getAppCustomPlugins(this.configPlugins),this},onAfterRender:function(t){t.viewPluginsList&&t.viewPluginsList.on("item:click",_.bind(this.onSelectPlugin,this)),this.bindViewEvents(this.panelPlugins,this.events);var i=this;Common.NotificationCenter.on({"layout:resizestart":function(t){var e;i.panelPlugins.isVisible()&&(e=i.panelPlugins.currentPluginFrame.offset(),i._moveOffset={x:e.left+parseInt(i.panelPlugins.currentPluginFrame.css("padding-left")),y:e.top+parseInt(i.panelPlugins.currentPluginFrame.css("padding-top"))},i.api.asc_pluginEnableMouseEvents(!0))},"layout:resizestop":function(t){i.panelPlugins.isVisible()&&i.api.asc_pluginEnableMouseEvents(!1)}})},refreshPluginsList:function(){var t=this.getApplication().getCollection("Common.Collections.Plugins"),i=[];t.each(function(t){var e=new Asc.CPlugin;e.deserialize(t.get("original")),t.set("pluginObj",e),i.push(e)}),this.api.asc_pluginsRegister("",i),t.hasVisible()&&Common.NotificationCenter.trigger("tab:visible","plugins",Common.UI.LayoutManager.isElementVisible("toolbar-plugins")),Common.Gateway.pluginsReady()},onAddPlugin:function(t){var e;this.$toolbarPanelPlugins&&(t=this.panelPlugins.createPluginButton(t))&&(e=$("> .group",this.$toolbarPanelPlugins),e=$('<span class="btn-slot text x-huge"></span>').appendTo(e),t.render(e),e=this.panelPlugins._state.docProtection,Common.Utils.lockControls(Common.enumLock.docLockView,e.isReadOnly,{array:t}),Common.Utils.lockControls(Common.enumLock.docLockForms,e.isFormsOnly,{array:t}),Common.Utils.lockControls(Common.enumLock.docLockComments,e.isCommentsOnly,{array:t}))},onResetPlugins:function(t){var s,o,n,a=this;a.appOptions.canPlugins=!t.isEmpty(),a.$toolbarPanelPlugins&&(a.$toolbarPanelPlugins.empty(),a.toolbar&&a.toolbar.clearMoreButton("plugins"),s=$('<div class="group"></div>'),o=-1,n=0,t.each(function(t){var e,i=t.get("groupRank"),t=(i!==o&&-1<o&&0<n?(s.appendTo(a.$toolbarPanelPlugins),$('<div class="separator long"></div>').appendTo(a.$toolbarPanelPlugins),s=$('<div class="group"></div>'),n=0):(s.appendTo(a.$toolbarPanelPlugins),$('<div class="separator long invisible"></div>').appendTo(a.$toolbarPanelPlugins),s=$('<div class="group" style="'+(Common.UI.isRTL()?"padding-right: 0;":"padding-left: 0;")+'"></div>')),a.panelPlugins.createPluginButton(t));t&&(e=$('<span class="btn-slot text x-huge"></span>').appendTo(s),t.render(e),n++),o=i}),s.appendTo(a.$toolbarPanelPlugins),a.toolbar&&a.toolbar.isTabActive("plugins")&&a.toolbar.processPanelVisible(null,!0,!0),t=a.panelPlugins._state.docProtection,Common.Utils.lockControls(Common.enumLock.docLockView,t.isReadOnly,{array:a.panelPlugins.lockedControls}),Common.Utils.lockControls(Common.enumLock.docLockForms,t.isFormsOnly,{array:a.panelPlugins.lockedControls}),Common.Utils.lockControls(Common.enumLock.docLockComments,t.isCommentsOnly,{array:a.panelPlugins.lockedControls}))},updatePluginsButtons:function(){var t=this.getApplication().getCollection("Common.Collections.Plugins"),e=this;t.each(function(t){e.panelPlugins.updatePluginIcons(t)})},onSelectPlugin:function(t,e,i,s){var o=$(s.target);if(o&&o.hasClass("plugin-caret")){var n=this.panelPlugins.pluginMenu;if(n.isVisible())n.hide();else{var a=this,o=$(s.currentTarget),l=$(this.panelPlugins.el),r=o.offset(),c=l.offset(),r=[r.left-c.left+o.width(),r.top-c.top+o.height()/2];if(null!=i){for(var d=0;d<n.items.length;d++)n.removeItem(n.items[d]),d--;n.removeAll();for(var h=i.get("variations"),d=0;d<h.length;d++){var p=h[d],p=new Common.UI.MenuItem({caption:0<d?p.get("description"):a.panelPlugins.textStart,value:parseInt(p.get("index"))}).on("click",function(t,e){a.api&&a.api.asc_pluginRun(i.get("guid"),t.value,"")});n.addItem(p)}}c=l.find("#menu-plugin-container");n.rendered||(c.length<1&&(c=$('<div id="menu-plugin-container" style="position: absolute; z-index: 10000;"><div class="dropdown-toggle" data-toggle="dropdown"></div></div>',n.id),l.append(c)),n.render(c),n.cmpEl.attr({tabindex:"-1"}),n.on({"show:after":function(t){t&&t.menuAlignEl&&t.menuAlignEl.toggleClass("over",!0)},"hide:after":function(t){t&&t.menuAlignEl&&t.menuAlignEl.toggleClass("over",!1)}})),c.css({left:r[0],top:r[1]}),n.menuAlignEl=o,n.setOffset(-20,-o.height()/2-3),n.show(),_.delay(function(){n.cmpEl.focus()},10),s.stopPropagation(),s.preventDefault()}}else this.api.asc_pluginRun(i.get("guid"),0,"")},onPluginShow:function(e,t,i,s){var o,n,a,l,r,c,d,h,t=e.get_Variations()[t];t.get_Visual()&&(o=this.appOptions&&this.appOptions.lang?this.appOptions.lang.split(/[\-_]/)[0]:"en",h=t.get_Url(),h=(0==e.get_BaseUrl().length?h:e.get_BaseUrl())+h,s&&(h+=s),t.get_InsideMode()?this.panelPlugins.openInsideMode(e.get_Name(o),h,i,e.get_Guid())||this.api.asc_pluginButtonClick(-1,e.get_Guid()):(n=this,s=t.get_CustomWindow(),a=t.get_Buttons(),l=[],r=t.get_Size(),c=t.get_Modal(),(!r||r.length<2)&&(r=[800,600]),_.isArray(a)&&_.each(a,function(t,e){t.visible&&(l[e]={caption:t.text,value:e,primary:t.primary})}),d=t.get_Help(),n.pluginDlg=new Common.Views.PluginDlg({cls:s?"plain":"",header:!s,title:e.get_Name(o),width:r[0],height:r[1],url:h,frameId:i,buttons:s?void 0:l,toolcallback:function(t){n.api.asc_pluginButtonClick(-1,e.get_Guid())},help:!!d,loader:e.get_Loader(),modal:void 0===c||c}),n.pluginDlg.on({"render:after":function(t){t.getChild(".footer .dlg-btn").on("click",function(t){n.api.asc_pluginButtonClick(parseInt(t.currentTarget.attributes.result.value),e.get_Guid())}),n.pluginContainer=n.pluginDlg.$window.find("#id-plugin-container")},close:function(t){n.pluginDlg=void 0},drag:function(t){n.api.asc_pluginEnableMouseEvents("start"==t[1])},resize:function(t){n.api.asc_pluginEnableMouseEvents("start"==t[1])},help:function(){d&&window.open(d,"_blank")},"header:click":function(t){n.api.asc_pluginButtonClick(t,e.get_Guid())}}),n.pluginDlg.show())),this.panelPlugins.openedPluginMode(e.get_Guid())},onPluginClose:function(t){this.pluginDlg?this.pluginDlg.close():this.panelPlugins.iframePlugin&&this.panelPlugins.closeInsideMode(),this.panelPlugins.closedPluginMode(t.get_Guid()),this.runAutoStartPlugins()},onPluginResize:function(t,e,i,s){var o;this.pluginDlg&&(o=e&&1<e.length&&i&&1<i.length&&(i[0]>e[0]||i[1]>e[1]||0==i[0]||0==i[1]),this.pluginDlg.setResizable(o,e,i),this.pluginDlg.setInnerSize(t[0],t[1]),s&&s.call())},onToolClose:function(){this.api.asc_pluginButtonClick(-1,this.panelPlugins?this.panelPlugins._state.insidePlugin:void 0)},onPluginMouseUp:function(t,e){this.pluginDlg?(this.pluginDlg.binding.dragStop&&this.pluginDlg.binding.dragStop(),this.pluginDlg.binding.resizeStop&&this.pluginDlg.binding.resizeStop()):Common.NotificationCenter.trigger("frame:mouseup",{pageX:t*Common.Utils.zoom()+this._moveOffset.x,pageY:e*Common.Utils.zoom()+this._moveOffset.y})},onPluginMouseMove:function(t,e){var i;this.pluginDlg?(i=this.pluginContainer.offset(),this.pluginDlg.binding.drag&&this.pluginDlg.binding.drag({pageX:t*Common.Utils.zoom()+i.left,pageY:e*Common.Utils.zoom()+i.top}),this.pluginDlg.binding.resize&&this.pluginDlg.binding.resize({pageX:t*Common.Utils.zoom()+i.left,pageY:e*Common.Utils.zoom()+i.top})):Common.NotificationCenter.trigger("frame:mousemove",{pageX:t*Common.Utils.zoom()+this._moveOffset.x,pageY:e*Common.Utils.zoom()+this._moveOffset.y})},onPluginsInit:function(t){t instanceof Array||(t=t.pluginsData),this.parsePlugins(t,!1,!0)},onPluginShowButton:function(t,e){this.pluginDlg&&this.pluginDlg.showButton(t,e)},onPluginHideButton:function(t){this.pluginDlg&&this.pluginDlg.hideButton(t)},runAutoStartPlugins:function(){this.autostart&&0<this.autostart.length&&this.api.asc_pluginRun(this.autostart.shift(),0,"")},resetPluginsList:function(){this.getApplication().getCollection("Common.Collections.Plugins").reset()},applyUICustomization:function(){var me=this;return new Promise(function(resolve,reject){var timer_sl=setInterval(function(){if(me.customPluginsComplete){clearInterval(timer_sl);try{me.configPlugins.UIplugins&&me.configPlugins.UIplugins.forEach(function(c){c.code&&eval(c.code)})}catch(e){}resolve()}},10)})},parsePlugins:function(t,e,i){var s,r,c,d=this,h=this.getApplication().getCollection("Common.Collections.Plugins"),p=d.appOptions.isEdit&&!d.isPDFEditor,m=d.editor,u=d.api?d.api.GetVersion():void 0;t instanceof Array?(s=[],r=[],c=d.appOptions.lang.split(/[\-_]/)[0],t.forEach(function(o){var t;if(i)t=(t=(t=s.find(function(t){return t.get("baseUrl")==o.baseUrl||t.get("guid")==o.guid}))||h.findWhere({baseUrl:o.baseUrl}))||h.findWhere({guid:o.guid});else if(s.some(function(t){return t.get("baseUrl")==o.baseUrl||t.get("guid")==o.guid})||h.findWhere({baseUrl:o.baseUrl})||h.findWhere({guid:o.guid}))return;var e,n=[],a=!1,l=!1;o.variations.forEach(function(t){var e,i,s=!0===t.isSystem||"system"===t.type,s=(p||t.isViewer&&!1!==t.isDisplayedInViewer)&&_.contains(t.EditorsSupport,m)&&!s;s&&(a=!0),t.isViewer&&!1!==t.isDisplayedInViewer&&(l=!0),o.isUICustomizer?s&&r.push({url:o.baseUrl+t.url}):(e=new Common.Models.PluginVariation(t),i=t.description,"object"==typeof t.descriptionLocale&&(i=t.descriptionLocale[c]||t.descriptionLocale.en||i||""),_.each(t.buttons,function(t,e){"object"==typeof t.textLocale&&(t.text=t.textLocale[c]||t.textLocale.en||t.text||""),t.visible=p||!1!==t.isViewer}),e.set({description:i,index:n.length,url:t.url,icons:t.icons2||t.icons,buttons:t.buttons,visible:s,help:t.help}),n.push(e))}),0<n.length&&!o.isUICustomizer&&(e=o.name,"object"==typeof o.nameLocale&&(e=o.nameLocale[c]||o.nameLocale.en||e||""),a=a&&d.checkPluginVersion(u,o.minVersion),e={name:e,guid:o.guid,baseUrl:o.baseUrl,variations:n,currentVariation:0,visible:a,groupName:o.group?o.group.name:"",groupRank:o.group?o.group.rank:0,minVersion:o.minVersion,original:o,isDisplayedInViewer:l},t?t.set(e):s.push(new Common.Models.Plugin(e)))}),!1!==e&&(d.configPlugins.UIplugins=r),!e&&h&&((s=h.models.concat(s)).sort(function(t,e){t=t.get("groupRank"),e=e.get("groupRank");return t<e?0==t?1:-1:e<t?0==e?-1:1:0}),h.reset(s),this.appOptions.canPlugins=!h.isEmpty())):e||(this.appOptions.canPlugins=!1),e||this.getApplication().getController("LeftMenu").enablePlugins(),this.appOptions.canPlugins&&(this.refreshPluginsList(),this.runAutoStartPlugins())},checkPluginVersion:function(t,e){if(t&&"develop"!==t&&e&&"string"==typeof e){var i=e.match(/^([0-9]+)(?:.([0-9]+))?(?:.([0-9]+))?$/),s=t.match(/^([0-9]+)(?:.([0-9]+))?(?:.([0-9]+))?$/);if(i&&1<i.length&&s&&1<s.length)for(var o=0;o<3;o++){var n=i[o+1]?parseInt(i[o+1]):0,a=s[o+1]?parseInt(s[o+1]):0;if(a<n)return!1;if(n<a)return!0}}return!0},getPlugins:function(t,e){var i;return!t||t.length<1?Promise.resolve([]):(i=[],t.map(e=e||function(e){return fetch(e).then(function(t){return t.ok?t.json():Promise.reject(e)}).then(function(t){return t.baseUrl=e.substring(0,e.lastIndexOf("config.json")),t})}).reduce(function(t,e){return t.then(function(){return e}).then(function(t){return i.push(t),Promise.resolve(t)}).catch(function(t){return Promise.resolve(t)})},Promise.resolve()).then(function(){return Promise.resolve(i)}))},mergePlugins:function(){var t,e,i,s,o;void 0!==this.serverPlugins.plugins&&void 0!==this.configPlugins.plugins&&(o=[],s=!(t=[]),(e=this.configPlugins).plugins&&0<e.plugins.length&&(t=e.plugins),e&&e.config&&(i=e.config.autostart||e.config.autoStartGuid,s=!!e.config.autoStartGuid,o=(i="string"==typeof i?[i]:i)||[]),(e=this.serverPlugins).plugins&&0<e.plugins.length&&(t=t.concat(e.plugins)),e&&e.config&&(i=e.config.autostart||e.config.autoStartGuid,s||e.config.autoStartGuid,o=o.concat((i="string"==typeof i?[i]:i)||[])),this.autostart=o,this.parsePlugins(t,!1))},getAppCustomPlugins:function(e){function i(){s.customPluginsComplete=!0}var s=this;e.config?this.getPlugins(e.config.UIpluginsData).then(function(t){s.parsePlugins(t,!0),s.getPlugins(e.UIplugins,function(e){return fetch(e.url).then(function(t){return t.ok?t.text():Promise.reject()}).then(function(t){return e.code=t})}).then(i,i)},i):i()},onChangeProtectDocument:function(t){var e;(t=t?t:(e=this.getApplication().getController("DocProtection"))?e.getDocProps():null)&&this.panelPlugins&&(this.panelPlugins._state.docProtection=t,Common.Utils.lockControls(Common.enumLock.docLockView,t.isReadOnly,{array:this.panelPlugins.lockedControls}),Common.Utils.lockControls(Common.enumLock.docLockForms,t.isFormsOnly,{array:this.panelPlugins.lockedControls}),Common.Utils.lockControls(Common.enumLock.docLockComments,t.isCommentsOnly,{array:this.panelPlugins.lockedControls}))},onPluginWindowShow:function(i,e){var s,t,o,n,a,l,r,c,d,h;e.isVisual&&!this.customPluginsDlg[i]&&(s=this.appOptions&&this.appOptions.lang?this.appOptions.lang.split(/[\-_]/)[0]:"en",t=e.url,n=!0===e.isSystem||"system"===e.type,(this.appOptions.isEdit||e.isViewer&&!1!==e.isDisplayedInViewer)&&_.contains(e.EditorsSupport,this.editor)&&!n&&!e.isInsideMode&&(o=this,n=e.isCustomWindow,a=e.buttons,l=[],r=e.size,c=e.isModal,(!r||r.length<2)&&(r=[800,600]),d=e.description,"object"==typeof e.descriptionLocale&&(d=e.descriptionLocale[s]||e.descriptionLocale.en||d||""),_.isArray(a)&&_.each(a,function(t,e){"object"==typeof t.textLocale&&(t.text=t.textLocale[s]||t.textLocale.en||t.text||""),(o.appOptions.isEdit&&!o.isPDFEditor||!1!==t.isViewer)&&(l[e]={caption:t.text,value:e,primary:t.primary,frameId:i})}),h=e.help,o.customPluginsDlg[i]=new Common.Views.PluginDlg({cls:n?"plain":"",header:!n,title:d,width:r[0],height:r[1],url:t,frameId:i,buttons:n?void 0:l,toolcallback:function(t){o.api.asc_pluginButtonClick(-1,e.guid,i)},help:!!h,modal:void 0===c||c}),o.customPluginsDlg[i].on({"render:after":function(t){t.getChild(".footer .dlg-btn").on("click",function(t){o.api.asc_pluginButtonClick(parseInt(t.currentTarget.attributes.result.value),e.guid,i)}),o.customPluginsDlg[i].options.pluginContainer=o.customPluginsDlg[i].$window.find("#id-plugin-container")},close:function(t){o.customPluginsDlg[i]=void 0},drag:function(t){o.api.asc_pluginEnableMouseEvents("start"==t[1],i)},resize:function(t){o.api.asc_pluginEnableMouseEvents("start"==t[1],i)},help:function(){h&&window.open(h,"_blank")},"header:click":function(t){o.api.asc_pluginButtonClick(t,e.guid,i)}}),o.customPluginsDlg[i].show()))},onPluginWindowClose:function(t){this.customPluginsDlg[t]&&this.customPluginsDlg[t].close()},onPluginWindowResize:function(t,e,i,s,o){var n;this.customPluginsDlg[t]&&(n=i&&1<i.length&&s&&1<s.length&&(s[0]>i[0]||s[1]>i[1]||0==s[0]||0==s[1]),this.customPluginsDlg[t].setResizable(n,i,s),this.customPluginsDlg[t].setInnerSize(e[0],e[1]),o&&o.call())},onPluginWindowMouseUp:function(t,e,i){this.customPluginsDlg[t]?(this.customPluginsDlg[t].binding.dragStop&&this.customPluginsDlg[t].binding.dragStop(),this.customPluginsDlg[t].binding.resizeStop&&this.customPluginsDlg[t].binding.resizeStop()):Common.NotificationCenter.trigger("frame:mouseup",{pageX:e*Common.Utils.zoom()+this._moveOffset.x,pageY:i*Common.Utils.zoom()+this._moveOffset.y})},onPluginWindowMouseMove:function(t,e,i){var s;this.customPluginsDlg[t]?(s=this.customPluginsDlg[t].options.pluginContainer.offset(),this.customPluginsDlg[t].binding.drag&&this.customPluginsDlg[t].binding.drag({pageX:e*Common.Utils.zoom()+s.left,pageY:i*Common.Utils.zoom()+s.top}),this.customPluginsDlg[t].binding.resize&&this.customPluginsDlg[t].binding.resize({pageX:e*Common.Utils.zoom()+s.left,pageY:i*Common.Utils.zoom()+s.top})):Common.NotificationCenter.trigger("frame:mousemove",{pageX:e*Common.Utils.zoom()+this._moveOffset.x,pageY:i*Common.Utils.zoom()+this._moveOffset.y})}},Common.Controllers.Plugins||{}))}),define("common/main/lib/view/ExternalEditor",["common/main/lib/component/Window"],function(){"use strict";Common.Views.ExternalEditor=Common.UI.Window.extend(_.extend({initialize:function(t){var e=Common.localStorage.getKeysFilter(),e=e&&e.length?e.split(",")[0]:"",e=(this.storageName=e+(t.storageName||"external-editor"),{}),i=t.initwidth||900,s=t.initheight||700,o=Common.localStorage.getItem(this.storageName+"-width"),o=(o&&(i=parseInt(o)),(o=Common.localStorage.getItem(this.storageName+"-height"))&&(s=parseInt(o)),Common.Utils.innerHeight()-Common.Utils.InternalSettings.get("window-inactive-area-top"));_.extend(e,{width:i,height:o-s<0?o:s,cls:"advanced-settings-dlg",header:!0,toolclose:"hide",toolcallback:_.bind(this.onToolClose,this),resizable:!0},t),this._headerFooterHeight=85,this.template=['<div id="id-editor-container" class="box" style="height:'+(e.height-this._headerFooterHeight)+'px; padding: 0 5px;">','<div id="'+(e.sdkplaceholder||"")+'" style="width: 100%;height: 100%;"></div>',"</div>",'<div class="separator horizontal"></div>','<div class="footer" style="text-align: center;">','<button id="id-btn-editor-apply" class="btn normal dlg-btn primary custom" result="ok" data-hint="1" data-hint-direction="bottom" data-hint-offset="big">'+this.textSave+"</button>",'<button id="id-btn-editor-cancel" class="btn normal dlg-btn" result="cancel" data-hint="1" data-hint-direction="bottom" data-hint-offset="big">'+this.textClose+"</button>","</div>"].join(""),e.tpl=_.template(this.template)(e),this.handler=e.handler,this._isNewObject=!0,this.on("resize",_.bind(this.onWindowResize,this)),Common.UI.Window.prototype.initialize.call(this,e)},render:function(){Common.UI.Window.prototype.render.call(this),this.boxEl=this.$window.find(".body > .box"),this.btnSave=new Common.UI.Button({el:this.$window.find("#id-btn-editor-apply"),disabled:!0}),this.btnCancel=new Common.UI.Button({el:this.$window.find("#id-btn-editor-cancel")}),this.$window.find(".dlg-btn").on("click",_.bind(this.onDlgBtnClick,this))},show:function(){Common.UI.Window.prototype.show.apply(this,arguments)},setEditMode:function(t){this._isNewObject=!t},isEditMode:function(){return!this._isNewObject},setControlsDisabled:function(t){this.btnSave.setDisabled(t),this.btnCancel.setDisabled(t),t?this.$window.find(".tool.close").addClass("disabled"):this.$window.find(".tool.close").removeClass("disabled")},onDlgBtnClick:function(t){this.handler?this.handler.call(this,t.currentTarget.attributes.result.value):this.hide()},onToolClose:function(){this.handler?this.handler.call(this,"cancel"):this.hide()},setHeight:function(t){var e;0<=t&&(e=parseInt(this.$window.css("min-height")),this.$window.height(t=t<e?e:t),e=this.initConfig.header?parseInt(this.$window.find("> .header").css("height")):0,this.$window.find("> .body").css("height",t-e),this.$window.find("> .body > .box").css("height",t-this._headerFooterHeight))},setInCenter:function(){var t=this.$window.height(),t=(Common.Utils.innerHeight()-Common.Utils.InternalSettings.get("window-inactive-area-top")-parseInt(t))/2,e=(Common.Utils.innerWidth()-parseInt(this.initConfig.width))/2;this.$window.css("left",e),this.$window.css("top",Common.Utils.InternalSettings.get("window-inactive-area-top")+t)},setInnerSize:function(t,e){var i=Common.Utils.innerHeight(),s=Common.Utils.innerWidth(),o=parseInt(this.$window.css("border-left-width"))+parseInt(this.$window.css("border-right-width")),n=parseInt(this.boxEl.css("padding-left"))+parseInt(this.boxEl.css("padding-right"));i<(e+=90)+this._headerFooterHeight&&(e=i-this._headerFooterHeight),s<t+n+o&&(t=s-n-o),this.boxEl.css("height",e),this.setHeight(e+this._headerFooterHeight),this.setWidth(t+n+o),this.getLeft()<0&&this.$window.css("left",0),this.getTop()<Common.Utils.InternalSettings.get("window-inactive-area-top")&&this.$window.css("top",Common.Utils.InternalSettings.get("window-inactive-area-top"))},onWindowResize:function(t){t&&"end"==t[1]&&(t=this.getSize(),Common.localStorage.setItem(this.storageName+"-width",t[0]),Common.localStorage.setItem(this.storageName+"-height",t[1]))}},Common.Views.ExternalEditor||{}))}),define("common/main/lib/view/ExternalOleEditor",["common/main/lib/view/ExternalEditor"],function(){"use strict";Common.Views.ExternalOleEditor=Common.Views.ExternalEditor.extend(_.extend({initialize:function(t){var e={};_.extend(e,{id:"id-external-ole-editor",title:this.textTitle,storageName:"ole-editor",sdkplaceholder:"id-ole-editor-placeholder",initwidth:900,initheight:700,minwidth:875,minheight:275},t),this._oleData=null,Common.Views.ExternalEditor.prototype.initialize.call(this,e)},setOleData:function(t){this._oleData=t,this._isExternalDocReady&&this.fireEvent("setoledata",this)}},Common.Views.ExternalOleEditor||{}))}),void 0===Common&&(Common={}),Common.Controllers=Common.Controllers||{},define("common/main/lib/controller/ExternalOleEditor",["core","common/main/lib/view/ExternalOleEditor"],function(){"use strict";var s,o,n,a,l;Common.Controllers.ExternalOleEditor=Backbone.Controller.extend(_.extend((s="zh",o=void 0,n="",l=!(a=null),{views:["Common.Views.ExternalOleEditor"],initialize:function(){this.addListeners({"Common.Views.ExternalOleEditor":{setoledata:_.bind(this.setOleData,this),drag:_.bind(function(t,e){a&&a.serviceCommand("window:drag","start"==e)},this),resize:_.bind(function(t,e){a&&a.serviceCommand("window:resize","start"==e)},this),show:_.bind(function(t){var e=this.oleEditorView.getHeight(),i=Common.Utils.innerHeight()-Common.Utils.InternalSettings.get("window-inactive-area-top");i<e&&this.oleEditorView.setHeight(i),a?(a.serviceCommand("setAppDisabled",!1),l&&this.oleEditorView._isExternalDocReady&&(l=!1,this.oleEditorView._oleData&&this.setOleData()),this.needDisableEditing&&this.oleEditorView._isExternalDocReady&&this.onOleEditingDisabled(),a.attachMouseEvents()):require(["api"],function(){!function(){Common.UI.HintManager.setInternalEditorLoading(!0),o&&(o.uiTheme=Common.localStorage.getItem("ui-theme-id","theme-light")),a=new DocsAPI.DocEditor("id-ole-editor-placeholder",{width:"100%",height:"100%",documentType:"cell",document:{url:"_chart_",permissions:{edit:!0,download:!1}},editorConfig:{mode:"editole",targetApp:n,lang:s,canCoAuthoring:!1,canBackToFolder:!1,canCreateNew:!1,customization:o,user:{id:"uid-"+Date.now()}},events:{onAppReady:function(){},onDocumentStateChange:function(){},onError:function(){},onInternalMessage:_.bind(this.onInternalMessage,this)}}),Common.Gateway.on("processmouse",_.bind(this.onProcessMouse,this))}.apply(this)}.bind(this)),this.isExternalEditorVisible=!0,this.isHandlerCalled=!1},this),hide:_.bind(function(t){a&&(a.detachMouseEvents(),this.isExternalEditorVisible=!1),Common.UI.HintManager.setInternalEditorLoading(!1)},this)}})},onLaunch:function(){this.oleEditorView=this.createView("Common.Views.ExternalOleEditor",{handler:_.bind(this.handler,this)})},setApi:function(t){return this.api=t,this.api.asc_registerCallback("asc_onCloseOleEditor",_.bind(this.onOleEditingDisabled,this)),this.api.asc_registerCallback("asc_sendFromGeneralToFrameEditor",_.bind(this.onSendFromGeneralToFrameEditor,this)),this},handler:function(t,e){this.isHandlerCalled||(this.isHandlerCalled=!0,this.oleEditorView._isExternalDocReady?a&&a.serviceCommand("queryClose",{mr:t}):(this.oleEditorView.hide(),this.isHandlerCalled=!1))},setOleData:function(){l||(a&&a.serviceCommand("setOleData",this.oleEditorView._oleData),this.oleEditorView._oleData=null)},loadConfig:function(t){t&&t.config&&(t.config.lang&&(s=t.config.lang),t.config.customization&&(o=t.config.customization),t.config.targetApp&&(n=t.config.targetApp))},onOleEditingDisabled:function(){this.oleEditorView.isVisible()&&this.oleEditorView._isExternalDocReady?(this.oleEditorView.setControlsDisabled(!0),Common.UI.alert({title:this.warningTitle,msg:this.warningText,iconCls:"warn",buttons:["ok"],callback:_.bind(function(t){this.oleEditorView.setControlsDisabled(!1),this.oleEditorView.hide()},this)}),this.needDisableEditing=!1):this.needDisableEditing=!0},onInternalMessage:function(t){var e,i,t=t.data;this.oleEditorView&&("documentReady"==t.type?(this.oleEditorView._isExternalDocReady=!0,this.isExternalEditorVisible&&(l=!1),this.oleEditorView._oleData&&this.setOleData(),this.needDisableEditing&&this.onOleEditingDisabled()):"oleEditorReady"==t.type?void 0===this.needDisableEditing&&this.oleEditorView.setControlsDisabled(!1):"shortcut"==t.type?"escape"==t.data.key&&this.oleEditorView.hide():"canClose"==t.type?(!0===t.data.answer&&(a&&(a.serviceCommand("setAppDisabled",!0),"ok"==t.data.mr&&a.serviceCommand("getOleData")),this.oleEditorView.hide()),this.isHandlerCalled=!1):"processMouse"==t.type?"mouse:up"==t.data.event?(this.oleEditorView.binding.dragStop(),this.oleEditorView.binding.resizeStop&&this.oleEditorView.binding.resizeStop()):"mouse:move"==t.data.event&&(e=parseInt(this.oleEditorView.$window.css("left"))+t.data.pagex,i=parseInt(this.oleEditorView.$window.css("top"))+t.data.pagey+34,this.oleEditorView.binding.drag({pageX:e,pageY:i}),this.oleEditorView.binding.resize&&this.oleEditorView.binding.resize({pageX:e,pageY:i})):"resize"==t.type?(e=t.data.width,i=t.data.height,0<e&&0<i&&this.oleEditorView.setInnerSize(e,i)):"frameToGeneralData"==t.type?this.api&&this.api.asc_getInformationBetweenFrameAndGeneralEditor(t.data):this.oleEditorView.fireEvent("internalmessage",this.oleEditorView,t))},onProcessMouse:function(t){"mouseup"==t.type&&this.isExternalEditorVisible&&a&&a.serviceCommand("processmouse",t)},onSendFromGeneralToFrameEditor:function(t){a&&a.serviceCommand("generalToFrameData",t)}}),Common.Controllers.ExternalOleEditor||{}))}),void 0===Common&&(Common={}),Common.Models=Common.Models||{},define("common/main/lib/model/ReviewChange",["underscore","backbone","common/main/lib/component/BaseView"],function(t,e){"use strict";Common.Models.ReviewChange=e.Model.extend({defaults:{uid:0,userid:0,username:"Guest",usercolor:null,date:void 0,changetext:"",lock:!1,lockuser:"",type:0,changedata:null,hint:!1,editable:!1,id:Common.UI.getId(),scope:null}})}),void 0===Common&&(Common={}),Common.Collections=Common.Collections||{},define("common/main/lib/collection/ReviewChanges",["underscore","backbone","common/main/lib/model/ReviewChange"],function(t,e){"use strict";Common.Collections.ReviewChanges=e.Collection.extend({model:Common.Models.ReviewChange})}),void 0===Common&&(Common={}),Common.Views=Common.Views||{},define("common/main/lib/view/ReviewChanges",["common/main/lib/util/utils","common/main/lib/component/Button","common/main/lib/component/DataView","common/main/lib/component/Layout","common/main/lib/component/Window"],function(){"use strict";Common.enumLock||(Common.enumLock={});var t,e={noSpellcheckLangs:"no-spellcheck-langs",isReviewOnly:"review-only",reviewChangelock:"review-change-lock",hasCoeditingUsers:"has-coediting-users",previewReviewMode:"preview-review-mode",viewFormMode:"view-form-mode",viewMode:"view-mode",hideComments:"hide-comments",cantShare:"cant-share"};for(t in e)e.hasOwnProperty(t)&&(Common.enumLock[t]=e[t]);Common.Views.ReviewChanges=Common.UI.BaseView.extend(_.extend({options:{},initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t),this.appConfig=t.mode,this.lockedControls=[];var e,t=Common.localStorage.getKeysFilter(),t=(this.appPrefix=t&&t.length?t.split(",")[0]:"",Common.enumLock);this.appConfig.canReview&&(this.btnAccept=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",caption:this.txtAccept,split:!this.appConfig.canUseReviewPermissions,iconCls:"toolbar__icon btn-review-save",lock:[t.reviewChangelock,t.isReviewOnly,t.previewReviewMode,t.viewFormMode,t.lostConnect,t.docLockView,t.docLockForms,t.docLockComments,t.docLockReview],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.lockedControls.push(this.btnAccept),this.btnReject=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",caption:this.txtReject,split:!this.appConfig.canUseReviewPermissions,iconCls:"toolbar__icon btn-review-deny",lock:[t.reviewChangelock,t.isReviewOnly,t.previewReviewMode,t.viewFormMode,t.lostConnect,t.docLockView,t.docLockForms,t.docLockComments,t.docLockReview],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.lockedControls.push(this.btnReject),this.appConfig.canFeatureComparison&&(this.btnCompare=new Common.UI.Button({cls:"btn-toolbar  x-huge icon-top",caption:this.txtCompare,split:!0,iconCls:"toolbar__icon btn-compare",lock:[t.hasCoeditingUsers,t.previewReviewMode,t.viewFormMode,t.lostConnect,t.docLockView,t.docLockForms,t.docLockComments],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.lockedControls.push(this.btnCompare),this.btnCombine=new Common.UI.Button({cls:"btn-toolbar  x-huge icon-top",caption:this.txtCombine,split:!0,iconCls:"toolbar__icon btn-combine",lock:[t.hasCoeditingUsers,t.previewReviewMode,t.viewFormMode,t.lostConnect,t.docLockView,t.docLockForms,t.docLockComments],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.lockedControls.push(this.btnCombine)),this.btnTurnOn=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-big-ic-review",lock:[t.previewReviewMode,t.viewFormMode,t.lostConnect,t.docLockView,t.docLockForms,t.docLockComments,t.docLockReview],caption:this.txtTurnon,split:!this.appConfig.isReviewOnly,enableToggle:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.btnsTurnReview=[this.btnTurnOn],this.lockedControls.push(this.btnTurnOn)),this.appConfig.canViewReview&&(this.btnPrev=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-review-prev",lock:[t.previewReviewMode,t.viewFormMode,t.lostConnect,t.docLockView,t.docLockForms,t.docLockComments],caption:this.txtPrev,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.lockedControls.push(this.btnPrev),this.btnNext=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-review-next",lock:[t.previewReviewMode,t.viewFormMode,t.lostConnect,t.docLockView,t.docLockForms,t.docLockComments],caption:this.txtNext,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.lockedControls.push(this.btnNext),this.appConfig.isRestrictedEdit||this.appConfig.customization&&this.appConfig.customization.review&&this.appConfig.customization.review.hideReviewDisplay||(e=_.template('<a id="<%= id %>" tabindex="-1" type="menuitem"><div><b><%= caption %></b></div><% if (options.description !== null) { %><label class="description"><%= options.description %></label><% } %></a>'),this.btnReviewView=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-ic-reviewview",lock:[t.viewFormMode,t.lostConnect,t.docLockView,t.docLockForms,t.docLockComments],caption:this.txtView,menu:new Common.UI.Menu({cls:"ppm-toolbar",items:[{caption:this.txtMarkupCap,checkable:!0,toggleGroup:"menuReviewView",checked:!0,value:"markup",template:e,description:Common.Utils.String.format(this.txtMarkup,this.appConfig.isEdit||this.appConfig.isRestrictedEdit?"("+this.txtEditing+")":"")},{caption:this.txtMarkupSimpleCap,checkable:!0,toggleGroup:"menuReviewView",checked:!1,value:"simple",template:e,description:Common.Utils.String.format(this.txtMarkupSimple,this.appConfig.isEdit||this.appConfig.isRestrictedEdit?"("+this.txtEditing+")":"")},{caption:this.txtFinalCap,checkable:!0,toggleGroup:"menuReviewView",checked:!1,template:e,description:Common.Utils.String.format(this.txtFinal,this.appConfig.isEdit||this.appConfig.isRestrictedEdit?"("+this.txtPreview+")":""),value:"final"},{caption:this.txtOriginalCap,checkable:!0,toggleGroup:"menuReviewView",checked:!1,template:e,description:Common.Utils.String.format(this.txtOriginal,this.appConfig.isEdit||this.appConfig.isRestrictedEdit?"("+this.txtPreview+")":""),value:"original"}]}),dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.lockedControls.push(this.btnReviewView))),(this.appConfig.sharingSettingsUrl&&this.appConfig.sharingSettingsUrl.length||this.appConfig.canRequestSharingSettings)&&!0!==this._readonlyRights&&(this.btnSharing=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-ic-sharing",lock:[t.viewFormMode,t.cantShare,t.lostConnect],caption:this.txtSharing,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.lockedControls.push(this.btnSharing)),this.appConfig.isEdit&&!this.appConfig.isOffline&&this.appConfig.canCoAuthoring&&this.appConfig.canChangeCoAuthoring&&(this.btnCoAuthMode=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-ic-coedit",lock:[t.viewFormMode,t.lostConnect,t.docLockView],caption:this.txtCoAuthMode,menu:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.lockedControls.push(this.btnCoAuthMode)),this.btnsSpelling=[],this.btnsDocLang=[],this.appConfig.canUseHistory&&!this.appConfig.isDisconnected&&(this.btnHistory=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-ic-history",lock:[t.lostConnect],caption:this.txtHistory,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.lockedControls.push(this.btnHistory)),this.appConfig.canCoAuthoring&&this.appConfig.canChat&&(this.btnChat=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-ic-chat",lock:[t.lostConnect],caption:this.txtChat,enableToggle:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.lockedControls.push(this.btnChat)),this.appConfig.canCoAuthoring&&this.appConfig.canComments&&(this.canComments=!0,this.btnCommentRemove=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",caption:this.txtCommentRemove,split:!0,iconCls:"toolbar__icon btn-rem-comment",lock:[t.previewReviewMode,t.viewFormMode,t.hideComments,t.Objects,t.lostConnect,t.docLockView,t.docLockForms],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.lockedControls.push(this.btnCommentRemove),this.btnCommentResolve=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",caption:this.txtCommentResolve,split:!0,iconCls:"toolbar__icon btn-resolve-all",lock:[t.previewReviewMode,t.viewFormMode,t.hideComments,t.Objects,t.lostConnect,t.docLockView,t.docLockForms],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.lockedControls.push(this.btnCommentResolve))},render:function(t){return this.boxSdk=$("#editor_sdk"),t&&t.html(this.getPanel()),this},onAppReady:function(a){var l=this;new Promise(function(t,e){t()}).then(function(){var t,e=_.template('<a id="<%= id %>" tabindex="-1" type="menuitem"><div><b><%= caption %></b></div><% if (options.description !== null) { %><label class="description"><%= options.description %></label><% } %></a>'),i=(a.canReview&&(i=Common.Utils.InternalSettings.get(l.appPrefix+"track-changes"),a.isReviewOnly||l.btnTurnOn.setMenu(new Common.UI.Menu({items:[{caption:l.txtOn,value:0,checkable:!0,checked:0==i,toggleGroup:"menuTurnReviewTlb"},{caption:l.txtOff,value:1,checkable:!0,checked:1==i,toggleGroup:"menuTurnReviewTlb"},{caption:l.txtOnGlobal,value:2,checkable:!0,checked:2==i,toggleGroup:"menuTurnReviewTlb"},{caption:l.txtOffGlobal,value:3,checkable:!0,checked:3==i,toggleGroup:"menuTurnReviewTlb"}]})),l.btnTurnOn.updateHint(l.tipReview),l.appConfig.canUseReviewPermissions||(l.btnAccept.setMenu(new Common.UI.Menu({items:[{caption:l.txtAcceptCurrent,value:"current"},{caption:l.txtAcceptAll,value:"all"}]})),l.btnReject.setMenu(new Common.UI.Menu({items:[{caption:l.txtRejectCurrent,value:"current"},{caption:l.txtRejectAll,value:"all"}]}))),l.btnAccept.updateHint([l.tipAcceptCurrent,l.txtAcceptChanges]),l.btnReject.updateHint([l.tipRejectCurrent,l.txtRejectChanges]),a.canFeatureComparison&&(l.btnCompare.setMenu(new Common.UI.Menu({items:[{caption:l.mniFromFile,value:"file"},{caption:l.mniFromUrl,value:"url"},{caption:l.mniFromStorage,value:"storage"}]})),l.btnCompare.menu.items[2].setVisible(l.appConfig.canRequestSelectDocument||l.appConfig.canRequestCompareFile||l.appConfig.fileChoiceUrl&&-1<l.appConfig.fileChoiceUrl.indexOf("{documentType}")),l.btnCompare.menu.items[1].setDisabled(l.appConfig.disableNetworkFunctionality),l.btnCompare.menu.items[2].setDisabled(l.appConfig.disableNetworkFunctionality),l.btnCompare.updateHint(l.tipCompare),l.btnCombine.setMenu(new Common.UI.Menu({items:[{caption:l.mniFromFile,value:"file"},{caption:l.mniFromUrl,value:"url"},{caption:l.mniFromStorage,value:"storage"}]})),l.btnCombine.menu.items[2].setVisible(l.appConfig.canRequestSelectDocument||l.appConfig.fileChoiceUrl&&-1<l.appConfig.fileChoiceUrl.indexOf("{documentType}")),l.btnCombine.menu.items[1].setDisabled(l.appConfig.disableNetworkFunctionality),l.btnCombine.menu.items[2].setDisabled(l.appConfig.disableNetworkFunctionality),l.btnCombine.updateHint(l.tipCombine)),Common.Utils.lockControls(Common.enumLock.isReviewOnly,a.isReviewOnly,{array:[l.btnAccept,l.btnReject]})),l.appConfig.canViewReview&&(l.btnPrev.updateHint(l.hintPrev),l.btnNext.updateHint(l.hintNext),l.btnReviewView&&l.btnReviewView.updateHint(l.tipReviewView)),l.btnSharing&&l.btnSharing.updateHint(l.tipSharing),l.btnHistory&&l.btnHistory.updateHint(l.tipHistory),l.btnChat&&l.btnChat.updateHint(l.txtChat+Common.Utils.String.platformKey("Alt+Q"," ("+(Common.Utils.isMac?Common.Utils.String.textCtrl+"+":"")+"{0})")),l.btnCoAuthMode&&(l.btnCoAuthMode.setMenu(new Common.UI.Menu({cls:"ppm-toolbar",style:"max-width: 220px;",items:[{caption:l.strFast,checkable:!0,toggleGroup:"menuCoauthMode",checked:!0,template:e,description:l.strFastDesc,value:1},{caption:l.strStrict,checkable:!0,toggleGroup:"menuCoauthMode",checked:!1,template:e,description:l.strStrictDesc,value:0}]})),l.btnCoAuthMode.updateHint(l.tipCoAuthMode),l.turnCoAuthMode(Common.Utils.InternalSettings.get(l.appPrefix+"settings-coauthmode"))),l.btnCommentRemove&&(s=[{caption:a.canDeleteComments?l.txtCommentRemCurrent:l.txtCommentRemMyCurrent,value:"current"},{caption:l.txtCommentRemMy,value:"my"}],a.canDeleteComments&&s.push({caption:l.txtCommentRemAll,value:"all"}),l.btnCommentRemove.setMenu(new Common.UI.Menu({items:s})),l.btnCommentRemove.updateHint([l.tipCommentRemCurrent,l.tipCommentRem])),l.btnCommentResolve&&(s=[{caption:a.canEditComments?l.txtCommentResolveCurrent:l.txtCommentResolveMyCurrent,value:"current"},{caption:l.txtCommentResolveMy,value:"my"}],a.canEditComments&&s.push({caption:l.txtCommentResolveAll,value:"all"}),l.btnCommentResolve.setMenu(new Common.UI.Menu({items:s})),l.btnCommentResolve.updateHint([l.tipCommentResolveCurrent,l.tipCommentResolve])),l.btnSharing||l.btnCoAuthMode?".separator.sharing":l.$el.find(".separator.sharing")),e=l.btnCommentRemove||l.btnCommentResolve?".separator.comments":l.$el.find(".separator.comments"),s=a.canReview||a.canViewReview?".separator.review":l.$el.find(".separator.review"),o=a.canReview&&a.canFeatureComparison?".separator.compare":l.$el.find(".separator.compare"),n=l.btnChat?".separator.chat":l.$el.find(".separator.chat");"object"==typeof i?i.hide().prev(".group").hide():t=i,"object"==typeof e?e.hide().prev(".group").hide():t=e,"object"==typeof s?s.hide().prevUntil(".separator.comments").hide():t=s,"object"==typeof o?o.hide().prev(".group").hide():t=o,"object"==typeof n?n.hide().prev(".group").hide():t=n,!l.btnHistory&&t&&l.$el.find(t).hide(),Common.NotificationCenter.trigger("tab:visible","review",(a.isEdit||a.canViewReview||l.canComments)&&Common.UI.LayoutManager.isElementVisible("toolbar-collaboration")),function(){var o=this;o.appConfig.canReview&&(this.btnAccept.on("click",function(t){o.fireEvent("reviewchange:accept",[o.btnAccept,"current"])}),this.btnAccept.menu&&this.btnAccept.menu.on("item:click",function(t,e,i){o.fireEvent("reviewchange:accept",[t,e])}),this.btnReject.on("click",function(t){o.fireEvent("reviewchange:reject",[o.btnReject,"current"])}),this.btnReject.menu&&this.btnReject.menu.on("item:click",function(t,e,i){o.fireEvent("reviewchange:reject",[t,e])}),o.appConfig.canFeatureComparison&&(this.btnCompare.on("click",function(t){o.fireEvent("reviewchange:compare",["file"])}),this.btnCompare.menu.on("item:click",function(t,e,i){o.fireEvent("reviewchange:compare",[e.value])}),this.btnCombine.on("click",function(t){o.fireEvent("reviewchange:combine",["file"])}),this.btnCombine.menu.on("item:click",function(t,e,i){o.fireEvent("reviewchange:combine",[e.value])})),this.btnsTurnReview.forEach(function(t){t.on("click",function(t,e){Common.NotificationCenter.trigger("reviewchanges:turn",t.pressed),Common.NotificationCenter.trigger("edit:complete")}),o.appConfig.isReviewOnly||t.menu.on("item:toggle",function(t,e,i,s){i&&(2==e.value?Common.UI.warning({title:o.textWarnTrackChangesTitle,msg:o.textWarnTrackChanges,maxwidth:600,buttons:[{value:"enable",caption:o.textEnable},"cancel"],primary:"enable",callback:function(t){"enable"==t?Common.NotificationCenter.trigger("reviewchanges:turn",0==e.value||2==e.value,1<e.value):(t=Common.Utils.InternalSettings.get(o.appPrefix+"track-changes"),o.turnChanges(0==t||2==t,1<t)),Common.NotificationCenter.trigger("edit:complete")}}):Common.NotificationCenter.trigger("reviewchanges:turn",0==e.value||2==e.value,1<e.value))})})),this.appConfig.canViewReview&&(this.btnPrev.on("click",function(t){o.fireEvent("reviewchange:preview",[o.btnPrev,"prev"])}),this.btnNext.on("click",function(t){o.fireEvent("reviewchange:preview",[o.btnNext,"next"])}),this.btnReviewView&&this.btnReviewView.menu.on("item:click",function(t,e,i){o.fireEvent("reviewchange:view",[t,e])})),this.btnsSpelling.forEach(function(t){t.on("click",function(t,e){Common.NotificationCenter.trigger("spelling:turn",t.pressed?"on":"off"),Common.NotificationCenter.trigger("edit:complete",o)})}),this.btnsDocLang.forEach(function(t){t.on("click",function(t,e){o.fireEvent("lang:document",this)})}),this.btnSharing&&this.btnSharing.on("click",function(t,e){Common.NotificationCenter.trigger("collaboration:sharing")}),this.btnCoAuthMode&&this.btnCoAuthMode.menu.on("item:click",function(t,e,i){o.fireEvent("collaboration:coauthmode",[t,e])}),this.btnHistory&&this.btnHistory.on("click",function(t,e){Common.NotificationCenter.trigger("collaboration:history")}),this.btnChat&&this.btnChat.on("click",function(t,e){o.fireEvent("collaboration:chat",[t.pressed])}),this.btnCommentRemove&&(this.btnCommentRemove.on("click",function(t){o.fireEvent("comment:removeComments",["current"])}),this.btnCommentRemove.menu.on("item:click",function(t,e,i){o.fireEvent("comment:removeComments",[e.value])})),this.btnCommentResolve&&(this.btnCommentResolve.on("click",function(t){o.fireEvent("comment:resolveComments",["current"])}),this.btnCommentResolve.menu.on("item:click",function(t,e,i){o.fireEvent("comment:resolveComments",[e.value])})),Common.NotificationCenter.on("protect:doclock",function(t){o.fireEvent("protect:update")}),o.fireEvent("protect:update")}.call(l)})},getPanel:function(){return this.$el=$(_.template('<section id="review-changes-panel" class="panel" data-tab="review"><div class="group no-group-mask review"><span id="slot-btn-sharing" class="btn-slot text x-huge"></span><span id="slot-btn-coauthmode" class="btn-slot text x-huge"></span></div><div class="separator long sharing"></div><div class="group"><span class="btn-slot text x-huge slot-comment"></span><span class="btn-slot text x-huge" id="slot-comment-remove"></span><span class="btn-slot text x-huge" id="slot-comment-resolve"></span></div><div class="separator long comments"></div><div class="group"><span id="btn-review-on" class="btn-slot text x-huge"></span></div><div class="group no-group-mask review" style="padding-left: 0;padding-right:0;"><span id="btn-review-view" class="btn-slot text x-huge"></span></div><div class="group move-changes" style="padding-left: 0;padding-right:0;"><span id="btn-change-prev" class="btn-slot text x-huge"></span><span id="btn-change-next" class="btn-slot text x-huge"></span><span id="btn-change-accept" class="btn-slot text x-huge"></span><span id="btn-change-reject" class="btn-slot text x-huge"></span></div><div class="separator long review"></div><div class="group"><span id="slot-btn-compare" class="btn-slot text x-huge"></span><span id="slot-btn-combine" class="btn-slot text x-huge"></span></div><div class="separator long compare"></div><div class="group no-group-mask review form-view"><span id="slot-btn-chat" class="btn-slot text x-huge"></span></div><div class="separator long chat"></div><div class="group no-group-mask review form-view"><span id="slot-btn-history" class="btn-slot text x-huge"></span></div></section>')({})),this.appConfig.canReview&&(this.btnAccept.render(this.$el.find("#btn-change-accept")),this.btnReject.render(this.$el.find("#btn-change-reject")),this.appConfig.canFeatureComparison&&this.btnCompare.render(this.$el.find("#slot-btn-compare")),this.appConfig.canFeatureComparison&&this.btnCombine.render(this.$el.find("#slot-btn-combine")),this.btnTurnOn.render(this.$el.find("#btn-review-on"))),this.btnPrev&&this.btnPrev.render(this.$el.find("#btn-change-prev")),this.btnNext&&this.btnNext.render(this.$el.find("#btn-change-next")),this.btnReviewView&&this.btnReviewView.render(this.$el.find("#btn-review-view")),this.btnSharing&&this.btnSharing.render(this.$el.find("#slot-btn-sharing")),this.btnCoAuthMode&&this.btnCoAuthMode.render(this.$el.find("#slot-btn-coauthmode")),this.btnHistory&&this.btnHistory.render(this.$el.find("#slot-btn-history")),this.btnChat&&this.btnChat.render(this.$el.find("#slot-btn-chat")),this.btnCommentRemove&&this.btnCommentRemove.render(this.$el.find("#slot-comment-remove")),this.btnCommentResolve&&this.btnCommentResolve.render(this.$el.find("#slot-comment-resolve")),this.$el},show:function(){Common.UI.BaseView.prototype.show.call(this),this.fireEvent("show",this)},getButton:function(t,e){var i;return"turn"==t&&"statusbar"==e?(i=new Common.UI.Button({cls:"btn-toolbar",iconCls:"toolbar__icon btn-ic-review",lock:[Common.enumLock.viewMode,Common.enumLock.previewReviewMode,Common.enumLock.viewFormMode,Common.enumLock.lostConnect,Common.enumLock.docLockView,Common.enumLock.docLockForms,Common.enumLock.docLockComments,Common.enumLock.docLockReview],hintAnchor:"top",hint:this.tipReview,split:!this.appConfig.isReviewOnly,enableToggle:!0,menu:!this.appConfig.isReviewOnly&&new Common.UI.Menu({menuAlign:"bl-tl",style:"margin-top:-5px;",items:[{caption:this.txtOn,value:0,checkable:!0,toggleGroup:"menuTurnReviewStb"},{caption:this.txtOff,value:1,checkable:!0,toggleGroup:"menuTurnReviewStb"},{caption:this.txtOnGlobal,value:2,checkable:!0,toggleGroup:"menuTurnReviewStb"},{caption:this.txtOffGlobal,value:3,checkable:!0,toggleGroup:"menuTurnReviewStb"}]}),dataHint:"0",dataHintDirection:"top",dataHintOffset:"2, -16"}),this.btnsTurnReview.push(i),this.lockedControls.push(i),i):"spelling"==t?(i=new Common.UI.Button({cls:"btn-toolbar",iconCls:"toolbar__icon btn-ic-docspell",lock:[Common.enumLock.viewMode,Common.enumLock.viewFormMode,Common.enumLock.previewReviewMode,Common.enumLock.docLockView,Common.enumLock.docLockForms,Common.enumLock.docLockComments],hintAnchor:"top",hint:this.tipSetSpelling,enableToggle:!0,dataHint:"0",dataHintDirection:"top",dataHintOffset:"small",visible:Common.UI.FeaturesManager.canChange("spellcheck")}),this.btnsSpelling.push(i),this.lockedControls.push(i),i):"doclang"==t&&"statusbar"==e?(i=new Common.UI.Button({cls:"btn-toolbar",iconCls:"toolbar__icon btn-ic-doclang",lock:[Common.enumLock.viewMode,Common.enumLock.previewReviewMode,Common.enumLock.viewFormMode,Common.enumLock.noSpellcheckLangs,Common.enumLock.lostConnect,Common.enumLock.docLockView,Common.enumLock.docLockForms,Common.enumLock.docLockComments],hintAnchor:"top",hint:this.tipSetDocLang,dataHint:"0",dataHintDirection:"top",dataHintOffset:"small"}),this.btnsDocLang.push(i),this.lockedControls.push(i),Common.Utils.lockControls(Common.enumLock.noSpellcheckLangs,!0,{array:[i]}),i):void 0},getButtons:function(){return this.lockedControls},getUserName:function(t){return Common.Utils.String.htmlEncode(AscCommon.UserInfoParser.getParsedName(t))},turnChanges:function(e,i){this.btnsTurnReview.forEach(function(t){t&&t.pressed!=e&&t.toggle(e,!0),t.menu&&(t.menu.items[0].setChecked(e&&!i,!0),t.menu.items[1].setChecked(!e&&!i,!0),t.menu.items[2].setChecked(e&&!!i,!0),t.menu.items[3].setChecked(!e&&!!i,!0))},this)},markChanges:function(e){this.btnsTurnReview.forEach(function(t){t&&$(".icon",t.cmpEl)[e?"addClass":"removeClass"]("btn-ic-changes")},this)},turnSpelling:function(e){this.btnsSpelling&&this.btnsSpelling.forEach(function(t){t&&t.pressed!=e&&t.toggle(e,!0)},this)},turnCoAuthMode:function(t){this.btnCoAuthMode&&(this.btnCoAuthMode.menu.items[0].setChecked(t,!0),this.btnCoAuthMode.menu.items[1].setChecked(!t,!0))},turnChat:function(t){this.btnChat&&this.btnChat.toggle(t,!0)},turnDisplayMode:function(t){this.btnReviewView&&(this.btnReviewView.menu.items[0].setChecked("markup"==t,!0),this.btnReviewView.menu.items[1].setChecked("simple"==t,!0),this.btnReviewView.menu.items[2].setChecked("final"==t,!0),this.btnReviewView.menu.items[3].setChecked("original"==t,!0))},onLostEditRights:function(){this._readonlyRights=!0}},Common.Views.ReviewChanges||{})),Common.Views.ReviewChangesDialog=Common.UI.Window.extend(_.extend({options:{width:330,height:90,title:"Review Changes",modal:!1,cls:"review-changes modal-dlg",alias:"Common.Views.ReviewChangesDialog"},initialize:function(t){_.extend(this.options,{title:this.textTitle},t||{}),this.template=['<div class="box">','<div class="input-row">','<div id="id-review-button-prev" style=""></div>','<div id="id-review-button-next" style=""></div>','<div id="id-review-button-accept" style=""></div>','<div id="id-review-button-reject" style="margin-right: 0;"></div>',"</div>","</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),this.popoverChanges=this.options.popoverChanges,this.mode=this.options.mode,this.docProtection=this.options.docProtection;t=Common.localStorage.getKeysFilter();this.appPrefix=t&&t.length?t.split(",")[0]:"",Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var t=Common.enumLock,t=(this.btnPrev=new Common.UI.Button({cls:"dlg-btn iconic",iconCls:"img-commonctrl prev",hint:this.txtPrev,hintAnchor:"top"}),this.btnPrev.render(this.$window.find("#id-review-button-prev")),this.btnNext=new Common.UI.Button({cls:" dlg-btn iconic",iconCls:"img-commonctrl next",hint:this.txtNext,hintAnchor:"top"}),this.btnNext.render(this.$window.find("#id-review-button-next")),this.btnAccept=new Common.UI.Button({cls:"btn-toolbar",caption:this.txtAccept,split:!0,disabled:this.mode.isReviewOnly||this.docProtection.isReviewOnly||!!Common.Utils.InternalSettings.get(this.appPrefix+"accept-reject-lock"),lock:[t.reviewChangelock,t.isReviewOnly,t.previewReviewMode,t.viewFormMode,t.lostConnect,t.docLockView,t.docLockForms,t.docLockComments,t.docLockReview],menu:!this.mode.canUseReviewPermissions&&new Common.UI.Menu({items:[this.mnuAcceptCurrent=new Common.UI.MenuItem({caption:this.txtAcceptCurrent,value:"current"}),this.mnuAcceptAll=new Common.UI.MenuItem({caption:this.txtAcceptAll,value:"all"})]})}),this.btnAccept.render(this.$window.find("#id-review-button-accept")),this.btnReject=new Common.UI.Button({cls:"btn-toolbar",caption:this.txtReject,split:!0,lock:[t.reviewChangelock,t.isReviewOnly,t.previewReviewMode,t.viewFormMode,t.lostConnect,t.docLockView,t.docLockForms,t.docLockComments,t.docLockReview],menu:!this.mode.canUseReviewPermissions&&new Common.UI.Menu({items:[this.mnuRejectCurrent=new Common.UI.MenuItem({caption:this.txtRejectCurrent,value:"current"}),this.mnuRejectAll=new Common.UI.MenuItem({caption:this.txtRejectAll,value:"all"})]})}),this.btnReject.render(this.$window.find("#id-review-button-reject")),[this.btnAccept,this.btnReject]),s=(Common.Utils.lockControls(Common.enumLock.isReviewOnly,this.mode.isReviewOnly,{array:t}),Common.Utils.lockControls(Common.enumLock.docLockView,this.docProtection.isReadOnly,{array:t}),Common.Utils.lockControls(Common.enumLock.docLockForms,this.docProtection.isFormsOnly,{array:t}),Common.Utils.lockControls(Common.enumLock.docLockReview,this.docProtection.isReviewOnly,{array:t}),Common.Utils.lockControls(Common.enumLock.docLockComments,this.docProtection.isCommentsOnly,{array:t}),Common.Utils.lockControls(Common.enumLock.reviewChangelock,!!Common.Utils.InternalSettings.get(this.appPrefix+"accept-reject-lock"),{array:t}),this);return this.btnPrev.on("click",function(t){s.fireEvent("reviewchange:preview",[s.btnPrev,"prev"])}),this.btnNext.on("click",function(t){s.fireEvent("reviewchange:preview",[s.btnNext,"next"])}),this.btnAccept.on("click",function(t){s.fireEvent("reviewchange:accept",[s.btnAccept,"current"])}),this.btnAccept.menu&&this.btnAccept.menu.on("item:click",function(t,e,i){s.fireEvent("reviewchange:accept",[t,e])}),this.btnReject.on("click",function(t){s.fireEvent("reviewchange:reject",[s.btnReject,"current"])}),this.btnReject.menu&&this.btnReject.menu.on("item:click",function(t,e,i){s.fireEvent("reviewchange:reject",[t,e])}),this}},Common.Views.ReviewChangesDialog||{}))}),define("text!common/main/lib/template/CommentsPopover.template",[],function(){return'<% if (!hide) { %>\n<div id="<%=id%>" class="user-comment-item">\n\n    \x3c!-- comment block --\x3e\n\n    <div class="user-name">\n        <div class="color" style="display: inline-block; background-color: <% if (usercolor!==null) { %><%=usercolor%><% } else { %> #cfcfcf <% } %>; " ></div><%= scope.getEncodedName(parsedName) %>\n    </div>\n    <div class="user-date"><%=date%></div>\n    <% if (!editTextInPopover || (hint && !fullInfoInHint) || scope.viewmode) { %>\n        <div oo_editor_input="true" tabindex="-1" class="user-message user-select"><%=scope.pickLink(comment)%></div>\n    <% } else { %>\n        <div class="inner-edit-ct">\n            <textarea class="msg-reply user-select" maxlength="maxCommLength" spellcheck="false" <% if (!!dummy) { %> placeholder="textMentionComment"<% } %>><%=comment%></textarea>\n            <% if (hideAddReply) { %>\n                <button class="btn normal dlg-btn primary btn-inner-edit" id="id-comments-change-popover">textAdd</button>\n            <% } else { %>\n                <button class="btn normal dlg-btn primary btn-inner-edit" id="id-comments-change-popover">textEdit</button>\n            <% } %>\n            <button class="btn normal dlg-btn btn-inner-close">textCancel</button>\n        </div>\n    <% } %>\n\n    \x3c!-- replys elements --\x3e\n\n    <% var add_arrow = true; %>\n    <% if (replys.length) { %>\n        <% _.each(replys, function (item) { %>\n            <% if (!item.get("hide")) { %>\n            <% if (add_arrow) { add_arrow = false; %>\n                <div class="reply-arrow img-commonctrl"></div>\n            <% } %>\n            <div class="reply-item-ct">\n                <div class="user-name">\n                    <div class="color" style="display: inline-block; background-color: <% if (item.get("usercolor")!==null) { %><%=item.get("usercolor")%><% } else { %> #cfcfcf <% } %>; " ></div><%= scope.getEncodedName(item.get("parsedName")) %>\n                </div>\n                <div class="user-date"><%=item.get("date")%></div>\n                <% if (!item.get("editTextInPopover")) { %>\n                    <div oo_editor_input="true" tabindex="-1" class="user-message user-select"><%=scope.pickLink(item.get("reply"))%></div>\n                    <% if ((fullInfoInHint || !hint) && !scope.viewmode) { %>\n                        <div class="btns-reply-ct">\n                            <% if (item.get("editable")) { %>\n                                <div class="btn-edit img-commonctrl" data-value="<%=item.get("id")%>"></div>\n                            <%}%>\n                            <% if (item.get("removable")) { %>\n                               <div class="btn-delete img-commonctrl" data-value="<%=item.get("id")%>"></div>\n                            <%}%>\n                        </div>\n                    <%}%>\n                <% } else { %>\n                    <div class="inner-edit-ct">\n                        <textarea class="msg-reply textarea-fix user-select" maxlength="maxCommLength" spellcheck="false"><%=item.get("reply")%></textarea>\n                        <button class="btn normal dlg-btn primary btn-inner-edit btn-fix" id="id-comments-change-popover">textEdit</button>\n                        <button class="btn normal dlg-btn btn-inner-close">textClose</button>\n                    </div>\n                <% } %>\n            </div>\n            <% } %>\n        <% }); %>\n    <% } %>\n\n    \x3c!-- add reply button --\x3e\n\n    <% if (!showReplyInPopover && !hideAddReply && (fullInfoInHint || !hint) && !scope.viewmode) { %>\n        <% if (replys.length && !add_arrow) { %>\n            <label class="user-reply with-reply" role="presentation" tabindex="-1">textAddReply</label>\n        <% } else { %>\n            <label class="user-reply" role="presentation" tabindex="-1">textAddReply</label>\n        <% } %>\n    <% } %>\n\n    \x3c!-- edit buttons --\x3e\n\n    <% if (!editTextInPopover && !lock) { %>\n        <div class="edit-ct">\n            <% if ((fullInfoInHint || !hint) && !scope.viewmode) { %>\n                <% if (editable) { %>\n                    <div class="btn-edit img-commonctrl"></div>\n                <% } %>\n                <% if (removable) { %>\n                    <div class="btn-delete img-commonctrl"></div>\n                <% } %>\n            <% } %>\n            <% if (editable && (fullInfoInHint || !hint) && !scope.viewmode) { %>\n                <div class="btn-resolve <% if (resolved) print(\'comment-resolved\') %>" data-toggle="tooltip"></div>\n            <% } else if ((fullInfoInHint || !hint) && (!editable || scope.viewmode) && resolved) { %>\n                <div class="icon-resolve i-comment-resolved" data-toggle="tooltip"></div>\n            <% } %>\n        </div>\n    <% } %>\n\n    \x3c!-- reply --\x3e\n\n    <% if (showReplyInPopover) { %>\n        <div class="reply-ct">\n            <textarea class="msg-reply user-select" placeholder="textMentionReply" maxlength="maxCommLength" spellcheck="false"></textarea>\n            <button class="btn normal dlg-btn primary btn-reply" id="id-comments-change-popover">textReply</button>\n            <button class="btn normal dlg-btn btn-close">textClose</button>\n        </div>\n    <% } %>\n\n    \x3c!-- locked user --\x3e\n\n    <% if (lock) { %>\n        <div class="lock-area" style="cursor: default;"></div>\n        <div class="lock-author" style="cursor: default;"><%=lockuserid%></div>\n    <% } %>\n\n</div>\n<% } %>'}),define("text!common/main/lib/template/ReviewChangesPopover.template",[],function(){return'<div id="<%=id%>" class="user-comment-item">\n    <div class="user-name">\n        <div class="color" style="display: inline-block; background-color: <% if (usercolor!==null) { %><%=usercolor%><% } else { %> #cfcfcf <% } %>; " ></div><%= scope.getUserName(username) %>\n    </div>\n    <div class="user-date"><%=date%></div>\n    <div class="user-message limit-height"><%=changetext%></div>\n    <div class="edit-ct">\n        <% if (goto) { %>\n        <div class="btn-goto img-commonctrl"></div>\n        <% } %>\n        <% if (!hint) { %>\n            <% if (scope.appConfig.isReviewOnly || docProtection.isReviewOnly) { %>\n                <% if (editable) { %>\n                <div class="btn-delete img-commonctrl"></div>\n                <% } %>\n            <% } else if (editable) { %>\n            <div class="btn-accept"></div>\n            <div class="btn-reject tool "></div>\n            <% } %>\n        <% } %>\n    </div>\n    <% if (!hint && lock) { %>\n    <div class="lock-area" style="cursor: default;"></div>\n    <div class="lock-author" style="cursor: default;"><%=lockuser%></div>\n    <% } %>\n</div>'}),void 0===Common&&(Common={}),Common.Views=Common.Views||{},define("common/main/lib/view/ReviewPopover",["text!common/main/lib/template/CommentsPopover.template","text!common/main/lib/template/ReviewChangesPopover.template","common/main/lib/util/utils","common/main/lib/component/Button","common/main/lib/component/ComboBox","common/main/lib/component/DataView","common/main/lib/component/Layout","common/main/lib/component/Window"],function(n,a){"use strict";Common.Views.ReviewPopover=Common.UI.Window.extend(_.extend({initialize:function(t){var e={};return _.extend(e,{closable:!1,width:265,height:120,header:!1,modal:!1,automove:!1,alias:"Common.Views.ReviewPopover"},t),this.template=t.template||['<div class="box">','<div id="id-popover" class="comments-popover" style="overflow-y: hidden;position: relative;">','<div id="id-review-popover"></div>','<div id="id-comments-popover"></div>',"</div>",'<div id="id-comments-arrow" class="comments-arrow"></div>',"</div>"].join(""),this.commentsStore=t.commentsStore,this.reviewStore=t.reviewStore,this.canRequestUsers=t.canRequestUsers,this.canRequestSendNotify=t.canRequestSendNotify,this.mentionShare=t.mentionShare,this.api=t.api,this._state={commentsVisible:!1,reviewVisible:!1},e.tpl=_.template(this.template)(e),this.arrow={margin:20,width:10,height:30},this.sdkBounds={width:0,height:0,padding:10,paddingTop:20},Common.UI.Window.prototype.initialize.call(this,e),this.canRequestUsers&&Common.NotificationCenter.on("mentions:setusers",_.bind(this.onEmailListMenuCallback,this)),this},render:function(t,e){Common.UI.Window.prototype.render.call(this);var c,i,p=this,s=this.$window,o=(s.css({height:"",minHeight:"",overflow:"hidden",position:"absolute",zIndex:"990"}),s.find(".body")),o=(o&&o.css("position","relative"),Common.UI.DataView.extend((c=p,{options:{handleSelect:!1,allowScrollbar:!1,template:_.template('<div class="dataview-ct inner" style="overflow-y: visible;"></div>')},getTextBox:function(){var t=$(this.el).find("textarea");return t&&t.length?t:void 0},setFocusToTextBox:function(t){var e=$(this.el).find("textarea");t?e.blur():e&&e.length&&(t=e.val(),e.focus(),e.val(""),e.val(t))},getActiveTextBoxVal:function(){var t=$(this.el).find("textarea");return t&&t.length?t.val().trim():""},disableTextBoxButton:function(t){var e=$(t.siblings("#id-comments-change-popover")[0]);0<t.val().trim().length?(e.removeAttr("disabled"),e.removeClass("disabled")):(e.attr("disabled",!0),e.addClass("disabled"))},autoHeightTextBox:function(){var e=this,t=this.$el.find("textarea"),i=null,s=55,o=0,n=0,a=0,l=0;function r(){n=c.scroller.getScrollTop(),i.scrollHeight>i.clientHeight?i.clientHeight+2<parseInt($(i).css("max-height"))&&(t.css({height:i.scrollHeight+o+"px"}),c.calculateSizeOfContent()):(a=i.clientHeight,s<=a&&(t.css({height:s+"px"}),i.scrollHeight>i.clientHeight&&(l=Math.max(i.scrollHeight+o,s),t.css({height:l+"px"})),c.calculateSizeOfContent(),c.setLeftTop(p.arrowPosX,p.arrowPosY,p.leftX),c.calculateSizeOfContent())),c.scroller.scrollTop(n),c.autoScrollToEditButtons()}t&&t.length&&c.scroller&&(i=t.get(0),e.disableTextBoxButton(t),i&&(o=.25*parseInt(t.css("lineHeight"),10),r(),t.bind("input propertychange",function(t){r(),e.disableTextBoxButton($(t.target))}))),this.textBox=t},clearTextBoxBind:function(){this.textBox&&(this.textBox.unbind("input propertychange"),this.textBox=void 0)}}))),o=(o&&(this.commentsView?(this.commentsView.render($("#id-comments-popover")),this.commentsView.onResetItems()):(this.commentsView=new o({el:$("#id-comments-popover"),itemTemplate:_.template(function(t,e){var i,s,o=t;for(i in e)void 0!==i&&(s=e[i],o=o.replace(new RegExp(i,"g"),s));return o}(n,{textAddReply:p.textAddReply,textMentionReply:p.canRequestSendNotify?p.mentionShare?p.textMention:p.textMentionNotify:p.textAddReply,textAdd:p.textAdd,textCancel:p.textCancel,textEdit:p.textEdit,textReply:p.textReply,textClose:p.textClose,maxCommLength:Asc.c_oAscMaxCellOrCommentLength,textMentionComment:p.canRequestSendNotify?p.mentionShare?p.textMention:p.textMentionNotify:p.textEnterComment}))}),this.commentsView.on("item:add",i=function(t,e,i){e.tipsArray&&e.tipsArray.forEach(function(t){t.remove()});var s=[],o=$(e.el).find(".btn-resolve:not(.comment-resolved)");o.tooltip({title:p.textResolve,placement:"cursor"}),o.each(function(t,e){s.push($(e).data("bs.tooltip").tip())}),(o=$(e.el).find(".comment-resolved")).tooltip({title:p.textOpenAgain,placement:"cursor"}),o.each(function(t,e){s.push($(e).data("bs.tooltip").tip())}),(o=$(e.el).find(".i-comment-resolved")).tooltip({title:p.textViewResolved,placement:"cursor"}),o.each(function(t,e){s.push($(e).data("bs.tooltip").tip())}),(o=$(e.el).find(".btn-edit")).tooltip({title:p.txtEditTip,placement:"cursor"}),o.each(function(t,e){s.push($(e).data("bs.tooltip").tip())}),(o=$(e.el).find(".btn-delete")).tooltip({title:p.txtDeleteTip,placement:"cursor"}),o.each(function(t,e){s.push($(e).data("bs.tooltip").tip())}),e.tipsArray=s,this.autoHeightTextBox()}),this.commentsView.on("item:remove",i),this.commentsView.on("item:change",i),this.commentsView.cmpEl.on("mouseover",function(){p._isMouseOver=!0}).on("mouseout",function(){p._isMouseOver=!1}),this.commentsView.setStore(p.commentsStore),this.commentsView.onResetItems(),this.commentsView.on("item:click",function(t,e,i,s){var o,n,a,l,r,c,d;function h(){p.update()}(s=$(s.target))&&(a=i.get("editTextInPopover"),l=i.get("showReplyInPopover"),r=i.get("hideAddReply"),c=i.get("uid"),d=s.attr("data-value"),i.get("hint")&&(p.fireEvent("comment:disableHint",[i]),!i.get("fullInfoInHint"))||(s.hasClass("btn-edit")?((n=s.data("bs.tooltip"))&&(n.dontShow=!0),_.isUndefined(d)?a||(p.fireEvent("comment:closeEditing"),i.set("editTextInPopover",!0),p.fireEvent("comment:show",[c]),this.autoHeightTextBox(),p.calculateSizeOfContent(),p.setLeftTop(p.arrowPosX,p.arrowPosY,p.leftX),p.calculateSizeOfContent(),h(),p.hookTextBox(),p.autoScrollToEditButtons(),this.setFocusToTextBox()):(p.fireEvent("comment:closeEditing",[c]),p.fireEvent("comment:editReply",[c,d,!0]),this.replyId=d,this.autoHeightTextBox(),p.calculateSizeOfContent(),p.setLeftTop(p.arrowPosX,p.arrowPosY,p.leftX),p.calculateSizeOfContent(),h(),p.hookTextBox(),p.autoScrollToEditButtons(),this.setFocusToTextBox())):s.hasClass("btn-delete")?((n=s.data("bs.tooltip"))&&(n.dontShow=!0),_.isUndefined(d)?p.fireEvent("comment:remove",[c]):(p.fireEvent("comment:removeReply",[c,d]),p.calculateSizeOfContent(),p.setLeftTop(p.arrowPosX,p.arrowPosY,p.leftX),p.calculateSizeOfContent()),p.fireEvent("comment:closeEditing"),h()):s.hasClass("user-reply")?(p.fireEvent("comment:closeEditing"),i.set("showReplyInPopover",!0),p.calculateSizeOfContent(),p.setLeftTop(p.arrowPosX,p.arrowPosY,p.leftX),p.calculateSizeOfContent(),h(),this.autoHeightTextBox(),p.hookTextBox(),p.autoScrollToEditButtons(),this.setFocusToTextBox()):s.hasClass("btn-reply",!1)?l&&(this.clearTextBoxBind(),p.fireEvent("comment:addReply",[c,this.getActiveTextBoxVal()]),p.fireEvent("comment:closeEditing"),p.calculateSizeOfContent(),h()):s.hasClass("btn-close",!1)?(p.fireEvent("comment:closeEditing",[c]),p.calculateSizeOfContent(),p.fireEvent("comment:show",[c]),h()):s.hasClass("btn-inner-edit",!1)?i.get("dummy")?(d=this.getActiveTextBoxVal(),p.clearDummyText(),0<d.length?p.fireEvent("comment:addDummyComment",[d]):(o=p.$window.find("textarea:not(.user-message)"))&&o.length&&setTimeout(function(){o.focus()},10)):(this.clearTextBoxBind(),_.isUndefined(this.replyId)?a&&(p.fireEvent("comment:change",[c,this.getActiveTextBoxVal()]),p.fireEvent("comment:closeEditing"),p.calculateSizeOfContent()):(p.fireEvent("comment:changeReply",[c,this.replyId,this.getActiveTextBoxVal()]),this.replyId=void 0,p.fireEvent("comment:closeEditing")),h()):s.hasClass("btn-inner-close",!1)?i.get("dummy")?(p.clearDummyText(),p.hide()):(r&&0<this.getActiveTextBoxVal().length?(p.saveText(),i.set("hideAddReply",!1),this.getTextBox().val(p.textVal),this.autoHeightTextBox()):(this.clearTextBoxBind(),p.fireEvent("comment:closeEditing",[c])),this.replyId=void 0,p.calculateSizeOfContent(),p.setLeftTop(p.arrowPosX,p.arrowPosY,p.leftX),p.calculateSizeOfContent(),h()):s.hasClass("btn-resolve")&&((n=s.data("bs.tooltip"))&&(n.dontShow=!0),p.fireEvent("comment:resolve",[c]),h())))}),this.emailMenu=new Common.UI.Menu({maxHeight:200,cyclic:!1,cls:"font-size-medium",items:[]}).on("render:after",function(t){this.scroller=new Common.UI.Scroller({el:$(this.el).find(".dropdown-menu "),useKeyboard:this.enableKeyEvents&&!this.handleSelect,minScrollbarLength:40,alwaysVisibleY:!0})}).on("show:after",function(){this.scroller.update({alwaysVisibleY:!0}),p.$window.css({zIndex:"1001"})}).on("hide:after",function(){p.$window.css({zIndex:"990"})}),p.on({show:function(){p.commentsView.autoHeightTextBox(),p.$window.find("textarea").keydown(function(t){t.keyCode==Common.UI.Keys.ESC&&p.hide(!0)})},"animate:before":function(){var t=p.$window.find("textarea");t&&t.length&&(t.focus(),p.commentsView.disableTextBoxButton(t))}}))),Common.UI.DataView.extend({options:{handleSelect:!1,scrollable:!0,template:_.template('<div class="dataview-ct inner" style="overflow-y: visible;"></div>')}}));o&&(this.reviewChangesView?this.reviewChangesView.render($("#id-review-popover")):(this.reviewChangesView=new o({el:$("#id-review-popover"),itemTemplate:_.template(a)}),this.reviewChangesView.on("item:add",i=function(t,e,i){e.tipsArray&&e.tipsArray.forEach(function(t){t.remove()});var s=[],o=$(e.el).find(".btn-goto");o.tooltip({title:p.textFollowMove,placement:"cursor"}),o.each(function(t,e){s.push($(e).data("bs.tooltip").tip())}),(o=$(e.el).find(".btn-accept")).tooltip({title:p.txtAccept,placement:"cursor"}),o.each(function(t,e){s.push($(e).data("bs.tooltip").tip())}),(o=$(e.el).find(".btn-reject")).tooltip({title:p.txtReject,placement:"cursor"}),o.each(function(t,e){s.push($(e).data("bs.tooltip").tip())}),e.tipsArray=s}),this.reviewChangesView.on("item:remove",i),this.reviewChangesView.on("item:change",i),this.reviewChangesView.on("item:click",function(t,e,i,s){var o,s=$(s.target);s&&(s.hasClass("btn-accept")?((o=s.data("bs.tooltip"))&&(o.dontShow=!0),p.fireEvent("reviewchange:accept",[i.get("changedata")])):s.hasClass("btn-reject")?((o=s.data("bs.tooltip"))&&(o.dontShow=!0),p.fireEvent("reviewchange:reject",[i.get("changedata")])):s.hasClass("btn-delete")?p.fireEvent("reviewchange:delete",[i.get("changedata")]):s.hasClass("btn-goto")&&((o=s.data("bs.tooltip"))&&(o.dontShow=!0),p.fireEvent("reviewchange:goto",[i.get("changedata")])))}),this.reviewChangesView.setStore(p.reviewStore)),this.reviewChangesView.onResetItems()),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:s.find("#id-popover"),minScrollbarLength:40,wheelSpeed:10,alwaysVisibleY:!0}))},showComments:function(t,e,i,s){this.options.animate=t;var o=this.commentsView.getTextBox();e&&this.textVal&&o&&o.val(this.textVal),s&&s.length&&o&&o.val(s),this.show(t),this.hookTextBox(),this._state.commentsVisible=!0},showReview:function(t,e,i){this.show(t),this._state.reviewVisible=!0},show:function(t,e,i,s){this.options.animate=t,Common.UI.Window.prototype.show.call(this),this.scroller&&this.scroller.update({minScrollbarLength:40,alwaysVisibleY:!0})},hideComments:function(){this.handlerHide&&this.handlerHide(),this.hideTips(),this._state.commentsVisible=!1,this._state.reviewVisible?this.calculateSizeOfContent():this.hide()},hideReview:function(){this.handlerHide&&this.handlerHide(),this.hideTips(),this._state.reviewVisible=!1,this._state.commentsVisible?this.calculateSizeOfContent():this.hide()},hide:function(){this.handlerHide&&this.handlerHide.apply(this,arguments),this.hideTips(),Common.UI.Window.prototype.hide.call(this),_.isUndefined(this.e)||this.e.keyCode!=Common.UI.Keys.ESC||(this.e.preventDefault(),this.e.stopImmediatePropagation(),this.e=void 0)},update:function(t){this.commentsView&&t&&this.commentsView.onResetItems(),this.scroller&&this.scroller.update({minScrollbarLength:40,alwaysVisibleY:!0})},isVisible:function(){return this.$window&&this.$window.is(":visible")},setLeftTop:function(t,e,i,s,o){var n,a,l,r,c,d,h,p,m,u,g,b,C,f,S,v,w;this.$window||this.render(),s&&(t=this.arrowPosX,e=this.arrowPosY,i=this.leftX),_.isUndefined(t)&&_.isUndefined(e)||(this.arrowPosX=t,this.arrowPosY=e,this.leftX=i,s=$("#id-popover"),n=$("#id-comments-arrow"),a=$("#editor_sdk"),l=null,g=m=h=c="",w=v=S=f=C=b=u=p=d=r=0,s&&n&&a&&a.get(0)&&(l=a.get(0).getBoundingClientRect())&&(r=l.height-2*this.sdkBounds.padding,this.$window.css({maxHeight:r+"px"}),this.sdkBounds.width=l.width,this.sdkBounds.height=l.height,_.isUndefined(t)||(((c=$("#id_vertical_scroll")).length||(c=$("#ws-v-scrollbar")).length)&&(d="none"!==c.css("display")?c.width():0),this.sdkBounds.width-=d,(h=$("#id_panel_left")).length&&(p="none"!==h.css("display")?h.width():0),(m=$("#id_panel_thumbnails")).length&&(u="none"!==m.css("display")?m.width():0,this.sdkBounds.width-=u),C=Common.UI.isRTL()?(C=Math.max(0+p+25,0+this.sdkBounds.width-this.$window.outerWidth()-t+7),Math.min(0+this.sdkBounds.width-this.$window.outerWidth()-25,C)):(C=Math.min(0+t+this.arrow.width,0+this.sdkBounds.width-this.$window.outerWidth()-25),Math.max(0+p+this.arrow.width,C)),n.removeClass("right top bottom").addClass("left"),n.css({left:""}),_.isUndefined(i)||(f=this.$window.outerWidth())&&(t+f>this.sdkBounds.width-this.arrow.width+5&&this.leftX>f||Common.UI.isRTL()&&0+this.leftX>f+this.arrow.width?(C=0+this.leftX-f-this.arrow.width,n.removeClass("left").addClass("right")):C=0+t+this.arrow.width),this.$window.css("left",C+"px")),_.isUndefined(e)||(w=0,(g=$("#id_panel_top")).length?(b="none"!==g.css("display")?g.height():0,w+=this.sdkBounds.paddingTop):(g=$("#ws-h-scrollbar")).length&&(b="none"!==g.css("display")?g.height():0),this.sdkBounds.height-=b,S=this.$window.outerHeight(),v=Math.min(0+r-S,this.arrowPosY+0-this.arrow.height),v=Math.max(v,w),parseInt(n.css("top"))+this.arrow.height>S&&n.css({top:S-this.arrow.height+"px"}),this.$window.css("top",v+"px"))),o&&!this.isOverCursor()||this.calculateSizeOfContent())},calculateSizeOfContent:function(t){var e,i,s,o,n,a,l,r,c,d,h,p,m,u,g,b,C,f;t&&!this.$window.is(":visible")||(this.$window.css({overflow:"hidden"}),t=$("#id-comments-arrow"),C=f=i=null,p="",c=r=h=l=a=n=o=s=0,(e=$("#id-popover"))&&t&&e.get(0)&&(d=this.scroller.getScrollTop(),e.css({height:"100%"}),(i=e.get(0).getBoundingClientRect())&&(f=$("#editor_sdk"))&&f.get(0)&&(C=f.get(0).getBoundingClientRect())&&(s=C.height-2*this.sdkBounds.padding,c=0,l=this.$window.outerHeight(),(p=$("#id_panel_top")).length?(o="none"!==p.css("display")?p.height():0,c+=this.sdkBounds.paddingTop):(p=$("#ws-h-scrollbar")).length&&(o="none"!==p.css("display")?p.height():0),h=Math.max(e.outerHeight(),this.$window.outerHeight()),(f=this.isOverCursor())?(C=parseInt(this.$window.css("left"))-this.arrow.width,p=f[1][1]+o+this.arrow.width,m=f[0][1]+o-this.arrow.width,u=!1,0+s<p+h?(g=0+s-p,m-h<0?g<.9*(b=m)?(this.$window.css({maxHeight:b+"px",top:"0px"}),e.css({height:b-3+"px"})):(this.$window.css({maxHeight:g+"px",top:p+"px"}),u=!0,e.css({height:g-3+"px"})):this.$window.css("top",m-h+"px")):(u=!0,this.$window.css("top",p+"px")),C-=this.arrow.height,this.$window.css("left",C+"px"),a=f[u?1:0][0],a=Math.max(0,a-C-this.arrow.height/2),a=Math.min(a,this.$window.outerWidth()-this.arrow.height),t.css({top:"",left:a+"px"}),t.toggleClass("top",u),t.toggleClass("bottom",!u),t.removeClass("left right")):s<=h?(this.$window.css({maxHeight:s-o+"px",top:0+o+"px"}),e.css({height:s-o-3+"px"}),n=Math.min(n,s-(o+this.arrow.margin+this.arrow.height)),t.css({top:n+"px",left:""}),t.removeClass("top bottom right"),t.addClass("left"),this.scroller.scrollTop(d)):(0<(h=l)&&(i.top+h>0+s||0===i.height)&&(r=Math.min(0+s-h,this.arrowPosY+0-this.arrow.height),r=Math.max(r,c),this.$window.css({top:r+"px"})),n=Math.max(this.arrow.margin,this.arrowPosY-(s-h)-this.arrow.height),n=Math.min(n,h-this.arrow.margin-this.arrow.height),t.css({top:n+"px",left:""}),t.removeClass("top bottom right"),t.addClass("left")))),this.$window.css({overflow:""}),this.scroller&&this.scroller.update({minScrollbarLength:40,alwaysVisibleY:!0}))},isOverCursor:function(){var t,e,i,s,o,n,a,l;if(this.api.asc_GetSelectionBounds)return s=this.api.asc_GetSelectionBounds(),o=Math.abs(s[0][0]-s[1][0])<.1&&Math.abs(s[0][1]-s[1][1])<.1&&Math.abs(s[2][0]-s[3][0])<.1&&Math.abs(s[2][1]-s[3][1])<.1,i=0,(t=$("#id_panel_left")).length&&(i="none"!==t.css("display")?t.width():0),t=s[0][0]+i,e=s[0][1],i=s[o?2:1][0]+i,s=s[o?2:1][1],o=parseInt(this.$window.css("left"))-this.arrow.width,n=this.$window.outerWidth()+this.arrow.width,a=parseInt(this.$window.css("top")),l=this.$window.outerHeight(),o<t&&t<o+n&&a<e&&e<a+l||o<i&&i<o+n&&a<s&&s<a+l?[e<s?[t,e]:[i,s],s<e?[t,e]:[i,s]]:void 0},saveText:function(t){this.commentsView&&this.commentsView.cmpEl.find(".lock-area").length<1&&(this.textVal=void 0,t?this.commentsView.clearTextBoxBind():this.textVal=this.commentsView.getActiveTextBoxVal())},loadText:function(){var t;this.textVal&&this.commentsView&&((t=this.commentsView.getTextBox())&&t.val(this.textVal))},getEditText:function(){if(this.commentsView)return this.commentsView.getActiveTextBoxVal()},saveDummyText:function(){this.commentsView&&this.commentsView.cmpEl.find(".lock-area").length<1&&(this.textDummyVal=this.commentsView.getActiveTextBoxVal())},clearDummyText:function(){var t;this.commentsView&&this.commentsView.cmpEl.find(".lock-area").length<1&&(this.textDummyVal=void 0,(t=this.commentsView.getTextBox())&&t.val(""),this.commentsView.clearTextBoxBind())},getDummyText:function(){return this.textDummyVal||""},hookTextBox:function(){var l=this,t=this.commentsView.getTextBox();t&&t.keydown(function(t){var e,i,s;!t.ctrlKey&&!t.metaKey||t.altKey||t.keyCode!==Common.UI.Keys.RETURN?t.keyCode===Common.UI.Keys.TAB&&(e=this.selectionStart,i=this.selectionEnd,(s=$(this)).val(s.val().substring(0,e)+"\t"+s.val().substring(i)),this.selectionStart=this.selectionEnd=e+1,t.preventDefault()):((s=$("#id-comments-change-popover"))&&s.length&&s.click(),t.stopImmediatePropagation()),l.e=t}),this.canRequestUsers&&(t&&t.keydown(function(t){t.keyCode==Common.UI.Keys.SPACE||t.keyCode===Common.UI.Keys.TAB||t.keyCode==Common.UI.Keys.HOME||t.keyCode==Common.UI.Keys.END||t.keyCode==Common.UI.Keys.RIGHT||t.keyCode==Common.UI.Keys.LEFT||t.keyCode==Common.UI.Keys.UP?l.onEmailListMenu():t.keyCode==Common.UI.Keys.DOWN&&l.emailMenu&&l.emailMenu.rendered&&l.emailMenu.isVisible()&&(_.delay(function(){l.emailMenu.cmpEl.find("li:not(.divider):first").find("a").focus()},10),t.preventDefault()),l.e=t}),t&&t.on("input",function(t){for(var e=$(this),i=this.selectionStart,s=e.val(),o=0,n=s.length-1,a=i-1;0<=a;a--)if(32==s.charCodeAt(a)||13==s.charCodeAt(a)||10==s.charCodeAt(a)||9==s.charCodeAt(a)){o=a+1;break}for(a=i;a<=n;a++)if(32==s.charCodeAt(a)||13==s.charCodeAt(a)||10==s.charCodeAt(a)||9==s.charCodeAt(a)){n=a-1;break}e=s.substring(o,n+1),i=e.match(/^(?:[@]|[+](?!1))(\S*)/);i&&1<i.length?(e=i[1],l.onEmailListMenu(e,o,n)):l.onEmailListMenu()}))},hideTips:function(){this.commentsView&&_.each(this.commentsView.dataViewItems,function(t){t.tipsArray&&t.tipsArray.forEach(function(t){t.hide()})},this),this.reviewChangesView&&_.each(this.reviewChangesView.dataViewItems,function(t){t.tipsArray&&t.tipsArray.forEach(function(t){t.hide()})},this),this.emailMenu&&this.emailMenu.rendered&&this.emailMenu.cmpEl.css("display","none")},isCommentsViewMouseOver:function(){return this._isMouseOver},setReviewStore:function(t){this.reviewStore=t,this.reviewChangesView&&this.reviewChangesView.setStore(this.reviewStore)},setCommentsStore:function(t){this.commentsStore=t,this.commentsView&&this.commentsView.setStore(this.commentsStore)},getPopover:function(t){return this.popover||(this.popover=new Common.Views.ReviewPopover(t)),this.popover},autoScrollToEditButtons:function(){var t=$("#id-comments-change-popover"),e=this.$window[0].getBoundingClientRect();t.length&&(t=t.get(0).getBoundingClientRect())&&e&&(e=e.bottom-(t.bottom+7))<0&&this.scroller.scrollTop(this.scroller.getScrollTop()-e)},onEmailListMenu:function(t,e,i){"string"==typeof t?(this._state.emailSearch={str:t,left:e,right:i},Common.UI.ExternalUsers.get("mention")):(this._state.emailSearch=null,this.emailMenu.rendered&&this.emailMenu.cmpEl.css("display","none"))},onEmailListMenuCallback:function(t,e){if(!(!this._state.emailSearch||e.length<1||t&&"mention"!==t)){var s=this,o=s.emailMenu,i=this._state.emailSearch.str,n=this._state.emailSearch.left,a=this._state.emailSearch.right,t=(this._state.emailSearch=null,s.$window.find(Common.Utils.String.format("#menu-container-{0}",o.id))),l=this.commentsView.getTextBox(),r=l?l[0]:null,c=r?[r.offsetLeft,r.offsetTop+r.clientHeight+3]:[0,0];o.rendered||(t.length<1&&(t=$(Common.Utils.String.format('<div id="menu-container-{0}" style="position: absolute; z-index: 10000;"><div class="dropdown-toggle" data-toggle="dropdown"></div></div>',o.id)),s.$window.append(t)),o.render(t),o.cmpEl.css("min-width",r?r.clientWidth:220),o.cmpEl.attr({tabindex:"-1"}),o.on("hide:after",function(){setTimeout(function(){var t=s.commentsView.getTextBox();t&&t.focus()},10)}));for(var d,h,p=0;p<o.items.length;p++)o.removeItem(o.items[p]),p--;0<e.length&&(0<(i=i.toLowerCase()).length&&(e=_.filter(e,function(t){return t.email&&0===t.email.toLowerCase().indexOf(i)||t.name&&0===t.name.toLowerCase().indexOf(i)})),d=_.template('<a id="<%= id %>" tabindex="-1" type="menuitem"><div style="overflow: hidden; text-overflow: ellipsis; max-width: 195px;"><%= Common.Utils.String.htmlEncode(caption) %></div><div style="overflow: hidden; text-overflow: ellipsis; max-width: 195px; color: #909090;"><%= Common.Utils.String.htmlEncode(options.value) %></div></a>'),h=!1,_.each(e,function(t,e){var i;h&&!t.hasAccess&&(h=!1,o.addItem(new Common.UI.MenuItem({caption:"--"}))),t.email&&t.name&&(i=new Common.UI.MenuItem({caption:t.name,value:t.email,template:d}).on("click",function(t,e){s.insertEmailToTextbox(t.options.value,n,a)}),o.addItem(i),t.hasAccess&&(h=!0))})),0<o.items.length?(t.css({left:c[0],top:c[1]}),o.menuAlignEl=l,o.show(),o.cmpEl.css("display",""),o.alignPosition("bl-tl",-5),o.scroller.update({alwaysVisibleY:!0})):o.rendered&&o.cmpEl.css("display","none")}},insertEmailToTextbox:function(t,e,i){var s,o=this.commentsView.getTextBox();o&&(s=o.val(),o.val(s.substring(0,e)+"+"+t+" "+s.substring(i+1,s.length)),setTimeout(function(){o[0].selectionStart=o[0].selectionEnd=e+t.length+2},10))}},Common.Views.ReviewPopover||{}))}),void 0===Common&&(Common={}),define("common/main/lib/view/LanguageDialog",["common/main/lib/component/Window"],function(){"use strict";Common.Views.LanguageDialog=Common.UI.Window.extend(_.extend({options:{header:!1,width:350,cls:"modal-dlg",buttons:["ok","cancel"]},template:'<div class="box"><div class="input-row"><label><%= label %></label></div><div class="input-row" id="id-document-language"></div></div>',initialize:function(t){_.extend(this.options,t||{},{label:this.labelSelect}),this.options.tpl=_.template(this.template)(this.options),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this.getChild(),t=(t.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.cmbLanguage=new Common.UI.ComboBox({el:t.find("#id-document-language"),cls:"input-group-nr",menuStyle:"min-width: 318px; max-height: 285px;",editable:!1,template:_.template(['<span class="input-group combobox <%= cls %> combo-langs" id="<%= id %>" style="<%= style %>">','<input type="text" class="form-control">','<span class="icon input-icon spellcheck-lang toolbar__icon btn-ic-docspell"></span>','<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">','<span class="caret" />',"</button>",'<ul class="dropdown-menu <%= menuCls %>" style="<%= menuStyle %>" role="menu">',"<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%= item.value %>">','<a tabindex="-1" type="menuitem" langval="<%= item.value %>">','<i class="icon <% if (item.spellcheck) { %> toolbar__icon btn-ic-docspell spellcheck-lang <% } %>"></i>',"<%= scope.getDisplayValue(item) %>","</a>","</li>","<% }); %>","</ul>","</span>"].join("")),data:this.options.languages,takeFocusOnClose:!0,search:!0,scrollAlwaysVisible:!0}),this.cmbLanguage.scroller&&this.cmbLanguage.scroller.update({alwaysVisibleY:!0}),this.cmbLanguage.on("selected",_.bind(this.onLangSelect,this)),Common.util.LanguageInfo.getLocalLanguageName(this.options.current)),e=(this.cmbLanguage.setValue(t[0],t[1]),this.onLangSelect(this.cmbLanguage,this.cmbLanguage.getSelectedRecord()),this);setTimeout(function(){e.cmbLanguage.focus()},100)},close:function(t){this.getChild().find(".combobox.open").length||Common.UI.Window.prototype.close.call(this,arguments)},onBtnClick:function(t){this.options.handler&&this.options.handler.call(this,t.currentTarget.attributes.result.value,this.cmbLanguage.getValue()),this.close()},onLangSelect:function(t,e,i){t.$el.find(".input-icon").toggleClass("spellcheck-lang",e&&e.spellcheck),t._input.css(Common.UI.isRTL()?"padding-right":"padding-left",e&&e.spellcheck?25:3)},onPrimary:function(){return this.options.handler&&this.options.handler.call(this,"ok",this.cmbLanguage.getValue()),this.close(),!1}},Common.Views.LanguageDialog||{}))}),void 0===Common&&(Common={}),Common.Controllers=Common.Controllers||{},define("common/main/lib/controller/ReviewChanges",["core","common/main/lib/model/ReviewChange","common/main/lib/collection/ReviewChanges","common/main/lib/view/ReviewChanges","common/main/lib/view/ReviewPopover","common/main/lib/view/LanguageDialog","common/main/lib/view/OptionsDialog"],function(){"use strict";Common.Controllers.ReviewChanges=Backbone.Controller.extend(_.extend({models:[],collections:["Common.Collections.ReviewChanges"],views:["Common.Views.ReviewChanges","Common.Views.ReviewPopover"],sdkViewName:"#id_main",initialize:function(){this.addListeners({FileMenu:{"settings:apply":this.applySettings.bind(this)},LeftMenu:{"comments:show":_.bind(this.commentsShowHide,this,"show"),"comments:hide":_.bind(this.commentsShowHide,this,"hide")},"Common.Views.ReviewChanges":{"reviewchange:accept":_.bind(this.onAcceptClick,this),"reviewchange:reject":_.bind(this.onRejectClick,this),"reviewchange:delete":_.bind(this.onDeleteClick,this),"reviewchange:preview":_.bind(this.onBtnPreviewClick,this),"reviewchange:view":_.bind(this.onReviewViewClick,this),"reviewchange:compare":_.bind(this.onCompareClick,this),"reviewchange:combine":_.bind(this.onCombineClick,this),"lang:document":_.bind(this.onDocLanguage,this),"collaboration:coauthmode":_.bind(this.onCoAuthMode,this),"protect:update":_.bind(this.onChangeProtectDocument,this)},"Common.Views.ReviewChangesDialog":{"reviewchange:accept":_.bind(this.onAcceptClick,this),"reviewchange:reject":_.bind(this.onRejectClick,this),"reviewchange:preview":_.bind(this.onBtnPreviewClick,this)},"Common.Views.ReviewPopover":{"reviewchange:accept":_.bind(this.onAcceptClick,this),"reviewchange:reject":_.bind(this.onRejectClick,this),"reviewchange:delete":_.bind(this.onDeleteClick,this),"reviewchange:goto":_.bind(this.onGotoClick,this)}})},onLaunch:function(){this.collection=this.getApplication().getCollection("Common.Collections.ReviewChanges"),this.userCollection=this.getApplication().getCollection("Common.Collections.Users"),this.viewmode=!1;var t=Common.localStorage.getKeysFilter();this.appPrefix=t&&t.length?t.split(",")[0]:"",this._state={posx:-1e3,posy:-1e3,popoverVisible:!1,previewMode:!1,compareSettings:null,wsLock:!1,wsProps:[],disableEditing:!1,docProtection:{isReadOnly:!1,isReviewOnly:!1,isFormsOnly:!1,isCommentsOnly:!1}},Common.NotificationCenter.on("reviewchanges:turn",this.onTurnPreview.bind(this)),Common.NotificationCenter.on("spelling:turn",this.onTurnSpelling.bind(this)),Common.NotificationCenter.on("app:ready",this.onAppReady.bind(this)),Common.NotificationCenter.on("api:disconnect",_.bind(this.onCoAuthoringDisconnect,this)),Common.NotificationCenter.on("collaboration:sharing",this.changeAccessRights.bind(this)),Common.NotificationCenter.on("collaboration:sharingdeny",this.onLostEditRights.bind(this)),Common.NotificationCenter.on("protect:wslock",_.bind(this.onChangeProtectSheet,this)),this.userCollection.on("reset",_.bind(this.onUpdateUsers,this)),this.userCollection.on("add",_.bind(this.onUpdateUsers,this))},setConfig:function(t,e){return this.setApi(e),t&&(this.currentUserId=t.config.user.id,this.sdkViewName=t.sdkviewname||this.sdkViewName),this},setApi:function(t){t&&(this.api=t,(this.appConfig.canReview||this.appConfig.canViewReview)&&(this.api.asc_registerCallback("asc_onShowRevisionsChange",_.bind(this.onApiShowChange,this)),this.api.asc_registerCallback("asc_onUpdateRevisionsChangesPosition",_.bind(this.onApiUpdateChangePosition,this)),this.api.asc_registerCallback("asc_onAuthParticipantsChanged",_.bind(this.onAuthParticipantsChanged,this)),this.api.asc_registerCallback("asc_onParticipantsChanged",_.bind(this.onAuthParticipantsChanged,this)),this.api.asc_registerCallback("asc_onChangeDisplayModeInReview",_.bind(this.onChangeDisplayModeInReview,this))),this.appConfig.canReview&&this.api.asc_registerCallback("asc_onOnTrackRevisionsChange",_.bind(this.onApiTrackRevisionsChange,this)),this.api.asc_registerCallback("asc_onAcceptChangesBeforeCompare",_.bind(this.onAcceptChangesBeforeCompare,this)),this.api.asc_registerCallback("asc_onCoAuthoringDisconnect",_.bind(this.onCoAuthoringDisconnect,this)),Common.Gateway.on("setrevisedfile",_.bind(this.setRevisedFile,this)),this.appConfig.canFeatureComparison&&(Common.NotificationCenter.on("storage:document-load",_.bind(this.openDocumentFromStorage,this)),Common.NotificationCenter.on("storage:document-insert",_.bind(this.insertDocumentFromStorage,this)),Common.Gateway.on("setrequesteddocument",_.bind(this.setRequestedDocument,this))))},setMode:function(t){return this.appConfig=t,this.popoverChanges=new Common.Collections.ReviewChanges,this.view=this.createView("Common.Views.ReviewChanges",{mode:t}),(this.appConfig.sharingSettingsUrl&&this.appConfig.sharingSettingsUrl.length||this.appConfig.canRequestSharingSettings)&&(Common.Gateway.on("showsharingsettings",_.bind(this.changeAccessRights,this)),Common.Gateway.on("setsharingsettings",_.bind(this.setSharingSettings,this))),this},loadDocument:function(t){this.document=t.doc},SetDisabled:function(t,e,i){this.dlgChanges&&this.dlgChanges.close(),e?(this.lockToolbar(Common.enumLock.previewReviewMode,t),this.dlgChanges&&Common.Utils.lockControls(Common.enumLock.previewReviewMode,t,{array:[this.dlgChanges.btnAccept,this.dlgChanges.btnReject]})):i?(this.lockToolbar(Common.enumLock.viewFormMode,t),this.dlgChanges&&Common.Utils.lockControls(Common.enumLock.viewFormMode,t,{array:[this.dlgChanges.btnAccept,this.dlgChanges.btnReject]})):this.lockToolbar(Common.enumLock.viewMode,t),this.setPreviewMode(t)},lockToolbar:function(t,e,i){this.view&&Common.Utils.lockControls(t,e,i,this.view.getButtons())},setPreviewMode:function(t){this._state.disableEditing=t,this.updatePreviewMode()},updatePreviewMode:function(){var e,t=this._state.disableEditing||this._state.docProtection.isReadOnly||this._state.docProtection.isFormsOnly||this._state.docProtection.isCommentsOnly;this.viewmode!==t&&((this.viewmode=t)&&(this.prevcanReview=this.appConfig.canReview),this.appConfig.canReview=!t&&this.prevcanReview,(e=this).popoverChanges&&this.popoverChanges.each(function(t){t.set("hint",!e.appConfig.canReview)}))},isSelectedChangesLocked:function(t,e){if(!t||t.length<1)return!0;if(e)return t[0].get("lock")||!t[0].get("editable");for(var i=0;i<t.length;i++){var s=t[i];if(s.get("lock")||!s.get("editable"))return!0}return!1},onApiShowChange:function(t,e){var i,s,o,n,a=!0;!this.appConfig.canReview||this.appConfig.isReviewOnly||this._state.docProtection.isReviewOnly||(t&&0<t.length&&(i=this.readSDKChange(t),a=this.isSelectedChangesLocked(i,e)),this._state.lock!==a&&(Common.Utils.lockControls(Common.enumLock.reviewChangelock,a,{array:[this.view.btnAccept,this.view.btnReject]}),this.dlgChanges&&Common.Utils.lockControls(Common.enumLock.reviewChangelock,a,{array:[this.dlgChanges.btnAccept,this.dlgChanges.btnReject]}),this._state.lock=a,Common.Utils.InternalSettings.set(this.appPrefix+"accept-reject-lock",a))),this.getPopover()&&(!this.appConfig.reviewHoverMode&&t&&0<t.length&&e?(a=t[0].get_X(),e=t[0].get_Y(),s=.001<Math.abs(this._state.posx-a)||.001<Math.abs(this._state.posy-e)||t.length!==this._state.changes_length,o=null!==t[0].get_LockUserId(),n=this.getUserName(t[0].get_LockUserId()),this.getPopover().hideTips(),this.popoverChanges.reset(i||this.readSDKChange(t)),s&&(this.getPopover().isVisible()&&this.getPopover().hide(),this.getPopover().setLeftTop(a,e)),this.getPopover().showReview(s,o,n),this._state.posx=a,this._state.posy=e,this._state.changes_length=t.length,this._state.popoverVisible=!0):this._state.popoverVisible&&(this._state.posx=this._state.posy=-1e3,this._state.changes_length=0,this._state.popoverVisible=!1,this.getPopover().hideTips(),this.popoverChanges.reset(),this.getPopover().hideReview()))},onApiUpdateChangePosition:function(t,e){this.getPopover()&&(e<0||this.getPopover().sdkBounds.height<e?this.getPopover().hide():0<this.popoverChanges.length&&(this.getPopover().isVisible()||this.getPopover().show(!1),this.getPopover().setLeftTop(t,e)))},findChange:function(t,e){return _.isUndefined(t)?this.collection.findWhere({id:e}):this.collection.findWhere({uid:t})},getPopover:function(){return(this.appConfig.canReview||this.appConfig.canViewReview)&&_.isUndefined(this.popover)&&(this.popover=Common.Views.ReviewPopover.prototype.getPopover({reviewStore:this.popoverChanges,renderTo:this.sdkViewName,canRequestUsers:this.appConfig?this.appConfig.canRequestUsers:void 0,canRequestSendNotify:this.appConfig?this.appConfig.canRequestSendNotify:void 0,mentionShare:!this.appConfig||this.appConfig.mentionShare,api:this.api}),this.popover.setReviewStore(this.popoverChanges)),this.popover},readSDKChange:function(t){var c=this,d=[];return _.each(t,function(t){var e,i="",s="",o=t.get_Value(),n=t.get_MoveType();switch(t.get_Type()){case Asc.c_oAscRevisionsChangeType.TextAdd:i=n==Asc.c_oAscRevisionsMove.NoMove?c.textInserted:c.textParaMoveTo,"object"==typeof o?_.each(o,function(t){if("string"==typeof t)i+=" "+Common.Utils.String.htmlEncode(t);else switch(t){case 0:i+=" &lt;"+c.textImage+"&gt;";break;case 1:i+=" &lt;"+c.textShape+"&gt;";break;case 2:i+=" &lt;"+c.textChart+"&gt;";break;case 3:i+=" &lt;"+c.textEquation+"&gt;"}}):"string"==typeof o&&(i+=" "+Common.Utils.String.htmlEncode(o));break;case Asc.c_oAscRevisionsChangeType.TextRem:i=n==Asc.c_oAscRevisionsMove.NoMove?c.textDeleted:t.is_MovedDown()?c.textParaMoveFromDown:c.textParaMoveFromUp,"object"==typeof o?_.each(o,function(t){if("string"==typeof t)i+=" "+Common.Utils.String.htmlEncode(t);else switch(t){case 0:i+=" &lt;"+c.textImage+"&gt;";break;case 1:i+=" &lt;"+c.textShape+"&gt;";break;case 2:i+=" &lt;"+c.textChart+"&gt;";break;case 3:i+=" &lt;"+c.textEquation+"&gt;"}}):"string"==typeof o&&(i+=" "+Common.Utils.String.htmlEncode(o));break;case Asc.c_oAscRevisionsChangeType.ParaAdd:i=c.textParaInserted;break;case Asc.c_oAscRevisionsChangeType.ParaRem:i=c.textParaDeleted;break;case Asc.c_oAscRevisionsChangeType.TextPr:i="<b>"+c.textFormatted,void 0!==o.Get_Bold()&&(s+=(o.Get_Bold()?"":c.textNot)+c.textBold+", "),void 0!==o.Get_Italic()&&(s+=(o.Get_Italic()?"":c.textNot)+c.textItalic+", "),void 0!==o.Get_Underline()&&(s+=(o.Get_Underline()?"":c.textNot)+c.textUnderline+", "),void 0!==o.Get_Strikeout()&&(s+=(o.Get_Strikeout()?"":c.textNot)+c.textStrikeout+", "),void 0!==o.Get_DStrikeout()&&(s+=(o.Get_DStrikeout()?"":c.textNot)+c.textDStrikeout+", "),void 0!==o.Get_Caps()&&(s+=(o.Get_Caps()?"":c.textNot)+c.textCaps+", "),void 0!==o.Get_SmallCaps()&&(s+=(o.Get_SmallCaps()?"":c.textNot)+c.textSmallCaps+", "),void 0!==o.Get_VertAlign()&&(s+=(o.Get_VertAlign()===Asc.vertalign_SuperScript?c.textSuperScript:o.Get_VertAlign()===Asc.vertalign_SubScript?c.textSubScript:c.textBaseline)+", "),void 0!==o.Get_Color()&&(s+=c.textColor+", "),void 0!==o.Get_Highlight()&&(s+=c.textHighlight+", "),void 0!==o.Get_Shd()&&(s+=c.textShd+", "),void 0!==o.Get_FontFamily()&&(s+=o.Get_FontFamily()+", "),void 0!==o.Get_FontSize()&&(s+=o.Get_FontSize()+", "),void 0!==o.Get_Spacing()&&(s+=c.textSpacing+" "+Common.Utils.Metric.fnRecalcFromMM(o.Get_Spacing()).toFixed(2)+" "+Common.Utils.Metric.getCurrentMetricName()+", "),void 0!==o.Get_Position()&&(s+=c.textPosition+" "+Common.Utils.Metric.fnRecalcFromMM(o.Get_Position()).toFixed(2)+" "+Common.Utils.Metric.getCurrentMetricName()+", "),void 0!==o.Get_Lang()&&(s+=Common.util.LanguageInfo.getLocalLanguageName(o.Get_Lang())[1]+", "),_.isEmpty(s)||(i+=": ",s=s.substring(0,s.length-2)),i=i+"</b>"+s;break;case Asc.c_oAscRevisionsChangeType.ParaPr:if(i="<b>"+c.textParaFormatted,o.Get_ContextualSpacing()&&(s+=(o.Get_ContextualSpacing()?c.textContextual:c.textNoContextual)+", "),void 0!==o.Get_IndLeft()&&(s+=c.textIndentLeft+" "+Common.Utils.Metric.fnRecalcFromMM(o.Get_IndLeft()).toFixed(2)+" "+Common.Utils.Metric.getCurrentMetricName()+", "),void 0!==o.Get_IndRight()&&(s+=c.textIndentRight+" "+Common.Utils.Metric.fnRecalcFromMM(o.Get_IndRight()).toFixed(2)+" "+Common.Utils.Metric.getCurrentMetricName()+", "),void 0!==o.Get_IndFirstLine()&&(s+=c.textFirstLine+" "+Common.Utils.Metric.fnRecalcFromMM(o.Get_IndFirstLine()).toFixed(2)+" "+Common.Utils.Metric.getCurrentMetricName()+", "),void 0!==o.Get_Jc())switch(o.Get_Jc()){case 0:s+=c.textRight+", ";break;case 1:s+=c.textLeft+", ";break;case 2:s+=c.textCenter+", ";break;case 3:s+=c.textJustify+", "}void 0!==o.Get_KeepLines()&&(s+=(o.Get_KeepLines()?c.textKeepLines:c.textNoKeepLines)+", "),o.Get_KeepNext()&&(s+=(o.Get_KeepNext()?c.textKeepNext:c.textNoKeepNext)+", "),o.Get_PageBreakBefore()&&(s+=(o.Get_PageBreakBefore()?c.textBreakBefore:c.textNoBreakBefore)+", "),void 0!==o.Get_SpacingLineRule()&&void 0!==o.Get_SpacingLine()&&(s=(s=(s+=c.textLineSpacing)+((o.Get_SpacingLineRule()==c_paragraphLinerule.LINERULE_LEAST?c.textAtLeast:o.Get_SpacingLineRule()==c_paragraphLinerule.LINERULE_AUTO?c.textMultiple:c.textExact)+" "))+(o.Get_SpacingLineRule()==c_paragraphLinerule.LINERULE_AUTO?o.Get_SpacingLine():Common.Utils.Metric.fnRecalcFromMM(o.Get_SpacingLine()).toFixed(2)+" "+Common.Utils.Metric.getCurrentMetricName())+", "),o.Get_SpacingBeforeAutoSpacing()?s+=c.textSpacingBefore+" "+c.textAuto+", ":void 0!==o.Get_SpacingBefore()&&(s+=c.textSpacingBefore+" "+Common.Utils.Metric.fnRecalcFromMM(o.Get_SpacingBefore()).toFixed(2)+" "+Common.Utils.Metric.getCurrentMetricName()+", "),o.Get_SpacingAfterAutoSpacing()?s+=c.textSpacingAfter+" "+c.textAuto+", ":void 0!==o.Get_SpacingAfter()&&(s+=c.textSpacingAfter+" "+Common.Utils.Metric.fnRecalcFromMM(o.Get_SpacingAfter()).toFixed(2)+" "+Common.Utils.Metric.getCurrentMetricName()+", "),o.Get_WidowControl()&&(s+=(o.Get_WidowControl()?c.textWidow:c.textNoWidow)+", "),void 0!==o.Get_Tabs()&&(s+=c.textTabs+", "),void 0!==o.Get_NumPr()&&(s+=c.textNum+", "),void 0!==o.Get_PStyle()&&(e=c.api.asc_GetStyleNameById(o.Get_PStyle()),_.isEmpty(e)||(s+=e+", ")),_.isEmpty(s)||(i+=": ",s=s.substring(0,s.length-2)),i=i+"</b>"+s;break;case Asc.c_oAscRevisionsChangeType.TablePr:i=c.textTableChanged;break;case Asc.c_oAscRevisionsChangeType.RowsAdd:i=c.textTableRowsAdd;break;case Asc.c_oAscRevisionsChangeType.RowsRem:i=c.textTableRowsDel}var a=""==t.get_DateTime()?new Date:new Date(t.get_DateTime()),l=c.userCollection.findOriginalUser(t.get_UserId()),r=c._state.docProtection.isReviewOnly,l=new Common.Models.ReviewChange({uid:Common.UI.getId(),userid:t.get_UserId(),username:t.get_UserName(),usercolor:l?l.get("color"):null,date:c.dateToLocaleTimeString(a),changetext:i,id:Common.UI.getId(),lock:null!==t.get_LockUserId(),lockuser:c.getUserName(t.get_LockUserId()),type:t.get_Type(),changedata:t,scope:c.view,hint:!c.appConfig.canReview,docProtection:c._state.docProtection,goto:t.get_MoveType()==Asc.c_oAscRevisionsMove.MoveTo||t.get_MoveType()==Asc.c_oAscRevisionsMove.MoveFrom,editable:(c.appConfig.isReviewOnly||r)&&t.get_UserId()==c.currentUserId||!(c.appConfig.isReviewOnly||r)&&(!c.appConfig.canUseReviewPermissions||AscCommon.UserInfoParser.canEditReview(t.get_UserName()))});d.push(l)}),d},getUserName:function(t){if(this.userCollection&&null!==t){t=this.userCollection.findUser(t);if(t)return AscCommon.UserInfoParser.getParsedName(t.get("username"))}return""},dateToLocaleTimeString:function(e){var t,i=(this.appConfig&&this.appConfig.lang||"en").replace("_","-").toLowerCase();try{return e.toLocaleString(i,{dateStyle:"short",timeStyle:"short"})}catch(t){return e.toLocaleString("en",{dateStyle:"short",timeStyle:"short"})}return e.getMonth()+1+"/"+e.getDate()+"/"+e.getFullYear()+" "+(e=(i=e).getHours(),i=i.getMinutes(),t=12<=e?"pm":"am",(e=(e%=12)||12)+":"+(i<10?"0"+i:i)+" "+t)},onBtnPreviewClick:function(t,e){switch(e){case"prev":this.api.asc_GetPrevRevisionsChange();break;case"next":this.api.asc_GetNextRevisionsChange()}Common.NotificationCenter.trigger("edit:complete",this.view)},onAcceptClick:function(t,e,i){this.api&&(e?"all"===e.value?this.api.asc_AcceptAllChanges():this._state.lock?this.api.asc_GetNextRevisionsChange():this.api.asc_AcceptChangesBySelection(!0):this.api.asc_AcceptChanges(t)),Common.NotificationCenter.trigger("edit:complete",this.view)},onRejectClick:function(t,e,i){this.api&&(e?"all"===e.value?this.api.asc_RejectAllChanges():this._state.lock?this.api.asc_GetNextRevisionsChange():this.api.asc_RejectChangesBySelection(!0):this.api.asc_RejectChanges(t)),Common.NotificationCenter.trigger("edit:complete",this.view)},onDeleteClick:function(t){this.api&&this.api.asc_RejectChanges(t),Common.NotificationCenter.trigger("edit:complete",this.view)},onGotoClick:function(t){this.api&&this.api.asc_FollowRevisionMove(t),Common.NotificationCenter.trigger("edit:complete",this.view)},onTurnPreview:function(t,e,i){this.appConfig.isReviewOnly?this.view.turnChanges(!0):this.appConfig.canReview&&(t="off"!=t&&t,e?(this.api.asc_SetLocalTrackRevisions(null),this.api.asc_SetGlobalTrackRevisions(!!t)):this.api.asc_SetLocalTrackRevisions(!!t))},onApiTrackRevisionsChange:function(t,e,i){var s;this.appConfig.isReviewOnly||this._state.docProtection.isReviewOnly?this.view.turnChanges(!0):this.appConfig.canReview&&(Common.Utils.InternalSettings.set(this.appPrefix+"track-changes",((t=(s=null===t)?e:t)?0:1)+(s?2:0)),this.view.turnChanges(t,s),i&&this.userCollection&&((t=this.userCollection.findOriginalUser(i))&&Common.NotificationCenter.trigger("showmessage",{msg:Common.Utils.String.format(e?this.textOnGlobal:this.textOffGlobal,AscCommon.UserInfoParser.getParsedName(t.get("username")))},{timeout:5e3,hideCloseTip:!0})))},onTurnSpelling:function(t,e){t="on"==t,this.view&&this.view.turnSpelling(t),Common.UI.FeaturesManager.canChange("spellcheck")&&!e&&(Common.localStorage.setItem(this.appPrefix+"settings-spellcheck",t?1:0),this.api.asc_setSpellCheck(t),Common.Utils.InternalSettings.set(this.appPrefix+"settings-spellcheck",t))},onReviewViewClick:function(t,e,i){this.turnDisplayMode(e.value),this.appConfig.isEdit||this.appConfig.isRestrictedEdit?"markup"!=e.value&&"simple"!=e.value||(Common.localStorage.setItem(this.appPrefix+"review-mode-editor",e.value),Common.Utils.InternalSettings.set(this.appPrefix+"review-mode-editor",e.value)):Common.localStorage.setItem(this.appPrefix+"review-mode",e.value),Common.NotificationCenter.trigger("edit:complete",this.view)},onCompareClick:function(t){var i;this.api&&((i=this)._state.compareSettings||(this._state.compareSettings=new AscCommonWord.ComparisonOptions,this._state.compareSettings.putWords(!Common.localStorage.getBool("de-compare-char"))),"file"===t?(this.api&&setTimeout(function(){i.api.asc_CompareDocumentFile(i._state.compareSettings)},1),Common.NotificationCenter.trigger("edit:complete",this.view)):"url"===t?new Common.Views.ImageFromUrlDialog({title:i.textUrl,handler:function(t,e){"ok"==t&&(i.api&&(t=e.replace(/ /g,""),_.isEmpty(t)||i.api.asc_CompareDocumentUrl(t,i._state.compareSettings)),Common.NotificationCenter.trigger("edit:complete",i.view))}}).show():"storage"===t?Common.NotificationCenter.trigger("storage:document-load","compare"):"settings"===t&&(t=!i._state.compareSettings||i._state.compareSettings.getWords(),new Common.Views.OptionsDialog({title:i.textTitleComparison,items:[{caption:i.textChar,value:!1,checked:!1===t},{caption:i.textWord,value:!0,checked:!1!==t}],label:i.textShow,handler:function(t,e){"ok"==e&&(i._state.compareSettings=new AscCommonWord.ComparisonOptions,i._state.compareSettings.putWords(t.getSettings())),Common.NotificationCenter.trigger("edit:complete",i.toolbar)}}).show())),Common.NotificationCenter.trigger("edit:complete",this.view)},onCombineClick:function(t){var i;this.api&&((i=this)._state.compareSettings||(this._state.compareSettings=new AscCommonWord.ComparisonOptions,this._state.compareSettings.putWords(!Common.localStorage.getBool("de-compare-char"))),"file"===t?(setTimeout(function(){i.api.asc_MergeDocumentFile(i._state.compareSettings)},1),Common.NotificationCenter.trigger("edit:complete",this.view)):"url"===t?new Common.Views.ImageFromUrlDialog({title:i.textUrl,handler:function(t,e){"ok"==t&&(i.api&&(t=e.replace(/ /g,""),_.isEmpty(t)||i.api.asc_MergeDocumentUrl(t,i._state.compareSettings)),Common.NotificationCenter.trigger("edit:complete",i.view))}}).show():"storage"===t&&Common.NotificationCenter.trigger("storage:document-load","combine")),Common.NotificationCenter.trigger("edit:complete",this.view)},setRevisedFile:function(t){t&&(t.c="compare"),this.setRequestedDocument(t)},onAcceptChangesBeforeCompare:function(e){Common.UI.warning({width:550,msg:this.textAcceptBeforeCompare,buttons:["yes","no"],primary:"yes",callback:function(t){_.defer(function(){e&&e("yes"==t)}),Common.NotificationCenter.trigger("edit:complete",this.view)}})},openDocumentFromStorage:function(i){var s=this;this.appConfig.canRequestSelectDocument?Common.Gateway.requestSelectDocument(i):this.appConfig.canRequestCompareFile?Common.Gateway.requestCompareFile():new Common.Views.SelectFileDlg({fileChoiceUrl:this.appConfig.fileChoiceUrl.replace("{fileExt}","").replace("{documentType}","DocumentsOnly")}).on("selectfile",function(t,e){e&&(e.c=i),s.setRequestedDocument(e)}).show()},setRequestedDocument:function(t){Common.NotificationCenter.trigger("storage:document-insert",t)},insertDocumentFromStorage:function(t){t&&t.url&&("compare"===t.c||"combine"===t.c)&&(this._state.compareSettings||(this._state.compareSettings=new AscCommonWord.ComparisonOptions,this._state.compareSettings.putWords(!Common.localStorage.getBool("de-compare-char"))),"compare"===t.c&&this.api.asc_CompareDocumentUrl(t.url,this._state.compareSettings,t.token),"combine"===t.c&&this.api.asc_MergeDocumentUrl(t.url,this._state.compareSettings,t.token))},turnDisplayMode:function(t){if(this.api){var e=Asc.c_oAscDisplayModeInReview.Edit;switch(t){case"final":e=Asc.c_oAscDisplayModeInReview.Final;break;case"original":e=Asc.c_oAscDisplayModeInReview.Original;break;case"simple":e=Asc.c_oAscDisplayModeInReview.Simple}this.api.asc_SetDisplayModeInReview(e)}this.disableEditing("final"==t||"original"==t),this._state.previewMode="final"==t||"original"==t},onChangeDisplayModeInReview:function(t){this.disableEditing(t===Asc.c_oAscDisplayModeInReview.Final||t===Asc.c_oAscDisplayModeInReview.Original);var e="markup";switch(t){case Asc.c_oAscDisplayModeInReview.Final:e="final";break;case Asc.c_oAscDisplayModeInReview.Original:e="original";break;case Asc.c_oAscDisplayModeInReview.Simple:e="simple"}this.view&&this.view.turnDisplayMode(e),this._state.previewMode=t===Asc.c_oAscDisplayModeInReview.Final||t===Asc.c_oAscDisplayModeInReview.Original},isPreviewChangesMode:function(){return this._state.previewMode},onCoAuthMode:function(t,e,i){var s;Common.localStorage.setItem(this.appPrefix+"settings-coauthmode",e.value),Common.Utils.InternalSettings.set(this.appPrefix+"settings-coauthmode",e.value),this.api&&(this.api.asc_SetFastCollaborative(1==e.value),this.api.SetCollaborativeMarksShowType&&(null!==(s=Common.localStorage.getItem(e.value?this.appPrefix+"settings-showchanges-fast":this.appPrefix+"settings-showchanges-strict"))?this.api.SetCollaborativeMarksShowType("all"==s?Asc.c_oAscCollaborativeMarksShowType.All:"none"==s?Asc.c_oAscCollaborativeMarksShowType.None:Asc.c_oAscCollaborativeMarksShowType.LastChanges):this.api.SetCollaborativeMarksShowType(e.value?Asc.c_oAscCollaborativeMarksShowType.None:Asc.c_oAscCollaborativeMarksShowType.LastChanges)),null===(s=Common.localStorage.getItem(this.appPrefix+"settings-autosave"))&&this.appConfig.customization&&!1===this.appConfig.customization.autosave&&(s=0),s=e.value||null===s?1:parseInt(s),Common.localStorage.setItem(this.appPrefix+"settings-autosave",s),Common.Utils.InternalSettings.set(this.appPrefix+"settings-autosave",s),this.api.asc_setAutoSaveGap(s)),Common.NotificationCenter.trigger("edit:complete",this.view),this.view.fireEvent("settings:apply",[this])},disableEditing:function(t){Common.NotificationCenter.trigger("editing:disable",t,{viewMode:!1,reviewMode:!0,fillFormMode:!1,allowMerge:!1,allowSignature:!1,allowProtect:!1,rightMenu:{clear:t,disable:!0},statusBar:!0,leftMenu:{disable:!1,previewMode:!0},fileMenu:{protect:!0,info:!0},navigation:{disable:!1,previewMode:!0},comments:{disable:!1,previewMode:!0},chat:!1,review:!0,viewport:!1,documentHolder:{clear:!1,disable:!0},toolbar:!0,plugins:!0,protect:!0},"review")},createToolbarPanel:function(){return this.view.getPanel()},getView:function(t){return!t&&this.view?this.view:Backbone.Controller.prototype.getView.call(this,t)},onAppReady:function(s){var o=this;new Promise(function(t){t()}).then(function(){s.canReview?(void 0===(i=o.appConfig.customization&&o.appConfig.customization.review?o.appConfig.customization.review.trackChanges:void 0)&&(i=o.appConfig.customization?o.appConfig.customization.trackChanges:void 0),s.isReviewOnly||void 0!==i?o.api.asc_SetLocalTrackRevisions(s.isReviewOnly||!0===i):o.onApiTrackRevisionsChange(o.api.asc_GetLocalTrackRevisions(),o.api.asc_GetGlobalTrackRevisions()),o.api.asc_HaveRevisionsChanges()&&o.view.markChanges(!0),null===(i=Common.localStorage.getItem(o.appPrefix+"review-mode-editor"))&&(i=(i=o.appConfig.customization&&o.appConfig.customization.review?o.appConfig.customization.review.reviewDisplay:void 0)||(o.appConfig.customization?o.appConfig.customization.reviewDisplay:void 0),i=/^(original|final|markup|simple)$/i.test(i)?i.toLocaleLowerCase():"markup"),Common.Utils.InternalSettings.set(o.appPrefix+"review-mode-editor",i),o.turnDisplayMode(i),o.view.turnDisplayMode(i),"object"==typeof o.appConfig.customization&&(o.appConfig.customization.review&&1==o.appConfig.customization.review.showReviewChanges||(!o.appConfig.customization.review||void 0===o.appConfig.customization.review.showReviewChanges)&&1==o.appConfig.customization.showReviewChanges)&&(o.dlgChanges=new Common.Views.ReviewChangesDialog({popoverChanges:o.popoverChanges,mode:o.appConfig,docProtection:o._state.docProtection}),e=(t=$("#editor_sdk")).offset(),o.dlgChanges.show(Math.max(10,e.left+t.width()-300),Math.max(10,e.top+t.height()-150)))):s.canViewReview&&(s.canViewReview=s.isEdit||o.api.asc_HaveRevisionsChanges(!0),s.canViewReview&&(null===(i=Common.localStorage.getItem(o.appPrefix+(s.isEdit||s.isRestrictedEdit?"review-mode-editor":"review-mode")))&&(i=(i=o.appConfig.customization&&o.appConfig.customization.review?o.appConfig.customization.review.reviewDisplay:void 0)||(o.appConfig.customization?o.appConfig.customization.reviewDisplay:void 0),i=/^(original|final|markup|simple)$/i.test(i)?i.toLocaleLowerCase():s.isEdit||s.isRestrictedEdit?"markup":"original"),o.turnDisplayMode(i),o.view.turnDisplayMode(i))),o.view&&o.view.btnChat&&o.getApplication().getController("LeftMenu").leftMenu.btnChat.on("toggle",function(t,e){e!==o.view.btnChat.pressed&&o.view.turnChat(e)}),o.onChangeProtectSheet(),o.view&&(o.lockToolbar(Common.enumLock.hideComments,!Common.localStorage.getBool(o.appPrefix+"settings-livecomment",!0),{array:[o.view.btnCommentRemove,o.view.btnCommentResolve]}),o.lockToolbar(Common.enumLock.Objects,!!o._state.wsProps.Objects,{array:[o.view.btnCommentRemove,o.view.btnCommentResolve]}));var t,e,i=Common.localStorage.getItem(o.appPrefix+"settings-review-hover-mode");i=null===i?!(!o.appConfig.customization||!o.appConfig.customization.review)&&!!o.appConfig.customization.review.hoverMode:!!parseInt(i),Common.Utils.InternalSettings.set(o.appPrefix+"settings-review-hover-mode",i),o.appConfig.reviewHoverMode=i,o.view&&o.view.onAppReady(s)})},applySettings:function(t){this.view&&this.view.turnSpelling(Common.localStorage.getBool(this.appPrefix+"settings-spellcheck",!0)),this.view&&this.view.turnCoAuthMode(Common.localStorage.getBool(this.appPrefix+"settings-coauthmode",!0)),(this.appConfig.canReview||this.appConfig.canViewReview)&&this.appConfig.reviewHoverMode&&this.onApiShowChange()},synchronizeChanges:function(){this.appConfig&&this.appConfig.canReview&&this.view.markChanges(this.api.asc_HaveRevisionsChanges())},setLanguages:function(t){this.langs=t,this.lockToolbar(Common.enumLock.noSpellcheckLangs,this.langs.length<1,{array:this.view.btnsDocLang})},onDocLanguage:function(){var i=this;new Common.Views.LanguageDialog({languages:i.langs,current:i.api.asc_getDefaultLanguage(),handler:function(t,e){"ok"==t&&(t=_.findWhere(i.langs,{value:e}))&&i.api.asc_setDefaultLanguage(t.code)}}).show()},onLostEditRights:function(){this._readonlyRights=!0,this.view&&this.view.onLostEditRights(),this.view&&this.lockToolbar(Common.enumLock.cantShare,!0,{array:[this.view.btnSharing]})},changeAccessRights:function(t,e,i){var s;this._docAccessDlg||this._readonlyRights||(this.appConfig.canRequestSharingSettings?Common.Gateway.requestSharingSettings():((s=this)._docAccessDlg=new Common.Views.DocumentAccessDialog({settingsurl:this.appConfig.sharingSettingsUrl}),s._docAccessDlg.on("accessrights",function(t,e){s.setSharingSettings({sharingSettings:e})}).on("close",function(t){s._docAccessDlg=void 0}),s._docAccessDlg.show()))},setSharingSettings:function(t){t&&(this.document.info.sharingSettings=t.sharingSettings,Common.NotificationCenter.trigger("collaboration:sharingupdate",t.sharingSettings),Common.NotificationCenter.trigger("mentions:clearusers",this))},onCoAuthoringDisconnect:function(){this.lockToolbar(Common.enumLock.lostConnect,!0),this.dlgChanges&&Common.Utils.lockControls(Common.enumLock.lostConnect,!0,{array:[this.dlgChanges.btnAccept,this.dlgChanges.btnReject]})},onUpdateUsers:function(){var i=this.userCollection;this.popoverChanges&&this.popoverChanges.each(function(t){var e=i.findOriginalUser(t.get("userid"));t.set("usercolor",e?e.get("color"):null)})},onAuthParticipantsChanged:function(t){var e;this.view&&this.view.btnCompare&&(e=0,_.each(t,function(t){t.asc_getView()||e++}),Common.Utils.lockControls(Common.enumLock.hasCoeditingUsers,1<e,{array:[this.view.btnCompare,this.view.btnCombine]}))},commentsShowHide:function(t){var e;!this.view||void 0!==(e=Common.Utils.InternalSettings.get(this.appPrefix+"settings-livecomment"))&&this.lockToolbar(Common.enumLock.hideComments,"show"!=t&&!e,{array:[this.view.btnCommentRemove,this.view.btnCommentResolve]})},onChangeProtectSheet:function(t){var e;t||(t=(e=this.getApplication().getController("WBProtection"))?e.getWSProps():null),this._state.wsProps=t?t.wsProps:[],this._state.wsLock=!!t&&t.wsLock,this.view&&this.lockToolbar(Common.enumLock.Objects,!!this._state.wsProps.Objects,{array:[this.view.btnCommentRemove,this.view.btnCommentResolve]})},onChangeProtectDocument:function(t){var e;(t=t?t:(e=this.getApplication().getController("DocProtection"))?e.getDocProps():null)&&(this._state.docProtection=t,this.lockToolbar(Common.enumLock.docLockView,t.isReadOnly),this.lockToolbar(Common.enumLock.docLockForms,t.isFormsOnly),this.lockToolbar(Common.enumLock.docLockReview,t.isReviewOnly),this.lockToolbar(Common.enumLock.docLockComments,t.isCommentsOnly),this.dlgChanges&&(Common.Utils.lockControls(Common.enumLock.docLockView,t.isReadOnly,{array:[this.dlgChanges.btnAccept,this.dlgChanges.btnReject]}),Common.Utils.lockControls(Common.enumLock.docLockForms,t.isFormsOnly,{array:[this.dlgChanges.btnAccept,this.dlgChanges.btnReject]}),Common.Utils.lockControls(Common.enumLock.docLockReview,t.isReviewOnly,{array:[this.dlgChanges.btnAccept,this.dlgChanges.btnReject]}),Common.Utils.lockControls(Common.enumLock.docLockComments,t.isCommentsOnly,{array:[this.dlgChanges.btnAccept,this.dlgChanges.btnReject]})),this.appConfig.isReviewOnly||(t.isReviewOnly?(this.api.asc_SetLocalTrackRevisions(!0),this.onApiShowChange()):this._state.prevReviewProtected&&(this.api.asc_SetLocalTrackRevisions(!1),this.onApiShowChange()),this._state.prevReviewProtected=t.isReviewOnly),this.updatePreviewMode())}},Common.Controllers.ReviewChanges||{}))}),define("common/main/lib/view/PasswordDialog",["common/main/lib/component/Window"],function(){"use strict";Common.Views.PasswordDialog=Common.UI.Window.extend(_.extend({applyFunction:void 0,initialize:function(t){var e={};_.extend(e,{width:395,height:270,header:!0,cls:"modal-dlg",contentTemplate:"",title:this.txtTitle,buttons:["ok","cancel"]},t),this.handler=t.handler,this.template=t.template||['<div class="box">','<div class="input-row" style="margin-bottom: 10px;">',"<label>"+this.txtDescription+"</label>","</div>",'<div class="input-row">',"<label>"+this.txtPassword+(this.passwordOptional?" ("+this.txtOptional+")":"")+"</label>","</div>",'<div id="id-password-txt" class="input-row" style="margin-bottom: 5px;"></div>','<div class="input-row">',"<label>"+this.txtRepeat+"</label>","</div>",'<div id="id-repeat-txt" class="input-row" style="margin-bottom: 10px;"></div>',"<label>"+this.txtWarning+"</label>","</div>"].join(""),e.tpl=_.template(this.template)(e),Common.UI.Window.prototype.initialize.call(this,e)},render:function(){var e;Common.UI.Window.prototype.render.call(this),this.$window&&((e=this).$window.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.repeatPwd=new Common.UI.InputField({el:$("#id-repeat-txt"),type:"password",allowBlank:!1,style:"width: 100%;",maxLength:255,validateOnBlur:!1,validation:function(t){return e.txtIncorrectPwd}}),this.inputPwd=new Common.UI.InputFieldBtnPassword({el:$("#id-password-txt"),type:"password",allowBlank:!1,style:"width: 100%;",maxLength:255,validateOnBlur:!1,repeatInput:this.repeatPwd}))},getFocusedComponents:function(){return[this.inputPwd,this.repeatPwd]},getDefaultFocusableComponent:function(){return this.inputPwd},onPrimary:function(t){return this._handleInput("ok"),!1},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},_handleInput:function(t){if(this.handler){if("ok"==t){if(!0!==this.inputPwd.checkValidate())return void this.inputPwd.focus();if(this.inputPwd.getValue()!==this.repeatPwd.getValue())return this.repeatPwd.checkValidate(),void this.repeatPwd.focus()}this.handler.call(this,t,this.inputPwd.getValue())}this.close()}},Common.Views.PasswordDialog||{}))}),void 0===Common&&(Common={}),define("common/main/lib/view/SignDialog",["common/main/lib/util/utils","common/main/lib/component/InputField","common/main/lib/component/Window","common/main/lib/component/ComboBoxFonts"],function(){"use strict";Common.Views.SignDialog=Common.UI.Window.extend(_.extend({options:{width:370,style:"min-width: 350px;",cls:"modal-dlg",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:this.textTitle},t||{}),this.api=this.options.api,this.signType=this.options.signType||"invisible",this.signSize=this.options.signSize||{width:0,height:0},this.certificateId=null,this.signObject=null,this.fontStore=this.options.fontStore,this.font={size:11,name:"Arial",bold:!1,italic:!1};t=Common.localStorage.getKeysFilter();this.appPrefix=t&&t.length?t.split(",")[0]:"",this.template=['<div class="box" style="height: '+("invisible"==this.signType?"132px;":"300px;")+'">','<div id="id-dlg-sign-invisible">','<div class="input-row">',"<label>"+this.textPurpose+"</label>","</div>",'<div id="id-dlg-sign-purpose" class="input-row"></div>',"</div>",'<div id="id-dlg-sign-visible">','<div class="input-row">',"<label>"+this.textInputName+"</label>","</div>",'<div id="id-dlg-sign-name" class="input-row" style="margin-bottom: 5px;"></div>','<div id="id-dlg-sign-fonts" class="input-row" style="display: inline-block;"></div>','<div id="id-dlg-sign-font-size" class="input-row margin-left-3" style="display: inline-block;"></div>','<div id="id-dlg-sign-bold" class="margin-left-3" style="display: inline-block;"></div>','<div id="id-dlg-sign-italic" class="margin-left-3" style="display: inline-block;"></div>','<div style="margin: 10px 0 5px 0;">',"<label>"+this.textUseImage+"</label>","</div>",'<button id="id-dlg-sign-image" class="btn btn-text-default auto">'+this.textSelectImage+"</button>",'<div class="input-row" style="margin-top: 10px;">','<label class="font-weight-bold">'+this.textSignature+"</label>","</div>",'<div style="border: 1px solid #cbcbcb;"><div id="signature-preview-img" style="width: 100%; height: 50px;position: relative;"></div></div>',"</div>",'<table style="margin-top: 30px;">',"<tr>",'<td><label class="font-weight-bold" style="margin-bottom: 3px;">'+this.textCertificate+'</label></td><td rowspan="2" class="padding-left-20" style="vertical-align: top;"><button id="id-dlg-sign-change" class="btn btn-text-default float-right">'+this.textSelect+"</button></td>","</tr>",'<tr><td><div id="id-dlg-sign-certificate" class="hidden" style="max-width: 240px;overflow: hidden;white-space: nowrap;"></td></tr>',"</table>","</div>"].join(""),this.templateCertificate=_.template(['<label style="display: block;margin-bottom: 3px;overflow: hidden;text-overflow: ellipsis;"><%= Common.Utils.String.htmlEncode(name) %></label>','<label style="display: block;"><%= Common.Utils.String.htmlEncode(valid) %></label>'].join("")),this.options.tpl=_.template(this.template)(this.options),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var i=this,t=this.getChild();i.inputPurpose=new Common.UI.InputField({el:$("#id-dlg-sign-purpose"),style:"width: 100%;"}),i.inputName=new Common.UI.InputField({el:$("#id-dlg-sign-name"),style:"width: 100%;",validateOnChange:!0}).on("changing",_.bind(i.onChangeName,i)),i.cmbFonts=new Common.UI.ComboBoxFonts({el:$("#id-dlg-sign-fonts"),cls:"input-group-nr",style:"width: 234px;",menuCls:"scrollable-menu",menuStyle:"min-width: 234px;max-height: 270px;",store:new Common.Collections.Fonts,recent:0,takeFocusOnClose:!0,hint:i.tipFontName}).on("selected",function(t,e){i.signObject&&i.signObject.setText(i.inputName.getValue(),e.name,i.font.size,i.font.italic,i.font.bold),i.font.name=e.name}),this.cmbFontSize=new Common.UI.ComboBox({el:$("#id-dlg-sign-font-size"),cls:"input-group-nr",style:"width: 55px;",menuCls:"scrollable-menu",menuStyle:"min-width: 55px;max-height: 270px;",hint:this.tipFontSize,takeFocusOnClose:!0,data:[{value:8,displayValue:"8"},{value:9,displayValue:"9"},{value:10,displayValue:"10"},{value:11,displayValue:"11"},{value:12,displayValue:"12"},{value:14,displayValue:"14"},{value:16,displayValue:"16"},{value:18,displayValue:"18"},{value:20,displayValue:"20"},{value:22,displayValue:"22"},{value:24,displayValue:"24"},{value:26,displayValue:"26"},{value:28,displayValue:"28"},{value:36,displayValue:"36"},{value:48,displayValue:"48"},{value:72,displayValue:"72"},{value:96,displayValue:"96"}]}).on("selected",function(t,e){i.signObject&&i.signObject.setText(i.inputName.getValue(),i.font.name,e.value,i.font.italic,i.font.bold),i.font.size=e.value}),this.cmbFontSize.setValue(this.font.size),this.cmbFontSize.on("changed:before",_.bind(this.onFontSizeChanged,this,!0)),this.cmbFontSize.on("changed:after",_.bind(this.onFontSizeChanged,this,!1)),i.btnBold=new Common.UI.Button({parentEl:$("#id-dlg-sign-bold"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-bold",enableToggle:!0,hint:i.textBold}),i.btnBold.on("click",function(t,e){i.signObject&&i.signObject.setText(i.inputName.getValue(),i.font.name,i.font.size,i.font.italic,t.pressed),i.font.bold=t.pressed}),i.btnItalic=new Common.UI.Button({parentEl:$("#id-dlg-sign-italic"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-italic",enableToggle:!0,hint:i.textItalic}),i.btnItalic.on("click",function(t,e){i.signObject&&i.signObject.setText(i.inputName.getValue(),i.font.name,i.font.size,t.pressed,i.font.bold),i.font.italic=t.pressed}),i.btnSelectImage=new Common.UI.Button({el:"#id-dlg-sign-image"}),i.btnSelectImage.on("click",_.bind(i.onSelectImage,i)),i.btnChangeCertificate=new Common.UI.Button({el:"#id-dlg-sign-change"}),i.btnChangeCertificate.on("click",_.bind(i.onChangeCertificate,i)),i.btnOk=new Common.UI.Button({el:t.find(".primary"),disabled:!0}),i.cntCertificate=$("#id-dlg-sign-certificate"),i.cntVisibleSign=$("#id-dlg-sign-visible"),i.cntInvisibleSign=$("#id-dlg-sign-invisible"),("visible"==i.signType?i.cntInvisibleSign:i.cntVisibleSign).addClass("hidden"),t.find(".dlg-btn").on("click",_.bind(i.onBtnClick,i)),i.afterRender()},getFocusedComponents:function(){return[this.inputPurpose,this.inputName,this.cmbFonts,this.cmbFontSize,this.btnBold,this.btnItalic,this.btnSelectImage,this.btnChangeCertificate]},show:function(){Common.UI.Window.prototype.show.apply(this,arguments);var t=this;_.delay(function(){("visible"==t.signType?t.inputName:t.inputPurpose).cmpEl.find("input").focus()},500)},close:function(){this.api.asc_unregisterCallback("on_signature_defaultcertificate_ret",this.binding.certificateChanged),this.api.asc_unregisterCallback("on_signature_selectsertificate_ret",this.binding.certificateChanged),Common.UI.Window.prototype.close.apply(this,arguments),this.signObject&&this.signObject.destroy()},afterRender:function(){this.api&&(this.binding||(this.binding={}),this.binding.certificateChanged=_.bind(this.onCertificateChanged,this),this.api.asc_registerCallback("on_signature_defaultcertificate_ret",this.binding.certificateChanged),this.api.asc_registerCallback("on_signature_selectsertificate_ret",this.binding.certificateChanged),this.api.asc_GetDefaultCertificate()),"visible"==this.signType&&(this.cmbFonts.fillFonts(this.fontStore),this.cmbFonts.selectRecord(this.fontStore.findWhere({name:this.font.name})||this.fontStore.at(0)),this.signObject=new AscCommon.CSignatureDrawer("signature-preview-img",this.api,this.signSize.width,this.signSize.height))},getSettings:function(){var t={};return t.certificateId=this.certificateId,"invisible"==this.signType?t.purpose=this.inputPurpose.getValue():t.images=this.signObject?this.signObject.getImages():[null,null],t},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onPrimary:function(t){return this._handleInput("ok"),!1},_handleInput:function(t){if(this.options.handler){if("ok"==t&&(this.btnOk.isDisabled()||this.signObject&&!this.signObject.isValid()))return void(this.btnOk.isDisabled()||(this.inputName.showError([this.textNameError]),this.inputName.focus()));this.options.handler.call(this,this,t)}this.close()},onChangeCertificate:function(){this.api.asc_SelectCertificate()},onCertificateChanged:function(t){this.certificateId=t.id;var e=t.date,e="string"==typeof e?e.split(" - "):["",""];this.cntCertificate.html(this.templateCertificate({name:t.name,valid:this.textValid.replace("%1",e[0]).replace("%2",e[1])})),this.cntCertificate.toggleClass("hidden",_.isEmpty(this.certificateId)||this.certificateId<0),this.btnChangeCertificate.setCaption(_.isEmpty(this.certificateId)||this.certificateId<0?this.textSelect:this.textChange),this.btnOk.setDisabled(_.isEmpty(this.certificateId)||this.certificateId<0)},onSelectImage:function(){this.signObject&&(this.signObject.selectImage(),this.inputName.setValue(""))},onChangeName:function(t,e){this.signObject&&this.signObject.setText(e,this.font.name,this.font.size,this.font.italic,this.font.bold)},onFontSizeChanged:function(t,e,i,s){if(t){t=e.store.findWhere({displayValue:i.value});if(!t&&!(o=/^\+?(\d*(\.|,)?\d+)$|^\+?(\d+(\.|,)?\d*)$/.exec(i.value)))return o=e.getValue(),e.setRawValue(o),s.preventDefault(),!1}else{var o,t="sse-"==this.appPrefix?409:300;o=t<(o=Common.Utils.String.parseFloat(i.value))?t:o<1?1:Math.floor(2*(o+.4))/2,e.setRawValue(o),this.signObject&&this.signObject.setText(this.inputName.getValue(),this.font.name,o,this.font.italic,this.font.bold),this.font.size=o}}},Common.Views.SignDialog||{}))}),void 0===Common&&(Common={}),define("common/main/lib/view/SignSettingsDialog",["common/main/lib/util/utils","common/main/lib/component/InputField","common/main/lib/component/CheckBox","common/main/lib/component/Window"],function(){"use strict";Common.Views.SignSettingsDialog=Common.UI.Window.extend(_.extend({options:{width:350,style:"min-width: 350px;",cls:"modal-dlg",type:"edit"},initialize:function(t){_.extend(this.options,{title:this.textTitle},t||{}),this.template=['<div class="box" style="height: 250px;">','<div class="input-row">',"<label>"+this.textInfoName+"</label>","</div>",'<div id="id-dlg-sign-settings-name" class="input-row" style="margin-bottom: 5px;"></div>','<div class="input-row">',"<label>"+this.textInfoTitle+"</label>","</div>",'<div id="id-dlg-sign-settings-title" class="input-row" style="margin-bottom: 5px;"></div>','<div class="input-row">',"<label>"+this.textInfoEmail+"</label>","</div>",'<div id="id-dlg-sign-settings-email" class="input-row" style="margin-bottom: 10px;"></div>','<div class="input-row">',"<label>"+this.textInstructions+"</label>","</div>",'<div id="id-dlg-sign-settings-instructions"></div>','<div id="id-dlg-sign-settings-date"></div>',"</div>",'<div class="footer center">','<button class="btn normal dlg-btn primary" result="ok">'+this.okButtonText+"</button>",'<% if (type == "edit") { %>','<button class="btn normal dlg-btn" result="cancel">'+this.cancelButtonText+"</button>","<% } %>","</div>"].join(""),this.api=this.options.api,this.type=this.options.type||"edit",this.options.tpl=_.template(this.template)(this.options),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this.getChild();this.inputName=new Common.UI.InputField({el:$("#id-dlg-sign-settings-name"),style:"width: 100%;",disabled:"view"==this.type}),this.inputTitle=new Common.UI.InputField({el:$("#id-dlg-sign-settings-title"),style:"width: 100%;",disabled:"view"==this.type}),this.inputEmail=new Common.UI.InputField({el:$("#id-dlg-sign-settings-email"),style:"width: 100%;",disabled:"view"==this.type}),this.textareaInstructions=new Common.UI.TextareaField({el:t.find("#id-dlg-sign-settings-instructions"),style:"width: 100%; height: 35px;margin-bottom: 10px;",value:this.textDefInstruction,disabled:"view"==this.type}),this.chDate=new Common.UI.CheckBox({el:$("#id-dlg-sign-settings-date"),labelText:this.textShowDate,disabled:"view"==this.type,value:"checked"}),t.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this))},getFocusedComponents:function(){return[this.inputName,this.inputTitle,this.inputEmail,this.textareaInstructions,this.chDate]},getDefaultFocusableComponent:function(){return this.inputName},setSettings:function(t){var e;t&&(e=t.asc_getSigner1(),this.inputName.setValue(e||""),e=t.asc_getSigner2(),this.inputTitle.setValue(e||""),e=t.asc_getEmail(),this.inputEmail.setValue(e||""),e=t.asc_getInstructions(),this.textareaInstructions.setValue(e||""),this.chDate.setValue(t.asc_getShowDate()),this._currentGuid=t.asc_getGuid())},getSettings:function(){var t=new AscCommon.asc_CSignatureLine;return t.asc_setSigner1(this.inputName.getValue()),t.asc_setSigner2(this.inputTitle.getValue()),t.asc_setEmail(this.inputEmail.getValue()),t.asc_setInstructions(this.textareaInstructions.getValue()),t.asc_setShowDate("checked"==this.chDate.getValue()),void 0!==this._currentGuid&&t.asc_setGuid(this._currentGuid),t},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onPrimary:function(t){return this._handleInput("ok"),!1},_handleInput:function(t){this.options.handler&&this.options.handler.call(this,this,t),this.close()}},Common.Views.SignSettingsDialog||{}))}),void 0===Common&&(Common={}),Common.Controllers=Common.Controllers||{},define("common/main/lib/controller/Protection",["core","common/main/lib/view/Protection","common/main/lib/view/PasswordDialog","common/main/lib/view/SignDialog","common/main/lib/view/SignSettingsDialog"],function(){"use strict";Common.Controllers.Protection=Backbone.Controller.extend(_.extend({models:[],collections:[],views:["Common.Views.Protection"],sdkViewName:"#id_main",initialize:function(){this.addListeners({"Common.Views.Protection":{"protect:password":_.bind(this.onPasswordClick,this),"protect:signature":_.bind(this.onSignatureClick,this)}})},onLaunch:function(){this._state={},Common.NotificationCenter.on("app:ready",this.onAppReady.bind(this)),Common.NotificationCenter.on("api:disconnect",_.bind(this.onCoAuthoringDisconnect,this))},setConfig:function(t,e){this.setApi(e),t&&(this.sdkViewName=t.sdkviewname||this.sdkViewName)},setApi:function(t){t&&(this.api=t,this.appConfig.isPasswordSupport&&this.api.asc_registerCallback("asc_onDocumentPassword",_.bind(this.onDocumentPassword,this)),this.appConfig.isSignatureSupport&&(Common.NotificationCenter.on("protect:sign",_.bind(this.onSignatureRequest,this)),Common.NotificationCenter.on("protect:signature",_.bind(this.onSignatureClick,this)),this.api.asc_registerCallback("asc_onSignatureClick",_.bind(this.onSignatureSign,this)),this.api.asc_registerCallback("asc_onUpdateSignatures",_.bind(this.onApiUpdateSignatures,this))),this.api.asc_registerCallback("asc_onCoAuthoringDisconnect",_.bind(this.onCoAuthoringDisconnect,this)))},setMode:function(t){return this.appConfig=t,this.view=this.createView("Common.Views.Protection",{mode:t}),this},onDocumentPassword:function(t,e){this.view&&this.view.onDocumentPassword(t,e)},SetDisabled:function(t,e){this.view&&this.view.SetDisabled(t,e)},onPasswordClick:function(t,e){switch(e){case"add":this.addPassword();break;case"delete":this.deletePassword()}Common.NotificationCenter.trigger("edit:complete",this.view)},onSignatureRequest:function(t){this.api.asc_RequestSign(t)},onSignatureClick:function(t,e,i){switch(t){case"invisible":this.onSignatureRequest("unvisibleAdd");break;case"visible":this.addVisibleSignature(e,i)}},createToolbarPanel:function(){return this.view.getPanel()},getView:function(t){return!t&&this.view?this.view:Backbone.Controller.prototype.getView.call(this,t)},onAppReady:function(t){var e=this;new Promise(function(t,e){t()}).then(function(){e.onChangeProtectDocument(),Common.NotificationCenter.on("protect:doclock",_.bind(e.onChangeProtectDocument,e))})},onChangeProtectDocument:function(t){var e;(t=t?t:(e=this.getApplication().getController("DocProtection"))?e.getDocProps():null)&&this.view&&(this.view._state.docProtection=t)},addPassword:function(){var i=this;new Common.Views.PasswordDialog({api:i.api,handler:function(t,e){"ok"==t&&i.api.asc_setCurrentPassword(e),Common.NotificationCenter.trigger("edit:complete")}}).show()},deletePassword:function(){this.api.asc_resetPassword()},addInvisibleSignature:function(){var i=this;new Common.Views.SignDialog({api:i.api,signType:"invisible",handler:function(t,e){"ok"==e&&(e=t.getSettings(),i.api.asc_Sign(e.certificateId)),Common.NotificationCenter.trigger("edit:complete")}}).show()},addVisibleSignature:function(i,t){var s=this,e=new Common.Views.SignSettingsDialog({type:i?"view":"edit",handler:function(t,e){i||"ok"!=e||s.api.asc_AddSignatureLine2(t.getSettings()),Common.NotificationCenter.trigger("edit:complete")}});e.show(),t&&e.setSettings(this.api.asc_getSignatureSetup(t))},signVisibleSignature:function(i,t,e){var s,o,n=this;_.isUndefined(n.fontStore)&&(n.fontStore=new Common.Collections.Fonts,s=n.getApplication().getController("Toolbar").getView("Toolbar").cmbFontName.store.toJSON(),o=[],_.each(s,function(t,e){t.cloneid||o.push(_.clone(t))}),n.fontStore.add(o)),new Common.Views.SignDialog({api:n.api,signType:"visible",fontStore:n.fontStore,signSize:{width:t||0,height:e||0},handler:function(t,e){"ok"==e&&(e=t.getSettings(),n.api.asc_Sign(e.certificateId,i,e.images[0],e.images[1])),Common.NotificationCenter.trigger("edit:complete")}}).show()},onSignatureSign:function(t,e,i,s){s?this.signVisibleSignature(t,e,i):this.addInvisibleSignature()},onApiUpdateSignatures:function(t,e){this.SetDisabled(t&&0<t.length,!0)},onCoAuthoringDisconnect:function(){this.SetDisabled(!0)}},Common.Controllers.Protection||{}))}),void 0===Common&&(Common={}),Common.Views=Common.Views||{},define("common/main/lib/view/Draw",["common/main/lib/util/utils","common/main/lib/component/BaseView","common/main/lib/component/Layout","common/main/lib/component/Window","common/main/lib/component/UpDownPicker"],function(t){"use strict";var e;Common.Views.Draw=Common.UI.BaseView.extend(_.extend((e='<div class="group"><span id="slot-btn-draw-select" class="btn-slot text x-huge"></span><span id="slot-btn-draw-pen-0" class="btn-slot text x-huge emptycaption"></span><span id="slot-btn-draw-pen-1" class="btn-slot text x-huge emptycaption"></span><span id="slot-btn-draw-pen-2" class="btn-slot text x-huge emptycaption"></span><span id="slot-btn-draw-eraser" class="btn-slot text x-huge"></span></div>',{options:{},initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t),this.appConfig=t.mode,this._state={disabled:!1},this.lockedControls=[],this.btnsPen=[],this.isPDFEditor=!!window.PDFE;var t=Common.localStorage.getKeysFilter(),t=(this.appPrefix=t&&t.length?t.split(",")[0]:"",Common.enumLock),e=[{hint:this.txtPen,color:"3D8A44",opacity:100,size:{arr:[.25,.5,1,2,3.5],idx:2},iconCls:"btn-pen-tool",idx:0},{hint:this.txtPen,color:"D43230",opacity:100,size:{arr:[.25,.5,1,2,3.5],idx:2},iconCls:"btn-pen-tool",idx:1},{hint:this.txtHighlighter,color:"FFFC54",opacity:50,size:{arr:[2,4,6,8,10],idx:2},iconCls:"btn-highlighter-tool",idx:2,colors:["FFFC54","72F54A","74F9FD","EB51F7","A900F9","EF8B3A","7272FF","FF63A4","1DFF92","03DA18","249B01","C504D2","0633D1","FFF7A0","FF0303","FFFFFF","D3D3D4","969696","606060","000000"]}],i="de-"===this.appPrefix?[t.headerLock,t.previewReviewMode,t.viewFormMode,t.lostConnect,t.docLockView,t.docLockForms,t.docLockComments]:"pe-"===this.appPrefix?[t.slideDeleted,t.lostConnect,t.noSlides]:[t.editCell,t.lostConnect,t.coAuth,t.Objects],s=this;e.forEach(function(t){t=new Common.UI.ButtonColored({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon "+t.iconCls,caption:" ",menu:!0,split:!0,enableToggle:!0,allowDepress:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small",penOptions:t,lock:i});s.btnsPen.push(t),s.lockedControls.push(t)}),this.btnEraser=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-eraser",caption:this.txtEraser,enableToggle:!0,allowDepress:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small",lock:i}),this.lockedControls.push(this.btnEraser),this.btnSelect=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-select",caption:this.txtSelect,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small",lock:i,visible:!this.isPDFEditor}),this.lockedControls.push(this.btnSelect),Common.NotificationCenter.on("app:ready",this.onAppReady.bind(this))},render:function(t){return this.boxSdk=$("#editor_sdk"),t&&t.html(this.getPanel()),this},updateButtonHint:function(t){var e=t.options.penOptions;t.updateHint(e.hint+": "+Common.Utils.ThemeColor.getTranslation(Common.Utils.ThemeColor.getRgbColor(e.color).asc_getName())+", "+e.size.arr[e.size.idx]+" "+this.txtMM),t.sizePicker&&t.sizePicker.setValue(e.size.arr[e.size.idx]+" "+this.txtMM)},createPen:function(i){var t=i.options.penOptions,s=Common.UI.getId(),o=this,e=(this.updateButtonHint(i),i.setMenu(new Common.UI.Menu({cls:"shifted-left",style:"min-width: 100px;",items:[{template:_.template('<div id="id-toolbar-menu-draw-pen-'+s+'" style="width: 174px; display: inline-block;" class="palette-large"></div>'),stopPropagation:!0},{id:s+"-color-new",template:_.template('<a tabindex="-1" type="menuitem" style="">'+i.textNewColor+"</a>")},{caption:"--"},{template:_.template('<div id="id-toolbar-draw-updownpicker-'+s+'" class="custom-scale" data-stopPropagation="true"></div>'),stopPropagation:!0}]}),!0),i.currentColor=t.color,i.setColor(i.currentColor),new Common.UI.ThemeColorPalette({el:$("#id-toolbar-menu-draw-pen-"+s),colors:t.colors||["1755A0","D43230","F5C346","EA3368","12A489","552F8B","9D1F87","BB2765","479ED2","67C9FA","3D8A44","80CA3D","1C19B4","7F4B0F","FF7E07","FFFFFF","D3D3D4","879397","575757","000000"],value:i.currentColor,dynamiccolors:5,themecolors:0,effects:0,columns:5,outerMenu:{menu:i.menu,index:0,focusOnShow:!0},storageSuffix:"-draw"})),n=(i.setPicker(e),e.on("select",_.bind(i.onColorSelect,i)),i.menu.setInnerMenu([{menu:e,index:0}]),i.menu.cmpEl.find("#"+s+"-color-new").on("click",function(){e.addNewColor(i.currentColor)}),function(t){var e=new Common.UI.UpDownPicker({el:$("#id-toolbar-draw-updownpicker-"+s),caption:o.txtSize,minWidth:50});e.on("click",function(t){o.fireEvent("draw:size",[i,t])}),e.setValue(i.options.penOptions.size.arr[i.options.penOptions.size.idx]+" "+o.txtMM),i.sizePicker=e,t.off("show:after",n)});i.menu.on("show:after",n)},onAppReady:function(t){var e=this;new Promise(function(t,e){t()}).then(function(){e.btnsPen.forEach(function(t){e.createPen(t)}),e.btnEraser.updateHint(e.hintEraser),e.btnSelect.updateHint(e.hintSelect),Common.NotificationCenter.trigger("tab:visible","draw",Common.UI.LayoutManager.isElementVisible("toolbar-draw")),function(){var i=this;i.btnEraser.on("click",function(t){i.fireEvent("draw:eraser",[t])}),i.btnsPen.forEach(function(t){t.on("click",function(t,e){i.fireEvent("draw:pen",[t])}),t.on("color:select",function(t,e){i.fireEvent("draw:color",[t,e])})}),i.btnSelect.on("click",function(t){i.fireEvent("draw:select",[t])}),i._isSetEvents=!0}.call(e)})},getPanel:function(t){this.$el=$(_.template(t?e:'<section id="draw-ink-panel" class="panel" data-tab="draw"><div class="group"><span id="slot-btn-draw-select" class="btn-slot text x-huge"></span><span id="slot-btn-draw-pen-0" class="btn-slot text x-huge emptycaption"></span><span id="slot-btn-draw-pen-1" class="btn-slot text x-huge emptycaption"></span><span id="slot-btn-draw-pen-2" class="btn-slot text x-huge emptycaption"></span><span id="slot-btn-draw-eraser" class="btn-slot text x-huge"></span></div></section>')({}));var i=this;return this.btnsPen.forEach(function(t,e){t.render(i.$el.find("#slot-btn-draw-pen-"+e))}),this.btnEraser&&this.btnEraser.render(this.$el.find("#slot-btn-draw-eraser")),this.btnSelect&&this.btnSelect.render(this.$el.find("#slot-btn-draw-select")),this.$el},show:function(){Common.UI.BaseView.prototype.show.call(this),this.fireEvent("show",this)},getButtons:function(){return this.lockedControls},depressButtons:function(e){this.btnsPen.forEach(function(t){t!==e&&t.toggle(!1,!0)}),this.btnEraser!==e&&this.btnEraser.toggle(!1,!0)},SetDisabled:function(t){this._state.disabled=t}}),Common.Views.Draw||{}))}),void 0===Common&&(Common={}),Common.Controllers=Common.Controllers||{},define("common/main/lib/controller/Draw",["core","common/main/lib/view/Draw","common/main/lib/view/PasswordDialog","common/main/lib/view/SignDialog","common/main/lib/view/SignSettingsDialog"],function(){"use strict";Common.Controllers.Draw=Backbone.Controller.extend(_.extend({models:[],collections:[],views:["Common.Views.Draw"],sdkViewName:"#id_main",initialize:function(){this.addListeners({"Common.Views.Draw":{"draw:select":_.bind(this.onSelect,this),"draw:eraser":_.bind(this.onEraser,this),"draw:pen":_.bind(this.onDrawPen,this),"draw:size":_.bind(this.onDrawSizeClick,this),"draw:color":_.bind(this.onDrawColorClick,this)}})},onLaunch:function(){this._state={},Common.NotificationCenter.on("app:ready",this.onAppReady.bind(this)),Common.NotificationCenter.on("api:disconnect",_.bind(this.onCoAuthoringDisconnect,this))},setConfig:function(t,e){this.setApi(e),t&&(this.sdkViewName=t.sdkviewname||this.sdkViewName)},setApi:function(t){return t&&(this.api=t,this.api.asc_registerCallback("asc_onInkDrawerStop",_.bind(this.onInkDrawerStop,this)),this.api.asc_registerCallback("asc_onCoAuthoringDisconnect",_.bind(this.onCoAuthoringDisconnect,this))),this},setMode:function(t){return this.appConfig=t,this.view=this.createView("Common.Views.Draw",{mode:t}),this},SetDisabled:function(t){this.view&&this.view.SetDisabled(t)},onInkDrawerStop:function(){this.view&&this.view.depressButtons()},onSelect:function(t){this.api&&this.api.asc_StopInkDrawer(),Common.NotificationCenter.trigger("edit:complete",this.view)},onEraser:function(t){this.api&&(t.pressed?(this.view.depressButtons(t),this.api.asc_StartInkEraser(),Common.NotificationCenter.trigger("draw:start",this.view)):this.api.asc_StopInkDrawer())},onDrawPen:function(t){var e;this.api&&(t.pressed?(this.view.depressButtons(t),t=t.options.penOptions,(e=new Asc.asc_CStroke).put_type(Asc.c_oAscStrokeType.STROKE_COLOR),e.put_color(Common.Utils.ThemeColor.getRgbColor(t.color)),e.asc_putPrstDash(Asc.c_oDashType.solid),e.put_width(t.size.arr[t.size.idx]),e.put_transparent(2.55*t.opacity),this.api.asc_StartDrawInk(e,t.idx),Common.NotificationCenter.trigger("draw:start",this.view)):this.api.asc_StopInkDrawer())},onDrawSizeClick:function(t,e){t.pressed||(t.toggle(!0,!0),this.view&&this.view.depressButtons(t));var i=t.options.penOptions;i.size.idx="up"===e?Math.min(i.size.idx+1,i.size.arr.length-1):Math.max(i.size.idx-1,0),this.view&&this.view.updateButtonHint(t),this.onDrawPen(t)},onDrawColorClick:function(t,e){t.pressed||(t.toggle(!0,!0),this.view&&this.view.depressButtons(t)),t.options.penOptions.color=e,this.view&&this.view.updateButtonHint(t),this.onDrawPen(t)},createToolbarPanel:function(t){return this.view.getPanel(t)},getView:function(t){return!t&&this.view?this.view:Backbone.Controller.prototype.getView.call(this,t)},onAppReady:function(t){new Promise(function(t,e){t()}).then(function(){})},onCoAuthoringDisconnect:function(){this.SetDisabled(!0)}},Common.Controllers.Draw||{}))}),require.config({baseUrl:"../../",paths:{jquery:"../vendor/jquery/jquery",underscore:"../vendor/underscore/underscore",backbone:"../vendor/backbone/backbone",bootstrap:"../vendor/bootstrap/dist/js/bootstrap",text:"../vendor/requirejs-text/text",perfectscrollbar:"common/main/lib/mods/perfect-scrollbar",jmousewheel:"../vendor/perfect-scrollbar/src/jquery.mousewheel",xregexp:"../vendor/xregexp/xregexp-all-min",socketio:"../vendor/socketio/socket.io.min",allfonts:"../../sdkjs/common/AllFonts",sdk:"../../sdkjs/cell/sdk-all-min",api:"api/documents/api",core:"common/main/lib/core/application",notification:"common/main/lib/core/NotificationCenter",keymaster:"common/main/lib/core/keymaster",tip:"common/main/lib/util/Tip",localstorage:"common/main/lib/util/LocalStorage",analytics:"common/Analytics",gateway:"common/Gateway",locale:"common/locale",irregularstack:"common/IrregularStack"},shim:{underscore:{exports:"_"},backbone:{deps:["underscore","jquery"],exports:"Backbone"},bootstrap:{deps:["jquery"]},perfectscrollbar:{deps:["jmousewheel"]},notification:{deps:["backbone"]},core:{deps:["backbone","notification","irregularstack"]},sdk:{deps:["jquery","allfonts","xregexp"]},gateway:{deps:["jquery"]},analytics:{deps:["jquery"]}}}),require(["spreadsheeteditor/main/locale/zh.json","themeinit","htmlutils","backbone","bootstrap","core","analytics","gateway","locale","device_scale"],function(t,e,i,s,o,n){var a;s.History&&s.History.started||(s.history.start(),a=new s.Application({nameSpace:"SSE",autoCreate:!1,controllers:["Viewport","DocumentHolder","CellEditor","FormulaDialog","Print","Toolbar","Statusbar","RightMenu","LeftMenu","Spellcheck","Main","PivotTable","DataTab","ViewTab","Search","WBProtection","Common.Controllers.Fonts","Common.Controllers.History","Common.Controllers.Chat","Common.Controllers.Draw","Common.Controllers.Plugins","Common.Controllers.ExternalOleEditor","Common.Controllers.ReviewChanges","Common.Controllers.Protection"]}),Common.Locale.apply(function(){require(["common/main/lib/util/LocalStorage","common/main/lib/controller/Scaling","common/main/lib/controller/Themes","common/main/lib/controller/Desktop","spreadsheeteditor/main/app/controller/Viewport","spreadsheeteditor/main/app/controller/DocumentHolder","spreadsheeteditor/main/app/controller/CellEditor","spreadsheeteditor/main/app/controller/Toolbar","spreadsheeteditor/main/app/controller/Statusbar","spreadsheeteditor/main/app/controller/RightMenu","spreadsheeteditor/main/app/controller/LeftMenu","spreadsheeteditor/main/app/controller/Spellcheck","spreadsheeteditor/main/app/controller/Main","spreadsheeteditor/main/app/controller/Print","spreadsheeteditor/main/app/controller/PivotTable","spreadsheeteditor/main/app/controller/DataTab","spreadsheeteditor/main/app/controller/ViewTab","spreadsheeteditor/main/app/controller/Search","spreadsheeteditor/main/app/controller/WBProtection","spreadsheeteditor/main/app/view/FileMenuPanels","spreadsheeteditor/main/app/view/ParagraphSettings","spreadsheeteditor/main/app/view/ImageSettings","spreadsheeteditor/main/app/view/ChartSettings","spreadsheeteditor/main/app/view/ShapeSettings","spreadsheeteditor/main/app/view/TextArtSettings","spreadsheeteditor/main/app/view/PivotSettings","spreadsheeteditor/main/app/view/FieldSettingsDialog","spreadsheeteditor/main/app/view/ValueFieldSettingsDialog","spreadsheeteditor/main/app/view/SignatureSettings","common/main/lib/util/utils","common/main/lib/controller/Fonts","common/main/lib/controller/History","common/main/lib/collection/Users","common/main/lib/controller/Chat","common/main/lib/controller/Plugins","common/main/lib/controller/ExternalOleEditor","common/main/lib/controller/ReviewChanges","common/main/lib/controller/Protection","common/main/lib/controller/Draw"],function(){a.start()})},t))},function(t){"timeout"==t.requireType&&!reqerr&&window.requireTimeourError&&(reqerr=window.requireTimeourError(),window.alert(reqerr),window.location.reload())}),define("../apps/spreadsheeteditor/main/app.js",function(){});