/*!
 * Copyright (c) Ascensio System SIA 2024. All rights reserved
 * Version: 7.4.1 (build:1)
 */
function getUrlParams(){function t(t){return decodeURIComponent(t.replace(i," "))}for(var e,i=/\+/g,n=/([^&=]+)=?([^&]*)/g,o=window.location.search.substring(1),s={};e=n.exec(o);)s[t(e[1])]=t(e[2]);return s}function encodeUrlParam(t){return t.replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}define("documenteditor/main/locale/zh.json",{"Common.Controllers.Chat.notcriticalErrorTitle":"警告","Common.Controllers.Chat.textEnterMessage":"在这里输入你的信息","Common.Controllers.ExternalDiagramEditor.textAnonymous":"匿名","Common.Controllers.ExternalDiagramEditor.textClose":"关闭","Common.Controllers.ExternalDiagramEditor.warningText":"该对象被禁用，因为它被另一个用户编辑。","Common.Controllers.ExternalDiagramEditor.warningTitle":"警告","Common.Controllers.ExternalMergeEditor.textAnonymous":"匿名","Common.Controllers.ExternalMergeEditor.textClose":"关闭","Common.Controllers.ExternalMergeEditor.warningText":"该对象被禁用，因为它被另一个用户编辑。","Common.Controllers.ExternalMergeEditor.warningTitle":"警告","Common.Controllers.ExternalOleEditor.textAnonymous":"匿名用户","Common.Controllers.ExternalOleEditor.textClose":"关闭","Common.Controllers.ExternalOleEditor.warningText":"该对象被禁用，因为它在被另一个用户编辑。","Common.Controllers.ExternalOleEditor.warningTitle":"警告","Common.Controllers.History.notcriticalErrorTitle":"警告","Common.Controllers.ReviewChanges.textAcceptBeforeCompare":"为了比较文件，文件中所有跟踪的更改都将被视为已被接受。你想继续吗？","Common.Controllers.ReviewChanges.textAtLeast":"至少","Common.Controllers.ReviewChanges.textAuto":"自动","Common.Controllers.ReviewChanges.textBaseline":"基线","Common.Controllers.ReviewChanges.textBold":"加粗","Common.Controllers.ReviewChanges.textBreakBefore":"段前分页","Common.Controllers.ReviewChanges.textCaps":"全部大写字母","Common.Controllers.ReviewChanges.textCenter":"居中对齐","Common.Controllers.ReviewChanges.textChar":"字符级别","Common.Controllers.ReviewChanges.textChart":"图表","Common.Controllers.ReviewChanges.textColor":"字体颜色","Common.Controllers.ReviewChanges.textContextual":"不要在相同样式的段落之间添加间隔","Common.Controllers.ReviewChanges.textDeleted":"<b>已删除</b>","Common.Controllers.ReviewChanges.textDStrikeout":"双击","Common.Controllers.ReviewChanges.textEquation":"公式","Common.Controllers.ReviewChanges.textExact":"精确地","Common.Controllers.ReviewChanges.textFirstLine":"第一行","Common.Controllers.ReviewChanges.textFontSize":"字号","Common.Controllers.ReviewChanges.textFormatted":"格式化","Common.Controllers.ReviewChanges.textHighlight":"颜色高亮","Common.Controllers.ReviewChanges.textImage":"图片","Common.Controllers.ReviewChanges.textIndentLeft":"左缩进","Common.Controllers.ReviewChanges.textIndentRight":"右缩进","Common.Controllers.ReviewChanges.textInserted":"<b>插入：</b>","Common.Controllers.ReviewChanges.textItalic":"斜体","Common.Controllers.ReviewChanges.textJustify":"两端对齐","Common.Controllers.ReviewChanges.textKeepLines":"段中不分页","Common.Controllers.ReviewChanges.textKeepNext":"与下段同页","Common.Controllers.ReviewChanges.textLeft":"左对齐","Common.Controllers.ReviewChanges.textLineSpacing":"行间距：","Common.Controllers.ReviewChanges.textMultiple":"多倍行距","Common.Controllers.ReviewChanges.textNoBreakBefore":"段前无分页","Common.Controllers.ReviewChanges.textNoContextual":"在相同样式的段落之间添加间隔","Common.Controllers.ReviewChanges.textNoKeepLines":"不要保持一行","Common.Controllers.ReviewChanges.textNoKeepNext":"不要跟着下一个","Common.Controllers.ReviewChanges.textNot":"不","Common.Controllers.ReviewChanges.textNoWidow":"没有单独控制","Common.Controllers.ReviewChanges.textNum":"更改编号","Common.Controllers.ReviewChanges.textOff":"{0} 已停用“跟踪修改”","Common.Controllers.ReviewChanges.textOffGlobal":"{0} 为所有人关闭“跟踪修改”","Common.Controllers.ReviewChanges.textOn":"{0} 正在使用“跟踪修改”","Common.Controllers.ReviewChanges.textOnGlobal":"{0} 为所有人启动“跟踪修改”","Common.Controllers.ReviewChanges.textParaDeleted":"<b>段落已删除</b>","Common.Controllers.ReviewChanges.textParaFormatted":"段落格式化","Common.Controllers.ReviewChanges.textParaInserted":"<b>段落插入</b>","Common.Controllers.ReviewChanges.textParaMoveFromDown":"<b>已下移</b>","Common.Controllers.ReviewChanges.textParaMoveFromUp":"<b>已上移</b>","Common.Controllers.ReviewChanges.textParaMoveTo":"<b>已移动</b>","Common.Controllers.ReviewChanges.textPosition":"位置","Common.Controllers.ReviewChanges.textRight":"右对齐","Common.Controllers.ReviewChanges.textShape":"形状","Common.Controllers.ReviewChanges.textShd":"背景颜色","Common.Controllers.ReviewChanges.textShow":"显示更改在","Common.Controllers.ReviewChanges.textSmallCaps":"小型大写字母","Common.Controllers.ReviewChanges.textSpacing":"间距","Common.Controllers.ReviewChanges.textSpacingAfter":"间隔","Common.Controllers.ReviewChanges.textSpacingBefore":"之前的距离","Common.Controllers.ReviewChanges.textStrikeout":"删除线","Common.Controllers.ReviewChanges.textSubScript":"下标","Common.Controllers.ReviewChanges.textSuperScript":"上标","Common.Controllers.ReviewChanges.textTableChanged":"<b>表格设置已更改</b>","Common.Controllers.ReviewChanges.textTableRowsAdd":"<b>表格行已添加</b>","Common.Controllers.ReviewChanges.textTableRowsDel":"<b>表格行已删除</b>","Common.Controllers.ReviewChanges.textTabs":"更改选项卡","Common.Controllers.ReviewChanges.textTitleComparison":"比较设置","Common.Controllers.ReviewChanges.textUnderline":"下划线","Common.Controllers.ReviewChanges.textUrl":"粘贴文档URL","Common.Controllers.ReviewChanges.textWidow":"视窗控制","Common.Controllers.ReviewChanges.textWord":"字级","Common.define.chartData.textArea":"面积图","Common.define.chartData.textAreaStacked":"堆积面积图","Common.define.chartData.textAreaStackedPer":"百分比堆积面积图","Common.define.chartData.textBar":"条形图","Common.define.chartData.textBarNormal":"簇状柱形图","Common.define.chartData.textBarNormal3d":"三维簇状柱形图","Common.define.chartData.textBarNormal3dPerspective":"三维柱形图","Common.define.chartData.textBarStacked":"堆积柱形图","Common.define.chartData.textBarStacked3d":"三维堆积柱形图","Common.define.chartData.textBarStackedPer":"百分比堆积柱形图","Common.define.chartData.textBarStackedPer3d":"三维百分比堆积柱形图","Common.define.chartData.textCharts":"流程图","Common.define.chartData.textColumn":"柱形图","Common.define.chartData.textCombo":"组合图","Common.define.chartData.textComboAreaBar":"堆积面积图 - 簇状柱形图","Common.define.chartData.textComboBarLine":"簇状柱形图 - 折线图","Common.define.chartData.textComboBarLineSecondary":"簇状柱形图 - 次坐标轴上的折线图","Common.define.chartData.textComboCustom":"自定义组合","Common.define.chartData.textDoughnut":"圆环图","Common.define.chartData.textHBarNormal":"簇状条形图","Common.define.chartData.textHBarNormal3d":"三维簇状条形图","Common.define.chartData.textHBarStacked":"堆积条形图","Common.define.chartData.textHBarStacked3d":"三维堆积条形图","Common.define.chartData.textHBarStackedPer":"百分比堆积条形图","Common.define.chartData.textHBarStackedPer3d":"三维百分比堆积条形图","Common.define.chartData.textLine":"折线图","Common.define.chartData.textLine3d":"三维折线图","Common.define.chartData.textLineMarker":"带数据标记的折线图","Common.define.chartData.textLineStacked":"堆积折线图","Common.define.chartData.textLineStackedMarker":"带数据标记的堆积折线图","Common.define.chartData.textLineStackedPer":"百分比堆积折线图","Common.define.chartData.textLineStackedPerMarker":"带数据标记的百分比堆积折线图","Common.define.chartData.textPie":"饼图","Common.define.chartData.textPie3d":"三维饼图","Common.define.chartData.textPoint":"散点图","Common.define.chartData.textRadar":"雷达图","Common.define.chartData.textRadarFilled":"填充雷达图","Common.define.chartData.textRadarMarker":"带数据标记的雷达图","Common.define.chartData.textScatter":"散点图​​","Common.define.chartData.textScatterLine":"带直线的散点图","Common.define.chartData.textScatterLineMarker":"带直线和数据标记的散点图","Common.define.chartData.textScatterSmooth":"带平滑线的散点图","Common.define.chartData.textScatterSmoothMarker":"带平滑线和数据标记的散点图","Common.define.chartData.textStock":"股价图","Common.define.chartData.textSurface":"平面","Common.define.smartArt.textAccentedPicture":"重音图片","Common.define.smartArt.textAccentProcess":"重点流程","Common.define.smartArt.textAlternatingFlow":"交替流","Common.define.smartArt.textAlternatingHexagons":"交替六边形","Common.define.smartArt.textAlternatingPictureBlocks":"交替图片块","Common.define.smartArt.textAlternatingPictureCircles":"交替图片圆形","Common.define.smartArt.textArchitectureLayout":"结构布局","Common.define.smartArt.textArrowRibbon":"带形箭头","Common.define.smartArt.textAscendingPictureAccentProcess":"升序图片重点流程","Common.define.smartArt.textBalance":"平衡","Common.define.smartArt.textBasicBendingProcess":"基本蛇形流程","Common.define.smartArt.textBasicBlockList":"基本列表","Common.define.smartArt.textBasicChevronProcess":"基本 V 形流程","Common.define.smartArt.textBasicCycle":"基本循环","Common.define.smartArt.textBasicMatrix":"基本矩阵","Common.define.smartArt.textBasicPie":"基本饼图","Common.define.smartArt.textBasicProcess":"基本流程","Common.define.smartArt.textBasicPyramid":"基本棱锥图","Common.define.smartArt.textBasicRadial":"基本射线图","Common.define.smartArt.textBasicTarget":"基本目标图","Common.define.smartArt.textBasicTimeline":"基本时间线","Common.define.smartArt.textBasicVenn":"基本维恩图","Common.define.smartArt.textBendingPictureAccentList":"蛇形图片重点列表","Common.define.smartArt.textBendingPictureBlocks":"蛇形图片块","Common.define.smartArt.textBendingPictureCaption":"蛇形图片题注","Common.define.smartArt.textBendingPictureCaptionList":"蛇形图片题注列表","Common.define.smartArt.textBendingPictureSemiTranparentText":"蛇形图片半透明文本","Common.define.smartArt.textBlockCycle":"块循环","Common.define.smartArt.textBubblePictureList":"气泡图片列表","Common.define.smartArt.textCaptionedPictures":"题注图片","Common.define.smartArt.textChevronAccentProcess":"V 形重点流程","Common.define.smartArt.textChevronList":"V 型列表","Common.define.smartArt.textCircleAccentTimeline":"圆形重点日程表","Common.define.smartArt.textCircleArrowProcess":"圆箭头流程","Common.define.smartArt.textCirclePictureHierarchy":"圆形图片层次结构","Common.define.smartArt.textCircleProcess":"循环流程","Common.define.smartArt.textCircleRelationship":"循环关系","Common.define.smartArt.textCircularBendingProcess":"环状蛇形流程","Common.define.smartArt.textCircularPictureCallout":"圆形图片标注","Common.define.smartArt.textClosedChevronProcess":"闭合 V 形流程","Common.define.smartArt.textContinuousArrowProcess":"连续箭头流程","Common.define.smartArt.textContinuousBlockProcess":"连续块状流程","Common.define.smartArt.textContinuousCycle":"连续循环","Common.define.smartArt.textContinuousPictureList":"连续图片列表","Common.define.smartArt.textConvergingArrows":"汇聚箭头","Common.define.smartArt.textConvergingRadial":"聚合射线","Common.define.smartArt.textConvergingText":"聚合文本","Common.define.smartArt.textCounterbalanceArrows":"平衡箭头","Common.define.smartArt.textCycle":"循环","Common.define.smartArt.textCycleMatrix":"循环矩阵","Common.define.smartArt.textDescendingBlockList":"降序块列表","Common.define.smartArt.textDescendingProcess":"降序流程","Common.define.smartArt.textDetailedProcess":"详细流程","Common.define.smartArt.textDivergingArrows":"分叉箭头","Common.define.smartArt.textDivergingRadial":"分离射线","Common.define.smartArt.textEquation":"公式","Common.define.smartArt.textFramedTextPicture":"带框架的文本图片","Common.define.smartArt.textFunnel":"漏斗","Common.define.smartArt.textGear":"齿轮","Common.define.smartArt.textGridMatrix":"网格矩阵","Common.define.smartArt.textGroupedList":"分组列表","Common.define.smartArt.textHalfCircleOrganizationChart":"半圆组织结构图","Common.define.smartArt.textHexagonCluster":"六边形群集","Common.define.smartArt.textHexagonRadial":"放射状六边形","Common.define.smartArt.textHierarchy":"层次结构","Common.define.smartArt.textHierarchyList":"层次结构列表","Common.define.smartArt.textHorizontalBulletList":"水平项目符号列表","Common.define.smartArt.textHorizontalHierarchy":"水平层次结构","Common.define.smartArt.textHorizontalLabeledHierarchy":"水平标记的层次结构","Common.define.smartArt.textHorizontalMultiLevelHierarchy":"水平多层层次结构","Common.define.smartArt.textHorizontalOrganizationChart":"水平组织结构图","Common.define.smartArt.textHorizontalPictureList":"水平图片列表","Common.define.smartArt.textIncreasingArrowProcess":"递增箭头流程","Common.define.smartArt.textIncreasingCircleProcess":"递增循环流程","Common.define.smartArt.textInterconnectedBlockProcess":"互联块流程","Common.define.smartArt.textInterconnectedRings":"互联环","Common.define.smartArt.textInvertedPyramid":"倒棱锥图","Common.define.smartArt.textLabeledHierarchy":"标记的层次结构","Common.define.smartArt.textLinearVenn":"线性维恩图","Common.define.smartArt.textLinedList":"线型列表","Common.define.smartArt.textList":"列表","Common.define.smartArt.textMatrix":"矩阵","Common.define.smartArt.textMultidirectionalCycle":"多向循环","Common.define.smartArt.textNameAndTitleOrganizationChart":"姓名和职务组织结构图","Common.define.smartArt.textNestedTarget":"嵌套目标图","Common.define.smartArt.textNondirectionalCycle":"不定向循环","Common.define.smartArt.textOpposingArrows":"反向箭头","Common.define.smartArt.textOpposingIdeas":"对立观点","Common.define.smartArt.textOrganizationChart":"组织结构图","Common.define.smartArt.textOther":"其他","Common.define.smartArt.textPhasedProcess":"分阶段流程","Common.define.smartArt.textPicture":"图片","Common.define.smartArt.textPictureAccentBlocks":"图片重点块","Common.define.smartArt.textPictureAccentList":"图片重点列表","Common.define.smartArt.textPictureAccentProcess":"图片重点流程","Common.define.smartArt.textPictureCaptionList":"图片题注列表","Common.define.smartArt.textPictureFrame":"图片框","Common.define.smartArt.textPictureGrid":"图片网格","Common.define.smartArt.textPictureLineup":"图片排列","Common.define.smartArt.textPictureOrganizationChart":"图片组织结构图","Common.define.smartArt.textPictureStrips":"图片条纹","Common.define.smartArt.textPieProcess":"饼图流程","Common.define.smartArt.textPlusAndMinus":"加号和减号","Common.define.smartArt.textProcess":"流程","Common.define.smartArt.textProcessArrows":"流程箭头","Common.define.smartArt.textProcessList":"流程列表","Common.define.smartArt.textPyramid":"棱锥型","Common.define.smartArt.textPyramidList":"棱锥型列表","Common.define.smartArt.textRadialCluster":"射线群集","Common.define.smartArt.textRadialCycle":"射线循环","Common.define.smartArt.textRadialList":"射线列表","Common.define.smartArt.textRadialPictureList":"放射状图片列表","Common.define.smartArt.textRadialVenn":"射线维恩图","Common.define.smartArt.textRandomToResultProcess":"随机至结果流程","Common.define.smartArt.textRelationship":"关系","Common.define.smartArt.textRepeatingBendingProcess":"重复蛇形流程","Common.define.smartArt.textReverseList":"反转列表","Common.define.smartArt.textSegmentedCycle":"分段循环","Common.define.smartArt.textSegmentedProcess":"分段流程","Common.define.smartArt.textSegmentedPyramid":"分段棱锥图","Common.define.smartArt.textSnapshotPictureList":"快照图片列表","Common.define.smartArt.textSpiralPicture":"螺旋图","Common.define.smartArt.textSquareAccentList":"方形重点列表","Common.define.smartArt.textStackedList":"堆叠列表","Common.define.smartArt.textStackedVenn":"堆叠维恩图","Common.define.smartArt.textStaggeredProcess":"交错流程","Common.define.smartArt.textStepDownProcess":"步骤下移流程","Common.define.smartArt.textStepUpProcess":"升级流程","Common.define.smartArt.textSubStepProcess":"子步骤流程","Common.define.smartArt.textTabbedArc":"拱状","Common.define.smartArt.textTableHierarchy":"表层次结构","Common.define.smartArt.textTableList":"表格列表","Common.define.smartArt.textTabList":"选项卡列表","Common.define.smartArt.textTargetList":"目标图列表","Common.define.smartArt.textTextCycle":"文本循环","Common.define.smartArt.textThemePictureAccent":"主题图片重点","Common.define.smartArt.textThemePictureAlternatingAccent":"主题图片交替重点","Common.define.smartArt.textThemePictureGrid":"主题图片网格","Common.define.smartArt.textTitledMatrix":"带标题的矩阵","Common.define.smartArt.textTitledPictureAccentList":"标题图片重点列表","Common.define.smartArt.textTitledPictureBlocks":"标题图片块","Common.define.smartArt.textTitlePictureLineup":"标题图片排列","Common.define.smartArt.textTrapezoidList":"梯形列表","Common.define.smartArt.textUpwardArrow":"向上箭头","Common.define.smartArt.textVaryingWidthList":"不同宽度列表","Common.define.smartArt.textVerticalAccentList":"垂直重点列表","Common.define.smartArt.textVerticalArrowList":"垂直箭头列表","Common.define.smartArt.textVerticalBendingProcess":"垂直蛇形流程","Common.define.smartArt.textVerticalBlockList":"垂直块列表","Common.define.smartArt.textVerticalBoxList":"垂直框列表","Common.define.smartArt.textVerticalBracketList":"垂直括弧列表","Common.define.smartArt.textVerticalBulletList":"垂直项目符号列表","Common.define.smartArt.textVerticalChevronList":"垂直 V 形列表","Common.define.smartArt.textVerticalCircleList":"垂直圆形列表","Common.define.smartArt.textVerticalCurvedList":"垂直曲形列表","Common.define.smartArt.textVerticalEquation":"垂直公式","Common.define.smartArt.textVerticalPictureAccentList":"垂直图片重点列表","Common.define.smartArt.textVerticalPictureList":"垂直图片列表","Common.define.smartArt.textVerticalProcess":"垂直流程","Common.Translation.textMoreButton":"更多","Common.Translation.tipFileLocked":"文件被锁定，无法编辑。您可以进行修改并将其另存为本地副本。","Common.Translation.tipFileReadOnly":"该文件具有只读权限。若要保存，请重新命名或在不同的位置保存该文件。","Common.Translation.warnFileLocked":"您不能编辑此文件，因为它正在另一个应用程序中被编辑。","Common.Translation.warnFileLockedBtnEdit":"建立副本","Common.Translation.warnFileLockedBtnView":"以浏览模式打开","Common.UI.ButtonColored.textAutoColor":"自动","Common.UI.ButtonColored.textEyedropper":"取色器","Common.UI.ButtonColored.textNewColor":"更多颜色","Common.UI.Calendar.textApril":"四月","Common.UI.Calendar.textAugust":"八月","Common.UI.Calendar.textDecember":"十二月","Common.UI.Calendar.textFebruary":"二月","Common.UI.Calendar.textJanuary":"一月","Common.UI.Calendar.textJuly":"七月","Common.UI.Calendar.textJune":"六月","Common.UI.Calendar.textMarch":"三月","Common.UI.Calendar.textMay":"五月","Common.UI.Calendar.textMonths":"月","Common.UI.Calendar.textNovember":"十一月","Common.UI.Calendar.textOctober":"十月","Common.UI.Calendar.textSeptember":"九月","Common.UI.Calendar.textShortApril":"四月","Common.UI.Calendar.textShortAugust":"八月","Common.UI.Calendar.textShortDecember":"十二月","Common.UI.Calendar.textShortFebruary":"二月","Common.UI.Calendar.textShortFriday":"周五","Common.UI.Calendar.textShortJanuary":"一月","Common.UI.Calendar.textShortJuly":"七月","Common.UI.Calendar.textShortJune":"六月","Common.UI.Calendar.textShortMarch":"三月","Common.UI.Calendar.textShortMay":"五月","Common.UI.Calendar.textShortMonday":"周一","Common.UI.Calendar.textShortNovember":"十一月","Common.UI.Calendar.textShortOctober":"十月","Common.UI.Calendar.textShortSaturday":"周六","Common.UI.Calendar.textShortSeptember":"九月","Common.UI.Calendar.textShortSunday":"周日","Common.UI.Calendar.textShortThursday":"周四","Common.UI.Calendar.textShortTuesday":"周二","Common.UI.Calendar.textShortWednesday":"周三","Common.UI.Calendar.textYears":"年","Common.UI.ComboBorderSize.txtNoBorders":"无边框","Common.UI.ComboBorderSizeEditable.txtNoBorders":"无边框","Common.UI.ComboDataView.emptyComboText":"没有风格","Common.UI.ExtendedColorDialog.addButtonText":"确定","Common.UI.ExtendedColorDialog.textCurrent":"当前","Common.UI.ExtendedColorDialog.textHexErr":"输入的值不正确。<br>请输入000000和FFFFFF之间的值。","Common.UI.ExtendedColorDialog.textNew":"新","Common.UI.ExtendedColorDialog.textRGBErr":"输入的值不正确。<br>请输入介于0和255之间的数值。","Common.UI.HSBColorPicker.textNoColor":"没有颜色","Common.UI.InputFieldBtnCalendar.textDate":"选择日期","Common.UI.InputFieldBtnPassword.textHintHidePwd":"隐藏密码","Common.UI.InputFieldBtnPassword.textHintShowPwd":"显示密码","Common.UI.SearchBar.textFind":"查找内容","Common.UI.SearchBar.tipCloseSearch":"关闭搜索","Common.UI.SearchBar.tipNextResult":"下一个","Common.UI.SearchBar.tipOpenAdvancedSettings":"打开高级设置","Common.UI.SearchBar.tipPreviousResult":"上一个","Common.UI.SearchDialog.textHighlight":"高亮效果","Common.UI.SearchDialog.textMatchCase":"区分大小写","Common.UI.SearchDialog.textReplaceDef":"输入替换文字","Common.UI.SearchDialog.textSearchStart":"在这里输入你的文字","Common.UI.SearchDialog.textTitle":"查找和替换","Common.UI.SearchDialog.textTitle2":"查找","Common.UI.SearchDialog.textWholeWords":"全字匹配","Common.UI.SearchDialog.txtBtnHideReplace":"隐藏替换","Common.UI.SearchDialog.txtBtnReplace":"替换","Common.UI.SearchDialog.txtBtnReplaceAll":"全部替换","Common.UI.SynchronizeTip.textDontShow":"不要再显示此消息","Common.UI.SynchronizeTip.textSynchronize":"该文档已被其他用户更改。<br>请点击保存更改并重新加载更新。","Common.UI.ThemeColorPalette.textRecentColors":"最近的颜色","Common.UI.ThemeColorPalette.textStandartColors":"标准色","Common.UI.ThemeColorPalette.textThemeColors":"主题颜色","Common.UI.ThemeColorPalette.textTransparent":"透明","Common.UI.Themes.txtThemeClassicLight":"经典浅色","Common.UI.Themes.txtThemeContrastDark":"深色对比","Common.UI.Themes.txtThemeDark":"深色","Common.UI.Themes.txtThemeLight":"浅色","Common.UI.Themes.txtThemeSystem":"和系统一致","Common.UI.Window.cancelButtonText":"取消","Common.UI.Window.closeButtonText":"关闭","Common.UI.Window.noButtonText":"否","Common.UI.Window.okButtonText":"确定","Common.UI.Window.textConfirmation":"确认","Common.UI.Window.textDontShow":"不要再显示此消息","Common.UI.Window.textError":"错误","Common.UI.Window.textInformation":"信息","Common.UI.Window.textWarning":"警告","Common.UI.Window.yesButtonText":"是","Common.Utils.Metric.txtCm":"厘米","Common.Utils.Metric.txtPt":"像素","Common.Utils.String.textAlt":"Alt","Common.Utils.String.textCtrl":"Ctrl","Common.Utils.String.textShift":"Shift","Common.Utils.ThemeColor.txtaccent":"强调","Common.Utils.ThemeColor.txtAqua":"水绿色","Common.Utils.ThemeColor.txtbackground":"背景","Common.Utils.ThemeColor.txtBlack":"黑色","Common.Utils.ThemeColor.txtBlue":"蓝色","Common.Utils.ThemeColor.txtBrightGreen":"鲜绿色","Common.Utils.ThemeColor.txtBrown":"棕色","Common.Utils.ThemeColor.txtDarkBlue":"深蓝色","Common.Utils.ThemeColor.txtDarker":"深色","Common.Utils.ThemeColor.txtDarkGray":"深灰色","Common.Utils.ThemeColor.txtDarkGreen":"深绿色","Common.Utils.ThemeColor.txtDarkPurple":"深紫色","Common.Utils.ThemeColor.txtDarkRed":"深红色","Common.Utils.ThemeColor.txtDarkTeal":"深青色","Common.Utils.ThemeColor.txtDarkYellow":"深黄色","Common.Utils.ThemeColor.txtGold":"金色","Common.Utils.ThemeColor.txtGray":"灰色","Common.Utils.ThemeColor.txtGreen":"绿色","Common.Utils.ThemeColor.txtIndigo":"靛蓝色","Common.Utils.ThemeColor.txtLavender":"淡紫色","Common.Utils.ThemeColor.txtLightBlue":"浅蓝色","Common.Utils.ThemeColor.txtLighter":"淡色","Common.Utils.ThemeColor.txtLightGray":"浅灰色","Common.Utils.ThemeColor.txtLightGreen":"浅绿色","Common.Utils.ThemeColor.txtLightOrange":"浅橙色","Common.Utils.ThemeColor.txtLightYellow":"浅黄色","Common.Utils.ThemeColor.txtOrange":"橙色","Common.Utils.ThemeColor.txtPink":"粉色","Common.Utils.ThemeColor.txtPurple":"紫色","Common.Utils.ThemeColor.txtRed":"红色","Common.Utils.ThemeColor.txtRose":"玫瑰色","Common.Utils.ThemeColor.txtSkyBlue":"天蓝色","Common.Utils.ThemeColor.txtTeal":"青色","Common.Utils.ThemeColor.txttext":"文本","Common.Utils.ThemeColor.txtTurquosie":"青绿色","Common.Utils.ThemeColor.txtViolet":"紫罗兰色","Common.Utils.ThemeColor.txtWhite":"白色","Common.Utils.ThemeColor.txtYellow":"黄色","Common.Views.About.txtAddress":"地址：","Common.Views.About.txtLicensee":"被许可人","Common.Views.About.txtLicensor":"许可","Common.Views.About.txtMail":"电子邮件：","Common.Views.About.txtPoweredBy":"技术支持","Common.Views.About.txtTel":"电话：","Common.Views.About.txtVersion":"版本","Common.Views.AutoCorrectDialog.textAdd":"新增","Common.Views.AutoCorrectDialog.textApplyText":"输入时自动应用","Common.Views.AutoCorrectDialog.textAutoCorrect":"自动修正","Common.Views.AutoCorrectDialog.textAutoFormat":"输入时自动调整格式","Common.Views.AutoCorrectDialog.textBulleted":"自动项目符号列表","Common.Views.AutoCorrectDialog.textBy":"依据","Common.Views.AutoCorrectDialog.textDelete":"删除","Common.Views.AutoCorrectDialog.textDoubleSpaces":"按两下空白键自动增加一个句点(.)符号","Common.Views.AutoCorrectDialog.textFLCells":"表格单元格的首字母大写","Common.Views.AutoCorrectDialog.textFLDont":"在以下条目后不要大写：","Common.Views.AutoCorrectDialog.textFLSentence":"将句子首字母大写","Common.Views.AutoCorrectDialog.textForLangFL":"语言例外:","Common.Views.AutoCorrectDialog.textHyperlink":"带超链接的互联网与网络路径","Common.Views.AutoCorrectDialog.textHyphens":"连带字符（-）改为破折号（-）","Common.Views.AutoCorrectDialog.textMathCorrect":"数学自动修正","Common.Views.AutoCorrectDialog.textNumbered":"自动编号列表","Common.Views.AutoCorrectDialog.textQuotes":"“半角引号”替换为“全角引号”","Common.Views.AutoCorrectDialog.textRecognized":"可识别的函数","Common.Views.AutoCorrectDialog.textRecognizedDesc":"以下表达式被识别为数学公式。这些表达式不会被自动设为斜体。","Common.Views.AutoCorrectDialog.textReplace":"替换","Common.Views.AutoCorrectDialog.textReplaceText":"输入时自动替换","Common.Views.AutoCorrectDialog.textReplaceType":"输入时自动替换文字","Common.Views.AutoCorrectDialog.textReset":"重置","Common.Views.AutoCorrectDialog.textResetAll":"重置为默认","Common.Views.AutoCorrectDialog.textRestore":"恢复","Common.Views.AutoCorrectDialog.textTitle":"自动修正","Common.Views.AutoCorrectDialog.textWarnAddFL":"例外情况必须只包含大写或小写字母。","Common.Views.AutoCorrectDialog.textWarnAddRec":"识别的函数只能包含字母A到Z，大写或小写。","Common.Views.AutoCorrectDialog.textWarnResetFL":"您添加的任何例外将被删除，被删除的例外将被恢复。您想继续吗？","Common.Views.AutoCorrectDialog.textWarnResetRec":"由您新增的表达式将被移除，由您移除的将被恢复。是否继续？","Common.Views.AutoCorrectDialog.warnReplace":"关于％1的自动更正条目已存在。确认替换？","Common.Views.AutoCorrectDialog.warnReset":"即将移除对自动更正功能所做的自定义设置，并恢复默认值。是否继续？","Common.Views.AutoCorrectDialog.warnRestore":"关于％1的自动更正条目将恢复默认值。确认继续？","Common.Views.Chat.textSend":"发送","Common.Views.Comments.mniAuthorAsc":"作者 (A到Z)","Common.Views.Comments.mniAuthorDesc":"作者 (Z到A)","Common.Views.Comments.mniDateAsc":"最老","Common.Views.Comments.mniDateDesc":"最新","Common.Views.Comments.mniFilterGroups":"按组筛选","Common.Views.Comments.mniPositionAsc":"自上而下","Common.Views.Comments.mniPositionDesc":"自下而上","Common.Views.Comments.textAdd":"添加","Common.Views.Comments.textAddComment":"添加批注","Common.Views.Comments.textAddCommentToDoc":"添加批注到文档","Common.Views.Comments.textAddReply":"添加回复","Common.Views.Comments.textAll":"所有","Common.Views.Comments.textAnonym":"游客","Common.Views.Comments.textCancel":"取消","Common.Views.Comments.textClose":"关闭","Common.Views.Comments.textClosePanel":"关闭注释","Common.Views.Comments.textComments":"批注","Common.Views.Comments.textEdit":"确定","Common.Views.Comments.textEnterCommentHint":"在此输入您的批注","Common.Views.Comments.textHintAddComment":"添加批注","Common.Views.Comments.textOpenAgain":"再次打开","Common.Views.Comments.textReply":"回复","Common.Views.Comments.textResolve":"解决","Common.Views.Comments.textResolved":"已解决","Common.Views.Comments.textSort":"评注排序","Common.Views.Comments.textViewResolved":"您没有重开评论的权限","Common.Views.Comments.txtEmpty":"文件中没有任何评论。","Common.Views.CopyWarningDialog.textDontShow":"不要再显示此消息","Common.Views.CopyWarningDialog.textMsg":"使用编辑器工具栏按钮和上下文菜单操作复制，剪切和粘贴操作将仅在此编辑器选项卡中执行。<br> <br>要在编辑器选项卡之外复制或粘贴到应用程序，请使用以下键盘组合：","Common.Views.CopyWarningDialog.textTitle":"复制，剪切和粘贴操作","Common.Views.CopyWarningDialog.textToCopy":"复制","Common.Views.CopyWarningDialog.textToCut":"剪切","Common.Views.CopyWarningDialog.textToPaste":"粘贴","Common.Views.DocumentAccessDialog.textLoading":"载入中……","Common.Views.DocumentAccessDialog.textTitle":"共享设置","Common.Views.Draw.hintEraser":"橡皮擦","Common.Views.Draw.hintSelect":"选择","Common.Views.Draw.txtEraser":"橡皮擦","Common.Views.Draw.txtHighlighter":"荧光笔","Common.Views.Draw.txtMM":"mm","Common.Views.Draw.txtPen":"笔","Common.Views.Draw.txtSelect":"选择","Common.Views.Draw.txtSize":"大小","Common.Views.ExternalDiagramEditor.textTitle":"图表编辑器","Common.Views.ExternalEditor.textClose":"关闭","Common.Views.ExternalEditor.textSave":"保存并退出","Common.Views.ExternalMergeEditor.textTitle":"邮件合并收件人","Common.Views.ExternalOleEditor.textTitle":"电子表格编辑器","Common.Views.Header.labelCoUsersDescr":"正在编辑文件的用户：","Common.Views.Header.textAddFavorite":"记作喜爱内容","Common.Views.Header.textAdvSettings":"高级设置","Common.Views.Header.textBack":"打开文件所在位置","Common.Views.Header.textCompactView":"查看紧凑工具栏","Common.Views.Header.textHideLines":"隐藏标尺","Common.Views.Header.textHideStatusBar":"隐藏状态栏","Common.Views.Header.textReadOnly":"只读","Common.Views.Header.textRemoveFavorite":"从收藏夹中删除","Common.Views.Header.textShare":"共享","Common.Views.Header.textZoom":"放大","Common.Views.Header.tipAccessRights":"管理文档访问权限","Common.Views.Header.tipDownload":"下载文件","Common.Views.Header.tipGoEdit":"编辑当前文件","Common.Views.Header.tipPrint":"打印","Common.Views.Header.tipPrintQuick":"快速打印","Common.Views.Header.tipRedo":"重做","Common.Views.Header.tipSave":"保存","Common.Views.Header.tipSearch":"搜索","Common.Views.Header.tipUndo":"撤消","Common.Views.Header.tipUsers":"查看用户","Common.Views.Header.tipViewSettings":"视图设置","Common.Views.Header.tipViewUsers":"查看用户和管理文档访问权限","Common.Views.Header.txtAccessRights":"更改访问权限","Common.Views.Header.txtRename":"重命名","Common.Views.History.textCloseHistory":"关闭历史记录","Common.Views.History.textHide":"折叠","Common.Views.History.textHideAll":"隐藏详细的更改","Common.Views.History.textRestore":"还原","Common.Views.History.textShow":"扩大","Common.Views.History.textShowAll":"显示详细的更改","Common.Views.History.textVer":"版本","Common.Views.ImageFromUrlDialog.textUrl":"粘贴图片网址：","Common.Views.ImageFromUrlDialog.txtEmpty":"这是必填栏","Common.Views.ImageFromUrlDialog.txtNotUrl":"该字段应该是“http://www.example.com”格式的URL","Common.Views.InsertTableDialog.textInvalidRowsCols":"您需要指定有效的行数和列数。","Common.Views.InsertTableDialog.txtColumns":"列数","Common.Views.InsertTableDialog.txtMaxText":"该字段的最大值为{0}。","Common.Views.InsertTableDialog.txtMinText":"该字段的最小值为{0}。","Common.Views.InsertTableDialog.txtRows":"行数","Common.Views.InsertTableDialog.txtTitle":"插入表格","Common.Views.InsertTableDialog.txtTitleSplit":"拆分单元格","Common.Views.LanguageDialog.labelSelect":"选择文档语言","Common.Views.OpenDialog.closeButtonText":"关闭文件","Common.Views.OpenDialog.txtEncoding":"编码","Common.Views.OpenDialog.txtIncorrectPwd":"密码错误","Common.Views.OpenDialog.txtOpenFile":"输入密码来打开文件","Common.Views.OpenDialog.txtPassword":"密码","Common.Views.OpenDialog.txtPreview":"预览","Common.Views.OpenDialog.txtProtected":"在您输入密码和打开文件后，该文件的当前密码将被重置。","Common.Views.OpenDialog.txtTitle":"选择%1个选项","Common.Views.OpenDialog.txtTitleProtected":"受保护的文件","Common.Views.PasswordDialog.txtDescription":"设置密码以保护此文档","Common.Views.PasswordDialog.txtIncorrectPwd":"确认密码不一致","Common.Views.PasswordDialog.txtPassword":"密码","Common.Views.PasswordDialog.txtRepeat":"重复输入密码","Common.Views.PasswordDialog.txtTitle":"设置密码","Common.Views.PasswordDialog.txtWarning":"警告: 如果丢失或忘记密码，则无法将其恢复。请妥善保存。","Common.Views.PluginDlg.textLoading":"载入中","Common.Views.Plugins.groupCaption":"插件","Common.Views.Plugins.strPlugins":"插件","Common.Views.Plugins.textClosePanel":"关闭插件","Common.Views.Plugins.textLoading":"载入中","Common.Views.Plugins.textStart":"开始","Common.Views.Plugins.textStop":"停止","Common.Views.Protection.hintAddPwd":"使用密码加密","Common.Views.Protection.hintDelPwd":"删除密码","Common.Views.Protection.hintPwd":"修改或删除密码","Common.Views.Protection.hintSignature":"添加数字签名或签名行","Common.Views.Protection.txtAddPwd":"添加密码","Common.Views.Protection.txtChangePwd":"修改密码","Common.Views.Protection.txtDeletePwd":"删除密码","Common.Views.Protection.txtEncrypt":"加密","Common.Views.Protection.txtInvisibleSignature":"添加数字签名","Common.Views.Protection.txtSignature":"签名","Common.Views.Protection.txtSignatureLine":"添加签名行","Common.Views.RecentFiles.txtOpenRecent":"最近打开","Common.Views.RenameDialog.textName":"文件名","Common.Views.RenameDialog.txtInvalidName":"文件名不能包含以下任何字符：","Common.Views.ReviewChanges.hintNext":"下一处修订","Common.Views.ReviewChanges.hintPrev":"上一处修订","Common.Views.ReviewChanges.mniFromFile":"本地文档","Common.Views.ReviewChanges.mniFromStorage":" 存储中的文档","Common.Views.ReviewChanges.mniFromUrl":"在线URL","Common.Views.ReviewChanges.mniSettings":"比较设置","Common.Views.ReviewChanges.strFast":"自动","Common.Views.ReviewChanges.strFastDesc":"自动共同编辑模式，自动保存修改痕迹。","Common.Views.ReviewChanges.strStrict":"手动","Common.Views.ReviewChanges.strStrictDesc":"使用“保存”按钮同步你和其他人的修改。","Common.Views.ReviewChanges.textEnable":"启动","Common.Views.ReviewChanges.textWarnTrackChanges":"对全体有完整控制权的用户，“跟踪修改”功能将会启动。任何人下次打开该文档，“跟踪修改”功能都会保持在启动状态。","Common.Views.ReviewChanges.textWarnTrackChangesTitle":"是否为所有人启动“跟踪修改”？","Common.Views.ReviewChanges.tipAcceptCurrent":"接受此修订","Common.Views.ReviewChanges.tipCoAuthMode":"设置共同编辑模式","Common.Views.ReviewChanges.tipCombine":"将当前文件与另一文件合并","Common.Views.ReviewChanges.tipCommentRem":"移除批注","Common.Views.ReviewChanges.tipCommentRemCurrent":"移除当前批注","Common.Views.ReviewChanges.tipCommentResolve":"解决评论","Common.Views.ReviewChanges.tipCommentResolveCurrent":"解决该评论","Common.Views.ReviewChanges.tipCompare":"将当前文档与另一个文档进行比较","Common.Views.ReviewChanges.tipHistory":"显示历史版本","Common.Views.ReviewChanges.tipRejectCurrent":"拒绝此修订","Common.Views.ReviewChanges.tipReview":"修订","Common.Views.ReviewChanges.tipReviewView":"选择您希望显示更改的模式","Common.Views.ReviewChanges.tipSetDocLang":"设置文档语言","Common.Views.ReviewChanges.tipSetSpelling":"拼写检查","Common.Views.ReviewChanges.tipSharing":"管理文档访问权限","Common.Views.ReviewChanges.txtAccept":"接受","Common.Views.ReviewChanges.txtAcceptAll":"接受所有修订","Common.Views.ReviewChanges.txtAcceptChanges":"接受更改","Common.Views.ReviewChanges.txtAcceptCurrent":"接受此修订","Common.Views.ReviewChanges.txtChat":"聊天","Common.Views.ReviewChanges.txtClose":"关闭","Common.Views.ReviewChanges.txtCoAuthMode":"共同编辑模式","Common.Views.ReviewChanges.txtCombine":"合并","Common.Views.ReviewChanges.txtCommentRemAll":"移除所有批注","Common.Views.ReviewChanges.txtCommentRemCurrent":"移除当前批注","Common.Views.ReviewChanges.txtCommentRemMy":"移除我的批注","Common.Views.ReviewChanges.txtCommentRemMyCurrent":"移除我的当前批注","Common.Views.ReviewChanges.txtCommentRemove":"删除","Common.Views.ReviewChanges.txtCommentResolve":"解决","Common.Views.ReviewChanges.txtCommentResolveAll":"解决所有评论","Common.Views.ReviewChanges.txtCommentResolveCurrent":"解决该评论","Common.Views.ReviewChanges.txtCommentResolveMy":"解决我的评论","Common.Views.ReviewChanges.txtCommentResolveMyCurrent":"解决我当前的评论","Common.Views.ReviewChanges.txtCompare":"比较","Common.Views.ReviewChanges.txtDocLang":"语言","Common.Views.ReviewChanges.txtEditing":"编辑","Common.Views.ReviewChanges.txtFinal":"已接受所有修订{0}","Common.Views.ReviewChanges.txtFinalCap":"最终版","Common.Views.ReviewChanges.txtHistory":"版本历史","Common.Views.ReviewChanges.txtMarkup":"所有更改{0}","Common.Views.ReviewChanges.txtMarkupCap":"标记批注框","Common.Views.ReviewChanges.txtMarkupSimple":"所有修改 {0}<br>无通知","Common.Views.ReviewChanges.txtMarkupSimpleCap":"仅标记","Common.Views.ReviewChanges.txtNext":"下一处修订","Common.Views.ReviewChanges.txtOff":"对我自己关闭","Common.Views.ReviewChanges.txtOffGlobal":"对所有人关闭","Common.Views.ReviewChanges.txtOn":"对我自己启动","Common.Views.ReviewChanges.txtOnGlobal":"对所有人启动","Common.Views.ReviewChanges.txtOriginal":"已拒绝所有修订{0}","Common.Views.ReviewChanges.txtOriginalCap":"原始版","Common.Views.ReviewChanges.txtPrev":"上一处修订","Common.Views.ReviewChanges.txtPreview":"预览","Common.Views.ReviewChanges.txtReject":"拒绝","Common.Views.ReviewChanges.txtRejectAll":"拒绝所有修订","Common.Views.ReviewChanges.txtRejectChanges":"拒绝更改","Common.Views.ReviewChanges.txtRejectCurrent":"拒绝此修订","Common.Views.ReviewChanges.txtSharing":"分享","Common.Views.ReviewChanges.txtSpelling":"拼写检查","Common.Views.ReviewChanges.txtTurnon":"修订","Common.Views.ReviewChanges.txtView":"显示模式","Common.Views.ReviewChangesDialog.textTitle":"查看更改","Common.Views.ReviewChangesDialog.txtAccept":"接受","Common.Views.ReviewChangesDialog.txtAcceptAll":"接受所有修订","Common.Views.ReviewChangesDialog.txtAcceptCurrent":"接受此修订","Common.Views.ReviewChangesDialog.txtNext":"下一处修订","Common.Views.ReviewChangesDialog.txtPrev":"上一处修订","Common.Views.ReviewChangesDialog.txtReject":"拒绝","Common.Views.ReviewChangesDialog.txtRejectAll":"拒绝所有修订","Common.Views.ReviewChangesDialog.txtRejectCurrent":"拒绝此修订","Common.Views.ReviewPopover.textAdd":"添加","Common.Views.ReviewPopover.textAddReply":"添加回复","Common.Views.ReviewPopover.textCancel":"取消","Common.Views.ReviewPopover.textClose":"关闭","Common.Views.ReviewPopover.textEdit":"确定","Common.Views.ReviewPopover.textEnterComment":"在此输入您的批注","Common.Views.ReviewPopover.textFollowMove":"跟随移动","Common.Views.ReviewPopover.textMention":"+提供访问文档和发送电子邮件的权限","Common.Views.ReviewPopover.textMentionNotify":"+通知将通过电子邮件通知用户","Common.Views.ReviewPopover.textOpenAgain":"再次打开","Common.Views.ReviewPopover.textReply":"回复","Common.Views.ReviewPopover.textResolve":"解决","Common.Views.ReviewPopover.textViewResolved":"您没有重开评论的权限","Common.Views.ReviewPopover.txtAccept":"接受","Common.Views.ReviewPopover.txtDeleteTip":"删除","Common.Views.ReviewPopover.txtEditTip":"编辑","Common.Views.ReviewPopover.txtReject":"拒绝","Common.Views.SaveAsDlg.textLoading":"载入中","Common.Views.SaveAsDlg.textTitle":"保存文件夹","Common.Views.SearchPanel.textCaseSensitive":"区分大小写","Common.Views.SearchPanel.textCloseSearch":"关闭搜索","Common.Views.SearchPanel.textContentChanged":"文件已更改。","Common.Views.SearchPanel.textFind":"查找内容","Common.Views.SearchPanel.textFindAndReplace":"查找和替换","Common.Views.SearchPanel.textItemsSuccessfullyReplaced":"{0}项已替换成功。","Common.Views.SearchPanel.textMatchUsingRegExp":"正则匹配","Common.Views.SearchPanel.textNoMatches":"找不到匹配信息","Common.Views.SearchPanel.textNoSearchResults":"找不到搜索结果","Common.Views.SearchPanel.textPartOfItemsNotReplaced":"{0}/{1}项已替换成功。剩余的{2}项被其他用户锁定。","Common.Views.SearchPanel.textReplace":"替换","Common.Views.SearchPanel.textReplaceAll":"全部替换","Common.Views.SearchPanel.textReplaceWith":"替换为","Common.Views.SearchPanel.textSearchAgain":"{0}进行新的搜索{1}以获得准确结果。","Common.Views.SearchPanel.textSearchHasStopped":"搜索已停止","Common.Views.SearchPanel.textSearchResults":"搜索结果：{0}/{1}","Common.Views.SearchPanel.textTooManyResults":"这里显示的结果太多了","Common.Views.SearchPanel.textWholeWords":"全字匹配","Common.Views.SearchPanel.tipNextResult":"下一个","Common.Views.SearchPanel.tipPreviousResult":"上一个","Common.Views.SelectFileDlg.textLoading":"载入中","Common.Views.SelectFileDlg.textTitle":"选择数据源","Common.Views.SignDialog.textBold":"加粗","Common.Views.SignDialog.textCertificate":"证书","Common.Views.SignDialog.textChange":"修改","Common.Views.SignDialog.textInputName":"输入签名者姓名","Common.Views.SignDialog.textItalic":"斜体","Common.Views.SignDialog.textNameError":"签名者名称不能为空","Common.Views.SignDialog.textPurpose":"签署本文档的目的","Common.Views.SignDialog.textSelect":"请选择","Common.Views.SignDialog.textSelectImage":"选择图片","Common.Views.SignDialog.textSignature":"签名类似","Common.Views.SignDialog.textTitle":"签署文件","Common.Views.SignDialog.textUseImage":"或单击“选择图片”将图片用作签名","Common.Views.SignDialog.textValid":"从%1到%2有效","Common.Views.SignDialog.tipFontName":"字体名称","Common.Views.SignDialog.tipFontSize":"字号","Common.Views.SignSettingsDialog.textAllowComment":"允许签名者在签名对话框中添加批注","Common.Views.SignSettingsDialog.textDefInstruction":"在签署本文件之前，请确保您所签署的内容是正确。","Common.Views.SignSettingsDialog.textInfoEmail":"建议签署人电邮","Common.Views.SignSettingsDialog.textInfoName":"建议签署人","Common.Views.SignSettingsDialog.textInfoTitle":"建议签署人职务","Common.Views.SignSettingsDialog.textInstructions":"给签名者的说明","Common.Views.SignSettingsDialog.textShowDate":"在签名行中显示签名日期","Common.Views.SignSettingsDialog.textTitle":"签名设置","Common.Views.SignSettingsDialog.txtEmpty":"这是必填栏","Common.Views.SymbolTableDialog.textCharacter":"字符","Common.Views.SymbolTableDialog.textCode":"Unicode十六进制值","Common.Views.SymbolTableDialog.textCopyright":"版权所有标识","Common.Views.SymbolTableDialog.textDCQuote":"后双引号","Common.Views.SymbolTableDialog.textDOQuote":"前双引号","Common.Views.SymbolTableDialog.textEllipsis":"横向省略号","Common.Views.SymbolTableDialog.textEmDash":"破折号","Common.Views.SymbolTableDialog.textEmSpace":"全角空格","Common.Views.SymbolTableDialog.textEnDash":"半破折号","Common.Views.SymbolTableDialog.textEnSpace":"半角空格","Common.Views.SymbolTableDialog.textFont":"字体 ","Common.Views.SymbolTableDialog.textNBHyphen":"不换行连词符","Common.Views.SymbolTableDialog.textNBSpace":"不换行空格","Common.Views.SymbolTableDialog.textPilcrow":"段落标识","Common.Views.SymbolTableDialog.textQEmSpace":"1/4全角空格","Common.Views.SymbolTableDialog.textRange":"子集","Common.Views.SymbolTableDialog.textRecent":"最近使用的符号","Common.Views.SymbolTableDialog.textRegistered":"注册商标标识","Common.Views.SymbolTableDialog.textSCQuote":"后单引号","Common.Views.SymbolTableDialog.textSection":"章节标识","Common.Views.SymbolTableDialog.textShortcut":"快捷键","Common.Views.SymbolTableDialog.textSHyphen":"软连词符","Common.Views.SymbolTableDialog.textSOQuote":"前单引号","Common.Views.SymbolTableDialog.textSpecial":"特殊字符","Common.Views.SymbolTableDialog.textSymbols":"符号","Common.Views.SymbolTableDialog.textTitle":"符号","Common.Views.SymbolTableDialog.textTradeMark":"商标标识","Common.Views.UserNameDialog.textDontShow":"不要再问我","Common.Views.UserNameDialog.textLabel":"标签：","Common.Views.UserNameDialog.textLabelError":"标签不能空","DE.Controllers.DocProtection.txtIsProtectedComment":"文件受保护。\n在本文件中您只能发评论。","DE.Controllers.DocProtection.txtIsProtectedForms":"文件受保护。\n在本文件中您只能填写表单。","DE.Controllers.DocProtection.txtIsProtectedTrack":"文件受保护。\n您可以编辑这个文件，但所有的更改都会被跟踪。","DE.Controllers.DocProtection.txtIsProtectedView":"文件受保护。\n本文件您只能查看。","DE.Controllers.DocProtection.txtWasProtectedComment":"文件已被其他用户保护。\n在本文件中您只能发评论。","DE.Controllers.DocProtection.txtWasProtectedForms":"文件已被其他用户保护。\n在本文件中您只能填写表单。","DE.Controllers.DocProtection.txtWasProtectedTrack":"文件已被其他用户保护。\n您可以编辑这个文件，但所有的更改都会被跟踪。","DE.Controllers.DocProtection.txtWasProtectedView":"文件已被其他用户保护。\n本文件您只能查看。","DE.Controllers.DocProtection.txtWasUnprotected":"文件已经不受保护了。","DE.Controllers.LeftMenu.leavePageText":"本文档中的所有未保存的更改都将丢失。<br>单击“取消”，然后单击“保存”保存。单击“确定”以放弃所有未保存的更改。","DE.Controllers.LeftMenu.newDocumentTitle":"未命名的文档","DE.Controllers.LeftMenu.notcriticalErrorTitle":"警告","DE.Controllers.LeftMenu.requestEditRightsText":"请求编辑权限..","DE.Controllers.LeftMenu.textLoadHistory":"载入版本历史记录中...","DE.Controllers.LeftMenu.textNoTextFound":"您搜索的数据无法找到。请调整您的搜索选项。","DE.Controllers.LeftMenu.textReplaceSkipped":"已经更换了。{0}次跳过。","DE.Controllers.LeftMenu.textReplaceSuccess":"他的搜索已经完成。发生次数：{0}","DE.Controllers.LeftMenu.txtCompatible":"文档将保存为新格式。它将允许使用所有编辑器功能，但可能会影响文档布局。<br>如果要使文档与旧版微软 Word 兼容，请使用高级设置的“兼容性”选项。","DE.Controllers.LeftMenu.txtUntitled":"无标题","DE.Controllers.LeftMenu.warnDownloadAs":"如果您继续以此格式保存，除文本之外的所有功能将丢失。<br>您确定要继续吗？","DE.Controllers.LeftMenu.warnDownloadAsPdf":"您的 {0} 将转换成一份可修改的文件。系统需要处理一段时间。转换后的文件即可随之修改，但可能不完全跟您的原 {0} 相同，特别是如果原文件有过多的图片将会更有差异。","DE.Controllers.LeftMenu.warnDownloadAsRTF":"如果您继续以此格式保存，一些格式可能会丢失。<br>您确定要继续吗？","DE.Controllers.LeftMenu.warnReplaceString":"{0}不是可用于“替换字段”的有效特殊字符。","DE.Controllers.Main.applyChangesTextText":"载入更改...","DE.Controllers.Main.applyChangesTitleText":"加载更改","DE.Controllers.Main.confirmMaxChangesSize":'行动的大小超过了对您服务器设置的限制。<br>按 "撤消"取消您的最后一次行动，或按"继续"在本地保留该行动（您需要下载文件或复制其内容以确保没有任何损失）。',"DE.Controllers.Main.convertationTimeoutText":"转换超时","DE.Controllers.Main.criticalErrorExtText":"按“确定”返回该文件列表。","DE.Controllers.Main.criticalErrorTitle":"错误","DE.Controllers.Main.downloadErrorText":"下载失败","DE.Controllers.Main.downloadMergeText":"下载中…","DE.Controllers.Main.downloadMergeTitle":"下载中","DE.Controllers.Main.downloadTextText":"正在下载文件...","DE.Controllers.Main.downloadTitleText":"下载文件","DE.Controllers.Main.errorAccessDeny":"您正在尝试执行您没有权限的操作。<br>请联系您的文档服务器管理员。","DE.Controllers.Main.errorBadImageUrl":"图片地址不正确","DE.Controllers.Main.errorCannotPasteImg":"我们无法从剪贴板上粘贴这个图片。您可以把它保存到您的设备上，然后从那里进行插入。\n或者您可以不复制文本而只复制图片，并将它粘贴到文档中。","DE.Controllers.Main.errorCoAuthoringDisconnect":"服务器连接丢失。该文档现在无法编辑","DE.Controllers.Main.errorComboSeries":"要创建联立图表，请选中至少两组数据。","DE.Controllers.Main.errorCompare":"协作编辑状态下，无法使用文件比对功能。","DE.Controllers.Main.errorConnectToServer":"这份文件无法保存。请检查连接设置或联系您的管理员。<br>当您点击“OK”按钮,系统将提示您下载文档。","DE.Controllers.Main.errorDatabaseConnection":"外部错误。<br>数据库连接错误。如果错误仍然存​​在，请联系支持人员。","DE.Controllers.Main.errorDataEncrypted":"加密更改已收到，无法对其解密。","DE.Controllers.Main.errorDataRange":"数据范围不正确","DE.Controllers.Main.errorDefaultMessage":"错误代码：%1","DE.Controllers.Main.errorDirectUrl":"请验证指向文档的链接。<br>此链接必须是指向要下载的文件的直接链接。","DE.Controllers.Main.errorEditingDownloadas":"在处理文档期间发生错误。<br>使用“下载为”选项将文件备份复制到您的计算机硬盘中。","DE.Controllers.Main.errorEditingSaveas":"在处理文档期间发生错误。<br>使用“另存为…”选项将文件备份复制到计算机硬盘中。","DE.Controllers.Main.errorEmailClient":"未找到电子邮件客户端。","DE.Controllers.Main.errorEmptyTOC":"开始创建一个目录并应用样式库中的标题样式到选择的文本。","DE.Controllers.Main.errorFilePassProtect":"该文档受密码保护，无法被打开。","DE.Controllers.Main.errorFileSizeExceed":"文件大小超出了为服务器设置的限制.<br>有关详细信息，请与文档服务器管理员联系。","DE.Controllers.Main.errorForceSave":"保存文件时发生错误请使用“下载为”选项将文件保存到计算机硬盘中或稍后重试。","DE.Controllers.Main.errorInconsistentExt":"在打开文件时发生了错误。<br> 该文件的扩展名不一致：%1。","DE.Controllers.Main.errorInconsistentExtDocx":"在打开文件时发生了错误。<br>文件内容对应于文本文档（如 docx），但该文件的扩展名不一致：%1。","DE.Controllers.Main.errorInconsistentExtPdf":"在打开文件时发生了错误。<br>文件内容对应于以下格式之一：pdf/djvu/xps/oxps，但该文件的扩展名不一致：%1。","DE.Controllers.Main.errorInconsistentExtPptx":"在打开文件时发生了错误。<br>文件内容对应于演示文稿（如 pptx），但该文件的扩展名不一致：%1。","DE.Controllers.Main.errorInconsistentExtXlsx":"在打开文件时发生了错误。<br>文件内容对应于电子表格（如 xlsx），但该文件的扩展名不一致：%1。","DE.Controllers.Main.errorKeyEncrypt":"未知密钥描述","DE.Controllers.Main.errorKeyExpire":"密钥过期","DE.Controllers.Main.errorLoadingFont":"字体未加载。<br>请与文档服务器管理员联系。","DE.Controllers.Main.errorMailMergeLoadFile":"加载文件失败了。请选择另一份文件。","DE.Controllers.Main.errorMailMergeSaveFile":"合并失败","DE.Controllers.Main.errorNoTOC":"没有目录要更新。你可以从引用标签插入一个目录。","DE.Controllers.Main.errorPasswordIsNotCorrect":"输入的密码不正确。<br> 请检查 CAPS LOCK 键的状态，确认输入密码的大小写正确。","DE.Controllers.Main.errorProcessSaveResult":"保存失败","DE.Controllers.Main.errorServerVersion":"该编辑版本已经更新。该页面将被重新加载以应用更改。","DE.Controllers.Main.errorSessionAbsolute":"文档编辑会话已过期。请重新加载页面。","DE.Controllers.Main.errorSessionIdle":"该文件尚未编辑相当长的时间。请重新加载页面。","DE.Controllers.Main.errorSessionToken":"与服务器的连接已中断。请重新加载页面。","DE.Controllers.Main.errorSetPassword":"未能成功设置密码","DE.Controllers.Main.errorStockChart":"行顺序不正确。建立股票图表将数据按照以下顺序放置在表格上：<br>开盘价，最高价格，最低价格，收盘价。","DE.Controllers.Main.errorSubmit":"提交失败","DE.Controllers.Main.errorTextFormWrongFormat":"输入的值与该字段的格式不一致。","DE.Controllers.Main.errorToken":"文档安全令牌未正确形成。<br>请与您的文件服务器管理员联系。","DE.Controllers.Main.errorTokenExpire":"文档安全令牌已过期。<br>请与您的文档服务器管理员联系。","DE.Controllers.Main.errorUpdateVersion":"该文件版本已经改变了。该页面将被重新加载。","DE.Controllers.Main.errorUpdateVersionOnDisconnect":"网连接已还原文件版本已更改。.<br>在继续工作之前，需要下载文件或复制其内容以确保没有丢失任何内容，然后重新加载此页。","DE.Controllers.Main.errorUserDrop":"该文件现在无法访问。","DE.Controllers.Main.errorUsersExceed":"超过了定价计划允许的用户数","DE.Controllers.Main.errorViewerDisconnect":"连接丢失了。您仍然可以查看文档，<br>但在连接恢复并页面被重新加载之前无法下载或打印。","DE.Controllers.Main.leavePageText":"您在本文档中有未保存的更改。点击“留在此页面”，然后点击“保存”以保存保存。点击“离开此页面”，以放弃所有未保存的更改。","DE.Controllers.Main.leavePageTextOnClose":"本文档中的所有未保存的更改都将丢失。<br>单击“取消”，然后单击“保存”保存。单击“确定”以放弃所有未保存的更改。","DE.Controllers.Main.loadFontsTextText":"数据加载中…","DE.Controllers.Main.loadFontsTitleText":"数据加载中","DE.Controllers.Main.loadFontTextText":"数据加载中…","DE.Controllers.Main.loadFontTitleText":"数据加载中","DE.Controllers.Main.loadImagesTextText":"图片加载中…","DE.Controllers.Main.loadImagesTitleText":"图片加载中","DE.Controllers.Main.loadImageTextText":"图片加载中…","DE.Controllers.Main.loadImageTitleText":"图片加载中","DE.Controllers.Main.loadingDocumentTextText":"文件加载中…","DE.Controllers.Main.loadingDocumentTitleText":"正在打开文档…","DE.Controllers.Main.mailMergeLoadFileText":"原始数据加载中…","DE.Controllers.Main.mailMergeLoadFileTitle":"原始数据加载中…","DE.Controllers.Main.notcriticalErrorTitle":"警告","DE.Controllers.Main.openErrorText":"打开文件时出现错误","DE.Controllers.Main.openTextText":"打开文件...","DE.Controllers.Main.openTitleText":"正在打开文件","DE.Controllers.Main.printTextText":"打印文件1","DE.Controllers.Main.printTitleText":"打印文档","DE.Controllers.Main.reloadButtonText":"重新加载页面","DE.Controllers.Main.requestEditFailedMessageText":"有人正在编辑此文档。请稍后再试。","DE.Controllers.Main.requestEditFailedTitleText":"访问被拒绝","DE.Controllers.Main.saveErrorText":"保存文件时出现错误","DE.Controllers.Main.saveErrorTextDesktop":"无法保存或创建此文件。<br>可能的原因是：<br> 1.此文件是只读的。 <br> 2.此文件正在由其他用户编辑。 <br> 3.磁盘已满或损坏。","DE.Controllers.Main.saveTextText":"保存文件…","DE.Controllers.Main.saveTitleText":"保存文件","DE.Controllers.Main.scriptLoadError":"连接速度过慢，部分组件无法被加载。请重新加载页面。","DE.Controllers.Main.sendMergeText":"任务合并","DE.Controllers.Main.sendMergeTitle":"任务合并","DE.Controllers.Main.splitDividerErrorText":"行数必须为%1的除数。","DE.Controllers.Main.splitMaxColsErrorText":"列数必须小于%1。","DE.Controllers.Main.splitMaxRowsErrorText":"行数必须小于%1。","DE.Controllers.Main.textAnonymous":"匿名","DE.Controllers.Main.textAnyone":"任何人","DE.Controllers.Main.textApplyAll":"应用到所有公式","DE.Controllers.Main.textBuyNow":"访问网站","DE.Controllers.Main.textChangesSaved":"所有更改已保存","DE.Controllers.Main.textClose":"关闭","DE.Controllers.Main.textCloseTip":"点击关闭提示","DE.Controllers.Main.textContactUs":"联系销售","DE.Controllers.Main.textContinue":"继续","DE.Controllers.Main.textConvertEquation":"这个公式是由一个早期版本的公式编辑器创建的。这个版本现在不受支持了。要想编辑这个公式，你需要将其转换成 Office Math ML 格式.<br>现在转换吗？","DE.Controllers.Main.textCustomLoader":"请注意，根据许可条款您无权更改加载程序。<br>请联系我们的销售部门获取报价。","DE.Controllers.Main.textDisconnect":"网络连接失败","DE.Controllers.Main.textGuest":"访客","DE.Controllers.Main.textHasMacros":"这个文件带有自动宏。<br> 是否要运行宏？","DE.Controllers.Main.textLearnMore":"了解更多","DE.Controllers.Main.textLoadingDocument":"文件加载中…","DE.Controllers.Main.textLongName":"输入名称，要求小于128字符。","DE.Controllers.Main.textNoLicenseTitle":"已达到许可证限制","DE.Controllers.Main.textPaidFeature":"付费功能","DE.Controllers.Main.textReconnect":"连接已恢复","DE.Controllers.Main.textRemember":"记住我为所有文件的选择","DE.Controllers.Main.textRememberMacros":"记住我的选择","DE.Controllers.Main.textRenameError":"用户名不能留空。","DE.Controllers.Main.textRenameLabel":"输入名称，可用于协作。","DE.Controllers.Main.textRequestMacros":"宏发起一个请求至URL。你是否允许请求到％1？","DE.Controllers.Main.textShape":"形状","DE.Controllers.Main.textStrict":"手动模式","DE.Controllers.Main.textText":"文本","DE.Controllers.Main.textTryQuickPrint":"您已经选择了快速打印：整个文件将用最新选定的打印机或默认的打印机被打印。<br>您想继续吗？","DE.Controllers.Main.textTryUndoRedo":"对于自动的协同编辑模式，取消/重做功能是禁用的。<br>单击“手动模式”按钮切换到手动协同编辑模式，这样，编辑该文件时只有您保存修改之后，其他用户才能访问这些修改。您可以使用编辑器高级设置易于切换编辑模式。","DE.Controllers.Main.textTryUndoRedoWarn":"自动共同编辑模式下，撤销/重做功能被禁用。","DE.Controllers.Main.textUndo":"撤消","DE.Controllers.Main.titleLicenseExp":"许可证过期","DE.Controllers.Main.titleLicenseNotActive":"许可证未激活","DE.Controllers.Main.titleServerVersion":"编辑器已更新","DE.Controllers.Main.titleUpdateVersion":"版本已变化","DE.Controllers.Main.txtAbove":"见上方","DE.Controllers.Main.txtArt":"在此输入文字","DE.Controllers.Main.txtBasicShapes":"基本形状","DE.Controllers.Main.txtBelow":"见下方","DE.Controllers.Main.txtBookmarkError":"错误！未定义书签。","DE.Controllers.Main.txtButtons":"按钮","DE.Controllers.Main.txtCallouts":"标注","DE.Controllers.Main.txtCharts":"流程图","DE.Controllers.Main.txtChoose":"选择一项","DE.Controllers.Main.txtClickToLoad":"点按以加载图片","DE.Controllers.Main.txtCurrentDocument":"当前文件","DE.Controllers.Main.txtDiagramTitle":"图表标题","DE.Controllers.Main.txtEditingMode":"设置编辑模式..","DE.Controllers.Main.txtEndOfFormula":"意外的公式结尾","DE.Controllers.Main.txtEnterDate":"输入日期","DE.Controllers.Main.txtErrorLoadHistory":"历史加载失败","DE.Controllers.Main.txtEvenPage":"偶数页","DE.Controllers.Main.txtFiguredArrows":"箭头汇总","DE.Controllers.Main.txtFirstPage":"首页","DE.Controllers.Main.txtFooter":"页脚","DE.Controllers.Main.txtFormulaNotInTable":"公式不在表格中","DE.Controllers.Main.txtHeader":"页眉","DE.Controllers.Main.txtHyperlink":"超链接","DE.Controllers.Main.txtIndTooLarge":"指数过大","DE.Controllers.Main.txtLines":"线条","DE.Controllers.Main.txtMainDocOnly":"错误！仅限主文档。","DE.Controllers.Main.txtMath":"公式形状","DE.Controllers.Main.txtMissArg":"缺少参数","DE.Controllers.Main.txtMissOperator":"缺少运算符","DE.Controllers.Main.txtNeedSynchronize":"您有更新","DE.Controllers.Main.txtNone":"无","DE.Controllers.Main.txtNoTableOfContents":"文档中无标题。文本中应用标题样式以便使其出现在目录中。","DE.Controllers.Main.txtNoTableOfFigures":"未找到图片或表格的元素。","DE.Controllers.Main.txtNoText":"错误！文档中没有指定样式的文本。","DE.Controllers.Main.txtNotInTable":"不在表格中","DE.Controllers.Main.txtNotValidBookmark":"错误！不是有效的书签自引用。","DE.Controllers.Main.txtOddPage":"奇数页","DE.Controllers.Main.txtOnPage":"在页面上","DE.Controllers.Main.txtRectangles":"矩形","DE.Controllers.Main.txtSameAsPrev":"与上一个相同","DE.Controllers.Main.txtSection":"-部分","DE.Controllers.Main.txtSeries":"系列","DE.Controllers.Main.txtShape_accentBorderCallout1":"线形标注1（边框和强调线）","DE.Controllers.Main.txtShape_accentBorderCallout2":"线形标注2（边框和强调线）","DE.Controllers.Main.txtShape_accentBorderCallout3":"线形标注3（边框和强调线）","DE.Controllers.Main.txtShape_accentCallout1":"线形标注1（强调线）","DE.Controllers.Main.txtShape_accentCallout2":"线形标注2（强调线）","DE.Controllers.Main.txtShape_accentCallout3":"线形标注3（强调线）","DE.Controllers.Main.txtShape_actionButtonBackPrevious":"后退或上一个按钮","DE.Controllers.Main.txtShape_actionButtonBeginning":"开始按钮","DE.Controllers.Main.txtShape_actionButtonBlank":"空白按钮","DE.Controllers.Main.txtShape_actionButtonDocument":"文件按钮","DE.Controllers.Main.txtShape_actionButtonEnd":"结束按钮","DE.Controllers.Main.txtShape_actionButtonForwardNext":"转发或下一个按钮","DE.Controllers.Main.txtShape_actionButtonHelp":"帮助按钮","DE.Controllers.Main.txtShape_actionButtonHome":"主页按钮","DE.Controllers.Main.txtShape_actionButtonInformation":"信息按钮","DE.Controllers.Main.txtShape_actionButtonMovie":"视频按钮","DE.Controllers.Main.txtShape_actionButtonReturn":"返回按钮","DE.Controllers.Main.txtShape_actionButtonSound":"声音按钮","DE.Controllers.Main.txtShape_arc":"弧","DE.Controllers.Main.txtShape_bentArrow":"圆角右箭头","DE.Controllers.Main.txtShape_bentConnector5":"肘形连接符","DE.Controllers.Main.txtShape_bentConnector5WithArrow":"肘形箭头连接符","DE.Controllers.Main.txtShape_bentConnector5WithTwoArrows":"肘形双箭头连接符","DE.Controllers.Main.txtShape_bentUpArrow":"直角上箭头","DE.Controllers.Main.txtShape_bevel":"棱台","DE.Controllers.Main.txtShape_blockArc":"空心弧","DE.Controllers.Main.txtShape_borderCallout1":"线形标注1","DE.Controllers.Main.txtShape_borderCallout2":"线形标注2","DE.Controllers.Main.txtShape_borderCallout3":"线形标注3","DE.Controllers.Main.txtShape_bracePair":"双大括号","DE.Controllers.Main.txtShape_callout1":"线形标注1（无边框）","DE.Controllers.Main.txtShape_callout2":"线形标注2（无边框）","DE.Controllers.Main.txtShape_callout3":"线形标注3（无边框）","DE.Controllers.Main.txtShape_can":"圆柱","DE.Controllers.Main.txtShape_chevron":"V形","DE.Controllers.Main.txtShape_chord":"弦形","DE.Controllers.Main.txtShape_circularArrow":"环形箭头","DE.Controllers.Main.txtShape_cloud":"云形","DE.Controllers.Main.txtShape_cloudCallout":"云形标注","DE.Controllers.Main.txtShape_corner":"角","DE.Controllers.Main.txtShape_cube":"正方体","DE.Controllers.Main.txtShape_curvedConnector3":"曲线连接符","DE.Controllers.Main.txtShape_curvedConnector3WithArrow":"曲线箭头连接符","DE.Controllers.Main.txtShape_curvedConnector3WithTwoArrows":"曲线双箭头连接符","DE.Controllers.Main.txtShape_curvedDownArrow":"下弧形箭头","DE.Controllers.Main.txtShape_curvedLeftArrow":"左弧形箭头","DE.Controllers.Main.txtShape_curvedRightArrow":"右弧形箭头","DE.Controllers.Main.txtShape_curvedUpArrow":"上弧形箭头","DE.Controllers.Main.txtShape_decagon":"十边形","DE.Controllers.Main.txtShape_diagStripe":"斜纹","DE.Controllers.Main.txtShape_diamond":"菱形","DE.Controllers.Main.txtShape_dodecagon":"十二边形","DE.Controllers.Main.txtShape_donut":"环形","DE.Controllers.Main.txtShape_doubleWave":"双波形","DE.Controllers.Main.txtShape_downArrow":"下箭头","DE.Controllers.Main.txtShape_downArrowCallout":"下箭头标注","DE.Controllers.Main.txtShape_ellipse":"椭圆","DE.Controllers.Main.txtShape_ellipseRibbon":"下凸弯带形","DE.Controllers.Main.txtShape_ellipseRibbon2":"上凸弯带形","DE.Controllers.Main.txtShape_flowChartAlternateProcess":"流程图：可选流程","DE.Controllers.Main.txtShape_flowChartCollate":"流程图：对照","DE.Controllers.Main.txtShape_flowChartConnector":"流程图：接点","DE.Controllers.Main.txtShape_flowChartDecision":"流程图：决策","DE.Controllers.Main.txtShape_flowChartDelay":"流程图：延期","DE.Controllers.Main.txtShape_flowChartDisplay":"流程图：展示","DE.Controllers.Main.txtShape_flowChartDocument":"流程图：文档","DE.Controllers.Main.txtShape_flowChartExtract":"流程图：摘录","DE.Controllers.Main.txtShape_flowChartInputOutput":"流程图：数据","DE.Controllers.Main.txtShape_flowChartInternalStorage":"流程图：内部贮存","DE.Controllers.Main.txtShape_flowChartMagneticDisk":"流程图：磁盘","DE.Controllers.Main.txtShape_flowChartMagneticDrum":"流程图：直接访问存储器","DE.Controllers.Main.txtShape_flowChartMagneticTape":"流程图：顺序访问存储器","DE.Controllers.Main.txtShape_flowChartManualInput":"流程图：手动输入","DE.Controllers.Main.txtShape_flowChartManualOperation":"流程图：手动操作","DE.Controllers.Main.txtShape_flowChartMerge":"流程图：合并","DE.Controllers.Main.txtShape_flowChartMultidocument":"流程图：多文档 ","DE.Controllers.Main.txtShape_flowChartOffpageConnector":"流程图：离页连接符","DE.Controllers.Main.txtShape_flowChartOnlineStorage":"流程图：存储数据","DE.Controllers.Main.txtShape_flowChartOr":"流程图：或者","DE.Controllers.Main.txtShape_flowChartPredefinedProcess":"流程图：预定义过程","DE.Controllers.Main.txtShape_flowChartPreparation":"流程图：准备","DE.Controllers.Main.txtShape_flowChartProcess":"流程图：过程","DE.Controllers.Main.txtShape_flowChartPunchedCard":"流程图：卡片","DE.Controllers.Main.txtShape_flowChartPunchedTape":"流程图：资料带","DE.Controllers.Main.txtShape_flowChartSort":"流程图：分类","DE.Controllers.Main.txtShape_flowChartSummingJunction":"流程图：汇总连接","DE.Controllers.Main.txtShape_flowChartTerminator":"流程图：终止","DE.Controllers.Main.txtShape_foldedCorner":"折角形","DE.Controllers.Main.txtShape_frame":"框架","DE.Controllers.Main.txtShape_halfFrame":"半闭框","DE.Controllers.Main.txtShape_heart":"心形","DE.Controllers.Main.txtShape_heptagon":"七边形","DE.Controllers.Main.txtShape_hexagon":"六边形","DE.Controllers.Main.txtShape_homePlate":"五边形","DE.Controllers.Main.txtShape_horizontalScroll":"横卷形","DE.Controllers.Main.txtShape_irregularSeal1":"爆炸形1","DE.Controllers.Main.txtShape_irregularSeal2":"爆炸形2","DE.Controllers.Main.txtShape_leftArrow":"左箭头","DE.Controllers.Main.txtShape_leftArrowCallout":"左箭头标注","DE.Controllers.Main.txtShape_leftBrace":"左括号","DE.Controllers.Main.txtShape_leftBracket":"左中括号","DE.Controllers.Main.txtShape_leftRightArrow":"左右箭头","DE.Controllers.Main.txtShape_leftRightArrowCallout":"左右箭头标注","DE.Controllers.Main.txtShape_leftRightUpArrow":"丁字箭头","DE.Controllers.Main.txtShape_leftUpArrow":"左上箭头","DE.Controllers.Main.txtShape_lightningBolt":"闪电形","DE.Controllers.Main.txtShape_line":"线","DE.Controllers.Main.txtShape_lineWithArrow":"箭头","DE.Controllers.Main.txtShape_lineWithTwoArrows":"双箭头","DE.Controllers.Main.txtShape_mathDivide":"除","DE.Controllers.Main.txtShape_mathEqual":"平等","DE.Controllers.Main.txtShape_mathMinus":"减去","DE.Controllers.Main.txtShape_mathMultiply":"乘","DE.Controllers.Main.txtShape_mathNotEqual":"不等于","DE.Controllers.Main.txtShape_mathPlus":"加","DE.Controllers.Main.txtShape_moon":"月形","DE.Controllers.Main.txtShape_noSmoking":"“NO”符号","DE.Controllers.Main.txtShape_notchedRightArrow":"燕尾形箭头","DE.Controllers.Main.txtShape_octagon":"八边形","DE.Controllers.Main.txtShape_parallelogram":"平行四边形","DE.Controllers.Main.txtShape_pentagon":"五边形","DE.Controllers.Main.txtShape_pie":"派","DE.Controllers.Main.txtShape_plaque":"符号","DE.Controllers.Main.txtShape_plus":"加","DE.Controllers.Main.txtShape_polyline1":"自由曲线","DE.Controllers.Main.txtShape_polyline2":"任意多边形","DE.Controllers.Main.txtShape_quadArrow":"十字箭头","DE.Controllers.Main.txtShape_quadArrowCallout":"十字箭头标注","DE.Controllers.Main.txtShape_rect":"矩形","DE.Controllers.Main.txtShape_ribbon":"下凸带形","DE.Controllers.Main.txtShape_ribbon2":"上凸带形","DE.Controllers.Main.txtShape_rightArrow":"右箭头","DE.Controllers.Main.txtShape_rightArrowCallout":"右箭头标注","DE.Controllers.Main.txtShape_rightBrace":"右括号","DE.Controllers.Main.txtShape_rightBracket":"右中括号","DE.Controllers.Main.txtShape_round1Rect":"单圆角矩形","DE.Controllers.Main.txtShape_round2DiagRect":"对角圆角矩形","DE.Controllers.Main.txtShape_round2SameRect":"同侧圆角矩形","DE.Controllers.Main.txtShape_roundRect":"圆角矩形","DE.Controllers.Main.txtShape_rtTriangle":"直角三角形","DE.Controllers.Main.txtShape_smileyFace":"笑脸","DE.Controllers.Main.txtShape_snip1Rect":"剪去单角的矩形","DE.Controllers.Main.txtShape_snip2DiagRect":"剪去对角的矩形","DE.Controllers.Main.txtShape_snip2SameRect":"剪去同侧角的矩形","DE.Controllers.Main.txtShape_snipRoundRect":"剪去单圆角的矩形","DE.Controllers.Main.txtShape_spline":"曲线","DE.Controllers.Main.txtShape_star10":"十角星","DE.Controllers.Main.txtShape_star12":"十二角星","DE.Controllers.Main.txtShape_star16":"十六角星","DE.Controllers.Main.txtShape_star24":"二十四角星","DE.Controllers.Main.txtShape_star32":"三十二角星","DE.Controllers.Main.txtShape_star4":"四角星","DE.Controllers.Main.txtShape_star5":"五角星","DE.Controllers.Main.txtShape_star6":"六角星","DE.Controllers.Main.txtShape_star7":"七角星","DE.Controllers.Main.txtShape_star8":"八角星","DE.Controllers.Main.txtShape_stripedRightArrow":"虚尾箭头","DE.Controllers.Main.txtShape_sun":"太阳形","DE.Controllers.Main.txtShape_teardrop":"泪珠形","DE.Controllers.Main.txtShape_textRect":"文本框","DE.Controllers.Main.txtShape_trapezoid":"梯形","DE.Controllers.Main.txtShape_triangle":"三角形","DE.Controllers.Main.txtShape_upArrow":"上箭头","DE.Controllers.Main.txtShape_upArrowCallout":"上箭头标注","DE.Controllers.Main.txtShape_upDownArrow":"上下箭头","DE.Controllers.Main.txtShape_uturnArrow":"手杖形箭头","DE.Controllers.Main.txtShape_verticalScroll":"竖卷形","DE.Controllers.Main.txtShape_wave":"波浪线","DE.Controllers.Main.txtShape_wedgeEllipseCallout":"椭圆形标注","DE.Controllers.Main.txtShape_wedgeRectCallout":"矩形标注","DE.Controllers.Main.txtShape_wedgeRoundRectCallout":"圆角矩形标注","DE.Controllers.Main.txtStarsRibbons":"星星和旗帜","DE.Controllers.Main.txtStyle_Caption":"标题","DE.Controllers.Main.txtStyle_endnote_text":"结束处文本","DE.Controllers.Main.txtStyle_footnote_text":"脚注文本","DE.Controllers.Main.txtStyle_Heading_1":"标题1","DE.Controllers.Main.txtStyle_Heading_2":"标题2","DE.Controllers.Main.txtStyle_Heading_3":"标题3","DE.Controllers.Main.txtStyle_Heading_4":"标题4","DE.Controllers.Main.txtStyle_Heading_5":"标题5","DE.Controllers.Main.txtStyle_Heading_6":"标题6","DE.Controllers.Main.txtStyle_Heading_7":"标题7","DE.Controllers.Main.txtStyle_Heading_8":"标题8","DE.Controllers.Main.txtStyle_Heading_9":"标题9","DE.Controllers.Main.txtStyle_Intense_Quote":"直接引用","DE.Controllers.Main.txtStyle_List_Paragraph":"列表段落","DE.Controllers.Main.txtStyle_No_Spacing":"无空格","DE.Controllers.Main.txtStyle_Normal":"常规","DE.Controllers.Main.txtStyle_Quote":"引用","DE.Controllers.Main.txtStyle_Subtitle":"副标题","DE.Controllers.Main.txtStyle_Title":"标题","DE.Controllers.Main.txtSyntaxError":"语法错误","DE.Controllers.Main.txtTableInd":"表格索引不能为零","DE.Controllers.Main.txtTableOfContents":"目录","DE.Controllers.Main.txtTableOfFigures":"图表目录","DE.Controllers.Main.txtTOCHeading":"目录标题","DE.Controllers.Main.txtTooLarge":"数字太大，无法设定格式","DE.Controllers.Main.txtTypeEquation":"在此这里输入公式。","DE.Controllers.Main.txtUndefBookmark":"未定义书签","DE.Controllers.Main.txtXAxis":"X轴","DE.Controllers.Main.txtYAxis":"Y轴","DE.Controllers.Main.txtZeroDivide":"除数为零","DE.Controllers.Main.unknownErrorText":"未知错误","DE.Controllers.Main.unsupportedBrowserErrorText":"你的浏览器不支持","DE.Controllers.Main.uploadDocExtMessage":"未知的文档格式","DE.Controllers.Main.uploadDocFileCountMessage":"没有文档上载了","DE.Controllers.Main.uploadDocSizeMessage":"超过最大文档大小限制。","DE.Controllers.Main.uploadImageExtMessage":"未知图片格式","DE.Controllers.Main.uploadImageFileCountMessage":"没有图片上传","DE.Controllers.Main.uploadImageSizeMessage":"图片太大。最大的大小为25MB。","DE.Controllers.Main.uploadImageTextText":"图片上传中...","DE.Controllers.Main.uploadImageTitleText":"图片上传中","DE.Controllers.Main.waitText":"请稍候...","DE.Controllers.Main.warnBrowserIE9":"该应用程序在IE9上的功能很差。使用IE10或更高版本","DE.Controllers.Main.warnBrowserZoom":"您的浏览器当前缩放设置不完全支持。请按Ctrl + 0重设为默认缩放。","DE.Controllers.Main.warnLicenseAnonymous":"拒绝匿名用户的访问。<br>本文档将以仅查看模式而打开。","DE.Controllers.Main.warnLicenseBefore":"许可证未激活。<br>请联系管理员。","DE.Controllers.Main.warnLicenseExceeded":"您已达到同时连接%1编辑器的限制。该文档将被打开仅供查看。<br>请联系您的管理员以了解更多。","DE.Controllers.Main.warnLicenseExp":"您的许可证已过期。<br>请更新您的许可证并刷新页面。","DE.Controllers.Main.warnLicenseLimitedNoAccess":"授权过期<br>您不具备文件编辑功能的授权<br>请联系管理员。","DE.Controllers.Main.warnLicenseLimitedRenewed":"授权需更新<br>您只有文件编辑功能的部分权限<br>请联系管理员以取得完整权限。","DE.Controllers.Main.warnLicenseUsersExceeded":"您已达到%1编辑器的用户限制。请联系您的管理员以了解更多。","DE.Controllers.Main.warnNoLicense":"您已达到同时连接%1编辑器的限制。该文档将被打开仅供查看。<br>请联系%1销售团队以了解个人升级条款。","DE.Controllers.Main.warnNoLicenseUsers":"您已达到%1编辑器的用户限制。请联系%1销售团队以了解个人升级条款。","DE.Controllers.Main.warnProcessRightsChange":"您被拒绝编辑文件的权限。","DE.Controllers.Navigation.txtBeginning":"文档开头","DE.Controllers.Navigation.txtGotoBeginning":"转到文档开头","DE.Controllers.Print.textMarginsLast":"上次的自定义","DE.Controllers.Print.txtCustom":"自定义","DE.Controllers.Print.txtPrintRangeInvalid":"打印范围无效","DE.Controllers.Print.txtPrintRangeSingleRange":"输入单个页码或单个页面范围（例如，5-12）。或者您可以打印为 PDF。","DE.Controllers.Search.notcriticalErrorTitle":"警告","DE.Controllers.Search.textNoTextFound":"您搜索的数据无法找到。请调整您的搜索选项。","DE.Controllers.Search.textReplaceSkipped":"替换已完成。 {0}个符合结果被跳过。","DE.Controllers.Search.textReplaceSuccess":"搜寻已完成。 {0}个符合结果已被取代","DE.Controllers.Search.warnReplaceString":"{0}不是有效的规范","DE.Controllers.Statusbar.textDisconnect":"<b>连接失败</b><br>正在尝试连接。请检查连接设置。","DE.Controllers.Statusbar.textHasChanges":"已经跟踪了新的变化","DE.Controllers.Statusbar.textSetTrackChanges":"你现在处于审阅模式。","DE.Controllers.Statusbar.textTrackChanges":"已启用“跟踪修订”模式","DE.Controllers.Statusbar.tipReview":"修订","DE.Controllers.Statusbar.zoomText":"缩放{0}%","DE.Controllers.Toolbar.confirmAddFontName":"您要保存的字体在当前设备上不可用。<br>使用其中一种系统字体显示文本样式，当可用时将使用保存的字体。<br>是否要继续？","DE.Controllers.Toolbar.dataUrl":"粘贴URL数据","DE.Controllers.Toolbar.notcriticalErrorTitle":"警告","DE.Controllers.Toolbar.textAccent":"导数符号","DE.Controllers.Toolbar.textBracket":"括号","DE.Controllers.Toolbar.textEmptyImgUrl":"您需要指定图片URL。","DE.Controllers.Toolbar.textEmptyMMergeUrl":"你需要指明 URL。","DE.Controllers.Toolbar.textFontSizeErr":"输入的值不正确。<br>请输入1到300之间的数值","DE.Controllers.Toolbar.textFraction":"分数","DE.Controllers.Toolbar.textFunction":"三角函数","DE.Controllers.Toolbar.textGroup":"群","DE.Controllers.Toolbar.textInsert":"插入","DE.Controllers.Toolbar.textIntegral":"积分","DE.Controllers.Toolbar.textLargeOperator":"大型运算符","DE.Controllers.Toolbar.textLimitAndLog":"极限和对数","DE.Controllers.Toolbar.textMatrix":"矩阵","DE.Controllers.Toolbar.textOperator":"运算符","DE.Controllers.Toolbar.textRadical":"根式","DE.Controllers.Toolbar.textRecentlyUsed":"最近使用的","DE.Controllers.Toolbar.textScript":"上下标","DE.Controllers.Toolbar.textSymbols":"符号","DE.Controllers.Toolbar.textTabForms":"表单","DE.Controllers.Toolbar.textWarning":"警告","DE.Controllers.Toolbar.txtAccent_Accent":"急性","DE.Controllers.Toolbar.txtAccent_ArrowD":"右上方的箭头在上方","DE.Controllers.Toolbar.txtAccent_ArrowL":"向左箭头","DE.Controllers.Toolbar.txtAccent_ArrowR":"向右箭头上方","DE.Controllers.Toolbar.txtAccent_Bar":"条","DE.Controllers.Toolbar.txtAccent_BarBot":"下划线","DE.Controllers.Toolbar.txtAccent_BarTop":"划线","DE.Controllers.Toolbar.txtAccent_BorderBox":"盒装配方（带占位符)","DE.Controllers.Toolbar.txtAccent_BorderBoxCustom":"盒装配方（示例）","DE.Controllers.Toolbar.txtAccent_Check":"检查","DE.Controllers.Toolbar.txtAccent_CurveBracketBot":"下方大括号","DE.Controllers.Toolbar.txtAccent_CurveBracketTop":"上方大括号","DE.Controllers.Toolbar.txtAccent_Custom_1":"A的矢量","DE.Controllers.Toolbar.txtAccent_Custom_2":"带顶线的ABC","DE.Controllers.Toolbar.txtAccent_Custom_3":"带顶线的x XOR y","DE.Controllers.Toolbar.txtAccent_DDDot":"三点","DE.Controllers.Toolbar.txtAccent_DDot":"双点","DE.Controllers.Toolbar.txtAccent_Dot":"点","DE.Controllers.Toolbar.txtAccent_DoubleBar":"双顶线","DE.Controllers.Toolbar.txtAccent_Grave":"抑音符号","DE.Controllers.Toolbar.txtAccent_GroupBot":"分组字符下面","DE.Controllers.Toolbar.txtAccent_GroupTop":"分组字符以上","DE.Controllers.Toolbar.txtAccent_HarpoonL":"向左鱼叉以上","DE.Controllers.Toolbar.txtAccent_HarpoonR":"向右上方的鱼叉","DE.Controllers.Toolbar.txtAccent_Hat":"帽状","DE.Controllers.Toolbar.txtAccent_Smile":"短音符","DE.Controllers.Toolbar.txtAccent_Tilde":"波浪号","DE.Controllers.Toolbar.txtBracket_Angle":"括号","DE.Controllers.Toolbar.txtBracket_Angle_Delimiter_2":"带分隔符的方括号","DE.Controllers.Toolbar.txtBracket_Angle_Delimiter_3":"带分隔符的方括号","DE.Controllers.Toolbar.txtBracket_Angle_NoneOpen":"单括号","DE.Controllers.Toolbar.txtBracket_Angle_OpenNone":"单括号","DE.Controllers.Toolbar.txtBracket_Curve":"括号","DE.Controllers.Toolbar.txtBracket_Curve_Delimiter_2":"带分隔符的方括号","DE.Controllers.Toolbar.txtBracket_Curve_NoneOpen":"单括号","DE.Controllers.Toolbar.txtBracket_Curve_OpenNone":"单括号","DE.Controllers.Toolbar.txtBracket_Custom_1":"案件（两个条件）","DE.Controllers.Toolbar.txtBracket_Custom_2":"案件（三个条件）","DE.Controllers.Toolbar.txtBracket_Custom_3":"堆栈对象","DE.Controllers.Toolbar.txtBracket_Custom_4":"堆栈对象","DE.Controllers.Toolbar.txtBracket_Custom_5":"案例示例","DE.Controllers.Toolbar.txtBracket_Custom_6":"二项系数","DE.Controllers.Toolbar.txtBracket_Custom_7":"二项系数","DE.Controllers.Toolbar.txtBracket_Line":"括号","DE.Controllers.Toolbar.txtBracket_Line_NoneOpen":"单括号","DE.Controllers.Toolbar.txtBracket_Line_OpenNone":"单括号","DE.Controllers.Toolbar.txtBracket_LineDouble":"括号","DE.Controllers.Toolbar.txtBracket_LineDouble_NoneOpen":"单括号","DE.Controllers.Toolbar.txtBracket_LineDouble_OpenNone":"单括号","DE.Controllers.Toolbar.txtBracket_LowLim":"括号","DE.Controllers.Toolbar.txtBracket_LowLim_NoneNone":"单括号","DE.Controllers.Toolbar.txtBracket_LowLim_OpenNone":"单括号","DE.Controllers.Toolbar.txtBracket_Round":"括号","DE.Controllers.Toolbar.txtBracket_Round_Delimiter_2":"带分隔符的方括号","DE.Controllers.Toolbar.txtBracket_Round_NoneOpen":"单括号","DE.Controllers.Toolbar.txtBracket_Round_OpenNone":"单括号","DE.Controllers.Toolbar.txtBracket_Square":"括号","DE.Controllers.Toolbar.txtBracket_Square_CloseClose":"括号","DE.Controllers.Toolbar.txtBracket_Square_CloseOpen":"括号","DE.Controllers.Toolbar.txtBracket_Square_NoneOpen":"单括号","DE.Controllers.Toolbar.txtBracket_Square_OpenNone":"单括号","DE.Controllers.Toolbar.txtBracket_Square_OpenOpen":"括号","DE.Controllers.Toolbar.txtBracket_SquareDouble":"括号","DE.Controllers.Toolbar.txtBracket_SquareDouble_NoneOpen":"单括号","DE.Controllers.Toolbar.txtBracket_SquareDouble_OpenNone":"单括号","DE.Controllers.Toolbar.txtBracket_UppLim":"括号","DE.Controllers.Toolbar.txtBracket_UppLim_NoneOpen":"单括号","DE.Controllers.Toolbar.txtBracket_UppLim_OpenNone":"单括号","DE.Controllers.Toolbar.txtFractionDiagonal":"倾斜分数","DE.Controllers.Toolbar.txtFractionDifferential_1":"微分","DE.Controllers.Toolbar.txtFractionDifferential_2":"微分","DE.Controllers.Toolbar.txtFractionDifferential_3":"微分","DE.Controllers.Toolbar.txtFractionDifferential_4":"微分","DE.Controllers.Toolbar.txtFractionHorizontal":"线性分数","DE.Controllers.Toolbar.txtFractionPi_2":"π/ 2","DE.Controllers.Toolbar.txtFractionSmall":"小分数","DE.Controllers.Toolbar.txtFractionVertical":"堆积分数","DE.Controllers.Toolbar.txtFunction_1_Cos":"反余弦","DE.Controllers.Toolbar.txtFunction_1_Cosh":"双曲反余弦函数","DE.Controllers.Toolbar.txtFunction_1_Cot":"反余切","DE.Controllers.Toolbar.txtFunction_1_Coth":"双曲反正弦函数","DE.Controllers.Toolbar.txtFunction_1_Csc":"反余割","DE.Controllers.Toolbar.txtFunction_1_Csch":"双曲逆乘功能","DE.Controllers.Toolbar.txtFunction_1_Sec":"反正割","DE.Controllers.Toolbar.txtFunction_1_Sech":"双曲线逆分割函数","DE.Controllers.Toolbar.txtFunction_1_Sin":"反正弦","DE.Controllers.Toolbar.txtFunction_1_Sinh":"双曲反正弦函数","DE.Controllers.Toolbar.txtFunction_1_Tan":"反切线","DE.Controllers.Toolbar.txtFunction_1_Tanh":"双曲反正切函数","DE.Controllers.Toolbar.txtFunction_Cos":"余弦","DE.Controllers.Toolbar.txtFunction_Cosh":"双曲余弦函数","DE.Controllers.Toolbar.txtFunction_Cot":"余切","DE.Controllers.Toolbar.txtFunction_Coth":"双曲正交函数","DE.Controllers.Toolbar.txtFunction_Csc":"余割","DE.Controllers.Toolbar.txtFunction_Csch":"双曲余弦函数","DE.Controllers.Toolbar.txtFunction_Custom_1":"正弦θ","DE.Controllers.Toolbar.txtFunction_Custom_2":"Cos 2x","DE.Controllers.Toolbar.txtFunction_Custom_3":"切线公式","DE.Controllers.Toolbar.txtFunction_Sec":"正割","DE.Controllers.Toolbar.txtFunction_Sech":"双曲正割函数","DE.Controllers.Toolbar.txtFunction_Sin":"正弦","DE.Controllers.Toolbar.txtFunction_Sinh":"双曲正弦函数","DE.Controllers.Toolbar.txtFunction_Tan":"切线","DE.Controllers.Toolbar.txtFunction_Tanh":"双曲正切函数","DE.Controllers.Toolbar.txtIntegral":"积分","DE.Controllers.Toolbar.txtIntegral_dtheta":"差分θ","DE.Controllers.Toolbar.txtIntegral_dx":"差分x","DE.Controllers.Toolbar.txtIntegral_dy":"差分y","DE.Controllers.Toolbar.txtIntegralCenterSubSup":"积分","DE.Controllers.Toolbar.txtIntegralDouble":"双积分","DE.Controllers.Toolbar.txtIntegralDoubleCenterSubSup":"双积分","DE.Controllers.Toolbar.txtIntegralDoubleSubSup":"双积分","DE.Controllers.Toolbar.txtIntegralOriented":"轮廓积分","DE.Controllers.Toolbar.txtIntegralOrientedCenterSubSup":"轮廓积分","DE.Controllers.Toolbar.txtIntegralOrientedDouble":"曲面积分","DE.Controllers.Toolbar.txtIntegralOrientedDoubleCenterSubSup":"曲面积分","DE.Controllers.Toolbar.txtIntegralOrientedDoubleSubSup":"曲面积分","DE.Controllers.Toolbar.txtIntegralOrientedSubSup":"轮廓积分","DE.Controllers.Toolbar.txtIntegralOrientedTriple":"体积积分","DE.Controllers.Toolbar.txtIntegralOrientedTripleCenterSubSup":"体积积分","DE.Controllers.Toolbar.txtIntegralOrientedTripleSubSup":"体积积分","DE.Controllers.Toolbar.txtIntegralSubSup":"积分","DE.Controllers.Toolbar.txtIntegralTriple":"三重积分","DE.Controllers.Toolbar.txtIntegralTripleCenterSubSup":"三重积分","DE.Controllers.Toolbar.txtIntegralTripleSubSup":"三重积分","DE.Controllers.Toolbar.txtLargeOperator_Conjunction":"楔","DE.Controllers.Toolbar.txtLargeOperator_Conjunction_CenterSub":"楔","DE.Controllers.Toolbar.txtLargeOperator_Conjunction_CenterSubSup":"楔","DE.Controllers.Toolbar.txtLargeOperator_Conjunction_Sub":"楔","DE.Controllers.Toolbar.txtLargeOperator_Conjunction_SubSup":"楔","DE.Controllers.Toolbar.txtLargeOperator_CoProd":"副积","DE.Controllers.Toolbar.txtLargeOperator_CoProd_CenterSub":"副积","DE.Controllers.Toolbar.txtLargeOperator_CoProd_CenterSubSup":"副积","DE.Controllers.Toolbar.txtLargeOperator_CoProd_Sub":"副积","DE.Controllers.Toolbar.txtLargeOperator_CoProd_SubSup":"副积","DE.Controllers.Toolbar.txtLargeOperator_Custom_1":"合计","DE.Controllers.Toolbar.txtLargeOperator_Custom_2":"合计","DE.Controllers.Toolbar.txtLargeOperator_Custom_3":"合计","DE.Controllers.Toolbar.txtLargeOperator_Custom_4":"乘积","DE.Controllers.Toolbar.txtLargeOperator_Custom_5":"并集","DE.Controllers.Toolbar.txtLargeOperator_Disjunction":"三角","DE.Controllers.Toolbar.txtLargeOperator_Disjunction_CenterSub":"三角","DE.Controllers.Toolbar.txtLargeOperator_Disjunction_CenterSubSup":"三角","DE.Controllers.Toolbar.txtLargeOperator_Disjunction_Sub":"三角","DE.Controllers.Toolbar.txtLargeOperator_Disjunction_SubSup":"三角","DE.Controllers.Toolbar.txtLargeOperator_Intersection":"交集","DE.Controllers.Toolbar.txtLargeOperator_Intersection_CenterSub":"交集","DE.Controllers.Toolbar.txtLargeOperator_Intersection_CenterSubSup":"交集","DE.Controllers.Toolbar.txtLargeOperator_Intersection_Sub":"交集","DE.Controllers.Toolbar.txtLargeOperator_Intersection_SubSup":"交集","DE.Controllers.Toolbar.txtLargeOperator_Prod":"乘积","DE.Controllers.Toolbar.txtLargeOperator_Prod_CenterSub":"乘积","DE.Controllers.Toolbar.txtLargeOperator_Prod_CenterSubSup":"乘积","DE.Controllers.Toolbar.txtLargeOperator_Prod_Sub":"乘积","DE.Controllers.Toolbar.txtLargeOperator_Prod_SubSup":"乘积","DE.Controllers.Toolbar.txtLargeOperator_Sum":"合计","DE.Controllers.Toolbar.txtLargeOperator_Sum_CenterSub":"合计","DE.Controllers.Toolbar.txtLargeOperator_Sum_CenterSubSup":"合计","DE.Controllers.Toolbar.txtLargeOperator_Sum_Sub":"合计","DE.Controllers.Toolbar.txtLargeOperator_Sum_SubSup":"合计","DE.Controllers.Toolbar.txtLargeOperator_Union":"并集","DE.Controllers.Toolbar.txtLargeOperator_Union_CenterSub":"并集","DE.Controllers.Toolbar.txtLargeOperator_Union_CenterSubSup":"并集","DE.Controllers.Toolbar.txtLargeOperator_Union_Sub":"并集","DE.Controllers.Toolbar.txtLargeOperator_Union_SubSup":"并集","DE.Controllers.Toolbar.txtLimitLog_Custom_1":"极限示例","DE.Controllers.Toolbar.txtLimitLog_Custom_2":"最大范例","DE.Controllers.Toolbar.txtLimitLog_Lim":"极限","DE.Controllers.Toolbar.txtLimitLog_Ln":"自然对数","DE.Controllers.Toolbar.txtLimitLog_Log":"对数","DE.Controllers.Toolbar.txtLimitLog_LogBase":"对数","DE.Controllers.Toolbar.txtLimitLog_Max":"最大值","DE.Controllers.Toolbar.txtLimitLog_Min":"最小值","DE.Controllers.Toolbar.txtMarginsH":"顶部和底部边距对于给定的页面高度来说太高","DE.Controllers.Toolbar.txtMarginsW":"对于给定的页面宽度，左右边距太宽","DE.Controllers.Toolbar.txtMatrix_1_2":"1x2空矩阵","DE.Controllers.Toolbar.txtMatrix_1_3":"1x3空矩阵","DE.Controllers.Toolbar.txtMatrix_2_1":"2x1空矩阵","DE.Controllers.Toolbar.txtMatrix_2_2":"2x2空矩阵","DE.Controllers.Toolbar.txtMatrix_2_2_DLineBracket":"空矩阵与支架","DE.Controllers.Toolbar.txtMatrix_2_2_LineBracket":"空矩阵与支架","DE.Controllers.Toolbar.txtMatrix_2_2_RoundBracket":"空矩阵与支架","DE.Controllers.Toolbar.txtMatrix_2_2_SquareBracket":"空矩阵与支架","DE.Controllers.Toolbar.txtMatrix_2_3":"2x3空矩阵","DE.Controllers.Toolbar.txtMatrix_3_1":"3x1空矩阵","DE.Controllers.Toolbar.txtMatrix_3_2":"3x2空矩阵","DE.Controllers.Toolbar.txtMatrix_3_3":"3x3空矩阵","DE.Controllers.Toolbar.txtMatrix_Dots_Baseline":"基线点","DE.Controllers.Toolbar.txtMatrix_Dots_Center":"中线点","DE.Controllers.Toolbar.txtMatrix_Dots_Diagonal":"对角点","DE.Controllers.Toolbar.txtMatrix_Dots_Vertical":"垂直点","DE.Controllers.Toolbar.txtMatrix_Flat_Round":"稀疏矩阵","DE.Controllers.Toolbar.txtMatrix_Flat_Square":"稀疏矩阵","DE.Controllers.Toolbar.txtMatrix_Identity_2":"2x2个性矩阵","DE.Controllers.Toolbar.txtMatrix_Identity_2_NoZeros":"3x3个性矩阵","DE.Controllers.Toolbar.txtMatrix_Identity_3":"3x3个性矩阵","DE.Controllers.Toolbar.txtMatrix_Identity_3_NoZeros":"3x3个性矩阵","DE.Controllers.Toolbar.txtOperator_ArrowD_Bot":"右左箭头下面","DE.Controllers.Toolbar.txtOperator_ArrowD_Top":"右上方的箭头在上方","DE.Controllers.Toolbar.txtOperator_ArrowL_Bot":"向左箭头","DE.Controllers.Toolbar.txtOperator_ArrowL_Top":"向左箭头","DE.Controllers.Toolbar.txtOperator_ArrowR_Bot":"下面箭头向右","DE.Controllers.Toolbar.txtOperator_ArrowR_Top":"向右箭头上方","DE.Controllers.Toolbar.txtOperator_ColonEquals":"冒号相等","DE.Controllers.Toolbar.txtOperator_Custom_1":"统一","DE.Controllers.Toolbar.txtOperator_Custom_2":"三角形区域","DE.Controllers.Toolbar.txtOperator_Definition":"相等于定义","DE.Controllers.Toolbar.txtOperator_DeltaEquals":"数据相当于","DE.Controllers.Toolbar.txtOperator_DoubleArrowD_Bot":"右左箭头下面","DE.Controllers.Toolbar.txtOperator_DoubleArrowD_Top":"右上方的箭头在上方","DE.Controllers.Toolbar.txtOperator_DoubleArrowL_Bot":"向左箭头","DE.Controllers.Toolbar.txtOperator_DoubleArrowL_Top":"向左箭头","DE.Controllers.Toolbar.txtOperator_DoubleArrowR_Bot":"下面箭头向右","DE.Controllers.Toolbar.txtOperator_DoubleArrowR_Top":"向右箭头上方","DE.Controllers.Toolbar.txtOperator_EqualsEquals":"等于等于","DE.Controllers.Toolbar.txtOperator_MinusEquals":"减号相等","DE.Controllers.Toolbar.txtOperator_PlusEquals":"加上等于","DE.Controllers.Toolbar.txtOperator_UnitOfMeasure":"被测量","DE.Controllers.Toolbar.txtRadicalCustom_1":"部首","DE.Controllers.Toolbar.txtRadicalCustom_2":"部首","DE.Controllers.Toolbar.txtRadicalRoot_2":"平方根","DE.Controllers.Toolbar.txtRadicalRoot_3":"立方根","DE.Controllers.Toolbar.txtRadicalRoot_n":"带有次数的根式","DE.Controllers.Toolbar.txtRadicalSqrt":"平方根","DE.Controllers.Toolbar.txtScriptCustom_1":"脚本","DE.Controllers.Toolbar.txtScriptCustom_2":"脚本","DE.Controllers.Toolbar.txtScriptCustom_3":"脚本","DE.Controllers.Toolbar.txtScriptCustom_4":"脚本","DE.Controllers.Toolbar.txtScriptSub":"下标","DE.Controllers.Toolbar.txtScriptSubSup":"下标","DE.Controllers.Toolbar.txtScriptSubSupLeft":"左标-标注","DE.Controllers.Toolbar.txtScriptSup":"上标","DE.Controllers.Toolbar.txtSymbol_about":"大约","DE.Controllers.Toolbar.txtSymbol_additional":"补集","DE.Controllers.Toolbar.txtSymbol_aleph":"阿列夫","DE.Controllers.Toolbar.txtSymbol_alpha":"Alpha","DE.Controllers.Toolbar.txtSymbol_approx":"几乎相等","DE.Controllers.Toolbar.txtSymbol_ast":"星号运算符","DE.Controllers.Toolbar.txtSymbol_beta":"测试版","DE.Controllers.Toolbar.txtSymbol_beth":"打赌","DE.Controllers.Toolbar.txtSymbol_bullet":"加重号运算符","DE.Controllers.Toolbar.txtSymbol_cap":"交集","DE.Controllers.Toolbar.txtSymbol_cbrt":"立方根","DE.Controllers.Toolbar.txtSymbol_cdots":"中线水平省略号","DE.Controllers.Toolbar.txtSymbol_celsius":"摄氏度","DE.Controllers.Toolbar.txtSymbol_chi":"驰","DE.Controllers.Toolbar.txtSymbol_cong":"大致相等","DE.Controllers.Toolbar.txtSymbol_cup":"并集","DE.Controllers.Toolbar.txtSymbol_ddots":"向右对角线省略号","DE.Controllers.Toolbar.txtSymbol_degree":"度","DE.Controllers.Toolbar.txtSymbol_delta":"参加","DE.Controllers.Toolbar.txtSymbol_div":"除号","DE.Controllers.Toolbar.txtSymbol_downarrow":"向下箭头","DE.Controllers.Toolbar.txtSymbol_emptyset":"空集","DE.Controllers.Toolbar.txtSymbol_epsilon":"小量","DE.Controllers.Toolbar.txtSymbol_equals":"平等","DE.Controllers.Toolbar.txtSymbol_equiv":"相同","DE.Controllers.Toolbar.txtSymbol_eta":"和","DE.Controllers.Toolbar.txtSymbol_exists":"有存在","DE.Controllers.Toolbar.txtSymbol_factorial":"阶乘","DE.Controllers.Toolbar.txtSymbol_fahrenheit":"华氏度","DE.Controllers.Toolbar.txtSymbol_forall":"全部","DE.Controllers.Toolbar.txtSymbol_gamma":"伽马","DE.Controllers.Toolbar.txtSymbol_geq":"大于或等于","DE.Controllers.Toolbar.txtSymbol_gg":"远大于","DE.Controllers.Toolbar.txtSymbol_greater":"大于","DE.Controllers.Toolbar.txtSymbol_in":"元素","DE.Controllers.Toolbar.txtSymbol_inc":"增量","DE.Controllers.Toolbar.txtSymbol_infinity":"无限","DE.Controllers.Toolbar.txtSymbol_iota":"Iota","DE.Controllers.Toolbar.txtSymbol_kappa":"卡帕","DE.Controllers.Toolbar.txtSymbol_lambda":"Lambda","DE.Controllers.Toolbar.txtSymbol_leftarrow":"左箭头","DE.Controllers.Toolbar.txtSymbol_leftrightarrow":"左右箭头","DE.Controllers.Toolbar.txtSymbol_leq":"小于或等于","DE.Controllers.Toolbar.txtSymbol_less":"小于","DE.Controllers.Toolbar.txtSymbol_ll":"远小于","DE.Controllers.Toolbar.txtSymbol_minus":"减去","DE.Controllers.Toolbar.txtSymbol_mp":"减号加","DE.Controllers.Toolbar.txtSymbol_mu":"亩","DE.Controllers.Toolbar.txtSymbol_nabla":"微分算符","DE.Controllers.Toolbar.txtSymbol_neq":"不等于","DE.Controllers.Toolbar.txtSymbol_ni":"包含作为成员","DE.Controllers.Toolbar.txtSymbol_not":"未签名","DE.Controllers.Toolbar.txtSymbol_notexists":"没有存在","DE.Controllers.Toolbar.txtSymbol_nu":"Nu","DE.Controllers.Toolbar.txtSymbol_o":"Omicron","DE.Controllers.Toolbar.txtSymbol_omega":"Omega","DE.Controllers.Toolbar.txtSymbol_partial":"偏微分","DE.Controllers.Toolbar.txtSymbol_percent":"百分比","DE.Controllers.Toolbar.txtSymbol_phi":"Phi","DE.Controllers.Toolbar.txtSymbol_pi":"Pi","DE.Controllers.Toolbar.txtSymbol_plus":"加","DE.Controllers.Toolbar.txtSymbol_pm":"加减","DE.Controllers.Toolbar.txtSymbol_propto":"成比例","DE.Controllers.Toolbar.txtSymbol_psi":"PSI","DE.Controllers.Toolbar.txtSymbol_qdrt":"第四根","DE.Controllers.Toolbar.txtSymbol_qed":"审校结束","DE.Controllers.Toolbar.txtSymbol_rddots":"向右对角线省略号","DE.Controllers.Toolbar.txtSymbol_rho":"Rho","DE.Controllers.Toolbar.txtSymbol_rightarrow":"右箭头","DE.Controllers.Toolbar.txtSymbol_sigma":"Sigma","DE.Controllers.Toolbar.txtSymbol_sqrt":"根号","DE.Controllers.Toolbar.txtSymbol_tau":"战斗","DE.Controllers.Toolbar.txtSymbol_therefore":"因此","DE.Controllers.Toolbar.txtSymbol_theta":"西塔","DE.Controllers.Toolbar.txtSymbol_times":"乘法符号","DE.Controllers.Toolbar.txtSymbol_uparrow":"向上箭头","DE.Controllers.Toolbar.txtSymbol_upsilon":"Upsilon","DE.Controllers.Toolbar.txtSymbol_varepsilon":"Epsilon变体","DE.Controllers.Toolbar.txtSymbol_varphi":"Phi 变量","DE.Controllers.Toolbar.txtSymbol_varpi":"π变量","DE.Controllers.Toolbar.txtSymbol_varrho":"Rho 变量","DE.Controllers.Toolbar.txtSymbol_varsigma":"Sigma变量","DE.Controllers.Toolbar.txtSymbol_vartheta":"西塔","DE.Controllers.Toolbar.txtSymbol_vdots":"垂直省略号","DE.Controllers.Toolbar.txtSymbol_xsi":"粒子","DE.Controllers.Toolbar.txtSymbol_zeta":"Zeta","DE.Controllers.Viewport.textFitPage":"适合页面","DE.Controllers.Viewport.textFitWidth":"适应宽度","DE.Controllers.Viewport.txtDarkMode":"暗黑模式","DE.Views.AddNewCaptionLabelDialog.textLabel":"标签：","DE.Views.AddNewCaptionLabelDialog.textLabelError":"标签不能空","DE.Views.BookmarksDialog.textAdd":"添加","DE.Views.BookmarksDialog.textBookmarkName":"书签名称","DE.Views.BookmarksDialog.textClose":"关闭","DE.Views.BookmarksDialog.textCopy":"复制","DE.Views.BookmarksDialog.textDelete":"删除","DE.Views.BookmarksDialog.textGetLink":"获取链接","DE.Views.BookmarksDialog.textGoto":"转到","DE.Views.BookmarksDialog.textHidden":"隐藏的书签","DE.Views.BookmarksDialog.textLocation":"位置","DE.Views.BookmarksDialog.textName":"名称","DE.Views.BookmarksDialog.textSort":"排序方式","DE.Views.BookmarksDialog.textTitle":"书签","DE.Views.BookmarksDialog.txtInvalidName":"书签名称只能包含字母、数字和下划线，并且应以字母开头","DE.Views.CaptionDialog.textAdd":"添加标签","DE.Views.CaptionDialog.textAfter":"段后","DE.Views.CaptionDialog.textBefore":"段前","DE.Views.CaptionDialog.textCaption":"题注","DE.Views.CaptionDialog.textChapter":"章节起始样式","DE.Views.CaptionDialog.textChapterInc":"包含章节号","DE.Views.CaptionDialog.textColon":"冒号","DE.Views.CaptionDialog.textDash":"破折号","DE.Views.CaptionDialog.textDelete":"删除标签","DE.Views.CaptionDialog.textEquation":"公式","DE.Views.CaptionDialog.textExamples":"例如：表 2-A，图片 1。IV","DE.Views.CaptionDialog.textExclude":"从题注中排除标签","DE.Views.CaptionDialog.textFigure":"图","DE.Views.CaptionDialog.textHyphen":"连字符","DE.Views.CaptionDialog.textInsert":"位置","DE.Views.CaptionDialog.textLabel":"标签","DE.Views.CaptionDialog.textLongDash":"长破折号","DE.Views.CaptionDialog.textNumbering":"编号","DE.Views.CaptionDialog.textPeriod":"时间段","DE.Views.CaptionDialog.textSeparator":"使用分隔符","DE.Views.CaptionDialog.textTable":"表格","DE.Views.CaptionDialog.textTitle":"插入题注","DE.Views.CellsAddDialog.textCol":"列","DE.Views.CellsAddDialog.textDown":"光标下方","DE.Views.CellsAddDialog.textLeft":"向左","DE.Views.CellsAddDialog.textRight":"向右","DE.Views.CellsAddDialog.textRow":"行","DE.Views.CellsAddDialog.textTitle":"插入多行/列","DE.Views.CellsAddDialog.textUp":"光标上方","DE.Views.ChartSettings.text3dDepth":"深度(原始深度百分比)","DE.Views.ChartSettings.text3dHeight":"高度(原始高度百分比)","DE.Views.ChartSettings.text3dRotation":"三维旋转","DE.Views.ChartSettings.textAdvanced":"显示高级设置","DE.Views.ChartSettings.textAutoscale":"自动缩放","DE.Views.ChartSettings.textChartType":"更改图表类型","DE.Views.ChartSettings.textDefault":"默认旋转","DE.Views.ChartSettings.textDown":"向下","DE.Views.ChartSettings.textEditData":"编辑数据","DE.Views.ChartSettings.textHeight":"高度","DE.Views.ChartSettings.textLeft":"向左","DE.Views.ChartSettings.textNarrow":"缩小视野","DE.Views.ChartSettings.textOriginalSize":"实际大小","DE.Views.ChartSettings.textPerspective":"透视","DE.Views.ChartSettings.textRight":"向右","DE.Views.ChartSettings.textRightAngle":"直角坐标轴","DE.Views.ChartSettings.textSize":"大小","DE.Views.ChartSettings.textStyle":"类型","DE.Views.ChartSettings.textUndock":"离开面板","DE.Views.ChartSettings.textUp":"向上","DE.Views.ChartSettings.textWiden":"扩大视野","DE.Views.ChartSettings.textWidth":"宽度","DE.Views.ChartSettings.textWrap":"文字环绕","DE.Views.ChartSettings.textX":"X 旋转","DE.Views.ChartSettings.textY":"Y 旋转","DE.Views.ChartSettings.txtBehind":"衬于​​文字下方","DE.Views.ChartSettings.txtInFront":"浮于文字上方","DE.Views.ChartSettings.txtInline":"嵌入型​​","DE.Views.ChartSettings.txtSquare":"四周型","DE.Views.ChartSettings.txtThrough":"穿越型","DE.Views.ChartSettings.txtTight":"紧密型","DE.Views.ChartSettings.txtTitle":"图表","DE.Views.ChartSettings.txtTopAndBottom":"上下型","DE.Views.ControlSettingsDialog.strGeneral":"常规","DE.Views.ControlSettingsDialog.textAdd":"添加","DE.Views.ControlSettingsDialog.textAppearance":"外观","DE.Views.ControlSettingsDialog.textApplyAll":"全部应用","DE.Views.ControlSettingsDialog.textBox":"边框","DE.Views.ControlSettingsDialog.textChange":"编辑","DE.Views.ControlSettingsDialog.textCheckbox":"复选框","DE.Views.ControlSettingsDialog.textChecked":"勾选符号","DE.Views.ControlSettingsDialog.textColor":"颜色","DE.Views.ControlSettingsDialog.textCombobox":"\n组合框","DE.Views.ControlSettingsDialog.textDate":"日期格式","DE.Views.ControlSettingsDialog.textDelete":"删除","DE.Views.ControlSettingsDialog.textDisplayName":"显示名称","DE.Views.ControlSettingsDialog.textDown":"下","DE.Views.ControlSettingsDialog.textDropDown":"下拉列表","DE.Views.ControlSettingsDialog.textFormat":"这样显示日期","DE.Views.ControlSettingsDialog.textLang":"语言","DE.Views.ControlSettingsDialog.textLock":"锁定","DE.Views.ControlSettingsDialog.textName":"标题","DE.Views.ControlSettingsDialog.textNone":"无","DE.Views.ControlSettingsDialog.textPlaceholder":"占位符","DE.Views.ControlSettingsDialog.textShowAs":"显示为","DE.Views.ControlSettingsDialog.textSystemColor":"系统","DE.Views.ControlSettingsDialog.textTag":"标签","DE.Views.ControlSettingsDialog.textTitle":"内容控制设置","DE.Views.ControlSettingsDialog.textUnchecked":"未选中的符号","DE.Views.ControlSettingsDialog.textUp":"上","DE.Views.ControlSettingsDialog.textValue":"值","DE.Views.ControlSettingsDialog.tipChange":"更改符号","DE.Views.ControlSettingsDialog.txtLockDelete":"无法删除内容控制","DE.Views.ControlSettingsDialog.txtLockEdit":"无法编辑内容","DE.Views.ControlSettingsDialog.txtRemContent":"编辑内容时删除内容控件","DE.Views.CrossReferenceDialog.textAboveBelow":"见上方/见下方","DE.Views.CrossReferenceDialog.textBookmark":"书签","DE.Views.CrossReferenceDialog.textBookmarkText":"书签文字","DE.Views.CrossReferenceDialog.textCaption":"整个标题","DE.Views.CrossReferenceDialog.textEmpty":"请求的引用为空。","DE.Views.CrossReferenceDialog.textEndnote":"尾注","DE.Views.CrossReferenceDialog.textEndNoteNum":"尾注编号","DE.Views.CrossReferenceDialog.textEndNoteNumForm":"尾注编号（带格式）","DE.Views.CrossReferenceDialog.textEquation":"公式","DE.Views.CrossReferenceDialog.textFigure":"图","DE.Views.CrossReferenceDialog.textFootnote":"脚注","DE.Views.CrossReferenceDialog.textHeading":"标题","DE.Views.CrossReferenceDialog.textHeadingNum":"标题号","DE.Views.CrossReferenceDialog.textHeadingNumFull":"标题号 (完整上下文)","DE.Views.CrossReferenceDialog.textHeadingNumNo":"标题号 (无上下文)","DE.Views.CrossReferenceDialog.textHeadingText":"标题文本","DE.Views.CrossReferenceDialog.textIncludeAbove":"包括“见上方”/“见下方”","DE.Views.CrossReferenceDialog.textInsert":"插入","DE.Views.CrossReferenceDialog.textInsertAs":"插入为超链接","DE.Views.CrossReferenceDialog.textLabelNum":"仅标签与标号","DE.Views.CrossReferenceDialog.textNoteNum":"脚注编号","DE.Views.CrossReferenceDialog.textNoteNumForm":"脚注编号（带格式）","DE.Views.CrossReferenceDialog.textOnlyCaption":"仅标注文本","DE.Views.CrossReferenceDialog.textPageNum":"页码","DE.Views.CrossReferenceDialog.textParagraph":"编号项","DE.Views.CrossReferenceDialog.textParaNum":"段落编号","DE.Views.CrossReferenceDialog.textParaNumFull":"段落编号（完整上下文）","DE.Views.CrossReferenceDialog.textParaNumNo":"段落编号（无上下文）","DE.Views.CrossReferenceDialog.textSeparate":"编号分隔符","DE.Views.CrossReferenceDialog.textTable":"表格","DE.Views.CrossReferenceDialog.textText":"段落文字","DE.Views.CrossReferenceDialog.textWhich":"引用哪一个标注","DE.Views.CrossReferenceDialog.textWhichBookmark":"引用哪一个书签","DE.Views.CrossReferenceDialog.textWhichEndnote":"引用哪一个尾注","DE.Views.CrossReferenceDialog.textWhichHeading":"引用哪一个标题","DE.Views.CrossReferenceDialog.textWhichNote":"引用哪一个脚注","DE.Views.CrossReferenceDialog.textWhichPara":"引用哪一个编号项","DE.Views.CrossReferenceDialog.txtReference":"引用内容","DE.Views.CrossReferenceDialog.txtTitle":"交叉引用","DE.Views.CrossReferenceDialog.txtType":"引用类型","DE.Views.CustomColumnsDialog.textColumns":"列数","DE.Views.CustomColumnsDialog.textEqualWidth":"栏宽相等","DE.Views.CustomColumnsDialog.textSeparator":"分割线","DE.Views.CustomColumnsDialog.textTitle":"栏","DE.Views.CustomColumnsDialog.textTitleSpacing":"间距","DE.Views.CustomColumnsDialog.textWidth":"宽度","DE.Views.DateTimeDialog.confirmDefault":"设置{0}：{1}的默认格式","DE.Views.DateTimeDialog.textDefault":"设为默认","DE.Views.DateTimeDialog.textFormat":"格式","DE.Views.DateTimeDialog.textLang":"语言","DE.Views.DateTimeDialog.textUpdate":"自动更新","DE.Views.DateTimeDialog.txtTitle":"日期和时间","DE.Views.DocProtection.hintProtectDoc":"保护文档","DE.Views.DocProtection.txtDocProtectedComment":"文件是受保护的。<br>您仅能对这个文件添加评论。","DE.Views.DocProtection.txtDocProtectedForms":"文件是受保护的。<br>您仅能填写本文件中的字段。","DE.Views.DocProtection.txtDocProtectedTrack":"文件是受保护的。<br>您可以编辑这个文件，但所做的变化都会被跟踪。","DE.Views.DocProtection.txtDocProtectedView":"文件是受保护的。<br>您仅能查看这个文件。","DE.Views.DocProtection.txtDocUnlockDescription":"输入密码以解除文件的保护","DE.Views.DocProtection.txtProtectDoc":"保护文档","DE.Views.DocProtection.txtUnlockTitle":"解除文件保护","DE.Views.DocumentHolder.aboveText":"以上","DE.Views.DocumentHolder.addCommentText":"添加批注","DE.Views.DocumentHolder.advancedDropCapText":"首字下沉选项","DE.Views.DocumentHolder.advancedEquationText":"公式设置","DE.Views.DocumentHolder.advancedFrameText":"框架高级设置","DE.Views.DocumentHolder.advancedParagraphText":"段落高级设置","DE.Views.DocumentHolder.advancedTableText":"表格高级设置","DE.Views.DocumentHolder.advancedText":"高级设置","DE.Views.DocumentHolder.alignmentText":"对齐","DE.Views.DocumentHolder.allLinearText":"全部 - 线性","DE.Views.DocumentHolder.allProfText":"全部 - 专业","DE.Views.DocumentHolder.belowText":"下面","DE.Views.DocumentHolder.breakBeforeText":"段前分页","DE.Views.DocumentHolder.bulletsText":"符号和编号","DE.Views.DocumentHolder.cellAlignText":"单元格垂直对齐","DE.Views.DocumentHolder.cellText":"单元格","DE.Views.DocumentHolder.centerText":"中心","DE.Views.DocumentHolder.chartText":"图表高级设置","DE.Views.DocumentHolder.columnText":"列","DE.Views.DocumentHolder.currLinearText":"当前 - 线性","DE.Views.DocumentHolder.currProfText":"当前 - 专业","DE.Views.DocumentHolder.deleteColumnText":"删除列","DE.Views.DocumentHolder.deleteRowText":"删除行","DE.Views.DocumentHolder.deleteTableText":"删除表格","DE.Views.DocumentHolder.deleteText":"删除","DE.Views.DocumentHolder.direct270Text":"向上旋转文字","DE.Views.DocumentHolder.direct90Text":"向下旋转文字","DE.Views.DocumentHolder.directHText":"水平","DE.Views.DocumentHolder.directionText":"文字方向","DE.Views.DocumentHolder.editChartText":"编辑数据","DE.Views.DocumentHolder.editFooterText":"编辑页脚","DE.Views.DocumentHolder.editHeaderText":"编辑页眉","DE.Views.DocumentHolder.editHyperlinkText":"编辑超链接","DE.Views.DocumentHolder.eqToDisplayText":"更改为显示","DE.Views.DocumentHolder.eqToInlineText":"改成内联","DE.Views.DocumentHolder.guestText":"游客","DE.Views.DocumentHolder.hideEqToolbar":"隐藏公式工具栏","DE.Views.DocumentHolder.hyperlinkText":"超链接","DE.Views.DocumentHolder.ignoreAllSpellText":"忽略所有","DE.Views.DocumentHolder.ignoreSpellText":"忽视","DE.Views.DocumentHolder.imageText":"图片高级设置","DE.Views.DocumentHolder.insertColumnLeftText":"在左侧插入列","DE.Views.DocumentHolder.insertColumnRightText":"在右侧插入列","DE.Views.DocumentHolder.insertColumnText":"插入列","DE.Views.DocumentHolder.insertRowAboveText":"在上方插入行","DE.Views.DocumentHolder.insertRowBelowText":"在下方插入行","DE.Views.DocumentHolder.insertRowText":"插入行","DE.Views.DocumentHolder.insertText":"插入","DE.Views.DocumentHolder.keepLinesText":"段中不分页","DE.Views.DocumentHolder.langText":"选择语言","DE.Views.DocumentHolder.latexText":"LaTeX","DE.Views.DocumentHolder.leftText":"左","DE.Views.DocumentHolder.loadSpellText":"加载变体...","DE.Views.DocumentHolder.mergeCellsText":"合并单元格","DE.Views.DocumentHolder.moreText":"更多变体...","DE.Views.DocumentHolder.noSpellVariantsText":"没有变量","DE.Views.DocumentHolder.notcriticalErrorTitle":"警告","DE.Views.DocumentHolder.originalSizeText":"实际大小","DE.Views.DocumentHolder.paragraphText":"段落","DE.Views.DocumentHolder.removeHyperlinkText":"删除超链接","DE.Views.DocumentHolder.rightText":"右","DE.Views.DocumentHolder.rowText":"行","DE.Views.DocumentHolder.saveStyleText":"新建样式","DE.Views.DocumentHolder.selectCellText":"选择单元格","DE.Views.DocumentHolder.selectColumnText":"选择列","DE.Views.DocumentHolder.selectRowText":"选择行","DE.Views.DocumentHolder.selectTableText":"选择表","DE.Views.DocumentHolder.selectText":"选择","DE.Views.DocumentHolder.shapeText":"形状高级设置","DE.Views.DocumentHolder.showEqToolbar":"显示公式工具栏","DE.Views.DocumentHolder.spellcheckText":"拼写检查","DE.Views.DocumentHolder.splitCellsText":"拆分单元格","DE.Views.DocumentHolder.splitCellTitleText":"拆分单元格","DE.Views.DocumentHolder.strDelete":"删除签名","DE.Views.DocumentHolder.strDetails":"签名详情","DE.Views.DocumentHolder.strSetup":"签名设置","DE.Views.DocumentHolder.strSign":"签名","DE.Views.DocumentHolder.styleText":"保存为样式","DE.Views.DocumentHolder.tableText":"表格","DE.Views.DocumentHolder.textAccept":"接受变化","DE.Views.DocumentHolder.textAlign":"对齐方式","DE.Views.DocumentHolder.textArrange":"排列","DE.Views.DocumentHolder.textArrangeBack":"置于底层","DE.Views.DocumentHolder.textArrangeBackward":"下移一层","DE.Views.DocumentHolder.textArrangeForward":"上移一层","DE.Views.DocumentHolder.textArrangeFront":"置于顶层","DE.Views.DocumentHolder.textCells":"单元格","DE.Views.DocumentHolder.textCol":"删除整列","DE.Views.DocumentHolder.textContentControls":"内容控制","DE.Views.DocumentHolder.textContinueNumbering":"继续编号","DE.Views.DocumentHolder.textCopy":"复制","DE.Views.DocumentHolder.textCrop":"裁剪","DE.Views.DocumentHolder.textCropFill":"填充","DE.Views.DocumentHolder.textCropFit":"最佳","DE.Views.DocumentHolder.textCut":"剪切","DE.Views.DocumentHolder.textDistributeCols":"平均分布各列","DE.Views.DocumentHolder.textDistributeRows":"平均分布各行","DE.Views.DocumentHolder.textEditControls":"内容控制设置","DE.Views.DocumentHolder.textEditPoints":"编辑顶点","DE.Views.DocumentHolder.textEditWrapBoundary":"编辑环绕边界","DE.Views.DocumentHolder.textFlipH":"水平翻转","DE.Views.DocumentHolder.textFlipV":"垂直翻转","DE.Views.DocumentHolder.textFollow":"跟随移动","DE.Views.DocumentHolder.textFromFile":"从文件导入","DE.Views.DocumentHolder.textFromStorage":"来自存储设备","DE.Views.DocumentHolder.textFromUrl":"从URL","DE.Views.DocumentHolder.textIndents":"调整列表缩进","DE.Views.DocumentHolder.textJoinList":"联接上一个列表","DE.Views.DocumentHolder.textLeft":"单元格左移","DE.Views.DocumentHolder.textNest":"下一个表格","DE.Views.DocumentHolder.textNextPage":"下一页","DE.Views.DocumentHolder.textNumberingValue":"编号值","DE.Views.DocumentHolder.textPaste":"粘贴","DE.Views.DocumentHolder.textPrevPage":"上一页","DE.Views.DocumentHolder.textRefreshField":"更新字段","DE.Views.DocumentHolder.textReject":"拒绝变化","DE.Views.DocumentHolder.textRemCheckBox":"删除多选框","DE.Views.DocumentHolder.textRemComboBox":"删除组合框","DE.Views.DocumentHolder.textRemDropdown":"删除候选列表","DE.Views.DocumentHolder.textRemField":"删除文本填充框","DE.Views.DocumentHolder.textRemove":"删除","DE.Views.DocumentHolder.textRemoveControl":"删除内容控件","DE.Views.DocumentHolder.textRemPicture":"删除图片","DE.Views.DocumentHolder.textRemRadioBox":"删除单选框","DE.Views.DocumentHolder.textReplace":"更改图片","DE.Views.DocumentHolder.textRotate":"旋转","DE.Views.DocumentHolder.textRotate270":"逆时针旋转90°","DE.Views.DocumentHolder.textRotate90":"顺时针旋转90°","DE.Views.DocumentHolder.textRow":"删除整行","DE.Views.DocumentHolder.textSaveAsPicture":"另存为图片","DE.Views.DocumentHolder.textSeparateList":"分隔列表","DE.Views.DocumentHolder.textSettings":"设置","DE.Views.DocumentHolder.textSeveral":"多行/多列","DE.Views.DocumentHolder.textShapeAlignBottom":"底端对齐","DE.Views.DocumentHolder.textShapeAlignCenter":"水平居中","DE.Views.DocumentHolder.textShapeAlignLeft":"左对齐","DE.Views.DocumentHolder.textShapeAlignMiddle":"垂直居中","DE.Views.DocumentHolder.textShapeAlignRight":"右对齐","DE.Views.DocumentHolder.textShapeAlignTop":"顶端对齐","DE.Views.DocumentHolder.textStartNewList":"开始新列表","DE.Views.DocumentHolder.textStartNumberingFrom":"设置编号值","DE.Views.DocumentHolder.textTitleCellsRemove":"删除单元格","DE.Views.DocumentHolder.textTOC":"目录","DE.Views.DocumentHolder.textTOCSettings":"目录设置","DE.Views.DocumentHolder.textUndo":"撤消","DE.Views.DocumentHolder.textUpdateAll":"更新整个目录","DE.Views.DocumentHolder.textUpdatePages":"仅更新页码","DE.Views.DocumentHolder.textUpdateTOC":"更新目录","DE.Views.DocumentHolder.textWrap":"文字环绕","DE.Views.DocumentHolder.tipIsLocked":"此元素正在由其他用户编辑。","DE.Views.DocumentHolder.toDictionaryText":"添加到词典","DE.Views.DocumentHolder.txtAddBottom":"添加底部边框","DE.Views.DocumentHolder.txtAddFractionBar":"添加分数栏","DE.Views.DocumentHolder.txtAddHor":"在相同样式的段落之间添加间隔","DE.Views.DocumentHolder.txtAddLB":"添加左下线","DE.Views.DocumentHolder.txtAddLeft":"添加左边框","DE.Views.DocumentHolder.txtAddLT":"添加左上线","DE.Views.DocumentHolder.txtAddRight":"添加右边框","DE.Views.DocumentHolder.txtAddTop":"添加顶部边框","DE.Views.DocumentHolder.txtAddVer":"添加垂直线","DE.Views.DocumentHolder.txtAlignToChar":"字符对齐","DE.Views.DocumentHolder.txtBehind":"衬于​​文字下方","DE.Views.DocumentHolder.txtBorderProps":"边框属性","DE.Views.DocumentHolder.txtBottom":"底部","DE.Views.DocumentHolder.txtColumnAlign":"列对齐","DE.Views.DocumentHolder.txtDecreaseArg":"减少大小参数","DE.Views.DocumentHolder.txtDeleteArg":"删除参数","DE.Views.DocumentHolder.txtDeleteBreak":"删除手动的断点","DE.Views.DocumentHolder.txtDeleteChars":"删除包围字符","DE.Views.DocumentHolder.txtDeleteCharsAndSeparators":"删除封闭字符和分隔符","DE.Views.DocumentHolder.txtDeleteEq":"删除公式","DE.Views.DocumentHolder.txtDeleteGroupChar":"删除字符","DE.Views.DocumentHolder.txtDeleteRadical":"彻底删除","DE.Views.DocumentHolder.txtDistribHor":"水平分布","DE.Views.DocumentHolder.txtDistribVert":"垂直分布","DE.Views.DocumentHolder.txtEmpty":"（空）","DE.Views.DocumentHolder.txtFractionLinear":"改为线性分数","DE.Views.DocumentHolder.txtFractionSkewed":"改为倾斜分数","DE.Views.DocumentHolder.txtFractionStacked":"改为堆积分数","DE.Views.DocumentHolder.txtGroup":"组合","DE.Views.DocumentHolder.txtGroupCharOver":"字符在文字上","DE.Views.DocumentHolder.txtGroupCharUnder":"文字下的Char","DE.Views.DocumentHolder.txtHideBottom":"隐藏底部边框","DE.Views.DocumentHolder.txtHideBottomLimit":"隐藏下限","DE.Views.DocumentHolder.txtHideCloseBracket":"隐藏右括号","DE.Views.DocumentHolder.txtHideDegree":"隐藏学位","DE.Views.DocumentHolder.txtHideHor":"隐藏水平线","DE.Views.DocumentHolder.txtHideLB":"隐藏左侧底线","DE.Views.DocumentHolder.txtHideLeft":"隐藏左边界","DE.Views.DocumentHolder.txtHideLT":"隐藏左顶线","DE.Views.DocumentHolder.txtHideOpenBracket":"隐藏开放支架","DE.Views.DocumentHolder.txtHidePlaceholder":"隐藏占位符","DE.Views.DocumentHolder.txtHideRight":"隐藏右边框","DE.Views.DocumentHolder.txtHideTop":"隐藏顶部边框","DE.Views.DocumentHolder.txtHideTopLimit":"隐藏上限","DE.Views.DocumentHolder.txtHideVer":"隐藏垂直线","DE.Views.DocumentHolder.txtIncreaseArg":"增加参数大小","DE.Views.DocumentHolder.txtInFront":"浮于文字上方","DE.Views.DocumentHolder.txtInline":"嵌入型​​","DE.Views.DocumentHolder.txtInsertArgAfter":"插入参数","DE.Views.DocumentHolder.txtInsertArgBefore":"之前插入参数","DE.Views.DocumentHolder.txtInsertBreak":"插入手动中断","DE.Views.DocumentHolder.txtInsertCaption":"插入标题","DE.Views.DocumentHolder.txtInsertEqAfter":"插入公式后","DE.Views.DocumentHolder.txtInsertEqBefore":"之前插入公式","DE.Views.DocumentHolder.txtInsImage":"插入图片","DE.Views.DocumentHolder.txtInsImageUrl":"插入在线图片","DE.Views.DocumentHolder.txtKeepTextOnly":"只保留文本","DE.Views.DocumentHolder.txtLimitChange":"更改限制位置","DE.Views.DocumentHolder.txtLimitOver":"限制文字","DE.Views.DocumentHolder.txtLimitUnder":"在文本限制","DE.Views.DocumentHolder.txtMatchBrackets":"匹配括号到参数高度","DE.Views.DocumentHolder.txtMatrixAlign":"矩阵对齐","DE.Views.DocumentHolder.txtOverbar":"文本上一条","DE.Views.DocumentHolder.txtOverwriteCells":"覆盖单元格","DE.Views.DocumentHolder.txtPasteSourceFormat":"保留源格式","DE.Views.DocumentHolder.txtPressLink":"按{0}并单击链接","DE.Views.DocumentHolder.txtPrintSelection":"打印选择","DE.Views.DocumentHolder.txtRemFractionBar":"去除分数吧","DE.Views.DocumentHolder.txtRemLimit":"删除限制","DE.Views.DocumentHolder.txtRemoveAccentChar":"删除重音字符","DE.Views.DocumentHolder.txtRemoveBar":"删除栏","DE.Views.DocumentHolder.txtRemoveWarning":"要删除该签名吗？<br>这一操作不能被撤销。","DE.Views.DocumentHolder.txtRemScripts":"删除上下标","DE.Views.DocumentHolder.txtRemSubscript":"删除标","DE.Views.DocumentHolder.txtRemSuperscript":"除去上标","DE.Views.DocumentHolder.txtScriptsAfter":"文字后的上下标","DE.Views.DocumentHolder.txtScriptsBefore":"文字前的上下标","DE.Views.DocumentHolder.txtShowBottomLimit":"显示下限","DE.Views.DocumentHolder.txtShowCloseBracket":"显示关闭括号","DE.Views.DocumentHolder.txtShowDegree":"显示学位","DE.Views.DocumentHolder.txtShowOpenBracket":"显示开放支架","DE.Views.DocumentHolder.txtShowPlaceholder":"显示占位符","DE.Views.DocumentHolder.txtShowTopLimit":"显示上限","DE.Views.DocumentHolder.txtSquare":"四周型","DE.Views.DocumentHolder.txtStretchBrackets":"拉伸支架","DE.Views.DocumentHolder.txtThrough":"穿越型","DE.Views.DocumentHolder.txtTight":"紧密型","DE.Views.DocumentHolder.txtTop":"顶部","DE.Views.DocumentHolder.txtTopAndBottom":"上下型","DE.Views.DocumentHolder.txtUnderbar":"在文本栏","DE.Views.DocumentHolder.txtUngroup":"取消组合","DE.Views.DocumentHolder.txtWarnUrl":"点击该链接可能会损害你的设备或数据。<br>你确定要继续吗？","DE.Views.DocumentHolder.unicodeText":"Unicode","DE.Views.DocumentHolder.updateStyleText":"更新%1样式","DE.Views.DocumentHolder.vertAlignText":"垂直对齐","DE.Views.DropcapSettingsAdvanced.strBorders":"边框和底纹","DE.Views.DropcapSettingsAdvanced.strDropcap":"首字下沉 ","DE.Views.DropcapSettingsAdvanced.strMargins":"边距","DE.Views.DropcapSettingsAdvanced.textAlign":"对齐方式","DE.Views.DropcapSettingsAdvanced.textAtLeast":"至少","DE.Views.DropcapSettingsAdvanced.textAuto":"自动","DE.Views.DropcapSettingsAdvanced.textBackColor":"背景颜色","DE.Views.DropcapSettingsAdvanced.textBorderColor":"边框颜色","DE.Views.DropcapSettingsAdvanced.textBorderDesc":"点击图表或使用按钮选择边框","DE.Views.DropcapSettingsAdvanced.textBorderWidth":"边框宽度","DE.Views.DropcapSettingsAdvanced.textBottom":"底部","DE.Views.DropcapSettingsAdvanced.textCenter":"中心","DE.Views.DropcapSettingsAdvanced.textColumn":"列","DE.Views.DropcapSettingsAdvanced.textDistance":"距正文","DE.Views.DropcapSettingsAdvanced.textExact":"精确地","DE.Views.DropcapSettingsAdvanced.textFlow":"流程框架","DE.Views.DropcapSettingsAdvanced.textFont":"字体","DE.Views.DropcapSettingsAdvanced.textFrame":"框架","DE.Views.DropcapSettingsAdvanced.textHeight":"高度","DE.Views.DropcapSettingsAdvanced.textHorizontal":"水平","DE.Views.DropcapSettingsAdvanced.textInline":"内联框架","DE.Views.DropcapSettingsAdvanced.textInMargin":"悬挂","DE.Views.DropcapSettingsAdvanced.textInText":"下沉","DE.Views.DropcapSettingsAdvanced.textLeft":"左","DE.Views.DropcapSettingsAdvanced.textMargin":"页边距","DE.Views.DropcapSettingsAdvanced.textMove":"文字移动","DE.Views.DropcapSettingsAdvanced.textNone":"无","DE.Views.DropcapSettingsAdvanced.textPage":"页面","DE.Views.DropcapSettingsAdvanced.textParagraph":"段落","DE.Views.DropcapSettingsAdvanced.textParameters":"参数","DE.Views.DropcapSettingsAdvanced.textPosition":"位置","DE.Views.DropcapSettingsAdvanced.textRelative":"相对于","DE.Views.DropcapSettingsAdvanced.textRight":"对","DE.Views.DropcapSettingsAdvanced.textRowHeight":"行高","DE.Views.DropcapSettingsAdvanced.textTitle":"首字下沉 - 高级设置","DE.Views.DropcapSettingsAdvanced.textTitleFrame":"框架 - 高级设置","DE.Views.DropcapSettingsAdvanced.textTop":"顶部","DE.Views.DropcapSettingsAdvanced.textVertical":"垂直","DE.Views.DropcapSettingsAdvanced.textWidth":"宽度","DE.Views.DropcapSettingsAdvanced.tipFontName":"字体","DE.Views.EditListItemDialog.textDisplayName":"显示名称","DE.Views.EditListItemDialog.textNameError":"显示名称不能空","DE.Views.EditListItemDialog.textValue":"值","DE.Views.EditListItemDialog.textValueError":"已存在具有相同值的项","DE.Views.FileMenu.btnBackCaption":"打开文件所在位置","DE.Views.FileMenu.btnCloseMenuCaption":"关闭菜单","DE.Views.FileMenu.btnCreateNewCaption":"新建","DE.Views.FileMenu.btnDownloadCaption":"另存为","DE.Views.FileMenu.btnExitCaption":"关闭","DE.Views.FileMenu.btnFileOpenCaption":"打开","DE.Views.FileMenu.btnHelpCaption":"帮助","DE.Views.FileMenu.btnHistoryCaption":"版本历史","DE.Views.FileMenu.btnInfoCaption":"文档信息","DE.Views.FileMenu.btnPrintCaption":"打印","DE.Views.FileMenu.btnProtectCaption":"保护","DE.Views.FileMenu.btnRecentFilesCaption":"最近打开","DE.Views.FileMenu.btnRenameCaption":"改名","DE.Views.FileMenu.btnReturnCaption":"返回文件","DE.Views.FileMenu.btnRightsCaption":"访问权","DE.Views.FileMenu.btnSaveAsCaption":"另存为","DE.Views.FileMenu.btnSaveCaption":"保存","DE.Views.FileMenu.btnSaveCopyAsCaption":"将副本另存为","DE.Views.FileMenu.btnSettingsCaption":"高级设置","DE.Views.FileMenu.btnSetDefaultCaption":"设为默认应用","DE.Views.FileMenu.btnFeedbackCaption":"反馈","DE.Views.FileMenu.btnUnInstallCaption":"卸载","DE.Views.FileMenu.btnEnableOnlineCaption":"开启在线文档预览/编辑","DE.Views.FileMenu.btnDisableOnlineCaption":"关闭在线文档预览/编辑","DE.Views.FileMenu.btnDownloadOnlineCaption":"下载文档","DE.Views.FileMenu.btnToEditCaption":"编辑文档","DE.Views.FileMenu.textDownload":"下载","DE.Views.FileMenuPanels.CreateNew.txtBlank":"空文档","DE.Views.FileMenuPanels.CreateNew.txtCreateNew":"新建","DE.Views.FileMenuPanels.DocumentInfo.okButtonText":"应用","DE.Views.FileMenuPanels.DocumentInfo.txtAddAuthor":"添加作者","DE.Views.FileMenuPanels.DocumentInfo.txtAddText":"添加文字","DE.Views.FileMenuPanels.DocumentInfo.txtAppName":"应用","DE.Views.FileMenuPanels.DocumentInfo.txtAuthor":"作者","DE.Views.FileMenuPanels.DocumentInfo.txtBtnAccessRights":"更改访问权限","DE.Views.FileMenuPanels.DocumentInfo.txtComment":"批注","DE.Views.FileMenuPanels.DocumentInfo.txtCreated":"已创建","DE.Views.FileMenuPanels.DocumentInfo.txtDocumentInfo":"文档信息","DE.Views.FileMenuPanels.DocumentInfo.txtFastWV":"快速Web视图","DE.Views.FileMenuPanels.DocumentInfo.txtLoading":"载入中……","DE.Views.FileMenuPanels.DocumentInfo.txtModifyBy":"上次修改者","DE.Views.FileMenuPanels.DocumentInfo.txtModifyDate":"上次修改时间","DE.Views.FileMenuPanels.DocumentInfo.txtNo":"否","DE.Views.FileMenuPanels.DocumentInfo.txtOwner":"创建者","DE.Views.FileMenuPanels.DocumentInfo.txtPages":"页数","DE.Views.FileMenuPanels.DocumentInfo.txtPageSize":"页面大小","DE.Views.FileMenuPanels.DocumentInfo.txtParagraphs":"段落","DE.Views.FileMenuPanels.DocumentInfo.txtPdfProducer":"PDF制作器","DE.Views.FileMenuPanels.DocumentInfo.txtPdfTagged":"已标记为PDF","DE.Views.FileMenuPanels.DocumentInfo.txtPdfVer":"PDF版","DE.Views.FileMenuPanels.DocumentInfo.txtPlacement":"位置","DE.Views.FileMenuPanels.DocumentInfo.txtRights":"有权利的人","DE.Views.FileMenuPanels.DocumentInfo.txtSpaces":"字符数(计空格)","DE.Views.FileMenuPanels.DocumentInfo.txtStatistics":"统计","DE.Views.FileMenuPanels.DocumentInfo.txtSubject":"主题","DE.Views.FileMenuPanels.DocumentInfo.txtSymbols":"字符数(不计空格)","DE.Views.FileMenuPanels.DocumentInfo.txtTags":"标签","DE.Views.FileMenuPanels.DocumentInfo.txtTitle":"标题","DE.Views.FileMenuPanels.DocumentInfo.txtUploaded":"上载","DE.Views.FileMenuPanels.DocumentInfo.txtWords":"单词","DE.Views.FileMenuPanels.DocumentInfo.txtYes":"是","DE.Views.FileMenuPanels.DocumentRights.txtAccessRights":"访问权限","DE.Views.FileMenuPanels.DocumentRights.txtBtnAccessRights":"更改访问权限","DE.Views.FileMenuPanels.DocumentRights.txtRights":"有权利的人","DE.Views.FileMenuPanels.ProtectDoc.notcriticalErrorTitle":"警告","DE.Views.FileMenuPanels.ProtectDoc.strEncrypt":"使用密码","DE.Views.FileMenuPanels.ProtectDoc.strProtect":"保护文档","DE.Views.FileMenuPanels.ProtectDoc.strSignature":"使用签名","DE.Views.FileMenuPanels.ProtectDoc.txtAddedSignature":"有效的签名已被添加到文件中。<br>该文件受保护，无法编辑。","DE.Views.FileMenuPanels.ProtectDoc.txtAddSignature":"<br>添加一个不可见的数字签名可确保文件的完整性","DE.Views.FileMenuPanels.ProtectDoc.txtEdit":"编辑文档","DE.Views.FileMenuPanels.ProtectDoc.txtEditWarning":"编辑将删除文档中的签名。<br>您确定要继续吗？","DE.Views.FileMenuPanels.ProtectDoc.txtEncrypted":"此文档受密码保护","DE.Views.FileMenuPanels.ProtectDoc.txtProtectDocument":"对该文件进行密码加密","DE.Views.FileMenuPanels.ProtectDoc.txtRequestedSignatures":"此文档需要签名。","DE.Views.FileMenuPanels.ProtectDoc.txtSigned":"有效签名已添加到文档中。该文档受到保护，无法编辑。","DE.Views.FileMenuPanels.ProtectDoc.txtSignedInvalid":"文档中的某些数字签名无效或无法验证。该文档受到保护，无法编辑。","DE.Views.FileMenuPanels.ProtectDoc.txtView":"查看签名","DE.Views.FileMenuPanels.RecentFiles.txtOpenRecent":"打开最近文件","DE.Views.FileMenuPanels.Settings.okButtonText":"应用","DE.Views.FileMenuPanels.Settings.strCoAuthMode":"共同编辑模式","DE.Views.FileMenuPanels.Settings.strFast":"自动","DE.Views.FileMenuPanels.Settings.strFontRender":"字体微调方式","DE.Views.FileMenuPanels.Settings.strIgnoreWordsInUPPERCASE":"忽略大写单词","DE.Views.FileMenuPanels.Settings.strIgnoreWordsWithNumbers":"忽略带数字的单词","DE.Views.FileMenuPanels.Settings.strMacrosSettings":"宏设置","DE.Views.FileMenuPanels.Settings.strPasteButton":"在执行粘贴操作后显示“粘贴选项”按钮","DE.Views.FileMenuPanels.Settings.strShowChanges":"实时协作变更","DE.Views.FileMenuPanels.Settings.strShowComments":"在文本中显示注释","DE.Views.FileMenuPanels.Settings.strShowOthersChanges":"显示其他用户的更改","DE.Views.FileMenuPanels.Settings.strShowResolvedComments":"显示已解决的注释","DE.Views.FileMenuPanels.Settings.strStrict":"手动","DE.Views.FileMenuPanels.Settings.strTheme":"界面主题","DE.Views.FileMenuPanels.Settings.strUnit":"测量单位","DE.Views.FileMenuPanels.Settings.strZoom":"默认缩放比率","DE.Views.FileMenuPanels.Settings.text10Minutes":"每10分钟","DE.Views.FileMenuPanels.Settings.text30Minutes":"每30分钟","DE.Views.FileMenuPanels.Settings.text5Minutes":"每5分钟","DE.Views.FileMenuPanels.Settings.text60Minutes":"每隔一小时","DE.Views.FileMenuPanels.Settings.textAlignGuides":"对齐辅助线","DE.Views.FileMenuPanels.Settings.textAutoRecover":"自动恢复","DE.Views.FileMenuPanels.Settings.textAutoSave":"自动保存","DE.Views.FileMenuPanels.Settings.textDisabled":"已禁用","DE.Views.FileMenuPanels.Settings.textForceSave":"在保存中间版本","DE.Views.FileMenuPanels.Settings.textMinute":"每一分钟","DE.Views.FileMenuPanels.Settings.textOldVersions":"使用与旧版微软 Word 兼容的方式保存 DOCX 文档","DE.Views.FileMenuPanels.Settings.textSmartSelection":"使用智能段落选择","DE.Views.FileMenuPanels.Settings.txtAdvancedSettings":"高级设置","DE.Views.FileMenuPanels.Settings.txtAll":"查看全部","DE.Views.FileMenuPanels.Settings.txtAutoCorrect":"自动修正选项...","DE.Views.FileMenuPanels.Settings.txtCacheMode":"默认缓存模式","DE.Views.FileMenuPanels.Settings.txtChangesBalloons":"点击通知气球以展示","DE.Views.FileMenuPanels.Settings.txtChangesTip":"光标移至弹出窗口以展示","DE.Views.FileMenuPanels.Settings.txtCm":"厘米","DE.Views.FileMenuPanels.Settings.txtCollaboration":"协作","DE.Views.FileMenuPanels.Settings.txtDarkMode":"开启文档夜间模式","DE.Views.FileMenuPanels.Settings.txtEditingSaving":"编辑并保存","DE.Views.FileMenuPanels.Settings.txtFastTip":"实时协同编辑。所有","DE.Views.FileMenuPanels.Settings.txtFitPage":"适合页面","DE.Views.FileMenuPanels.Settings.txtFitWidth":"适应宽度","DE.Views.FileMenuPanels.Settings.txtHieroglyphs":"特殊符号","DE.Views.FileMenuPanels.Settings.txtInch":"寸","DE.Views.FileMenuPanels.Settings.txtLast":"最后查看","DE.Views.FileMenuPanels.Settings.txtLastUsed":"最后一次使用","DE.Views.FileMenuPanels.Settings.txtMac":"仿照 OS X","DE.Views.FileMenuPanels.Settings.txtNative":"本机系统原生","DE.Views.FileMenuPanels.Settings.txtNone":"无查看","DE.Views.FileMenuPanels.Settings.txtProofing":"校对","DE.Views.FileMenuPanels.Settings.txtPt":"点","DE.Views.FileMenuPanels.Settings.txtQuickPrint":"在编辑器标题中显示快速打印按钮","DE.Views.FileMenuPanels.Settings.txtQuickPrintTip":"文件将用最新选定的打印机或默认的打印机被打印出来。","DE.Views.FileMenuPanels.Settings.txtRunMacros":"启动所有项目","DE.Views.FileMenuPanels.Settings.txtRunMacrosDesc":"启动所有不带通知的宏","DE.Views.FileMenuPanels.Settings.txtShowTrackChanges":"显示跟踪变化","DE.Views.FileMenuPanels.Settings.txtSpellCheck":"拼写检查","DE.Views.FileMenuPanels.Settings.txtStopMacros":"解除所有项目","DE.Views.FileMenuPanels.Settings.txtStopMacrosDesc":"解除所有不带通知的宏","DE.Views.FileMenuPanels.Settings.txtStrictTip":'使用“保存"按钮同步你和其他人的修改',"DE.Views.FileMenuPanels.Settings.txtUseAltKey":"使用键盘上的Alt键导航至用户界面","DE.Views.FileMenuPanels.Settings.txtUseOptionKey":"使用键盘上的Option键导航至用户界面","DE.Views.FileMenuPanels.Settings.txtWarnMacros":"显示通知","DE.Views.FileMenuPanels.Settings.txtWarnMacrosDesc":"解除所有带通知的宏","DE.Views.FileMenuPanels.Settings.txtWin":"仿照 Windows","DE.Views.FileMenuPanels.Settings.txtWorkspace":"工作空间","DE.Views.FileMenuPanels.ViewSaveAs.textDownloadAs":"另存为","DE.Views.FileMenuPanels.ViewSaveCopy.textSaveCopyAs":"将副本另存为","DE.Views.FormSettings.textAlways":"总是","DE.Views.FormSettings.textAnyone":"任何人","DE.Views.FormSettings.textAspect":"锁定宽高比","DE.Views.FormSettings.textAtLeast":"至少","DE.Views.FormSettings.textAuto":"自动","DE.Views.FormSettings.textAutofit":"自动适应","DE.Views.FormSettings.textBackgroundColor":"背景颜色","DE.Views.FormSettings.textCheckbox":"多选框","DE.Views.FormSettings.textCheckDefault":"默认情况下，复选框为选中","DE.Views.FormSettings.textColor":"边框颜色","DE.Views.FormSettings.textComb":"字符组合","DE.Views.FormSettings.textCombobox":"\n组合框","DE.Views.FormSettings.textComplex":"复合字段","DE.Views.FormSettings.textConnected":"关联字段","DE.Views.FormSettings.textCreditCard":"信用卡号码（如：4111-1111-1111-1111）","DE.Views.FormSettings.textDateField":"日期与时间字段","DE.Views.FormSettings.textDateFormat":"这样显示日期","DE.Views.FormSettings.textDefValue":"默认值","DE.Views.FormSettings.textDelete":"删除","DE.Views.FormSettings.textDigits":"数字","DE.Views.FormSettings.textDisconnect":"断开","DE.Views.FormSettings.textDropDown":"候选列表","DE.Views.FormSettings.textExact":"精确","DE.Views.FormSettings.textField":"文字字段","DE.Views.FormSettings.textFillRoles":"谁需要填写这个？","DE.Views.FormSettings.textFixed":"固定填充框大小","DE.Views.FormSettings.textFormat":"格式","DE.Views.FormSettings.textFormatSymbols":"可用符号","DE.Views.FormSettings.textFromFile":"从文件导入","DE.Views.FormSettings.textFromStorage":"来自存储设备","DE.Views.FormSettings.textFromUrl":"从URL","DE.Views.FormSettings.textGroupKey":"群组密钥","DE.Views.FormSettings.textImage":"图片","DE.Views.FormSettings.textKey":"密钥","DE.Views.FormSettings.textLang":"语言","DE.Views.FormSettings.textLetters":"文字","DE.Views.FormSettings.textLock":"锁定","DE.Views.FormSettings.textMask":"任意掩码","DE.Views.FormSettings.textMaxChars":"字数限制","DE.Views.FormSettings.textMulti":"多行填充框","DE.Views.FormSettings.textNever":"从不","DE.Views.FormSettings.textNoBorder":"无边框","DE.Views.FormSettings.textNone":"无","DE.Views.FormSettings.textPhone1":"电话号码（如：(123) 456-7890）","DE.Views.FormSettings.textPhone2":"电话号码（如：+447911123456）","DE.Views.FormSettings.textPlaceholder":"占位符","DE.Views.FormSettings.textRadiobox":"单选框","DE.Views.FormSettings.textRadioDefault":"默认情况下，按钮被选中","DE.Views.FormSettings.textReg":"正则表达式","DE.Views.FormSettings.textRequired":"必填","DE.Views.FormSettings.textScale":"何时按倍缩放？","DE.Views.FormSettings.textSelectImage":"选择图片","DE.Views.FormSettings.textTag":"标签","DE.Views.FormSettings.textTip":"提示","DE.Views.FormSettings.textTipAdd":"新增值","DE.Views.FormSettings.textTipDelete":"刪除值","DE.Views.FormSettings.textTipDown":"下移","DE.Views.FormSettings.textTipUp":"上移","DE.Views.FormSettings.textTooBig":"图片过大","DE.Views.FormSettings.textTooSmall":"图片较小","DE.Views.FormSettings.textUKPassport":"英国护照号码（如：925665416）","DE.Views.FormSettings.textUnlock":"解锁","DE.Views.FormSettings.textUSSSN":"美国 SSN (如：123-45-6789)","DE.Views.FormSettings.textValue":"值设置","DE.Views.FormSettings.textWidth":"单元格宽度","DE.Views.FormSettings.textZipCodeUS":"美国邮政编码（如：92663 或 92663-1234）","DE.Views.FormsTab.capBtnCheckBox":"多选框","DE.Views.FormsTab.capBtnComboBox":"组合框","DE.Views.FormsTab.capBtnComplex":"复合字段","DE.Views.FormsTab.capBtnDownloadForm":"下载为oform","DE.Views.FormsTab.capBtnDropDown":"候选列表","DE.Views.FormsTab.capBtnEmail":"Email地址","DE.Views.FormsTab.capBtnImage":"图片","DE.Views.FormsTab.capBtnManager":"管理角色","DE.Views.FormsTab.capBtnNext":"下一填充框","DE.Views.FormsTab.capBtnPhone":"电话号码","DE.Views.FormsTab.capBtnPrev":"上一填充框","DE.Views.FormsTab.capBtnRadioBox":"单选框","DE.Views.FormsTab.capBtnSaveForm":"另存为oform","DE.Views.FormsTab.capBtnSubmit":"提交","DE.Views.FormsTab.capBtnText":"文字字段","DE.Views.FormsTab.capBtnView":"浏览表单","DE.Views.FormsTab.capCreditCard":"信用卡","DE.Views.FormsTab.capDateTime":"日期与时间","DE.Views.FormsTab.capZipCode":"邮政编码","DE.Views.FormsTab.textAnyone":"任何人","DE.Views.FormsTab.textClear":"清除填充框","DE.Views.FormsTab.textClearFields":"清除所有字段","DE.Views.FormsTab.textCreateForm":"添加字段并创建一个可填充的OFORM文件","DE.Views.FormsTab.textGotIt":"明白了","DE.Views.FormsTab.textHighlight":"高亮设置","DE.Views.FormsTab.textNoHighlight":"无高亮","DE.Views.FormsTab.textRequired":"要发送表单，请填写所有必填项目。","DE.Views.FormsTab.textSubmited":"成功提交表单","DE.Views.FormsTab.tipCheckBox":"插入多选框","DE.Views.FormsTab.tipComboBox":"插入组合框","DE.Views.FormsTab.tipComplexField":"插入复合字段","DE.Views.FormsTab.tipCreditCard":"插入信用卡号码","DE.Views.FormsTab.tipDateTime":"插入日期与时间","DE.Views.FormsTab.tipDownloadForm":"下载一个文件填写","DE.Views.FormsTab.tipDropDown":"插入候选列表","DE.Views.FormsTab.tipEmailField":"插入电邮地址","DE.Views.FormsTab.tipFixedText":"插入固定文本字段","DE.Views.FormsTab.tipImageField":"插入图片","DE.Views.FormsTab.tipInlineText":"插入内嵌文本字段","DE.Views.FormsTab.tipManager":"管理角色","DE.Views.FormsTab.tipNextForm":"前往下一填充框","DE.Views.FormsTab.tipPhoneField":"插入电话号码","DE.Views.FormsTab.tipPrevForm":"回到上一填充框","DE.Views.FormsTab.tipRadioBox":"添加单选框","DE.Views.FormsTab.tipSaveForm":"将文件保存为可填充的OFORM文件","DE.Views.FormsTab.tipSubmit":"提交表单","DE.Views.FormsTab.tipTextField":"插入文本框","DE.Views.FormsTab.tipViewForm":"视图窗体","DE.Views.FormsTab.tipZipCode":"插入邮政编码","DE.Views.FormsTab.txtFixedDesc":"插入固定文本字段","DE.Views.FormsTab.txtFixedText":"固定","DE.Views.FormsTab.txtInlineDesc":"插入内嵌文本字段","DE.Views.FormsTab.txtInlineText":"内嵌","DE.Views.FormsTab.txtUntitled":"无标题","DE.Views.HeaderFooterSettings.textBottomCenter":"底部中心","DE.Views.HeaderFooterSettings.textBottomLeft":"左下","DE.Views.HeaderFooterSettings.textBottomPage":"页面底部","DE.Views.HeaderFooterSettings.textBottomRight":"右下","DE.Views.HeaderFooterSettings.textDiffFirst":"首页不同","DE.Views.HeaderFooterSettings.textDiffOdd":"奇偶页不同","DE.Views.HeaderFooterSettings.textFrom":"开始","DE.Views.HeaderFooterSettings.textHeaderFromBottom":"底端距离","DE.Views.HeaderFooterSettings.textHeaderFromTop":"顶端距离","DE.Views.HeaderFooterSettings.textInsertCurrent":"插入到当前位置","DE.Views.HeaderFooterSettings.textOptions":"选项","DE.Views.HeaderFooterSettings.textPageNum":"插入页码","DE.Views.HeaderFooterSettings.textPageNumbering":"页码编号","DE.Views.HeaderFooterSettings.textPosition":"位置","DE.Views.HeaderFooterSettings.textPrev":"从上一节继续","DE.Views.HeaderFooterSettings.textSameAs":"链接到前一条页眉","DE.Views.HeaderFooterSettings.textTopCenter":"顶部中心","DE.Views.HeaderFooterSettings.textTopLeft":"左上","DE.Views.HeaderFooterSettings.textTopPage":"页面顶部","DE.Views.HeaderFooterSettings.textTopRight":"右上","DE.Views.HyperlinkSettingsDialog.textDefault":"所选文本片段","DE.Views.HyperlinkSettingsDialog.textDisplay":"要显示的文字","DE.Views.HyperlinkSettingsDialog.textExternal":"外部链接","DE.Views.HyperlinkSettingsDialog.textInternal":"本文档中的位置","DE.Views.HyperlinkSettingsDialog.textTitle":"插入超链接","DE.Views.HyperlinkSettingsDialog.textTooltip":"屏幕提示文字","DE.Views.HyperlinkSettingsDialog.textUrl":"链接到","DE.Views.HyperlinkSettingsDialog.txtBeginning":"文档开头","DE.Views.HyperlinkSettingsDialog.txtBookmarks":"书签","DE.Views.HyperlinkSettingsDialog.txtEmpty":"这是必填栏","DE.Views.HyperlinkSettingsDialog.txtHeadings":"标题","DE.Views.HyperlinkSettingsDialog.txtNotUrl":"该字段应该是“http://www.example.com”格式的URL","DE.Views.HyperlinkSettingsDialog.txtSizeLimit":"该域字符限制为2803个。","DE.Views.HyphenationDialog.textAuto":"自动连字符","DE.Views.HyphenationDialog.textCaps":"连字符大写字母","DE.Views.HyphenationDialog.textLimit":"将连续连字符限制为","DE.Views.HyphenationDialog.textNoLimit":"无限制","DE.Views.HyphenationDialog.textTitle":"连字符","DE.Views.HyphenationDialog.textZone":"连字符区","DE.Views.ImageSettings.textAdvanced":"显示高级设置","DE.Views.ImageSettings.textCrop":"裁剪","DE.Views.ImageSettings.textCropFill":"填充","DE.Views.ImageSettings.textCropFit":"最佳","DE.Views.ImageSettings.textCropToShape":"裁剪为形状","DE.Views.ImageSettings.textEdit":"修改","DE.Views.ImageSettings.textEditObject":"编辑对象","DE.Views.ImageSettings.textFitMargins":"适合边距","DE.Views.ImageSettings.textFlip":"翻转","DE.Views.ImageSettings.textFromFile":"从文件导入","DE.Views.ImageSettings.textFromStorage":"来自存储设备","DE.Views.ImageSettings.textFromUrl":"从URL","DE.Views.ImageSettings.textHeight":"高度","DE.Views.ImageSettings.textHint270":"逆时针旋转90°","DE.Views.ImageSettings.textHint90":"顺时针旋转90°","DE.Views.ImageSettings.textHintFlipH":"水平翻转","DE.Views.ImageSettings.textHintFlipV":"垂直翻转","DE.Views.ImageSettings.textInsert":"更改图片","DE.Views.ImageSettings.textOriginalSize":"实际大小","DE.Views.ImageSettings.textRecentlyUsed":"最近使用的","DE.Views.ImageSettings.textRotate90":"旋转90°","DE.Views.ImageSettings.textRotation":"旋转","DE.Views.ImageSettings.textSize":"大小","DE.Views.ImageSettings.textWidth":"宽度","DE.Views.ImageSettings.textWrap":"文字环绕","DE.Views.ImageSettings.txtBehind":"衬于​​文字下方","DE.Views.ImageSettings.txtInFront":"浮于文字上方","DE.Views.ImageSettings.txtInline":"嵌入型​​","DE.Views.ImageSettings.txtSquare":"四周型","DE.Views.ImageSettings.txtThrough":"穿越型","DE.Views.ImageSettings.txtTight":"紧密型","DE.Views.ImageSettings.txtTopAndBottom":"上下型","DE.Views.ImageSettingsAdvanced.strMargins":"边距","DE.Views.ImageSettingsAdvanced.textAbsoluteWH":"绝对值","DE.Views.ImageSettingsAdvanced.textAlignment":"对齐方式","DE.Views.ImageSettingsAdvanced.textAlt":"替代文字","DE.Views.ImageSettingsAdvanced.textAltDescription":"说明","DE.Views.ImageSettingsAdvanced.textAltTip":"视觉对象信息的替代基于文本的表示法，将要向有视觉或认知障碍人阅读，以帮助他们更好地了解图片、自选图形、图表或表格中的那些信息。","DE.Views.ImageSettingsAdvanced.textAltTitle":"标题","DE.Views.ImageSettingsAdvanced.textAngle":"角度","DE.Views.ImageSettingsAdvanced.textArrows":"箭头","DE.Views.ImageSettingsAdvanced.textAspectRatio":"锁定宽高比","DE.Views.ImageSettingsAdvanced.textAutofit":"自动适应","DE.Views.ImageSettingsAdvanced.textBeginSize":"前端大小","DE.Views.ImageSettingsAdvanced.textBeginStyle":"前端类型","DE.Views.ImageSettingsAdvanced.textBelow":"下侧","DE.Views.ImageSettingsAdvanced.textBevel":"棱台","DE.Views.ImageSettingsAdvanced.textBottom":"下","DE.Views.ImageSettingsAdvanced.textBottomMargin":"下边距","DE.Views.ImageSettingsAdvanced.textBtnWrap":"文字环绕","DE.Views.ImageSettingsAdvanced.textCapType":"端点类型","DE.Views.ImageSettingsAdvanced.textCenter":"中心","DE.Views.ImageSettingsAdvanced.textCharacter":"字符","DE.Views.ImageSettingsAdvanced.textColumn":"分栏","DE.Views.ImageSettingsAdvanced.textDistance":"距正文","DE.Views.ImageSettingsAdvanced.textEndSize":"末端大小","DE.Views.ImageSettingsAdvanced.textEndStyle":"末端类型","DE.Views.ImageSettingsAdvanced.textFlat":"平面","DE.Views.ImageSettingsAdvanced.textFlipped":"翻转","DE.Views.ImageSettingsAdvanced.textHeight":"高度","DE.Views.ImageSettingsAdvanced.textHorizontal":"水平","DE.Views.ImageSettingsAdvanced.textHorizontally":"水平","DE.Views.ImageSettingsAdvanced.textJoinType":"联接类型","DE.Views.ImageSettingsAdvanced.textKeepRatio":"锁定纵横比","DE.Views.ImageSettingsAdvanced.textLeft":"左","DE.Views.ImageSettingsAdvanced.textLeftMargin":"左边距","DE.Views.ImageSettingsAdvanced.textLine":"行","DE.Views.ImageSettingsAdvanced.textLineStyle":"线条","DE.Views.ImageSettingsAdvanced.textMargin":"页边距","DE.Views.ImageSettingsAdvanced.textMiter":"斜接","DE.Views.ImageSettingsAdvanced.textMove":"对象随文字移动","DE.Views.ImageSettingsAdvanced.textOptions":"选项","DE.Views.ImageSettingsAdvanced.textOriginalSize":"实际大小","DE.Views.ImageSettingsAdvanced.textOverlap":"允许重叠","DE.Views.ImageSettingsAdvanced.textPage":"页面","DE.Views.ImageSettingsAdvanced.textParagraph":"段落","DE.Views.ImageSettingsAdvanced.textPosition":"位置","DE.Views.ImageSettingsAdvanced.textPositionAbs":"绝对位置","DE.Views.ImageSettingsAdvanced.textPositionPc":"相对位置","DE.Views.ImageSettingsAdvanced.textRelative":"相对于","DE.Views.ImageSettingsAdvanced.textRelativeWH":"相对值","DE.Views.ImageSettingsAdvanced.textResizeFit":"根据文字调整形状大小","DE.Views.ImageSettingsAdvanced.textRight":"右","DE.Views.ImageSettingsAdvanced.textRightMargin":"右边距","DE.Views.ImageSettingsAdvanced.textRightOf":"右侧","DE.Views.ImageSettingsAdvanced.textRotation":"旋转","DE.Views.ImageSettingsAdvanced.textRound":"圆形","DE.Views.ImageSettingsAdvanced.textShape":"形状设置","DE.Views.ImageSettingsAdvanced.textSize":"大小","DE.Views.ImageSettingsAdvanced.textSquare":"正方形","DE.Views.ImageSettingsAdvanced.textTextBox":"文本框","DE.Views.ImageSettingsAdvanced.textTitle":"图片 - 高级设置","DE.Views.ImageSettingsAdvanced.textTitleChart":"图表 - 高级设置","DE.Views.ImageSettingsAdvanced.textTitleShape":"形状 - 高级设置","DE.Views.ImageSettingsAdvanced.textTop":"上","DE.Views.ImageSettingsAdvanced.textTopMargin":"上边距","DE.Views.ImageSettingsAdvanced.textVertical":"垂直","DE.Views.ImageSettingsAdvanced.textVertically":"垂直","DE.Views.ImageSettingsAdvanced.textWeightArrows":"线条和箭头","DE.Views.ImageSettingsAdvanced.textWidth":"宽度","DE.Views.ImageSettingsAdvanced.textWrap":"文字环绕","DE.Views.ImageSettingsAdvanced.textWrapBehindTooltip":"衬于​​文字下方","DE.Views.ImageSettingsAdvanced.textWrapInFrontTooltip":"浮于文字上方","DE.Views.ImageSettingsAdvanced.textWrapInlineTooltip":"嵌入型​​","DE.Views.ImageSettingsAdvanced.textWrapSquareTooltip":"四周型","DE.Views.ImageSettingsAdvanced.textWrapThroughTooltip":"穿越型","DE.Views.ImageSettingsAdvanced.textWrapTightTooltip":"紧密型","DE.Views.ImageSettingsAdvanced.textWrapTopbottomTooltip":"上下型","DE.Views.LeftMenu.tipAbout":"关于","DE.Views.LeftMenu.tipChat":"聊天","DE.Views.LeftMenu.tipComments":"批注","DE.Views.LeftMenu.tipNavigation":"导航","DE.Views.LeftMenu.tipOutline":"目录","DE.Views.LeftMenu.tipPageThumbnails":"页面缩略图","DE.Views.LeftMenu.tipPlugins":"插件","DE.Views.LeftMenu.tipSearch":"搜索","DE.Views.LeftMenu.tipSupport":"反馈和支持","DE.Views.LeftMenu.tipTitles":"标题","DE.Views.LeftMenu.txtDeveloper":"开发者模式","DE.Views.LeftMenu.txtEditor":"文字编辑器","DE.Views.LeftMenu.txtLimit":"限制访问","DE.Views.LeftMenu.txtTrial":"试用模式","DE.Views.LeftMenu.txtTrialDev":"试用开发者模式","DE.Views.LineNumbersDialog.textAddLineNumbering":"新增行号","DE.Views.LineNumbersDialog.textApplyTo":"应用更改","DE.Views.LineNumbersDialog.textContinuous":"连续","DE.Views.LineNumbersDialog.textCountBy":"计数依据","DE.Views.LineNumbersDialog.textDocument":"整个文件","DE.Views.LineNumbersDialog.textForward":"从该处起","DE.Views.LineNumbersDialog.textFromText":"来自文本","DE.Views.LineNumbersDialog.textNumbering":"编号","DE.Views.LineNumbersDialog.textRestartEachPage":"每页重编行号","DE.Views.LineNumbersDialog.textRestartEachSection":"每节重编行号","DE.Views.LineNumbersDialog.textSection":"当前部分","DE.Views.LineNumbersDialog.textStartAt":"始于","DE.Views.LineNumbersDialog.textTitle":"行号","DE.Views.LineNumbersDialog.txtAutoText":"自动","DE.Views.Links.capBtnAddText":"添加文字","DE.Views.Links.capBtnBookmarks":"书签","DE.Views.Links.capBtnCaption":"题注","DE.Views.Links.capBtnContentsUpdate":"更新目录","DE.Views.Links.capBtnCrossRef":"交叉引用","DE.Views.Links.capBtnInsContents":"目录","DE.Views.Links.capBtnInsFootnote":"脚注","DE.Views.Links.capBtnInsLink":"超链接","DE.Views.Links.capBtnTOF":"图表目录","DE.Views.Links.confirmDeleteFootnotes":"您要删除所有脚注吗？","DE.Views.Links.confirmReplaceTOF":"确认替换选中的图表目录？","DE.Views.Links.mniConvertNote":"转换所有注释","DE.Views.Links.mniDelFootnote":"删除所有注释","DE.Views.Links.mniInsEndnote":"插入尾注","DE.Views.Links.mniInsFootnote":"插入脚注","DE.Views.Links.mniNoteSettings":"更多设置","DE.Views.Links.textContentsRemove":"删除目录","DE.Views.Links.textContentsSettings":"自定义目录","DE.Views.Links.textConvertToEndnotes":"脚注全部转换成尾注","DE.Views.Links.textConvertToFootnotes":"尾注全部转换成脚注","DE.Views.Links.textGotoEndnote":"转到尾注","DE.Views.Links.textGotoFootnote":"转到脚注","DE.Views.Links.textSwapNotes":"脚注和尾注相互转换","DE.Views.Links.textUpdateAll":"更新整个目录","DE.Views.Links.textUpdatePages":"只更新页码","DE.Views.Links.tipAddText":"包括标题在","DE.Views.Links.tipBookmarks":"创建书签","DE.Views.Links.tipCaption":"插入题注","DE.Views.Links.tipContents":"插入目录","DE.Views.Links.tipContentsUpdate":"更新目录","DE.Views.Links.tipCrossRef":"插入交叉引用","DE.Views.Links.tipInsertHyperlink":"添加超链接","DE.Views.Links.tipNotes":"插入或编辑脚注","DE.Views.Links.tipTableFigures":"插入图表目录","DE.Views.Links.tipTableFiguresUpdate":"更新图表目录","DE.Views.Links.titleUpdateTOF":"更新图表目录","DE.Views.Links.txtDontShowTof":"不在目录中显示","DE.Views.Links.txtLevel":"级","DE.Views.ListIndentsDialog.textSpace":"空格","DE.Views.ListIndentsDialog.textTab":"制表符","DE.Views.ListIndentsDialog.textTitle":"列表缩进","DE.Views.ListIndentsDialog.txtFollowBullet":"点符后的第一个符号","DE.Views.ListIndentsDialog.txtFollowNumber":"编号后的第一个符号","DE.Views.ListIndentsDialog.txtIndent":"文本缩进","DE.Views.ListIndentsDialog.txtNone":"无","DE.Views.ListIndentsDialog.txtPosBullet":"项目符号位置","DE.Views.ListIndentsDialog.txtPosNumber":"编号位置","DE.Views.ListSettingsDialog.textAuto":"自动","DE.Views.ListSettingsDialog.textBold":"粗体","DE.Views.ListSettingsDialog.textCenter":"居中","DE.Views.ListSettingsDialog.textHide":"隐藏设置","DE.Views.ListSettingsDialog.textItalic":"斜体","DE.Views.ListSettingsDialog.textLeft":"左对齐","DE.Views.ListSettingsDialog.textLevel":"级别","DE.Views.ListSettingsDialog.textMore":"显示更多设置","DE.Views.ListSettingsDialog.textPreview":"预览","DE.Views.ListSettingsDialog.textRight":"右对齐","DE.Views.ListSettingsDialog.textSelectLevel":"选择级别","DE.Views.ListSettingsDialog.textSpace":"空格","DE.Views.ListSettingsDialog.textTab":"制表符","DE.Views.ListSettingsDialog.txtAlign":"对齐方式","DE.Views.ListSettingsDialog.txtAlignAt":"位置","DE.Views.ListSettingsDialog.txtBullet":"项目符号","DE.Views.ListSettingsDialog.txtColor":"颜色","DE.Views.ListSettingsDialog.txtFollow":"编号后的第一个符号","DE.Views.ListSettingsDialog.txtFontName":"字体 ","DE.Views.ListSettingsDialog.txtInclcudeLevel":"包含级别编号","DE.Views.ListSettingsDialog.txtIndent":"文本缩进","DE.Views.ListSettingsDialog.txtLikeText":"与文字相同","DE.Views.ListSettingsDialog.txtMoreTypes":"更多类型","DE.Views.ListSettingsDialog.txtNewBullet":"自定义符号...","DE.Views.ListSettingsDialog.txtNone":"无","DE.Views.ListSettingsDialog.txtNumFormatString":"数字格式","DE.Views.ListSettingsDialog.txtRestart":"重新创建列表","DE.Views.ListSettingsDialog.txtSize":"大小","DE.Views.ListSettingsDialog.txtStart":"起始编号：","DE.Views.ListSettingsDialog.txtSymbol":"符号","DE.Views.ListSettingsDialog.txtTabStop":"制表位添加位置：","DE.Views.ListSettingsDialog.txtTitle":"定义新项目符号","DE.Views.ListSettingsDialog.txtType":"类型","DE.Views.ListTypesAdvanced.labelSelect":"选择列表类型","DE.Views.MailMergeEmailDlg.filePlaceholder":"PDF","DE.Views.MailMergeEmailDlg.okButtonText":"发送","DE.Views.MailMergeEmailDlg.subjectPlaceholder":"主题","DE.Views.MailMergeEmailDlg.textAttachDocx":"作为DOCX附加","DE.Views.MailMergeEmailDlg.textAttachPdf":"附上PDF","DE.Views.MailMergeEmailDlg.textFileName":"文件名","DE.Views.MailMergeEmailDlg.textFormat":"邮件格式","DE.Views.MailMergeEmailDlg.textFrom":"从","DE.Views.MailMergeEmailDlg.textHTML":"超文本标记语言","DE.Views.MailMergeEmailDlg.textMessage":"消息","DE.Views.MailMergeEmailDlg.textSubject":"标题","DE.Views.MailMergeEmailDlg.textTitle":"发送到电子邮件","DE.Views.MailMergeEmailDlg.textTo":"到","DE.Views.MailMergeEmailDlg.textWarning":"警告！","DE.Views.MailMergeEmailDlg.textWarningMsg":"请注意，一旦您点击“发送”按钮，邮件无法停止。","DE.Views.MailMergeSettings.downloadMergeTitle":"合并","DE.Views.MailMergeSettings.errorMailMergeSaveFile":"合并失败","DE.Views.MailMergeSettings.notcriticalErrorTitle":"警告","DE.Views.MailMergeSettings.textAddRecipients":"首先将一些收件人添加到列表中","DE.Views.MailMergeSettings.textAll":"所有记录","DE.Views.MailMergeSettings.textCurrent":"当前记录","DE.Views.MailMergeSettings.textDataSource":"数据来源","DE.Views.MailMergeSettings.textDocx":"Docx","DE.Views.MailMergeSettings.textDownload":"下载","DE.Views.MailMergeSettings.textEditData":"编辑收件人列表","DE.Views.MailMergeSettings.textEmail":"电子邮件","DE.Views.MailMergeSettings.textFrom":"从","DE.Views.MailMergeSettings.textGoToMail":"转到邮件","DE.Views.MailMergeSettings.textHighlight":"突出显示合并字段","DE.Views.MailMergeSettings.textInsertField":"插入合并字段","DE.Views.MailMergeSettings.textMaxRecepients":"最多100位收件人。","DE.Views.MailMergeSettings.textMerge":"合并","DE.Views.MailMergeSettings.textMergeFields":"合并字段","DE.Views.MailMergeSettings.textMergeTo":"合并到","DE.Views.MailMergeSettings.textPdf":"PDF","DE.Views.MailMergeSettings.textPortal":"保存","DE.Views.MailMergeSettings.textPreview":"预览结果","DE.Views.MailMergeSettings.textReadMore":"了解更多","DE.Views.MailMergeSettings.textSendMsg":"所有邮件都已准备就绪，并会在一段时间内发出。<br>邮件的速度取决于您的邮件服务,您可以继续使用文档或关闭它。操作结束后，通知将发送到您的注册邮箱地址。","DE.Views.MailMergeSettings.textTo":"到","DE.Views.MailMergeSettings.txtFirst":"首先记录","DE.Views.MailMergeSettings.txtFromToError":"From”值必须小于“To”值","DE.Views.MailMergeSettings.txtLast":"到下一个记录","DE.Views.MailMergeSettings.txtNext":"到下一个记录","DE.Views.MailMergeSettings.txtPrev":"以前的记录","DE.Views.MailMergeSettings.txtUntitled":"无标题","DE.Views.MailMergeSettings.warnProcessMailMerge":"启动合并失败","DE.Views.Navigation.strNavigate":"目录","DE.Views.Navigation.txtClosePanel":"关闭目录","DE.Views.Navigation.txtCollapse":"全部折叠","DE.Views.Navigation.txtDemote":"降级","DE.Views.Navigation.txtEmpty":"文档中无目录。<br>文本中应用标题样式以便使其出现在目录中。","DE.Views.Navigation.txtEmptyItem":"空标题","DE.Views.Navigation.txtEmptyViewer":"文档中无目录。","DE.Views.Navigation.txtExpand":"全部展开","DE.Views.Navigation.txtExpandToLevel":"显示标题级别","DE.Views.Navigation.txtFontSize":"字号","DE.Views.Navigation.txtHeadingAfter":"在后面插入新标题","DE.Views.Navigation.txtHeadingBefore":"在前面插入新标题","DE.Views.Navigation.txtLarge":"大","DE.Views.Navigation.txtMedium":"中","DE.Views.Navigation.txtNewHeading":"新建副标题","DE.Views.Navigation.txtPromote":"升级","DE.Views.Navigation.txtSelect":"选择标题和内容","DE.Views.Navigation.txtSettings":"目录设置","DE.Views.Navigation.txtSmall":"小","DE.Views.Navigation.txtWrapHeadings":"长标题换行","DE.Views.NoteSettingsDialog.textApply":"应用","DE.Views.NoteSettingsDialog.textApplyTo":"应用更改","DE.Views.NoteSettingsDialog.textContinue":"连续","DE.Views.NoteSettingsDialog.textCustom":"自定义标记","DE.Views.NoteSettingsDialog.textDocEnd":"文档结尾","DE.Views.NoteSettingsDialog.textDocument":"整篇文档","DE.Views.NoteSettingsDialog.textEachPage":"重新启动每一页","DE.Views.NoteSettingsDialog.textEachSection":"重新启动每一节","DE.Views.NoteSettingsDialog.textEndnote":"尾注","DE.Views.NoteSettingsDialog.textFootnote":"脚注","DE.Views.NoteSettingsDialog.textFormat":"格式","DE.Views.NoteSettingsDialog.textInsert":"插入","DE.Views.NoteSettingsDialog.textLocation":"位置","DE.Views.NoteSettingsDialog.textNumbering":"编号","DE.Views.NoteSettingsDialog.textNumFormat":"编号格式","DE.Views.NoteSettingsDialog.textPageBottom":"页面底端","DE.Views.NoteSettingsDialog.textSectEnd":"节的结尾","DE.Views.NoteSettingsDialog.textSection":"本节","DE.Views.NoteSettingsDialog.textStart":"起始编号","DE.Views.NoteSettingsDialog.textTextBottom":"文字下方","DE.Views.NoteSettingsDialog.textTitle":"脚注和尾注","DE.Views.NotesRemoveDialog.textEnd":"刪除所有尾注","DE.Views.NotesRemoveDialog.textFoot":"删除所有脚注","DE.Views.NotesRemoveDialog.textTitle":"删除注释","DE.Views.PageMarginsDialog.notcriticalErrorTitle":"警告","DE.Views.PageMarginsDialog.textBottom":"下","DE.Views.PageMarginsDialog.textGutter":" 装订线","DE.Views.PageMarginsDialog.textGutterPosition":" 装订线位置","DE.Views.PageMarginsDialog.textInside":"内侧","DE.Views.PageMarginsDialog.textLandscape":"横向","DE.Views.PageMarginsDialog.textLeft":"左","DE.Views.PageMarginsDialog.textMirrorMargins":"对称页边距","DE.Views.PageMarginsDialog.textMultiplePages":"多页","DE.Views.PageMarginsDialog.textNormal":"普通","DE.Views.PageMarginsDialog.textOrientation":"方向","DE.Views.PageMarginsDialog.textOutside":"外侧","DE.Views.PageMarginsDialog.textPortrait":"纵向","DE.Views.PageMarginsDialog.textPreview":"预览","DE.Views.PageMarginsDialog.textRight":"右","DE.Views.PageMarginsDialog.textTitle":"页边距","DE.Views.PageMarginsDialog.textTop":"上","DE.Views.PageMarginsDialog.txtMarginsH":"顶部和底部边距对于给定的页面高度来说太高","DE.Views.PageMarginsDialog.txtMarginsW":"对于给定的页面宽度，左右边距太宽","DE.Views.PageSizeDialog.textHeight":"高度","DE.Views.PageSizeDialog.textPreset":"预设","DE.Views.PageSizeDialog.textTitle":"页面大小","DE.Views.PageSizeDialog.textWidth":"宽度","DE.Views.PageSizeDialog.txtCustom":"自定义","DE.Views.PageThumbnails.textClosePanel":"关闭页面缩略图","DE.Views.PageThumbnails.textHighlightVisiblePart":"突出显示页面的可见部分","DE.Views.PageThumbnails.textPageThumbnails":"页面缩略图","DE.Views.PageThumbnails.textThumbnailsSettings":"缩略图设置","DE.Views.PageThumbnails.textThumbnailsSize":"缩略图大小","DE.Views.ParagraphSettings.strIndent":"缩进","DE.Views.ParagraphSettings.strIndentsLeftText":"左侧","DE.Views.ParagraphSettings.strIndentsRightText":"右侧","DE.Views.ParagraphSettings.strIndentsSpecial":"特殊格式","DE.Views.ParagraphSettings.strLineHeight":"行间距","DE.Views.ParagraphSettings.strParagraphSpacing":"段落间距","DE.Views.ParagraphSettings.strSomeParagraphSpace":"不要在相同样式的段落之间添加间隔","DE.Views.ParagraphSettings.strSpacingAfter":"段后","DE.Views.ParagraphSettings.strSpacingBefore":"段前","DE.Views.ParagraphSettings.textAdvanced":"显示高级设置","DE.Views.ParagraphSettings.textAt":"在","DE.Views.ParagraphSettings.textAtLeast":"最小值","DE.Views.ParagraphSettings.textAuto":"多倍行距","DE.Views.ParagraphSettings.textBackColor":"背景颜色","DE.Views.ParagraphSettings.textExact":"固定值","DE.Views.ParagraphSettings.textFirstLine":"首行缩进","DE.Views.ParagraphSettings.textHanging":"悬挂缩进","DE.Views.ParagraphSettings.textNoneSpecial":"（无）","DE.Views.ParagraphSettings.txtAutoText":"自动","DE.Views.ParagraphSettingsAdvanced.noTabs":"指定的选项卡将显示在此字段中","DE.Views.ParagraphSettingsAdvanced.strAllCaps":"全部大写字母","DE.Views.ParagraphSettingsAdvanced.strBorders":"边框和底纹","DE.Views.ParagraphSettingsAdvanced.strBreakBefore":"段前分页","DE.Views.ParagraphSettingsAdvanced.strDoubleStrike":"双删除线","DE.Views.ParagraphSettingsAdvanced.strIndent":"缩进","DE.Views.ParagraphSettingsAdvanced.strIndentsLeftText":"左侧","DE.Views.ParagraphSettingsAdvanced.strIndentsLineSpacing":"行间距","DE.Views.ParagraphSettingsAdvanced.strIndentsOutlinelevel":"大纲级别","DE.Views.ParagraphSettingsAdvanced.strIndentsRightText":"右侧","DE.Views.ParagraphSettingsAdvanced.strIndentsSpacingAfter":"段后","DE.Views.ParagraphSettingsAdvanced.strIndentsSpacingBefore":"段前","DE.Views.ParagraphSettingsAdvanced.strIndentsSpecial":"特殊格式","DE.Views.ParagraphSettingsAdvanced.strKeepLines":"段中不分页","DE.Views.ParagraphSettingsAdvanced.strKeepNext":"与下段同页","DE.Views.ParagraphSettingsAdvanced.strMargins":"内间距","DE.Views.ParagraphSettingsAdvanced.strOrphan":"孤行控制","DE.Views.ParagraphSettingsAdvanced.strParagraphFont":"字体","DE.Views.ParagraphSettingsAdvanced.strParagraphIndents":"缩进和间距","DE.Views.ParagraphSettingsAdvanced.strParagraphLine":"换行和分页","DE.Views.ParagraphSettingsAdvanced.strParagraphPosition":"放置","DE.Views.ParagraphSettingsAdvanced.strSmallCaps":"小型大写字母","DE.Views.ParagraphSettingsAdvanced.strSomeParagraphSpace":"不要在相同样式的段落间增加间距","DE.Views.ParagraphSettingsAdvanced.strSpacing":"间距","DE.Views.ParagraphSettingsAdvanced.strStrike":"删除线","DE.Views.ParagraphSettingsAdvanced.strSubscript":"下标","DE.Views.ParagraphSettingsAdvanced.strSuperscript":"上标","DE.Views.ParagraphSettingsAdvanced.strSuppressLineNumbers":"取消行号","DE.Views.ParagraphSettingsAdvanced.strTabs":"制表位","DE.Views.ParagraphSettingsAdvanced.textAlign":"对齐方式","DE.Views.ParagraphSettingsAdvanced.textAll":"所有","DE.Views.ParagraphSettingsAdvanced.textAtLeast":"最小值","DE.Views.ParagraphSettingsAdvanced.textAuto":"多倍行距","DE.Views.ParagraphSettingsAdvanced.textBackColor":"背景颜色","DE.Views.ParagraphSettingsAdvanced.textBodyText":"正文文本","DE.Views.ParagraphSettingsAdvanced.textBorderColor":"边框颜色","DE.Views.ParagraphSettingsAdvanced.textBorderDesc":"点击图表或使用按钮选择边框并将选择的样式应用于它们","DE.Views.ParagraphSettingsAdvanced.textBorderWidth":"边框宽度","DE.Views.ParagraphSettingsAdvanced.textBottom":"底部","DE.Views.ParagraphSettingsAdvanced.textCentered":"居中的","DE.Views.ParagraphSettingsAdvanced.textCharacterSpacing":"字符间距","DE.Views.ParagraphSettingsAdvanced.textContext":"上下文的","DE.Views.ParagraphSettingsAdvanced.textContextDiscret":"上下文和任意的","DE.Views.ParagraphSettingsAdvanced.textContextHistDiscret":"上下文、历史和任意的","DE.Views.ParagraphSettingsAdvanced.textContextHistorical":"上下文和历史的","DE.Views.ParagraphSettingsAdvanced.textDefault":"默认选项","DE.Views.ParagraphSettingsAdvanced.textDiscret":"任意的","DE.Views.ParagraphSettingsAdvanced.textEffects":"效果","DE.Views.ParagraphSettingsAdvanced.textExact":"固定值","DE.Views.ParagraphSettingsAdvanced.textFirstLine":"首行缩进","DE.Views.ParagraphSettingsAdvanced.textHanging":"悬挂缩进","DE.Views.ParagraphSettingsAdvanced.textHistorical":"历史的","DE.Views.ParagraphSettingsAdvanced.textHistoricalDiscret":"历史和任意的","DE.Views.ParagraphSettingsAdvanced.textJustified":"两端对齐","DE.Views.ParagraphSettingsAdvanced.textLeader":"引导线","DE.Views.ParagraphSettingsAdvanced.textLeft":"左侧","DE.Views.ParagraphSettingsAdvanced.textLevel":"级","DE.Views.ParagraphSettingsAdvanced.textLigatures":"连字","DE.Views.ParagraphSettingsAdvanced.textNone":"无","DE.Views.ParagraphSettingsAdvanced.textNoneSpecial":"（无）","DE.Views.ParagraphSettingsAdvanced.textOpenType":"OpenType 功能","DE.Views.ParagraphSettingsAdvanced.textPosition":"位置","DE.Views.ParagraphSettingsAdvanced.textRemove":"删除","DE.Views.ParagraphSettingsAdvanced.textRemoveAll":"删除所有","DE.Views.ParagraphSettingsAdvanced.textRight":"右侧","DE.Views.ParagraphSettingsAdvanced.textSet":"指定","DE.Views.ParagraphSettingsAdvanced.textSpacing":"间距","DE.Views.ParagraphSettingsAdvanced.textStandard":"仅限标准的","DE.Views.ParagraphSettingsAdvanced.textStandardContext":"标准和上下文的","DE.Views.ParagraphSettingsAdvanced.textStandardContextDiscret":"标准、上下文和任意的","DE.Views.ParagraphSettingsAdvanced.textStandardContextHist":"标准、上下文和历史的","DE.Views.ParagraphSettingsAdvanced.textStandardDiscret":"标准和任意的","DE.Views.ParagraphSettingsAdvanced.textStandardHistDiscret":"标准、历史和任意的","DE.Views.ParagraphSettingsAdvanced.textStandardHistorical":"标准和历史的","DE.Views.ParagraphSettingsAdvanced.textTabCenter":"居中","DE.Views.ParagraphSettingsAdvanced.textTabLeft":"左对齐","DE.Views.ParagraphSettingsAdvanced.textTabPosition":"制表位位置","DE.Views.ParagraphSettingsAdvanced.textTabRight":"右对齐","DE.Views.ParagraphSettingsAdvanced.textTitle":"段落 - 高级设置","DE.Views.ParagraphSettingsAdvanced.textTop":"顶部","DE.Views.ParagraphSettingsAdvanced.tipAll":"所有边框","DE.Views.ParagraphSettingsAdvanced.tipBottom":"下边框","DE.Views.ParagraphSettingsAdvanced.tipInner":"内部横框线","DE.Views.ParagraphSettingsAdvanced.tipLeft":"左边框","DE.Views.ParagraphSettingsAdvanced.tipNone":"无边框","DE.Views.ParagraphSettingsAdvanced.tipOuter":"外侧框线","DE.Views.ParagraphSettingsAdvanced.tipRight":"右边框","DE.Views.ParagraphSettingsAdvanced.tipTop":"上边框","DE.Views.ParagraphSettingsAdvanced.txtAutoText":"自动","DE.Views.ParagraphSettingsAdvanced.txtNoBorders":"无边框","DE.Views.PrintWithPreview.textMarginsLast":"上次的自定义","DE.Views.PrintWithPreview.textMarginsModerate":"中等","DE.Views.PrintWithPreview.textMarginsNarrow":"窄","DE.Views.PrintWithPreview.textMarginsNormal":"常规","DE.Views.PrintWithPreview.textMarginsUsNormal":"美国常规","DE.Views.PrintWithPreview.textMarginsWide":"宽","DE.Views.PrintWithPreview.txtAllPages":"所有页面","DE.Views.PrintWithPreview.txtBothSides":"双面打印","DE.Views.PrintWithPreview.txtBothSidesLongDesc":"翻转长边的页面","DE.Views.PrintWithPreview.txtBothSidesShortDesc":"翻转短边的页面","DE.Views.PrintWithPreview.txtBottom":"底部","DE.Views.PrintWithPreview.txtCopies":"份数","DE.Views.PrintWithPreview.txtCurrentPage":"当前页面","DE.Views.PrintWithPreview.txtCustom":"自定义","DE.Views.PrintWithPreview.txtCustomPages":"自定义打印","DE.Views.PrintWithPreview.txtLandscape":"横向","DE.Views.PrintWithPreview.txtLeft":"左侧","DE.Views.PrintWithPreview.txtMargins":"页边距","DE.Views.PrintWithPreview.txtOf":"/ {0}","DE.Views.PrintWithPreview.txtOneSide":"单面打印","DE.Views.PrintWithPreview.txtOneSideDesc":"只打印一侧的页面","DE.Views.PrintWithPreview.txtPage":"页面","DE.Views.PrintWithPreview.txtPageNumInvalid":"页码无效","DE.Views.PrintWithPreview.txtPageOrientation":"页面方向","DE.Views.PrintWithPreview.txtPages":"页面","DE.Views.PrintWithPreview.txtPageSize":"页面大小","DE.Views.PrintWithPreview.txtPortrait":"纵向","DE.Views.PrintWithPreview.txtPrint":"打印","DE.Views.PrintWithPreview.txtPrintPdf":"打印为 PDF 格式","DE.Views.PrintWithPreview.txtPrintRange":"打印范围","DE.Views.PrintWithPreview.txtPrintSides":"双面打印","DE.Views.PrintWithPreview.txtRight":"右侧","DE.Views.PrintWithPreview.txtSelection":"选择","DE.Views.PrintWithPreview.txtTop":"顶部","DE.Views.ProtectDialog.textComments":"评论","DE.Views.ProtectDialog.textForms":"填写表单","DE.Views.ProtectDialog.textReview":"修订","DE.Views.ProtectDialog.textView":"不允许任何更改（只读）","DE.Views.ProtectDialog.txtAllow":"仅允许在文档中进行此类型的编辑","DE.Views.ProtectDialog.txtIncorrectPwd":"确认的密码与先前输入的不一致。","DE.Views.ProtectDialog.txtLimit":"密码限制为15个字符","DE.Views.ProtectDialog.txtOptional":"可选","DE.Views.ProtectDialog.txtPassword":"密码","DE.Views.ProtectDialog.txtProtect":"保护","DE.Views.ProtectDialog.txtRepeat":"重复输入密码","DE.Views.ProtectDialog.txtTitle":"保护","DE.Views.ProtectDialog.txtWarning":"警告: 如果丢失或忘记密码，则无法将其恢复。请妥善保存。","DE.Views.RightMenu.txtChartSettings":"图表设置","DE.Views.RightMenu.txtFormSettings":"表单设置","DE.Views.RightMenu.txtHeaderFooterSettings":"页眉和页脚设置","DE.Views.RightMenu.txtImageSettings":"图片设置","DE.Views.RightMenu.txtMailMergeSettings":"邮件合并设置","DE.Views.RightMenu.txtParagraphSettings":"段落设置","DE.Views.RightMenu.txtShapeSettings":"形状设置","DE.Views.RightMenu.txtSignatureSettings":"签名设置","DE.Views.RightMenu.txtTableSettings":"表格设置","DE.Views.RightMenu.txtTextArtSettings":"艺术字设置","DE.Views.RoleDeleteDlg.textLabel":"要删除这个角色，请把与之相关的字段移到另一个角色领域中。","DE.Views.RoleDeleteDlg.textSelect":"为外地合并角色选择","DE.Views.RoleDeleteDlg.textTitle":"删除角色","DE.Views.RoleEditDlg.errNameExists":"具有同样名称的角色已经存在。","DE.Views.RoleEditDlg.textEmptyError":"角色名称不得为空。","DE.Views.RoleEditDlg.textName":"角色名称","DE.Views.RoleEditDlg.textNameEx":"例如：申请人、客户、销售代表","DE.Views.RoleEditDlg.textNoHighlight":"无高亮","DE.Views.RoleEditDlg.txtTitleEdit":"编辑角色","DE.Views.RoleEditDlg.txtTitleNew":"创建新角色","DE.Views.RolesManagerDlg.textAnyone":"任何人","DE.Views.RolesManagerDlg.textDelete":"删除","DE.Views.RolesManagerDlg.textDeleteLast":"您确定您要删除{0}角色吗？<br>删除之后，默认角色将自动创建。","DE.Views.RolesManagerDlg.textDescription":"添加角色并设置填写者接收和签署文件的顺序","DE.Views.RolesManagerDlg.textDown":"角色下移","DE.Views.RolesManagerDlg.textEdit":"编辑","DE.Views.RolesManagerDlg.textEmpty":"还没有创建任何角色。<br>至少创建一个角色，它就会在这个领域出现。","DE.Views.RolesManagerDlg.textNew":"新建","DE.Views.RolesManagerDlg.textUp":"角色上移","DE.Views.RolesManagerDlg.txtTitle":"管理角色","DE.Views.RolesManagerDlg.warnCantDelete":"您不得删除这个角色，它有相关的字段。","DE.Views.RolesManagerDlg.warnDelete":"您确定您要删除{0}角色吗？","DE.Views.SaveFormDlg.saveButtonText":"保存","DE.Views.SaveFormDlg.textAnyone":"任何人","DE.Views.SaveFormDlg.textDescription":"当另存为 oform 时，只有带字段的角色被添加到填充列表中。","DE.Views.SaveFormDlg.textEmpty":"与该字段相关的角色不存在。","DE.Views.SaveFormDlg.textFill":"填写列表","DE.Views.SaveFormDlg.txtTitle":"另存为表单","DE.Views.ShapeSettings.strBackground":"背景色","DE.Views.ShapeSettings.strChange":"更改自动形状","DE.Views.ShapeSettings.strColor":"颜色","DE.Views.ShapeSettings.strFill":"填充","DE.Views.ShapeSettings.strForeground":"前景色","DE.Views.ShapeSettings.strPattern":"图案","DE.Views.ShapeSettings.strShadow":"显示阴影","DE.Views.ShapeSettings.strSize":"宽度","DE.Views.ShapeSettings.strStroke":"线条","DE.Views.ShapeSettings.strTransparency":"透明度","DE.Views.ShapeSettings.strType":"类型","DE.Views.ShapeSettings.textAdvanced":"显示高级设置","DE.Views.ShapeSettings.textAngle":"角度","DE.Views.ShapeSettings.textBorderSizeErr":"输入的值不正确。<br>请输入介于0 pt和1584 pt之间的值。","DE.Views.ShapeSettings.textColor":"纯色填充","DE.Views.ShapeSettings.textDirection":"方向","DE.Views.ShapeSettings.textEditPoints":"编辑顶点","DE.Views.ShapeSettings.textEditShape":"编辑形状","DE.Views.ShapeSettings.textEmptyPattern":"无图案","DE.Views.ShapeSettings.textFlip":"翻转","DE.Views.ShapeSettings.textFromFile":"从文件导入","DE.Views.ShapeSettings.textFromStorage":"来自存储设备","DE.Views.ShapeSettings.textFromUrl":"从URL","DE.Views.ShapeSettings.textGradient":"渐变点","DE.Views.ShapeSettings.textGradientFill":"渐变填充","DE.Views.ShapeSettings.textHint270":"逆时针旋转90°","DE.Views.ShapeSettings.textHint90":"顺时针旋转90°","DE.Views.ShapeSettings.textHintFlipH":"水平翻转","DE.Views.ShapeSettings.textHintFlipV":"垂直翻转","DE.Views.ShapeSettings.textImageTexture":"图片或纹理","DE.Views.ShapeSettings.textLinear":"线性","DE.Views.ShapeSettings.textNoFill":"无填充","DE.Views.ShapeSettings.textPatternFill":"图案填充","DE.Views.ShapeSettings.textPosition":"位置","DE.Views.ShapeSettings.textRadial":"径向","DE.Views.ShapeSettings.textRecentlyUsed":"最近使用的","DE.Views.ShapeSettings.textRotate90":"旋转90°","DE.Views.ShapeSettings.textRotation":"旋转","DE.Views.ShapeSettings.textSelectImage":"选取图片","DE.Views.ShapeSettings.textSelectTexture":"请选择","DE.Views.ShapeSettings.textStretch":"拉伸","DE.Views.ShapeSettings.textStyle":"类型","DE.Views.ShapeSettings.textTexture":"从纹理","DE.Views.ShapeSettings.textTile":"平铺","DE.Views.ShapeSettings.textWrap":"文字环绕","DE.Views.ShapeSettings.tipAddGradientPoint":"新增渐变点","DE.Views.ShapeSettings.tipRemoveGradientPoint":"删除渐变点","DE.Views.ShapeSettings.txtBehind":"衬于​​文字下方","DE.Views.ShapeSettings.txtBrownPaper":"牛皮纸","DE.Views.ShapeSettings.txtCanvas":"画布","DE.Views.ShapeSettings.txtCarton":"纸板","DE.Views.ShapeSettings.txtDarkFabric":"深色织物","DE.Views.ShapeSettings.txtGrain":"颗粒","DE.Views.ShapeSettings.txtGranite":"花岗岩","DE.Views.ShapeSettings.txtGreyPaper":"灰纸","DE.Views.ShapeSettings.txtInFront":"浮于文字上方","DE.Views.ShapeSettings.txtInline":"嵌入型​​","DE.Views.ShapeSettings.txtKnit":"针织","DE.Views.ShapeSettings.txtLeather":"皮革","DE.Views.ShapeSettings.txtNoBorders":"无线条","DE.Views.ShapeSettings.txtPapyrus":"纸莎草","DE.Views.ShapeSettings.txtSquare":"四周型","DE.Views.ShapeSettings.txtThrough":"穿越型","DE.Views.ShapeSettings.txtTight":"紧密型","DE.Views.ShapeSettings.txtTopAndBottom":"上下型","DE.Views.ShapeSettings.txtWood":"木头","DE.Views.SignatureSettings.notcriticalErrorTitle":"警告","DE.Views.SignatureSettings.strDelete":"删除签名","DE.Views.SignatureSettings.strDetails":"签名详情","DE.Views.SignatureSettings.strInvalid":"签名无效","DE.Views.SignatureSettings.strRequested":"请求的签名","DE.Views.SignatureSettings.strSetup":"签名设置","DE.Views.SignatureSettings.strSign":"签名","DE.Views.SignatureSettings.strSignature":"签名","DE.Views.SignatureSettings.strSigner":"签名者","DE.Views.SignatureSettings.strValid":"有效签名","DE.Views.SignatureSettings.txtContinueEditing":"继续编辑","DE.Views.SignatureSettings.txtEditWarning":"编辑将删除文档中的签名。<br>您确定要继续吗？","DE.Views.SignatureSettings.txtRemoveWarning":"要删除该签名吗？<br>这一操作不能被撤销。","DE.Views.SignatureSettings.txtRequestedSignatures":"此文档需要签名。","DE.Views.SignatureSettings.txtSigned":"有效签名已添加到文档中。该文档受到保护，无法编辑。","DE.Views.SignatureSettings.txtSignedInvalid":"文档中的某些数字签名无效或无法验证。该文档受到保护，无法编辑。","DE.Views.Statusbar.goToPageText":"转到页面","DE.Views.Statusbar.pageIndexText":"第{0}页共{1}页","DE.Views.Statusbar.tipFitPage":"适合页面","DE.Views.Statusbar.tipFitWidth":"适应宽度","DE.Views.Statusbar.tipHandTool":"移动工具","DE.Views.Statusbar.tipSelectTool":"选取工具","DE.Views.Statusbar.tipSetLang":"设置文本语言","DE.Views.Statusbar.tipZoomFactor":"缩放","DE.Views.Statusbar.tipZoomIn":"放大","DE.Views.Statusbar.tipZoomOut":"缩小","DE.Views.Statusbar.txtPageNumInvalid":"页码无效","DE.Views.Statusbar.txtPages":"页数","DE.Views.Statusbar.txtParagraphs":"段落","DE.Views.Statusbar.txtSpaces":"字符数(计空格)","DE.Views.Statusbar.txtSymbols":"字符数(不计空格)","DE.Views.Statusbar.txtWordCount":"字数统计","DE.Views.Statusbar.txtWords":"单词","DE.Views.StyleTitleDialog.textHeader":"创建样式","DE.Views.StyleTitleDialog.textNextStyle":"后续段落样式","DE.Views.StyleTitleDialog.textTitle":"名称","DE.Views.StyleTitleDialog.txtEmpty":"这是必填栏","DE.Views.StyleTitleDialog.txtNotEmpty":"区域不能为空","DE.Views.StyleTitleDialog.txtSameAs":"与创建的新样式相同","DE.Views.TableFormulaDialog.textBookmark":"粘贴书签","DE.Views.TableFormulaDialog.textFormat":"数字格式","DE.Views.TableFormulaDialog.textFormula":"公式","DE.Views.TableFormulaDialog.textInsertFunction":"粘贴函数","DE.Views.TableFormulaDialog.textTitle":"公式设置","DE.Views.TableOfContentsSettings.strAlign":"页码右对齐","DE.Views.TableOfContentsSettings.strFullCaption":"包括标签和编号","DE.Views.TableOfContentsSettings.strLinks":"将目录格式化为链接","DE.Views.TableOfContentsSettings.strLinksOF":"将图片表格格式化为链接","DE.Views.TableOfContentsSettings.strShowPages":"显示页码","DE.Views.TableOfContentsSettings.textBuildTable":"构建目录起始","DE.Views.TableOfContentsSettings.textBuildTableOF":"构建图表目录起始","DE.Views.TableOfContentsSettings.textEquation":"公式","DE.Views.TableOfContentsSettings.textFigure":"图","DE.Views.TableOfContentsSettings.textLeader":"引导线","DE.Views.TableOfContentsSettings.textLevel":"级别","DE.Views.TableOfContentsSettings.textLevels":"级别","DE.Views.TableOfContentsSettings.textNone":"无","DE.Views.TableOfContentsSettings.textRadioCaption":"标题","DE.Views.TableOfContentsSettings.textRadioLevels":"大纲级别","DE.Views.TableOfContentsSettings.textRadioStyle":"样式","DE.Views.TableOfContentsSettings.textRadioStyles":"所选样式","DE.Views.TableOfContentsSettings.textStyle":"样式","DE.Views.TableOfContentsSettings.textStyles":"样式","DE.Views.TableOfContentsSettings.textTable":"表格","DE.Views.TableOfContentsSettings.textTitle":"目录","DE.Views.TableOfContentsSettings.textTitleTOF":"图表目录","DE.Views.TableOfContentsSettings.txtCentered":"居中","DE.Views.TableOfContentsSettings.txtClassic":"古典","DE.Views.TableOfContentsSettings.txtCurrent":"当前","DE.Views.TableOfContentsSettings.txtDistinctive":"可区分","DE.Views.TableOfContentsSettings.txtFormal":"正式","DE.Views.TableOfContentsSettings.txtModern":"现代","DE.Views.TableOfContentsSettings.txtOnline":"超链接","DE.Views.TableOfContentsSettings.txtSimple":"简单","DE.Views.TableOfContentsSettings.txtStandard":"标准","DE.Views.TableSettings.deleteColumnText":"删除列","DE.Views.TableSettings.deleteRowText":"删除行","DE.Views.TableSettings.deleteTableText":"删除表格","DE.Views.TableSettings.insertColumnLeftText":"在左侧插入列","DE.Views.TableSettings.insertColumnRightText":"在右侧插入列","DE.Views.TableSettings.insertRowAboveText":"在上方插入行","DE.Views.TableSettings.insertRowBelowText":"在下方插入行","DE.Views.TableSettings.mergeCellsText":"合并单元格","DE.Views.TableSettings.selectCellText":"选择单元格","DE.Views.TableSettings.selectColumnText":"选择列","DE.Views.TableSettings.selectRowText":"选择行","DE.Views.TableSettings.selectTableText":"选择表","DE.Views.TableSettings.splitCellsText":"拆分单元格","DE.Views.TableSettings.splitCellTitleText":"拆分单元格","DE.Views.TableSettings.strRepeatRow":"在每页顶部重复标题行","DE.Views.TableSettings.textAddFormula":"添加公式","DE.Views.TableSettings.textAdvanced":"显示高级设置","DE.Views.TableSettings.textBackColor":"背景颜色","DE.Views.TableSettings.textBanded":"镶边行","DE.Views.TableSettings.textColBanded":"镶边列","DE.Views.TableSettings.textBorderColor":"颜色","DE.Views.TableSettings.textBorders":"边框风格","DE.Views.TableSettings.textCellSize":"行&列的大小","DE.Views.TableSettings.textColumns":"列","DE.Views.TableSettings.textConvert":"将表格转为文本","DE.Views.TableSettings.textDistributeCols":"平均分布各列","DE.Views.TableSettings.textDistributeRows":"平均分布各行","DE.Views.TableSettings.textEdit":"行和列","DE.Views.TableSettings.textEmptyTemplate":"没有模板","DE.Views.TableSettings.textFirst":"第一列","DE.Views.TableSettings.textHeader":"标题行","DE.Views.TableSettings.textHeight":"高度","DE.Views.TableSettings.textLast":"最后一列","DE.Views.TableSettings.textRows":"行","DE.Views.TableSettings.textSelectBorders":"选择您要更改应用样式的边框","DE.Views.TableSettings.textTemplate":"表格样式","DE.Views.TableSettings.textTotal":"汇总行","DE.Views.TableSettings.textWidth":"宽度","DE.Views.TableSettings.tipAll":"所有边框","DE.Views.TableSettings.tipBottom":"下边框","DE.Views.TableSettings.tipInner":"内部框线","DE.Views.TableSettings.tipInnerHor":"内部横框线","DE.Views.TableSettings.tipInnerVert":"内部竖框线","DE.Views.TableSettings.tipLeft":"左边框","DE.Views.TableSettings.tipNone":"无边框","DE.Views.TableSettings.tipOuter":"外侧框线","DE.Views.TableSettings.tipRight":"右边框","DE.Views.TableSettings.tipTop":"上边框","DE.Views.TableSettings.txtGroupTable_BorderedAndLined":"带边框及线条的表格","DE.Views.TableSettings.txtGroupTable_Custom":"自定义","DE.Views.TableSettings.txtGroupTable_Grid":"网格表","DE.Views.TableSettings.txtGroupTable_List":"清单表","DE.Views.TableSettings.txtGroupTable_Plain":"普通表格","DE.Views.TableSettings.txtNoBorders":"无边框","DE.Views.TableSettings.txtTable_Accent":"强调","DE.Views.TableSettings.txtTable_Bordered":"带边框的","DE.Views.TableSettings.txtTable_BorderedAndLined":"带边框及线条的","DE.Views.TableSettings.txtTable_Colorful":"多彩","DE.Views.TableSettings.txtTable_Dark":"黑暗的","DE.Views.TableSettings.txtTable_GridTable":"表格网格","DE.Views.TableSettings.txtTable_Light":"光","DE.Views.TableSettings.txtTable_Lined":"带线条的","DE.Views.TableSettings.txtTable_ListTable":"列表表","DE.Views.TableSettings.txtTable_PlainTable":"简单的表","DE.Views.TableSettings.txtTable_TableGrid":"表格的网格","DE.Views.TableSettingsAdvanced.textAlign":"对齐方式","DE.Views.TableSettingsAdvanced.textAlignment":"对齐","DE.Views.TableSettingsAdvanced.textAllowSpacing":"单元格间距","DE.Views.TableSettingsAdvanced.textAlt":"替代文字","DE.Views.TableSettingsAdvanced.textAltDescription":"说明","DE.Views.TableSettingsAdvanced.textAltTip":"视觉对象信息的替代基于文本的表示法，将要向有视觉或认知障碍人阅读，以帮助他们更好地了解图片、自选图形、图表或表格中的那些信息。","DE.Views.TableSettingsAdvanced.textAltTitle":"标题","DE.Views.TableSettingsAdvanced.textAnchorText":"文本","DE.Views.TableSettingsAdvanced.textAutofit":"自动调整大小以适应内容","DE.Views.TableSettingsAdvanced.textBackColor":"单元格背景","DE.Views.TableSettingsAdvanced.textBelow":"下面","DE.Views.TableSettingsAdvanced.textBorderColor":"边框颜色","DE.Views.TableSettingsAdvanced.textBorderDesc":"点击图表或使用按钮选择边框并将选择的样式应用于它们","DE.Views.TableSettingsAdvanced.textBordersBackgroung":"边框和底纹","DE.Views.TableSettingsAdvanced.textBorderWidth":"边框宽度","DE.Views.TableSettingsAdvanced.textBottom":"下","DE.Views.TableSettingsAdvanced.textCellOptions":"单元格选项","DE.Views.TableSettingsAdvanced.textCellProps":"单元格","DE.Views.TableSettingsAdvanced.textCellSize":"单元格大小","DE.Views.TableSettingsAdvanced.textCenter":"中心","DE.Views.TableSettingsAdvanced.textCenterTooltip":"居中","DE.Views.TableSettingsAdvanced.textCheckMargins":"使用默认页边距","DE.Views.TableSettingsAdvanced.textDefaultMargins":"默认单元格边距","DE.Views.TableSettingsAdvanced.textDistance":"距正文","DE.Views.TableSettingsAdvanced.textHorizontal":"水平","DE.Views.TableSettingsAdvanced.textIndLeft":"左缩进","DE.Views.TableSettingsAdvanced.textLeft":"左","DE.Views.TableSettingsAdvanced.textLeftTooltip":"左对齐","DE.Views.TableSettingsAdvanced.textMargin":"页边距","DE.Views.TableSettingsAdvanced.textMargins":"单元格边距","DE.Views.TableSettingsAdvanced.textMeasure":"度量单位","DE.Views.TableSettingsAdvanced.textMove":"随文字移动","DE.Views.TableSettingsAdvanced.textOnlyCells":"仅适用于选定的单元格","DE.Views.TableSettingsAdvanced.textOptions":"选项","DE.Views.TableSettingsAdvanced.textOverlap":"允许重叠","DE.Views.TableSettingsAdvanced.textPage":"页面","DE.Views.TableSettingsAdvanced.textPosition":"位置","DE.Views.TableSettingsAdvanced.textPrefWidth":"首选宽度","DE.Views.TableSettingsAdvanced.textPreview":"预览","DE.Views.TableSettingsAdvanced.textRelative":"相对于","DE.Views.TableSettingsAdvanced.textRight":"右","DE.Views.TableSettingsAdvanced.textRightOf":"在 - 的右边","DE.Views.TableSettingsAdvanced.textRightTooltip":"右对齐","DE.Views.TableSettingsAdvanced.textTable":"表格","DE.Views.TableSettingsAdvanced.textTableBackColor":"表背景","DE.Views.TableSettingsAdvanced.textTablePosition":"表格位置","DE.Views.TableSettingsAdvanced.textTableSize":"表格尺寸","DE.Views.TableSettingsAdvanced.textTitle":"表格 - 高级设置","DE.Views.TableSettingsAdvanced.textTop":"上","DE.Views.TableSettingsAdvanced.textVertical":"垂直","DE.Views.TableSettingsAdvanced.textWidth":"宽度","DE.Views.TableSettingsAdvanced.textWidthSpaces":"宽度和间距","DE.Views.TableSettingsAdvanced.textWrap":"文字环绕","DE.Views.TableSettingsAdvanced.textWrapNoneTooltip":"无","DE.Views.TableSettingsAdvanced.textWrapParallelTooltip":"环绕","DE.Views.TableSettingsAdvanced.textWrappingStyle":"文字环绕","DE.Views.TableSettingsAdvanced.textWrapText":"自动换行","DE.Views.TableSettingsAdvanced.tipAll":"所有边框","DE.Views.TableSettingsAdvanced.tipCellAll":"仅为单元格设置边框","DE.Views.TableSettingsAdvanced.tipCellInner":"设置单元格的垂直和水平线","DE.Views.TableSettingsAdvanced.tipCellOuter":"仅为单元格设定外部边框","DE.Views.TableSettingsAdvanced.tipInner":"内部框线","DE.Views.TableSettingsAdvanced.tipNone":"无边框","DE.Views.TableSettingsAdvanced.tipOuter":"外侧框线","DE.Views.TableSettingsAdvanced.tipTableOuterCellAll":"设置所有单元格的外边框和边界。","DE.Views.TableSettingsAdvanced.tipTableOuterCellInner":"设置表格外部边框和单元格的垂直和水平线","DE.Views.TableSettingsAdvanced.tipTableOuterCellOuter":"为单元格设置表外边界和外边界","DE.Views.TableSettingsAdvanced.txtCm":"厘米","DE.Views.TableSettingsAdvanced.txtInch":"寸","DE.Views.TableSettingsAdvanced.txtNoBorders":"无边框","DE.Views.TableSettingsAdvanced.txtPercent":"百分","DE.Views.TableSettingsAdvanced.txtPt":"点","DE.Views.TableToTextDialog.textEmpty":"必须为自定义的分隔符键入一个字符","DE.Views.TableToTextDialog.textNested":"转换嵌套表格","DE.Views.TableToTextDialog.textOther":"其他","DE.Views.TableToTextDialog.textPara":"自然段符号","DE.Views.TableToTextDialog.textSemicolon":"分号","DE.Views.TableToTextDialog.textSeparator":"以何方法分开文本？","DE.Views.TableToTextDialog.textTab":"标签","DE.Views.TableToTextDialog.textTitle":"将表格转为文本","DE.Views.TextArtSettings.strColor":"颜色","DE.Views.TextArtSettings.strFill":"文本填充","DE.Views.TextArtSettings.strSize":"宽度","DE.Views.TextArtSettings.strStroke":"文本轮廓","DE.Views.TextArtSettings.strTransparency":"透明度","DE.Views.TextArtSettings.strType":"类型","DE.Views.TextArtSettings.textAngle":"角度","DE.Views.TextArtSettings.textBorderSizeErr":"输入的值不正确。<br>请输入介于0 pt和1584 pt之间的值。","DE.Views.TextArtSettings.textColor":"纯色填充","DE.Views.TextArtSettings.textDirection":"方向","DE.Views.TextArtSettings.textGradient":"渐变点","DE.Views.TextArtSettings.textGradientFill":"渐变填充","DE.Views.TextArtSettings.textLinear":"线性","DE.Views.TextArtSettings.textNoFill":"无填充","DE.Views.TextArtSettings.textPosition":"位置","DE.Views.TextArtSettings.textRadial":"径向","DE.Views.TextArtSettings.textSelectTexture":"请选择","DE.Views.TextArtSettings.textStyle":"类型","DE.Views.TextArtSettings.textTemplate":"样式","DE.Views.TextArtSettings.textTransform":"跟随路径","DE.Views.TextArtSettings.tipAddGradientPoint":"新增渐变点","DE.Views.TextArtSettings.tipRemoveGradientPoint":"删除渐变点","DE.Views.TextArtSettings.txtNoBorders":"无线条","DE.Views.TextToTableDialog.textAutofit":"自动适应行为","DE.Views.TextToTableDialog.textColumns":"列","DE.Views.TextToTableDialog.textContents":"自动适应内容","DE.Views.TextToTableDialog.textEmpty":"必须为自定义的分隔符键入一个字符","DE.Views.TextToTableDialog.textFixed":"固定列宽","DE.Views.TextToTableDialog.textOther":"其他","DE.Views.TextToTableDialog.textPara":"段落","DE.Views.TextToTableDialog.textRows":"行","DE.Views.TextToTableDialog.textSemicolon":"分号","DE.Views.TextToTableDialog.textSeparator":"文本分开位置","DE.Views.TextToTableDialog.textTab":"标签","DE.Views.TextToTableDialog.textTableSize":"表格尺寸","DE.Views.TextToTableDialog.textTitle":"将文本转为表格","DE.Views.TextToTableDialog.textWindow":"自动适应窗口","DE.Views.TextToTableDialog.txtAutoText":"自动","DE.Views.Toolbar.capBtnAddComment":"添加批注","DE.Views.Toolbar.capBtnBlankPage":"空白页","DE.Views.Toolbar.capBtnColumns":"分栏","DE.Views.Toolbar.capBtnComment":"批注","DE.Views.Toolbar.capBtnDateTime":"日期和时间","DE.Views.Toolbar.capBtnHyphenation":"连字符","DE.Views.Toolbar.capBtnInsChart":"图表","DE.Views.Toolbar.capBtnInsControls":"内容控件","DE.Views.Toolbar.capBtnInsDropcap":"首字下沉 ","DE.Views.Toolbar.capBtnInsEquation":"公式","DE.Views.Toolbar.capBtnInsHeader":"页眉/页脚","DE.Views.Toolbar.capBtnInsImage":"图片","DE.Views.Toolbar.capBtnInsPagebreak":"分页","DE.Views.Toolbar.capBtnInsShape":"形状","DE.Views.Toolbar.capBtnInsSmartArt":"SmartArt","DE.Views.Toolbar.capBtnInsSymbol":"符号","DE.Views.Toolbar.capBtnInsTable":"表格","DE.Views.Toolbar.capBtnInsTextart":"艺术字","DE.Views.Toolbar.capBtnInsTextbox":"文本框","DE.Views.Toolbar.capBtnLineNumbers":"行号","DE.Views.Toolbar.capBtnMargins":"页边距","DE.Views.Toolbar.capBtnPageColor":"页面颜色","DE.Views.Toolbar.capBtnPageOrient":"纸张方向","DE.Views.Toolbar.capBtnPageSize":"纸张大小","DE.Views.Toolbar.capBtnWatermark":"水印","DE.Views.Toolbar.capImgAlign":"对齐","DE.Views.Toolbar.capImgBackward":"下移一层","DE.Views.Toolbar.capImgForward":"上移一层","DE.Views.Toolbar.capImgGroup":"组合","DE.Views.Toolbar.capImgWrapping":"环绕文字","DE.Views.Toolbar.mniCapitalizeWords":"每个单词首字母大写","DE.Views.Toolbar.mniCustomTable":"插入表格","DE.Views.Toolbar.mniDrawTable":"绘制表格","DE.Views.Toolbar.mniEditControls":"控制设置","DE.Views.Toolbar.mniEditDropCap":"首字下沉选项","DE.Views.Toolbar.mniEditFooter":"编辑页脚","DE.Views.Toolbar.mniEditHeader":"编辑页眉","DE.Views.Toolbar.mniEraseTable":"删除表格","DE.Views.Toolbar.mniFromFile":"从文件导入","DE.Views.Toolbar.mniFromStorage":"来自存储设备","DE.Views.Toolbar.mniFromUrl":"从URL","DE.Views.Toolbar.mniHiddenBorders":"隐藏表边框","DE.Views.Toolbar.mniHiddenChars":"不打印字符","DE.Views.Toolbar.mniHighlightControls":"突出显示设置","DE.Views.Toolbar.mniImageFromFile":"本地图片","DE.Views.Toolbar.mniImageFromStorage":"图片来自存储","DE.Views.Toolbar.mniImageFromUrl":"在线URL","DE.Views.Toolbar.mniInsertSSE":"Excel 电子表格","DE.Views.Toolbar.mniLowerCase":"小写","DE.Views.Toolbar.mniRemoveFooter":"移除页脚","DE.Views.Toolbar.mniRemoveHeader":"移除页眉","DE.Views.Toolbar.mniSentenceCase":"句首字母大写","DE.Views.Toolbar.mniTextToTable":"将文本转为表格","DE.Views.Toolbar.mniToggleCase":"切换大小写","DE.Views.Toolbar.mniUpperCase":"大写","DE.Views.Toolbar.strMenuNoFill":"无填充","DE.Views.Toolbar.textAlpha":"希腊文小字母阿尔法","DE.Views.Toolbar.textAuto":"自动的","DE.Views.Toolbar.textAutoColor":"自动化的","DE.Views.Toolbar.textBetta":"希腊文小字母贝塔","DE.Views.Toolbar.textBlackHeart":"黑心","DE.Views.Toolbar.textBold":"加粗","DE.Views.Toolbar.textBottom":"下： ","DE.Views.Toolbar.textBullet":"项目符号","DE.Views.Toolbar.textChangeLevel":"更改列表级别","DE.Views.Toolbar.textCheckboxControl":"复选框","DE.Views.Toolbar.textColumnsCustom":"自定义栏","DE.Views.Toolbar.textColumnsLeft":"偏左","DE.Views.Toolbar.textColumnsOne":"一栏","DE.Views.Toolbar.textColumnsRight":"偏右","DE.Views.Toolbar.textColumnsThree":"三栏","DE.Views.Toolbar.textColumnsTwo":"二栏","DE.Views.Toolbar.textComboboxControl":"\n组合框","DE.Views.Toolbar.textContinuous":"连续","DE.Views.Toolbar.textContPage":"连续页","DE.Views.Toolbar.textCopyright":"版权符号","DE.Views.Toolbar.textCustomHyphen":"连字符选项","DE.Views.Toolbar.textCustomLineNumbers":"行号选项","DE.Views.Toolbar.textDateControl":"日期","DE.Views.Toolbar.textDegree":"度数符号","DE.Views.Toolbar.textDelta":"希腊文小字母得尔塔","DE.Views.Toolbar.textDivision":"除号","DE.Views.Toolbar.textDollar":"美元符号","DE.Views.Toolbar.textDropdownControl":"下拉列表","DE.Views.Toolbar.textEditWatermark":"自定义水印","DE.Views.Toolbar.textEuro":"欧元符号","DE.Views.Toolbar.textEvenPage":"偶数页","DE.Views.Toolbar.textGreaterEqual":"大于或等于","DE.Views.Toolbar.textInfinity":"无限","DE.Views.Toolbar.textInMargin":"悬挂","DE.Views.Toolbar.textInsColumnBreak":"插入分栏符","DE.Views.Toolbar.textInsertPageCount":"插入页数","DE.Views.Toolbar.textInsertPageNumber":"插入页码","DE.Views.Toolbar.textInsPageBreak":"插入分页符","DE.Views.Toolbar.textInsSectionBreak":"插入分节符","DE.Views.Toolbar.textInText":"下沉","DE.Views.Toolbar.textItalic":"斜体","DE.Views.Toolbar.textLandscape":"横向","DE.Views.Toolbar.textLeft":"左： ","DE.Views.Toolbar.textLessEqual":"小于或等于","DE.Views.Toolbar.textLetterPi":"希腊文小字母 Pi","DE.Views.Toolbar.textListSettings":"定义新项目符号...","DE.Views.Toolbar.textMarginsLast":"最后自定义","DE.Views.Toolbar.textMarginsModerate":"中等","DE.Views.Toolbar.textMarginsNarrow":"窄","DE.Views.Toolbar.textMarginsNormal":"常规","DE.Views.Toolbar.textMarginsUsNormal":"美国常规","DE.Views.Toolbar.textMarginsWide":"宽","DE.Views.Toolbar.textMoreSymbols":"更多符号","DE.Views.Toolbar.textNewColor":"更多颜色","DE.Views.Toolbar.textNextPage":"下一页","DE.Views.Toolbar.textNoHighlight":"无高亮","DE.Views.Toolbar.textNone":"无","DE.Views.Toolbar.textNotEqualTo":"不等于","DE.Views.Toolbar.textOddPage":"奇数页","DE.Views.Toolbar.textOneHalf":"普通分数一半","DE.Views.Toolbar.textOneQuarter":"普通分数四分之一","DE.Views.Toolbar.textPageMarginsCustom":"自定义页边距","DE.Views.Toolbar.textPageSizeCustom":"自定义页面大小","DE.Views.Toolbar.textPictureControl":"图片","DE.Views.Toolbar.textPlainControl":"纯文本","DE.Views.Toolbar.textPlusMinus":"正负号","DE.Views.Toolbar.textPortrait":"纵向","DE.Views.Toolbar.textRegistered":"注册标志","DE.Views.Toolbar.textRemoveControl":"删除内容控件","DE.Views.Toolbar.textRemWatermark":"删除水印","DE.Views.Toolbar.textRestartEachPage":"每页重编行号","DE.Views.Toolbar.textRestartEachSection":"每节重编行号","DE.Views.Toolbar.textRichControl":"格式文本","DE.Views.Toolbar.textRight":"右： ","DE.Views.Toolbar.textSection":"章节标志","DE.Views.Toolbar.textSmile":"白色笑脸","DE.Views.Toolbar.textSquareRoot":"平方根","DE.Views.Toolbar.textStrikeout":"删除线","DE.Views.Toolbar.textStyleMenuDelete":"删除样式","DE.Views.Toolbar.textStyleMenuDeleteAll":"删除所有自定义样式","DE.Views.Toolbar.textStyleMenuNew":"创建样式","DE.Views.Toolbar.textStyleMenuRestore":"恢复为默认","DE.Views.Toolbar.textStyleMenuRestoreAll":"全部恢复为默认样式","DE.Views.Toolbar.textStyleMenuUpdate":"从选择更新","DE.Views.Toolbar.textSubscript":"下标","DE.Views.Toolbar.textSuperscript":"上标","DE.Views.Toolbar.textSuppressForCurrentParagraph":"禁用于当前段落","DE.Views.Toolbar.textTabCollaboration":"审阅","DE.Views.Toolbar.textTabDraw":"绘图","DE.Views.Toolbar.textTabFile":"文件","DE.Views.Toolbar.textTabHome":"开始","DE.Views.Toolbar.textTabInsert":"插入","DE.Views.Toolbar.textTabLayout":"布局","DE.Views.Toolbar.textTabLinks":"引用","DE.Views.Toolbar.textTabProtect":"保护","DE.Views.Toolbar.textTabReview":"审阅","DE.Views.Toolbar.textTabView":"视图","DE.Views.Toolbar.textTilde":"波浪号","DE.Views.Toolbar.textTitleError":"错误","DE.Views.Toolbar.textToCurrent":"到当前位置","DE.Views.Toolbar.textTop":"上： ","DE.Views.Toolbar.textTradeMark":"商标标志","DE.Views.Toolbar.textUnderline":"下划线","DE.Views.Toolbar.textYen":"日元符号","DE.Views.Toolbar.textRmb":"人民币符号","DE.Views.Toolbar.tipAlignCenter":"居中","DE.Views.Toolbar.tipAlignJust":"两端对齐","DE.Views.Toolbar.tipAlignLeft":"左对齐","DE.Views.Toolbar.tipAlignRight":"右对齐","DE.Views.Toolbar.tipBack":"返回","DE.Views.Toolbar.tipBlankPage":"插入空白页面","DE.Views.Toolbar.tipChangeCase":"更改大小写","DE.Views.Toolbar.tipChangeChart":"更改图表类型","DE.Views.Toolbar.tipClearStyle":"清除样式","DE.Views.Toolbar.tipColorSchemas":"更改配色方案","DE.Views.Toolbar.tipColumns":"插入列","DE.Views.Toolbar.tipControls":"插入内容控件","DE.Views.Toolbar.tipCopy":"复制","DE.Views.Toolbar.tipCopyStyle":"格式刷","DE.Views.Toolbar.tipCut":"剪切","DE.Views.Toolbar.tipDateTime":"插入当前日期和时间","DE.Views.Toolbar.tipDecFont":"减小字号","DE.Views.Toolbar.tipDecPrLeft":"减少缩进","DE.Views.Toolbar.tipDropCap":"插入首字下沉 ","DE.Views.Toolbar.tipEditHeader":"编辑标题或页脚","DE.Views.Toolbar.tipFontColor":"字体颜色","DE.Views.Toolbar.tipFontName":"字体","DE.Views.Toolbar.tipFontSize":"字号","DE.Views.Toolbar.tipHighlightColor":"颜色高亮","DE.Views.Toolbar.tipHyphenation":"更改连字符号","DE.Views.Toolbar.tipImgAlign":"对齐对象","DE.Views.Toolbar.tipImgGroup":"组合对象","DE.Views.Toolbar.tipImgWrapping":"环绕文字","DE.Views.Toolbar.tipIncFont":"增大字号","DE.Views.Toolbar.tipIncPrLeft":"增加缩进","DE.Views.Toolbar.tipInsertChart":"插入图表","DE.Views.Toolbar.tipInsertEquation":"插入公式","DE.Views.Toolbar.tipInsertHorizontalText":"插入横排文本框","DE.Views.Toolbar.tipInsertImage":"插入图片","DE.Views.Toolbar.tipInsertNum":"插入页码","DE.Views.Toolbar.tipInsertShape":"自动插入形状","DE.Views.Toolbar.tipInsertSmartArt":"插入 SmartArt","DE.Views.Toolbar.tipInsertSymbol":"插入符号","DE.Views.Toolbar.tipInsertTable":"插入表格","DE.Views.Toolbar.tipInsertText":"插入文字","DE.Views.Toolbar.tipInsertTextArt":"插入艺术字","DE.Views.Toolbar.tipInsertVerticalText":"插入竖排文本框","DE.Views.Toolbar.tipLineNumbers":"显示行号","DE.Views.Toolbar.tipLineSpace":"行和段落间距","DE.Views.Toolbar.tipMailRecepients":"邮件合并","DE.Views.Toolbar.tipMarkers":"项目符号","DE.Views.Toolbar.tipMarkersArrow":"箭头项目符号","DE.Views.Toolbar.tipMarkersCheckmark":"选中标记项目符号","DE.Views.Toolbar.tipMarkersDash":"划线项目符号","DE.Views.Toolbar.tipMarkersFRhombus":"实心菱形项目符号","DE.Views.Toolbar.tipMarkersFRound":"实心圆形项目符号","DE.Views.Toolbar.tipMarkersFSquare":"实心方形项目符号","DE.Views.Toolbar.tipMarkersHRound":"空心圆形项目符号","DE.Views.Toolbar.tipMarkersStar":"星形项目符号","DE.Views.Toolbar.tipMultiLevelArticl":"多层次编号的文章","DE.Views.Toolbar.tipMultiLevelChapter":"多层次编号的章节","DE.Views.Toolbar.tipMultiLevelHeadings":"多层次编号的标题","DE.Views.Toolbar.tipMultiLevelHeadVarious":"多层次各种编号的标题","DE.Views.Toolbar.tipMultiLevelNumbered":"多级编号","DE.Views.Toolbar.tipMultilevels":"多级列表","DE.Views.Toolbar.tipMultiLevelSymbols":"多级项目符号","DE.Views.Toolbar.tipMultiLevelVarious":"多级各种编号","DE.Views.Toolbar.tipNumbers":"编号","DE.Views.Toolbar.tipPageBreak":"插入页面或分节符","DE.Views.Toolbar.tipPageColor":"更改页面颜色","DE.Views.Toolbar.tipPageMargins":"页边距","DE.Views.Toolbar.tipPageOrient":"页面方向","DE.Views.Toolbar.tipPageSize":"页面大小","DE.Views.Toolbar.tipParagraphStyle":"段落风格","DE.Views.Toolbar.tipPaste":"粘贴","DE.Views.Toolbar.tipPrColor":"底纹","DE.Views.Toolbar.tipPrint":"打印","DE.Views.Toolbar.tipPrintQuick":"快速打印","DE.Views.Toolbar.tipRedo":"重做","DE.Views.Toolbar.tipSave":"保存","DE.Views.Toolbar.tipSaveCoauth":"保存您的更改以供其他用户查看","DE.Views.Toolbar.tipSelectAll":"全选","DE.Views.Toolbar.tipSendBackward":"下移一层","DE.Views.Toolbar.tipSendForward":"上移一层","DE.Views.Toolbar.tipShowHiddenChars":"不打印字符","DE.Views.Toolbar.tipSynchronize":"该文档已被其他用户更改。请点击保存更改和重新加载更新。","DE.Views.Toolbar.tipUndo":"撤消","DE.Views.Toolbar.tipWatermark":"编辑水印","DE.Views.Toolbar.txtDistribHor":"水平分布","DE.Views.Toolbar.txtDistribVert":"垂直分布","DE.Views.Toolbar.txtGroupBulletDoc":"文档项目符号","DE.Views.Toolbar.txtGroupBulletLib":"项目符号库","DE.Views.Toolbar.txtGroupMultiDoc":"当前文档中的列表","DE.Views.Toolbar.txtGroupMultiLib":"列表库","DE.Views.Toolbar.txtGroupNumDoc":"文档编号格式","DE.Views.Toolbar.txtGroupNumLib":"编号库","DE.Views.Toolbar.txtGroupRecent":"最近使用的","DE.Views.Toolbar.txtMarginAlign":"对齐边距","DE.Views.Toolbar.txtObjectsAlign":"对齐所选对象","DE.Views.Toolbar.txtPageAlign":"对齐页面","DE.Views.Toolbar.txtScheme1":"公司地址","DE.Views.Toolbar.txtScheme10":"中位数","DE.Views.Toolbar.txtScheme11":"组件","DE.Views.Toolbar.txtScheme12":"组件","DE.Views.Toolbar.txtScheme13":"富裕的","DE.Views.Toolbar.txtScheme14":"奥丽尔","DE.Views.Toolbar.txtScheme15":"原来的","DE.Views.Toolbar.txtScheme16":"纸","DE.Views.Toolbar.txtScheme17":"至点","DE.Views.Toolbar.txtScheme18":"技术","DE.Views.Toolbar.txtScheme19":"行进","DE.Views.Toolbar.txtScheme2":"灰度","DE.Views.Toolbar.txtScheme20":"城市的","DE.Views.Toolbar.txtScheme21":"气势","DE.Views.Toolbar.txtScheme22":"新的 Office","DE.Views.Toolbar.txtScheme3":"顶点","DE.Views.Toolbar.txtScheme4":"方面","DE.Views.Toolbar.txtScheme5":"公民","DE.Views.Toolbar.txtScheme6":"中央大厅","DE.Views.Toolbar.txtScheme7":"公平","DE.Views.Toolbar.txtScheme8":"流动","DE.Views.Toolbar.txtScheme9":"发现","DE.Views.ViewTab.textAlwaysShowToolbar":"始终显示工具栏","DE.Views.ViewTab.textDarkDocument":"黑暗文件","DE.Views.ViewTab.textFitToPage":"适合页面","DE.Views.ViewTab.textFitToWidth":"适应宽度","DE.Views.ViewTab.textInterfaceTheme":"界面主题","DE.Views.ViewTab.textLeftMenu":"左面板","DE.Views.ViewTab.textNavigation":"导航","DE.Views.ViewTab.textOutline":"目录","DE.Views.ViewTab.textRightMenu":"右面板","DE.Views.ViewTab.textRulers":"标尺","DE.Views.ViewTab.textStatusBar":"状态栏","DE.Views.ViewTab.textZoom":"缩放","DE.Views.ViewTab.tipDarkDocument":"黑暗文件","DE.Views.ViewTab.tipFitToPage":"适合页面","DE.Views.ViewTab.tipFitToWidth":"适应宽度","DE.Views.ViewTab.tipHeadings":"标题","DE.Views.ViewTab.tipInterfaceTheme":"界面主题","DE.Views.WatermarkSettingsDialog.textAuto":"自动","DE.Views.WatermarkSettingsDialog.textBold":"加粗","DE.Views.WatermarkSettingsDialog.textColor":"文字颜色","DE.Views.WatermarkSettingsDialog.textDiagonal":"斜式","DE.Views.WatermarkSettingsDialog.textFont":"字体 ","DE.Views.WatermarkSettingsDialog.textFromFile":"从文件导入","DE.Views.WatermarkSettingsDialog.textFromStorage":"来自存储设备","DE.Views.WatermarkSettingsDialog.textFromUrl":"从URL导入","DE.Views.WatermarkSettingsDialog.textHor":"水平","DE.Views.WatermarkSettingsDialog.textImageW":"图片水印","DE.Views.WatermarkSettingsDialog.textItalic":"斜体","DE.Views.WatermarkSettingsDialog.textLanguage":"语言","DE.Views.WatermarkSettingsDialog.textLayout":"版式","DE.Views.WatermarkSettingsDialog.textNone":"无水印","DE.Views.WatermarkSettingsDialog.textScale":"缩放","DE.Views.WatermarkSettingsDialog.textSelect":"选择图片","DE.Views.WatermarkSettingsDialog.textStrikeout":"删除线","DE.Views.WatermarkSettingsDialog.textText":"文字","DE.Views.WatermarkSettingsDialog.textTextW":"文字水印","DE.Views.WatermarkSettingsDialog.textTitle":"水印设置","DE.Views.WatermarkSettingsDialog.textTransparency":"半透明","DE.Views.WatermarkSettingsDialog.textUnderline":"下划线","DE.Views.WatermarkSettingsDialog.tipFontName":"字体名称","DE.Views.WatermarkSettingsDialog.tipFontSize":"字号"});var params=getUrlParams(),lang=(params.lang||"en").split(/[\-\_]/)[0],logo=params.headerlogo?encodeUrlParam(params.headerlogo):null,logoDark=params.headerlogodark?encodeUrlParam(params.headerlogodark):null,checkLocalStorage=(window.frameEditorId=params.frameEditorId,window.parentOrigin=params.parentOrigin,!function(){window.uitheme||(window.uitheme={}),window.uitheme.set_id=function(t){"theme-system"==t?this.adapt_to_system_theme():this.id=t},window.uitheme.is_theme_system=function(){return"theme-system"==this.id},window.uitheme.adapt_to_system_theme=function(){this.id="theme-system",this.type=this.is_system_theme_dark()?"dark":"light"},window.uitheme.relevant_theme_id=function(){return this.is_theme_system()?this.is_system_theme_dark()?"theme-dark":"theme-classic-light":this.id},window.uitheme.is_system_theme_dark||(window.uitheme.is_system_theme_dark=function(){return window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches}),window.uitheme.id||window.uitheme.set_id(localStorage.getItem("ui-theme-id")),window.uitheme.iscontentdark="dark"==localStorage.getItem("content-theme");let t=window.uitheme.colors?window.uitheme:localStorage.getItem("ui-theme");if(t=t&&("string"==typeof t&&t.startsWith("{")&&t.endsWith("}")?JSON.parse(t):t))if(window.uitheme.id&&window.uitheme.id!=t.id)localStorage.removeItem("ui-theme"),!window.uitheme.type&&/-dark/.test(window.uitheme.id)&&(window.uitheme.type="dark");else if(window.uitheme.cache=t,!window.uitheme.type&&t.type&&(window.uitheme.type=t.type),t.colors){var e,i=[];for(e in t.colors)"toolbar-header-presentation"==e&&"#aa5252"==t.colors[e]&&(t.colors[e]="#BE664F"),i.push("--"+e+":"+t.colors[e]);var n=document.createElement("style");n.type="text/css",n.innerHTML="."+t.id+"{"+i.join(";")+";}",document.getElementsByTagName("head")[0].appendChild(n)}}(),define("themeinit",function(){}),function(){try{window.localStorage;return!0}catch(t){return!1}}()),Common,Common,Common,Common,Common,Common,Common,Common,Common,Common,Common;checkLocalStorage&&"1"===localStorage.getItem("ui-rtl")&&(document.body.setAttribute("dir","rtl"),document.body.classList.add("rtl"));const isIE=/msie|trident/i.test(navigator.userAgent);function checkScaling(){var t,e={"pixel-ratio__1_25":"screen and (-webkit-min-device-pixel-ratio: 1.25) and (-webkit-max-device-pixel-ratio: 1.49), screen and (min-resolution: 1.25dppx) and (max-resolution: 1.49dppx)","pixel-ratio__1_5":"screen and (-webkit-min-device-pixel-ratio: 1.5) and (-webkit-max-device-pixel-ratio: 1.74), screen and (min-resolution: 1.5dppx) and (max-resolution: 1.74dppx)","pixel-ratio__1_75":"screen and (-webkit-min-device-pixel-ratio: 1.75) and (-webkit-max-device-pixel-ratio: 1.99), screen and (min-resolution: 1.75dppx) and (max-resolution: 1.99dppx)"};for(t in e)if(window.matchMedia(e[t]).matches){document.body.classList.add(t);break}if(!isIE)for(var i in e={"pixel-ratio__2_5":"screen and (-webkit-min-device-pixel-ratio: 2.25), screen and (min-resolution: 2.25dppx)"})if(window.matchMedia(e[i]).matches){document.body.classList.add(i),Common.Utils.injectSvgIcons();break}}let svg_icons=["./resources/img/iconssmall@2.5x.svg","./resources/img/iconsbig@2.5x.svg","./resources/img/iconshuge@2.5x.svg"];if(window.Common={Utils:{injectSvgIcons:function(){}}},checkScaling(),params.uitheme&&("default-dark"==params.uitheme?(params.uitheme="theme-dark",params.uithemetype="dark"):"default-light"==params.uitheme?(params.uitheme="theme-classic-light",params.uithemetype="light"):params.uitheme),!window.uitheme.id&&params.uitheme&&(window.uitheme.id=params.uitheme),window.uitheme.id?!window.uitheme.type&&params.uitheme&&(window.uitheme.type=params.uithemetype):window.uitheme.adapt_to_system_theme(),document.body.classList.add(window.uitheme.relevant_theme_id()),"dark"==window.uitheme.type&&(document.body.classList.add("theme-type-dark"),checkLocalStorage&&"dark"==localStorage.getItem("content-theme")&&document.body.classList.add("content-theme-dark")),window.is_system_theme_dark||delete window.is_system_theme_dark,define("htmlutils",function(){}),!function(){function r(o,s){return s=null==s?o.length-1:+s,function(){for(var t=Math.max(arguments.length-s,0),e=Array(t),i=0;i<t;i++)e[i]=arguments[i+s];switch(s){case 0:return o.call(this,e);case 1:return o.call(this,arguments[0],e);case 2:return o.call(this,arguments[0],arguments[1],e)}for(var n=Array(s+1),i=0;i<s;i++)n[i]=arguments[i];return n[s]=e,o.apply(this,n)}}function t(e){return function(t){return null==t?void 0:t[e]}}function a(t,e){for(var i=e.length,n=0;n<i;n++){if(null==t)return;t=t[e[n]]}return i?t:void 0}function e(m){return function(t,e,i,n){var o=3<=arguments.length,s=t,a=k(e,n,4),l=i,r=!E(s)&&A.keys(s),c=(r||s).length,d=0<m?0:c-1;for(o||(l=s[r?r[d]:d],d+=m);0<=d&&d<c;d+=m){var h=r?r[d]:d;l=a(l,s[h],h,s)}return l}}function i(s,e){return function(i,n,t){var o=e?[[],[]]:{};return n=D(n,t),A.each(i,function(t,e){e=n(t,e,i);s(o,t,e)}),o}}function n(s){return function(t,e,i){e=D(e,i);for(var n=P(t),o=0<s?0:n-1;0<=o&&o<n;o+=s)if(e(t[o],o,t))return o;return-1}}function o(s,a,l){return function(t,e,i){var n=0,o=P(t);if("number"==typeof i)0<s?n=0<=i?i:Math.max(i+o,n):o=0<=i?Math.min(i+1,o):i+o+1;else if(l&&i&&o)return t[i=l(t,e)]===e?i:-1;if(e!=e)return 0<=(i=a(v.call(t,n,o),A.isNaN))?i+n:-1;for(i=0<s?n:o-1;0<=i&&i<o;i+=s)if(t[i]===e)return i;return-1}}function c(t,e,i,n,o){return n instanceof e?(n=I(t.prototype),e=t.apply(n,o),A.isObject(e)?e:n):t.apply(i,o)}function s(t,e){var i=U.length,n=t.constructor,o=A.isFunction(n)&&n.prototype||C,s="constructor";for(A.has(t,s)&&!A.contains(e,s)&&e.push(s);i--;)(s=U[i])in t&&t[s]!==o[s]&&!A.contains(e,s)&&e.push(s)}function l(r,c){return function(t){var e=arguments.length;if(c&&(t=Object(t)),!(e<2||null==t))for(var i=1;i<e;i++)for(var n=arguments[i],o=r(n),s=o.length,a=0;a<s;a++){var l=o[a];c&&void 0!==t[l]||(t[l]=n[l])}return t}}function F(t,e,i){return e in i}function d(e){function i(t){return e[t]}var t="(?:"+A.keys(e).join("|")+")",n=RegExp(t),o=RegExp(t,"g");return function(t){return n.test(t=null==t?"":""+t)?t.replace(o,i):t}}function R(t){return"\\"+W[t]}function h(t,e){return t._chain?A(e).chain():e}var m,p,u,g="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global||this||{},B=g._,b=Array.prototype,C=Object.prototype,f="undefined"!=typeof Symbol?Symbol.prototype:null,H=b.push,v=b.slice,_=C.toString,w=C.hasOwnProperty,y=Array.isArray,x=Object.keys,S=Object.create,T=function(){},A=function(t){return t instanceof A?t:this instanceof A?void(this._wrapped=t):new A(t)},k=("undefined"==typeof exports||exports.nodeType?g._=A:(exports="undefined"!=typeof module&&!module.nodeType&&module.exports?module.exports=A:exports)._=A,A.VERSION="1.8.3",function(o,s,t){if(void 0===s)return o;switch(t){case 1:return function(t){return o.call(s,t)};case null:case 3:return function(t,e,i){return o.call(s,t,e,i)};case 4:return function(t,e,i,n){return o.call(s,t,e,i,n)}}return function(){return o.apply(s,arguments)}}),D=function(t,e,i){return A.iteratee!==m?A.iteratee(t,e):null==t?A.identity:A.isFunction(t)?k(t,e,i):A.isObject(t)&&!A.isArray(t)?A.matcher(t):A.property(t)},I=(A.iteratee=m=function(t,e){return D(t,e,1/0)},function(t){if(!A.isObject(t))return{};if(S)return S(t);T.prototype=t;t=new T;return T.prototype=null,t}),O=Math.pow(2,53)-1,P=t("length"),E=function(t){t=P(t);return"number"==typeof t&&0<=t&&t<=O},N=(A.each=A.forEach=function(t,e,i){if(e=k(e,i),E(t))for(o=0,s=t.length;o<s;o++)e(t[o],o,t);else for(var n=A.keys(t),o=0,s=n.length;o<s;o++)e(t[n[o]],n[o],t);return t},A.map=A.collect=function(t,e,i){e=D(e,i);for(var n=!E(t)&&A.keys(t),o=(n||t).length,s=Array(o),a=0;a<o;a++){var l=n?n[a]:a;s[a]=e(t[l],l,t)}return s},A.reduce=A.foldl=A.inject=e(1),A.reduceRight=A.foldr=e(-1),A.find=A.detect=function(t,e,i){e=(E(t)?A.findIndex:A.findKey)(t,e,i);if(void 0!==e&&-1!==e)return t[e]},A.filter=A.select=function(t,n,e){var o=[];return n=D(n,e),A.each(t,function(t,e,i){n(t,e,i)&&o.push(t)}),o},A.reject=function(t,e,i){return A.filter(t,A.negate(D(e)),i)},A.every=A.all=function(t,e,i){e=D(e,i);for(var n=!E(t)&&A.keys(t),o=(n||t).length,s=0;s<o;s++){var a=n?n[s]:s;if(!e(t[a],a,t))return!1}return!0},A.some=A.any=function(t,e,i){e=D(e,i);for(var n=!E(t)&&A.keys(t),o=(n||t).length,s=0;s<o;s++){var a=n?n[s]:s;if(e(t[a],a,t))return!0}return!1},A.contains=A.includes=A.include=function(t,e,i,n){return E(t)||(t=A.values(t)),0<=A.indexOf(t,e,i="number"==typeof i&&!n?i:0)},A.invoke=r(function(t,i,n){var o,s;return A.isFunction(i)?s=i:A.isArray(i)&&(o=i.slice(0,-1),i=i[i.length-1]),A.map(t,function(t){var e=s;if(!e){if(null==(t=o&&o.length?a(t,o):t))return;e=t[i]}return null==e?e:e.apply(t,n)})}),A.pluck=function(t,e){return A.map(t,A.property(e))},A.where=function(t,e){return A.filter(t,A.matcher(e))},A.findWhere=function(t,e){return A.find(t,A.matcher(e))},A.max=function(t,n,e){var i,o,s=-1/0,a=-1/0;if(null==n||"number"==typeof n&&"object"!=typeof t[0]&&null!=t)for(var l=0,r=(t=E(t)?t:A.values(t)).length;l<r;l++)null!=(i=t[l])&&s<i&&(s=i);else n=D(n,e),A.each(t,function(t,e,i){o=n(t,e,i),(a<o||o===-1/0&&s===-1/0)&&(s=t,a=o)});return s},A.min=function(t,n,e){var i,o,s=1/0,a=1/0;if(null==n||"number"==typeof n&&"object"!=typeof t[0]&&null!=t)for(var l=0,r=(t=E(t)?t:A.values(t)).length;l<r;l++)null!=(i=t[l])&&i<s&&(s=i);else n=D(n,e),A.each(t,function(t,e,i){((o=n(t,e,i))<a||o===1/0&&s===1/0)&&(s=t,a=o)});return s},A.shuffle=function(t){return A.sample(t,1/0)},A.sample=function(t,e,i){if(null==e||i)return(t=E(t)?t:A.values(t))[A.random(t.length-1)];for(var n=E(t)?A.clone(t):A.values(t),i=P(n),o=(e=Math.max(Math.min(e,i),0),i-1),s=0;s<e;s++){var a=A.random(s,o),l=n[s];n[s]=n[a],n[a]=l}return n.slice(0,e)},A.sortBy=function(t,n,e){var o=0;return n=D(n,e),A.pluck(A.map(t,function(t,e,i){return{value:t,index:o++,criteria:n(t,e,i)}}).sort(function(t,e){var i=t.criteria,n=e.criteria;if(i!==n){if(n<i||void 0===i)return 1;if(i<n||void 0===n)return-1}return t.index-e.index}),"value")},A.groupBy=i(function(t,e,i){A.has(t,i)?t[i].push(e):t[i]=[e]}),A.indexBy=i(function(t,e,i){t[i]=e}),A.countBy=i(function(t,e,i){A.has(t,i)?t[i]++:t[i]=1}),/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g),V=(A.toArray=function(t){return t?A.isArray(t)?v.call(t):A.isString(t)?t.match(N):E(t)?A.map(t,A.identity):A.values(t):[]},A.size=function(t){return null==t?0:(E(t)?t:A.keys(t)).length},A.partition=i(function(t,e,i){t[i?0:1].push(e)},!0),A.first=A.head=A.take=function(t,e,i){if(!(null==t||t.length<1))return null==e||i?t[0]:A.initial(t,t.length-e)},A.initial=function(t,e,i){return v.call(t,0,Math.max(0,t.length-(null==e||i?1:e)))},A.last=function(t,e,i){if(!(null==t||t.length<1))return null==e||i?t[t.length-1]:A.rest(t,Math.max(0,t.length-e))},A.rest=A.tail=A.drop=function(t,e,i){return v.call(t,null==e||i?1:e)},A.compact=function(t){return A.filter(t,Boolean)},function(t,e,i,n){for(var o=(n=n||[]).length,s=0,a=P(t);s<a;s++){var l=t[s];if(E(l)&&(A.isArray(l)||A.isArguments(l)))if(e)for(var r=0,c=l.length;r<c;)n[o++]=l[r++];else V(l,e,i,n),o=n.length;else i||(n[o++]=l)}return n}),M=(A.flatten=function(t,e){return V(t,e,!1)},A.without=r(function(t,e){return A.difference(t,e)}),A.uniq=A.unique=function(t,e,i,n){A.isBoolean(e)||(n=i,i=e,e=!1),null!=i&&(i=D(i,n));for(var o=[],s=[],a=0,l=P(t);a<l;a++){var r=t[a],c=i?i(r,a,t):r;e?(a&&s===c||o.push(r),s=c):i?A.contains(s,c)||(s.push(c),o.push(r)):A.contains(o,r)||o.push(r)}return o},A.union=r(function(t){return A.uniq(V(t,!0,!0))}),A.intersection=function(t){for(var e=[],i=arguments.length,n=0,o=P(t);n<o;n++){var s=t[n];if(!A.contains(e,s)){for(var a=1;a<i&&A.contains(arguments[a],s);a++);a===i&&e.push(s)}}return e},A.difference=r(function(t,e){return e=V(e,!0,!0),A.filter(t,function(t){return!A.contains(e,t)})}),A.unzip=function(t){for(var e=t&&A.max(t,P).length||0,i=Array(e),n=0;n<e;n++)i[n]=A.pluck(t,n);return i},A.zip=r(A.unzip),A.object=function(t,e){for(var i={},n=0,o=P(t);n<o;n++)e?i[t[n]]=e[n]:i[t[n][0]]=t[n][1];return i},A.findIndex=n(1),A.findLastIndex=n(-1),A.sortedIndex=function(t,e,i,n){for(var o=(i=D(i,n,1))(e),s=0,a=P(t);s<a;){var l=Math.floor((s+a)/2);i(t[l])<o?s=l+1:a=l}return s},A.indexOf=o(1,A.findIndex,A.sortedIndex),A.lastIndexOf=o(-1,A.findLastIndex),A.range=function(t,e,i){null==e&&(e=t||0,t=0),i=i||(e<t?-1:1);for(var n=Math.max(Math.ceil((e-t)/i),0),o=Array(n),s=0;s<n;s++,t+=i)o[s]=t;return o},A.chunk=function(t,e){if(null==e||e<1)return[];for(var i=[],n=0,o=t.length;n<o;)i.push(v.call(t,n,n+=e));return i},A.bind=r(function(e,i,n){var o;if(A.isFunction(e))return o=r(function(t){return c(e,o,i,this,n.concat(t))});throw new TypeError("Bind must be called on a function")}),A.partial=r(function(o,s){function a(){for(var t=0,e=s.length,i=Array(e),n=0;n<e;n++)i[n]=s[n]===l?arguments[t++]:s[n];for(;t<arguments.length;)i.push(arguments[t++]);return c(o,a,this,this,i)}var l=A.partial.placeholder;return a}),(A.partial.placeholder=A).bindAll=r(function(t,e){var i=(e=V(e,!1,!1)).length;if(i<1)throw new Error("bindAll must be passed function names");for(;i--;){var n=e[i];t[n]=A.bind(t[n],t)}}),A.memoize=function(n,o){function s(t){var e=s.cache,i=""+(o?o.apply(this,arguments):t);return A.has(e,i)||(e[i]=n.apply(this,arguments)),e[i]}return s.cache={},s},A.delay=r(function(t,e,i){return setTimeout(function(){return t.apply(null,i)},e)}),A.defer=A.partial(A.delay,A,1),A.throttle=function(i,n,o){function s(){d=!1===o.leading?0:A.now(),a=null,c=i.apply(l,r),a||(l=r=null)}function t(){var t=A.now(),e=(d||!1!==o.leading||(d=t),n-(t-d));return l=this,r=arguments,e<=0||n<e?(a&&(clearTimeout(a),a=null),d=t,c=i.apply(l,r),a||(l=r=null)):a||!1===o.trailing||(a=setTimeout(s,e)),c}var a,l,r,c,d=0;o=o||{};return t.cancel=function(){clearTimeout(a),d=0,a=l=r=null},t},A.debounce=function(i,n,o){function s(t,e){a=null,e&&(l=i.apply(t,e))}var a,l,t=r(function(t){var e;return a&&clearTimeout(a),o?(e=!a,a=setTimeout(s,n),e&&(l=i.apply(this,t))):a=A.delay(s,n,this,t),l});return t.cancel=function(){clearTimeout(a),a=null},t},A.wrap=function(t,e){return A.partial(e,t)},A.negate=function(t){return function(){return!t.apply(this,arguments)}},A.compose=function(){var i=arguments,n=i.length-1;return function(){for(var t=n,e=i[n].apply(this,arguments);t--;)e=i[t].call(this,e);return e}},A.after=function(t,e){return function(){if(--t<1)return e.apply(this,arguments)}},A.before=function(t,e){var i;return function(){return 0<--t&&(i=e.apply(this,arguments)),t<=1&&(e=null),i}},A.once=A.partial(A.before,2),A.restArgs=r,!{toString:null}.propertyIsEnumerable("toString")),U=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],y=(A.keys=function(t){if(!A.isObject(t))return[];if(x)return x(t);var e,i=[];for(e in t)A.has(t,e)&&i.push(e);return M&&s(t,i),i},A.allKeys=function(t){if(!A.isObject(t))return[];var e,i=[];for(e in t)i.push(e);return M&&s(t,i),i},A.values=function(t){for(var e=A.keys(t),i=e.length,n=Array(i),o=0;o<i;o++)n[o]=t[e[o]];return n},A.mapObject=function(t,e,i){e=D(e,i);for(var n=A.keys(t),o=n.length,s={},a=0;a<o;a++){var l=n[a];s[l]=e(t[l],l,t)}return s},A.pairs=function(t){for(var e=A.keys(t),i=e.length,n=Array(i),o=0;o<i;o++)n[o]=[e[o],t[e[o]]];return n},A.invert=function(t){for(var e={},i=A.keys(t),n=0,o=i.length;n<o;n++)e[t[i[n]]]=i[n];return e},A.functions=A.methods=function(t){var e,i=[];for(e in t)A.isFunction(t[e])&&i.push(e);return i.sort()},A.extend=l(A.allKeys),A.extendOwn=A.assign=l(A.keys),A.findKey=function(t,e,i){e=D(e,i);for(var n,o=A.keys(t),s=0,a=o.length;s<a;s++)if(e(t[n=o[s]],n,t))return n},A.pick=r(function(t,e){var i={},n=e[0];if(null!=t){A.isFunction(n)?(1<e.length&&(n=k(n,e[1])),e=A.allKeys(t)):(n=F,e=V(e,!1,!1),t=Object(t));for(var o=0,s=e.length;o<s;o++){var a=e[o],l=t[a];n(l,a,t)&&(i[a]=l)}}return i}),A.omit=r(function(t,i){var e,n=i[0];return A.isFunction(n)?(n=A.negate(n),1<i.length&&(e=i[1])):(i=A.map(V(i,!1,!1),String),n=function(t,e){return!A.contains(i,e)}),A.pick(t,n,e)}),A.defaults=l(A.allKeys,!0),A.create=function(t,e){t=I(t);return e&&A.extendOwn(t,e),t},A.clone=function(t){return A.isObject(t)?A.isArray(t)?t.slice():A.extend({},t):t},A.tap=function(t,e){return e(t),t},A.isMatch=function(t,e){var i=A.keys(e),n=i.length;if(null==t)return!n;for(var o=Object(t),s=0;s<n;s++){var a=i[s];if(e[a]!==o[a]||!(a in o))return!1}return!0},p=function(t,e,i,n){var o;return t===e?0!==t||1/t==1/e:null!=t&&null!=e&&(t!=t?e!=e:("function"==(o=typeof t)||"object"==o||"object"==typeof e)&&u(t,e,i,n))},u=function(t,e,i,n){t instanceof A&&(t=t._wrapped),e instanceof A&&(e=e._wrapped);var o=_.call(t);if(o!==_.call(e))return!1;switch(o){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!=+t?+e!=+e:0==+t?1/+t==1/e:+t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object Symbol]":return f.valueOf.call(t)===f.valueOf.call(e)}o="[object Array]"===o;if(!o){if("object"!=typeof t||"object"!=typeof e)return!1;var s=t.constructor,a=e.constructor;if(s!==a&&!(A.isFunction(s)&&s instanceof s&&A.isFunction(a)&&a instanceof a)&&"constructor"in t&&"constructor"in e)return!1}n=n||[];for(var l=(i=i||[]).length;l--;)if(i[l]===t)return n[l]===e;if(i.push(t),n.push(e),o){if((l=t.length)!==e.length)return!1;for(;l--;)if(!p(t[l],e[l],i,n))return!1}else{var r,c=A.keys(t),l=c.length;if(A.keys(e).length!==l)return!1;for(;l--;)if(r=c[l],!A.has(e,r)||!p(t[r],e[r],i,n))return!1}return i.pop(),n.pop(),!0},A.isEqual=function(t,e){return p(t,e)},A.isEmpty=function(t){return null==t||(E(t)&&(A.isArray(t)||A.isString(t)||A.isArguments(t))?0===t.length:0===A.keys(t).length)},A.isElement=function(t){return!(!t||1!==t.nodeType)},A.isArray=y||function(t){return"[object Array]"===_.call(t)},A.isObject=function(t){var e=typeof t;return"function"==e||"object"==e&&!!t},A.each(["Arguments","Function","String","Number","Date","RegExp","Error","Symbol","Map","WeakMap","Set","WeakSet"],function(e){A["is"+e]=function(t){return _.call(t)==="[object "+e+"]"}}),A.isArguments(arguments)||(A.isArguments=function(t){return A.has(t,"callee")}),g.document&&g.document.childNodes),y=("function"!=typeof/./&&"object"!=typeof Int8Array&&"function"!=typeof y&&(A.isFunction=function(t){return"function"==typeof t||!1}),A.isFinite=function(t){return!A.isSymbol(t)&&isFinite(t)&&!isNaN(parseFloat(t))},A.isNaN=function(t){return A.isNumber(t)&&isNaN(t)},A.isBoolean=function(t){return!0===t||!1===t||"[object Boolean]"===_.call(t)},A.isNull=function(t){return null===t},A.isUndefined=function(t){return void 0===t},A.has=function(t,e){if(!A.isArray(e))return null!=t&&w.call(t,e);for(var i=e.length,n=0;n<i;n++){var o=e[n];if(null==t||!w.call(t,o))return!1;t=t[o]}return!!i},A.noConflict=function(){return g._=B,this},A.identity=function(t){return t},A.constant=function(t){return function(){return t}},A.noop=function(){},A.property=function(e){return A.isArray(e)?function(t){return a(t,e)}:t(e)},A.propertyOf=function(e){return null==e?function(){}:function(t){return A.isArray(t)?a(e,t):e[t]}},A.matcher=A.matches=function(e){return e=A.extendOwn({},e),function(t){return A.isMatch(t,e)}},A.times=function(t,e,i){var n=Array(Math.max(0,t));e=k(e,i,1);for(var o=0;o<t;o++)n[o]=e(o);return n},A.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},A.now=Date.now||function(){return(new Date).getTime()},{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"}),z=A.invert(y),$=(A.escape=d(y),A.unescape=d(z),A.result=function(t,e,i){var n=(e=A.isArray(e)?e:[e]).length;if(!n)return A.isFunction(i)?i.call(t):i;for(var o=0;o<n;o++){var s=null==t?void 0:t[e[o]];void 0===s&&(s=i,o=n),t=A.isFunction(s)?s.call(t):s}return t},0),L=(A.uniqueId=function(t){var e=++$+"";return t?t+e:e},A.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},/(.)^/),W={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},G=/\\|'|\r|\n|\u2028|\u2029/g;A.template=function(s,t,e){t=A.defaults({},t=!t&&e?e:t,A.templateSettings);var i,e=RegExp([(t.escape||L).source,(t.interpolate||L).source,(t.evaluate||L).source].join("|")+"|$","g"),a=0,l="__p+='";s.replace(e,function(t,e,i,n,o){return l+=s.slice(a,o).replace(G,R),a=o+t.length,e?l+="'+\n((__t=("+e+"))==null?'':_.escape(__t))+\n'":i?l+="'+\n((__t=("+i+"))==null?'':__t)+\n'":n&&(l+="';\n"+n+"\n__p+='"),t}),l+="';\n",l="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+(l=t.variable?l:"with(obj||{}){\n"+l+"}\n")+"return __p;\n";try{i=new Function(t.variable||"obj","_",l)}catch(t){throw t.source=l,t}function n(t){return i.call(this,t,A)}e=t.variable||"obj";return n.source="function("+e+"){\n"+l+"}",n},A.chain=function(t){t=A(t);return t._chain=!0,t};A.mixin=function(i){return A.each(A.functions(i),function(t){var e=A[t]=i[t];A.prototype[t]=function(){var t=[this._wrapped];return H.apply(t,arguments),h(this,e.apply(A,t))}}),A},A.mixin(A),A.each(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var i=b[e];A.prototype[e]=function(){var t=this._wrapped;return i.apply(t,arguments),"shift"!==e&&"splice"!==e||0!==t.length||delete t[0],h(this,t)}}),A.each(["concat","join","slice"],function(t){var e=b[t];A.prototype[t]=function(){return h(this,e.apply(this._wrapped,arguments))}}),A.prototype.value=function(){return this._wrapped},A.prototype.valueOf=A.prototype.toJSON=A.prototype.value,A.prototype.toString=function(){return String(this._wrapped)},"function"==typeof define&&define.amd&&define("underscore",[],function(){return A})}(),!function(t,e){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=t.document?e(t,!0):function(t){if(t.document)return e(t);throw new Error("jQuery requires a window with a document")}:e(t)}("undefined"!=typeof window?window:this,function(w,F){"use strict";function f(t){return"function"==typeof t&&"number"!=typeof t.nodeType}function g(t){return null!=t&&t===t.window}var e=[],R=Object.getPrototypeOf,l=e.slice,B=e.flat?function(t){return e.flat.call(t)}:function(t){return e.concat.apply([],t)},H=e.push,O=e.indexOf,N={},z=N.toString,$=N.hasOwnProperty,W=$.toString,G=W.call(Object),b={},y=w.document,j={type:!0,src:!0,nonce:!0,noModule:!0};function q(t,e,i){var n,o,s=(i=i||y).createElement("script");if(s.text=t,e)for(n in j)(o=e[n]||e.getAttribute&&e.getAttribute(n))&&s.setAttribute(n,o);i.head.appendChild(s).parentNode.removeChild(s)}function u(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?N[z.call(t)]||"object":typeof t}var x=function(t,e){return new x.fn.init(t,e)};function K(t){var e=!!t&&"length"in t&&t.length,i=u(t);return!f(t)&&!g(t)&&("array"===i||0===e||"number"==typeof e&&0<e&&e-1 in t)}x.fn=x.prototype={jquery:"3.5.1",constructor:x,length:0,toArray:function(){return l.call(this)},get:function(t){return null==t?l.call(this):t<0?this[t+this.length]:this[t]},pushStack:function(t){t=x.merge(this.constructor(),t);return t.prevObject=this,t},each:function(t){return x.each(this,t)},map:function(i){return this.pushStack(x.map(this,function(t,e){return i.call(t,e,t)}))},slice:function(){return this.pushStack(l.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(x.grep(this,function(t,e){return(e+1)%2}))},odd:function(){return this.pushStack(x.grep(this,function(t,e){return e%2}))},eq:function(t){var e=this.length,t=+t+(t<0?e:0);return this.pushStack(0<=t&&t<e?[this[t]]:[])},end:function(){return this.prevObject||this.constructor()},push:H,sort:e.sort,splice:e.splice},x.extend=x.fn.extend=function(){var t,e,i,n,o,s=arguments[0]||{},a=1,l=arguments.length,r=!1;for("boolean"==typeof s&&(r=s,s=arguments[a]||{},a++),"object"==typeof s||f(s)||(s={}),a===l&&(s=this,a--);a<l;a++)if(null!=(t=arguments[a]))for(e in t)i=t[e],"__proto__"!==e&&s!==i&&(r&&i&&(x.isPlainObject(i)||(n=Array.isArray(i)))?(o=s[e],o=n&&!Array.isArray(o)?[]:n||x.isPlainObject(o)?o:{},n=!1,s[e]=x.extend(r,o,i)):void 0!==i&&(s[e]=i));return s},x.extend({expando:"jQuery"+("3.5.1"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isPlainObject:function(t){return!(!t||"[object Object]"!==z.call(t))&&(!(t=R(t))||"function"==typeof(t=$.call(t,"constructor")&&t.constructor)&&W.call(t)===G)},isEmptyObject:function(t){for(var e in t)return!1;return!0},globalEval:function(t,e,i){q(t,{nonce:e&&e.nonce},i)},each:function(t,e){var i,n=0;if(K(t))for(i=t.length;n<i&&!1!==e.call(t[n],n,t[n]);n++);else for(n in t)if(!1===e.call(t[n],n,t[n]))break;return t},makeArray:function(t,e){e=e||[];return null!=t&&(K(Object(t))?x.merge(e,"string"==typeof t?[t]:t):H.call(e,t)),e},inArray:function(t,e,i){return null==e?-1:O.call(e,t,i)},merge:function(t,e){for(var i=+e.length,n=0,o=t.length;n<i;n++)t[o++]=e[n];return t.length=o,t},grep:function(t,e,i){for(var n=[],o=0,s=t.length,a=!i;o<s;o++)!e(t[o],o)!=a&&n.push(t[o]);return n},map:function(t,e,i){var n,o,s=0,a=[];if(K(t))for(n=t.length;s<n;s++)null!=(o=e(t[s],s,i))&&a.push(o);else for(s in t)null!=(o=e(t[s],s,i))&&a.push(o);return B(a)},guid:1,support:b}),"function"==typeof Symbol&&(x.fn[Symbol.iterator]=e[Symbol.iterator]),x.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(t,e){N["[object "+e+"]"]=e.toLowerCase()});function n(t,e,i){for(var n=[],o=void 0!==i;(t=t[e])&&9!==t.nodeType;)if(1===t.nodeType){if(o&&x(t).is(i))break;n.push(t)}return n}function Y(t,e){for(var i=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&i.push(t);return i}var t=function(F){function h(t,e){return t="0x"+t.slice(1)-65536,e||(t<0?String.fromCharCode(65536+t):String.fromCharCode(t>>10|55296,1023&t|56320))}function R(t,e){return e?"\0"===t?"�":t.slice(0,-1)+"\\"+t.charCodeAt(t.length-1).toString(16)+" ":"\\"+t}function B(){y()}var t,m,_,s,H,p,O,N,w,r,c,y,x,i,S,u,n,o,g,T="sizzle"+ +new Date,d=F.document,A=0,z=0,$=E(),W=E(),G=E(),b=E(),j=function(t,e){return t===e&&(c=!0),0},q={}.hasOwnProperty,e=[],K=e.pop,Y=e.push,k=e.push,X=e.slice,f=function(t,e){for(var i=0,n=t.length;i<n;i++)if(t[i]===e)return i;return-1},J="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",a="[\\x20\\t\\r\\n\\f]",l="(?:\\\\[\\da-fA-F]{1,6}"+a+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",Z="\\["+a+"*("+l+")(?:"+a+"*([*^$|!~]?=)"+a+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+l+"))|)"+a+"*\\]",Q=":("+l+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+Z+")*)|.*)\\)|)",tt=new RegExp(a+"+","g"),C=new RegExp("^"+a+"+|((?:^|[^\\\\])(?:\\\\.)*)"+a+"+$","g"),et=new RegExp("^"+a+"*,"+a+"*"),it=new RegExp("^"+a+"*([>+~]|"+a+")"+a+"*"),nt=new RegExp(a+"|>"),ot=new RegExp(Q),st=new RegExp("^"+l+"$"),v={ID:new RegExp("^#("+l+")"),CLASS:new RegExp("^\\.("+l+")"),TAG:new RegExp("^("+l+"|[*])"),ATTR:new RegExp("^"+Z),PSEUDO:new RegExp("^"+Q),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+a+"*(even|odd|(([+-]|)(\\d*)n|)"+a+"*(?:([+-]|)"+a+"*(\\d+)|))"+a+"*\\)|)","i"),bool:new RegExp("^(?:"+J+")$","i"),needsContext:new RegExp("^"+a+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+a+"*((?:-\\d)?\\d*)"+a+"*\\)|)(?=[^-]|$)","i")},at=/HTML$/i,lt=/^(?:input|select|textarea|button)$/i,rt=/^h\d$/i,D=/^[^{]+\{\s*\[native \w/,ct=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,dt=/[+~]/,I=new RegExp("\\\\[\\da-fA-F]{1,6}"+a+"?|\\\\([^\\r\\n\\f])","g"),ht=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,mt=ft(function(t){return!0===t.disabled&&"fieldset"===t.nodeName.toLowerCase()},{dir:"parentNode",next:"legend"});try{k.apply(e=X.call(d.childNodes),d.childNodes),e[d.childNodes.length].nodeType}catch(t){k={apply:e.length?function(t,e){Y.apply(t,X.call(e))}:function(t,e){for(var i=t.length,n=0;t[i++]=e[n++];);t.length=i-1}}}function P(e,t,i,n){var o,s,a,l,r,c,d=t&&t.ownerDocument,h=t?t.nodeType:9;if(i=i||[],"string"!=typeof e||!e||1!==h&&9!==h&&11!==h)return i;if(!n&&(y(t),t=t||x,S)){if(11!==h&&(l=ct.exec(e)))if(o=l[1]){if(9===h){if(!(c=t.getElementById(o)))return i;if(c.id===o)return i.push(c),i}else if(d&&(c=d.getElementById(o))&&g(t,c)&&c.id===o)return i.push(c),i}else{if(l[2])return k.apply(i,t.getElementsByTagName(e)),i;if((o=l[3])&&m.getElementsByClassName&&t.getElementsByClassName)return k.apply(i,t.getElementsByClassName(o)),i}if(m.qsa&&!b[e+" "]&&!(u&&u.test(e)||1===h&&"object"===t.nodeName.toLowerCase())){if(c=e,d=t,1===h&&(nt.test(e)||it.test(e))){for((d=dt.test(e)&&bt(t.parentNode)||t)===t&&m.scope||((a=t.getAttribute("id"))?a=a.replace(ht,R):t.setAttribute("id",a=T)),s=(r=p(e)).length;s--;)r[s]=(a?"#"+a:":scope")+" "+L(r[s]);c=r.join(",")}try{return k.apply(i,d.querySelectorAll(c)),i}catch(t){b(e,!0)}finally{a===T&&t.removeAttribute("id")}}}return N(e.replace(C,"$1"),t,i,n)}function E(){var i=[];function n(t,e){return i.push(t+" ")>_.cacheLength&&delete n[i.shift()],n[t+" "]=e}return n}function V(t){return t[T]=!0,t}function M(t){var e=x.createElement("fieldset");try{return!!t(e)}catch(t){return!1}finally{e.parentNode&&e.parentNode.removeChild(e)}}function pt(t,e){for(var i=t.split("|"),n=i.length;n--;)_.attrHandle[i[n]]=e}function ut(t,e){var i=e&&t,n=i&&1===t.nodeType&&1===e.nodeType&&t.sourceIndex-e.sourceIndex;if(n)return n;if(i)for(;i=i.nextSibling;)if(i===e)return-1;return t?1:-1}function gt(e){return function(t){return"form"in t?t.parentNode&&!1===t.disabled?"label"in t?"label"in t.parentNode?t.parentNode.disabled===e:t.disabled===e:t.isDisabled===e||t.isDisabled!==!e&&mt(t)===e:t.disabled===e:"label"in t&&t.disabled===e}}function U(a){return V(function(s){return s=+s,V(function(t,e){for(var i,n=a([],t.length,s),o=n.length;o--;)t[i=n[o]]&&(t[i]=!(e[i]=t[i]))})})}function bt(t){return t&&void 0!==t.getElementsByTagName&&t}for(t in m=P.support={},H=P.isXML=function(t){var e=t.namespaceURI,t=(t.ownerDocument||t).documentElement;return!at.test(e||t&&t.nodeName||"HTML")},y=P.setDocument=function(t){var t=t?t.ownerDocument||t:d;return t!=x&&9===t.nodeType&&t.documentElement&&(i=(x=t).documentElement,S=!H(x),d!=x&&(t=x.defaultView)&&t.top!==t&&(t.addEventListener?t.addEventListener("unload",B,!1):t.attachEvent&&t.attachEvent("onunload",B)),m.scope=M(function(t){return i.appendChild(t).appendChild(x.createElement("div")),void 0!==t.querySelectorAll&&!t.querySelectorAll(":scope fieldset div").length}),m.attributes=M(function(t){return t.className="i",!t.getAttribute("className")}),m.getElementsByTagName=M(function(t){return t.appendChild(x.createComment("")),!t.getElementsByTagName("*").length}),m.getElementsByClassName=D.test(x.getElementsByClassName),m.getById=M(function(t){return i.appendChild(t).id=T,!x.getElementsByName||!x.getElementsByName(T).length}),m.getById?(_.filter.ID=function(t){var e=t.replace(I,h);return function(t){return t.getAttribute("id")===e}},_.find.ID=function(t,e){if(void 0!==e.getElementById&&S)return(e=e.getElementById(t))?[e]:[]}):(_.filter.ID=function(t){var e=t.replace(I,h);return function(t){t=void 0!==t.getAttributeNode&&t.getAttributeNode("id");return t&&t.value===e}},_.find.ID=function(t,e){if(void 0!==e.getElementById&&S){var i,n,o,s=e.getElementById(t);if(s){if((i=s.getAttributeNode("id"))&&i.value===t)return[s];for(o=e.getElementsByName(t),n=0;s=o[n++];)if((i=s.getAttributeNode("id"))&&i.value===t)return[s]}return[]}}),_.find.TAG=m.getElementsByTagName?function(t,e){return void 0!==e.getElementsByTagName?e.getElementsByTagName(t):m.qsa?e.querySelectorAll(t):void 0}:function(t,e){var i,n=[],o=0,s=e.getElementsByTagName(t);if("*"!==t)return s;for(;i=s[o++];)1===i.nodeType&&n.push(i);return n},_.find.CLASS=m.getElementsByClassName&&function(t,e){if(void 0!==e.getElementsByClassName&&S)return e.getElementsByClassName(t)},n=[],u=[],(m.qsa=D.test(x.querySelectorAll))&&(M(function(t){var e;i.appendChild(t).innerHTML="<a id='"+T+"'></a><select id='"+T+"-\r\\' msallowcapture=''><option selected=''></option></select>",t.querySelectorAll("[msallowcapture^='']").length&&u.push("[*^$]="+a+"*(?:''|\"\")"),t.querySelectorAll("[selected]").length||u.push("\\["+a+"*(?:value|"+J+")"),t.querySelectorAll("[id~="+T+"-]").length||u.push("~="),(e=x.createElement("input")).setAttribute("name",""),t.appendChild(e),t.querySelectorAll("[name='']").length||u.push("\\["+a+"*name"+a+"*="+a+"*(?:''|\"\")"),t.querySelectorAll(":checked").length||u.push(":checked"),t.querySelectorAll("a#"+T+"+*").length||u.push(".#.+[+~]"),t.querySelectorAll("\\\f"),u.push("[\\r\\n\\f]")}),M(function(t){t.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var e=x.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),t.querySelectorAll("[name=d]").length&&u.push("name"+a+"*[*^$|!~]?="),2!==t.querySelectorAll(":enabled").length&&u.push(":enabled",":disabled"),i.appendChild(t).disabled=!0,2!==t.querySelectorAll(":disabled").length&&u.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),u.push(",.*:")})),(m.matchesSelector=D.test(o=i.matches||i.webkitMatchesSelector||i.mozMatchesSelector||i.oMatchesSelector||i.msMatchesSelector))&&M(function(t){m.disconnectedMatch=o.call(t,"*"),o.call(t,"[s!='']:x"),n.push("!=",Q)}),u=u.length&&new RegExp(u.join("|")),n=n.length&&new RegExp(n.join("|")),t=D.test(i.compareDocumentPosition),g=t||D.test(i.contains)?function(t,e){var i=9===t.nodeType?t.documentElement:t,e=e&&e.parentNode;return t===e||!(!e||1!==e.nodeType||!(i.contains?i.contains(e):t.compareDocumentPosition&&16&t.compareDocumentPosition(e)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},j=t?function(t,e){var i;return t===e?(c=!0,0):(i=!t.compareDocumentPosition-!e.compareDocumentPosition)||(1&(i=(t.ownerDocument||t)==(e.ownerDocument||e)?t.compareDocumentPosition(e):1)||!m.sortDetached&&e.compareDocumentPosition(t)===i?t==x||t.ownerDocument==d&&g(d,t)?-1:e==x||e.ownerDocument==d&&g(d,e)?1:r?f(r,t)-f(r,e):0:4&i?-1:1)}:function(t,e){if(t===e)return c=!0,0;var i,n=0,o=t.parentNode,s=e.parentNode,a=[t],l=[e];if(!o||!s)return t==x?-1:e==x?1:o?-1:s?1:r?f(r,t)-f(r,e):0;if(o===s)return ut(t,e);for(i=t;i=i.parentNode;)a.unshift(i);for(i=e;i=i.parentNode;)l.unshift(i);for(;a[n]===l[n];)n++;return n?ut(a[n],l[n]):a[n]==d?-1:l[n]==d?1:0}),x},P.matches=function(t,e){return P(t,null,null,e)},P.matchesSelector=function(t,e){if(y(t),m.matchesSelector&&S&&!b[e+" "]&&!(n&&n.test(e)||u&&u.test(e)))try{var i=o.call(t,e);if(i||m.disconnectedMatch||t.document&&11!==t.document.nodeType)return i}catch(t){b(e,!0)}return 0<P(e,x,null,[t]).length},P.contains=function(t,e){return(t.ownerDocument||t)!=x&&y(t),g(t,e)},P.attr=function(t,e){(t.ownerDocument||t)!=x&&y(t);var i=_.attrHandle[e.toLowerCase()],i=i&&q.call(_.attrHandle,e.toLowerCase())?i(t,e,!S):void 0;return void 0!==i?i:m.attributes||!S?t.getAttribute(e):(i=t.getAttributeNode(e))&&i.specified?i.value:null},P.escape=function(t){return(t+"").replace(ht,R)},P.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},P.uniqueSort=function(t){var e,i=[],n=0,o=0;if(c=!m.detectDuplicates,r=!m.sortStable&&t.slice(0),t.sort(j),c){for(;e=t[o++];)e===t[o]&&(n=i.push(o));for(;n--;)t.splice(i[n],1)}return r=null,t},s=P.getText=function(t){var e,i="",n=0,o=t.nodeType;if(o){if(1===o||9===o||11===o){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)i+=s(t)}else if(3===o||4===o)return t.nodeValue}else for(;e=t[n++];)i+=s(e);return i},(_=P.selectors={cacheLength:50,createPseudo:V,match:v,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(I,h),t[3]=(t[3]||t[4]||t[5]||"").replace(I,h),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||P.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&P.error(t[0]),t},PSEUDO:function(t){var e,i=!t[6]&&t[2];return v.CHILD.test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":i&&ot.test(i)&&(e=(e=p(i,!0))&&i.indexOf(")",i.length-e)-i.length)&&(t[0]=t[0].slice(0,e),t[2]=i.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(I,h).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=$[t+" "];return e||(e=new RegExp("(^|"+a+")"+t+"("+a+"|$)"))&&$(t,function(t){return e.test("string"==typeof t.className&&t.className||void 0!==t.getAttribute&&t.getAttribute("class")||"")})},ATTR:function(e,i,n){return function(t){t=P.attr(t,e);return null==t?"!="===i:!i||(t+="","="===i?t===n:"!="===i?t!==n:"^="===i?n&&0===t.indexOf(n):"*="===i?n&&-1<t.indexOf(n):"$="===i?n&&t.slice(-n.length)===n:"~="===i?-1<(" "+t.replace(tt," ")+" ").indexOf(n):"|="===i&&(t===n||t.slice(0,n.length+1)===n+"-"))}},CHILD:function(u,t,e,g,b){var C="nth"!==u.slice(0,3),f="last"!==u.slice(-4),v="of-type"===t;return 1===g&&0===b?function(t){return!!t.parentNode}:function(t,e,i){var n,o,s,a,l,r,c=C!=f?"nextSibling":"previousSibling",d=t.parentNode,h=v&&t.nodeName.toLowerCase(),m=!i&&!v,p=!1;if(d){if(C){for(;c;){for(a=t;a=a[c];)if(v?a.nodeName.toLowerCase()===h:1===a.nodeType)return!1;r=c="only"===u&&!r&&"nextSibling"}return!0}if(r=[f?d.firstChild:d.lastChild],f&&m){for(p=(l=(n=(o=(s=(a=d)[T]||(a[T]={}))[a.uniqueID]||(s[a.uniqueID]={}))[u]||[])[0]===A&&n[1])&&n[2],a=l&&d.childNodes[l];a=++l&&a&&a[c]||(p=l=0,r.pop());)if(1===a.nodeType&&++p&&a===t){o[u]=[A,l,p];break}}else if(!1===(p=m?l=(n=(o=(s=(a=t)[T]||(a[T]={}))[a.uniqueID]||(s[a.uniqueID]={}))[u]||[])[0]===A&&n[1]:p))for(;(a=++l&&a&&a[c]||(p=l=0,r.pop()))&&((v?a.nodeName.toLowerCase()!==h:1!==a.nodeType)||!++p||(m&&((o=(s=a[T]||(a[T]={}))[a.uniqueID]||(s[a.uniqueID]={}))[u]=[A,p]),a!==t)););return(p-=b)===g||p%g==0&&0<=p/g}}},PSEUDO:function(t,s){var e,a=_.pseudos[t]||_.setFilters[t.toLowerCase()]||P.error("unsupported pseudo: "+t);return a[T]?a(s):1<a.length?(e=[t,t,"",s],_.setFilters.hasOwnProperty(t.toLowerCase())?V(function(t,e){for(var i,n=a(t,s),o=n.length;o--;)t[i=f(t,n[o])]=!(e[i]=n[o])}):function(t){return a(t,0,e)}):a}},pseudos:{not:V(function(t){var n=[],o=[],l=O(t.replace(C,"$1"));return l[T]?V(function(t,e,i,n){for(var o,s=l(t,null,n,[]),a=t.length;a--;)(o=s[a])&&(t[a]=!(e[a]=o))}):function(t,e,i){return n[0]=t,l(n,null,i,o),n[0]=null,!o.pop()}}),has:V(function(e){return function(t){return 0<P(e,t).length}}),contains:V(function(e){return e=e.replace(I,h),function(t){return-1<(t.textContent||s(t)).indexOf(e)}}),lang:V(function(i){return st.test(i||"")||P.error("unsupported lang: "+i),i=i.replace(I,h).toLowerCase(),function(t){var e;do{if(e=S?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(e=e.toLowerCase())===i||0===e.indexOf(i+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var e=F.location&&F.location.hash;return e&&e.slice(1)===t.id},root:function(t){return t===i},focus:function(t){return t===x.activeElement&&(!x.hasFocus||x.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:gt(!1),disabled:gt(!0),checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,!0===t.selected},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!_.pseudos.empty(t)},header:function(t){return rt.test(t.nodeName)},input:function(t){return lt.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(t=t.getAttribute("type"))||"text"===t.toLowerCase())},first:U(function(){return[0]}),last:U(function(t,e){return[e-1]}),eq:U(function(t,e,i){return[i<0?i+e:i]}),even:U(function(t,e){for(var i=0;i<e;i+=2)t.push(i);return t}),odd:U(function(t,e){for(var i=1;i<e;i+=2)t.push(i);return t}),lt:U(function(t,e,i){for(var n=i<0?i+e:e<i?e:i;0<=--n;)t.push(n);return t}),gt:U(function(t,e,i){for(var n=i<0?i+e:i;++n<e;)t.push(n);return t})}}).pseudos.nth=_.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})_.pseudos[t]=function(e){return function(t){return"input"===t.nodeName.toLowerCase()&&t.type===e}}(t);for(t in{submit:!0,reset:!0})_.pseudos[t]=function(i){return function(t){var e=t.nodeName.toLowerCase();return("input"===e||"button"===e)&&t.type===i}}(t);function Ct(){}function L(t){for(var e=0,i=t.length,n="";e<i;e++)n+=t[e].value;return n}function ft(a,t,e){var l=t.dir,r=t.next,c=r||l,d=e&&"parentNode"===c,h=z++;return t.first?function(t,e,i){for(;t=t[l];)if(1===t.nodeType||d)return a(t,e,i);return!1}:function(t,e,i){var n,o,s=[A,h];if(i){for(;t=t[l];)if((1===t.nodeType||d)&&a(t,e,i))return!0}else for(;t=t[l];)if(1===t.nodeType||d)if(o=(o=t[T]||(t[T]={}))[t.uniqueID]||(o[t.uniqueID]={}),r&&r===t.nodeName.toLowerCase())t=t[l]||t;else{if((n=o[c])&&n[0]===A&&n[1]===h)return s[2]=n[2];if((o[c]=s)[2]=a(t,e,i))return!0}return!1}}function vt(o){return 1<o.length?function(t,e,i){for(var n=o.length;n--;)if(!o[n](t,e,i))return!1;return!0}:o[0]}function _t(t,e,i,n,o){for(var s,a=[],l=0,r=t.length,c=null!=e;l<r;l++)!(s=t[l])||i&&!i(s,n,o)||(a.push(s),c&&e.push(l));return a}function wt(p,u,g,b,C,t){return b&&!b[T]&&(b=wt(b)),C&&!C[T]&&(C=wt(C,t)),V(function(t,e,i,n){var o,s,a,l=[],r=[],c=e.length,d=t||function(t,e,i){for(var n=0,o=e.length;n<o;n++)P(t,e[n],i);return i}(u||"*",i.nodeType?[i]:i,[]),h=!p||!t&&u?d:_t(d,l,p,i,n),m=g?C||(t?p:c||b)?[]:e:h;if(g&&g(h,m,i,n),b)for(o=_t(m,r),b(o,[],i,n),s=o.length;s--;)(a=o[s])&&(m[r[s]]=!(h[r[s]]=a));if(t){if(C||p){if(C){for(o=[],s=m.length;s--;)(a=m[s])&&o.push(h[s]=a);C(null,m=[],o,n)}for(s=m.length;s--;)(a=m[s])&&-1<(o=C?f(t,a):l[s])&&(t[o]=!(e[o]=a))}}else m=_t(m===e?m.splice(c,m.length):m),C?C(null,e,m,n):k.apply(e,m)})}function yt(b,C){function t(t,e,i,n,o){var s,a,l,r=0,c="0",d=t&&[],h=[],m=w,p=t||v&&_.find.TAG("*",o),u=A+=null==m?1:Math.random()||.1,g=p.length;for(o&&(w=e==x||e||o);c!==g&&null!=(s=p[c]);c++){if(v&&s){for(a=0,e||s.ownerDocument==x||(y(s),i=!S);l=b[a++];)if(l(s,e||x,i)){n.push(s);break}o&&(A=u)}f&&((s=!l&&s)&&r--,t&&d.push(s))}if(r+=c,f&&c!==r){for(a=0;l=C[a++];)l(d,h,e,i);if(t){if(0<r)for(;c--;)d[c]||h[c]||(h[c]=K.call(n));h=_t(h)}k.apply(n,h),o&&!t&&0<h.length&&1<r+C.length&&P.uniqueSort(n)}return o&&(A=u,w=m),d}var f=0<C.length,v=0<b.length;return f?V(t):t}return Ct.prototype=_.filters=_.pseudos,_.setFilters=new Ct,p=P.tokenize=function(t,e){var i,n,o,s,a,l,r,c=W[t+" "];if(c)return e?0:c.slice(0);for(a=t,l=[],r=_.preFilter;a;){for(s in i&&!(n=et.exec(a))||(n&&(a=a.slice(n[0].length)||a),l.push(o=[])),i=!1,(n=it.exec(a))&&(i=n.shift(),o.push({value:i,type:n[0].replace(C," ")}),a=a.slice(i.length)),_.filter)!(n=v[s].exec(a))||r[s]&&!(n=r[s](n))||(i=n.shift(),o.push({value:i,type:s,matches:n}),a=a.slice(i.length));if(!i)break}return e?a.length:a?P.error(t):W(t,l).slice(0)},O=P.compile=function(t,e){var i,n=[],o=[],s=G[t+" "];if(!s){for(i=(e=e||p(t)).length;i--;)((s=function t(e){for(var n,i,o,s=e.length,a=_.relative[e[0].type],l=a||_.relative[" "],r=a?1:0,c=ft(function(t){return t===n},l,!0),d=ft(function(t){return-1<f(n,t)},l,!0),h=[function(t,e,i){return t=!a&&(i||e!==w)||((n=e).nodeType?c:d)(t,e,i),n=null,t}];r<s;r++)if(i=_.relative[e[r].type])h=[ft(vt(h),i)];else{if((i=_.filter[e[r].type].apply(null,e[r].matches))[T]){for(o=++r;o<s&&!_.relative[e[o].type];o++);return wt(1<r&&vt(h),1<r&&L(e.slice(0,r-1).concat({value:" "===e[r-2].type?"*":""})).replace(C,"$1"),i,r<o&&t(e.slice(r,o)),o<s&&t(e=e.slice(o)),o<s&&L(e))}h.push(i)}return vt(h)}(e[i]))[T]?n:o).push(s);(s=G(t,yt(o,n))).selector=t}return s},N=P.select=function(t,e,i,n){var o,s,a,l,r,c="function"==typeof t&&t,d=!n&&p(t=c.selector||t);if(i=i||[],1===d.length){if(2<(s=d[0]=d[0].slice(0)).length&&"ID"===(a=s[0]).type&&9===e.nodeType&&S&&_.relative[s[1].type]){if(!(e=(_.find.ID(a.matches[0].replace(I,h),e)||[])[0]))return i;c&&(e=e.parentNode),t=t.slice(s.shift().value.length)}for(o=v.needsContext.test(t)?0:s.length;o--&&(a=s[o],!_.relative[l=a.type]);)if((r=_.find[l])&&(n=r(a.matches[0].replace(I,h),dt.test(s[0].type)&&bt(e.parentNode)||e))){if(s.splice(o,1),t=n.length&&L(s))break;return k.apply(i,n),i}}return(c||O(t,d))(n,e,!S,i,!e||dt.test(t)&&bt(e.parentNode)||e),i},m.sortStable=T.split("").sort(j).join("")===T,m.detectDuplicates=!!c,y(),m.sortDetached=M(function(t){return 1&t.compareDocumentPosition(x.createElement("fieldset"))}),M(function(t){return t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href")})||pt("type|href|height|width",function(t,e,i){if(!i)return t.getAttribute(e,"type"===e.toLowerCase()?1:2)}),m.attributes&&M(function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")})||pt("value",function(t,e,i){if(!i&&"input"===t.nodeName.toLowerCase())return t.defaultValue}),M(function(t){return null==t.getAttribute("disabled")})||pt(J,function(t,e,i){if(!i)return!0===t[e]?e.toLowerCase():(i=t.getAttributeNode(e))&&i.specified?i.value:null}),P}(w),X=(x.find=t,x.expr=t.selectors,x.expr[":"]=x.expr.pseudos,x.uniqueSort=x.unique=t.uniqueSort,x.text=t.getText,x.isXMLDoc=t.isXML,x.contains=t.contains,x.escapeSelector=t.escape,x.expr.match.needsContext);function r(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()}var J=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function Z(t,i,n){return f(i)?x.grep(t,function(t,e){return!!i.call(t,e,t)!==n}):i.nodeType?x.grep(t,function(t){return t===i!==n}):"string"!=typeof i?x.grep(t,function(t){return-1<O.call(i,t)!==n}):x.filter(i,t,n)}x.filter=function(t,e,i){var n=e[0];return i&&(t=":not("+t+")"),1===e.length&&1===n.nodeType?x.find.matchesSelector(n,t)?[n]:[]:x.find.matches(t,x.grep(e,function(t){return 1===t.nodeType}))},x.fn.extend({find:function(t){var e,i,n=this.length,o=this;if("string"!=typeof t)return this.pushStack(x(t).filter(function(){for(e=0;e<n;e++)if(x.contains(o[e],this))return!0}));for(i=this.pushStack([]),e=0;e<n;e++)x.find(t,o[e],i);return 1<n?x.uniqueSort(i):i},filter:function(t){return this.pushStack(Z(this,t||[],!1))},not:function(t){return this.pushStack(Z(this,t||[],!0))},is:function(t){return!!Z(this,"string"==typeof t&&X.test(t)?x(t):t||[],!1).length}});var Q,tt=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/,et=((x.fn.init=function(t,e,i){if(t){if(i=i||Q,"string"!=typeof t)return t.nodeType?(this[0]=t,this.length=1,this):f(t)?void 0!==i.ready?i.ready(t):t(x):x.makeArray(t,this);if(!(n="<"===t[0]&&">"===t[t.length-1]&&3<=t.length?[null,t,null]:tt.exec(t))||!n[1]&&e)return(!e||e.jquery?e||i:this.constructor(e)).find(t);if(n[1]){if(e=e instanceof x?e[0]:e,x.merge(this,x.parseHTML(n[1],e&&e.nodeType?e.ownerDocument||e:y,!0)),J.test(n[1])&&x.isPlainObject(e))for(var n in e)f(this[n])?this[n](e[n]):this.attr(n,e[n])}else(i=y.getElementById(n[2]))&&(this[0]=i,this.length=1)}return this}).prototype=x.fn,Q=x(y),/^(?:parents|prev(?:Until|All))/),it={children:!0,contents:!0,next:!0,prev:!0};function nt(t,e){for(;(t=t[e])&&1!==t.nodeType;);return t}x.fn.extend({has:function(t){var e=x(t,this),i=e.length;return this.filter(function(){for(var t=0;t<i;t++)if(x.contains(this,e[t]))return!0})},closest:function(t,e){var i,n=0,o=this.length,s=[],a="string"!=typeof t&&x(t);if(!X.test(t))for(;n<o;n++)for(i=this[n];i&&i!==e;i=i.parentNode)if(i.nodeType<11&&(a?-1<a.index(i):1===i.nodeType&&x.find.matchesSelector(i,t))){s.push(i);break}return this.pushStack(1<s.length?x.uniqueSort(s):s)},index:function(t){return t?"string"==typeof t?O.call(x(t),this[0]):O.call(this,t.jquery?t[0]:t):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(x.uniqueSort(x.merge(this.get(),x(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),x.each({parent:function(t){t=t.parentNode;return t&&11!==t.nodeType?t:null},parents:function(t){return n(t,"parentNode")},parentsUntil:function(t,e,i){return n(t,"parentNode",i)},next:function(t){return nt(t,"nextSibling")},prev:function(t){return nt(t,"previousSibling")},nextAll:function(t){return n(t,"nextSibling")},prevAll:function(t){return n(t,"previousSibling")},nextUntil:function(t,e,i){return n(t,"nextSibling",i)},prevUntil:function(t,e,i){return n(t,"previousSibling",i)},siblings:function(t){return Y((t.parentNode||{}).firstChild,t)},children:function(t){return Y(t.firstChild)},contents:function(t){return null!=t.contentDocument&&R(t.contentDocument)?t.contentDocument:(r(t,"template")&&(t=t.content||t),x.merge([],t.childNodes))}},function(n,o){x.fn[n]=function(t,e){var i=x.map(this,o,t);return(e="Until"!==n.slice(-5)?t:e)&&"string"==typeof e&&(i=x.filter(e,i)),1<this.length&&(it[n]||x.uniqueSort(i),et.test(n)&&i.reverse()),this.pushStack(i)}});var S=/[^\x20\t\r\n\f]+/g;function d(t){return t}function ot(t){throw t}function st(t,e,i,n){var o;try{t&&f(o=t.promise)?o.call(t).done(e).fail(i):t&&f(o=t.then)?o.call(t,e,i):e.apply(void 0,[t].slice(n))}catch(t){i.apply(void 0,[t])}}x.Callbacks=function(n){var t,i;n="string"==typeof n?(t=n,i={},x.each(t.match(S)||[],function(t,e){i[e]=!0}),i):x.extend({},n);function o(){for(l=l||n.once,a=s=!0;c.length;d=-1)for(e=c.shift();++d<r.length;)!1===r[d].apply(e[0],e[1])&&n.stopOnFalse&&(d=r.length,e=!1);n.memory||(e=!1),s=!1,l&&(r=e?[]:"")}var s,e,a,l,r=[],c=[],d=-1,h={add:function(){return r&&(e&&!s&&(d=r.length-1,c.push(e)),function i(t){x.each(t,function(t,e){f(e)?n.unique&&h.has(e)||r.push(e):e&&e.length&&"string"!==u(e)&&i(e)})}(arguments),e&&!s&&o()),this},remove:function(){return x.each(arguments,function(t,e){for(var i;-1<(i=x.inArray(e,r,i));)r.splice(i,1),i<=d&&d--}),this},has:function(t){return t?-1<x.inArray(t,r):0<r.length},empty:function(){return r=r&&[],this},disable:function(){return l=c=[],r=e="",this},disabled:function(){return!r},lock:function(){return l=c=[],e||s||(r=e=""),this},locked:function(){return!!l},fireWith:function(t,e){return l||(e=[t,(e=e||[]).slice?e.slice():e],c.push(e),s||o()),this},fire:function(){return h.fireWith(this,arguments),this},fired:function(){return!!a}};return h},x.extend({Deferred:function(t){var s=[["notify","progress",x.Callbacks("memory"),x.Callbacks("memory"),2],["resolve","done",x.Callbacks("once memory"),x.Callbacks("once memory"),0,"resolved"],["reject","fail",x.Callbacks("once memory"),x.Callbacks("once memory"),1,"rejected"]],o="pending",a={state:function(){return o},always:function(){return l.done(arguments).fail(arguments),this},catch:function(t){return a.then(null,t)},pipe:function(){var o=arguments;return x.Deferred(function(n){x.each(s,function(t,e){var i=f(o[e[4]])&&o[e[4]];l[e[1]](function(){var t=i&&i.apply(this,arguments);t&&f(t.promise)?t.promise().progress(n.notify).done(n.resolve).fail(n.reject):n[e[0]+"With"](this,i?[t]:arguments)})}),o=null}).promise()},then:function(e,i,n){var r=0;function c(o,s,a,l){return function(){function t(){var t,e;if(!(o<r)){if((t=a.apply(i,n))===s.promise())throw new TypeError("Thenable self-resolution");e=t&&("object"==typeof t||"function"==typeof t)&&t.then,f(e)?l?e.call(t,c(r,s,d,l),c(r,s,ot,l)):(r++,e.call(t,c(r,s,d,l),c(r,s,ot,l),c(r,s,d,s.notifyWith))):(a!==d&&(i=void 0,n=[t]),(l||s.resolveWith)(i,n))}}var i=this,n=arguments,e=l?t:function(){try{t()}catch(t){x.Deferred.exceptionHook&&x.Deferred.exceptionHook(t,e.stackTrace),r<=o+1&&(a!==ot&&(i=void 0,n=[t]),s.rejectWith(i,n))}};o?e():(x.Deferred.getStackHook&&(e.stackTrace=x.Deferred.getStackHook()),w.setTimeout(e))}}return x.Deferred(function(t){s[0][3].add(c(0,t,f(n)?n:d,t.notifyWith)),s[1][3].add(c(0,t,f(e)?e:d)),s[2][3].add(c(0,t,f(i)?i:ot))}).promise()},promise:function(t){return null!=t?x.extend(t,a):a}},l={};return x.each(s,function(t,e){var i=e[2],n=e[5];a[e[1]]=i.add,n&&i.add(function(){o=n},s[3-t][2].disable,s[3-t][3].disable,s[0][2].lock,s[0][3].lock),i.add(e[3].fire),l[e[0]]=function(){return l[e[0]+"With"](this===l?void 0:this,arguments),this},l[e[0]+"With"]=i.fireWith}),a.promise(l),t&&t.call(l,l),l},when:function(t){function e(e){return function(t){o[e]=this,s[e]=1<arguments.length?l.call(arguments):t,--i||a.resolveWith(o,s)}}var i=arguments.length,n=i,o=Array(n),s=l.call(arguments),a=x.Deferred();if(i<=1&&(st(t,a.done(e(n)).resolve,a.reject,!i),"pending"===a.state()||f(s[n]&&s[n].then)))return a.then();for(;n--;)st(s[n],e(n),a.reject);return a.promise()}});var at=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/,lt=(x.Deferred.exceptionHook=function(t,e){w.console&&w.console.warn&&t&&at.test(t.name)&&w.console.warn("jQuery.Deferred exception: "+t.message,t.stack,e)},x.readyException=function(t){w.setTimeout(function(){throw t})},x.Deferred());function rt(){y.removeEventListener("DOMContentLoaded",rt),w.removeEventListener("load",rt),x.ready()}x.fn.ready=function(t){return lt.then(t).catch(function(t){x.readyException(t)}),this},x.extend({isReady:!1,readyWait:1,ready:function(t){(!0===t?--x.readyWait:x.isReady)||(x.isReady=!0)!==t&&0<--x.readyWait||lt.resolveWith(y,[x])}}),x.ready.then=lt.then,"complete"===y.readyState||"loading"!==y.readyState&&!y.documentElement.doScroll?w.setTimeout(x.ready):(y.addEventListener("DOMContentLoaded",rt),w.addEventListener("load",rt));function h(t,e,i,n,o,s,a){var l=0,r=t.length,c=null==i;if("object"===u(i))for(l in o=!0,i)h(t,e,l,i[l],!0,s,a);else if(void 0!==n&&(o=!0,f(n)||(a=!0),e=c?a?(e.call(t,n),null):(c=e,function(t,e,i){return c.call(x(t),i)}):e))for(;l<r;l++)e(t[l],i,a?n:n.call(t[l],l,e(t[l],i)));return o?t:c?e.call(t):r?e(t[0],i):s}var ct=/^-ms-/,dt=/-([a-z])/g;function ht(t,e){return e.toUpperCase()}function v(t){return t.replace(ct,"ms-").replace(dt,ht)}function C(t){return 1===t.nodeType||9===t.nodeType||!+t.nodeType}function mt(){this.expando=x.expando+mt.uid++}mt.uid=1,mt.prototype={cache:function(t){var e=t[this.expando];return e||(e={},C(t)&&(t.nodeType?t[this.expando]=e:Object.defineProperty(t,this.expando,{value:e,configurable:!0}))),e},set:function(t,e,i){var n,o=this.cache(t);if("string"==typeof e)o[v(e)]=i;else for(n in e)o[v(n)]=e[n];return o},get:function(t,e){return void 0===e?this.cache(t):t[this.expando]&&t[this.expando][v(e)]},access:function(t,e,i){return void 0===e||e&&"string"==typeof e&&void 0===i?this.get(t,e):(this.set(t,e,i),void 0!==i?i:e)},remove:function(t,e){var i,n=t[this.expando];if(void 0!==n){if(void 0!==e){i=(e=Array.isArray(e)?e.map(v):(e=v(e))in n?[e]:e.match(S)||[]).length;for(;i--;)delete n[e[i]]}void 0!==e&&!x.isEmptyObject(n)||(t.nodeType?t[this.expando]=void 0:delete t[this.expando])}},hasData:function(t){t=t[this.expando];return void 0!==t&&!x.isEmptyObject(t)}};var _=new mt,c=new mt,pt=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,ut=/[A-Z]/g;function gt(t,e,i){var n,o;if(void 0===i&&1===t.nodeType)if(n="data-"+e.replace(ut,"-$&").toLowerCase(),"string"==typeof(i=t.getAttribute(n))){try{i="true"===(o=i)||"false"!==o&&("null"===o?null:o===+o+""?+o:pt.test(o)?JSON.parse(o):o)}catch(t){}c.set(t,e,i)}else i=void 0;return i}x.extend({hasData:function(t){return c.hasData(t)||_.hasData(t)},data:function(t,e,i){return c.access(t,e,i)},removeData:function(t,e){c.remove(t,e)},_data:function(t,e,i){return _.access(t,e,i)},_removeData:function(t,e){_.remove(t,e)}}),x.fn.extend({data:function(i,t){var e,n,o,s=this[0],a=s&&s.attributes;if(void 0!==i)return"object"==typeof i?this.each(function(){c.set(this,i)}):h(this,function(t){var e;if(s&&void 0===t)return void 0!==(e=c.get(s,i))||void 0!==(e=gt(s,i))?e:void 0;this.each(function(){c.set(this,i,t)})},null,t,1<arguments.length,null,!0);if(this.length&&(o=c.get(s),1===s.nodeType&&!_.get(s,"hasDataAttrs"))){for(e=a.length;e--;)a[e]&&0===(n=a[e].name).indexOf("data-")&&(n=v(n.slice(5)),gt(s,n,o[n]));_.set(s,"hasDataAttrs",!0)}return o},removeData:function(t){return this.each(function(){c.remove(this,t)})}}),x.extend({queue:function(t,e,i){var n;if(t)return n=_.get(t,e=(e||"fx")+"queue"),i&&(!n||Array.isArray(i)?n=_.access(t,e,x.makeArray(i)):n.push(i)),n||[]},dequeue:function(t,e){e=e||"fx";var i=x.queue(t,e),n=i.length,o=i.shift(),s=x._queueHooks(t,e);"inprogress"===o&&(o=i.shift(),n--),o&&("fx"===e&&i.unshift("inprogress"),delete s.stop,o.call(t,function(){x.dequeue(t,e)},s)),!n&&s&&s.empty.fire()},_queueHooks:function(t,e){var i=e+"queueHooks";return _.get(t,i)||_.access(t,i,{empty:x.Callbacks("once memory").add(function(){_.remove(t,[e+"queue",i])})})}}),x.fn.extend({queue:function(e,i){var t=2;return"string"!=typeof e&&(i=e,e="fx",t--),arguments.length<t?x.queue(this[0],e):void 0===i?this:this.each(function(){var t=x.queue(this,e,i);x._queueHooks(this,e),"fx"===e&&"inprogress"!==t[0]&&x.dequeue(this,e)})},dequeue:function(t){return this.each(function(){x.dequeue(this,t)})},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){function i(){--o||s.resolveWith(a,[a])}var n,o=1,s=x.Deferred(),a=this,l=this.length;for("string"!=typeof t&&(e=t,t=void 0),t=t||"fx";l--;)(n=_.get(a[l],t+"queueHooks"))&&n.empty&&(o++,n.empty.add(i));return i(),s.promise(e)}});function bt(t,e){return"none"===(t=e||t).style.display||""===t.style.display&&A(t)&&"none"===x.css(t,"display")}var t=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,Ct=new RegExp("^(?:([+-])=|)("+t+")([a-z%]*)$","i"),m=["Top","Right","Bottom","Left"],T=y.documentElement,A=function(t){return x.contains(t.ownerDocument,t)},ft={composed:!0};T.getRootNode&&(A=function(t){return x.contains(t.ownerDocument,t)||t.getRootNode(ft)===t.ownerDocument});function vt(t,e,i,n){var o,s,a=20,l=n?function(){return n.cur()}:function(){return x.css(t,e,"")},r=l(),c=i&&i[3]||(x.cssNumber[e]?"":"px"),d=t.nodeType&&(x.cssNumber[e]||"px"!==c&&+r)&&Ct.exec(x.css(t,e));if(d&&d[3]!==c){for(c=c||d[3],d=+(r/=2)||1;a--;)x.style(t,e,d+c),(1-s)*(1-(s=l()/r||.5))<=0&&(a=0),d/=s;x.style(t,e,(d*=2)+c),i=i||[]}return i&&(d=+d||+r||0,o=i[1]?d+(i[1]+1)*i[2]:+i[2],n&&(n.unit=c,n.start=d,n.end=o)),o}var _t={};function k(t,e){for(var i,n,o,s,a,l=[],r=0,c=t.length;r<c;r++)(n=t[r]).style&&(i=n.style.display,e?("none"===i&&(l[r]=_.get(n,"display")||null,l[r]||(n.style.display="")),""===n.style.display&&bt(n)&&(l[r]=(a=s=void 0,s=(o=n).ownerDocument,o=o.nodeName,(a=_t[o])||(s=s.body.appendChild(s.createElement(o)),a=x.css(s,"display"),s.parentNode.removeChild(s),_t[o]=a="none"===a?"block":a),a))):"none"!==i&&(l[r]="none",_.set(n,"display",i)));for(r=0;r<c;r++)null!=l[r]&&(t[r].style.display=l[r]);return t}x.fn.extend({show:function(){return k(this,!0)},hide:function(){return k(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each(function(){bt(this)?x(this).show():x(this).hide()})}});var wt=/^(?:checkbox|radio)$/i,yt=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,xt=/^$|^module$|\/(?:java|ecma)script/i,D=(V=y.createDocumentFragment().appendChild(y.createElement("div")),(a=y.createElement("input")).setAttribute("type","radio"),a.setAttribute("checked","checked"),a.setAttribute("name","t"),V.appendChild(a),b.checkClone=V.cloneNode(!0).cloneNode(!0).lastChild.checked,V.innerHTML="<textarea>x</textarea>",b.noCloneChecked=!!V.cloneNode(!0).lastChild.defaultValue,V.innerHTML="<option></option>",b.option=!!V.lastChild,{thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]});function I(t,e){var i=void 0!==t.getElementsByTagName?t.getElementsByTagName(e||"*"):void 0!==t.querySelectorAll?t.querySelectorAll(e||"*"):[];return void 0===e||e&&r(t,e)?x.merge([t],i):i}function St(t,e){for(var i=0,n=t.length;i<n;i++)_.set(t[i],"globalEval",!e||_.get(e[i],"globalEval"))}D.tbody=D.tfoot=D.colgroup=D.caption=D.thead,D.th=D.td,b.option||(D.optgroup=D.option=[1,"<select multiple='multiple'>","</select>"]);var Tt=/<|&#?\w+;/;function At(t,e,i,n,o){for(var s,a,l,r,c,d=e.createDocumentFragment(),h=[],m=0,p=t.length;m<p;m++)if((s=t[m])||0===s)if("object"===u(s))x.merge(h,s.nodeType?[s]:s);else if(Tt.test(s)){for(a=a||d.appendChild(e.createElement("div")),l=(yt.exec(s)||["",""])[1].toLowerCase(),l=D[l]||D._default,a.innerHTML=l[1]+x.htmlPrefilter(s)+l[2],c=l[0];c--;)a=a.lastChild;x.merge(h,a.childNodes),(a=d.firstChild).textContent=""}else h.push(e.createTextNode(s));for(d.textContent="",m=0;s=h[m++];)if(n&&-1<x.inArray(s,n))o&&o.push(s);else if(r=A(s),a=I(d.appendChild(s),"script"),r&&St(a),i)for(c=0;s=a[c++];)xt.test(s.type||"")&&i.push(s);return d}var kt=/^key/,Dt=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,It=/^([^.]*)(?:\.(.+)|)/;function i(){return!0}function p(){return!1}function Pt(t,e){return t===function(){try{return y.activeElement}catch(t){}}()==("focus"===e)}function Et(t,e,i,n,o,s){var a,l;if("object"==typeof e){for(l in"string"!=typeof i&&(n=n||i,i=void 0),e)Et(t,l,i,n,e[l],s);return t}if(null==n&&null==o?(o=i,n=i=void 0):null==o&&("string"==typeof i?(o=n,n=void 0):(o=n,n=i,i=void 0)),!1===o)o=p;else if(!o)return t;return 1===s&&(a=o,(o=function(t){return x().off(t),a.apply(this,arguments)}).guid=a.guid||(a.guid=x.guid++)),t.each(function(){x.event.add(this,e,o,n,i)})}function Vt(t,o,s){s?(_.set(t,o,!1),x.event.add(t,o,{namespace:!1,handler:function(t){var e,i,n=_.get(this,o);if(1&t.isTrigger&&this[o]){if(n.length)(x.event.special[o]||{}).delegateType&&t.stopPropagation();else if(n=l.call(arguments),_.set(this,o,n),e=s(this,o),this[o](),n!==(i=_.get(this,o))||e?_.set(this,o,!1):i={},n!==i)return t.stopImmediatePropagation(),t.preventDefault(),i.value}else n.length&&(_.set(this,o,{value:x.event.trigger(x.extend(n[0],x.Event.prototype),n.slice(1),this)}),t.stopImmediatePropagation())}})):void 0===_.get(t,o)&&x.event.add(t,o,i)}x.event={global:{},add:function(e,t,i,n,o){var s,a,l,r,c,d,h,m,p,u=_.get(e);if(C(e))for(i.handler&&(i=(s=i).handler,o=s.selector),o&&x.find.matchesSelector(T,o),i.guid||(i.guid=x.guid++),l=(l=u.events)||(u.events=Object.create(null)),a=(a=u.handle)||(u.handle=function(t){return void 0!==x&&x.event.triggered!==t.type?x.event.dispatch.apply(e,arguments):void 0}),r=(t=(t||"").match(S)||[""]).length;r--;)h=p=(m=It.exec(t[r])||[])[1],m=(m[2]||"").split(".").sort(),h&&(c=x.event.special[h]||{},h=(o?c.delegateType:c.bindType)||h,c=x.event.special[h]||{},p=x.extend({type:h,origType:p,data:n,handler:i,guid:i.guid,selector:o,needsContext:o&&x.expr.match.needsContext.test(o),namespace:m.join(".")},s),(d=l[h])||((d=l[h]=[]).delegateCount=0,c.setup&&!1!==c.setup.call(e,n,m,a)||e.addEventListener&&e.addEventListener(h,a)),c.add&&(c.add.call(e,p),p.handler.guid||(p.handler.guid=i.guid)),o?d.splice(d.delegateCount++,0,p):d.push(p),x.event.global[h]=!0)},remove:function(t,e,i,n,o){var s,a,l,r,c,d,h,m,p,u,g,b=_.hasData(t)&&_.get(t);if(b&&(r=b.events)){for(c=(e=(e||"").match(S)||[""]).length;c--;)if(p=g=(l=It.exec(e[c])||[])[1],u=(l[2]||"").split(".").sort(),p){for(h=x.event.special[p]||{},m=r[p=(n?h.delegateType:h.bindType)||p]||[],l=l[2]&&new RegExp("(^|\\.)"+u.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=s=m.length;s--;)d=m[s],!o&&g!==d.origType||i&&i.guid!==d.guid||l&&!l.test(d.namespace)||n&&n!==d.selector&&("**"!==n||!d.selector)||(m.splice(s,1),d.selector&&m.delegateCount--,h.remove&&h.remove.call(t,d));a&&!m.length&&(h.teardown&&!1!==h.teardown.call(t,u,b.handle)||x.removeEvent(t,p,b.handle),delete r[p])}else for(p in r)x.event.remove(t,p+e[c],i,n,!0);x.isEmptyObject(r)&&_.remove(t,"handle events")}},dispatch:function(t){var e,i,n,o,s,a=new Array(arguments.length),l=x.event.fix(t),t=(_.get(this,"events")||Object.create(null))[l.type]||[],r=x.event.special[l.type]||{};for(a[0]=l,e=1;e<arguments.length;e++)a[e]=arguments[e];if(l.delegateTarget=this,!r.preDispatch||!1!==r.preDispatch.call(this,l)){for(s=x.event.handlers.call(this,l,t),e=0;(n=s[e++])&&!l.isPropagationStopped();)for(l.currentTarget=n.elem,i=0;(o=n.handlers[i++])&&!l.isImmediatePropagationStopped();)l.rnamespace&&!1!==o.namespace&&!l.rnamespace.test(o.namespace)||(l.handleObj=o,l.data=o.data,void 0!==(o=((x.event.special[o.origType]||{}).handle||o.handler).apply(n.elem,a))&&!1===(l.result=o)&&(l.preventDefault(),l.stopPropagation()));return r.postDispatch&&r.postDispatch.call(this,l),l.result}},handlers:function(t,e){var i,n,o,s,a,l=[],r=e.delegateCount,c=t.target;if(r&&c.nodeType&&!("click"===t.type&&1<=t.button))for(;c!==this;c=c.parentNode||this)if(1===c.nodeType&&("click"!==t.type||!0!==c.disabled)){for(s=[],a={},i=0;i<r;i++)void 0===a[o=(n=e[i]).selector+" "]&&(a[o]=n.needsContext?-1<x(o,this).index(c):x.find(o,this,null,[c]).length),a[o]&&s.push(n);s.length&&l.push({elem:c,handlers:s})}return c=this,r<e.length&&l.push({elem:c,handlers:e.slice(r)}),l},addProp:function(e,t){Object.defineProperty(x.Event.prototype,e,{enumerable:!0,configurable:!0,get:f(t)?function(){if(this.originalEvent)return t(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[e]},set:function(t){Object.defineProperty(this,e,{enumerable:!0,configurable:!0,writable:!0,value:t})}})},fix:function(t){return t[x.expando]?t:new x.Event(t)},special:{load:{noBubble:!0},click:{setup:function(t){t=this||t;return wt.test(t.type)&&t.click&&r(t,"input")&&Vt(t,"click",i),!1},trigger:function(t){t=this||t;return wt.test(t.type)&&t.click&&r(t,"input")&&Vt(t,"click"),!0},_default:function(t){t=t.target;return wt.test(t.type)&&t.click&&r(t,"input")&&_.get(t,"click")||r(t,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}}},x.removeEvent=function(t,e,i){t.removeEventListener&&t.removeEventListener(e,i)},x.Event=function(t,e){if(!(this instanceof x.Event))return new x.Event(t,e);t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&!1===t.returnValue?i:p,this.target=t.target&&3===t.target.nodeType?t.target.parentNode:t.target,this.currentTarget=t.currentTarget,this.relatedTarget=t.relatedTarget):this.type=t,e&&x.extend(this,e),this.timeStamp=t&&t.timeStamp||Date.now(),this[x.expando]=!0},x.Event.prototype={constructor:x.Event,isDefaultPrevented:p,isPropagationStopped:p,isImmediatePropagationStopped:p,isSimulated:!1,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=i,t&&!this.isSimulated&&t.preventDefault()},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=i,t&&!this.isSimulated&&t.stopPropagation()},stopImmediatePropagation:function(){var t=this.originalEvent;this.isImmediatePropagationStopped=i,t&&!this.isSimulated&&t.stopImmediatePropagation(),this.stopPropagation()}},x.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(t){var e=t.button;return null==t.which&&kt.test(t.type)?null!=t.charCode?t.charCode:t.keyCode:!t.which&&void 0!==e&&Dt.test(t.type)?1&e?1:2&e?3:4&e?2:0:t.which}},x.event.addProp),x.each({focus:"focusin",blur:"focusout"},function(t,e){x.event.special[t]={setup:function(){return Vt(this,t,Pt),!1},trigger:function(){return Vt(this,t),!0},delegateType:e}}),x.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(t,o){x.event.special[t]={delegateType:o,bindType:o,handle:function(t){var e,i=t.relatedTarget,n=t.handleObj;return i&&(i===this||x.contains(this,i))||(t.type=n.origType,e=n.handler.apply(this,arguments),t.type=o),e}}}),x.fn.extend({on:function(t,e,i,n){return Et(this,t,e,i,n)},one:function(t,e,i,n){return Et(this,t,e,i,n,1)},off:function(t,e,i){var n,o;if(t&&t.preventDefault&&t.handleObj)n=t.handleObj,x(t.delegateTarget).off(n.namespace?n.origType+"."+n.namespace:n.origType,n.selector,n.handler);else{if("object"!=typeof t)return!1!==e&&"function"!=typeof e||(i=e,e=void 0),!1===i&&(i=p),this.each(function(){x.event.remove(this,t,i,e)});for(o in t)this.off(o,e,t[o])}return this}});var Mt=/<script|<style|<link/i,Ut=/checked\s*(?:[^=]|=\s*.checked.)/i,Lt=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function Ft(t,e){return r(t,"table")&&r(11!==e.nodeType?e:e.firstChild,"tr")&&x(t).children("tbody")[0]||t}function Rt(t){return t.type=(null!==t.getAttribute("type"))+"/"+t.type,t}function Bt(t){return"true/"===(t.type||"").slice(0,5)?t.type=t.type.slice(5):t.removeAttribute("type"),t}function Ht(t,e){var i,n,o,s;if(1===e.nodeType){if(_.hasData(t)&&(s=_.get(t).events))for(o in _.remove(e,"handle events"),s)for(i=0,n=s[o].length;i<n;i++)x.event.add(e,o,s[o][i]);c.hasData(t)&&(t=c.access(t),t=x.extend({},t),c.set(e,t))}}function P(i,n,o,s){n=B(n);var t,e,a,l,r,c,d=0,h=i.length,m=h-1,p=n[0],u=f(p);if(u||1<h&&"string"==typeof p&&!b.checkClone&&Ut.test(p))return i.each(function(t){var e=i.eq(t);u&&(n[0]=p.call(this,t,e.html())),P(e,n,o,s)});if(h&&(e=(t=At(n,i[0].ownerDocument,!1,i,s)).firstChild,1===t.childNodes.length&&(t=e),e||s)){for(l=(a=x.map(I(t,"script"),Rt)).length;d<h;d++)r=t,d!==m&&(r=x.clone(r,!0,!0),l&&x.merge(a,I(r,"script"))),o.call(i[d],r,d);if(l)for(c=a[a.length-1].ownerDocument,x.map(a,Bt),d=0;d<l;d++)r=a[d],xt.test(r.type||"")&&!_.access(r,"globalEval")&&x.contains(c,r)&&(r.src&&"module"!==(r.type||"").toLowerCase()?x._evalUrl&&!r.noModule&&x._evalUrl(r.src,{nonce:r.nonce||r.getAttribute("nonce")},c):q(r.textContent.replace(Lt,""),r,c))}return i}function Ot(t,e,i){for(var n,o=e?x.filter(e,t):t,s=0;null!=(n=o[s]);s++)i||1!==n.nodeType||x.cleanData(I(n)),n.parentNode&&(i&&A(n)&&St(I(n,"script")),n.parentNode.removeChild(n));return t}x.extend({htmlPrefilter:function(t){return t},clone:function(t,e,i){var n,o,s,a,l,r,c,d=t.cloneNode(!0),h=A(t);if(!(b.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||x.isXMLDoc(t)))for(a=I(d),n=0,o=(s=I(t)).length;n<o;n++)l=s[n],r=a[n],c=void 0,"input"===(c=r.nodeName.toLowerCase())&&wt.test(l.type)?r.checked=l.checked:"input"!==c&&"textarea"!==c||(r.defaultValue=l.defaultValue);if(e)if(i)for(s=s||I(t),a=a||I(d),n=0,o=s.length;n<o;n++)Ht(s[n],a[n]);else Ht(t,d);return 0<(a=I(d,"script")).length&&St(a,!h&&I(t,"script")),d},cleanData:function(t){for(var e,i,n,o=x.event.special,s=0;void 0!==(i=t[s]);s++)if(C(i)){if(e=i[_.expando]){if(e.events)for(n in e.events)o[n]?x.event.remove(i,n):x.removeEvent(i,n,e.handle);i[_.expando]=void 0}i[c.expando]&&(i[c.expando]=void 0)}}}),x.fn.extend({detach:function(t){return Ot(this,t,!0)},remove:function(t){return Ot(this,t)},text:function(t){return h(this,function(t){return void 0===t?x.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=t)})},null,t,arguments.length)},append:function(){return P(this,arguments,function(t){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||Ft(this,t).appendChild(t)})},prepend:function(){return P(this,arguments,function(t){var e;1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(e=Ft(this,t)).insertBefore(t,e.firstChild)})},before:function(){return P(this,arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this)})},after:function(){return P(this,arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)})},empty:function(){for(var t,e=0;null!=(t=this[e]);e++)1===t.nodeType&&(x.cleanData(I(t,!1)),t.textContent="");return this},clone:function(t,e){return t=null!=t&&t,e=null==e?t:e,this.map(function(){return x.clone(this,t,e)})},html:function(t){return h(this,function(t){var e=this[0]||{},i=0,n=this.length;if(void 0===t&&1===e.nodeType)return e.innerHTML;if("string"==typeof t&&!Mt.test(t)&&!D[(yt.exec(t)||["",""])[1].toLowerCase()]){t=x.htmlPrefilter(t);try{for(;i<n;i++)1===(e=this[i]||{}).nodeType&&(x.cleanData(I(e,!1)),e.innerHTML=t);e=0}catch(t){}}e&&this.empty().append(t)},null,t,arguments.length)},replaceWith:function(){var i=[];return P(this,arguments,function(t){var e=this.parentNode;x.inArray(this,i)<0&&(x.cleanData(I(this)),e&&e.replaceChild(t,this))},i)}}),x.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(t,a){x.fn[t]=function(t){for(var e,i=[],n=x(t),o=n.length-1,s=0;s<=o;s++)e=s===o?this:this.clone(!0),x(n[s])[a](e),H.apply(i,e.get());return this.pushStack(i)}});function Nt(t){var e=t.ownerDocument.defaultView;return(e=e&&e.opener?e:w).getComputedStyle(t)}function zt(t,e,i){var n,o={};for(n in e)o[n]=t.style[n],t.style[n]=e[n];for(n in i=i.call(t),e)t.style[n]=o[n];return i}var $t,Wt,Gt,jt,qt,Kt,Yt,o,Xt=new RegExp("^("+t+")(?!px)[a-z%]+$","i"),Jt=new RegExp(m.join("|"),"i");function Zt(){var t;o&&(Yt.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",o.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",T.appendChild(Yt).appendChild(o),t=w.getComputedStyle(o),$t="1%"!==t.top,Kt=12===Qt(t.marginLeft),o.style.right="60%",jt=36===Qt(t.right),Wt=36===Qt(t.width),o.style.position="absolute",Gt=12===Qt(o.offsetWidth/3),T.removeChild(Yt),o=null)}function Qt(t){return Math.round(parseFloat(t))}function te(t,e,i){var n,o,s=t.style;return(i=i||Nt(t))&&(""!==(o=i.getPropertyValue(e)||i[e])||A(t)||(o=x.style(t,e)),!b.pixelBoxStyles()&&Xt.test(o)&&Jt.test(e)&&(t=s.width,e=s.minWidth,n=s.maxWidth,s.minWidth=s.maxWidth=s.width=o,o=i.width,s.width=t,s.minWidth=e,s.maxWidth=n)),void 0!==o?o+"":o}function ee(t,e){return{get:function(){if(!t())return(this.get=e).apply(this,arguments);delete this.get}}}Yt=y.createElement("div"),(o=y.createElement("div")).style&&(o.style.backgroundClip="content-box",o.cloneNode(!0).style.backgroundClip="",b.clearCloneStyle="content-box"===o.style.backgroundClip,x.extend(b,{boxSizingReliable:function(){return Zt(),Wt},pixelBoxStyles:function(){return Zt(),jt},pixelPosition:function(){return Zt(),$t},reliableMarginLeft:function(){return Zt(),Kt},scrollboxSize:function(){return Zt(),Gt},reliableTrDimensions:function(){var t,e,i;return null==qt&&(t=y.createElement("table"),e=y.createElement("tr"),i=y.createElement("div"),t.style.cssText="position:absolute;left:-11111px",e.style.height="1px",i.style.height="9px",T.appendChild(t).appendChild(e).appendChild(i),i=w.getComputedStyle(e),qt=3<parseInt(i.height),T.removeChild(t)),qt}}));var ie=["Webkit","Moz","ms"],ne=y.createElement("div").style,oe={};function se(t){var e=x.cssProps[t]||oe[t];return e||(t in ne?t:oe[t]=function(t){for(var e=t[0].toUpperCase()+t.slice(1),i=ie.length;i--;)if((t=ie[i]+e)in ne)return t}(t)||t)}var ae=/^(none|table(?!-c[ea]).+)/,le=/^--/,re={position:"absolute",visibility:"hidden",display:"block"},ce={letterSpacing:"0",fontWeight:"400"};function de(t,e,i){var n=Ct.exec(e);return n?Math.max(0,n[2]-(i||0))+(n[3]||"px"):e}function he(t,e,i,n,o,s){var a="width"===e?1:0,l=0,r=0;if(i===(n?"border":"content"))return 0;for(;a<4;a+=2)"margin"===i&&(r+=x.css(t,i+m[a],!0,o)),n?("content"===i&&(r-=x.css(t,"padding"+m[a],!0,o)),"margin"!==i&&(r-=x.css(t,"border"+m[a]+"Width",!0,o))):(r+=x.css(t,"padding"+m[a],!0,o),"padding"!==i?r+=x.css(t,"border"+m[a]+"Width",!0,o):l+=x.css(t,"border"+m[a]+"Width",!0,o));return!n&&0<=s&&(r+=Math.max(0,Math.ceil(t["offset"+e[0].toUpperCase()+e.slice(1)]-s-r-l-.5))||0),r}function me(t,e,i){var n=Nt(t),o=(!b.boxSizingReliable()||i)&&"border-box"===x.css(t,"boxSizing",!1,n),s=o,a=te(t,e,n),l="offset"+e[0].toUpperCase()+e.slice(1);if(Xt.test(a)){if(!i)return a;a="auto"}return(!b.boxSizingReliable()&&o||!b.reliableTrDimensions()&&r(t,"tr")||"auto"===a||!parseFloat(a)&&"inline"===x.css(t,"display",!1,n))&&t.getClientRects().length&&(o="border-box"===x.css(t,"boxSizing",!1,n),(s=l in t)&&(a=t[l])),(a=parseFloat(a)||0)+he(t,e,i||(o?"border":"content"),s,n,a)+"px"}function s(t,e,i,n,o){return new s.prototype.init(t,e,i,n,o)}x.extend({cssHooks:{opacity:{get:function(t,e){if(e)return""===(e=te(t,"opacity"))?"1":e}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(t,e,i,n){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var o,s,a,l=v(e),r=le.test(e),c=t.style;if(r||(e=se(l)),a=x.cssHooks[e]||x.cssHooks[l],void 0===i)return a&&"get"in a&&void 0!==(o=a.get(t,!1,n))?o:c[e];"string"===(s=typeof i)&&(o=Ct.exec(i))&&o[1]&&(i=vt(t,e,o),s="number"),null!=i&&i==i&&("number"!==s||r||(i+=o&&o[3]||(x.cssNumber[l]?"":"px")),b.clearCloneStyle||""!==i||0!==e.indexOf("background")||(c[e]="inherit"),a&&"set"in a&&void 0===(i=a.set(t,i,n))||(r?c.setProperty(e,i):c[e]=i))}},css:function(t,e,i,n){var o,s=v(e);return le.test(e)||(e=se(s)),"normal"===(o=void 0===(o=(s=x.cssHooks[e]||x.cssHooks[s])&&"get"in s?s.get(t,!0,i):o)?te(t,e,n):o)&&e in ce&&(o=ce[e]),(""===i||i)&&(s=parseFloat(o),!0===i||isFinite(s))?s||0:o}}),x.each(["height","width"],function(t,a){x.cssHooks[a]={get:function(t,e,i){if(e)return!ae.test(x.css(t,"display"))||t.getClientRects().length&&t.getBoundingClientRect().width?me(t,a,i):zt(t,re,function(){return me(t,a,i)})},set:function(t,e,i){var n=Nt(t),o=!b.scrollboxSize()&&"absolute"===n.position,s=(o||i)&&"border-box"===x.css(t,"boxSizing",!1,n),i=i?he(t,a,i,s,n):0;return s&&o&&(i-=Math.ceil(t["offset"+a[0].toUpperCase()+a.slice(1)]-parseFloat(n[a])-he(t,a,"border",!1,n)-.5)),i&&(s=Ct.exec(e))&&"px"!==(s[3]||"px")&&(t.style[a]=e,e=x.css(t,a)),de(0,e,i)}}}),x.cssHooks.marginLeft=ee(b.reliableMarginLeft,function(t,e){if(e)return(parseFloat(te(t,"marginLeft"))||t.getBoundingClientRect().left-zt(t,{marginLeft:0},function(){return t.getBoundingClientRect().left}))+"px"}),x.each({margin:"",padding:"",border:"Width"},function(o,s){x.cssHooks[o+s]={expand:function(t){for(var e=0,i={},n="string"==typeof t?t.split(" "):[t];e<4;e++)i[o+m[e]+s]=n[e]||n[e-2]||n[0];return i}},"margin"!==o&&(x.cssHooks[o+s].set=de)}),x.fn.extend({css:function(t,e){return h(this,function(t,e,i){var n,o,s={},a=0;if(Array.isArray(e)){for(n=Nt(t),o=e.length;a<o;a++)s[e[a]]=x.css(t,e[a],!1,n);return s}return void 0!==i?x.style(t,e,i):x.css(t,e)},t,e,1<arguments.length)}}),((x.Tween=s).prototype={constructor:s,init:function(t,e,i,n,o,s){this.elem=t,this.prop=i,this.easing=o||x.easing._default,this.options=e,this.start=this.now=this.cur(),this.end=n,this.unit=s||(x.cssNumber[i]?"":"px")},cur:function(){var t=s.propHooks[this.prop];return(t&&t.get?t:s.propHooks._default).get(this)},run:function(t){var e,i=s.propHooks[this.prop];return this.options.duration?this.pos=e=x.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):this.pos=e=t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),(i&&i.set?i:s.propHooks._default).set(this),this}}).init.prototype=s.prototype,(s.propHooks={_default:{get:function(t){return 1!==t.elem.nodeType||null!=t.elem[t.prop]&&null==t.elem.style[t.prop]?t.elem[t.prop]:(t=x.css(t.elem,t.prop,""))&&"auto"!==t?t:0},set:function(t){x.fx.step[t.prop]?x.fx.step[t.prop](t):1!==t.elem.nodeType||!x.cssHooks[t.prop]&&null==t.elem.style[se(t.prop)]?t.elem[t.prop]=t.now:x.style(t.elem,t.prop,t.now+t.unit)}}}).scrollTop=s.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},x.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2},_default:"swing"},x.fx=s.prototype.init,x.fx.step={};var E,pe,a,V,ue=/^(?:toggle|show|hide)$/,ge=/queueHooks$/;function be(){pe&&(!1===y.hidden&&w.requestAnimationFrame?w.requestAnimationFrame(be):w.setTimeout(be,x.fx.interval),x.fx.tick())}function Ce(){return w.setTimeout(function(){E=void 0}),E=Date.now()}function fe(t,e){var i,n=0,o={height:t};for(e=e?1:0;n<4;n+=2-e)o["margin"+(i=m[n])]=o["padding"+i]=t;return e&&(o.opacity=o.width=t),o}function ve(t,e,i){for(var n,o=(M.tweeners[e]||[]).concat(M.tweeners["*"]),s=0,a=o.length;s<a;s++)if(n=o[s].call(i,e,t))return n}function M(o,t,e){var i,s,n,a,l,r,c,d=0,h=M.prefilters.length,m=x.Deferred().always(function(){delete p.elem}),p=function(){if(!s){for(var t=E||Ce(),t=Math.max(0,u.startTime+u.duration-t),e=1-(t/u.duration||0),i=0,n=u.tweens.length;i<n;i++)u.tweens[i].run(e);if(m.notifyWith(o,[u,e,t]),e<1&&n)return t;n||m.notifyWith(o,[u,1,0]),m.resolveWith(o,[u])}return!1},u=m.promise({elem:o,props:x.extend({},t),opts:x.extend(!0,{specialEasing:{},easing:x.easing._default},e),originalProperties:t,originalOptions:e,startTime:E||Ce(),duration:e.duration,tweens:[],createTween:function(t,e){e=x.Tween(o,u.opts,t,e,u.opts.specialEasing[t]||u.opts.easing);return u.tweens.push(e),e},stop:function(t){var e=0,i=t?u.tweens.length:0;if(!s){for(s=!0;e<i;e++)u.tweens[e].run(1);t?(m.notifyWith(o,[u,1,0]),m.resolveWith(o,[u,t])):m.rejectWith(o,[u,t])}return this}}),g=u.props,b=g,C=u.opts.specialEasing;for(n in b)if(l=C[a=v(n)],r=b[n],Array.isArray(r)&&(l=r[1],r=b[n]=r[0]),n!==a&&(b[a]=r,delete b[n]),(c=x.cssHooks[a])&&"expand"in c)for(n in r=c.expand(r),delete b[a],r)n in b||(b[n]=r[n],C[n]=l);else C[a]=l;for(;d<h;d++)if(i=M.prefilters[d].call(u,o,g,u.opts))return f(i.stop)&&(x._queueHooks(u.elem,u.opts.queue).stop=i.stop.bind(i)),i;return x.map(g,ve,u),f(u.opts.start)&&u.opts.start.call(o,u),u.progress(u.opts.progress).done(u.opts.done,u.opts.complete).fail(u.opts.fail).always(u.opts.always),x.fx.timer(x.extend(p,{elem:o,anim:u,queue:u.opts.queue})),u}x.Animation=x.extend(M,{tweeners:{"*":[function(t,e){var i=this.createTween(t,e);return vt(i.elem,t,Ct.exec(e),i),i}]},tweener:function(t,e){for(var i,n=0,o=(t=f(t)?(e=t,["*"]):t.match(S)).length;n<o;n++)i=t[n],M.tweeners[i]=M.tweeners[i]||[],M.tweeners[i].unshift(e)},prefilters:[function(t,e,i){var n,o,s,a,l,r,c,d="width"in e||"height"in e,h=this,m={},p=t.style,u=t.nodeType&&bt(t),g=_.get(t,"fxshow");for(n in i.queue||(null==(a=x._queueHooks(t,"fx")).unqueued&&(a.unqueued=0,l=a.empty.fire,a.empty.fire=function(){a.unqueued||l()}),a.unqueued++,h.always(function(){h.always(function(){a.unqueued--,x.queue(t,"fx").length||a.empty.fire()})})),e)if(o=e[n],ue.test(o)){if(delete e[n],s=s||"toggle"===o,o===(u?"hide":"show")){if("show"!==o||!g||void 0===g[n])continue;u=!0}m[n]=g&&g[n]||x.style(t,n)}if((r=!x.isEmptyObject(e))||!x.isEmptyObject(m))for(n in d&&1===t.nodeType&&(i.overflow=[p.overflow,p.overflowX,p.overflowY],null==(c=g&&g.display)&&(c=_.get(t,"display")),"none"===(d=x.css(t,"display"))&&(c?d=c:(k([t],!0),c=t.style.display||c,d=x.css(t,"display"),k([t]))),("inline"===d||"inline-block"===d&&null!=c)&&"none"===x.css(t,"float")&&(r||(h.done(function(){p.display=c}),null==c&&(d=p.display,c="none"===d?"":d)),p.display="inline-block")),i.overflow&&(p.overflow="hidden",h.always(function(){p.overflow=i.overflow[0],p.overflowX=i.overflow[1],p.overflowY=i.overflow[2]})),r=!1,m)r||(g?"hidden"in g&&(u=g.hidden):g=_.access(t,"fxshow",{display:c}),s&&(g.hidden=!u),u&&k([t],!0),h.done(function(){for(n in u||k([t]),_.remove(t,"fxshow"),m)x.style(t,n,m[n])})),r=ve(u?g[n]:0,n,h),n in g||(g[n]=r.start,u&&(r.end=r.start,r.start=0))}],prefilter:function(t,e){e?M.prefilters.unshift(t):M.prefilters.push(t)}}),x.speed=function(t,e,i){var n=t&&"object"==typeof t?x.extend({},t):{complete:i||!i&&e||f(t)&&t,duration:t,easing:i&&e||e&&!f(e)&&e};return x.fx.off?n.duration=0:"number"!=typeof n.duration&&(n.duration in x.fx.speeds?n.duration=x.fx.speeds[n.duration]:n.duration=x.fx.speeds._default),null!=n.queue&&!0!==n.queue||(n.queue="fx"),n.old=n.complete,n.complete=function(){f(n.old)&&n.old.call(this),n.queue&&x.dequeue(this,n.queue)},n},x.fn.extend({fadeTo:function(t,e,i,n){return this.filter(bt).css("opacity",0).show().end().animate({opacity:e},t,i,n)},animate:function(e,t,i,n){function o(){var t=M(this,x.extend({},e),a);(s||_.get(this,"finish"))&&t.stop(!0)}var s=x.isEmptyObject(e),a=x.speed(t,i,n);return o.finish=o,s||!1===a.queue?this.each(o):this.queue(a.queue,o)},stop:function(o,t,s){function a(t){var e=t.stop;delete t.stop,e(s)}return"string"!=typeof o&&(s=t,t=o,o=void 0),t&&this.queue(o||"fx",[]),this.each(function(){var t=!0,e=null!=o&&o+"queueHooks",i=x.timers,n=_.get(this);if(e)n[e]&&n[e].stop&&a(n[e]);else for(e in n)n[e]&&n[e].stop&&ge.test(e)&&a(n[e]);for(e=i.length;e--;)i[e].elem!==this||null!=o&&i[e].queue!==o||(i[e].anim.stop(s),t=!1,i.splice(e,1));!t&&s||x.dequeue(this,o)})},finish:function(a){return!1!==a&&(a=a||"fx"),this.each(function(){var t,e=_.get(this),i=e[a+"queue"],n=e[a+"queueHooks"],o=x.timers,s=i?i.length:0;for(e.finish=!0,x.queue(this,a,[]),n&&n.stop&&n.stop.call(this,!0),t=o.length;t--;)o[t].elem===this&&o[t].queue===a&&(o[t].anim.stop(!0),o.splice(t,1));for(t=0;t<s;t++)i[t]&&i[t].finish&&i[t].finish.call(this);delete e.finish})}}),x.each(["toggle","show","hide"],function(t,n){var o=x.fn[n];x.fn[n]=function(t,e,i){return null==t||"boolean"==typeof t?o.apply(this,arguments):this.animate(fe(n,!0),t,e,i)}}),x.each({slideDown:fe("show"),slideUp:fe("hide"),slideToggle:fe("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(t,n){x.fn[t]=function(t,e,i){return this.animate(n,t,e,i)}}),x.timers=[],x.fx.tick=function(){var t,e=0,i=x.timers;for(E=Date.now();e<i.length;e++)(t=i[e])()||i[e]!==t||i.splice(e--,1);i.length||x.fx.stop(),E=void 0},x.fx.timer=function(t){x.timers.push(t),x.fx.start()},x.fx.interval=13,x.fx.start=function(){pe||(pe=!0,be())},x.fx.stop=function(){pe=null},x.fx.speeds={slow:600,fast:200,_default:400},x.fn.delay=function(n,t){return n=x.fx&&x.fx.speeds[n]||n,this.queue(t=t||"fx",function(t,e){var i=w.setTimeout(t,n);e.stop=function(){w.clearTimeout(i)}})},a=y.createElement("input"),V=y.createElement("select").appendChild(y.createElement("option")),a.type="checkbox",b.checkOn=""!==a.value,b.optSelected=V.selected,(a=y.createElement("input")).value="t",a.type="radio",b.radioValue="t"===a.value;var _e,we=x.expr.attrHandle,ye=(x.fn.extend({attr:function(t,e){return h(this,x.attr,t,e,1<arguments.length)},removeAttr:function(t){return this.each(function(){x.removeAttr(this,t)})}}),x.extend({attr:function(t,e,i){var n,o,s=t.nodeType;if(3!==s&&8!==s&&2!==s)return void 0===t.getAttribute?x.prop(t,e,i):(1===s&&x.isXMLDoc(t)||(o=x.attrHooks[e.toLowerCase()]||(x.expr.match.bool.test(e)?_e:void 0)),void 0!==i?null===i?void x.removeAttr(t,e):o&&"set"in o&&void 0!==(n=o.set(t,i,e))?n:(t.setAttribute(e,i+""),i):!(o&&"get"in o&&null!==(n=o.get(t,e)))&&null==(n=x.find.attr(t,e))?void 0:n)},attrHooks:{type:{set:function(t,e){var i;if(!b.radioValue&&"radio"===e&&r(t,"input"))return i=t.value,t.setAttribute("type",e),i&&(t.value=i),e}}},removeAttr:function(t,e){var i,n=0,o=e&&e.match(S);if(o&&1===t.nodeType)for(;i=o[n++];)t.removeAttribute(i)}}),_e={set:function(t,e,i){return!1===e?x.removeAttr(t,i):t.setAttribute(i,i),i}},x.each(x.expr.match.bool.source.match(/\w+/g),function(t,e){var a=we[e]||x.find.attr;we[e]=function(t,e,i){var n,o,s=e.toLowerCase();return i||(o=we[s],we[s]=n,n=null!=a(t,e,i)?s:null,we[s]=o),n}}),/^(?:input|select|textarea|button)$/i),xe=/^(?:a|area)$/i;function U(t){return(t.match(S)||[]).join(" ")}function L(t){return t.getAttribute&&t.getAttribute("class")||""}function Se(t){return Array.isArray(t)?t:"string"==typeof t&&t.match(S)||[]}x.fn.extend({prop:function(t,e){return h(this,x.prop,t,e,1<arguments.length)},removeProp:function(t){return this.each(function(){delete this[x.propFix[t]||t]})}}),x.extend({prop:function(t,e,i){var n,o,s=t.nodeType;if(3!==s&&8!==s&&2!==s)return 1===s&&x.isXMLDoc(t)||(e=x.propFix[e]||e,o=x.propHooks[e]),void 0!==i?o&&"set"in o&&void 0!==(n=o.set(t,i,e))?n:t[e]=i:o&&"get"in o&&null!==(n=o.get(t,e))?n:t[e]},propHooks:{tabIndex:{get:function(t){var e=x.find.attr(t,"tabindex");return e?parseInt(e,10):ye.test(t.nodeName)||xe.test(t.nodeName)&&t.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),b.optSelected||(x.propHooks.selected={get:function(t){t=t.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null},set:function(t){t=t.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),x.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){x.propFix[this.toLowerCase()]=this}),x.fn.extend({addClass:function(e){var t,i,n,o,s,a,l=0;if(f(e))return this.each(function(t){x(this).addClass(e.call(this,t,L(this)))});if((t=Se(e)).length)for(;i=this[l++];)if(a=L(i),n=1===i.nodeType&&" "+U(a)+" "){for(s=0;o=t[s++];)n.indexOf(" "+o+" ")<0&&(n+=o+" ");a!==(a=U(n))&&i.setAttribute("class",a)}return this},removeClass:function(e){var t,i,n,o,s,a,l=0;if(f(e))return this.each(function(t){x(this).removeClass(e.call(this,t,L(this)))});if(!arguments.length)return this.attr("class","");if((t=Se(e)).length)for(;i=this[l++];)if(a=L(i),n=1===i.nodeType&&" "+U(a)+" "){for(s=0;o=t[s++];)for(;-1<n.indexOf(" "+o+" ");)n=n.replace(" "+o+" "," ");a!==(a=U(n))&&i.setAttribute("class",a)}return this},toggleClass:function(o,e){var s=typeof o,a="string"==s||Array.isArray(o);return"boolean"==typeof e&&a?e?this.addClass(o):this.removeClass(o):f(o)?this.each(function(t){x(this).toggleClass(o.call(this,t,L(this),e),e)}):this.each(function(){var t,e,i,n;if(a)for(e=0,i=x(this),n=Se(o);t=n[e++];)i.hasClass(t)?i.removeClass(t):i.addClass(t);else void 0!==o&&"boolean"!=s||((t=L(this))&&_.set(this,"__className__",t),this.setAttribute&&this.setAttribute("class",!t&&!1!==o&&_.get(this,"__className__")||""))})},hasClass:function(t){for(var e,i=0,n=" "+t+" ";e=this[i++];)if(1===e.nodeType&&-1<(" "+U(L(e))+" ").indexOf(n))return!0;return!1}});function Te(t){t.stopPropagation()}var Ae=/\r/g,ke=(x.fn.extend({val:function(e){var i,t,n,o=this[0];return arguments.length?(n=f(e),this.each(function(t){1===this.nodeType&&(null==(t=n?e.call(this,t,x(this).val()):e)?t="":"number"==typeof t?t+="":Array.isArray(t)&&(t=x.map(t,function(t){return null==t?"":t+""})),(i=x.valHooks[this.type]||x.valHooks[this.nodeName.toLowerCase()])&&"set"in i&&void 0!==i.set(this,t,"value")||(this.value=t))})):o?(i=x.valHooks[o.type]||x.valHooks[o.nodeName.toLowerCase()])&&"get"in i&&void 0!==(t=i.get(o,"value"))?t:"string"==typeof(t=o.value)?t.replace(Ae,""):null==t?"":t:void 0}}),x.extend({valHooks:{option:{get:function(t){var e=x.find.attr(t,"value");return null!=e?e:U(x.text(t))}},select:{get:function(t){for(var e,i=t.options,n=t.selectedIndex,o="select-one"===t.type,s=o?null:[],a=o?n+1:i.length,l=n<0?a:o?n:0;l<a;l++)if(((e=i[l]).selected||l===n)&&!(e.disabled||e.parentNode.disabled&&r(e.parentNode,"optgroup"))){if(e=x(e).val(),o)return e;s.push(e)}return s},set:function(t,e){for(var i,n,o=t.options,s=x.makeArray(e),a=o.length;a--;)((n=o[a]).selected=-1<x.inArray(x.valHooks.option.get(n),s))&&(i=!0);return i||(t.selectedIndex=-1),s}}}}),x.each(["radio","checkbox"],function(){x.valHooks[this]={set:function(t,e){if(Array.isArray(e))return t.checked=-1<x.inArray(x(t).val(),e)}},b.checkOn||(x.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})}),b.focusin="onfocusin"in w,/^(?:focusinfocus|focusoutblur)$/),De=(x.extend(x.event,{trigger:function(t,e,i,n){var o,s,a,l,r,c,d,h=[i||y],m=$.call(t,"type")?t.type:t,p=$.call(t,"namespace")?t.namespace.split("."):[],u=d=s=i=i||y;if(3!==i.nodeType&&8!==i.nodeType&&!ke.test(m+x.event.triggered)&&(-1<m.indexOf(".")&&(m=(p=m.split(".")).shift(),p.sort()),l=m.indexOf(":")<0&&"on"+m,(t=t[x.expando]?t:new x.Event(m,"object"==typeof t&&t)).isTrigger=n?2:3,t.namespace=p.join("."),t.rnamespace=t.namespace?new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=i),e=null==e?[t]:x.makeArray(e,[t]),c=x.event.special[m]||{},n||!c.trigger||!1!==c.trigger.apply(i,e))){if(!n&&!c.noBubble&&!g(i)){for(a=c.delegateType||m,ke.test(a+m)||(u=u.parentNode);u;u=u.parentNode)h.push(u),s=u;s===(i.ownerDocument||y)&&h.push(s.defaultView||s.parentWindow||w)}for(o=0;(u=h[o++])&&!t.isPropagationStopped();)d=u,t.type=1<o?a:c.bindType||m,(r=(_.get(u,"events")||Object.create(null))[t.type]&&_.get(u,"handle"))&&r.apply(u,e),(r=l&&u[l])&&r.apply&&C(u)&&(t.result=r.apply(u,e),!1===t.result&&t.preventDefault());return t.type=m,n||t.isDefaultPrevented()||c._default&&!1!==c._default.apply(h.pop(),e)||!C(i)||l&&f(i[m])&&!g(i)&&((s=i[l])&&(i[l]=null),x.event.triggered=m,t.isPropagationStopped()&&d.addEventListener(m,Te),i[m](),t.isPropagationStopped()&&d.removeEventListener(m,Te),x.event.triggered=void 0,s&&(i[l]=s)),t.result}},simulate:function(t,e,i){i=x.extend(new x.Event,i,{type:t,isSimulated:!0});x.event.trigger(i,null,e)}}),x.fn.extend({trigger:function(t,e){return this.each(function(){x.event.trigger(t,e,this)})},triggerHandler:function(t,e){var i=this[0];if(i)return x.event.trigger(t,e,i,!0)}}),b.focusin||x.each({focus:"focusin",blur:"focusout"},function(i,n){function o(t){x.event.simulate(n,t.target,x.event.fix(t))}x.event.special[n]={setup:function(){var t=this.ownerDocument||this.document||this,e=_.access(t,n);e||t.addEventListener(i,o,!0),_.access(t,n,(e||0)+1)},teardown:function(){var t=this.ownerDocument||this.document||this,e=_.access(t,n)-1;e?_.access(t,n,e):(t.removeEventListener(i,o,!0),_.remove(t,n))}}}),w.location),Ie={guid:Date.now()},Pe=/\?/,Ee=(x.parseXML=function(t){var e;if(!t||"string"!=typeof t)return null;try{e=(new w.DOMParser).parseFromString(t,"text/xml")}catch(t){e=void 0}return e&&!e.getElementsByTagName("parsererror").length||x.error("Invalid XML: "+t),e},/\[\]$/),Ve=/\r?\n/g,Me=/^(?:submit|button|image|reset|file)$/i,Ue=/^(?:input|select|textarea|keygen)/i;x.param=function(t,e){function i(t,e){e=f(e)?e():e,o[o.length]=encodeURIComponent(t)+"="+encodeURIComponent(null==e?"":e)}var n,o=[];if(null==t)return"";if(Array.isArray(t)||t.jquery&&!x.isPlainObject(t))x.each(t,function(){i(this.name,this.value)});else for(n in t)!function i(n,t,o,s){if(Array.isArray(t))x.each(t,function(t,e){o||Ee.test(n)?s(n,e):i(n+"["+("object"==typeof e&&null!=e?t:"")+"]",e,o,s)});else if(o||"object"!==u(t))s(n,t);else for(var e in t)i(n+"["+e+"]",t[e],o,s)}(n,t[n],e,i);return o.join("&")},x.fn.extend({serialize:function(){return x.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var t=x.prop(this,"elements");return t?x.makeArray(t):this}).filter(function(){var t=this.type;return this.name&&!x(this).is(":disabled")&&Ue.test(this.nodeName)&&!Me.test(t)&&(this.checked||!wt.test(t))}).map(function(t,e){var i=x(this).val();return null==i?null:Array.isArray(i)?x.map(i,function(t){return{name:e.name,value:t.replace(Ve,"\r\n")}}):{name:e.name,value:i.replace(Ve,"\r\n")}}).get()}});var Le=/%20/g,Fe=/#.*$/,Re=/([?&])_=[^&]*/,Be=/^(.*?):[ \t]*([^\r\n]*)$/gm,He=/^(?:GET|HEAD)$/,Oe=/^\/\//,Ne={},ze={},$e="*/".concat("*"),We=y.createElement("a");function Ge(s){return function(t,e){"string"!=typeof t&&(e=t,t="*");var i,n=0,o=t.toLowerCase().match(S)||[];if(f(e))for(;i=o[n++];)"+"===i[0]?(i=i.slice(1)||"*",(s[i]=s[i]||[]).unshift(e)):(s[i]=s[i]||[]).push(e)}}function je(e,n,o,s){var a={},l=e===ze;function r(t){var i;return a[t]=!0,x.each(e[t]||[],function(t,e){e=e(n,o,s);return"string"!=typeof e||l||a[e]?l?!(i=e):void 0:(n.dataTypes.unshift(e),r(e),!1)}),i}return r(n.dataTypes[0])||!a["*"]&&r("*")}function qe(t,e){var i,n,o=x.ajaxSettings.flatOptions||{};for(i in e)void 0!==e[i]&&((o[i]?t:n=n||{})[i]=e[i]);return n&&x.extend(!0,t,n),t}We.href=De.href,x.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:De.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(De.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":$e,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":x.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?qe(qe(t,x.ajaxSettings),e):qe(x.ajaxSettings,t)},ajaxPrefilter:Ge(Ne),ajaxTransport:Ge(ze),ajax:function(t,e){"object"==typeof t&&(e=t,t=void 0);var r,c,d,i,h,m,p,n,u=x.ajaxSetup({},e=e||{}),g=u.context||u,b=u.context&&(g.nodeType||g.jquery)?x(g):x.event,C=x.Deferred(),f=x.Callbacks("once memory"),v=u.statusCode||{},o={},s={},a="canceled",_={readyState:0,getResponseHeader:function(t){var e;if(m){if(!i)for(i={};e=Be.exec(d);)i[e[1].toLowerCase()+" "]=(i[e[1].toLowerCase()+" "]||[]).concat(e[2]);e=i[t.toLowerCase()+" "]}return null==e?null:e.join(", ")},getAllResponseHeaders:function(){return m?d:null},setRequestHeader:function(t,e){return null==m&&(t=s[t.toLowerCase()]=s[t.toLowerCase()]||t,o[t]=e),this},overrideMimeType:function(t){return null==m&&(u.mimeType=t),this},statusCode:function(t){if(t)if(m)_.always(t[_.status]);else for(var e in t)v[e]=[v[e],t[e]];return this},abort:function(t){t=t||a;return r&&r.abort(t),l(0,t),this}};if(C.promise(_),u.url=((t||u.url||De.href)+"").replace(Oe,De.protocol+"//"),u.type=e.method||e.type||u.method||u.type,u.dataTypes=(u.dataType||"*").toLowerCase().match(S)||[""],null==u.crossDomain){t=y.createElement("a");try{t.href=u.url,t.href=t.href,u.crossDomain=We.protocol+"//"+We.host!=t.protocol+"//"+t.host}catch(t){u.crossDomain=!0}}if(u.data&&u.processData&&"string"!=typeof u.data&&(u.data=x.param(u.data,u.traditional)),je(Ne,u,e,_),!m){for(n in(p=x.event&&u.global)&&0==x.active++&&x.event.trigger("ajaxStart"),u.type=u.type.toUpperCase(),u.hasContent=!He.test(u.type),c=u.url.replace(Fe,""),u.hasContent?u.data&&u.processData&&0===(u.contentType||"").indexOf("application/x-www-form-urlencoded")&&(u.data=u.data.replace(Le,"+")):(t=u.url.slice(c.length),u.data&&(u.processData||"string"==typeof u.data)&&(c+=(Pe.test(c)?"&":"?")+u.data,delete u.data),!1===u.cache&&(c=c.replace(Re,"$1"),t=(Pe.test(c)?"&":"?")+"_="+Ie.guid+++t),u.url=c+t),u.ifModified&&(x.lastModified[c]&&_.setRequestHeader("If-Modified-Since",x.lastModified[c]),x.etag[c]&&_.setRequestHeader("If-None-Match",x.etag[c])),(u.data&&u.hasContent&&!1!==u.contentType||e.contentType)&&_.setRequestHeader("Content-Type",u.contentType),_.setRequestHeader("Accept",u.dataTypes[0]&&u.accepts[u.dataTypes[0]]?u.accepts[u.dataTypes[0]]+("*"!==u.dataTypes[0]?", "+$e+"; q=0.01":""):u.accepts["*"]),u.headers)_.setRequestHeader(n,u.headers[n]);if(u.beforeSend&&(!1===u.beforeSend.call(g,_,u)||m))return _.abort();if(a="abort",f.add(u.complete),_.done(u.success),_.fail(u.error),r=je(ze,u,e,_)){if(_.readyState=1,p&&b.trigger("ajaxSend",[_,u]),m)return _;u.async&&0<u.timeout&&(h=w.setTimeout(function(){_.abort("timeout")},u.timeout));try{m=!1,r.send(o,l)}catch(t){if(m)throw t;l(-1,t)}}else l(-1,"No Transport")}return _;function l(t,e,i,n){var o,s,a,l=e;m||(m=!0,h&&w.clearTimeout(h),r=void 0,d=n||"",_.readyState=0<t?4:0,n=200<=t&&t<300||304===t,i&&(a=function(t,e,i){for(var n,o,s,a,l=t.contents,r=t.dataTypes;"*"===r[0];)r.shift(),void 0===n&&(n=t.mimeType||e.getResponseHeader("Content-Type"));if(n)for(o in l)if(l[o]&&l[o].test(n)){r.unshift(o);break}if(r[0]in i)s=r[0];else{for(o in i){if(!r[0]||t.converters[o+" "+r[0]]){s=o;break}a=a||o}s=s||a}if(s)return s!==r[0]&&r.unshift(s),i[s]}(u,_,i)),!n&&-1<x.inArray("script",u.dataTypes)&&(u.converters["text script"]=function(){}),a=function(t,e,i,n){var o,s,a,l,r,c={},d=t.dataTypes.slice();if(d[1])for(a in t.converters)c[a.toLowerCase()]=t.converters[a];for(s=d.shift();s;)if(t.responseFields[s]&&(i[t.responseFields[s]]=e),!r&&n&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),r=s,s=d.shift())if("*"===s)s=r;else if("*"!==r&&r!==s){if(!(a=c[r+" "+s]||c["* "+s]))for(o in c)if((l=o.split(" "))[1]===s&&(a=c[r+" "+l[0]]||c["* "+l[0]])){!0===a?a=c[o]:!0!==c[o]&&(s=l[0],d.unshift(l[1]));break}if(!0!==a)if(a&&t.throws)e=a(e);else try{e=a(e)}catch(t){return{state:"parsererror",error:a?t:"No conversion from "+r+" to "+s}}}return{state:"success",data:e}}(u,a,_,n),n?(u.ifModified&&((i=_.getResponseHeader("Last-Modified"))&&(x.lastModified[c]=i),(i=_.getResponseHeader("etag"))&&(x.etag[c]=i)),204===t||"HEAD"===u.type?l="nocontent":304===t?l="notmodified":(l=a.state,o=a.data,n=!(s=a.error))):(s=l,!t&&l||(l="error",t<0&&(t=0))),_.status=t,_.statusText=(e||l)+"",n?C.resolveWith(g,[o,l,_]):C.rejectWith(g,[_,l,s]),_.statusCode(v),v=void 0,p&&b.trigger(n?"ajaxSuccess":"ajaxError",[_,u,n?o:s]),f.fireWith(g,[_,l]),p&&(b.trigger("ajaxComplete",[_,u]),--x.active||x.event.trigger("ajaxStop")))}},getJSON:function(t,e,i){return x.get(t,e,i,"json")},getScript:function(t,e){return x.get(t,void 0,e,"script")}}),x.each(["get","post"],function(t,o){x[o]=function(t,e,i,n){return f(e)&&(n=n||i,i=e,e=void 0),x.ajax(x.extend({url:t,type:o,dataType:n,data:e,success:i},x.isPlainObject(t)&&t))}}),x.ajaxPrefilter(function(t){for(var e in t.headers)"content-type"===e.toLowerCase()&&(t.contentType=t.headers[e]||"")}),x._evalUrl=function(t,e,i){return x.ajax({url:t,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(t){x.globalEval(t,e,i)}})},x.fn.extend({wrapAll:function(t){return this[0]&&(f(t)&&(t=t.call(this[0])),t=x(t,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var t=this;t.firstElementChild;)t=t.firstElementChild;return t}).append(this)),this},wrapInner:function(i){return f(i)?this.each(function(t){x(this).wrapInner(i.call(this,t))}):this.each(function(){var t=x(this),e=t.contents();e.length?e.wrapAll(i):t.append(i)})},wrap:function(e){var i=f(e);return this.each(function(t){x(this).wrapAll(i?e.call(this,t):e)})},unwrap:function(t){return this.parent(t).not("body").each(function(){x(this).replaceWith(this.childNodes)}),this}}),x.expr.pseudos.hidden=function(t){return!x.expr.pseudos.visible(t)},x.expr.pseudos.visible=function(t){return!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)},x.ajaxSettings.xhr=function(){try{return new w.XMLHttpRequest}catch(t){}};var Ke={0:200,1223:204},Ye=x.ajaxSettings.xhr(),Xe=(b.cors=!!Ye&&"withCredentials"in Ye,b.ajax=Ye=!!Ye,x.ajaxTransport(function(o){var s,a;if(b.cors||Ye&&!o.crossDomain)return{send:function(t,e){var i,n=o.xhr();if(n.open(o.type,o.url,o.async,o.username,o.password),o.xhrFields)for(i in o.xhrFields)n[i]=o.xhrFields[i];for(i in o.mimeType&&n.overrideMimeType&&n.overrideMimeType(o.mimeType),o.crossDomain||t["X-Requested-With"]||(t["X-Requested-With"]="XMLHttpRequest"),t)n.setRequestHeader(i,t[i]);s=function(t){return function(){s&&(s=a=n.onload=n.onerror=n.onabort=n.ontimeout=n.onreadystatechange=null,"abort"===t?n.abort():"error"===t?"number"!=typeof n.status?e(0,"error"):e(n.status,n.statusText):e(Ke[n.status]||n.status,n.statusText,"text"!==(n.responseType||"text")||"string"!=typeof n.responseText?{binary:n.response}:{text:n.responseText},n.getAllResponseHeaders()))}},n.onload=s(),a=n.onerror=n.ontimeout=s("error"),void 0!==n.onabort?n.onabort=a:n.onreadystatechange=function(){4===n.readyState&&w.setTimeout(function(){s&&a()})},s=s("abort");try{n.send(o.hasContent&&o.data||null)}catch(t){if(s)throw t}},abort:function(){s&&s()}}}),x.ajaxPrefilter(function(t){t.crossDomain&&(t.contents.script=!1)}),x.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(t){return x.globalEval(t),t}}}),x.ajaxPrefilter("script",function(t){void 0===t.cache&&(t.cache=!1),t.crossDomain&&(t.type="GET")}),x.ajaxTransport("script",function(i){var n,o;if(i.crossDomain||i.scriptAttrs)return{send:function(t,e){n=x("<script>").attr(i.scriptAttrs||{}).prop({charset:i.scriptCharset,src:i.url}).on("load error",o=function(t){n.remove(),o=null,t&&e("error"===t.type?404:200,t.type)}),y.head.appendChild(n[0])},abort:function(){o&&o()}}}),[]),Je=/(=)\?(?=&|$)|\?\?/,Ze=(x.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=Xe.pop()||x.expando+"_"+Ie.guid++;return this[t]=!0,t}}),x.ajaxPrefilter("json jsonp",function(t,e,i){var n,o,s,a=!1!==t.jsonp&&(Je.test(t.url)?"url":"string"==typeof t.data&&0===(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&Je.test(t.data)&&"data");if(a||"jsonp"===t.dataTypes[0])return n=t.jsonpCallback=f(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,a?t[a]=t[a].replace(Je,"$1"+n):!1!==t.jsonp&&(t.url+=(Pe.test(t.url)?"&":"?")+t.jsonp+"="+n),t.converters["script json"]=function(){return s||x.error(n+" was not called"),s[0]},t.dataTypes[0]="json",o=w[n],w[n]=function(){s=arguments},i.always(function(){void 0===o?x(w).removeProp(n):w[n]=o,t[n]&&(t.jsonpCallback=e.jsonpCallback,Xe.push(n)),s&&f(o)&&o(s[0]),s=o=void 0}),"script"}),b.createHTMLDocument=((t=y.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===t.childNodes.length),x.parseHTML=function(t,e,i){var n;return"string"!=typeof t?[]:("boolean"==typeof e&&(i=e,e=!1),e||(b.createHTMLDocument?((n=(e=y.implementation.createHTMLDocument("")).createElement("base")).href=y.location.href,e.head.appendChild(n)):e=y),n=!i&&[],(i=J.exec(t))?[e.createElement(i[1])]:(i=At([t],e,n),n&&n.length&&x(n).remove(),x.merge([],i.childNodes)))},x.fn.load=function(t,e,i){var n,o,s,a=this,l=t.indexOf(" ");return-1<l&&(n=U(t.slice(l)),t=t.slice(0,l)),f(e)?(i=e,e=void 0):e&&"object"==typeof e&&(o="POST"),0<a.length&&x.ajax({url:t,type:o||"GET",dataType:"html",data:e}).done(function(t){s=arguments,a.html(n?x("<div>").append(x.parseHTML(t)).find(n):t)}).always(i&&function(t,e){a.each(function(){i.apply(this,s||[t.responseText,e,t])})}),this},x.expr.pseudos.animated=function(e){return x.grep(x.timers,function(t){return e===t.elem}).length},x.offset={setOffset:function(t,e,i){var n,o,s,a,l=x.css(t,"position"),r=x(t),c={};"static"===l&&(t.style.position="relative"),s=r.offset(),n=x.css(t,"top"),a=x.css(t,"left"),l=("absolute"===l||"fixed"===l)&&-1<(n+a).indexOf("auto")?(o=(l=r.position()).top,l.left):(o=parseFloat(n)||0,parseFloat(a)||0),null!=(e=f(e)?e.call(t,i,x.extend({},s)):e).top&&(c.top=e.top-s.top+o),null!=e.left&&(c.left=e.left-s.left+l),"using"in e?e.using.call(t,c):("number"==typeof c.top&&(c.top+="px"),"number"==typeof c.left&&(c.left+="px"),r.css(c))}},x.fn.extend({offset:function(e){var t,i;return arguments.length?void 0===e?this:this.each(function(t){x.offset.setOffset(this,e,t)}):(i=this[0])?i.getClientRects().length?(t=i.getBoundingClientRect(),i=i.ownerDocument.defaultView,{top:t.top+i.pageYOffset,left:t.left+i.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var t,e,i,n=this[0],o={top:0,left:0};if("fixed"===x.css(n,"position"))e=n.getBoundingClientRect();else{for(e=this.offset(),i=n.ownerDocument,t=n.offsetParent||i.documentElement;t&&(t===i.body||t===i.documentElement)&&"static"===x.css(t,"position");)t=t.parentNode;t&&t!==n&&1===t.nodeType&&((o=x(t).offset()).top+=x.css(t,"borderTopWidth",!0),o.left+=x.css(t,"borderLeftWidth",!0))}return{top:e.top-o.top-x.css(n,"marginTop",!0),left:e.left-o.left-x.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent;t&&"static"===x.css(t,"position");)t=t.offsetParent;return t||T})}}),x.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,o){var s="pageYOffset"===o;x.fn[e]=function(t){return h(this,function(t,e,i){var n;if(g(t)?n=t:9===t.nodeType&&(n=t.defaultView),void 0===i)return n?n[o]:t[e];n?n.scrollTo(s?n.pageXOffset:i,s?i:n.pageYOffset):t[e]=i},e,t,arguments.length)}}),x.each(["top","left"],function(t,i){x.cssHooks[i]=ee(b.pixelPosition,function(t,e){if(e)return e=te(t,i),Xt.test(e)?x(t).position()[i]+"px":e})}),x.each({Height:"height",Width:"width"},function(a,l){x.each({padding:"inner"+a,content:l,"":"outer"+a},function(n,s){x.fn[s]=function(t,e){var i=arguments.length&&(n||"boolean"!=typeof t),o=n||(!0===t||!0===e?"margin":"border");return h(this,function(t,e,i){var n;return g(t)?0===s.indexOf("outer")?t["inner"+a]:t.document.documentElement["client"+a]:9===t.nodeType?(n=t.documentElement,Math.max(t.body["scroll"+a],n["scroll"+a],t.body["offset"+a],n["offset"+a],n["client"+a])):void 0===i?x.css(t,e,o):x.style(t,e,i,o)},l,i?t:void 0,i)}})}),x.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(t,e){x.fn[e]=function(t){return this.on(e,t)}}),x.fn.extend({bind:function(t,e,i){return this.on(t,null,e,i)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,i,n){return this.on(e,t,i,n)},undelegate:function(t,e,i){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",i)},hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)}}),x.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(t,i){x.fn[i]=function(t,e){return 0<arguments.length?this.on(i,null,t,e):this.trigger(i)}}),/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g),Qe=(x.proxy=function(t,e){var i,n;if("string"==typeof e&&(n=t[e],e=t,t=n),f(t))return i=l.call(arguments,2),(n=function(){return t.apply(e||this,i.concat(l.call(arguments)))}).guid=t.guid=t.guid||x.guid++,n},x.holdReady=function(t){t?x.readyWait++:x.ready(!0)},x.isArray=Array.isArray,x.parseJSON=JSON.parse,x.nodeName=r,x.isFunction=f,x.isWindow=g,x.camelCase=v,x.type=u,x.now=Date.now,x.isNumeric=function(t){var e=x.type(t);return("number"===e||"string"===e)&&!isNaN(t-parseFloat(t))},x.trim=function(t){return null==t?"":(t+"").replace(Ze,"")},"function"==typeof define&&define.amd&&define("jquery",[],function(){return x}),w.jQuery),ti=w.$;return x.noConflict=function(t){return w.$===x&&(w.$=ti),t&&w.jQuery===x&&(w.jQuery=Qe),x},void 0===F&&(w.jQuery=w.$=x),x}),!function(){var t=this,e=t.Backbone,i=[],o=i.slice,a="undefined"!=typeof exports?exports:t.Backbone={},w=(a.VERSION="1.1.0",t._),s=(w||"undefined"==typeof require||(w=require("underscore")),a.$=t.jQuery||t.Zepto||t.ender||t.$,a.noConflict=function(){return t.Backbone=e,this},a.emulateHTTP=!1,a.emulateJSON=!1,a.Events={on:function(t,e,i){return h(this,"on",t,[e,i])&&e&&(this._events||(this._events={}),(this._events[t]||(this._events[t]=[])).push({callback:e,context:i,ctx:i||this})),this},once:function(t,e,i){var n,o;return h(this,"once",t,[e,i])&&e?(n=this,(o=w.once(function(){n.off(t,o),e.apply(this,arguments)}))._callback=e,this.on(t,o,i)):this},off:function(t,e,i){var n,o,s,a,l,r,c,d;if(this._events&&h(this,"off",t,[e,i]))if(t||e||i){for(l=0,r=(a=t?[t]:w.keys(this._events)).length;l<r;l++)if(t=a[l],s=this._events[t]){if(this._events[t]=n=[],e||i)for(c=0,d=s.length;c<d;c++)o=s[c],(e&&e!==o.callback&&e!==o.callback._callback||i&&i!==o.context)&&n.push(o);n.length||delete this._events[t]}}else this._events={};return this},trigger:function(t){var e,i,n;return this._events&&(e=o.call(arguments,1),h(this,"trigger",t,e)&&(i=this._events[t],n=this._events.all,i&&l(i,e),n&&l(n,arguments))),this},stopListening:function(t,e,i){var n=this._listeningTo;if(n){var o,s=!e&&!i;for(o in i||"object"!=typeof e||(i=this),t&&((n={})[t._listenId]=t),n)(t=n[o]).off(e,i,this),(s||w.isEmpty(t._events))&&delete this._listeningTo[o]}return this}}),r=/\s+/,h=function(t,e,i,n){if(i){if("object"==typeof i){for(var o in i)t[e].apply(t,[o,i[o]].concat(n));return!1}if(r.test(i)){for(var s=i.split(r),a=0,l=s.length;a<l;a++)t[e].apply(t,[s[a]].concat(n));return!1}}return!0},l=function(t,e){var i,n=-1,o=t.length,s=e[0],a=e[1],l=e[2];switch(e.length){case 0:for(;++n<o;)(i=t[n]).callback.call(i.ctx);return;case 1:for(;++n<o;)(i=t[n]).callback.call(i.ctx,s);return;case 2:for(;++n<o;)(i=t[n]).callback.call(i.ctx,s,a);return;case 3:for(;++n<o;)(i=t[n]).callback.call(i.ctx,s,a,l);return;default:for(;++n<o;)(i=t[n]).callback.apply(i.ctx,e)}},y=(w.each({listenTo:"on",listenToOnce:"once"},function(n,t){s[t]=function(t,e,i){return((this._listeningTo||(this._listeningTo={}))[t._listenId||(t._listenId=w.uniqueId("l"))]=t)[n](e,i=i||"object"!=typeof e?i:this,this),this}}),s.bind=s.on,s.unbind=s.off,w.extend(a,s),a.Model=function(t,e){var i=t||{};e=e||{},this.cid=w.uniqueId("c"),this.attributes={},e.collection&&(this.collection=e.collection),e.parse&&(i=this.parse(i,e)||{}),i=w.defaults({},i,w.result(this,"defaults")),this.set(i,e),this.changed={},this.initialize.apply(this,arguments)}),c=(w.extend(y.prototype,s,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(t){return w.clone(this.attributes)},sync:function(){return a.sync.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(t){return w.escape(this.get(t))},has:function(t){return null!=this.get(t)},set:function(t,e,i){var n,o,s,a,l,r,c;if(null!=t){if("object"==typeof t?(o=t,i=e):(o={})[t]=e,!this._validate(o,i=i||{}))return!1;for(n in s=i.unset,t=i.silent,a=[],l=this._changing,this._changing=!0,l||(this._previousAttributes=w.clone(this.attributes),this.changed={}),c=this.attributes,r=this._previousAttributes,this.idAttribute in o&&(this.id=o[this.idAttribute]),o)e=o[n],w.isEqual(c[n],e)||a.push(n),w.isEqual(r[n],e)?delete this.changed[n]:this.changed[n]=e,s?delete c[n]:c[n]=e;if(!t){a.length&&(this._pending=!0);for(var d=0,h=a.length;d<h;d++)this.trigger("change:"+a[d],this,c[a[d]],i)}if(!l){if(!t)for(;this._pending;)this._pending=!1,this.trigger("change",this,i);this._pending=!1,this._changing=!1}}return this},unset:function(t,e){return this.set(t,void 0,w.extend({},e,{unset:!0}))},clear:function(t){var e,i={};for(e in this.attributes)i[e]=void 0;return this.set(i,w.extend({},t,{unset:!0}))},hasChanged:function(t){return null==t?!w.isEmpty(this.changed):w.has(this.changed,t)},changedAttributes:function(t){if(!t)return!!this.hasChanged()&&w.clone(this.changed);var e,i,n=!1,o=this._changing?this._previousAttributes:this.attributes;for(i in t)w.isEqual(o[i],e=t[i])||((n=n||{})[i]=e);return n},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return w.clone(this._previousAttributes)},fetch:function(e){void 0===(e=e?w.clone(e):{}).parse&&(e.parse=!0);var i=this,n=e.success;return e.success=function(t){if(!i.set(i.parse(t,e),e))return!1;n&&n(i,t,e),i.trigger("sync",i,t,e)},P(this,e),this.sync("read",this,e)},save:function(t,e,i){var n,o=this.attributes;if(null==t||"object"==typeof t?(n=t,i=e):(n={})[t]=e,i=w.extend({validate:!0},i),n&&!i.wait){if(!this.set(n,i))return!1}else if(!this._validate(n,i))return!1;n&&i.wait&&(this.attributes=w.extend({},o,n)),void 0===i.parse&&(i.parse=!0);var s=this,a=i.success;return i.success=function(t){s.attributes=o;var e=s.parse(t,i);if(i.wait&&(e=w.extend(n||{},e)),w.isObject(e)&&!s.set(e,i))return!1;a&&a(s,t,i),s.trigger("sync",s,t,i)},P(this,i),"patch"==(t=this.isNew()?"create":i.patch?"patch":"update")&&(i.attrs=n),e=this.sync(t,this,i),n&&i.wait&&(this.attributes=o),e},destroy:function(e){e=e?w.clone(e):{};function i(){n.trigger("destroy",n,n.collection,e)}var n=this,o=e.success;if(e.success=function(t){(e.wait||n.isNew())&&i(),o&&o(n,t,e),n.isNew()||n.trigger("sync",n,t,e)},this.isNew())return e.success(),!1;P(this,e);var t=this.sync("delete",this,e);return e.wait||i(),t},url:function(){var t=w.result(this,"urlRoot")||w.result(this.collection,"url")||I();return this.isNew()?t:t+("/"===t.charAt(t.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(t,e){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},isValid:function(t){return this._validate({},w.extend(t||{},{validate:!0}))},_validate:function(t,e){if(!e.validate||!this.validate)return!0;t=w.extend({},this.attributes,t);t=this.validationError=this.validate(t,e)||null;return!t||(this.trigger("invalid",this,t,w.extend(e,{validationError:t})),!1)}}),w.each(["keys","values","pairs","invert","pick","omit"],function(e){y.prototype[e]=function(){var t=o.call(arguments);return t.unshift(this.attributes),w[e].apply(w,t)}}),a.Collection=function(t,e){(e=e||{}).model&&(this.model=e.model),void 0!==e.comparator&&(this.comparator=e.comparator),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,w.extend({silent:!0},e))}),x={add:!0,remove:!0,merge:!0},n={add:!0,remove:!1},i=(w.extend(c.prototype,s,{model:y,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return a.sync.apply(this,arguments)},add:function(t,e){return this.set(t,w.extend({merge:!1},e,n))},remove:function(t,e){var i,n,o,s,a=!w.isArray(t);for(e=e||{},i=0,n=(t=a?[t]:w.clone(t)).length;i<n;i++)(s=t[i]=this.get(t[i]))&&(delete this._byId[s.id],delete this._byId[s.cid],o=this.indexOf(s),this.models.splice(o,1),this.length--,e.silent||(e.index=o,s.trigger("remove",s,this,e)),this._removeReference(s));return a?t[0]:t},set:function(t,e){(e=w.defaults({},e,x)).parse&&(t=this.parse(t,e));var i,n,o,s,a=!w.isArray(t),l=(t=a?t?[t]:[]:w.clone(t),e.at),r=this.model,c=this.comparator&&null==l&&!1!==e.sort,d=w.isString(this.comparator)?this.comparator:null,h=[],m=[],p={},u=e.add,g=e.merge,b=e.remove,C=!(c||!u||!b)&&[];for(v=0,_=t.length;v<_;v++){if(o=(n=t[v])instanceof y?i=n:n[r.prototype.idAttribute],o=this.get(o))b&&(p[o.cid]=!0),g&&(n=n===i?i.attributes:n,e.parse&&(n=o.parse(n,e)),o.set(n,e),c&&!s&&o.hasChanged(d)&&(s=!0)),t[v]=o;else if(u){if(!(i=t[v]=this._prepareModel(n,e)))continue;h.push(i),i.on("all",this._onModelEvent,this),null!=(this._byId[i.cid]=i).id&&(this._byId[i.id]=i)}C&&C.push(o||i)}if(b){for(v=0,_=this.length;v<_;++v)p[(i=this.models[v]).cid]||m.push(i);m.length&&this.remove(m,e)}if(h.length||C&&C.length)if(c&&(s=!0),this.length+=h.length,null!=l)for(v=0,_=h.length;v<_;v++)this.models.splice(l+v,0,h[v]);else{C&&(this.models.length=0);for(var f=C||h,v=0,_=f.length;v<_;v++)this.models.push(f[v])}if(s&&this.sort({silent:!0}),!e.silent){for(v=0,_=h.length;v<_;v++)(i=h[v]).trigger("add",i,this,e);(s||C&&C.length)&&this.trigger("sort",this,e)}return a?t[0]:t},reset:function(t,e){e=e||{};for(var i=0,n=this.models.length;i<n;i++)this._removeReference(this.models[i]);return e.previousModels=this.models,this._reset(),t=this.add(t,w.extend({silent:!0},e)),e.silent||this.trigger("reset",this,e),t},push:function(t,e){return this.add(t,w.extend({at:this.length},e))},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t),e},unshift:function(t,e){return this.add(t,w.extend({at:0},e))},shift:function(t){var e=this.at(0);return this.remove(e,t),e},slice:function(){return o.apply(this.models,arguments)},get:function(t){if(null!=t)return this._byId[t.id]||this._byId[t.cid]||this._byId[t]},at:function(t){return this.models[t]},where:function(i,t){return w.isEmpty(i)?t?void 0:[]:this[t?"find":"filter"](function(t){for(var e in i)if(i[e]!==t.get(e))return!1;return!0})},findWhere:function(t){return this.where(t,!0)},sort:function(t){if(this.comparator)return t=t||{},w.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(w.bind(this.comparator,this)),t.silent||this.trigger("sort",this,t),this;throw new Error("Cannot sort a set without a comparator")},pluck:function(t){return w.invoke(this.models,"get",t)},fetch:function(i){void 0===(i=i?w.clone(i):{}).parse&&(i.parse=!0);var n=i.success,o=this;return i.success=function(t){var e=i.reset?"reset":"set";o[e](t,i),n&&n(o,t,i),o.trigger("sync",o,t,i)},P(this,i),this.sync("read",this,i)},create:function(t,e){if(e=e?w.clone(e):{},!(t=this._prepareModel(t,e)))return!1;e.wait||this.add(t,e);var n=this,o=e.success;return e.success=function(t,e,i){i.wait&&n.add(t,i),o&&o(t,e,i)},t.save(null,e),t},parse:function(t,e){return t},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(t,e){return t instanceof y?(t.collection||(t.collection=this),t):(t=new((e=e?w.clone(e):{}).collection=this).model(t,e)).validationError?(this.trigger("invalid",this,t.validationError,e),!1):t},_removeReference:function(t){this===t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,i,n){("add"!==t&&"remove"!==t||i===this)&&("destroy"===t&&this.remove(e,n),e&&t==="change:"+e.idAttribute&&(delete this._byId[e.previous(e.idAttribute)],null!=e.id&&(this._byId[e.id]=e)),this.trigger.apply(this,arguments))}}),w.each(["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain"],function(e){c.prototype[e]=function(){var t=o.call(arguments);return t.unshift(this.models),w[e].apply(w,t)}}),w.each(["groupBy","countBy","sortBy"],function(n){c.prototype[n]=function(e,t){var i=w.isFunction(e)?e:function(t){return t.get(e)};return w[n](this.models,i,t)}}),a.View=function(t){this.cid=w.uniqueId("view"),w.extend(this,w.pick(t=t||{},m)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()}),d=/^(\S+)\s*(.*)$/,m=["model","collection","el","id","attributes","className","tagName","events"],p=(w.extend(i.prototype,s,{tagName:"div",$:function(t){return this.$el.find(t)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(t,e){return this.$el&&this.undelegateEvents(),this.$el=t instanceof a.$?t:a.$(t),this.el=this.$el[0],!1!==e&&this.delegateEvents(),this},delegateEvents:function(t){if(t=t||w.result(this,"events"))for(var e in this.undelegateEvents(),t){var i,n=t[e];(n=w.isFunction(n)?n:this[t[e]])&&(i=(e=e.match(d))[1],e=e[2],n=w.bind(n,this),i+=".delegateEvents"+this.cid,""===e?this.$el.on(i,n):this.$el.on(i,e,n))}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){var t;this.el?this.setElement(w.result(this,"el"),!1):(t=w.extend({},w.result(this,"attributes")),this.id&&(t.id=w.result(this,"id")),this.className&&(t.class=w.result(this,"className")),t=a.$("<"+w.result(this,"tagName")+">").attr(t),this.setElement(t,!1))}}),a.sync=function(t,e,i){var n,o=u[t],s=(w.defaults(i=i||{},{emulateHTTP:a.emulateHTTP,emulateJSON:a.emulateJSON}),{type:o,dataType:"json"}),t=(i.url||(s.url=w.result(e,"url")||I()),null!=i.data||!e||"create"!==t&&"update"!==t&&"patch"!==t||(s.contentType="application/json",s.data=JSON.stringify(i.attrs||e.toJSON(i))),i.emulateJSON&&(s.contentType="application/x-www-form-urlencoded",s.data=s.data?{model:s.data}:{}),!i.emulateHTTP||"PUT"!==o&&"DELETE"!==o&&"PATCH"!==o||(s.type="POST",i.emulateJSON&&(s.data._method=o),n=i.beforeSend,i.beforeSend=function(t){if(t.setRequestHeader("X-HTTP-Method-Override",o),n)return n.apply(this,arguments)}),"GET"===s.type||i.emulateJSON||(s.processData=!1),"PATCH"===s.type&&p&&(s.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")}),i.xhr=a.ajax(w.extend(s,i)));return e.trigger("request",e,t,i),t},!("undefined"==typeof window||!window.ActiveXObject||window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent)),u={create:"POST",update:"PUT",patch:"PATCH",delete:"DELETE",read:"GET"},g=(a.ajax=function(){return a.$.ajax.apply(a.$,arguments)},a.Router=function(t){(t=t||{}).routes&&(this.routes=t.routes),this._bindRoutes(),this.initialize.apply(this,arguments)}),b=/\((.*?)\)/g,C=/(\(\?)?:\w+/g,f=/\*\w+/g,v=/[\-{}\[\]+?.,\\\^$|#\s]/g,_=(w.extend(g.prototype,s,{initialize:function(){},route:function(e,i,n){w.isRegExp(e)||(e=this._routeToRegExp(e)),w.isFunction(i)&&(n=i,i=""),n=n||this[i];var o=this;return a.history.route(e,function(t){t=o._extractParameters(e,t);n&&n.apply(o,t),o.trigger.apply(o,["route:"+i].concat(t)),o.trigger("route",i,t),a.history.trigger("route",o,i,t)}),this},navigate:function(t,e){return a.history.navigate(t,e),this},_bindRoutes:function(){if(this.routes){this.routes=w.result(this,"routes");for(var t,e=w.keys(this.routes);null!=(t=e.pop());)this.route(t,this.routes[t])}},_routeToRegExp:function(t){return t=t.replace(v,"\\$&").replace(b,"(?:$1)?").replace(C,function(t,e){return e?t:"([^/]+)"}).replace(f,"(.*?)"),new RegExp("^"+t+"$")},_extractParameters:function(t,e){t=t.exec(e).slice(1);return w.map(t,function(t){return t?decodeURIComponent(t):null})}}),a.History=function(){this.handlers=[],w.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)}),S=/^[#\/]|\s+$/g,T=/^\/+|\/+$/g,A=/msie [\w.]+/,k=/\/$/,D=/[?#].*$/,I=(_.started=!1,w.extend(_.prototype,s,{interval:50,getHash:function(t){t=(t||this).location.href.match(/#(.*)$/);return t?t[1]:""},getFragment:function(t,e){return null==t&&(this._hasPushState||!this._wantsHashChange||e?(t=this.location.pathname,e=this.root.replace(k,""),t.indexOf(e)||(t=t.slice(e.length))):t=this.getHash()),t.replace(S,"")},start:function(t){if(_.started)throw new Error("Backbone.history has already been started");_.started=!0,this.options=w.extend({root:"/"},this.options,t),this.root=this.options.root,this._wantsHashChange=!1!==this.options.hashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var t=this.getFragment(),e=document.documentMode,e=A.exec(navigator.userAgent.toLowerCase())&&(!e||e<=7),e=(this.root=("/"+this.root+"/").replace(T,"/"),e&&this._wantsHashChange&&(this.iframe=a.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(t)),this._hasPushState?a.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!e?a.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=t,this.location),t=e.pathname.replace(/[^\/]$/,"$&/")===this.root;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!t)return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0;this._hasPushState&&t&&e.hash&&(this.fragment=this.getHash().replace(S,""),this.history.replaceState({},document.title,this.root+this.fragment+e.search))}if(!this.options.silent)return this.loadUrl()},stop:function(){a.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),_.started=!1},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(t){var e=this.getFragment();if((e=e===this.fragment&&this.iframe?this.getFragment(this.getHash(this.iframe)):e)===this.fragment)return!1;this.iframe&&this.navigate(e),this.loadUrl()},loadUrl:function(e){return e=this.fragment=this.getFragment(e),w.any(this.handlers,function(t){if(t.route.test(e))return t.callback(e),!0})},navigate:function(t,e){if(!_.started)return!1;e&&!0!==e||(e={trigger:!!e});var i=this.root+(t=this.getFragment(t||""));if(t=t.replace(D,""),this.fragment!==t){if(""===(this.fragment=t)&&"/"!==i&&(i=i.slice(0,-1)),this._hasPushState)this.history[e.replace?"replaceState":"pushState"]({},document.title,i);else{if(!this._wantsHashChange)return this.location.assign(i);this._updateHash(this.location,t,e.replace),this.iframe&&t!==this.getFragment(this.getHash(this.iframe))&&(e.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,t,e.replace))}return e.trigger?this.loadUrl(t):void 0}},_updateHash:function(t,e,i){i?(i=t.href.replace(/(javascript:|#).*$/,""),t.replace(i+"#"+e)):t.hash="#"+e}}),a.history=new _,y.extend=c.extend=g.extend=i.extend=_.extend=function(t,e){function i(){this.constructor=o}var n=this,o=t&&w.has(t,"constructor")?t.constructor:function(){return n.apply(this,arguments)};w.extend(o,n,e);return i.prototype=n.prototype,o.prototype=new i,t&&w.extend(o.prototype,t),o.__super__=n.prototype,o},function(){throw new Error('A "url" property or function must be specified')}),P=function(e,i){var n=i.error;i.error=function(t){n&&n(e,t,i),e.trigger("error",e,t,i)}}}.call(this),define("backbone",["underscore","jquery"],function(t){return function(){return t.Backbone}}(this)),"undefined"==typeof jQuery)throw new Error("Bootstrap's JavaScript requires jQuery");function _extend_object(t,e){return"undefined"!=typeof _?_.extend({},t,e):Object?Object.assign({},t,e):e}!function(){"use strict";var t=jQuery.fn.jquery.split(" ")[0].split(".");if(t[0]<2&&t[1]<9||1==t[0]&&9==t[1]&&t[2]<1||3<t[0])throw new Error("Bootstrap's JavaScript requires jQuery version 1.9.1 or higher, but lower than version 4")}(),!function(n){"use strict";n.fn.emulateTransitionEnd=function(t){var e=!1,i=this;n(this).one("bsTransitionEnd",function(){e=!0});return setTimeout(function(){e||n(i).trigger(n.support.transition.end)},t),this},n(function(){n.support.transition=function(){var t,e=document.createElement("bootstrap"),i={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(t in i)if(void 0!==e.style[t])return{end:i[t]};return!1}(),n.support.transition&&(n.event.special.bsTransitionEnd={bindType:n.support.transition.end,delegateType:n.support.transition.end,handle:function(t){if(n(t.target).is(this))return t.handleObj.handler.apply(this,arguments)}})})}(jQuery),!function(s){"use strict";function a(t){s(t).on("click",e,this.close)}var e='[data-dismiss="alert"]';a.VERSION="3.4.1",a.TRANSITION_DURATION=150,a.prototype.close=function(t){var e=s(this),i=e.attr("data-target"),n=(i="#"===(i=i||(i=e.attr("href"))&&i.replace(/.*(?=#[^\s]*$)/,""))?[]:i,s(document).find(i));function o(){n.detach().trigger("closed.bs.alert").remove()}t&&t.preventDefault(),(n=n.length?n:e.closest(".alert")).trigger(t=s.Event("close.bs.alert")),t.isDefaultPrevented()||(n.removeClass("in"),s.support.transition&&n.hasClass("fade")?n.one("bsTransitionEnd",o).emulateTransitionEnd(a.TRANSITION_DURATION):o())};var t=s.fn.alert;s.fn.alert=function(i){return this.each(function(){var t=s(this),e=t.data("bs.alert");e||t.data("bs.alert",e=new a(this)),"string"==typeof i&&e[i].call(t)})},s.fn.alert.Constructor=a,s.fn.alert.noConflict=function(){return s.fn.alert=t,this},s(document).on("click.bs.alert.data-api",e,a.prototype.close)}(jQuery),!function(s){"use strict";function n(t,e){this.$element=s(t),this.options=s.extend({},n.DEFAULTS,e),this.isLoading=!1}function i(i){return this.each(function(){var t=s(this),e=t.data("bs.button");e||t.data("bs.button",e=new n(this,"object"==typeof i&&i)),"toggle"==i?e.toggle():i&&e.setState(i)})}n.VERSION="3.4.1",n.DEFAULTS={loadingText:"loading..."},n.prototype.setState=function(t){var e="disabled",i=this.$element,n=i.is("input")?"val":"html",o=i.data();t+="Text",null==o.resetText&&i.data("resetText",i[n]()),setTimeout(s.proxy(function(){i[n]((null==o[t]?this.options:o)[t]),"loadingText"==t?(this.isLoading=!0,i.addClass(e).attr(e,e).prop(e,!0)):this.isLoading&&(this.isLoading=!1,i.removeClass(e).removeAttr(e).prop(e,!1))},this),0)},n.prototype.toggle=function(){var t,e=!0,i=this.$element.closest('[data-toggle="buttons"]');i.length?("radio"==(t=this.$element.find("input")).prop("type")?(t.prop("checked")&&(e=!1),i.find(".active").removeClass("active"),this.$element.addClass("active")):"checkbox"==t.prop("type")&&(t.prop("checked")!==this.$element.hasClass("active")&&(e=!1),this.$element.toggleClass("active")),t.prop("checked",this.$element.hasClass("active")),e&&t.trigger("change")):(this.$element.attr("aria-pressed",!this.$element.hasClass("active")),this.$element.toggleClass("active"))};var t=s.fn.button;s.fn.button=i,s.fn.button.Constructor=n,s.fn.button.noConflict=function(){return s.fn.button=t,this},s(document).on("click.bs.button.data-api",'[data-toggle^="button"]',function(t){var e=s(t.target).closest(".btn");i.call(e,"toggle"),s(t.target).is('input[type="radio"], input[type="checkbox"]')||(t.preventDefault(),(e.is("input,button")?e:e.find("input:visible,button:visible").first()).trigger("focus"))}).on("focus.bs.button.data-api blur.bs.button.data-api",'[data-toggle^="button"]',function(t){s(t.target).closest(".btn").toggleClass("focus",/^focus(in)?$/.test(t.type))})}(jQuery),!function(c){"use strict";function d(t,e){this.$element=c(t),this.$indicators=this.$element.find(".carousel-indicators"),this.options=e,this.paused=null,this.sliding=null,this.interval=null,this.$active=null,this.$items=null,this.options.keyboard&&this.$element.on("keydown.bs.carousel",c.proxy(this.keydown,this)),"hover"!=this.options.pause||"ontouchstart"in document.documentElement||this.$element.on("mouseenter.bs.carousel",c.proxy(this.pause,this)).on("mouseleave.bs.carousel",c.proxy(this.cycle,this))}function o(o){return this.each(function(){var t=c(this),e=t.data("bs.carousel"),i=c.extend({},d.DEFAULTS,t.data(),"object"==typeof o&&o),n="string"==typeof o?o:i.slide;e||t.data("bs.carousel",e=new d(this,i)),"number"==typeof o?e.to(o):n?e[n]():i.interval&&e.pause().cycle()})}d.VERSION="3.4.1",d.TRANSITION_DURATION=600,d.DEFAULTS={interval:5e3,pause:"hover",wrap:!0,keyboard:!0},d.prototype.keydown=function(t){if(!/input|textarea/i.test(t.target.tagName)){switch(t.which){case 37:this.prev();break;case 39:this.next();break;default:return}t.preventDefault()}},d.prototype.cycle=function(t){return t||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(c.proxy(this.next,this),this.options.interval)),this},d.prototype.getItemIndex=function(t){return this.$items=t.parent().children(".item"),this.$items.index(t||this.$active)},d.prototype.getItemForDirection=function(t,e){var i=this.getItemIndex(e);return("prev"==t&&0===i||"next"==t&&i==this.$items.length-1)&&!this.options.wrap?e:(e=(i+("prev"==t?-1:1))%this.$items.length,this.$items.eq(e))},d.prototype.to=function(t){var e=this,i=this.getItemIndex(this.$active=this.$element.find(".item.active"));if(!(t>this.$items.length-1||t<0))return this.sliding?this.$element.one("slid.bs.carousel",function(){e.to(t)}):i==t?this.pause().cycle():this.slide(i<t?"next":"prev",this.$items.eq(t))},d.prototype.pause=function(t){return t||(this.paused=!0),this.$element.find(".next, .prev").length&&c.support.transition&&(this.$element.trigger(c.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},d.prototype.next=function(){if(!this.sliding)return this.slide("next")},d.prototype.prev=function(){if(!this.sliding)return this.slide("prev")},d.prototype.slide=function(t,e){var i,n,o,s=this.$element.find(".item.active"),a=e||this.getItemForDirection(t,s),e=this.interval,l="next"==t?"left":"right",r=this;return a.hasClass("active")?this.sliding=!1:(i=a[0],n=c.Event("slide.bs.carousel",{relatedTarget:i,direction:l}),this.$element.trigger(n),n.isDefaultPrevented()?void 0:(this.sliding=!0,e&&this.pause(),this.$indicators.length&&(this.$indicators.find(".active").removeClass("active"),(n=c(this.$indicators.children()[this.getItemIndex(a)]))&&n.addClass("active")),o=c.Event("slid.bs.carousel",{relatedTarget:i,direction:l}),c.support.transition&&this.$element.hasClass("slide")?(a.addClass(t),"object"==typeof a&&a.length&&a[0].offsetWidth,s.addClass(l),a.addClass(l),s.one("bsTransitionEnd",function(){a.removeClass([t,l].join(" ")).addClass("active"),s.removeClass(["active",l].join(" ")),r.sliding=!1,setTimeout(function(){r.$element.trigger(o)},0)}).emulateTransitionEnd(d.TRANSITION_DURATION)):(s.removeClass("active"),a.addClass("active"),this.sliding=!1,this.$element.trigger(o)),e&&this.cycle(),this))};function t(t){var e,i=c(this),n=(n=i.attr("href"))&&n.replace(/.*(?=#[^\s]+$)/,""),n=i.attr("data-target")||n;(n=c(document).find(n)).hasClass("carousel")&&(e=c.extend({},n.data(),i.data()),(i=i.attr("data-slide-to"))&&(e.interval=!1),o.call(n,e),i&&n.data("bs.carousel").to(i),t.preventDefault())}var e=c.fn.carousel;c.fn.carousel=o,c.fn.carousel.Constructor=d,c.fn.carousel.noConflict=function(){return c.fn.carousel=e,this};c(document).on("click.bs.carousel.data-api","[data-slide]",t).on("click.bs.carousel.data-api","[data-slide-to]",t),c(window).on("load",function(){c('[data-ride="carousel"]').each(function(){var t=c(this);o.call(t,t.data())})})}(jQuery),!function(o){"use strict";function s(t,e){this.$element=o(t),this.options=o.extend({},s.DEFAULTS,e),this.$trigger=o('[data-toggle="collapse"][href="#'+t.id+'"],[data-toggle="collapse"][data-target="#'+t.id+'"]'),this.transitioning=null,this.options.parent?this.$parent=this.getParent():this.addAriaAndCollapsedClass(this.$element,this.$trigger),this.options.toggle&&this.toggle()}function i(t){t=t.attr("data-target")||(t=t.attr("href"))&&t.replace(/.*(?=#[^\s]+$)/,"");return o(document).find(t)}function a(n){return this.each(function(){var t=o(this),e=t.data("bs.collapse"),i=o.extend({},s.DEFAULTS,t.data(),"object"==typeof n&&n);!e&&i.toggle&&/show|hide/.test(n)&&(i.toggle=!1),e||t.data("bs.collapse",e=new s(this,i)),"string"==typeof n&&e[n]()})}s.VERSION="3.4.1",s.TRANSITION_DURATION=350,s.DEFAULTS={toggle:!0},s.prototype.dimension=function(){return this.$element.hasClass("width")?"width":"height"},s.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var t=this.$parent&&this.$parent.children(".panel").children(".in, .collapsing");if(!(t&&t.length&&(n=t.data("bs.collapse"))&&n.transitioning)){var e=o.Event("show.bs.collapse");if(this.$element.trigger(e),!e.isDefaultPrevented()){t&&t.length&&(a.call(t,"hide"),n||t.data("bs.collapse",null));var i=this.dimension(),e=(this.$element.removeClass("collapse").addClass("collapsing")[i](0).attr("aria-expanded",!0),this.$trigger.removeClass("collapsed").attr("aria-expanded",!0),this.transitioning=1,function(){this.$element.removeClass("collapsing").addClass("collapse in")[i](""),this.transitioning=0,this.$element.trigger("shown.bs.collapse")});if(!o.support.transition)return e.call(this);var n=o.camelCase(["scroll",i].join("-"));this.$element.one("bsTransitionEnd",o.proxy(e,this)).emulateTransitionEnd(s.TRANSITION_DURATION)[i](this.$element[0][n])}}}},s.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var t=o.Event("hide.bs.collapse");if(this.$element.trigger(t),!t.isDefaultPrevented()){var t=this.dimension(),e=(this.$element[t](this.$element[t]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse in").attr("aria-expanded",!1),this.$trigger.addClass("collapsed").attr("aria-expanded",!1),this.transitioning=1,function(){this.transitioning=0,this.$element.removeClass("collapsing").addClass("collapse").trigger("hidden.bs.collapse")});if(!o.support.transition)return e.call(this);this.$element[t](0).one("bsTransitionEnd",o.proxy(e,this)).emulateTransitionEnd(s.TRANSITION_DURATION)}}},s.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()},s.prototype.getParent=function(){return o(document).find(this.options.parent).find('[data-toggle="collapse"][data-parent="'+this.options.parent+'"]').each(o.proxy(function(t,e){e=o(e);this.addAriaAndCollapsedClass(i(e),e)},this)).end()},s.prototype.addAriaAndCollapsedClass=function(t,e){var i=t.hasClass("in");t.attr("aria-expanded",i),e.toggleClass("collapsed",!i).attr("aria-expanded",i)};var t=o.fn.collapse;o.fn.collapse=a,o.fn.collapse.Constructor=s,o.fn.collapse.noConflict=function(){return o.fn.collapse=t,this},o(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(t){var e=o(this),t=(e.attr("data-target")||t.preventDefault(),i(e)),e=t.data("bs.collapse")?"toggle":e.data();a.call(t,e)})}(jQuery),!function(o){"use strict";function n(t){o(t).on("click.bs.dropdown",this.toggle)}var s='[data-toggle="dropdown"]';function a(t){var e=t.attr("data-target"),e="#"!==(e=e||(e=t.attr("href"))&&/#[A-Za-z]/.test(e)&&e.replace(/.*(?=#[^\s]*$)/,""))?o(document).find(e):null;return e&&e.length?e:t.parent()}function l(n){n&&3===n.which||(o(".dropdown-backdrop").remove(),o(s).each(function(){var t=o(this),e=a(t),i={relatedTarget:this};!e.hasClass("open")||n&&"click"==n.type&&/input|textarea/i.test(n.target.tagName)&&o.contains(e[0],n.target)||(e.trigger(n=o.Event("hide.bs.dropdown",i)),n.isDefaultPrevented()||(t.attr("aria-expanded","false"),e.removeClass("open").trigger(o.Event("hidden.bs.dropdown",i))))}))}n.VERSION="3.4.1",n.prototype.toggle=function(t){var e=o(this);if(!e.is(".disabled, :disabled")){var i=a(e),n=i.hasClass("open");if(l(),!n){"ontouchstart"in document.documentElement&&!i.closest(".navbar-nav").length&&o(document.createElement("div")).addClass("dropdown-backdrop").insertAfter(o(this)).on("click",l);n={relatedTarget:this};if(i.trigger(t=o.Event("show.bs.dropdown",n)),t.isDefaultPrevented())return;e.trigger("focus").attr("aria-expanded","true"),i.toggleClass("open").trigger(o.Event("shown.bs.dropdown",n))}return!1}},n.prototype.keydown=function(t){if(/(38|40|27|32)/.test(t.which)&&!/input|textarea/i.test(t.target.tagName)){var e=o(this);if(t.preventDefault(),t.stopPropagation(),!e.is(".disabled, :disabled")){var i=a(e),n=i.hasClass("open");if(!n&&27!=t.which||n&&27==t.which)return 27==t.which&&i.find(s).trigger("focus"),e.trigger("click");n=i.find(".dropdown-menu li:not(.disabled):visible a");n.length&&(e=n.index(t.target),38==t.which&&0<e&&e--,40==t.which&&e<n.length-1&&e++,n.eq(e=~e?e:0).trigger("focus"))}}};var t=o.fn.dropdown;o.fn.dropdown=function(i){return this.each(function(){var t=o(this),e=t.data("bs.dropdown");e||t.data("bs.dropdown",e=new n(this)),"string"==typeof i&&e[i].call(t)})},o.fn.dropdown.Constructor=n,o.fn.dropdown.noConflict=function(){return o.fn.dropdown=t,this},o(document).on("click.bs.dropdown.data-api",l).on("click.bs.dropdown.data-api",".dropdown form",function(t){t.stopPropagation()}).on("click.bs.dropdown.data-api",s,n.prototype.toggle).on("keydown.bs.dropdown.data-api",s,n.prototype.keydown).on("keydown.bs.dropdown.data-api",".dropdown-menu",n.prototype.keydown)}(jQuery),!function(s){"use strict";function a(t,e){this.options=e,this.$body=s(document.body),this.$element=s(t),this.$dialog=this.$element.find(".modal-dialog"),this.$backdrop=null,this.isShown=null,this.originalBodyPad=null,this.scrollbarWidth=0,this.ignoreBackdropClick=!1,this.fixedContent=".navbar-fixed-top, .navbar-fixed-bottom",this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,s.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))}function l(n,o){return this.each(function(){var t=s(this),e=t.data("bs.modal"),i=s.extend({},a.DEFAULTS,t.data(),"object"==typeof n&&n);e||t.data("bs.modal",e=new a(this,i)),"string"==typeof n?e[n](o):i.show&&e.show(o)})}a.VERSION="3.4.1",a.TRANSITION_DURATION=300,a.BACKDROP_TRANSITION_DURATION=150,a.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},a.prototype.toggle=function(t){return this.isShown?this.hide():this.show(t)},a.prototype.show=function(i){var n=this,t=s.Event("show.bs.modal",{relatedTarget:i});this.$element.trigger(t),this.isShown||t.isDefaultPrevented()||(this.isShown=!0,this.checkScrollbar(),this.setScrollbar(),this.$body.addClass("modal-open"),this.escape(),this.resize(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',s.proxy(this.hide,this)),this.$dialog.on("mousedown.dismiss.bs.modal",function(){n.$element.one("mouseup.dismiss.bs.modal",function(t){s(t.target).is(n.$element)&&(n.ignoreBackdropClick=!0)})}),this.backdrop(function(){var t=s.support.transition&&n.$element.hasClass("fade"),e=(n.$element.parent().length||n.$element.appendTo(n.$body),n.$element.show().scrollTop(0),n.adjustDialog(),t&&n.$element[0].offsetWidth,n.$element.addClass("in"),n.enforceFocus(),s.Event("shown.bs.modal",{relatedTarget:i}));t?n.$dialog.one("bsTransitionEnd",function(){n.$element.trigger("focus").trigger(e)}).emulateTransitionEnd(a.TRANSITION_DURATION):n.$element.trigger("focus").trigger(e)}))},a.prototype.hide=function(t){t&&t.preventDefault(),t=s.Event("hide.bs.modal"),this.$element.trigger(t),this.isShown&&!t.isDefaultPrevented()&&(this.isShown=!1,this.escape(),this.resize(),s(document).off("focusin.bs.modal"),this.$element.removeClass("in").off("click.dismiss.bs.modal").off("mouseup.dismiss.bs.modal"),this.$dialog.off("mousedown.dismiss.bs.modal"),s.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",s.proxy(this.hideModal,this)).emulateTransitionEnd(a.TRANSITION_DURATION):this.hideModal())},a.prototype.enforceFocus=function(){s(document).off("focusin.bs.modal").on("focusin.bs.modal",s.proxy(function(t){document===t.target||this.$element[0]===t.target||this.$element.has(t.target).length||this.$element.trigger("focus")},this))},a.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keydown.dismiss.bs.modal",s.proxy(function(t){27==t.which&&this.hide()},this)):this.isShown||this.$element.off("keydown.dismiss.bs.modal")},a.prototype.resize=function(){this.isShown?s(window).on("resize.bs.modal",s.proxy(this.handleUpdate,this)):s(window).off("resize.bs.modal")},a.prototype.hideModal=function(){var t=this;this.$element.hide(),this.backdrop(function(){t.$body.removeClass("modal-open"),t.resetAdjustments(),t.resetScrollbar(),t.$element.trigger("hidden.bs.modal")})},a.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},a.prototype.backdrop=function(t){var e,i=this,n=this.$element.hasClass("fade")?"fade":"";this.isShown&&this.options.backdrop?(e=s.support.transition&&n,this.$backdrop=s(document.createElement("div")).addClass("modal-backdrop "+n).appendTo(this.$body),this.$element.on("click.dismiss.bs.modal",s.proxy(function(t){this.ignoreBackdropClick?this.ignoreBackdropClick=!1:t.target===t.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus():this.hide())},this)),e&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),t&&(e?this.$backdrop.one("bsTransitionEnd",t).emulateTransitionEnd(a.BACKDROP_TRANSITION_DURATION):t())):!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),n=function(){i.removeBackdrop(),t&&t()},s.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",n).emulateTransitionEnd(a.BACKDROP_TRANSITION_DURATION):n()):t&&t()},a.prototype.handleUpdate=function(){this.adjustDialog()},a.prototype.adjustDialog=function(){var t=this.$element[0].scrollHeight>document.documentElement.clientHeight;this.$element.css({paddingLeft:!this.bodyIsOverflowing&&t?this.scrollbarWidth:"",paddingRight:this.bodyIsOverflowing&&!t?this.scrollbarWidth:""})},a.prototype.resetAdjustments=function(){this.$element.css({paddingLeft:"",paddingRight:""})},a.prototype.checkScrollbar=function(){var t,e=window.innerWidth;e||(e=(t=document.documentElement.getBoundingClientRect()).right-Math.abs(t.left)),this.bodyIsOverflowing=document.body.clientWidth<e,this.scrollbarWidth=this.measureScrollbar()},a.prototype.setScrollbar=function(){var t=parseInt(this.$body.css("padding-right")||0,10),o=(this.originalBodyPad=document.body.style.paddingRight||"",this.scrollbarWidth);this.bodyIsOverflowing&&(this.$body.css("padding-right",t+o),s(this.fixedContent).each(function(t,e){var i=e.style.paddingRight,n=s(e).css("padding-right");s(e).data("padding-right",i).css("padding-right",parseFloat(n)+o+"px")}))},a.prototype.resetScrollbar=function(){this.$body.css("padding-right",this.originalBodyPad),s(this.fixedContent).each(function(t,e){var i=s(e).data("padding-right");s(e).removeData("padding-right"),e.style.paddingRight=i||""})},a.prototype.measureScrollbar=function(){var t=document.createElement("div"),e=(t.className="modal-scrollbar-measure",this.$body.append(t),t.offsetWidth-t.clientWidth);return this.$body[0].removeChild(t),e};var t=s.fn.modal;s.fn.modal=l,s.fn.modal.Constructor=a,s.fn.modal.noConflict=function(){return s.fn.modal=t,this},s(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(t){var e=s(this),i=e.attr("href"),n=e.attr("data-target")||i&&i.replace(/.*(?=#[^\s]+$)/,""),o=s(document).find(n),n=o.data("bs.modal")?"toggle":s.extend({remote:!/#/.test(i)&&i},o.data(),e.data());e.is("a")&&t.preventDefault(),o.one("show.bs.modal",function(t){t.isDefaultPrevented()||o.one("hidden.bs.modal",function(){e.is(":visible")&&e.trigger("focus")})}),l.call(o,n,this)})}(jQuery),!function(p){"use strict";var n=["sanitize","whiteList","sanitizeFn"],u=["background","cite","href","itemtype","longdesc","poster","src","xlink:href"],t={"*":["class","dir","id","lang","role",/^aria-[\w-]*$/i],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],div:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},g=/^(?:(?:https?|mailto|ftp|tel|file):|[^&:/?#]*(?:[/?#]|$))/gi,b=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+/]+=*$/i;function o(t,e,i){if(0===t.length)return t;if(i&&"function"==typeof i)return i(t);if(!document.implementation||!document.implementation.createHTMLDocument)return t;for(var i=document.implementation.createHTMLDocument("sanitization"),n=(i.body.innerHTML=t,p.map(e,function(t,e){return e})),o=p(i.body).find("*"),s=0,a=o.length;s<a;s++){var l=o[s],r=l.nodeName.toLowerCase();if(-1===p.inArray(r,n))l.parentNode.removeChild(l);else for(var c=p.map(l.attributes,function(t){return t}),d=[].concat(e["*"]||[],e[r]||[]),h=0,m=c.length;h<m;h++)!function(t,e){var i=t.nodeName.toLowerCase();if(-1!==p.inArray(i,e))return-1===p.inArray(i,u)||Boolean(t.nodeValue.match(g)||t.nodeValue.match(b));for(var n=p(e).filter(function(t,e){return e instanceof RegExp}),o=0,s=n.length;o<s;o++)if(i.match(n[o]))return 1}(c[h],d)&&l.removeAttribute(c[h].nodeName)}return i.body.innerHTML}function r(t,e){this.type=null,this.options=null,this.enabled=null,this.timeout=null,this.hoverState=null,this.$element=null,this.inState=null,this.init("tooltip",t,e)}r.VERSION="3.4.1",r.TRANSITION_DURATION=150,r.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0},sanitize:!0,sanitizeFn:null,whiteList:t},r.prototype.init=function(t,e,i){if(this.enabled=!0,this.type=t,this.$element=p(e),this.options=this.getOptions(i),this.$viewport=this.options.viewport&&p(document).find(p.isFunction(this.options.viewport)?this.options.viewport.call(this,this.$element):this.options.viewport.selector||this.options.viewport),this.inState={click:!1,hover:!1,focus:!1},this.$element[0]instanceof document.constructor&&!this.options.selector)throw new Error("`selector` option must be specified when initializing "+this.type+" on the window.document object!");for(var n=this.options.trigger.split(" "),o=n.length;o--;){var s,a=n[o];"click"==a?this.$element.on("click."+this.type,this.options.selector,p.proxy(this.toggle,this)):"manual"!=a&&(s="hover"==a?"mouseleave":"focusout",this.$element.on(("hover"==a?"mouseenter":"focusin")+"."+this.type,this.options.selector,p.proxy(this.enter,this)),this.$element.on(s+"."+this.type,this.options.selector,p.proxy(this.leave,this)))}this.options.selector?this._options=p.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},r.prototype.getDefaults=function(){return r.DEFAULTS},r.prototype.getOptions=function(t){var e,i=this.$element.data();for(e in i)i.hasOwnProperty(e)&&-1!==p.inArray(e,n)&&delete i[e];return(t=p.extend({},this.getDefaults(),i,t)).delay&&"number"==typeof t.delay&&(t.delay={show:t.delay,hide:t.delay}),t.sanitize&&(t.template=o(t.template,t.whiteList,t.sanitizeFn)),t},r.prototype.getDelegateOptions=function(){var i={},n=this.getDefaults();return this._options&&p.each(this._options,function(t,e){n[t]!=e&&(i[t]=e)}),i},r.prototype.enter=function(t){var e=t instanceof this.constructor?t:p(t.currentTarget).data("bs."+this.type);if(e||(e=new this.constructor(t.currentTarget,this.getDelegateOptions()),p(t.currentTarget).data("bs."+this.type,e)),t instanceof p.Event&&(e.inState["focusin"==t.type?"focus":"hover"]=!0),e.tip().hasClass("in")||"in"==e.hoverState)e.hoverState="in";else{if(clearTimeout(e.timeout),e.hoverState="in",!e.options.delay||!e.options.delay.show)return e.show();e.timeout=setTimeout(function(){"in"==e.hoverState&&e.show()},e.options.delay.show)}},r.prototype.isInStateTrue=function(){for(var t in this.inState)if(this.inState[t])return!0;return!1},r.prototype.leave=function(t){var e=t instanceof this.constructor?t:p(t.currentTarget).data("bs."+this.type);if(e||(e=new this.constructor(t.currentTarget,this.getDelegateOptions()),p(t.currentTarget).data("bs."+this.type,e)),t instanceof p.Event&&(e.inState["focusout"==t.type?"focus":"hover"]=!1),!e.isInStateTrue()){if(clearTimeout(e.timeout),e.hoverState="out",!e.options.delay||!e.options.delay.hide)return e.hide();e.timeout=setTimeout(function(){"out"==e.hoverState&&e.hide()},e.options.delay.hide)}},r.prototype.show=function(){var e,t,i,n,o,s,a,l=p.Event("show.bs."+this.type);this.hasContent()&&this.enabled&&(this.$element.trigger(l),o=p.contains(this.$element[0].ownerDocument.documentElement,this.$element[0]),!l.isDefaultPrevented()&&o&&(l=(e=this).tip(),o=this.getUID(this.type),this.setContent(),l.attr("id",o),this.$element.attr("aria-describedby",o),this.options.animation&&l.addClass("fade"),o="function"==typeof this.options.placement?this.options.placement.call(this,l[0],this.$element[0]):this.options.placement,(a=(t=/\s?auto?\s?/i).test(o))&&(o=o.replace(t,"")||"top"),l.detach().css({top:0,left:0,display:"block"}).addClass(o).data("bs."+this.type,this),this.options.container?l.appendTo(p(document).find(this.options.container)):l.insertAfter(this.$element),this.$element.trigger("inserted.bs."+this.type),t=this.getPosition(),i=l[0].offsetWidth,n=l[0].offsetHeight,a&&(a=o,s=this.getPosition(this.$viewport),o="bottom"==o&&t.bottom+n>s.bottom?"top":"top"==o&&t.top-n<s.top?"bottom":"right"==o&&t.right+i>s.width?"left":"left"==o&&t.left-i<s.left?"right":o,l.removeClass(a).addClass(o)),s=this.getCalculatedOffset(o,t,i,n),this.applyPlacement(s,o),a=function(){var t=e.hoverState;e.$element.trigger("shown.bs."+e.type),e.hoverState=null,"out"==t&&e.leave(e)},p.support.transition&&this.$tip.hasClass("fade")?l.one("bsTransitionEnd",a).emulateTransitionEnd(r.TRANSITION_DURATION):a()))},r.prototype.applyPlacement=function(t,e){var i=this.tip(),n=i[0].offsetWidth,o=i[0].offsetHeight,s=parseInt(i.css("margin-top"),10),a=parseInt(i.css("margin-left"),10),s=(isNaN(s)&&(s=0),isNaN(a)&&(a=0),t.top+=s,t.left+=a,p.offset.setOffset(i[0],p.extend({using:function(t){i.css({top:Math.round(t.top),left:Math.round(t.left)})}},t),0),i.addClass("in"),i[0].offsetWidth),a=i[0].offsetHeight,l=("top"==e&&a!=o&&(t.top=t.top+o-a),this.getViewportAdjustedDelta(e,t,s,a)),e=(l.left?t.left+=l.left:t.top+=l.top,/top|bottom/.test(e)),n=e?2*l.left-n+s:2*l.top-o+a,s=e?"offsetWidth":"offsetHeight";i.offset(t),this.replaceArrow(n,i[0][s],e)},r.prototype.replaceArrow=function(t,e,i){this.arrow().css(i?"left":"top",50*(1-t/e)+"%").css(i?"top":"left","")},r.prototype.setContent=function(){var t=this.tip(),e=this.getTitle();this.options.html?(this.options.sanitize&&(e=o(e,this.options.whiteList,this.options.sanitizeFn)),t.find(".tooltip-inner").html(e)):t.find(".tooltip-inner").text(e),t.removeClass("fade in top bottom left right")},r.prototype.hide=function(t){var e=this,i=p(this.$tip),n=p.Event("hide.bs."+this.type);function o(){"in"!=e.hoverState&&i.detach(),e.$element&&e.$element.removeAttr("aria-describedby").trigger("hidden.bs."+e.type),t&&t()}if(this.$element.trigger(n),!n.isDefaultPrevented())return i.removeClass("in"),p.support.transition&&i.hasClass("fade")?i.one("bsTransitionEnd",o).emulateTransitionEnd(r.TRANSITION_DURATION):o(),this.hoverState=null,this},r.prototype.fixTitle=function(){var t=this.$element;!t.attr("title")&&"string"==typeof t.attr("data-original-title")||t.attr("data-original-title",t.attr("title")||"").attr("title","")},r.prototype.hasContent=function(){return this.getTitle()},r.prototype.getPosition=function(t){var e=(t=t||this.$element)[0],i="BODY"==e.tagName,n=e.getBoundingClientRect(),e=(null==n.width&&(n=p.extend({},n,{width:n.right-n.left,height:n.bottom-n.top})),window.SVGElement&&e instanceof window.SVGElement),e=i?{top:0,left:0}:e?null:t.offset(),t={scroll:i?document.documentElement.scrollTop||document.body.scrollTop:t.scrollTop()},i=i?{width:p(window).width(),height:p(window).height()}:null;return p.extend({},n,t,i,e)},r.prototype.getCalculatedOffset=function(t,e,i,n){return"bottom"==t?{top:e.top+e.height,left:e.left+e.width/2-i/2}:"top"==t?{top:e.top-n,left:e.left+e.width/2-i/2}:"left"==t?{top:e.top+e.height/2-n/2,left:e.left-i}:{top:e.top+e.height/2-n/2,left:e.left+e.width}},r.prototype.getViewportAdjustedDelta=function(t,e,i,n){var o,s,a={top:0,left:0};return this.$viewport&&(o=this.options.viewport&&this.options.viewport.padding||0,s=this.getPosition(this.$viewport),/right|left/.test(t)?(t=e.top-o-s.scroll,n=e.top+o-s.scroll+n,t<s.top?a.top=s.top-t:n>s.top+s.height&&(a.top=s.top+s.height-n)):(t=e.left-o,n=e.left+o+i,t<s.left?a.left=s.left-t:n>s.right&&(a.left=s.left+s.width-n))),a},r.prototype.getTitle=function(){var t=this.$element,e=this.options;return t.attr("data-original-title")||("function"==typeof e.title?e.title.call(t[0]):e.title)},r.prototype.getUID=function(t){for(;t+=~~(1e6*Math.random()),document.getElementById(t););return t},r.prototype.tip=function(){if(this.$tip||(this.$tip=p(this.options.template),1==this.$tip.length))return this.$tip;throw new Error(this.type+" `template` option must consist of exactly 1 top-level element!")},r.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},r.prototype.enable=function(){this.enabled=!0},r.prototype.disable=function(){this.enabled=!1},r.prototype.toggleEnabled=function(){this.enabled=!this.enabled},r.prototype.toggle=function(t){var e=this;t&&!(e=p(t.currentTarget).data("bs."+this.type))&&(e=new this.constructor(t.currentTarget,this.getDelegateOptions()),p(t.currentTarget).data("bs."+this.type,e)),t?(e.inState.click=!e.inState.click,e.isInStateTrue()?e.enter(e):e.leave(e)):e.tip().hasClass("in")?e.leave(e):e.enter(e)},r.prototype.destroy=function(){var t=this;clearTimeout(this.timeout),this.hide(function(){t.$element.off("."+t.type).removeData("bs."+t.type),t.$tip&&t.$tip.detach(),t.$tip=null,t.$arrow=null,t.$viewport=null,t.$element=null})},r.prototype.sanitizeHtml=function(t){return o(t,this.options.whiteList,this.options.sanitizeFn)};var e=p.fn.tooltip;p.fn.tooltip=function(n){return this.each(function(){var t=p(this),e=t.data("bs.tooltip"),i="object"==typeof n&&n;!e&&/destroy|hide/.test(n)||(e||t.data("bs.tooltip",e=new r(this,i)),"string"==typeof n&&e[n]())})},p.fn.tooltip.Constructor=r,p.fn.tooltip.noConflict=function(){return p.fn.tooltip=e,this}}(jQuery),!function(o){"use strict";function s(t,e){this.init("popover",t,e)}if(!o.fn.tooltip)throw new Error("Popover requires tooltip.js");s.VERSION="3.4.1",s.DEFAULTS=o.extend({},o.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),((s.prototype=o.extend({},o.fn.tooltip.Constructor.prototype)).constructor=s).prototype.getDefaults=function(){return s.DEFAULTS},s.prototype.setContent=function(){var t,e=this.tip(),i=this.getTitle(),n=this.getContent();this.options.html?(t=typeof n,this.options.sanitize&&(i=this.sanitizeHtml(i),"string"==t&&(n=this.sanitizeHtml(n))),e.find(".popover-title").html(i),e.find(".popover-content").children().detach().end()["string"==t?"html":"append"](n)):(e.find(".popover-title").text(i),e.find(".popover-content").children().detach().end().text(n)),e.removeClass("fade top bottom left right in"),e.find(".popover-title").html()||e.find(".popover-title").hide()},s.prototype.hasContent=function(){return this.getTitle()||this.getContent()},s.prototype.getContent=function(){var t=this.$element,e=this.options;return t.attr("data-content")||("function"==typeof e.content?e.content.call(t[0]):e.content)},s.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")};var t=o.fn.popover;o.fn.popover=function(n){return this.each(function(){var t=o(this),e=t.data("bs.popover"),i="object"==typeof n&&n;!e&&/destroy|hide/.test(n)||(e||t.data("bs.popover",e=new s(this,i)),"string"==typeof n&&e[n]())})},o.fn.popover.Constructor=s,o.fn.popover.noConflict=function(){return o.fn.popover=t,this}}(jQuery),!function(o){"use strict";function n(t,e){this.$body=o(document.body),this.$scrollElement=o(t).is(document.body)?o(window):o(t),this.options=o.extend({},n.DEFAULTS,e),this.selector=(this.options.target||"")+" .nav li > a",this.offsets=[],this.targets=[],this.activeTarget=null,this.scrollHeight=0,this.$scrollElement.on("scroll.bs.scrollspy",o.proxy(this.process,this)),this.refresh(),this.process()}function e(i){return this.each(function(){var t=o(this),e=t.data("bs.scrollspy");e||t.data("bs.scrollspy",e=new n(this,"object"==typeof i&&i)),"string"==typeof i&&e[i]()})}n.VERSION="3.4.1",n.DEFAULTS={offset:10},n.prototype.getScrollHeight=function(){return this.$scrollElement[0].scrollHeight||Math.max(this.$body[0].scrollHeight,document.documentElement.scrollHeight)},n.prototype.refresh=function(){var t=this,i="offset",n=0;this.offsets=[],this.targets=[],this.scrollHeight=this.getScrollHeight(),o.isWindow(this.$scrollElement[0])||(i="position",n=this.$scrollElement.scrollTop()),this.$body.find(this.selector).map(function(){var t=o(this),t=t.data("target")||t.attr("href"),e=/^#./.test(t)&&o(t);return e&&e.length&&e.is(":visible")?[[e[i]().top+n,t]]:null}).sort(function(t,e){return t[0]-e[0]}).each(function(){t.offsets.push(this[0]),t.targets.push(this[1])})},n.prototype.process=function(){var t,e=this.$scrollElement.scrollTop()+this.options.offset,i=this.getScrollHeight(),n=this.options.offset+i-this.$scrollElement.height(),o=this.offsets,s=this.targets,a=this.activeTarget;if(this.scrollHeight!=i&&this.refresh(),n<=e)return a!=(t=s[s.length-1])&&this.activate(t);if(a&&e<o[0])return this.activeTarget=null,this.clear();for(t=o.length;t--;)a!=s[t]&&e>=o[t]&&(void 0===o[t+1]||e<o[t+1])&&this.activate(s[t])},n.prototype.activate=function(t){this.activeTarget=t,this.clear();t=this.selector+'[data-target="'+t+'"],'+this.selector+'[href="'+t+'"]',t=o(t).parents("li").addClass("active");(t=t.parent(".dropdown-menu").length?t.closest("li.dropdown").addClass("active"):t).trigger("activate.bs.scrollspy")},n.prototype.clear=function(){o(this.selector).parentsUntil(this.options.target,".active").removeClass("active")};var t=o.fn.scrollspy;o.fn.scrollspy=e,o.fn.scrollspy.Constructor=n,o.fn.scrollspy.noConflict=function(){return o.fn.scrollspy=t,this},o(window).on("load.bs.scrollspy.data-api",function(){o('[data-spy="scroll"]').each(function(){var t=o(this);e.call(t,t.data())})})}(jQuery),!function(a){"use strict";function l(t){this.element=a(t)}function e(i){return this.each(function(){var t=a(this),e=t.data("bs.tab");e||t.data("bs.tab",e=new l(this)),"string"==typeof i&&e[i]()})}l.VERSION="3.4.1",l.TRANSITION_DURATION=150,l.prototype.show=function(){var t,e,i,n=this.element,o=n.closest("ul:not(.dropdown-menu)"),s=(s=n.data("target"))||(s=n.attr("href"))&&s.replace(/.*(?=#[^\s]*$)/,"");n.parent("li").hasClass("active")||(t=o.find(".active:last a"),e=a.Event("hide.bs.tab",{relatedTarget:n[0]}),i=a.Event("show.bs.tab",{relatedTarget:t[0]}),t.trigger(e),n.trigger(i),i.isDefaultPrevented()||e.isDefaultPrevented()||(i=a(document).find(s),this.activate(n.closest("li"),o),this.activate(i,i.parent(),function(){t.trigger({type:"hidden.bs.tab",relatedTarget:n[0]}),n.trigger({type:"shown.bs.tab",relatedTarget:t[0]})})))},l.prototype.activate=function(t,e,i){var n=e.find("> .active"),o=i&&a.support.transition&&(n.length&&n.hasClass("fade")||!!e.find("> .fade").length);function s(){n.removeClass("active").find("> .dropdown-menu > .active").removeClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!1),t.addClass("active").find('[data-toggle="tab"]').attr("aria-expanded",!0),o?(t[0].offsetWidth,t.addClass("in")):t.removeClass("fade"),t.parent(".dropdown-menu").length&&t.closest("li.dropdown").addClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!0),i&&i()}n.length&&o?n.one("bsTransitionEnd",s).emulateTransitionEnd(l.TRANSITION_DURATION):s(),n.removeClass("in")};function t(t){t.preventDefault(),e.call(a(this),"show")}var i=a.fn.tab;a.fn.tab=e,a.fn.tab.Constructor=l,a.fn.tab.noConflict=function(){return a.fn.tab=i,this};a(document).on("click.bs.tab.data-api",'[data-toggle="tab"]',t).on("click.bs.tab.data-api",'[data-toggle="pill"]',t)}(jQuery),!function(a){"use strict";function l(t,e){this.options=a.extend({},l.DEFAULTS,e),e=this.options.target===l.DEFAULTS.target?a(this.options.target):a(document).find(this.options.target),this.$target=e.on("scroll.bs.affix.data-api",a.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",a.proxy(this.checkPositionWithEventLoop,this)),this.$element=a(t),this.affixed=null,this.unpin=null,this.pinnedOffset=null,this.checkPosition()}function i(i){return this.each(function(){var t=a(this),e=t.data("bs.affix");e||t.data("bs.affix",e=new l(this,"object"==typeof i&&i)),"string"==typeof i&&e[i]()})}l.VERSION="3.4.1",l.RESET="affix affix-top affix-bottom",l.DEFAULTS={offset:0,target:window},l.prototype.getState=function(t,e,i,n){var o,s=this.$target.scrollTop(),a=this.$element.offset(),l=this.$target.height();return null!=i&&"top"==this.affixed?s<i&&"top":"bottom"==this.affixed?null!=i?!(s+this.unpin<=a.top)&&"bottom":!(s+l<=t-n)&&"bottom":(a=(o=null==this.affixed)?s:a.top,null!=i&&s<=i?"top":null!=n&&t-n<=a+(o?l:e)&&"bottom")},l.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(l.RESET).addClass("affix");var t=this.$target.scrollTop(),e=this.$element.offset();return this.pinnedOffset=e.top-t},l.prototype.checkPositionWithEventLoop=function(){setTimeout(a.proxy(this.checkPosition,this),1)},l.prototype.checkPosition=function(){if(this.$element.is(":visible")){var t=this.$element.height(),e=this.options.offset,i=e.top,n=e.bottom,o=Math.max(a(document).height(),a(document.body).height()),e=("object"!=typeof e&&(n=i=e),"function"==typeof i&&(i=e.top(this.$element)),"function"==typeof n&&(n=e.bottom(this.$element)),this.getState(o,t,i,n));if(this.affixed!=e){null!=this.unpin&&this.$element.css("top","");var i="affix"+(e?"-"+e:""),s=a.Event(i+".bs.affix");if(this.$element.trigger(s),s.isDefaultPrevented())return;this.affixed=e,this.unpin="bottom"==e?this.getPinnedOffset():null,this.$element.removeClass(l.RESET).addClass(i).trigger(i.replace("affix","affixed")+".bs.affix")}"bottom"==e&&this.$element.offset({top:o-t-n})}};var t=a.fn.affix;a.fn.affix=i,a.fn.affix.Constructor=l,a.fn.affix.noConflict=function(){return a.fn.affix=t,this},a(window).on("load",function(){a('[data-spy="affix"]').each(function(){var t=a(this),e=t.data();e.offset=e.offset||{},null!=e.offsetBottom&&(e.offset.bottom=e.offsetBottom),null!=e.offsetTop&&(e.offset.top=e.offsetTop),i.call(t,e)})})}(jQuery),define("bootstrap",["jquery"],function(){}),void 0===Common&&(Common={}),define("notification",["backbone"],function(t){"use strict";function e(){}if(_.extend(e.prototype,t.Events),void 0!==Common.NotificationCenter)throw"Native Common.NotificationCenter instance already defined.";e.extend=t.Model.extend,Common.NotificationCenter=new e}),!function(){function o(t,e){for(var i=t.split("."),n=e||window,o=0,s=i.length;o<s;o++)n=n[i[o]]||{};return n}function t(t){_.extend(this,t||{}),this.eventbus=new i({application:this}),this.createApplicationNamespace(),this.initialize.apply(this,arguments),!1!==this.autoCreate&&$($.proxy(this.onReady,this))}if(_.extend(t.prototype,{nameSpace:"Application",models:{},collections:{},controllers:{},allocationMap:{model:"Models",collection:"Collections",controller:"Controllers",view:"Views"},createApplicationNamespace:function(){var t=window;this.nameSpace&&void 0===t[this.nameSpace]&&(t[this.nameSpace]={}),t[this.nameSpace]=this,_.each(this.allocationMap,function(t,e){this[t]=this[t]||{}},this)},initialize:function(){},onReady:function(){this.start()},start:function(){this.initializeControllers(this.controllers||{}),this.launchControllers(),this.launch.call(this)},getClasseRefs:function(t,e){var i={},n=this[this.allocationMap[t]];return _.each(e,function(t){i[t]=o(t,-1<t.indexOf(".")?window:n)},this),i},initializeControllers:function(t){this.controllers={},_.each(t,function(t){var e=-1<t.indexOf(".")?window:this[this.allocationMap.controller],e=o(t,e),e=(t.split(".").pop(),new e({id:t,application:this}));e.views=this.getClasseRefs("view",e.views||[]),_.extend(this.models,this.getClasseRefs("model",e.models||[])),_.extend(this.collections,this.getClasseRefs("collection",e.collections||{})),this.buildCollections(),this.controllers[t]=e},this)},launchControllers:function(){_.each(this.controllers,function(t,e){t.onLaunch(this)},this)},launch:function(){},addListeners:function(t,e){this.eventbus.addListeners(t,e)},getController:function(t){return this.controllers[t]},getModel:function(t){this._modelsCache=this._modelsCache||{};var e=this._modelsCache[t],i=this.getModelConstructor(t);return!e&&i&&(e=this.createModel(t),this._modelsCache[t]=e),e||null},getModelConstructor:function(t){return this.models[t]},createModel:function(t,e){var t=this.getModelConstructor(t),i=null;return i=t?new t(_.extend(e||{})):i},getCollection:function(t){this._collectionsCache=this._collectionsCache||{};var e=this._collectionsCache[t],i=this.getCollectionConstructor(t);return!e&&i&&(e=this.createCollection(t),this._collectionsCache[t]=e),e||null},getCollectionConstructor:function(t){return this.collections[t]},createCollection:function(t){var t=this.getCollectionConstructor(t),e=null;return e=t?new t:e},buildCollections:function(){_.each(this.collections,function(t,e){this.getCollection(e)},this)}}),void 0!==Backbone.Application)throw"Native Backbone.Application instance already defined.";Backbone.Application=t,Backbone.Application.extend=Backbone.Model.extend;function e(t){_.extend(this,t||{}),this.initialize.apply(this,arguments)}if(_.extend(e.prototype,{name:null,views:{},models:{},collections:{},initialize:function(t){},addListeners:function(t){this.getApplication().addListeners(t,this)},onLaunch:function(t){},getApplication:function(){return this.application},getView:function(t){return this._viewsCache[t]},getViewConstructor:function(t){return this.views[t]},createView:function(t,e){var i=this.getViewConstructor(t),e=_.extend(e||{},{alias:t});return this._viewsCache=this._viewsCache||{},this._viewsCache[t]=new i(e),this._viewsCache[t].options=_.extend({},e),this._viewsCache[t]},getModel:function(t){return this.application.getModel(t)},getModelConstructor:function(t){return this.application.getModelConstructor(t)},createModel:function(t,e){return this.application.createModel(t)},getCollection:function(t){return this.application.getCollection(t)},getCollectionConstructor:function(t){return this.application.getCollectionConstructor(t)},createCollection:function(t){return this.application.createCollection(t)},fireEvent:function(t,e,i){this.application.eventbus.fireEvent(t,e,i)},bindViewEvents:function(t,e){for(var i in this.unbindViewEvents(t),e=_.isFunction(e)?e.call(this):e){var n=e[i],i=(_.isFunction(n)||(n=this[e[i]]),i.match(/^(\S+)\s*(.*)$/)),o=i[1],i=i[2],n=_.bind(n,this);o+=".bindViewEvents"+t.cid,t.$el.on(o,i,n)}return this},unbindViewEvents:function(t){return t.$el.off(".bindViewEvents"+t.cid),this}}),void 0!==Backbone.Controller)throw"Native Backbone.Controller instance already defined.";Backbone.Controller=e,Backbone.Controller.extend=Backbone.Model.extend;var i=function(t){var i=this;_.extend(this,t||{}),_.extend(Backbone.View.prototype,{alias:null,hidden:!1,getAlias:function(){return this.options.alias},fireEvent:function(t,e){this.trigger.apply(this,arguments),i.fireEvent(this.getAlias(),t,e)},hide:function(){this.$el.hide(),this.hidden=!0},show:function(){this.$el.show(),this.hidden=!1}})};if(_.extend(i.prototype,{pool:{},addListeners:function(t,e){this.pool[e.id]=this.pool[e.id]||{};var n=this.pool[e.id];_.isArray(t)?_.each(t,function(t){this.addListeners(t,e)},this):_.isObject(t)&&_.each(t,function(t,i){_.each(t,function(t,e){n[i]=n[i]||{},n[i][e]=n[i][e]||[],n[i][e].push(t)},this)},this)},fireEvent:function(n,o,s){var a=this.getApplication();_.each(this.pool,function(t,e){var i,t=t[n];t&&(t=t[o],i=a.getController(e),_.each(t,function(t){t.apply(i,s)}))},this)},getApplication:function(){return this.application}}),void 0!==Backbone.EventBus)throw"Native Backbone.Application instance already defined.";Backbone.EventBus=i}(),define("core",["backbone","notification"],function(){}),void 0===window.Common&&(window.Common={}),Common.component=Common.component||{},Common.Analytics=Common.component.Analytics=new function(){var o;let s="";try{var t=window.external;s=t.GetMID(t.GetSID(window))}catch(t){}async function e(){let t=localStorage.getItem("__guid");return t||(t=await async function(t){t=(new TextEncoder).encode(t),t=await crypto.subtle.digest("SHA-1",t),t=Array.from(new Uint8Array(t)),t=t.map(t=>t.toString(16).padStart(2,"0")).join("");return t}([Date.now(),Math.random()].join("-")),localStorage.setItem("__guid",t)),t}return s||(chrome.account360?chrome.account360.getMID(t=>{t?s=t:e().then(t=>s=t)}):e().then(t=>s=t)),{initialize:function(t,e){if(void 0===t)throw"Analytics: invalid id.";if(void 0===e||"[object String]"!==Object.prototype.toString.apply(e))throw"Analytics: invalid category type.";o=e,$("head").append('<script type="text/javascript">var _gaq = _gaq || [];_gaq.push(["_setAccount", "'+t+'"]);_gaq.push(["_trackPageview"]);(function() {var ga = document.createElement("script"); ga.type = "text/javascript"; ga.async = true;ga.src = ("https:" == document.location.protocol ? "https://ssl" : "http://www") + ".google-analytics.com/ga.js";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(ga, s);})();<\/script>')},trackEvent:function(t,e,i){if(void 0!==t&&"[object String]"!==Object.prototype.toString.apply(t))throw"Analytics: invalid action type.";if(void 0!==e&&"[object String]"!==Object.prototype.toString.apply(e))throw"Analytics: invalid label type.";if(void 0!==i&&("[object Number]"!==Object.prototype.toString.apply(i)||!isFinite(i)))throw"Analytics: invalid value type.";let n="1431.9739.gif";switch(o){case"WORD":n="1551.1372.gif";break;case"EXCEL":n="1551.2566.gif";break;case"PPT":n="1551.9804.gif"}this.send(n,[t,e,i])},basePath:"https://dd.browser.360.cn/static/a/",init:function(t,e){o=t;var t=e.url.startsWith("."),i=!e.url.startsWith("file:///")&&e.url.includes(":");this.send("1551.7601.gif",["."+e.fileType,t?"new":i?"online":"local"])},send:function(t,e){"[object Array]"===Object.prototype.toString.call(e)&&(e=e.join("|"));var i=window.AscCommon&&window.AscCommon.g_cBuildNumber,n=Date.now()+Math.random().toString().replace("0.","").substr(0,10),i={build:i,mid:s,type:o,_referer:e,r:n},e=this.basePath+t+"?"+jQuery.param(i);(new Image).src=e},trackPerf:function(t){var e=(performance.now()/1e3).toFixed(1)+"s",t=(t/1e3).toFixed(1)+"s";this.send("1431.7617.gif",[o,e,t]),setTimeout(()=>{var t=10*Math.round(performance.memory.usedJSHeapSize/1024/1024/10)+"mb";this.send("1431.9100.gif",[o,t])},3e3)}}},define("analytics",["jquery"],function(){}),void 0===window.Common&&(window.Common={}),Common.Gateway=new function(){function n(t){window.parent&&window.JSON&&(t.frameEditorId=window.frameEditorId,window.parent.postMessage(t,"*"))}function t(t){e(t)}var o=this,s=$(o),i={init:function(t){s.trigger("init",t)},openDocument:function(t){s.trigger("opendocument",t)},showMessage:function(t){s.trigger("showmessage",t)},applyEditRights:function(t){s.trigger("applyeditrights",t)},processSaveResult:function(t){s.trigger("processsaveresult",t)},processRightsChange:function(t){s.trigger("processrightschange",t)},refreshHistory:function(t){s.trigger("refreshhistory",t)},setHistoryData:function(t){s.trigger("sethistorydata",t)},setEmailAddresses:function(t){s.trigger("setemailaddresses",t)},setActionLink:function(t){s.trigger("setactionlink",t.url)},processMailMerge:function(t){s.trigger("processmailmerge",t)},downloadAs:function(t){s.trigger("downloadas",t)},processMouse:function(t){s.trigger("processmouse",t)},internalCommand:function(t){s.trigger("internalcommand",t)},resetFocus:function(t){s.trigger("resetfocus",t)},setUsers:function(t){s.trigger("setusers",t)},showSharingSettings:function(t){s.trigger("showsharingsettings",t)},setSharingSettings:function(t){s.trigger("setsharingsettings",t)},insertImage:function(t){s.trigger("insertimage",t)},setMailMergeRecipients:function(t){s.trigger("setmailmergerecipients",t)},setRevisedFile:function(t){s.trigger("setrevisedfile",t)},setFavorite:function(t){s.trigger("setfavorite",t)},requestClose:function(t){s.trigger("requestclose",t)},blurFocus:function(t){s.trigger("blurfocus",t)},grabFocus:function(t){s.trigger("grabfocus",t)},setReferenceData:function(t){s.trigger("setreferencedata",t)},setRequestedDocument:function(t){s.trigger("setrequesteddocument",t)},setRequestedSpreadsheet:function(t){s.trigger("setrequestedspreadsheet",t)},setReferenceSource:function(t){s.trigger("setreferencesource",t)},asc_CloseFile:function(t){s.trigger("asc_CloseFile",t)},asc_openDocument:function(t){s.trigger("asc_openDocument",t)},asc_setImageUrls:function(t){s.trigger("asc_setImageUrls",t)},asc_onSaveCallback:function(t){s.trigger("asc_onSaveCallback",t)},asc_writeFileCallback:function(t){s.trigger("asc_writeFileCallback",t)},asc_openEmptyDocument:function(t){s.trigger("asc_openEmptyDocument",t)},asc_TextToColumns:function(t){s.trigger("asc_TextToColumns",t)},asc_OpenCSV:function(t){s.trigger("asc_OpenCSV",t)},asc_showPasswordDialog:function(t){s.trigger("asc_showPasswordDialog",t)},asc_Alert:function(t){s.trigger("asc_Alert",t)},asc_Toast:function(t){s.trigger("asc_Toast",t)},asc_trackEvent:function(t){s.trigger("asc_trackEvent",t)},asc_setDocumentName:function(t){s.trigger("asc_setDocumentName",t)},asc_setUnchangedDocument:function(t){s.trigger("asc_setUnchangedDocument",t)},asc_updateRecent:function(t){s.trigger("asc_updateRecent",t)}},e=function(t){if(t.origin===window.parentOrigin||t.origin===window.location.origin||"null"===t.origin&&("file://"===window.parentOrigin||"file://"===window.location.origin)){var t=t.data,e=("[object String]"===Object.prototype.toString.apply(t)&&window.JSON,t);if("string"==typeof e)try{e=window.JSON.parse(t)}catch(t){}e&&(t=i[e.command])&&t.call(this,e.data)}};return window.attachEvent?window.attachEvent("onmessage",t):window.addEventListener("message",t,!1),{appReady:function(){n({event:"onAppReady"})},requestEditRights:function(){n({event:"onRequestEditRights"})},requestHistory:function(){n({event:"onRequestHistory"})},requestHistoryData:function(t){n({event:"onRequestHistoryData",data:t})},requestRestore:function(t,e,i){n({event:"onRequestRestore",data:{version:t,url:e,fileType:i}})},requestEmailAddresses:function(){n({event:"onRequestEmailAddresses"})},requestStartMailMerge:function(){n({event:"onRequestStartMailMerge"})},requestHistoryClose:function(t){n({event:"onRequestHistoryClose"})},reportError:function(t,e){n({event:"onError",data:{errorCode:t,errorDescription:e}})},reportWarning:function(t,e){n({event:"onWarning",data:{warningCode:t,warningDescription:e}})},sendInfo:function(t){n({event:"onInfo",data:t})},setDocumentModified:function(t){n({event:"onDocumentStateChange",data:t})},internalMessage:function(t,e){n({event:"onInternalMessage",data:{type:t,data:e}})},updateVersion:function(){n({event:"onOutdatedVersion"})},downloadAs:function(t,e){n({event:"onDownloadAs",data:{url:t,fileType:e}})},requestSaveAs:function(t,e,i){n({event:"onRequestSaveAs",data:{url:t,title:e,fileType:i}})},collaborativeChanges:function(){n({event:"onCollaborativeChanges"})},requestRename:function(t){n({event:"onRequestRename",data:t})},metaChange:function(t){n({event:"onMetaChange",data:t})},documentReady:function(){n({event:"onDocumentReady"})},requestClose:function(){n({event:"onRequestClose"})},requestMakeActionLink:function(t){n({event:"onMakeActionLink",data:t})},requestUsers:function(t){n({event:"onRequestUsers",data:{c:t}})},requestSendNotify:function(t){n({event:"onRequestSendNotify",data:t})},requestInsertImage:function(t){n({event:"onRequestInsertImage",data:{c:t}})},requestMailMergeRecipients:function(){n({event:"onRequestMailMergeRecipients"})},requestCompareFile:function(){n({event:"onRequestCompareFile"})},requestSharingSettings:function(){n({event:"onRequestSharingSettings"})},requestCreateNew:function(t){n({event:"onRequestCreateNew",data:t})},requestReferenceData:function(t){n({event:"onRequestReferenceData",data:t})},requestOpen:function(t){n({event:"onRequestOpen",data:t})},requestSelectDocument:function(t){n({event:"onRequestSelectDocument",data:{c:t}})},requestSelectSpreadsheet:function(t){n({event:"onRequestSelectSpreadsheet",data:{c:t}})},requestReferenceSource:function(){n({event:"onRequestReferenceSource"})},pluginsReady:function(){n({event:"onPluginsReady"})},on:function(t,i){s.on(t,function(t,e){i.call(o,e)})},off:function(t,e){s.off(t,e)},_postMessage:n}},define("gateway",["jquery"],function(){}),void 0===Common&&(Common={}),Common.Locale=new function(){"use strict";var l10n=null,loadcallback,apply=!1,defLang="zh",currentLang=defLang,_4letterLangs=["pt-pt","zh-tw"],_applyLocalization=function(t,e){try{if(t&&(loadcallback=t),e){for(var i in l10n=e){var n=i.split(".");if(n&&2<n.length){for(var o=window,s=0;s<n.length-1;++s)void 0===o[n[s]]&&(o[n[s]]=new Object),o=o[n[s]];o&&(o[n[n.length-1]]=l10n[i])}}loadcallback&&loadcallback()}else apply=!0}catch(t){}},_get=function(prop,scope){var res="";return l10n&&scope&&scope.name&&(res=l10n[scope.name+"."+prop],!res&&scope.default&&(res=scope.default)),res||(scope?eval(scope.name).prototype[prop]:"")},_getCurrentLanguage=function(){return currentLang},_getDefaultLanguage=function(){return defLang},_getLoadedLanguage=function(){return loadedLang},_getUrlParameterByName=function(t){t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");t=new RegExp("[\\?&]"+t+"=([^&#]*)").exec(location.search);return null==t?"":decodeURIComponent(t[1].replace(/\+/g," "))},_requireLang=function(t){var t=(t="string"!=typeof t?null:t)||_getUrlParameterByName("lang")||defLang,e=_4letterLangs.indexOf(t.replace("_","-").toLowerCase()),t=e<0?t.split(/[\-_]/)[0]:_4letterLangs[e];currentLang=t};_requireLang();const _isCurrentRtl=function(){return!1};return{apply:_applyLocalization,get:_get,getCurrentLanguage:_getCurrentLanguage,isCurrentLanguageRtl:_isCurrentRtl,getDefaultLanguage:_getDefaultLanguage}},define("locale",function(){}),!function(l){var t,e,i,n,r=[1,1.25,1.5,1.75,2,2.25,2.5,2.75,3,3.5,4,4.5,5],c=0!==(r=l.AscDesktopEditor&&l.AscDesktopEditor.GetSupportedScaleValues?l.AscDesktopEditor.GetSupportedScaleValues():r).length&&(t=-1<(e=navigator.userAgent.toLowerCase()).indexOf("android"),e=!(-1<e.indexOf("msie")||-1<e.indexOf("trident")||-1<e.indexOf("edge"))&&-1<e.indexOf("chrome"),i=!!l.opera,n=/android|avantgo|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od|ad)|iris|kindle|lge |maemo|midp|mmp|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(navigator.userAgent||navigator.vendor||l.opera),!(t||!e||i||n||!document||!document.firstElementChild||!document.body)),o=(l.AscCommon=l.AscCommon||{},l.AscCommon.checkDeviceScale=function(){var t={zoom:1,devicePixelRatio:l.devicePixelRatio,applicationPixelRatio:l.devicePixelRatio,correct:!1};if(c){for(var e,i=l.devicePixelRatio,n=0,o=Math.abs(r[0]-i),s=1,a=r.length;s<a&&!(1e-4<Math.abs(r[s]-i)&&r[s]>i-1e-4);s++)(e=Math.abs(r[s]-i))<o-1e-4&&(o=e,n=s);t.applicationPixelRatio=r[n],.01<Math.abs(t.devicePixelRatio-t.applicationPixelRatio)&&(t.zoom=t.devicePixelRatio/t.applicationPixelRatio,t.correct=!0)}return t},1);l.AscCommon.correctApplicationScale=function(t){!t.correct&&Math.abs(t.zoom-o)<1e-4||(o=t.zoom,t=document.firstElementChild.style,Math.abs(o-1)<.001?t.zoom="normal":t.zoom=1/o)}}(window),define("device_scale",function(){}),define("common/main/lib/util/LocalStorage",["gateway"],function(){Common.localStorage=new function(){function n(t,e,i){if(a)try{localStorage.setItem(t,e)}catch(t){}else s[t]=e}function i(t){return a?localStorage.getItem(t):void 0===s[t]?null:s[t]}var e,o,s={};Common.Gateway.on("internalcommand",function(t){"localstorage"==t.type&&(s=t.keys)});try{var a=!!window.localStorage}catch(t){a=!1}return{getId:function(){return e},setId:function(t){e=t},getItem:i,getBool:function(t,e){t=i(t);return e=e||!1,null!==t?0!=parseInt(t):e},setBool:function(t,e,i){n(t,e?1:0)},setItem:n,removeItem:function(t){a?localStorage.removeItem(t):delete s[t]},setKeysFilter:function(t){o=t},getKeysFilter:function(){return o},itemExists:function(t){return null!==i(t)},sync:function(){},save:function(){}}}}),define("common/main/lib/controller/Scaling",["core"],function(){"use strict";Common.UI||(Common.UI={}),Common.UI.Scaling=new function(){const n={"pixel-ratio__1":1,"pixel-ratio__1_25":1.25,"pixel-ratio__1_5":1.5,"pixel-ratio__1_75":1.75,"pixel-ratio__2":2,"pixel-ratio__2_5":2.25};var t=document.body.className;function o(t){return(t=/(pixel-ratio__[\w-]+)/.exec(t))&&t[1]in n?t[1]:"pixel-ratio__1"}let s=o(t);return new MutationObserver(function(t,e){var i=o(document.body.className);i!=s&&($("[ratio]").trigger("app:scaling",{ratio:n[i]}),s=i)}.bind(this)).observe(document.body,{attributes:!0,attributeFilter:["class"]}),{currentRatio:function(){return n[s]},currentRatioSelector:function(){return s}}}}),define("common/main/lib/controller/Themes",["core"],function(){"use strict";Common.UI||(Common.UI={}),Common.UI.Themes=new function(t){const n="light",e="dark";var o={"theme-system":{text:(t=t||{}).txtThemeSystem||"Same as system",type:"system",source:"static"},"theme-light":{text:t.txtThemeLight||"Light",type:"light",source:"static"},"theme-classic-light":{text:t.txtThemeClassicLight||"Classic Light",type:"light",source:"static"},"theme-dark":{text:t.txtThemeDark||"Dark",type:"dark",source:"static"},"theme-contrast-dark":{text:t.txtThemeContrastDark||"Dark Contrast",type:"dark",source:"static"}},i="theme-classic-light",s="theme-dark",a=["toolbar-header-document","toolbar-header-spreadsheet","toolbar-header-presentation","toolbar-header-pdf","text-toolbar-header-on-background-document","text-toolbar-header-on-background-spreadsheet","text-toolbar-header-on-background-presentation","text-toolbar-header-on-background-pdf","background-normal","background-toolbar","background-toolbar-additional","background-primary-dialog-button","background-tab-underline","background-notification-popover","background-notification-badge","background-scrim","background-loader","background-accent-button","background-contrast-popover","shadow-contrast-popover","highlight-button-hover","highlight-button-pressed","highlight-button-pressed-hover","highlight-primary-dialog-button-hover","highlight-header-button-hover","highlight-header-button-pressed","highlight-toolbar-tab-underline","highlight-text-select","highlight-accent-button-hover","highlight-accent-button-pressed","border-toolbar","border-divider","border-regular-control","border-toolbar-button-hover","border-preview-hover","border-preview-select","border-control-focus","border-color-shading","border-error","border-contrast-popover","text-normal","text-normal-pressed","text-secondary","text-tertiary","text-link","text-link-hover","text-link-active","text-link-visited","text-inverse","text-toolbar-header","text-contrast-background","text-alt-key-hint","icon-normal","icon-normal-pressed","icon-inverse","icon-toolbar-header","icon-notification-badge","icon-contrast-popover","icon-success","canvas-background","canvas-content-background","canvas-page-border","canvas-ruler-background","canvas-ruler-border","canvas-ruler-margins-background","canvas-ruler-mark","canvas-ruler-handle-border","canvas-ruler-handle-border-disabled","canvas-high-contrast","canvas-high-contrast-disabled","canvas-cell-border","canvas-cell-title","canvas-cell-title-border","canvas-cell-title-border-hover","canvas-cell-title-border-selected","canvas-cell-title-hover","canvas-cell-title-selected","canvas-dark-cell-title","canvas-dark-cell-title-hover","canvas-dark-cell-title-selected","canvas-dark-cell-title-border","canvas-dark-cell-title-border-hover","canvas-dark-cell-title-border-selected","canvas-dark-content-background","canvas-dark-page-border","canvas-scroll-thumb","canvas-scroll-thumb-hover","canvas-scroll-thumb-pressed","canvas-scroll-thumb-border","canvas-scroll-thumb-border-hover","canvas-scroll-thumb-border-pressed","canvas-scroll-arrow","canvas-scroll-arrow-hover","canvas-scroll-arrow-pressed","canvas-scroll-thumb-target","canvas-scroll-thumb-target-hover","canvas-scroll-thumb-target-pressed","canvas-sheet-view-cell-background","canvas-sheet-view-cell-background-hover","canvas-sheet-view-cell-background-pressed","canvas-sheet-view-cell-title-label","canvas-freeze-line-1px","canvas-freeze-line-2px","canvas-select-all-icon"],l=function(t){var i,t=t||a,n={};return Common.Utils.isIE10||Common.Utils.isIE11||(i=getComputedStyle(document.body),t.forEach(function(t,e){n[t]=i.getPropertyValue("--"+t).trim()})),n};function r(t){return(t="string"==typeof t&&t.startsWith("{")&&t.endsWith("}")?JSON.parse(t):t)&&"object"==typeof t?t.id:t}function c(){var t=(Common.Controllers.Desktop&&Common.Controllers.Desktop.isActive()?Common.Controllers.Desktop.systemThemeType():window.matchMedia("(prefers-color-scheme: dark)").matches?e:n)==e?s:i;return{id:t,info:o[t]}}function d(t){window.uitheme.set_id(t);var e=window.uitheme.relevant_theme_id(),i=(document.body.className=document.body.className.replace(/theme-[\w-]+\s?/gi,"").trim(),document.body.classList.add(e,"theme-type-"+o[e].type),this.api.asc_setContentDarkMode&&("dark"==o[e].type?(this.api.asc_setContentDarkMode(this.isContentThemeDark()),Common.NotificationCenter.trigger("contenttheme:dark",this.isContentThemeDark())):this.api.asc_setContentDarkMode(!1)),l());i.type=o[e].type,i.name=e,this.api.asc_setSkin(i),Common.Utils.isIE10||Common.Utils.isIE11||"static"!=o[t].source&&(e={id:t,type:o[t].type,text:o[t].text,colors:i},Common.localStorage.setItem("ui-theme",JSON.stringify(e)))}function h(t){!t&&Common.localStorage.getItem("ui-theme-id")==window.uitheme.id||(t=Common.localStorage.getItem("ui-theme-id"))&&(d.call(this,t),Common.NotificationCenter.trigger("uitheme:changed",t))}return{init:function(t){Common.Gateway.on("opendocument",function(t){}.bind(this)),$(window).on("storage",function(t){"ui-theme-id"!=t.key||Common.Controllers.Desktop.isActive()?"content-theme"==t.key&&this.setContentTheme(t.originalEvent.newValue,!0):t.originalEvent.newValue&&h.call(this)}.bind(this)),this.api=t;var e=window.uitheme.relevant_theme_id(),i=l(a),i=(i.type=window.uitheme.type||(o[e]?o[e].type:n),i.name=e,t.asc_setSkin(i),o[e]&&"dark"==o[e].type&&window.uitheme.iscontentdark);t.asc_setContentDarkMode&&t.asc_setContentDarkMode(i),Common.Utils.isIE10||Common.Utils.isIE11||window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",function(t){window.uitheme.is_theme_system()&&h.call(this,!0)}.bind(this)),Common.NotificationCenter.on("document:ready",function(t){}.bind(this))},available:function(){return!Common.Utils.isIE&&!this.locked},setAvailable:function(t){this.locked=!t},map:function(){return o},get:function(t){return o[t]},currentThemeId:function(){return o[window.uitheme.id]?window.uitheme.id:i},defaultThemeId:function(t){return"dark"==t?s:i},defaultTheme:function(t){return o[this.defaultThemeId(t)]},isDarkTheme:function(t){return t=t||this.currentThemeId(),("system"==o[t].type?c().info:o[t]).type==e},isContentThemeDark:function(){return window.uitheme.iscontentdark},setContentTheme:function(t,e){var i="dark"==t;i==window.uitheme.iscontentdark&&!e||(this.isDarkTheme()&&this.api.asc_setContentDarkMode(i),window.uitheme.iscontentdark=t,Common.localStorage.getItem("content-theme")!=t&&Common.localStorage.setItem("content-theme",t),Common.NotificationCenter.trigger("contenttheme:dark",i))},toggleContentTheme:function(){window.uitheme.iscontentdark=!window.uitheme.iscontentdark,Common.localStorage.setItem("content-theme",window.uitheme.iscontentdark?"dark":"light"),this.isDarkTheme()&&this.api.asc_setContentDarkMode(window.uitheme.iscontentdark),Common.NotificationCenter.trigger("contenttheme:dark",window.uitheme.iscontentdark)},setTheme:function(t){t&&(t=r(t),o[t]&&t!=window.uitheme.id&&(d.call(this,t),Common.localStorage.setItem("ui-theme-id",t),Common.NotificationCenter.trigger("uitheme:changed",t)))},refreshTheme:h,toggleTheme:function(){this.setTheme(this.isDarkTheme()?i:s)}}}(Common.UI.Themes)}),define("common/main/lib/controller/Desktop",["core"],function(){"use strict";var g=window.DE||window.PE||window.SSE||window.PDFE,b=Object.assign({version:"7.4.1.1",eventloading:!0,titlebuttons:!0,uithemes:!0,btnhome:!0,quickprint:!0},g.features),C=window.desktop||window.AscDesktopEditor;window.RendererProcessVariable={},(C={execCommand:()=>{},LocalFileRecents:()=>{}})&&C.execCommand("webapps:features",JSON.stringify(b)),Common.Controllers||(Common.Controllers={}),Common.Controllers.Desktop=new function(){var a,e,i,l={version:"7.4.1.1"},n={"btn-save":"save","btn-save-coauth":"coauth","btn-synch":"synch"};let o=[];if(C){if(C.features=C.features||{},e=window.RendererProcessVariable,window.on_native_message=function(t,e){var i;if(/^style:change/.test(t))"toolbar"==(n=JSON.parse(e)).element?"off"==n.action&&"native-color"==n.style&&$(".toolbar").removeClass("editor-native-color"):"body"==n.element&&"merge"==n.action&&((i=document.createElement("style")).innerHTML=n.style,document.body.appendChild(i));else if(/window:features/.test(t)){var n=JSON.parse(e);_.isNumber(n.skiptoparea)&&($(".asc-window.modal").length&&$(".asc-window.modal").position().top<n.skiptoparea&&$(".asc-window.modal").css("top",n.skiptoparea),Common.Utils.InternalSettings.set("window-inactive-area-top",n.skiptoparea)),void 0!==n.singlewindow&&(C.features.singlewindow=n.singlewindow,l.isFillFormApp?$("#title-doc-name")[n.singlewindow?"hide":"show"]():a&&a.home&&a.home.btn.setVisible(n.singlewindow))}else if(/editor:config/.test(t)){if("request"==e){var o={user:l.user,title:{buttons:[]}};if(a){if(!$.isEmptyObject(a))if(g.getController("Viewport").getView("Common.Views.Header"))for(var s in a)o.title.buttons.push(d(s,a[s]));C.execCommand("editor:config",JSON.stringify(o))}else l.callback_editorconfig||(l.callback_editorconfig=function(){setTimeout(function(){window.on_native_message(t,e)},0)})}}else if(/button:click/.test(t))(n=JSON.parse(e)).action&&a[n.action]&&a[n.action].btn.click();else if(/theme:changed/.test(t))Common.UI.Themes.setTheme(e);else if(/renderervars:changed/.test(t)){const o=JSON.parse(e);o.theme&&o.theme.system&&(window.RendererProcessVariable.theme.system=o.theme.system,"theme-system"==Common.UI.Themes.currentThemeId()&&Common.UI.Themes.refreshTheme(!0))}else/element:show/.test(t)?(i=/title:(?:(true|show)|(false|hide))/.exec(e))&&(i[1]?$("#app-title").show():i[2]&&$("#app-title").hide()):/althints:show/.test(t)?/false|hide/.test(e)&&Common.NotificationCenter.trigger("hints:clear"):/file:print/.test(t)?g.getController("Main").onPrint():/file:saveas/.test(t)?g.getController("Main").api.asc_DownloadAs():/file:save/.test(t)&&g.getController("Main").api.asc_Save()},window.on_native_message("editor:config","request"),window.native_message_cmd)for(var t in window.native_message_cmd)"uitheme:changed"!=t&&window.on_native_message(t,window.native_message_cmd[t]);C.execCommand("webapps:features",JSON.stringify(b)),window.onupdaterecents=function(t){o=u(t),Common.NotificationCenter.trigger("update:recents",o)};var s=document.createElement("style");s.appendChild(document.createTextNode(".modals-mask{opacity:0 !important;}")),document.getElementsByTagName("head")[0].appendChild(s)}function r(t,e,i){var n={};n[t]=i,C.execCommand("title:button",JSON.stringify({disabled:n}))}function c(t){if("open"==t)C.execCommand("title:button",JSON.stringify({disabled:{all:!0}}));else{var e,i={};for(e in a)i[e]=a[e].btn.isDisabled();C.execCommand("title:button",JSON.stringify({disabled:i}))}}var d=function(t,e){return{action:t,icon:e.icon||void 0,hint:e.btn.options.hint,disabled:e.btn.isDisabled(),visible:e.visible}};function h(t){_.extend(l,t),C&&C.execCommand("doc:onready",""),C&&C.LocalFileRecents(),$(".toolbar").addClass("editor-native-color")}function m(){if(l.isEdit){const e=g.getController("Viewport").getView("Common.Views.Header"),i=g.getController("Main").api;var t=i.asc_getLocalRestrictions?i.asc_getLocalRestrictions():Asc.c_oAscLocalRestrictionType.None;Asc.c_oAscLocalRestrictionType.None!==t&&(b.readonly=!0,e.setDocumentReadOnly(!0),i.asc_setLocalRestrictions(Asc.c_oAscLocalRestrictionType.None),new Common.UI.SynchronizeTip({extCls:"no-arrow",placement:"bottom",target:$(".toolbar"),text:t!==Asc.c_oAscLocalRestrictionType.ReadOnly?Common.Locale.get("tipFileLocked",{name:"Common.Translation",default:"Document is locked for editing. You can make changes and save its local copy later."}):Common.Locale.get("tipFileReadOnly",{name:"Common.Translation",default:"Document is read only. You can make changes and save its local copy later."}),showLink:!1}).on("closeclick",function(){this.close()}).show(),C.execCommand("webapps:features",JSON.stringify(b)),i.asc_registerCallback("asc_onDocumentName",function(){b.readonly&&i.asc_getLocalRestrictions()==Asc.c_oAscLocalRestrictionType.None&&(b.readonly=!1,e.setDocumentReadOnly(!1),C.execCommand("webapps:features",JSON.stringify(b)))}))}}function p(t){if(b.viewmode=!t.isEdit,b.viewmode&&(b.btnhome=!1),b.crypted=t.isCrypted,C.execCommand("webapps:features",JSON.stringify(b)),a={},t.isEdit){var e,i,t=g.getController("Viewport").getView("Common.Views.Header");for(i in t.btnHome=new Common.UI.Button({cls:"btn-header",iconCls:"toolbar__icon icon--inverse btn-home",visible:!1,hint:Common.Locale.get("hintBtnHome",{name:"Common.Controllers.Desktop",default:"Show Main window"}),dataHint:"0",dataHintDirection:"right",dataHintOffset:"10, -18",dataHintTitle:"K"}).render($("#box-document-title #slot-btn-dt-home")),a.home={btn:t.btnHome},t.btnHome.on("click",function(t){C.execCommand("title:button",JSON.stringify({click:"home"}))}),$("#id-box-doc-name").on({dblclick:function(t){C.execCommand("title:dblclick",JSON.stringify({x:t.originalEvent.screenX,y:t.originalEvent.screenY}))},mousedown:function(t){C.execCommand("title:mousedown",JSON.stringify({x:t.originalEvent.screenX,y:t.originalEvent.screenY}))},mousemove:function(t){C.execCommand("title:mousemove",JSON.stringify({x:t.originalEvent.screenX,y:t.originalEvent.screenY}))},mouseup:function(t){C.execCommand("title:mouseup",JSON.stringify({x:t.originalEvent.screenX,y:t.originalEvent.screenY}))}}),t.btnSave&&(a.save={btn:t.btnSave},(e=/\s?([^\s]+)$/.exec(a.save.btn.$icon.attr("class")))&&e.length&&(a.save.icon=n[e])),t.btnPrint&&(a.print={btn:t.btnPrint}),t.btnPrintQuick&&(a.quickprint={btn:t.btnPrintQuick,visible:t.btnPrintQuick.isVisible()}),t.btnUndo&&(a.undo={btn:t.btnUndo}),t.btnRedo&&(a.redo={btn:t.btnRedo}),a)a[i].btn.options.signals=["disabled"],a[i].btn.on("disabled",r.bind(this,i));a.save&&(a.save.btn.options.signals.push("icon:changed"),a.save.btn.on("icon:changed",function(t,e){C.execCommand("title:button",JSON.stringify({"icon:changed":{save:n[e.next]}}))}.bind(this)))}l.callback_editorconfig&&(l.callback_editorconfig(),delete l.callback_editorconfig),void 0!==C.features.singlewindow&&(l.isFillFormApp&&$("#title-doc-name")[C.features.singlewindow?"hide":"show"](),a.home&&a.home.btn.setVisible(C.features.singlewindow))}const u=function(t){var e,i=[],n=/Win/.test(navigator.platform)?/([^\\/]+\.[a-zA-Z0-9]{1,})$/:/([^/]+\.[a-zA-Z0-9]{1,})$/;for(e in t){var o,s,a=t[e];f.matchFileFormat(a.type)&&n.test(a.path)&&(o=n.exec(a.path)[1],s=a.path.slice(0,a.path.length-o.length-1),i.push({fileid:a.id,type:a.type,format:f.parseFileFormat(a.type),title:o,url:a.path,folder:s}))}return i};return{init:function(t){_.extend(l,t);t=e&&"winxp"===e.os;Common.UI.Themes.setAvailable(!t),Common.NotificationCenter.on({"app:ready":h,"document:ready":m.bind(this),"app:face":p.bind(this),"modal:show":c.bind(this,"open"),"modal:close":c.bind(this,"close"),"modal:hide":c.bind(this,"hide"),"uitheme:changed":function(t){var e;window.uitheme.is_theme_system()?C.execCommand("uitheme:changed",JSON.stringify({name:"theme-system"})):(e=Common.UI.Themes.get(t))&&C.execCommand("uitheme:changed",JSON.stringify({name:t,type:e.type}))},"hints:show":function(t,e){t={visible:t&&!(0<e)};a&&(t.hints={},a.print&&(t.hints.print=a.print.btn.btnEl.attr("data-hint-title")),a.quickprint&&(t.hints.quickprint=a.quickprint.btn.btnEl.attr("data-hint-title")),a.undo&&(t.hints.undo=a.undo.btn.btnEl.attr("data-hint-title")),a.redo&&(t.hints.redo=a.redo.btn.btnEl.attr("data-hint-title")),a.save&&(t.hints.save=a.save.btn.btnEl.attr("data-hint-title"))),C.execCommand("althints:show",JSON.stringify(t))}.bind(this)}),$(document).on("keydown",function(t){Common.UI.HintManager&&Common.UI.HintManager.isHintVisible()&&C.execCommand("althints:keydown",JSON.stringify({code:t.keyCode}))}.bind(this)),"fillform"==b.uitype&&(l.isFillFormApp=!0,$("#header-logo, .brand-logo").hide())},process:function(t){if(l.isDesktopApp&&C){if("goback"==t)return C.execCommand("go:folder",l.isOffline?"offline":l.customization.goback.url),!0;if("preloader:hide"==t)return C.execCommand("editor:onready",""),!0;if("create:new"==t&&"desktop://create.new"==l.createUrl)return C.execCommand("create:new",window.SSE?"cell":window.PE?"slide":"word"),!0}return!1},requestClose:function(){l.isDesktopApp&&C&&C.execCommand("editor:event",JSON.stringify({action:"file:close",url:l.customization.goback.url}))},isActive:function(){return!!C},isOffline:function(){return(l.isFillFormApp?g.getController("ApplicationController"):g.getController("Main")).appOptions.isOffline},isFeatureAvailable:function(t){return!!C&&!!C[t]},call:function(t){var e;if(C[t])return e=[].slice.call(arguments,1),C[t].apply(this,e)},helpUrl:function(){var t;return i||(e&&e.helpUrl?(t=window.SSE?"spreadsheeteditor":window.PE?"presentationeditor":"documenteditor",e.helpUrl+"/"+t+"/main/resources/help"):void 0)},isHelpAvailable:function(){return!!i},getDefaultPrinterName:function(){return e?e.defaultPrinterName:""},systemThemeType:function(){return e.theme&&e.theme.system?e.theme.system:window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"},systemThemeSupported:function(){return e.theme&&"disabled"!==e.theme.system},localThemes:function(){return e?e.localthemes:void 0},recentFiles:function(){return o},openRecent:function(t){var e;return!!this.isActive()&&(e={name:Common.Utils.String.htmlDecode(t.get("title")),path:Common.Utils.String.htmlDecode(t.get("url"))},null!=t.get("fileid")&&null!=t.get("fileid")?(e.id=t.get("fileid"),e.type=t.type):e.id=-1,C.execCommand("open:recent",JSON.stringify(e)),!0)}}};const f={defines:{}};f.defines.FileFormat={FILE_UNKNOWN:0,FILE_DOCUMENT:64,FILE_DOCUMENT_DOCX:65,FILE_DOCUMENT_DOC:66,FILE_DOCUMENT_ODT:67,FILE_DOCUMENT_RTF:68,FILE_DOCUMENT_TXT:69,FILE_DOCUMENT_HTML:70,FILE_DOCUMENT_MHT:71,FILE_DOCUMENT_EPUB:72,FILE_DOCUMENT_FB2:73,FILE_DOCUMENT_MOBI:74,FILE_DOCUMENT_DOCM:75,FILE_DOCUMENT_DOTX:76,FILE_DOCUMENT_DOTM:77,FILE_DOCUMENT_ODT_FLAT:78,FILE_DOCUMENT_OTT:79,FILE_DOCUMENT_DOC_FLAT:80,FILE_DOCUMENT_OFORM:85,FILE_DOCUMENT_DOCXF:86,FILE_PRESENTATION:128,FILE_PRESENTATION_PPTX:129,FILE_PRESENTATION_PPT:130,FILE_PRESENTATION_ODP:131,FILE_PRESENTATION_PPSX:132,FILE_PRESENTATION_PPTM:133,FILE_PRESENTATION_PPSM:134,FILE_PRESENTATION_POTX:135,FILE_PRESENTATION_POTM:136,FILE_PRESENTATION_ODP_FLAT:137,FILE_PRESENTATION_OTP:138,FILE_SPREADSHEET:256,FILE_SPREADSHEET_XLSX:257,FILE_SPREADSHEET_XLS:258,FILE_SPREADSHEET_ODS:259,FILE_SPREADSHEET_CSV:260,FILE_SPREADSHEET_XLSM:261,FILE_SPREADSHEET_XLTX:262,FILE_SPREADSHEET_XLTM:263,FILE_SPREADSHEET_ODS_FLAT:264,FILE_SPREADSHEET_OTS:265,FILE_CROSSPLATFORM:512,FILE_CROSSPLATFORM_PDF:513,FILE_CROSSPLATFORM_SWF:514,FILE_CROSSPLATFORM_DJVU:515,FILE_CROSSPLATFORM_XPS:516,FILE_CROSSPLATFORM_PDFA:521},f.parseFileFormat=function(t){switch(t){case f.defines.FileFormat.FILE_DOCUMENT_DOC:return"doc";case f.defines.FileFormat.FILE_DOCUMENT_DOCX:return"docx";case f.defines.FileFormat.FILE_DOCUMENT_ODT:return"odt";case f.defines.FileFormat.FILE_DOCUMENT_RTF:return"rtf";case f.defines.FileFormat.FILE_DOCUMENT_TXT:return"txt";case f.defines.FileFormat.FILE_DOCUMENT_HTML:return"htm";case f.defines.FileFormat.FILE_DOCUMENT_MHT:return"mht";case f.defines.FileFormat.FILE_DOCUMENT_EPUB:return"epub";case f.defines.FileFormat.FILE_DOCUMENT_FB2:return"fb2";case f.defines.FileFormat.FILE_DOCUMENT_DOTX:return"dotx";case f.defines.FileFormat.FILE_DOCUMENT_OTT:return"ott";case f.defines.FileFormat.FILE_DOCUMENT_OFORM:return"oform";case f.defines.FileFormat.FILE_DOCUMENT_DOCXF:return"docxf";case f.defines.FileFormat.FILE_SPREADSHEET_XLS:return"xls";case f.defines.FileFormat.FILE_SPREADSHEET_XLTX:return"xltx";case f.defines.FileFormat.FILE_SPREADSHEET_XLSX:return"xlsx";case f.defines.FileFormat.FILE_SPREADSHEET_ODS:return"ods";case f.defines.FileFormat.FILE_SPREADSHEET_CSV:return"csv";case f.defines.FileFormat.FILE_SPREADSHEET_OTS:return"ots";case f.defines.FileFormat.FILE_PRESENTATION_PPT:return"ppt";case f.defines.FileFormat.FILE_PRESENTATION_POTX:return"potx";case f.defines.FileFormat.FILE_PRESENTATION_PPTX:return"pptx";case f.defines.FileFormat.FILE_PRESENTATION_ODP:return"odp";case f.defines.FileFormat.FILE_PRESENTATION_PPSX:return"ppsx";case f.defines.FileFormat.FILE_PRESENTATION_OTP:return"otp";case f.defines.FileFormat.FILE_CROSSPLATFORM_PDFA:case f.defines.FileFormat.FILE_CROSSPLATFORM_PDF:return"pdf";case f.defines.FileFormat.FILE_CROSSPLATFORM_DJVU:return"djvu";case f.defines.FileFormat.FILE_CROSSPLATFORM_XPS:return"xps"}return""},f.matchFileFormat=function(t){return window.PE?t>f.defines.FileFormat.FILE_PRESENTATION&&!(t>f.defines.FileFormat.FILE_SPREADSHEET):window.DE?t>f.defines.FileFormat.FILE_DOCUMENT&&!(t>f.defines.FileFormat.FILE_PRESENTATION)||t==f.defines.FileFormat.FILE_CROSSPLATFORM_PDF||t==f.defines.FileFormat.FILE_CROSSPLATFORM_PDFA||t==f.defines.FileFormat.FILE_CROSSPLATFORM_DJVU:window.SSE?t>f.defines.FileFormat.FILE_SPREADSHEET&&!(t>f.defines.FileFormat.FILE_CROSSPLATFORM)||t==f.defines.FileFormat.FILE_CROSSPLATFORM_XPS:!!window.PDFE&&(t==f.defines.FileFormat.FILE_CROSSPLATFORM_PDFA||t==f.defines.FileFormat.FILE_CROSSPLATFORM_PDF||t==f.defines.FileFormat.FILE_CROSSPLATFORM_DJVU||t==f.defines.FileFormat.FILE_CROSSPLATFORM_XPS)}}),define("text",["module"],function(t){"use strict";var o,s,a,l,n=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],i=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,r=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,c="undefined"!=typeof location&&location.href,d=c&&location.protocol&&location.protocol.replace(/\:/,""),h=c&&location.hostname,m=c&&(location.port||void 0),p={},u=t.config&&t.config()||{},g={version:"2.0.10",strip:function(t){var e;return t?(e=(t=t.replace(i,"")).match(r))&&(t=e[1]):t="",t},jsEscape:function(t){return t.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:u.createXhr||function(){var t,e,i;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(e=0;e<3;e+=1){i=n[e];try{t=new ActiveXObject(i)}catch(t){}if(t){n=[i];break}}return t},parseName:function(t){var e,i,n=!1,o=t.indexOf("."),s=0===t.indexOf("./")||0===t.indexOf("../");return-1!==o&&(!s||1<o)?(e=t.substring(0,o),i=t.substring(o+1,t.length)):e=t,-1!==(o=(s=i||e).indexOf("!"))&&(n="strip"===s.substring(o+1),s=s.substring(0,o),i?i=s:e=s),{moduleName:e,ext:i,strip:n}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(t,e,i,n){var o,s,t=g.xdRegExp.exec(t);return!t||(o=t[2],s=(t=(t=t[3]).split(":"))[1],t=t[0],!(o&&o!==e||t&&t.toLowerCase()!==i.toLowerCase()||(s||t)&&s!==n))},finishLoad:function(t,e,i,n){i=e?g.strip(i):i,u.isBuild&&(p[t]=i),n(i)},load:function(e,t,i,n){var o,s,a;n.isBuild&&!n.inlineText||(u.isBuild=n.isBuild,n=(o=g.parseName(e)).moduleName+(o.ext?"."+o.ext:""),s=t.toUrl(n),a=u.useXhr||g.useXhr,0===s.indexOf("empty:"))?i():!c||a(s,d,h,m)?g.get(s,function(t){g.finishLoad(e,o.strip,t,i)},function(t){i.error&&i.error(t)}):t([n],function(t){g.finishLoad(o.moduleName+"."+o.ext,o.strip,t,i)})},write:function(t,e,i,n){var o;p.hasOwnProperty(e)&&(o=g.jsEscape(p[e]),i.asModule(t+"!"+e,"define(function () { return '"+o+"';});\n"))},writeFile:function(i,t,e,n,o){var t=g.parseName(t),s=t.ext?"."+t.ext:"",a=t.moduleName+s,l=e.toUrl(t.moduleName+s)+".js";g.load(a,e,function(t){function e(t){return n(l,t)}e.asModule=function(t,e){return n.asModule(t,l,e)},g.write(i,a,e,o)},o)}};return"node"===u.env||!u.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]?(o=require.nodeRequire("fs"),g.get=function(t,e,i){try{var n=o.readFileSync(t,"utf8");e(n=0===n.indexOf("\ufeff")?n.substring(1):n)}catch(t){i(t)}}):"xhr"===u.env||!u.env&&g.createXhr()?g.get=function(i,n,o,t){var e,s=g.createXhr();if(s.open("GET",i,!0),t)for(e in t)t.hasOwnProperty(e)&&s.setRequestHeader(e.toLowerCase(),t[e]);u.onXhr&&u.onXhr(s,i),s.onreadystatechange=function(t){var e;4===s.readyState&&(399<(e=s.status)&&e<600?((e=new Error(i+" HTTP status: "+e)).xhr=s,o(e)):n(s.responseText),u.onXhrComplete&&u.onXhrComplete(s,i))},s.send(null)}:"rhino"===u.env||!u.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?g.get=function(t,e){var i,n,t=new java.io.File(t),o=java.lang.System.getProperty("line.separator"),s=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(t),"utf-8")),t="";try{for(i=new java.lang.StringBuffer,null!==(n=(n=s.readLine())&&n.length()&&65279===n.charAt(0)?n.substring(1):n)&&i.append(n);null!==(n=s.readLine());)i.append(o),i.append(n);t=String(i.toString())}finally{s.close()}e(t)}:("xpconnect"===u.env||!u.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(s=Components.classes,a=Components.interfaces,Components.utils.import("resource://gre/modules/FileUtils.jsm"),l="@mozilla.org/windows-registry-key;1"in s,g.get=function(e,t){var i,n,o={};l&&(e=e.replace(/\//g,"\\")),e=new FileUtils.File(e);try{(i=s["@mozilla.org/network/file-input-stream;1"].createInstance(a.nsIFileInputStream)).init(e,1,0,!1),(n=s["@mozilla.org/intl/converter-input-stream;1"].createInstance(a.nsIConverterInputStream)).init(i,"utf-8",i.available(),a.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),n.readString(i.available(),o),n.close(),i.close(),t(o.value)}catch(t){throw new Error((e&&e.path||"")+": "+t)}}),g}),define("text!common/main/lib/template/Header.template",[],function(){return'<div id="header-container">\n    <div id="header-logo"></div>\n    <div id="header-caption"><div><%= headerCaption %></div></div>\n    <div id="header-documentcaption"><div><%= documentCaption %></div></div>\n    <div id="header-back" style="display: <%= canBack ? \'table-cell\' : \'none\' %>;"><div><%= textBack %></div></div>\n</div>'}),void 0===Common&&(Common={}),define("common/main/lib/component/BaseView",["backbone"],function(t){"use strict";Common.UI=_.extend(Common.UI||{},{Keys:{BACKSPACE:8,TAB:9,RETURN:13,SHIFT:16,CTRL:17,ALT:18,ESC:27,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46,HOME:36,END:35,SPACE:32,PAGEUP:33,PAGEDOWN:34,INSERT:45,ZERO:48,EQUALITY_FF:61,NUM_ZERO:96,NUM_PLUS:107,NUM_MINUS:109,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,MINUS_FF:173,EQUALITY:187,MINUS:189},BaseView:t.View.extend({isSuspendEvents:!1,initialize:function(t){this.options=this.options?_({}).extend(this.options,t):t},setVisible:function(t){return this[t?"show":"hide"]()},isVisible:function(){return $(this.el).is(":visible")},suspendEvents:function(){this.isSuspendEvents=!0},resumeEvents:function(){this.isSuspendEvents=!1}}),getId:function(t){return _.uniqueId(t||"asc-gen")}})}),void 0===Common&&(Common={}),define("common/main/lib/component/CheckBox",["common/main/lib/component/BaseView","underscore"],function(t,e){"use strict";Common.UI.CheckBox=Common.UI.BaseView.extend({options:{labelText:""},disabled:!1,rendered:!1,indeterminate:!1,checked:!1,value:"unchecked",template:e.template('<label class="checkbox-indeterminate"><input id="<%= id %>" type="checkbox" class="checkbox__native"><label for="<%= id %>" class="checkbox__shape" data-hint="<%= dataHint %>" data-hint-direction="<%= dataHintDirection %>" data-hint-offset="<%= dataHintOffset %>"></label><span></span></label>'),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t),this.options.el&&this.render()},render:function(t){var e;return this.rendered||(e=this.template({id:Common.UI.getId("chb-"),dataHint:this.options.dataHint,dataHintDirection:this.options.dataHintDirection,dataHintOffset:this.options.dataHintOffset}),(t?(this.setElement(t,!1),t):this.$el).html(e),this.$chk=this.$el.find("input[type=checkbox]"),this.$label=this.$el.find("label.checkbox-indeterminate"),this.$span=this.$label.find("span"),this.$chk.on("click",this.onItemCheck.bind(this)),this.$label.on("keydown",this.onKeyDown.bind(this)),this.rendered=!0),this.options.disabled&&this.setDisabled(this.options.disabled),void 0!==this.options.value&&this.setValue(this.options.value,!0),this.setCaption(this.options.labelText),this},setDisabled:function(t){this.rendered&&((t=!0===t)!==this.disabled&&(this.$label.toggleClass("disabled",t),t?this.$chk.attr({disabled:t}):this.$chk.removeAttr("disabled"),void 0!==this.tabindex&&(t&&(this.tabindex=this.$label.attr("tabindex")),this.$label.attr("tabindex",t?"-1":this.tabindex))),this.disabled=t)},isDisabled:function(){return this.disabled},onItemCheck:function(t){this.disabled||(this.indeterminate?(this.indeterminate=!1,this.setValue(!1)):this.setValue(!this.checked))},setRawValue:function(t){this.checked=!0===t||"true"===t||"1"===t||1===t||"checked"===t,this.indeterminate="indeterminate"===t,this.value=this.indeterminate?"indeterminate":this.checked?"checked":"unchecked",this.$chk.prop({indeterminate:this.indeterminate,checked:this.checked})},setValue:function(t,e){this.rendered?t!=this.value&&(this.lastValue=this.value,this.setRawValue(t),!0!==e&&this.trigger("change",this,this.value,this.lastValue)):this.options.value=t},getValue:function(){return this.value},isChecked:function(){return this.checked},setCaption:function(t){this.$span.text(t),this.$span.css("visibility",t?"visible":"hidden")},onKeyDown:function(t){t.isDefaultPrevented()||t.keyCode===Common.UI.Keys.SPACE&&this.onItemCheck(t)},focus:function(){this.$label&&this.$label.focus()},setTabIndex:function(t){this.rendered&&(this.tabindex=t.toString(),this.disabled||this.$label.attr("tabindex",this.tabindex))}})}),void 0===Common&&(Common={}),void 0===Common.UI&&(Common.UI={}),Common.UI.FocusManager=new function(){function i(t){var e,i,n=t?1:-1;for(e in o)!o.hasOwnProperty(e)||(i=o[e])&&i.index<a-1&&i.traps&&i.traps[1].attr("tabindex",(parseInt(i.traps[1].attr("tabindex"))+n).toString())}function n(t,e,i){var n;if(t&&t.cid)return o[t.cid]?(n=o[t.cid].fields||[],i<0&&(i+=n.length),o[t.cid].fields=void 0===i?n.concat(l(e)):n.slice(0,i).concat(l(e)).concat(n.slice(i))):o[t.cid]={parent:t,fields:l(e),hidden:!1,index:a++},r(o[t.cid]),i||0}var s=1,o=[],a=0,l=function(t){var i=[];return(t=t.forEach?t:[t]).forEach(function(t){var e;t&&(e={},t.cmp&&"string"==typeof t.selector?e=t:(e.cmp=t,Common.UI.ListView&&t instanceof Common.UI.ListView?e.selector=".listview":t instanceof Common.UI.CheckBox?e.selector=".checkbox-indeterminate":t instanceof Common.UI.RadioBox?e.selector=".radiobox":t instanceof Common.UI.TreeView?e.selector=".treeview":t instanceof Common.UI.Button?e.selector="button":e.selector=".form-control"),e.el=(e.cmp.$el||$(e.cmp.el||e.cmp)).find(e.selector).addBack().filter(e.selector),e.el&&e.el.attr&&(e.cmp.setTabIndex?e.cmp.setTabIndex(s):e.el.attr("tabindex",s.toString())),i.push(e))}),i},r=function(o){var t,e;!o||o.traps||!o.fields||o.fields.length<1||((t=$('<span aria-hidden="true" tabindex="'+s+'"></span>')).on("focus",function(){if(!o.hidden)for(var t=o.fields,e=t.length-1;0<=e;e--){var i=t[e];if((i.cmp.isVisible?i.cmp.isVisible():i.cmp.is(":visible"))&&(!i.cmp.isDisabled||!i.cmp.isDisabled())){var n=i.selector?(i.cmp.$el||$(i.cmp.el||i.cmp)).find(i.selector).addBack().filter(i.selector):i.el;n&&setTimeout(function(){n.focus()},10);break}}}),o.parent.$window.prepend(t),(e=$('<span aria-hidden="true" tabindex="'+(s+1)+'"></span>')).on("focus",function(){if(!o.hidden)for(var t=o.fields,e=0;e<t.length;e++){var i=t[e];if((i.cmp.isVisible?i.cmp.isVisible():i.cmp.is(":visible"))&&(!i.cmp.isDisabled||!i.cmp.isDisabled())){var n=i.selector?(i.cmp.$el||$(i.cmp.el||i.cmp)).find(i.selector).addBack().filter(i.selector):i.el;n&&setTimeout(function(){n.focus()},10);break}}}),o.parent.$window.append(e),o.traps=[t,e])};return{init:function(){Common.NotificationCenter.on({"modal:show":function(t){t&&t.cid&&(o[t.cid]?o[t.cid].hidden=!1:(o[t.cid]={parent:t,hidden:!1,index:a++},i(!0)))},"window:show":function(t){t&&t.cid&&o[t.cid]&&!o[t.cid].fields&&(o[t.cid].fields=l(t.getFocusedComponents()),r(o[t.cid]));var e=t?t.getDefaultFocusableComponent():null;e&&setTimeout(function(){e.focus()},100)},"modal:close":function(t,e){t&&t.cid&&o[t.cid]&&(i(!1),delete o[t.cid],a--)},"modal:hide":function(t,e){t&&t.cid&&o[t.cid]&&(o[t.cid].hidden=!0)}})},add:function(t,e){n(t,e)},insert:n,remove:function(t,e,i){t&&t.cid&&o[t.cid]&&o[t.cid].fields&&void 0!==e&&((t=o[t.cid].fields.splice(e,i))&&t.forEach(function(t){t.el&&t.el.attr&&(t.cmp.setTabIndex?t.cmp.setTabIndex(-1):t.el.attr("tabindex","-1"))}))}}},define("common/main/lib/controller/FocusManager",function(){}),void 0===Common&&(Common={}),define("common/main/lib/component/Window",["common/main/lib/component/BaseView","common/main/lib/component/CheckBox","common/main/lib/controller/FocusManager"],function(){"use strict";function s(){var t=$(".modals-mask");return 0==t.length&&(t=$("<div class='modals-mask'>").appendTo(document.body).hide()).attr("counter",0),t}function e(t){if(!this.isLocked()&&this.isVisible()&&this.initConfig.enableKeyEvents&&!1!==this.pauseKeyEvents)switch(t.keyCode){case Common.UI.Keys.ESC:if($(".asc-loadmask").length<1)return t.preventDefault(),t.stopPropagation(),!1!==this.initConfig.closable&&(this.initConfig.toolcallback?this.initConfig.toolcallback.call(this):"hide"==this.initConfig.toolclose?this.hide():this.close()),!1;break;case Common.UI.Keys.RETURN:if(this.$window.find(".btn.primary").length&&$(".asc-loadmask").length<1&&!1===(this.initConfig.onprimary||this.onPrimary).call(this))return t.preventDefault(),!1}}function l(){var t,e=null==window.innerHeight?(t=document.documentElement.offsetWidth,document.documentElement.offsetHeight):(t=Common.Utils.innerWidth(),Common.Utils.innerHeight());return{width:t,height:e-=Common.Utils.InternalSettings.get("window-inactive-area-top"),top:Common.Utils.InternalSettings.get("window-inactive-area-top")}}function a(t){return{"-webkit-transition":"0.3s opacity","-moz-transition":"0.3s opacity","-ms-transition":"0.3s opacity","-o-transition":"0.3s opacity",opacity:t}}function i(t){var e,i;$(t.target).hasClass("close")||$(t.target).hasClass("help")||(Common.UI.Menu.Manager.hideAll(),e=t instanceof jQuery.Event?Common.Utils.zoom():1,this.dragging.enabled=!0,this.dragging.initx=t.pageX*e-this.getLeft(),this.dragging.inity=t.pageY*e-this.getTop(),e=(t=l()).width,i=t.height,this.dragging.maxx=e-this.getWidth(),this.dragging.maxy=i-this.getHeight(),this.dragging.maxy<0&&(this.dragging.maxy=0),this.dragging.maxy+=t.top,$(document).on("mousemove",this.binding.drag),$(document).on("mouseup",this.binding.dragStop),this.fireEvent("drag",[this,"start"]))}function n(){$(document).off("mousemove",this.binding.drag),$(document).off("mouseup",this.binding.dragStop),this.dragging.enabled=!1,this.fireEvent("drag",[this,"end"])}function r(t){var e,i;this.dragging.enabled&&(i=t instanceof jQuery.Event?Common.Utils.zoom():1,e=t.pageX*i-this.dragging.initx,t=t.pageY*i-this.dragging.inity,i=Common.Utils.InternalSettings.get("window-inactive-area-top"),e<0?e=0:e>this.dragging.maxx&&(e=this.dragging.maxx),t<i?t=i:t>this.dragging.maxy&&(t=this.dragging.maxy),this.$window.css({left:e,top:t}))}function c(t){"mouseup"==t.type&&this.dragging.enabled&&n.call(this)}function d(){var t=l(),e=t.width,t=t.height,i=this.getHeight(),n=this.getWidth(),o=this.getTop(),s=this.getLeft();this.$window.css({left:(s=e<s+n?e-n:s)<0?0:s,top:(o=t<o+i?t-i:o)<0?0:o})}function o(t){Common.UI.Menu.Manager.hideAll();var e=$(t.target),i=this.getLeft(),n=this.getTop(),t=(this.resizing.enabled=!0,this.resizing.initpage_x=t.pageX*Common.Utils.zoom(),this.resizing.initpage_y=t.pageY*Common.Utils.zoom(),this.resizing.initx=this.resizing.initpage_x-i,this.resizing.inity=this.resizing.initpage_y-n,this.resizing.initw=this.getWidth(),this.resizing.inith=this.getHeight(),this.resizing.type=[e.hasClass("left")?-1:e.hasClass("right")?1:0,e.hasClass("top")?-1:e.hasClass("bottom")?1:0],l()),o=t.width,t=t.height,s=this.initConfig.maxwidth||o,a=this.initConfig.maxheight||t;this.resizing.minw=this.initConfig.minwidth,this.resizing.maxw=0<this.resizing.type[0]?Math.min(o-i,s):Math.min(i+this.resizing.initw,s),this.resizing.minh=this.initConfig.minheight,this.resizing.maxh=0<this.resizing.type[1]?Math.min(t-n,a):Math.min(n+this.resizing.inith,a),$(document.body).css("cursor",e.css("cursor")),this.$window.find(".resize-border").addClass("resizing"),this.$window.find(".header").addClass("resizing"),$(document).on("mousemove",this.binding.resize),$(document).on("mouseup",this.binding.resizeStop),this.fireEvent("resize",[this,"start"])}function h(t){var e,i,n;this.resizing.enabled&&(e=!1,i=t instanceof jQuery.Event?Common.Utils.zoom():1,n=t.pageX*i,t=t.pageY*i,this.resizing.type[0]&&((i=this.resizing.initw+(n-this.resizing.initpage_x)*this.resizing.type[0])>this.resizing.maxw?(n-=(i-this.resizing.maxw)*this.resizing.type[0],i=this.resizing.maxw):i<this.resizing.minw&&(n-=(i-this.resizing.minw)*this.resizing.type[0],i=this.resizing.minw),this.resizing.type[0]<0&&this.$window.css({left:n-this.resizing.initx}),this.setWidth(i),e=!0),this.resizing.type[1]&&((n=this.resizing.inith+(t-this.resizing.initpage_y)*this.resizing.type[1])>this.resizing.maxh?(t-=(n-this.resizing.maxh)*this.resizing.type[1],n=this.resizing.maxh):n<this.resizing.minh&&(t-=(n-this.resizing.minh)*this.resizing.type[1],n=this.resizing.minh),this.resizing.type[1]<0&&this.$window.css({top:t-this.resizing.inity}),this.setHeight(n),e=!0),e&&this.fireEvent("resizing"))}function m(){$(document).off("mousemove",this.binding.resize),$(document).off("mouseup",this.binding.resizeStop),$(document.body).css("cursor","auto"),this.$window.find(".resize-border").removeClass("resizing"),this.$window.find(".header").removeClass("resizing"),this.resizing.enabled=!1,this.fireEvent("resize",[this,"end"])}var t;Common.UI.Window=Common.UI.BaseView.extend(_.extend((t={closable:!0,header:!0,modal:!0,width:"auto",height:"auto",title:"Title",alias:"Window",cls:"",toolclose:"close",help:!1,maxwidth:void 0,maxheight:void 0,minwidth:0,minheight:0,enableKeyEvents:!0,automove:!0},Common.UI.alert=function(h){this.Window.prototype;h.buttons||(h.buttons=["ok"]),h.dontshow=h.dontshow||!1,h.width||(h.width="auto");var t='<div class="info-box"><% if (typeof iconCls !== "undefined") { %><div class="icon <%= iconCls %>"></div><% } %><div class="text" <% if (typeof iconCls == "undefined") { %> style="padding-'+(Common.UI.isRTL()?"right":"left")+':10px;"<% } %>><span><%= msg %></span><% if (dontshow) { %><div class="dont-show-checkbox"></div><% } %></div></div><% if (dontshow) { %><div class="separator horizontal" style="width: 100%;"></div><% } %>',m=(_.extend(h,{cls:"alert",onprimary:function(t){return u({currentTarget:m.getChild(".footer .dlg-btn")[0]}),!1},tpl:_.template(t)(h)}),new Common.UI.Window(h)),p=null;function u(t){h.callback&&h.callback.call(m,t.currentTarget.attributes.result.value,!!p&&"checked"==p.getValue()),m.close(!0)}return m.on({"render:after":function(t){var e,i,n,o,s,a,l,r,c,d=t.getChild(".footer");h.dontshow&&d.addClass("dontshow"),d.find(".dlg-btn").on("click",u),p=new Common.UI.CheckBox({el:m.$window.find(".dont-show-checkbox"),labelText:h.textDontShow||m.textDontShow}),t=(d=t).getChild(".info-box"),n=d.getChild(".info-box .text > span"),o=d.getChild(".footer"),s=d.getChild(".header"),a=d.getChild(".body"),l=0<(r=d.getChild(".icon")).length?r.height():0,r=0<r.length?$(r).outerWidth(!0):0,c=d.getChild(".info-box .dont-show-checkbox"),h.dontshow||a.css("padding-bottom","10px"),h.maxwidth&&"auto"==h.width&&(i=Common.UI.isRTL()?parseInt(t.css("padding-right"))+r+n.width()+parseInt(t.css("padding-left")):n.position().left+n.width()+parseInt(t.css("padding-right")))>h.maxwidth&&(h.width=h.maxwidth),"auto"==h.width?(t.height(Math.max(n.height(),l)+(0<c.length?c.height()+parseInt(c.css("margin-top")):0)),a.height(parseInt(t.css("height"))+parseInt(o.css("height"))),e=c.find("span"),i=Common.UI.isRTL()?parseInt(t.css("padding-right"))+r+parseInt(t.css("padding-left"))+Math.max(n.width(),0<c.length?$(c).find(".checkbox-indeterminate").outerWidth(!0):0):Math.max(n.width(),0<e.length?e.position().left+e.width():0)+n.position().left+parseInt(t.css("padding-right")),d.setSize(i,parseInt(a.css("height"))+parseInt(s.css("height")))):(n.css("white-space","normal"),d.setWidth(h.width),t.height(Math.max(n.height(),l)+(0<c.length?c.height()+parseInt(c.css("margin-top")):0)),a.height(parseInt(t.css("height"))+parseInt(o.css("height"))),d.setHeight(parseInt(a.css("height"))+parseInt(s.css("height")))),n.height()<l/2&&n.css({"vertical-align":"baseline","line-height":l+"px"})},show:function(t){t.getChild(".footer .dlg-btn").focus()},close:function(){h.callback&&h.callback.call(m,"close")}}),m.show(),m},Common.UI.error=function(t){return(t=t||{}).title||(t.title=this.Window.prototype.textError),Common.UI.alert(_.extend(t,{iconCls:"error"}))},Common.UI.confirm=function(t){return(t=t||{}).title||(t.title=this.Window.prototype.textConfirmation),Common.UI.alert(_.extend(t,{iconCls:"confirm"}))},Common.UI.info=function(t){return(t=t||{}).title||(t.title=this.Window.prototype.textInformation),Common.UI.alert(_.extend(t,{iconCls:"info"}))},{$window:void 0,$lastmodal:void 0,dragging:{enabled:!(Common.UI.warning=function(t){return(t=t||{}).title||(t.title=this.Window.prototype.textWarning),Common.UI.alert(_.extend(t,{iconCls:"warn"}))})},resizing:{enabled:!1},initialize:function(e){this.initConfig={},this.binding={};var i,n={ok:this.okButtonText,cancel:this.cancelButtonText,yes:this.yesButtonText,no:this.noButtonText,close:this.closeButtonText};e.buttons&&_.isArray(e.buttons)&&(null==e.primary&&(e.primary="ok"),i={},_.each(e.buttons,function(t){"object"==typeof t?void 0!==t.value&&(i[t.value]={text:t.caption,cls:"custom"+(t.primary||e.primary==t.value?" primary":"")}):void 0!==t&&(i[t]={text:"custom"==t?e.customButtonText:n[t],cls:e.primary==t||-1<_.indexOf(e.primary,t)?"primary":""},"custom"==t&&(i[t].cls+=" custom"))}),e.buttons=i,e.footerCls=e.footerCls||"center"),_.extend(this.initConfig,t,e||{}),this.initConfig.id||(this.initConfig.id="window-"+this.cid),this.initConfig.tpl||(this.initConfig.tpl=""),Common.UI.BaseView.prototype.initialize.call(this,this.initConfig)},render:function(){var t=this.initConfig.renderTo||document.body,o=($(t).append(_.template('<div class="asc-window<%= modal?" modal":"" %><%= cls?" "+cls:"" %>" id="<%= id %>" style="width:<%= width %>px;"><% if (header==true) { %><div class="header"><div class="tools"><% if (closable!==false) %><div class="tool close"></div><% %><% if (help===true) %><div class="tool help">?</div><% %></div><div class="title"><%= title %></div> </div><% } %><div class="body"><%= tpl %><% if (typeof (buttons) !== "undefined" && _.size(buttons) > 0) { %><div class="footer"><% for(var bt in buttons) { %><button class="btn normal dlg-btn <%= buttons[bt].cls %>" result="<%= bt %>"><%= buttons[bt].text %></button><% } %></div><% } %></div></div>')(this.initConfig)),this.$window=$("#"+this.initConfig.id),Common.Locale.getCurrentLanguage()&&"en"!==Common.Locale.getCurrentLanguage()&&this.$window.attr("applang",Common.Locale.getCurrentLanguage()),this.binding.keydown=_.bind(e,this),this.initConfig.header?(this.binding.drag=_.bind(r,this),this.binding.dragStop=_.bind(n,this),this.binding.dragStart=_.bind(i,this),this.$window.find(".header").on("mousedown",this.binding.dragStart),this.$window.find(".tool.close").on("click",_.bind(function(){this.$window.find(".tool.close").hasClass("disabled")||(this.initConfig.toolcallback?this.initConfig.toolcallback.call(this):"hide"==this.initConfig.toolclose?this.hide():this.close())},this)),this.$window.find(".tool.help").on("click",_.bind(function(){this.$window.find(".tool.help").hasClass("disabled")||this.fireEvent("help",this)},this)),this.initConfig.modal||Common.Gateway.on("processmouse",_.bind(c,this))):this.$window.find(".body").css({top:0,"border-radius":"5px"}),"auto"!==this.initConfig.height&&this.$window.css("height",this.initConfig.height),this.initConfig.resizable&&this.setResizable(this.initConfig.resizable),this);return this.binding.winclose=function(t){o.$window&&o.isVisible()&&o.$window==t.$window&&o.close()},Common.NotificationCenter.on("window:close",this.binding.winclose),this.initConfig.footerCls&&this.$window.find(".footer").addClass(this.initConfig.footerCls),this.menuAddAlign=function(t,e,i){var n=this;o.$window.hasClass("notransform")?(t.css({left:e,top:i}),n.options.additionalAlign=null):(o.$window.addClass("notransform"),t.addClass("hidden"),setTimeout(function(){t.removeClass("hidden"),t.css({left:e,top:i}),n.options.additionalAlign=null},300))},this.fireEvent("render:after",this),this},show:function(t,e){this.initConfig.modal&&(i=s(),!1===this.options.animate||this.options.animate&&!1===this.options.animate.mask?(i.attr("counter",parseInt(i.attr("counter"))+1),i.show()):(n=$(":root").css("--modal-window-mask-opacity"),i.css("opacity",0),i.attr("counter",parseInt(i.attr("counter"))+1),i.show(),setTimeout(function(){i.css(a(n))},1)),Common.NotificationCenter.trigger("modal:show",this),this.$lastmodal=$(".asc-window.modal:not(.dethrone):visible").first().addClass("dethrone")),this.$window?this.$window.is(":visible")||(this.$window.css({opacity:0}),function(){var t=l(),e=t.width,i=t.height;this.getLeft()+this.getWidth()>e&&this.$window.css("left",e-this.getWidth()),this.getTop()<t.top?this.$window.css("top",t.top):this.getTop()+this.getHeight()>i&&(i-this.getHeight()<0?this.$window.css("top",t.top):this.$window.css("top",t.top+i-this.getHeight()))}.call(this),this.$window.show()):(this.render(),function(){var t;"auto"==this.initConfig.height&&(t=Math.ceil(parseFloat(this.$window.find("> .body").css("height"))),this.initConfig.header&&(t+=parseInt(this.$window.find("> .header").css("height"))),this.$window.height(t))}.call(this),_.isNumber(t)&&_.isNumber(e)?(this.$window.css("left",Math.floor(t)),this.$window.css("top",Math.floor(e))):function(){var t,e=(o=l()).width,i=o.height,n=("auto"==this.initConfig.height?(t=parseInt(this.$window.find(".body").css("height")),this.initConfig.header&&(t+=parseInt(this.$window.find(".header").css("height")))):i<(t=this.initConfig.height)&&(t=i),"auto"==this.initConfig.width?parseInt(this.$window.find(".body").css("width")):this.initConfig.width),o=o.top+Math.floor((parseInt(i)-parseInt(t))/2),i=Math.floor((parseInt(e)-parseInt(n))/2);this.$window.css({left:i<0?0:i,top:o<0?0:o})}.call(this)),$(document).on("keydown."+this.cid,this.binding.keydown),this.initConfig.automove&&(this.binding.windowresize=_.bind(d,this),$(window).on("resize",this.binding.windowresize));var i,n,o=this;setTimeout(function(){o.fireEvent("animate:before",o)},10),!1!==this.options.animate?(this.$window.css({"-webkit-transform":"scale(0.8)","-moz-transform":"scale(0.8)","-ms-transform":"scale(0.8)","-o-transform":"scale(0.8)",opacity:0}),setTimeout(function(){o.$window.css({"-webkit-transition":"0.2s opacity, 0.2s -webkit-transform","-webkit-transform":"scale(1)","-moz-transition":"0.2s opacity, 0.2s -moz-transform","-moz-transform":"scale(1)","-ms-transition":"0.2s opacity, 0.2s -ms-transform","-ms-transform":"scale(1)","-o-transition":"0.2s opacity, 0.2s -o-transform","-o-transform":"scale(1)",opacity:"1"}),setTimeout(function(){o.fireEvent("animate:after",o)},210)},1),setTimeout(function(){o.$window.addClass("notransform"),o.fireEvent("show",o)},this.initConfig.modal?1e3:350)):(this.$window.css({opacity:1}),this.$window.addClass("notransform"),this.fireEvent("show",this),setTimeout(function(){o.fireEvent("animate:after",o)},10)),Common.NotificationCenter.trigger("window:show",this)},close:function(t){var e,i,n;$(document).off("keydown."+this.cid),this.initConfig.automove&&$(window).off("resize",this.binding.windowresize),this.initConfig.header&&this.$window.find(".header").off("mousedown",this.binding.dragStart),Common.NotificationCenter.off({"window:close":this.binding.winclose}),this.initConfig.modal&&(i=!0,(e=s()).attr("counter",parseInt(e.attr("counter"))-1),0<this.$lastmodal.length&&(this.$lastmodal.removeClass("dethrone"),i=!(this.$lastmodal.hasClass("modal")&&this.$lastmodal.is(":visible"))),i&&(!1!==this.options.animate?(n=$(":root").css("--modal-window-mask-opacity"),e.css(a(0)),setTimeout(function(){parseInt(e.attr("counter"))<1&&(e.css("opacity",n),e.hide(),e.attr("counter",0))},300)):parseInt(e.attr("counter"))<1&&(e.hide(),e.attr("counter",0))),Common.NotificationCenter.trigger("modal:close",this,i&&parseInt(e.attr("counter"))<1)),this.$window.remove(),!0!==t&&this.fireEvent("close",this)},hide:function(){var t,e,i;$(document).off("keydown."+this.cid),this.initConfig.automove&&$(window).off("resize",this.binding.windowresize),this.$window&&(this.initConfig.modal&&(e=!0,(t=s()).attr("counter",parseInt(t.attr("counter"))-1),0<this.$lastmodal.length&&(this.$lastmodal.removeClass("dethrone"),e=!(this.$lastmodal.hasClass("modal")&&this.$lastmodal.is(":visible"))),e&&(!1!==this.options.animate?(i=$(":root").css("--modal-window-mask-opacity"),t.css(a(0)),setTimeout(function(){parseInt(t.attr("counter"))<1&&(t.css("opacity",i),t.hide(),t.attr("counter",0))},300)):parseInt(t.attr("counter"))<1&&(t.hide(),t.attr("counter",0))),Common.NotificationCenter.trigger("modal:hide",this,e&&parseInt(t.attr("counter"))<1)),this.$window.hide(),this.$window.removeClass("notransform"),this.fireEvent("hide",this))},isLocked:function(){return this.$window.hasClass("dethrone")||!this.initConfig.modal&&this.$window.parent().find(".asc-window.modal:visible").length},getChild:function(t){return t?this.$window.find(t):this.$window},setWidth:function(t){var e;0<=t&&(t<(e=parseInt(this.$window.css("min-width")))&&(t=e),t-=parseInt(this.$window.css("border-left-width"))+parseInt(this.$window.css("border-right-width")),this.$window.width(t))},getWidth:function(){return parseInt(this.$window.css("width"))},setHeight:function(t){var e;0<=t&&(t<(e=parseInt(this.$window.css("min-height")))&&(t=e),t-=parseInt(this.$window.css("border-bottom-width"))+parseInt(this.$window.css("border-top-width")),this.$window.height(t),this.initConfig.header&&(t-=parseInt(this.$window.find("> .header").css("height"))),this.$window.find("> .body").css("height",t))},getHeight:function(){return parseInt(this.$window.css("height"))},setSize:function(t,e){this.setWidth(t),this.setHeight(e)},getSize:function(){return[this.getWidth(),this.getHeight()]},setTitle:function(t){this.$window.find("> .header > .title").text(t)},getTitle:function(){return this.$window.find("> .header > .title").text()},getLeft:function(){return parseInt(this.$window.css("left"))},getTop:function(){return parseInt(this.$window.css("top"))},isVisible:function(){return this.$window&&this.$window.is(":visible")},setResizable:function(t,e,i){var n;t!==this.resizable?(t?(n='<div class="resize-border left" style="top:'+(this.initConfig.header?"33":"5")+'px; bottom: 5px; height: auto; border-right-style: solid; cursor: w-resize;"></div><div class="resize-border left bottom" style="border-bottom-left-radius: 5px; cursor: sw-resize;"></div><div class="resize-border bottom" style="left: 4px; right: 4px; width: auto; z-index: 2; border-top-style: solid; cursor: s-resize;"></div><div class="resize-border right bottom" style="border-bottom-right-radius: 5px; cursor: se-resize;"></div><div class="resize-border right" style="top:'+(this.initConfig.header?"33":"5")+'px; bottom: 5px; height: auto; border-left-style: solid; cursor: e-resize;"></div><div class="resize-border left top" style="border-top-left-radius: 5px; cursor: nw-resize;"></div><div class="resize-border top" style="left: 4px; right: 4px; width: auto; z-index: 2; border-bottom-style:'+(this.initConfig.header?"none":"solid")+'; cursor: n-resize;"></div><div class="resize-border right top" style="border-top-right-radius: 5px; cursor: ne-resize;"></div>',this.initConfig.header&&(n+='<div class="resize-border left" style="top: 5px; height: 28px; cursor: w-resize;"></div><div class="resize-border right" style="top: 5px; height: 28px; cursor: e-resize;"></div>'),this.$window.append(_.template(n)),this.binding.resize=_.bind(h,this),this.binding.resizeStop=_.bind(m,this),this.binding.resizeStart=_.bind(o,this),e&&1<e.length&&(this.initConfig.minwidth=e[0]),e&&1<e.length&&(this.initConfig.minheight=e[1]),i&&1<i.length&&(this.initConfig.maxwidth=i[0]),i&&1<i.length&&(this.initConfig.maxheight=i[1]),this.$window.find(".resize-border").on("mousedown",this.binding.resizeStart)):this.$window.find(".resize-border").remove(),this.resizable=t):t&&(e&&1<e.length&&(this.initConfig.minwidth=e[0]),e&&1<e.length&&(this.initConfig.minheight=e[1]),i&&1<i.length&&(this.initConfig.maxwidth=i[0]),i&&1<i.length&&(this.initConfig.maxheight=i[1]))},suspendKeyEvents:function(){this.pauseKeyEvents=!1},resumeKeyEvents:function(){this.initConfig.enableKeyEvents&&(this.pauseKeyEvents=!0)},onPrimary:function(){},getFocusedComponents:function(){return[]},getDefaultFocusableComponent:function(){},getFooterButtons:function(){var i;return this.footerButtons||(i=[],this.$window.find(".dlg-btn").each(function(t,e){i.push(new Common.UI.Button({el:$(e)}))}),this.footerButtons=i),this.footerButtons},cancelButtonText:"Cancel",okButtonText:"OK",yesButtonText:"Yes",noButtonText:"No",closeButtonText:"Close",textWarning:"Warning",textError:"Error",textConfirmation:"Confirmation",textInformation:"Information",textDontShow:"Don't show this message again"}),Common.UI.Window||{}))}),define("common/main/lib/view/RenameDialog",["common/main/lib/component/Window"],function(){"use strict";Common.Views.RenameDialog=Common.UI.Window.extend(_.extend({options:{width:330,header:!1,cls:"modal-dlg",filename:"",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,t||{}),this.template=['<div class="box">','<div class="input-row">',"<label>"+this.textName+"</label>","</div>",'<div id="id-dlg-newname" class="input-row"></div>',"</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var e=this,t=(e.inputName=new Common.UI.InputField({el:$("#id-dlg-newname"),style:"width: 100%;",validateOnBlur:!1,maxLength:e.options.maxLength,validation:function(t){return!/[\t*\+:\"<>?|\\\\/]/gim.test(t)||e.txtInvalidName+'*+:"<>?|/'}}),this.getChild());t.find(".btn").on("click",_.bind(this.onBtnClick,this)),e.inputNameEl=t.find("input")},show:function(){Common.UI.Window.prototype.show.apply(this,arguments);var t=this,e=t.options.filename.lastIndexOf(".");0<e&&(t.options.filename=t.options.filename.substring(0,e)),_.delay(function(){t.inputName.setValue(t.options.filename),t.inputNameEl.focus().select()},100)},onPrimary:function(t){return this._handleInput("ok"),!1},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},_handleInput:function(t){if(this.options.handler){if("ok"==t&&!0!==this.inputName.checkValidate())return void this.inputNameEl.focus();this.options.handler.call(this,t,this.inputName.getValue())}this.close()}},Common.Views.RenameDialog||{}))}),void 0===Common&&(Common={}),Common.Views=Common.Views||{},define("common/main/lib/view/Header",["backbone","text!common/main/lib/template/Header.template","core","common/main/lib/view/RenameDialog"],function(t,e){"use strict";Common.Views.Header=t.View.extend(_.extend(function(){var n,o,s,l,r,c=!1,d=!!window.PDFE;_.template("<ul><% for (originalId in users) { %><%= usertpl({user: users[originalId][0], fnEncode: fnEncode, len: users[originalId].length}) %><% } %></ul>");function i(){c=!0,this.btnShare&&this.btnShare.setVisible(!1),a(n)}function a(t){var e,i,n,o,s;r&&t&&(e=r.parent(),t.isEdit?t.customization&&t.customization.compactHeader||(n=e.position().left,o=e.next().outerWidth(),s=r.outerWidth(),.1<(i=(i=r[0].style.width)?parseFloat(i):s)-s?(e.css("padding-left",n<o?Math.max(2,e.outerWidth()-2-i):2),e.css("padding-right",n<o?2:Math.max(2,e.outerWidth()-2-i))):(e.css("padding-left",n<o?Math.max(2,Math.min(o-n+2,e.outerWidth()-2-i)):2),e.css("padding-right",n<o?2:Math.max(2,Math.min(n-o+2,e.outerWidth()-2-i))))):(n=e.position().left,o=e.next().outerWidth(),e.css("padding-left",n<o?Math.max(2,o-n):2),e.css("padding-right",n<o?2:Math.max(2,n-o))),t.customization&&t.customization.toolbarHideFileName||!(!t.isEdit||t.customization&&t.customization.compactHeader)||(s=parseFloat(e.css("padding-left")||0)+parseFloat(e.css("padding-right")||0)+parseInt(r.css("min-width")||50),t.isCrypted&&(s+=20),e.css("flex-basis",Math.ceil(s)+"px"),e.closest(".extra.right").css("flex-basis",Math.ceil(s)+e.next().outerWidth()+"px"),Common.NotificationCenter.trigger("tab:resize")))}function h(t){var e=this;t=t||n,e.btnPDFMode&&t&&(e.btnPDFMode.setIconCls("toolbar__icon icon--inverse "+(t.isPDFEdit?"btn-edit":t.isPDFAnnotate?"btn-menu-comments":"btn-sheet-view")),e.btnPDFMode.setCaption(t.isPDFEdit?e.textEdit:t.isPDFAnnotate?e.textComment:e.textView),e.btnPDFMode.updateHint(t.isPDFEdit?e.tipEdit:t.isPDFAnnotate?e.tipComment:e.tipView))}function m(){!n||!n.isEdit||n.customization&&n.customization.compactHeader||a(n)}function p(t){r&&(t.isCrypted&&(r.before('<div class="inner-box-icon crypted hidden"><svg class="icon"><use xlink:href="#svg-icon-crypted"></use></svg></div>'),this.imgCrypted=r.parent().find(".crypted"),this._showImgCrypted=!0),a(t))}function u(t){n=t;var e,i=this;i.btnGoBack.on("click",function(t){Common.NotificationCenter.trigger("goback")}),i.btnFavorite.on("click",function(t){Common.NotificationCenter.trigger("markfavorite",!i.options.favorite)}),i.btnShare&&(i.btnShare.on("click",function(t){Common.NotificationCenter.trigger("collaboration:sharing")}),i.btnShare.updateHint(i.tipAccessRights),i.btnShare.setVisible(!c&&n&&(n.sharingSettingsUrl&&n.sharingSettingsUrl.length||n.canRequestSharingSettings)),a(n)),n.user.guest&&n.canRenameAnonymous&&i.btnUserName&&i.btnUserName.on("click",function(t){Common.NotificationCenter.trigger("user:rename")}),i.btnPrint&&(i.btnPrint.updateHint(i.tipPrint+Common.Utils.String.platformKey("Ctrl+P")),i.btnPrint.on("click",function(t){i.fireEvent("print",i)})),i.btnPrintQuick&&(i.btnPrintQuick.updateHint(i.tipPrintQuick),i.btnPrintQuick.on("click",function(t){i.fireEvent("print-quick",i)})),i.btnSave&&(i.btnSave.updateHint(i.tipSave+(d?"":Common.Utils.String.platformKey("Ctrl+S"))),i.btnSave.on("click",function(t){i.fireEvent("save",i)})),i.btnUndo&&(i.btnUndo.updateHint(i.tipUndo+Common.Utils.String.platformKey("Ctrl+Z")),i.btnUndo.on("click",function(t){i.fireEvent("undo",i)})),i.btnRedo&&(i.btnRedo.updateHint(i.tipRedo+Common.Utils.String.platformKey("Ctrl+Y")),i.btnRedo.on("click",function(t){i.fireEvent("redo",i)})),i.btnDownload&&(i.btnDownload.updateHint(i.tipDownload),i.btnDownload.on("click",function(t){i.fireEvent("download")})),t.isEdit||(i.btnDownload&&(i.btnDownload.updateHint(i.tipDownload),i.btnDownload.on("click",function(t){i.fireEvent("downloadas",["original"])})),i.btnEdit&&(i.btnEdit.updateHint(i.tipGoEdit),i.btnEdit.on("click",function(t){i.fireEvent("go:editor",i)}))),i.btnSearch&&i.btnSearch.updateHint(i.tipSearch+Common.Utils.String.platformKey("Ctrl+F")),i.btnPDFMode&&(t=_.template('<a id="<%= id %>" tabindex="-1" type="menuitem"><div><% if (!_.isEmpty(iconCls)) { %><span class="menu-item-icon <%= iconCls %>"></span><% } %><b><%= caption %></b></div><% if (options.description !== null) { %><label class="margin-left-10 description"><%= options.description %></label><% } %></a>'),e=[],n.canPDFEdit&&e.push({caption:i.textEdit,iconCls:"menu__icon btn-edit",template:t,description:i.textEditDesc,value:"edit"}),e.push({caption:i.textComment,iconCls:"menu__icon btn-menu-comments",template:t,description:i.textCommentDesc,value:"comment",disabled:!n.canPDFAnnotate}),e.push({caption:i.textView,iconCls:"menu__icon btn-sheet-view",template:t,description:i.textViewDesc,value:"view"}),i.btnPDFMode.setMenu(new Common.UI.Menu({cls:"ppm-toolbar",style:"width: 220px;",menuAlign:"tr-br",items:e})),i.btnPDFMode.menu.on("item:click",function(t,e){Common.NotificationCenter.trigger("pdf:mode",e.value,_.bind(h,i))})),!n.isEdit||n.customization&&n.customization.compactHeader||Common.NotificationCenter.on("window:resize",m)}return{options:{branding:{},documentCaption:"",canBack:!1,wopi:!1},el:"#header",template:_.template(e),events:{},initialize:function(t){var e=this;this.options=this.options?_.extend(this.options,t):t,this.documentCaption=this.options.documentCaption,this.branding=this.options.customization,this.isModified=!1,e.btnGoBack=new Common.UI.Button({id:"btn-go-back",cls:"btn-header",iconCls:"toolbar__icon icon--inverse btn-goback",dataHint:"0",dataHintDirection:"bottom",dataHintOffset:"big"}),e.btnSearch=new Common.UI.Button({cls:"btn-header no-caret",iconCls:"toolbar__icon icon--inverse btn-menu-search",enableToggle:!0,dataHint:"0",dataHintDirection:"bottom",dataHintOffset:"big"}),e.btnFavorite=new Common.UI.Button({id:"id-btn-favorite",cls:"btn-header",iconCls:"toolbar__icon icon--inverse btn-favorite",dataHint:"0",dataHintDirection:"bottom",dataHintOffset:"big"}),Common.NotificationCenter.on({"app:ready":function(t){Common.Utils.asyncCall(u,e,t)},"app:face":function(t){Common.Utils.asyncCall(p,e,t)},"tab:visible":function(){Common.Utils.asyncCall(a,e,n)},"collaboration:sharingdeny":function(t){Common.Utils.asyncCall(i,e,t)}}),Common.NotificationCenter.on("uitheme:changed",this.changeLogo.bind(this))},render:function(t,e){return $(t).html(this.getPanel(e)),this},getPanel:function(t,a){var e,i=this;function n(t,e,i,n,o,s){return new Common.UI.Button({cls:"btn-header",iconCls:t,disabled:!0===i,dataHint:"0",dataHintDirection:n||(a.isDesktopApp?"right":"left"),dataHintOffset:o||(a.isDesktopApp?"10, -18":"10, 10"),dataHintTitle:s}).render(e)}return"left"!=t||a&&a.isDesktopApp?"right"==t?(e=$(_.template('<section><section id="box-doc-name"><input id="rib-doc-name" autofill="off" autocomplete="off"/></input></section><section style="display: inherit;"><div class="hedset"><div class="btn-slot" id="slot-hbtn-edit"></div><div class="btn-slot" id="slot-hbtn-print"></div><div class="btn-slot" id="slot-hbtn-print-quick"></div><div class="btn-slot" id="slot-hbtn-download"></div></div><div class="hedset" data-layout-name="header-users"><section id="tlb-box-users" class="box-cousers dropdown"><div class="btn-users dropdown-toggle" data-toggle="dropdown" data-hint="0" data-hint-direction="bottom" data-hint-offset="big"><div class="inner-box-icon"><svg class=""><use xlink:href="#svg-icon-users"></use></svg></div><label class="caption"></label></div><div class="cousers-menu dropdown-menu"><label id="tlb-users-menu-descr"><%= tipUsers %></label><div class="cousers-list"></div></div></section></div><div class="hedset"><div class="btn-slot" id="slot-btn-share"></div></div><div class="hedset"><div class="btn-slot" id="slot-btn-pdf-mode"></div></div><div class="hedset"><div class="btn-slot" id="slot-btn-mode"></div><div class="btn-slot" id="slot-btn-back"></div><div class="btn-slot" id="slot-btn-favorite"></div><div class="btn-slot" id="slot-btn-search"></div></div></section></section>')({tipUsers:this.labelCoUsersDescr,textShare:this.textShare})),r?e.find("#rib-doc-name").hide():(r=e.find("#rib-doc-name"),i.documentCaption&&setTimeout(function(){i.setDocTitle(i.documentCaption)},50)),this.setCanRename(!!this.options.canRename),!0===this.options.canBack?i.btnGoBack.render(e.find("#slot-btn-back")):e.find("#slot-btn-back").hide(),void 0!==this.options.favorite&&null!==this.options.favorite?(i.btnFavorite.render(e.find("#slot-btn-favorite")),i.btnFavorite.changeIcon(i.options.favorite?{next:"btn-in-favorite",curr:"btn-favorite"}:{next:"btn-favorite",curr:"btn-in-favorite"}),i.btnFavorite.updateHint(i.options.favorite?i.textRemoveFavorite:i.textAddFavorite)):e.find("#slot-btn-favorite").hide(),a.isEdit||(!a.canDownload&&!a.canDownloadOrigin||a.isOffline||(this.btnDownload=n("toolbar__icon icon--inverse btn-download",e.findById("#slot-hbtn-download"),void 0,"bottom","big")),a.canPrint&&(this.btnPrint=n("toolbar__icon icon--inverse btn-print",e.findById("#slot-hbtn-print"),void 0,"bottom","big","P")),a.canQuickPrint&&(this.btnPrintQuick=n("toolbar__icon icon--inverse btn-quick-print",e.findById("#slot-hbtn-print-quick"),void 0,"bottom","big","Q")),a.canEdit&&a.canRequestEditRights&&!d&&(this.btnEdit=n("toolbar__icon icon--inverse btn-edit",e.findById("#slot-hbtn-edit"),void 0,"bottom","big"))),i.btnSearch.render(e.find("#slot-btn-search")),(!a.isEdit||a.customization&&a.customization.compactHeader)&&((a.user.guest&&a.canRenameAnonymous?(i.btnUserName=new Common.UI.Button({el:e.findById(".slot-btn-user-name"),cls:"btn-header",dataHint:"0",dataHintDirection:"bottom",dataHintOffset:"big",visible:!0}),i.btnUserName.cmpEl):(i.elUserName=e.find(".btn-current-user"),i.elUserName)).removeClass("hidden"),l=e.find(".color-user-name"),i.setUserName(i.options.userName)),!c&&a&&(a.sharingSettingsUrl&&a.sharingSettingsUrl.length||a.canRequestSharingSettings)?(i.btnShare=new Common.UI.Button({cls:"btn-header btn-header-share",iconCls:"toolbar__icon icon--inverse btn-users-share",caption:i.textShare,dataHint:"0",dataHintDirection:"bottom",dataHintOffset:"big"}),i.btnShare.render(e.find("#slot-btn-share"))):e.find("#slot-btn-share").hide(),d&&a.isEdit&&!a.isOffline&&a.canSwitchMode?(i.btnPDFMode=new Common.UI.Button({cls:"btn-header btn-header-pdf-mode no-caret",iconCls:"toolbar__icon icon--inverse btn-sheet-view",caption:i.textView,menu:!0,dataHint:"0",dataHintDirection:"bottom",dataHintOffset:"big"}),i.btnPDFMode.render(e.find("#slot-btn-pdf-mode")),h.call(i,a)):e.find("#slot-btn-pdf-mode").hide(),e.find(".cousers-list"),(o=e.find(".box-cousers")).hide(),e):"title"==t?(e=$(_.template('<section id="box-document-title"><div class="extra"></div><div class="hedset"><div class="btn-slot" id="slot-btn-dt-home"></div><div class="btn-slot" id="slot-btn-dt-save" data-layout-name="header-save"></div><div class="btn-slot" id="slot-btn-dt-print"></div><div class="btn-slot" id="slot-btn-dt-print-quick"></div><div class="btn-slot" id="slot-btn-dt-download"></div><div class="btn-slot" id="slot-btn-dt-undo"></div><div class="btn-slot" id="slot-btn-dt-redo"></div></div><div class="lr-separator" id="id-box-doc-name"><input id="title-doc-name" autofill="off" autocomplete="off"/></input></div></section>')()),r&&r.hide().off(),r=e.find("#title-doc-name"),setTimeout(function(){i.setDocTitle(i.documentCaption)},50),i.options.wopi&&r.attr("maxlength",i.options.wopi.FileNameMaxLength),(a.user.guest&&a.canRenameAnonymous?(i.btnUserName=new Common.UI.Button({el:e.findById(".slot-btn-user-name"),cls:"btn-header",dataHint:"0",dataHintDirection:"bottom",dataHintOffset:"big",visible:!0}),i.btnUserName.cmpEl):(i.elUserName=e.find(".btn-current-user"),i.elUserName)).removeClass("hidden"),l=e.find(".color-user-name"),a.canPrint&&a.isEdit&&(i.btnPrint=n("toolbar__icon icon--inverse btn-print",e.findById("#slot-btn-dt-print"),!0,void 0,void 0,"P")),a.canQuickPrint&&a.isEdit&&(i.btnPrintQuick=n("toolbar__icon icon--inverse btn-quick-print",e.findById("#slot-btn-dt-print-quick"),!0,void 0,void 0,"Q")),!a.document.url.startsWith("file:///")&&a.document.url.includes(":")&&(i.btnDownload=n("toolbar__icon icon--inverse btn-download",e.findById("#slot-btn-dt-download"),!1,void 0,void 0,"D")),i.btnSave=n("toolbar__icon icon--inverse btn-save",e.findById("#slot-btn-dt-save"),!0,void 0,void 0,"S"),i.btnUndo=n("toolbar__icon icon--inverse btn-undo",e.findById("#slot-btn-dt-undo"),!0,void 0,void 0,"Z"),i.btnRedo=n("toolbar__icon icon--inverse btn-redo",e.findById("#slot-btn-dt-redo"),!0,void 0,void 0,"Y"),e):void 0:$("")},setVisible:function(t){},setBranding:function(t){var e,i;(this.branding=t)&&t.logo&&(t.logo.image||t.logo.imageDark)&&(e=Common.UI.Themes.isDarkTheme()?t.logo.imageDark||t.logo.image:t.logo.image||t.logo.imageDark,(i=$("#header-logo"))&&(i.html('<img src="'+e+'" style="max-width:100px; max-height:20px; margin: 0;"/>'),i.css({"background-image":"none",width:"auto"}),!t.logo.url&&void 0!==t.logo.url||i.addClass("link")))},changeLogo:function(){var t=this.branding;t&&t.logo&&t.logo.image&&t.logo.imageDark&&t.logo.image!==t.logo.imageDark&&(t=Common.UI.Themes.isDarkTheme()?t.logo.imageDark||t.logo.image:t.logo.image||t.logo.imageDark,$("#header-logo img").attr("src",t))},setDocumentCaption:function(t){this.documentCaption=t=t||"";var e=this.documentCaption.lastIndexOf(".");return 0<e&&(this.fileExtention=this.documentCaption.substring(e)),this.isModified&&(t+="*"),this.readOnly&&(t+=" ("+this.textReadOnly+")"),r&&this.setDocTitle(t),t},getDocumentCaption:function(){return this.documentCaption},setDocumentChanged:function(t){this.isModified=t;var e=this.documentCaption;t&&(e+="*"),this.setDocTitle(e)},setCanBack:function(t,e){return this.options.canBack=t,this.btnGoBack[t?"show":"hide"](),t&&this.btnGoBack.updateHint(e&&"string"==typeof e?e:this.textBack),a(n),this},getCanBack:function(){return this.options.canBack},setFavorite:function(t){return this.options.favorite=t,this.btnFavorite[null!=t?"show":"hide"](),this.btnFavorite.changeIcon(t?{next:"btn-in-favorite",curr:"btn-favorite"}:{next:"btn-favorite",curr:"btn-in-favorite"}),this.btnFavorite.updateHint(t?this.textRemoveFavorite:this.textAddFavorite),a(n),this},getFavorite:function(){return this.options.favorite},setWopi:function(t){this.options.wopi=t},setCanRename:function(t){var e,i,n=this;n.options.canRename=t,r&&(e=r,t?(e.removeAttr("disabled").tooltip({title:n.txtRename,placement:"cursor"}),e.on({keydown:function(t){var e=this,i=r.val();t.keyCode==Common.UI.Keys.RETURN?(i=i.trim(),_.isEmpty(i)||e.cutDocName(e.documentCaption)===i?Common.NotificationCenter.trigger("edit:complete",e):(e.isSaveDocName=!0,/[\t*\+:\"<>?|\\\\/]/gim.test(i)?_.defer(function(){Common.UI.error({msg:(new Common.Views.RenameDialog).txtInvalidName+'*+:"<>?|/',callback:function(){_.delay(function(){r.focus(),e.isSaveDocName=!0},50)}})}):e.withoutExt&&(i=e.cutDocName(i),e.fireEvent("rename",[i]),i+=e.fileExtention,e.withoutExt=!1,e.setDocTitle(i),Common.NotificationCenter.trigger("edit:complete",e)))):t.keyCode==Common.UI.Keys.ESC?Common.NotificationCenter.trigger("edit:complete",this):_.delay(function(){e.setDocTitle()},10)}.bind(this),focus:function(t){var e,i=this;i.imgCrypted&&i.imgCrypted.toggleClass("hidden",!0),i.isSaveDocName=!1,i.withoutExt||(e=i.cutDocName(r.val()),i.withoutExt=!0,_.delay(function(){i.setDocTitle(e),r.select()},100))}.bind(this),blur:function(t){n.imgCrypted&&n.imgCrypted.toggleClass("hidden",!1),Common.Utils.isGecko&&(e[0].selectionStart=e[0].selectionEnd=0),n.isSaveDocName||(n.withoutExt=!1,n.setDocTitle(n.documentCaption))},paste:function(t){setTimeout(function(){var t=n.cutDocName(r.val());n.setDocTitle(t)})}})):(e.off(),e.attr("disabled",!0),(i=e.data("bs.tooltip"))&&(i.options.title="",i.setContent())),e.attr("data-can-copy",t))},cutDocName:function(t){var e;return!(t.length<=this.fileExtention.length)&&(e=t.length-this.fileExtention.length,t.substring(e)==this.fileExtention)?t.substring(0,e):t},setDocTitle:function(t){var e=this.getTextWidth(t||r.val())+10;0<=e&&r.width(e),t&&0<=e&&r.val(t),this._showImgCrypted&&0<=e&&(this.imgCrypted.toggleClass("hidden",!1),this._showImgCrypted=!1),0<=e&&m()},getTextWidth:function(t){var e,i;return this._testCanvas||(e=(r.css("font-size")+" "+r.css("font-family")).trim())&&(i=document.createElement("canvas"),this._testCanvas=i.getContext("2d"),this._testCanvas.font=e),this._testCanvas?void 0!==(i=this._testCanvas.measureText(t)).actualBoundingBoxLeft?Math.ceil(Math.abs(i.actualBoundingBoxLeft)+Math.abs(i.actualBoundingBoxRight))+1:i.width?Math.ceil(i.width)+2:0:-1},setUserName:function(t){return this.options.userName=t,this.btnUserName?this.btnUserName.updateHint(t):this.elUserName&&this.elUserName.tooltip({title:Common.Utils.String.htmlEncode(t),placement:"cursor",html:!0}),l&&l.text(this.getInitials(t)),this},getButton:function(t){return"save"==t?this.btnSave:"users"==t?o:"share"==t?this.btnShare:void 0},lockHeaderBtns:function(t,e){if("users"==t)e?s.addClass("disabled").attr("disabled","disabled"):s.removeClass("disabled").removeAttr("disabled"),this.btnShare&&this.btnShare.setDisabled(e);else if("rename-user"==t)this.btnUserName&&this.btnUserName.setDisabled(e);else{var i=function(t){t&&(e?(t.keepState={disabled:t.isDisabled()},t.setDisabled(!0)):(t.setDisabled(t.keepState&&t.keepState.disabled||e),delete t.keepState))};switch(t){case"undo":i(this.btnUndo);break;case"redo":i(this.btnRedo)}}},getInitials:function(t){for(var e=t.split(" "),i=e[0].substring(0,1).toUpperCase(),n=e.length-1;0<n;n--)if("("!==e[n][0]&&")"!==e[n][0]){i+=e[n].substring(0,1).toUpperCase();break}return i},setDocumentReadOnly:function(t){this.readOnly=t,this.setDocumentCaption(this.documentCaption)}}}(),Common.Views.Header||{}))}),void 0===Common&&(Common={}),define("common/main/lib/component/ToggleManager",["common/main/lib/component/BaseView"],function(){"use strict";var s={};function i(t,e){var i,n,o;if(e)for(n=0,o=(i=s[t.toggleGroup]).length;n<o;n++)i[n]===t||i[n].isActive&&!i[n].isActive()||i[n].toggle(!1)}Common.UI.ToggleManager={register:function(t){t.toggleGroup&&((s[t.toggleGroup]||(s[t.toggleGroup]=[])).push(t),t.on("toggle",i))},unregister:function(t){var e;!t.toggleGroup||(e=s[t.toggleGroup])&&(_.without(e,t),t.off("toggle",i))},getToggled:function(t){var e,i=s[t],n=0;if(i)for(e=i.length;n<e;n++)if(!0===i[n].pressed||!0===i[n].checked)return i[n];return null}}}),void 0===Common&&(Common={}),define("common/main/lib/component/Button",["common/main/lib/component/BaseView","common/main/lib/component/ToggleManager"],function(){"use strict";window.createButtonSet=function(){function t(t){}t.prototype=new Array;var e,i=!1,n=((t.prototype.constructor=t).prototype.add=function(t){t.setDisabled(i),this.push(t)},t.prototype.setDisabled=function(e){i=e,this.forEach(function(t){t.setDisabled(e)})},t.prototype.toggle=function(e,i){this.forEach(function(t){t.toggle(e,i)})},t.prototype.pressed=function(){return this.some(function(t){return t.pressed})},t.prototype.contains=function(e){return this.some(function(t){return t.id==e})},t.prototype.concat=function(){var t=Array.prototype.slice.call(arguments),e=Array.prototype.slice.call(this);return t.forEach(function(t){t instanceof Array?Array.prototype.push.apply(e,t):t&&e.push(t)}),e},Object.create(t.prototype));for(e in arguments)n.add(arguments[e]);return n};function r(t){var e=document.createElement("span"),t=(e.style.fontSize=document.documentElement.style.getPropertyValue("--font-size-base-app-custom")||"11px",e.style.fontFamily='Arial, Helvetica, "Helvetica Neue", sans-serif',e.style.position="absolute",e.style.top="-1000px",e.style.left="-1000px",e.innerHTML=t,document.body.appendChild(e),e.offsetWidth);return document.body.removeChild(e),t}function c(t,e){for(var i=t.length-1,n=t;r(n)>e;)n=t.slice(0,i).trim()+"...",i--;return n}Common.UI.Button=Common.UI.BaseView.extend({options:{id:null,hint:!1,enableToggle:!1,allowDepress:!0,toggleGroup:null,cls:"",iconCls:"",caption:"",menu:null,disabled:!1,pressed:!1,split:!1,visible:!0,dataHint:"",dataHintDirection:"",dataHintOffset:"0, 0",scaling:!1},template:_.template(["<% var applyicon = function() { %>","<% if (iconImg) { print('<img src=\"' + iconImg + '\">'); } else { %>",'<% if (iconCls != "") {  if (/svgicon/.test(iconCls)) {print(\'<svg class="icon uni-scale"><use class="zoom-int" xlink:href="#\' + /svgicon\\s(\\S+)/.exec(iconCls)[1] + \'"></use></svg>\');} else print(\'<i class="icon \' + iconCls + \'">&nbsp;</i>\'); }} %>',"<% } %>","<% if ( !menu ) { %>",'<button type="button" class="btn <%= cls %>" id="<%= id %>" style="<%= style %>" data-hint="<%= dataHint %>" data-hint-direction="<%= dataHintDirection %>" data-hint-offset="<%= dataHintOffset %>" <% if (dataHintTitle) { %> data-hint-title="<%= dataHintTitle %>" <% } %>>',"<% applyicon() %>",'<span class="caption"><%= caption %></span>',"</button>","<% } else if (split == false) {%>",'<div class="btn-group" id="<%= id %>" style="<%= style %>">','<button type="button" class="btn dropdown-toggle <%= cls %>" data-toggle="dropdown" data-hint="<%= dataHint %>" data-hint-direction="<%= dataHintDirection %>" data-hint-offset="<%= dataHintOffset %>" <% if (dataHintTitle) { %> data-hint-title="<%= dataHintTitle %>" <% } %>>',"<% applyicon() %>",'<span class="caption"><%= caption %></span>','<span class="inner-box-caret"><i class="caret"></i></span>',"</button>","</div>","<% } else { %>",'<div class="btn-group split" id="<%= id %>" style="<%= style %>">','<button type="button" class="btn <%= cls %>">',"<% applyicon() %>",'<span class="caption"><%= caption %></span>',"</button>",'<button type="button" class="btn <%= cls %> dropdown-toggle" data-toggle="dropdown" data-hint="<%= dataHint %>" data-hint-direction="<%= dataHintDirection %>" data-hint-offset="<%= dataHintOffset %>" <% if (dataHintTitle) { %> data-hint-title="<%= dataHintTitle %>" <% } %>>','<i class="caret"></i>','<span class="sr-only"></span>',"</button>","</div>","<% } %>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);t=this;t.id=t.options.id||Common.UI.getId(),t.hint=t.options.hint,t.enableToggle=t.options.enableToggle,t.allowDepress=t.options.allowDepress,t.cls=t.options.cls,t.iconCls=t.options.iconCls,t.menu=t.options.menu,t.split=t.options.split,t.toggleGroup=t.options.toggleGroup,t.disabled=t.options.disabled,t.visible=t.options.visible,t.pressed=t.options.pressed,t.caption=t.options.caption,t.template=t.options.template||t.template,t.style=t.options.style,(t.rendered=!1)===t.options.scaling&&t.options.iconCls&&(t.iconCls=t.options.iconCls+" scaling-off"),t.options.el?t.render():t.options.parentEl&&t.render(t.options.parentEl)},getCaptionWithBreaks:function(t){var e=t.split(" "),i=null,n=156,o=e.indexOf("&");if(-1<o&&(e[o-1]+=" &",e.splice(o,1)),1<e.length)if(n=this.menu||!0===this.split?n-10:n,e.length<3)e[0]=c(e[0],this.menu?n+10:n),e[1]=c(e[1],n),i=e[0]+"<br>"+e[1];else{var s="";if(r(e[0]+" "+e[1])<n){for(var a=2;a<e.length;a++)s+=e[a]+" ";i=2*r(s+(this.menu?10:0))<r(e[0]+" "+e[1])?(s=c((e[1]+" "+s).trim(),n),e[0]+"<br>"+s):(s=c(s.trim(),n),e[0]+" "+e[1]+"<br>"+s)}else{for(var l=1;l<e.length;l++)s+=e[l]+" ";s=c(s.trim(),n),i=e[0]+"<br>"+s}}else{i=r(t)<n?t:c(t,n);!this.menu&&!0!==this.split||(i+="<br>")}return i},render:function(t){var o,e,s,i,n,a,l,r,c=this;return c.trigger("render:before",c),c.cmpEl=c.$el||$(c.el),t&&(c.setElement(t,!1),c.rendered||(/icon-top/.test(c.cls)&&c.caption&&/huge/.test(c.cls)&&(!0===c.split?(c.cls&&(c.cls=c.cls.replace(/\s?(?:x-huge|icon-top)/g,"")),this.template=_.template('<div class="btn-group x-huge split icon-top" id="<%= id %>" style="<%= style %>"><button type="button" class="btn <%= cls %> inner-box-icon"><span class="btn-fixflex-hcenter"><% if ( iconImg ) { %><img src="<%= iconImg %>"><% } else { %><% if (/svgicon/.test(iconCls)) {print(\'<svg class="icon uni-scale"><use class="zoom-int" xlink:href="#\' + /svgicon\\s(\\S+)/.exec(iconCls)[1] + \'"></use></svg>\');} else print(\'<i class="icon \' + iconCls + \'">&nbsp;</i>\'); %><% } %></span></button><button type="button" class="btn <%= cls %> inner-box-caption dropdown-toggle" data-toggle="dropdown" data-hint="<%= dataHint %>" data-hint-direction="<%= dataHintDirection %>" data-hint-offset="<%= dataHintOffset %>" <% if (dataHintTitle) { %> data-hint-title="<%= dataHintTitle %>" <% } %>><span class="btn-fixflex-vcenter"><span class="caption"><%= caption %><i class="caret"></i></span><i class="caret compact-caret"></i></span></button></div>')):c.menu?this.template=_.template('<div class="btn-group icon-top" id="<%= id %>" style="<%= style %>"><button type="button" class="btn dropdown-toggle <%= cls %>" data-toggle="dropdown" data-hint="<%= dataHint %>" data-hint-direction="<%= dataHintDirection %>" data-hint-offset="<%= dataHintOffset %>" <% if (dataHintTitle) { %> data-hint-title="<%= dataHintTitle %>" <% } %>><div class="inner-box-icon"><% if ( iconImg ) { %><img src="<%= iconImg %>"><% } else { %><% if (/svgicon/.test(iconCls)) {print(\'<svg class="icon uni-scale"><use class="zoom-int" xlink:href="#\' + /svgicon\\s(\\S+)/.exec(iconCls)[1] + \'"></use></svg>\');} else print(\'<i class="icon \' + iconCls + \'">&nbsp;</i>\'); %><% } %></div><div class="inner-box-caption"><span class="caption"><%= caption %><i class="caret"></i></span><i class="caret compact-caret"></i></div></button></div>'):this.template=_.template('<button type="button" class="btn <%= cls %>" id="<%= id %>" data-hint="<%= dataHint %>" data-hint-direction="<%= dataHintDirection %>" data-hint-offset="<%= dataHintOffset %>" <% if (dataHintTitle) { %> data-hint-title="<%= dataHintTitle %>" <% } %>> <div class="inner-box-icon"><% if ( iconImg ) { %><img src="<%= iconImg %>"><% } else { %><% if (/svgicon/.test(iconCls)) {print(\'<svg class="icon uni-scale"><use class="zoom-int" xlink:href="#\' + /svgicon\\s(\\S+)/.exec(iconCls)[1] + \'"></use></svg>\');} else print(\'<i class="icon \' + iconCls + \'">&nbsp;</i>\'); %><% } %></div><div class="inner-box-caption"><span class="caption"><%= caption %></span></div></button>'),(e=this.getCaptionWithBreaks(this.caption))&&(c.caption=e)),c.cmpEl=$(this.template({id:c.id,cls:c.cls,iconCls:c.iconCls,iconImg:c.options.iconImg,menu:c.menu,split:c.split,disabled:c.disabled,pressed:c.pressed,caption:c.caption,style:c.style,dataHint:c.options.dataHint,dataHintDirection:c.options.dataHintDirection,dataHintOffset:c.options.dataHintOffset,dataHintTitle:c.options.dataHintTitle})),c.menu&&_.isObject(c.menu)&&_.isFunction(c.menu.render)&&c.menu.render(c.cmpEl),t.html(c.cmpEl),c.$icon=c.$el.find(".icon"))),c.rendered||(e=(o=c.cmpEl).hasClass("btn-group"),s=o.hasClass("split"),c.options.hint&&(i=c.cmpEl.closest(".asc-window"),"object"==typeof c.options.hint&&1<c.options.hint.length&&0<$("button",o).length?(t=$("button",o),c.btnEl=$(t[0]),c.btnMenuEl=$(t[1])):(c.btnEl=c.cmpEl,c.btnEl.attr("data-toggle","tooltip")),c.btnEl.tooltip({title:"string"==typeof c.options.hint?c.options.hint:c.options.hint[0],placement:c.options.hintAnchor||"cursor"}),c.btnMenuEl&&c.btnMenuEl.tooltip({title:c.options.hint[1],placement:c.options.hintAnchor||"cursor"}),0<i.length&&(c.btnEl.data("bs.tooltip").tip().css("z-index",parseInt(i.css("z-index"))+10),c.btnMenuEl&&c.btnMenuEl.data("bs.tooltip").tip().css("z-index",parseInt(i.css("z-index"))+10),n=function(t){i[0]===t.$window[0]&&((t=c.btnEl.data("bs.tooltip"))&&(void 0===t.dontShow&&(t.dontShow=!0),t.hide()),Common.NotificationCenter.off({"modal:close":n}))},Common.NotificationCenter.on({"modal:close":n}))),_.isString(c.toggleGroup)&&(c.enableToggle=!0),t=function(t){var e;c.disabled||1!=t.which||(c.doToggle(),c.options.hint&&(e=c.btnEl.data("bs.tooltip"))&&(void 0===e.dontShow&&(e.dontShow=!0),e.hide()),c.trigger("click",c,t))},a=function(t,e,i){var n;if(t||(n=!1,$("button",o).each(function(t,e){if($(e).is(":hover"))return!(n=!0)}),n||(o.removeClass("over"),$("button",o).removeClass("over"))),"button"==e){if(!t&&c.enableToggle&&c.allowDepress&&c.pressed)return;if(t&&!s&&c.enableToggle&&c.allowDepress&&!c.pressed)return void i.preventDefault();$("button:first",o).toggleClass("active",t)}else $("[data-toggle^=dropdown]",o).toggleClass("active",t);o.toggleClass("active",t)},r=function(t){a(!1,l,t),$(document).off("mouseup",r)},(e?(s&&($("[data-toggle^=dropdown]",o).on("mousedown",_.bind(function(t){var e;c.disabled||1!=t.which||s&&(c.options.hint&&(e=(c.btnMenuEl||c.btnEl).data("bs.tooltip"))&&(void 0===e.dontShow&&(e.dontShow=!0),e.hide()),e=o.hasClass("open"),a(!e,"arrow",t))},this)),$("button",o).on("mousedown",_.bind(function(t){l=t.currentTarget.className.match(/dropdown/)?"arrow":"button",a(!0,l,t),$(document).on("mouseup",r)},this)),0<c.options.width&&$("button:first",o).css("width",c.options.width-$("[data-toggle^=dropdown]",o).outerWidth())),o.on("hide.bs.dropdown",_.bind(a,c,!1,"arrow")),o.on("show.bs.dropdown",_.bind(a,c,!0,"arrow")),o.on("hidden.bs.dropdown",_.bind(function(t,e){c.cmpEl.find(".dropdown-toggle").blur(),c.cmpEl.hasClass("active")!==c.pressed&&c.cmpEl.trigger("button.internal.active",[c.pressed])},c)),$("button:first",o)):o).on("click",t),o.on("button.internal.active",_.bind(function(t,e){s?a(e,"button",t):(o.toggleClass("active",e),$("button",o).toggleClass("active",e))},c)),o.on("mouseover",function(t){c.disabled||(c.cmpEl.addClass("over"),c.trigger("mouseover",c,t))}),o.on("mouseout",function(t){c.cmpEl.removeClass("over"),c.disabled||c.trigger("mouseout",c,t)}),Common.UI.ToggleManager.register(c),!1!==c.options.scaling&&(o.attr("ratio","ratio"),c.applyScaling(Common.UI.Scaling.currentRatio()),o.on("app:scaling",function(t,e){c.options.scaling!=e.ratio&&c.applyScaling(e.ratio)}))),c.rendered=!0,c.pressed&&c.toggle(c.pressed,!0),c.disabled&&c.setDisabled(!(c.disabled=!1)),c.visible||c.setVisible(c.visible),c.trigger("render:after",c),this},doToggle:function(){!this.enableToggle||!1===this.allowDepress&&this.pressed||this.toggle()},toggle:function(t,e){t=void 0===t?!this.pressed:!!t;this.pressed=t,this.cmpEl&&this.cmpEl.trigger("button.internal.active",[t]),e||this.trigger("toggle",this,t)},click:function(t){this.disabled||(this.doToggle(),this.trigger("click",this,t))},isActive:function(){return this.enableToggle?this.pressed:this.cmpEl.hasClass("active")},setDisabled:function(e){var t,i,n,o;this.rendered&&this.disabled!=e&&(o=(t=this.cmpEl).hasClass("btn-group"),i=this,(e=!0===e)!==t.hasClass("disabled")&&((n=function(t){t.toggleClass("disabled",e),i.options.allowMouseEventsOnDisabled||(e?t.attr({disabled:e}):t.removeAttr("disabled"))})(t),o&&n(t.children("button"))),!e&&Common.Utils.isGecko||!this.options.hint||((o=this.btnEl.data("bs.tooltip"))&&(e&&o.hide(),Common.Utils.isGecko||(o.enabled=!e)),this.btnMenuEl&&(o=this.btnMenuEl.data("bs.tooltip"))&&(e&&o.hide(),Common.Utils.isGecko||(o.enabled=!e))),e&&this.menu&&_.isObject(this.menu)&&this.menu.rendered&&this.menu.isVisible()&&setTimeout(function(){i.menu.hide()},1),!i.options.signals||i.options.signals.indexOf("disabled")<0||i.trigger("disabled",i,e)),this.disabled=e},isDisabled:function(){return this.disabled},setIconCls:function(t){var e,i=$(this.el).find(".icon"),n=this.iconCls,o=i.find("use.zoom-int");this.iconCls=t,/svgicon/.test(this.iconCls)?(e=/svgicon\s(\S+)/.exec(this.iconCls),o.attr("xlink:href",e&&1<e.length?"#"+e[1]:"")):o.length?(e=/btn-[^\s]+/.exec(this.iconCls),o.attr("href",e?"#"+e[0]:"")):(i.removeClass(n),i.addClass(t||""),!1===this.options.scaling&&i.addClass("scaling-off"))},changeIcon:function(t){var e,i=$(this.el).find(".icon");t&&(t.curr||t.next)&&i&&(e=i.find("use.zoom-int"),t.curr&&i.removeClass(t.curr),t.next&&!i.hasClass(t.next)&&i.addClass(t.next),e.length&&t.next&&e.attr("href","#"+t.next),!this.options.signals||this.options.signals.indexOf("icon:changed")<0||this.trigger("icon:changed",this,t))},hasIcon:function(t){return this.$icon.hasClass(t)},setVisible:function(t){this.cmpEl&&this.cmpEl.toggleClass("hidden",!t),this.visible=t},isVisible:function(){return(this.cmpEl||$(this.el)).is(":visible")},updateHint:function(t,e){var i,n,o;this.options.hint=t,this.rendered&&(n=(i=this.cmpEl).closest(".asc-window"),this.btnEl||("object"==typeof this.options.hint&&1<this.options.hint.length&&0<$("button",i).length?(o=$("button",i),this.btnEl=$(o[0]),this.btnMenuEl=$(o[1])):(this.btnEl=i,this.btnEl.attr("data-toggle","tooltip"))),this.btnEl.data("bs.tooltip")&&this.btnEl.removeData("bs.tooltip"),this.btnMenuEl&&this.btnMenuEl.data("bs.tooltip")&&this.btnMenuEl.removeData("bs.tooltip"),this.btnEl.tooltip({html:!!e,title:"string"==typeof t?t:t[0],placement:this.options.hintAnchor||"cursor"}),this.btnMenuEl&&this.btnMenuEl.tooltip({html:!!e,title:t[1],placement:this.options.hintAnchor||"cursor"}),0<n.length&&(this.btnEl.data("bs.tooltip").tip().css("z-index",parseInt(n.css("z-index"))+10),this.btnMenuEl&&this.btnMenuEl.data("bs.tooltip").tip().css("z-index",parseInt(n.css("z-index"))+10)),!this.disabled&&Common.Utils.isGecko||((o=this.btnEl.data("bs.tooltip"))&&(this.disabled&&o.hide(),Common.Utils.isGecko||(o.enabled=!this.disabled)),this.btnMenuEl&&(o=this.btnMenuEl.data("bs.tooltip"))&&(this.disabled&&o.hide(),Common.Utils.isGecko||(o.enabled=!this.disabled))))},setCaption:function(t){var e;this.caption!=t&&(/icon-top/.test(this.cls)&&this.caption&&/huge/.test(this.cls)?(e=this.getCaptionWithBreaks(t),this.caption=e||t):this.caption=t,this.rendered&&(0<(e=this.cmpEl.find(".caption")).length?e:this.cmpEl.find("button:first").addBack().filter("button")).html(this.caption))},setMenu:function(t){t&&_.isObject(t)&&_.isFunction(t.render)&&(this.menu=t,this.rendered&&this.menu.render(this.cmpEl))},applyScaling:function(t){this.options.scaling!=t&&(2<(this.options.scaling=t)?this.$el.find("svg.icon").length||(t=this.iconCls||this.$el.find("i.icon").attr("class"),t=(t=/btn-[^\s]+/.exec(t))?t[0]:"null",t='<svg class="icon"><use class="zoom-int" href="#%iconname"></use></svg>'.replace("%iconname",t),this.$el.find("i.icon").after(t)):this.$el.find("i.icon")||(t='<i class="icon %cls">&nbsp;</i>'.replace("%cls",this.iconCls),this.$el.find("svg.icon").after(t)))},focus:function(){this.$el&&this.$el.find("button").addBack().filter("button").focus()}})}),define("common/main/lib/view/SearchBar",["common/main/lib/component/Window","common/main/lib/component/Button"],function(){"use strict";Common.UI.SearchBar=Common.UI.Window.extend(_.extend({options:{modal:!1,width:328,height:54,header:!1,cls:"search-bar",alias:"SearchBar",showOpenPanel:!0,toolclose:"hide",automove:!1},initialize:function(t){_.extend(this.options,t||{}),this.template=['<div class="box">','<div class="search-input-group">','<input type="text" id="search-bar-text" class="input-field form-control" maxlength="255" placeholder="'+this.textFind+'" autocomplete="off">','<div id="search-bar-results">0/0</div>',"</div>",'<div class="tools">','<div id="search-bar-back"></div>','<div id="search-bar-next"></div>',this.options.showOpenPanel?'<div id="search-bar-open-panel"></div>':"",'<div id="search-bar-close"></div>',"</div>","</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),this.iconType=this.options.iconType,Common.UI.Window.prototype.initialize.call(this,this.options),Common.NotificationCenter.on("layout:changed",_.bind(this.onLayoutChanged,this)),$(window).on("resize",_.bind(this.onLayoutChanged,this))},render:function(){Common.UI.Window.prototype.render.call(this),this.inputSearch=this.$window.find("#search-bar-text"),this.inputSearch.on("input",_.bind(function(){this.disableNavButtons(),this.fireEvent("search:input",[this.inputSearch.val()])},this)).on("keydown",_.bind(function(t){this.fireEvent("search:keydown",[this.inputSearch.val(),t])},this));var t="svg"===this.iconType;return this.btnBack=new Common.UI.Button({parentEl:$("#search-bar-back"),cls:"btn-toolbar",iconCls:t?"svg-icon search-arrow-up":"toolbar__icon btn-arrow-up",hint:this.tipPreviousResult,scaling:!t}),this.btnBack.on("click",_.bind(this.onBtnNextClick,this,"back")),this.btnNext=new Common.UI.Button({parentEl:$("#search-bar-next"),cls:"btn-toolbar",iconCls:t?"svg-icon search-arrow-down":"toolbar__icon btn-arrow-down",hint:this.tipNextResult,scaling:!t}),this.btnNext.on("click",_.bind(this.onBtnNextClick,this,"next")),this.options.showOpenPanel&&(this.btnOpenPanel=new Common.UI.Button({parentEl:$("#search-bar-open-panel"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-more-vertical",hint:this.tipOpenAdvancedSettings}),this.btnOpenPanel.on("click",_.bind(this.onOpenPanel,this))),this.btnClose=new Common.UI.Button({parentEl:$("#search-bar-close"),cls:"btn-toolbar",iconCls:t?"svg-icon search-close":"toolbar__icon btn-close",hint:this.tipCloseSearch,scaling:!t}),this.btnClose.on("click",_.bind(function(){this.hide()},this)),this.searchResults=$("#search-bar-results"),this.on("animate:before",_.bind(this.focus,this)),Common.NotificationCenter.on("search:updateresults",_.bind(function(t,e){this.disableNavButtons(t,e),this.updateResultsNumber(t,e)},this)),this},show:function(t){var e=(0<$("#app-title").length?$("#app-title").height():0)+$("#toolbar").height()+2,i=Common.UI.isRTL()?($("#right-menu").is(":visible")?$("#right-menu").width():0)+32:Common.Utils.innerWidth()-($("#right-menu").is(":visible")?$("#right-menu").width():0)-this.options.width-32;Common.UI.Window.prototype.show.call(this,i,e),this.disableNavButtons(),t?(this.inputSearch.val(t),this.fireEvent("search:input",[t])):(this.inputSearch.val(""),window.SSE&&this.fireEvent("search:input",["",!0])),this.focus()},focus:function(){var t=this;setTimeout(function(){t.inputSearch.focus(),t.inputSearch.select()},10)},setText:function(t){this.inputSearch.val(t),this.fireEvent("search:input",[t])},getSettings:function(){return{}},onLayoutChanged:function(){var t=$("#app-title").height()+$("#toolbar").height()+2,e=Common.UI.isRTL()?($("#right-menu").is(":visible")?$("#right-menu").width():0)+32:Common.Utils.innerWidth()-($("#right-menu").is(":visible")?$("#right-menu").width():0)-this.options.width-32;this.$window.css({left:e,top:t})},onBtnNextClick:function(t){this.fireEvent("search:"+t,[this.inputSearch.val(),!1])},onOpenPanel:function(){this.hide(),this.fireEvent("search:show",[!0,this.inputSearch.val()])},disableNavButtons:function(t,e){e=""===this.inputSearch.val()&&!window.SSE||!e;this.btnBack.setDisabled(e),this.btnNext.setDisabled(e)},updateResultsNumber:function(t,e){this.searchResults.text(!e||""===this.inputSearch.val()&&!window.SSE?"0/0":Common.UI.isRTL()?e+"/"+(t+1):t+1+"/"+e),this.inputSearch.css(Common.UI.isRTL()?"padding-left":"padding-right",this.searchResults.outerWidth()+"px")}},Common.UI.SearchBar||{}))}),define("text!documenteditor/main/app/template/Viewport.template",[],function(){return'<div class="layout-region">\n    <div id="viewport-vbox-layout" class="layout-ct vbox">\n        <section class="layout-ct">\n            <div id="file-menu-panel" class="toolbar-fullview-panel hint-section" style="display:none;"></div>\n        </section>\n        <section id="app-title" class="layout-item"></section>\n        <div id="toolbar" class="layout-item hint-section" data-layout-name="toolbar"></div>\n        <div class="layout-item middle">\n            <div id="viewport-hbox-layout" class="layout-ct hbox">\n                <div id="left-menu" class="layout-item hint-section" data-layout-name="leftMenu" style="width: 40px;"></div>\n                <div id="about-menu-panel" class="left-menu-full-ct" style="display:none;"></div>\n                <div id="editor-container" class="layout-item"><div id="editor_sdk"></div></div>\n                <div id="right-menu" class="layout-item hint-section" data-layout-name="rightMenu"></div>\n                <div id="left-panel-history" class="layout-item"></div>\n            </div>\n        </div>\n        <div id="statusbar" class="layout-item" data-layout-name="statusBar"></div>\n    </div>\n</div>\n'}),void 0===Common&&(Common={}),define("common/main/lib/component/Layout",["backbone"],function(){"use strict";function e(t){this.box=null,this.panels=[],this.splitters=[],_.extend(this,t||{})}function o(){return{width:null,height:null,resize:!1,stretch:!1,rely:!1}}_.extend(e.prototype,Backbone.Events,{initialize:function(t){this.$parent=this.box.parent();this.resize={eventMove:_.bind(this.resizeMove,this),eventStop:_.bind(this.resizeStop,this)};this.freeze=t.freeze,this.changeLayout(t.items)},doLayout:function(){},changeLayout:function(t){var e,i,n=!1;this.splitters&&this.splitters.forEach(function(t){t.resizer&&t.resizer.el.remove()},this),this.splitters=[],this.panels=[],t.forEach(function(t){t.el instanceof HTMLElement&&(t.el=$(t.el)),(e=_.extend(new o,t)).stretch&&(n=!0,e.rely=!1,e.resize=!1),this.panels.push(e),e.resize&&(i={isresizer:!0,minpos:e.resize.min||0,maxpos:e.resize.max||0,fmin:e.resize.fmin,fmax:e.resize.fmax,behaviour:e.behaviour,index:this.splitters.length,offset:e.resize.offset||0,multiply:e.resize.multiply},n?(e.resize.el=i.el=e.el.before('<div class="layout-resizer before"></div>').prev(),this.panels.splice(this.panels.length-1,0,i)):(e.resize.el=i.el=e.el.after('<div class="layout-resizer after"></div>').next(),this.panels.push(i)),this.splitters.push({resizer:i}),e.resize.hidden&&i.el.hide(),Common.Gateway.on("processmouse",this.resize.eventStop))},this),this.freezePanels(this.freeze)},getElementHeight:function(t){return parseInt(t.css("height"))},getElementWidth:function(t){return parseInt(t.css("width"))},getItem:function(t){for(var e in this.panels){e=this.panels[e];if(e.alias==t)return e}},onSelectStart:function(t){return t.preventDefault&&t.preventDefault(),!1},addHandler:function(t,e,i){t.addEventListener?t.addEventListener(e,i):t.attachEvent?t.attachEvent("on"+e,i):t["on"+e]=i},removeHandler:function(t,e,i){t.removeEventListener?t.removeEventListener(e,i):t.detachEvent?t.detachEvent("on"+e,i):t["on"+e]=null},clearSelection:function(){var t;window.getSelection?(t=window.getSelection()).empty?t.empty():t.removeAllRanges&&t.removeAllRanges():document.selection&&document.selection.empty()},resizeStart:function(t){var e;this.freeze||(this.clearSelection(),this.addHandler(window.document,"selectstart",this.onSelectStart),$(document).on({mousemove:this.resize.eventMove,mouseup:this.resize.eventStop}),Common.NotificationCenter.on({"frame:mousemove":this.resize.eventMove,"frame:mouseup":this.resize.eventStop}),e=t.data.panel,this.resize.type=t.data.type,this.resize.$el=e.el,this.resize.min=0<e.minpos?e.minpos:this.resize.$el.parent().width()+e.minpos,this.resize.fmin=e.fmin,this.resize.fmax=e.fmax,this.resize.behaviour=e.behaviour,this.resize.multiply=e.multiply,this.resize.$el.addClass("move"),"vertical"==t.data.type?(this.resize.height=parseInt(this.resize.$el.css("height")),this.resize.max=(0<e.maxpos?e.maxpos:this.resize.$el.parent().height()+e.maxpos)-this.resize.height,this.resize.inity=t.pageY*Common.Utils.zoom()-parseInt(t.currentTarget.style.top)):"horizontal"==t.data.type&&(this.resize.width=parseInt(this.resize.$el.css("width")),this.resize.max=(0<e.maxpos?e.maxpos:this.resize.$el.parent().width()+e.maxpos)-this.resize.width,this.resize.initx=t.pageX*Common.Utils.zoom()-parseInt(t.currentTarget.style.left)),this.resize.multiply&&this.resize.multiply.koeff&&(this.resize.max=Math.floor(this.resize.max/this.resize.multiply.koeff)*this.resize.multiply.koeff+(this.resize.multiply.offset||0)),Common.NotificationCenter.trigger("layout:resizestart"))},resizeMove:function(t){var e,i,n,o=t instanceof jQuery.Event?Common.Utils.zoom():1;"vertical"==this.resize.type?(e="top",n=t.pageY*o-this.resize.inity):"horizontal"==this.resize.type&&(e="left",n=t.pageX*o-this.resize.initx),this.resize.multiply&&this.resize.multiply.koeff&&(o=n/(t=this.resize.multiply.koeff),i=Math.floor(o)*t+(this.resize.multiply.offset||0),o=Math.ceil(o)*t+(this.resize.multiply.offset||0),n=i+t/2<n?o:i),this.resize.fmin&&this.resize.fmax?n<this.resize.fmin()||n>this.resize.fmax()||(this.resize.$el[0].style[e]=n+"px"):n<this.resize.min||n>this.resize.max||(this.resize.$el[0].style[e]=n+"px")},resizeStop:function(t){var e,i,n,o;this.removeHandler(window.document,"selectstart",this.onSelectStart),$(document).off({mousemove:this.resize.eventMove,mouseup:this.resize.eventStop}),Common.NotificationCenter.off({"frame:mousemove":this.resize.eventMove,"frame:mouseup":this.resize.eventStop}),this.resize.$el&&(n=t instanceof jQuery.Event?Common.Utils.zoom():1,t instanceof jQuery.Event||void 0!==t.pageY&&void 0!==t.pageX||(t.pageY=t.y,t.pageX=t.x),"vertical"==this.resize.type?(e="height",i=t.pageY*n-this.resize.inity):"horizontal"==this.resize.type&&(e="width",i=t.pageX*n-this.resize.initx),this.resize.multiply&&this.resize.multiply.koeff&&(n=i/(t=this.resize.multiply.koeff),o=Math.floor(n)*t+(this.resize.multiply.offset||0),n=Math.ceil(n)*t+(this.resize.multiply.offset||0),i=o+t/2<i?n:o),this.resize.fmin&&this.resize.fmax?(i=i<this.resize.fmin()?this.resize.fmin():i)>this.resize.fmax()&&(i=this.resize.fmax()):(i=i<this.resize.min?this.resize.min:i)>this.resize.max&&(i=this.resize.max),n=t=null,o=0,this.resize.$el.hasClass("after")?(t=this.resize.$el.prev(),n=this.resize.$el.next(),o=parseInt(t.css(e))):(t=this.resize.$el.next(),n=this.resize.$el.prev(),o=parseInt(t.css(e)),i=t.parent()[e]()-(i+this.resize[e])),"vertical"==this.resize.type&&(i-=t.position().top),t.css(e,i+"px"),this.resize.behaviour&&n.css(e,parseInt(n.css(e))-(i-o)),this.resize.$el.removeClass("move"),delete this.resize.$el,this.resize.value!=i&&(this.doLayout(),this.trigger("layout:resizedrag",this)),Common.NotificationCenter.trigger("layout:resizestop"))},freezePanels:function(e){this.panels.forEach(function(t){!t.stretch&&t.resize&&$(t.resize.el).css("cursor",e?"default":"")}),this.freeze=e},setResizeValue:function(t,e){var i,n,o,s;return t>=this.splitters.length?(this.doLayout(),!1):(n=i=null,o=0,s="height",(e=e<(t=this.splitters[t].resizer).fmin()?t.fmin():e)>t.fmax()&&(e=t.fmax()),o=(n=(t.el.hasClass("after")?i=t.el.prev():e=(i=t.el.next()).parent()[s]()-(e+t[s]),t.el.next()),parseInt(i.css(s))),e-=i.position().top,i.css(s,e+"px"),t.behaviour&&n.css(s,parseInt(n.css(s))-(e-o)),t.value!=e&&this.doLayout(),.99<Math.abs(o-e))}}),Common.UI||(Common.UI={}),Common.UI.VBoxLayout=function(t){e.apply(this,arguments),this.initialize.apply(this,arguments)},Common.UI.VBoxLayout.prototype=_.extend(new e,{initialize:function(t){e.prototype.initialize.call(this,t)},doLayout:function(){var e,i,n=0;this.panels.forEach(function(t){t.stretch?e=t:((i=t.el.is(":visible"))&&(n+=!0!==t.rely?t.height:this.getElementHeight(t.el)),t.resize&&!1!==t.resize.autohide&&t.resize.el&&(i?(t.resize.el.show(),e&&(n+=t.resize.height)):(t.resize.el.hide(),e&&(n-=t.resize.height))))},this),e&&(e.height=this.$parent.height()-n),n=0,this.panels.forEach(function(t){t.el.is(":visible")&&(i={top:n},!0!==t.rely&&(i.height=t.height),t.el.css(i),n+=i.height||this.getElementHeight(t.el))},this)},changeLayout:function(t){e.prototype.changeLayout.call(this,t),this.panels.forEach(function(t){t.stretch||t.height||(t.height=this.getElementHeight(t.el)),t.isresizer&&t.el.on("mousedown",{type:"vertical",panel:t},_.bind(this.resizeStart,this))},this),this.doLayout.call(this)}}),Common.UI.HBoxLayout=function(t){e.apply(this,arguments),this.initialize.apply(this,arguments)},Common.UI.HBoxLayout.prototype=_.extend(new e,{initialize:function(t){e.prototype.initialize.call(this,t)},doLayout:function(t){var e,i,n=0;this.panels.forEach(function(t){t.stretch?e=t:((i=t.el.is(":visible"))&&(t.isresizer?n+=t.offset:n+=!0!==t.rely?t.width:this.getElementWidth(t.el)),t.resize&&!1!==t.resize.autohide&&t.resize.el&&(i?t.resize.el.show():t.resize.el.hide(),e&&(n-=t.resize.width)))},this),e&&(e.width=this.$parent.width()-n),n=0,this.panels.forEach(function(t){t.el.is(":visible")&&(i={left:n-(t.isresizer?t.width:0)},!0!==t.rely&&(i.width=t.width),t.el.css(i),t.isresizer?n+=t.offset:n+=this.getElementWidth(t.el))},this)},changeLayout:function(t){e.prototype.changeLayout.call(this,t),this.panels.forEach(function(t){t.stretch||t.width||(t.width=this.getElementWidth(t.el)),t.isresizer&&t.el.on("mousedown",{type:"horizontal",panel:t},_.bind(this.resizeStart,this))},this),this.doLayout.call(this)}}),Common.UI.VBoxLayout.prototype.constructor=Common.UI.VBoxLayout,Common.UI.HBoxLayout.prototype.constructor=Common.UI.HBoxLayout}),define("documenteditor/main/app/view/Viewport",["text!documenteditor/main/app/template/Viewport.template","jquery","underscore","backbone","common/main/lib/component/Layout"],function(t,i,e,n){"use strict";DE.Views.Viewport=n.View.extend({el:"#viewport",template:e.template(t),events:{},initialize:function(){},render:function(){this.$el.html(this.template({})),Common.Utils.isSafari?(i("body").addClass("safari"),i("body").mousewheel(function(t){t.preventDefault(),t.stopPropagation()})):Common.Utils.isChrome&&i("body").addClass("chrome");var t=i("#viewport-vbox-layout",this.$el),e=(this.vlayout=new Common.UI.VBoxLayout({box:t,items:[{el:t.find("> .layout-item#app-title").hide(),alias:"title",height:Common.Utils.InternalSettings.get("document-title-height")},{el:t.find(" > .layout-item#toolbar"),alias:"toolbar",height:Common.localStorage.getBool("de-compact-toolbar")?Common.Utils.InternalSettings.get("toolbar-height-compact"):Common.Utils.InternalSettings.get("toolbar-height-normal")},{el:t.find(" > .layout-item.middle"),stretch:!0},{el:t.find(" > .layout-item#statusbar"),height:25}]}),(t=i("#viewport-hbox-layout",this.$el)).find(" > .layout-item")),e=[{el:e[0],rely:!0,alias:"left",resize:{hidden:!0,autohide:!1,min:300,max:600}},{el:e[3],rely:!0,alias:"history",resize:{hidden:!0,autohide:!1,min:300,max:600}},{el:e[1],stretch:!0},{el:i(e[2]).hide(),rely:!0}];return Common.UI.isRTL()&&(e[0].resize.min=-600,e[0].resize.max=-300,[e[1].resize.min,e[1].resize.max]=[-600,-300],[e[0],e[3]]=[e[3],e[0]],[e[1],e[2]]=[e[2],e[1]]),this.hlayout=new Common.UI.HBoxLayout({box:t,items:e}),this},applyEditorMode:function(){var t=DE.getController("RightMenu").getView("RightMenu"),t=(this._rightMenu=t.render(this.mode),Common.UI.LayoutManager.getInitValue("rightMenu"));Common.localStorage.getBool("de-hidden-rightmenu",t=void 0!==t&&!t)&&this._rightMenu.hide(),Common.Utils.InternalSettings.set("de-hidden-rightmenu",Common.localStorage.getBool("de-hidden-rightmenu",t))},applyCommonMode:function(){Common.localStorage.getBool("de-hidden-status")&&DE.getController("Statusbar").getView("Statusbar").setVisible(!1);var t=Common.UI.LayoutManager.getInitValue("leftMenu");Common.localStorage.getBool("de-hidden-leftmenu",void 0!==t&&!t)&&DE.getController("LeftMenu").getView("LeftMenu").hide()},setMode:function(t){t.isDisconnected?(e.isUndefined(this.mode)&&(this.mode={}),this.mode.canCoAuthoring=!1):this.mode=t}})}),define("text!documenteditor/main/app/template/LeftMenu.template",[],function(){return'<div id="view-left-menu" class="tool-menu left">\n    <div class="tool-menu-btns">\n        <button id="left-btn-searchbar" class="btn btn-category" data-hint="0" data-hint-direction="right" data-hint-offset="big" content-target="left-panel-search"><i class="icon toolbar__icon btn-menu-search">&nbsp;</i></button>\n        \x3c!-- /** coauthoring begin **/ --\x3e\n        <button id="left-btn-comments" class="btn btn-category" data-hint="0" data-hint-direction="right" data-hint-offset="big" content-target="left-panel-comments"><i class="icon toolbar__icon btn-menu-comments">&nbsp;</i></button>\n        <button id="left-btn-chat" class="btn btn-category" data-hint="0" data-hint-direction="right" data-hint-offset="big" content-target="left-panel-chat"><i class="icon toolbar__icon btn-menu-chat">&nbsp;</i></button>\n        \x3c!-- /** coauthoring end **/ --\x3e\n        <button id="left-btn-plugins" class="btn btn-category" data-hint="0" data-hint-direction="right" data-hint-offset="big" content-target=""><i class="icon toolbar__icon btn-menu-plugin">&nbsp;</i></button>\n        <button id="left-btn-navigation" class="btn btn-category" data-hint="0" data-hint-direction="right" data-hint-offset="big" content-target="" data-layout-name="leftMenu-navigation"><i class="icon toolbar__icon btn-menu-navigation">&nbsp;</i></button>\n        <button id="left-btn-thumbnails" class="btn btn-category" data-hint="0" data-hint-direction="right" data-hint-offset="big" content-target=""><i class="icon toolbar__icon btn-menu-thumbs">&nbsp;</i></button>\n        <button id="left-btn-support" class="btn btn-category" data-hint="0" data-hint-direction="right" data-hint-offset="big" content-target=""><i class="icon toolbar__icon btn-menu-support">&nbsp;</i></button>\n        <button id="left-btn-about" class="btn btn-category" data-hint="0" data-hint-direction="right" data-hint-offset="big" content-target=""><i class="icon toolbar__icon btn-menu-about">&nbsp;</i></button>\n    </div>\n    <div class="left-panel" style="">\n        <div id="left-panel-search" class="" style="display: none;"></div>\n        \x3c!-- /** coauthoring begin **/ --\x3e\n        <div id="left-panel-comments" class="" style="display: none;"></div>\n        <div id="left-panel-chat" class="" style="display: none;"></div>\n        \x3c!-- /** coauthoring end **/ --\x3e\n        <div id="left-panel-navigation" class="" style="display: none; height: 100%;"></div>\n        <div id="left-panel-thumbnails" class="" style="display: none; height: 100%;"></div>\n        <div id="left-panel-plugins" class="" style="display: none; height: 100%;"></div>\n    </div>\n</div>'}),define("common/main/lib/view/SearchDialog",["common/main/lib/component/Window"],function(){"use strict";Common.UI.SearchDialog=Common.UI.Window.extend(_.extend({options:{width:550,title:"Search & Replace",modal:!1,cls:"search",toolclose:"hide",alias:"SearchDialog"},initialize:function(t){_.extend(this.options,t||{}),this.template=['<div class="box">','<div class="input-row">','<span class="btn-placeholder" id="search-placeholder-btn-options"></span>','<input type="text" id="sd-text-search" class="input-field form-control" maxlength="255" placeholder="'+this.textSearchStart+'" autocomplete="off">',"</div>",'<div class="input-row">','<input type="text" id="sd-text-replace" class="input-field form-control" maxlength="255" placeholder="'+this.textReplaceDef+'" autocomplete="off">',"</div>",'<div class="input-row">','<label class="link" id="search-label-replace" result="replaceshow">'+this.txtBtnReplace+"</label>","</div>","</div>",'<div class="separator horizontal"></div>','<div class="footer right">','<button class="btn normal dlg-btn" result="replace">'+this.txtBtnReplace+"</button>",'<button class="btn normal dlg-btn margin-left-6" result="replaceall" style="width: auto;min-width: 100px;">'+this.txtBtnReplaceAll+"</button>",'<button class="btn normal dlg-btn iconic" result="back"><span class="icon img-commonctrl back"></span></button>','<button class="btn normal dlg-btn iconic margin-left-6" result="next"><span class="icon img-commonctrl next"></span></button>',"</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){return Common.UI.Window.prototype.render.call(this),this.miMatchCase=new Common.UI.MenuItem({caption:this.textMatchCase,checkable:!0}),this.miMatchWord=new Common.UI.MenuItem({caption:this.options.matchwordstr||this.textWholeWords,checkable:!0}),this.miHighlight=new Common.UI.MenuItem({caption:this.textHighlight,checkable:!0}),this.btnOptions=new Common.UI.Button({id:"search-btn-options",cls:"btn-toolbar",iconCls:"toolbar__icon btn-settings",menu:new Common.UI.Menu({items:[this.miMatchCase,this.miMatchWord,this.miHighlight]})}),this.options.extraoptions&&(this.btnOptions.menu.addItem({caption:"--"}),this.options.extraoptions.forEach(function(t){this.btnOptions.menu.addItem(t)},this)),this.btnOptions.render(this.$window.find("#search-placeholder-btn-options")),this.options.matchcase||this.miMatchCase.hide(),this.options.matchword||this.miMatchWord.hide(),this.options.markresult?this.options.markresult.applied&&this.miHighlight.setChecked(!0,!0):this.miHighlight.hide(),"search"===this.options.mode&&$(this.$window.find(".input-row").get(2)).hide(),this.txtSearch=this.$window.find("#sd-text-search"),this.txtReplace=this.$window.find("#sd-text-replace"),this.lblReplace=this.$window.find("#search-label-replace"),this.miHighlight.on("toggle",_.bind(this.onHighlight,this)),this.$window.find(".btn[result=back]").on("click",_.bind(this.onBtnClick,this,"back")),this.$window.find(".btn[result=next]").on("click",_.bind(this.onBtnClick,this,"next")),this.$window.find(".btn[result=replace]").on("click",_.bind(this.onBtnClick,this,"replace")),this.$window.find(".btn[result=replaceall]").on("click",_.bind(this.onBtnClick,this,"replaceall")),this.$window.find("label[result=replaceshow]").on("click",_.bind(this.onShowReplace,this)),this.txtSearch.on("keydown",null,"search",_.bind(this.onKeyPress,this)),this.txtReplace.on("keydown",null,"replace",_.bind(this.onKeyPress,this)),this.on("animate:before",_.bind(this.onAnimateBefore,this)),this},show:function(t,e){Common.UI.Window.prototype.show.call(this),(t=this.mode?t:t||"search")&&this.mode!=t&&this.setMode(t),e&&this.setSearchText(e),this.options.markresult&&this.miHighlight.checked&&this.fireEvent("search:highlight",[this,!0]),this.focus()},focus:function(t){var e="replace"===t?this.txtReplace:this.txtSearch;setTimeout(function(){e.focus(),e.select()},10)},onAnimateBefore:function(){this.focus()},onKeyPress:function(t){this.isLocked()||(t.keyCode==Common.UI.Keys.RETURN?("search"==t.data?this.onBtnClick("next",t):"replace"==t.data&&"replace"==this.mode&&this.onBtnClick("replace",t),t.preventDefault(),t.stopPropagation()):t.keyCode==Common.UI.Keys.ESC&&$(".asc-loadmask").length<1&&(this.hide(),t.preventDefault(),t.stopPropagation()))},onBtnClick:function(t,e){var i;$(".asc-loadmask").length||(i={textsearch:this.txtSearch.val(),textreplace:this.txtReplace.val(),matchcase:this.miMatchCase.checked,matchword:this.miMatchWord.checked,highlight:this.miHighlight.checked},this.fireEvent("search:"+t,[this,i]))},setMode:function(t){this.mode=t;var e=this.$window.find(".input-row");"no-replace"===t?(this.setTitle(this.textTitle2),e.eq(1).hide(),e.eq(2).hide(),this.$window.find(".btn[result=replace]").hide(),this.$window.find(".btn[result=replaceall]").hide(),this.options.matchcase||this.options.matchword||this.options.markresult||(this.txtSearch.addClass("clear"),this.btnOptions.hide()),this.menuLookin&&this.menuLookin.menu.items[1].setDisabled(!1),this.setHeight(170)):(this.txtSearch.removeClass("clear"),this.setTitle(this.textTitle),"search"===t?(e.eq(2).show(),this.lblReplace.text(this.txtBtnReplace),e.eq(1).hide(),this.$window.find(".btn[result=replace]").hide(),this.$window.find(".btn[result=replaceall]").hide(),this.menuLookin&&this.menuLookin.menu.items[1].setDisabled(!1),this.setHeight(200)):(e.eq(2).show(),this.lblReplace.text(this.txtBtnHideReplace),e.eq(1).show(),this.$window.find(".btn[result=replace]").show(),this.$window.find(".btn[result=replaceall]").show(),this.menuLookin&&(this.menuLookin.menu.items[0].setChecked(!0),this.menuLookin.menu.items[1].setDisabled(!0)),this.setHeight(230)))},setSearchText:function(t){this.txtSearch&&this.txtSearch.val(t)},onShowReplace:function(t){this.setMode("replace"==this.mode?"search":"replace");var e=this;_.defer(function(){("replace"==e.mode?e.txtReplace:e.txtSearch).focus()},300)},onHighlight:function(t,e){this.fireEvent("search:highlight",[this,e])},getSettings:function(){return{textsearch:this.txtSearch.val(),matchcase:this.miMatchCase.checked,matchword:this.miMatchWord.checked}}},Common.UI.SearchDialog||{}))}),define("text!documenteditor/main/app/template/FileMenu.template",[],function(){return'<div class="panel-menu">\n    <li class="fm-first-item"></li>\n    <li id="fm-btn-return" class="fm-btn" data-layout-name="toolbar-file-close"></li>\n    <li class="devider"></li>\n    <li id="fm-btn-create" class="fm-btn"></li>\n    <li id="fm-btn-recent" class="fm-btn"></li>\n    <li class="devider"></li>\n    <li id="fm-btn-save" class="fm-btn" data-layout-name="toolbar-file-save"></li>\n    <li id="fm-btn-edit" class="fm-btn"></li>\n    <li id="fm-btn-download" class="fm-btn"></li>\n    <li id="fm-btn-save-copy" class="fm-btn"></li>\n    <li id="fm-btn-save-desktop" class="fm-btn"></li>\n    <li id="fm-btn-print" class="fm-btn"></li>\n    <li id="fm-btn-print-with-preview" class="fm-btn"></li>\n    <li id="fm-btn-rename" class="fm-btn"></li>\n    <li id="fm-btn-protect" class="fm-btn"></li>\n    <li class="devider"></li>\n    <li id="fm-btn-info" class="fm-btn" data-layout-name="toolbar-file-info"></li>\n    <li id="fm-btn-rights" class="fm-btn"></li>\n    <li id="fm-btn-history" class="fm-btn"></li>\n    <li class="devider" class="fm-btn"></li>\n    <li id="fm-btn-set-default" class="fm-btn"></li>\n    <li id="fm-btn-settings" class="fm-btn" data-layout-name="toolbar-file-settings"></li>\n    <li id="fm-btn-feedback" class="fm-btn"></li>\n    <li id="fm-btn-uninstall" class="fm-btn"></li>\n    <li id="fm-btn-toggle-online" class="fm-btn"></li>\n    <li id="fm-btn-download-online" class="fm-btn"></li>\n    <li class="devider"></li>\n    <li id="fm-btn-help" class="fm-btn"></li>\n    <li class="devider"></li>\n    <li id="fm-btn-back" class="fm-btn"></li>\n</div>\n<div class="panel-context">\n    <div id="panel-saveas" class="content-box"></div>\n    <div id="panel-savecopy" class="content-box"></div>\n    <div id="panel-recentfiles" class="content-box"></div>\n    <div id="panel-createnew" class="content-box"></div>\n    <div id="panel-info" class="content-box"></div>\n    <div id="panel-rights" class="content-box"></div>\n    <div id="panel-settings" class="content-box"></div>\n    <div id="panel-help" class="content-box"></div>\n    <div id="panel-protect" class="content-box"></div>\n    <div id="panel-print" class="content-box"></div>\n</div>'}),void 0===Common&&(Common={}),Common.Views=Common.Views||{},define("common/main/lib/view/RecentFiles",["common/main/lib/component/BaseView"],function(){"use strict";Common.Views.RecentFiles=Common.UI.BaseView.extend(_.extend({menu:void 0,template:_.template(['<div class="header"><%= scope.txtOpenRecent %><button type="button" class="btn btn-text-default" id="fms-btn-clear-recent" style="width:auto; display: inline-block;margin-left:10px;padding-right: 5px;padding-left: 5px;" data-hint="2" data-hint-direction="bottom" data-hint-offset="medium">清除列表</button></div>','<div id="id-recent-view"></div>'].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.menu=t.menu,this.recent=t.recent,this.el=t.el,Common.NotificationCenter.on("update:recents",function(t){var e;this.viewRecentPicker&&(e=this.viewRecentPicker.store)&&(e.reset(this.recent.concat(t)),this.btnClearRecent.setDisabled(0===this.recent.length))}.bind(this)),Common.NotificationCenter.on("reset:recents",function(t){var e;this.viewRecentPicker&&(e=this.viewRecentPicker.store)&&(this.recent=t,e.reset(this.recent),this.btnClearRecent.setDisabled(0===this.recent.length))}.bind(this))},render:function(){return this.$el.html(this.template({scope:this})),this.viewRecentPicker=new Common.UI.DataView({el:$("#id-recent-view"),store:new Common.UI.DataViewStore(this.recent),itemTemplate:_.template(['<div class="recent-wrap">','<div class="recent-icon">',"<div>",'<div class= <% if (typeof format !== "undefined") {%> "default-icon img-format-<%=format %>"<% } else {%> "svg-file-recent"<%} %>></div>',"</div>","</div>",'<div class="file-name"><% if (typeof title !== "undefined") {%><%= Common.Utils.String.htmlEncode(title || "") %><% } %></div>','<div class="file-info"><% if (typeof folder !== "undefined") {%><%= Common.Utils.String.htmlEncode(folder || "") %><% } %></div>','<div class="file-date"><% if (typeof update_time !== "undefined") {%><%= update_time %><% } %></div>',"</div>"].join(""))}),this.viewRecentPicker.on("item:click",_.bind(this.onRecentFileClick,this)),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:this.$el,suppressScrollX:!0,alwaysVisibleY:!0})),this.btnClearRecent=new Common.UI.Button({el:this.$el.findById("#fms-btn-clear-recent")}),this.btnClearRecent.on("click",_.bind(this.onClearRecentClick,this)),this.btnClearRecent.setDisabled(0===this.recent.length),this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this.scroller&&this.scroller.update()},onRecentFileClick:function(t,e,i){this.menu&&(this.menu.hide(),Common.Gateway._postMessage({event:"onOpenRecent",data:{url:i.get("url")}}))},onClearRecentClick:function(){this.menu.hide(),Common.Gateway._postMessage({event:"onClearRecent"}),Common.NotificationCenter.trigger("reset:recents",[])}},Common.Views.RecentFiles||{}))}),define("documenteditor/main/app/view/FileMenu",["text!documenteditor/main/app/template/FileMenu.template","underscore","common/main/lib/component/BaseView","common/main/lib/view/RecentFiles"],function(t,n){"use strict";DE.Views.FileMenu=Common.UI.BaseView.extend(n.extend({el:"#file-menu-panel",rendered:!1,options:{alias:"FileMenu"},template:n.template(t),events:function(){return{"click .fm-btn":n.bind(function(t){var e=$(t.currentTarget),e=(e.hasClass("active")||($(".fm-btn",this.el).removeClass("active"),e.addClass("active")),n.findWhere(this.items,{el:t.currentTarget}));if(e){var i,t=this.panels[e.options.action];if("help"===e.options.action)if(!0===t.noHelpContents&&navigator.onLine)return this.fireEvent("item:click",[this,"external-help",!0]),void((i=Common.Utils.InternalSettings.get("url-help-center"))&&window.open(i,"_blank"));this.fireEvent("item:click",[this,e.options.action,!!t]),t&&(this.$el.find(".content-box:visible").hide(),this.active=e.options.action,t.show())}},this)}},initialize:function(){this._state={infoPreviewMode:!1}},render:function(){var t,e=$(this.template());return this.miClose=new Common.UI.MenuItem({el:e.elementById("#fm-btn-return"),action:"back",caption:this.btnCloseMenuCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[2,14]}),this.miSave=new Common.UI.MenuItem({el:e.elementById("#fm-btn-save"),action:"save",caption:this.btnSaveCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[2,14],dataHintTitle:"S"}),this.options.miSave&&(this.miSave.setDisabled(this.options.miSave.isDisabled()),delete this.options.miSave),this.miEdit=new Common.UI.MenuItem({el:e.elementById("#fm-btn-edit"),action:"edit",caption:this.btnToEditCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[2,14]}),this.miDownload=new Common.UI.MenuItem({el:e.elementById("#fm-btn-download"),action:"saveas",caption:this.btnDownloadCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[2,14]}),this.miSaveCopyAs=new Common.UI.MenuItem({el:e.elementById("#fm-btn-save-copy"),action:"save-copy",caption:this.btnSaveCopyAsCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[2,14]}),this.miSaveAs=new Common.UI.MenuItem({el:e.elementById("#fm-btn-save-desktop"),action:"save-desktop",caption:this.btnSaveAsCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[2,14]}),this.miPrintWithPreview=new Common.UI.MenuItem({el:e.elementById("#fm-btn-print-with-preview"),action:"printpreview",caption:this.btnPrintCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[2,14],dataHintTitle:"P"}),this.miPrint=new Common.UI.MenuItem({el:e.elementById("#fm-btn-print"),action:"print",caption:this.btnPrintCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[2,14],dataHintTitle:"P"}),this.miRename=new Common.UI.MenuItem({el:e.elementById("#fm-btn-rename"),action:"rename",caption:this.btnRenameCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[2,14]}),this.options.miRename&&(this.miRename.setDisabled(this.options.miRename.isDisabled()),delete this.options.miRename),this.miProtect=new Common.UI.MenuItem({el:e.elementById("#fm-btn-protect"),action:"protect",caption:this.btnProtectCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[2,14]}),this.options.miProtect&&(this.miProtect.setDisabled(this.options.miProtect.isDisabled()),delete this.options.miProtect),this.miRecent=new Common.UI.MenuItem({el:e.elementById("#fm-btn-recent"),action:"recent",caption:this.btnRecentFilesCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[2,14]}),this.miNew=new Common.UI.MenuItem({el:e.elementById("#fm-btn-create"),action:"new",caption:this.btnCreateNewCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[2,14]}),this.miInfo=new Common.UI.MenuItem({el:e.elementById("#fm-btn-info"),action:"info",caption:this.btnInfoCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[2,14]}),this.miAccess=new Common.UI.MenuItem({el:e.elementById("#fm-btn-rights"),action:"rights",caption:this.btnRightsCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[2,14]}),this.miHistory=new Common.UI.MenuItem({el:e.elementById("#fm-btn-history"),action:"history",caption:this.btnHistoryCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[2,14]}),this.options.miHistory&&(this.miHistory.setDisabled(this.options.miHistory.isDisabled()),delete this.options.miHistory),this.miSettings=new Common.UI.MenuItem({el:e.elementById("#fm-btn-settings"),action:"opts",caption:this.btnSettingsCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[2,14]}),this.miSetDefault=new Common.UI.MenuItem({el:e.elementById("#fm-btn-set-default"),action:"set-default",caption:this.btnSetDefaultCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[2,14]}),this.miFeedback=new Common.UI.MenuItem({el:e.elementById("#fm-btn-feedback"),action:"feedback",caption:this.btnFeedbackCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[2,14]}),this.miUnInstall=new Common.UI.MenuItem({el:e.elementById("#fm-btn-uninstall"),action:"uninstall",caption:this.btnUnInstallCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[2,14]}),this.miToggleOnline=new Common.UI.MenuItem({el:e.elementById("#fm-btn-toggle-online"),action:"toggle-online",caption:this.btnDisableOnlineCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[2,14]}),this.miDownloadOnline=new Common.UI.MenuItem({el:e.elementById("#fm-btn-download-online"),action:"download-online",caption:this.btnDownloadOnlineCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[2,14]}),this.miHelp=new Common.UI.MenuItem({el:e.elementById("#fm-btn-help"),action:"help",caption:this.btnHelpCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[2,14]}),this.miBack=new Common.UI.MenuItem({el:e.elementById("#fm-btn-back"),action:"exit",caption:this.btnBackCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[2,14]}),this.items=[],this.items.push(this.miClose,this.miSave,this.miEdit,this.miDownload,this.miSaveCopyAs,this.miSaveAs,this.miPrint,this.miPrintWithPreview,this.miRename,this.miProtect,this.miRecent,this.miNew,this.miInfo,this.miAccess,this.miHistory,this.miSettings,this.miHelp,this.miBack,this.miSetDefault,this.miFeedback,this.miUnInstall,this.miToggleOnline,this.miDownloadOnline),this.rendered=!0,this.$el.html(e),this.$el.find(".content-box").hide(),n.isUndefined(this.scroller)&&((t=this).scroller=new Common.UI.Scroller({el:this.$el.find(".panel-menu"),suppressScrollX:!0,alwaysVisibleY:!0}),Common.NotificationCenter.on("window:resize",function(){t.scroller.update()})),this.applyMode(),this.api&&(this.panels.info.setApi(this.api),this.panels.opts&&this.panels.opts.setApi(this.api),this.panels.protect&&this.panels.protect.setApi(this.api)),this.fireEvent("render:after",[this]),this},show:function(t,e){var i;this.isVisible()&&void 0===t||!this.mode||(this.rendered||this.render(),i=!this.mode.canDownload||this.mode.isDesktopApp&&this.mode.isOffline?"info":"saveas",i=this.mode.canOpenRecent&&this.mode.recent?"recent":i,this.miToggleOnline.setCaption(Common.localStorage.getBool("de-disable-online")?this.btnEnableOnlineCaption:this.btnDisableOnlineCaption),t=t||this.active||i,this.$el.show(),this.scroller.update(),this.selectMenu(t,e,i),this.api&&this.api.asc_enableKeyEvents(!1),this.fireEvent("menu:show",[this]))},hide:function(){this.$el.hide(),this.fireEvent("menu:hide",[this])},applyMode:function(){var t,e,i;this.rendered&&(this.panels||(this.panels={opts:new DE.Views.FileMenuPanels.Settings({menu:this}).render(this.$el.find("#panel-settings")),info:new DE.Views.FileMenuPanels.DocumentInfo({menu:this}).render(this.$el.find("#panel-info")),rights:new DE.Views.FileMenuPanels.DocumentRights({menu:this}).render(this.$el.find("#panel-rights"))},this._state.infoPreviewMode&&this.panels.info.setPreviewMode(this._state.infoPreviewMode)),this.mode&&(e=!1,t=Common.UI.LayoutManager.isElementVisible("toolbar-file-close"),this.miClose[t?"show":"hide"](),this.miClose.$el.find("+.devider")[t?"show":"hide"](),t&&(i=this.miClose.$el.find("+.devider")),this.miDownload[!this.mode.canDownload&&!this.mode.canDownloadOrigin||this.mode.isDesktopApp&&this.mode.isOffline?"hide":"show"](),this.miSaveCopyAs[!this.mode.canDownload&&!this.mode.canDownloadOrigin||this.mode.isDesktopApp&&this.mode.isOffline||!this.mode.canRequestSaveAs&&!this.mode.saveAsUrl?"hide":"show"](),this.miSaveAs[(this.mode.canDownload||this.mode.canDownloadOrigin)&&this.mode.isDesktopApp&&this.mode.isOffline?"show":"hide"](),this.miSave[this.mode.isEdit&&Common.UI.LayoutManager.isElementVisible("toolbar-file-save")?"show":"hide"](),this.miEdit[!this.mode.isEdit&&this.mode.canEdit&&this.mode.canRequestEditRights?"show":"hide"](),this.miPrint[this.mode.canPrint&&!this.mode.canPreviewPrint?"show":"hide"](),this.miPrintWithPreview[this.mode.canPreviewPrint?"show":"hide"](),this.miRename[this.mode.canRename&&!this.mode.isDesktopApp?"show":"hide"](),this.miProtect[this.mode.isSignatureSupport||this.mode.isPasswordSupport?"show":"hide"](),e=(this.mode.canDownload||this.mode.canDownloadOrigin||this.mode.isEdit&&Common.UI.LayoutManager.isElementVisible("toolbar-file-save")||this.mode.canPrint||this.mode.isSignatureSupport||this.mode.isPasswordSupport||!this.mode.isEdit&&this.mode.canEdit&&this.mode.canRequestEditRights||this.mode.canRename&&!this.mode.isDesktopApp)&&!this.mode.isDisconnected,this.miProtect.$el.find("+.devider")[e?"show":"hide"](),e&&(i=this.miProtect.$el.find("+.devider")),this.miRecent[this.mode.canOpenRecent?"show":"hide"](),this.miNew[this.mode.canCreateNew?"show":"hide"](),e=this.mode.canCreateNew,this.miNew.$el.find("+.devider")[e?"show":"hide"](),e&&(i=this.miNew.$el.find("+.devider")),t=Common.UI.LayoutManager.isElementVisible("toolbar-file-info"),this.miInfo[(e=t)?"show":"hide"](),t=!this.mode.isOffline&&this.document&&this.document.info&&(this.document.info.sharingSettings&&0<this.document.info.sharingSettings.length||this.mode.sharingSettingsUrl&&this.mode.sharingSettingsUrl.length||this.mode.canRequestSharingSettings),e=e||t,this.miAccess[t?"show":"hide"](),t=this.mode.canUseHistory&&!this.mode.isDisconnected,e=e||t,this.miHistory[t?"show":"hide"](),this.miHistory.$el.find("+.devider")[e?"show":"hide"](),e&&(i=this.miHistory.$el.find("+.devider")),t=Common.UI.LayoutManager.isElementVisible("toolbar-file-settings"),this.miSettings[t?"show":"hide"](),this.miSettings.$el.find("+.devider")[t?"show":"hide"](),t&&(i=this.miSettings.$el.find("+.devider")),t=this.mode.canHelp,this.miHelp[t?"show":"hide"](),this.miHelp.$el.find("+.devider")[t?"show":"hide"](),t&&(i=this.miHelp.$el.find("+.devider")),t=this.mode.canBack,this.miBack[t?"show":"hide"](),i&&!t&&i.hide(),t=this.mode.customization.canSetDefault,this.miSetDefault[t?"show":"hide"](),t=this.mode.customization.canUnInstall,this.miUnInstall[t?"show":"hide"](),t=this.mode.customization.canToggleOnline,this.miToggleOnline[t?"show":"hide"](),!(e=this.mode.document&&this.mode.document.url).startsWith("file:///")&&e.includes(":")?this.miDownloadOnline.show():this.miDownloadOnline.hide(),this.customizationDone||(this.customizationDone=!0,Common.Utils.applyCustomization(this.mode.customization,{goback:"#fm-btn-back > a"})),this.panels.opts.setMode(this.mode),this.panels.info.setMode(this.mode),this.mode.isDisconnected||this.panels.info.updateInfo(this.document),this.panels.rights.setMode(this.mode),this.mode.isDisconnected||this.panels.rights.updateInfo(this.document),this.mode.canCreateNew&&this.mode.templates&&this.mode.templates.length&&(this.panels.new||(this.panels.new=new DE.Views.FileMenuPanels.CreateNew({menu:this,docs:this.mode.templates,blank:this.mode.canRequestCreateNew||!!this.mode.createUrl}).render())),this.mode.canOpenRecent&&this.mode.recent&&(this.panels.recent||(this.panels.recent=new Common.Views.RecentFiles({el:"#panel-recentfiles",menu:this,recent:this.mode.recent}).render())),(this.mode.isSignatureSupport||this.mode.isPasswordSupport)&&(this.panels.protect||(this.panels.protect=new DE.Views.FileMenuPanels.ProtectDoc({menu:this}).render()),this.panels.protect.setMode(this.mode)),this.mode.canDownload?this.panels.saveas||(this.panels.saveas=new DE.Views.FileMenuPanels.ViewSaveAs({menu:this,fileType:this.document.fileType,mode:this.mode}).render()):this.mode.canDownloadOrigin&&$("a",this.miDownload.$el).text(this.textDownload),this.mode.canDownload&&(this.mode.canRequestSaveAs||this.mode.saveAsUrl)&&!this.panels["save-copy"]&&(this.panels["save-copy"]=new DE.Views.FileMenuPanels.ViewSaveCopy({menu:this,fileType:this.document.fileType,mode:this.mode}).render()),this.mode.canHelp&&!this.panels.help&&(this.panels.help=new DE.Views.FileMenuPanels.Help({menu:this}).render(),this.panels.help.setLangConfig(this.mode.lang)),this.mode.canPreviewPrint&&!((i=DE.getController("Print").getView("PrintWithPreview")).menu=this).panels.printpreview&&(this.panels.printpreview=i.render(this.$el.find("#panel-print"))),this.mode.canCreateNew&&($('<li id="fm-btn-local-open" class="fm-btn"/>').insertAfter($("#fm-btn-create",this.$el)),this.items.push(new Common.UI.MenuItem({el:$("#fm-btn-local-open",this.$el),action:"file:open",caption:this.btnFileOpenCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[2,14]})))))},setMode:function(t,e){return t.isDisconnected?(this.mode.canEdit=this.mode.isEdit=!1,this.mode.canOpenRecent=this.mode.canCreateNew=!1,this.mode.isDisconnected=t.isDisconnected,this.mode.canRename=!1,t.enableDownload||(this.mode.canPrint=this.mode.canDownload=this.mode.canDownloadOrigin=!1)):this.mode=t,e||this.applyMode(),this},setApi:function(t){return this.api=t,this.rendered&&(this.panels.info.setApi(t),this.panels.opts&&this.panels.opts.setApi(t),this.panels.protect&&this.panels.protect.setApi(t)),this},loadDocument:function(t){this.document=t.doc},selectMenu:function(t,e,i){var n,o;t&&(o=this._getMenuItem(t),n=this.panels[t],!o.isDisabled()&&o.isVisible()||(o=this._getMenuItem(i),n=this.panels[i]),o&&n&&($(".fm-btn",this.el).removeClass("active"),o.$el.addClass("active"),this.$el.find(".content-box:visible").hide(),n.show(e),this.scroller&&(i=o.$el.position().top,n=o.$el.outerHeight(),e=this.$el.outerHeight(),(i<0||e<i+n)&&(o=this.scroller.$el.scrollTop()+i+(n-e)/2,o=Math.floor(o/n)*n,this.scroller.scrollTop(o))),this.active=t))},_getMenuItem:function(e){return n.find(this.items,function(t){return t.options.action==e})},SetDisabled:function(t,e){var i=this.getButton("protect"),n=this.getButton("history");e&&e.protect&&i.setDisabled(t),e&&e.history&&n.setDisabled(t),e&&e.info&&(this.panels?this.panels.info.setPreviewMode(t):this._state.infoPreviewMode=t)},isVisible:function(){return!this.$el.is(":hidden")},getButton:function(t){return this.rendered?"save"==t?this.miSave:"rename"==t?this.miRename:"protect"==t?this.miProtect:"history"==t?this.miHistory:void 0:"save"==t?this.options.miSave||(this.options.miSave=new Common.UI.MenuItem({})):"rename"==t?this.options.miRename||(this.options.miRename=new Common.UI.MenuItem({})):"protect"==t?this.options.miProtect||(this.options.miProtect=new Common.UI.MenuItem({})):"history"==t?this.options.miHistory||(this.options.miHistory=new Common.UI.MenuItem({})):void 0}},DE.Views.FileMenu||{}))}),window.compareVersions=!0,void 0===window.Common&&(window.Common={}),void 0===Common.Utils&&(Common.Utils={});var utils=new function(){function t(t){return t.test(n)}function e(t,e){return t&&(t=e.exec(n))?parseFloat(t[1]):0}function i(){var t={},e=(window.AscCommon&&window.AscCommon.checkDeviceScale?(t=window.AscCommon.checkDeviceScale(),AscCommon.correctApplicationScale(t)):(window.matchMedia("screen and (-webkit-min-device-pixel-ratio: 1.25) and (-webkit-max-device-pixel-ratio: 1.49), screen and (min-resolution: 1.25dppx) and (max-resolution: 1.49dppx)").matches||window.matchMedia("screen and (-webkit-min-device-pixel-ratio: 1.5) and (-webkit-max-device-pixel-ratio: 1.74), screen and (min-resolution: 1.5dppx) and (max-resolution: 1.74dppx)").matches?t.devicePixelRatio=1.5:window.matchMedia("screen and (-webkit-min-device-pixel-ratio: 1.75) and (-webkit-max-device-pixel-ratio: 1.99), screen and (min-resolution: 1.75dppx) and (max-resolution: 1.99dppx)").matches?t.devicePixelRatio=1.75:window.matchMedia("screen and (-webkit-min-device-pixel-ratio: 2), screen and (min-resolution: 2dppx), screen and (min-resolution: 192dpi)").matches?t.devicePixelRatio=2:t.devicePixelRatio=1,window.matchMedia("screen and (-webkit-min-device-pixel-ratio: 2.25), screen and (min-resolution: 2.25dppx), screen and (min-resolution: 216dpi)").matches&&(t.devicePixelRatio=2.25)),$(document.body),document.body.className),i=e.replace(/pixel-ratio__[\w-]+/gi,"").trim();t.devicePixelRatio<1.25?/pixel-ratio__/.test(e)&&(document.body.className=i):t.devicePixelRatio<1.5?/pixel-ratio__1_25/.test(e)||(document.body.className=i+" pixel-ratio__1_25"):t.devicePixelRatio<1.75?/pixel-ratio__1_5/.test(e)||(document.body.className=i+" pixel-ratio__1_5"):!(t.devicePixelRatio<1.75)&&t.devicePixelRatio<2?/pixel-ratio__1_75/.test(e)||(document.body.className=i+" pixel-ratio__1_75"):!(t.devicePixelRatio<2)&&t.devicePixelRatio<2.25?/pixel-ratio__2\b/.test(e)||(document.body.className=i+" pixel-ratio__2"):/pixel-ratio__2_5/.test(e)||(document.body.className=i+" pixel-ratio__2_5"),L.zoom=t.correct?t.zoom:1,L.innerWidth=window.innerWidth*L.zoom,L.innerHeight=window.innerHeight*L.zoom,L.applicationPixelRatio=t.applicationPixelRatio||t.devicePixelRatio}var n=navigator.userAgent.toLowerCase(),o="CSS1Compat"==document.compatMode,s=document.documentMode,a=(t(/edge/),t(/opera/)),l=a&&t(/version\/10\.5/),r=!a&&(t(/msie/)||t(/trident/)||t(/edge/)),c=r&&(t(/msie 7/)&&8!=s&&9!=s&&10!=s||7==s),d=r&&(t(/msie 8/)&&7!=s&&9!=s&&10!=s||8==s),h=r&&(t(/msie 9/)&&7!=s&&8!=s&&10!=s||9==s),m=r&&(t(/msie 10/)&&7!=s&&8!=s&&9!=s||10==s),s=r&&(t(/trident\/7\.0/)&&7!=s&&8!=s&&9!=s&&10!=s||11==s),p=r&&t(/msie 6/),u=!r&&t(/\bchrome\b/),g=!r&&t(/webkit/),b=!r&&!u&&t(/safari/),C=b&&t(/applewebkit\/4/),f=b&&t(/version\/3/),v=b&&t(/version\/4/),_=b&&t(/version\/5\.0/),w=b&&t(/version\/5/),y=!g&&!r&&t(/gecko/),x=y&&t(/rv:1\.9/),S=y&&t(/rv:2\.0/),T=y&&t(/rv:5\./),A=y&&t(/rv:10\./),k=x&&t(/rv:1\.9\.0/),D=x&&t(/rv:1\.9\.1/),I=x&&t(/rv:1\.9\.2/),P=t(/windows|win32/),E=t(/macintosh|mac os x/),V=t(/linux/),M=e(!0,/\bchrome\/(\d+\.\d+)/),U=e(!0,/\bfirefox\/(\d+\.\d+)/),F=e(r,/msie (\d+\.\d+)/),R=e(a,/version\/(\d+\.\d+)/),B=e(b,/version\/(\d+\.\d+)/),H=e(g,/webkit\/(\d+\.\d+)/),O=/^https/i.test(window.location.protocol),L=(/android|avantgo|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od|ad)|iris|kindle|lge |maemo|midp|mmp|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(navigator.userAgent||navigator.vendor||window.opera),this);return checkSizeIE=function(){L.innerWidth=window.innerWidth,L.innerHeight=window.innerHeight},L.zoom=1,L.applicationPixelRatio=1,L.innerWidth=window.innerWidth,L.innerHeight=window.innerHeight,r?($(document.body).addClass("ie"),$(window).on("resize",checkSizeIE)):(i(),$(window).on("resize",i)),{checkSize:i,userAgent:n,isStrict:o,isIEQuirks:r&&!o&&(p||c||d||h),isOpera:a,isOpera10_5:l,isWebKit:g,isChrome:u,isSafari:b,isSafari3:f,isSafari4:v,isSafari5:w,isSafari5_0:_,isSafari2:C,isIE:r,isIE6:p,isIE7:c,isIE7m:p||c,isIE7p:r&&!p,isIE8:d,isIE8m:p||c||d,isIE8p:r&&!(p||c),isIE9:h,isIE9m:p||c||d||h,isIE9p:r&&!(p||c||d),isIE10:m,isIE10m:p||c||d||h||m,isIE10p:r&&!(p||c||d||h),isIE11:s,isIE11m:p||c||d||h||m||s,isIE11p:r&&!(p||c||d||h||m),isGecko:y,isGecko3:x,isGecko4:S,isGecko5:T,isGecko10:A,isFF3_0:k,isFF3_5:D,isFF3_6:I,isFF4:4<=U&&U<5,isFF5:5<=U&&U<6,isFF10:10<=U&&U<11,isLinux:V,isWindows:P,isMac:E,chromeVersion:M,firefoxVersion:U,ieVersion:F,operaVersion:R,safariVersion:B,webKitVersion:H,isSecure:O,emailRe:/^(mailto:)?([a-z0-9'\._-]+@[a-z0-9\.-]+\.[a-z0-9]{2,4})([a-яё0-9\._%+-=\? :&]*)/i,ipRe:/^(((https?)|(ftps?)):\/\/)?([\-\wа-яё]*:?[\-\wа-яё]*@)?(((1[0-9]{2}|2[0-4][0-9]|25[0-5]|[1-9][0-9]|[0-9])\.){3}(1[0-9]{2}|2[0-4][0-9]|25[0-5]|[1-9][0-9]|[0-9]))(:\d+)?(\/[%\-\wа-яё]*(\.[\wа-яё]{2,})?(([\wа-яё\-\.\?\\\/+@&#;:`~=%!,\(\)]*)(\.[\wа-яё]{2,})?)*)*\/?/i,hostnameRe:/^(((https?)|(ftps?)):\/\/)?([\-\wа-яё]*:?[\-\wа-яё]*@)?(([\-\wа-яё]+\.)+[\wа-яё\-]{2,}(:\d+)?(\/[%\-\wа-яё]*(\.[\wа-яё]{2,})?(([\wа-яё\-\.\?\\\/\+@&#;:`'~=%!,\(\)]*)(\.[\wа-яё]{2,})?)*)*\/?)/i,localRe:/^(((https?)|(ftps?)):\/\/)([\-\wа-яё]*:?[\-\wа-яё]*@)?(([\-\wа-яё]+)(:\d+)?(\/[%\-\wа-яё]*(\.[\wа-яё]{2,})?(([\wа-яё\-\.\?\\\/\+@&#;:`'~=%!,\(\)]*)(\.[\wа-яё]{2,})?)*)*\/?)/i,emailStrongRe:/(mailto:)?([a-z0-9'\._-]+@[a-z0-9\.-]+\.[a-z0-9]{2,4})([a-яё0-9\._%+-=\?:&]*)/gi,emailAddStrongRe:/(mailto:|\s[@]|\s[+])?([a-z0-9'\._-]+@[a-z0-9\.-]+\.[a-z0-9]{2,4})([a-яё0-9\._%\+-=\?:&]*)/gi,ipStrongRe:/(((https?)|(ftps?)):\/\/([\-\wа-яё]*:?[\-\wа-яё]*@)?)(((1[0-9]{2}|2[0-4][0-9]|25[0-5]|[1-9][0-9]|[0-9])\.){3}(1[0-9]{2}|2[0-4][0-9]|25[0-5]|[1-9][0-9]|[0-9]))(:\d+)?(\/[%\-\wа-яё]*(\.[\wа-яё]{2,})?(([\wа-яё\-\.\?\\\/\+@&#;:`~=%!,\(\)]*)(\.[\wа-яё]{2,})?)*)*\/?/gi,hostnameStrongRe:/((((https?)|(ftps?)):\/\/([\-\wа-яё]*:?[\-\wа-яё]*@)?)|(([\-\wа-яё]*:?[\-\wа-яё]*@)?www\.))((([\-\wа-яё]+\.)+[\wа-яё\-]{2,}|([\-\wа-яё]+))(:\d+)?(\/[%\-\wа-яё]*(\.[\wа-яё]{2,})?(([\wа-яё\-\.\?\\\/\+@&#;:`~=%!,\(\)]*)(\.[\wа-яё]{2,})?)*)*\/?)/gi,documentSettingsType:{Paragraph:0,Table:1,Header:2,TextArt:3,Shape:4,Image:5,Slide:6,Chart:7,MailMerge:8,Signature:9,Pivot:10,Cell:11,Slicer:12,Form:13},importTextType:{DRM:0,CSV:1,TXT:2,Paste:3,Columns:4,Data:5},zoom:function(){return L.zoom},applicationPixelRatio:function(){return L.applicationPixelRatio},topOffset:0,innerWidth:function(){return L.innerWidth},innerHeight:function(){return L.innerHeight},croppedGeometry:function(){return{left:0,top:Common.Utils.InternalSettings.get("window-inactive-area-top"),width:L.innerWidth,height:L.innerHeight-Common.Utils.InternalSettings.get("window-inactive-area-top")}}}},themecolor=(Common.Utils=_extend_object(Common.Utils,utils),new function(){var h=!0;return{txtBlack:"Black",txtWhite:"White",txtRed:"Red",txtGreen:"Green",txtBlue:"Blue",txtYellow:"Yellow",txtPurple:"Purple",txtAqua:"Aqua",txtDarkRed:"Dark red",txtDarkGreen:"Dark green",txtDarkBlue:"Dark blue",txtDarkYellow:"Dark yellow",txtDarkPurple:"Dark purple",txtDarkTeal:"Dark teal",txtLightGray:"Light gray",txtGray:"Gray",txtLightBlue:"Light blue",txtPink:"Pink",txtLightYellow:"Light yellow",txtSkyBlue:"Sky blue",txtRose:"Rose",txtTurquosie:"Turquosie",txtLightGreen:"Light green",txtLavender:"Lavender",txtLightOrange:"Light orange",txtTeal:"Teal",txtGold:"Gold",txtOrange:"Orange",txtIndigo:"Indigo",txtBrown:"Brown",txtDarkGray:"Dark gray",txtbackground:"Background",txttext:"Text",txtaccent:"Accent",txtDarker:"Darker",txtLighter:"Lighter",txtBrightGreen:"Bright green",txtViolet:"Violet",ThemeValues:[6,15,7,16,0,1,2,3,4,5],getTranslation:function(t){return t?this["txt"+t.replace(" ","")]||t:""},getEffectTranslation:function(t){return 0!==(t=parseInt(100*t))?(0<t?this.txtLighter:this.txtDarker)+" "+Math.abs(t)+"%":""},setColors:function(t,e){if(h){for(var i=1;i<3;i++)this["txtbackground"+i]=this.txtbackground+" "+i,this["txttext"+i]=this.txttext+" "+i;for(i=1;i<7;i++)this["txtaccent"+i]=this.txtaccent+" "+i;h=!1}var n,o;if(e&&0<e.length){var s=[];for(i=0;i<e.length;i++)o={color:this.getHexColor(e[i].get_r(),e[i].get_g(),e[i].get_b()),tip:this.getTranslation(e[i].asc_getName())},s.push(o);this.standartcolors=s}var a=[];for(i=0;i<6;i++)for(n=0;n<10;n++){var l=i+6*n,r=this.getTranslation(t[l].asc_getName()),c=this.getTranslation(t[l].asc_getNameInColorScheme()),d=this.getEffectTranslation(t[l].asc_getEffectValue());r&&(c&&(r+=", "+c),d&&(r+=", "+d)),o={color:this.getHexColor(t[l].get_r(),t[l].get_g(),t[l].get_b()),effectId:l,effectValue:this.ThemeValues[n],tip:r},a.push(o)}this.effectcolors=a},getEffectColors:function(){return this.effectcolors},getStandartColors:function(){return this.standartcolors},getHexColor:function(t,e,i){return t=t.toString(16),e=e.toString(16),i=i.toString(16),(t=1==t.length?"0"+t:t)+(e=1==e.length?"0"+e:e)+(i=1==i.length?"0"+i:i)},getRgbColor:function(t){var e="object"==typeof t?t.color:t,i=(3==(e=e.replace(/#/,"")).length&&(e=e.replace(/(.)/g,"$1$1")),e=parseInt(e,16),new Asc.asc_CColor);return i.put_type("object"==typeof t&&void 0!==t.effectId?Asc.c_oAscColor.COLOR_TYPE_SCHEME:Asc.c_oAscColor.COLOR_TYPE_SRGB),i.put_r(e>>16),i.put_g((65280&e)>>8),i.put_b(255&e),i.put_a(255),void 0!==t.effectId&&i.put_value(t.effectId),i},colorValue2EffectId:function(t){if("object"==typeof t&&t&&void 0!==t.effectValue&&this.effectcolors)for(var e=0;e<this.effectcolors.length;e++)if(this.effectcolors[e].effectValue===t.effectValue&&t.color.toUpperCase()===this.effectcolors[e].color.toUpperCase()){t.effectId=this.effectcolors[e].effectId;break}return t}}}),metrics=(Common.Utils.ThemeColor=_extend_object(themecolor,Common.Utils.ThemeColor),new function(){var e=this;return e.c_MetricUnits={cm:0,pt:1,inch:2},e.currentMetric=e.c_MetricUnits.pt,e.metricName=["Cm","Pt","Inch"],e.defaultMetric=e.c_MetricUnits.cm,{c_MetricUnits:e.c_MetricUnits,txtCm:"cm",txtPt:"pt",txtInch:'"',setCurrentMetric:function(t){e.currentMetric=t},getCurrentMetric:function(){return e.currentMetric},getCurrentMetricName:function(){return this["txt"+e.metricName[e.currentMetric]]},getMetricName:function(t){return this["txt"+e.metricName[void 0!==t?t:0]]},setDefaultMetric:function(t){e.defaultMetric=t},getDefaultMetric:function(){return e.defaultMetric},fnRecalcToMM:function(t){if(null!=t)switch(e.currentMetric){case e.c_MetricUnits.cm:return 10*t;case e.c_MetricUnits.pt:return 25.4*t/72;case e.c_MetricUnits.inch:return 25.4*t}return t},fnRecalcFromMM:function(t){switch(e.currentMetric){case e.c_MetricUnits.cm:return parseFloat((t/10).toFixed(4));case e.c_MetricUnits.pt:return parseFloat((72*t/25.4).toFixed(3));case e.c_MetricUnits.inch:return parseFloat((t/25.4).toFixed(3))}return t}}}),utilsString=(Common.Utils.Metric=_extend_object(metrics,Common.Utils.Metric),Common.Utils.RGBColor=function(t){t=(t=(t="#"==t.charAt(0)?t.substr(1,6):t).replace(/ /g,"")).toLowerCase();for(var e=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,process:function(t){return[parseInt(t[1]),parseInt(t[2]),parseInt(t[3])]}},{re:/^hsb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,process:function(t){var e,i={},n=Math.round(t[1]),o=Math.round(255*t[2]/100),t=Math.round(255*t[3]/100);return 0==o?i.r=i.g=i.b=t:(t=n%60*((e=t)-(o=(255-o)*t/255))/60,(n=360==n?0:n)<60?(i.r=e,i.b=o,i.g=o+t):n<120?(i.g=e,i.b=o,i.r=e-t):n<180?(i.g=e,i.r=o,i.b=o+t):n<240?(i.b=e,i.r=o,i.g=e-t):n<300?(i.b=e,i.g=o,i.r=o+t):n<360?(i.r=e,i.g=o,i.b=e-t):(i.r=0,i.g=0,i.b=0)),[Math.round(i.r),Math.round(i.g),Math.round(i.b)]}},{re:/^(\w{2})(\w{2})(\w{2})$/,process:function(t){return[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,process:function(t){return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)]}}],i=0;i<e.length;i++){var n,o,s,a=e[i].re,l=e[i].process,a=a.exec(t);a&&(l=l(a),n=l[0],o=l[1],s=l[2])}n=n<0||isNaN(n)?0:255<n?255:n,o=o<0||isNaN(o)?0:255<o?255:o,s=s<0||isNaN(s)?0:255<s?255:s;return{r:n,g:o,b:s,isEqual:function(t){return n==t.r&&o==t.g&&s==t.b},toRGB:function(){return"rgb("+n+", "+o+", "+s+")"},toRGBA:function(t){return"rgba("+n+", "+o+", "+s+", "+(t=void 0===t?1:t)+")"},toHex:function(){var t=n.toString(16),e=o.toString(16),i=s.toString(16);return"#"+(t=1==t.length?"0"+t:t)+(e=1==e.length?"0"+e:e)+(i=1==i.length?"0"+i:i)},toHSB:function(){var t={h:0,s:0,b:0},e=Math.min(n,o,s),i=Math.max(n,o,s),e=i-e;return t.b=i,t.s=0!=i?255*e/i:0,t.h=0!=t.s?n==i?0+(o-s)/e:o==i?2+(s-n)/e:4+(n-o)/e:0,t.h*=60,t.h<0&&(t.h+=360),t.s*=100/255,t.b*=100/255,t.h=parseInt(t.h),t.s=parseInt(t.s),t.b=parseInt(t.b),t}}},new function(){return{textCtrl:"Ctrl",textShift:"Shift",textAlt:"Alt",format:function(t){var i=_.toArray(arguments).slice(1);return i.length&&"object"==typeof i[0]&&(i=i[0]),t.replace(/\{(\d+)\}/g,function(t,e){return i[e]})},htmlEncode:function(t){return"undefined"!=typeof _?_.escape(t):t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")},htmlDecode:function(t){return _.unescape(t)},ellipsis:function(t,e,i){if(t&&t.length>e){if(i){var i=t.substr(0,e-2),n=Math.max(i.lastIndexOf(" "),i.lastIndexOf("."),i.lastIndexOf("!"),i.lastIndexOf("?"));if(-1!==n&&e-15<=n)return i.substr(0,n)+"..."}return t.substr(0,e-3)+"..."}return t},platformKey:function(t,e,i){return _.isEmpty(e)&&(e=" ({0})"),Common.Utils.isMac?(_.isFunction(i)&&(t=i.call(this,t)),Common.Utils.String.format(e,t.replace(/\+(?=\S)/g,"").replace(/Ctrl|ctrl/g,"⌘").replace(/Alt|alt/g,"⌥").replace(/Shift|shift/g,"⇧"))):Common.Utils.String.format(e,t.replace(/Ctrl|ctrl/g,this.textCtrl).replace(/Alt|alt/g,this.textAlt).replace(/Shift|shift/g,this.textShift))},parseFloat:function(t){return"string"==typeof t&&(t=t.replace(",",".")),parseFloat(t)},encodeSurrogateChar:function(t){var e;return t<65536?String.fromCharCode(t):(e=56320|1023&(t-=65536),String.fromCharCode(55296|t>>10)+String.fromCharCode(e))},fixedDigits:function(t,e,i){void 0===i&&(i="0");for(var n="",t=t.toString(),o=t.length;o<e;o++)n+=i;return n+t}}}),Common,Common,Common,Common,Common,Common,Common,Common,Common,Common,Common;function onDropDownKeyDown(t){var e=$(this),i=e.parent(),n=jQuery.Event("keydown.before.bs.dropdown",{keyCode:t.keyCode}),o=jQuery.Event("keydown.after.bs.dropdown",{keyCode:t.keyCode});i.trigger(n),i.hasClass("no-stop-propagate")?(1<arguments.length&&arguments[1]instanceof KeyboardEvent&&(t=arguments[1]),!/^(38|40|27|13|9|37|39)$/.test(t.keyCode)||t.ctrlKey||t.altKey||(patchDropDownKeyDownAdditional.call(this,t),/(37|39)/.test(t.keyCode)||(t.preventDefault(),t.stopPropagation()))):e.hasClass("move-focus")&&(/^(13|9|32)/.test(t.keyCode)||27===t.keyCode&&!i.hasClass("open"))&&!t.ctrlKey&&!t.altKey||(patchDropDownKeyDown.call(this,t),t.preventDefault(),t.stopPropagation()),i.trigger(o)}function checkFocusedItem(t,e){var i=t.innerHeight(),n=(i-t.height())/2,o=e.position().top,e=e.outerHeight();o<0?t.scrollTop(t.scrollTop()+o-n):i<o+e&&t.scrollTop(t.scrollTop()+o+e-i+n)}function patchDropDownKeyDown(t){if(/(38|40|27|37|39)/.test(t.keyCode)){var e=$(this);if(t.preventDefault(),t.stopPropagation(),!e.is(".disabled, :disabled")){var i=getParent(e),n=i.hasClass("open")||i.hasClass("over");if(!n||27==t.keyCode){if(27==t.which){if((s=$("[role=menu] li.dropdown-submenu.over:visible",i)).length)return s.eq(s.length-1).removeClass("over"),!1;(i.hasClass("dropdown-submenu")&&i.hasClass("over")?(i.removeClass("over"),i.find("> a")):i.find("[data-toggle=dropdown]")).focus()}return n?e.click():void 0}var o,s=$("> [role=menu] > li:not(.divider):not(.disabled):visible",i).find("> a");s.length&&(n=s.index(s.filter(":focus")),39==t.keyCode?n<0||(o=s.eq(n).parent()).hasClass("dropdown-submenu")&&!o.hasClass("over")&&(o.mouseenter(),o.addClass("focused-submenu"),_.delay(function(){var t=$("> [role=menu]",o),e=t.find("> li:not(.divider):not(.disabled):visible > a"),i=t.find("> li:not(.divider):not(.disabled):visible .dataview"),n=t.find("> li:not(.divider):not(.disabled):visible .theme-colorpalette.focused"),t=t.find("> li:not(.divider):not(.disabled):visible ul.internal-menu");0<e.length&&i.length<1&&t.length<1&&n.length<1&&e.index(e.filter(":focus"))<0&&e.eq(0).focus()},250)):37==t.keyCode?i.hasClass("dropdown-submenu")&&i.hasClass("over")&&(i.removeClass("over"),i.find("> a").focus()):(38==t.keyCode?0<n?n--:n=e.hasClass("no-cyclic")?0:s.length-1:40==t.keyCode&&(n<s.length-1?n++:n=e.hasClass("no-cyclic")?s.length-1:0),~n||(n=0),i.hasClass("dropdown-submenu")&&i.hasClass("over")&&i.addClass("focused-submenu"),checkFocusedItem(e,s.eq(n)),s.eq(n).focus()))}}}function patchDropDownKeyDownAdditional(t){if(/(38|40|27|37|39)/.test(t.keyCode)){var e=$(this);if(/(37|39)/.test(t.keyCode)||(t.preventDefault(),t.stopPropagation()),!e.is(".disabled, :disabled")){var i=getParent(e),n=i.hasClass("open")||i.hasClass("over");if(!n||27==t.keyCode||37==t.keyCode||39==t.keyCode)return n?e.click():void 0;var o,n=$("> [role=menu] > li:not(.divider):not(.disabled):visible",i).find("> a");n.length&&(o=i=n.index(n.filter(".focus")),38==t.keyCode?0<i?i--:i=e.hasClass("no-cyclic")?0:n.length-1:40==t.keyCode&&(i<n.length-1?i++:i=e.hasClass("no-cyclic")?n.length-1:0),~i||(i=0),n.removeClass("focus"),n.eq(i).addClass("focus"),o!==i&&((t=n.eq(o).parent().data("bs.tooltip"))&&t.hide(),(t=n.eq(i).parent().data("bs.tooltip"))&&t.show()))}}}function getParent(t){var e=t.attr("data-target"),e=(e=e||(e=t.attr("href"))&&/#/.test(e)&&e.replace(/.*(?=#[^\s]*$)/,""))&&$(e);return e&&e.length?e:t.parent()}function clearMenus(i){$(".dropdown-toggle").each(function(t){var e=$(this).parent();e.hasClass("open")&&("prevent-canvas-click"==e.attr("data-value")?e.attr("data-value",""):(e.trigger(t=$.Event("hide.bs.dropdown")),t.isDefaultPrevented()||e.removeClass("open").trigger("hidden.bs.dropdown",i)))})}function toggle(){$(".dropdown-backdrop").remove()}Common.Utils.String=_extend_object(utilsString,Common.Utils.String),Common.Utils.isBrowserSupported=function(){return!(0!=Common.Utils.ieVersion&&Common.Utils.ieVersion<10||0!=Common.Utils.safariVersion&&Common.Utils.safariVersion<5||0!=Common.Utils.firefoxVersion&&Common.Utils.firefoxVersion<4||0!=Common.Utils.chromeVersion&&Common.Utils.chromeVersion<7||0!=Common.Utils.operaVersion&&Common.Utils.operaVersion<10.5)},Common.Utils.showBrowserRestriction=function(){var t,e;document.getElementsByClassName&&0<document.getElementsByClassName("app-error-panel").length||(t=window.DE?"Document":window.SSE?"Spreadsheet":window.PE?"Presentation":window.PDFE?"PDF":"that",(e=document.createElement("div")).innerHTML='<div class="app-error-panel"><div class="message-block"><div class="message-inner"><div class="title">Your browser is not supported.</div><div class="text">Sorry, '+t+' Editor is currently only supported in the latest versions of the Chrome, Firefox, Safari or Internet Explorer web browsers.</div></div></div><div class="message-auxiliary"></div></div>',document.body.appendChild(e),$("#loading-mask").hide().remove(),$("#viewport").hide().remove())},Common.Utils.applyCustomization=function(t,e){for(var i in t){var n;e[i]&&(n=$(e[i])).length&&(!1===(i=t[i])||!1===i.visible||(i.text&&n.text(i.text),!1===i.visible))&&n.hide()}},Common.Utils.applyCustomizationPlugins=function(plugins){var _createXMLHTTPObject,_getPluginCode;!plugins||plugins.length<1||(_createXMLHTTPObject=function(){var e;if("undefined"!=typeof XMLHttpRequest)e=new XMLHttpRequest;else try{e=new ActiveXObject("Msxml2.XMLHTTP")}catch(t){try{e=new ActiveXObject("Microsoft.XMLHTTP")}catch(t){e=!1}}return e},_getPluginCode=function(url){if(!url)return"";try{var xhrObj=_createXMLHTTPObject();xhrObj&&url&&(xhrObj.open("GET",url,!1),xhrObj.send(""),200==xhrObj.status&&eval(xhrObj.responseText))}catch(e){}return null},plugins.forEach(function(t){t&&_getPluginCode(t)}))},Common.Utils.fillUserInfo=function(t,e,i,n){t=t||{};return t.anonymous=!t.id,t.id||(t.id=n),t.fullname=t.name||i,t.group&&(t.fullname=t.group.toString()+AscCommon.UserInfoParser.getSeparator()+t.fullname),t.guest=!t.name,t},Common.Utils.createXhr=function(){var e;if("undefined"!=typeof XMLHttpRequest)e=new XMLHttpRequest;else try{e=new ActiveXObject("Msxml2.XMLHTTP")}catch(t){try{e=new ActiveXObject("Microsoft.XMLHTTP")}catch(t){e=!1}}return e},Common.Utils.getConfigJson=function(t){if(t)try{var e=Common.Utils.createXhr();if(e)return e.open("GET",t,!1),e.send(""),JSON.parse(e.responseText)}catch(t){}return null},Common.Utils.loadConfig=function(t,e){fetch(t,{method:"get",headers:{Accept:"application/json"}}).then(function(t){return t.ok?t.json():"error"}).then(function(t){e(t)}).catch(function(t){e("error")})},Common.Utils.asyncCall=function(t,e,i){new Promise(function(t,e){t()}).then(function(){t.call(e,i)})},String.prototype.strongMatch=function(t){return!!(t&&t instanceof RegExp)&&!!((t=this.toString().match(t))&&0<t.length&&t[0].length==this.length)},Common.Utils.InternalSettings=new function(){var i={};return{get:function(t){return i[t]},set:function(t,e){i[t]=e}}},Common.Utils.lockControls=function(t,n,i,e){var o=(i=i||{}).array||e;function s(t,e){var i;t&&t.options&&_.contains(t.options.lock,e)&&(i=t.keepState.indexOf(e),n?i<0&&t.keepState.push(e):i<0||t.keepState.splice(i,1))}i.merge&&(o=_.union(e,o)),_.each(o,function(e){e&&_.isFunction(e.setDisabled)&&(e.keepState||(e.keepState=[]),i.clear&&0<i.clear.length&&0<e.keepState.length&&(e.keepState=_.difference(e.keepState,i.clear)),_.isArray(t)?_.each(t,function(t){s(e,t)}):s(e,t),0<e.keepState.length?e.isDisabled()||e.setDisabled(!0):e.isDisabled()&&e.setDisabled(!1))})},Common.Utils.injectButtons=function(n,o,s,a,l,r,c,d,h,m,p,u){var g=createButtonSet();return g.setDisabled(!0),o=o||"id-toolbar-"+s,n.each(function(t,e){var i="btn-toolbar",e=(/x-huge/.test(e.className)&&(i+=" x-huge icon-top"),new Common.UI.Button({parentEl:n.eq(t),id:o+t,cls:i,iconCls:s,caption:a,split:r||!1,menu:c||!1,enableToggle:d||!1,lock:l,disabled:!0,dataHint:h,dataHintDirection:m,dataHintOffset:p,dataHintTitle:u}));g.add(e)}),g},Common.Utils.injectComponent=function(t,e){e&&t.length&&(e.rendered?t.append(e.$el):e.render(t))},Common.Utils.warningDocumentIsLocked=function(e){e.disablefunc&&e.disablefunc(!0);var i=window.DE||window.PE||window.SSE||window.PDFE;Common.UI.warning({msg:Common.Locale.get("warnFileLocked",{name:"Common.Translation",default:"You can't edit this file. Document is in use by another application."}),buttons:[{value:"view",caption:Common.Locale.get("warnFileLockedBtnView",{name:"Common.Translation",default:"Open for viewing"})},{value:"edit",caption:Common.Locale.get("warnFileLockedBtnEdit",{name:"Common.Translation",default:"Create a copy"})}],primary:"view",callback:function(t){"edit"==t&&(e.disablefunc&&e.disablefunc(!1),i.getController("Main").api.asc_setLocalRestrictions(Asc.c_oAscLocalRestrictionType.None))}})},jQuery.fn.extend({elementById:function(i,t){var n=document.getElementById(i.substring(1));if(!n)if((t=t||this)&&0<t.length)t.each(function(t,e){if(e.querySelectorAll)if(0==(n=e.querySelectorAll(i)).length){if("#"+e.id==i)return n=e,!1}else if(n.length)return n=n[0],!1});else if(t&&t.querySelectorAll&&(n=t.querySelectorAll(i))&&n.length)return n[0];return n},findById:function(t,e){var i=$.fn.elementById.apply(this,arguments);return i?$(i):$()}}),Common.Utils.InternalSettings.set("toolbar-height-tabs",32),Common.Utils.InternalSettings.set("toolbar-height-tabs-top-title",28),Common.Utils.InternalSettings.set("toolbar-height-controls",67),Common.Utils.InternalSettings.set("document-title-height",28),Common.Utils.InternalSettings.set("window-inactive-area-top",0),Common.Utils.InternalSettings.set("toolbar-height-compact",Common.Utils.InternalSettings.get("toolbar-height-tabs")),Common.Utils.InternalSettings.set("toolbar-height-normal",Common.Utils.InternalSettings.get("toolbar-height-tabs")+Common.Utils.InternalSettings.get("toolbar-height-controls")),Common.Utils.ModalWindow=new function(){var t=0;return{show:function(){t++},close:function(){t--},isVisible:function(){return 0<t}}},Common.Utils.UserInfoParser=new function(){var o=!1,s=String.fromCharCode(160);return{setParser:function(t){o=!!t},getSeparator:function(){return s},getParsedName:function(t){return o&&t?t.substring(t.indexOf(s)+1):t},getParsedGroups:function(t){if(o&&t){for(var e=t.indexOf(s),i=-1<e?t.substring(0,e).split(","):[],n=0;n<i.length;n++)i[n]=i[n].trim();return i}}}},Common.Utils.getKeyByValue=function(t,e){for(var i in t)if(t.hasOwnProperty(i)&&t[i]===e)return i},Common.UI||(Common.UI={}),Common.UI.isRTL=function(){return null==window.isrtl&&(window.isrtl=Common.localStorage.itemExists("ui-rtl")?Common.localStorage.getBool("ui-rtl"):Common.Locale.isCurrentLanguageRtl()),window.isrtl},define("common/main/lib/util/utils",function(){}),!function(t){"function"==typeof define&&define.amd?define("jmousewheel",["jquery"],t):"object"==typeof exports?module.exports=t:t(jQuery)}(function(l){var r,c,t=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],e="onwheel"in document||9<=document.documentMode?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],d=Array.prototype.slice;if(l.event.fixHooks)for(var i=t.length;i;)l.event.fixHooks[t[--i]]=l.event.mouseHooks;var n=l.event.special.mousewheel={version:"3.1.9",setup:function(){if(this.addEventListener)for(var t=e.length;t;)this.addEventListener(e[--t],o,!1);else this.onmousewheel=o;l.data(this,"mousewheel-line-height",n.getLineHeight(this)),l.data(this,"mousewheel-page-height",n.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var t=e.length;t;)this.removeEventListener(e[--t],o,!1);else this.onmousewheel=null},getLineHeight:function(t){return parseInt(l(t)["offsetParent"in l.fn?"offsetParent":"parent"]().css("fontSize"),10)},getPageHeight:function(t){return l(t).height()},settings:{adjustOldDeltas:!0}};function o(t){var e,i=t||window.event,n=d.call(arguments,1),o=0,s=0,a=0;if((t=l.event.fix(i)).type="mousewheel","detail"in i&&(a=-1*i.detail),"wheelDelta"in i&&(a=i.wheelDelta),"wheelDeltaY"in i&&(a=i.wheelDeltaY),"wheelDeltaX"in i&&(s=-1*i.wheelDeltaX),"axis"in i&&i.axis===i.HORIZONTAL_AXIS&&(s=-1*a,a=0),o=0===a?s:a,"deltaY"in i&&(o=a=-1*i.deltaY),"deltaX"in i&&(s=i.deltaX,0===a&&(o=-1*s)),0!==a||0!==s)return 1===i.deltaMode?(o*=e=l.data(this,"mousewheel-line-height"),a*=e,s*=e):2===i.deltaMode&&(o*=e=l.data(this,"mousewheel-page-height"),a*=e,s*=e),e=Math.max(Math.abs(a),Math.abs(s)),(!c||e<c)&&m(i,c=e)&&(c/=40),m(i,e)&&(o/=40,s/=40,a/=40),o=Math[1<=o?"floor":"ceil"](o/c),s=Math[1<=s?"floor":"ceil"](s/c),a=Math[1<=a?"floor":"ceil"](a/c),t.deltaX=s,t.deltaY=a,t.deltaFactor=c,t.deltaMode=0,n.unshift(t,o,s,a),r&&clearTimeout(r),r=setTimeout(h,200),(l.event.dispatch||l.event.handle).apply(this,n)}function h(){c=null}function m(t,e){return n.settings.adjustOldDeltas&&"mousewheel"===t.type&&e%120==0}l.fn.extend({mousewheel:function(t){return t?this.bind("mousewheel",t):this.trigger("mousewheel")},unmousewheel:function(t){return this.unbind("mousewheel",t)}})}),!function(t){"use strict";"function"==typeof define&&define.amd?define("perfectscrollbar",["jquery"],t):"object"==typeof exports?t(require("jquery")):t(jQuery)}(function(O){"use strict";var e,N={wheelSpeed:10,wheelPropagation:!1,minScrollbarLength:null,useBothWheelAxes:!1,useKeyboard:!0,suppressScrollX:!1,suppressScrollY:!1,scrollXMarginOffset:0,scrollYMarginOffset:0,includePadding:!1,includeMargin:!0},z=(e=0,function(){var t=e;return e+=1,".perfect-scrollbar-"+t});O.fn.perfectScrollbar=function(B,H){return this.each(function(){var l=O.extend(!0,{},N),d=O(this);if("object"==typeof B?O.extend(!0,l,B):H=B,"update"===H)d.data("perfect-scrollbar-update")&&d.data("perfect-scrollbar-update")();else if("destroy"===H)d.data("perfect-scrollbar-destroy")&&d.data("perfect-scrollbar-destroy")();else{if(d.data("perfect-scrollbar"))return d.data("perfect-scrollbar");d.addClass("ps-container oo");var r,c,n,o,s,a,h,m,i,p,u,g,t,b=O("<div class='ps-scrollbar-x-rail'></div>").appendTo(d),C=O("<div class='ps-scrollbar-y-rail'></div>").appendTo(d),f=O("<div class='ps-scrollbar-x'></div>").appendTo(b),v=O("<div class='ps-scrollbar-y'></div>").appendTo(C),_=parseInt(b.css("bottom"),10),w=parseInt(C.css("right"),10),y=z(),e=function(t,e){t+=e,e=g-p,u=t<0?0:e<t?e:t,e=parseInt(u*(a-o)/(g-p),10);d.scrollTop(e),b.css({bottom:_-e})},x=function(t,e){t+=e,e=i-h,m=t<0?0:e<t?e:t,e=parseInt(m*(s-n)/(i-h),10);d.scrollLeft(e),C.css({right:w-e})},S=function(t){return t=l.minScrollbarLength?Math.max(t,l.minScrollbarLength):t},T=function(){b.css({left:d.scrollLeft(),bottom:_-d.scrollTop(),width:i,display:r?"inherit":"none"}),C.hasClass("in-scrolling")?C.css({right:w-d.scrollLeft(),height:g,display:c?"inherit":"none"}):C.css({top:d.scrollTop(),right:w-d.scrollLeft(),height:g,display:c?"inherit":"none"}),f&&f.css({left:m,width:h}),v&&v.css({top:u,height:p})},A=function(){n=l.includePadding?d.innerWidth():d.width(),o=l.includePadding?d.innerHeight():d.height(),g=o-(l.includeMargin?parseInt(C.css("margin-top"))+parseInt(C.css("margin-bottom")):0),i=n-(l.includeMargin?parseInt(b.css("margin-left"))+parseInt(b.css("margin-right")):0),s=d.prop("scrollWidth"),a=d.prop("scrollHeight"),!l.suppressScrollX&&n+l.scrollXMarginOffset<s?(r=!0,h=S(parseInt(i*n/s,10)),m=parseInt(d.scrollLeft()*(i-h)/(s-n),10)):(r=!1,m=h=0,d.scrollLeft(0)),!l.suppressScrollY&&o+l.scrollYMarginOffset<a?(c=!0,p=S(parseInt(g*o/a,10)),u=parseInt(d.scrollTop()*(g-p)/(a-o),10)):(c=!1,u=p=0,d.scrollTop(0)),g-p<=u&&(u=g-p),i-h<=m&&(m=i-h),T(),l.onChange&&l.onChange(this)},k=function(){var e,i;f.bind("mousedown"+y,function(t){Common.NotificationCenter.trigger("hints:clear"),i=t.pageX,e=f.position().left,b.addClass("in-scrolling"),t.stopPropagation(),t.preventDefault()}),O(document).bind("mousemove"+y,function(t){b.hasClass("in-scrolling")&&(x(e,t.pageX-i),t.stopPropagation(),t.preventDefault())}),O(document).bind("mouseup"+y,function(t){b.hasClass("in-scrolling")&&b.removeClass("in-scrolling")}),e=i=null},D=function(){var n,o;v.bind("mousedown"+y,function(t){Common.NotificationCenter.trigger("hints:clear"),o=t.pageY,n=v.position().top,C.addClass("in-scrolling");var e=parseInt(C.css("margin-top")),i=C[0].getBoundingClientRect();C.css({position:"fixed",left:i.left,top:i.top-e}),t.stopPropagation(),t.preventDefault()}),O(document).bind("mousemove"+y,function(t){C.hasClass("in-scrolling")&&(e(n,t.pageY-o),t.stopPropagation(),t.preventDefault())}),O(document).bind("mouseup"+y,function(t){C.hasClass("in-scrolling")&&(C.removeClass("in-scrolling"),C.css({position:"",left:"",top:""}),T())}),n=o=null},I=function(t,e){var i=d.scrollTop();if(0===t){if(!c)return!1;if(0===i&&0<e||a-o<=i&&e<0)return!l.wheelPropagation}i=d.scrollLeft();if(0===e){if(!r)return!1;if(0===i&&t<0||s-n<=i&&0<t)return!l.wheelPropagation}return!0},P=function(){l.wheelSpeed/=10;var a=!1;d.bind("mousewheel"+y,function(t,e,i,n){Common.NotificationCenter.trigger("hints:clear");var o,s,i=t.deltaX*t.deltaFactor||i,n=t.deltaY*t.deltaFactor||n;t&&t.target&&("textarea"===t.target.type||"input"===t.target.type)?(t.stopImmediatePropagation(),t.preventDefault(),o=O(t.target).scrollTop(),s=0,t.originalEvent?t.originalEvent.wheelDelta?s=t.originalEvent.wheelDelta:t.originalEvent.deltaY?s=40*-t.originalEvent.deltaY:t.originalEvent.detail&&(s=t.originalEvent.detail):s=void 0!==t.wheelDelta?t.wheelDelta:t.deltaY,O(t.target).scrollTop(o-s)):(a=!1,l.useBothWheelAxes?c&&!r?(n?d.scrollTop(d.scrollTop()-n*l.wheelSpeed):d.scrollTop(d.scrollTop()+i*l.wheelSpeed),a=!0):r&&!c&&(i?d.scrollLeft(d.scrollLeft()+i*l.wheelSpeed):d.scrollLeft(d.scrollLeft()-n*l.wheelSpeed),a=!0):(d.scrollTop(d.scrollTop()-n*l.wheelSpeed),d.scrollLeft(d.scrollLeft()+i*l.wheelSpeed)),A(),(a=a||I(i,n))&&(t.stopPropagation(),t.preventDefault()))}),d.bind("MozMousePixelScroll"+y,function(t){a&&t.preventDefault()})},E=function(){var n=!1;d.bind("mouseenter"+y,function(t){n=!0}),d.bind("mouseleave"+y,function(t){n=!1});O(document).bind("keydown"+y,function(t){if(n&&!O(document.activeElement).is(":input,[contenteditable]")){var e=0,i=0;switch(t.which){case 37:e=-30;break;case 38:i=30;break;case 39:e=30;break;case 40:i=-30;break;case 33:i=90;break;case 32:case 34:i=-90;break;case 35:i=-o;break;case 36:i=o;break;default:return}d.scrollTop(d.scrollTop()-i),d.scrollLeft(d.scrollLeft()+e),I(e,i)&&t.preventDefault()}})},V=function(){function t(t){t.stopPropagation()}v.bind("click"+y,t),C.bind("click"+y,function(t){var e=parseInt(p/2,10),t=(t.pageY-C.offset().top-e)/(g-p);t<0?t=0:1<t&&(t=1),d.scrollTop((a-o)*t)}),f.bind("click"+y,t),b.bind("click"+y,function(t){var e=parseInt(h/2,10),t=(t.pageX-b.offset().left-e)/(i-h);t<0?t=0:1<t&&(t=1),d.scrollLeft((s-n)*t)})},M=function(){function s(t,e){d.scrollTop(d.scrollTop()-e),d.scrollLeft(d.scrollLeft()-t),A()}var a={},l=0,r={},i=null,c=!1;O(window).bind("touchstart"+y,function(t){c=!0}),O(window).bind("touchend"+y,function(t){c=!1}),d.bind("touchstart"+y,function(t){var e=t.originalEvent.targetTouches[0];a.pageX=e.pageX,a.pageY=e.pageY,l=(new Date).getTime(),null!==i&&clearInterval(i),t.stopPropagation()}),d.bind("touchmove"+y,function(t){var e,i,n,o;c||1!==t.originalEvent.targetTouches.length||(e=t.originalEvent.targetTouches[0],(n={}).pageX=e.pageX,n.pageY=e.pageY,e=n.pageX-a.pageX,i=n.pageY-a.pageY,s(e,i),a=n,0<(o=(n=(new Date).getTime())-l)&&(r.x=e/o,r.y=i/o,l=n),t.preventDefault())}),d.bind("touchend"+y,function(t){clearInterval(i),i=setInterval(function(){Math.abs(r.x)<.01&&Math.abs(r.y)<.01?clearInterval(i):(s(30*r.x,30*r.y),r.x*=.8,r.y*=.8)},10)})},U=function(){d.bind("scroll"+y,function(t){A()})},L=function(){d.unbind(y),O(window).unbind(y),O(document).unbind(y),d.data("perfect-scrollbar",null),d.data("perfect-scrollbar-update",null),d.data("perfect-scrollbar-destroy",null),f.remove(),v.remove(),b.remove(),C.remove(),f=v=n=o=s=a=h=m=_=p=u=w=null},F=function(t){d.addClass("ie").addClass("ie"+t);function e(){O(this).addClass("hover")}function i(){O(this).removeClass("hover")}6===t&&(d.bind("mouseenter"+y,e).bind("mouseleave"+y,i),b.bind("mouseenter"+y,e).bind("mouseleave"+y,i),C.bind("mouseenter"+y,e).bind("mouseleave"+y,i),f.bind("mouseenter"+y,e).bind("mouseleave"+y,i),v.bind("mouseenter"+y,e).bind("mouseleave"+y,i),T=function(){f.css({left:m+d.scrollLeft(),bottom:_,width:h}),v.css({top:u+d.scrollTop(),right:w,height:p}),f.hide().show(),v.hide().show()})},R="ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch;(t=navigator.userAgent.toLowerCase().match(/(msie) ([\w.]+)/))&&"msie"===t[1]&&F(parseInt(t[2],10)),A(),U(),k(),D(),V(),R&&M(),d.mousewheel&&P(),l.useKeyboard&&E(),d.data("perfect-scrollbar",d),d.data("perfect-scrollbar-update",A),d.data("perfect-scrollbar-destroy",L)}return d})}}),void 0===Common&&(Common={}),define("common/main/lib/component/Scroller",["jmousewheel","perfectscrollbar","common/main/lib/component/BaseView"],function(){"use strict";var n;Common.UI.Scroller=_.extend(Common.UI.BaseView.extend({options:{wheelSpeed:20,wheelPropagation:!1,minScrollbarLength:null,useBothWheelAxes:!1,useKeyboard:!0,suppressScrollX:!1,suppressScrollY:!1,scrollXMarginOffset:5,scrollYMarginOffset:5,includePadding:!0,includeMargin:!0,alwaysVisibleX:!1,alwaysVisibleY:!1,scrollYStyle:null},initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t),this.options.el&&this.render()},render:function(){return this.cmpEl=this.$el||$(this.el),this.rendered||(this.cmpEl.perfectScrollbar(_.extend({},this.options)),this.rendered=!0,this.setAlwaysVisibleX(this.options.alwaysVisibleX),this.setAlwaysVisibleY(this.options.alwaysVisibleY),this.options.scrollYStyle&&this.setOptionStyleY(this.options.scrollYStyle)),this},remove:function(){this.destroy(),Backbone.View.prototype.remove.call(this)},update:function(t){function e(t){function e(t){$(document).unbind("mouseup",e),_.delay(function(){n=!1},10)}n=!0,$(document).mouseup(e)}var i=this.options;t?(this.destroy(),i=_.extend(this.options,t),this.cmpEl.perfectScrollbar(i)):this.cmpEl.perfectScrollbar("update"),this.setAlwaysVisibleX(i.alwaysVisibleX),this.setAlwaysVisibleY(i.alwaysVisibleY),i.scrollYStyle&&this.setOptionStyleY(i.scrollYStyle);$(".ps-scrollbar-x-rail, .ps-scrollbar-y-rail, .ps-scrollbar-x, .ps-scrollbar-y",this.cmpEl).off("mousedown",e).on("mousedown",e)},destroy:function(){this.cmpEl.perfectScrollbar("destroy")},scrollLeft:function(t){this.cmpEl.scrollLeft(t),this.update()},scrollTop:function(t){this.cmpEl.scrollTop(t),this.update()},getScrollTop:function(){return this.cmpEl.scrollTop()},getScrollLeft:function(){return this.cmpEl.scrollLeft()},setAlwaysVisibleX:function(t){t?$(this.el).find(".ps-scrollbar-x-rail").addClass("always-visible-x"):$(this.el).find(".ps-scrollbar-x-rail").removeClass("always-visible-x"),$(this.el).find(".ps-scrollbar-x").addClass("always-visible-x")},setAlwaysVisibleY:function(t){t?$(this.el).find(".ps-scrollbar-y-rail").addClass("always-visible-y"):$(this.el).find(".ps-scrollbar-y-rail").removeClass("always-visible-y"),$(this.el).find(".ps-scrollbar-y").addClass("always-visible-y")},setOptionStyleY:function(t){$(this.el).find(".ps-scrollbar-y-rail").css(t),this.cmpEl.perfectScrollbar("update")},isVisible:function(){return $(this.el).find(".ps-scrollbar-y-rail").is(":visible")}}),{isMouseCapture:function(){return n}})}),void 0===Common&&(Common={}),define("common/main/lib/component/DataView",["common/main/lib/component/BaseView","common/main/lib/component/Scroller"],function(){"use strict";Common.UI.DataViewGroupModel=Backbone.Model.extend({defaults:function(){return{id:Common.UI.getId(),caption:"",inline:!1,headername:void 0}}}),Common.UI.DataViewGroupStore=Backbone.Collection.extend({model:Common.UI.DataViewGroupModel}),Common.UI.DataViewModel=Backbone.Model.extend({defaults:function(){return{id:Common.UI.getId(),selected:!1,allowSelected:!0,value:null,disabled:!1}}}),Common.UI.DataViewStore=Backbone.Collection.extend({model:Common.UI.DataViewModel}),Common.UI.DataViewItem=Common.UI.BaseView.extend({options:{},template:_.template(['<div id="<%= id %>"><%= value %></div>'].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);t=this;t.template=t.options.template||t.template,t.dataHint=t.options.dataHint||"",t.dataHintDirection=t.options.dataHintDirection||"",t.dataHintOffset=t.options.dataHintOffset||"",t.scaling=t.options.scaling,t.listenTo(t.model,"change",this.model.get("skipRenderOnChange")?t.onChange:t.render),t.listenTo(t.model,"change:selected",t.onSelectChange),t.listenTo(t.model,"remove",t.remove)},render:function(){var t,e;return _.isUndefined(this.model.id)||((t=this.$el||$(this.el)).html(this.template(this.model.toJSON())),t.addClass("item"),t.toggleClass("selected",this.model.get("selected")&&this.model.get("allowSelected")),""!==this.dataHint&&(t.attr("data-hint",this.dataHint),t.attr("data-hint-direction",this.dataHintDirection),t.attr("data-hint-offset",this.dataHintOffset)),_.isUndefined(this.model.get("contentTarget"))||t.attr("content-target",this.model.get("contentTarget")),t.off("click dblclick contextmenu"),t.on({click:_.bind(this.onClick,this),dblclick:_.bind(this.onDblClick,this),contextmenu:_.bind(this.onContextMenu,this)}),t.toggleClass("disabled",!!this.model.get("disabled")),_.isUndefined(this.model.get("cls"))||t.addClass(this.model.get("cls")),(e=t.data("bs.tooltip"))&&void 0===e.dontShow&&t.is(":hover")&&(e.dontShow=!0),!1!==this.scaling&&t.find(".options__icon").length&&(t.attr("ratio","ratio"),this.applyScaling(Common.UI.Scaling.currentRatio()),t.on("app:scaling",_.bind(function(t,e){this.scaling!=e.ratio&&this.applyScaling(e.ratio)},this))),this.trigger("change",this,this.model)),this},remove:function(){this.stopListening(this.model),this.trigger("remove",this,this.model),Common.UI.BaseView.prototype.remove.call(this)},onClick:function(t){if(this.model.get("disabled"))return!1;this.trigger("click",this,this.model,t)},onDblClick:function(t){if(this.model.get("disabled"))return!1;this.trigger("dblclick",this,this.model,t)},onContextMenu:function(t){this.trigger("contextmenu",this,this.model,t)},onSelectChange:function(t,e){this.trigger("select",this,t,e)},onChange:function(){var t;return _.isUndefined(this.model.id)||((t=this.$el||$(this.el)).toggleClass("selected",this.model.get("selected")&&this.model.get("allowSelected")),t.toggleClass("disabled",!!this.model.get("disabled")),this.trigger("change",this,this.model)),this},applyScaling:function(t){var e;2<(this.scaling=t)&&(0<(e=(t=this.$el||$(this.el)).find(".options__icon")).length&&(t.find("svg.icon").length||(t=e.attr("class"),t=(t=/btn-[^\s]+/.exec(t))?t[0]:"null",t='<svg class="icon"><use class="zoom-int" href="#%iconname"></use></svg>'.replace("%iconname",t),e.after(t))))}}),Common.UI.DataView=Common.UI.BaseView.extend({options:{multiSelect:!1,handleSelect:!0,enableKeyEvents:!0,keyMoveDirection:"both",restoreHeight:0,emptyText:"",listenStoreEvents:!0,allowScrollbar:!0,scrollAlwaysVisible:!1,minScrollbarLength:40,scrollYStyle:null,showLast:!0,useBSKeydown:!1,cls:""},template:_.template(['<div class="dataview inner <%= cls %>" style="<%= style %>">',"<% _.each(groups, function(group) { %>","<% if (group.headername !== undefined) { %>",'<div class="header-name"><%= group.headername %></div>',"<% } %>",'<div class="grouped-data <% if (group.inline) { %> inline <% } %> <% if (!_.isEmpty(group.caption)) { %> margin <% } %>" id="<%= group.id %>">',"<% if (!_.isEmpty(group.caption)) { %>",'<div class="group-description">',"<span><%= group.caption %></span>","</div>","<% } %>",'<div class="group-items-container">',"</div>","</div>","<% }); %>","</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);t=this;t.template=t.options.template||t.template,t.store=t.options.store||new Common.UI.DataViewStore,t.groups=t.options.groups||null,t.itemTemplate=t.options.itemTemplate||null,t.itemDataHint=t.options.itemDataHint||"",t.itemDataHintDirection=t.options.itemDataHintDirection||"",t.itemDataHintOffset=t.options.itemDataHintOffset||"",t.multiSelect=t.options.multiSelect,t.handleSelect=t.options.handleSelect,t.parentMenu=t.options.parentMenu,t.outerMenu=t.options.outerMenu,t.enableKeyEvents=t.options.enableKeyEvents,t.useBSKeydown=t.options.useBSKeydown,t.showLast=t.options.showLast,t.style=t.options.style||"",t.cls=t.options.cls||"",t.emptyText=t.options.emptyText||"",t.listenStoreEvents=void 0===t.options.listenStoreEvents||t.options.listenStoreEvents,t.allowScrollbar=void 0===t.options.allowScrollbar||t.options.allowScrollbar,t.scrollAlwaysVisible=t.options.scrollAlwaysVisible||!1,t.minScrollbarLength=t.options.minScrollbarLength||40,t.scrollYStyle=t.options.scrollYStyle,t.tabindex=t.options.tabindex||0,t.delayRenderTips=t.options.delayRenderTips||!1,t.parentMenu&&(t.parentMenu.options.restoreHeight=0<t.options.restoreHeight),t.delaySelect=t.options.delaySelect||!1,t.rendered=!1,t.dataViewItems=[],"vertical"==t.options.keyMoveDirection?t.moveKeys=[Common.UI.Keys.UP,Common.UI.Keys.DOWN]:"horizontal"==t.options.keyMoveDirection?t.moveKeys=[Common.UI.Keys.LEFT,Common.UI.Keys.RIGHT]:t.moveKeys=[Common.UI.Keys.UP,Common.UI.Keys.DOWN,Common.UI.Keys.LEFT,Common.UI.Keys.RIGHT],!1===t.options.scaling&&(t.cls=t.options.cls+" scaling-off"),t.options.el&&t.render()},render:function(t){var i=this,t=(this.trigger("render:before",this),t?(this.setElement(t,!1),this.cmpEl=$(this.template({groups:i.groups?i.groups.toJSON():null,style:i.style,cls:i.cls,options:i.options})),t.html(this.cmpEl)):(this.cmpEl=i.$el||$(this.el),this.cmpEl.html(this.template({groups:i.groups?i.groups.toJSON():null,style:i.style,cls:i.cls,options:i.options}))),this.cmpEl.closest(".asc-window"));return 0<(t=t.length<1?this.cmpEl.closest('[id^="menu-container-"]'):t).length&&(this.tipZIndex=parseInt(t.css("z-index"))+10),this.rendered||(this.listenStoreEvents&&(this.listenTo(this.store,"add",this.onAddItem),this.listenTo(this.store,"reset",this.onResetItems),this.groups&&(this.listenTo(this.groups,"add",this.onAddGroup),this.listenTo(this.groups,"remove",this.onRemoveGroup))),this.onResetItems(),this.parentMenu&&(this.cmpEl.closest("li").css("height","100%"),this.cmpEl.css("height","100%"),this.parentMenu.on("show:after",_.bind(this.alignPosition,this))),this.enableKeyEvents&&this.parentMenu&&this.handleSelect&&(i.showLast||this.parentMenu.on("show:before",function(t){i.deselectAll()}),this.parentMenu.on("show:after",function(t,e){e&&t.el!==e.target||(i.showLast&&i.showLastSelected(),Common.NotificationCenter.trigger("dataview:focus"),_.delay(function(){t.cmpEl.find(".dataview").focus()},10))}).on("hide:after",function(){Common.NotificationCenter.trigger("dataview:blur")}))),_.isUndefined(this.scroller)&&this.allowScrollbar&&(this.scroller=new Common.UI.Scroller({el:$(this.el).find(".inner").addBack().filter(".inner"),useKeyboard:this.enableKeyEvents&&!this.handleSelect,minScrollbarLength:this.minScrollbarLength,scrollYStyle:this.scrollYStyle,wheelSpeed:10,alwaysVisibleY:this.scrollAlwaysVisible})),this.rendered=!0,this.cmpEl.on("click",function(t){if(/dataview/.test(t.target.className))return!1}),this.trigger("render:after",this),this},setStore:function(t){t&&(this.stopListening(this.store),this.store=t,this.listenStoreEvents&&(this.listenTo(this.store,"add",this.onAddItem),this.listenTo(this.store,"reset",this.onResetItems)))},selectRecord:function(e,t){var i,n;if(this.handleSelect)return t&&this.suspendEvents(),this.extremeSeletedRec=e,!this.multiSelect||!this.pressedShift&&!this.pressedCtrl||!this.currentSelectedRec||this.pressedShift&&this.currentSelectedRec==e?(_.each(this.store.where({selected:!0}),function(t){t.set({selected:!1})}),e&&(e.set({selected:!0}),this.currentSelectedRec=e)):e&&(this.pressedCtrl?(e.set({selected:!e.get("selected")}),this.currentSelectedRec=e):this.pressedShift&&(i=this,n=!1,_.each(i.store.models,function(t){i.currentSelectedRec==t||e==t?(n=!n,t.set({selected:!0})):t.set({selected:n})}))),t&&this.resumeEvents(),e},selectByIndex:function(t,e){if(0<this.store.length&&-1<t&&t<this.store.length)return this.selectRecord(this.store.at(t),e)},deselectAll:function(t){t&&this.suspendEvents(),_.each(this.store.where({selected:!0}),function(t){t.set({selected:!1})}),t&&this.resumeEvents()},getSelectedRec:function(){return this.multiSelect?this.store.where({selected:!0}):this.store.findWhere({selected:!0})},onAddItem:function(t,e,i){var n,o,s,a,l=new Common.UI.DataViewItem({template:this.itemTemplate,model:t,scaling:this.options.scaling,dataHint:this.itemDataHint,dataHintDirection:this.itemDataHintDirection,dataHintOffset:this.itemDataHintOffset});l&&(n=$(this.el).find(".inner").addBack().filter(".inner"),this.groups&&0<this.groups.length&&((o=this.groups.findWhere({id:t.get("group")}))&&(n=n.find("#"+o.id+" .group-items-container"))),o=_.indexOf(this.store.models,t),n&&(i&&"number"==typeof i.at&&0<=i.at?0==i.at?n.prepend(l.render().el):this.groups&&0<this.groups.length?n.append(l.render().el):(i=n.find("> div"),0<o?$(i.get(o-1)).after(l.render().el):0<i.length?$(i[o]).before(l.render().el):n.append(l.render().el)):n.append(l.render().el),this.dataViewItems.length<1&&n.find(".empty-text").remove(),this.dataViewItems=this.dataViewItems.slice(0,o).concat(l).concat(this.dataViewItems.slice(o)),s=this,a=$(l.el),null!=t.get("tip")&&(this.delayRenderTips?a.one("mouseenter",function(){a.attr("data-toggle","tooltip"),a.tooltip({title:t.get("tip"),placement:"cursor",zIndex:s.tipZIndex}),a.mouseenter()}):(a.attr("data-toggle","tooltip"),a.tooltip({title:t.get("tip"),placement:"cursor",zIndex:s.tipZIndex}))),this.listenTo(l,"change",this.onChangeItem),this.listenTo(l,"remove",this.onRemoveItem),this.listenTo(l,"click",this.onClickItem),this.listenTo(l,"dblclick",this.onDblClickItem),this.listenTo(l,"select",this.onSelectItem),this.listenTo(l,"contextmenu",this.onContextMenuItem),this.isSuspendEvents||this.trigger("item:add",this,l,t))),this._layoutParams=void 0},onAddGroup:function(t){var e,i=$(_.template(["<% if (group.headername !== undefined) { %>",'<div class="header-name"><%= group.headername %></div>',"<% } %>",'<div class="grouped-data <% if (group.inline) { %> group.inline <% } %> <% if (!_.isEmpty(group.caption)) { %> margin <% } %>" id="<%= group.id %>">',"<% if (!_.isEmpty(group.caption)) { %>",'<div class="group-description">',"<span><%= group.caption %></span>","</div>","<% } %>",'<div class="group-items-container">',"</div>","</div>"].join(""))({group:t.toJSON()})),n=$(this.el).find(".inner").addBack().filter(".inner");n&&(t=_.indexOf(this.groups.models,t),e=n.find(".grouped-data"),0<t?$(e.get(t-1)).after(i):0<e.length?$(e[t]).before(i):n.append(i))},onRemoveGroup:function(t){var e=$(this.el).find(".inner").addBack().filter(".inner");e&&(e=e.find("#"+t.get("id")+".grouped-data"))&&e.remove(),this._layoutParams=void 0},onResetItems:function(){this.trigger("reset:before",this),_.each(this.dataViewItems,function(t){t=t.$el.data("bs.tooltip");t&&(void 0===t.dontShow&&(t.dontShow=!0),t.tip().remove())},this),$(this.el).html(this.template({groups:this.groups?this.groups.toJSON():null,style:this.style,cls:this.cls,options:this.options})),_.isUndefined(this.scroller)||(this.scroller.destroy(),delete this.scroller),this.store.length<1&&0<this.emptyText.length&&$(this.el).find(".inner").addBack().filter(".inner").append('<table cellpadding="10" class="empty-text"><tr><td>'+this.emptyText+"</td></tr></table>"),_.each(this.dataViewItems,function(t){this.stopListening(t),t.stopListening(t.model)},this),this.dataViewItems=[];var e=this;this.store.each(function(t){e.onAddItem(t,e.store)},this),this.allowScrollbar&&(this.scroller=new Common.UI.Scroller({el:$(this.el).find(".inner").addBack().filter(".inner"),useKeyboard:this.enableKeyEvents&&!this.handleSelect,minScrollbarLength:this.minScrollbarLength,scrollYStyle:this.scrollYStyle,wheelSpeed:10,alwaysVisibleY:this.scrollAlwaysVisible})),this.disabled&&this.setDisabled(this.disabled),this.attachKeyEvents(),this.lastSelectedRec=null,this._layoutParams=void 0},onChangeItem:function(t,e){this.isSuspendEvents||this.trigger("item:change",this,t,e)},onRemoveItem:function(t,e){var i=t.$el.data("bs.tooltip");i&&(void 0===i.dontShow&&(i.dontShow=!0),i.tip().remove()),this.stopListening(t),t.stopListening(),this.store.length<1&&0<this.emptyText.length&&((i=$(this.el).find(".inner").addBack().filter(".inner")).find(".empty-text").length<=0&&i.append('<table cellpadding="10" class="empty-text"><tr><td>'+this.emptyText+"</td></tr></table>"));for(var n=0;n<this.dataViewItems.length;n++)if(_.isEqual(t,this.dataViewItems[n])){this.dataViewItems.splice(n,1);break}this.isSuspendEvents||this.trigger("item:remove",this,t,e),this._layoutParams=void 0},onClickItem:function(t,e,i){var n;this.disabled||(window._event=i,this.multiSelect&&(i&&i.ctrlKey?this.pressedCtrl=!0:i&&i.shiftKey&&(this.pressedShift=!0)),this.showLast&&(this.delaySelect?(_.each(this.store.where({selected:!0}),function(t){t.set({selected:!1})}),e&&setTimeout(_.bind(function(){e.set({selected:!0}),this.trigger("item:click",this,t,e,i)},this),300)):this.selectRecord(e)),this.lastSelectedRec=null,(n=t.$el.data("bs.tooltip"))&&n.tip().remove(),this.isSuspendEvents||this.delaySelect||this.trigger("item:click",this,t,e,i))},onDblClickItem:function(t,e,i){this.disabled||(window._event=i,this.showLast&&this.selectRecord(e),this.lastSelectedRec=null,this.isSuspendEvents||this.trigger("item:dblclick",this,t,e,i))},onSelectItem:function(t,e,i){this.isSuspendEvents||this.trigger(i?"item:select":"item:deselect",this,t,e,this._fromKeyDown)},onContextMenuItem:function(t,e,i){this.isSuspendEvents||this.trigger("item:contextmenu",this,t,e,i)},scrollToRecord:function(t,e,i){var n,o,s;t&&(i=(n=$(this.el).find(".inner")).offset().top+(i||0),(o=0<=(o=_.indexOf(this.store.models,t))&&this.dataViewItems.length>o?$(this.dataViewItems[o].el):n.find("#"+t.get("id"))).length<=0||(t=o.offset().top,s=0<(s=$(this.dataViewItems[0].el)).length?s[0].clientTop:0,(e||t<i+s||t+.9*o.outerHeight()>i+s+n.height())&&(this.scroller&&this.allowScrollbar?this.scroller.scrollTop(n.scrollTop()+t-i-s,0):n.scrollTop(n.scrollTop()+t-i-s))))},onKeyDown:function(t,e){if(!this.disabled)if(void 0===e&&(e=t),this.multiSelect&&(e.keyCode==Common.UI.Keys.CTRL?this.pressedCtrl=!0:e.keyCode==Common.UI.Keys.SHIFT&&(this.pressedShift=!0)),-1<_.indexOf(this.moveKeys,e.keyCode)||e.keyCode==Common.UI.Keys.RETURN){e.preventDefault(),e.stopPropagation();var i=this.multiSelect?this.extremeSeletedRec:this.getSelectedRec();if(null===this.lastSelectedRec&&(this.lastSelectedRec=i),e.keyCode==Common.UI.Keys.RETURN)this.lastSelectedRec=null,this.selectedBeforeHideRec&&(i=this.selectedBeforeHideRec),this.trigger("item:click",this,this,i,t),this.trigger("item:select",this,this,i,t),this.trigger("entervalue",this,i,t),this.parentMenu&&this.parentMenu.hide();else{this.pressedCtrl=!1;var n=_.indexOf(this.store.models,i);if(n<0)e.keyCode==Common.UI.Keys.LEFT&&0<(o=$(t.target).closest(".dropdown-submenu.over")).length?(o.removeClass("over"),o.find("> a").focus()):n=0;else if("both"==this.options.keyMoveDirection){void 0===this._layoutParams&&this.fillIndexesArray();var o,s=this.dataViewItems[n].topIdx,a=this.dataViewItems[n].leftIdx,n=void 0;if(e.keyCode==Common.UI.Keys.LEFT)for(;void 0===n;){if(--a<0){if(0<(o=$(t.target).closest(".dropdown-submenu.over")).length){o.removeClass("over"),o.find("> a").focus();break}a=this._layoutParams.columns-1}n=this._layoutParams.itemsIndexes[s][a]}else if(e.keyCode==Common.UI.Keys.RIGHT)for(;void 0===n;)++a>this._layoutParams.columns-1&&(a=0),n=this._layoutParams.itemsIndexes[s][a];else if(e.keyCode==Common.UI.Keys.UP){if(0==s&&this.outerMenu&&this.outerMenu.menu)return this.deselectAll(!0),void(this.outerMenu.menu.focusOuter&&this.outerMenu.menu.focusOuter(e,this.outerMenu.index));for(;void 0===n;)--s<0&&(s=this._layoutParams.rows-1),n=this._layoutParams.itemsIndexes[s][a]}else{if(s==this._layoutParams.rows-1&&this.outerMenu&&this.outerMenu.menu)return this.deselectAll(!0),void(this.outerMenu.menu.focusOuter&&this.outerMenu.menu.focusOuter(e,this.outerMenu.index));for(;void 0===n;)++s>this._layoutParams.rows-1&&(s=0),n=this._layoutParams.itemsIndexes[s][a]}}else n=e.keyCode==Common.UI.Keys.UP||e.keyCode==Common.UI.Keys.LEFT?Math.max(0,n-1):Math.min(this.store.length-1,n+1);(i=void 0!==n&&0<=n?this.store.at(n):i)&&(this._fromKeyDown=!0,this.selectRecord(i),this.scrollToRecord(i),this._fromKeyDown=!1)}}else this.trigger("item:keydown",this,i,t)},onKeyUp:function(t){t.keyCode==Common.UI.Keys.SHIFT&&(this.pressedShift=!1),t.keyCode==Common.UI.Keys.CTRL&&(this.pressedCtrl=!1),this.trigger("item:keyup",this,t)},attachKeyEvents:function(){var t;this.enableKeyEvents&&this.handleSelect&&((t=$(this.el).find(".inner").addBack().filter(".inner")).addClass("canfocused"),t.attr("tabindex",this.tabindex.toString()),t.on(this.parentMenu&&this.useBSKeydown?"dataview:keydown":"keydown",_.bind(this.onKeyDown,this)),t.on(this.parentMenu&&this.useBSKeydown?"dataview:keyup":"keyup",_.bind(this.onKeyUp,this)))},showLastSelected:function(){var t;this.lastSelectedRec?(this.selectRecord(this.lastSelectedRec,!0),this.scrollToRecord(this.lastSelectedRec),this.lastSelectedRec=null):(t=this.getSelectedRec(),this.multiSelect?t&&0<t.length&&this.scrollToRecord(t[t.length-1]):this.scrollToRecord(t))},setDisabled:function(t){this.disabled=t=!!t,$(this.el).find(".inner").addBack().filter(".inner").toggleClass("disabled",t)},isDisabled:function(){return this.disabled},setEmptyText:function(t){this.emptyText=t,this.store.length<1&&(0<(t=$(this.el).find(".inner").addBack().filter(".inner").find(".empty-text td")).length&&t.text(this.emptyText))},alignPosition:function(){var t="menu"===this.parentMenu.cmpEl.attr("role")?this.parentMenu.cmpEl:this.parentMenu.cmpEl.find("[role=menu]"),e=Common.Utils.innerHeight()-10,i=$(this.el).find(".inner").addBack().filter(".inner"),n=t.outerHeight(),o=i.height(),s=Math.max(n-o,0),t=parseInt(t.css("top")),a={minScrollbarLength:this.minScrollbarLength};this.scrollAlwaysVisible&&(a.alwaysVisibleY=this.scrollAlwaysVisible),e<t+n?(i.css("max-height",e-t-s+"px"),this.allowScrollbar&&this.scroller.update(a)):t+n<e&&o<this.options.restoreHeight&&(i.css("max-height",Math.min(e-t-s,this.options.restoreHeight)+"px"),this.allowScrollbar&&this.scroller.update(a))},fillIndexesArray:function(){if(!(this.dataViewItems.length<=0)){this._layoutParams={itemsIndexes:[],columns:0,rows:0};for(var t=$(this.dataViewItems[0].el),e=t.outerWidth()+parseFloat(t.css("margin-left"))+parseFloat(t.css("margin-right")),i=this.$el.offset().left,n=t.offset().top,o=-1,s=0,a=0;a<this.dataViewItems.length;a++){var l=$(this.dataViewItems[a].el).offset().top-n,r=Math.floor(($(this.dataViewItems[a].el).offset().left-i)/e+.01);o<l&&(o=l,this._layoutParams.itemsIndexes.push([]),s=this._layoutParams.itemsIndexes.length-1),this._layoutParams.itemsIndexes[s][r]=a,this.dataViewItems[a].topIdx=s,this.dataViewItems[a].leftIdx=r,this._layoutParams.columns<r&&(this._layoutParams.columns=r)}this._layoutParams.rows=this._layoutParams.itemsIndexes.length,this._layoutParams.columns++}},setMultiselectMode:function(t){this.pressedCtrl=!!t},onResize:function(){this._layoutParams=void 0},focus:function(t){var e;$(this.el).find(".inner").addBack().filter(".inner").focus(),"string"==typeof t?"first"==t?e=this.selectByIndex(0,!0):"last"==t&&(void 0===this._layoutParams&&this.fillIndexesArray(),e=this.selectByIndex(this._layoutParams.itemsIndexes[this._layoutParams.rows-1][0],!0)):void 0!==t&&(e=this.selectByIndex(t,!0)),this.scrollToRecord(e)},focusInner:function(t){this.focus(t.keyCode==Common.UI.Keys.DOWN?"first":"last")}}),Common.UI.DataViewSimple=Common.UI.BaseView.extend({options:{handleSelect:!0,enableKeyEvents:!0,keyMoveDirection:"both",restoreHeight:0,scrollAlwaysVisible:!1,useBSKeydown:!1},template:_.template(['<div class="dataview inner" style="<%= style %>">',"<% _.each(items, function(item) { %>","<% if (!item.id) item.id = Common.UI.getId(); %>",'<div class="item" <% if(!!item.tip) { %> data-toggle="tooltip" <% } %> data-hint="<%= item.dataHint %>" data-hint-direction="<%= item.dataHintDirection %>" data-hint-offset="<%= item.dataHintOffset %>"><%= itemTemplate(item) %></div>',"<% }) %>","</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);t=this;t.template=t.options.template||t.template,t.store=t.options.store||new Common.UI.DataViewStore,t.itemTemplate=t.options.itemTemplate||null,t.handleSelect=t.options.handleSelect,t.parentMenu=t.options.parentMenu,t.enableKeyEvents=t.options.enableKeyEvents,t.useBSKeydown=t.options.useBSKeydown,t.style=t.options.style||"",t.scrollAlwaysVisible=t.options.scrollAlwaysVisible||!1,t.tabindex=t.options.tabindex||0,t.parentMenu&&(t.parentMenu.options.restoreHeight=0<t.options.restoreHeight),t.rendered=!1,"vertical"==t.options.keyMoveDirection?t.moveKeys=[Common.UI.Keys.UP,Common.UI.Keys.DOWN]:"horizontal"==t.options.keyMoveDirection?t.moveKeys=[Common.UI.Keys.LEFT,Common.UI.Keys.RIGHT]:t.moveKeys=[Common.UI.Keys.UP,Common.UI.Keys.DOWN,Common.UI.Keys.LEFT,Common.UI.Keys.RIGHT],t.options.el&&t.render()},render:function(t){var e=this,t=(this.trigger("render:before",this),t?(this.setElement(t,!1),this.cmpEl=$(this.template({items:e.store.toJSON(),itemTemplate:e.itemTemplate,style:e.style})),t.html(this.cmpEl)):(this.cmpEl=e.$el||$(this.el),this.cmpEl.html(this.template({items:e.store.toJSON(),itemTemplate:e.itemTemplate,style:e.style,options:e.options}))),this.cmpEl.closest(".asc-window"));return 0<(t=t.length<1?this.cmpEl.closest('[id^="menu-container-"]'):t).length&&(this.tipZIndex=parseInt(t.css("z-index"))+10),this.rendered||(this.parentMenu?(this.cmpEl.closest("li").css("height","100%"),this.cmpEl.css("height","100%"),this.parentMenu.on("show:after",_.bind(this.alignPosition,this)),this.parentMenu.on("show:after",_.bind(this.onAfterShowMenu,this))):0<this.store.length&&this.onAfterShowMenu(),this.enableKeyEvents&&this.parentMenu&&this.handleSelect&&(this.parentMenu.on("show:before",function(t){e.deselectAll()}),this.parentMenu.on("show:after",function(t){Common.NotificationCenter.trigger("dataview:focus"),_.delay(function(){t.cmpEl.find(".dataview").focus()},10)}).on("hide:after",function(){Common.NotificationCenter.trigger("dataview:blur")})),this.attachKeyEvents(),this.cmpEl.on("click","div.item",_.bind(e.onClickItem,e))),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:$(this.el).find(".inner").addBack().filter(".inner"),useKeyboard:this.enableKeyEvents&&!this.handleSelect,minScrollbarLength:this.minScrollbarLength,scrollYStyle:this.scrollYStyle,wheelSpeed:10,alwaysVisibleY:this.scrollAlwaysVisible})),this.rendered=!0,this.cmpEl.on("click",function(t){if(/dataview/.test(t.target.className))return!1}),this.trigger("render:after",this),this},selectRecord:function(t,e){var i;if(this.handleSelect)return e&&this.suspendEvents(),this.deselectAll(e),t&&(t.set({selected:!0}),0<=(i=_.indexOf(this.store.models,t))&&this.dataViewItems&&this.dataViewItems.length>i&&this.dataViewItems[i].el.addClass("selected")),e&&this.resumeEvents(),t},selectByIndex:function(t,e){if(0<this.store.length&&-1<t&&t<this.store.length)return this.selectRecord(this.store.at(t),e)},deselectAll:function(t){t&&this.suspendEvents(),_.each(this.store.where({selected:!0}),function(t){t.set({selected:!1})}),this.cmpEl.find(".item.selected").removeClass("selected"),t&&this.resumeEvents()},getSelectedRec:function(){return this.store.findWhere({selected:!0})},onResetItems:function(){this.dataViewItems&&_.each(this.dataViewItems,function(t){t=t.el.data("bs.tooltip");t&&(void 0===t.dontShow&&(t.dontShow=!0),t.tip().remove())},this),this.dataViewItems=null;var t=_.template(["<% _.each(items, function(item) { %>","<% if (!item.id) item.id = Common.UI.getId(); %>",'<div class="item" <% if(!!item.tip) { %> data-toggle="tooltip" <% } %> data-hint="<%= item.dataHint %>" data-hint-direction="<%= item.dataHintDirection %>" data-hint-offset="<%= item.dataHintOffset %>"><%= itemTemplate(item) %></div>',"<% }) %>"].join(""));this.cmpEl&&this.cmpEl.find(".inner").html(t({items:this.store.toJSON(),itemTemplate:this.itemTemplate,style:this.style})),_.isUndefined(this.scroller)||(this.scroller.destroy(),delete this.scroller),this.scroller=new Common.UI.Scroller({el:$(this.el).find(".inner").addBack().filter(".inner"),useKeyboard:this.enableKeyEvents&&!this.handleSelect,minScrollbarLength:this.minScrollbarLength,scrollYStyle:this.scrollYStyle,wheelSpeed:10,alwaysVisibleY:this.scrollAlwaysVisible}),!this.parentMenu&&0<this.store.length&&this.onAfterShowMenu(),this._layoutParams=void 0},setStore:function(t){t&&(this.store=t,this.onResetItems())},onClickItem:function(t){var e,i,n;this.disabled||(window._event=t,e=0<=(i=$(t.currentTarget).closest("div.item").index())?this.store.at(i):null,i=0<=i?this.dataViewItems[i]:null,e&&i&&(e.set({selected:!0}),(n=i.el.data("bs.tooltip"))&&n.tip().remove(),this.isSuspendEvents||this.trigger("item:click",this,i.el,e,t)))},onAfterShowMenu:function(t){var i;this.dataViewItems||((i=this).dataViewItems=[],_.each(this.cmpEl.find("div.item"),function(t,e){t=$(t),e=i.store.at(e);i.dataViewItems.push({el:t}),e.get("tip")&&t.tooltip({title:e.get("tip"),placement:"cursor",zIndex:i.tipZIndex})}))},scrollToRecord:function(t){var e,i,n,o;t&&(i=(e=$(this.el).find(".inner")).offset().top,(n=0<=(n=_.indexOf(this.store.models,t))&&this.dataViewItems.length>n?this.dataViewItems[n].el:e.find("#"+t.get("id"))).length<=0||((t=n.offset().top)<i+(o=0<(o=this.dataViewItems[0].el).length?o[0].offsetTop:0)||t+n.outerHeight()>i+e.height())&&(this.scroller?this.scroller.scrollTop(e.scrollTop()+t-i-o,0):e.scrollTop(e.scrollTop()+t-i-o)))},onKeyDown:function(t,e){if(!this.disabled)if(void 0===e&&(e=t),-1<_.indexOf(this.moveKeys,e.keyCode)||e.keyCode==Common.UI.Keys.RETURN){e.preventDefault(),e.stopPropagation();var i=this.getSelectedRec();if(e.keyCode==Common.UI.Keys.RETURN)this.selectedBeforeHideRec&&(i=this.selectedBeforeHideRec),this.canAddRecents&&this.addRecentItem(i),this.trigger("item:click",this,this,i,t),this.parentMenu&&this.parentMenu.hide();else{if((l=_.indexOf(this.store.models,i))<0){function n(){for(var t=0;!this.dataViewItems[t].el.is(":visible");)t++;return t}e.keyCode==Common.UI.Keys.LEFT&&0<(o=$(t.target).closest(".dropdown-submenu.over")).length?(o.removeClass("over"),o.find("> a").focus()):l=n.call(this)}else if("both"==this.options.keyMoveDirection){void 0===this._layoutParams&&this.fillIndexesArray();var o,s=this.dataViewItems[l].topIdx,a=this.dataViewItems[l].leftIdx,l=void 0;if(e.keyCode==Common.UI.Keys.LEFT)for(;void 0===l;){if(--a<0){if(0<(o=$(t.target).closest(".dropdown-submenu.over")).length){o.removeClass("over"),o.find("> a").focus();break}a=this._layoutParams.columns-1}l=this._layoutParams.itemsIndexes[s][a]}else if(e.keyCode==Common.UI.Keys.RIGHT)for(;void 0===l;)++a>this._layoutParams.columns-1&&(a=0),l=this._layoutParams.itemsIndexes[s][a];else if(e.keyCode==Common.UI.Keys.UP){if(0==s&&this.outerMenu&&this.outerMenu.menu)return this.deselectAll(!0),void(this.outerMenu.menu.focusOuter&&this.outerMenu.menu.focusOuter(e,this.outerMenu.index));for(;void 0===l;)--s<0&&(s=this._layoutParams.rows-1),l=this._layoutParams.itemsIndexes[s][a]}else{if(s==this._layoutParams.rows-1&&this.outerMenu&&this.outerMenu.menu)return this.deselectAll(!0),void(this.outerMenu.menu.focusOuter&&this.outerMenu.menu.focusOuter(e,this.outerMenu.index));for(;void 0===l;)++s>this._layoutParams.rows-1&&(s=0),l=this._layoutParams.itemsIndexes[s][a]}}else l=e.keyCode==Common.UI.Keys.UP||e.keyCode==Common.UI.Keys.LEFT?Math.max(0,l-1):Math.min(this.store.length-1,l+1);(i=void 0!==l&&0<=l?this.store.at(l):i)&&(this._fromKeyDown=!0,this.selectRecord(i),this.scrollToRecord(i),this._fromKeyDown=!1)}}else this.trigger("item:keydown",this,i,t)},attachKeyEvents:function(){var t;this.enableKeyEvents&&this.handleSelect&&((t=$(this.el).find(".inner").addBack().filter(".inner")).addClass("canfocused"),t.attr("tabindex",this.tabindex.toString()),t.on(this.parentMenu&&this.useBSKeydown?"dataview:keydown":"keydown",_.bind(this.onKeyDown,this)))},setDisabled:function(t){this.disabled=t=!!t,$(this.el).find(".inner").addBack().filter(".inner").toggleClass("disabled",t)},isDisabled:function(){return this.disabled},alignPosition:function(){var t,e="menu"===this.parentMenu.cmpEl.attr("role")?this.parentMenu.cmpEl:this.parentMenu.cmpEl.find("[role=menu]"),i=Common.Utils.innerHeight()-10,n=$(this.el).find(".inner").addBack().filter(".inner"),o=n.parent(),o=parseInt(o.css("margin-top"))+parseInt(o.css("margin-bottom"))+parseInt(e.css("margin-top")),s=parseInt(e.css("padding-top"))+parseInt(e.css("padding-bottom")),a=e.outerHeight(),l=parseInt(e.css("top")),r={minScrollbarLength:this.minScrollbarLength},c=(this.scrollAlwaysVisible&&(r.alwaysVisibleY=this.scrollAlwaysVisible),!1);(c=this.parentMenu.menuAlign?"bl"===(t=this.parentMenu.menuAlign.match(/^([a-z]+)-([a-z]+)/))[1]||"br"===t[1]:c)?(t=l+a,l<0?(n.css("max-height",t-s-o+"px"),e.css("top",0),this.scroller.update(r)):0<l&&n.height()<this.options.restoreHeight&&(n.css("max-height",Math.min(t-s-o,this.options.restoreHeight)+"px"),e.css("top",t-e.outerHeight()),this.scroller.update(r))):i<l+a?(n.css("max-height",i-l-s-o+"px"),this.scroller.update(r)):l+a<i&&n.height()<this.options.restoreHeight&&(n.css("max-height",Math.min(i-l-s-o,this.options.restoreHeight)+"px"),this.scroller.update(r))},fillIndexesArray:function(){if(!(this.dataViewItems.length<=0)){this._layoutParams={itemsIndexes:[],columns:0,rows:0};for(var t=this.dataViewItems[0].el,e=t.outerWidth()+parseFloat(t.css("margin-left"))+parseFloat(t.css("margin-right")),i=this.$el.offset().left,n=t.offset().top,o=-1,s=0,a=0;a<this.dataViewItems.length;a++){var l=this.dataViewItems[a],r=l.el.offset().top-n,c=Math.floor((l.el.offset().left-i)/e);o<r&&(o=r,this._layoutParams.itemsIndexes.push([]),s=this._layoutParams.itemsIndexes.length-1),this._layoutParams.itemsIndexes[s][c]=a,l.topIdx=s,l.leftIdx=c,this._layoutParams.columns<c&&(this._layoutParams.columns=c)}this._layoutParams.rows=this._layoutParams.itemsIndexes.length,this._layoutParams.columns++}},onResize:function(){this._layoutParams=void 0},focus:function(){this.cmpEl&&this.cmpEl.find(".dataview").focus()}}),$(document).on("keydown.dataview","[data-toggle=dropdown], [role=menu]",function(e){e.keyCode!==Common.UI.Keys.UP&&e.keyCode!==Common.UI.Keys.DOWN&&e.keyCode!==Common.UI.Keys.LEFT&&e.keyCode!==Common.UI.Keys.RIGHT&&e.keyCode!==Common.UI.Keys.RETURN||_.defer(function(){var t=$(e.target).closest(".dropdown-toggle");(t.length?t.parent():$(e.target).closest(".dropdown-submenu")).find(".inner.canfocused").trigger("dataview:keydown",e)},100)}),Common.UI.DataViewShape=Common.UI.DataViewSimple.extend(_.extend({template:_.template(['<div class="dataview inner" style="<%= style %>">',"<% _.each(options.groupsWithRecent, function(group, index) { %>",'<div class="grouped-data <% if (index === 0) { %> recent-group <% } %> " id="<%= group.id %>" >',"<% if (!_.isEmpty(group.groupName)) { %>",'<div class="group-description">',"<span><%= group.groupName %></span>","</div>","<% } %>",'<div class="group-items-container <% if (index === 0) { %> recent-items <% } %>">',"<% _.each(group.groupStore.toJSON(), function(item, index) { %>","<% if (!item.id) item.id = Common.UI.getId(); %>",'<div class="item" data-index="<%= index %>"<% if(!!item.tip) { %> data-toggle="tooltip" <% } %> ><%= itemTemplate(item) %></div>',"<% }); %>","</div>","</div>","<% }); %>","</div>"].join("")),initialize:function(t){var e=this,i=(this.canAddRecents=!0,this._state={hideTextRect:t.hideTextRect,hideLines:t.hideLines},Common.localStorage.getKeysFilter()),i=(this.appPrefix=i&&i.length?i.split(",")[0]:"",e.groups=t.groups.toJSON(),new Common.UI.DataViewGroupStore),n=t.recentShapes||[],o=18<n.length?7:6,s=35*Math.ceil(n.length/o)+3,o=30*o;if((e.recentShapes=n,0<e.recentShapes.length)&&!_.findWhere(e.groups,{groupName:e.recentShapes[0].groupName})){for(var a=0;a<e.recentShapes.length;a++)for(var l,r=e.recentShapes[a].data.shapeType,c=0;c<e.groups.length;c++){for(var d=e.groups[c].groupStore,h=e.groups[c].groupName,m=0;m<d.length;m++)if(d.at(m).get("data").shapeType===r){l=d.at(m).toJSON(),e.recentShapes[a]={data:l.data,tip:l.tip,allowSelected:l.allowSelected,selected:!1,groupName:h};break}if(l){l=void 0;break}}Common.localStorage.setItem(this.appPrefix+"recent-shapes",JSON.stringify(e.recentShapes))}if(e.recentShapes.length<12){for(var p=12-e.recentShapes.length,u=[],g=function(t,e){t=t.toJSON(),t={data:t.data,tip:t.tip,allowSelected:t.allowSelected,selected:!1,groupName:e};u.push(t)},m=0;m<e.groups.length&&0<p;m++){var b=e.groups[m].groupStore,h=e.groups[m].groupName;0===m?(g(b.at(1),h),0<--p&&(g(b.at(2),h),p--)):3!==m&&6!==m&&7!==m&&(g(b.at(0),h),0<--p&&(g(b.at(1),h),p--))}e.recentShapes=e.recentShapes.concat(u)}i.add(e.recentShapes),e.groups.unshift({groupName:t.textRecentlyUsed,groupStore:i,groupWidth:o,groupHeight:s}),e.options.groupsWithRecent=e.groups;d=new Common.UI.DataViewStore;_.each(e.groups,function(t,e){var i=t.groupStore.models;if(0<e)for(var n=0;n<i.length;n++)i[n].set({groupName:t.groupName});d.add(i)}),t.store=d,Common.UI.DataViewSimple.prototype.initialize.call(this,t),e.parentMenu.on("show:before",function(){e.updateRecents()}),e._state.hideLines&&e.hideLinesGroup()},onAfterShowMenu:function(t){var s=this,e=!1;if(s.dataViewItems||(s.dataViewItems=[],_.each(s.cmpEl.find("div.grouped-data"),function(t,o){_.each($(t).find("div.item"),function(t,e){var i=$(t),t=s.groups[o].groupStore.at(e),n=(s.dataViewItems.push({el:i,groupIndex:o,index:e}),t.get("tip"));n&&i.one("mouseenter",function(){i.attr("data-toggle","tooltip"),i.tooltip({title:n,placement:"cursor",zIndex:s.tipZIndex}),i.mouseenter()})})}),e=!0),s.updateDataViewItems&&s.cmpEl.is(":visible")){for(var i=_.where(s.dataViewItems,{groupIndex:0}),n=i?i.length:0,o=0;o<n;o++){var a=s.dataViewItems[o].el.data("bs.tooltip");a&&(void 0===a.dontShow&&(a.dontShow=!0),a.tip().remove())}s.dataViewItems=s.dataViewItems.slice(n);var l=[];_.each(s.cmpEl.find(".recent-group div.item"),function(t,e){var i=$(t),t=s.recentShapes[e],n=(l.push({el:i,groupIndex:0,index:e}),t.tip);n&&i.one("mouseenter",function(){i.attr("data-toggle","tooltip"),i.tooltip({title:n,placement:"cursor",zIndex:s.tipZIndex}),i.mouseenter()})}),s.dataViewItems=l.concat(s.dataViewItems),1===s.recentShapes.length&&$(".recent-group").show(),e=!(s.updateDataViewItems=!1)}this._state.hideLines&&s.hideLines(),e&&s.hideTextRect(s._state.hideTextRect),s.fillIndexesArray()},onClickItem:function(t){var e,i,n,o,s;this.disabled||(window._event=t,e=$(t.currentTarget).closest("div.grouped-data").index(),i=$(t.currentTarget).closest("div.item").data("index"),n=0<=(o=_.findIndex(this.dataViewItems,function(t){return t.groupIndex===e&&t.index===i}))?this.store.at(o):null,o=0<=o?this.dataViewItems[o]:null,n&&o&&(n.set({selected:!0}),(s=o.el.data("bs.tooltip"))&&s.tip().remove(),this.isSuspendEvents||this.trigger("item:click",this,o.el,n,t),this.addRecentItem(n)))},addRecentItem:function(t){for(var e=!1,i=t.get("data").shapeType,n=t.get("groupName"),o=0;o<this.recentShapes.length;o++)if(this.recentShapes[o].data.shapeType===i){e=!0;break}e||(t=[{data:(t=t.toJSON()).data,tip:t.tip,allowSelected:t.allowSelected,selected:!1,groupName:n}].concat(this.recentShapes.slice(0,11)),Common.localStorage.setItem(this.appPrefix+"recent-shapes",JSON.stringify(t)),this.recentShapes=void 0)},updateRecents:function(){var e,i,t,n=this,o=(o=Common.localStorage.getItem(this.appPrefix+"recent-shapes"))?JSON.parse(o):[],s=!1;if(n.recentShapes)for(var a=0;a<o.length;a++)(!n.recentShapes[a]||n.recentShapes[a]&&o[a].tip!==n.recentShapes[a].tip)&&(s=!0);else s=!0;0<o.length&&s&&(n.recentShapes=o,e=new Common.UI.DataViewStore,_.each(n.recentShapes,function(t){t={data:{shapeType:t.data.shapeType},tip:t.tip,allowSelected:t.allowSelected,selected:t.selected,groupName:t.groupName};e.push(t)}),n.groups[0].groupStore=e,i=new Common.UI.DataViewStore,_.each(n.groups,function(t){i.add(t.groupStore.models)}),n.store=i,t=_.template(["<% _.each(items, function(item, index) { %>","<% if (!item.id) item.id = Common.UI.getId(); %>",'<div class="item" data-index="<%= index %>"<% if(!!item.tip) { %> data-toggle="tooltip" <% } %> ><%= itemTemplate(item) %></div>',"<% }) %>"].join("")),n.cmpEl&&n.cmpEl.find(".recent-items").html(t({items:n.recentShapes,itemTemplate:this.itemTemplate,style:this.style})),n.updateDataViewItems=!0)},fillIndexesArray:function(){if(!(this.dataViewItems.length<=0)){this._layoutParams={itemsIndexes:[],columns:0,rows:0};for(var t=this.dataViewItems[0].el,e=0;!this.dataViewItems[e].el.is(":visible");){if(e++,!this.dataViewItems[e])return;t=this.dataViewItems[e].el}for(var i=t.outerWidth()+parseInt(t.css("margin-left"))+parseInt(t.css("margin-right")),n=this.$el.offset().left,o=t.offset().top,s=-1,a=0,l=e,r=0;r<this.dataViewItems.length;r++){var c,d=this.dataViewItems[r];d.el.is(":visible")?(c=d.el.offset().top-o,l=Math.floor((d.el.offset().left-n)/i),s<c&&(s=c,this._layoutParams.itemsIndexes.push([]),a=this._layoutParams.itemsIndexes.length-1),this._layoutParams.itemsIndexes[a][l]=r,d.topIdx=a,d.leftIdx=l,this._layoutParams.columns<l&&(this._layoutParams.columns=l)):(d.topIdx=-1,d.leftIdx=-1)}this._layoutParams.rows=this._layoutParams.itemsIndexes.length,this._layoutParams.columns++}},hideTextRect:function(i){var n=this;this.store.each(function(t,e){"textRect"===t.get("data").shapeType&&n.dataViewItems[e].el[i?"addClass":"removeClass"]("hidden")},this),this._state.hideTextRect=i},hideLinesGroup:function(){$(this.cmpEl.find("div.grouped-data")[9]).hide()},hideLines:function(){var i=this;this.store.each(function(t,e){"Lines"===t.get("groupName")&&(t=i.dataViewItems[e].el).is(":visible")&&t.addClass("hidden")},this)}}))}),void 0===Common&&(Common={}),define("common/main/lib/component/TreeView",["common/main/lib/component/DataView"],function(){"use strict";Common.UI.TreeViewModel=Common.UI.DataViewModel.extend({defaults:function(){return{id:Common.UI.getId(),name:"",isNotHeader:!1,hasSubItems:!1,hasParent:!1,isEmptyItem:!1,isExpanded:!0,isVisible:!0,selected:!1,allowSelected:!0,disabled:!1,level:0,index:0}}}),Common.UI.TreeViewStore=Backbone.Collection.extend({model:Common.UI.TreeViewModel,expandSubItems:function(t){var a=this,l=function(t,e,i){for(var n=t+1;n<a.length;n++){var o=a.at(n),s=o.get("level");if(!(i<s))return n-1;e&&o.set("isVisible",!0),o.get("hasSubItems")&&(n=l(n,o.get("isExpanded"),s))}};t.set("isExpanded",!0),l(t.get("index"),!0,t.get("level"))},collapseSubItems:function(t){for(var e=t.get("level"),i=t.get("index")+1;i<this.length;i++){var n=this.at(i);if(!(e<n.get("level")))break;n.set("isVisible",!1)}return i-1},expandAll:function(){this.each(function(t){t.set("isExpanded",!0),t.set("isVisible",!0)})},collapseAll:function(){for(var t=0;t<this.length;t++){var e=this.at(t);e.get("isNotHeader")||(e.set("isExpanded",!1),t=this.collapseSubItems(e))}},expandToLevel:function(a){for(var l=this,r=function(t,e){var i=l.at(t);i.set("isExpanded",!1);for(var n=t+1;n<l.length;n++){var o=l.at(n),s=o.get("level");if(!(e<s))return n-1;s<=a&&i.set("isExpanded",!0),o.set("isVisible",s<=a),o.get("hasSubItems")&&(n=r(n,s))}},t=0;t<this.length;t++){var e=this.at(t);(e.get("level")<=a||!e.get("hasParent"))&&(e.set("isVisible",!0),e.get("isNotHeader")||(t=r(t,e.get("level"))))}}}),Common.UI.TreeView=Common.UI.DataView.extend({options:{handleSelect:!0,showLast:!0,allowScrollbar:!0,scrollAlwaysVisible:!0,emptyItemText:"",keyMoveDirection:"both"},template:_.template(['<div class="treeview inner" style="<%= style %>"></div>'].join("")),initialize:function(t){t.store=t.store||new Common.UI.TreeViewStore,t.emptyItemText=t.emptyItemText||"",t.itemTemplate=t.itemTemplate||(Common.UI.isRTL()?_.template(['<div id="<%= id %>" class="tree-item <% if (!isVisible) { %>hidden<% } %>" style="display: block;padding-right: <%= level*16 + 24 %>px;">',"<% if (hasSubItems) { %>",'<div class="tree-caret img-commonctrl <% if (!isExpanded) { %>up<% } %>" style="margin-right: <%= level*16 %>px;"></div>',"<% } %>","<% if (isNotHeader) { %>",'<div class="name not-header"><%= Common.Utils.String.htmlEncode(name) %></div>',"<% } else if (isEmptyItem) { %>",'<div class="name empty">'+t.emptyItemText+"</div>","<% } else { %>",'<div class="name"><%= Common.Utils.String.htmlEncode(name) %></div>',"<% } %>","</div>"].join("")):_.template(['<div id="<%= id %>" class="tree-item <% if (!isVisible) { %>hidden<% } %>" style="display: block;padding-left: <%= level*16 + 24 %>px;">',"<% if (hasSubItems) { %>",'<div class="tree-caret img-commonctrl <% if (!isExpanded) { %>up<% } %>" style="margin-left: <%= level*16 %>px;"></div>',"<% } %>","<% if (isNotHeader) { %>",'<div class="name not-header"><%= Common.Utils.String.htmlEncode(name) %></div>',"<% } else if (isEmptyItem) { %>",'<div class="name empty">'+t.emptyItemText+"</div>","<% } else { %>",'<div class="name"><%= Common.Utils.String.htmlEncode(name) %></div>',"<% } %>","</div>"].join(""))),Common.UI.DataView.prototype.initialize.call(this,t)},onAddItem:function(t,e,i){var n,o,s=new Common.UI.DataViewItem({template:this.itemTemplate,model:t});s&&(n=(this.$el||$(this.el)).find(".inner").addBack().filter(".inner"))&&(this.dataViewItems.length<1&&n.find(".empty-text").remove(),i&&"number"==typeof i.at?(i=i.at,o=n.find("> div"),0<i?$(o.get(i-1)).after(s.render().el):0<o.length?$(o[i]).before(s.render().el):n.append(s.render().el),this.dataViewItems=this.dataViewItems.slice(0,i).concat(s).concat(this.dataViewItems.slice(i))):(n.append(s.render().el),this.dataViewItems.push(s)),this.updateTip(s),this.listenTo(s,"change",this.onChangeItem),this.listenTo(s,"remove",this.onRemoveItem),this.listenTo(s,"click",this.onClickItem),this.listenTo(s,"dblclick",this.onDblClickItem),this.listenTo(s,"select",this.onSelectItem),this.listenTo(s,"contextmenu",this.onContextMenuItem),this.isSuspendEvents||this.trigger("item:add",this,s,t))},onClickItem:function(t,e,i){var n=$(i.target);n&&(n.hasClass("tree-caret")||n.hasClass("btn-tree-caret"))?((n=t.$el.data("bs.tooltip"))&&n.tip().remove(),n=!e.get("isExpanded"),e.set("isExpanded",n),this.store[n?"expandSubItems":"collapseSubItems"](e),this.scroller.update({minScrollbarLength:this.minScrollbarLength,alwaysVisibleY:this.scrollAlwaysVisible})):Common.UI.DataView.prototype.onClickItem.call(this,t,e,i)},expandAll:function(){this.store.expandAll(),this.scroller.update({minScrollbarLength:this.minScrollbarLength,alwaysVisibleY:this.scrollAlwaysVisible})},collapseAll:function(){this.store.collapseAll(),this.scroller.update({minScrollbarLength:this.minScrollbarLength,alwaysVisibleY:this.scrollAlwaysVisible})},expandToLevel:function(t){this.store.expandToLevel(t),this.scroller.update({minScrollbarLength:this.minScrollbarLength,alwaysVisibleY:this.scrollAlwaysVisible})},expandRecord:function(t){t&&(t.set("isExpanded",!0),this.store.expandSubItems(t),this.scroller.update({minScrollbarLength:this.minScrollbarLength,alwaysVisibleY:this.scrollAlwaysVisible}))},collapseRecord:function(t){t&&(t.set("isExpanded",!1),this.store.collapseSubItems(t),this.scroller.update({minScrollbarLength:this.minScrollbarLength,alwaysVisibleY:this.scrollAlwaysVisible}))},onKeyDown:function(t,e){if(!this.disabled)if(void 0===e&&(e=t),-1<_.indexOf(this.moveKeys,e.keyCode)||e.keyCode==Common.UI.Keys.RETURN){e.preventDefault(),e.stopPropagation();var i=this.getSelectedRec();if(null===this.lastSelectedRec&&(this.lastSelectedRec=i),e.keyCode==Common.UI.Keys.RETURN)this.lastSelectedRec=null,this.selectedBeforeHideRec&&(i=this.selectedBeforeHideRec),this.trigger("item:click",this,this,i,t),this.trigger("item:select",this,this,i,t),this.trigger("entervalue",this,i,t),this.parentMenu&&this.parentMenu.hide();else{var n=_.indexOf(this.store.models,i);if(n<0)e.keyCode==Common.UI.Keys.LEFT&&0<(o=$(t.target).closest(".dropdown-submenu.over")).length?(o.removeClass("over"),o.find("> a").focus()):n=0;else if("both"==this.options.keyMoveDirection){var o=i.get("hasSubItems"),s=(i.get("hasParent"),i.get("isExpanded"));if(e.keyCode==Common.UI.Keys.LEFT)o&&s&&this.collapseRecord(i);else if(e.keyCode==Common.UI.Keys.RIGHT)o&&!s&&this.expandRecord(i);else if(e.keyCode==Common.UI.Keys.DOWN){for(var a=n+1;a<this.store.length;a++)if(this.store.at(a).get("isVisible")){n=a;break}}else if(e.keyCode==Common.UI.Keys.UP)for(a=n-1;0<=a;a--)if(this.store.at(a).get("isVisible")){n=a;break}}else n=e.keyCode==Common.UI.Keys.UP||e.keyCode==Common.UI.Keys.LEFT?Math.max(0,n-1):Math.min(this.store.length-1,n+1);(i=void 0!==n&&0<=n?this.store.at(n):i)&&(this._fromKeyDown=!0,this.selectRecord(i),this._fromKeyDown=!1,this.scrollToRecord(i))}}else this.trigger("item:keydown",this,i,t)},focus:function(){this.cmpEl&&this.cmpEl.find(".treeview").focus()},updateTip:function(t){var e=t.model,i=e.get("name"),n=this,o=(i.length>37-2*e.get("level")?e.set("tip",i):e.set("tip",""),t.$el||$(t.el)),i=o.data("bs.tooltip");i&&(void 0===i.dontShow&&(i.dontShow=!0),o.removeData("bs.tooltip"),i.tip().remove()),e.get("tip")&&(o.attr("data-toggle","tooltip"),o.tooltip({title:e.get("tip"),placement:"cursor",zIndex:this.tipZIndex}),this.delayRenderTips?o.one("mouseenter",function(){o.attr("data-toggle","tooltip"),o.tooltip({title:e.get("tip"),placement:"cursor",zIndex:n.tipZIndex}),o.mouseenter()}):(o.attr("data-toggle","tooltip"),o.tooltip({title:e.get("tip"),placement:"cursor",zIndex:n.tipZIndex})))}})}),define("documenteditor/main/app/view/Navigation",["common/main/lib/util/utils","common/main/lib/component/BaseView","common/main/lib/component/Layout","common/main/lib/component/TreeView"],function(t){"use strict";DE.Views.Navigation=Common.UI.BaseView.extend(_.extend({el:"#left-panel-navigation",storeNavigation:void 0,template:_.template(['<div id="navigation-box" class="layout-ct vbox">','<div id="navigation-header" className="">',"<label><%= scope.strNavigate%></label>",'<div id="navigation-btn-close" class="float-right margin-left-4"></div>','<div id="navigation-btn-settings" class="float-right"></div>',"</div>",'<div id="navigation-list" class="">',"</div>","</div>"].join("")),initialize:function(t){_.extend(this,t),Common.UI.BaseView.prototype.initialize.call(this,arguments)},render:function(t){t=t||this.el,$(t).html(this.template({scope:this}));var e=Common.localStorage.getBool("de-outline-wrap",!0),i=(i=Common.localStorage.getItem("de-outline-fontsize"))||"medium";return this.$el=$(t),this.btnClose=new Common.UI.Button({parentEl:$("#navigation-btn-close",this.$el),cls:"btn-toolbar",iconCls:"toolbar__icon btn-close",hint:this.txtClosePanel}),this.btnSettings=new Common.UI.Button({parentEl:$("#navigation-btn-settings",this.$el),cls:"btn-toolbar",iconCls:"toolbar__icon btn-settings",hint:this.txtSettings,menu:new Common.UI.Menu({menuAlign:"tr-br",style:"min-width: auto;",cls:"shifted-right",items:[{caption:this.txtExpand,value:"expand",iconCls:"menu__icon btn-expand-all"},{caption:this.txtCollapse,value:"collapse",iconCls:"menu__icon btn-collapse-all"},{caption:this.txtExpandToLevel,value:"expand-level",menu:new Common.UI.Menu({menuAlign:"tl-tr",style:"min-width: auto;",items:[{caption:"1",value:1},{caption:"2",value:2},{caption:"3",value:3},{caption:"4",value:4},{caption:"5",value:5},{caption:"6",value:6},{caption:"7",value:7},{caption:"8",value:8},{caption:"9",value:9}]})},{caption:"--",visible:!0},{caption:this.txtFontSize,value:"font-size",menu:new Common.UI.Menu({menuAlign:"tl-tr",style:"min-width: auto;",items:[{caption:this.txtSmall,checkable:!0,value:"small",checked:"small"==i,toggleGroup:"fontsize"},{caption:this.txtMedium,checkable:!0,value:"medium",checked:"medium"==i,toggleGroup:"fontsize"},{caption:this.txtLarge,checkable:!0,checked:"large"==i,value:"large",toggleGroup:"fontsize"}]})},{caption:"--",visible:!0},{caption:this.txtWrapHeadings,checkable:!0,checked:e,value:"wrap"}]})}),this.btnSettingsMenu=this.btnSettings.menu,this.viewNavigationList=new Common.UI.TreeView({el:$("#navigation-list"),store:this.storeNavigation,enableKeyEvents:!1,emptyText:this.txtEmpty,emptyItemText:this.txtEmptyItem,style:"border: none;",delayRenderTips:!0,minScrollbarLength:25}),this.viewNavigationList.cmpEl.off("click"),this.viewNavigationList.$el.addClass(i),e&&this.viewNavigationList.$el.addClass("wrap"),this.navigationMenu=new Common.UI.Menu({cls:"shifted-right",items:[{iconCls:"menu__icon btn-promote",caption:this.txtPromote,value:"promote"},{iconCls:"menu__icon btn-demote",caption:this.txtDemote,value:"demote"},{caption:"--"},{caption:this.txtHeadingBefore,value:"before"},{caption:this.txtHeadingAfter,value:"after"},{caption:this.txtNewHeading,value:"new"},{caption:"--"},{iconCls:"menu__icon btn-select-all",caption:this.txtSelect,value:"select"},{caption:"--"},{iconCls:"menu__icon btn-expand-all",caption:this.txtExpand,value:"expand"},{iconCls:"menu__icon btn-collapse-all",caption:this.txtCollapse,value:"collapse"},{caption:this.txtExpandToLevel,menu:new Common.UI.Menu({menuAlign:"tl-tr",style:"min-width: 60px;",items:[{caption:"1",value:1},{caption:"2",value:2},{caption:"3",value:3},{caption:"4",value:4},{caption:"5",value:5},{caption:"6",value:6},{caption:"7",value:7},{caption:"8",value:8},{caption:"9",value:9}]})}]}),this.trigger("render:after",this),this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this.fireEvent("show",this)},hide:function(){Common.UI.BaseView.prototype.hide.call(this,arguments),this.fireEvent("hide",this)},changeWrapHeadings:function(){Common.localStorage.setBool("de-outline-wrap",this.btnSettingsMenu.items[6].checked),this.btnSettingsMenu.items[6].checked?this.viewNavigationList.$el.addClass("wrap"):this.viewNavigationList.$el.removeClass("wrap")},changeFontSize:function(t){Common.localStorage.setItem("de-outline-fontsize",t),this.viewNavigationList.$el.removeClass(),this.viewNavigationList.$el.addClass(t),this.changeWrapHeadings()},ChangeSettings:function(t){}},DE.Views.Navigation||{}))}),define("documenteditor/main/app/view/LeftMenu",["text!documenteditor/main/app/template/LeftMenu.template","jquery","underscore","backbone","common/main/lib/component/Button","common/main/lib/view/SearchDialog","documenteditor/main/app/view/FileMenu","documenteditor/main/app/view/Navigation"],function(t,o,s,e){"use strict";DE.Views.LeftMenu=e.View.extend(s.extend({el:"#left-menu",template:s.template(t),events:function(){return{}},initialize:function(){this.minimizedMode=!0,this._state={disabled:!1}},render:function(){var t=o(this.template({}));return this.btnSearchBar=new Common.UI.Button({action:"advancedsearch",el:t.elementById("#left-btn-searchbar"),hint:this.tipSearch,disabled:!0,iconCls:"btn-menu-search",enableToggle:!0,toggleGroup:"leftMenuGroup"}),this.btnSearchBar.on("click",this.onBtnMenuClick.bind(this)),this.btnAbout=new Common.UI.Button({action:"about",el:t.elementById("#left-btn-about"),hint:this.tipAbout,enableToggle:!0,disabled:!0,iconCls:"btn-menu-about",toggleGroup:"leftMenuGroup"}),this.btnSupport=new Common.UI.Button({action:"support",el:t.elementById("#left-btn-support"),hint:this.tipSupport,iconCls:"btn-menu-support",disabled:!0}),this.btnComments=new Common.UI.Button({el:t.elementById("#left-btn-comments"),hint:this.tipComments+Common.Utils.String.platformKey("Ctrl+Shift+H"),enableToggle:!0,disabled:!0,iconCls:"btn-menu-comments",toggleGroup:"leftMenuGroup"}),this.btnComments.on("click",this.onBtnMenuClick.bind(this)),this.btnComments.on("toggle",this.onBtnCommentsToggle.bind(this)),this.btnChat=new Common.UI.Button({el:t.elementById("#left-btn-chat"),hint:this.tipChat+Common.Utils.String.platformKey("Alt+Q"," ("+(Common.Utils.isMac?Common.Utils.String.textCtrl+"+":"")+"{0})"),enableToggle:!0,disabled:!0,iconCls:"btn-menu-chat",toggleGroup:"leftMenuGroup"}),this.btnChat.on("click",this.onBtnMenuClick.bind(this)),this.btnComments.hide(),this.btnChat.hide(),this.btnPlugins=new Common.UI.Button({el:t.elementById("#left-btn-plugins"),hint:this.tipPlugins,enableToggle:!0,disabled:!0,iconCls:"btn-menu-plugin",toggleGroup:"leftMenuGroup"}),this.btnPlugins.hide(),this.btnPlugins.on("click",this.onBtnMenuClick.bind(this)),this.btnNavigation=new Common.UI.Button({el:t.elementById("#left-btn-navigation"),hint:this.tipOutline,enableToggle:!0,disabled:!0,iconCls:"btn-menu-navigation",toggleGroup:"leftMenuGroup"}),this.btnNavigation.on("click",this.onBtnMenuClick.bind(this)),this.menuFile=new DE.Views.FileMenu,this.btnThumbnails=new Common.UI.Button({el:t.elementById("#left-btn-thumbnails"),hint:this.tipPageThumbnails,enableToggle:!0,disabled:!0,iconCls:"btn-menu-thumbs",toggleGroup:"leftMenuGroup"}),this.btnThumbnails.hide(),this.btnThumbnails.on("click",this.onBtnMenuClick.bind(this)),this.$el.html(t),this},onBtnMenuToggle:function(t,e){e?(t.panel.show(),this._state.pluginIsRunning||this.$el.width(40)):t.panel.hide(),DE.getController("Toolbar").DisableToolbar(1==e),this.supressEvents||Common.NotificationCenter.trigger("layout:changed","leftmenu")},onBtnCommentsToggle:function(t,e){e||this.fireEvent("comments:hide",this)},onBtnMenuClick:function(t,e){var i;this.supressEvents=!0,this.btnAbout.toggle(!1),t.pressed?40<this.$el.width()||this.$el.width(parseInt(Common.localStorage.getItem("de-mainmenu-width"))||300):this._state.pluginIsRunning||(i=this.$el.width(),this.isVisible()&&40<i&&Common.localStorage.setItem("de-mainmenu-width",i),this.$el.width(40)),this.supressEvents=!1,this.onCoauthOptions(),t.pressed&&"advancedsearch"==t.options.action&&this.fireEvent("search:aftershow",this),Common.NotificationCenter.trigger("layout:changed","leftmenu")},onCoauthOptions:function(t){this.mode.canCoAuthoring&&(this.mode.canViewComments&&(this.btnComments.pressed&&this.btnComments.$el.hasClass("notify")&&this.btnComments.$el.removeClass("notify"),this.panelComments[this.btnComments.pressed?"show":"hide"](),this.fireEvent(this.btnComments.pressed?"comments:show":"comments:hide",this)),this.mode.canChat&&(this.btnChat.pressed?(this.btnChat.$el.hasClass("notify")&&this.btnChat.$el.removeClass("notify"),this.panelChat.show(),this.panelChat.focus()):this.panelChat.hide())),this.panelNavigation&&(this.btnNavigation.pressed?this.panelNavigation.show():this.panelNavigation.hide()),this.panelThumbnails&&(this.btnThumbnails.pressed?this.panelThumbnails.show():this.panelThumbnails.hide()),this.panelSearch&&(this.btnSearchBar.pressed?(this.panelSearch.show(),this.panelSearch.focus()):this.panelSearch.hide())},setOptionsPanel:function(t,e){"chat"==t?this.panelChat=e.render("#left-panel-chat"):"comment"==t?this.panelComments=e:"history"==t?this.panelHistory=e.render("#left-panel-history"):"plugins"!=t||this.panelPlugins?"navigation"!=t||this.panelNavigation?"thumbnails"==t?this.panelThumbnails=e.render("#left-panel-thumbnails"):"advancedsearch"==t&&(this.panelSearch=e.render("#left-panel-search")):this.panelNavigation=e.render("#left-panel-navigation"):this.panelPlugins=e.render()},markCoauthOptions:function(t,e){"chat"!=t||!this.btnChat.isVisible()||this.btnChat.isDisabled()||this.btnChat.pressed||this.btnChat.$el.addClass("notify"),"comments"!=t||!this.btnComments.isVisible()||this.btnComments.pressed||this.btnComments.isDisabled()&&!e||this.btnComments.$el.addClass("notify")},close:function(t){this.menuFile.isVisible()?this.menuFile.hide():(this.btnAbout.toggle(!1),this._state.pluginIsRunning||this.$el.width(40),this.mode.canCoAuthoring&&(this.mode.canViewComments&&(this.panelComments.hide(),this.btnComments.pressed&&this.fireEvent("comments:hide",this),this.btnComments.toggle(!1,!0)),this.mode.canChat&&(this.panelChat.hide(),this.btnChat.toggle(!1))),this.mode.canPlugins&&this.panelPlugins&&!this._state.pluginIsRunning&&(this.panelPlugins.hide(),this.btnPlugins.toggle(!1,!0)),this.panelNavigation&&(this.panelNavigation.hide(),this.btnNavigation.toggle(!1)),this.panelSearch&&(this.panelSearch.hide(),this.btnSearchBar.toggle(!1,!0)),this.panelThumbnails&&(this.panelThumbnails.hide(),this.btnThumbnails.toggle(!1,!0)))},isOpened:function(){return this.btnSearchBar.pressed||this.btnComments.pressed||this.btnChat.pressed},disableMenu:function(t,e){this.btnSearchBar.setDisabled(!1),this.btnAbout.setDisabled(!1),this.btnSupport.setDisabled(!1),this.btnComments.setDisabled(!1),this.btnChat.setDisabled(!1),this.btnPlugins.setDisabled(!1),this.btnNavigation.setDisabled(!1),this.btnThumbnails.setDisabled(!1)},showMenu:function(t,e,i){var n=/^(\w+):?(\w*)$/.exec(t);"file"==n[1]?(this.menuFile.isVisible(),this.menuFile.show(n[2].length?n[2]:void 0,e)):"chat"==t?!this.btnChat.isVisible()||this.btnChat.isDisabled()||this.btnChat.pressed||(this.btnChat.toggle(!0),this.onBtnMenuClick(this.btnChat),this.panelChat.focus()):"comments"==t?!this.btnComments.isVisible()||this.btnComments.isDisabled()||this.btnComments.pressed||(this.btnComments.toggle(!0),this.onBtnMenuClick(this.btnComments)):"navigation"==t?!this.btnNavigation.isVisible()||this.btnNavigation.isDisabled()||this.btnNavigation.pressed||(this.btnNavigation.toggle(!0),this.onBtnMenuClick(this.btnNavigation)):"advancedsearch"!=t||!this.btnSearchBar.isVisible()||this.btnSearchBar.isDisabled()||this.btnSearchBar.pressed||(this.btnSearchBar.toggle(!0),this.onBtnMenuClick(this.btnSearchBar),this.panelSearch.focus(),i||this.fireEvent("search:aftershow",this))},getMenu:function(t){switch(t){default:return null;case"file":return this.menuFile;case"about":return this.btnAbout.panel}},setMode:function(t){return(this.mode=t).canUseThumbnails&&this.btnThumbnails.show(),this},showHistory:function(){this._state.pluginIsRunning=!1,this.panelHistory.show(),this.panelHistory.$el.width((parseInt(Common.localStorage.getItem("de-mainmenu-width"))||300)-40),Common.NotificationCenter.trigger("layout:changed","history")},setDeveloperMode:function(t,e,i){var n;this.$el.is(":visible")&&((t&Asc.c_oLicenseMode.Trial||t&Asc.c_oLicenseMode.Developer)&&!this.developerHint&&(n="",t&Asc.c_oLicenseMode.Trial&&t&Asc.c_oLicenseMode.Developer?n=this.txtTrialDev:0!=(t&Asc.c_oLicenseMode.Trial)?n=this.txtTrial:0!=(t&Asc.c_oLicenseMode.Developer)&&(n=this.txtDeveloper),n=n.toUpperCase(),this.developerHint=o('<div id="developer-hint">'+n+"</div>").appendTo(this.$el),this.devHeight=this.developerHint.outerHeight(),this.devHintInited||o(window).on("resize",s.bind(this.onWindowResize,this)),this.devHintInited=!0),this.developerHint&&this.developerHint.toggleClass("hidden",!(t&Asc.c_oLicenseMode.Trial||t&Asc.c_oLicenseMode.Developer)),e&&!this.betaHint&&(n=t?'style="margin-top: 4px;"':"",t="",0<(i=(i||"").split(".")).length&&(t+="v. "+i[0]),1<i.length&&(t+="."+i[1]),this.betaHint=o('<div id="beta-hint"'+n+">"+t+" (beta)</div>").appendTo(this.$el),this.betaHeight=this.betaHint.outerHeight(),this.devHintInited||o(window).on("resize",s.bind(this.onWindowResize,this)),this.devHintInited=!0),this.betaHint&&this.betaHint.toggleClass("hidden",!e),n=0<(i=this.$el.find("button.btn-category:visible")).length?o(i[i.length-1]):null,this.minDevPosition=n?n.offset().top-n.offsetParent().offset().top+n.height()+20:20,this.onWindowResize())},setLimitMode:function(){var t;this.$el.is(":visible")&&(this.limitHint||(t=this.txtLimit.toUpperCase(),this.limitHint=o('<div id="limit-hint" style="margin-top: 4px;">'+t+"</div>").appendTo(this.$el),this.limitHeight=this.limitHint.outerHeight(),this.devHintInited||o(window).on("resize",s.bind(this.onWindowResize,this)),this.devHintInited=!0),this.limitHint&&this.limitHint.toggleClass("hidden",!1),t=0<(t=this.$el.find("button.btn-category:visible")).length?o(t[t.length-1]):null,this.minDevPosition=t?t.offset().top-t.offsetParent().offset().top+t.height()+20:20,this.onWindowResize())},onWindowResize:function(){var t=(this.devHeight||0)+(this.betaHeight||0)+(this.limitHeight||0),t=Math.max((this.$el.height()-t)/2,this.minDevPosition);this.developerHint&&(this.developerHint.css("top",t),t+=this.devHeight),this.betaHint&&(this.betaHint.css("top",t),t+=this.betaHeight+4),this.limitHint&&this.limitHint.css("top",t)},isVisible:function(){return this.$el&&this.$el.is(":visible")}},DE.Views.LeftMenu||{}))}),define("documenteditor/main/app/controller/Viewport",["core","common/main/lib/view/Header","common/main/lib/view/SearchBar","documenteditor/main/app/view/Viewport","documenteditor/main/app/view/LeftMenu"],function(t){"use strict";DE.Controllers.Viewport=Backbone.Controller.extend(_.assign({models:[],collections:[],views:["Viewport","Common.Views.Header"],initialize:function(){var i=this;this.addListeners({FileMenu:{"menu:hide":i.onFileMenu.bind(i,"hide"),"menu:show":i.onFileMenu.bind(i,"show"),"settings:apply":i.applySettings.bind(i)},Toolbar:{"render:before":function(t){var e=DE.getController("Main").appOptions,t=(t.setExtra("right",i.header.getPanel("right",e)),(!e.isEdit||e.customization&&e.customization.compactHeader)&&t.setExtra("left",i.header.getPanel("left",e)),Common.localStorage.getBool("de-settings-quick-print-button",!0));Common.Utils.InternalSettings.set("de-settings-quick-print-button",t),i.header&&i.header.btnPrintQuick&&i.header.btnPrintQuick[t?"show":"hide"]()},"view:compact":function(t,e){i.viewport.vlayout.getItem("toolbar").height=e?Common.Utils.InternalSettings.get("toolbar-height-compact"):Common.Utils.InternalSettings.get("toolbar-height-normal")},"undo:disabled":function(t){i.header.btnUndo&&(i.header.btnUndo.keepState?i.header.btnUndo.keepState.disabled=t:i.header.btnUndo.setDisabled(t))},"redo:disabled":function(t){i.header.btnRedo&&(i.header.btnRedo.keepState?i.header.btnRedo.keepState.disabled=t:i.header.btnRedo.setDisabled(t))},"print:disabled":function(t){i.header.btnPrint&&i.header.btnPrint.setDisabled(t),i.header.btnPrintQuick&&i.header.btnPrintQuick.setDisabled(t)},"save:disabled":function(t){i.header.btnSave&&i.header.btnSave.setDisabled(t)}}})},setApi:function(t){this.api=t,this.api.asc_registerCallback("asc_onCoAuthoringDisconnect",this.onApiCoAuthoringDisconnect.bind(this)),Common.NotificationCenter.on("api:disconnect",this.onApiCoAuthoringDisconnect.bind(this))},getApi:function(){return this.api},onLaunch:function(){log.debug("Viewport","onLaunch"),this.viewport=this.createView("Viewport").render(),this.api=new Asc.asc_docs_api({"id-view":"editor_sdk",translate:this.getApplication().getController("Main").translationTable}),this.header=this.createView("Common.Views.Header",{headerCaption:"Document Editor",storeUsers:DE.getCollection("Common.Collections.Users")}),Common.NotificationCenter.on("layout:changed",_.bind(this.onLayoutChanged,this)),$(window).on("resize",_.bind(this.onWindowResize,this));var t=$("#left-menu"),e=$("#left-panel-history");this.viewport.hlayout.on("layout:resizedrag",function(){this.api.Resize(),Common.localStorage.setItem("de-mainmenu-width",e.is(":visible")?e.width()+SCALE_MIN:t.width())},this),this.boxSdk=$("#editor_sdk"),this.boxSdk.css("border-left","none"),Common.NotificationCenter.on("app:face",this.onAppShowed.bind(this)),Common.NotificationCenter.on("app:ready",this.onAppReady.bind(this)),Common.NotificationCenter.on("search:show",_.bind(this.onSearchShow,this))},onAppShowed:function(t){var e,i=this,n=(i.appConfig=t,Common.Utils.InternalSettings),o=$(".toolbar-fullview-panel");o.css("top",Common.UI.LayoutManager.isElementVisible("toolbar")?n.get("toolbar-height-tabs"):0),i.viewport.$el.attr("applang",i.appConfig.lang.split(/[\-_]/)[0]),(!(t.isEdit||t.isRestrictedEdit&&t.canFillForms&&t.isFormCreator)||!Common.localStorage.itemExists("de-compact-toolbar")&&t.customization&&t.customization.compactToolbar)&&(e=i.viewport.vlayout.getItem("toolbar"))&&(e.height=n.get("toolbar-height-tabs")),t.customization&&(t.customization.toolbarNoTabs&&i.viewport.vlayout.getItem("toolbar").el.addClass("style-off-tabs"),t.customization.toolbarHideFileName&&i.viewport.vlayout.getItem("toolbar").el.addClass("style-skip-docname")),!t.isEdit||t.customization&&t.customization.compactHeader||((e=i.viewport.vlayout.getItem("title").el).html(i.header.getPanel("title",t)).show(),e.find(".extra").html(i.header.getPanel("left",t)),(e=i.viewport.vlayout.getItem("toolbar")).el.addClass("top-title"),e.height-=n.get("toolbar-height-tabs")-n.get("toolbar-height-tabs-top-title"),t=n.get("toolbar-height-tabs-top-title"),n.set("toolbar-height-tabs",t),n.set("toolbar-height-compact",t),n.set("toolbar-height-normal",t+n.get("toolbar-height-controls")),o.css("top",(Common.UI.LayoutManager.isElementVisible("toolbar")?t:0)+n.get("document-title-height")),(e=i.getApplication().getController("Toolbar").getView()).btnCollabChanges=i.header.btnSave),i.header.btnSearch.on("toggle",i.onSearchToggle.bind(this))},onAppReady:function(t){},onLayoutChanged:function(t){switch(t){default:this.viewport.vlayout.doLayout();case"rightmenu":this.viewport.hlayout.doLayout();break;case"history":(e=this.viewport.hlayout.getItem("history")).resize.el&&(this.boxSdk.css("border-left",""),e.resize.el.show()),this.viewport.hlayout.doLayout();break;case"leftmenu":var e;(e=this.viewport.hlayout.getItem("left")).resize.el&&(40<e.el.width()?(this.boxSdk.css("border-left",""),e.resize.el.show()):(e.resize.el.hide(),this.boxSdk.css("border-left","0 none"))),this.viewport.hlayout.doLayout();break;case"header":case"toolbar":case"status":this.viewport.vlayout.doLayout()}this.api.Resize()},onWindowResize:function(t){this.onLayoutChanged("window"),Common.NotificationCenter.trigger("window:resize")},onFileMenu:function(t){t="show"==t;this.header.lockHeaderBtns("undo",t),this.header.lockHeaderBtns("redo",t)},applySettings:function(){var t=Common.localStorage.getBool("de-settings-quick-print-button",!0);Common.Utils.InternalSettings.set("de-settings-quick-print-button",t),this.header&&this.header.btnPrintQuick&&this.header.btnPrintQuick[t?"show":"hide"]()},onApiCoAuthoringDisconnect:function(t){this.header&&(this.header.btnDownload&&!t&&this.header.btnDownload.hide(),this.header.btnPrint&&!t&&this.header.btnPrint.hide(),this.header.btnPrintQuick&&!t&&this.header.btnPrintQuick.hide(),this.header.btnEdit&&this.header.btnEdit.hide(),this.header.lockHeaderBtns("rename-user",!0))},SetDisabled:function(t){this.header&&this.header.lockHeaderBtns("rename-user",t)},onSearchShow:function(){this.header.btnSearch&&this.header.btnSearch.toggle(!0)},onSearchToggle:function(){var t,e,i=this.getApplication().getController("LeftMenu");i.isSearchPanelVisible()?(this.header.btnSearch.toggle(!1,!0),i.getView("LeftMenu").panelSearch.focus()):(this.searchBar||(i=this.appConfig.canBrandingExt&&(!Common.UI.LayoutManager.isElementVisible("leftMenu")||this.appConfig.customization&&!1===this.appConfig.customization.leftMenu),this.searchBar=new Common.UI.SearchBar(i?{showOpenPanel:!1,width:303}:{}),this.searchBar.on("hide",_.bind(function(){this.header.btnSearch.toggle(!1,!0),Common.NotificationCenter.trigger("edit:complete")},this))),this.header.btnSearch.pressed?(i=this.api.asc_GetSelectedText(),e=(t=this.getApplication().getController("Search")).getResultsNumber(),this.searchBar.show(i&&i.trim()||t.getSearchText()),this.searchBar.updateResultsNumber(e[0],e[1])):this.searchBar.hide())},isSearchBarVisible:function(){return this.searchBar&&this.searchBar.isVisible()}},DE.Controllers.Viewport))}),$(document).off("keydown.bs.dropdown.data-api").on("keydown.bs.dropdown.data-api","[data-toggle=dropdown], [role=menu]",onDropDownKeyDown),"ontouchstart"in document.documentElement&&$(document).on("click.bs.dropdown.data-api","[data-toggle=dropdown]",toggle),!function(){var n,t=$._data($(document).get(0),"events");t&&t.click&&t.click.every(function(t,e,i){return!(n=/click/.test(t.type)&&!t.selector&&/bs\..+\.dropdown/.test(t.namespace)?t.handler:n)}),n&&$(document).off("click.bs.dropdown.data-api",n).on("click.bs.dropdown.data-api",function(t){1!=t.which&&null!=t.which||clearMenus(/form-control/.test(t.target.className))})}(),define("common/main/lib/extend/Bootstrap",function(){}),void 0===Common&&(Common={}),define("common/main/lib/component/MenuItem",["common/main/lib/component/BaseView","common/main/lib/component/ToggleManager"],function(){"use strict";Common.UI.MenuItem=Common.UI.BaseView.extend({options:{id:null,cls:"",style:"",hint:!1,checkable:!1,checked:!1,allowDepress:!1,disabled:!1,visible:!0,value:null,toggleGroup:null,iconCls:"",menu:null,canFocused:!0,dataHint:"",dataHintDirection:"",dataHintOffset:"",dataHintTitle:"",scaling:!1},tagName:"li",template:_.template(['<a id="<%= id %>" class="menu-item" style="<%= style %>" <% if(options.canFocused) { %> tabindex="-1" type="menuitem" <% }; if(!_.isUndefined(options.stopPropagation)) { %> data-stopPropagation="true" <% }; if(!_.isUndefined(options.dataHint)) { %> data-hint="<%= options.dataHint %>" <% }; if(!_.isUndefined(options.dataHintDirection)) { %> data-hint-direction="<%= options.dataHintDirection %>" <% }; if(!_.isUndefined(options.dataHintOffset)) { %> data-hint-offset="<%= options.dataHintOffset %>" <% }; if(options.dataHintTitle) { %> data-hint-title="<%= options.dataHintTitle %>" <% }; %> >',"<% if (!_.isEmpty(iconCls)) { %>",'<span class="menu-item-icon <%= iconCls %>"></span>',"<% } %>","<%= caption %>","</a>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);t=this;this.id=t.options.id||Common.UI.getId(),this.cls=t.options.cls,this.style=t.options.style,this.caption=t.options.caption,this.menu=t.options.menu||null,this.checkable=t.options.checkable,this.checked=t.options.checked,t.allowDepress=t.options.allowDepress,this.disabled=t.options.disabled,this.visible=t.options.visible,this.value=t.options.value,this.toggleGroup=t.options.toggleGroup,this.template=t.options.template||this.template,this.iconCls=t.options.iconCls,this.hint=t.options.hint,this.rendered=!1,null===this.menu||this.menu instanceof Common.UI.Menu||this.menu instanceof Common.UI.MenuSimple||(this.menu=new Common.UI.Menu(_.extend({},t.options.menu))),t.options.el&&this.render()},render:function(){var t,i=this,e=i.$el||$(this.el);return i.cmpEl=e,i.trigger("render:before",i),"--"===i.caption?e.addClass("divider"):this.rendered||(e.off("click"),Common.UI.ToggleManager.unregister(i),e.html(this.template({id:i.id,caption:i.caption,iconCls:i.iconCls,style:i.style,options:i.options})),i.menu&&(e.addClass("dropdown-submenu"),i.menu.render(e),e.mouseenter(_.bind(i.menu.alignPosition,i.menu)),e.focusout(_.bind(i.onBlurItem,i)),e.hover(_.bind(i.onHoverItem,i),_.bind(i.onUnHoverItem,i))),t=e.children(":first"),this.checkable&&t&&(t.toggleClass("checkable",this.checkable),t.toggleClass("no-checkmark",!1===this.options.checkmark),t.toggleClass("checked",this.checked),_.isEmpty(this.iconCls)||t.css("background-image","none")),i.options.hint&&(e.attr("data-toggle","tooltip"),e.tooltip({title:i.options.hint,placement:i.options.hintAnchor||function(t,e){var i=this.getPosition(),n=t.offsetWidth,o=t.offsetHeight,s=Common.Utils.innerWidth(),a=Common.Utils.innerHeight(),l=i.top,r=i.left+i.width+2;a<l+o&&(l=a-o-2),s<r+n&&(r=i.left-n-2),$(t).offset({top:l,left:r}).addClass("in")}})),this.cls&&e.addClass(this.cls),this.disabled&&e.toggleClass("disabled",this.disabled),e.on("click",_.bind(this.onItemClick,this)),e.on("mousedown",_.bind(this.onItemMouseDown,this)),Common.UI.ToggleManager.register(i),!1!==i.options.scaling&&i.iconCls&&(e.attr("ratio","ratio"),i.applyScaling(Common.UI.Scaling.currentRatio()),e.on("app:scaling",function(t,e){i.options.scaling!=e.ratio&&i.applyScaling(e.ratio)}))),this.visible||this.setVisible(this.visible),i.rendered=!0,i.trigger("render:after",i),this},setCaption:function(t,e){this.caption=t,this.rendered&&(this.cmpEl.find("> a").contents().last()[0].textContent=e?t:Common.Utils.String.htmlEncode(t))},setIconCls:function(t){var e,i;this.rendered&&!_.isEmpty(this.iconCls)&&(e=this.cmpEl.children(":first"))&&(e.find(".menu-item-icon").removeClass(this.iconCls).addClass(t),(e=e.find("use.zoom-int")).length&&(i=(i=/btn-[^\s]+/.exec(t))?i[0]:"null",e.attr("href","#"+i))),this.iconCls=t},setChecked:function(t,e){this.toggle(t,e)},isChecked:function(){return this.checked},setDisabled:function(t){this.disabled=!!t,this.rendered&&this.cmpEl.toggleClass("disabled",this.disabled)},isDisabled:function(){return this.disabled},toggle:function(t,e){var i,t=void 0===t?!this.checked:!!t;this.checkable&&(this.checked=t,this.rendered&&(i=this.cmpEl.children(":first"))&&(i.toggleClass("checked",this.checked),_.isEmpty(this.iconCls)||i.css("background-image","none")),e||this.trigger("toggle",this,t))},onItemMouseDown:function(t){if(Common.UI.HintManager&&Common.UI.HintManager.clearHints(),1!=t.which)return t.preventDefault(),t.stopPropagation(),!1;t.stopPropagation()},onItemClick:function(t){return(1==t.which||void 0===t.which&&!this.menu)&&(this.disabled||!this.allowDepress&&this.checked&&this.toggleGroup||this.menu||this.setChecked(!this.checked),this.menu?t.target.id!=this.id&&void(this.menu.isOver||this.cmpEl.removeClass("over")):!this.disabled&&void this.trigger("click",this,t))},onHoverItem:function(t){this._doHover(t)},onUnHoverItem:function(t){this._doUnHover(t)},onBlurItem:function(t){this._doUnHover(t)},_doHover:function(t){var e=this;e.menu&&!e.disabled&&(clearTimeout(e.hideMenuTimer),e.cmpEl.trigger("show.bs.dropdown"),e.expandMenuTimer=_.delay(function(){e.cmpEl.addClass("over"),e.cmpEl.trigger("shown.bs.dropdown")},200))},_doUnHover:function(t){var e=this;e.cmpEl.hasClass("dropdown-submenu")&&e.cmpEl.hasClass("over")&&(t&&t.relatedTarget&&0<e.cmpEl.find(t.relatedTarget).length||e.cmpEl.hasClass("focused-submenu"))?e.cmpEl.removeClass("focused-submenu"):e.menu&&!e.disabled&&(clearTimeout(e.expandMenuTimer),e.hideMenuTimer=_.delay(function(){e.menu.isOver||e.cmpEl.removeClass("over")},200),t&&"focusout"!==t.type&&0<(t=e.cmpEl.children(":focus")).length&&(t.blur(),e.cmpEl.closest("ul").focus()))},setMenu:function(t){var e;t&&_.isObject(t)&&_.isFunction(t.render)&&(this.rendered?(this.menu&&(this.menu instanceof Common.UI.Menu||this.menu instanceof Common.UI.MenuSimple)&&(Common.UI.Menu.Manager.unregister(this.menu),this.menu.cmpEl&&this.menu.cmpEl.remove()),this.menu=t,(e=this.cmpEl).addClass("dropdown-submenu"),this.menu.render(e),e.mouseenter(_.bind(this.menu.alignPosition,this.menu)),e.focusout(_.bind(this.onBlurItem,this)),e.hover(_.bind(this.onHoverItem,this),_.bind(this.onUnHoverItem,this))):this.menu=t)},applyScaling:function(t){var e;this.options.scaling!=t&&(this.options.scaling=t,e=this.cmpEl.children(":first"),2<t&&(e.find("svg.menu-item-icon").length||(t=this.iconCls,t=(t=/btn-[^\s]+/.exec(t))?t[0]:"null",t='<svg class="menu-item-icon"><use class="zoom-int" href="#%iconname"></use></svg>'.replace("%iconname",t),e.find("span.menu-item-icon").after(t))))}}),Common.UI.MenuItemSeparator=function(t){return(t=t||{}).caption="--",new Common.UI.MenuItem(t)}}),void 0===Common&&(Common={}),define("common/main/lib/component/Menu",["common/main/lib/extend/Bootstrap","common/main/lib/component/BaseView","common/main/lib/component/MenuItem","common/main/lib/component/Scroller"],function(){"use strict";var i,n,o;Common.UI.Menu=(i=[],n={},o={register:function(t){(n[t.id]=t).on("show:after",function(t){i.push(t)}).on("hide:after",function(t){t=i.indexOf(t);-1<t&&i.splice(t,1)})},unregister:function(t){var e=i.indexOf(t);delete n[t.id],-1<e&&i.splice(e,1),t.off("show:after").off("hide:after")},hideAll:function(){return Common.NotificationCenter.trigger("menumanager:hideall"),!!(i&&0<i.length)&&(_.each(i,function(t){t&&t.hide()}),!0)}},_.extend(Common.UI.BaseView.extend({options:{cls:"",style:"",itemTemplate:null,items:[],menuAlign:"tl-bl",menuAlignEl:null,offset:[0,0],cyclic:!0,search:!1,scrollAlwaysVisible:!0,scrollToCheckedItem:!0,focusToCheckedItem:!1},template:_.template(['<ul class="dropdown-menu <%= options.cls %>" oo_editor_input="true" style="<%= options.style %>" role="menu"></ul>'].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);var e=this;this.id=this.options.id||Common.UI.getId(),this.itemTemplate=this.options.itemTemplate||Common.UI.MenuItem.prototype.template,this.rendered=!1,this.items=[],this.offset=[0,0],this.menuAlign=this.options.menuAlign,this.menuAlignEl=this.options.menuAlignEl,this.scrollAlwaysVisible=this.options.scrollAlwaysVisible,this.search=this.options.search,this.outerMenu=this.options.outerMenu,Common.UI.isRTL()&&("tl-tr"===this.menuAlign?this.menuAlign="tr-tl":"tl-bl"===this.menuAlign?this.menuAlign="tr-br":"tr-br"===this.menuAlign?this.menuAlign="tl-bl":"bl-tl"===this.menuAlign&&(this.menuAlign="br-tr")),this.options.restoreHeight&&(this.options.restoreHeight="number"==typeof this.options.restoreHeight?this.options.restoreHeight:this.options.maxHeight||1e5,this.options.maxHeight||(this.options.maxHeight=this.options.restoreHeight)),this.options.cyclic||(this.options.cls+=" no-cyclic"),_.each(this.options.items,function(t){t instanceof Common.UI.MenuItem?e.items.push(t):e.items.push(new Common.UI.MenuItem(_.extend({tagName:"li",template:e.itemTemplate},t)))}),this.options.el&&this.render(),o.register(this)},remove:function(){o.unregister(this),Common.UI.BaseView.prototype.remove.call(this)},render:function(t){var e=this,t=(this.trigger("render:before",this),this.cmpEl=e.$el||$(this.el),t?(this.setElement(t,!1),e.rendered||(this.cmpEl=$(this.template({options:e.options})),t.append(this.cmpEl))):e.rendered||(this.cmpEl=this.template({options:e.options}),this.$el.append(this.cmpEl)),this.cmpEl.parent()),i="menu"===t.attr("role")?t:t.find("[role=menu]");return(this.menuRoot=i)&&(e.rendered||(_.each(e.items||[],function(t){i.append(t.render().el),t.on("click",_.bind(e.onItemClick,e)),t.on("toggle",_.bind(e.onItemToggle,e))}),i.on("click",function(t){e.trigger("menu:click",this,t)})),this.options.maxHeight&&(i.css({"max-height":e.options.maxHeight}),this.scroller=new Common.UI.Scroller({el:e.$el.find(".dropdown-menu "),minScrollbarLength:30,suppressScrollX:!0,alwaysVisibleY:this.scrollAlwaysVisible})),i.css({position:"fixed",right:"auto",left:-1e3,top:-1e3}),this.parentEl=i.parent(),this.parentEl.on("show.bs.dropdown",_.bind(e.onBeforeShowMenu,e)),this.parentEl.on("shown.bs.dropdown",_.bind(e.onAfterShowMenu,e)),this.parentEl.on("hide.bs.dropdown",_.bind(e.onBeforeHideMenu,e)),this.parentEl.on("hidden.bs.dropdown",_.bind(e.onAfterHideMenu,e)),this.parentEl.on("keydown.after.bs.dropdown",_.bind(e.onAfterKeydownMenu,e)),this.parentEl.on("keydown.before.bs.dropdown",_.bind(e.onBeforeKeydownMenu,e)),this.options.innerMenus&&this.on("keydown:before",_.bind(e.onBeforeKeyDown,e)),i.hover(function(t){e.isOver=!0},function(t){e.isOver=!1})),this.rendered=!0,this.trigger("render:after",this),this},isVisible:function(){return this.rendered&&this.cmpEl.is(":visible")},show:function(){this.rendered&&this.parentEl&&!this.parentEl.hasClass("open")&&this.cmpEl.dropdown("toggle")},hide:function(){this.rendered&&this.parentEl&&(this.parentEl.hasClass("open")?this.cmpEl.dropdown("toggle"):this.parentEl.hasClass("over")&&this.parentEl.removeClass("over"))},insertItem:function(t,e){var i;this.cmpEl;e instanceof Common.UI.MenuItem||(e=new Common.UI.MenuItem(_.extend({tagName:"li",template:this.itemTemplate},e))),t<0||t>=this.items.length?this.items.push(e):this.items.splice(t,0,e),this.rendered&&(i=this.menuRoot)&&(t<0?i.append(e.render().el):0===t?i.prepend(e.render().el):i.children("li:nth-child("+(t+1)+")").before(e.render().el),e.on("click",_.bind(this.onItemClick,this)),e.on("toggle",_.bind(this.onItemToggle,this)))},addItem:function(t){this.insertItem(-1,t)},removeItem:function(t){var e=this.items.indexOf(t);-1<e&&(this.items.splice(e,1),t.off("click").off("toggle"),t.remove())},removeItems:function(t,e){if(!(t>this.items.length-1)){t+e>this.items.length&&(e=this.items.length-t);for(var i=t;i<t+e;i++)this.items[i].off("click").off("toggle"),this.items[i].remove();this.items.splice(t,e)}},removeAll:function(){_.each(this.items,function(t){t.off("click").off("toggle"),t.remove()}),this.items=[]},onBeforeShowMenu:function(t){Common.NotificationCenter.trigger("menu:show"),this.trigger("show:before",this,t),t&&t.target===t.currentTarget&&this.alignPosition()},onAfterShowMenu:function(t){var e,i,n,o;this.trigger("show:after",this,t),this.scroller&&t&&t.target===t.currentTarget&&(t=this.menuRoot,void 0===this.wheelSpeed&&(i=(i=t.find("> li:first")).length?i.outerHeight():1,this.wheelSpeed=Math.min(Math.floor(t.height()/i)*i/10,20)),this.scroller.update({alwaysVisibleY:this.scrollAlwaysVisible,wheelSpeed:this.wheelSpeed}),(e=t.find("> li .checked")).length&&(o=e.position().top,i=e.outerHeight(),n=t.outerHeight(),this.options.scrollToCheckedItem&&(o<0||n<o+i)&&(o=t.scrollTop()+o+(i-n)/2,o=Math.floor(o/i)*i,t.scrollTop(o)),this.options.focusToCheckedItem&&setTimeout(function(){e.focus()},1))),this._search={}},onBeforeHideMenu:function(t){this.trigger("hide:before",this,t),Common.UI.Scroller.isMouseCapture()&&t.preventDefault()},onAfterHideMenu:function(t,e){this.trigger("hide:after",this,t,e),Common.NotificationCenter.trigger("menu:hide",this,e)},onAfterKeydownMenu:function(t){if(this.trigger("keydown:before",this,t),!t.isDefaultPrevented())if(t.keyCode==Common.UI.Keys.RETURN){var e=$(t.target).closest("li");if(0<(e=e.length<=0?$(t.target).parent().find("li .dataview"):e).length&&e.click(),e.hasClass("dropdown-submenu")||Common.UI.Menu.Manager.hideAll(),$(t.currentTarget).closest("li").hasClass("dropdown-submenu"))return t.stopPropagation(),!1}else{var i;t.keyCode==Common.UI.Keys.UP||t.keyCode==Common.UI.Keys.DOWN?this.fromKeyDown=!0:t.keyCode!=Common.UI.Keys.ESC&&this.search&&64<t.keyCode&&t.keyCode<91&&t.key&&(i=this,clearTimeout(this._search.timer),this._search.timer=setTimeout(function(){i._search={}},1e3),this._search.text||(this._search.text=""),this._search.char||(this._search.char=t.key),this._search.char!==t.key&&(this._search.full=!0),this._search.text+=t.key,void 0===this._search.index&&(e=this.menuRoot.find("> li").find("> a"),this._search.index=e.index(e.filter(":focus"))),this.selectCandidate())}},onBeforeKeydownMenu:function(t){var e,i;t.isDefaultPrevented()||!this.outerMenu||!this.outerMenu.menu||t.keyCode!=Common.UI.Keys.UP&&t.keyCode!=Common.UI.Keys.DOWN||(i=(e=this.menuRoot.find("> li").find("> a")).index(e.filter(":focus")),(t.keyCode==Common.UI.Keys.UP&&0==i||t.keyCode==Common.UI.Keys.DOWN&&i==e.length-1)&&(this.outerMenu.menu.focusOuter(t,this.outerMenu.index),t.preventDefault(),t.stopPropagation()))},selectCandidate:function(){for(var t,e,i,n,o,s=this._search.index&&-1!=this._search.index?this._search.index:0,a=new RegExp("^"+(this._search.full?this._search.text:this._search.char),"i"),l=a.test(this.items[s].caption),r=0;r<this.items.length;r++){var c=this.items[r];if(a.test(c.caption)){if(!t&&(t=c,e=r,!l))break;if(this._search.full&&r==s||s<r){t=c,e=r;break}}}t&&(this._search.index=e,c=t.cmpEl.find("a"),this.scroller&&(this.scroller.update({alwaysVisibleY:this.scrollAlwaysVisible,wheelSpeed:this.wheelSpeed}),i=c.position().top,n=c.outerHeight(),o=this.menuRoot.outerHeight(),(i<0||o<i+n)&&(o=this.menuRoot.scrollTop()+i,o=Math.floor(o/n)*n,this.menuRoot.scrollTop(o))),c.focus())},onBeforeKeyDown:function(t,e){var i,n;e.keyCode==Common.UI.Keys.RETURN?(0<(i=$(e.target).closest("li")).length&&(e.preventDefault(),e.stopPropagation(),i.click()),Common.UI.Menu.Manager.hideAll()):"after.bs.dropdown"===e.namespace||e.keyCode!=Common.UI.Keys.DOWN&&e.keyCode!=Common.UI.Keys.UP||this.menuRoot.length<1||$(e.target).closest("ul[role=menu]").get(0)!==this.menuRoot.get(0)||(n=this.findInnerMenu(e.keyCode))&&n.focusInner&&(e.preventDefault(),e.stopPropagation(),_.delay(function(){n.focusInner(e)},10))},setInnerMenu:function(t){!this.options.innerMenus&&t&&(this.options.innerMenus=t,this.rendered&&this.on("keydown:before",_.bind(this.onBeforeKeyDown,this)))},findInnerMenu:function(t,e,i){if(this.options.innerMenus){var n=$("> li",this.menuRoot),o=$("> li:not(.divider):not(.disabled):visible",this.menuRoot),s=o.length;if(s)for(var a=0;a<s;){var l=void 0!==e?o.index(n.eq(e)):o.index(o.find("> a").filter(":focus").parent()),l=t==Common.UI.Keys.DOWN?l<s-1?l+1:0:0<l?l-1:s-1,l=o.eq(l);e=n.index(l);for(var r=0;r<this.options.innerMenus.length;r++){var c=this.options.innerMenus[r];if(c&&c.menu&&c.index==e)return c.menu}if(0<l.find("> a").length)return i?l:void 0;a++}}},focusInner:function(t){(t.keyCode==Common.UI.Keys.UP?this.items[this.items.length-1]:this.items[0]).cmpEl.find("> a").focus()},focusOuter:function(t,e){var i,n,o=this.findInnerMenu(t.keyCode,e,!0);o&&o.focusInner?_.delay(function(){o.focusInner(t)},10):o?o.find("> a").focus():(n=(i=$("> li:not(.divider):not(.disabled):visible",this.menuRoot).find("> a")).length)&&i.eq(t.keyCode==Common.UI.Keys.UP?e<0?n-1:e:n-1<=e?0:e+1).focus()},onItemClick:function(t,e){var i;t.menu||(this.isOver=!1),t.options.stopPropagation?(e.stopPropagation(),i=this,_.delay(function(){i.$el.parent().parent().find("[data-toggle=dropdown]").focus()},10)):this.trigger("item:click",this,t,e)},onItemToggle:function(t,e,i){this.trigger("item:toggle",this,t,e,i)},setOffset:function(t,e){this.offset[0]=_.isUndefined(t)?this.offset[0]:t,this.offset[1]=_.isUndefined(e)?this.offset[1]:e,this.alignPosition()},getOffset:function(){return this.offset},alignPosition:function(t,e){var i,n=this.menuRoot,o=this.menuAlignEl||n.parent(),s=this.menuAlign.match(/^([a-z]+)-([a-z]+)/),a=o.offset(),l=Common.Utils.innerWidth()-10,r=Common.Utils.innerHeight()-10,c=n.outerWidth(),d=n.outerHeight(),h=o.outerWidth(),m=o.outerHeight(),p={tl:[0,0],bl:[0,d],tr:[c,0],br:[c,d]},m={tl:[0,0],tr:[h,0],bl:[0,m],br:[h,m]},u=a.left-p[s[1]][0]+m[s[2]][0]+this.offset[0],g=a.top-p[s[1]][1]+m[s[2]][1]+this.offset[1];l<u+c?u=o.is("li.dropdown-submenu")?a.left-c+2:l-c:u<0&&(u=o.is("li.dropdown-submenu")?a.left+h-2:0),u<0&&(u=0),this.options.restoreHeightAndTop?(r=(i=Common.Utils.croppedGeometry()).height-10,n.css("max-height","none"),(g=(g=g+(d=n.outerHeight())>r+i.top?r-d:g)<i.top?i.top:g)+d>r+i.top&&(n.css("max-height",r-g+"px"),this.scroller||(this.scroller=new Common.UI.Scroller({el:this.$el.find("> .dropdown-menu "),minScrollbarLength:30,suppressScrollX:!0,alwaysVisibleY:this.scrollAlwaysVisible})),this.wheelSpeed=void 0),this.scroller&&this.scroller.update({alwaysVisibleY:this.scrollAlwaysVisible})):this.options.restoreHeight?"number"==typeof this.options.restoreHeight&&(r<g+d?(n.css("max-height",r-g+"px"),this.scroller||(this.scroller=new Common.UI.Scroller({el:this.$el.find(".dropdown-menu "),minScrollbarLength:30,suppressScrollX:!0,alwaysVisibleY:this.scrollAlwaysVisible})),this.wheelSpeed=void 0):g+d<r&&n.height()<this.options.restoreHeight&&(n.css("max-height",Math.min(r-g,this.options.restoreHeight)+"px"),this.wheelSpeed=void 0)):(g=g+d>(r=(i=Common.Utils.croppedGeometry()).height-10)+i.top?t&&"string"==typeof t?(s=t.match(/^([a-z]+)-([a-z]+)/),a.top-p[s[1]][1]+m[s[2]][1]+this.offset[1]+(e||0)):r-d:g)<i.top&&(g=i.top),this.options.additionalAlign?this.options.additionalAlign.call(this,n,u,g):(l={left:u,top:g},d<r||(l["margin-top"]=0),n.css(l))},getChecked:function(){for(var t=0;t<this.items.length;t++){var e=this.items[t];if(e.isChecked&&e.isChecked())return e}},clearAll:function(){_.each(this.items,function(t){t.setChecked&&t.setChecked(!1,!0)})}}),{Manager:o})),Common.UI.MenuSimple=Common.UI.BaseView.extend({options:{cls:"",style:"",itemTemplate:null,items:[],menuAlign:"tl-bl",menuAlignEl:null,offset:[0,0],cyclic:!0,search:!1,scrollAlwaysVisible:!0,scrollToCheckedItem:!0,focusToCheckedItem:!1},template:_.template(['<ul class="dropdown-menu <%= options.cls %>" oo_editor_input="true" style="<%= options.style %>" role="menu">',"<% _.each(items, function(item) { %>","<% if (!item.id) item.id = Common.UI.getId(); %>","<% item.checked = item.checked || false;  %>","<li><%= itemTemplate(item) %></li>","<% }) %>","</ul>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);this.id=this.options.id||Common.UI.getId(),this.itemTemplate=this.options.itemTemplate||_.template(['<a id="<%= id %>" <% if(typeof style !== "undefined") { %> style="<%= style %>" <% } %>','<% if(typeof canFocused !== "undefined") { %> tabindex="-1" type="menuitem" <% } %>','<% if(typeof stopPropagation !== "undefined") { %> data-stopPropagation="true" <% } %>','class="<% if (checked) { %> checked <% } %>" >','<% if (typeof iconCls !== "undefined") { %>','<span class="menu-item-icon <%= iconCls %>"></span>',"<% } %>","<%= caption %>","</a>"].join("")),this.rendered=!1,this.items=this.options.items||[],this.offset=[0,0],this.menuAlign=this.options.menuAlign,this.menuAlignEl=this.options.menuAlignEl,this.scrollAlwaysVisible=this.options.scrollAlwaysVisible,this.search=this.options.search,Common.UI.isRTL()&&("tl-tr"===this.menuAlign?this.menuAlign="tr-tl":"tl-bl"===this.menuAlign?this.menuAlign="tr-br":"tr-br"===this.menuAlign?this.menuAlign="tl-bl":"bl-tl"===this.menuAlign&&(this.menuAlign="br-tr")),this.options.restoreHeight&&(this.options.restoreHeight="number"==typeof this.options.restoreHeight?this.options.restoreHeight:this.options.maxHeight||1e5,this.options.maxHeight||(this.options.maxHeight=this.options.restoreHeight)),this.options.cyclic||(this.options.cls+=" no-cyclic"),this.options.el&&this.render(),Common.UI.Menu.Manager.register(this)},remove:function(){Common.UI.Menu.Manager.unregister(this),Common.UI.BaseView.prototype.remove.call(this)},render:function(t){var e=this,t=(this.trigger("render:before",this),this.cmpEl=e.$el||$(this.el),t&&this.setElement(t,!1),e.rendered||(this.cmpEl=$(this.template({items:e.items,itemTemplate:e.itemTemplate,options:e.options})),(t||this.$el).append(this.cmpEl)),this.cmpEl.parent()),t="menu"===t.attr("role")?t:t.find("[role=menu]");return(this.menuRoot=t)&&(e.rendered||(t.on("click","li",_.bind(e.onItemClick,e)),t.on("mousedown","li",_.bind(e.onItemMouseDown,e))),this.options.maxHeight&&(t.css({"max-height":e.options.maxHeight}),this.scroller=new Common.UI.Scroller({el:e.$el.find(".dropdown-menu "),minScrollbarLength:30,suppressScrollX:!0,alwaysVisibleY:this.scrollAlwaysVisible})),t.css({position:"fixed",right:"auto",left:-1e3,top:-1e3}),this.parentEl=t.parent(),this.parentEl.on("show.bs.dropdown",_.bind(e.onBeforeShowMenu,e)),this.parentEl.on("shown.bs.dropdown",_.bind(e.onAfterShowMenu,e)),this.parentEl.on("hide.bs.dropdown",_.bind(e.onBeforeHideMenu,e)),this.parentEl.on("hidden.bs.dropdown",_.bind(e.onAfterHideMenu,e)),this.parentEl.on("keydown.after.bs.dropdown",_.bind(e.onAfterKeydownMenu,e)),t.hover(function(t){e.isOver=!0},function(t){e.isOver=!1})),this.rendered=!0,this.trigger("render:after",this),this},resetItems:function(t){this.items=t||[],this.$items=null;t=_.template(["<% _.each(items, function(item) { %>","<% if (!item.id) item.id = Common.UI.getId(); %>","<% item.checked = item.checked || false;  %>","<li><%= itemTemplate(item) %></li>","<% }) %>"].join(""));this.cmpEl&&this.cmpEl.html(t({items:this.items,itemTemplate:this.itemTemplate,options:this.options}))},isVisible:function(){return this.rendered&&this.cmpEl.is(":visible")},show:function(){this.rendered&&this.parentEl&&!this.parentEl.hasClass("open")&&this.cmpEl.dropdown("toggle")},hide:function(){this.rendered&&this.parentEl&&(this.parentEl.hasClass("open")?this.cmpEl.dropdown("toggle"):this.parentEl.hasClass("over")&&this.parentEl.removeClass("over"))},onItemClick:function(t){if(1!=t.which&&void 0!==t.which)return!1;var e,i=$(t.currentTarget).closest("li").index(),n=0<=i?this.items[i]:null;if(n){if(n.disabled)return!1;n.checkable&&!n.checked&&this.setChecked(i,!n.checked),this.isOver=!1,n.stopPropagation?(t.stopPropagation(),e=this,_.delay(function(){e.$el.parent().parent().find("[data-toggle=dropdown]").focus()},10)):this.trigger("item:click",this,n,t)}},onItemMouseDown:function(t){if(1!=t.which)return t.preventDefault(),t.stopPropagation(),!1;t.stopPropagation()},setChecked:function(t,e,i){this.toggle(t,e,i)},toggle:function(t,e,i){var n,e=!!e,t=this.items[t];this.clearAll(),t&&t.checkable&&(t.checked=e,this.rendered&&(n=t.el||this.cmpEl.find("#"+t.id))&&(n.toggleClass("checked",t.checked),_.isEmpty(t.iconCls)||n.css("background-image","none")),i||this.trigger("item:toggle",this,t,e))},setDisabled:function(t){this.disabled=!!t,this.rendered&&this.cmpEl.toggleClass("disabled",this.disabled)},isDisabled:function(){return this.disabled},onBeforeShowMenu:function(t){Common.NotificationCenter.trigger("menu:show"),this.trigger("show:before",this,t),t&&t.target===t.currentTarget&&this.alignPosition()},onAfterShowMenu:function(t){var e,i,n,o,s;this.trigger("show:after",this,t),this.scroller&&t&&t.target===t.currentTarget&&(this.scroller.update({alwaysVisibleY:this.scrollAlwaysVisible}),t=this.menuRoot,(e=t.find("> li .checked")).length&&(o=e.position().top,i=e.outerHeight(),n=t.outerHeight(),this.options.scrollToCheckedItem&&(o<0||n<o+i)&&(o=t.scrollTop()+o+(i-n)/2,o=Math.floor(o/i)*i,t.scrollTop(o)),this.options.focusToCheckedItem&&setTimeout(function(){e.focus()},1))),this._search={},this.search&&!this.$items&&((s=this).$items=this.menuRoot.find("> li").find("> a"),_.each(this.$items,function(t,e){s.items[e].el=$(t)}))},onBeforeHideMenu:function(t){this.trigger("hide:before",this,t),Common.UI.Scroller.isMouseCapture()&&t.preventDefault()},onAfterHideMenu:function(t,e){this.trigger("hide:after",this,t,e),Common.NotificationCenter.trigger("menu:hide",this,e)},onAfterKeydownMenu:function(t){if(t.keyCode==Common.UI.Keys.RETURN){var e=$(t.target).closest("li");if(0<(e=e.length<=0?$(t.target).parent().find("li .dataview"):e).length&&e.click(),e.hasClass("dropdown-submenu")||Common.UI.Menu.Manager.hideAll(),$(t.currentTarget).closest("li").hasClass("dropdown-submenu"))return t.stopPropagation(),!1}else{var i;t.keyCode==Common.UI.Keys.UP||t.keyCode==Common.UI.Keys.DOWN?this.fromKeyDown=!0:t.keyCode!=Common.UI.Keys.ESC&&this.search&&64<t.keyCode&&t.keyCode<91&&t.key&&(i=this,clearTimeout(this._search.timer),this._search.timer=setTimeout(function(){i._search={}},1e3),this._search.text||(this._search.text=""),this._search.char||(this._search.char=t.key),this._search.char!==t.key&&(this._search.full=!0),this._search.text+=t.key,void 0===this._search.index&&(this._search.index=this.$items.index(this.$items.filter(":focus"))),this.selectCandidate())}},selectCandidate:function(){for(var t,e,i,n,o,s=this._search.index&&-1!=this._search.index?this._search.index:0,a=new RegExp("^"+(this._search.full?this._search.text:this._search.char),"i"),l=a.test(this.items[s].caption),r=0;r<this.items.length;r++){var c=this.items[r];if(a.test(c.caption)){if(!t&&(t=c,e=r,!l))break;if(this._search.full&&r==s||s<r){t=c,e=r;break}}}t&&(this._search.index=e,c=t.el,this.scroller&&(this.scroller.update({alwaysVisibleY:this.scrollAlwaysVisible}),i=c.position().top,n=c.outerHeight(),o=this.menuRoot.outerHeight(),(i<0||o<i+n)&&(o=this.menuRoot.scrollTop()+i,o=Math.floor(o/n)*n,this.menuRoot.scrollTop(o))),c.focus())},setOffset:function(t,e){this.offset[0]=_.isUndefined(t)?this.offset[0]:t,this.offset[1]=_.isUndefined(e)?this.offset[1]:e,this.alignPosition()},getOffset:function(){return this.offset},alignPosition:function(t,e){var i=this.menuRoot,n=this.menuAlignEl||i.parent(),o=this.menuAlign.match(/^([a-z]+)-([a-z]+)/),s=n.offset(),a=Common.Utils.innerWidth(),l=Common.Utils.innerHeight()-10,r=i.outerWidth(),c=i.outerHeight(),d=n.outerWidth(),h=n.outerHeight(),m={tl:[0,0],bl:[0,c],tr:[r,0],br:[r,c]},h={tl:[0,0],tr:[d,0],bl:[0,h],br:[d,h]},p=s.left-m[o[1]][0]+h[o[2]][0]+this.offset[0],u=s.top-m[o[1]][1]+h[o[2]][1]+this.offset[1];a<p+r?p=n.is("li.dropdown-submenu")?s.left-r+2:a-r:p<0&&(p=n.is("li.dropdown-submenu")?s.left+d-2:0),p<0&&(p=0),this.options.restoreHeight?"number"==typeof this.options.restoreHeight&&(l<u+c?(i.css("max-height",l-u+"px"),this.scroller||(this.scroller=new Common.UI.Scroller({el:this.$el.find(".dropdown-menu "),minScrollbarLength:30,suppressScrollX:!0,alwaysVisibleY:this.scrollAlwaysVisible}))):u+c<l&&i.height()<this.options.restoreHeight&&i.css("max-height",Math.min(l-u,this.options.restoreHeight)+"px")):(u=l<u+c?t&&"string"==typeof t?(o=t.match(/^([a-z]+)-([a-z]+)/),s.top-m[o[1]][1]+h[o[2]][1]+this.offset[1]+(e||0)):l-c:u)<0&&(u=0),this.options.additionalAlign?this.options.additionalAlign.call(this,i,p,u):i.css({left:Math.ceil(p),top:Math.ceil(u)})},clearAll:function(){this.cmpEl&&this.cmpEl.find("li > a.checked").removeClass("checked"),_.each(this.items,function(t){t.checked=!1})}})}),void 0===Common&&(Common={}),define("common/main/lib/component/Calendar",["common/main/lib/component/BaseView","common/main/lib/util/utils"],function(){"use strict";Common.UI.Calendar=Common.UI.BaseView.extend(_.extend({template:_.template(['<div id="calendar" class="calendar-box">','<div class="calendar-header">','<div class="top-row">','<div id="prev-arrow"><button type="button"><i class="arrow-prev img-commonctrl"></i></button></div>','<div class="title"></div>','<div id="next-arrow"><button type="button"><i class="arrow-next img-commonctrl" /></button></div>',"</div>",'<div class="bottom-row"></div>',"</div>",'<div class="calendar-content"></div>',"</div>"].join("")),options:{date:void 0,firstday:0},initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);this.monthNames=[this.textJanuary,this.textFebruary,this.textMarch,this.textApril,this.textMay,this.textJune,this.textJuly,this.textAugust,this.textSeptember,this.textOctober,this.textNovember,this.textDecember],this.dayNamesShort=[this.textShortSunday,this.textShortMonday,this.textShortTuesday,this.textShortWednesday,this.textShortThursday,this.textShortFriday,this.textShortSaturday],this.monthShortNames=[this.textShortJanuary,this.textShortFebruary,this.textShortMarch,this.textShortApril,this.textShortMay,this.textShortJune,this.textShortJuly,this.textShortAugust,this.textShortSeptember,this.textShortOctober,this.textShortNovember,this.textShortDecember],this.options.date=t.date,_.isUndefined(t.firstday)||0!==t.firstday&&1!==t.firstday||(this.options.firstday=t.firstday),this.enableKeyEvents=this.options.enableKeyEvents,this._state=void 0,this.render()},render:function(){var e=this;return e.cmpEl=e.$el||$(this.el),e.cmpEl.html(this.template()),e.currentDate=e.options.date||new Date,e.btnPrev=new Common.UI.Button({parentEl:e.cmpEl.find("#prev-arrow"),cls:"",iconCls:"arrow-prev img-commonctrl"}),e.btnPrev.on("click",_.bind(e.onClickPrev,e)),e.btnNext=new Common.UI.Button({parentEl:e.cmpEl.find("#next-arrow"),cls:"",iconCls:"arrow-next img-commonctrl"}),e.btnNext.on("click",_.bind(e.onClickNext,e)),e.cmpEl.on("keydown",function(t){e.trigger("calendar:keydown",e,t)}),e.renderMonth(e.currentDate),this.trigger("render:after",this),this},onClickPrev:function(){var t,e,i=this;0===i._state?((t=new Date(i.currentDate)).setMonth(t.getMonth()-1),0<t.getFullYear()&&i.renderMonth(t)):1===i._state?((t=new Date(i.currentDate)).setFullYear(t.getFullYear()-1),0<t.getFullYear()&&i.renderMonths(t)):2===i._state&&0<(e=(t=i.currentDate.getFullYear())%10!=0?(e=String(t),Number(e.slice(0,-1)+"0")-1):t-1)&&(i.currentDate.setFullYear(e),i.renderYears(e))},onClickNext:function(){var t,e,i=this;0===i._state?((t=new Date(i.currentDate)).setMonth(t.getMonth()+1),0<t.getFullYear()&&i.renderMonth(t)):1===i._state?((t=new Date(i.currentDate)).setFullYear(t.getFullYear()+1),0<t.getFullYear()&&i.renderMonths(t)):2===i._state&&0<(e=(t=i.currentDate.getFullYear())%10!=9?(e=String(t),Number(e.slice(0,-1)+"9")+1):t+1)&&(i.currentDate.setFullYear(e),i.renderYears(e))},renderYears:function(t){for(var e,s=this,t=_.isNumber(t)?t:(s.currentDate||new Date).getFullYear(),i=(s._state=2,s.$el.removeClass("view-days view-months").addClass("view-years"),t),n=t,o=(i%10!=0&&(e=String(t),i=Number(e.slice(0,-1)+"0")),n%10!=9&&(e=String(t),n=Number(e.slice(0,-1)+"9")),s.topTitle=_.template(["<label>"+i+"-"+n+"</label>"].join("")),s.cmpEl.find(".calendar-header .title").html(s.topTitle),s.bottomTitle=_.template(["<label>"+s.textYears+"</label>"].join("")),s.cmpEl.find(".calendar-header .bottom-row").html(s.bottomTitle),[]),a=i-3,l=0;l<16;l++)o.push({year:0<a?a:"",isCurrentDecade:i<=a&&a<=n,disabled:!(0<a),selected:_.isDate(s.selectedDate)?a===s.selectedDate.getFullYear():a===(new Date).getFullYear()}),a++;s.yearPicker?s.yearPicker.store.reset(o):(s.yearPicker=new Common.UI.DataView({el:s.cmpEl.find(".calendar-content"),store:new Common.UI.DataViewStore(o),itemTemplate:_.template('<div class="name-year <% if (!isCurrentDecade) { %> no-current-decade <% } %>" data-year="<%= year %>"><%= year %></div>')}),s.yearPicker.on("item:click",function(t,e,i,n){var i=i.get("year"),o=new Date;o.setFullYear(i),s.renderMonths(o)}),s.enableKeyEvents&&this.yearPicker.on("item:keydown",function(t,e,i){i.keyCode==Common.UI.Keys.ESC&&Common.NotificationCenter.trigger("dataview:blur")})),s.enableKeyEvents&&_.delay(function(){s.monthPicker.focus()},10)},renderMonths:function(t){for(var a=this,e=_.isDate(t)?t:a.currentDate||new Date,i=e.getFullYear(),n=(a._state=1,a.currentDate=e,a.$el.removeClass("view-years view-days").addClass("view-months"),a.topTitle=_.template(['<div class="button"><label>'+i+"</label></div>"].join("")),a.cmpEl.find(".calendar-header .title").html(a.topTitle),a.cmpEl.find(".calendar-header .title").off(),a.cmpEl.find(".calendar-header .title").on("click",_.bind(a.renderYears,a)),a.bottomTitle=_.template(["<label>"+a.textMonths+"</label>"].join("")),a.cmpEl.find(".calendar-header .bottom-row").html(a.bottomTitle),[]),o=new Date,s=0;s<12;s++)n.push({indexMonth:s,nameMonth:a.monthShortNames[s],year:i,curYear:!0,isCurrentMonth:s===e.getMonth(),selected:_.isDate(a.selectedDate)?s===a.selectedDate.getMonth()&&i===a.selectedDate.getFullYear():s===o.getMonth()&&i===o.getFullYear()});i+=1;for(s=0;s<4;s++)n.push({indexMonth:s,nameMonth:a.monthShortNames[s],year:i,curYear:!1,selected:_.isDate(a.selectedDate)?s===a.selectedDate.getMonth()&&i===a.selectedDate.getFullYear():s===o.getMonth()&&i===o.getFullYear()});a.monthsPicker?a.monthsPicker.store.reset(n):(a.monthsPicker=new Common.UI.DataView({el:a.cmpEl.find(".calendar-content"),store:new Common.UI.DataViewStore(n),itemTemplate:_.template('<div class="name-month <% if (!curYear) { %> no-cur-year <% } %>" data-month="<%= indexMonth %>" data-year="<%= year %>"><%= nameMonth %></div>')}),a.monthsPicker.on("item:click",function(t,e,i,n){var o=i.get("indexMonth"),i=i.get("year"),s=new Date;s.setFullYear(i,o),a.renderMonth(s)}),a.enableKeyEvents&&this.monthsPicker.on("item:keydown",function(t,e,i){i.keyCode==Common.UI.Keys.ESC&&Common.NotificationCenter.trigger("dataview:blur")})),a.enableKeyEvents&&_.delay(function(){a.monthPicker.focus()},10)},renderMonth:function(t){for(var a=this,e=(a._state=0,a.options.firstday),t=t||new Date,i=t.getMonth(),n=(t.getDay(),t.getDate(),t.getFullYear()),o=(a.currentDate=t,a.$el.removeClass("view-years view-months").addClass("view-days"),a.topTitle=_.template(['<div class="button">',"<label>"+a.monthNames[i]+" "+n+"</label>","</div>"].join("")),a.cmpEl.find(".calendar-header .title").html(a.topTitle),a.cmpEl.find(".calendar-header .title").off(),a.cmpEl.find(".calendar-header .title").on("click",_.bind(a.renderMonths,a)),""),s=e;s<7;s++)o+="<label>"+a.dayNamesShort[s]+"</label>";0<e&&(o+="<label>"+a.dayNamesShort[0]+"</label>"),a.cmpEl.find(".calendar-header .bottom-row").html(_.template(o));for(var l,r=[],t=new Date(t),c=(t.setDate(1),t.getDay()),t=a.daysInMonth(t.getTime()-864e6),t=0===e?0<c?t-(c-1):1:0===c?t-5:t-(c-2),c=0<c&&0===e||1===e?0<=i-1?(l=i-1,n):(l=11,n-1):(l=i,n),d=new Date,h=(d.setFullYear(c,l,t),new Date),m=0;m<6;m++)for(var p=0;p<7;p++){var u=d.getDay(),g=d.getDate(),b=d.getMonth(),C=d.getFullYear();r.push({indexInWeek:u,dayNumber:g,month:b,year:C,isCurrentMonth:b===i,selected:_.isDate(a.selectedDate)?g===a.selectedDate.getDate()&&b===a.selectedDate.getMonth()&&C===a.selectedDate.getFullYear():g===h.getDate()&&b===h.getMonth()&&C===h.getFullYear()}),d.setDate(g+1)}a.monthPicker?a.monthPicker.store.reset(r):(a.monthPicker=new Common.UI.DataView({el:a.cmpEl.find(".calendar-content"),store:new Common.UI.DataViewStore(r),itemTemplate:_.template('<div class="number-day<% if (indexInWeek === 6 || indexInWeek === 0) { %> weekend<% } %><% if (!isCurrentMonth) { %> no-current-month<% } %>" data-number="<%= dayNumber %>" data-month="<%= month %>" data-year="<%= year %>"><%= dayNumber %></div>')}),a.monthPicker.on("item:click",function(t,e,i,n){var o=i.get("dayNumber"),s=i.get("month"),i=i.get("year");_.isUndefined(a.selectedDate)&&(a.selectedDate=new Date),a.selectedDate.setFullYear(i,s,o),a.trigger("date:click",a,a.selectedDate)}),a.enableKeyEvents&&this.monthPicker.on("item:keydown",function(t,e,i){i.keyCode==Common.UI.Keys.ESC&&Common.NotificationCenter.trigger("dataview:blur")})),a.enableKeyEvents&&_.delay(function(){a.monthPicker.focus()},10)},daysInMonth:function(t){var t=t?new Date(t):new Date,e=new Date;return e.setFullYear(t.getFullYear(),t.getMonth()+1,0),e.getDate()},setDate:function(t){_.isDate(t)&&(this.selectedDate=new Date(t),this.renderMonth(this.selectedDate))},focus:function(){var t=this;t.enableKeyEvents&&t.monthPicker&&_.delay(function(){t.monthPicker.focus()},10)},textJanuary:"January",textFebruary:"February",textMarch:"March",textApril:"April",textMay:"May",textJune:"June",textJuly:"July",textAugust:"August",textSeptember:"September",textOctober:"October",textNovember:"November",textDecember:"December",textShortJanuary:"Jan",textShortFebruary:"Feb",textShortMarch:"Mar",textShortApril:"Apr",textShortMay:"May",textShortJune:"Jun",textShortJuly:"Jul",textShortAugust:"Aug",textShortSeptember:"Sep",textShortOctober:"Oct",textShortNovember:"Nov",textShortDecember:"Dec",textShortSunday:"Su",textShortMonday:"Mo",textShortTuesday:"Tu",textShortWednesday:"We",textShortThursday:"Th",textShortFriday:"Fr",textShortSaturday:"Sa",textMonths:"Months",textYears:"Years"},Common.UI.Calendar||{}))}),void 0===Common&&(Common={}),define("common/main/lib/view/InsertTableDialog",["common/main/lib/component/Window"],function(){"use strict";Common.Views.InsertTableDialog=Common.UI.Window.extend(_.extend({options:{width:230,height:157,style:"min-width: 230px;",cls:"modal-dlg",id:"window-insert-table",split:!1,buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:t.split?this.txtTitleSplit:this.txtTitle},t||{}),this.template=['<div class="box">','<div class="input-row">','<label class="text columns-text" style="width: 130px;">'+this.txtColumns+'</label><div class="columns-val float-right"></div>',"</div>",'<div class="input-row" style="margin-top: 10px;">','<label class="text rows-text" style="width: 130px;">'+this.txtRows+'</label><div class="rows-val float-right"></div>',"</div>","</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this.getChild();t.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.udColumns=new Common.UI.MetricSpinner({el:t.find(".columns-val"),step:1,width:64,value:2,defaultUnit:"",maxValue:63,minValue:1,allowDecimal:!1}),this.udRows=new Common.UI.MetricSpinner({el:t.find(".rows-val"),step:1,width:64,value:2,defaultUnit:"",maxValue:100,minValue:1,allowDecimal:!1})},getFocusedComponents:function(){return[this.udColumns,this.udRows]},getDefaultFocusableComponent:function(){return this.udColumns},onBtnClick:function(t){this.options.handler&&this.options.handler.call(this,t.currentTarget.attributes.result.value,{columns:this.udColumns.getNumberValue(),rows:this.udRows.getNumberValue()}),this.close()},onPrimary:function(){return this.options.handler&&this.options.handler.call(this,"ok",{columns:this.udColumns.getNumberValue(),rows:this.udRows.getNumberValue()}),this.close(),!1}},Common.Views.InsertTableDialog||{}))}),void 0===Common&&(Common={}),define("common/main/lib/view/CopyWarningDialog",["common/main/lib/component/Window"],function(){"use strict";Common.Views.CopyWarningDialog=Common.UI.Window.extend(_.extend({options:{width:500,height:325,cls:"modal-dlg copy-warning",buttons:["ok"]},initialize:function(t){_.extend(this.options,{title:this.textTitle,buttons:["ok"]},t||{}),this.template=['<div class="box">','<p class="message">'+this.textMsg+"</p>",'<div class="hotkeys">',"<div>",'<p class="hotkey">'+Common.Utils.String.platformKey("Ctrl+C","{0}")+"</p>",'<p class="message">'+this.textToCopy+"</p>","</div>","<div>",'<p class="hotkey">'+Common.Utils.String.platformKey("Ctrl+X","{0}")+"</p>",'<p class="message">'+this.textToCut+"</p>","</div>","<div>",'<p class="hotkey">'+Common.Utils.String.platformKey("Ctrl+V","{0}")+"</p>",'<p class="message">'+this.textToPaste+"</p>","</div>","</div>",'<div id="copy-warning-checkbox" class="text-align-left" style="margin-top: 20px;"></div>',"</div>",'<div class="separator horizontal"></div>'].join(""),this.options.tpl=_.template(this.template)(this.options),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this),this.chDontShow=new Common.UI.CheckBox({el:$("#copy-warning-checkbox"),labelText:this.textDontShow}),this.getChild().find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.autoSize()},autoSize:function(){var t=this.getChild(".box"),e=this.getChild(".footer"),i=this.getChild(".header"),n=this.getChild(".body");n.height(parseInt(t.height())+parseInt(e.css("height"))),this.setHeight(parseInt(n.css("height"))+parseInt(i.css("height")))},onBtnClick:function(t){this.options.handler&&this.options.handler.call(this,"checked"==this.chDontShow.getValue()),this.close()},onKeyPress:function(t){t.keyCode==Common.UI.Keys.RETURN&&(this.options.handler&&this.options.handler.call(this,"checked"==this.chDontShow.getValue()),this.close())},getSettings:function(){return"checked"==this.chDontShow.getValue()}},Common.Views.CopyWarningDialog||{}))}),void 0===Common&&(Common={}),define("common/main/lib/component/RadioBox",["common/main/lib/component/BaseView","underscore"],function(t,e){"use strict";Common.UI.RadioBox=Common.UI.BaseView.extend({options:{labelText:""},disabled:!1,rendered:!1,template:e.template('<div class="radiobox" data-hint="<%= dataHint %>" data-hint-direction="<%= dataHintDirection %>" data-hint-offset="<%= dataHintOffset %>"><input type="radio" name="<%= name %>" id="<%= id %>" class="button__radiobox"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><circle class="rb-circle" cx="8" cy="8" r="6.5" /><circle class="rb-check-mark" cx="8" cy="8" r="4" /></svg><span></span></div>'),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t),this.dataHint=t.dataHint,this.dataHintDirection=t.dataHintDirection,this.dataHintOffset=t.dataHintOffset;this.name=this.options.name||Common.UI.getId(),this.render(),this.options.disabled&&this.setDisabled(this.options.disabled),void 0!==this.options.checked&&this.setValue(this.options.checked,!0),this.setCaption(this.options.labelText)},render:function(){var t=this.$el||$(this.el);return t.html(this.template({labelText:this.options.labelText,name:this.name,id:Common.UI.getId("rdb-"),dataHint:this.dataHint,dataHintDirection:this.dataHintDirection,dataHintOffset:this.dataHintOffset})),this.$radio=t.find("input[type=radio]"),this.$label=t.find("div.radiobox"),this.$span=this.$label.find("span"),this.$label.on({keydown:this.onKeyDown.bind(this),click:function(t){this.disabled||this.setValue(!0)}.bind(this)}),this.rendered=!0,this},setDisabled:function(t){this.rendered&&((t=!!t)!==this.disabled&&(this.$label.toggleClass("disabled",t),this.$radio.toggleClass("disabled",t),t?this.$radio.attr({disabled:t}):this.$radio.removeAttr("disabled"),void 0!==this.tabindex&&(t&&(this.tabindex=this.$label.attr("tabindex")),this.$label.attr("tabindex",t?"-1":this.tabindex))),this.disabled=t)},isDisabled:function(){return this.disabled},onItemCheck:function(t){this.disabled||this.setValue(!0)},setRawValue:function(t){(t=!0===t||"true"===t||"1"===t||1===t)&&$("input[type=radio][name="+this.name+"]").removeClass("checked"),this.$radio.toggleClass("checked",t),this.$radio.prop("checked",t)},setValue:function(t,e){var i;this.rendered?(i=this.$radio.hasClass("checked"),this.setRawValue(t),!0!==e&&i!==t&&this.trigger("change",this,this.$radio.is(":checked"))):this.options.checked=t},getValue:function(){return this.$radio.is(":checked")},setCaption:function(t){this.$span.text(t),this.$span.css("visibility",t?"visible":"hidden")},onKeyDown:function(t){t.isDefaultPrevented()||t.keyCode===Common.UI.Keys.SPACE&&this.onItemCheck(t)},focus:function(){this.$label&&this.$label.focus()},setTabIndex:function(t){this.rendered&&(this.tabindex=t.toString(),this.disabled||this.$label.attr("tabindex",this.tabindex))}})}),define("common/main/lib/view/OptionsDialog",["common/main/lib/component/Window","common/main/lib/component/RadioBox"],function(){"use strict";Common.Views.OptionsDialog=Common.UI.Window.extend(_.extend({options:{width:214,header:!0,style:"min-width: 214px;",cls:"modal-dlg",items:[],buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,t||{}),this.template=['<div class="box">','<% if (typeof label !== "undefined" && label !=="") { %>','<label style="margin-bottom: 10px;"><%= label %></label>',"<% } %>","<% _.each(items, function(item, index) { %>","<% if (!item.id) item.id = Common.UI.getId(); %>",'<div id="<%= item.id %>" style="margin-bottom: 10px;"></div>',"<% }) %>","</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),this.radio=[],Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var n=this,t=n.getChild(),e=this.options.items,i=!0;if(this.checkedIndex=-1,e){for(var o=0;o<e.length;o++){var s=e[o];this.radio.push(new Common.UI.RadioBox({el:t.find("#"+s.id),labelText:s.caption||"",name:"asc-radio-opt-dlg",value:s.value,disabled:!!s.disabled,checked:i&&!s.disabled}).on("change",function(t,e,i){e&&(n.currentCell=t.options.value)})),!i&&!s.checked||s.disabled||(i=!1,this.checkedIndex=o)}0<=this.checkedIndex&&(this.radio[this.checkedIndex].setValue(!0),this.currentCell=this.radio[this.checkedIndex].options.value)}t.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this))},getFocusedComponents:function(){return this.radio},getDefaultFocusableComponent:function(){return 0<=this.checkedIndex?this.radio[this.checkedIndex]:null},_handleInput:function(t){this.options.handler&&this.options.handler.call(this,this,t),this.close()},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},getSettings:function(){return this.currentCell},onPrimary:function(){return this._handleInput("ok"),!1}},Common.Views.OptionsDialog||{}))}),define("text!documenteditor/main/app/template/DropcapSettingsAdvanced.template",[],function(){return'<div id="id-adv-dropcap-frame" class="settings-panel">\n    <div class="inner-content">\n        <table cols="3" style="width: 100%">\n            <tr>\n                <td colspan="3">\n                    <label class="header  padding-small"><%= scope.textPosition %></label>\n                </td>\n            </tr>\n            <tr>\n                <td colspan="3" class="settins-cell padding-large">\n                    <span id="frame-advanced-button-none" class="margin-right-5"></span>\n                    <span id="frame-advanced-button-inline" class="margin-right-5"></span>\n                    <span id="frame-advanced-button-flow"></span>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small" colspan="3">\n                    <div class="separator horizontal"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="settins-cell padding-small" width="80">\n                    <label class="input-label"><%= scope.textWidth %></label>\n                </td>\n                <td class="settins-cell padding-small padding-right-10" width="130">\n                    <div id="frame-advanced-input-widthtype"></div>\n                </td>\n                <td class="settins-cell padding-small" width="95">\n                    <div id="frame-advanced-input-width"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="settins-cell padding-small" width="80">\n                    <label class="input-label"><%= scope.textHeight %></label>\n                </td>\n                <td class="settins-cell padding-small padding-right-10" width="130">\n                    <div id="frame-advanced-input-heighttype"></div>\n                </td>\n                <td class="settins-cell padding-small" width="95">\n                    <div id="frame-advanced-input-height"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small" colspan="3">\n                    <div class="separator horizontal"></div>\n                </td>\n            </tr>\n            <tr>\n                <td colspan="3">\n                    <label class="header"><%= scope.textHorizontal %></label>\n                </td>\n            </tr>\n            <tr>\n                <td colspan="2"></td>\n                <td class="settins-cell">\n                    <label class="input-label"><%= scope.textRelative %></label>\n                </td>\n            </tr>\n            <tr>\n                <td class="settins-cell padding-small" width="80">\n                    <label class="input-label"><%= scope.textPosition %></label>\n                </td>\n                <td class="settins-cell padding-small padding-right-10" width="130">\n                    <div id="frame-advanced-input-hposition"></div>\n                </td>\n                <td class="settins-cell padding-small" width="95">\n                    <div id="frame-advanced-input-hrelative"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="settins-cell padding-small padding-right-10" colspan="2">\n                    <label class="input-label float-right"><%= scope.textDistance %></label>\n                </td>\n                <td class="settins-cell padding-small">\n                    <div id="frame-advanced-input-hdist"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small" colspan="3">\n                    <div class="separator horizontal"></div>\n                </td>\n            </tr>\n            <tr>\n                <td colspan="3">\n                    <label class="header"><%= scope.textVertical %></label>\n                </td>\n            </tr>\n            <tr>\n                <td colspan="2"></td>\n                <td class="settins-cell">\n                    <label class="input-label"><%= scope.textRelative %></label>\n                </td>\n            </tr>\n            <tr>\n                <td class="settins-cell padding-small" width="80">\n                    <label class="input-label"><%= scope.textPosition %></label>\n                </td>\n                <td class="settins-cell padding-small padding-right-10" width="130">\n                    <div id="frame-advanced-input-vposition"></div>\n                </td>\n                <td class="settins-cell padding-small" width="95">\n                    <div id="frame-advanced-input-vrelative"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="settins-cell padding-small padding-right-10" colspan="2">\n                    <label class="input-label float-right"><%= scope.textDistance %></label>\n                </td>\n                <td class="settins-cell padding-small">\n                    <div id="frame-advanced-input-vdist"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small" colspan="3">\n                    <div id="frame-advanced-checkbox-move"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-adv-dropcap-dropcap" class="settings-panel">\n    <div class="inner-content">\n        <label class="header padding-small" style="width: 100%;"><%= scope.textPosition %></label>\n        <div class="padding-small" style="width: 100%">\n            <span id="drop-advanced-button-none" class="margin-right-5"></span>\n            <span id="drop-advanced-button-intext" class="margin-right-5"></span>\n            <span id="drop-advanced-button-inmargin" class="margin-right-5"></span>\n        </div>\n        <label class="header padding-small" style="width: 100%;"><%= scope.textParameters %></label>\n        <label class="input-label"><%= scope.textFont %></label>\n        <div id="drop-advanced-input-fonts" class="padding-small" style="width: 100%;"></div>\n    </div>\n    <div class="inner-content">\n        <table cols="2" style="width: 100%;">\n            <tr>\n                <td width="50%">\n                    <label class="input-label"><%= scope.textRowHeight %></label>\n                    <div id="drop-advanced-input-rowheight"></div>\n                </td>\n                <td width="50%">\n                    <label class="input-label"><%= scope.textDistance %></label>\n                    <div id="drop-advanced-input-distance"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-adv-dropcap-borders" class="settings-panel">\n    <div class="inner-content">\n        <div style="width: 100%;" class="padding-small">\n            <label class="input-label margin-right-5"><%= scope.textBorderWidth %></label>\n            <div id="drop-advanced-input-bordersize" style="display: inline-block; vertical-align: middle; width: 93px;"></div>\n            <div style="display: inline-block; vertical-align: middle;" class="float-right">\n                <label class="input-label margin-right-5"><%= scope.textBorderColor %></label>\n                <div id="drop-advanced-button-bordercolor" style="display: inline-block;"></div>\n            </div>\n        </div>\n        <label class="input-label padding-small" style="width: 100%;"><%= scope.textBorderDesc %></label>\n        <div style="width: 100%;" class="padding-large">\n            <div id="drop-advanced-borderstyler" style="display: inline-block; vertical-align: middle; width: 200px; height: 170px;outline: 1px solid #ccc;"></div>\n            <div style="display: inline-block; vertical-align: middle; width: 80px; height: 170px; padding-top: 10px;" class="float-right padding-left-4">\n                <div id="drop-advanced-button-borderline-00" style="display: inline-block;"></div>\n                <div id="drop-advanced-button-borderline-01" style="display: inline-block;"></div>\n                <div id="drop-advanced-button-borderline-10" style="display: inline-block;"></div>\n                <div id="drop-advanced-button-borderline-11" style="display: inline-block;"></div>\n                <div id="drop-advanced-button-borderline-20" style="display: inline-block;"></div>\n                <div id="drop-advanced-button-borderline-21" style="display: inline-block;"></div>\n                <div id="drop-advanced-button-borderline-30" style="display: inline-block;"></div>\n                <div id="drop-advanced-button-borderline-31" style="display: inline-block;"></div>\n            </div>\n        </div>\n        <div style="width: 100%;" class="padding-small">\n            <label class="input-label margin-right-5"><%= scope.textBackColor %></label>\n            <div id="drop-advanced-button-color" style="display: inline-block;"></div>\n        </div>\n    </div>\n</div>\n<div id="id-adv-dropcap-margins" class="settings-panel">\n    <div class="inner-content">\n        <table cols="2" style="width: 100%;">\n            <tr>\n                <td class="padding-small" width="50%">\n                    <label class="input-label"><%= scope.textTop %></label>\n                    <div id="drop-advanced-input-top"></div>\n                </td>\n                <td class="padding-small" width="50%">\n                    <label class="input-label"><%= scope.textLeft %></label>\n                    <div id="drop-advanced-input-left"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small" width="50%">\n                    <label class="input-label"><%= scope.textBottom %></label>\n                    <div id="drop-advanced-input-bottom"></div>\n                </td>\n                <td class="padding-small" width="50%">\n                    <label class="input-label"><%= scope.textRight %></label>\n                    <div id="drop-advanced-input-right"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>'}),void 0===Common&&(Common={}),define("common/main/lib/component/ComboBox",["common/main/lib/component/BaseView","common/main/lib/component/Scroller"],function(){"use strict";Common.UI.ComboBoxModel=Backbone.Model.extend({defaults:function(){return{id:Common.UI.getId(),value:null,displayValue:null}}}),Common.UI.ComboBoxStore=Backbone.Collection.extend({model:Common.UI.ComboBoxModel}),Common.UI.ComboBox=Common.UI.BaseView.extend({options:{id:null,cls:"",style:"",hint:!1,editable:!0,disabled:!1,menuCls:"",menuStyle:"",restoreMenuHeight:!0,displayField:"displayValue",valueField:"value",search:!1,placeHolder:"",scrollAlwaysVisible:!1,takeFocusOnClose:!1,dataHint:"",dataHintDirection:"",dataHintOffset:""},template:_.template(['<span class="input-group combobox <%= cls %>" id="<%= id %>" style="<%= style %>">','<input type="text" class="form-control" spellcheck="false" placeholder="<%= placeHolder %>" data-hint="<%= dataHint %>" data-hint-direction="<%= dataHintDirection %>" data-hint-offset="<%= dataHintOffset %>">','<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">','<span class="caret"></span>',"</button>",'<ul class="dropdown-menu <%= menuCls %>" style="<%= menuStyle %>" role="menu">',"<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%- item.value %>"><a tabindex="-1" type="menuitem"><%= scope.getDisplayValue(item) %></a></li>',"<% }); %>","</ul>","</span>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);t=this;this.id=t.options.id||Common.UI.getId(),this.cls=t.options.cls,this.style=t.options.style,this.menuCls=t.options.menuCls,this.menuStyle=t.options.menuStyle,this.template=t.options.template||t.template,this.itemsTemplate=t.options.itemsTemplate,this.hint=t.options.hint,this.editable=t.options.editable,this.disabled=t.options.disabled,this.store=t.options.store||new Common.UI.ComboBoxStore,this.displayField=t.options.displayField,this.valueField=t.options.valueField,this.placeHolder=t.options.placeHolder,this.search=t.options.search,this.scrollAlwaysVisible=t.options.scrollAlwaysVisible,this.focusWhenNoSelection=!1!==t.options.focusWhenNoSelection,this.restoreMenuHeight=t.options.restoreMenuHeight,t.rendered=t.options.rendered||!1,this.lastValue=null,t.store.add(t.options.data),t.options.el&&t.render()},render:function(t){var e,i,n,o,s=this;return s.rendered?this.cmpEl=s.$el||$(this.el):(o=this.store.toJSON(),this.cmpEl=$(this.template({id:this.id,cls:this.cls,style:this.style,menuCls:this.menuCls,menuStyle:this.menuStyle,items:o,scope:s,placeHolder:this.placeHolder,dataHint:this.options.dataHint,dataHintDirection:this.options.dataHintDirection,dataHintOffset:this.options.dataHintOffset,isRTL:Common.UI.isRTL()})),this.itemsTemplate&&this.cmpEl.find("ul").html($(this.itemsTemplate({items:o,scope:s}))),(t?(this.setElement(t,!1),t):this.$el).html(this.cmpEl)),s.rendered||(e=this.cmpEl,this._input=e.find("input"),this._button=e.find(".btn"),e.on("click","a",_.bind(this.itemClicked,this)),e.on("mousedown","a",_.bind(this.itemMouseDown,this)),this.editable?(e.on("change","input",_.bind(this.onInputChanged,this)),e.on("input","input",_.bind(this.onInputChanging,this)),e.on("keydown","input",_.bind(this.onInputKeyDown,this)),e.on("focusin","input",_.bind(this.onInputFocusIn,this)),e.on("click",".form-control",_.bind(this.onEditableInputClick,this))):(e.on("click",".form-control",_.bind(this.onInputClick,this)),this._input.attr("readonly","readonly"),this._input.attr("data-can-copy",!1),this._input.on("mousedown",function(t){t.preventDefault()})),s.options.hint&&(e.attr("data-toggle","tooltip"),e.tooltip({title:s.options.hint,placement:s.options.hintAnchor||"cursor"}),0<(i=e.closest(".asc-window")).length&&(e.data("bs.tooltip").tip().css("z-index",parseInt(i.css("z-index"))+10),n=function(t){i[0]===t.$window[0]&&((t=e.data("bs.tooltip"))&&(void 0===t.dontShow&&(t.dontShow=!0),t.hide()),Common.NotificationCenter.off({"modal:close":n}))},Common.NotificationCenter.on({"modal:close":n})),e.find(".dropdown-menu").on("mouseenter",function(){var t=e.data("bs.tooltip");t&&(void 0===t.dontShow&&(t.dontShow=!0),t.hide())})),(o=e.find(".dropdown-menu")).hasClass("menu-absolute")&&o.css("min-width",e.outerWidth()),e.on("show.bs.dropdown",_.bind(s.onBeforeShowMenu,s)),e.on("shown.bs.dropdown",_.bind(s.onAfterShowMenu,s)),e.on("hide.bs.dropdown",_.bind(s.onBeforeHideMenu,s)),e.on("hidden.bs.dropdown",_.bind(s.onAfterHideMenu,s)),e.on("keydown.after.bs.dropdown",_.bind(s.onAfterKeydownMenu,s)),Common.NotificationCenter.on("menumanager:hideall",_.bind(s.closeMenu,s)),this.setDefaultSelection(),this.listenTo(this.store,"reset",this.onResetItems)),s.rendered=!0,s.disabled&&s.setDisabled(s.disabled),this},setData:function(t){this.store.reset([]),this.store.add(t),this.setRawValue(""),this.onResetItems()},openMenu:function(t){var e;this.store.length<1||((e=this).scroller||(this.scroller=new Common.UI.Scroller(_.extend({el:$(".dropdown-menu",this.cmpEl),minScrollbarLength:40,includePadding:!0,wheelSpeed:10,alwaysVisibleY:this.scrollAlwaysVisible},this.options.scroller))),_.delay(function(){e.cmpEl.addClass("open")},t||0))},closeMenu:function(){this.cmpEl.removeClass("open")},isMenuOpen:function(){return this.cmpEl.hasClass("open")},onBeforeShowMenu:function(t){this.scroller||(this.scroller=new Common.UI.Scroller(_.extend({el:$(".dropdown-menu",this.cmpEl),minScrollbarLength:40,includePadding:!0,wheelSpeed:10,alwaysVisibleY:this.scrollAlwaysVisible},this.options.scroller))),Common.NotificationCenter.trigger("menu:show"),this.trigger("show:before",this,t),this.options.hint&&(t=this.cmpEl.data("bs.tooltip"))&&(void 0===t.dontShow&&(t.dontShow=!0),t.hide());var e,i,t=this.cmpEl.find("ul");t.hasClass("menu-absolute")?((e=(i=this.cmpEl.offset()).left)+t.outerWidth()>Common.Utils.innerWidth()&&(e+=this.cmpEl.outerWidth()-t.outerWidth()),t.css({left:e,top:i.top+this.cmpEl.outerHeight()+2})):t.hasClass("menu-aligned")&&(i=this.cmpEl.offset(),t.toggleClass("show-top",i.top+this.cmpEl.outerHeight()+t.outerHeight()>Common.Utils.innerHeight()))},onAfterShowMenu:function(t){this.alignMenuPosition();var e,i,n,o,s=$(this.el).find("ul"),a=s.find("> li.selected");a.length?(n=a.position().top,e=a.outerHeight(),i=s.outerHeight(),(n<0||i<n+e)&&(n=s.scrollTop()+n+(e-i)/2,n=Math.floor(n/e)*e,s.scrollTop(n)),setTimeout(function(){a.find("a").focus()},1)):this.focusWhenNoSelection&&(o=this,setTimeout(function(){o.cmpEl.find("ul li:first a").focus()},1)),this.scroller&&this.scroller.update({alwaysVisibleY:this.scrollAlwaysVisible}),this.trigger("show:after",this,t,{fromKeyDown:void 0===t}),this._search={}},alignMenuPosition:function(){var t,e,i,n,o;this.restoreMenuHeight&&(t=$(this.el).find("ul"),"number"!=typeof this.restoreMenuHeight&&(e=parseFloat(t.css("max-height")),t.hasClass("scrollable-menu")||e?this.restoreMenuHeight=e||1e5:this.restoreMenuHeight=1e5),e=Common.Utils.croppedGeometry().height-10,i=t.outerHeight(),(o=e<(n=t.get(0).getBoundingClientRect().top)+(o=(o=i)<this.restoreMenuHeight?this.restoreMenuHeight:o)?e-n:o)!==i&&t.css("max-height",o+"px"))},onBeforeHideMenu:function(t){this.trigger("hide:before",this,t),Common.UI.Scroller.isMouseCapture()&&t.preventDefault()},onAfterHideMenu:function(t,e){var i;this.cmpEl.find(".dropdown-toggle").blur(),this.trigger("hide:after",this,t,e),Common.NotificationCenter.trigger("menu:hide",this,e),this.options.takeFocusOnClose&&((i=this)._input&&0<i._input.length&&!i.editable&&i._input[0].selectionStart===i._input[0].selectionEnd&&setTimeout(function(){i._input[0].selectionStart=i._input[0].selectionEnd=0},1),setTimeout(function(){i.focus()},1))},onAfterKeydownMenu:function(t){if(t.keyCode==Common.UI.Keys.DOWN&&!this.editable&&!this.isMenuOpen())return this.openMenu(),this.onAfterShowMenu(),!1;if(this.focusWhenNoSelection||t.keyCode!=Common.UI.Keys.DOWN&&t.keyCode!=Common.UI.Keys.UP){var e,i;if(t.keyCode==Common.UI.Keys.RETURN&&(this.editable||this.isMenuOpen()))return e=this.isMenuOpen(),$(t.target).click(),this.rendered&&(Common.Utils.isIE?this._input.trigger("change",{onkeydown:!0}):this._input.blur()),!e;{if(t.keyCode==Common.UI.Keys.ESC&&this.isMenuOpen())return this._input.val(this.lastValue),this.closeMenu(),this.onAfterHideMenu(t),!1;this.search&&64<t.keyCode&&t.keyCode<91&&t.key&&"object"==typeof this._search&&(i=this,clearTimeout(this._search.timer),this._search.timer=setTimeout(function(){i._search={}},1e3),this._search.text||(this._search.text=""),this._search.char||(this._search.char=t.key),this._search.char!==t.key&&(this._search.full=!0),this._search.text+=t.key,void 0===this._search.index&&(n=this.cmpEl.find("ul > li").find("> a"),this._search.index=n.index(n.filter(":focus"))),this.selectCandidate())}}else{var n;0===(n=this.cmpEl.find("ul > li a")).filter(":focus").length&&0<n.length&&setTimeout(function(){n[t.keyCode==Common.UI.Keys.DOWN?0:n.length-1].focus()},1)}},selectCandidate:function(){for(var t,e,i,n,o,s,a=this._search.index&&-1!=this._search.index?this._search.index:0,l=new RegExp("^"+(this._search.full?this._search.text:this._search.char),"i"),r=l.test(this.store.at(a).get(this.displayField)),c=0;c<this.store.length;c++){var d=this.store.at(c);if(l.test(d.get(this.displayField))){if(!t&&(t=d,e=c,!r))break;if(this._search.full&&c==a||a<c){t=d,e=c;break}}}t&&(this._search.index=e,d=$("#"+t.get("id")+" a",$(this.el)),this.scroller&&(this.scroller.update({alwaysVisibleY:this.scrollAlwaysVisible}),i=$(this.el).find("ul"),n=d.position().top,o=d.outerHeight(),s=i.outerHeight(),(n<0||s<n+o)&&(s=i.scrollTop()+n,s=Math.floor(s/o)*o,i.scrollTop(s))),d.focus())},onInputKeyDown:function(t){var e=this;t.keyCode==Common.UI.Keys.ESC?(this._input.val(this.lastValue),this.closeMenu(),this.onAfterHideMenu(t)):t.keyCode==Common.UI.Keys.UP||t.keyCode==Common.UI.Keys.DOWN?(this.isMenuOpen()||(this.openMenu(),this.onAfterShowMenu()),_.delay(function(){e._skipInputChange=!0,e.cmpEl.find("ul li:first a").focus()},10)):t.keyCode==Common.UI.Keys.RETURN&&$(t.target).val()===e.lastValue?this._input.trigger("change",{reapply:!0}):e._skipInputChange=!1},onInputFocusIn:function(t){this.trigger("combo:focusin",this,t)},onInputChanged:function(t,e){var i,n,o;e&&e.synthetic||(this._skipInputChange?this._skipInputChange=!1:(i=$(t.target).val(),n={},this.lastValue!==i||e&&e.reapply?(n[this.valueField]=i,this.trigger("changed:before",this,n,t),t.isDefaultPrevented()||(this._selectedItem=this.store.findWhere(((o={})[this.displayField]=i,o)),this._selectedItem&&(n=this._selectedItem.toJSON(),$(".selected",$(this.el)).removeClass("selected"),$("#"+this._selectedItem.get("id"),$(this.el)).addClass("selected")),this.trigger("changed:after",this,n,t))):e&&e.onkeydown&&this.trigger("combo:blur",this,t)))},onInputChanging:function(t,e){var i=$(t.target).val();t.isDefaultPrevented()||this.trigger("changing",this,i,t)},onInputClick:function(t){this._button&&this._button.dropdown("toggle"),t.preventDefault(),t.stopPropagation()},onEditableInputClick:function(t){var e;this.options.hint&&(e=this.cmpEl.data("bs.tooltip"))&&(void 0===e.dontShow&&(e.dontShow=!0),e.hide()),this.isMenuOpen()&&1==t.which&&t.stopPropagation()},setDefaultSelection:function(){var t,e;!this.rendered||(t=this._input.val())&&(this._selectedItem=this.store.findWhere(((e={})[this.displayField]=t,e)),this._selectedItem&&($(".selected",$(this.el)).removeClass("selected"),$("#"+this._selectedItem.get("id"),$(this.el)).addClass("selected")))},setDisabled:function(t){this.disabled=t=!!t,this.rendered&&(t?this._input.attr("disabled",!0):this._input.removeAttr("disabled"),this.cmpEl.toggleClass("disabled",t),this._button.toggleClass("disabled",t))},isDisabled:function(){return this.disabled},setRawValue:function(t){this.rendered&&(this._input.val(t).trigger("change",{synthetic:!0}),this.lastValue=null!=t?t.toString():t)},getRawValue:function(){return this.rendered?this._input.val():null},setValue:function(t,e){var i;this.rendered&&(this._selectedItem=this.store.findWhere(((i={})[this.valueField]=t,i)),$(".selected",$(this.el)).removeClass("selected"),this._selectedItem?(this.setRawValue(this._selectedItem.get(this.displayField)),$("#"+this._selectedItem.get("id"),$(this.el)).addClass("selected")):this.setRawValue(void 0!==e?e:t))},getValue:function(){return this.rendered?this._selectedItem&&!_.isUndefined(this._selectedItem.get(this.valueField))?this._selectedItem.get(this.valueField):this._input.val():null},getDisplayValue:function(t){return Common.Utils.String.htmlEncode(t[this.displayField])},getSelectedRecord:function(){return this.rendered&&this._selectedItem&&!_.isUndefined(this._selectedItem.get(this.valueField))?_.extend({},this._selectedItem.toJSON()):null},selectRecord:function(t){this.rendered&&t&&(this._selectedItem=t,$(".selected",$(this.el)).removeClass("selected"),this.setRawValue(this._selectedItem.get(this.displayField)),$("#"+this._selectedItem.get("id"),$(this.el)).addClass("selected"))},clearSelection:function(){$(".selected",$(this.el)).removeClass("selected"),this._selectedItem=null},itemClicked:function(t){var e=$(t.target).closest("li");this._selectedItem=this.store.findWhere({id:e.attr("id")}),this._selectedItem&&(this.lastValue=this._selectedItem.get(this.displayField),this._input.val(this.lastValue).trigger("change",{synthetic:!0}),$(".selected",$(this.el)).removeClass("selected"),e.addClass("selected"),this.trigger("selected",this,_.extend({},this._selectedItem.toJSON()),t),t.preventDefault()),this._isMouseDownMenu=!1},itemMouseDown:function(t){if(1!=t.which)return t.preventDefault(),t.stopPropagation(),!1;this._isMouseDownMenu=!0},onResetItems:function(){this.itemsTemplate?$(this.el).find("ul").html($(this.itemsTemplate({items:this.store.toJSON(),scope:this}))):$(this.el).find("ul").html(_.template(["<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%- item.value %>"><a tabindex="-1" type="menuitem"><%= scope.getDisplayValue(item) %></a></li>',"<% }); %>"].join(""))({items:this.store.toJSON(),scope:this})),_.isUndefined(this.scroller)||(this.scroller.destroy(),delete this.scroller),this.scroller=new Common.UI.Scroller(_.extend({el:$(".dropdown-menu",this.cmpEl),minScrollbarLength:40,includePadding:!0,wheelSpeed:10,alwaysVisibleY:this.scrollAlwaysVisible},this.options.scroller))},focus:function(){this._input&&this._input.focus()}}),Common.UI.ComboBoxCustom=Common.UI.ComboBox.extend(_.extend({itemClicked:function(t){Common.UI.ComboBox.prototype.itemClicked.call(this,t),this.options.updateFormControl&&this.options.updateFormControl.call(this,this._selectedItem)},setValue:function(t,e){Common.UI.ComboBox.prototype.setValue.call(this,t,e),this.options.updateFormControl&&this.options.updateFormControl.call(this,this._selectedItem,e)},selectRecord:function(t){Common.UI.ComboBox.prototype.selectRecord.call(this,t),this.options.updateFormControl&&this.options.updateFormControl.call(this,this._selectedItem)},focus:function(){this.cmpEl&&this.cmpEl.find(".form-control").focus()}},Common.UI.ComboBoxCustom||{}))}),void 0===Common&&(Common={});var FONT_TYPE_RECENT=4,Common,Common,Common,Common,Common,Common,c_oAscFrameWrap=(define("common/main/lib/component/ComboBoxFonts",["common/main/lib/component/ComboBox"],function(){"use strict";Common.UI.ComboBoxFonts=Common.UI.ComboBox.extend(function(){for(var t,m=Asc.FONT_THUMBNAIL_HEIGHT||28,i=document.createElement("canvas"),n=i.getContext("2d"),o=[{ratio:1.5,path:"../../../../sdkjs/common/Images/fonts_thumbnail"+(/^(zh|ja|ko)$/i.test(Common.Locale.getCurrentLanguage())?"_ea":"")+"@1.5x.png",width:450,height:1.5*m}],s=0,h=1,e=Common.Utils.applicationPixelRatio(),a=Math.abs(e-o[0].ratio),l=1;l<o.length;l++)(t=Math.abs(e-o[l].ratio))<a-1e-4&&(a=t,s=l);function r(){this.supportBinaryFormat=!0,this.image=null,this.binaryFormat=null,this.data=null,this.width=0,this.height=0,this.heightOne=0,this.count=0,this.offsets=null,this.load=function(t,e){var i,n;e&&(this.supportBinaryFormat?(i=this,(n=new XMLHttpRequest).open("GET",t+".bin",!0),n.responseType="arraybuffer",n.overrideMimeType?n.overrideMimeType("text/plain; charset=x-user-defined"):n.setRequestHeader("Accept-Charset","x-user-defined"),n.onload=function(){i.binaryFormat=new Uint8Array(this.response),e()},n.send(null)):(this.width=o[s].width,this.heightOne=o[s].height,this.image=new Image,this.image.onload=e,this.image.src=o[s].path))},this.openBinary=function(t){var e=this.binaryFormat,i=(this.width=e[0]<<24|e[1]<<16|e[2]<<8|e[3]<<0,this.heightOne=e[4]<<24|e[5]<<16|e[6]<<8|e[7]<<0,this.count=e[8]<<24|e[9]<<16|e[10]<<8|e[11]<<0,this.height=this.count*this.heightOne,4*this.width*this.height),n=5e7<i,o=(n?this.offsets=new Array(this.count):this.data=new Uint8ClampedArray(i),12),s=e.length,a=0,l=0,r=0;if(n)for(var c=this.width*this.heightOne,d=c-1;o<s;)if(0==(r=e[o++]))for(l=e[o++];0<l;)l--,++d===c&&(this.offsets[a++]={pos:o,len:l+1},d=0);else++d===c&&(this.offsets[a++]={pos:o-1,len:-1},d=0);else for(var h=this.data;o<s;)if(0==(r=e[o++]))for(l=e[o++];0<l;)l--,h[a]=h[a+1]=h[a+2]=255,h[a+3]=0,a+=4;else h[a]=h[a+1]=h[a+2]=255-r,h[a+3]=r,a+=4;this.offsets||delete this.binaryFormat},this.getImage=function(t,e,i){if(this.supportBinaryFormat){this.data||this.offsets||this.openBinary(this.binaryFormat),e||((e=document.createElement("canvas")).width=this.width,e.height=this.heightOne,e.style.width="300px",e.style.height=m+"px",i=e.getContext("2d"));var n=i.createImageData(this.width,this.heightOne),o=4*this.width*this.heightOne;if(this.offsets){var s,a=this.binaryFormat,l=this.offsets[t].pos,r=0,c=this.width*this.heightOne,d=0,h=n.data;for(-1!=this.offsets[t].len&&(r+=4*this.offsets[t].len);0<c;)if(0==(s=a[l++]))for(c<(d=a[l++])&&(d=c);0<d;)d--,h[r]=h[r+1]=h[r+2]=255,h[r+3]=0,r+=4,c--;else h[r]=h[r+1]=h[r+2]=255-s,h[r+3]=s,r+=4,c--}else n.data.set(new Uint8ClampedArray(this.data.buffer,t*o,o));i.putImageData(n,0,0)}else e||((e=document.createElement("canvas")).width=this.width,e.height=this.heightOne,e.style.width="300px",e.style.height=m+"px",i=e.getContext("2d")),i.clearRect(0,0,this.width,this.heightOne),i.drawImage(this.image,0,-this.heightOne*t);return e}}return i.height=o[s].height,i.width=o[s].width,{template:_.template(['<div class="input-group combobox fonts <%= cls %>" id="<%= id %>" style="<%= style %>">','<input type="text" class="form-control" spellcheck="false" data-hint="<%= dataHint %>" data-hint-direction="<%= dataHintDirection %>"> ','<div style="display: table-cell;"></div>','<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown"><span class="caret"></span></button>','<ul class="dropdown-menu <%= menuCls %>" style="<%= menuStyle %>" role="menu">','<li class="divider">',"<% _.each(items, function(item) { %>",'<li id="<%= item.id %>">','<a class="font-item" tabindex="-1" type="menuitem" style="height:<%=scope.getListItemHeight()%>px;"></a>',"</li>","<% }); %>","</ul>","</div>"].join("")),initialize:function(t){Common.UI.ComboBox.prototype.initialize.call(this,_.extend(t,{displayField:"name",scroller:{wheelSpeed:20,alwaysVisibleY:!0,onChange:this.updateVisibleFontsTiles.bind(this)}})),this.recent=_.isNumber(t.recent)?t.recent:5;t=Common.localStorage.getKeysFilter();this.appPrefix=t&&t.length?t.split(",")[0]:"",Common.NotificationCenter.on("fonts:load",_.bind(this.fillFonts,this))},render:function(t){var e=null,i="";return _.isUndefined(this._input)||(e=this._input.val(),i=this._input.attr("tabindex")),Common.UI.ComboBox.prototype.render.call(this,t),this.setRawValue(e),this._input.attr("tabindex",i),this._input.on("keyup",_.bind(this.onInputKeyUp,this)),this._input.on("keydown",_.bind(this.onInputKeyDown,this)),this._input.on("focus",_.bind(function(){this.inFormControl=!0},this)),this._input.on("blur",_.bind(function(){this.inFormControl=!1},this)),this},onAfterKeydownMenu:function(t){var e=this;if(t.keyCode==Common.UI.Keys.RETURN){if($(t.target).closest("input").length){if(this.lastValue===this._input.val())return!0;this._input.trigger("change")}else $(t.target).click(),this.rendered&&(Common.Utils.isIE?this._input.trigger("change",{onkeydown:!0}):this._input.blur());return!1}if(t.keyCode==Common.UI.Keys.ESC&&this.isMenuOpen())return this._input.val(this.lastValue),setTimeout(function(){e.closeMenu(),e.onAfterHideMenu(t)},10),!1;(t.keyCode==Common.UI.Keys.HOME&&!t.shiftKey||t.keyCode==Common.UI.Keys.END&&!t.shiftKey||t.keyCode==Common.UI.Keys.BACKSPACE&&!e._input.is(":focus"))&&this.isMenuOpen()&&(e._input.focus(),setTimeout(function(){e._input[0].selectionStart=e._input[0].selectionEnd=t.keyCode==Common.UI.Keys.HOME?0:e._input[0].value.length},10)),this.updateVisibleFontsTiles()},onInputKeyUp:function(t){var n;this._isKeyDown&&(t.keyCode!=Common.UI.Keys.RETURN&&t.keyCode!==Common.UI.Keys.SHIFT&&t.keyCode!==Common.UI.Keys.CTRL&&t.keyCode!==Common.UI.Keys.ALT&&t.keyCode!==Common.UI.Keys.LEFT&&t.keyCode!==Common.UI.Keys.RIGHT&&t.keyCode!==Common.UI.Keys.HOME&&t.keyCode!==Common.UI.Keys.END&&t.keyCode!==Common.UI.Keys.ESC&&t.keyCode!==Common.UI.Keys.INSERT&&t.keyCode!==Common.UI.Keys.TAB&&(t.stopPropagation(),this.selectCandidate(t.keyCode==Common.UI.Keys.DELETE||t.keyCode==Common.UI.Keys.BACKSPACE),this._selectedItem&&void 0===(n=this)._timerSelection&&(n._timerSelection=setInterval(function(){var t,e,i;new Date-n._inInputKeyDown<100||!n._selectedItem||(clearInterval(n._timerSelection),n._timerSelection=void 0,t=n._input[0],e=n._selectedItem.get(n.displayField),i=t.value,n.rendered&&(document.selection?document.selection.createRange().text=e:!t.selectionStart&&"0"!=t.selectionStart||(t.value=e,t.selectionStart=i.length,t.selectionEnd=e.length)))},10))),this._isKeyDown=!1)},onInputKeyDown:function(e){this._isKeyDown=!0,this._inInputKeyDown=new Date;var i=this;e.keyCode==Common.UI.Keys.ESC?(this._input.val(this.lastValue),setTimeout(function(){i.closeMenu(),i.onAfterHideMenu(e)},10)):e.keyCode!=Common.UI.Keys.RETURN&&e.keyCode!=Common.UI.Keys.CTRL&&e.keyCode!=Common.UI.Keys.SHIFT&&e.keyCode!=Common.UI.Keys.ALT&&e.keyCode!=Common.UI.Keys.TAB?(this.isMenuOpen()||e.ctrlKey||(this.openMenu(),0<this.recent&&this.flushVisibleFontsTiles()),e.keyCode==Common.UI.Keys.UP||e.keyCode==Common.UI.Keys.DOWN?_.delay(function(){var t=e.keyCode==Common.UI.Keys.DOWN?i.cmpEl.find("ul li.selected").nextAll("li:not(.divider)"):i.cmpEl.find("ul li.selected").prevAll("li:not(.divider)");t=(t=0<t.length?t.eq(0):e.keyCode==Common.UI.Keys.DOWN?i.cmpEl.find("ul li:not(.divider):first"):i.cmpEl.find("ul li:not(.divider):last")).find("a"),i._skipInputChange=!0,t.focus(),i.updateVisibleFontsTiles()},10):i._skipInputChange=!1):e.keyCode==Common.UI.Keys.RETURN&&this._input.val()===i.lastValue&&this._input.trigger("change",{reapply:!0})},onInputChanged:function(t,e){var i,n;e&&e.synthetic||(this._skipInputChange?this._skipInputChange=!1:this._isMouseDownMenu?this._isMouseDownMenu=!1:(i=$(t.target).val(),n={},this.lastValue!==i||e&&e.reapply?(n[this.valueField]=i,n[this.displayField]=i,this.trigger("changed:before",this,n,t),t.isDefaultPrevented()||(this._selectedItem?(n[this.valueField]=this._selectedItem.get(this.displayField),this.setRawValue(n[this.valueField]),this.trigger("selected",this,_.extend({},this._selectedItem.toJSON()),t),this.addItemToRecent(this._selectedItem)):(this.setRawValue(n[this.valueField]),n.isNewFont=!0,this.trigger("selected",this,n,t)),this.closeMenu(),this.trigger("changed:after",this,n,t))):e&&e.onkeydown&&this.trigger("combo:blur",this,t)))},getImageUri:function(t){var e;return t.cloneid?null!=(e=$(this.el).find("ul > li#"+t.cloneid+" img"))?e[0].src:void 0:(e=Math.floor(t.imgidx/h),this.spriteThumbs.getImage(e,i,n).toDataURL())},getImageWidth:function(){return 300},getImageHeight:function(){return m},getListItemHeight:function(){return 28},loadSprite:function(t){this.spriteThumbs=new r,this.spriteThumbs.load(o[s].path,t)},fillFonts:function(e,t){var i=this;this.loadSprite(function(){var t;h=Math.floor(i.spriteThumbs.width/o[s].width)||1,i.store.set(e.toJSON()),i.rendered=!1,_.isUndefined(i.scroller)||(i.scroller.destroy(),delete i.scroller),i._scrollerIsInited=!1,i.render($(i.el)),i._fontsArray=i.store.toJSON(),0<i.recent&&(i.store.on("add",i.onInsertItem,i),i.store.on("remove",i.onRemoveItem,i),Common.Utils.InternalSettings.set(i.appPrefix+"-settings-recent-fonts",Common.localStorage.getItem(i.appPrefix+"-settings-recent-fonts")),(t=(t=Common.Utils.InternalSettings.get(i.appPrefix+"-settings-recent-fonts"))?t.split(";"):[]).reverse().forEach(function(t){t&&i.addItemToRecent(i.store.findWhere({name:t}),!0)}))})},onApiChangeFont:function(t){var e=this,t=_.isFunction(t.get_Name)?t.get_Name():t.asc_getFontName();this.__name!==t&&(this.__name=t,this.__nameId||(this.__nameId=setTimeout(function(){e.onApiChangeFontInternal(e.__name),e.__nameId=null},100)))},onApiChangeFontInternal:function(t){var e,i;this.inFormControl||this.getRawValue()!==t&&(e=this.store.findWhere({name:t}),$(".selected",$(this.el)).removeClass("selected"),e?(this.setRawValue(e.get(this.displayField)),e=$("#"+e.get("id"),$(this.el)),i=$("ul.dropdown-menu",this.cmpEl),e&&i&&(e.addClass("selected"),this.recent<=0&&i.scrollTop(e.offset().top-i.offset().top))):this.setRawValue(t))},itemClicked:function(t){this.__name=void 0,this.__nameId&&(clearTimeout(this.__nameId),this.__nameId=void 0),Common.UI.ComboBox.prototype.itemClicked.apply(this,arguments);t=$(t.target).closest("li"),t=this.store.findWhere({id:t.attr("id")});this.addItemToRecent(t)},onInsertItem:function(t){$(this.el).find("ul").prepend(_.template(['<li id="<%= item.id %>">','<a class="font-item" tabindex="-1" type="menuitem" style="height:<%=scope.getListItemHeight()%>px;"></a>',"</li>"].join(""))({item:t.attributes,scope:this}))},onRemoveItem:function(t,e,i){$(this.el).find("ul > li#"+t.id).remove()},onBeforeShowMenu:function(t){this.store.length<1?t.preventDefault():(Common.UI.ComboBox.prototype.onBeforeShowMenu.apply(this,arguments),!this.getSelectedRecord()&&this.getRawValue()&&(t=this.store.where({name:this.getRawValue()}))&&t.length&&this.selectRecord(t[t.length-1]))},onAfterShowMenu:function(t){this.alignMenuPosition(),0<this.recent?(this.scroller&&!this._scrollerIsInited&&(this.scroller.update(),this._scrollerIsInited=!0),$(this.el).find("ul").scrollTop(0),this.trigger("show:after",this,t),this.flushVisibleFontsTiles(),this.updateVisibleFontsTiles(null,0),Common.Utils.isGecko&&this.scroller&&this.scroller.update()):Common.UI.ComboBox.prototype.onAfterShowMenu.apply(this,arguments)},onAfterHideMenu:function(t){this.lastValue!==this._input.val()&&this._input.val(this.lastValue),Common.UI.ComboBox.prototype.onAfterHideMenu.apply(this,arguments)},addItemToRecent:function(t,e){var i,n;!t||this.recent<1||((i=this.store.findWhere({name:t.get("name"),type:FONT_TYPE_RECENT}))&&this.store.remove(i),(i=this.store.where({type:FONT_TYPE_RECENT})).length<this.recent||this.store.remove(i[this.recent-1]),(i=t.clone()).set({type:FONT_TYPE_RECENT,id:Common.UI.getId(),cloneid:t.id}),this.store.add(i,{at:0}),e||(n=[],this.store.where({type:FONT_TYPE_RECENT}).forEach(function(t){n.push(t.get("name"))}),n=n.join(";"),Common.localStorage.setItem(this.appPrefix+"-settings-recent-fonts",n),Common.Utils.InternalSettings.set(this.appPrefix+"-settings-recent-fonts",n)))},selectCandidate:function(e){var t,i,n=this,o=this._input.val().toLowerCase(),s=(this._fontsArray||(this._fontsArray=this.store.toJSON()),_.find(this._fontsArray,function(t){return e?t[n.displayField].toLowerCase()==o:0==t[n.displayField].toLowerCase().indexOf(o)}));this._selectedItem=s?this.store.findWhere({id:s.id}):null,$(".selected",$(this.el)).removeClass("selected"),this._selectedItem&&(s=$("#"+this._selectedItem.get("id"),$(this.el)),t=$("ul[role=menu]",$(this.el)),0<s.length&&0<t.length&&(s.addClass("selected"),s=s.position().top,i=t.scrollTop(),0!=s&&t.scrollTop(i+s)))},updateVisibleFontsTiles:function(t,e){var i=this,n=0,o=i.store.length,s=0;if(i.tiles||(i.tiles=[]),o!==i.tiles.length)for(n=i.tiles.length;n<o;++n)i.tiles.unshift(null);_.isUndefined(e)&&(e=parseInt($(i.el).find(".ps-scrollbar-x-rail").css("bottom")));for(var a,l=$(i.el).find(".dropdown-menu").height(),l=Math.max(Math.floor(l/28)+3,0),r=Math.max(Math.floor(-e/28)-1,0),c=r+l,d=$(i.el).find("a"),n=0;n<o;++n)r<=n&&n<c?null===i.tiles[n]&&(s=Math.floor(i.store.at(n).get("imgidx")/h),a=i.spriteThumbs.getImage(s),i.tiles[n]=a,$(d[n]).get(0).appendChild(a)):i.tiles[n]&&(i.tiles[n].parentNode.removeChild(i.tiles[n]),i.tiles[n]=null)},flushVisibleFontsTiles:function(){for(var t=this.tiles.length-1;0<=t;--t)this.tiles[t]&&(this.tiles[t].parentNode.removeChild(this.tiles[t]),this.tiles[t]=null)}}}())}),void 0===Common&&(Common={}),define("common/main/lib/component/MetricSpinner",["common/main/lib/component/BaseView"],function(){"use strict";Common.UI.MetricSpinner=Common.UI.BaseView.extend({options:{minValue:0,maxValue:100,step:1,defaultUnit:"px",allowAuto:!1,autoText:"Auto",hold:!0,speed:"medium",width:90,allowDecimal:!0,dataHint:"",dataHintDirection:"",dataHintOffset:""},disabled:!1,value:"0 px",rendered:!1,template:'<input type="text" class="form-control" spellcheck="false" data-hint="<%= dataHint %>" data-hint-direction="<%= dataHintDirection %>" data-hint-offset="<%= dataHintOffset %>"><div class="spinner-buttons"><button type="button" class="spinner-up"><i class="arrow"></i></button><button type="button" class="spinner-down"><i class="arrow"></i></button></div>',initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);var e=this,t=e.$el||$(this.el);t.addClass("spinner"),t.on("mousedown",".spinner-up",_.bind(this.onMouseDown,this,!0)),t.on("mousedown",".spinner-down",_.bind(this.onMouseDown,this,!1)),t.on("mouseup",".spinner-up",_.bind(this.onMouseUp,this,!0)),t.on("mouseup",".spinner-down",_.bind(this.onMouseUp,this,!1)),t.on("mouseover",".spinner-up, .spinner-down",_.bind(this.onMouseOver,this)),t.on("mouseout",".spinner-up, .spinner-down",_.bind(this.onMouseOut,this)),t.on("keydown",".form-control",_.bind(this.onKeyDown,this)),t.on("keyup",".form-control",_.bind(this.onKeyUp,this)),t.on("blur",".form-control",_.bind(this.onBlur,this)),t.on("input",".form-control",_.bind(this.onInput,this)),this.options.allowDecimal||t.on("keypress",".form-control",_.bind(this.onKeyPress,this)),t.on("focus","input.form-control",function(t){setTimeout(function(){e.$input&&(e.$input[0].selectionStart=0,e.$input[0].selectionEnd=e.$input.val().length)},1)}),Common.Utils.isGecko&&t.on("blur","input.form-control",function(){setTimeout(function(){e.$input&&(e.$input[0].selectionStart=e.$input[0].selectionEnd=0)},1)}),this.switches={count:1,enabled:!0,fromKeyDown:!1},"medium"===this.options.speed?this.switches.speed=300:"fast"===this.options.speed?this.switches.speed=100:this.switches.speed=500,this.render(),this.options.disabled&&this.setDisabled(this.options.disabled),void 0!==this.options.value&&(this.value=this.options.value),this.setRawValue(this.value),this.options.width&&t.width(this.options.width),void 0===this.options.defaultValue&&(this.options.defaultValue=this.options.minValue),this.oldValue=this.options.minValue,this.lastValue=null},render:function(){var t=this.$el||$(this.el),e=_.template(this.template);return t.html($(e({dataHint:this.options.dataHint,dataHintDirection:this.options.dataHintDirection,dataHintOffset:this.options.dataHintOffset}))),this.$input=t.find(".form-control"),this.rendered=!0,null!=this.options.tabindex&&this.$input.attr("tabindex",this.options.tabindex),this},setDisabled:function(t){t=!!t;var e=this.$el||$(this.el);t!==this.disabled&&(e.find("button").toggleClass("disabled",t),e.toggleClass("disabled",t),t?this.$input.attr({disabled:t}):this.$input.removeAttr("disabled")),this.disabled=t},isDisabled:function(){return this.disabled},setDefaultUnit:function(t){var e;this.options.defaultUnit!=t&&(e=this.options.defaultUnit,this.options.defaultUnit=t,this.setMinValue(this._recalcUnits(this.options.minValue,e)),this.setMaxValue(this._recalcUnits(this.options.maxValue,e)),this.setValue(this._recalcUnits(this.getNumberValue(),e),!0))},setMinValue:function(t){this.options.minValue=t},setMaxValue:function(t){this.options.maxValue=t},setStep:function(t){this.options.step=t},getMinValue:function(){return this.options.minValue},getMaxValue:function(){return this.options.maxValue},getNumberValue:function(){return this.checkAutoText(this.value)?-1:parseFloat(this.value)},getUnitValue:function(){return this.options.defaultUnit},getValue:function(){return this.value},setRawValue:function(t){this.$input&&this.$input.val(t)},getRawValue:function(){return this.$input.val()},setValue:function(t,e){var i,n,o=!1;this._fromKeyDown=!1,this.lastValue=this.value,void 0===t||""===t?this.value="":this.options.allowAuto&&(Math.abs(Common.Utils.String.parseFloat(t)+1)<1e-4||this.checkAutoText(t))?this.value=this.options.autoText:(i=this._add(Common.Utils.String.parseFloat(t),0,this.options.allowDecimal?3:0),void 0!==t&&!isNaN(i)||(i=this.oldValue,o=!0),n=this.options.defaultUnit,void 0!==t.match&&null!==(t=t.match(/(px|em|%|en|ex|pt|"|cm|mm|pc|s|ms|см|мм|пт|сек|мс)$/i))&&"undefined"!==t[0]&&(n=t[0].toLowerCase()),(i=this.options.defaultUnit===n||o?i:this._recalcUnits(i,n))>this.options.maxValue&&(i=this.options.maxValue,o=!0),i<this.options.minValue&&(i=this.options.minValue,o=!0),this.value=(i+" "+this.options.defaultUnit).trim(),this.oldValue=i),!0!==e&&this.lastValue!==this.value&&this.trigger("change",this,this.value,this.lastValue),!0!==e&&o&&this.trigger("inputerror",this,this.value),this.rendered?this.setRawValue(this.value):this.options.value=this.value},setMask:function(t){this.options.maskExp=t},onMouseDown:function(t,e){this.disabled||(e&&$(e.currentTarget).addClass("active"),this.options.hold&&(this.switches.fromKeyDown=!1,this._startSpin(t,e)))},onMouseUp:function(t,e){this.disabled||($(e.currentTarget).removeClass("active"),this.options.hold?this._stopSpin():this._step(t))},onMouseOver:function(t){this.disabled||$(t.currentTarget).addClass("over")},onMouseOut:function(t){this.disabled||($(t.currentTarget).removeClass("active over"),this.options.hold&&this._stopSpin())},onKeyDown:function(t){if(!this.disabled){if(!this.options.hold||t.keyCode!=Common.UI.Keys.UP&&t.keyCode!=Common.UI.Keys.DOWN)if(t.keyCode==Common.UI.Keys.RETURN)if(this.options.defaultUnit&&this.options.defaultUnit.length){var e=this.getRawValue();if(this.value!=e)return this.onEnterValue(),this.trigger("inputleave",this),this.value==e}else this.onEnterValue();else this._fromKeyDown=!0;else t.preventDefault(),t.stopPropagation(),void 0===this.switches.timeout&&(this.switches.fromKeyDown=!0,this._startSpin(t.keyCode==Common.UI.Keys.UP,t));t.keyCode==Common.UI.Keys.ESC&&this.setRawValue(this.value),t.keyCode!=Common.UI.Keys.RETURN&&t.keyCode!=Common.UI.Keys.ESC||this.trigger("inputleave",this)}},onKeyUp:function(t){this.disabled||t.keyCode!=Common.UI.Keys.UP&&t.keyCode!=Common.UI.Keys.DOWN||(t.stopPropagation(),t.preventDefault(),this.options.hold?this._stopSpin():this._step(t.keyCode==Common.UI.Keys.UP))},onKeyPress:function(t){var e;this.disabled||("."!=(e=String.fromCharCode(t.charCode))&&","!=e&&(!this.options.maskExp||this.options.maskExp.test(e)||t.ctrlKey||t.keyCode===Common.UI.Keys.RETURN)||(t.preventDefault(),t.stopPropagation()))},onInput:function(t,e){this.disabled||t.isDefaultPrevented()||this.trigger("changing",this,$(t.target).val(),t)},onEnterValue:function(){var t;this.$input&&(t=this.getRawValue(),this.setValue(""===t?this.value:t),this.trigger("entervalue",this))},onBlur:function(t){var e;this.$input&&(e=this.getRawValue(),this.setValue(""===e?this.value:e),this.options.hold&&this.switches.fromKeyDown&&this._stopSpin())},_startSpin:function(t,e){var i;this.disabled||(i=1===(i=this.switches.count)?(this._step(t,!0),1):i<3?1.5:i<8?2.5:6,this.switches.timeout=setTimeout($.proxy(function(){this._step(t,!0),this._startSpin(t)},this),this.switches.speed/i),this.switches.count++)},_stopSpin:function(t){void 0!==this.switches.timeout&&(clearTimeout(this.switches.timeout),this.switches.timeout=void 0,this.switches.count=1,this.trigger("change",this,this.value,this.lastValue))},_increase:function(t){var e,i=this;i.readOnly||(e=i.options.step,i._fromKeyDown?(e=this.getRawValue(),e=_.isEmpty(e)?i.oldValue:Common.Utils.String.parseFloat(e)):""!==i.getValue()?(e=i.checkAutoText(i.getValue())?i.options.defaultValue-i.options.step:Common.Utils.String.parseFloat(i.getValue()),isNaN(e)&&(e=this.oldValue)):e=i.options.defaultValue-i.options.step,i.setValue((this._add(e,i.options.step,i.options.allowDecimal?3:0)+" "+this.options.defaultUnit).trim(),t))},_decrease:function(t){var e=this;if(!e.readOnly){var i=e.options.step;if(e._fromKeyDown)i=this.getRawValue(),i=_.isEmpty(i)?e.oldValue:Common.Utils.String.parseFloat(i);else if(""!==e.getValue()){if(i=e.checkAutoText(e.getValue())?e.options.minValue:Common.Utils.String.parseFloat(e.getValue()),isNaN(i)&&(i=this.oldValue),e.options.allowAuto&&this._add(i,-e.options.step,e.options.allowDecimal?3:0)<e.options.minValue)return void e.setValue(e.options.autoText,!0)}else i=e.options.defaultValue;e.setValue((this._add(i,-e.options.step,e.options.allowDecimal?3:0)+" "+this.options.defaultUnit).trim(),t)}},_step:function(t,e){t?this._increase(e):this._decrease(e),this.options.hold&&this.switches.fromKeyDown&&this.$input&&this.$input.select()},_add:function(t,e,i){i=Math.pow(10,i||this.options.allowDecimal?2:0);return(Math.round(t*i)+Math.round(e*i))/i},_recalcUnits:function(t,e){var i;return e.match(/(s|ms|сек|мс)$/i)&&this.options.defaultUnit.match(/(s|ms|сек|мс)$/i)?(i=t,"ms"!=e&&"мс"!=e||(i=parseFloat((i/1e3).toFixed(6))),"ms"!=this.options.defaultUnit&&"мс"!=this.options.defaultUnit?i:parseFloat((1e3*i).toFixed(6))):null===e.match(/(pt|"|cm|mm|pc|см|мм|пт)$/i)||null===this.options.defaultUnit.match(/(pt|"|cm|mm|pc|см|мм|пт)$/i)?t:(i=t,"cm"==e||"см"==e?i*=10:"pt"==e||"пт"==e?i=25.4*i/72:'"'==e?i*=25.4:"pc"==e&&(i=25.4*i/6),"cm"==this.options.defaultUnit||"см"==this.options.defaultUnit?i=parseFloat((i/10).toFixed(6)):"pt"==this.options.defaultUnit||"пт"==this.options.defaultUnit?i=parseFloat((72*i/25.4).toFixed(3)):'"'==this.options.defaultUnit?i=parseFloat((i/25.4).toFixed(3)):"pc"==this.options.defaultUnit&&(i=parseFloat((6*i/25.4).toFixed(6))),i)},focus:function(){this.$input&&this.$input.focus()},setDefaultValue:function(t){this.options.defaultValue=t},checkAutoText:function(t){return!(!this.options.allowAuto||"string"!=typeof t)&&((t=t.toLowerCase())==this.options.autoText.toLowerCase()||"auto"==t)}}),Common.UI.CustomSpinner=Common.UI.MetricSpinner.extend(_.extend({initialize:function(t){this.options.toCustomFormat=t.toCustomFormat||function(t){return t},this.options.fromCustomFormat=t.fromCustomFormat||function(t){return t},Common.UI.MetricSpinner.prototype.initialize.call(this,t)},setRawValue:function(t){this.$input&&this.$input.val(this.options.toCustomFormat(t))},getRawValue:function(){return this.options.fromCustomFormat(this.$input.val())}},Common.UI.CustomSpinner||{}))}),void 0===Common&&(Common={}),define("common/main/lib/component/TableStyler",["common/main/lib/component/BaseView"],function(){"use strict";Common.UI.CellBorder=function(t){var e,i,a,n,o,l=this;l.overwriteStyle=void 0===t.overwriteStyle||t.overwriteStyle,l.maxBorderSize=t.maxBorderSize||8,l.defaultBorderSize=void 0!==t.defaultBorderSize?t.defaultBorderSize:1,l.defaultBorderColor=t.defaultBorderColor||"#ccc",l.col=void 0!==t.col?t.col:-1,l.row=void 0!==t.row?t.row:-1,l.cellPadding=void 0!==t.cellPadding?t.cellPadding:10,l.tablePadding=void 0!==t.tablePadding?t.tablePadding:10,l.X1=void 0!==t.x1?t.x1:0,l.Y1=void 0!==t.y1?t.y1:0,l.X2=void 0!==t.x2?t.x2:0,l.Y2=void 0!==t.y2?t.y2:0,l.numInCell=void 0!==t.numInCell?t.numInCell:-1,l.scale=void 0!==t.scale?t.scale:2,l.rows=void 0!==t.rows?t.rows:2,l.columns=void 0!==t.columns?t.columns:2,l.context=t.context,e=l.defaultBorderSize,i=new Common.Utils.RGBColor(l.defaultBorderColor),a=e,n=i,o=1,l.setBordersSize=function(t){a=t>this.maxBorderSize?this.maxBorderSize:t,o=t<1?.3:1},l.setBordersColor=function(t){var e=t;"string"==typeof t&&(e=new Common.Utils.RGBColor(t)),n=e},l.getBorderSize=function(){return a},l.getBorderColor=function(){return n.toHex()},l.setVirtualBorderSize=function(t){e=t>this.maxBorderSize?this.maxBorderSize:t},l.setVirtualBorderColor=function(t){i=t},l.getVirtualBorderSize=function(){return e},l.getVirtualBorderColor=function(){return i.toHex()},l.scaleBorderSize=function(t){return t*l.scale+.5>>0},l.getLine=function(){var t=l.scaleBorderSize(a);if(l.numInCell<0)return l.Y1==l.Y2?{X1:l.X1>>0,Y1:(l.Y1+t/2>>0)-t/2,X2:l.X2>>0,Y2:(l.Y2+t/2>>0)-t/2}:{X1:(l.X1+t/2>>0)-t/2,Y1:l.Y1>>0,X2:(l.X2+t/2>>0)-t/2,Y2:l.Y2>>0};var e=[],i=l.cellPadding*l.scale;if(t*=0===l.numInCell?1:-1,l.Y1==l.Y2)for(var n=(l.X2-l.X1)/l.columns,o=0;o<l.columns;o++)e.push({X1:l.X1+o*n+(0<o|0)*i/2>>0,Y1:(l.Y1>>0)+t/2,X2:l.X1+(o+1)*n-(o<l.columns-1|0)*i/2>>0,Y2:(l.Y1>>0)+t/2});else{n=(l.Y2-l.Y1)/l.rows;for(var s=0;s<l.rows;s++)e.push({X1:(l.X1>>0)+t/2,Y1:l.Y1+s*n+(0<s|0)*i/2>>0,X2:(l.X1>>0)+t/2,Y2:l.Y1+(s+1)*n-(s<l.rows-1|0)*i/2>>0})}return e},l.inRect=function(t,e){var i=l.scale*l.tablePadding/2,n=l.getLine(),o=t*l.scale,s=e*l.scale;if(l.numInCell<0)return n.Y1==n.Y2?o>n.X1&&o<n.X2&&s>n.Y1-i&&s<n.Y1+i:s>n.Y1&&s<n.Y2&&o>n.X1-i&&o<n.X1+i;if(l.Y1==l.Y2){for(var a=0;a<n.length;a++)if(o>n[a].X1&&o<n[a].X2&&s>n[a].Y1-i&&s<n[a].Y1+i)return!0}else for(a=0;a<n.length;a++)if(s>n[a].Y1&&s<n[a].Y2&&o>n[a].X1-i&&o<n[a].X1+i)return!0;return!1},l.drawBorder=function(){var t;0!=a&&(t=l.getLine(),l.context.beginPath(),l.context.globalAlpha=o,l.context.lineWidth=l.scaleBorderSize(a),l.context.strokeStyle=l.getBorderColor(),l.numInCell<0?(l.context.moveTo(t.X1,t.Y1),l.context.lineTo(t.X2,t.Y2)):_.each(t,function(t){l.context.moveTo(t.X1,t.Y1),l.context.lineTo(t.X2,t.Y2)}),l.context.stroke(),l.context.globalAlpha=1)},l.setBorderParams=function(){a==e&&i.isEqual(n)&&l.overwriteStyle?l.setBordersSize(0):(l.setBordersSize(e),l.setBordersColor(i))}},Common.UI.TableStyler=Common.UI.BaseView.extend({options:{width:200,height:200,sizeCorner:10,scale:2,row:-1,col:-1,rows:2,columns:2,cellPadding:10,tablePadding:10,overwriteStyle:!0,maxBorderSize:8,spacingMode:!1,defaultBorderSize:1,defaultBorderColor:"#ccc"},template:_.template(['<div id="<%=scope.id%>" class="table-styler" style="position: relative; width: <%=scope.width%>px; height:<%=scope.height%>px;">','<canvas id="<%=scope.id%>-table-canvas"  width ="<%=scope.width * scope.scale%>" height="<%=scope.height * scope.scale%>" style="left: 0; top: 0; width: 100%; height: 100%;">',"</canvas>","</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);var i,n,d=this,a=(d.id=d.options.id||Common.UI.getId(),d.scale=Common.Utils.applicationPixelRatio(),d.scale=1<=d.scale?d.scale:1,d.width=(d.options.width*d.scale>>0)/d.scale,d.height=(d.options.height*d.scale>>0)/d.scale,d.rows=d.options.rows,d.columns=d.options.columns,d.cellPadding=d.options.cellPadding,d.tablePadding=d.options.tablePadding,d.overwriteStyle=d.options.overwriteStyle,d.maxBorderSize=d.options.maxBorderSize,d.spacingMode=d.options.spacingMode,d.twoModes=d.options.twoModes,d.defaultBorderSize=d.options.defaultBorderSize,d.defaultBorderColor=d.options.defaultBorderColor,d.sizeCorner=d.options.sizeCorner,d.backgroundColor="transparent",d.backgroundCellColor="transparent",i=d.defaultBorderSize>d.maxBorderSize?d.maxBorderSize:d.defaultBorderSize,n=new Common.Utils.RGBColor(d.defaultBorderColor),{top:i,right:i,bottom:i,left:i}),l={top:n,right:n,bottom:n,left:n};d.rendered=!1,d.on("render:after",function(t){d.canv.addEventListener("click",function(t){void 0!==t.offsetX?(e=parseInt(t.offsetX*Common.Utils.zoom()),i=parseInt(t.offsetY*Common.Utils.zoom())):t.layerX&&(e=t.layerX,i=t.layerY);var e,i,n=!1;if(d.inRect("t",e,i))d.setBorderParams("t"),n=!0,d.fireEvent("borderclick",d,"t",a.top,l.top.toHex());else if(d.inRect("b",e,i))d.setBorderParams("b"),n=!0,d.fireEvent("borderclick",d,"b",a.bottom,l.bottom.toHex());else if(d.inRect("l",e,i))d.setBorderParams("l"),n=!0,d.fireEvent("borderclick",d,"l",a.left,l.left.toHex());else if(d.inRect("r",e,i))d.setBorderParams("r"),n=!0,d.fireEvent("borderclick",d,"r",a.right,l.right.toHex());else for(var o=0;o<d._cellBorders.length;o++)if(d._cellBorders[o].inRect(e,i)){var s,n=!0;d._cellBorders[o].setBorderParams(),d.fireEvent("borderclick:cellborder",d,d._cellBorders[o],d._cellBorders[o].getBorderSize(),d._cellBorders[o].getBorderColor()),d.spacingMode&&(s=void 0,0<d._cellBorders[o].col&&0===d._cellBorders[o].numInCell?s=d.getCellBorder(-1,d._cellBorders[o].col-1,1):0<d._cellBorders[o].row&&0===d._cellBorders[o].numInCell?s=d.getCellBorder(d._cellBorders[o].row-1,-1,1):-1<d._cellBorders[o].col&&d._cellBorders[o].col<d.columns-1&&1===d._cellBorders[o].numInCell?s=d.getCellBorder(-1,d._cellBorders[o].col+1,0):-1<d._cellBorders[o].row&&d._cellBorders[o].row<d.rows-1&&1===d._cellBorders[o].numInCell&&(s=d.getCellBorder(d._cellBorders[o].row+1,-1,0)),s&&s.setBorderParams());break}n&&d.redrawTable()}),$(window).resize(d.resizeTable)}),d.resizeTable=function(){d.context.clearRect(0,0,d.width*d.scale,d.height*d.scale),d.scale=Common.Utils.applicationPixelRatio(),d.scale=1<=d.scale?d.scale:1,d.width=(d.options.width*d.scale>>0)/d.scale,d.height=(d.options.height*d.scale>>0)/d.scale,d.cmpEl.css({width:d.width,height:d.height}),d.cmpEl.parent().css({width:d.width,height:d.height}),d._cellBorders.forEach(function(t){t.scale=d.scale});var t=d.sizeCorner*d.scale,e=d.width*d.scale,i=d.height*d.scale,n=(e-2*t)/d.columns,o=(i-2*t)/d.rows;if(d.spacingMode){for(var s=d.cellPadding*d.scale,n=(e-2*(t+=s))/d.columns,o=(i-2*t)/d.rows,a=r=0;a<d.columns;a++)for(var l=0;l<2;l++)d._cellBorders[r].Y1=t,d._cellBorders[r].Y2=i-t,d._cellBorders[r].X1=0==l?a*(n+s/2)+t:d.width*d.scale-t-(d.columns-a-1)*(n+s/2),d._cellBorders[r].X2=d._cellBorders[r].X1,r++;for(c=0;c<d.rows;c++)for(l=0;l<2;l++)d._cellBorders[r].Y1=0==l?c*(o+s/2)+t:d.height*d.scale-t-(d.rows-c-1)*(o+s/2),d._cellBorders[r].Y2=d._cellBorders[r].Y1,d._cellBorders[r].X1=t,d._cellBorders[r].X2=e-t,r++}else{for(var r=0,c=0;c<d.rows-1;c++)d._cellBorders[r].Y1=(c+1)*o+t,d._cellBorders[r].Y2=d._cellBorders[r].Y1,d._cellBorders[r].X1=t,d._cellBorders[r].X2=e-t,r++;for(var a=0;a<d.columns-1;a++)d._cellBorders[r].Y1=t,d._cellBorders[r].Y2=i-t,d._cellBorders[r].X1=(a+1)*n+t,d._cellBorders[r].X2=d._cellBorders[r].X1,r++}d.canv.width=d.width*d.scale,d.canv.height=d.height*d.scale,d.drawTable()},d.getVirtualBorderSize=function(){return i},d.getVirtualBorderColor=function(){return n.toHex()},d.setVirtualBorderSize=function(t){i=t>d.maxBorderSize?d.maxBorderSize:t;for(var e=0;e<d._cellBorders.length;e++)d._cellBorders[e].setVirtualBorderSize(t)},d.setVirtualBorderColor=function(t){var e=new Common.Utils.RGBColor(t);if(!n.isEqual(e)){n=e;for(var i=0;i<d._cellBorders.length;i++)d._cellBorders[i].setVirtualBorderColor(e)}},d.setBordersSize=function(t,e){e=e>d.maxBorderSize?d.maxBorderSize:e,-1<t.indexOf("t")&&(a.top=e),-1<t.indexOf("r")&&(a.right=e),-1<t.indexOf("b")&&(a.bottom=e),-1<t.indexOf("l")&&(a.left=e)},d.scaleBorderSize=function(t){return t*d.scale+.5>>0},d.setBordersColor=function(t,e){e=new Common.Utils.RGBColor(e);-1<t.indexOf("t")&&(l.top=e),-1<t.indexOf("r")&&(l.right=e),-1<t.indexOf("b")&&(l.bottom=e),-1<t.indexOf("l")&&(l.left=e)},d.getBorderSize=function(t){switch(t){case"t":return a.top;case"r":return a.right;case"b":return a.bottom;case"l":return a.left}return null},d.getBorderColor=function(t){switch(t){case"t":return l.top.toHex();case"r":return l.right.toHex();case"b":return l.bottom.toHex();case"l":return l.left.toHex()}return null},d.getBorderAlpha=function(t){return d.getBorderSize(t)<1?.2:1},d.setBorderParams=function(t){var e=new Common.Utils.RGBColor(d.getBorderColor(t));d.getBorderSize(t)==i&&n.isEqual(e)&&d.overwriteStyle?d.setBordersSize(t,0):(d.setBordersSize(t,d.getVirtualBorderSize()),d.setBordersColor(t,d.getVirtualBorderColor()))},d.getLine=function(t,e){var i=d.sizeCorner*d.scale,n=d.scaleBorderSize(t),o={},s=d.width*d.scale,a=d.height*d.scale;switch(e){case"t":o.X1=i>>0,o.Y1=(i>>0)+n/2,o.X2=s-i>>0,o.Y2=o.Y1;break;case"b":o.X1=i>>0,o.Y1=(a-i>>0)-n/2,o.X2=s-i>>0,o.Y2=o.Y1;break;case"l":o.X1=(i>>0)+n/2,o.Y1=i>>0,o.X2=o.X1,o.Y2=a-i>>0;break;case"r":o.X1=(s-i>>0)-n/2,o.Y1=i>>0,o.X2=o.X1,o.Y2=a-i>>0}return o},d.inRect=function(t,e,i){var n=d.tablePadding/2,o=d.getBorderSize(t),o=d.getLine(o,t);return(o={X1:o.X1/d.scale,Y1:o.Y1/d.scale,X2:o.X2/d.scale,Y2:o.Y2/d.scale}).Y1==o.Y2?o.X1<e&&e<o.X2&&o.Y1-n<i&&i<o.Y1+n:o.Y1<i&&i<o.Y2&&o.X1-n<e&&e<o.X1+n},d.setTableColor=function(t){d.backgroundColor="transparent"==t?t:"#"+t},d.setCellsColor=function(t){d.backgroundCellColor="transparent"==t?t:"#"+t},d.options.el&&d.render(null,{borderSize:a,borderColor:l,virtualBorderSize:i,virtualBorderColor:n})},render:function(t){var e=arguments[1],e=(this.trigger("render:before",this),this.rendered?this.cmpEl=$(this.el):(this.cmpEl=$(this.template(_.extend({scope:this},e))),(t?(this.setElement(t,!1),this.setElement(t,!1),t):$(this.el)).html(this.cmpEl),this.cmpEl.parent().css({width:this.width,height:this.height})),this.canv=$("#"+this.id+"-table-canvas")[0],this.context=this.canv.getContext("2d"),this.sizeCorner*this.scale);return e+=this.spacingMode?this.cellPadding*this.scale:0,this.rendered||(this._cellBorders=[],t={scale:this.scale,context:this.context,cellPadding:this.cellPadding,tablePadding:this.tablePadding,rows:this.rows,columns:this.columns},this.spacingMode||this.createHorizontalBorders(t,e),this.createVerticaLBorders(t,e),this.spacingMode&&this.createHorizontalBorders(t,e),this.drawTable()),this.rendered=!0,this.trigger("render:after",this),this},createHorizontalBorders:function(t,e){var i=t,n=this.width*this.scale,o=(this.height*this.scale-2*e)/this.rows,s=this.cellPadding*this.scale;if(this.spacingMode)for(l=0;l<this.rows;l++)for(var a=0;a<2;a++)i.numInCell=a,i.y1=0==a?l*(o+s/2)+e:this.height*this.scale-e-(this.rows-l-1)*(o+s/2),i.y2=i.y1,i.x1=e,i.x2=n-e,i.row=l,i.col=-1,this._cellBorders.push(new Common.UI.CellBorder(i));else for(var l=0;l<this.rows-1;l++)i.y1=(l+1)*o+e,i.y2=i.y1,i.x1=e,i.x2=n-e,i.row=l,i.col=-1,this._cellBorders.push(new Common.UI.CellBorder(i))},createVerticaLBorders:function(t,e){var i=t,n=this.height*this.scale,o=(this.width*this.scale-2*e)/this.columns,s=this.cellPadding*this.scale;if(this.spacingMode)for(l=0;l<this.columns;l++)for(var a=0;a<2;a++)i.numInCell=a,i.y1=e,i.y2=n-e,i.x1=0==a?l*(o+s/2)+e:this.width*this.scale-e-(this.columns-l-1)*(o+s/2),i.x2=i.x1,i.col=l,i.row=-1,this._cellBorders.push(new Common.UI.CellBorder(i));else for(var l=0;l<this.columns-1;l++)i.y1=e,i.y2=n-e,i.x1=(l+1)*o+e,i.x2=i.x1,i.row=-1,i.col=l,this._cellBorders.push(new Common.UI.CellBorder(i))},drawCorners:function(){var t=.5*this.scale+.5>>0,e=this.sizeCorner*this.scale,i=this.width*this.scale,n=this.height*this.scale,o=t/2;this.context.setLineDash([t,t]),this.context.lineWidth=t,this.context.strokeStyle="grey",this.context.beginPath(),this.context.moveTo((e>>0)-o,0),this.context.lineTo((e>>0)-o,(e>>0)-o),this.context.moveTo(e>>0,(e>>0)-o),this.context.lineTo(0,(e>>0)-o),this.context.moveTo((i-e>>0)+o,0),this.context.lineTo((i-e>>0)+o,e>>0),this.context.moveTo(i-e>>0,(e>>0)-o),this.context.lineTo(i>>0,(e>>0)-o),this.context.moveTo((i-e>>0)+o,n>>0),this.context.lineTo((i-e>>0)+o,n-e>>0),this.context.moveTo(i-e>>0,(n-e>>0)+o),this.context.lineTo(i>>0,(n-e>>0)+o),this.context.moveTo((e>>0)-o,n>>0),this.context.lineTo((e>>0)-o,n-e>>0),this.context.moveTo(e>>0,(n-e>>0)+o),this.context.lineTo(0,(n-e>>0)+o),this.context.stroke(),this.context.setLineDash([])},fillCells:function(){if(this.spacingMode&&"transparent"!=this.backgroundCellColor){var t=(this.sizeCorner+this.cellPadding)*this.scale,e=this.cellPadding*this.scale,i=(this.width*this.scale-2*t)/this.columns,n=(this.height*this.scale-2*t)/this.rows;this.context.beginPath(),this.context.fillStyle=this.backgroundCellColor;for(var o=0;o<this.rows;o++)for(var s=0;s<this.columns;s++)this.context.fillRect(t+s*i+(0<s|0)*e/2>>0,t+o*n+(0<o|0)*e/2>>0,i-((0<s|0)+(s<this.columns-1|0))*e/2>>0,n-((0<o|0)+(o<this.rows-1|0))*e/2>>0);this.context.stroke()}},drawBorder:function(t){var e,i=this.getBorderSize(t);i&&(e=this.getLine(i,t),this.context.imageSmoothingEnabled=!1,this.context.mozImageSmoothingEnabled=!1,this.context.msImageSmoothingEnabled=!1,this.context.webkitImageSmoothingEnabled=!1,this.context.lineWidth=this.scaleBorderSize(i),this.context.globalAlpha=this.getBorderAlpha(t),this.context.beginPath(),this.context.strokeStyle=this.getBorderColor(t),this.context.moveTo(e.X1,e.Y1),this.context.lineTo(e.X2,e.Y2),this.context.stroke(),this.context.globalAlpha=1)},fillWithLines:function(){var t,e,i,n,o=this.maxBorderSize+4;if(this.context.setLineDash([2*this.scale+.5>>0,2*this.scale+.5>>0]),this.context.strokeStyle="#c0c0c0",this.spacingMode){var s=(this.sizeCorner+this.cellPadding)*this.scale,a=this.cellPadding*this.scale;l=(this.width*this.scale-2*s)/this.columns,r=(this.height*this.scale-2*s)/this.rows,o*=this.scale,this.context.beginPath(),this.context.fillStyle=this.backgroundCellColor;for(h=0;h<this.rows;h++)for(p=0;p<this.columns;p++)e=l-((0<p|0)+(p<this.columns-1|0))*a/2-2*o+.5>>0,n=r-((0<h|0)+(h<this.rows-1|0))*a/2-2*o,t=s+p*l+(0<p|0)*a/2+o>>0,i=s+h*r+(0<h|0)*a/2+o,this.context.beginPath(),this.context.lineWidth=e,this.context.moveTo(t+e/2,i>>0),this.context.lineTo(t+e/2,i+n>>0),this.context.stroke()}else for(var l=(this.width-2*this.sizeCorner)/this.columns,r=(this.height-2*this.sizeCorner)/this.rows,c=this.sizeCorner,d=this.sizeCorner,h=0;h<this.rows;h++){for(var m=d,p=0;p<this.columns;p++)t=(m+o)*this.scale>>0,i=(c+o)*this.scale,e=(l-2*o)*this.scale+.5>>0,n=(r-2*o)*this.scale,this.context.lineWidth=e,this.context.beginPath(),this.context.moveTo(t+e/2,i>>0),this.context.lineTo(t+e/2,i+n>>0),this.context.stroke(),m+=l;c+=r}this.context.setLineDash([])},drawTable:function(){this.drawCorners();var t=this.sizeCorner*this.scale,e=this.width*this.scale-2*t>>0,i=this.height*this.scale-2*t>>0;this.context.fillStyle=this.backgroundColor,"transparent"!=this.backgroundColor&&(this.context.beginPath(),this.context.fillRect(t>>0,t>>0,e,i),this.context.stroke()),this.fillCells(),this._cellBorders.forEach(function(t){t.drawBorder()}),this.drawBorder("l"),this.drawBorder("r"),this.drawBorder("t"),this.drawBorder("b"),this.fillWithLines(),this.context.lineWidth=0},redrawTable:function(){this.context.clearRect(0,0,this.canv.width,this.canv.height),this.drawTable()},getCellBorder:function(t,e,i){return t=void 0===t?-1:t,e=void 0===e?-1:e,i=void 0===i?-1:i,_.findWhere(this._cellBorders,{row:t,col:e,numInCell:i})}})}),define("text!common/main/lib/template/ExtendedColorDialog.template",[],function(){return'<div class="color-box">\n    <div id="id-hsb-colorpicker" style="vertical-align:top;">\n    </div>\n    <div class="color-info" style="">\n        <div class="margin-left-15">\n            <label class="color-label"><%= txtNew %></label>\n            <div id="field-new-color" class="color-cnt top"></div>\n            <div id="field-start-color" class="color-cnt bottom"></div>\n            <label class="color-label"><%= txtCurrent %></label>\n        </div>\n        <div style="padding:13px 0 2px 0;">\n            <label class="input-label">R:</label>\n            <div id="extended-spin-r" class="color-spin"></div>\n        </div>\n        <div style="padding:2px 0;">\n            <label class="input-label">G:</label>\n            <div id="extended-spin-g" class="color-spin"></div>\n        </div>\n        <div style="padding:2px 0;">\n            <label class="input-label">B:</label>\n            <div id="extended-spin-b" class="color-spin"></div>\n        </div>\n        <div style="padding:11px 0 0 0;">\n            <label class="input-label" style="width:12px;">#:</label>\n            <input id="extended-text-color" type="text" role="textbox" style="width:62px; height: 22px;">\n        </div>\n    </div>\n</div>\n<div class="footer center">\n    <button class="btn normal dlg-btn primary" result="1"><%= txtAdd %></button>\n    <button class="btn normal dlg-btn" result="0"><%= txtCancel %></button>\n</div>\n'}),void 0===Common&&(Common={}),define("common/main/lib/component/HSBColorPicker",["common/main/lib/component/BaseView","common/main/lib/util/utils"],function(){"use strict";Common.UI.HSBColorPicker=Common.UI.BaseView.extend({template:_.template('<div class="hsb-colorpicker"><% if (this.showCurrentColor) { %><div class="top-panel"><span class="color-value"><span class="transparent-color img-colorpicker"></span></span><div class="color-text"></div></div><% } %><div><div class="cnt-hb img-colorpicker"><div class="cnt-hb-arrow"></div></div><% if (this.changeSaturation) { %><div class="cnt-root"><div class="cnt-sat img-colorpicker"><div class="cnt-sat-arrow img-colorpicker"></div></div></div><% } %></div><% if (this.allowEmptyColor) { %><div class="empty-color"><%= this.textNoColor %></div><% } %></div>'),color:"#ff0000",options:{allowEmptyColor:!1,changeSaturation:!0,showCurrentColor:!0},initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);var n,o,s,a,i,l,r,c,d=this,h=(d.$el||$(this.el),0),m=100,p=100,u=(d.allowEmptyColor=d.options.allowEmptyColor,d.changeSaturation=d.options.changeSaturation,d.showCurrentColor=d.options.showCurrentColor,function(t,e){t=new Common.Utils.RGBColor("hsb("+t.h+","+t.s+","+t.b+")").toHex();d.color=e?"transparent":t,g(),d.trigger("changecolor",d,d.color)}),g=function(){var t;0<i.length&&0<l.length&&("transparent"==d.color?l.show():(i.css("background-color",d.color),l.hide())),0<s.length&&(t="linear-gradient(rgba(255,255,255,0), #000), linear-gradient(-90deg,"+(t=new Common.Utils.RGBColor("hsb("+h+", 100, 100)")).toRGB()+","+t.toRGBA(0)+"), #fff",s.css("background",t)),0<r.length&&(r[0].innerHTML="transparent"==d.color?d.textNoColor:d.color.toUpperCase()),0<n.length&&0<o.length&&(n.css({left:m+"%",top:100-p+"%","background-color":d.color}),o.css("top",parseInt(100*h/360)+"%"))},b=function(t,e,i){0<n.length&&0<s.length&&(t=[Math.max(0,Math.min(100,parseInt((t.pageX*Common.Utils.zoom()-s.offset().left)/s.width()*100))),Math.max(0,Math.min(100,parseInt((t.pageY*Common.Utils.zoom()-s.offset().top)/s.height()*100)))],n.css("left",t[0]+"%"),n.css("top",t[1]+"%"),u({h:h,s:m=t[0],b:p=100-t[1]}))},C=function(t,e,i){o&&a&&(t=Math.max(0,Math.min(100,parseInt((t.pageY*Common.Utils.zoom()-a.offset().top)/a.height()*100))),o.css("top",t+"%"),h=parseInt(360*t/100),u({h:h,s:m,b:p}))},f=function(t,e,i){$(document).on("mouseup",v),$(document).on("mousemove",b)},v=function(t,e,i){$(document).off("mouseup",v),$(document).off("mousemove",b),b(t,e,i)},_=function(t,e,i){$(document).on("mouseup",w),$(document).on("mousemove",C),C(t,e,i)},w=function(t,e,i){$(document).off("mouseup",w),$(document).off("mousemove",C)},y=function(t){var e=new Common.util.RGBColor(d.color).toHSB();u(e,!0)};d.setColor=function(t){var e;d.color!=t&&(e="transparent"==t?{h:0,s:100,b:100}:new Common.Utils.RGBColor(t).toHSB(),h=e.h,m=e.s,p=e.b,h==m&&h==p&&0==h&&(m=100),d.color=t,g())},d.getColor=function(){return d.color},d.on("render:after",function(t){var e=$(d.el);e&&(n=e.find(".cnt-hb-arrow"),o=e.find(".cnt-sat-arrow"),s=e.find(".cnt-hb"),a=e.find(".cnt-sat"),i=e.find(".color-value"),r=e.find(".color-text"),c=e.find(".empty-color"),0<i.length&&(l=i.find(".transparent-color")),0<s.length&&(s.off("mousedown"),s.on("mousedown",f)),0<a.length&&(a.off("mousedown"),a.on("mousedown",_)),0<c.length&&(c.off("click"),c.on("click",y)),e="transparent"==d.color?{h:0,s:100,b:100}:new Common.Utils.RGBColor(d.color).toHSB(),h=e.h,m=e.s,p=e.b,h==m&&h==p&&0==h&&(m=100),g())}),d.render()},render:function(){return(this.$el||$(this.el)).html(this.template()),this.trigger("render:after",this),this},textNoColor:"No Color"})}),void 0===Common&&(Common={}),define("common/main/lib/component/MaskedField",["common/main/lib/component/BaseView"],function(){"use strict";Common.UI.MaskedField=Common.UI.BaseView.extend({options:{maskExp:"",maxLength:999},initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);var i=this,n=i.$el||$(this.el);n.addClass("masked-field user-select"),n.attr("maxlength",i.options.maxLength),n.on("keypress",function(t){var e=String.fromCharCode(t.which);i.options.maskExp.test(e)||t.ctrlKey||(t.keyCode==Common.UI.Keys.RETURN&&i.trigger("changed",i,n.val()),t.preventDefault(),t.stopPropagation())}),n.on("input",function(t){i.trigger("change",i,n.val())}),n.on("blur",function(t){i.trigger("changed",i,n.val())})},render:function(){return this},setValue:function(t){this.options.maskExp.test(t)&&t.length<=this.options.maxLength&&this.$el.val(t)},getValue:function(){this.$el.val()}})}),void 0===Common&&(Common={}),define("common/main/lib/view/ExtendedColorDialog",["text!common/main/lib/template/ExtendedColorDialog.template","common/main/lib/component/HSBColorPicker","common/main/lib/component/MetricSpinner","common/main/lib/component/MaskedField","common/main/lib/component/Window"],function(t){"use strict";Common.UI.ExtendedColorDialog=Common.UI.Window.extend(_.extend({tpl:_.template(t),options:{},rendered:!1,initialize:function(t){Common.UI.Window.prototype.initialize.call(this,{cls:"extended-color-dlg",tpl:this.tpl({txtNew:this.textNew,txtCurrent:this.textCurrent,txtAdd:this.addButtonText,txtCancel:this.cancelButtonText}),header:!1,width:340,height:272}),this.hexRe=/\s*#?([0-9a-fA-F][0-9a-fA-F]?)([0-9a-fA-F][0-9a-fA-F]?)([0-9a-fA-F][0-9a-fA-F]?)\s*/},render:function(){var e=this;return Common.UI.Window.prototype.render.call(this),this.colorsPicker=new Common.UI.HSBColorPicker({el:$("#id-hsb-colorpicker"),showCurrentColor:!1}),this.colorsPicker.on("changecolor",_.bind(this.onChangeColor,this)),this.colorNew=$("#field-new-color"),this.colorSaved=$("#field-start-color"),this.spinR=new Common.UI.MetricSpinner({el:$("#extended-spin-r"),step:1,width:63,value:"0",defaultUnit:"",maxValue:255,minValue:0,maskExp:/[0-9]/,allowDecimal:!1}),this.spinG=new Common.UI.MetricSpinner({el:$("#extended-spin-g"),step:1,width:63,value:"0",defaultUnit:"",maxValue:255,minValue:0,maskExp:/[0-9]/,allowDecimal:!1}),this.spinB=new Common.UI.MetricSpinner({el:$("#extended-spin-b"),step:1,width:63,value:"0",defaultUnit:"",maxValue:255,minValue:0,maskExp:/[0-9]/,allowDecimal:!1}),this.textColor=new Common.UI.MaskedField({el:$("#extended-text-color"),width:55,maskExp:/[a-fA-F0-9]/,maxLength:6}),this.spinR.on("change",_.bind(this.showColor,this,null,!0)).on("changing",_.bind(this.onChangingRGB,this,1)),this.spinG.on("change",_.bind(this.showColor,this,null,!0)).on("changing",_.bind(this.onChangingRGB,this,2)),this.spinB.on("change",_.bind(this.showColor,this,null,!0)).on("changing",_.bind(this.onChangingRGB,this,3)),this.textColor.on("change",_.bind(this.onChangeMaskedField,this)),this.textColor.on("changed",_.bind(this.onChangedMaskedField,this)),this.textColor.$el.on("focus",function(){setTimeout(function(){e.textColor.$el&&e.textColor.$el.select()},1)}),this.spinR.$el.find("input").attr("maxlength",3),this.spinG.$el.find("input").attr("maxlength",3),this.spinB.$el.find("input").attr("maxlength",3),this.on("close",function(){e.trigger("onmodalresult",0)}),$(this)[0].getChild(".footer .dlg-btn").on("click",function(t){e.trigger("onmodalresult",parseInt(t.currentTarget.attributes.result.value)),e.close(!0)}),this.rendered=!0,void 0!==this.color&&this.setColor(this.color),this},getFocusedComponents:function(){return[this.spinR,this.spinG,this.spinB,{cmp:this.textColor,selector:"input"}]},getDefaultFocusableComponent:function(){return this.getChild("#extended-text-color")},onChangeColor:function(t,e){this.colorNew.css({"background-color":e}),this.stopevents=!0;e=e.match(this.hexRe);this.spinR.setValue(parseInt(e[1],16)),this.spinG.setValue(parseInt(e[2],16)),this.spinB.setValue(parseInt(e[3],16)),this.textColor.setValue((e[1]+e[2]+e[3]).toUpperCase()),this.stopevents=!1},showColor:function(t,e){var i,n,o;this.stopevents||(i=null==(o=this.spinR.getNumberValue())||o<0?0:255<o?255:o,e&&this.spinR.setValue(i,!0),i=i.toString(16),n=null==(o=this.spinG.getNumberValue())||o<0?0:255<o?255:o,e&&this.spinG.setValue(n,!0),n=n.toString(16),o=null==(o=this.spinB.getNumberValue())||o<0?0:255<o?255:o,e&&this.spinB.setValue(o,!0),o=o.toString(16),e=(1==i.length?"0"+i:i)+(1==n.length?"0"+n:n)+(1==o.length?"0"+o:o),this.colorsPicker.setColor("#"+e),"hex"!=t&&this.textColor.setValue(e.toUpperCase()),this.colorNew.css("background-color","#"+e))},onChangingRGB:function(t,e,i,n){if(!this.stopevents){var o,s,a,l;switch(i=_.isEmpty(i)||isNaN(parseInt(i))?parseInt(e.getValue()):parseInt(i),t){case 1:o=(null==i||isNaN(i)||i<0?0:255<i?255:i).toString(16),s=(null==(l=this.spinG.getNumberValue())||l<0?0:255<l?255:l).toString(16),a=(null==(l=this.spinB.getNumberValue())||l<0?0:255<l?255:l).toString(16);break;case 2:o=(null==(l=this.spinR.getNumberValue())||l<0?0:255<l?255:l).toString(16),s=(null==i||isNaN(i)||i<0?0:255<i?255:i).toString(16),a=(null==(l=this.spinB.getNumberValue())||l<0?0:255<l?255:l).toString(16);break;case 3:o=(null==(l=this.spinR.getNumberValue())||l<0?0:255<l?255:l).toString(16),s=(null==(l=this.spinG.getNumberValue())||l<0?0:255<l?255:l).toString(16),a=(null==i||isNaN(i)||i<0?0:255<i?255:i).toString(16)}e=(1==o.length?"0"+o:o)+(1==s.length?"0"+s:s)+(1==a.length?"0"+a:a);this.colorsPicker.setColor("#"+e),this.textColor.setValue(e.toUpperCase()),this.colorNew.css("background-color","#"+e)}},onChangeMaskedField:function(t,e){e=(e="000000"+(e=/^[a-fA-F0-9]{0,6}$/.test(e)?e:"000000")).match(/([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})$/i);this.stopevents=!0,this.spinR.setValue(parseInt(e[1],16)),this.spinG.setValue(parseInt(e[2],16)),this.spinB.setValue(parseInt(e[3],16)),this.stopevents=!1,this.rendered&&this.showColor("hex")},onChangedMaskedField:function(t,e){/^[a-fA-F0-9]{0,6}$/.test(e)&&!_.isEmpty(e)||t.setValue("000000"),this.rendered&&this.showColor("",!0)},getColor:function(){var t=/#?([a-fA-F0-9]{6})/.exec(this.colorsPicker.getColor());return t?t[1]:null},setColor:function(t){var e,i=this;!0!==this.rendered?this.color=t:(e=/#?([a-fA-F0-9]{6})/.test(t)?t:"ff0000",i.colorsPicker.setColor("#"+e),"transparent"==t?i.colorSaved.addClass("color-transparent"):(i.colorSaved.removeClass("color-transparent"),i.colorSaved.css("background-color","#"+t)),i.colorNew.css("background-color","#"+e),i.stopevents=!0,t=i.hexRe.exec(e),i.spinR.setValue(parseInt(t[1],16)),i.spinG.setValue(parseInt(t[2],16)),i.spinB.setValue(parseInt(t[3],16)),i.textColor.setValue((t[1]+t[2]+t[3]).toUpperCase()),i.stopevents=!1)},onPrimary:function(){return this.trigger("onmodalresult",1),this.close(!0),!1}},Common.UI.ExtendedColorDialog||{}))}),void 0===Common&&(Common={}),define("common/main/lib/component/ThemeColorPalette",["common/main/lib/component/BaseView","common/main/lib/view/ExtendedColorDialog"],function(){"use strict";Common.UI.ThemeColorPalette=Common.UI.BaseView.extend(_.extend({options:{dynamiccolors:10,standardcolors:10,themecolors:10,columns:10,effects:5,hideEmptyColors:!0,allowReselect:!0,transparent:!1,value:"000000",enableKeyEvents:!0,colorHints:!0,keyMoveDirection:"both",storageSuffix:""},template:_.template('<div class="palette-inner"><% var me = this; var idx = 0; %><% $(colors).each(function(num, item) { %><% if (me.isBlankSeparator(item)) { %> <div class="palette-color-spacer"></div><% } else if (me.isSeparator(item)) { %> </div><div class="divider"></div><div style="padding: 12px;"><% } else if (me.isColor(item)) { %> <a class="palette-color color-<%=item%>" data-toggle="tooltip" style="background:#<%=item%>" idx="<%=idx++%>"><em><span style="background:#<%=item%>;" unselectable="on">&#160;</span></em></a><% } else if (me.isTransparent(item)) { %><a class="color-<%=item%>" data-toggle="tooltip" idx="<%=idx++%>"><em><span unselectable="on">&#160;</span></em></a><% } else if (me.isEffect(item)) { %><% if (idx>0 && me.columns>0 && idx%me.columns===0) { %> <div class="color-divider"></div><% } %><a effectid="<%=item.effectId%>" effectvalue="<%=item.effectValue%>" data-toggle="tooltip" class="palette-color-effect color-<%=item.color%>" style="background:#<%=item.color%>" idx="<%=idx++%>"><em><span style="background:#<%=item.color%>;" unselectable="on">&#160;</span></em></a><% } else if (me.isCaption(item)) { %><div class="palette-color-caption"><%=item%></div><% } %><% }); %></div><% if (me.options.dynamiccolors!==undefined) { %><div class="palette-color-dynamiccolors"><div class="palette-color-spacer"></div><div class="palette-color-caption"><%=me.textRecentColors%></div><% for (var i=0; i<me.options.dynamiccolors; i++) { %><a class="color-dynamic-<%=i%> dynamic-empty-color <%= me.emptyColorsClass %>" data-toggle="tooltip" color="" idx="<%=idx++%>"><em><span unselectable="on">&#160;</span></em></a><% } %><% } %></div>'),colorRe:/(?:^|\s)color-(.{6})(?:\s|$)/,selectedCls:"selected",initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);var e=this,t=e.$el||$(this.el);this.colors=e.options.colors||this.generateColorData(e.options.themecolors,e.options.effects,e.options.standardcolors,e.options.transparent),this.columns=e.options.columns||0,this.enableKeyEvents=e.options.enableKeyEvents,this.tabindex=e.options.tabindex||0,this.outerMenu=e.options.outerMenu,this.lastSelectedIdx=-1,this.emptyColorsClass=e.options.hideEmptyColors?"hidden":"",this.colorHints=e.options.colorHints,e.colorItems=[],"vertical"==e.options.keyMoveDirection?e.moveKeys=[Common.UI.Keys.UP,Common.UI.Keys.DOWN]:"horizontal"==e.options.keyMoveDirection?e.moveKeys=[Common.UI.Keys.LEFT,Common.UI.Keys.RIGHT]:e.moveKeys=[Common.UI.Keys.UP,Common.UI.Keys.DOWN,Common.UI.Keys.LEFT,Common.UI.Keys.RIGHT],t.addClass("theme-colorpalette"),this.render(),this.options.updateColorsArr&&this.updateColors(this.options.updateColorsArr[0],this.options.updateColorsArr[1]),this.options.value&&this.select(this.options.value,!0),this.options.outerMenu&&this.options.outerMenu.focusOnShow&&this.options.outerMenu.menu&&(t.addClass("focused"),this.options.outerMenu.menu.on("show:after",function(t){_.delay(function(){e.showLastSelected(),e.focus()},10)})),this.updateCustomColors(),t.closest(".btn-group").on("show.bs.dropdown",_.bind(this.updateCustomColors,this)),t.closest(".dropdown-submenu").on("show.bs.dropdown",_.bind(this.updateCustomColors,this)),t.on("click",_.bind(this.handleClick,this))},render:function(){this.$el.html(this.template({colors:this.colors}));var i=this,t=(this.moveKeys&&this.$el.find("a").each(function(t,e){i.colorItems.push({el:e,index:t})}),this.attachKeyEvents(),this.$el.closest(".asc-window"));return 0<t.length&&(this.tipZIndex=parseInt(t.css("z-index"))+10),this.colorHints&&(this.options.transparent&&this.createTip(this.$el.find("a.color-transparent"),this.textTransparent),this.options.themecolors||this.options.effects||this.updateHints("object"==typeof this.colorHints?this.colorHints:void 0),this.colorHints=!!this.colorHints),this},isBlankSeparator:function(t){return"string"==typeof t&&"-"==t},isSeparator:function(t){return"string"==typeof t&&"--"==t},isColor:function(t){return"string"==typeof t&&/[0-9A-F]{6}/.test(t)},isTransparent:function(t){return"string"==typeof t&&"transparent"==t},isCaption:function(t){return"string"==typeof t&&"-"!=t&&"--"!=t&&!/[0-9A-F]{6}|transparent/.test(t)},isEffect:function(t){return"object"==typeof t&&void 0!==t.effectId},getColor:function(){return this.value},updateCustomColors:function(){var t=this.$el||$(this.el);if(t){var e,i=0<=this.lastSelectedIdx?$(this.colorItems[this.lastSelectedIdx].el):t.find("a."+this.selectedCls),n=0<i.length&&/color-dynamic/.test(i[0].className)?i.attr("color"):void 0,o=(n&&(n=n.toUpperCase(),i.removeClass(this.selectedCls),this.lastSelectedIdx=-1),Common.localStorage.getItem("asc."+Common.localStorage.getId()+".colors.custom"+this.options.storageSuffix)),s=-1,a=(o=o?o.split(","):[]).length<this.options.dynamiccolors?o.length:this.options.dynamiccolors;for(this.options.hideEmptyColors&&this._layoutParams&&t.find(".dynamic-empty-color").length!==this.options.dynamiccolors-a&&(this._layoutParams=void 0);++s<a;)(e=t.find(".color-dynamic-"+s)).removeClass("dynamic-empty-color").removeClass(this.emptyColorsClass).attr("color",o[s]),e.find("span").css({"background-color":"#"+o[s]}),o[s]==n&&(e.addClass(this.selectedCls),this.lastSelectedIdx=parseInt(e.attr("idx")),n=void 0),this.colorHints&&this.createTip(e,Common.Utils.ThemeColor.getTranslation(Common.Utils.ThemeColor.getRgbColor(o[s]).asc_getName()));for(;s<this.options.dynamiccolors;)(e=t.find(".color-dynamic-"+s)).removeAttr("color"),e.addClass("dynamic-empty-color").addClass(this.emptyColorsClass),e.find("span").css({"background-color":"transparent"}),s++;t.find(".palette-color-dynamiccolors").toggleClass(this.emptyColorsClass,0===a)}},handleClick:function(t){var e,i,n=this,o=$(t.target).closest("a");if(0==o.length)return!1;o.hasClass("color-transparent")?(n.clearSelection(!0),o.addClass(n.selectedCls),t.suppressEvent||(n.lastSelectedIdx=parseInt(o.attr("idx")),n.value="transparent",n.trigger("select",n,"transparent"))):o[0].className.search("color-dynamic")<0?((!/^[a-fA-F0-9]{6}$/.test(n.value)||_.indexOf(n.colors,n.value)<0)&&(n.value=!1),n.clearSelection(!0),o.addClass(n.selectedCls),e=o[0].className.match(n.colorRe)[1],o.hasClass("palette-color-effect")?(i=parseInt(o.attr("effectid")),e&&!t.suppressEvent&&(n.value=e.toUpperCase(),n.trigger("select",n,{color:e,effectId:i}),n.lastSelectedIdx=parseInt(o.attr("idx")))):/#?[a-fA-F0-9]{6}/.test(e)&&(e=/#?([a-fA-F0-9]{6})/.exec(e)[1].toUpperCase())&&!t.suppressEvent&&(n.value=e,n.trigger("select",n,e),n.lastSelectedIdx=parseInt(o.attr("idx")))):/dynamic-empty-color/.test(o[0].className)?t.suppressEvent?(n.clearSelection(!0),o.addClass(n.selectedCls)):setTimeout(function(){n.addNewColor()},10):(n.clearSelection(!0),o.addClass(n.selectedCls),t.suppressEvent||(n.lastSelectedIdx=parseInt(o.attr("idx")),e=o.attr("color"),n.trigger("select",n,e),n.value=e.toUpperCase()))},setCustomColor:function(t){var e,i,n=this.$el||$(this.el);(t=/#?([a-fA-F0-9]{6})/.exec(t))&&(e=this.saveCustomColor(t[1]),this.clearSelection(!0),0==(i=n.find(".dynamic-empty-color")).length?(this.updateCustomColors(),i=n.find(".color-dynamic-"+(this.options.dynamiccolors-1))):e&&this.options.hideEmptyColors&&this._layoutParams&&(this._layoutParams=void 0),e&&(i.first().removeClass("dynamic-empty-color").removeClass(this.emptyColorsClass).addClass(this.selectedCls).attr("color",t[1]),i.first().find("span").css({"background-color":"#"+t[1]})),n.find(".palette-color-dynamiccolors").removeClass(this.emptyColorsClass),this.select(t[1],!0))},saveCustomColor:function(t){var e="asc."+Common.localStorage.getId()+".colors.custom"+this.options.storageSuffix,i=(i=Common.localStorage.getItem(e))?i.split(","):[],n=_.indexOf(i,t.toUpperCase());return n<0&&(i.push(t)>this.options.dynamiccolors&&i.shift(),Common.localStorage.setItem(e,i.join().toUpperCase())),n<0},addNewColor:function(t){var e=this,i=new Common.UI.ExtendedColorDialog({});i.on("onmodalresult",function(t){e._isdlgopen=!1,1==t&&(e.setCustomColor(i.getColor()),e.fireEvent("select",e,i.getColor())),e.fireEvent("close:extended",e,1==t)}),e._isdlgopen=!0,i.setColor(void 0!==e.value&&!1!==e.value?e.value:void 0!==t?t:"000000"),i.show()},isDialogOpen:function(){return 1==this._isdlgopen},select:function(t,e){var i,n,o=this.$el||$(this.el);this.clearSelection(),"object"==typeof t?void 0!==t.effectId?0<(i=o.find('a[effectid="'+t.effectId+'"]').first()).length?(i.addClass(this.selectedCls),this.lastSelectedIdx=parseInt(i.attr("idx")),this.value=i[0].className.match(this.colorRe)[1].toUpperCase()):this.value=!1:void 0!==t.effectValue&&(0<(i=o.find('a[effectvalue="'+t.effectValue+'"].color-'+t.color.toUpperCase()).first()).length?(i.addClass(this.selectedCls),this.lastSelectedIdx=parseInt(i.attr("idx")),this.value=i[0].className.match(this.colorRe)[1].toUpperCase()):this.value=!1):(/#?[a-fA-F0-9]{6}/.test(t)&&(t=/#?([a-fA-F0-9]{6})/.exec(t)[1].toUpperCase(),this.value=t),/^[a-fA-F0-9]{6}|transparent$/.test(t)&&0<=_.indexOf(this.colors,t)?(_.indexOf(this.colors,this.value)<0&&(this.value=!1),t==this.value&&!this.options.allowReselect||(n=("transparent"==t?o.find("a.color-transparent"):o.find("a.palette-color.color-"+t).first()).addClass(this.selectedCls),this.value=t,this.lastSelectedIdx=parseInt(n.attr("idx")),!0!==e&&this.fireEvent("select",this,t))):0<(n=0==(n=o.find("#"+t).first()).length?o.find('a[color="'+t+'"]').first():n).length&&(n.addClass(this.selectedCls),this.lastSelectedIdx=parseInt(n.attr("idx")),this.value=t.toUpperCase()))},selectByRGB:function(t,e){var i,n=this.$el||$(this.el),t=(this.clearSelection(!0),"object"==typeof t?t.color:t);/#?[a-fA-F0-9]{6}/.test(t)&&(t=/#?([a-fA-F0-9]{6})/.exec(t)[1].toUpperCase()),/^[a-fA-F0-9]{6}|transparent$/.test(t)&&(t!=this.value||this.options.allowReselect)&&(0<(i=0==(i=0==(i="transparent"==t?n.find("a.color-transparent"):n.find("a.color-"+t).first()).length?n.find("#"+t).first():i).length?n.find('a[color="'+t+'"]').first():i).length&&(i.addClass(this.selectedCls),this.lastSelectedIdx=parseInt(i.attr("idx")),this.value=t),!0!==e&&this.fireEvent("select",this,t))},updateColors:function(t,e,i){if(void 0!==t&&void 0!==e){for(var n,o=this,s=o.$el||$(this.el),a=(void 0===o.aColorElements&&(o.aColorElements=s.find("a.palette-color")),void 0===o.aEffectElements&&(o.aEffectElements=s.find("a.palette-color-effect")),0),l=0,r=0;r<o.colors.length;r++)"string"==typeof o.colors[r]&&/[0-9A-F]{6}/.test(o.colors[r])?a>=e.length||((n=$(o.aColorElements[a])).removeClass("color-"+o.colors[r]),o.colors[r]=e[a].color=e[a].color.toUpperCase(),n.addClass("color-"+o.colors[r]),n.css({background:"#"+o.colors[r]}),n.find("span").first().css({background:"#"+o.colors[r]}),o.colorHints&&o.createTip(n,e[a].tip),a++):"object"!=typeof o.colors[r]||void 0===o.colors[r].effectId||l>=t.length||(n=$(o.aEffectElements[l]),t[l].color=t[l].color.toUpperCase(),o.colors[r].color!==t[l].color&&(n.removeClass("color-"+o.colors[r].color),n.addClass("color-"+t[l].color),n.css({background:"#"+t[l].color}),n.find("span").first().css({background:"#"+t[l].color})),o.colors[r].effectId!==t[l].effectId&&n.attr("effectid",""+t[l].effectId),o.colors[r].effectValue!==t[l].effectValue&&n.attr("effectvalue",""+t[l].effectValue),o.colors[r]=t[l],o.colorHints&&o.createTip(n,t[l].tip),l++);i?this.select(i,!0):(i=s.find("a."+this.selectedCls)).length&&i.hasClass("palette-color-effect")&&(this.value=i[0].className.match(this.colorRe)[1].toUpperCase()),this.options.updateColorsArr=void 0}},createTip:function(t,e){var i=this.tipZIndex,n=(void 0===t.attr("color-name")&&t.one("mouseenter",function(t){t=$(t.currentTarget);t.tooltip({title:t.attr("color-name"),placement:"cursor",zIndex:i}),t.mouseenter()}),t.data("bs.tooltip"));n&&n.updateTitle(e),t.attr("color-name",e||"")},clearSelection:function(t){this.$el.find("a."+this.selectedCls).removeClass(this.selectedCls),t||(this.value=void 0,this.lastSelectedIdx=-1)},showLastSelected:function(){this.selectByIndex(this.lastSelectedIdx,!0)},getSelectedColor:function(){var t=(this.$el||$(this.el)).find("a."+this.selectedCls).attr("idx");return void 0!==t?this.colorItems[parseInt(t)]:null},selectByIndex:function(t,e){this.clearSelection(!0),0<=t&&t<this.colorItems.length&&this.handleClick({target:this.colorItems[t].el,suppressEvent:e})},generateColorData:function(t,e,i,n){var o=[],s=0<t&&0<e?t*e:0;if(0<t){for(var o=[this.textThemeColors],a=0;a<t;a++)o.push({color:"FFFFFF",effectId:1});0<e&&o.push("-");for(a=0;a<s;a++)o.push({color:"FFFFFF",effectId:1});i&&o.push("-")}if(i){o.push(this.textStandartColors),n&&(o.push("transparent"),i--);for(a=0;a<i;a++)o.push("FFFFFF")}return o},onKeyDown:function(t,e){if(void 0===e&&(e=t),-1<_.indexOf(this.moveKeys,e.keyCode)||e.keyCode==Common.UI.Keys.RETURN){e.preventDefault(),e.stopPropagation();t=this.getSelectedColor();if(e.keyCode==Common.UI.Keys.RETURN)t&&this.selectByIndex(t.index),this.outerMenu&&this.outerMenu.menu&&this.outerMenu.menu.hide();else{if((o=t?t.index:-1)<0)o=0;else if("both"==this.options.keyMoveDirection){void 0===this._layoutParams&&this.fillIndexesArray();var i=this.colorItems[o].topIdx,n=this.colorItems[o].leftIdx,o=void 0;if(e.keyCode==Common.UI.Keys.LEFT)for(;void 0===o;)--n<0&&(n=this._layoutParams.columns-1),o=this._layoutParams.itemsIndexes[i][n];else if(e.keyCode==Common.UI.Keys.RIGHT)for(;void 0===o;)++n>this._layoutParams.columns-1&&(n=0),o=this._layoutParams.itemsIndexes[i][n];else if(e.keyCode==Common.UI.Keys.UP)if(0==i&&this.outerMenu&&this.outerMenu.menu)this.clearSelection(!0),this.outerMenu.menu.focusOuter(e,this.outerMenu.index);else for(;void 0===o;)--i<0&&(i=this._layoutParams.rows-1),o=this._layoutParams.itemsIndexes[i][n];else if(i==this._layoutParams.rows-1&&this.outerMenu&&this.outerMenu.menu)this.clearSelection(!0),this.outerMenu.menu.focusOuter(e,this.outerMenu.index);else for(;void 0===o;)++i>this._layoutParams.rows-1&&(i=0),o=this._layoutParams.itemsIndexes[i][n]}else o=e.keyCode==Common.UI.Keys.UP||e.keyCode==Common.UI.Keys.LEFT?Math.max(0,o-1):Math.min(this.colorItems.length-1,o+1);void 0!==o&&0<=o&&(this._fromKeyDown=!0,this.selectByIndex(o,!0),this._fromKeyDown=!1)}}},fillIndexesArray:function(){if(!(this.colorItems.length<=0)){this._layoutParams={itemsIndexes:[],columns:0,rows:0};for(var t=$(this.colorItems[0].el),e=t.outerWidth()+parseInt(t.css("margin-left"))+parseInt(t.css("margin-right")),i=this.$el.offset().left,n=t.offset().top,o=-1,s=0,a=0;a<this.colorItems.length;a++){var l=$(this.colorItems[a].el).offset().top-n,r=Math.floor(($(this.colorItems[a].el).offset().left-i)/e);o<l&&(o=l,this._layoutParams.itemsIndexes.push([]),s=this._layoutParams.itemsIndexes.length-1),this._layoutParams.itemsIndexes[s][r]=a,this.colorItems[a].topIdx=s,this.colorItems[a].leftIdx=r,this._layoutParams.columns<r&&(this._layoutParams.columns=r)}this._layoutParams.rows=this._layoutParams.itemsIndexes.length,this._layoutParams.columns++}},attachKeyEvents:function(){var t;this.enableKeyEvents&&((t=this.$el||$(this.el)).addClass("canfocused"),t.attr("tabindex",this.tabindex.toString()),t.on("keydown",_.bind(this.onKeyDown,this)))},focus:function(t){var e=this.$el||$(this.el);e&&e.focus(),"string"==typeof t?"first"==t?this.selectByIndex(0,!0):"last"==t&&(void 0===this._layoutParams&&this.fillIndexesArray(),this.selectByIndex(this._layoutParams.itemsIndexes[this._layoutParams.rows-1][0],!0)):void 0!==t&&this.selectByIndex(t,!0)},focusInner:function(t){this.focus(t.keyCode==Common.UI.Keys.DOWN?"first":"last")},updateHints:function(i){var n;this.colorHints&&((n=this).$el||$(n.el)).find("a.palette-color").each(function(t,e){i&&i[t]?n.createTip($(e),i[t]):(t=e.className.match(n.colorRe)[1],n.createTip($(e),Common.Utils.ThemeColor.getTranslation(Common.Utils.ThemeColor.getRgbColor(t).asc_getName())))})},textThemeColors:"Theme Colors",textStandartColors:"Standard Colors",textRecentColors:"Recent Colors",textTransparent:"Transparent"},Common.UI.ThemeColorPalette||{}))}),define("common/main/lib/view/AdvancedSettingsWindow",["common/main/lib/component/Window"],function(){"use strict";Common.Views.AdvancedSettingsWindow=Common.UI.Window.extend(_.extend({initialize:function(t){var e={};_.extend(e,{height:"auto",header:!0,cls:"advanced-settings-dlg",toggleGroup:"advanced-settings-group",contentTemplate:"",contentStyle:"",items:[],buttons:["ok","cancel"],separator:!0},t),this.template=t.template||['<div class="box">',"<% if (items.length>0) { %>",'<div class="menu-panel">',"<% _.each(items, function(item) { %>",'<div id="slot-category-<%= item.panelId %>"></div>',"<% }); %>","</div>",'<div class="separator"></div>',"<% } %>",'<div class="content-panel" style="<%= contentStyle %>">'+e.contentTemplate+"</div>","</div>","<% if (separator) { %>",'<div class="separator horizontal"></div>',"<% } %>"].join(""),e.tpl=_.template(this.template)(e),this.handler=e.handler,this.toggleGroup=e.toggleGroup,this.contentWidth=e.contentWidth,this.storageName=e.storageName,Common.UI.Window.prototype.initialize.call(this,e)},render:function(){Common.UI.Window.prototype.render.call(this);function t(){o.width((0<s.length?s.width():0)+i.outerWidth()+2)}var e,n=this,o=this.getChild(),i=(o.find(".dlg-btn").on("click",_.bind(this.onDlgBtnClick,this)),this.on("animate:after",_.bind(this.onAnimateAfter,this)),this.btnsCategory=[],this.options.items.forEach(function(t,e){var i=new Common.UI.Button({parentEl:o.find("#slot-category-"+t.panelId),cls:"btn-category "+(t.categoryCls||""),caption:t.panelCaption,iconCls:t.categoryIcon||"",enableToggle:!0,toggleGroup:n.toggleGroup,allowDepress:!1,contentTarget:t.panelId});i.cmpEl.attr("content-target",t.panelId),i.on("click",_.bind(n.onCategoryClick,n,i,e)),n.btnsCategory.push(i)}),o.find(".content-panel")),s=o.find(".menu-panel");i.width(this.contentWidth),o.width((0<s.length?s.width():0)+i.outerWidth()+2),this.options.contentHeight?o.find(".body > .box").css("height",this.options.contentHeight):"number"==typeof this.options.height&&(e=o.find(".body"),e=parseInt(o.find(".header").css("height"))+parseInt(o.find(".footer").css("height"))+parseInt(e.css("padding-top"))+parseInt(e.css("padding-bottom"))+parseInt(o.css("border-bottom-width"))+parseInt(o.css("border-top-width")),o.find(".body > .box").css("height",this.options.height-e)),this.content_panels=o.find(".settings-panel"),0<this.btnsCategory.length&&this.btnsCategory[0].toggle(!0,!0);$(window).on("resize",t),this.on("close",function(){$(window).off("resize",t)})},setHeight:function(t){Common.UI.Window.prototype.setHeight.call(this,t);var t=this.getChild(),e=t.find(".body"),i=parseInt(t.find(".footer").css("height"))+parseInt(e.css("padding-top"))+parseInt(e.css("padding-bottom"));t.find(".body > .box").css("height",parseInt(e.css("height"))-i)},setInnerHeight:function(t){var e=this.getChild(),i=e.find(".body"),i=parseInt(e.find(".header").css("height"))+parseInt(e.find(".footer").css("height"))+parseInt(i.css("padding-top"))+parseInt(i.css("padding-bottom"))+parseInt(e.css("border-bottom-width"))+parseInt(e.css("border-top-width"));Common.UI.Window.prototype.setHeight.call(this,t+i),e.find(".body > .box").css("height",t)},onDlgBtnClick:function(t){t=t.currentTarget.attributes.result.value;this.handler&&this.handler.call(this,t,"ok"==t?this.getSettings():void 0)||this.close()},onCategoryClick:function(t,e){this.content_panels.filter(".active").removeClass("active"),$("#"+t.options.contentTarget).addClass("active")},getSettings:function(){},onPrimary:function(){return this.handler&&this.handler.call(this,"ok",this.getSettings())||this.close(),!1},setActiveCategory:function(t){if(!(this.btnsCategory.length<1)){t=0<=t&&t<this.btnsCategory.length?t:0;var e=this.btnsCategory[t];if(!e.isVisible()||e.isDisabled())for(var i=0;i<this.btnsCategory.length;i++){var n=this.btnsCategory[i];if(n.isVisible()&&!n.isDisabled()){e=n,t=i;break}}e.toggle(!0),this.onCategoryClick(e,t)}},getActiveCategory:function(){var i=-1;return this.btnsCategory.forEach(function(t,e){t.pressed&&(i=e)}),i},close:function(t){this.storageName&&Common.localStorage.setItem(this.storageName,this.getActiveCategory()),Common.UI.Window.prototype.close.call(this,t)},onAnimateAfter:function(){}},Common.Views.AdvancedSettingsWindow||{}))}),{None:-1,Inline:!1,Flow:!0}),Common,Common,c_oHyperlinkType=(define("documenteditor/main/app/view/DropcapSettingsAdvanced",["text!documenteditor/main/app/template/DropcapSettingsAdvanced.template","core","common/main/lib/component/Button","common/main/lib/component/CheckBox","common/main/lib/component/ComboBoxFonts","common/main/lib/component/MetricSpinner","common/main/lib/component/TableStyler","common/main/lib/component/ThemeColorPalette","common/main/lib/view/AdvancedSettingsWindow"],function(e){"use strict";DE.Views.DropcapSettingsAdvanced=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:320,height:380,toggleGroup:"dropcap-adv-settings-group",storageName:"de-dropcap-settings-adv-category"},initialize:function(t){_.extend(this.options,{title:this.textTitle,contentTemplate:_.template(e)({scope:this}),items:[{panelId:"id-adv-dropcap-frame",panelCaption:this.textFrame},{panelId:"id-adv-dropcap-dropcap",panelCaption:this.strDropcap},{panelId:"id-adv-dropcap-borders",panelCaption:this.strBorders},{panelId:"id-adv-dropcap-margins",panelCaption:this.strMargins}]},t),this.tableStylerRows=this.options.tableStylerRows,this.tableStylerColumns=this.options.tableStylerColumns,this.fontStore=this.options.fontStore,this.borderProps=this.options.borderProps,this.isFrame=this.options.isFrame,this.api=this.options.api,this.Borders={},this.BorderSize={ptValue:0,pxValue:0},this.paragraphShade="transparent",this._changedProps=null,this.ChangedBorders=void 0,this._noApply=!0,this.Margins=void 0,this._originalProps=new Asc.asc_CParagraphProperty(this.options.paragraphProps),Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){var o=this,t=(Common.Views.AdvancedSettingsWindow.prototype.render.call(this),this.tableStyler=new Common.UI.TableStyler({el:$("#drop-advanced-borderstyler"),width:200,height:170,rows:this.tableStylerRows,columns:this.tableStylerColumns,spacingMode:!1}),this._btnsBorderPosition=[],_.each([[c_tableBorder.BORDER_HORIZONTAL_TOP,"t","toolbar__icon toolbar__icon-big btn-paragraph-borders-top","00"],[c_tableBorder.BORDER_HORIZONTAL_CENTER,"m","toolbar__icon toolbar__icon-big btn-paragraph-borders-inner","01"],[c_tableBorder.BORDER_HORIZONTAL_BOTTOM,"b","toolbar__icon toolbar__icon-big btn-paragraph-borders-bottom","10"],[c_tableBorder.BORDER_OUTER,"lrtb","toolbar__icon toolbar__icon-big btn-paragraph-borders-outer","11"],[c_tableBorder.BORDER_VERTICAL_LEFT,"l","toolbar__icon toolbar__icon-big btn-paragraph-borders-left","20"],[c_tableBorder.BORDER_ALL,"lrtbm","toolbar__icon toolbar__icon-big btn-paragraph-borders-all","21"],[c_tableBorder.BORDER_VERTICAL_RIGHT,"r","toolbar__icon toolbar__icon-big btn-paragraph-borders-right","30"],[c_tableBorder.BORDER_NONE,"","toolbar__icon toolbar__icon-big btn-paragraph-borders-none","31"]],function(t,e){t=new Common.UI.Button({parentEl:$("#drop-advanced-button-borderline-"+t[3]),posId:t[0],strId:t[1],iconCls:t[2],style:"margin-bottom: 4px;",cls:"btn-options large border-off margin-left-5"});t.on("click",function(t){o._ApplyBorderPreset(t.options.strId)}),o._btnsBorderPosition.push(t)},this),Common.Utils.Metric.getMetricName(Common.Utils.Metric.c_MetricUnits.pt),this.cmbBorderSize=new Common.UI.ComboBorderSize({el:$("#drop-advanced-input-bordersize"),style:"width: 90px;",takeFocusOnClose:!0}).on("selected",_.bind(function(t,e){this.BorderSize={ptValue:e.value,pxValue:e.pxValue},this.tableStyler.setVirtualBorderSize(this.BorderSize.pxValue)},this)),this.cmbBorderSize.store.at(2));this.cmbBorderSize.setValue(t.get("value")),this.BorderSize={ptValue:t.get("value"),pxValue:t.get("pxValue")},this.btnBorderColor=new Common.UI.ColorButton({parentEl:$("#drop-advanced-button-bordercolor"),additionalAlign:this.menuAddAlign,color:"auto",auto:!0,cls:"move-focus",takeFocusOnClose:!0}),this.btnBorderColor.on("color:select",_.bind(function(t,e){this.tableStyler.setVirtualBorderColor("object"==typeof e?e.color:e)},this)),this.btnBorderColor.on("auto:select",_.bind(function(t,e){this.tableStyler.setVirtualBorderColor("object"==typeof e?e.color:e)},this)),this.colorsBorder=this.btnBorderColor.getPicker(),this.btnBackColor=new Common.UI.ColorButton({parentEl:$("#drop-advanced-button-color"),additionalAlign:this.menuAddAlign,transparent:!0,cls:"move-focus",takeFocusOnClose:!0}),this.btnBackColor.on("color:select",_.bind(function(t,e){o.paragraphShade=e,o._changedProps&&(void 0!==o._changedProps.get_Shade()&&null!==o._changedProps.get_Shade()||o._changedProps.put_Shade(new Asc.asc_CParagraphShd),"transparent"==e?o._changedProps.get_Shade().put_Value(Asc.c_oAscShdNil):(o._changedProps.get_Shade().put_Value(Asc.c_oAscShdClear),o._changedProps.get_Shade().put_Color(Common.Utils.ThemeColor.getRgbColor(e))));e="object"==typeof e?e.color:e;o.tableStyler.setTableColor(e),o.tableStyler.redrawTable()},this)),this.colorsBack=this.btnBackColor.getPicker(),this.spnMarginTop=new Common.UI.MetricSpinner({el:$("#drop-advanced-input-top"),step:.1,width:100,value:"0 cm",defaultUnit:"cm",maxValue:55.87,minValue:0}).on("change",_.bind(function(t,e,i){this._noApply||(_.isUndefined(this.Margins)&&(this.Margins={}),this.Margins.Top=Common.Utils.Metric.fnRecalcToMM(t.getNumberValue()))},o)),this.spnMarginLeft=new Common.UI.MetricSpinner({el:$("#drop-advanced-input-left"),step:.1,width:100,value:"0 cm",defaultUnit:"cm",maxValue:55.87,minValue:0}).on("change",_.bind(function(t,e,i){this._noApply||(_.isUndefined(this.Margins)&&(this.Margins={}),this.Margins.Left=Common.Utils.Metric.fnRecalcToMM(t.getNumberValue()))},o)),this.spnMarginBottom=new Common.UI.MetricSpinner({el:$("#drop-advanced-input-bottom"),step:.1,width:100,value:"0 cm",defaultUnit:"cm",maxValue:55.87,minValue:0}).on("change",_.bind(function(t,e,i){this._noApply||(_.isUndefined(this.Margins)&&(this.Margins={}),this.Margins.Bottom=Common.Utils.Metric.fnRecalcToMM(t.getNumberValue()))},o)),this.spnMarginRight=new Common.UI.MetricSpinner({el:$("#drop-advanced-input-right"),step:.1,width:100,value:"0 cm",defaultUnit:"cm",maxValue:55.87,minValue:0}).on("change",_.bind(function(t,e,i){this._noApply||(_.isUndefined(this.Margins)&&(this.Margins={}),this.Margins.Right=Common.Utils.Metric.fnRecalcToMM(t.getNumberValue()))},o)),this.btnNone=new Common.UI.Button({parentEl:$("#drop-advanced-button-none"),cls:"btn huge-1 btn-options",iconCls:"icon-advanced-wrap options__icon options__icon-huge btn-drop-none",enableToggle:!0,toggleGroup:"dropAdvGroup",allowDepress:!1,hint:this.textNone}).on("toggle",_.bind(function(t,e){o._changedProps&&e&&(o._DisableElem(Asc.c_oAscDropCap.None),o._changedProps.put_DropCap(Asc.c_oAscDropCap.None))},o)),this.btnInText=new Common.UI.Button({parentEl:$("#drop-advanced-button-intext"),cls:"btn huge-1 btn-options",iconCls:"icon-advanced-wrap options__icon options__icon-huge btn-drop-text",enableToggle:!0,toggleGroup:"dropAdvGroup",allowDepress:!1,hint:this.textInText}).on("toggle",_.bind(function(t,e){o._changedProps&&e&&(o._DisableElem(Asc.c_oAscDropCap.Drop),o._changedProps.put_DropCap(Asc.c_oAscDropCap.Drop))},o)),this.btnInMargin=new Common.UI.Button({parentEl:$("#drop-advanced-button-inmargin"),cls:"btn huge-1 btn-options",iconCls:"icon-advanced-wrap options__icon options__icon-huge btn-drop-margin",enableToggle:!0,toggleGroup:"dropAdvGroup",allowDepress:!1,hint:this.textInMargin}).on("toggle",_.bind(function(t,e){o._changedProps&&e&&(o._DisableElem(Asc.c_oAscDropCap.Margin),o._changedProps.put_DropCap(Asc.c_oAscDropCap.Margin))},o)),this.spnRowHeight=new Common.UI.MetricSpinner({el:$("#drop-advanced-input-rowheight"),step:1,width:120,value:3,defaultUnit:"",maxValue:10,minValue:1,allowDecimal:!1}).on("change",_.bind(function(t,e,i){o._changedProps&&o._changedProps.put_Lines(t.getNumberValue())},o)),this.numDistance=new Common.UI.MetricSpinner({el:$("#drop-advanced-input-distance"),step:.1,width:120,value:"0 cm",defaultUnit:"cm",maxValue:55.87,minValue:0}).on("change",_.bind(function(t,e,i){o._changedProps&&o._changedProps.put_HSpace(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue()))},o)),this.cmbFonts=new Common.UI.ComboBoxFonts({el:$("#drop-advanced-input-fonts"),cls:"input-group-nr",style:"width: 290px;",menuCls:"scrollable-menu",menuStyle:"min-width: 55px;max-height: 236px;",store:new Common.Collections.Fonts,recent:0,hint:this.tipFontName,takeFocusOnClose:!0}).on("selected",_.bind(function(t,e){o._changedProps&&o._changedProps.put_FontFamily(e.name)},o)),this.btnFrameNone=new Common.UI.Button({parentEl:$("#frame-advanced-button-none"),cls:"btn huge-1 btn-options",iconCls:"options__icon options__icon-huge btn-none",enableToggle:!0,toggleGroup:"frameAdvGroup",allowDepress:!1,hint:this.textNone}).on("toggle",_.bind(function(t,e){o._changedProps&&e&&(o._DisableElem(c_oAscFrameWrap.None),o._changedProps.put_Wrap(c_oAscFrameWrap.None))},o)),this.btnFrameInline=new Common.UI.Button({parentEl:$("#frame-advanced-button-inline"),cls:"btn huge-1 btn-options",iconCls:"options__icon options__icon-huge btn-table-align-center",enableToggle:!0,toggleGroup:"frameAdvGroup",allowDepress:!1,hint:this.textInline}).on("toggle",_.bind(function(t,e){o._changedProps&&e&&(o._DisableElem(c_oAscFrameWrap.Inline),o._changedProps.put_Wrap(c_oAscFrameWrap.Inline))},o)),this.btnFrameFlow=new Common.UI.Button({parentEl:$("#frame-advanced-button-flow"),cls:"btn huge-1 btn-options",iconCls:"options__icon options__icon-huge btn-table-flow",enableToggle:!0,toggleGroup:"frameAdvGroup",allowDepress:!1,hint:this.textFlow}).on("toggle",_.bind(function(t,e){o._changedProps&&e&&(o._DisableElem(c_oAscFrameWrap.Flow),o._changedProps.put_Wrap(c_oAscFrameWrap.Flow))},o)),this._arrWidth=[{displayValue:this.textAuto,value:0},{displayValue:this.textExact,value:1}],this.cmbWidth=new Common.UI.ComboBox({el:$("#frame-advanced-input-widthtype"),cls:"input-group-nr",menuStyle:"min-width: 130px;",editable:!1,takeFocusOnClose:!0,data:this._arrWidth}).on("selected",_.bind(function(t,e){o._changedProps&&(o.spnWidth.suspendEvents(),o.spnWidth.setValue(0==e.value?"":1),o.spnWidth.resumeEvents(),o._changedProps.put_W(0==e.value?void 0:Common.Utils.Metric.fnRecalcToMM(this.spnWidth.getNumberValue())))},o)),this.cmbWidth.setValue(this._arrWidth[0].value),this.spnWidth=new Common.UI.MetricSpinner({el:$("#frame-advanced-input-width"),maxValue:55.88,minValue:.02,step:.1,defaultUnit:"cm",value:""}).on("change",_.bind(function(t,e,i){o._changedProps&&(o.cmbWidth.suspendEvents(),o.cmbWidth.setValue(this._arrWidth[1].value),o.cmbWidth.resumeEvents(),o._changedProps.put_W(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())))},o)),this._arrHeight=[{displayValue:this.textAuto,value:0},{displayValue:this.textExact,value:1},{displayValue:this.textAtLeast,value:2}],this.cmbHeight=new Common.UI.ComboBox({el:$("#frame-advanced-input-heighttype"),cls:"input-group-nr",menuStyle:"min-width: 130px;",editable:!1,takeFocusOnClose:!0,data:this._arrHeight}).on("selected",_.bind(function(t,e){o._changedProps&&(o.spnHeight.suspendEvents(),o.spnHeight.setValue(0==e.value?"":1),o.spnHeight.resumeEvents(),o._changedProps.put_HRule(0==e.value?Asc.linerule_Auto:1==e.value?Asc.linerule_Exact:Asc.linerule_AtLeast),0<e.value&&this._changedProps.put_H(Common.Utils.Metric.fnRecalcToMM(this.spnHeight.getNumberValue())))},o)),this.cmbHeight.setValue(this._arrHeight[0].value),this.spnHeight=new Common.UI.MetricSpinner({el:$("#frame-advanced-input-height"),maxValue:55.88,minValue:.02,step:.1,defaultUnit:"cm",value:""}).on("change",_.bind(function(t,e,i){var n;o._changedProps&&(n=Asc.linerule_Auto,o.cmbHeight.getValue()==o._arrHeight[1].value?n=Asc.linerule_Exact:o.cmbHeight.getValue()==o._arrHeight[2].value&&(n=Asc.linerule_AtLeast),n==Asc.linerule_Auto&&(o.cmbHeight.suspendEvents(),o.cmbHeight.setValue(o._arrHeight[2].value),n=Asc.linerule_AtLeast,o.cmbHeight.resumeEvents()),o._changedProps.put_HRule(n),o._changedProps.put_H(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())))},o)),this.spnX=new Common.UI.MetricSpinner({el:$("#frame-advanced-input-hdist"),maxValue:55.87,minValue:0,step:.1,defaultUnit:"cm",value:"0 cm",width:"auto"}).on("change",_.bind(function(t,e,i){o._changedProps&&o._changedProps.put_HSpace(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue()))},o)),this.spnY=new Common.UI.MetricSpinner({el:$("#frame-advanced-input-vdist"),maxValue:55.87,minValue:0,step:.1,defaultUnit:"cm",value:"0 cm",width:"auto"}).on("change",_.bind(function(t,e,i){o._changedProps&&o._changedProps.put_VSpace(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue()))},o)),this._arrHAlign=[{displayValue:this.textLeft,value:Asc.c_oAscXAlign.Left},{displayValue:this.textCenter,value:Asc.c_oAscXAlign.Center},{displayValue:this.textRight,value:Asc.c_oAscXAlign.Right}],this.cmbHAlign=new Common.UI.ComboBox({el:$("#frame-advanced-input-hposition"),cls:"input-group-nr",menuStyle:"min-width: 130px;",data:this._arrHAlign,takeFocusOnClose:!0}).on("changed:after",_.bind(function(t,e){o._changedProps&&(t.getSelectedRecord()?o._changedProps.put_XAlign(e.value):(t=Common.Utils.String.parseFloat(e.value),isNaN(t)||(o._changedProps.put_XAlign(void 0),o._changedProps.put_X(Common.Utils.Metric.fnRecalcToMM(t)))))},o)).on("selected",_.bind(function(t,e){o._changedProps&&o._changedProps.put_XAlign(e.value)},o)),this.cmbHAlign.setValue(this._arrHAlign[0].value),this._arrHRelative=[{displayValue:this.textMargin,value:Asc.c_oAscHAnchor.Margin},{displayValue:this.textPage,value:Asc.c_oAscHAnchor.Page},{displayValue:this.textColumn,value:Asc.c_oAscHAnchor.Text}],this.cmbHRelative=new Common.UI.ComboBox({el:$("#frame-advanced-input-hrelative"),cls:"input-group-nr",menuStyle:"min-width: 95px;",data:this._arrHRelative,editable:!1,takeFocusOnClose:!0}).on("selected",_.bind(function(t,e){o._changedProps&&o._changedProps.put_HAnchor(e.value)},o)),this.cmbHRelative.setValue(this._arrHRelative[1].value),this._arrVAlign=[{displayValue:this.textTop,value:Asc.c_oAscYAlign.Top},{displayValue:this.textCenter,value:Asc.c_oAscYAlign.Center},{displayValue:this.textBottom,value:Asc.c_oAscYAlign.Bottom}],this.cmbVAlign=new Common.UI.ComboBox({el:$("#frame-advanced-input-vposition"),cls:"input-group-nr",menuStyle:"min-width: 130px;",data:this._arrVAlign,takeFocusOnClose:!0}).on("changed:after",_.bind(function(t,e){o._changedProps&&(t.getSelectedRecord()?o._changedProps.put_YAlign(e.value):(t=Common.Utils.String.parseFloat(e.value),isNaN(t)||(o._changedProps.put_YAlign(void 0),o._changedProps.put_Y(Common.Utils.Metric.fnRecalcToMM(Common.Utils.String.parseFloat(e.value))))))},o)).on("selected",_.bind(function(t,e){o._changedProps&&o._changedProps.put_YAlign(e.value)},o)),this.cmbVAlign.setValue(this._arrVAlign[0].value),this._arrVRelative=[{displayValue:this.textMargin,value:Asc.c_oAscVAnchor.Margin},{displayValue:this.textPage,value:Asc.c_oAscVAnchor.Page},{displayValue:this.textParagraph,value:Asc.c_oAscVAnchor.Text}],this.cmbVRelative=new Common.UI.ComboBox({el:$("#frame-advanced-input-vrelative"),cls:"input-group-nr",menuStyle:"min-width: 95px;",data:this._arrVRelative,editable:!1,takeFocusOnClose:!0}).on("selected",_.bind(function(t,e){o._changedProps&&(o._changedProps.put_VAnchor(e.value),this.chMove.setValue(e.value==Asc.c_oAscVAnchor.Text,!0))},o)),this.cmbVRelative.setValue(this._arrVRelative[2].value),this.chMove=new Common.UI.CheckBox({el:$("#frame-advanced-checkbox-move"),labelText:this.textMove}).on("change",_.bind(function(t,e){o._changedProps&&(e=this.cmbVRelative.store.at("checked"==e?2:1),o.cmbVRelative.setValue(e.get("value")),o._changedProps.put_VAnchor(e.get("value")))},o)),this.on("show",_.bind(this.onShowDialog,this)),this.afterRender()},afterRender:function(){this.updateMetricUnit(),this.updateThemeColors(),this.isFrame||this.cmbFonts.fillFonts(this.fontStore),this._setDefaults(this._originalProps);var t="object"==typeof this.paragraphShade?this.paragraphShade.color:this.paragraphShade;this.tableStyler.setTableColor(t),"transparent"!=t&&this.tableStyler.redrawTable(),void 0!==this.borderProps&&(this.btnBorderColor.setColor(this.borderProps.borderColor),this.btnBorderColor.setAutoColor("auto"==this.borderProps.borderColor),this.tableStyler.setVirtualBorderColor(("object"==typeof this.btnBorderColor.color?this.btnBorderColor.color:this.btnBorderColor).color),"auto"==this.borderProps.borderColor?this.colorsBorder.clearSelection():this.colorsBorder.select(this.borderProps.borderColor,!0),this.cmbBorderSize.setValue(this.borderProps.borderSize.ptValue),this.BorderSize={ptValue:this.borderProps.borderSize.ptValue,pxValue:this.borderProps.borderSize.pxValue},this.tableStyler.setVirtualBorderSize(this.BorderSize.pxValue)),this.setTitle(this.isFrame?this.textTitleFrame:this.textTitle),this.tableStyler.on("borderclick:cellborder",function(t,e,i,n){void 0===this.ChangedBorders&&(this.ChangedBorders=new Asc.asc_CParagraphBorders),this._UpdateCellBordersStyle(t,e,i,n,this.Borders)},this),this.tableStyler.on("borderclick",function(t,e,i,n){void 0===this.ChangedBorders&&(this.ChangedBorders=new Asc.asc_CParagraphBorders),this._UpdateTableBordersStyle(t,e,i,n,this.Borders)},this),this.isFrame&&this.setHeight(500),this.btnsCategory[this.isFrame?1:0].setVisible(!1),this.storageName&&(t=Common.localStorage.getItem(this.storageName),this.setActiveCategory(null!==t?parseInt(t):0))},getFocusedComponents:function(){return[this.cmbWidth,this.spnWidth,this.cmbHeight,this.spnHeight,this.cmbHAlign,this.cmbHRelative,this.spnX,this.cmbVAlign,this.cmbVRelative,this.spnY,this.chMove,this.cmbFonts,this.spnRowHeight,this.numDistance,this.cmbBorderSize,this.btnBorderColor].concat(this._btnsBorderPosition).concat([this.btnBackColor,this.spnMarginTop,this.spnMarginLeft,this.spnMarginBottom,this.spnMarginRight])},onCategoryClick:function(t,e){Common.Views.AdvancedSettingsWindow.prototype.onCategoryClick.call(this,t,e);var i=this;setTimeout(function(){switch(e){case 0:i.cmbWidth.focus();break;case 1:i.cmbFonts.focus();break;case 2:i.cmbBorderSize.focus();break;case 3:i.spnMarginTop.focus()}},100)},getSettings:function(){var t;return null===this.ChangedBorders?this._changedProps.put_Borders(this.Borders):void 0!==this.ChangedBorders&&this._changedProps.put_Borders(this.ChangedBorders),this.Margins&&(null==(t=this._changedProps.get_Borders())&&(this._changedProps.put_Borders(new Asc.asc_CParagraphBorders),t=this._changedProps.get_Borders()),void 0!==this.Margins.Left&&(void 0!==t.get_Left()&&null!==t.get_Left()||t.put_Left(new Asc.asc_CTextBorder(this.Borders.get_Left())),t.get_Left().put_Space(this.Margins.Left)),void 0!==this.Margins.Top&&(void 0!==t.get_Top()&&null!==t.get_Top()||t.put_Top(new Asc.asc_CTextBorder(this.Borders.get_Top())),t.get_Top().put_Space(this.Margins.Top)),void 0!==this.Margins.Right&&(void 0!==t.get_Right()&&null!==t.get_Right()||t.put_Right(new Asc.asc_CTextBorder(this.Borders.get_Right())),t.get_Right().put_Space(this.Margins.Right)),void 0!==this.Margins.Bottom&&(void 0!==t.get_Bottom()&&null!==t.get_Bottom()||t.put_Bottom(new Asc.asc_CTextBorder(this.Borders.get_Bottom())),t.get_Bottom().put_Space(this.Margins.Bottom),void 0!==t.get_Between()&&null!==t.get_Between()||t.put_Between(new Asc.asc_CTextBorder(this.Borders.get_Between())),t.get_Between().put_Space(this.Margins.Bottom))),this._changedProps.put_FromDropCapMenu(!this.isFrame),{paragraphProps:this._changedProps,borderProps:{borderSize:this.BorderSize,borderColor:this.btnBorderColor.isAutoColor()?"auto":this.btnBorderColor.color}}},onShowDialog:function(t){!this.isFrame&&this.btnNone.pressed?this._DisableElem(Asc.c_oAscDropCap.None):this.isFrame&&this.btnFrameNone.pressed&&this._DisableElem(c_oAscFrameWrap.None)},onBtnBordersClick:function(t,e){this.updateBordersStyle(t.options.strId,!0),this.api&&((t=new Asc.CTableProp).put_CellBorders(this.CellBorders),t.put_CellSelect(!0),this.api.tblApply(t)),this.fireEvent("editcomplete",this)},updateThemeColors:function(){this.colorsBorder.updateColors(Common.Utils.ThemeColor.getEffectColors(),Common.Utils.ThemeColor.getStandartColors()),this.colorsBack.updateColors(Common.Utils.ThemeColor.getEffectColors(),Common.Utils.ThemeColor.getStandartColors())},updateMetricUnit:function(){_.each([this.spnMarginTop,this.spnMarginLeft,this.spnMarginBottom,this.spnMarginRight,this.numDistance,this.spnWidth,this.spnHeight,this.spnX,this.spnY],function(t){t.setDefaultUnit(Common.Utils.Metric.getCurrentMetricName()),t.setStep(Common.Utils.Metric.getCurrentMetric()==Common.Utils.Metric.c_MetricUnits.pt?1:.1)})},_setDefaults:function(t){if(t){this._noApply=!0,this._originalProps=new Asc.asc_CParagraphProperty(t);t=t.get_FramePr();if(t){if(this.isFrame){e=t.get_W(),this.cmbWidth.setValue((void 0===e?this._arrWidth[0]:this._arrWidth[1]).value),this.spnWidth.setValue(void 0!==e?Common.Utils.Metric.fnRecalcFromMM(e):""),void 0!==(e=t.get_HRule())?(this.cmbHeight.setValue((e===Asc.linerule_Exact?this._arrHeight[1]:this._arrHeight[2]).value),this.spnHeight.setValue(Common.Utils.Metric.fnRecalcFromMM(t.get_H()))):(this.cmbHeight.setValue(this._arrHeight[0].value),this.spnHeight.setValue("")),e=t.get_HSpace(),this.spnX.setValue(void 0!==e?Common.Utils.Metric.fnRecalcFromMM(e):0),e=t.get_VSpace(),this.spnY.setValue(void 0!==e?Common.Utils.Metric.fnRecalcFromMM(e):0);for(var e=t.get_HAnchor(),i=0;i<this._arrHRelative.length;i++)if(e==this._arrHRelative[i].value){this.cmbHRelative.setValue(this._arrHRelative[i].value);break}if(void 0!==(e=t.get_XAlign())){for(i=0;i<this._arrHAlign.length;i++)if(e==this._arrHAlign[i].value){this.cmbHAlign.setValue(this._arrHAlign[i].value);break}}else e=t.get_X(),this.cmbHAlign.setValue(Common.Utils.Metric.fnRecalcFromMM(void 0!==e?e:0)+" "+Common.Utils.Metric.getCurrentMetricName());e=t.get_VAnchor();for(i=0;i<this._arrVRelative.length;i++)if(e==this._arrVRelative[i].value){this.cmbVRelative.setValue(this._arrVRelative[i].value);break}if(this.chMove.setValue(e==Asc.c_oAscVAnchor.Text),void 0!==(e=t.get_YAlign())){for(i=0;i<this._arrVAlign.length;i++)if(e==this._arrVAlign[i].value){this.cmbVAlign.setValue(this._arrVAlign[i].value);break}}else e=t.get_Y(),this.cmbVAlign.setValue(Common.Utils.Metric.fnRecalcFromMM(void 0!==e?e:0)+" "+Common.Utils.Metric.getCurrentMetricName());(!1===(e=t.get_Wrap())?this.btnFrameInline:this.btnFrameFlow).toggle(!0,!1)}else this.spnRowHeight.setValue(null!==t.get_Lines()?t.get_Lines():""),this.numDistance.setValue(null!==t.get_HSpace()?Common.Utils.Metric.fnRecalcFromMM(t.get_HSpace()):""),((e=t.get_DropCap())==Asc.c_oAscDropCap.Drop?this.btnInText:e==Asc.c_oAscDropCap.Margin?this.btnInMargin:this.btnNone).toggle(!0,!1),(e=t.get_FontFamily())&&((o=this.cmbFonts.store.findWhere({name:e.get_Name()}))?this.cmbFonts.setValue(o.get("name")):this.cmbFonts.setRawValue(e.get_Name()));this.Borders=new Asc.asc_CParagraphBorders(t.get_Borders()),this.Borders&&(n=null!=(o=this.Borders.get_Left())&&null!==o.get_Space()&&void 0!==o.get_Space()?Common.Utils.Metric.fnRecalcFromMM(o.get_Space()):"",this.spnMarginLeft.setValue(n),n=null!=(o=this.Borders.get_Top())&&null!==o.get_Space()&&void 0!==o.get_Space()?Common.Utils.Metric.fnRecalcFromMM(o.get_Space()):"",this.spnMarginTop.setValue(n),n=null!=(o=this.Borders.get_Right())&&null!==o.get_Space()&&void 0!==o.get_Space()?Common.Utils.Metric.fnRecalcFromMM(o.get_Space()):"",this.spnMarginRight.setValue(n),n=null!=(o=this.Borders.get_Bottom())&&null!==o.get_Space()&&void 0!==o.get_Space()?Common.Utils.Metric.fnRecalcFromMM(o.get_Space()):"",this.spnMarginBottom.setValue(n));var n,o=t.get_Shade();if(null!=o&&o.get_Value()===Asc.c_oAscShdClear&&(n=o.get_Color())?n.get_type()==Asc.c_oAscColor.COLOR_TYPE_SCHEME?this.paragraphShade={color:Common.Utils.ThemeColor.getHexColor(n.get_r(),n.get_g(),n.get_b()),effectValue:n.get_value()}:this.paragraphShade=Common.Utils.ThemeColor.getHexColor(n.get_r(),n.get_g(),n.get_b()):this.paragraphShade="transparent",this.btnBackColor.setColor(this.paragraphShade),_.isObject(this.paragraphShade)){for(var s=!1,i=0;i<10;i++)if(Common.Utils.ThemeColor.ThemeValues[i]==this.paragraphShade.effectValue){this.colorsBack.select(this.paragraphShade,!0),s=!0;break}s||this.colorsBack.clearSelection()}else this.colorsBack.select(this.paragraphShade,!0);this._UpdateBorders()}this._noApply=!1,this._changedProps=new Asc.asc_CParagraphFrame,this.isFrame&&t&&void 0!==t.get_W()&&this._changedProps.put_W(t.get_W()),this.ChangedBorders=void 0}},_DisableElem:function(t){var e=t===Asc.c_oAscDropCap.None||t===c_oAscFrameWrap.None;_.each(this.btnsCategory,function(t){"id-adv-dropcap-borders"!=t.options.contentTarget&&"id-adv-dropcap-margins"!=t.options.contentTarget||t.setDisabled(e)}),(this.isFrame?(e=t==c_oAscFrameWrap.None,this.cmbHAlign.setDisabled(e),this.cmbHRelative.setDisabled(e),this.spnX.setDisabled(e),this.cmbVAlign.setDisabled(e),this.cmbVRelative.setDisabled(e),this.spnY.setDisabled(e),this.chMove.setDisabled(e),this.cmbWidth.setDisabled(e),this.cmbHeight.setDisabled(e),this.spnWidth.setDisabled(e),this.spnHeight):(e=t==Asc.c_oAscDropCap.None,this.spnRowHeight.setDisabled(e),this.numDistance.setDisabled(e),this.cmbFonts)).setDisabled(e)},_UpdateBorders:function(){var t=this.BorderSize,e=this.btnBorderColor.color;if(this._UpdateBorder(this.Borders.get_Left(),"l"),this._UpdateBorder(this.Borders.get_Top(),"t"),this._UpdateBorder(this.Borders.get_Right(),"r"),this._UpdateBorder(this.Borders.get_Bottom(),"b"),null!==this.Borders.get_Between())for(var i=0;i<this.tableStyler.rows-1;i++)this._UpdateCellBorder(this.Borders.get_Between(),this.tableStyler.getCellBorder(i,-1));this.tableStyler.setVirtualBorderSize(t.pxValue),this.tableStyler.setVirtualBorderColor("object"==typeof e?e.color:e),this.tableStyler.redrawTable()},_UpdateCellBorder:function(t,e){null!=t&&null!==t.get_Value()&&null!==t.get_Size()&&null!==t.get_Color()&&1==t.get_Value()?(e.setBordersSize(this._BorderPt2Px(72*t.get_Size()/25.4)),e.setBordersColor("rgb("+t.get_Color().get_r()+","+t.get_Color().get_g()+","+t.get_Color().get_b()+")")):e.setBordersSize(0)},_UpdateBorder:function(t,e){null!=t&&null!==t.get_Value()&&null!==t.get_Size()&&null!==t.get_Color()&&1==t.get_Value()?(this.tableStyler.setBordersSize(e,this._BorderPt2Px(72*t.get_Size()/25.4)),this.tableStyler.setBordersColor(e,"rgb("+t.get_Color().get_r()+","+t.get_Color().get_g()+","+t.get_Color().get_b()+")")):this.tableStyler.setBordersSize(e,0)},_BorderPt2Px:function(t){return 0==t?0:t<.6?.5:t<=1?1:t<=1.5?2:t<=2.25?3:t<=3?4:t<=4.5?6:8},_ApplyBorderPreset:function(t){this.ChangedBorders=null,this.Borders.put_Left(this._UpdateBorderStyle(this.Borders.get_Left(),-1<t.indexOf("l"))),this.Borders.put_Top(this._UpdateBorderStyle(this.Borders.get_Top(),-1<t.indexOf("t"))),this.Borders.put_Right(this._UpdateBorderStyle(this.Borders.get_Right(),-1<t.indexOf("r"))),this.Borders.put_Bottom(this._UpdateBorderStyle(this.Borders.get_Bottom(),-1<t.indexOf("b"))),this.Borders.put_Between(this._UpdateBorderStyle(this.Borders.get_Between(),-1<t.indexOf("m"))),this._UpdateBorders()},_UpdateBorderStyle:function(t,e){var i;return null==t&&(t=new Asc.asc_CTextBorder),e&&0<this.BorderSize.ptValue?(e=parseFloat(this.BorderSize.ptValue),t.put_Value(1),t.put_Size(25.4*e/72),this.btnBorderColor.isAutoColor()?(i=new Asc.asc_CColor).put_auto(!0):i=Common.Utils.ThemeColor.getRgbColor(this.btnBorderColor.color),t.put_Color(i)):(t.put_Color(new Asc.asc_CColor),t.put_Value(0)),t},_UpdateCellBordersStyle:function(t,e,i,n,o){o.put_Between(this._UpdateBorderStyle(o.get_Between(),0<i)),this.ChangedBorders&&this.ChangedBorders.put_Between(new Asc.asc_CTextBorder(o.get_Between()))},_UpdateTableBordersStyle:function(t,e,i,n,o){-1<e.indexOf("l")&&(o.put_Left(this._UpdateBorderStyle(o.get_Left(),0<i)),this.ChangedBorders&&this.ChangedBorders.put_Left(new Asc.asc_CTextBorder(o.get_Left()))),-1<e.indexOf("t")&&(o.put_Top(this._UpdateBorderStyle(o.get_Top(),0<i)),this.ChangedBorders&&this.ChangedBorders.put_Top(new Asc.asc_CTextBorder(o.get_Top()))),-1<e.indexOf("r")&&(o.put_Right(this._UpdateBorderStyle(o.get_Right(),0<i)),this.ChangedBorders&&this.ChangedBorders.put_Right(new Asc.asc_CTextBorder(o.get_Right()))),-1<e.indexOf("b")&&(o.put_Bottom(this._UpdateBorderStyle(o.get_Bottom(),0<i)),this.ChangedBorders&&this.ChangedBorders.put_Bottom(new Asc.asc_CTextBorder(o.get_Bottom())))}},DE.Views.DropcapSettingsAdvanced||{}))}),!function(d){function n(t,e){this.init("tooltip",t,e)}var h=d.fn.tooltip,t=(h.prototype=d.fn.tooltip.Constructor.prototype,d.extend(d.fn.tooltip.Constructor.DEFAULTS,{container:"body",delay:{show:500},arrow:!1}),n.prototype=d.extend({},d.fn.tooltip.Constructor.prototype,{constructor:n,init:function(){h.prototype.init.apply(this,arguments),"cursor"==this.options.placement&&/hover/.exec(this.options.trigger)&&this.$element.on("mousemove.tooltip",this.options.selector,d.proxy(this.mousemove,this)),this.options.zIndex&&this.tip().css("z-index",this.options.zIndex);var e=this;Common.NotificationCenter.on({"layout:changed":function(t){e.options.keepvisible||e.options.hideonclick||!e.tip().is(":visible")||e.hide()}}),this.isDesktopApp=!1},mousemove:function(t){var e=t.clientX*Common.Utils.zoom(),t=t.clientY*Common.Utils.zoom();this.targetXY=[e,this.isDesktopApp?Math.max(t,14):t]},leave:function(t){h.prototype.leave.apply(this,arguments),this.dontShow=void 0},show:function(t){if(this.hasContent()&&("left"==this.options.hintDirection||this.enabled)&&!this.dontShow&&(this.$element.is(":visible")||!(0<this.$element.closest("[role=menu]").length))){var e=this.tip(),i=(!1===this.options.arrow&&e.addClass("arrow-free"),this.options.cls&&e.addClass(this.options.cls),"function"!=typeof this.options.placement?/^([a-zA-Z]+)-?([a-zA-Z]*)$/.exec(this.options.placement):null);if(t||!i||i[2].length){var n=d.Event("show.bs.tooltip");if(this.$element.trigger(n),n.isDefaultPrevented())return;if(this.setContent(),this.options.animation&&e.addClass("fade"),e.detach().css({top:0,left:0,display:"block"}),this.options.container?e.appendTo(this.options.container):e.insertAfter(this.$element),"function"==typeof this.options.placement)this.options.placement.call(this,e[0],this.$element[0]);else if("object"==typeof t){var o={top:t[1]+15,left:Common.UI.isRTL()?t[0]-e.width()-9:t[0]+18},n=Common.Utils.innerWidth(),s=Common.Utils.innerHeight();o.left<0&&(o.left=t[0]+18),o.left+e.width()>n&&(o.left=n-e.width()-30),o.top+e.height()>s&&(o.top=s-e.height()-30),e.offset(o).addClass("in")}else{var a=this.getPosition(),l=e[0].offsetWidth,r=e[0].offsetHeight;switch(i[1]){case"bottom":o={top:a.top+a.height+10};break;case"top":o={top:a.top-r-10}}switch(i[2]){case"left":o.left=a.left,this.$element.outerWidth()<=18&&(o.left-=4);break;case"right":o.left=a.left+a.width-l,this.$element.outerWidth()<=18&&(o.left+=4)}this.applyPlacement(o,i[1]),this.moveArrow(),e.addClass(i[1]).addClass(i[0])}this.$element.trigger("shown.bs.tooltip")}else h.prototype.show.apply(this,arguments);var c=this;clearTimeout(c.timeout),c.timeout=setTimeout(function(){"in"==c.hoverState&&c.hide(),c.dontShow=!1},5e3)}},moveArrow:function(){var t=this.tip().find(".tooltip-arrow, .arrow");switch(this.options.placement){case"top-left":case"bottom-left":t.css("left",10);break;case"top-right":case"bottom-right":t.css("right",10)}},enter:function(t){var e,i;"mouseenter"!==t.type||(e=d(t.target)).is("[role=menu]")||e.parentsUntil(t.currentTarget,"[role=menu]").length&&t.target!==t.currentTarget||this.tip().is(":visible")||(i=t instanceof this.constructor?t:d(t.currentTarget)[this.type](this.getDelegateOptions()).data("bs.tooltip"),clearTimeout(i.timeout),i.hoverState="in",this._updateTitle&&(this.tip().find(".tooltip-inner")[this.options.html?"html":"text"](this.options.title),this._updateTitle=void 0),i.options.delay&&i.options.delay.show?i.timeout=setTimeout(function(){"in"==i.hoverState&&i.show("cursor"==i.options.placement?i.targetXY:void 0)},i.options.delay.show):i.show())},replaceArrow:function(t,e,i){!1===this.options.arrow?this.arrow().hide():h.prototype.replaceArrow.apply(this,arguments)},getCalculatedOffset:function(t,e,i,n){var o=h.prototype.getCalculatedOffset.apply(this,arguments);if(0<this.options.offset||this.options.offset<0)switch(/(bottom|top)/.exec(t)[1]){case"bottom":o.top+=this.options.offset;break;case"top":o.top-=this.options.offset}return o},updateTitle:function(t){this.options.title=t,this._updateTitle=t}}),d.fn.tooltip);d.fn.tooltip=function(i){return this.each(function(){var t=d(this),e=t.data("bs.tooltip");e||t.data("bs.tooltip",e=new n(this,"object"==typeof i&&i)),"string"==typeof i&&e[i]()})},d.fn.tooltip.Constructor=n,d.fn.tooltip.noConflict=function(){return d.fn.tooltip=t,this}}(window.jQuery),define("tip",function(){}),define("common/main/lib/component/Tooltip",["tip","backbone"],function(){"use strict";function t(t){this.$element=this.placement=void 0,this.init.call(this,t)}_.extend(t.prototype,Backbone.Events,{init:function(t){var e,i;this.$element=t.owner instanceof Backbone.View?t.owner.$el:$(t.owner),this.placement=t.placement,this.$element.data("bs.tooltip")&&this.$element.removeData("bs.tooltip"),this.$element.tooltip({title:t.title,trigger:"manual",placement:t.placement,offset:t.offset,cls:t.cls,html:t.html,hideonclick:t.hideonclick,keepvisible:t.keepvisible}),t.hideonclick&&(i=(e=this).$element.data("bs.tooltip"))&&i.tip().on("click",function(){i.hide(),e.trigger("tooltip:hideonclick",this)}),this.$element.on("shown.bs.tooltip",_.bind(this.onTipShown,this)),this.$element.on("hidden.bs.tooltip",_.bind(this.onTipHidden,this))},show:function(t){this.getBSTip().show(t)},hide:function(t){this.getBSTip().hide(t)},setTitle:function(t){var e=this.getBSTip();e&&(e.options.title=t)},updateTitle:function(){var t=this.getBSTip();t.$tip.find(".tooltip-inner")[t.options.html?"html":"text"](t.options.title)},getBSTip:function(){return this.$element.data("bs.tooltip")},onTipShown:function(){this.trigger("tooltip:show",this)},onTipHidden:function(){this.trigger("tooltip:hide",this)},isVisible:function(){return this.getBSTip().tip().is(":visible")}}),Common.UI=Common.UI||{},Common.UI.Tooltip=t}),void 0===Common&&(Common={}),define("common/main/lib/component/InputField",["common/main/lib/component/BaseView","common/main/lib/component/Tooltip","common/main/lib/component/Button"],function(){"use strict";Common.UI.InputField=Common.UI.BaseView.extend({options:{id:null,cls:"",style:"",value:"",type:"text",name:"",validation:null,allowBlank:!0,placeHolder:"",blankError:null,spellcheck:!1,maskExp:"",validateOnChange:!1,validateOnBlur:!0,disabled:!1,editable:!0},template:_.template(['<div class="input-field" style="<%= style %>">',"<input ",'type="<%= type %>" ','name="<%= name %>" ','spellcheck="<%= spellcheck %>" ','class="form-control <%= cls %>" ','placeholder="<%= placeHolder %>" ','data-hint="<%= dataHint %>"','data-hint-direction="<%= dataHintDirection %>"','data-hint-offset="<%= dataHintOffset %>"',">",'<span class="input-error"></span>',"</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);t=this;this.id=t.options.id||Common.UI.getId(),this.cls=t.options.cls,this.style=t.options.style,this.value=t.options.value,this.type=t.options.type,this.name=t.options.name,this.validation=t.options.validation,this.allowBlank=t.options.allowBlank,this.placeHolder=t.options.placeHolder,this.template=t.options.template||t.template,this.editable=t.options.editable,this.disabled=t.options.disabled,this.spellcheck=t.options.spellcheck,this.blankError=t.options.blankError||"This field is required",this.validateOnChange=t.options.validateOnChange,this.validateOnBlur=t.options.validateOnBlur,this.maxLength=t.options.maxLength,t.rendered=t.options.rendered||!1,t.options.el&&t.render()},render:function(t){var e,i;return this.rendered?this.cmpEl=this.$el:(this.cmpEl=$(this.template({id:this.id,cls:this.cls,style:this.style,value:this.value,type:this.type,name:this.name,placeHolder:this.placeHolder,spellcheck:this.spellcheck,dataHint:this.options.dataHint,dataHintDirection:this.options.dataHintDirection,dataHintOffset:this.options.dataHintOffset,scope:this})),(t?(this.setElement(t,!1),t):this.$el).html(this.cmpEl)),this.rendered||(e=this.cmpEl,this._input=this.cmpEl.find("input").addBack().filter("input").first(),this.editable&&(this._input.on("blur",_.bind(this.onInputChanged,this)),this._input.on("keypress",_.bind(this.onKeyPress,this)),this._input.on("keydown",_.bind(this.onKeyDown,this)),this._input.on("keyup",_.bind(this.onKeyUp,this)),this.validateOnChange&&this._input.on("input",_.bind(this.onInputChanging,this)),this.maxLength&&this._input.attr("maxlength",this.maxLength)),this.setEditable(this.editable),this.disabled&&this.setDisabled(this.disabled),0<this._input.closest(".asc-window").length&&(i=function(){var t=e.find(".input-error").data("bs.tooltip");t&&t.tip().remove(),Common.NotificationCenter.off({"modal:close":i})}),Common.NotificationCenter.on({"modal:close":i})),this.rendered=!0,this.value&&this.setValue(this.value),this},_doChange:function(t,e){var i;e&&e.synthetic||(e=$(t.target).val(),i=this.value,this.trigger("changed:before",this,e,i,t),t.isDefaultPrevented()||(this.value=e,this.validateOnBlur&&this.checkValidate(),this.trigger("changed:after",this,e,i,t)))},onInputChanged:function(t,e){this._doChange(t,e)},onInputChanging:function(t,e){var i=$(t.target).val(),n=this.value;t.isDefaultPrevented()||(this.value=i,this.validateOnBlur&&this.checkValidate(),this.trigger("changing",this,i,n,t))},onKeyPress:function(t){var e;this.trigger("keypress:before",this,t),t.isDefaultPrevented()||(this.options.maskExp&&!_.isEmpty(this.options.maskExp.source)&&(e=String.fromCharCode(t.which),this.options.maskExp.test(e)||t.ctrlKey||t.keyCode===Common.UI.Keys.RETURN||(t.preventDefault(),t.stopPropagation())),this.trigger("keypress:after",this,t))},onKeyDown:function(t){this.trigger("keydown:before",this,t),t.isDefaultPrevented()||(t.keyCode===Common.UI.Keys.RETURN&&this._doChange(t),t.keyCode==Common.UI.Keys.ESC&&this.setValue(this.value),t.keyCode!=Common.UI.Keys.RETURN&&t.keyCode!=Common.UI.Keys.ESC||this.trigger("inputleave",this))},onKeyUp:function(t){this.trigger("keyup:before",this,t),t.isDefaultPrevented()||this.trigger("keyup:after",this,t)},setEditable:function(t){var e=this._input;(this.editable=t)&&e?(e.removeAttr("readonly"),e.removeAttr("data-can-copy")):(e.attr("readonly","readonly"),e.attr("data-can-copy",!1))},isEditable:function(){return this.editable},setDisabled:function(t){this.disabled=t=!!t,$(this.el).toggleClass("disabled",t),this.rendered&&(t?this._input.attr("disabled",!0):this._input.removeAttr("disabled"))},isDisabled:function(){return this.disabled},setValue:function(t){this.value=t,this.rendered&&this._input.val(t)},getValue:function(){return this.value},focus:function(){this._input&&this._input.focus()},checkValidate:function(){var t,e,i=this,n=[];return!i.allowBlank&&_.isEmpty(i.value)&&n.push(i.blankError),_.isFunction(i.validation)&&!0!==(t=i.validation.call(i,i.value))&&(n=_.flatten(n.concat(t))),_.isEmpty(n)?(i.cmpEl.removeClass("error"),!0):(i.cmpEl.hasClass("error")?(e=i.cmpEl.find(".input-error").data("bs.tooltip"))&&(e.options.title=n.join("\n"),e.setContent()):(i.cmpEl.addClass("error"),i=(t=i.cmpEl.find(".input-error")).closest(".asc-window"),(e=t.data("bs.tooltip"))&&e.tip().remove(),t.attr("data-toggle","tooltip"),t.removeData("bs.tooltip"),t.tooltip({title:n.join("\n"),placement:"cursor"}),0<i.length&&t.data("bs.tooltip").tip().css("z-index",parseInt(i.css("z-index"))+10)),n)},showError:function(t,e){var i,n;_.isEmpty(t)?(this.cmpEl.removeClass("error"),this.cmpEl.removeClass("warning")):(this.cmpEl.addClass(e?"warning":"error"),i=(e=this.cmpEl.find(".input-error")).closest(".asc-window"),(n=e.data("bs.tooltip"))&&n.tip().remove(),e.attr("data-toggle","tooltip"),e.removeData("bs.tooltip"),e.tooltip({title:t.join("\n"),placement:"cursor"}),0<i.length&&e.data("bs.tooltip").tip().css("z-index",parseInt(i.css("z-index"))+10))},showWarning:function(t){this.showError(t,!0)}}),Common.UI.InputFieldBtn=Common.UI.InputField.extend({options:{id:null,cls:"",style:"",value:"",type:"text",name:"",validation:null,allowBlank:!0,placeHolder:"",blankError:null,spellcheck:!1,maskExp:"",validateOnChange:!1,validateOnBlur:!0,disabled:!1,editable:!0,iconCls:"toolbar__icon btn-select-range",btnHint:""},template:_.template(['<div class="input-field input-field-btn" style="<%= style %>">',"<input ","type=<%= type %> ",'name="<%= name %>" ','spellcheck="<%= spellcheck %>" ','class="form-control <%= cls %>" ','placeholder="<%= placeHolder %>" ','value="<%= value %>"','data-hint="<%= dataHint %>"','data-hint-offset="<%= dataHintOffset %>"','data-hint-direction="<%= dataHintDirection %>"',">",'<span class="input-error"></span>','<div class="select-button"></div>',"</div>"].join("")),render:function(t){var e,i;return this.rendered?this.cmpEl=this.$el:(this.cmpEl=$(this.template({id:this.id,cls:this.cls,style:this.style,value:this.value,type:this.type,name:this.name,placeHolder:this.placeHolder,spellcheck:this.spellcheck,scope:this,dataHint:this.options.dataHint,dataHintOffset:this.options.dataHintOffset,dataHintDirection:this.options.dataHintDirection})),(t?(this.setElement(t,!1),t):this.$el).html(this.cmpEl)),this.rendered||(e=this.cmpEl,this._button=new Common.UI.Button({cls:"btn-toolbar",iconCls:this.options.iconCls,hint:this.options.btnHint||"",menu:this.options.menu}),this._button.render(this.cmpEl.find(".select-button")),this._button.on("click",_.bind(this.onButtonClick,this)),this._input=this.cmpEl.find("input").addBack().filter("input"),this.editable&&(this._input.on("blur",_.bind(this.onInputChanged,this)),this._input.on("keypress",_.bind(this.onKeyPress,this)),this._input.on("keydown",_.bind(this.onKeyDown,this)),this._input.on("keyup",_.bind(this.onKeyUp,this)),this.validateOnChange&&this._input.on("input",_.bind(this.onInputChanging,this)),this.maxLength&&this._input.attr("maxlength",this.maxLength)),this.setEditable(this.editable),this.disabled&&this.setDisabled(this.disabled),0<this._input.closest(".asc-window").length&&(i=function(){var t=e.find(".input-error").data("bs.tooltip");t&&t.tip().remove(),Common.NotificationCenter.off({"modal:close":i})}),Common.NotificationCenter.on({"modal:close":i})),this.rendered=!0,this.value&&this.setValue(this.value),this},onButtonClick:function(t,e){this.trigger("button:click",this,e)},setDisabled:function(t){this.disabled=t=!!t,$(this.el).toggleClass("disabled",t),t?this._input.attr("disabled",!0):this._input.removeAttr("disabled"),this._button.setDisabled(t)},setBtnDisabled:function(t){this._button.setDisabled(t)},updateBtnHint:function(t){this.options.hint=t,this.rendered&&this._button.updateHint(this.options.hint)}}),Common.UI.InputFieldBtnPassword=Common.UI.InputFieldBtn.extend(_.extend({options:{id:null,cls:"",style:"",value:"",name:"",type:"password",validation:null,allowBlank:!0,placeHolder:"",blankError:null,spellcheck:!1,maskExp:"",validateOnChange:!1,validateOnBlur:!0,disabled:!1,editable:!0,showCls:"toolbar__icon btn-sheet-view",hideCls:"toolbar__icon btn-hide-password",btnHint:"",repeatInput:null,showPwdOnClick:!0},initialize:function(t){(t=t||{}).btnHint=t.btnHint||this.textHintShowPwd,t.iconCls=t.showCls||this.options.showCls,Common.UI.InputFieldBtn.prototype.initialize.call(this,t),this.hidePwd=!0,this.repeatInput=this.options.repeatInput},render:function(t){return Common.UI.InputFieldBtn.prototype.render.call(this,t),this._btnElm=this._button.$el,this.options.showPwdOnClick?this._button.on("click",_.bind(this.passwordClick,this)):this._btnElm.on("mousedown",_.bind(this.passwordShow,this)),this},passwordClick:function(t){this.hidePwd?(this.passwordShow(t),this.hidePwd=!1):(this.passwordHide(t),this.hidePwd=!0);var e=this,i=e._input[0].selectionStart,n=e._input[0].selectionEnd;setTimeout(function(){e.focus(),e._input[0].selectionStart=i,e._input[0].selectionEnd=n},1)},passwordShow:function(t){this.disabled||(this._button.setIconCls(this.options.hideCls),this.type="text",this._input.attr("type",this.type),this.repeatInput&&(this.repeatInput.type=this.type,this.repeatInput._input.attr("type",this.type)),this.options.showPwdOnClick?this._button.updateHint(this.textHintHidePwd):(this._btnElm.on("mouseup",_.bind(this.passwordHide,this)),this._btnElm.on("mouseout",_.bind(this.passwordHide,this))))},passwordHide:function(t){var e,i,n;this._button.setIconCls(this.options.showCls),this.type="password",this._input.attr("type",this.type),this.repeatInput&&(this.repeatInput.type=this.type,this.repeatInput._input.attr("type",this.type)),this.options.showPwdOnClick?this._button.updateHint(this.textHintShowPwd):(this._btnElm.off("mouseup",this.passwordHide),this._btnElm.off("mouseout",this.passwordHide),i=(e=this)._input[0].selectionStart,n=e._input[0].selectionEnd,setTimeout(function(){e.focus(),e._input[0].selectionStart=i,e._input[0].selectionEnd=n},1))},textHintShowPwd:"Show password",textHintHidePwd:"Hide password"},Common.UI.InputFieldBtnPassword||{})),Common.UI.InputFieldBtnCalendar=Common.UI.InputFieldBtn.extend({options:{id:null,cls:"",style:"",value:"",type:"text",name:"",validation:null,allowBlank:!0,placeHolder:"",blankError:null,spellcheck:!1,maskExp:"",validateOnChange:!1,validateOnBlur:!0,disabled:!1,editable:!0,iconCls:"toolbar__icon btn-date",btnHint:"",menu:!0},initialize:function(t){(t=t||{}).btnHint=t.btnHint||this.textDate,Common.UI.InputFieldBtn.prototype.initialize.call(this,t)},render:function(t){var n=this,e=(Common.UI.InputFieldBtn.prototype.render.call(this,t),"id-"+Common.UI.getId()+"input-field-datetime"),t=new Common.UI.Menu({menuAlign:"tr-br",style:"border: none; padding: 0;",items:[{template:_.template('<div id="'+e+'" style=""></div>'),stopPropagation:!0}]});$("button",this._button.cmpEl).addClass("no-caret"),this._button.setMenu(t),this._button.menu.on("show:after",function(i){n.cmpCalendar||(n.cmpCalendar=new Common.UI.Calendar({el:n.cmpEl.find("#"+e),enableKeyEvents:!0,firstday:1}),n.cmpCalendar.on("date:click",function(t,e){n.trigger("date:click",n,e),i.hide()}),i.alignPosition()),n.cmpCalendar.focus()})},setDate:function(t){this.cmpCalendar&&t&&t instanceof Date&&!isNaN(t)&&this.cmpCalendar&&this.cmpCalendar.setDate(t)},textDate:"Select date"}),Common.UI.InputFieldFixed=Common.UI.InputField.extend({options:{id:null,cls:"",style:"",value:"",fixedValue:"",type:"text",name:"",validation:null,allowBlank:!0,placeHolder:"",blankError:null,spellcheck:!1,maskExp:"",validateOnChange:!1,validateOnBlur:!0,disabled:!1,editable:!0,btnHint:""},template:_.template(['<div class="input-field input-field-fixed" style="<%= style %>">',"<input ","type=<%= type %> ",'name="<%= name %>" ','spellcheck="<%= spellcheck %>" ','class="form-control <%= cls %>" ','placeholder="<%= placeHolder %>" ','value="<%= value %>"','data-hint="<%= dataHint %>"','data-hint-offset="<%= dataHintOffset %>"','data-hint-direction="<%= dataHintDirection %>"',">",'<span class="input-error"></span>','<input class="fixed-text form-control" type="text" readonly="readonly"></div>'].join("")),initialize:function(t){this.fixedValue=t.fixedValue,Common.UI.InputField.prototype.initialize.call(this,t)},render:function(t){return Common.UI.InputField.prototype.render.call(this,t),this.fixedValue&&this.setFixedValue(this.fixedValue),this},setFixedValue:function(t){this.fixedValue=t,this.rendered&&this.cmpEl.find("input.fixed-text").addBack().filter("input.fixed-text").val(t)},setDisabled:function(t){var e;this.disabled=t=!!t,$(this.el).toggleClass("disabled",t),this.rendered&&(e=this.cmpEl.find("input").addBack().filter("input"),t?e.attr("disabled",!0):e.removeAttr("disabled"))}})}),void 0===Common&&(Common={}),{InternalLink:0,WebLink:1}),Common,Common,Common,c_paragraphLinerule=(define("documenteditor/main/app/view/HyperlinkSettingsDialog",["common/main/lib/util/utils","common/main/lib/component/InputField","common/main/lib/component/Window"],function(){"use strict";DE.Views.HyperlinkSettingsDialog=Common.UI.Window.extend(_.extend({options:{width:350,style:"min-width: 230px;",cls:"modal-dlg",id:"window-hyperlink",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:this.textTitle},t||{}),this.template=['<div class="box" style="height: 319px;">','<div class="input-row" style="margin-bottom: 10px;">','<button type="button" class="btn btn-text-default auto" id="id-dlg-hyperlink-external">',this.textExternal,"</button>",'<button type="button" class="btn btn-text-default auto" id="id-dlg-hyperlink-internal">',this.textInternal,"</button>","</div>",'<div class="input-row">',"<label>"+this.textDisplay+"</label>","</div>",'<div id="id-dlg-hyperlink-display" class="input-row" style="margin-bottom: 5px;"></div>','<div id="id-external-link">','<div class="input-row">',"<label>"+this.textUrl+"</label>","</div>",'<div id="id-dlg-hyperlink-url" class="input-row" style="margin-bottom: 5px;"></div>',"</div>",'<div id="id-internal-link">','<div class="input-row">',"<label>"+this.textUrl+"</label>","</div>",'<div id="id-dlg-hyperlink-list" style="width:100%; height: 171px;"></div>',"</div>",'<div class="input-row">',"<label>"+this.textTooltip+"</label>","</div>",'<div id="id-dlg-hyperlink-tip" class="input-row" style="margin-bottom: 5px;"></div>',"</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),this.api=this.options.api,this._originalProps=null,this.urlType=AscCommon.c_oAscUrlType.Invalid,Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var e=this,t=this.getChild();e.btnExternal=new Common.UI.Button({el:$("#id-dlg-hyperlink-external"),enableToggle:!0,toggleGroup:"hyperlink-type",allowDepress:!1,pressed:!0}),e.btnExternal.on("click",_.bind(e.onLinkTypeClick,e,c_oHyperlinkType.WebLink)),e.btnInternal=new Common.UI.Button({el:$("#id-dlg-hyperlink-internal"),enableToggle:!0,toggleGroup:"hyperlink-type",allowDepress:!1}),e.btnInternal.on("click",_.bind(e.onLinkTypeClick,e,c_oHyperlinkType.InternalLink)),e.inputUrl=new Common.UI.InputField({el:$("#id-dlg-hyperlink-url"),allowBlank:!1,blankError:e.txtEmpty,style:"width: 100%;",validateOnBlur:!1,validation:function(t){t=$.trim(t);return 2083<t.length?e.txtSizeLimit:(e.urlType=e.api.asc_getUrlType(t),e.urlType!==AscCommon.c_oAscUrlType.Invalid||e.txtNotUrl)}}),e.inputUrl._input.on("input",function(t){e.isInputFirstChange&&e.inputUrl.showError(),e.isInputFirstChange=!1;t=$(t.target).val();e.isAutoUpdate&&(e.inputDisplay.setValue(t),e.isTextChanged=!0),e.btnOk.setDisabled(""==$.trim(t))}),e.inputDisplay=new Common.UI.InputField({el:$("#id-dlg-hyperlink-display"),allowBlank:!0,validateOnBlur:!1,style:"width: 100%;"}).on("changed:after",function(){e.isTextChanged=!0}),e.inputDisplay._input.on("input",function(t){e.isAutoUpdate=""==$(t.target).val()}),e.inputTip=new Common.UI.InputField({el:$("#id-dlg-hyperlink-tip"),style:"width: 100%;",maxLength:Asc.c_oAscMaxTooltipLength}),e.internalList=new Common.UI.TreeView({el:$("#id-dlg-hyperlink-list"),store:new Common.UI.TreeViewStore,enableKeyEvents:!0,tabindex:1}),e.internalList.on("item:select",_.bind(this.onSelectItem,this)),e.btnOk=new Common.UI.Button({el:t.find(".primary")}),t.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),e.internalList.on("entervalue",_.bind(e.onPrimary,e)),e.externalPanel=t.find("#id-external-link"),e.internalPanel=t.find("#id-internal-link")},getFocusedComponents:function(){return[this.inputUrl,this.internalList,this.inputDisplay,this.inputTip]},ShowHideElem:function(t){this.externalPanel.toggleClass("hidden",t!==c_oHyperlinkType.WebLink),this.internalPanel.toggleClass("hidden",t!==c_oHyperlinkType.InternalLink);var e=this.internalList.store;if(t==c_oHyperlinkType.InternalLink){if(e.length<1){var i=this.api.asc_GetHyperlinkAnchors(),n=i.length,o=0,s=0,a=[];a.push(new Common.UI.TreeViewModel({name:this.txtBeginning,level:0,index:0,hasParent:!1,isEmptyItem:!1,isNotHeader:!0,hasSubItems:!1})),a.push(new Common.UI.TreeViewModel({name:this.txtHeadings,level:0,index:1,hasParent:!1,isEmptyItem:!1,isNotHeader:!1,type:Asc.c_oAscHyperlinkAnchor.Heading,hasSubItems:!1}));for(var l=0;l<n;l++){var r=i[l],c=i[l].asc_GetHeadingLevel()+1,d=!0;r.asc_GetType()==Asc.c_oAscHyperlinkAnchor.Heading&&(o<c&&a[a.length-1].set("hasSubItems",!0),c<=s&&(s=c,d=!1),a.push(new Common.UI.TreeViewModel({name:r.asc_GetHeadingText(),level:c,index:l+2,hasParent:d,type:Asc.c_oAscHyperlinkAnchor.Heading,headingParagraph:r.asc_GetHeadingParagraph()})),o=c)}a.push(new Common.UI.TreeViewModel({name:this.txtBookmarks,level:0,index:a.length,hasParent:!1,isEmptyItem:!1,isNotHeader:!1,type:Asc.c_oAscHyperlinkAnchor.Bookmark,hasSubItems:!1}));for(o=0,l=0;l<n;l++){d=!0;(r=i[l]).asc_GetType()==Asc.c_oAscHyperlinkAnchor.Bookmark&&(o<1&&a[a.length-1].set("hasSubItems",!0),a.push(new Common.UI.TreeViewModel({name:r.asc_GetBookmarkName(),level:1,index:a.length,hasParent:!1,type:Asc.c_oAscHyperlinkAnchor.Bookmark})),o=1)}e.reset(a),this.internalList.collapseAll()}var t=this.internalList.getSelectedRec(),h=(this.btnOk.setDisabled(!t||0==t.get("level")&&0<t.get("index")),this);_.delay(function(){h.inputDisplay.focus()},50)}else{this.btnOk.setDisabled(""==$.trim(this.inputUrl.getValue()));h=this;_.delay(function(){h.inputUrl.focus()},50)}},onLinkTypeClick:function(t,e,i){this.ShowHideElem(t),this.isAutoUpdate&&(t==c_oHyperlinkType.InternalLink?(t=this.internalList.getSelectedRec(),this.inputDisplay.setValue(t&&(t.get("level")||0==t.get("index"))?t.get("name"):"")):this.inputDisplay.setValue(this.inputUrl.getValue()),this.isTextChanged=!0)},onSelectItem:function(t,e,i,n){this.btnOk.setDisabled(0==i.get("level")&&0<i.get("index")),this.isAutoUpdate&&(this.inputDisplay.setValue(i.get("level")||0==i.get("index")?i.get("name"):""),this.isTextChanged=!0)},show:function(){Common.UI.Window.prototype.show.apply(this,arguments)},setSettings:function(t){var e,i,n,o;t&&(e=this,((n=(null===(i=t.get_Bookmark())||""==i)&&(t.get_Value()||!Common.Utils.InternalSettings.get("de-settings-link-type"))?c_oHyperlinkType.WebLink:c_oHyperlinkType.InternalLink)==c_oHyperlinkType.WebLink?e.btnExternal:e.btnInternal).toggle(!0),e.ShowHideElem(n),n==c_oHyperlinkType.WebLink?(t.get_Value()?e.inputUrl.setValue(t.get_Value().replace(new RegExp(" ","g"),"%20")):e.inputUrl.setValue(""),this.btnOk.setDisabled(""==$.trim(this.inputUrl.getValue()))):(t.is_TopOfDocument()?this.internalList.selectByIndex(0):t.is_Heading()?(o=this.internalList.store.findWhere({type:Asc.c_oAscHyperlinkAnchor.Heading,headingParagraph:t.get_Heading()}))&&(this.internalList.expandRecord(this.internalList.store.at(1)),this.internalList.scrollToRecord(this.internalList.selectRecord(o))):(o=this.internalList.store.findWhere({type:Asc.c_oAscHyperlinkAnchor.Bookmark,name:i}))&&(this.internalList.expandRecord(this.internalList.store.findWhere({type:Asc.c_oAscHyperlinkAnchor.Bookmark,level:0})),this.internalList.scrollToRecord(this.internalList.selectRecord(o))),o=this.internalList.getSelectedRec(),this.btnOk.setDisabled(!o||0==o.get("level")&&0<o.get("index"))),null!==t.get_Text()?(e.inputDisplay.setValue(t.get_Text()),e.inputDisplay.setDisabled(!1),e.isAutoUpdate=""==e.inputDisplay.getValue()||n==c_oHyperlinkType.WebLink&&e.inputUrl.getValue()==e.inputDisplay.getValue()):(e.inputDisplay.setValue(this.textDefault),e.inputDisplay.setDisabled(!0)),this.isTextChanged=!1,e.inputTip.setValue(t.get_ToolTip()),e._originalProps=t)},getSettings:function(){var t,e,i=this,n=new Asc.CHyperlinkProperty,o="",s=this.btnExternal.isActive()?c_oHyperlinkType.WebLink:c_oHyperlinkType.InternalLink;return s==c_oHyperlinkType.WebLink?(t=$.trim(i.inputUrl.getValue()),t=(t=i.urlType===AscCommon.c_oAscUrlType.Unsafe||/(((^https?)|(^ftp)):\/\/)|(^mailto:)/i.test(t)?t:(i.urlType==AscCommon.c_oAscUrlType.Email?"mailto:":"http://")+t).replace(new RegExp("%20","g")," "),n.put_Value(t),n.put_Bookmark(null),o=t):(t=this.internalList.getSelectedRec())&&(n.put_Bookmark(t.get("name")),0==t.get("index")&&n.put_TopOfDocument(),(e=t.get("headingParagraph"))&&n.put_Heading(e),o=t.get("name")),i.inputDisplay.isDisabled()||!i.isTextChanged&&!_.isEmpty(i.inputDisplay.getValue())?n.put_Text(null):((_.isEmpty(i.inputDisplay.getValue())||s==c_oHyperlinkType.WebLink&&i.isAutoUpdate)&&i.inputDisplay.setValue(o),n.put_Text(i.inputDisplay.getValue())),n.put_ToolTip(i.inputTip.getValue()),n.put_InternalHyperlink(i._originalProps.get_InternalHyperlink()),n},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onPrimary:function(t){return this._handleInput("ok"),!1},_handleInput:function(t){if(this.options.handler){if("ok"==t){if(this.btnExternal.isActive()){if(!0!==this.inputUrl.checkValidate())return this.isInputFirstChange=!0,void this.inputUrl.focus()}else{var e=this.internalList.getSelectedRec();if(!e||0==e.get("level")&&0<e.get("index"))return}if(!0!==this.inputDisplay.checkValidate())return void this.inputDisplay.focus();this._originalProps.get_Bookmark()||this._originalProps.get_Value()||Common.Utils.InternalSettings.set("de-settings-link-type",this.btnInternal.isActive())}this.options.handler.call(this,this,t)}this.close()}},DE.Views.HyperlinkSettingsDialog||{}))}),define("text!documenteditor/main/app/template/ParagraphSettingsAdvanced.template",[],function(){return'<div id="id-adv-paragraph-indents" class="settings-panel active">\n    <div class="inner-content">\n            <div>\n                <div class="padding-large" style="display: inline-block;">\n                    <label class="input-label"><%= scope.textAlign %></label>\n                    <div id="paragraphadv-spin-text-alignment"></div>\n                </div>\n                <div class="padding-large text-only float-right">\n                    <label class="input-label"><%= scope.strIndentsOutlinelevel %></label>\n                    <div id="paragraphadv-spin-outline-level"></div>\n                </div>\n            </div>\n            <div><label class="header padding-very-small"><%= scope.strIndent %></label></div>\n            <div>\n                <div class="padding-large margin-right-3" style="display: inline-block;">\n                 <label class="input-label"><%= scope.strIndentsLeftText %></label>\n                    <div id="paragraphadv-spin-indent-left"></div>\n                </div>\x3c!--\n             --\x3e<div class="padding-large margin-right-3" style="display: inline-block;">\n                    <label class="input-label"><%= scope.strIndentsRightText %></label>\n                    <div id="paragraphadv-spin-indent-right"></div>\n                </div>\x3c!--\n             --\x3e<div class="padding-large" style="display: inline-block;vertical-align: top">\n                    <div>\n                        <label class="input-label"><%= scope.strIndentsSpecial %></label>\n                    </div>\n                <div>\n                        <div id="paragraphadv-spin-special" class="margin-right-3" style="display: inline-block;"></div>\x3c!--\n                     --\x3e<div id="paragraphadv-spin-special-by" style="display: inline-block;"></div>\n                    </div>\n                </div>\n            </div>\n            <div><label class="header padding-very-small"><%= scope.strSpacing %></label></div>\n            <div>\n                <div class="margin-right-3" style="display: inline-block;">\n                    <label class="input-label"><%= scope.strIndentsSpacingBefore %></label>\n                    <div id="paragraphadv-spin-spacing-before"></div>\n                </div>\x3c!--\n             --\x3e<div class="margin-right-3" style="display: inline-block;">\n                    <label class="input-label"><%= scope.strIndentsSpacingAfter %></label>\n                    <div id="paragraphadv-spin-spacing-after"></div>\n                </div>\x3c!--\n             --\x3e<div style="display: inline-block;vertical-align: top">\n                    <div>\n                        <label class="input-label"><%= scope.strIndentsLineSpacing %></label>\n                    </div>\n                    <div>\n                        <div id="paragraphadv-spin-line-rule" class="margin-right-3" style="display: inline-block;"></div>\x3c!--\n                     --\x3e<div id="paragraphadv-spin-line-height" style="display: inline-block;"></div>\n                    </div>\n                </div>\n            </div>\n            <div class="text-only" style="padding-top: 8px;">\n                <div id="paragraphadv-checkbox-add-interval"></div>\n            </div>\n            <div class="padding-large" style="padding-top: 16px; display: none;">\n                <div style="border: 1px solid #cbcbcb; width: 350px;">\n                    <div id="paragraphadv-indent-preview" style="height: 58px; position: relative;"></div>\n                </div>\n            </div>\n    </div>\n</div>\n<div id="id-adv-paragraph-line" class="settings-panel">\n    <div class="inner-content text-only padding-left-10" >\n        <table cols="2" style="width: 100%;">\n            <tr>\n                <td class="padding-small">\n                    <div id="paragraphadv-checkbox-break-before"></div>\n                </td>\n                <td class="padding-small">\n                    <div id="paragraphadv-checkbox-keep-lines"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="paragraphadv-checkbox-orphan"></div>\n                </td>\n                <td class="padding-small">\n                    <div id="paragraphadv-checkbox-keep-next"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small" colspan="2">\n                    <div id="paragraphadv-checkbox-suppress-line-numbers"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-adv-paragraph-borders" class="settings-panel">\n    <div class="inner-content">\n        <div class="settings-wrap padding-small">\n            <label class="input-label"><%= scope.textBorderWidth %></label>\n            <div id="paragraphadv-combo-border-size" class="margin-left-3"></div>\n            <div class="border-color">\n                <label class="input-label" ><%= scope.textBorderColor %></label>\n                <div id="paragraphadv-border-color-btn" class="margin-left-3"></div>\n            </div>\n        </div>\n        <label class="input-label padding-small" style="width: 100%;"><%= scope.textBorderDesc %></label>\n        <div style="width: 100%;" class="padding-large">\n            <div id="id-deparagraphstyler" style="display: inline-block; vertical-align: middle; width: 200px; height: 170px;outline: 1px solid #ccc; margin-top: 2px;"></div>\n            <div class="border-types margin-left-9" style="display: inline-block; vertical-align: top; width: 76px; height: 170px; padding-top: 0px;">\n                <div id="paragraphadv-button-border-top" style="display: inline-block;"></div>\n                <div id="paragraphadv-button-border-inner-hor" style="display: inline-block;"></div>\n                <div id="paragraphadv-button-border-bottom" style="display: inline-block;"></div>\n                <div id="paragraphadv-button-border-outer" style="display: inline-block;"></div>\n                <div id="paragraphadv-button-border-left" style="display: inline-block;"></div>\n                <div id="paragraphadv-button-border-all" style="display: inline-block;"></div>\n                <div id="paragraphadv-button-border-right" style="display: inline-block;"></div>\n                <div id="paragraphadv-button-border-none" style="display: inline-block;"></div>\n            </div>\n        </div>\n        <div class="color-btn-wrap" class="padding-small">\n            <label class="input-label margin-right-5"><%= scope.textBackColor %></label>\n            <div id="paragraphadv-back-color-btn"></div>\n        </div>\n    </div>\n</div>\n<div id="id-adv-paragraph-font" class="settings-panel">\n    <div class="inner-content" style="width: 100%;">\n        <div class="padding-very-small">\n            <label class="header"><%= scope.textEffects %></label>\n        </div>\n        <table cols="2">\n            <tr>\n                <td class="padding-small">\n                    <div id="paragraphadv-checkbox-strike"></div>\n                </td>\n                <td class="padding-small padding-left-40">\n                    <div id="paragraphadv-checkbox-subscript"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="paragraphadv-checkbox-double-strike"></div>\n                </td>\n                <td class="padding-small padding-left-40">\n                    <div id="paragraphadv-checkbox-small-caps"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-large">\n                    <div id="paragraphadv-checkbox-superscript"></div>\n                </td>\n                <td class="padding-large padding-left-40">\n                    <div id="paragraphadv-checkbox-all-caps"></div>\n                </td>\n            </tr>\n        </table>\n        <div class="padding-very-small">\n            <label class="header"><%= scope.textCharacterSpacing %></label>\n        </div>\n        <div class="padding-large">\n            <div style="display: inline-block;">\n                <label class="input-label"><%= scope.textSpacing %></label>\n                <div id="paragraphadv-spin-spacing"></div>\n            </div>\n            <div class="text-only margin-left-15" style="display: inline-block;">\n                <label class="input-label"><%= scope.textPosition %></label>\n                <div id="paragraphadv-spin-position"></div>\n            </div>\n        </div>\n        <div class="padding-very-small">\n            <label class="header"><%= scope.textOpenType %></label>\n        </div>\n        <div class="padding-large">\n            <label class="input-label"><%= scope.textLigatures %></label>\n            <div id="paragraphadv-cmb-ligatures" class="margin-left-5" style="display: inline-block; vertical-align: baseline;"></div>\n        </div>\n        <div class="doc-content-color" style="outline: 1px solid #cbcbcb;">\n            <div id="paragraphadv-font-img" style="width: 300px; height: 80px; position: relative; margin: 0 auto;"></div>\n        </div>\n    </div>\n</div>\n<div id="id-adv-paragraph-tabs" class="settings-panel">\n    <div class="inner-content">\n            <div class="padding-large">\n                <label class="input-label"><%= scope.textDefault %></label>\n                <div id="paraadv-spin-default-tab"></div>\n\n            </div>\n            <div>\n                <div class="padding-large margin-right-8" style="display: inline-block;">\n                    <label class="input-label"><%= scope.textTabPosition %></label>\n                    <div id="paraadv-spin-tab"></div>\n                </div>\n                <div class="padding-large margin-right-9" style=" display: inline-block;">\n                    <label class="input-label"><%= scope.textAlign %></label>\n                    <div id="paraadv-cmb-align"></div>\n                </div>\n                <div class="padding-large text-only" style="display: inline-block;">\n                    <label class="input-label"><%= scope.textLeader %></label>\n                    <div id="paraadv-cmb-leader"></div>\n                </div>\n            </div>\n            <div>\n                <div colspan=3 class="padding-large">\n                     <div id="paraadv-list-tabs" style="width:348px; height: 116px;"></div>\n                </div>\n            </div>\n            <div>\n                <button type="button" class="btn btn-text-default margin-right-9" id="paraadv-button-add-tab" style="width: 108px; display: inline-block;"><%= scope.textSet %></button>\n                <button type="button" class="btn btn-text-default margin-right-9" id="paraadv-button-remove-tab" style="width:108px; display: inline-block;"><%= scope.textRemove %></button>\n                <button type="button" class="btn btn-text-default" id="paraadv-button-remove-all" style="width:108px;display: inline-block;"><%= scope.textRemoveAll %></button>\n            </div>\n    </div>\n</div>\n<div id="id-adv-paragraph-margins" class="settings-panel">\n    <div class="inner-content">\n            <div>\n                <div class="padding-small" style="display: inline-block;">\n                    <label class="input-label"><%= scope.textTop %></label>\n                    <div id="paraadv-number-margin-top"></div>\n                </div>\n                <div class="padding-small padding-left-15" style="display: inline-block;">\n                    <label class="input-label"><%= scope.textLeft %></label>\n                    <div id="paraadv-number-margin-left"></div>\n                </div>\n            </div>\n            <div>\n                <div class="padding-small" style="display: inline-block;">\n                    <label class="input-label"><%= scope.textBottom %></label>\n                    <div id="paraadv-number-margin-bottom"></div>\n                </div>\n                <div class="padding-small padding-left-15" style="display: inline-block;">\n                    <label class="input-label"><%= scope.textRight %></label>\n                    <div id="paraadv-number-margin-right"></div>\n                </div>\n            </div>\n    </div>\n</div>'}),void 0===Common&&(Common={}),define("common/main/lib/component/ColorButton",["common/main/lib/component/Button","common/main/lib/component/ThemeColorPalette"],function(){"use strict";Common.UI.ButtonColored=Common.UI.Button.extend(_.extend({render:function(t){Common.UI.Button.prototype.render.call(this,t),/huge/.test(this.options.cls)&&!0===this.options.split&&!this.options.hideColorLine?(t=$("button",this.cmpEl),(t=$(t[1]))&&t.append($('<div class="btn-color-value-line"></div>'))):this.options.hideColorLine||$("button:first-child",this.cmpEl).append($('<div class="btn-color-value-line"></div>')),this.colorEl=this.cmpEl.find(".btn-color-value-line"),this.options.auto&&(this.autocolor="object"==typeof this.options.auto&&this.options.auto.color||"000000"),void 0!==this.options.color&&this.setColor(this.options.color)},getPicker:function(t,e){return this.colorPicker||(e={el:this.cmpEl.find("#"+this.menu.id+"-color-menu"),value:t,colors:e},void 0!==this.options.transparent&&(e.transparent=this.options.transparent),void 0!==this.options.hideEmptyColors&&(e.hideEmptyColors=this.options.hideEmptyColors),void 0!==this.options.themecolors&&(e.themecolors=this.options.themecolors),void 0!==this.options.effects&&(e.effects=this.options.effects),void 0!==this.options.colorHints&&(e.colorHints=this.options.colorHints),this.colorPicker=new Common.UI.ThemeColorPalette(e),this.colorPicker.on("select",_.bind(this.onColorSelect,this)),this.colorPicker.on("close:extended",_.bind(this.onCloseExtentedColor,this)),this.cmpEl.find("#"+this.menu.id+"-color-new").on("click",_.bind(this.addNewColor,this)),this.options.auto&&(this.cmpEl.find("#"+this.menu.id+"-color-auto").on("click",_.bind(this.onAutoColorSelect,this)),this.colorAuto=this.cmpEl.find("#"+this.menu.id+"-color-auto > a"),"auto"==t&&this.setAutoColor(!0)),this.options.eyeDropper&&this.cmpEl.find("#"+this.menu.id+"-eyedropper").on("click",_.bind(this.onEyedropperStart,this)),this.initInnerMenu()),this.colorPicker},setPicker:function(t){this.colorPicker=t},getMenu:function(e){var t,i,n,o,s;return"object"!=typeof this.menu?(t=(e=e||this.options).paletteHeight?e.paletteHeight+"px":"auto",i=Common.UI.getId(),o=[],n=[],e.auto&&(this.autocolor="object"==typeof e.auto&&e.auto.color||"000000",o.push({id:i+"-color-auto",caption:"object"==typeof e.auto&&e.auto.caption||this.textAutoColor,template:_.template('<a tabindex="-1" type="menuitem"><span class="menu-item-icon color-auto" style="background-color: #'+this.autocolor+';"></span><%= caption %></a>')}),o.push({caption:"--"})),e.eyeDropper&&n.push({id:i+"-eyedropper",caption:this.textEyedropper,iconCls:"menu__icon btn-eyedropper"}),o=new Common.UI.Menu({id:i,cls:"color-menu "+(e.eyeDropper?"shifted-right":"shifted-left"),additionalAlign:e.additionalAlign,items:(e.additionalItems||[]).concat(o).concat([{template:_.template('<div id="'+i+'-color-menu" style="width: 164px; height:'+t+'; display: inline-block;"></div>')},{caption:"--"}]).concat(n).concat([{id:i+"-color-new",template:_.template('<a tabindex="-1" type="menuitem" style="">'+this.textNewColor+"</a>")}])}),this.initInnerMenu(),s=this,o.on("keydown:before",_.bind(this.onBeforeKeyDown,this)),o.on("show:after",function(t){s.colorPicker&&_.delay(function(){s.colorPicker.showLastSelected(),e.additionalItems||e.auto||s.colorPicker.focus()},10)}).on("hide:after",function(){s.options.takeFocusOnClose&&setTimeout(function(){s.focus()},1)}),o):this.menu},initInnerMenu:function(){var t;this.colorPicker&&"object"==typeof this.menu&&(t=(this.options.additionalItems||[]).length+(this.options.auto?2:0),this.colorPicker.outerMenu={menu:this.menu,index:t},this.menu.setInnerMenu([{menu:this.colorPicker,index:t}]))},setMenu:function(t,e){t=t||this.getMenu(),Common.UI.Button.prototype.setMenu.call(this,t),e||this.getPicker(this.options.color,this.options.colors)},onColorSelect:function(t,e){this.setColor(e),this.setAutoColor(!1),this.trigger("color:select",this,e)},onCloseExtentedColor:function(t,e){var i;this.options.takeFocusOnClose&&(i=this,setTimeout(function(){i.focus()},1))},setColor:function(t){"auto"==t&&this.options.auto&&(t=this.autocolor),this.color=t,this.colorEl&&(this.colorEl.css({"background-color":"transparent"==t?t:"object"==typeof t?"#"+t.color:"#"+t}),this.colorEl.toggleClass("bordered","transparent"==t))},setAutoColor:function(t){this.colorAuto&&(t&&!this.colorAuto.hasClass("selected")?this.colorAuto.addClass("selected"):!t&&this.colorAuto.hasClass("selected")&&this.colorAuto.removeClass("selected"))},isAutoColor:function(){return this.colorAuto&&this.colorAuto.hasClass("selected")},onAutoColorSelect:function(){this.setColor("auto"),this.setAutoColor(!0),this.colorPicker&&this.colorPicker.clearSelection(),this.trigger("auto:select",this,this.autocolor)},addNewColor:function(){this.colorPicker&&this.colorPicker.addNewColor(("object"==typeof this.color?this.color:this).color)},onEyedropperStart:function(){Common.NotificationCenter.trigger("eyedropper:start"),this.trigger("eyedropper:start",this)},eyedropperEnd:function(t,e,i){void 0!==t&&(t=Common.Utils.ThemeColor.getHexColor(t,e,i),this.colorPicker.setCustomColor("#"+t),this.onColorSelect(this.colorPicker,t),this.trigger("eyedropper:end",this))},onBeforeKeyDown:function(t,e){if((e.keyCode==Common.UI.Keys.DOWN||e.keyCode==Common.UI.Keys.SPACE)&&!this.isMenuOpen())return $("button",this.cmpEl).click(),!1},isMenuOpen:function(){return this.cmpEl.hasClass("open")},focus:function(){$("button",this.cmpEl).focus()},textNewColor:"Add New Custom Color",textAutoColor:"Automatic",textEyedropper:"Eyedropper"},Common.UI.ButtonColored||{})),Common.UI.ColorButton=Common.UI.ButtonColored.extend(_.extend({options:{id:null,hint:!1,enableToggle:!1,allowDepress:!1,toggleGroup:null,cls:"",iconCls:"",caption:"",menu:null,disabled:!1,pressed:!1,split:!1,visible:!0},template:_.template(['<div class="btn-group" id="<%= id %>">','<button type="button" class="btn btn-color dropdown-toggle <%= cls %>" data-toggle="dropdown" style="<%= style %>" data-hint="<%= dataHint %>" data-hint-direction="<%= dataHintDirection %>" data-hint-offset="<%= dataHintOffset %>">',"<span>&nbsp;</span>",'<span class="inner-box-caret">','<i class="caret"></i>',"</span>","</button>","</div>"].join("")),initialize:function(e){var i;e.menu||!1===e.menu||(e.menu=(i=this).getMenu(e),i.on("render:after",function(t){i.getPicker(e.color,e.colors)})),Common.UI.Button.prototype.initialize.call(this,e)},render:function(t){Common.UI.Button.prototype.render.call(this,t),this.options.auto&&(this.autocolor="object"==typeof this.options.auto&&this.options.auto.color||"000000"),void 0!==this.options.color&&this.setColor(this.options.color)},setColor:function(t){"auto"==t&&this.options.auto&&(t=this.autocolor);var e=$(this.cmpEl).find("button span:nth-child(1)");this.color=t,e.toggleClass("color-transparent","transparent"==t),e.css({"background-color":"transparent"==t?t:"object"==typeof t?"#"+t.color:"#"+t})},focus:function(){$("button",this.cmpEl).focus()}},Common.UI.ColorButton||{}))}),void 0===Common&&(Common={}),define("common/main/lib/component/ListView",["common/main/lib/component/DataView"],function(){"use strict";Common.UI.ListView=Common.UI.DataView.extend({options:{handleSelect:!0,enableKeyEvents:!0,showLast:!0,simpleAddMode:!1,headers:[],initSort:null,keyMoveDirection:"vertical",itemTemplate:_.template('<div id="<%= id %>" class="list-item" style=""><%= value %></div>'),cls:""},template:_.template(['<div class="listview inner <%= cls %>" <% if (options.dataHint) { %> data-hint="<%= options.dataHint %>" <% } if (options.dataHintDirection) { %> data-hint-direction="<%= options.dataHintDirection %>" <% } if (options.dataHintOffset) { %> data-hint-offset="<%= options.dataHintOffset %>" <% } %>>',"</div>"].join("")),initialize:function(t){null!=this.options.initSort&&(this.activeSortType=this.options.initSort.type,this.sortDirection=this.options.initSort.direction),this.headerEl=null,this.headerHeight=0,Common.UI.DataView.prototype.initialize.call(this,t)},render:function(){0<this.options.headers.length&&this.insertHeaders(),Common.UI.DataView.prototype.render.call(this)},insertHeaders:function(){for(var e,t=_.template(['<div class="listview-table-header-wrapper">','<div class="listview-table-header">',"<% _.each(headers, function(header){ %>","<%if (header.sortType) { %>",'<div class="table-header-item" style="<% if (header.width) {%>width: <%=header.width%>px; <%}%> <% if (header.style) { %> <%= header.style %> <%}%>" sort-type="<%=header.sortType%>">','<div class="header-sorted-wrapper">','<span class="header-sorted">',"<label><%= header.name %></label>",'<span class="sort-direction caret <%if (sortDirection == -1) { %>sort-desc <% } if (activeSortType != header.sortType) { %>caret-hidden<%}%>"></span>',"</span>","</div>","</div>","<%} else { %>",'<label class="table-header-item" style="<% if (header.width) {%>width: <%=header.width%>px; <%}%> <% if (header.style) { %> <%= header.style %> <%}%>"><%= header.name %></label>',"<%}%>","<% }); %>","</div>","</div>"].join(""))({headers:this.options.headers,activeSortType:this.options.initSort?this.options.initSort.type:null,sortDirection:this.options.initSort?this.options.initSort.direction:null}),i=(this.$el.before(t),this),n=this.$el.prev().children(),o=0,s=0;o<this.options.headers.length;o++){var a,l,r,c=this.options.headers[o];c.sortType&&(c=c.name.split(" "),a=$(n.find(".table-header-item .header-sorted label")[s]),l=$("<label>A</label>"),i.$el.before(l),1<c.length&&a.height()>Math.ceil(l.height())&&(r=0,c.forEach(function(t){l.text(t),l.width()>r&&(r=l.width())}),r<a.width()&&a.width(r)),l.remove(),s++)}n.find(".table-header-item .header-sorted").on("click",function(t){var e=$(t.currentTarget).parent().parent().attr("sort-type"),t=$(t.currentTarget).find(".caret");i.activeSortType===e?i.sortDirection=-i.sortDirection:(i.activeSortType=e,i.sortDirection=1),n.find(".caret").addClass("caret-hidden"),t.removeClass("caret-hidden"),-1==i.sortDirection?t.addClass("sort-desc"):t.removeClass("sort-desc"),i.trigger("header:click",i.activeSortType,i.sortDirection)}),0!=this.tabindex&&this.handleSelect&&(n.on("click",function(t){i.focus()}),e=function(t){i.focus(),i.$el.find(".inner").removeClass("focused"),$(document).off("mouseup",e)},n.on("mousedown",function(t){i.$el.find(".inner").addClass("focused"),$(document).on("mouseup",e)})),this.headerEl=n,this.calcOffsetFromHeader()},setHeaderName:function(t,e){var i;t<0||t>this.options.headers.length-1||!this.headerEl||((i=$(this.headerEl.find(".table-header-item")[t])).attr("sort-type")&&(i=i.find("label")[0]),this.options.headers[t].name=e,i.text(e))},setHeaderWidth:function(t,e){var i;t<0||t>this.options.headers.length-1||!this.headerEl||((i=$(this.headerEl.find(".table-header-item")[t])).attr("sort-type")&&(i=i.find("label")[0]),this.options.headers[t].width=e,$(i).width(e))},calcOffsetFromHeader:function(){var t;this.headerEl&&(t=Math.floor(this.headerEl.outerHeight()),this.headerHeight=t,this.scrollYStyle=_.extend({},this.scrollYStyle,{"margin-top":t+1+"px"}))},setOffsetFromHeader:function(t){this.headerEl&&(!0===t&&this.calcOffsetFromHeader(),this.$el.find(".listview").css({"padding-top":this.headerHeight+"px"}),this.scroller&&this.scroller.update(t?{scrollYStyle:this.scrollYStyle}:void 0))},onResetItems:function(){this.innerEl=null,Common.UI.DataView.prototype.onResetItems.call(this),this.trigger("items:reset",this),this.headerEl&&this.setOffsetFromHeader()},createNewItem:function(t){return new Common.UI.DataViewItem({template:this.itemTemplate,model:t})},onAddItem:function(t,e,i){var n,o,s=this.createNewItem(t);this.innerEl||(this.innerEl=$(this.el).find(".inner")),s&&this.innerEl&&(this.dataViewItems.length<1&&this.innerEl.find(".empty-text").remove(),this.options.simpleAddMode?(this.innerEl.append(s.render().el),this.dataViewItems.push(s)):(n=_.indexOf(this.store.models,t),o=this.innerEl.find("> .item"),0<n?$(o.get(n-1)).after(s.render().el):0<o.length?$(o[n]).before(s.render().el):this.innerEl.append(s.render().el),this.dataViewItems=this.dataViewItems.slice(0,n).concat(s).concat(this.dataViewItems.slice(n))),this.listenTo(s,"change",this.onChangeItem),this.listenTo(s,"remove",this.onRemoveItem),this.listenTo(s,"click",this.onClickItem),this.listenTo(s,"dblclick",this.onDblClickItem),this.listenTo(s,"select",this.onSelectItem),t.get("tip")&&((o=$(s.el)).attr("data-toggle","tooltip"),o.tooltip({title:t.get("tip"),placement:"cursor",zIndex:this.tipZIndex})),this.isSuspendEvents||this.trigger("item:add",this,s,t))},focus:function(){this.cmpEl&&this.cmpEl.find(".listview").focus()},scrollToRecord:function(t,e){var i,n,o,s,a,l;this._fromKeyDown?t&&(n=(i=$(this.el).find(".inner")).innerHeight(),(s=0<=(s=_.indexOf(this.store.models,t))&&this.dataViewItems.length>s?$(this.dataViewItems[s].el):i.find("#"+t.get("id"))).length<=0||(o=s.position().top,s=s.outerHeight(),a=(a=this.dataViewItems[0].el)?a.offsetTop:0,e||o<a?l=i.scrollTop()+o-a:n<o+s&&(l=i.scrollTop()+o+s-n),void 0!==l&&(this.scroller&&this.allowScrollbar?this.scroller.scrollTop(l,0):i.scrollTop(l)))):Common.UI.DataView.prototype.scrollToRecord.call(this,t,e,this.headerHeight)}})}),define("documenteditor/main/app/view/ParagraphSettingsAdvanced",["text!documenteditor/main/app/template/ParagraphSettingsAdvanced.template","common/main/lib/view/AdvancedSettingsWindow","common/main/lib/component/MetricSpinner","common/main/lib/component/CheckBox","common/main/lib/component/ThemeColorPalette","common/main/lib/component/ColorButton","common/main/lib/component/ListView","common/main/lib/component/TableStyler"],function(n){"use strict";DE.Views.ParagraphSettingsAdvanced=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:370,height:415,toggleGroup:"paragraph-adv-settings-group",storageName:"de-para-settings-adv-category"},initialize:function(t){var e=this;_.extend(this.options,{title:this.textTitle,items:[{panelId:"id-adv-paragraph-indents",panelCaption:this.strParagraphIndents},{panelId:"id-adv-paragraph-line",panelCaption:this.strParagraphLine},{panelId:"id-adv-paragraph-borders",panelCaption:this.strBorders},{panelId:"id-adv-paragraph-font",panelCaption:this.strParagraphFont},{panelId:"id-adv-paragraph-tabs",panelCaption:this.strTabs},{panelId:"id-adv-paragraph-margins",panelCaption:this.strMargins}],contentTemplate:_.template(n)({scope:this})},t),Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options),this.Borders={},this.BorderSize={ptValue:0,pxValue:0},this.paragraphShade="transparent",this._changedProps=null,this.ChangedBorders=void 0,this.checkGroup=0,this._noApply=!0,this._tabListChanged=!1,this.Margins=void 0,this.FirstLine=void 0,this.LeftIndent=void 0,this.Spacing=null,this.spinners=[],this.tableStylerRows=this.options.tableStylerRows,this.tableStylerColumns=this.options.tableStylerColumns,this.borderProps=this.options.borderProps,this.api=this.options.api,this._originalProps=new Asc.asc_CParagraphProperty(this.options.paragraphProps),this.isChart=this.options.isChart,this.isSmartArtInternal=this.options.isSmartArtInternal,this.CurLineRuleIdx=this._originalProps.get_Spacing().get_LineRule(),this._arrLineRule=[{displayValue:this.textAtLeast,defaultValue:5,value:c_paragraphLinerule.LINERULE_LEAST,minValue:.03,step:.01,defaultUnit:"cm"},{displayValue:this.textAuto,defaultValue:1,value:c_paragraphLinerule.LINERULE_AUTO,minValue:.5,step:.01,defaultUnit:""},{displayValue:this.textExact,defaultValue:5,value:c_paragraphLinerule.LINERULE_EXACT,minValue:.03,step:.01,defaultUnit:"cm"}],this._arrSpecial=[{displayValue:this.textNoneSpecial,value:c_paragraphSpecial.NONE_SPECIAL,defaultValue:0},{displayValue:this.textFirstLine,value:c_paragraphSpecial.FIRST_LINE,defaultValue:12.7},{displayValue:this.textHanging,value:c_paragraphSpecial.HANGING,defaultValue:12.7}],this.CurSpecial=void 0,this._arrTextAlignment=[{displayValue:this.textTabLeft,value:c_paragraphTextAlignment.LEFT},{displayValue:this.textTabCenter,value:c_paragraphTextAlignment.CENTERED},{displayValue:this.textTabRight,value:c_paragraphTextAlignment.RIGHT},{displayValue:this.textJustified,value:c_paragraphTextAlignment.JUSTIFIED}],this._arrOutlinelevel=[{displayValue:this.textBodyText,value:-1}];for(var i=0;i<9;i++)this._arrOutlinelevel.push({displayValue:i+1+" "+this.textLevel,value:i});this._arrTabAlign=[{value:Asc.c_oAscTabType.Left,displayValue:this.textTabLeft},{value:Asc.c_oAscTabType.Center,displayValue:this.textTabCenter},{value:Asc.c_oAscTabType.Right,displayValue:this.textTabRight}],this._arrKeyTabAlign=[],this._arrTabAlign.forEach(function(t){e._arrKeyTabAlign[t.value]=t.displayValue}),this._arrTabLeader=[{value:Asc.c_oAscTabLeader.None,displayValue:this.textNone},{value:Asc.c_oAscTabLeader.Dot,displayValue:"...................."},{value:Asc.c_oAscTabLeader.Hyphen,displayValue:"-----------------"},{value:Asc.c_oAscTabLeader.MiddleDot,displayValue:"·················"},{value:Asc.c_oAscTabLeader.Underscore,displayValue:"__________"}],this._arrKeyTabLeader=[],this._arrTabLeader.forEach(function(t){e._arrKeyTabLeader[t.value]=t.displayValue})},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);function t(){e._noApply||(e._tabListChanged=!0)}var e=this,i=(this.numIndentsLeft=new Common.UI.MetricSpinner({el:$("#paragraphadv-spin-indent-left"),step:.1,width:85,defaultUnit:"cm",defaultValue:0,value:"0 cm",maxValue:55.87,minValue:-55.87}),this.numIndentsLeft.on("change",_.bind(function(t,e,i,n){this._changedProps&&(null!==this._changedProps.get_Ind()&&void 0!==this._changedProps.get_Ind()||this._changedProps.put_Ind(new Asc.asc_CParagraphInd),this._changedProps.get_Ind().put_Left(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())))},this)),this.spinners.push(this.numIndentsLeft),this.numIndentsRight=new Common.UI.MetricSpinner({el:$("#paragraphadv-spin-indent-right"),step:.1,width:85,defaultUnit:"cm",defaultValue:0,value:"0 cm",maxValue:55.87,minValue:-55.87}),this.numIndentsRight.on("change",_.bind(function(t,e,i,n){this._changedProps&&(null!==this._changedProps.get_Ind()&&void 0!==this._changedProps.get_Ind()||this._changedProps.put_Ind(new Asc.asc_CParagraphInd),this._changedProps.get_Ind().put_Right(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())))},this)),this.spinners.push(this.numIndentsRight),this.numSpacingBefore=new Common.UI.MetricSpinner({el:$("#paragraphadv-spin-spacing-before"),step:.1,width:85,value:"",defaultUnit:"cm",maxValue:55.88,minValue:0,allowAuto:!0,autoText:this.txtAutoText}),this.numSpacingBefore.on("change",_.bind(function(t,e,i,n){null===this.Spacing&&(o=this._originalProps||new Asc.asc_CParagraphProperty,this.Spacing=o.get_Spacing());var o=t.getNumberValue();this.Spacing.put_Before(o<0?-1:Common.Utils.Metric.fnRecalcToMM(o))},this)),this.spinners.push(this.numSpacingBefore),this.numSpacingAfter=new Common.UI.MetricSpinner({el:$("#paragraphadv-spin-spacing-after"),step:.1,width:85,value:"",defaultUnit:"cm",maxValue:55.88,minValue:0,allowAuto:!0,autoText:this.txtAutoText}),this.numSpacingAfter.on("change",_.bind(function(t,e,i,n){null===this.Spacing&&(o=this._originalProps||new Asc.asc_CParagraphProperty,this.Spacing=o.get_Spacing());var o=t.getNumberValue();this.Spacing.put_After(o<0?-1:Common.Utils.Metric.fnRecalcToMM(o))},this)),this.spinners.push(this.numSpacingAfter),this.cmbLineRule=new Common.UI.ComboBox({el:$("#paragraphadv-spin-line-rule"),cls:"input-group-nr",editable:!1,data:this._arrLineRule,style:"width: 85px;",menuStyle:"min-width: 85px;",takeFocusOnClose:!0}),this.cmbLineRule.setValue(""),this.cmbLineRule.on("selected",_.bind(this.onLineRuleSelect,this)),this.numLineHeight=new Common.UI.MetricSpinner({el:$("#paragraphadv-spin-line-height"),step:.01,width:85,value:"",defaultUnit:"",maxValue:132,minValue:.5}),this.spinners.push(this.numLineHeight),this.numLineHeight.on("change",_.bind(this.onNumLineHeightChange,this)),this.chAddInterval=new Common.UI.CheckBox({el:$("#paragraphadv-checkbox-add-interval"),labelText:this.strSomeParagraphSpace}),this.cmbSpecial=new Common.UI.ComboBox({el:$("#paragraphadv-spin-special"),cls:"input-group-nr",editable:!1,data:this._arrSpecial,style:"width: 85px;",menuStyle:"min-width: 85px;",takeFocusOnClose:!0}),this.cmbSpecial.setValue(""),this.cmbSpecial.on("selected",_.bind(this.onSpecialSelect,this)),this.numSpecialBy=new Common.UI.MetricSpinner({el:$("#paragraphadv-spin-special-by"),step:.1,width:85,defaultUnit:"cm",defaultValue:0,value:"0 cm",maxValue:55.87,minValue:0}),this.spinners.push(this.numSpecialBy),this.numSpecialBy.on("change",_.bind(this.onFirstLineChange,this)),this.cmbTextAlignment=new Common.UI.ComboBox({el:$("#paragraphadv-spin-text-alignment"),cls:"input-group-nr",editable:!1,data:this._arrTextAlignment,style:"width: 173px;",menuStyle:"min-width: 173px;",takeFocusOnClose:!0}),this.cmbTextAlignment.setValue(""),this.cmbOutlinelevel=new Common.UI.ComboBox({el:$("#paragraphadv-spin-outline-level"),cls:"input-group-nr",editable:!1,data:this._arrOutlinelevel,style:"width: 174px;",menuStyle:"min-width: 174px;",takeFocusOnClose:!0}),this.cmbOutlinelevel.setValue(-1),this.cmbOutlinelevel.on("selected",_.bind(this.onOutlinelevelSelect,this)),this.chBreakBefore=new Common.UI.CheckBox({el:$("#paragraphadv-checkbox-break-before"),labelText:this.strBreakBefore}),this.chBreakBefore.on("change",_.bind(function(t,e,i,n){this._changedProps&&this._changedProps.put_PageBreakBefore("checked"==t.getValue())},this)),this.chKeepLines=new Common.UI.CheckBox({el:$("#paragraphadv-checkbox-keep-lines"),labelText:this.strKeepLines}),this.chKeepLines.on("change",_.bind(function(t,e,i,n){this._changedProps&&this._changedProps.put_KeepLines("checked"==t.getValue())},this)),this.chOrphan=new Common.UI.CheckBox({el:$("#paragraphadv-checkbox-orphan"),labelText:this.strOrphan}),this.chOrphan.on("change",_.bind(function(t,e,i,n){this._changedProps&&this._changedProps.put_WidowControl("checked"==t.getValue())},this)),this.chKeepNext=new Common.UI.CheckBox({el:$("#paragraphadv-checkbox-keep-next"),labelText:this.strKeepNext}),this.chKeepNext.on("change",_.bind(function(t,e,i,n){this._changedProps&&this._changedProps.put_KeepNext("checked"==t.getValue())},this)),this.chLineNumbers=new Common.UI.CheckBox({el:$("#paragraphadv-checkbox-suppress-line-numbers"),labelText:this.strSuppressLineNumbers}),this.chLineNumbers.on("change",_.bind(function(t,e,i,n){this._changedProps&&this._changedProps.put_SuppressLineNumbers("checked"==t.getValue())},this)),this.cmbBorderSize=new Common.UI.ComboBorderSize({el:$("#paragraphadv-combo-border-size"),style:"width: 93px;",takeFocusOnClose:!0}),this.cmbBorderSize.store.at(2)),i=(this.BorderSize={ptValue:i.get("value"),pxValue:i.get("pxValue")},this.cmbBorderSize.setValue(this.BorderSize.ptValue),this.cmbBorderSize.on("selected",_.bind(this.onBorderSizeSelect,this)),this.btnBorderColor=new Common.UI.ColorButton({parentEl:$("#paragraphadv-border-color-btn"),additionalAlign:this.menuAddAlign,color:"auto",auto:!0,cls:"move-focus",takeFocusOnClose:!0}),this.colorsBorder=this.btnBorderColor.getPicker(),this.btnBorderColor.on("color:select",_.bind(this.onColorsBorderSelect,this)),this.btnBorderColor.on("auto:select",_.bind(this.onColorsBorderSelect,this)),this.BordersImage=new Common.UI.TableStyler({el:$("#id-deparagraphstyler"),width:200,height:170,rows:this.tableStylerRows,columns:this.tableStylerColumns,spacingMode:!1}),[["lrtb","toolbar__icon toolbar__icon-big btn-paragraph-borders-outer","paragraphadv-button-border-outer",this.tipOuter],["lrtbm","toolbar__icon toolbar__icon-big btn-paragraph-borders-all","paragraphadv-button-border-all",this.tipAll],["","toolbar__icon toolbar__icon-big btn-paragraph-borders-none","paragraphadv-button-border-none",this.tipNone],["l","toolbar__icon toolbar__icon-big btn-paragraph-borders-left","paragraphadv-button-border-left",this.tipLeft],["r","toolbar__icon toolbar__icon-big btn-paragraph-borders-right","paragraphadv-button-border-right",this.tipRight],["t","toolbar__icon toolbar__icon-big btn-paragraph-borders-top","paragraphadv-button-border-top",this.tipTop],["m","toolbar__icon toolbar__icon-big btn-paragraph-borders-inner","paragraphadv-button-border-inner-hor",this.tipInner],["b","toolbar__icon toolbar__icon-big btn-paragraph-borders-bottom","paragraphadv-button-border-bottom",this.tipBottom]]);this._btnsBorderPosition=[],_.each(i,function(t,e,i){t=new Common.UI.Button({parentEl:$("#"+t[2]),cls:"btn-options large border-off",iconCls:t[1],strId:t[0],hint:t[3]});t.on("click",_.bind(this._ApplyBorderPreset,this)),this._btnsBorderPosition.push(t)},this),this.btnBackColor=new Common.UI.ColorButton({parentEl:$("#paragraphadv-back-color-btn"),transparent:!0,additionalAlign:this.menuAddAlign,cls:"move-focus",takeFocusOnClose:!0}),this.colorsBack=this.btnBackColor.getPicker(),this.btnBackColor.on("color:select",_.bind(this.onColorsBackSelect,this)),this.chStrike=new Common.UI.CheckBox({el:$("#paragraphadv-checkbox-strike"),labelText:this.strStrike}),this.chStrike.on("change",_.bind(this.onStrikeChange,this)),this.chDoubleStrike=new Common.UI.CheckBox({el:$("#paragraphadv-checkbox-double-strike"),labelText:this.strDoubleStrike}),this.chDoubleStrike.on("change",_.bind(this.onDoubleStrikeChange,this)),this.chSuperscript=new Common.UI.CheckBox({el:$("#paragraphadv-checkbox-superscript"),labelText:this.strSuperscript}),this.chSuperscript.on("change",_.bind(this.onSuperscriptChange,this)),this.chSubscript=new Common.UI.CheckBox({el:$("#paragraphadv-checkbox-subscript"),labelText:this.strSubscript}),this.chSubscript.on("change",_.bind(this.onSubscriptChange,this)),this.chSmallCaps=new Common.UI.CheckBox({el:$("#paragraphadv-checkbox-small-caps"),labelText:this.strSmallCaps}),this.chSmallCaps.on("change",_.bind(this.onSmallCapsChange,this)),this.chAllCaps=new Common.UI.CheckBox({el:$("#paragraphadv-checkbox-all-caps"),labelText:this.strAllCaps}),this.chAllCaps.on("change",_.bind(this.onAllCapsChange,this)),this.numSpacing=new Common.UI.MetricSpinner({el:$("#paragraphadv-spin-spacing"),step:.01,width:90,defaultUnit:"cm",defaultValue:0,value:"0 cm",maxValue:55.87,minValue:-55.87}),this.numSpacing.on("change",_.bind(function(t,e,i,n){var o;this._changedProps&&this._changedProps.put_TextSpacing(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())),this.api&&!this._noApply&&((o=this._originalProps||new Asc.asc_CParagraphProperty).put_TextSpacing(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())),this.api.SetDrawImagePlaceParagraph("paragraphadv-font-img",o))},this)),this.spinners.push(this.numSpacing),this.numPosition=new Common.UI.MetricSpinner({el:$("#paragraphadv-spin-position"),step:.01,width:90,defaultUnit:"cm",defaultValue:0,value:"0 cm",maxValue:55.87,minValue:-55.87}),this.numPosition.on("change",_.bind(function(t,e,i,n){var o;this._changedProps&&this._changedProps.put_Position(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())),this.api&&!this._noApply&&((o=this._originalProps||new Asc.asc_CParagraphProperty).put_Position(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())),this.api.SetDrawImagePlaceParagraph("paragraphadv-font-img",o))},this)),this.spinners.push(this.numPosition),this._arrLigatures=[{displayValue:this.textNone,value:Asc.LigaturesType.None},{displayValue:this.textStandard,value:Asc.LigaturesType.Standard},{displayValue:this.textContext,value:Asc.LigaturesType.Contextual},{displayValue:this.textHistorical,value:Asc.LigaturesType.Historical},{displayValue:this.textDiscret,value:Asc.LigaturesType.Discretional},{displayValue:this.textStandardContext,value:Asc.LigaturesType.StandardContextual},{displayValue:this.textStandardHistorical,value:Asc.LigaturesType.StandardHistorical},{displayValue:this.textContextHistorical,value:Asc.LigaturesType.ContextualHistorical},{displayValue:this.textStandardDiscret,value:Asc.LigaturesType.StandardDiscretional},{displayValue:this.textContextDiscret,value:Asc.LigaturesType.ContextualDiscretional},{displayValue:this.textHistoricalDiscret,value:Asc.LigaturesType.HistoricalDiscretional},{displayValue:this.textStandardContextHist,value:Asc.LigaturesType.StandardContextualHistorical},{displayValue:this.textStandardContextDiscret,value:Asc.LigaturesType.StandardContextualDiscretional},{displayValue:this.textStandardHistDiscret,value:Asc.LigaturesType.StandardHistoricalDiscretional},{displayValue:this.textContextHistDiscret,value:Asc.LigaturesType.ContextualHistoricalDiscretional},{displayValue:this.textAll,value:Asc.LigaturesType.All}],this.cmbLigatures=new Common.UI.ComboBox({el:$("#paragraphadv-cmb-ligatures"),cls:"input-group-nr",editable:!1,data:this._arrLigatures,style:"width: 210px;",menuStyle:"min-width: 210px;max-height:135px;",takeFocusOnClose:!0}),this.cmbLigatures.setValue(Asc.LigaturesType.None),this.cmbLigatures.on("selected",_.bind(this.onLigaturesSelect,this)),this.numTab=new Common.UI.MetricSpinner({el:$("#paraadv-spin-tab"),step:.1,width:108,defaultUnit:"cm",value:"1.25 cm",maxValue:55.87,minValue:0}),this.spinners.push(this.numTab),this.numDefaultTab=new Common.UI.MetricSpinner({el:$("#paraadv-spin-default-tab"),step:.1,width:108,defaultUnit:"cm",value:"1.25 cm",maxValue:55.87,minValue:0}),this.numDefaultTab.on("change",_.bind(function(t,e,i,n){this._changedProps&&this._changedProps.put_DefaultTab(parseFloat(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue()).toFixed(1)))},this)),this.spinners.push(this.numDefaultTab),this.tabList=new Common.UI.ListView({el:$("#paraadv-list-tabs"),emptyText:this.noTabs,store:new Common.UI.DataViewStore,template:_.template(['<div class="listview inner" style=""></div>'].join("")),itemTemplate:_.template(['<div id="<%= id %>" class="list-item" style="width: 100%;display:inline-block;">','<div style="width:117px;display: inline-block;"><%= value %></div>','<div style="width:121px;display: inline-block;"><%= displayTabAlign %></div>',this.isChart||this.isSmartArtInternal?"":'<div style="width:96px;display: inline-block;"><%= displayTabLeader %></div>',"</div>"].join("")),tabindex:1}),this.tabList.store.comparator=function(t){return t.get("tabPos")},this.tabList.on("item:select",_.bind(this.onSelectTab,this));this.listenTo(this.tabList.store,"add",t),this.listenTo(this.tabList.store,"remove",t),this.listenTo(this.tabList.store,"reset",t),this.cmbAlign=new Common.UI.ComboBox({el:$("#paraadv-cmb-align"),style:"width: 108px;",menuStyle:"min-width: 108px;",editable:!1,cls:"input-group-nr",data:this._arrTabAlign,takeFocusOnClose:!0}),this.cmbAlign.setValue(Asc.c_oAscTabType.Left),this.cmbLeader=new Common.UI.ComboBox({el:$("#paraadv-cmb-leader"),style:"width: 108px;",menuStyle:"min-width: 108px;",editable:!1,cls:"input-group-nr",data:this._arrTabLeader,takeFocusOnClose:!0}),this.cmbLeader.setValue(Asc.c_oAscTabLeader.None),this.btnAddTab=new Common.UI.Button({el:$("#paraadv-button-add-tab")}),this.btnAddTab.on("click",_.bind(this.addTab,this)),this.btnRemoveTab=new Common.UI.Button({el:$("#paraadv-button-remove-tab")}),this.btnRemoveTab.on("click",_.bind(this.removeTab,this)),this.btnRemoveAll=new Common.UI.Button({el:$("#paraadv-button-remove-all")}),this.btnRemoveAll.on("click",_.bind(this.removeAllTabs,this)),this.spnMarginTop=new Common.UI.MetricSpinner({el:$("#paraadv-number-margin-top"),step:.1,width:100,defaultUnit:"cm",value:"0 cm",maxValue:55.87,minValue:0}),this.spnMarginTop.on("change",_.bind(function(t,e,i,n){this._noApply||(void 0===this.Margins&&(this.Margins={}),this.Margins.Top=Common.Utils.Metric.fnRecalcToMM(t.getNumberValue()))},this)),this.spinners.push(this.spnMarginTop),this.spnMarginBottom=new Common.UI.MetricSpinner({el:$("#paraadv-number-margin-bottom"),step:.1,width:100,defaultUnit:"cm",value:"0 cm",maxValue:55.87,minValue:0}),this.spnMarginBottom.on("change",_.bind(function(t,e,i,n){this._noApply||(void 0===this.Margins&&(this.Margins={}),this.Margins.Bottom=Common.Utils.Metric.fnRecalcToMM(t.getNumberValue()))},this)),this.spinners.push(this.spnMarginBottom),this.spnMarginLeft=new Common.UI.MetricSpinner({el:$("#paraadv-number-margin-left"),step:.1,width:100,defaultUnit:"cm",value:"0.19 cm",maxValue:9.34,minValue:0}),this.spnMarginLeft.on("change",_.bind(function(t,e,i,n){this._noApply||(void 0===this.Margins&&(this.Margins={}),this.Margins.Left=Common.Utils.Metric.fnRecalcToMM(t.getNumberValue()))},this)),this.spinners.push(this.spnMarginLeft),this.spnMarginRight=new Common.UI.MetricSpinner({el:$("#paraadv-number-margin-right"),step:.1,width:100,defaultUnit:"cm",value:"0.19 cm",maxValue:9.34,minValue:0}),this.spnMarginRight.on("change",_.bind(function(t,e,i,n){this._noApply||(void 0===this.Margins&&(this.Margins={}),this.Margins.Right=Common.Utils.Metric.fnRecalcToMM(t.getNumberValue()))},this)),this.spinners.push(this.spnMarginRight),this.TextOnlySettings=$(".text-only"),this.afterRender()},getFocusedComponents:function(){return[this.cmbTextAlignment,this.cmbOutlinelevel,this.numIndentsLeft,this.numIndentsRight,this.cmbSpecial,this.numSpecialBy,this.numSpacingBefore,this.numSpacingAfter,this.cmbLineRule,this.numLineHeight,this.chAddInterval,this.chBreakBefore,this.chKeepLines,this.chOrphan,this.chKeepNext,this.chLineNumbers,this.cmbBorderSize,this.btnBorderColor].concat(this._btnsBorderPosition).concat([this.btnBackColor,this.chStrike,this.chSubscript,this.chDoubleStrike,this.chSmallCaps,this.chSuperscript,this.chAllCaps,this.numSpacing,this.numPosition,this.numDefaultTab,this.numTab,this.cmbAlign,this.cmbLeader,this.tabList,this.btnAddTab,this.btnRemoveTab,this.btnRemoveAll,this.spnMarginTop,this.spnMarginLeft,this.spnMarginBottom,this.spnMarginRight])},onCategoryClick:function(t,e,i,n){Common.Views.AdvancedSettingsWindow.prototype.onCategoryClick.call(this,t,e);var o=this;setTimeout(function(){switch(e){case 0:o.cmbTextAlignment.focus();break;case 1:o.chBreakBefore.focus();break;case 2:o.cmbBorderSize.focus();break;case 3:o.chStrike.focus(),n&&n instanceof jQuery.Event&&o.api.SetDrawImagePlaceParagraph("paragraphadv-font-img",o._originalProps||new Asc.asc_CParagraphProperty);break;case 4:o.numDefaultTab.focus();break;case 5:o.spnMarginTop.focus()}},10)},onAnimateAfter:function(){3==this.getActiveCategory()&&this.api.SetDrawImagePlaceParagraph("paragraphadv-font-img",this._originalProps||new Asc.asc_CParagraphProperty)},getSettings:function(){null===this.ChangedBorders?this._changedProps.put_Borders(this.Borders):void 0!==this.ChangedBorders&&this._changedProps.put_Borders(this.ChangedBorders),this.Margins&&(null==(e=this._changedProps.get_Borders())&&(this._changedProps.put_Borders(new Asc.asc_CParagraphBorders),e=this._changedProps.get_Borders()),void 0!==this.Margins.Left&&(void 0!==e.get_Left()&&null!==e.get_Left()||e.put_Left(new Asc.asc_CTextBorder(this.Borders.get_Left())),e.get_Left().put_Space(this.Margins.Left)),void 0!==this.Margins.Top&&(void 0!==e.get_Top()&&null!==e.get_Top()||e.put_Top(new Asc.asc_CTextBorder(this.Borders.get_Top())),e.get_Top().put_Space(this.Margins.Top)),void 0!==this.Margins.Right&&(void 0!==e.get_Right()&&null!==e.get_Right()||e.put_Right(new Asc.asc_CTextBorder(this.Borders.get_Right())),e.get_Right().put_Space(this.Margins.Right)),void 0!==this.Margins.Bottom&&(void 0!==e.get_Bottom()&&null!==e.get_Bottom()||e.put_Bottom(new Asc.asc_CTextBorder(this.Borders.get_Bottom())),e.get_Bottom().put_Space(this.Margins.Bottom),void 0!==e.get_Between()&&null!==e.get_Between()||e.put_Between(new Asc.asc_CTextBorder(this.Borders.get_Between())),e.get_Between().put_Space(this.Margins.Bottom))),this._tabListChanged&&(null!==this._changedProps.get_Tabs()&&void 0!==this._changedProps.get_Tabs()||this._changedProps.put_Tabs(new Asc.asc_CParagraphTabs),this.tabList.store.each(function(t,e){t=new Asc.asc_CParagraphTab(Common.Utils.Metric.fnRecalcToMM(t.get("tabPos")),t.get("tabAlign"),t.get("tabLeader"));this._changedProps.get_Tabs().add_Tab(t)},this)),null!==this._changedProps.get_Ind()&&void 0!==this._changedProps.get_Ind()&&(e=this._changedProps.get_Ind().get_Left(),t=this._changedProps.get_Ind().get_FirstLine(),void 0===e&&void 0===t||!(t<0||this.FirstLine<0)||(t<0||null==t?(null==t&&(t=this.FirstLine),null!=(e=null==e?this.LeftIndent:e)&&this._changedProps.get_Ind().put_Left(e-t)):null!=(e=null==e?this.LeftIndent:e)&&this._changedProps.get_Ind().put_Left(e))),null!==this.Spacing&&this._changedProps.asc_putSpacing(this.Spacing);var t=this.chAddInterval.getValue(),e=(this._changedProps.asc_putContextualSpacing("checked"==t),this.cmbTextAlignment.getValue());return this._changedProps.asc_putJc(null!=e?e:c_paragraphTextAlignment.LEFT),{paragraphProps:this._changedProps,borderProps:{borderSize:this.BorderSize,borderColor:this.btnBorderColor.isAutoColor()?"auto":this.btnBorderColor.color}}},_setDefaults:function(t){if(t){this._originalProps=new Asc.asc_CParagraphProperty(t),this.hideTextOnlySettings(this.isChart||this.isSmartArtInternal),this.FirstLine=null!==t.get_Ind()?t.get_Ind().get_FirstLine():null,this.LeftIndent=null!==t.get_Ind()?t.get_Ind().get_Left():null,this.FirstLine<0&&null!==this.LeftIndent&&(this.LeftIndent=this.LeftIndent+this.FirstLine),this.numIndentsLeft.setValue(null!==this.LeftIndent?Common.Utils.Metric.fnRecalcFromMM(this.LeftIndent):"",!0),this.numIndentsRight.setValue(null!==t.get_Ind()&&null!==t.get_Ind().get_Right()?Common.Utils.Metric.fnRecalcFromMM(t.get_Ind().get_Right()):"",!0);var e,i=t.get_Spacing()?t.get_Spacing().get_Before():null,i=(this.numSpacingBefore.setValue(null!==i?i<0?i:Common.Utils.Metric.fnRecalcFromMM(i):"",!0),i=t.get_Spacing()?t.get_Spacing().get_After():null,this.numSpacingAfter.setValue(null!==i?i<0?i:Common.Utils.Metric.fnRecalcFromMM(i):"",!0),t.get_Spacing().get_LineRule()),i=(this.cmbLineRule.setValue(null!==i?i:""),null!==t.get_Spacing()&&null!==t.get_Spacing().get_Line()?this.numLineHeight.setValue(i==c_paragraphLinerule.LINERULE_AUTO?t.get_Spacing().get_Line():Common.Utils.Metric.fnRecalcFromMM(t.get_Spacing().get_Line()),!0):this.numLineHeight.setValue("",!0),this.chAddInterval.setValue(null!==t.get_ContextualSpacing()&&void 0!==t.get_ContextualSpacing()?t.get_ContextualSpacing():"indeterminate",!0),void 0===this.CurSpecial&&(this.CurSpecial=0===t.get_Ind().get_FirstLine()?c_paragraphSpecial.NONE_SPECIAL:0<t.get_Ind().get_FirstLine()?c_paragraphSpecial.FIRST_LINE:c_paragraphSpecial.HANGING),this.cmbSpecial.setValue(this.CurSpecial),this.numSpecialBy.setValue(null!==this.FirstLine?Math.abs(Common.Utils.Metric.fnRecalcFromMM(this.FirstLine)):"",!0),this.cmbTextAlignment.setValue(void 0!==t.get_Jc()&&null!==t.get_Jc()?t.get_Jc():c_paragraphTextAlignment.LEFT,!0),this.chKeepLines.setValue(null!==t.get_KeepLines()&&void 0!==t.get_KeepLines()?t.get_KeepLines():"indeterminate",!0),this.chBreakBefore.setValue(null!==t.get_PageBreakBefore()&&void 0!==t.get_PageBreakBefore()?t.get_PageBreakBefore():"indeterminate",!0),this.chKeepNext.setValue(null!==t.get_KeepNext()&&void 0!==t.get_KeepNext()?t.get_KeepNext():"indeterminate",!0),this.chOrphan.setValue(null!==t.get_WidowControl()&&void 0!==t.get_WidowControl()?t.get_WidowControl():"indeterminate",!0),this.chLineNumbers.setValue(null!==t.get_SuppressLineNumbers()&&void 0!==t.get_SuppressLineNumbers()?t.get_SuppressLineNumbers():"indeterminate",!0),this.Borders=new Asc.asc_CParagraphBorders(t.get_Borders()),this.Borders&&(e=null!=(i=this.Borders.get_Left())&&null!==i.get_Space()&&void 0!==i.get_Space()?Common.Utils.Metric.fnRecalcFromMM(i.get_Space()):"",this.spnMarginLeft.setValue(e,!0),e=null!=(i=this.Borders.get_Top())&&null!==i.get_Space()&&void 0!==i.get_Space()?Common.Utils.Metric.fnRecalcFromMM(i.get_Space()):"",this.spnMarginTop.setValue(e,!0),e=null!=(i=this.Borders.get_Right())&&null!==i.get_Space()&&void 0!==i.get_Space()?Common.Utils.Metric.fnRecalcFromMM(i.get_Space()):"",this.spnMarginRight.setValue(e,!0),e=null!=(i=this.Borders.get_Bottom())&&null!==i.get_Space()&&void 0!==i.get_Space()?Common.Utils.Metric.fnRecalcFromMM(i.get_Space()):"",this.spnMarginBottom.setValue(e,!0)),t.get_Shade());if(null!=i&&i.get_Value()===Asc.c_oAscShdClear&&(e=i.get_Color())?e.get_type()==Asc.c_oAscColor.COLOR_TYPE_SCHEME?this.paragraphShade={color:Common.Utils.ThemeColor.getHexColor(e.get_r(),e.get_g(),e.get_b()),effectValue:e.get_value()}:this.paragraphShade=Common.Utils.ThemeColor.getHexColor(e.get_r(),e.get_g(),e.get_b()):this.paragraphShade="transparent",this.btnBackColor.setColor(this.paragraphShade),"object"==typeof this.paragraphShade){for(var n=!1,o=0;o<10;o++)if(Common.Utils.ThemeColor.ThemeValues[o]==this.paragraphShade.effectValue){this.colorsBack.select(this.paragraphShade,!0),n=!0;break}n||this.colorsBack.clearSelection()}else this.colorsBack.select(this.paragraphShade,!0);this._UpdateBorders(),this._noApply=!0,this.chStrike.setValue(null!==t.get_Strikeout()&&void 0!==t.get_Strikeout()?t.get_Strikeout():"indeterminate",!0),this.chDoubleStrike.setValue(null!==t.get_DStrikeout()&&void 0!==t.get_DStrikeout()?t.get_DStrikeout():"indeterminate",!0),this.chSubscript.setValue(null!==t.get_Subscript()&&void 0!==t.get_Subscript()?t.get_Subscript():"indeterminate",!0),this.chSuperscript.setValue(null!==t.get_Superscript()&&void 0!==t.get_Superscript()?t.get_Superscript():"indeterminate",!0),this.chSmallCaps.setValue(null!==t.get_SmallCaps()&&void 0!==t.get_SmallCaps()?t.get_SmallCaps():"indeterminate",!0),this.chAllCaps.setValue(null!==t.get_AllCaps()&&void 0!==t.get_AllCaps()?t.get_AllCaps():"indeterminate",!0),this.numSpacing.setValue(null!==t.get_TextSpacing()&&void 0!==t.get_TextSpacing()?Common.Utils.Metric.fnRecalcFromMM(t.get_TextSpacing()):"",!0),this.numPosition.setValue(null!==t.get_Position()&&void 0!==t.get_Position()?Common.Utils.Metric.fnRecalcFromMM(t.get_Position()):"",!0),this.numDefaultTab.setValue(null!==t.get_DefaultTab()&&void 0!==t.get_DefaultTab()?Common.Utils.Metric.fnRecalcFromMM(parseFloat(t.get_DefaultTab().toFixed(1))):"",!0);var i=this.tabList.store,s=t.get_Tabs();if(s){for(var a=[],l=s.get_Count(),o=0;o<l;o++){var r=s.get_Tab(o),c=Common.Utils.Metric.fnRecalcFromMM(parseFloat(r.get_Pos().toFixed(1))),d=new Common.UI.DataViewModel;d.set({tabPos:c,value:parseFloat(c.toFixed(3))+" "+Common.Utils.Metric.getCurrentMetricName(),tabAlign:r.get_Value(),tabLeader:r.get_Leader(),displayTabLeader:this._arrKeyTabLeader[r.get_Leader()],displayTabAlign:this._arrKeyTabAlign[r.get_Value()]}),a.push(d)}i.reset(a,{silent:!1}),this.tabList.selectByIndex(0)}this.cmbOutlinelevel.setValue(void 0===t.get_OutlineLvl()||null===t.get_OutlineLvl()?-1:t.get_OutlineLvl()),this.cmbOutlinelevel.setDisabled(!!t.get_OutlineLvlStyle()),this.cmbLigatures.setValue(void 0===t.get_Ligatures()||null===t.get_Ligatures()?"":t.get_Ligatures()),this._noApply=!1,this._changedProps=new Asc.asc_CParagraphProperty,this.ChangedBorders=void 0}},updateMetricUnit:function(){if(this.spinners)for(var t=0;t<this.spinners.length;t++){var e=this.spinners[t];e.setDefaultUnit(Common.Utils.Metric.getCurrentMetricName()),"paragraphadv-spin-spacing"==e.el.id||"paragraphadv-spin-position"==e.el.id||"paragraphadv-spin-spacing-before"==e.el.id||"paragraphadv-spin-spacing-after"==e.el.id?e.setStep(Common.Utils.Metric.getCurrentMetric()==Common.Utils.Metric.c_MetricUnits.pt?1:.01):e.setStep(Common.Utils.Metric.getCurrentMetric()==Common.Utils.Metric.c_MetricUnits.pt?1:.1)}var i;this._arrLineRule[2].defaultUnit=this._arrLineRule[0].defaultUnit=Common.Utils.Metric.getCurrentMetricName(),this._arrLineRule[2].minValue=this._arrLineRule[0].minValue=parseFloat(Common.Utils.Metric.fnRecalcFromMM(.3).toFixed(2)),this._arrLineRule[2].step=this._arrLineRule[0].step=Common.Utils.Metric.getCurrentMetric()==Common.Utils.Metric.c_MetricUnits.pt?1:.01,null!==this.CurLineRuleIdx&&(i=this._arrLineRule[-1!==this.CurLineRuleIdx?this.CurLineRuleIdx:0],this.numLineHeight.setDefaultUnit(i.defaultUnit),this.numLineHeight.setStep(i.step))},updateThemeColors:function(){this.colorsBorder.updateColors(Common.Utils.ThemeColor.getEffectColors(),Common.Utils.ThemeColor.getStandartColors()),this.colorsBack.updateColors(Common.Utils.ThemeColor.getEffectColors(),Common.Utils.ThemeColor.getStandartColors())},afterRender:function(){this.updateMetricUnit(),this.updateThemeColors(),this._setDefaults(this._originalProps);var t="object"==typeof this.paragraphShade?this.paragraphShade.color:this.paragraphShade;this.BordersImage.setTableColor(t),"transparent"!=t&&this.BordersImage.redrawTable(),void 0!==this.borderProps&&(this.btnBorderColor.setColor(this.borderProps.borderColor),this.btnBorderColor.setAutoColor("auto"==this.borderProps.borderColor),this.BordersImage.setVirtualBorderColor(("object"==typeof this.btnBorderColor.color?this.btnBorderColor.color:this.btnBorderColor).color),"auto"==this.borderProps.borderColor?this.colorsBorder.clearSelection():this.colorsBorder.select(this.borderProps.borderColor,!0),this.cmbBorderSize.setValue(this.borderProps.borderSize.ptValue),(t=this.cmbBorderSize.getSelectedRecord())&&this.onBorderSizeSelect(this.cmbBorderSize,t)),this.BordersImage.on("borderclick:cellborder",function(t,e,i,n){void 0===this.ChangedBorders&&(this.ChangedBorders=new Asc.asc_CParagraphBorders),this._UpdateCellBordersStyle(t,e,i,n,this.Borders)},this),this.BordersImage.on("borderclick",function(t,e,i,n){void 0===this.ChangedBorders&&(this.ChangedBorders=new Asc.asc_CParagraphBorders),this._UpdateTableBordersStyle(t,e,i,n,this.Borders)},this),this.storageName&&(t=Common.localStorage.getItem(this.storageName),this.setActiveCategory(null!==t?parseInt(t):0))},onStrikeChange:function(t,e,i,n){var o;this._changedProps&&1!=this.checkGroup&&this._changedProps.put_Strikeout("checked"==t.getValue()),this.checkGroup=0,"checked"==t.getValue()&&(this.checkGroup=1,this.chDoubleStrike.setValue(0),this._changedProps&&this._changedProps.put_DStrikeout(!1),this.checkGroup=0),this.api&&!this._noApply&&((o=this._originalProps||new Asc.asc_CParagraphProperty).put_Strikeout("checked"==t.getValue()),o.put_DStrikeout("checked"==this.chDoubleStrike.getValue()),this.api.SetDrawImagePlaceParagraph("paragraphadv-font-img",o))},onDoubleStrikeChange:function(t,e,i,n){var o;this._changedProps&&1!=this.checkGroup&&this._changedProps.put_DStrikeout("checked"==t.getValue()),this.checkGroup=0,"checked"==t.getValue()&&(this.checkGroup=1,this.chStrike.setValue(0),this._changedProps&&this._changedProps.put_Strikeout(!1),this.checkGroup=0),this.api&&!this._noApply&&((o=this._originalProps||new Asc.asc_CParagraphProperty).put_DStrikeout("checked"==t.getValue()),o.put_Strikeout("checked"==this.chStrike.getValue()),this.api.SetDrawImagePlaceParagraph("paragraphadv-font-img",o))},onSuperscriptChange:function(t,e,i,n){var o;this._changedProps&&2!=this.checkGroup&&this._changedProps.put_Superscript("checked"==t.getValue()),this.checkGroup=0,"checked"==t.getValue()&&(this.checkGroup=2,this.chSubscript.setValue(0),this._changedProps&&this._changedProps.put_Subscript(!1),this.checkGroup=0),this.api&&!this._noApply&&((o=this._originalProps||new Asc.asc_CParagraphProperty).put_Superscript("checked"==t.getValue()),o.put_Subscript("checked"==this.chSubscript.getValue()),this.api.SetDrawImagePlaceParagraph("paragraphadv-font-img",o))},onSubscriptChange:function(t,e,i,n){var o;this._changedProps&&2!=this.checkGroup&&this._changedProps.put_Subscript("checked"==t.getValue()),this.checkGroup=0,"checked"==t.getValue()&&(this.checkGroup=2,this.chSuperscript.setValue(0),this._changedProps&&this._changedProps.put_Superscript(!1),this.checkGroup=0),this.api&&!this._noApply&&((o=this._originalProps||new Asc.asc_CParagraphProperty).put_Subscript("checked"==t.getValue()),o.put_Superscript("checked"==this.chSuperscript.getValue()),this.api.SetDrawImagePlaceParagraph("paragraphadv-font-img",o))},onSmallCapsChange:function(t,e,i,n){var o;this._changedProps&&3!=this.checkGroup&&this._changedProps.put_SmallCaps("checked"==t.getValue()),this.checkGroup=0,"checked"==t.getValue()&&(this.checkGroup=3,this.chAllCaps.setValue(0),this._changedProps&&this._changedProps.put_AllCaps(!1),this.checkGroup=0),this.api&&!this._noApply&&((o=this._originalProps||new Asc.asc_CParagraphProperty).put_SmallCaps("checked"==t.getValue()),o.put_AllCaps("checked"==this.chAllCaps.getValue()),this.api.SetDrawImagePlaceParagraph("paragraphadv-font-img",o))},onAllCapsChange:function(t,e,i,n){var o;this._changedProps&&3!=this.checkGroup&&this._changedProps.put_AllCaps("checked"==t.getValue()),this.checkGroup=0,"checked"==t.getValue()&&(this.checkGroup=3,this.chSmallCaps.setValue(0),this._changedProps&&this._changedProps.put_SmallCaps(!1),this.checkGroup=0),this.api&&!this._noApply&&((o=this._originalProps||new Asc.asc_CParagraphProperty).put_AllCaps("checked"==t.getValue()),o.put_SmallCaps("checked"==this.chSmallCaps.getValue()),this.api.SetDrawImagePlaceParagraph("paragraphadv-font-img",o))},onBorderSizeSelect:function(t,e){this.BorderSize={ptValue:e.value,pxValue:e.pxValue},this.BordersImage.setVirtualBorderSize(this.BorderSize.pxValue)},onColorsBorderSelect:function(t,e){this.BordersImage.setVirtualBorderColor("object"==typeof e?e.color:e)},onColorsBackSelect:function(t,e){this.paragraphShade=e,this._changedProps&&(void 0!==this._changedProps.get_Shade()&&null!==this._changedProps.get_Shade()||this._changedProps.put_Shade(new Asc.asc_CParagraphShd),"transparent"==this.paragraphShade?this._changedProps.get_Shade().put_Value(Asc.c_oAscShdNil):(this._changedProps.get_Shade().put_Value(Asc.c_oAscShdClear),this._changedProps.get_Shade().put_Color(Common.Utils.ThemeColor.getRgbColor(this.paragraphShade))));e="object"==typeof e?e.color:e;this.BordersImage.setTableColor(e),this.BordersImage.redrawTable()},_ApplyBorderPreset:function(t){t=t.options.strId;this.ChangedBorders=null,this.Borders.put_Left(this._UpdateBorderStyle(this.Borders.get_Left(),-1<t.indexOf("l"))),this.Borders.put_Top(this._UpdateBorderStyle(this.Borders.get_Top(),-1<t.indexOf("t"))),this.Borders.put_Right(this._UpdateBorderStyle(this.Borders.get_Right(),-1<t.indexOf("r"))),this.Borders.put_Bottom(this._UpdateBorderStyle(this.Borders.get_Bottom(),-1<t.indexOf("b"))),this.Borders.put_Between(this._UpdateBorderStyle(this.Borders.get_Between(),-1<t.indexOf("m"))),this._UpdateBorders()},_UpdateBorderStyle:function(t,e){var i;return null==t&&(t=new Asc.asc_CTextBorder),e&&0<this.BorderSize.ptValue?(e=parseFloat(this.BorderSize.ptValue),t.put_Value(1),t.put_Size(25.4*e/72),this.btnBorderColor.isAutoColor()?(i=new Asc.asc_CColor).put_auto(!0):i=Common.Utils.ThemeColor.getRgbColor(this.btnBorderColor.color),t.put_Color(i)):(t.put_Color(new Asc.asc_CColor),t.put_Value(0)),t},_UpdateCellBordersStyle:function(t,e,i,n,o){o.put_Between(this._UpdateBorderStyle(o.get_Between(),0<i)),this.ChangedBorders&&this.ChangedBorders.put_Between(new Asc.asc_CTextBorder(o.get_Between()))},_UpdateTableBordersStyle:function(t,e,i,n,o){-1<e.indexOf("l")&&(o.put_Left(this._UpdateBorderStyle(o.get_Left(),0<i)),this.ChangedBorders&&this.ChangedBorders.put_Left(new Asc.asc_CTextBorder(o.get_Left()))),-1<e.indexOf("t")&&(o.put_Top(this._UpdateBorderStyle(o.get_Top(),0<i)),this.ChangedBorders&&this.ChangedBorders.put_Top(new Asc.asc_CTextBorder(o.get_Top()))),-1<e.indexOf("r")&&(o.put_Right(this._UpdateBorderStyle(o.get_Right(),0<i)),this.ChangedBorders&&this.ChangedBorders.put_Right(new Asc.asc_CTextBorder(o.get_Right()))),-1<e.indexOf("b")&&(o.put_Bottom(this._UpdateBorderStyle(o.get_Bottom(),0<i)),this.ChangedBorders&&this.ChangedBorders.put_Bottom(new Asc.asc_CTextBorder(o.get_Bottom())))},_UpdateBorders:function(){var t=this.BorderSize,e=this.btnBorderColor.color;if(this._UpdateBorder(this.Borders.get_Left(),"l"),this._UpdateBorder(this.Borders.get_Top(),"t"),this._UpdateBorder(this.Borders.get_Right(),"r"),this._UpdateBorder(this.Borders.get_Bottom(),"b"),null!==this.Borders.get_Between())for(var i=0;i<this.BordersImage.rows-1;i++)this._UpdateCellBorder(this.Borders.get_Between(),this.BordersImage.getCellBorder(i,-1));this.BordersImage.setVirtualBorderSize(t.pxValue),this.BordersImage.setVirtualBorderColor("object"==typeof e?e.color:e),this.BordersImage.redrawTable()},_UpdateCellBorder:function(t,e){null!=t&&null!==t.get_Value()&&null!==t.get_Size()&&null!==t.get_Color()&&1==t.get_Value()?(e.setBordersSize(this._BorderPt2Px(72*t.get_Size()/25.4)),e.setBordersColor(new Common.Utils.RGBColor("rgb("+t.get_Color().get_r()+","+t.get_Color().get_g()+","+t.get_Color().get_b()+")"))):e.setBordersSize(0)},_UpdateBorder:function(t,e){null!=t&&null!==t.get_Value()&&null!==t.get_Size()&&null!==t.get_Color()&&1==t.get_Value()?(this.BordersImage.setBordersSize(e,this._BorderPt2Px(72*t.get_Size()/25.4)),this.BordersImage.setBordersColor(e,"rgb("+t.get_Color().get_r()+","+t.get_Color().get_g()+","+t.get_Color().get_b()+")")):this.BordersImage.setBordersSize(e,0)},_BorderPt2Px:function(t){return 0==t?0:t<.6?.5:t<=1?1:t<=1.5?2:t<=2.25?3:t<=3?4:t<=4.5?6:8},addTab:function(t,e){var i=this.numTab.getNumberValue(),n=this.cmbAlign.getValue(),o=this.cmbLeader.getValue(),s=this._arrKeyTabAlign[n],a=this._arrKeyTabLeader[o],l=this.tabList.store,r=l.find(function(t){return Math.abs(t.get("tabPos")-i)<.001});r?(r.set("tabAlign",n),r.set("tabLeader",o),r.set("displayTabAlign",s),r.set("displayTabLeader",a),this._tabListChanged=!0):((r=new Common.UI.DataViewModel).set({tabPos:i,value:i+" "+Common.Utils.Metric.getCurrentMetricName(),tabAlign:n,tabLeader:o,displayTabLeader:a,displayTabAlign:s}),l.add(r)),this.tabList.selectRecord(r),this.tabList.scrollToRecord(r)},removeTab:function(t,e){var i,n,o=this.tabList.getSelectedRec();o&&(i=this.tabList.store,n=_.indexOf(i.models,o),i.remove(o),n>i.length-1&&(n=i.length-1),0<i.length&&(this.tabList.selectByIndex(n),this.tabList.scrollToRecord(i.at(n))))},removeAllTabs:function(t,e){this.tabList.store.reset()},onSelectTab:function(t,e,i){if(i){var n={};if(_.isFunction(i.toJSON)){if(!i.get("selected"))return;n=i.toJSON()}else n=i;this.numTab.setValue(n.tabPos),this.cmbAlign.setValue(n.tabAlign),this.cmbLeader.setValue(n.tabLeader)}},hideTextOnlySettings:function(t){this.TextOnlySettings.toggleClass("hidden",1==t),this.btnsCategory[1].setVisible(!t),this.btnsCategory[2].setVisible(!t),this.btnsCategory[5].setVisible(!t)},onLineRuleSelect:function(t,e){var i;null===this.Spacing&&(i=this._originalProps||new Asc.asc_CParagraphProperty,this.Spacing=i.get_Spacing()),this.Spacing.put_LineRule(e.value),this.CurLineRuleIdx!==this.Spacing.get_LineRule()&&(this.numLineHeight.setDefaultUnit(this._arrLineRule[e.value].defaultUnit),this.numLineHeight.setMinValue(this._arrLineRule[e.value].minValue),this.numLineHeight.setStep(this._arrLineRule[e.value].step),i=this.numLineHeight.getNumberValue(),this.Spacing.get_LineRule()===c_paragraphLinerule.LINERULE_AUTO?this.numLineHeight.setValue(this._arrLineRule[e.value].defaultValue):this.CurLineRuleIdx===c_paragraphLinerule.LINERULE_AUTO?this.numLineHeight.setValue(Common.Utils.Metric.fnRecalcFromMM(this._arrLineRule[e.value].defaultValue)):this.numLineHeight.setValue(i),this.CurLineRuleIdx=e.value)},onNumLineHeightChange:function(t,e,i,n){var o;""!==this.cmbLineRule.getRawValue()&&(null===this.Spacing&&(o=this._originalProps||new Asc.asc_CParagraphProperty,this.Spacing=o.get_Spacing()),this.Spacing.put_Line(this.cmbLineRule.getValue()==c_paragraphLinerule.LINERULE_AUTO?t.getNumberValue():Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())))},onSpecialSelect:function(t,e){var i;this.CurSpecial=e.value,this.CurSpecial===c_paragraphSpecial.NONE_SPECIAL&&this.numSpecialBy.setValue(0,!0),this._changedProps&&(null!==this._changedProps.get_Ind()&&void 0!==this._changedProps.get_Ind()||this._changedProps.put_Ind(new Asc.asc_CParagraphInd),0===(i=Common.Utils.Metric.fnRecalcToMM(this.numSpecialBy.getNumberValue()))&&(this.numSpecialBy.setValue(Common.Utils.Metric.fnRecalcFromMM(this._arrSpecial[e.value].defaultValue),!0),i=this._arrSpecial[e.value].defaultValue),this.CurSpecial===c_paragraphSpecial.HANGING&&(i=-i),this._changedProps.get_Ind().put_FirstLine(i))},onFirstLineChange:function(t,e,i,n){this._changedProps&&(null!==this._changedProps.get_Ind()&&void 0!==this._changedProps.get_Ind()||this._changedProps.put_Ind(new Asc.asc_CParagraphInd),t=Common.Utils.Metric.fnRecalcToMM(t.getNumberValue()),this.CurSpecial===c_paragraphSpecial.NONE_SPECIAL&&0<t?(this.CurSpecial=c_paragraphSpecial.FIRST_LINE,this.cmbSpecial.setValue(c_paragraphSpecial.FIRST_LINE)):0===t?(this.CurSpecial=c_paragraphSpecial.NONE_SPECIAL,this.cmbSpecial.setValue(c_paragraphSpecial.NONE_SPECIAL)):this.CurSpecial===c_paragraphSpecial.HANGING&&(t=-t),this._changedProps.get_Ind().put_FirstLine(t))},onOutlinelevelSelect:function(t,e){this._changedProps&&this._changedProps.put_OutlineLvl(-1<e.value?e.value:null)},onLigaturesSelect:function(t,e){this._changedProps&&this._changedProps.put_Ligatures(e.value)}},DE.Views.ParagraphSettingsAdvanced||{}))}),define("text!documenteditor/main/app/template/TableSettingsAdvanced.template",[],function(){return'<div id="id-adv-table-width" class="settings-panel active">\n    <div class="inner-content">\n        <table cols="3">\n            <tr>\n                <td colspan="3" class="padding-small">\n                    <label class="header"><%= scope.textTableSize %></label>\n                </td>\n            </tr>\n            <tr>\n                <td style="vertical-align: bottom; padding-bottom: 11px;">\n                    <div id="tableadv-checkbox-width"></div>\n                </td>\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textWidth %></label>\n                    <div id="tableadv-number-width" class="margin-right-10"></div>\n                </td>\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textMeasure %></label>\n                    <div id="tableadv-cmb-unit" style="width: 115px;"></div>\n                </td>\n            </tr>\n            <tr>\n                <td colspan="3" class="padding-large">\n                    <div id="tableadv-checkbox-autofit"></div>\n                </td>\n            </tr>\n        </table>\n        <div class="padding-small"></div>\n        <table cols="2" style="width: 100%;">\n            <tr>\n                <td colspan=2 class="padding-small">\n                    <label class="header"><%= scope.textDefaultMargins %></label>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small" width="125px">\n                    <label class="input-label"><%= scope.textTop %></label>\n                    <div id="tableadv-number-margin-table-top"></div>\n                </td>\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textLeft %></label>\n                    <div id="tableadv-number-margin-table-left"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-large">\n                    <label class="input-label"><%= scope.textBottom %></label>\n                    <div id="tableadv-number-margin-table-bottom"></div>\n                </td>\n                <td class="padding-large">\n                    <label class="input-label"><%= scope.textRight %></label>\n                    <div id="tableadv-number-margin-table-right"></div>\n                </td>\n            </tr>\n        </table>\n        <div class="padding-small"></div>\n        <table cols="2">\n            <tr>\n                <td colspan="2" class="padding-small">\n                    <label class="header"><%= scope.textOptions %></label>\n                </td>\n            </tr>\n            <tr>\n                <td style="vertical-align: bottom; padding-bottom: 19px;">\n                    <div id="tableadv-checkbox-spacing"></div>\n                </td>\n                <td class="padding-large">\n                    <label class="input-label"><%= scope.textAllowSpacing %></label>\n                    <div id="tableadv-number-spacing"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n    <div class="inner-content">\n    </div>\n</div>\n<div id="id-adv-table-cell-props" class="settings-panel">\n    <div class="inner-content">\n        <table cols="3">\n            <tr>\n                <td colspan="3" class="padding-small">\n                    <label class="header"><%= scope.textCellSize %></label>\n                </td>\n            </tr>\n            <tr>\n                <td style="vertical-align: bottom; padding-bottom: 19px;">\n                    <div id="tableadv-checkbox-prefwidth"></div>\n                </td>\n                <td class="padding-large">\n                    <label class="input-label"><%= scope.textPrefWidth %></label>\n                    <div id="tableadv-number-prefwidth" class="margin-right-10"></div>\n                </td>\n                <td class="padding-large">\n                    <label class="input-label"><%= scope.textMeasure %></label>\n                    <div id="tableadv-combo-prefwidth-unit" style="width: 115px;"></div>\n                </td>\n            </tr>\n        </table>\n        <div class="padding-small"></div>\n        <table cols="2" style="width: 100%;">\n            <tr>\n                <td colspan=2 class="padding-small">\n                    <label class="header"><%= scope.textMargins %></label>\n                </td>\n            </tr>\n            <tr>\n                <td colspan="2" class="padding-small">\n                    <div id="tableadv-checkbox-margins"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small" width="125px">\n                    <label class="input-label"><%= scope.textTop %></label>\n                    <div id="tableadv-number-margin-top"></div>\n                </td>\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textLeft %></label>\n                    <div id="tableadv-number-margin-left"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-large">\n                    <label class="input-label"><%= scope.textBottom %></label>\n                    <div id="tableadv-number-margin-bottom"></div>\n                </td>\n                <td class="padding-large">\n                    <label class="input-label"><%= scope.textRight %></label>\n                    <div id="tableadv-number-margin-right"></div>\n                </td>\n            </tr>\n            <tr>\n                <td colspan="2" class="padding-small"></td>\n            </tr>\n            <tr>\n                <td colspan=2 class="padding-small">\n                    <label class="header"><%= scope.textCellOptions %></label>\n                </td>\n            </tr>\n            <tr>\n                <td colspan="2" class="padding-small">\n                    <div id="tableadv-checkbox-wrap"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-adv-table-wrap" class="settings-panel">\n    <div class="inner-content padding-large">\n        <label class="header padding-small" style="display: block;"><%= scope.textWrappingStyle %></label>\n        <div id="tableadv-button-wrap-none" class="margin-right-5" style="display: inline-block;"></div>\n        <div id="tableadv-button-wrap-parallel" class="margin-right-5" style="display: inline-block;"></div>\n    </div>\n    <div class="padding-small"></div>\n    <div class="inner-content">\n        <div id="tableadv-panel-align" style="width: 100%;">\n            <label class="header padding-small"><%= scope.textAlign %></label>\n            <div class="padding-large">\n                <div id="tableadv-button-align-left" class="margin-right-5" style="display: inline-block;"></div>\n                <div id="tableadv-button-align-center" class="margin-right-5" style="display: inline-block;"></div>\n                <div id="tableadv-button-align-right" class="margin-right-5" style="display: inline-block;"></div>\n                <div class="margin-left-20" style="display: inline-block; vertical-align: bottom; margin-bottom: 1px;">\n                    <label class="input-label" style="display: block;"><%= scope.textIndLeft %></label>\n                    <div id="tableadv-number-indent"></div>\n                </div>\n            </div>\n        </div>\n        <div id="tableadv-panel-distance" class="settings-hidden" style="width: 100%;">\n            <table cols="2" style="width: 100%;">\n                <tr>\n                    <td colspan=2 class="padding-small">\n                        <label class="header"><%= scope.textDistance %></label>\n                    </td>\n                </tr>\n                <tr>\n                    <td class="padding-small" width="125px">\n                        <label class="input-label"><%= scope.textTop %></label>\n                        <div id="tableadv-number-distance-top"></div>\n                    </td>\n                    <td class="padding-small">\n                        <label class="input-label"><%= scope.textLeft %></label>\n                        <div id="tableadv-number-distance-left"></div>\n                    </td>\n                </tr>\n                <tr>\n                    <td class="padding-small">\n                        <label class="input-label"><%= scope.textBottom %></label>\n                        <div id="tableadv-number-distance-bottom"></div>\n                    </td>\n                    <td class="padding-small">\n                        <label class="input-label"><%= scope.textRight %></label>\n                        <div id="tableadv-number-distance-right"></div>\n                    </td>\n                </tr>\n            </table>\n        </div>\n    </div>\n</div>\n<div id="id-adv-table-borders" class="settings-panel">\n    <div class="inner-content padding-large">\n        <div class="settings-wrap">\n            <label class="input-label"><%= scope.textBorderWidth %></label>\n            <div id="tableadv-combo-border-size" class="margin-left-3"></div>\n            <div class="border-color">\n                <label class="input-label" ><%= scope.textBorderColor %></label>\n                <div id="tableadv-border-color-btn" class="margin-left-3"></div>\n            </div>\n        </div>\n    </div>\n    <div class="inner-content">\n        <label class="input-label padding-large" style="width: 100%;"><%= scope.textBorderDesc %></label>\n        <div id="tableadv-panel-borders" style="width: 100%;" class="padding-large">\n            <div id="id-detablestyler" style="display: inline-block; vertical-align: middle; width: 200px; height: 200px;outline: 1px solid #ccc;"></div>\n            <div class="border-types" style="display: inline-block; vertical-align: middle; width: 76px; height: 200px; padding-top: 10px;">\n                <div id="tableadv-button-border-all"></div>\n                <div id="tableadv-button-border-none"></div>\n                <div id="tableadv-button-border-inner"></div>\n                <div id="tableadv-button-border-outer"></div>\n            </div>\n        </div>\n        <div id="tableadv-panel-borders-spacing" style="width: 100%;" class="padding-large settings-hidden">\n            <div id="id-detablestyler-spacing" style="display: inline-block; vertical-align: middle; width: 200px; height: 200px;outline: 1px solid #ccc;"></div>\n            <div style="display: inline-block; vertical-align: middle; width: 76px; height: 200px; padding-top: 10px;" class="float-right">\n                <div id="tableadv-button-border-all-none" style="display: inline-block;"></div>\n                <div id="tableadv-button-border-all-table" style="display: inline-block;"></div>\n                <div id="tableadv-button-border-none-none" style="display: inline-block;"></div>\n                <div id="tableadv-button-border-none-table" style="display: inline-block;"></div>\n                <div id="tableadv-button-border-inner-none" style="display: inline-block;"></div>\n                <div id="tableadv-button-border-inner-table" style="display: inline-block;"></div>\n                <div id="tableadv-button-border-outer-none" style="display: inline-block;"></div>\n                <div id="tableadv-button-border-outer-table" style="display: inline-block;"></div>\n            </div>\n        </div>\n        <div style="width: 100%;">\n            <div id="tableadv-panel-table-back">\n                <label class="input-label margin-right-5"><%= scope.textTableBackColor %></label>\n                <div id="tableadv-button-table-back-color"></div>\n            </div>\n            <div id="tableadv-panel-cell-back">\n                <label class="input-label margin-right-5"><%= scope.textBackColor %></label>\n                <div id="tableadv-button-back-color"></div>\n            </div>\n        </div>\n    </div>\n</div>\n<div id="id-adv-table-position" class="settings-panel">\n    <div class="inner-content">\n        <table cols="3" style="width: 100%;">\n            <tr>\n                <td colspan="3" class="padding-small">\n                    <label class="header"><%= scope.textHorizontal %></label>\n                </td>\n            </tr>\n            <tr>\n                <td style="vertical-align: bottom; padding-bottom: 12px;">\n                    <div id="tableadv-radio-halign"></div>\n                </td>\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textAlignment %></label>\n                    <div id="tableadv-combo-halign" style="width: 115px;"></div>\n                </td>\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textRelative %></label>\n                    <div id="tableadv-combo-hrelative" style="width: 115px;"></div>\n                </td>\n            </tr>\n            <tr>\n                <td style="vertical-align: bottom; padding-bottom: 12px;">\n                    <div id="tableadv-radio-hposition"></div>\n                </td>\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textPosition %></label>\n                    <div id="tableadv-spin-x"></div>\n                </td>\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textRightOf %></label>\n                    <div id="tableadv-combo-hposition" style="width: 115px;"></div>\n                </td>\n            </tr>\n            <tr>\n                <td colspan="3" class="padding-small">\n                    <label class="header"><%= scope.textVertical %></label>\n                </td>\n            </tr>\n            <tr>\n                <td style="vertical-align: bottom; padding-bottom: 12px;">\n                    <div id="tableadv-radio-valign"></div>\n                </td>\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textAlignment %></label>\n                    <div id="tableadv-combo-valign" style="width: 115px;"></div>\n                </td>\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textRelative %></label>\n                    <div id="tableadv-combo-vrelative" style="width: 115px;"></div>\n                </td>\n            </tr>\n            <tr>\n                <td style="vertical-align: bottom; padding-bottom: 19px;">\n                    <div id="tableadv-radio-vposition"></div>\n                </td>\n                <td class="padding-large">\n                    <label class="input-label"><%= scope.textPosition %></label>\n                    <div id="tableadv-spin-y"></div>\n                </td>\n                <td class="padding-large">\n                    <label class="input-label"><%= scope.textBelow %></label>\n                    <div id="tableadv-combo-vposition" style="width: 115px;"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n    <div class="separator horizontal padding-large"></div>\n    <div class="inner-content">\n        <table cols="2" style="width: 100%;">\n            <tr>\n                <td colspan="2" class="padding-small">\n                    <label class="header"><%= scope.textOptions %></label>\n                </td>\n            </tr>\n            <tr>\n                <td>\n                    <div id="tableadv-checkbox-move"></div>\n                </td>\n                <td>\n                    <div id="tableadv-checkbox-overlap"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-adv-table-alttext" class="settings-panel">\n    <div class="inner-content">\n        <table cols="1" width="100%">\n            <tr>\n                <td class="padding-large">\n                    <label class="header"><%= scope.textAltTitle %></label>\n                    <div id="table-advanced-alt-title"></div>\n                </td>\n            </tr>\n            <tr>\n                <td>\n                    <label class="header"><%= scope.textAltDescription %></label>\n                    <textarea id="table-advanced-alt-description" class="form-control" style="width: 100%; height: 120px;"></textarea>\n                </td>\n            </tr>\n            <tr>\n                <td>\n                    <label><%= scope.textAltTip %></label>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>'}),define("documenteditor/main/app/view/TableSettingsAdvanced",["text!documenteditor/main/app/template/TableSettingsAdvanced.template","common/main/lib/view/AdvancedSettingsWindow","common/main/lib/component/ComboBox","common/main/lib/component/MetricSpinner","common/main/lib/component/CheckBox","common/main/lib/component/RadioBox","common/main/lib/component/ThemeColorPalette","common/main/lib/component/ColorButton","common/main/lib/component/ListView","common/main/lib/component/TableStyler"],function(e){"use strict";DE.Views.TableSettingsAdvanced=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:340,height:436,toggleGroup:"table-adv-settings-group",storageName:"de-table-settings-adv-category"},initialize:function(t){_.extend(this.options,{title:this.textTitle,items:[{panelId:"id-adv-table-width",panelCaption:this.textTable},{panelId:"id-adv-table-cell-props",panelCaption:this.textCellProps},{panelId:"id-adv-table-borders",panelCaption:this.textBordersBackgroung},{panelId:"id-adv-table-position",panelCaption:this.textTablePosition},{panelId:"id-adv-table-wrap",panelCaption:this.textWrap},{panelId:"id-adv-table-alttext",panelCaption:this.textAlt}],contentTemplate:_.template(e)({scope:this})},t),Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options),this.spinners=[],this._changedProps=null,this._cellBackground=null,this._state={HAlignType:Asc.c_oAscXAlign.Left,HAlignFrom:Asc.c_oAscHAnchor.Margin,HPositionFrom:Asc.c_oAscHAnchor.Margin,VAlignType:Asc.c_oAscYAlign.Top,VAlignFrom:Asc.c_oAscVAnchor.Margin,VPositionFrom:Asc.c_oAscVAnchor.Margin,spnXChanged:!1,spnYChanged:!1,fromWrapInline:!1,verticalPropChanged:!1,horizontalPropChanged:!1,alignChanged:!1},this._allTable=!1,this.TableMargins={Left:.19,Right:.19,Top:0,Bottom:0},this.CellMargins={Left:.19,Right:.19,Top:null,Bottom:null,Flag:0},this.TableBorders={},this.CellBorders={},this.ChangedTableBorders=void 0,this.ChangedCellBorders=void 0,this.BorderSize={ptValue:0,pxValue:0},this.TableColor={Value:1,Color:"transparent"},this.CellColor={Value:1,Color:"transparent"},this.IndeterminateColor="#C8C8C8",this.IndeterminateSize=4.5,this.tableStylerRows=this.options.tableStylerRows,this.tableStylerColumns=this.options.tableStylerColumns,this.borderProps=this.options.borderProps,this.pageWidth=210,this._originalProps=new Asc.CTableProp(this.options.tableProps)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);function o(){"indeterminate"==e.CellMargins.Flag?e._changedProps.get_CellMargins().put_Flag(1):"checked"==e.CellMargins.Flag?e._changedProps.get_CellMargins().put_Flag(0):e._changedProps.get_CellMargins().put_Flag(2)}var e=this,t=(this._marginsChange=function(t,e,i,n,o,s){"table"==o?this.TableMargins[s]=t.getNumberValue():this.CellMargins[s]=t.getNumberValue()},this.chWidth=new Common.UI.CheckBox({el:$("#tableadv-checkbox-width"),value:!0,labelText:""}),this.chWidth.on("change",_.bind(function(t,e,i,n){e="checked"==e;this.nfWidth.setDisabled(!e),this.cmbUnit.setDisabled(!e),this._changedProps&&(e&&0<this.nfWidth.getNumberValue()?this._changedProps.put_Width(this.cmbUnit.getValue()?-this.nfWidth.getNumberValue():Common.Utils.Metric.fnRecalcToMM(this.nfWidth.getNumberValue())):this._changedProps.put_Width(null))},this)),this.nfWidth=new Common.UI.MetricSpinner({el:$("#tableadv-number-width"),step:.1,width:115,defaultUnit:"cm",value:"10 cm",maxValue:55.88,minValue:0}),this.nfWidth.on("change",_.bind(function(t,e,i,n){this._changedProps&&this._changedProps.put_Width(this.cmbUnit.getValue()?-t.getNumberValue():Common.Utils.Metric.fnRecalcToMM(t.getNumberValue()))},this)),Common.Utils.Metric.getCurrentMetric()),t=(this.cmbUnit=new Common.UI.ComboBox({el:$("#tableadv-cmb-unit"),style:"width: 115px;",menuStyle:"min-width: 115px;",editable:!1,cls:"input-group-nr",data:[{value:0,displayValue:t==Common.Utils.Metric.c_MetricUnits.pt?this.txtPt:t==Common.Utils.Metric.c_MetricUnits.inch?this.txtInch:this.txtCm},{value:1,displayValue:this.txtPercent}],takeFocusOnClose:!0}),this.cmbUnit.on("selected",_.bind(function(t,e){var i;this._changedProps&&(i=Common.Utils.Metric.fnRecalcFromMM(558),this.nfWidth.setDefaultUnit(e.value?"%":Common.Utils.Metric.getCurrentMetricName()),this.nfWidth.setMaxValue(e.value?parseFloat((100*i/this.pageWidth).toFixed(2)):i),this.nfWidth.setStep(e.value||Common.Utils.Metric.getCurrentMetric()==Common.Utils.Metric.c_MetricUnits.pt?1:.1),this.nfWidth.setValue(e.value?100*this.nfWidth.getNumberValue()/this.pageWidth:this.pageWidth*this.nfWidth.getNumberValue()/100),this._changedProps.put_Width(e.value?-this.nfWidth.getNumberValue():Common.Utils.Metric.fnRecalcToMM(this.nfWidth.getNumberValue())))},this)),this.chAllowSpacing=new Common.UI.CheckBox({el:$("#tableadv-checkbox-spacing"),value:!0,labelText:""}),this.chAllowSpacing.on("change",_.bind(function(t,e,i,n){e="checked"==e;this._changedProps&&(this.nfSpacing.setDisabled(!e),this.ShowHideSpacing(e),this._changedProps&&(e&&0<this.nfSpacing.getNumberValue()?this._changedProps.put_Spacing(Common.Utils.Metric.fnRecalcToMM(this.nfSpacing.getNumberValue())):this._changedProps.put_Spacing(null)))},this)),this.nfSpacing=new Common.UI.MetricSpinner({el:$("#tableadv-number-spacing"),step:.1,width:115,defaultUnit:"cm",value:"0.5 cm",maxValue:2.14,minValue:0}),this.nfSpacing.on("change",_.bind(function(t,e,i,n){this._changedProps&&this._changedProps.put_Spacing(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue()))},this)),this.spinners.push(this.nfSpacing),this.chAutofit=new Common.UI.CheckBox({el:$("#tableadv-checkbox-autofit"),value:!0,labelText:this.textAutofit}),this.chAutofit.on("change",_.bind(function(t,e,i,n){this._changedProps&&this._changedProps.put_TableLayout("checked"==t.getValue()?Asc.c_oAscTableLayout.AutoFit:Asc.c_oAscTableLayout.Fixed)},this)),this.spnTableMarginTop=new Common.UI.MetricSpinner({el:$("#tableadv-number-margin-table-top"),step:.1,width:85,defaultUnit:"cm",value:"0 cm",maxValue:55.87,minValue:0}),this.spnTableMarginTop.on("change",_.bind(function(t,e,i,n){this._marginsChange(t,e,i,n,"table","Top"),this._changedProps&&(void 0===this._changedProps.get_DefaultMargins()&&this._changedProps.put_DefaultMargins(new Asc.asc_CPaddings),this._changedProps.get_DefaultMargins().put_Top(null!==this.TableMargins.Top?Common.Utils.Metric.fnRecalcToMM(this.TableMargins.Top):null),this.TableMargins.isChanged=!0)},this)),this.spinners.push(this.spnTableMarginTop),this.spnTableMarginBottom=new Common.UI.MetricSpinner({el:$("#tableadv-number-margin-table-bottom"),step:.1,width:85,defaultUnit:"cm",value:"0 cm",maxValue:55.87,minValue:0}),this.spnTableMarginBottom.on("change",_.bind(function(t,e,i,n){this._marginsChange(t,e,i,n,"table","Bottom"),this._changedProps&&(void 0===this._changedProps.get_DefaultMargins()&&this._changedProps.put_DefaultMargins(new Asc.asc_CPaddings),this._changedProps.get_DefaultMargins().put_Bottom(null!==this.TableMargins.Bottom?Common.Utils.Metric.fnRecalcToMM(this.TableMargins.Bottom):null),this.TableMargins.isChanged=!0)},this)),this.spinners.push(this.spnTableMarginBottom),this.spnTableMarginLeft=new Common.UI.MetricSpinner({el:$("#tableadv-number-margin-table-left"),step:.1,width:85,defaultUnit:"cm",value:"0.19 cm",maxValue:9.34,minValue:0}),this.spnTableMarginLeft.on("change",_.bind(function(t,e,i,n){this._marginsChange(t,e,i,n,"table","Left"),this._changedProps&&(void 0===this._changedProps.get_DefaultMargins()&&this._changedProps.put_DefaultMargins(new Asc.asc_CPaddings),this._changedProps.get_DefaultMargins().put_Left(null!==this.TableMargins.Left?Common.Utils.Metric.fnRecalcToMM(this.TableMargins.Left):null),this.TableMargins.isChanged=!0)},this)),this.spinners.push(this.spnTableMarginLeft),this.spnTableMarginRight=new Common.UI.MetricSpinner({el:$("#tableadv-number-margin-table-right"),step:.1,width:85,defaultUnit:"cm",value:"0.19 cm",maxValue:9.34,minValue:0}),this.spnTableMarginRight.on("change",_.bind(function(t,e,i,n){this._marginsChange(t,e,i,n,"table","Right"),this._changedProps&&(void 0===this._changedProps.get_DefaultMargins()&&this._changedProps.put_DefaultMargins(new Asc.asc_CPaddings),this._changedProps.get_DefaultMargins().put_Right(null!==this.TableMargins.Right?Common.Utils.Metric.fnRecalcToMM(this.TableMargins.Right):null),this.TableMargins.isChanged=!0)},this)),this.spinners.push(this.spnTableMarginRight),this.chCellMargins=new Common.UI.CheckBox({el:$("#tableadv-checkbox-margins"),value:!0,labelText:this.textCheckMargins}),this.chCellMargins.on("change",_.bind(function(t,e,i,n){"checked"==i&&this._originalProps&&1==this._originalProps.get_CellMargins().get_Flag()&&t.setValue("indeterminate",!0),this.fillMargins.call(this,t.getValue()),this.CellMargins.Flag=t.getValue(),this._changedProps&&(void 0===this._changedProps.get_CellMargins()&&this._changedProps.put_CellMargins(new Asc.CMargins),this._changedProps.get_CellMargins().put_Left(null!==this.CellMargins.Left?Common.Utils.Metric.fnRecalcToMM(this.CellMargins.Left):null),this._changedProps.get_CellMargins().put_Top(null!==this.CellMargins.Top?Common.Utils.Metric.fnRecalcToMM(this.CellMargins.Top):null),this._changedProps.get_CellMargins().put_Bottom(null!==this.CellMargins.Bottom?Common.Utils.Metric.fnRecalcToMM(this.CellMargins.Bottom):null),this._changedProps.get_CellMargins().put_Right(null!==this.CellMargins.Right?Common.Utils.Metric.fnRecalcToMM(this.CellMargins.Right):null),o())},this)),this.spnMarginTop=new Common.UI.MetricSpinner({el:$("#tableadv-number-margin-top"),step:.1,width:85,defaultUnit:"cm",value:"0 cm",maxValue:55.87,minValue:0}),this.spnMarginTop.on("change",_.bind(function(t,e,i,n){this._marginsChange(t,e,i,n,"cell","Top"),this._changedProps&&(void 0===this._changedProps.get_CellMargins()&&this._changedProps.put_CellMargins(new Asc.CMargins),this._changedProps.get_CellMargins().put_Top(null!==this.CellMargins.Top?Common.Utils.Metric.fnRecalcToMM(this.CellMargins.Top):null),o())},this)),this.spinners.push(this.spnMarginTop),this.spnMarginBottom=new Common.UI.MetricSpinner({el:$("#tableadv-number-margin-bottom"),step:.1,width:85,defaultUnit:"cm",value:"0 cm",maxValue:55.87,minValue:0}),this.spnMarginBottom.on("change",_.bind(function(t,e,i,n){this._marginsChange(t,e,i,n,"cell","Bottom"),this._changedProps&&(void 0===this._changedProps.get_CellMargins()&&this._changedProps.put_CellMargins(new Asc.CMargins),this._changedProps.get_CellMargins().put_Bottom(null!==this.CellMargins.Bottom?Common.Utils.Metric.fnRecalcToMM(this.CellMargins.Bottom):null),o())},this)),this.spinners.push(this.spnMarginBottom),this.spnMarginLeft=new Common.UI.MetricSpinner({el:$("#tableadv-number-margin-left"),step:.1,width:85,defaultUnit:"cm",value:"0.19 cm",maxValue:9.34,minValue:0}),this.spnMarginLeft.on("change",_.bind(function(t,e,i,n){this._marginsChange(t,e,i,n,"cell","Left"),this._changedProps&&(void 0===this._changedProps.get_CellMargins()&&this._changedProps.put_CellMargins(new Asc.CMargins),this._changedProps.get_CellMargins().put_Left(null!==this.CellMargins.Left?Common.Utils.Metric.fnRecalcToMM(this.CellMargins.Left):null),o())},this)),this.spinners.push(this.spnMarginLeft),this.spnMarginRight=new Common.UI.MetricSpinner({el:$("#tableadv-number-margin-right"),step:.1,width:85,defaultUnit:"cm",value:"0.19 cm",maxValue:9.34,minValue:0}),this.spnMarginRight.on("change",_.bind(function(t,e,i,n){this._marginsChange(t,e,i,n,"cell","Right"),this._changedProps&&(void 0===this._changedProps.get_CellMargins()&&this._changedProps.put_CellMargins(new Asc.CMargins),this._changedProps.get_CellMargins().put_Right(null!==this.CellMargins.Right?Common.Utils.Metric.fnRecalcToMM(this.CellMargins.Right):null),o())},this)),this.spinners.push(this.spnMarginRight),this.chPrefWidth=new Common.UI.CheckBox({el:$("#tableadv-checkbox-prefwidth"),value:!1,labelText:""}),this.chPrefWidth.on("change",_.bind(function(t,e,i,n){e="checked"==e;this.nfPrefWidth.setDisabled(!e),this.cmbPrefWidthUnit.setDisabled(!e),this._changedProps&&(e&&0<this.nfPrefWidth.getNumberValue()?this._changedProps.put_CellsWidth(this.cmbPrefWidthUnit.getValue()?-this.nfPrefWidth.getNumberValue():Common.Utils.Metric.fnRecalcToMM(this.nfPrefWidth.getNumberValue())):this._changedProps.put_CellsWidth(null))},this)),this.nfPrefWidth=new Common.UI.MetricSpinner({el:$("#tableadv-number-prefwidth"),step:.1,width:115,defaultUnit:"cm",value:"10 cm",maxValue:55.88,minValue:0}),this.nfPrefWidth.on("change",_.bind(function(t,e,i,n){this._changedProps&&this._changedProps.put_CellsWidth(this.cmbPrefWidthUnit.getValue()?-t.getNumberValue():Common.Utils.Metric.fnRecalcToMM(t.getNumberValue()))},this)),this.cmbPrefWidthUnit=new Common.UI.ComboBox({el:$("#tableadv-combo-prefwidth-unit"),style:"width: 115px;",menuStyle:"min-width: 115px;",editable:!1,cls:"input-group-nr",data:[{value:0,displayValue:t==Common.Utils.Metric.c_MetricUnits.pt?this.txtPt:t==Common.Utils.Metric.c_MetricUnits.inch?this.txtInch:this.txtCm},{value:1,displayValue:this.txtPercent}],takeFocusOnClose:!0}),this.cmbPrefWidthUnit.on("selected",_.bind(function(t,e){var i,n;this._changedProps&&(i=e.value?"%":Common.Utils.Metric.getCurrentMetricName(),this.nfPrefWidth.getUnitValue()!==i&&(n=Common.Utils.Metric.fnRecalcFromMM(558),this.nfPrefWidth.setDefaultUnit(i),this.nfPrefWidth.setMaxValue(e.value?parseFloat((100*n/this.pageWidth).toFixed(2)):n),this.nfPrefWidth.setStep(e.value||Common.Utils.Metric.getCurrentMetric()==Common.Utils.Metric.c_MetricUnits.pt?1:.1),this.nfPrefWidth.setValue(e.value?100*this.nfPrefWidth.getNumberValue()/this.pageWidth:this.pageWidth*this.nfPrefWidth.getNumberValue()/100),this._changedProps.put_CellsWidth(e.value?-this.nfPrefWidth.getNumberValue():Common.Utils.Metric.fnRecalcToMM(this.nfPrefWidth.getNumberValue()))))},this)),this.chWrapText=new Common.UI.CheckBox({el:$("#tableadv-checkbox-wrap"),value:!1,labelText:this.textWrapText}),this.chWrapText.on("change",_.bind(function(t,e,i,n){this._changedProps&&this._changedProps.put_CellsNoWrap("checked"!=t.getValue())},this)),this.btnWrapNone=new Common.UI.Button({parentEl:$("#tableadv-button-wrap-none"),cls:"btn-options huge-1",iconCls:"options__icon options__icon-huge btn-table-align-center",posId:c_tableWrap.TABLE_WRAP_NONE,hint:this.textWrapNoneTooltip,enableToggle:!0,allowDepress:!1,toggleGroup:"advtablewrapGroup"}),this.btnWrapNone.on("click",_.bind(this.onBtnInlineWrapClick,this)),this.btnWrapParallel=new Common.UI.Button({parentEl:$("#tableadv-button-wrap-parallel"),cls:"btn-options huge-1",iconCls:"options__icon options__icon-huge btn-table-flow",posId:c_tableWrap.TABLE_WRAP_PARALLEL,hint:this.textWrapParallelTooltip,enableToggle:!0,allowDepress:!1,toggleGroup:"advtablewrapGroup"}),this.btnWrapParallel.on("click",_.bind(this.onBtnFlowWrapClick,this)),this.btnAlignLeft=new Common.UI.Button({parentEl:$("#tableadv-button-align-left"),cls:"btn-options huge-1",iconCls:"options__icon options__icon-huge btn-table-align-left",posId:c_tableAlign.TABLE_ALIGN_LEFT,hint:this.textLeftTooltip,enableToggle:!0,allowDepress:!1,toggleGroup:"advtablealignGroup"}),this.btnAlignLeft.on("click",_.bind(function(t){this._changedProps&&t.pressed&&(this._changedProps.put_TableAlignment(t.options.posId),this._changedProps.put_TableIndent(Common.Utils.Metric.fnRecalcToMM(this.spnIndentLeft.getNumberValue())),this.spnIndentLeft.setDisabled(!t.pressed),this._state.alignChanged=!0)},this)),this.btnAlignCenter=new Common.UI.Button({parentEl:$("#tableadv-button-align-center"),cls:"btn-options huge-1",iconCls:"options__icon options__icon-huge btn-table-align-center",posId:c_tableAlign.TABLE_ALIGN_CENTER,hint:this.textCenterTooltip,enableToggle:!0,allowDepress:!1,toggleGroup:"advtablealignGroup"}),this.btnAlignCenter.on("click",_.bind(function(t){this._changedProps&&t.pressed&&(this._changedProps.put_TableAlignment(t.options.posId),this._changedProps.put_TableIndent(0),this.spnIndentLeft.setDisabled(t.pressed),this._state.alignChanged=!0)},this)),this.btnAlignRight=new Common.UI.Button({parentEl:$("#tableadv-button-align-right"),cls:"btn-options huge-1",iconCls:"options__icon options__icon-huge btn-table-align-right",posId:c_tableAlign.TABLE_ALIGN_RIGHT,hint:this.textRightTooltip,enableToggle:!0,allowDepress:!1,toggleGroup:"advtablealignGroup"}),this.btnAlignRight.on("click",_.bind(function(t){this._changedProps&&t.pressed&&(this._changedProps.put_TableAlignment(t.options.posId),this._changedProps.put_TableIndent(0),this.spnIndentLeft.setDisabled(t.pressed),this._state.alignChanged=!0)},this)),this.spnIndentLeft=new Common.UI.MetricSpinner({el:$("#tableadv-number-indent"),step:.1,width:85,defaultUnit:"cm",defaultValue:0,value:"0 cm",maxValue:38.09,minValue:-38.09}),this.spnIndentLeft.on("change",_.bind(function(t,e,i,n){this._changedProps&&this._changedProps.put_TableIndent(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue()))},this)),this.spinners.push(this.spnIndentLeft),this.spnDistanceTop=new Common.UI.MetricSpinner({el:$("#tableadv-number-distance-top"),step:.1,width:85,defaultUnit:"cm",value:"1 cm",maxValue:55.87,minValue:0}),this.spnDistanceTop.on("change",_.bind(function(t,e,i,n){this._changedProps&&(void 0===this._changedProps.get_TablePaddings()&&this._changedProps.put_TablePaddings(new Asc.asc_CPaddings),this._changedProps.get_TablePaddings().put_Top(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())))},this)),this.spinners.push(this.spnDistanceTop),this.spnDistanceBottom=new Common.UI.MetricSpinner({el:$("#tableadv-number-distance-bottom"),step:.1,width:85,defaultUnit:"cm",value:"1 cm",maxValue:55.87,minValue:0}),this.spnDistanceBottom.on("change",_.bind(function(t,e,i,n){this._changedProps&&(void 0===this._changedProps.get_TablePaddings()&&this._changedProps.put_TablePaddings(new Asc.asc_CPaddings),this._changedProps.get_TablePaddings().put_Bottom(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())))},this)),this.spinners.push(this.spnDistanceBottom),this.spnDistanceLeft=new Common.UI.MetricSpinner({el:$("#tableadv-number-distance-left"),step:.1,width:85,defaultUnit:"cm",value:"1 cm",maxValue:9.34,minValue:0}),this.spnDistanceLeft.on("change",_.bind(function(t,e,i,n){this._changedProps&&(void 0===this._changedProps.get_TablePaddings()&&this._changedProps.put_TablePaddings(new Asc.asc_CPaddings),this._changedProps.get_TablePaddings().put_Left(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())))},this)),this.spinners.push(this.spnDistanceLeft),this.spnDistanceRight=new Common.UI.MetricSpinner({el:$("#tableadv-number-distance-right"),step:.1,width:85,defaultUnit:"cm",value:"0.19 cm",maxValue:9.34,minValue:0}),this.spnDistanceRight.on("change",_.bind(function(t,e,i,n){this._changedProps&&(void 0===this._changedProps.get_TablePaddings()&&this._changedProps.put_TablePaddings(new Asc.asc_CPaddings),this._changedProps.get_TablePaddings().put_Right(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())))},this)),this.spinners.push(this.spnDistanceRight),this.spnX=new Common.UI.MetricSpinner({el:$("#tableadv-spin-x"),step:.1,width:115,disabled:!0,defaultUnit:"cm",defaultValue:0,value:"1 cm",maxValue:55.87,minValue:-55.87}),this.spnX.on("change",_.bind(function(t,e,i,n){this._changedProps&&(null!==this._changedProps.get_PositionH()&&void 0!==this._changedProps.get_PositionH()||this._changedProps.put_PositionH(new Asc.CTablePositionH),this._changedProps.get_PositionH().put_UseAlign(!1),this._changedProps.get_PositionH().put_RelativeFrom(this._state.HPositionFrom),this._changedProps.get_PositionH().put_Value(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())),this._state.spnXChanged=!0)},this)),this.spinners.push(this.spnX),this.spnY=new Common.UI.MetricSpinner({el:$("#tableadv-spin-y"),step:.1,width:115,disabled:!0,defaultUnit:"cm",defaultValue:0,value:"1 cm",maxValue:55.87,minValue:-55.87}),this.spnY.on("change",_.bind(function(t,e,i,n){this._changedProps&&(null!==this._changedProps.get_PositionV()&&void 0!==this._changedProps.get_PositionV()||this._changedProps.put_PositionV(new Asc.CTablePositionV),this._changedProps.get_PositionV().put_UseAlign(!1),this._changedProps.get_PositionV().put_RelativeFrom(this._state.VPositionFrom),this._changedProps.get_PositionV().put_Value(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())),this._state.spnYChanged=!0)},this)),this.spinners.push(this.spnY),this._arrHAlign=[{displayValue:this.textLeft,value:Asc.c_oAscXAlign.Left},{displayValue:this.textCenter,value:Asc.c_oAscXAlign.Center},{displayValue:this.textRight,value:Asc.c_oAscXAlign.Right}],this.cmbHAlign=new Common.UI.ComboBox({el:$("#tableadv-combo-halign"),cls:"input-group-nr",menuStyle:"min-width: 115px;",editable:!1,data:this._arrHAlign,takeFocusOnClose:!0}),this.cmbHAlign.setValue(this._state.HAlignType),this.cmbHAlign.on("selected",_.bind(this.onHAlignSelect,this)),this._arrHRelative=[{displayValue:this.textMargin,value:Asc.c_oAscHAnchor.Margin},{displayValue:this.textPage,value:Asc.c_oAscHAnchor.Page},{displayValue:this.textAnchorText,value:Asc.c_oAscHAnchor.Text}],this.cmbHRelative=new Common.UI.ComboBox({el:$("#tableadv-combo-hrelative"),cls:"input-group-nr",menuStyle:"min-width: 115px;",editable:!1,data:this._arrHRelative,takeFocusOnClose:!0}),this.cmbHRelative.setValue(this._state.HAlignFrom),this.cmbHRelative.on("selected",_.bind(this.onHRelativeSelect,this)),this.cmbHPosition=new Common.UI.ComboBox({el:$("#tableadv-combo-hposition"),cls:"input-group-nr",menuStyle:"min-width: 115px;",editable:!1,data:this._arrHRelative,takeFocusOnClose:!0}),this.cmbHPosition.setDisabled(!0),this.cmbHPosition.setValue(this._state.HPositionFrom),this.cmbHPosition.on("selected",_.bind(this.onHPositionSelect,this)),this._arrVAlign=[{displayValue:this.textTop,value:Asc.c_oAscYAlign.Top},{displayValue:this.textCenter,value:Asc.c_oAscYAlign.Center},{displayValue:this.textBottom,value:Asc.c_oAscYAlign.Bottom}],this.cmbVAlign=new Common.UI.ComboBox({el:$("#tableadv-combo-valign"),cls:"input-group-nr",menuStyle:"min-width: 115px;",editable:!1,data:this._arrVAlign,takeFocusOnClose:!0}),this.cmbVAlign.setValue(this._state.VAlignType),this.cmbVAlign.on("selected",_.bind(this.onVAlignSelect,this)),this._arrVRelative=[{displayValue:this.textMargin,value:Asc.c_oAscVAnchor.Margin},{displayValue:this.textPage,value:Asc.c_oAscVAnchor.Page},{displayValue:this.textAnchorText,value:Asc.c_oAscVAnchor.Text}],this.cmbVRelative=new Common.UI.ComboBox({el:$("#tableadv-combo-vrelative"),cls:"input-group-nr",menuStyle:"min-width: 115px;",editable:!1,data:this._arrVRelative,takeFocusOnClose:!0}),this.cmbVRelative.setValue(this._state.VAlignFrom),this.cmbVRelative.on("selected",_.bind(this.onVRelativeSelect,this)),this.cmbVPosition=new Common.UI.ComboBox({el:$("#tableadv-combo-vposition"),cls:"input-group-nr",menuStyle:"min-width: 115px;",editable:!1,data:this._arrVRelative,takeFocusOnClose:!0}),this.cmbVPosition.setDisabled(!0),this.cmbVPosition.setValue(this._state.VPositionFrom),this.cmbVPosition.on("selected",_.bind(this.onVPositionSelect,this)),this.radioHAlign=new Common.UI.RadioBox({el:$("#tableadv-radio-halign"),name:"asc-radio-horizontal",checked:!0}),this.radioHAlign.on("change",_.bind(this.onRadioHAlignChange,this)),this.radioHPosition=new Common.UI.RadioBox({el:$("#tableadv-radio-hposition"),name:"asc-radio-horizontal"}),this.radioHPosition.on("change",_.bind(this.onRadioHPositionChange,this)),this.radioVAlign=new Common.UI.RadioBox({el:$("#tableadv-radio-valign"),name:"asc-radio-vertical",checked:!0}),this.radioVAlign.on("change",_.bind(this.onRadioVAlignChange,this)),this.radioVPosition=new Common.UI.RadioBox({el:$("#tableadv-radio-vposition"),name:"asc-radio-vertical"}),this.radioVPosition.on("change",_.bind(this.onRadioVPositionChange,this)),this.chMove=new Common.UI.CheckBox({el:$("#tableadv-checkbox-move"),labelText:this.textMove}),this.chMove.on("change",_.bind(function(t,e,i,n){var o;this._changedProps&&(t=this._arrVRelative["checked"==t.getValue()?2:1].value,this.cmbVRelative.isDisabled()?(this.cmbVPosition.setValue(t),(o=this.cmbVPosition.getSelectedRecord())&&this.onVPositionSelect(this.cmbVPosition,o)):(this.cmbVRelative.setValue(t),(o=this.cmbVRelative.getSelectedRecord())&&this.onVRelativeSelect(this.cmbVRelative,o)))},this)),this.chOverlap=new Common.UI.CheckBox({el:$("#tableadv-checkbox-overlap"),labelText:this.textOverlap}),this.chOverlap.on("change",_.bind(function(t,e,i,n){this._changedProps&&this._changedProps.put_AllowOverlap("checked"==t.getValue())},this)),this.cmbBorderSize=new Common.UI.ComboBorderSize({el:$("#tableadv-combo-border-size"),style:"width: 93px;",takeFocusOnClose:!0}),this.cmbBorderSize.store.at(1)),t=(this.BorderSize={ptValue:t.get("value"),pxValue:t.get("pxValue")},this.cmbBorderSize.setValue(this.BorderSize.ptValue),this.cmbBorderSize.on("selected",_.bind(this.onBorderSizeSelect,this)),this.btnBorderColor=new Common.UI.ColorButton({parentEl:$("#tableadv-border-color-btn"),additionalAlign:this.menuAddAlign,color:"auto",auto:!0,cls:"move-focus",takeFocusOnClose:!0}),this.btnBorderColor.on("color:select",_.bind(e.onColorsBorderSelect,e)),this.btnBorderColor.on("auto:select",_.bind(e.onColorsBorderSelect,e)),this.colorsBorder=this.btnBorderColor.getPicker(),this.btnBackColor=new Common.UI.ColorButton({parentEl:$("#tableadv-button-back-color"),additionalAlign:this.menuAddAlign,transparent:!0,cls:"move-focus",takeFocusOnClose:!0}),this.btnBackColor.on("color:select",_.bind(this.onColorsBackSelect,this)),this.colorsBack=this.btnBackColor.getPicker(),this.btnTableBackColor=new Common.UI.ColorButton({parentEl:$("#tableadv-button-table-back-color"),additionalAlign:this.menuAddAlign,transparent:!0,cls:"move-focus",takeFocusOnClose:!0}),this.btnTableBackColor.on("color:select",_.bind(this.onColorsTableBackSelect,this)),this.colorsTableBack=this.btnTableBackColor.getPicker(),this.tableBordersImageSpacing=new Common.UI.TableStyler({el:$("#id-detablestyler-spacing"),width:200,height:200,rows:this.tableStylerRows,columns:this.tableStylerColumns,spacingMode:!0}),this.tableBordersImage=new Common.UI.TableStyler({el:$("#id-detablestyler"),width:200,height:200,rows:this.tableStylerRows,columns:this.tableStylerColumns,spacingMode:!1}),[["cm","toolbar__icon toolbar__icon-big btn-borders-inner-only","tableadv-button-border-inner",this.tipInner],["lrtb","toolbar__icon toolbar__icon-big btn-borders-outer-only","tableadv-button-border-outer",this.tipOuter],["lrtbcm","toolbar__icon toolbar__icon-big btn-borders-all","tableadv-button-border-all",this.tipAll],["","toolbar__icon toolbar__icon-big btn-borders-none","tableadv-button-border-none",this.tipNone]]),t=(this._btnsBorderPosition=[],_.each(t,function(t,e,i){t=new Common.UI.Button({parentEl:$("#"+t[2]),cls:"btn-options large border-off",iconCls:t[1],strId:t[0],hint:t[3]});t.on("click",_.bind(this._ApplyBorderPreset,this)),this._btnsBorderPosition.push(t)},this),[["cm","","toolbar__icon toolbar__icon-big btn-borders-twin-none-inner","tableadv-button-border-inner-none",this.tipCellInner],["lrtb","","toolbar__icon toolbar__icon-big btn-borders-twin-none-outer","tableadv-button-border-outer-none",this.tipCellOuter],["lrtbcm","","toolbar__icon toolbar__icon-big btn-borders-twin-none-all","tableadv-button-border-all-none",this.tipCellAll],["","","toolbar__icon toolbar__icon-big btn-borders-twin-none","tableadv-button-border-none-none",this.tipNone],["lrtbcm","lrtb","toolbar__icon toolbar__icon-big btn-borders-twin-all","tableadv-button-border-all-table",this.tipTableOuterCellAll],["","lrtb","toolbar__icon toolbar__icon-big btn-borders-twin-outer-none","tableadv-button-border-none-table",this.tipOuter],["cm","lrtb","toolbar__icon toolbar__icon-big btn-borders-twin-outer-inner","tableadv-button-border-inner-table",this.tipTableOuterCellInner],["lrtb","lrtb","toolbar__icon toolbar__icon-big btn-borders-twin-outer-outer","tableadv-button-border-outer-table",this.tipTableOuterCellOuter]]);this._btnsTableBorderPosition=[],_.each(t,function(t,e,i){t=new Common.UI.Button({parentEl:$("#"+t[3]),style:"margin-bottom: 4px;",cls:"btn-options large border-off  margin-left-4",iconCls:t[2],strCellId:t[0],strTableId:t[1],hint:t[4]});t.on("click",_.bind(this._ApplyBorderPreset,this)),this._btnsTableBorderPosition.push(t)},this),this.inputAltTitle=new Common.UI.InputField({el:$("#table-advanced-alt-title"),allowBlank:!0,validateOnBlur:!1,style:"width: 100%;"}).on("changed:after",function(){e.isAltTitleChanged=!0}),this.textareaAltDescription=this.$window.find("textarea"),this.textareaAltDescription.keydown(function(t){t.keyCode==Common.UI.Keys.RETURN&&t.stopPropagation(),e.isAltDescChanged=!0}),this.AlignContainer=$("#tableadv-panel-align"),this.DistanceContainer=$("#tableadv-panel-distance"),this.BordersContainer=$("#tableadv-panel-borders"),this.BordersSpacingContainer=$("#tableadv-panel-borders-spacing"),this.CellBackContainer=$("#tableadv-panel-cell-back"),this.TableBackContainer=$("#tableadv-panel-table-back"),this.afterRender()},getFocusedComponents:function(){return[this.chWidth,this.nfWidth,this.cmbUnit,this.chAutofit,this.spnTableMarginTop,this.spnTableMarginLeft,this.spnTableMarginBottom,this.spnTableMarginRight,this.chAllowSpacing,this.nfSpacing,this.chPrefWidth,this.nfPrefWidth,this.cmbPrefWidthUnit,this.chCellMargins,this.spnMarginTop,this.spnMarginLeft,this.spnMarginBottom,this.spnMarginRight,this.chWrapText,this.cmbBorderSize,this.btnBorderColor].concat(this._btnsBorderPosition).concat(this._btnsTableBorderPosition).concat([this.btnBackColor,this.btnTableBackColor,this.radioHAlign,this.cmbHAlign,this.radioHPosition,this.cmbHRelative,this.spnX,this.cmbHPosition,this.radioVAlign,this.cmbVAlign,this.radioVPosition,this.cmbVRelative,this.spnY,this.cmbVPosition,this.chMove,this.chOverlap,this.spnIndentLeft,this.spnDistanceTop,this.spnDistanceLeft,this.spnDistanceBottom,this.spnDistanceRight,this.inputAltTitle,this.textareaAltDescription])},onCategoryClick:function(t,e){Common.Views.AdvancedSettingsWindow.prototype.onCategoryClick.call(this,t,e);var i=this;setTimeout(function(){switch(e){case 0:(i.nfWidth.isDisabled()?i.spnTableMarginTop:i.nfWidth).focus();break;case 1:i.onCellCategoryClick(t),(i.nfPrefWidth.isDisabled()?i.chPrefWidth:i.nfPrefWidth).focus();break;case 2:i.cmbBorderSize.focus();break;case 3:(i.cmbHAlign.isDisabled()?i.spnX:i.cmbHAlign).focus();break;case 4:(i.spnIndentLeft.isVisible()?i.spnIndentLeft:i.spnDistanceTop).focus();break;case 5:i.inputAltTitle.focus()}},10)},afterRender:function(){this.updateMetricUnit(),this.updateThemeColors(),this._setDefaults(this._originalProps);var t="object"==typeof this.CellColor.Color?this.CellColor.Color.color:this.CellColor.Color,e="object"==typeof this.TableColor.Color?this.TableColor.Color.color:this.TableColor.Color;this.tableBordersImageSpacing.setTableColor(e),this.tableBordersImage.setTableColor(e),this.tableBordersImageSpacing.setCellsColor(t),this.tableBordersImage.setCellsColor(this._allTable?e:t),this.tableBordersImage.redrawTable(),this.tableBordersImageSpacing.redrawTable(),void 0!==this.borderProps&&(this.btnBorderColor.setColor(this.borderProps.borderColor),this.btnBorderColor.setAutoColor("auto"==this.borderProps.borderColor),e=("object"==typeof this.btnBorderColor.color?this.btnBorderColor.color:this.btnBorderColor).color,this.tableBordersImageSpacing.setVirtualBorderColor(e),this.tableBordersImage.setVirtualBorderColor(e),"auto"==this.borderProps.borderColor?this.colorsBorder.clearSelection():this.colorsBorder.select(this.borderProps.borderColor,!0),this.cmbBorderSize.setValue(this.borderProps.borderSize.ptValue),(t=this.cmbBorderSize.getSelectedRecord())&&this.onBorderSizeSelect(this.cmbBorderSize,t)),this.tableBordersImageSpacing.on("borderclick:cellborder",function(t,e,i,n){void 0===this.ChangedCellBorders&&(this.ChangedCellBorders=new Asc.CBorders),this._UpdateCellBordersStyle(t,e,i,n,this.CellBorders,this.ChangedCellBorders)},this),this.tableBordersImageSpacing.on("borderclick",function(t,e,i,n){void 0===this.ChangedTableBorders&&(this.ChangedTableBorders=new Asc.CBorders),this._UpdateTableBordersStyle(t,e,i,n,this.TableBorders,this.ChangedTableBorders)},this),this.tableBordersImage.on("borderclick",function(t,e,i,n){this._allTable?void 0===this.ChangedTableBorders&&(this.ChangedTableBorders=new Asc.CBorders):void 0===this.ChangedCellBorders&&(this.ChangedCellBorders=new Asc.CBorders),this._UpdateTableBordersStyle(t,e,i,n,this._allTable?this.TableBorders:this.CellBorders,this._allTable?this.ChangedTableBorders:this.ChangedCellBorders)},this),this.tableBordersImage.on("borderclick:cellborder",function(t,e,i,n){this._allTable?void 0===this.ChangedTableBorders&&(this.ChangedTableBorders=new Asc.CBorders):void 0===this.ChangedCellBorders&&(this.ChangedCellBorders=new Asc.CBorders),this._UpdateCellBordersStyle(t,e,i,n,this._allTable?this.TableBorders:this.CellBorders,this._allTable?this.ChangedTableBorders:this.ChangedCellBorders)},this),this.storageName&&(e=Common.localStorage.getItem(this.storageName),this.setActiveCategory(null!==e?parseInt(e):0))},getSettings:function(){return this._cellBackground&&(this._allTable&&(null===this._changedProps.get_Spacing()||void 0===this._changedProps.get_Spacing()&&null===this._originalProps.get_Spacing())?this._changedProps.put_CellsBackground(null):this._changedProps.put_CellsBackground(this._cellBackground)),null===this.ChangedTableBorders?this._changedProps.put_TableBorders(this.TableBorders):void 0!==this.ChangedTableBorders&&this._changedProps.put_TableBorders(this.ChangedTableBorders),null===this.ChangedCellBorders?this._changedProps.put_CellBorders(this.CellBorders):void 0!==this.ChangedCellBorders&&this._changedProps.put_CellBorders(this.ChangedCellBorders),this.isAltTitleChanged&&this._changedProps.put_TableCaption(this.inputAltTitle.getValue()),this.isAltDescChanged&&this._changedProps.put_TableDescription(this.textareaAltDescription.val()),{tableProps:this._changedProps,borderProps:{borderSize:this.BorderSize,borderColor:this.btnBorderColor.isAutoColor()?"auto":this.btnBorderColor.color}}},_setDefaults:function(t){if(t){this._allTable=!t.get_CellSelect(),this.pageWidth=Common.Utils.Metric.fnRecalcFromMM(t.get_PercentFullWidth());var e=t.get_Width(),i=Common.Utils.Metric.getCurrentMetric(),e=(this.cmbUnit.store.at(0).set("displayValue",i==Common.Utils.Metric.c_MetricUnits.pt?this.txtPt:i==Common.Utils.Metric.c_MetricUnits.inch?this.txtInch:this.txtCm),this.cmbUnit.setValue(e<0?1:0),this.nfWidth.setDefaultUnit(e<0?"%":Common.Utils.Metric.getCurrentMetricName()),e<0&&this.nfWidth.setMaxValue(parseFloat((100*Common.Utils.Metric.fnRecalcFromMM(558)/this.pageWidth).toFixed(2))),this.nfWidth.setStep(e<0||Common.Utils.Metric.getCurrentMetric()==Common.Utils.Metric.c_MetricUnits.pt?1:.1),null!==e&&this.nfWidth.setValue(0<e?Common.Utils.Metric.fnRecalcFromMM(e):-e,!0),this.chWidth.setValue(null!==e,!0),s="checked"!==this.chWidth.getValue(),this.nfWidth.setDisabled(s),this.cmbUnit.setDisabled(s),t.get_Spacing()),e=(null!==e&&this.nfSpacing.setValue(Common.Utils.Metric.fnRecalcFromMM(e),!0),this.chAllowSpacing.setValue(null!==e,!0),this.nfSpacing.setDisabled("checked"!==this.chAllowSpacing.getValue()),t.get_TableLayout()),e=(this.chAutofit.setDisabled(void 0===e),this.chAutofit.setValue(e===Asc.c_oAscTableLayout.AutoFit,!0),t.get_DefaultMargins()),n=(e&&(this.TableMargins={Left:null!==e.get_Left()?Common.Utils.Metric.fnRecalcFromMM(e.get_Left()):null,Right:null!==e.get_Right()?Common.Utils.Metric.fnRecalcFromMM(e.get_Right()):null,Top:null!==e.get_Top()?Common.Utils.Metric.fnRecalcFromMM(e.get_Top()):null,Bottom:null!==e.get_Bottom()?Common.Utils.Metric.fnRecalcFromMM(e.get_Bottom()):null}),void 0),e=((e=t.get_CellMargins())&&(this.CellMargins={Left:null!==e.get_Left()?Common.Utils.Metric.fnRecalcFromMM(e.get_Left()):null,Right:null!==e.get_Right()?Common.Utils.Metric.fnRecalcFromMM(e.get_Right()):null,Top:null!==e.get_Top()?Common.Utils.Metric.fnRecalcFromMM(e.get_Top()):null,Bottom:null!==e.get_Bottom()?Common.Utils.Metric.fnRecalcFromMM(e.get_Bottom()):null},n=e.get_Flag(),this.CellMargins.Flag=1==n?"indeterminate":0==n?"checked":"unchecked",this.chCellMargins.setValue(this.CellMargins.Flag,!0)),0===n&&(null===this.CellMargins.Left&&(this.CellMargins.Left=this.TableMargins.Left),null===this.CellMargins.Top&&(this.CellMargins.Top=this.TableMargins.Top),null===this.CellMargins.Right&&(this.CellMargins.Right=this.TableMargins.Right),null===this.CellMargins.Bottom&&(this.CellMargins.Bottom=this.TableMargins.Bottom)),this.fillMargins(this.CellMargins.Flag),t.get_CellsWidth()),n=(this.cmbPrefWidthUnit.store.at(0).set("displayValue",i==Common.Utils.Metric.c_MetricUnits.pt?this.txtPt:i==Common.Utils.Metric.c_MetricUnits.inch?this.txtInch:this.txtCm),this.cmbPrefWidthUnit.setValue(e<0?1:0),this.nfPrefWidth.setDefaultUnit(e<0?"%":Common.Utils.Metric.getCurrentMetricName()),e<0&&this.nfPrefWidth.setMaxValue(parseFloat((100*Common.Utils.Metric.fnRecalcFromMM(558)/this.pageWidth).toFixed(2))),this.nfPrefWidth.setStep(e<0||Common.Utils.Metric.getCurrentMetric()==Common.Utils.Metric.c_MetricUnits.pt?1:.1),null!==e&&this.nfPrefWidth.setValue(0<e?Common.Utils.Metric.fnRecalcFromMM(e):-e,!0),this.chPrefWidth.setValue(t.get_CellsWidthNotEqual()?"indeterminate":null!==e,!0),s="checked"!==this.chPrefWidth.getValue(),this.nfPrefWidth.setDisabled(s),this.cmbPrefWidthUnit.setDisabled(s),!t.get_CellsNoWrap()),i=(this.chWrapText.setValue(n,!0),this._TblWrapStyleChanged(t.get_TableWrap()),this.ShowHideWrap(t.get_TableWrap()===c_tableWrap.TABLE_WRAP_NONE),this.btnWrapParallel.setDisabled(!t.get_CanBeFlow()),t.get_TableAlignment()),e=(null!==i&&(this._TblAlignChanged(i),this.spnIndentLeft.setValue(i!==c_tableAlign.TABLE_ALIGN_LEFT?0:Common.Utils.Metric.fnRecalcFromMM(t.get_TableIndent()),!0),this.spnIndentLeft.setDisabled(i!==c_tableAlign.TABLE_ALIGN_LEFT)),this._state.alignChanged=!1,t.get_TablePaddings()),n=(e&&(this.spnDistanceTop.setValue(Common.Utils.Metric.fnRecalcFromMM(e.get_Top()),!0),this.spnDistanceLeft.setValue(Common.Utils.Metric.fnRecalcFromMM(e.get_Left()),!0),this.spnDistanceBottom.setValue(Common.Utils.Metric.fnRecalcFromMM(e.get_Bottom()),!0),this.spnDistanceRight.setValue(Common.Utils.Metric.fnRecalcFromMM(e.get_Right()),!0)),t.get_PositionH());if(n){s=n.get_RelativeFrom();for(var o=0;o<this._arrHRelative.length;o++)if(s==this._arrHRelative[o].value){this.cmbHRelative.setValue(s),this.cmbHPosition.setValue(s),this._state.HPositionFrom=s,this._state.HAlignFrom=s;break}if(n.get_UseAlign()){for(var s=n.get_Align(),o=0;o<this._arrHAlign.length;o++)if(s==this._arrHAlign[o].value){this.cmbHAlign.setValue(s),this._state.HAlignType=s;break}s=this._originalProps.get_Value_X(this._state.HPositionFrom)}else this.radioHPosition.setValue(!0),s=n.get_Value()}else s=this._originalProps.get_Value_X(this._state.HPositionFrom);if(this.spnX.setValue(Common.Utils.Metric.fnRecalcFromMM(s)),n=t.get_PositionV()){for(s=n.get_RelativeFrom(),o=0;o<this._arrVRelative.length;o++)if(s==this._arrVRelative[o].value){this.cmbVRelative.setValue(s),this.cmbVPosition.setValue(s),this._state.VAlignFrom=s,this._state.VPositionFrom=s;break}if(s==Asc.c_oAscVAnchor.Text&&this.chMove.setValue(!0,!0),n.get_UseAlign()){for(s=n.get_Align(),o=0;o<this._arrVAlign.length;o++)if(s==this._arrVAlign[o].value){this.cmbVAlign.setValue(s),this._state.VAlignType=s;break}s=t.get_Value_Y(this._state.VPositionFrom)}else this.radioVPosition.setValue(!0),s=n.get_Value()}else s=t.get_Value_Y(this._state.VPositionFrom);this.spnY.setValue(Common.Utils.Metric.fnRecalcFromMM(s)),this.chOverlap.setValue(null!==t.get_AllowOverlap()?t.get_AllowOverlap():"indeterminate",!0),this._state.verticalPropChanged=!1,this._state.horizontalPropChanged=!1,this.TableBorders=new Asc.CBorders(t.get_TableBorders()),this.CellBorders=new Asc.CBorders(t.get_CellBorders()),this._UpdateBordersNoSpacing_(),this._UpdateBordersSpacing_();var a,i=null===this.CellBorders.get_InsideV()&&null===this.CellBorders.get_InsideH(),e=(this._btnsBorderPosition[0].setDisabled(i&&!this._allTable),this._btnsTableBorderPosition[0].setDisabled(i&&!this._allTable),this._btnsTableBorderPosition[6].setDisabled(i&&!this._allTable),t.get_TableBackground());if(e&&0==e.get_Value()?(a=e.get_Color())?a.get_type()==Asc.c_oAscColor.COLOR_TYPE_SCHEME?this.TableColor={Value:1,Color:{color:Common.Utils.ThemeColor.getHexColor(a.get_r(),a.get_g(),a.get_b()),effectValue:a.get_value()}}:this.TableColor={Value:1,Color:Common.Utils.ThemeColor.getHexColor(a.get_r(),a.get_g(),a.get_b())}:this.TableColor={Value:1,Color:"transparent"}:this.TableColor={Value:0,Color:"transparent"},(e=t.get_CellsBackground())?0==e.get_Value()&&(a=e.get_Color())?a.get_type()==Asc.c_oAscColor.COLOR_TYPE_SCHEME?this.CellColor={Value:1,Color:{color:Common.Utils.ThemeColor.getHexColor(a.get_r(),a.get_g(),a.get_b()),effectValue:a.get_value()}}:this.CellColor={Value:1,Color:Common.Utils.ThemeColor.getHexColor(a.get_r(),a.get_g(),a.get_b())}:this.CellColor={Value:1,Color:"transparent"}:this.CellColor={Value:0,Color:"transparent"},this.btnBackColor.setColor(this.CellColor.Color),"object"==typeof this.CellColor.Color){for(var l=!1,o=0;o<10;o++)if(Common.Utils.ThemeColor.ThemeValues[o]==this.CellColor.Color.effectValue){this.colorsBack.select(this.CellColor.Color,!0),l=!0;break}l||this.colorsBack.clearSelection()}else this.colorsBack.select(this.CellColor.Color,!0);if(this.btnTableBackColor.setColor(this.TableColor.Color),"object"==typeof this.TableColor.Color){for(l=!1,o=0;o<10;o++)if(Common.Utils.ThemeColor.ThemeValues[o]==this.TableColor.Color.effectValue){this.colorsTableBack.select(this.TableColor.Color,!0),l=!0;break}l||this.colorsTableBack.clearSelection()}else this.colorsTableBack.select(this.TableColor.Color,!0);this.ShowHideSpacing("checked"===this.chAllowSpacing.getValue()),s=t.get_TableCaption(),this.inputAltTitle.setValue(s||""),s=t.get_TableDescription(),this.textareaAltDescription.val(s||"")}this._changedProps=new Asc.CTableProp,this._changedProps.put_CellSelect(!this._allTable),this._cellBackground=null,this.ChangedTableBorders=void 0,this.ChangedCellBorders=void 0},fillMargins:function(t){this.spnMarginLeft.setValue(null!==this.CellMargins.Left?this.CellMargins.Left:"",!0),this.spnMarginTop.setValue(null!==this.CellMargins.Top?this.CellMargins.Top:"",!0),this.spnMarginRight.setValue(null!==this.CellMargins.Right?this.CellMargins.Right:"",!0),this.spnMarginBottom.setValue(null!==this.CellMargins.Bottom?this.CellMargins.Bottom:"",!0);t="checked"==t;this.spnMarginTop.setDisabled(t),this.spnMarginBottom.setDisabled(t),this.spnMarginLeft.setDisabled(t),this.spnMarginRight.setDisabled(t),this.spnTableMarginLeft.setValue(null!==this.TableMargins.Left?this.TableMargins.Left:"",!0),this.spnTableMarginTop.setValue(null!==this.TableMargins.Top?this.TableMargins.Top:"",!0),this.spnTableMarginRight.setValue(null!==this.TableMargins.Right?this.TableMargins.Right:"",!0),this.spnTableMarginBottom.setValue(null!==this.TableMargins.Bottom?this.TableMargins.Bottom:"",!0)},_TblWrapStyleChanged:function(t){(t==c_tableWrap.TABLE_WRAP_NONE?this.btnWrapNone:this.btnWrapParallel).toggle(!0),this._state.fromWrapInline=t==c_tableWrap.TABLE_WRAP_NONE},_TblAlignChanged:function(t){(t==c_tableAlign.TABLE_ALIGN_LEFT?this.btnAlignLeft:t==c_tableAlign.TABLE_ALIGN_CENTER?this.btnAlignCenter:this.btnAlignRight).toggle(!0,!0)},onBtnInlineWrapClick:function(t,e){this.ShowHideWrap(!0),this._changedProps&&t.pressed&&(this._state.alignChanged&&(this._state.HAlignType===Asc.c_oAscXAlign.Left?this.btnAlignLeft.toggle(!0):this._state.HAlignType==Asc.c_oAscXAlign.Center?this.btnAlignCenter.toggle(!0):this._state.HAlignType==Asc.c_oAscXAlign.Right&&this.btnAlignRight.toggle(!0),this._state.alignChanged=!1),this._changedProps.put_TableWrap(t.options.posId),this.btnAlignLeft.pressed?this._changedProps.put_TableAlignment(c_tableAlign.TABLE_ALIGN_LEFT):this.btnAlignCenter.pressed?this._changedProps.put_TableAlignment(c_tableAlign.TABLE_ALIGN_CENTER):this._changedProps.put_TableAlignment(c_tableAlign.TABLE_ALIGN_RIGHT),this.spnIndentLeft.setDisabled(!this.btnAlignLeft.pressed),this._changedProps.put_TableIndent(Common.Utils.Metric.fnRecalcToMM(this.spnIndentLeft.getNumberValue()))),this.spnIndentLeft.isDisabled()||this.spnIndentLeft.focus()},onBtnFlowWrapClick:function(t,e){this.ShowHideWrap(!1),this._changedProps&&t.pressed&&(this._changedProps.put_TableWrap(t.options.posId),this._changedProps.put_TableAlignment(null),this._changedProps.put_TableIndent(null),this._state.fromWrapInline&&!this._state.verticalPropChanged&&this.radioVPosition.setValue(!0),this._state.alignChanged?(this.btnAlignLeft.pressed?this._state.HAlignType=Asc.c_oAscXAlign.Left:this.btnAlignCenter.pressed?this._state.HAlignType=Asc.c_oAscXAlign.Center:this._state.HAlignType=Asc.c_oAscXAlign.Right,this.cmbHAlign.setValue(this._state.HAlignType),this.radioHAlign.setValue(!0),null!==this._changedProps.get_PositionH()&&void 0!==this._changedProps.get_PositionH()||this._changedProps.put_PositionH(new Asc.CTablePositionH),this._changedProps.get_PositionH().put_UseAlign(!0),this._changedProps.get_PositionH().put_Align(this._state.HAlignType),this._changedProps.get_PositionH().put_RelativeFrom(this._state.HAlignFrom),this._state.alignChanged=!1,this._state.horizontalPropChanged=!0):this._state.fromWrapInline&&!this._state.horizontalPropChanged&&this.radioHPosition.setValue(!0)),this.spnDistanceTop.focus()},onHAlignSelect:function(t,e){this._changedProps&&(null!==this._changedProps.get_PositionH()&&void 0!==this._changedProps.get_PositionH()||this._changedProps.put_PositionH(new Asc.CTablePositionH),this._state.HAlignType=e.value,this._changedProps.get_PositionH().put_UseAlign(!0),this._changedProps.get_PositionH().put_RelativeFrom(this._state.HAlignFrom),this._changedProps.get_PositionH().put_Align(this._state.HAlignType),this._state.alignChanged=!0)},onHRelativeSelect:function(t,e){this._changedProps&&(null!==this._changedProps.get_PositionH()&&void 0!==this._changedProps.get_PositionH()||this._changedProps.put_PositionH(new Asc.CTablePositionH),this._state.HAlignFrom=e.value,this._changedProps.get_PositionH().put_UseAlign(!0),this._changedProps.get_PositionH().put_RelativeFrom(this._state.HAlignFrom),this._changedProps.get_PositionH().put_Align(this._state.HAlignType))},onHPositionSelect:function(t,e){this._changedProps&&(null!==this._changedProps.get_PositionH()&&void 0!==this._changedProps.get_PositionH()||this._changedProps.put_PositionH(new Asc.CTablePositionH),this._state.HPositionFrom=e.value,this._changedProps.get_PositionH().put_UseAlign(!1),this._changedProps.get_PositionH().put_RelativeFrom(this._state.HPositionFrom),this._state.spnXChanged||(e=this._originalProps.get_Value_X(this._state.HPositionFrom),this.spnX.setValue(Common.Utils.Metric.fnRecalcFromMM(e),!0)),this._changedProps.get_PositionH().put_Value(Common.Utils.Metric.fnRecalcToMM(this.spnX.getNumberValue())))},onVAlignSelect:function(t,e){this._changedProps&&(null!==this._changedProps.get_PositionV()&&void 0!==this._changedProps.get_PositionV()||this._changedProps.put_PositionV(new Asc.CTablePositionV),this._state.VAlignType=e.value,this._changedProps.get_PositionV().put_UseAlign(!0),this._changedProps.get_PositionV().put_RelativeFrom(this._state.VAlignFrom),this._changedProps.get_PositionV().put_Align(this._state.VAlignType))},onVRelativeSelect:function(t,e){this._changedProps&&(null!==this._changedProps.get_PositionV()&&void 0!==this._changedProps.get_PositionV()||this._changedProps.put_PositionV(new Asc.CTablePositionV),this._state.VAlignFrom=e.value,this._changedProps.get_PositionV().put_UseAlign(!0),this._changedProps.get_PositionV().put_RelativeFrom(this._state.VAlignFrom),this._changedProps.get_PositionV().put_Align(this._state.VAlignType),this.chMove.setValue(this._state.VAlignFrom==Asc.c_oAscVAnchor.Text,!0))},onVPositionSelect:function(t,e){this._changedProps&&(null!==this._changedProps.get_PositionV()&&void 0!==this._changedProps.get_PositionV()||this._changedProps.put_PositionV(new Asc.CTablePositionV),this._state.VPositionFrom=e.value,this._changedProps.get_PositionV().put_UseAlign(!1),this._changedProps.get_PositionV().put_RelativeFrom(this._state.VPositionFrom),this._state.spnYChanged||(e=this._originalProps.get_Value_Y(this._state.VPositionFrom),this.spnY.setValue(Common.Utils.Metric.fnRecalcFromMM(e),!0)),this._changedProps.get_PositionV().put_Value(Common.Utils.Metric.fnRecalcToMM(this.spnY.getNumberValue())),this.chMove.setValue(this._state.VPositionFrom==Asc.c_oAscVAnchor.Text,!0))},onRadioHAlignChange:function(t,e,i){this._changedProps&&(null!==this._changedProps.get_PositionH()&&void 0!==this._changedProps.get_PositionH()||this._changedProps.put_PositionH(new Asc.CTablePositionH),this._changedProps.get_PositionH().put_UseAlign(e),e&&(this._changedProps.get_PositionH().put_Align(this._state.HAlignType),this._changedProps.get_PositionH().put_RelativeFrom(this._state.HAlignFrom))),e&&(this.cmbHAlign.setDisabled(!1),this.cmbHAlign.focus(),this.cmbHRelative.setDisabled(!1),this.spnX.setDisabled(!0),this.cmbHPosition.setDisabled(!0),this._state.horizontalPropChanged=!0,this._state.alignChanged=!0)},onRadioHPositionChange:function(t,e,i){var n;this._changedProps&&(null!==this._changedProps.get_PositionH()&&void 0!==this._changedProps.get_PositionH()||this._changedProps.put_PositionH(new Asc.CTablePositionH),this._changedProps.get_PositionH().put_UseAlign(!e),e&&(this._state.spnXChanged||(n=this._originalProps.get_Value_X(this._state.HPositionFrom),this.spnX.setValue(Common.Utils.Metric.fnRecalcFromMM(n))),this._changedProps.get_PositionH().put_Value(Common.Utils.Metric.fnRecalcToMM(this.spnX.getNumberValue())),this._changedProps.get_PositionH().put_RelativeFrom(this._state.HPositionFrom))),e&&(this.cmbHAlign.setDisabled(!0),this.cmbHRelative.setDisabled(!0),this.spnX.setDisabled(!1),this.spnX.focus(),this.cmbHPosition.setDisabled(!1),this._state.alignChanged=!1)},onRadioVAlignChange:function(t,e,i){this._changedProps&&(null!==this._changedProps.get_PositionV()&&void 0!==this._changedProps.get_PositionV()||this._changedProps.put_PositionV(new Asc.CTablePositionV),this._changedProps.get_PositionV().put_UseAlign(e),e&&(this._changedProps.get_PositionV().put_Align(this._state.VAlignType),this._changedProps.get_PositionV().put_RelativeFrom(this._state.VAlignFrom),this._state.verticalPropChanged=!0)),e&&(this.cmbVAlign.setDisabled(!1),this.cmbVAlign.focus(),this.cmbVRelative.setDisabled(!1),this.spnY.setDisabled(!0),this.cmbVPosition.setDisabled(!0),this.chMove.setValue(this._state.VAlignFrom==Asc.c_oAscVAnchor.Text,!0))},onRadioVPositionChange:function(t,e,i){var n;this._changedProps&&(null!==this._changedProps.get_PositionV()&&void 0!==this._changedProps.get_PositionV()||this._changedProps.put_PositionV(new Asc.CTablePositionV),this._changedProps.get_PositionV().put_UseAlign(!e),e&&(this._state.spnYChanged||(n=this._originalProps.get_Value_Y(this._state.VPositionFrom),this.spnY.setValue(Common.Utils.Metric.fnRecalcFromMM(n))),this._changedProps.get_PositionV().put_Value(Common.Utils.Metric.fnRecalcToMM(this.spnY.getNumberValue())),this._changedProps.get_PositionV().put_RelativeFrom(this._state.VPositionFrom))),e&&(this.cmbVAlign.setDisabled(!0),this.cmbVRelative.setDisabled(!0),this.spnY.setDisabled(!1),this.spnY.focus(),this.cmbVPosition.setDisabled(!1),this.chMove.setValue(this._state.VPositionFrom==Asc.c_oAscVAnchor.Text,!0))},onBorderSizeSelect:function(t,e){this.BorderSize={ptValue:e.value,pxValue:e.pxValue},this.tableBordersImage.setVirtualBorderSize(this.BorderSize.pxValue),this.tableBordersImageSpacing.setVirtualBorderSize(this.BorderSize.pxValue)},onColorsBorderSelect:function(t,e){e="object"==typeof e?e.color:e;this.tableBordersImage.setVirtualBorderColor(e),this.tableBordersImageSpacing.setVirtualBorderColor(e)},onColorsBackSelect:function(t,e){this.CellColor={Value:1,Color:e},null===this._cellBackground&&(this._cellBackground=new Asc.CBackground),"transparent"==this.CellColor.Color?(this._cellBackground.put_Value(1),this._cellBackground.put_Color(new Asc.asc_CColor(0,0,0))):(this._cellBackground.put_Value(0),this._cellBackground.put_Color(Common.Utils.ThemeColor.getRgbColor(this.CellColor.Color)));e="object"==typeof e?e.color:e;this.tableBordersImageSpacing.setCellsColor(e),this.tableBordersImageSpacing.redrawTable(),this._allTable||(this.tableBordersImage.setCellsColor(e),this.tableBordersImage.redrawTable())},onColorsTableBackSelect:function(t,e){this.TableColor.Color=e,this._changedProps&&(void 0===(i=this._changedProps.get_TableBackground())&&(i=new Asc.CBackground,this._changedProps.put_TableBackground(i)),"transparent"==this.TableColor.Color?(i.put_Value(1),i.put_Color(new Asc.asc_CColor(0,0,0))):(i.put_Value(0),i.put_Color(Common.Utils.ThemeColor.getRgbColor(this.TableColor.Color))));var i="object"==typeof e?e.color:e;this.tableBordersImageSpacing.setTableColor(i),this.tableBordersImage.setTableColor(i),this._allTable&&this.tableBordersImage.setCellsColor(i),this.tableBordersImage.redrawTable(),this.tableBordersImageSpacing.redrawTable()},_UpdateBordersSpacing_:function(){var t=this.TableBorders,e=this.BorderSize,i=this.btnBorderColor.color;if(this._UpdateTableBorderSpacing_(t.get_Left(),"l"),this._UpdateTableBorderSpacing_(t.get_Top(),"t"),this._UpdateTableBorderSpacing_(t.get_Right(),"r"),this._UpdateTableBorderSpacing_(t.get_Bottom(),"b"),t=this.CellBorders,this._UpdateCellBorderSpacing_(t.get_Top(),this.tableBordersImageSpacing.getCellBorder(0,-1,0)),this._UpdateCellBorderSpacing_(t.get_Left(),this.tableBordersImageSpacing.getCellBorder(-1,0,0)),this._UpdateCellBorderSpacing_(t.get_Bottom(),this.tableBordersImageSpacing.getCellBorder(this.tableBordersImageSpacing.rows-1,-1,1)),this._UpdateCellBorderSpacing_(t.get_Right(),this.tableBordersImageSpacing.getCellBorder(-1,this.tableBordersImageSpacing.columns-1,1)),this._allTable&&null===t.get_InsideV()&&t.put_InsideV(new Asc.asc_CTextBorder),null!==t.get_InsideV())for(var n=0;n<this.tableBordersImageSpacing.columns-1;n++)this._UpdateCellBorderSpacing_(t.get_InsideV(),this.tableBordersImageSpacing.getCellBorder(-1,n,1)),this._UpdateCellBorderSpacing_(t.get_InsideV(),this.tableBordersImageSpacing.getCellBorder(-1,n+1,0));if(this._allTable&&null===t.get_InsideH()&&t.put_InsideH(new Asc.asc_CTextBorder),null!==t.get_InsideH())for(n=0;n<this.tableBordersImageSpacing.rows-1;n++)this._UpdateCellBorderSpacing_(t.get_InsideH(),this.tableBordersImageSpacing.getCellBorder(n,-1,1)),this._UpdateCellBorderSpacing_(t.get_InsideH(),this.tableBordersImageSpacing.getCellBorder(n+1,-1,0));this.tableBordersImageSpacing.setVirtualBorderSize(e.pxValue),this.tableBordersImageSpacing.setVirtualBorderColor("object"==typeof i?i.color:i),this.tableBordersImageSpacing.redrawTable()},_UpdateCellBorderSpacing_:function(t,e){null!=t&&null!==t.get_Value()&&null!==t.get_Size()&&null!==t.get_Color()?1==t.get_Value()?(e.setBordersSize(this._BorderPt2Px(72*t.get_Size()/25.4)),e.setBordersColor("rgb("+t.get_Color().get_r()+","+t.get_Color().get_g()+","+t.get_Color().get_b()+")")):e.setBordersSize(0):(e.setBordersSize(this.IndeterminateSize),e.setBordersColor(this.IndeterminateColor))},_UpdateTableBorderSpacing_:function(t,e){null!=t&&null!==t.get_Value()&&null!==t.get_Size()&&null!==t.get_Color()?1==t.get_Value()?(this.tableBordersImageSpacing.setBordersSize(e,this._BorderPt2Px(72*t.get_Size()/25.4)),this.tableBordersImageSpacing.setBordersColor(e,"rgb("+t.get_Color().get_r()+","+t.get_Color().get_g()+","+t.get_Color().get_b()+")")):this.tableBordersImageSpacing.setBordersSize(e,0):(this.tableBordersImageSpacing.setBordersSize(e,this.IndeterminateSize),this.tableBordersImageSpacing.setBordersColor(e,this.IndeterminateColor))},_UpdateBordersNoSpacing_:function(){var t=this._allTable?this.TableBorders:this.CellBorders,e=this.BorderSize,i=this.btnBorderColor.color;if(this._UpdateTableBorderNoSpacing_(t.get_Left(),"l"),this._UpdateTableBorderNoSpacing_(t.get_Top(),"t"),this._UpdateTableBorderNoSpacing_(t.get_Right(),"r"),this._UpdateTableBorderNoSpacing_(t.get_Bottom(),"b"),this._allTable&&null==t.get_InsideV()&&t.put_InsideV(new Asc.asc_CTextBorder),null!==t.get_InsideV())for(var n=0;n<this.tableBordersImage.columns-1;n++)this._UpdateCellBorderNoSpacing_(t.get_InsideV(),this.tableBordersImage.getCellBorder(-1,n));if(this._allTable&&null==t.get_InsideH()&&t.put_InsideH(new Asc.asc_CTextBorder),null!==t.get_InsideH())for(n=0;n<this.tableBordersImage.rows-1;n++)this._UpdateCellBorderNoSpacing_(t.get_InsideH(),this.tableBordersImage.getCellBorder(n,-1));this.tableBordersImage.setVirtualBorderSize(e.pxValue),this.tableBordersImage.setVirtualBorderColor("object"==typeof i?i.color:i)},_UpdateCellBorderNoSpacing_:function(t,e){null!=t&&null!==t.get_Value()&&null!==t.get_Size()&&null!==t.get_Color()?1==t.get_Value()?(e.setBordersSize(this._BorderPt2Px(72*t.get_Size()/25.4)),e.setBordersColor("rgb("+t.get_Color().get_r()+","+t.get_Color().get_g()+","+t.get_Color().get_b()+")")):e.setBordersSize(0):(e.setBordersSize(this.IndeterminateSize),e.setBordersColor(this.IndeterminateColor))},_UpdateTableBorderNoSpacing_:function(t,e){null!=t&&null!==t.get_Value()&&null!==t.get_Size()&&null!==t.get_Color()?1==t.get_Value()?(this.tableBordersImage.setBordersSize(e,this._BorderPt2Px(72*t.get_Size()/25.4)),this.tableBordersImage.setBordersColor(e,"rgb("+t.get_Color().get_r()+","+t.get_Color().get_g()+","+t.get_Color().get_b()+")")):this.tableBordersImage.setBordersSize(e,0):(this.tableBordersImage.setBordersSize(e,this.IndeterminateSize),this.tableBordersImage.setBordersColor(e,this.IndeterminateColor))},_BorderPt2Px:function(t){return 0==t?0:t<.6?.5:t<=1?1:t<=1.5?2:t<=2.25?3:t<=3?4:t<=4.5?6:8},_ApplyBorderPreset:function(t){var e,i=void 0!==t.options.strId?t.options.strId:t.options.strCellId,t=t.options.strTableId;this._allTable&&void 0===t?(e=this.TableBorders,this.ChangedTableBorders=null):(e=this.CellBorders,this.ChangedCellBorders=null),this._UpdateBorderStyle(e.get_Left(),-1<i.indexOf("l")),this._UpdateBorderStyle(e.get_Top(),-1<i.indexOf("t")),this._UpdateBorderStyle(e.get_Right(),-1<i.indexOf("r")),this._UpdateBorderStyle(e.get_Bottom(),-1<i.indexOf("b")),this._UpdateBorderStyle(e.get_InsideV(),-1<i.indexOf("c")),this._UpdateBorderStyle(e.get_InsideH(),-1<i.indexOf("m")),void 0===t?(this._UpdateBordersNoSpacing_(),this._allTable&&(e=this.CellBorders,this.ChangedCellBorders=null,this._UpdateBorderStyle(e.get_Left(),-1<i.indexOf("l")),this._UpdateBorderStyle(e.get_Top(),-1<i.indexOf("t")),this._UpdateBorderStyle(e.get_Right(),-1<i.indexOf("r")),this._UpdateBorderStyle(e.get_Bottom(),-1<i.indexOf("b")),this._UpdateBorderStyle(e.get_InsideV(),-1<i.indexOf("c")),this._UpdateBorderStyle(e.get_InsideH(),-1<i.indexOf("m"))),this.tableBordersImageSpacing.redrawTable(),this.tableBordersImage.redrawTable()):(e=this.TableBorders,this.ChangedTableBorders=null,this._UpdateBorderStyle(e.get_Left(),-1<t.indexOf("l")),this._UpdateBorderStyle(e.get_Top(),-1<t.indexOf("t")),this._UpdateBorderStyle(e.get_Right(),-1<t.indexOf("r")),this._UpdateBorderStyle(e.get_Bottom(),-1<t.indexOf("b")),this._UpdateBordersSpacing_())},_UpdateCellBordersStyle:function(t,e,i,n,o,s){0==e.col&&0==e.numInCell?(this._UpdateBorderStyle(o.get_Left(),0<i),s&&s.put_Left(new Asc.asc_CTextBorder(o.get_Left()))):e.col==e.columns-1&&1==e.numInCell?(this._UpdateBorderStyle(o.get_Right(),0<i),s&&s.put_Right(new Asc.asc_CTextBorder(o.get_Right()))):0==e.row&&0==e.numInCell?(this._UpdateBorderStyle(o.get_Top(),0<i),s&&s.put_Top(new Asc.asc_CTextBorder(o.get_Top()))):e.row==e.rows-1&&1==e.numInCell?(this._UpdateBorderStyle(o.get_Bottom(),0<i),s&&s.put_Bottom(new Asc.asc_CTextBorder(o.get_Bottom()))):-1<e.col?(this._UpdateBorderStyle(o.get_InsideV(),0<i),s&&s.put_InsideV(new Asc.asc_CTextBorder(o.get_InsideV()))):-1<e.row&&(this._UpdateBorderStyle(o.get_InsideH(),0<i),s&&s.put_InsideH(new Asc.asc_CTextBorder(o.get_InsideH())))},_UpdateTableBordersStyle:function(t,e,i,n,o,s){-1<e.indexOf("l")?(this._UpdateBorderStyle(o.get_Left(),0<i),s&&s.put_Left(new Asc.asc_CTextBorder(o.get_Left()))):-1<e.indexOf("t")?(this._UpdateBorderStyle(o.get_Top(),0<i),s&&s.put_Top(new Asc.asc_CTextBorder(o.get_Top()))):-1<e.indexOf("r")?(this._UpdateBorderStyle(o.get_Right(),0<i),s&&s.put_Right(new Asc.asc_CTextBorder(o.get_Right()))):-1<e.indexOf("b")&&(this._UpdateBorderStyle(o.get_Bottom(),0<i),s&&s.put_Bottom(new Asc.asc_CTextBorder(o.get_Bottom())))},_UpdateBorderStyle:function(t,e){var i;return null==t?0:(e&&0<this.BorderSize.ptValue?(e=parseFloat(this.BorderSize.ptValue),t.put_Value(1),t.put_Size(25.4*e/72),this.btnBorderColor.isAutoColor()?(i=new Asc.asc_CColor).put_auto(!0):i=Common.Utils.ThemeColor.getRgbColor(this.btnBorderColor.color),t.put_Color(i)):(t.put_Color(new Asc.asc_CColor),t.put_Value(0)),t.get_Value())},onCellCategoryClick:function(t){"checked"==this.CellMargins.Flag&&this.TableMargins.isChanged&&(this.CellMargins.Left=this.TableMargins.Left,this.CellMargins.Top=this.TableMargins.Top,this.CellMargins.Right=this.TableMargins.Right,this.CellMargins.Bottom=this.TableMargins.Bottom,this.spnMarginRight.setValue(this.CellMargins.Right,!0),this.spnMarginLeft.setValue(this.CellMargins.Left,!0),this.spnMarginBottom.setValue(this.CellMargins.Bottom,!0),this.spnMarginTop.setValue(this.CellMargins.Top,!0)),this.TableMargins.isChanged=!1},updateMetricUnit:function(){if(this.spinners)for(var t=0;t<this.spinners.length;t++){var e=this.spinners[t];e.setDefaultUnit(Common.Utils.Metric.getCurrentMetricName()),e.setStep(Common.Utils.Metric.getCurrentMetric()==Common.Utils.Metric.c_MetricUnits.pt?1:.1)}},updateThemeColors:function(){this.colorsBorder.updateColors(Common.Utils.ThemeColor.getEffectColors(),Common.Utils.ThemeColor.getStandartColors()),this.colorsBack.updateColors(Common.Utils.ThemeColor.getEffectColors(),Common.Utils.ThemeColor.getStandartColors()),this.colorsTableBack.updateColors(Common.Utils.ThemeColor.getEffectColors(),Common.Utils.ThemeColor.getStandartColors())},ShowHideWrap:function(t){this.AlignContainer.toggleClass("settings-hidden",!t),this.DistanceContainer.toggleClass("settings-hidden",t),this.btnsCategory[3].setDisabled(t)},ShowHideSpacing:function(t){this.BordersContainer.toggleClass("settings-hidden",t),this.BordersSpacingContainer.toggleClass("settings-hidden",!t),this.TableBackContainer.css("display",t||this._allTable?"flex":"none"),this.CellBackContainer.css("display",!t&&this._allTable?"none":"flex"),this.TableBackContainer.toggleClass("float-right",t||!this._allTable),t?this._UpdateBordersSpacing_():this._UpdateBordersNoSpacing_()}},DE.Views.TableSettingsAdvanced||{}))}),define("text!documenteditor/main/app/template/ControlSettingsDialog.template",[],function(){return'<div id="id-adv-control-settings-general" class="settings-panel active">\n    <div class="inner-content">\n        <table cols="1" style="width: 100%;">\n            <tr>\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textName %></label>\n                    <div id="control-settings-txt-name"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textPlaceholder %></label>\n                    <div id="control-settings-txt-pholder"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-large">\n                    <label class="input-label"><%= scope.textTag %></label>\n                    <div id="control-settings-txt-tag"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="control-settings-chb-temp"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div class="separator horizontal"></div>\n                </td>\n            </tr>\n        </table>\n        <table cols="2" style="width: auto;">\n            <tr>\n                <td class="padding-small" colspan="2">\n                    <label class="header"><%= scope.textAppearance %></label>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <label class="input-label margin-right-10"><%= scope.textShowAs %></label>\n                </td>\n                <td class="padding-small">\n                    <div id="control-settings-combo-show" class="input-group-nr" style="display: inline-block; width:120px;"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <label class="input-label margin-right-10"><%= scope.textColor %></label>\n                </td>\n                <td class="padding-small">\n                    <div id="control-settings-color-btn" style="display: inline-block;"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="" colspan="2">\n                    <button type="button" class="btn btn-text-default auto" id="control-settings-btn-all" style="min-width: 98px;"><%= scope.textApplyAll %></button>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-adv-control-settings-lock" class="settings-panel active">\n    <div class="inner-content">\n        <table cols="1" style="width: 100%;">\n            <tr>\n                <td class="padding-small">\n                    <div id="control-settings-chb-lock-delete"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="control-settings-chb-lock-edit"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-adv-control-settings-list" class="settings-panel active">\n    <div class="inner-content">\n        <table cols="2" style="width: 100%;">\n            <tr>\n                <td>\n                    <label class="header" style="width: 99px;"><%= scope.textDisplayName %></label>\n                    <label class="header" style=""><%= scope.textValue %></label>\n                </td>\n                <td></td>\n            </tr>\n            <tr style="vertical-align: top;">\n                <td class="padding-small">\n                    <div id="control-settings-list" class="margin-right-10" style="width:200px; height: 214px;"></div>\n                </td>\n                <td class="padding-small">\n                    <button type="button" class="btn btn-text-default" id="control-settings-btn-add" style="min-width: 86px;margin-bottom: 5px;"><%= scope.textAdd %></button>\n                    <button type="button" class="btn btn-text-default" id="control-settings-btn-change" style="min-width: 86px;margin-bottom: 5px;"><%= scope.textChange %></button>\n                    <button type="button" class="btn btn-text-default" id="control-settings-btn-delete" style="min-width: 86px;margin-bottom: 5px;"><%= scope.textDelete %></button>\n                    <button type="button" class="btn btn-text-default" id="control-settings-btn-up" style="min-width: 86px;margin-bottom: 5px;"><%= scope.textUp %></button>\n                    <button type="button" class="btn btn-text-default" id="control-settings-btn-down" style="min-width: 86px;margin-bottom: 5px;"><%= scope.textDown %></button>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-adv-control-settings-date" class="settings-panel active">\n    <div class="inner-content">\n        <table cols="1" style="width: 100%;">\n            <tr>\n                <td>\n                    <label><%= scope.textFormat %></label>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="control-settings-txt-format" style="width: 100%;"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="control-settings-format" style="width: 100%; height: 162px;"></div>\n                </td>\n            </tr>\n            <tr>\n                <td>\n                    <label><%= scope.textLang %></label>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="control-settings-lang"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-adv-control-settings-checkbox" class="settings-panel">\n    <div class="inner-content">\n        <table cols="2" style="width: auto;">\n            <tr>\n                <td class="padding-small">\n                    <label class="input-label margin-right-10"><%= scope.textChecked %></label>\n                </td>\n                <td class="padding-small">\n                    <button type="button" class="btn btn-text-default" id="control-settings-btn-checked-edit" style="width:53px"></button>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <label class="input-label margin-right-10"><%= scope.textUnchecked %></label>\n                </td>\n                <td class="padding-small">\n                    <button type="button" class="btn btn-text-default" id="control-settings-btn-unchecked-edit" style="width:53px"></button>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-adv-control-settings-additional" class="settings-panel">\n    <div class="inner-content">\n        <table cols="1" style="width: 100%;">\n            <tr class="group-key">\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textGroupKey %></label>\n                    <div id="control-settings-txt-groupkey"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textKey %></label>\n                    <div id="control-settings-txt-key"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textLabel %></label>\n                    <div id="control-settings-txt-label"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-large">\n                    <label class="input-label"><%= scope.textHelp %></label>\n                    <textarea id="control-settings-txt-help" class="form-control" style="width: 100%; height: 90px;"></textarea>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-large">\n                    <div id="control-settings-chb-required"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-adv-control-settings-field" class="settings-panel">\n    <div class="inner-content">\n        <table cols="2" style="width: auto;">\n            <tr>\n                <td class="padding-small" colspan="2">\n                    <div id="control-settings-chb-max-chars" class="margin-right-10" style="display: inline-block;"></div>\n                    <div id="control-settings-spin-max-chars" style="display: inline-block;"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small" colspan="2">\n                    <div id="control-settings-chb-comb"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <label class="input-label margin-right-10"><%= scope.textPlaceholderSymbol %></label>\n                </td>\n                <td class="padding-small">\n                    <button type="button" class="btn btn-text-default" id="control-settings-btn-placeholder-edit" style="width:53px"></button>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small" colspan="2">\n                    <label class="input-label margin-right-10"><%= scope.textWidth %></label>\n                    <div id="control-settings-spin-width"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n'}),!function(e){var s=1,a=2,t=3,i=4,n=5,o=6,l=7,r=8,c=9,d=10,F=11,R=12,B=13,H=14,O=15,N=16,z=17,$=18,W=19,G=20,j=21,q=22,K=23,Y=24,X=25,J=26,Z=27,Q=28,tt=29,et=30,it=31,nt=32,ot=33,st=34,at=35,lt=36,rt=37,ct=38,dt=39,ht=40,mt=41,pt=42,ut=43,gt=44,bt=45,Ct=46,ft=47,vt=48,_t=49,wt=50,yt=51,xt=52,St=53,Tt=54,At=55,kt=56,Dt=57,It=58,Pt=59,Et=60,Vt=61,Mt=62,Ut=63,Lt=64,Ft=65,Rt=66,Bt=67,Ht=68,Ot=69,Nt=70,zt=71,$t=72,Wt=73,Gt=74,jt=75,qt=76,Kt=77,Yt=78,Xt=79,Jt=80,Zt=81,Qt=82,te=83,ee=84,ie=85,ne=86,oe=87,se=88,ae=89,le=90,re=91,ce=92,de=93,he=94,me=95,pe=96,ue=97,ge=98,be=99,Ce=100,fe=101,ve=102,_e=103,we=104,ye=105,xe=106,Se=107,Te=108,Ae=109,ke=110,De=111,Ie=112,Pe=113,Ee=114,Ve=115,Me=116,Ue=117,h=118,Le=119,Fe=120,Re=121,Be=122,He=123,Oe=124,Ne=125,ze=126,$e=127,We=128,Ge=129,je=130,qe=131,Ke=132,Ye=133,Xe=134,Je=135,Ze=136,Qe=137,ti=138,ei=139,ii=140,ni=141,oi=142,si=143,ai=144,li=145,ri=146,ci=147,di=148,hi=149,mi=150,pi=151,ui=152,gi=153,bi=154,Ci=155,fi=156,vi=157,_i=158,wi=159,yi=160,xi=161,Si=162,Ti=163,Ai=164,ki=165,Di=166,Ii=167,Pi=168,Ei=169,Vi=170,Mi=171,Ui=172,Li=173,Fi=174,Ri=175,Bi=176,Hi=177,Oi=178,Ni=179,zi=180,$i=181,Wi=182,Gi=183,ji=184,qi=185,Ki=186,Yi=187,Xi=188,Ji=189,Zi=190,Qi=191,tn=192,en=193,nn=194,on=195,sn=196,an=197,ln=198,rn=199,cn=200,dn=201,hn=202,mn=203,pn=204,un=205,gn=206,bn=207,Cn=208,fn=209,vn=210,_n=211,wn=212,yn=213,xn=214,Sn=215,Tn=216,An=217,kn=218,Dn=219,In=220,Pn=221,En=222,Vn=223,Mn=224,Un=225,Ln=226,Fn=227,Rn=228,Bn=229,Hn=230,On=231,Nn=232,zn=233,$n=234,Wn=235,Gn=236,jn=237,qn=238,Kn=239,Yn=240,Xn=241,Jn=242,Zn=243,Qn=244,to=245,eo=246,io=247,no=248,oo=249,so=250,ao=251,lo=252,ro=253,co=254,ho=255,mo=256,po=257,uo=258,go=259,bo=260,Co=261,fo=262,vo=263,_o=264,wo=265,yo=266,xo=267,So=268,To=269,Ao=270,ko=271,Do=272,Io=273,m=0,p=1,u=2,Po=3,g=4,b=5,C=6,f=7,Eo=8,Vo=16,v=17,_=18,w=19,y=20,x=30,S=19,Mo=21,T=29,A={Basic_Latin:0,Latin_1_Supplement:1,Latin_Extended_A:2,Latin_Extended_B:3,IPA_Extensions:4,Spacing_Modifier_Letters:5,Combining_Diacritical_Marks:6,Greek_and_Coptic:7,Coptic:8,Cyrillic:9,Armenian:10,Hebrew:11,Vai:12,Arabic:13,NKo:14,Devanagari:15,Bengali:16,Gurmukhi:17,Gujarati:18,Oriya:19,Tamil:20,Telugu:21,Kannada:22,Malayalam:23,Thai:24,Lao:25,Georgian:26,Balinese:27,Hangul_Jamo:28,Latin_Extended_Additional:29,Greek_Extended:30,General_Punctuation:31},k={Superscripts_And_Subscripts:0,Currency_Symbols:1,Combining_Diacritical_Marks_For_Symbols:2,Letterlike_Symbols:3,Number_Forms:4,Arrows:5,Mathematical_Operators:6,Miscellaneous_Technical:7,Control_Pictures:8,Optical_Character_Recognition:9,Enclosed_Alphanumerics:10,Box_Drawing:11,Block_Elements:12,Geometric_Shapes:13,Miscellaneous_Symbols:14,Dingbats:15,CJK_Symbols_And_Punctuation:16,Hiragana:17,Katakana:18,Bopomofo:19,Hangul_Compatibility_Jamo:20,Phags_pa:21,Enclosed_CJK_Letters_And_Months:22,CJK_Compatibility:23,Hangul_Syllables:24,Non_Plane:25,Phoenician:26,CJK_Unified_Ideographs:27,Private_Use_Area_plane_0:28,CJK_Strokes:29,Alphabetic_Presentation_Forms:30,Arabic_Presentation_Forms_A:31},D={Combining_Half_Marks:0,Vertical_Forms:1,Small_Form_Variants:2,Arabic_Presentation_Forms_B:3,Halfwidth_And_Fullwidth_Forms:4,Specials:5,Tibetan:6,Syriac:7,Thaana:8,Sinhala:9,Myanmar:10,Ethiopic:11,Cherokee:12,Unified_Canadian_Aboriginal_Syllabics:13,Ogham:14,Runic:15,Khmer:16,Mongolian:17,Braille_Patterns:18,Yi_Syllables:19,Tagalog:20,Old_Italic:21,Gothic:22,Deseret:23,Byzantine_Musical_Symbols:24,Mathematical_Alphanumeric_Symbols:25,Private_Use_plane_15:26,Variation_Selectors:27,Tags:28,Limbu:29,Tai_Le:30,New_Tai_Lue:31},Uo=1,Lo=2,Fo=3,Ro=4,I=5,Bo=6,Ho=7,Oo=8,No=9,zo=10,$o=11,Wo=12,P=14,E=16,Go=17,jo=18,qo=19,Ko=20,Yo=21,Xo=22,Jo=23,Zo=24,V=25,M=26;function U(t,e,i,n,o){this.Start=t,this.End=e,this.Name=i,this.Lid=n,this.Param=o}var L=[new U(32,126,s,1033,[1<<A.Basic_Latin,0,0,0,1<<m,0]),new U(160,255,a,0,[1<<A.Basic_Latin|1<<A.Latin_1_Supplement,0,0,0,1<<m,0]),new U(256,383,t,0,[1<<A.Basic_Latin|1<<A.Latin_Extended_A,0,0,0,1<<m|1<<p|1<<g|1<<f,0]),new U(384,591,i,0,[1<<A.Basic_Latin|1<<A.Latin_Extended_B,0,0,0,1<<m|1<<p|1<<g|1<<f,0]),new U(592,687,n,0,[1<<A.IPA_Extensions,0,0,0,0,0]),new U(688,767,o,0,[1<<A.Spacing_Modifier_Letters,0,0,0,0,0]),new U(768,879,l,0,[1<<A.Combining_Diacritical_Marks,0,0,0,0,0]),new U(880,1023,r,1032,[1<<A.Greek_and_Coptic,0,0,0,1<<Po,0]),new U(1024,1279,c,1049,[1<<A.Cyrillic,0,0,0,1<<u,0]),new U(1280,1327,d,0,[1<<A.Cyrillic,0,0,0,1<<u,0]),new U(1328,1423,F,1067,[1<<A.Armenian,0,0,0,0,0]),new U(1424,1535,R,1037,[1<<A.Hebrew,0,0,0,1<<b,1<<Mo]),new U(1536,1791,B,1,[1<<A.Arabic,0,0,0,1<<C,1<<S|1<<T]),new U(1792,1871,H,1114,[1<<A.Arabic,0,0,0,1<<C,1<<S|1<<T]),new U(1872,1919,O,1,[1<<A.Arabic,0,0,0,1<<C,1<<S|1<<T]),new U(1920,1983,N,1125,[1<<A.Arabic,0,0,0,1<<C,1<<S|1<<T]),new U(1984,2047,z,0,[1<<A.NKo,0,0,0,0,0]),new U(2048,2111,$,0,[1<<A.Hebrew,0,0,0,1<<b,0]),new U(2112,2143,W,0,[1<<A.Arabic,0,0,0,1<<C,1<<S|1<<T]),new U(2208,2303,G,1,[1<<A.Arabic,0,0,0,1<<C,1<<S|1<<T]),new U(2304,2431,j,1081,[1<<A.Devanagari,0,0,0,0,0]),new U(2432,2559,q,1093,[1<<A.Bengali,0,0,0,0,0]),new U(2560,2687,K,1094,[1<<A.Gurmukhi,0,0,0,0,0]),new U(2688,2815,Y,1095,[1<<A.Gujarati,0,0,0,0,0]),new U(2816,2943,X,1096,[1<<A.Oriya,0,0,0,0,0]),new U(2944,3071,J,1097,[1<<A.Tamil,0,0,0,0,0]),new U(3072,3199,Z,1098,[1<<A.Telugu,0,0,0,0,0]),new U(3200,3327,Q,1099,[1<<A.Kannada,0,0,0,0,0]),new U(3328,3455,tt,1100,[1<<A.Malayalam,0,0,0,0,0]),new U(3456,3583,et,1115,[0,0,1<<D.Sinhala,0,0,0]),new U(3584,3711,it,1054,[1<<A.Thai,0,0,0,1<<Vo,0]),new U(3712,3839,nt,1108,[1<<A.Lao,0,0,0,0,0]),new U(3840,4095,ot,2129,[0,0,1<<D.Tibetan,0,0,0]),new U(4096,4255,st,1109,[0,0,1<<D.Myanmar,0,0,0]),new U(4256,4351,at,1079,[1<<A.Georgian,0,0,0,0,0]),new U(4352,4607,lt,1042,[1<<A.Hangul_Jamo,0,0,0,1<<w,0]),new U(4608,4991,rt,1138,[0,0,1<<D.Ethiopic,0,0,0]),new U(4992,5023,ct,0,[0,0,1<<D.Ethiopic,0,0,0]),new U(5024,5119,dt,1116,[0,0,1<<D.Cherokee,0,0,0]),new U(5120,5759,ht,1117,[0,0,1<<D.Unified_Canadian_Aboriginal_Syllabics,0,0,0]),new U(5760,5791,mt,0,[0,0,1<<D.Ogham,0,0,0]),new U(5792,5887,pt,0,[0,0,1<<D.Runic,0,0,0]),new U(5888,5919,ut,1124,[0,0,1<<D.Tagalog,0,0,0]),new U(5920,5951,gt,1124,[0,0,1<<D.Tagalog,0,0,0]),new U(5952,5983,bt,1124,[0,0,1<<D.Tagalog,0,0,0]),new U(5984,6015,Ct,1124,[0,0,1<<D.Tagalog,0,0,0]),new U(6016,6143,ft,1107,[0,0,1<<D.Khmer,0,0,0]),new U(6144,6319,vt,1104,[0,0,1<<D.Mongolian,0,0,0]),new U(6320,6399,_t,1117,[0,0,1<<D.Unified_Canadian_Aboriginal_Syllabics,0,0,0]),new U(6400,6479,wt,0,[0,0,1<<D.Limbu,0,0,0]),new U(6480,6527,yt,0,[0,0,1<<D.Tai_Le,0,0,0]),new U(6528,6623,xt,0,[0,0,1<<D.New_Tai_Lue,0,0,0]),new U(6624,6655,St,1107,[0,0,1<<D.Khmer,0,0,0]),new U(6656,6687,Tt,0,[0,0,1<<D.Buginese,0,0,0]),new U(6688,6831,At,1054,[0,0,1<<D.Tai_Le,0,0,0]),new U(6832,6911,kt,0,[1<<A.Combining_Diacritical_Marks,0,0,0,0,0]),new U(6912,7039,Dt,1057,[1<<A.Balinese,0,0,0,0,0]),new U(7040,7103,It,1057,[0,0,0,1<<E,0,0]),new U(7104,7167,Pt,1057,[]),new U(7168,7247,Et,0,[0,0,0,1<<Go,0,0]),new U(7248,7295,Vt,0,[0,0,0,1<<jo,0,0]),new U(7296,7311,Mt,0,[1<<A.Cyrillic,0,0,0,0,0]),new U(7360,7375,Ut,0,[0,0,0,1<<E,0,0]),new U(7376,7423,Lt,0,[]),new U(7424,7551,Ft,0,[1<<A.IPA_Extensions,0,0,0,0,0]),new U(7552,7615,Rt,0,[1<<A.IPA_Extensions,0,0,0,0,0]),new U(7616,7679,Bt,0,[1<<A.Combining_Diacritical_Marks,0,0,0,0,0]),new U(7680,7935,Ht,0,[1<<A.Latin_Extended_Additional,0,0,0,1<<Eo,0]),new U(7936,8191,Ot,0,[1<<A.Greek_Extended,0,0,0,0,0]),new U(8192,8303,Nt,0,[1<<A.Punctuation,0,0,0,0,0]),new U(8304,8351,zt,0,[0,1<<k.Superscripts_And_Subscripts,0,0,0,0]),new U(8352,8399,$t,0,[0,1<<k.Currency_Symbols,0,0,0,0]),new U(8400,8447,Wt,0,[0,1<<k.Combining_Diacritical_Marks_For_Symbols,0,0,0,0]),new U(8448,8527,Gt,0,[0,1<<k.Letterlike_Symbols,0,0,0,0]),new U(8528,8591,jt,0,[0,1<<k.Number_Forms,0,0,0,0]),new U(8592,8703,qt,0,[0,1<<k.Arrows,0,0,0,0]),new U(8704,8959,Kt,0,[0,1<<k.Mathematical_Operators,0,0,0,0]),new U(8960,9215,Yt,0,[0,1<<k.Miscellaneous_Technical,0,0,0,0]),new U(9216,9279,Xt,0,[0,1<<k.Control_Pictures,0,0,0,0]),new U(9280,9311,Jt,0,[0,1<<k.Optical_Character_Recognition,0,0,0,0]),new U(9312,9471,Zt,0,[0,1<<k.Enclosed_Alphanumerics,0,0,0,0]),new U(9472,9599,Qt,0,[0,1<<k.Box_Drawing,0,0,0,0]),new U(9600,9631,te,0,[0,1<<k.Block_Elements,0,0,0,0]),new U(9632,9727,ee,0,[0,1<<k.Geometric_Shapes,0,0,0,0]),new U(9728,9983,ie,0,[0,1<<k.Miscellaneous_Symbols,0,0,0,0]),new U(9984,10175,ne,0,[0,1<<k.Dingbats,0,0,0,0]),new U(10176,10223,oe,0,[0,1<<k.Mathematical_Operators,0,0,0,0]),new U(10224,10239,se,0,[0,1<<k.Arrows,0,0,0,0]),new U(10240,10495,ae,0,[0,0,1<<D.Braille_Patterns,0,0,0]),new U(10496,10623,le,0,[0,1<<k.Arrows,0,0,0,0]),new U(10624,10751,re,0,[0,1<<k.Mathematical_Operators,0,0,0,0]),new U(10752,11007,ce,0,[0,1<<k.Mathematical_Operators,0,0,0,0]),new U(11008,11263,de,0,[0,1<<k.Arrows,0,0,0,0]),new U(11264,11359,he,0,[0,0,0,1<<k.Glagolitic,0,0]),new U(11360,11391,me,0,[1<<A.Latin_Extended_Additional,0,0,0,0,0]),new U(11392,11519,pe,0,[1<<A.Coptic,0,0,0,0,0]),new U(11520,11567,ue,0,[1<<A.Georgian,0,0,0,0,0]),new U(11568,11647,ge,0,[0,0,0,1<<Lo,0,0]),new U(11648,11743,be,0,[0,0,1<<D.Ethiopic,0,0,0]),new U(11744,11775,Ce,0,[1<<A.Cyrillic,0,0,0,1<<u,0]),new U(11776,11903,fe,0,[1<<A.General_Punctuation,0,0,0,0,0]),new U(11904,12031,ve,0,[0,1<<k.CJK_Unified_Ideographs,0,0,0,0]),new U(12032,12255,_e,0,[0,1<<k.CJK_Unified_Ideographs,0,0,0,0]),new U(12272,12287,we,0,[0,1<<k.CJK_Unified_Ideographs,0,0,0,0]),new U(12288,12351,ye,0,[0,1<<k.CJK_Symbols_And_Punctuation,0,0,1<<v|1<<x,0]),new U(12352,12447,xe,1041,[0,1<<k.Hiragana,0,0,0,0]),new U(12448,12543,Se,1041,[0,1<<k.Katakana,0,0,0,0]),new U(12544,12591,Te,0,[0,1<<k.Bopomofo,0,0,0,0]),new U(12592,12687,Ae,0,[0,1<<k.Hangul_Compatibility_Jamo,0,0,1<<w,0]),new U(12688,12703,ke,2052,[0,1<<k.CJK_Unified_Ideographs,0,0,0,0]),new U(12704,12735,De,0,[0,1<<k.Bopomofo,0,0,0,0]),new U(12736,12783,Ie,0,[0,1<<k.CJK_Strokes,0,0,0,0]),new U(12784,12799,Pe,0,[0,1<<k.Katakana,0,0,0,0]),new U(12800,13055,Ee,0,[0,1<<k.Enclosed_CJK_Letters_And_Months,0,0,0,0]),new U(13056,13311,Ve,0,[0,1<<k.CJK_Compatibility,0,0,0,0]),new U(13312,19903,Me,0,[0,1<<k.CJK_Unified_Ideographs,0,0,1<<_|1<<y,0]),new U(19904,19967,Ue,0,[0,0,0,1<<Fo,1<<_|1<<y,0]),new U(19968,40959,h,0,[0,1<<k.CJK_Unified_Ideographs,0,0,1<<_|1<<y|1<<v|1<<x,0]),new U(40960,42127,Le,0,[0,0,1<<D.Yi_Syllables,0,0,0]),new U(42128,42191,Fe,0,[0,0,1<<D.Yi_Radicals,0,0,0]),new U(42192,42239,Re,0,[]),new U(42240,42559,Be,0,[1<<A.Vai,0,0,0,0,0]),new U(42560,42655,He,0,[1<<A.Cyrillic,0,0,0,1<<u,0]),new U(42656,42751,Oe,0,[]),new U(42752,42783,Ne,0,[1<<A.Spacing_Modifier_Letters,0,0,0,0,0]),new U(42784,43007,ze,0,[1<<A.Latin_Extended_Additional,0,0,0,0,0]),new U(43008,43055,$e,0,[0,0,0,1<<Ro,0,0]),new U(43056,43071,We,0,[]),new U(43072,43135,Ge,0,[0,1<<k.Phags_pa,0,0,0,0]),new U(43136,43231,je,0,[0,0,0,1<<qo,0,0]),new U(43232,43263,qe,0,[1<<A.Devanagari,0,0,0,0,0]),new U(43264,43311,Ke,0,[0,0,0,1<<Ko,0,0]),new U(43312,43359,Ye,0,[0,0,0,1<<Yo,0,0]),new U(43360,43391,Xe,0,[1<<A.Hangul_Jamo,0,0,0,0,0]),new U(43392,43487,Je,1057,[]),new U(43488,43519,Ze,0,[0,0,1<<D.Myanmar,0,0,0]),new U(43520,43615,Qe,0,[0,0,0,1<<Xo,0,0]),new U(43616,43647,ti,0,[0,0,1<<D.Myanmar,0,0,0]),new U(43648,43743,ei,0,[]),new U(43744,43775,ii,0,[]),new U(43776,43823,ni,0,[]),new U(43824,43887,oi,0,[1<<A.Latin_Extended_Additional,0,0,0,0,0]),new U(43888,43967,si,0,[]),new U(43968,44031,ai,0,[]),new U(44032,55215,li,0,[0,1<<k.Hangul_Syllables,0,0,1<<w,0]),new U(55216,55295,ri,0,[1<<A.Hangul_Jamo,0,0,0,0,0]),new U(55296,56191,ci,0,[]),new U(56192,56319,di,0,[]),new U(56320,57343,hi,0,[]),new U(57344,63743,mi,0,[0,1<<k.Private_Use_Area_plane_0,0,0,0,0]),new U(63744,64255,pi,0,[0,1<<k.CJK_Compatibility_Ideographs,0,0,1<<_|1<<y,0]),new U(64256,64335,ui,0,[0,1<<k.Alphabetic_Presentation_Forms,0,0,0,0]),new U(64336,65023,gi,0,[0,1<<k.Arabic_Presentation_Forms_A,0,0,1<<C,1<<S|1<<T]),new U(65024,65039,bi,0,[0,0,1<<D.Variation_Selectors,0,0,0]),new U(65040,65055,Ci,0,[0,0,1<<D.Vertical_Forms,0,0,0]),new U(65056,65071,fi,0,[0,0,1<<D.Combining_Half_Marks,0,0,0]),new U(65072,65103,vi,0,[0,0,1<<D.Vertical_Forms,0,0,0]),new U(65104,65135,_i,0,[0,0,1<<D.Small_Form_Variants,0,0,0]),new U(65136,65279,wi,0,[0,0,1<<D.Arabic_Presentation_Forms_B,0,1<<C,1<<S|1<<T]),new U(65280,65519,yi,0,[0,0,1<<D.Halfwidth_And_Fullwidth_Forms,0,1<<w|1<<_|1<<y|1<<v|1<<x,0]),new U(65520,65535,xi,0,[0,0,1<<D.Specials,0,0,0]),new U(65536,65663,Si,0,[0,0,0,1<<I,0,0]),new U(65664,65791,Ti,0,[0,0,0,1<<I,0,0]),new U(65792,65855,Ai,0,[0,0,0,1<<I,0,0]),new U(65856,65935,ki,0,[0,0,0,1<<Bo,0,0]),new U(65936,65999,Di,0,[0,0,0,1<<Jo,0,0]),new U(66e3,66047,Ii,0,[0,0,0,1<<Zo,0,0]),new U(66176,66207,Pi,0,[0,0,0,1<<V,0,0]),new U(66208,66271,Ei,0,[0,0,0,1<<V,0,0]),new U(66272,66303,Vi,0,[1<<A.Coptic,0,0,0,0,0]),new U(66304,66351,Mi,0,[0,0,1<<D.Old_Italic,0,0,0]),new U(66352,66383,Ui,0,[0,0,1<<D.Gothic,0,0,0]),new U(66384,66431,Li,0,[]),new U(66432,66463,Fi,0,[0,0,0,1<<Ho,0,0]),new U(66464,66527,Ri,0,[0,0,0,1<<Oo,0,0]),new U(66560,66639,Bi,0,[0,0,1<<D.Deseret,0,0,0]),new U(66640,66687,Hi,0,[0,0,0,1<<No,0,0]),new U(66688,66735,Oi,0,[0,0,0,1<<zo,0,0]),new U(66736,66815,Ni,0,[]),new U(66816,66863,zi,0,[]),new U(66864,66927,$i,0,[]),new U(67072,67455,Wi,0,[]),new U(67584,67647,Gi,0,[0,0,0,1<<$o,0,0]),new U(67648,67679,ji,0,[]),new U(67680,67711,qi,0,[]),new U(67712,67759,Ki,0,[]),new U(67808,67839,Yi,0,[]),new U(67840,67871,Xi,0,[0,1<<k.Phoenician,0,0,0,0]),new U(67872,67903,Ji,0,[0,0,0,1<<V,0,0]),new U(67968,67999,Zi,0,[]),new U(68e3,68095,Qi,0,[]),new U(68096,68191,tn,0,[0,0,0,1<<Wo,0,0]),new U(68192,68223,en,0,[]),new U(68224,68255,nn,0,[]),new U(68288,68351,on,0,[]),new U(68352,68415,sn,0,[]),new U(68416,68447,an,0,[]),new U(68448,68479,ln,0,[]),new U(68480,68527,rn,0,[]),new U(68608,68687,cn,0,[]),new U(68736,68863,dn,0,[]),new U(69216,69247,hn,0,[]),new U(69632,69759,mn,0,[]),new U(69760,69839,pn,0,[]),new U(69840,69887,un,0,[]),new U(69888,69967,gn,0,[]),new U(69968,70015,bn,0,[]),new U(70016,70111,Cn,0,[]),new U(70112,70143,fn,0,[0,0,1<<D.Sinhala,0,0,0]),new U(70144,70223,vn,0,[]),new U(70272,70319,_n,0,[]),new U(70320,70399,wn,0,[]),new U(70400,70527,yn,0,[]),new U(70656,70783,xn,0,[]),new U(70784,70879,Sn,0,[]),new U(71040,71167,Tn,0,[]),new U(71168,71263,An,0,[]),new U(71264,71295,kn,0,[0,0,1<<D.Mongolian,0,0,0]),new U(71296,71375,Dn,0,[]),new U(71424,71487,In,0,[]),new U(71840,71935,Pn,0,[]),new U(72384,72447,En,0,[]),new U(72704,72815,Vn,0,[]),new U(72816,72895,Mn,0,[]),new U(73728,74751,Un,0,[0,0,0,1<<P,0,0]),new U(74752,74879,Ln,0,[0,0,0,1<<P,0,0]),new U(74880,75087,Fn,0,[]),new U(77824,78895,Rn,0,[]),new U(82944,83583,Bn,0,[]),new U(92160,92735,Hn,0,[]),new U(92736,92783,On,0,[]),new U(92880,92927,Nn,0,[]),new U(92928,93071,zn,0,[]),new U(93952,94111,$n,2052,[]),new U(94176,94207,Wn,0,[]),new U(94208,100351,Gn,0,[]),new U(100352,101119,jn,0,[]),new U(110592,110847,qn,0,[]),new U(113664,113823,Kn,0,[]),new U(113824,113839,Yn,0,[]),new U(118784,119039,Xn,0,[0,0,1<<D.Byzantine_Musical_Symbols,0,0,0]),new U(119040,119295,Jn,0,[0,0,1<<D.Byzantine_Musical_Symbols,0,0,0]),new U(119296,119375,Zn,0,[0,0,1<<D.Byzantine_Musical_Symbols,0,0,0]),new U(119552,119647,Qn,0,[]),new U(119648,119679,to,0,[]),new U(119808,120831,eo,0,[0,0,1<<D.Mathematical_Alphanumeric_Symbols,0,0,0]),new U(120832,121519,io,0,[]),new U(122880,122927,no,0,[0,0,0,1<<Uo,0,0]),new U(124928,125151,oo,0,[]),new U(125184,125279,so,0,[]),new U(126464,126719,ao,0,[]),new U(126976,127023,lo,0,[0,0,0,1<<M,0,0]),new U(127024,127135,ro,0,[0,0,0,1<<M,0,0]),new U(127136,127231,co,0,[]),new U(127232,127487,ho,0,[]),new U(127488,127743,mo,0,[]),new U(127744,128511,po,0,[]),new U(128512,128591,uo,0,[]),new U(128592,128639,go,0,[]),new U(128640,128767,bo,0,[]),new U(128768,128895,Co,0,[]),new U(128896,129023,fo,0,[0,1<<k.Geometric_Shapes,0,0,0,0]),new U(129024,129279,vo,0,[0,1<<k.Arrows,0,0,0,0]),new U(129280,129535,_o,0,[]),new U(131072,173791,wo,0,[0,0,1<<D.CJK_Unified_Ideographs,0,1<<_|1<<y,0]),new U(173824,177983,yo,0,[0,0,1<<D.CJK_Unified_Ideographs,0,1<<_|1<<y,0]),new U(177984,178207,xo,0,[0,0,1<<D.CJK_Unified_Ideographs,0,1<<_|1<<y,0]),new U(178208,183983,So,0,[0,0,1<<D.CJK_Unified_Ideographs,0,1<<_|1<<y,0]),new U(194560,195103,To,0,[0,0,1<<D.CJK_Strokes,0,1<<_|1<<y,0]),new U(917504,917631,Ao,0,[0,0,1<<D.Tags,0,0,0]),new U(917760,917999,ko,0,[0,0,1<<D.Variation_Selectors,0,0,0]),new U(983040,1048575,Do,0,[0,0,1<<D.Private_Use_plane_15,0,0,0]),new U(1048576,1114111,Io,0,[0,0,1<<D.Private_Use_plane_15,0,0,0])];e.getSupportedFonts=function(t){t=function(t,e){var i,n=0,o=e.length-1,s=null;if(o<=n)return null;for(;n<o;)if((s=e[i=n+o>>1]).Start>t)o=i-1;else{if(!(s.End<t))return e[i];n=1+i}return o<n||(s=e[n]).Start>t||s.End<t?null:e[n]}(t,L);return e.getSupportedFontsByRange(t)},e.getSupportedFontsByRange=function(t){if(null==t)return[];for(var e=AscFonts.g_fontApplication.g_fontSelections.List,i=e.length,n=[],o=0;o<i;o++){var s=e[o],a=t.Param;if(a[0]==(s.m_ulUnicodeRange1&a[0])&&(a[1]==(s.m_ulUnicodeRange2&a[1])&&a[2]==(s.m_ulUnicodeRange3&a[2])&&a[3]==(s.m_ulUnicodeRange4&a[3]))){if(t.Name==h){if(0==(s.m_ulCodePageRange1&a[4]))continue}else if(a[4]!=(s.m_ulCodePageRange1&a[4]))continue;a[5]==(s.m_ulCodePageRange2&a[5])&&n.push(s.m_wsFontName)}}return n},e.getSupportedRangesByFont=function(t){for(var e=[],i=0;i<L.length;++i){var n=L[i],o=n.Param;o[0]==(t.m_ulUnicodeRange1&o[0])&&o[1]==(t.m_ulUnicodeRange2&o[1])&&o[2]==(t.m_ulUnicodeRange3&o[2])&&o[3]==(t.m_ulUnicodeRange4&o[3])&&o[4]==(t.m_ulCodePageRange1&o[4])&&o[5]==(t.m_ulCodePageRange2&o[5])&&e.push(n)}return 0===e.length&&(e.push(new U(32,126,s,1033,[1<<A.Basic_Latin,0,0,0,1<<m,0])),e.push(new U(160,255,a,0,[1<<A.Basic_Latin|1<<A.Latin_1_Supplement,0,0,0,1<<m,0]))),e}}(window),define("common/main/lib/util/character",function(){}),void 0===Common&&(Common={}),define("common/main/lib/view/SymbolTableDialog",["common/main/lib/util/utils","common/main/lib/util/character","common/main/lib/component/InputField","common/main/lib/component/Window"],function(){"use strict";var n={1:"Basic Latin",2:"Latin 1 Supplement",3:"Latin Extended A",4:"Latin Extended B",5:"IPA Extensions",6:"Spacing Modifier Letters",7:"Combining Diacritical Marks",8:"Greek and Coptic",9:"Cyrillic",10:"Cyrillic Supplement",11:"Armenian",12:"Hebrew",13:"Arabic",14:"Syriac",15:"Arabic Supplement",16:"Thaana",17:"NKo",18:"Samaritan",19:"Mandaic",20:"Arabic Extended A",21:"Devanagari",22:"Bengali",23:"Gurmukhi",24:"Gujarati",25:"Oriya",26:"Tamil",27:"Telugu",28:"Kannada",29:"Malayalam",30:"Sinhala",31:"Thai",32:"Lao",33:"Tibetan",34:"Myanmar",35:"Georgian",36:"Hangul Jamo",37:"Ethiopic",38:"Ethiopic Supplement",39:"Cherokee",40:"Unified Canadian Aboriginal Syllabics",41:"Ogham",42:"Runic",43:"Tagalog",44:"Hanunoo",45:"Buhid",46:"Tagbanwa",47:"Khmer",48:"Mongolian",49:"Unified Canadian Aboriginal Syllabics Extended",50:"Limbu",51:"Tai Le",52:"New Tai Lue",53:"Khmer Symbols",54:"Buginese",55:"Tai Tham",56:"Combining Diacritical Marks Extended",57:"Balinese",58:"Sundanese",59:"Batak",60:"Lepcha",61:"Ol Chiki",62:"Cyrillic Extended C",63:"Sundanese Supplement",64:"Vedic Extensions",65:"Phonetic Extensions",66:"Phonetic Extensions Supplement",67:"Combining Diacritical Marks Supplement",68:"Latin Extended Additional",69:"Greek Extended",70:"General Punctuation",71:"Superscripts and Subscripts",72:"Currency Symbols",73:"Combining Diacritical Marks for Symbols",74:"Letterlike Symbols",75:"Number Forms",76:"Arrows",77:"Mathematical Operators",78:"Miscellaneous Technical",79:"Control Pictures",80:"Optical Character Recognition",81:"Enclosed Alphanumerics",82:"Box Drawing",83:"Block Elements",84:"Geometric Shapes",85:"Miscellaneous Symbols",86:"Dingbats",87:"Miscellaneous Mathematical Symbols A",88:"Supplemental Arrows A",89:"Braille Patterns",90:"Supplemental Arrows B",91:"Miscellaneous Mathematical Symbols B",92:"Supplemental Mathematical Operators",93:"Miscellaneous Symbols and Arrows",94:"Glagolitic",95:"Latin Extended C",96:"Coptic",97:"Georgian Supplement",98:"Tifinagh",99:"Ethiopic Extended",100:"Cyrillic Extended A",101:"Supplemental Punctuation",102:"CJK Radicals Supplement",103:"Kangxi Radicals",104:"Ideographic Description Characters",105:"CJK Symbols and Punctuation",106:"Hiragana",107:"Katakana",108:"Bopomofo",109:"Hangul Compatibility Jamo",110:"Kanbun",111:"Bopomofo Extended",112:"CJK Strokes",113:"Katakana Phonetic Extensions",114:"Enclosed CJK Letters and Months",115:"CJK Compatibility",116:"CJK Unified Ideographs Extension",117:"Yijing Hexagram Symbols",118:"CJK Unified Ideographs",119:"Yi Syllables",120:"Yi Radicals",121:"Lisu",122:"Vai",123:"Cyrillic Extended B",124:"Bamum",125:"Modifier Tone Letters",126:"Latin Extended D",127:"Syloti Nagri",128:"Common Indic Number Forms",129:"Phags pa",130:"Saurashtra",131:"Devanagari Extended",132:"Kayah Li",133:"Rejang",134:"Hangul Jamo Extended A",135:"Javanese",136:"Myanmar Extended B",137:"Cham",138:"Myanmar Extended A",139:"Tai Viet",140:"Meetei Mayek Extensions",141:"Ethiopic Extended A",142:"Latin Extended E",143:"Cherokee Supplement",144:"Meetei Mayek",145:"Hangul Syllables",146:"Hangul Jamo Extended B",147:"High Surrogates",148:"High Private Use Surrogates",149:"Low Surrogates",150:"Private Use Area",151:"CJK Compatibility Ideographs",152:"Alphabetic Presentation Forms",153:"Arabic Presentation Forms A",154:"Variation Selectors",155:"Vertical Forms",156:"Combining Half Marks",157:"CJK Compatibility Forms",158:"Small Form Variants",159:"Arabic Presentation Forms B",160:"Halfwidth and Fullwidth Forms",161:"Specials",162:"Linear B Syllabary",163:"Linear B Ideograms",164:"Aegean Numbers",165:"Ancient Greek Numbers",166:"Ancient Symbols",167:"Phaistos Disc",168:"Lycian",169:"Carian",170:"Coptic Epact Numbers",171:"Old Italic",172:"Gothic",173:"Old Permic",174:"Ugaritic",175:"Old Persian",176:"Deseret",177:"Shavian",178:"Osmanya",179:"Osage",180:"Elbasan",181:"Caucasian Albanian",182:"Linear A",183:"Cypriot Syllabary",184:"Imperial Aramaic",185:"Palmyrene",186:"Nabataean",187:"Hatran",188:"Phoenician",189:"Lydian",190:"Meroitic Hieroglyphs",191:"Meroitic Cursive",192:"Kharoshthi",193:"Old South Arabian",194:"Old North Arabian",195:"Manichaean",196:"Avestan",197:"Inscriptional Parthian",198:"Inscriptional Pahlavi",199:"Psalter Pahlavi",200:"Old Turkic",201:"Old Hungarian",202:"Rumi Numeral Symbols",203:"Brahmi",204:"Kaithi",205:"Sora Sompeng",206:"Chakma",207:"Mahajani",208:"Sharada",209:"Sinhala Archaic Numbers",210:"Khojki",211:"Multani",212:"Khudawadi",213:"Grantha",214:"Newa",215:"Tirhuta",216:"Siddham",217:"Modi",218:"Mongolian Supplement",219:"Takri",220:"Ahom",221:"Warang Citi",222:"Pau Cin Hau",223:"Bhaiksuki",224:"Marchen",225:"Cuneiform",226:"Cuneiform Numbers and Punctuation",227:"Early Dynastic Cuneiform",228:"Egyptian Hieroglyphs",229:"Anatolian Hieroglyphs",230:"Bamum Supplement",231:"Mro",232:"Bassa Vah",233:"Pahawh Hmong",234:"Miao",235:"Ideographic Symbols and Punctuation",236:"Tangut",237:"Tangut Components",238:"Kana Supplement",239:"Duployan",240:"Shorthand Format Controls",241:"Byzantine Musical Symbols",242:"Musical Symbols",243:"Ancient Greek Musical Notation",244:"Tai Xuan Jing Symbols",245:"Counting Rod Numerals",246:"Mathematical Alphanumeric Symbols",247:"Sutton SignWriting",248:"Glagolitic Supplement",249:"Mende Kikakui",250:"Adlam",251:"Arabic Mathematical Alphabetic Symbols",252:"Mahjong Tiles",253:"Domino Tiles",254:"Playing Cards",255:"Enclosed Alphanumeric Supplement",256:"Enclosed Ideographic Supplement",257:"Miscellaneous Symbols and Pictographs",258:"Emoticons",259:"Ornamental Dingbats",260:"Transport and Map Symbols",261:"Alchemical Symbols",262:"Geometric Shapes Extended",263:"Supplemental Arrows C",264:"Supplemental Symbols and Pictographs",265:"CJK Unified Ideographs Extension B",266:"CJK Unified Ideographs Extension C",267:"CJK Unified Ideographs Extension D",268:"CJK Unified Ideographs Extension E",269:"CJK Compatibility Ideographs Supplement",270:"Tags",271:"Variation Selectors Supplement",272:"Supplementary Private Use Area A",273:"Supplementary Private Use Area B"},c=[],d=[],s=[],h=-1,a=-1,l=!0,r=-1,m="",p=-1e3,o="",u=-1e3,g=-1,b=-1,C=20,f=20;Common.Views.SymbolTableDialog=Common.UI.Window.extend(_.extend({options:{resizable:!0,minwidth:448,minheight:434,width:448,height:434,cls:"modal-dlg invisible-borders",buttons:["ok","cancel"]},initialize:function(t){var e,i=Common.localStorage.getKeysFilter(),i=(this.appPrefix=i&&i.length?i.split(",")[0]:"",this.appPrefix+"settings-size-symbol-table"),n=Common.Utils.InternalSettings.get(i);if(null==n&&(n=Common.localStorage.getItem(i)||"",Common.Utils.InternalSettings.set(i,n)),n=n?JSON.parse(n):[],this.options=_.extend({resizable:!0,minwidth:448,minheight:434,width:448,height:434,cls:"modal-dlg invisible-borders",buttons:["ok","cancel"]},{title:this.textTitle,width:n[0]||448,height:n[1]||434},t||{}),this.api=this.options.api,this.type=this.options.type||0,this.special=this.options.special||!1,this.showShortcutKey=this.options.showShortcutKey||!1,this.special||(this.options.height-=38),this.special||(this.options.minheight-=38),this.template=['<div class="box">','<div style="margin-bottom: 16px;" class="'+(this.special?"":"hidden")+'">','<button type="button" class="btn btn-text-default auto" id="symbol-table-symbols">',this.textSymbols,"</button>",'<button type="button" class="btn btn-text-default auto" id="symbol-table-special">',this.textSpecial,"</button>","</div>",'<div id="symbol-table-pnl-symbols">','<table cols="2" style="width: 100%;max-width: 497px;">',"<tr>",'<td class="padding-right-5" style="padding-bottom: 8px;width: 50%;">','<label class="input-label">'+this.textFont+"</label>",'<div id="symbol-table-cmb-fonts"></div>',"</td>",'<td class="padding-left-5" style="padding-bottom: 8px;">','<label class="input-label">'+this.textRange+"</label>",'<div id="symbol-table-cmb-range"></div>',"</td>","</tr>","</table>",'<table cols="1" style="width: 100%;">',"<tr>",'<td style="padding-bottom: 16px;">','<div id="symbol-table-scrollable-div" style="position: relative;height:'+(this.options.height-304+38*(this.special?0:1))+'px;">','<div style="width: 100%;">','<div id="id-preview">',"<div>",'<div style="position: absolute; top: 0;"><div id="id-preview-data" tabindex="0" oo_editor_input="true"></div></div>',"</div>","</div>","</div>","</div>","</td>","</tr>","<tr>",'<td style="padding-bottom: 16px;">','<label class="input-label">'+this.textRecent+"</label>",'<div id="symbol-table-recent" tabindex="0" oo_editor_input="true" style="width: 100%;"></div>',"</td>","</tr>","</table>",'<table cols="2" style="width: 100%;max-width: 497px;">',"<tr>",'<td class="padding-right-5" style="width: 50%;">','<label class="input-label">'+this.textCode+"</label>","</td>",'<td class="padding-left-5">',"</td>","</tr>","<tr>",'<td class="padding-right-5">','<div id="symbol-table-text-code" oo_editor_input="true"></div>',"</td>",'<td class="padding-left-5">','<div id="symbol-table-label-font" style="overflow: hidden; text-overflow: ellipsis;white-space: nowrap;max-width: 160px;"></div>',"</td>","</tr>","</table>","</div>",'<div id="symbol-table-pnl-special">','<table cols="1" style="width: 100%;">',"<tr>","<td>","<label>"+this.textCharacter+"</label>",'<label id="symbol-table-lbl-shortcut" style="width: 112px;" class="float-right">'+this.textShortcut+"</label>","</td>","</tr>","<tr>","<td>",'<div id="symbol-table-special-list" class="no-borders" style="width:100%; height: '+(this.options.height-157+38*(this.special?0:1))+'px;"></div>',"</td>","</tr>","</table>","</div>","</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),c.length<1&&this.initFonts(),this.fillRecentSymbols(),t.font?e=t.font:0<s.length&&(e=s[0].font),e)for(var o=0;o<c.length;++o)if(c[o].displayValue===e){h=o;break}h<0&&(h=0),d=this.getArrRangesByFont(h),-1===a&&(a=d[0].Start),t.code?a=t.code:t.symbol?a=this.fixedCharCodeAt(t.symbol,0):0<s.length&&(a=s[0].symbol),Common.UI.Window.prototype.initialize.call(this,this.options),this.on("resizing",_.bind(this.onWindowResizing,this)),this.on("resize",_.bind(this.onWindowResize,this)),l=!0},initFonts:function(){for(var t,e,i,n=this.api.pluginMethod_GetFontList(),o=(n.sort(function(t,e){return t.m_wsFontName<e.m_wsFontName?-1:t.m_wsFontName>e.m_wsFontName?1:0}),[]),s={},a=0;a<n.length;++a)(!(e=s[i=(t=n[a]).m_wsFontName])||e.m_bBold&&e.m_bItalic||e.m_bBold&&!t.m_bBold||e.m_bItalic&&!t.m_bBold&&!t.m_bItalic)&&(s[i]=t);delete s.ASCW3;var l,a=0;for(l in s)s.hasOwnProperty(l)&&(o.push(s[l]),o[o.length-1].displayValue=s[l].m_wsFontName);for((c=o).sort(function(t,e){return t.displayValue.toLowerCase()>e.displayValue.toLowerCase()?1:-1}),a=0;a<c.length;++a)c[a].value=a;if(s[m]||(s["Cambria Math"]?m="Cambria Math":s["Asana-Math"]&&(m="Asana-Math")),s[m])for(a=0;a<c.length;++a)if(c[a].displayValue===m){h=a;break}},render:function(){Common.UI.Window.prototype.render.call(this);var o=this,s=this.getChild(),t=(this.btnSymbols=new Common.UI.Button({el:s.find("#symbol-table-symbols"),enableToggle:!0,toggleGroup:"hyperlink-type",allowDepress:!1,pressed:!0}),this.btnSymbols.on("click",_.bind(this.onModeClick,this,!1)),this.btnSpecial=new Common.UI.Button({el:s.find("#symbol-table-special"),enableToggle:!0,toggleGroup:"hyperlink-type",allowDepress:!1}),this.btnSpecial.on("click",_.bind(this.onModeClick,this,!0)),this.cmbFonts=new Common.UI.ComboBox({el:s.find("#symbol-table-cmb-fonts"),cls:"input-group-nr",data:c,editable:!1,search:!0,menuStyle:"min-width: 100%; max-height: 209px;"}).on("selected",function(t,e){var i=o.getRangeBySymbol(d,a);if(h=e.value,d=o.getArrRangesByFont(h),i){for(var n=0;n<d.length&&i.Name!==d[n].Name;++n);n===d.length&&(a=d[0].Start)}else a=d[0].Start;l=!0,o.updateView(),setTimeout(function(){o.previewPanel.focus()},1)}),this.cmbFonts.setValue(h),this.cmbRange=new Common.UI.ComboBox({el:s.find("#symbol-table-cmb-range"),cls:"input-group-nr",editable:!1,search:!0,menuStyle:"min-width: 100%; max-height: 209px;"}).on("selected",function(t,e){e=o.getRangeByName(d,parseInt(e.value));a=e.Start,l=!0,o.updateView(void 0,void 0,void 0,void 0,!1),setTimeout(function(){o.previewPanel.focus()},1)}),this.updateRangeSelector(),o.inputCode=new Common.UI.InputField({el:s.find("#symbol-table-text-code"),allowBlank:!1,blankError:o.txtEmpty,style:"width: 100%;",validateOnBlur:!1,validateOnChange:!0}).on("changing",function(t,e,i){var n,e=parseInt(e,16);!isNaN(e)&&31<e&&o.getRangeBySymbol(d,e)&&(n=0===s.find("#c"+e).length,a=e,l=!0,o.updateView(n,void 0,!1))}).on("change:after",function(t,e,i){o.updateInput()}),this.symbolTablePanel=s.find("#symbol-table-scrollable-div"),this.previewPanel=s.find("#id-preview-data"),this.previewParent=this.previewPanel.parent(),this.previewScrolled=s.find("#id-preview"),this.previewInner=this.previewScrolled.find("> div:first-child"),this.recentPanel=s.find("#symbol-table-recent"),this.fontLabel=s.find("#symbol-table-label-font"),this.boxPanel=s.find(".box"),this.updateView(void 0,void 0,void 0,!0),[{symbol:"—",description:this.textEmDash,shortcutKey:Common.Utils.String.platformKey(Common.Utils.isMac?"Alt Shift -":"Alt+Ctrl+Num -","{0}"),code:"2014"},{symbol:"–",description:this.textEnDash,shortcutKey:Common.Utils.String.platformKey(Common.Utils.isMac?"Ctrl Num -":"Ctrl+Num -","{0}"),code:"2013"},{symbol:"‑",description:this.textNBHyphen,shortcutKey:Common.Utils.String.platformKey(Common.Utils.isMac?"Ctrl Shift _":"Ctrl+Shift+_","{0}"),code:"002D",special:{NonBreakingHyphen:!0}},{symbol:"",description:this.textEmSpace,shortcutKey:"",code:"2003"},{symbol:"",description:this.textEnSpace,shortcutKey:"",code:"2002"},{symbol:"",description:this.textQEmSpace,shortcutKey:"",code:"2005"},{symbol:"°",description:this.textNBSpace,shortcutKey:Common.Utils.String.platformKey(Common.Utils.isMac?"Alt ":"Ctrl+Shift+","{0}")+"Space",code:"00A0"},{symbol:"©",description:this.textCopyright,shortcutKey:Common.Utils.String.platformKey(Common.Utils.isMac?"Alt Ctrl ":"Alt+Ctrl+","{0}")+"G",code:"00A9"},{symbol:"®",description:this.textRegistered,shortcutKey:Common.Utils.String.platformKey(Common.Utils.isMac?"Alt Ctrl ":"Alt+Ctrl+","{0}")+"R",code:"00AE"},{symbol:"™",description:this.textTradeMark,shortcutKey:Common.Utils.String.platformKey(Common.Utils.isMac?"Alt Ctrl ":"Alt+Ctrl+","{0}")+"T",code:"2122"},{symbol:"§",description:this.textSection,shortcutKey:"",code:"00A7"},{symbol:"¶",description:this.textPilcrow,shortcutKey:"",code:"00B6"},{symbol:"…",description:this.textEllipsis,shortcutKey:Common.Utils.String.platformKey(Common.Utils.isMac?"Alt Ctrl ":"Alt+Ctrl+","{0}")+".",code:"2026"},{symbol:"‛",description:this.textSOQuote,shortcutKey:"",code:"2018"},{symbol:"’",description:this.textSCQuote,shortcutKey:"",code:"2019"},{symbol:"‟",description:this.textDOQuote,shortcutKey:"",code:"201C"},{symbol:"”",description:this.textDCQuote,shortcutKey:"",code:"201D"}]);this.specialList=new Common.UI.ListView({el:s.find("#symbol-table-special-list"),store:new Common.UI.DataViewStore(t),simpleAddMode:!0,cls:"dbl-clickable",itemTemplate:_.template(['<div id="<%= id %>" class="list-item" style="width: 100%;display:flex;">','<div class="padding-right-5" style="width:70px;text-align: center;"><%= symbol %></div>','<div class="padding-right-5" style="flex-grow:1;"><%= description %></div>',"<% if ("+this.showShortcutKey+") { %>",'<div style="width:105px;"><%= shortcutKey %></div>',"<% } %>","</div>"].join(""))}),this.specialList.on("item:dblclick",_.bind(this.onDblClickSpecialItem,this)).on("entervalue",_.bind(this.onDblClickSpecialItem,this)),this.specialList.selectByIndex(0),this.lblShortCut=s.find("#symbol-table-lbl-shortcut"),this.lblShortCut.toggleClass("hidden",!this.showShortcutKey),s.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.symbolsPanel=s.find("#symbol-table-pnl-symbols"),this.specialPanel=s.find("#symbol-table-pnl-special")},show:function(){Common.UI.Window.prototype.show.apply(this,arguments),this.binding||(this.binding={}),this.binding.keydownSymbols=_.bind(this.onKeyDown,this),this.binding.keypressSymbols=_.bind(this.onKeyPress,this),$(document).on("keydown."+this.cid,"#symbol-table-scrollable-div #id-preview-data, #symbol-table-recent",this.binding.keydownSymbols),$(document).on("keypress."+this.cid,"#symbol-table-scrollable-div #id-preview-data, #symbol-table-recent",this.binding.keypressSymbols);var t=this.special&&!!Common.Utils.InternalSettings.get(this.appPrefix+"symbol-table-special");(t?this.btnSpecial:this.btnSymbols).toggle(!0),this.ShowHideElem(t)},close:function(t){$(document).off("keydown."+this.cid,this.binding.keydownSymbols),$(document).off("keypress."+this.cid,this.binding.keypressSymbols),this.special&&Common.Utils.InternalSettings.set(this.appPrefix+"symbol-table-special",this.btnSpecial.isActive()),Common.UI.Window.prototype.close.apply(this,arguments)},getPasteSymbol:function(t){var e,i=!1;return{font:e=t&&0<t.length?((i="c"===t[0])?c[h]:(t=parseInt(t.split("_")[2]),c[t])).displayValue:e,symbol:this.encodeSurrogateChar(a),code:a,updateRecents:i}},getSpecialSymbol:function(){var t=this.specialList.getSelectedRec();return{font:void 0,symbol:this.encodeSurrogateChar(t.get("code")),code:parseInt(t.get("code"),16),special:t.get("special"),speccharacter:!0}},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value,!0)},onPrimary:function(t){return this._handleInput("ok"),!1},_handleInput:function(t,e){var i;!e&&document.activeElement&&"textarea"==document.activeElement.localName&&/area_id/.test(document.activeElement.id)||(e=this.btnSpecial.isActive(),i="ok"==t?e?this.getSpecialSymbol():this.getPasteSymbol(this.$window.find(".cell-selected").attr("id")):{},this.options.handler&&this.options.handler.call(this,this,t,i),"ok"==t&&(e||this.checkRecent(a,i.font),!e&&i.updateRecents&&this.updateRecents(),this.type)||this.close())},encodeSurrogateChar:function(t){var e;return t<65536?String.fromCharCode(t):(e=56320|1023&(t-=65536),String.fromCharCode(55296|t>>10)+String.fromCharCode(e))},fixedCharCodeAt:function(t,e){var i,n=t.charCodeAt(e=e||0);if(55296<=n&&n<=56319){if(i=n,t=t.charCodeAt(e+1),isNaN(t))throw"Старшая часть суррогатной пары без следующей младшей в fixedCharCodeAt()";return 1024*(i-55296)+(t-56320)+65536}return!(56320<=n&&n<=57343)&&n},getArrRangesByFont:function(t){t=getSupportedRangesByFont(c[t]);return 0===t.length&&t.push({Start:32,End:255}),t[0].Start<32&&(t[0].Start=32),t},getRangeBySymbol:function(t,e){for(var i=0;i<t.length;++i)if(t[i].Start<=e&&t[i].End>=e)return t[i];return null},getRangeByName:function(t,e){for(var i=0;i<t.length;++i)if(t[i].Name===e)return t[i];return null},getLinearIndexByCode:function(t,e){for(var i,n=0,o=0;o<t.length;++o){if((i=t[o]).Start>e)return-1;if(i.Start<=e&&i.End>=e)return n+(e-i.Start);n+=i.End-i.Start+1}return-1},getCodeByLinearIndex:function(t,e){if(!(e<0))for(var i,n,o=0,s=(t[0],0);s<t.length;++s){if(e<o+(n=(i=t[s]).End-i.Start+1))return i.Start+e-o;o+=n}return-1},createTable:function(t,e,i){for(var n,o=e*i,s=0,a="",l=0;l<o;++l)n=l/i>>0==e-1?"style='border-bottom: none'":"",l<t.length?a+='<div class="cell" '+n+' id="'+("c"+t[l])+'">&#'+t[l].toString(10)+"</div>":a+='<div class="cell"'+n+"></div>",i<=++s&&(a+='<br class="noselect">',s=0);this.previewPanel.html(a)},fillRecentSymbols:function(){var t,e=Common.localStorage.getItem(this.appPrefix+"recentSymbols");""!=e&&(t=JSON.parse(e)),_.isArray(t)&&(s=t)},saveRecent:function(){var t=JSON.stringify(s);Common.localStorage.setItem(this.appPrefix+"recentSymbols",t)},checkRecent:function(t,e){if(0===s.length)s.push({symbol:t,font:e});else{for(var i=0;i<s.length;++i)if(s[i].symbol===t&&s[i].font===e){s.splice(i,1);break}s.splice(0,0,{symbol:t,font:e}),36<s.length&&s.splice(36,s.length-36)}this.saveRecent()},createCell:function(t,e){var i="",n="";if(e){for(var o=0,s=0;s<c.length;++s)if(c[s].displayValue===e){o=s;break}i="r_"+t+"_"+o,n="&#"+t.toString()}else void 0!==t&&(i="r"+t,n="&#"+t.toString());t=$('<div id="'+i+'">'+n+"</div>");return t.addClass("cell"),t.addClass("noselect"),t.mousedown(_.bind(this.cellClickHandler,this)),e&&t.css("font-family","'"+e+"'"),t},cellClickHandler:function(t){var e,i=$(t.target).attr("id");i&&(e=(new Date).getTime(),i===o&&e-u<300?this.cellDblClickHandler(t):(l="c"===i[0]?(a=parseInt(i.slice(1,i.length)),!0):(i=i.split("_"),a=parseInt(i[1]),r=parseInt(i[2]),!1),this.updateView(!1)),o=t.target.id,u=e)},cellDblClickHandler:function(t){this.type?(t=this.getPasteSymbol($(t.target).attr("id")),this.checkRecent(a,t.font),t.updateRecents&&this.updateView(!1,void 0,void 0,!0),this.fireEvent("symbol:dblclick",this,"ok",t)):this._handleInput("ok")},onDblClickSpecialItem:function(t){var e;this.type?(e=this.getSpecialSymbol(),this.fireEvent("symbol:dblclick",this,"ok",e)):this._handleInput("ok")},updateRecents:function(){var t=this.recentPanel,e=(t.empty(),this.getColsCount()),i=s.length;t.width(31*e);for(var n=0;n<e;++n){var o=n<i?this.createCell(s[n].symbol,s[n].font):this.createCell();o.css("border-bottom","none"),t.append(o),n===e-1&&o.css(Common.UI.isRTL()?"border-left":"border-right","none")}},getColsCount:function(){return(this.boxPanel.innerWidth()-13)/31>>0},getMaxHeight:function(){return this.symbolTablePanel.innerHeight()-2},getRowsCount:function(){return Math.max(1,this.getMaxHeight()/33>>0)},getAllSymbolsCount:function(t){for(var e,i=0,n=0;n<t.length;++n)i+=(e=t[n]).End-e.Start+1;return i},setTable:function(t){for(var e,i=this.getColsCount(),n=this.getRowsCount(),t=this.getLinearIndexByCode(d,t),o=this.getAllSymbolsCount(d),o=Math.ceil(o/i),o=Math.max(0,Math.min(o-n,t/i>>0)),s=o*i,a=n*i,l=[],r=0;r<a&&-1!==(e=this.getCodeByLinearIndex(d,s+r));++r)l.push(e);return this.previewPanel.css("font-family","'"+c[h].displayValue+"'"),this.createTable(l,n,i),o},updateView:function(t,e,i,n,o){l&&!1!==o&&this.updateRangeSelector(),l?this.fontLabel.text(c[h]?c[h].displayValue:""):this.fontLabel.text(c[r]?c[r].displayValue:""),!1!==t&&this.cmbFonts.setValue(h);var s=33*this.getRowsCount();!1!==t&&(o=null!=e?e:a,t=this.setTable(o),e=this.getAllSymbolsCount(d),o=Math.ceil(e/this.getColsCount()),this.previewInner.height(33*o),this.previewPanel.height(s),this.previewScrolled.height(s),this.scrollerY||(C=Math.max(22,s/8+.5>>0),f=Math.min(33*Math.floor(this.previewPanel.height()/33)/10,20),this.scrollerY=new Common.UI.Scroller({el:this.previewScrolled,minScrollbarLength:C,alwaysVisibleY:!0,wheelSpeed:f,useKeyboard:!1,onChange:_.bind(function(){this.scrollerY&&(this._preventUpdateScroll=!0,this.onScrollEnd(),this._preventUpdateScroll=!1,this.previewParent.height(s),this.previewParent.css({top:this.scrollerY.getScrollTop()}))},this)})),this._preventUpdateScroll||(this.scrollerY.update({minScrollbarLength:C,wheelSpeed:f}),this.scrollerY.scrollTop(33*t)),(e=this.previewPanel.find(".cell")).off("mousedown"),e.mousedown(_.bind(this.cellClickHandler,this))),n&&this.updateRecents(),this.$window.find(".cell").removeClass("cell-selected"),(l?this.$window.find("#c"+a):this.$window.find("#r_"+a+"_"+r)).addClass("cell-selected"),!1!==i&&this.updateInput()},onScrollEnd:function(){if(this.scrollerY.getScrollTop()!==p){var t=this.getAllSymbolsCount(d),e=this.getColsCount(),i=this.getRowsCount(),t=Math.ceil(t/e),n=33*t,i=Math.max(0,Math.min(t-i,t*this.scrollerY.getScrollTop()/n+.5>>0));if(p=this.scrollerY.getScrollTop(),l){t=this.previewPanel.children()[0];if(t){n=t.id;if(n){var t=parseInt(n.slice(1,n.length)),n=this.getLinearIndexByCode(d,t),o=i*e+(this.getLinearIndexByCode(d,a)-n),s=(a=this.getCodeByLinearIndex(d,o),i*e);for(o-=e;-1===a&&s<=o;)a=this.getCodeByLinearIndex(d,o),o-=e;-1===a&&(a=this.getCodeByLinearIndex(d,s))}else a=this.getCodeByLinearIndex(d,i*e)}}else a=this.getCodeByLinearIndex(d,i*e),l=!0;this.updateView(!0,this.getCodeByLinearIndex(d,i*e))}},updateInput:function(){for(var t=a.toString(16).toUpperCase(),e=t.length;e<5;++e)t="0"+t;this.inputCode.setValue(t)},updateRangeSelector:function(){var t=this.getRangeBySymbol(d,a);if(t&&t.Name){this.cmbRange.setDisabled(!1);for(var e=[],i=0;i<d.length;++i)e.push({value:d[i].Name,displayValue:n[d[i].Name]});this.cmbRange.setData(e),this.cmbRange.setValue(t.Name)}else this.cmbRange.setDisabled(!0),this.cmbRange.setValue("")},onKeyDown:function(t){var e,i,n,o;document.activeElement&&document.activeElement.nodeName&&"span"===document.activeElement.nodeName.toLowerCase()||(t=t.which||t.charCode||t.keyCode||0,e=!0,l?(n=-1,t===Common.UI.Keys.LEFT?n=this.getCodeByLinearIndex(d,this.getLinearIndexByCode(d,a)-1):t===Common.UI.Keys.UP?n=this.getCodeByLinearIndex(d,this.getLinearIndexByCode(d,a)-this.getColsCount()):t===Common.UI.Keys.RIGHT?n=this.getCodeByLinearIndex(d,this.getLinearIndexByCode(d,a)+1):t===Common.UI.Keys.DOWN?n=this.getCodeByLinearIndex(d,this.getLinearIndexByCode(d,a)+this.getColsCount()):t===Common.UI.Keys.HOME?0<d.length&&(n=d[0].Start):t===Common.UI.Keys.END?0<d.length&&(n=d[d.length-1].End):e=!1,-1<n&&(a=n,n=0===this.$window.find("#c"+a).length,this.updateView(n))):t===Common.UI.Keys.LEFT?(o=this.$window.find(".cell-selected")[0])&&"r"===o.id[0]&&0<(n=this.$window.find(o).prev()).length&&(i=this.$window.find(n).attr("id").split("_"),a=parseInt(i[1]),r=parseInt(i[2]),this.updateView(!1)):t===Common.UI.Keys.RIGHT?(o=this.$window.find(".cell-selected")[0])&&"r"===o.id[0]&&0<(n=this.$window.find(o).next()).length&&(i=this.$window.find(n).attr("id").split("_"),a=parseInt(i[1]),r=parseInt(i[2]),this.updateView(!1)):t===Common.UI.Keys.HOME?(o=this.$window.find("#recent-table").children()[0])&&(i=o.id.split("_"),a=parseInt(i[1]),r=parseInt(i[2]),this.updateView(!1)):t===Common.UI.Keys.END?(o=(n=this.recentPanel.children())[n.length-1])&&(i=o.id.split("_"),a=parseInt(i[1]),r=parseInt(i[2]),this.updateView(!1)):e=!1,e&&(b=t,g=(new Date).getTime()))},onKeyPress:function(t){var e,i;document.activeElement&&document.activeElement.nodeName&&"span"===document.activeElement.nodeName.toLowerCase()||(e=t.which||t.charCode||t.keyCode||0,b===e&&Math.abs(g-(new Date).getTime())<1e3||(!isNaN(e)&&31<e&&this.getRangeBySymbol(d,e)&&(i=0===this.$window.find("#c"+e).length,a=e,l=!0,this.updateView(i,void 0,!0)),t.preventDefault&&t.preventDefault()))},onWindowResize:function(t){var e=this.getSize();t&&"start"==t[1]?(this._preventUpdateScroll=!0,this.curSize={resize:!1,width:e[0],height:e[1]}):this.curSize.resize&&(this._preventUpdateScroll=!1,this.curSize.height=e[1]-304+38*(this.special?0:1),t=33*Math.max(1,(this.curSize.height-2)/33>>0),this.symbolTablePanel.css({height:this.curSize.height+"px"}),this.previewPanel.css({height:t+"px"}),this.previewScrolled.css({height:t+"px"}),this.scrollerY=null,this.updateView(void 0,void 0,void 0,!0),this.specialList.cmpEl.height(e[1]-157+38*(this.special?0:1)),this.special||(e[1]+=38),t=JSON.stringify(e),Common.localStorage.setItem(this.appPrefix+"settings-size-symbol-table",t),Common.Utils.InternalSettings.set(this.appPrefix+"settings-size-symbol-table",t))},onWindowResizing:function(){var t,e;!this.curSize||(t=this.getSize())[0]===this.curSize.width&&t[1]===this.curSize.height||(this.curSize.resize||(this.curSize.resize=!0),this.curSize.width=t[0],this.curSize.height=t[1]-304+38*(this.special?0:1),e=33*Math.max(1,(this.curSize.height-2)/33>>0),this.symbolTablePanel.css({height:this.curSize.height+"px"}),this.previewPanel.css({height:e+"px"}),this.previewScrolled.css({height:e+"px"}),this.specialList.cmpEl.height(t[1]-157+38*(this.special?0:1)),this.updateView(void 0,void 0,void 0,!0))},onModeClick:function(t,e,i){this.ShowHideElem(t)},ShowHideElem:function(t){this.symbolsPanel.toggleClass("hidden",t),this.specialPanel.toggleClass("hidden",!t);var e=this;_.delay(function(){(t?e.specialList:e.previewPanel).focus()},50)}},Common.Views.SymbolTableDialog||{}))}),define("documenteditor/main/app/view/EditListItemDialog",["common/main/lib/component/Window","common/main/lib/component/InputField"],function(){"use strict";DE.Views.EditListItemDialog=Common.UI.Window.extend(_.extend({options:{width:330,header:!1,cls:"modal-dlg",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,t||{}),this.template=['<div class="box">','<div class="input-row">',"<label>"+this.textDisplayName+"</label>","</div>",'<div id="id-dlg-label-name" class="input-row" style="margin-bottom: 8px;"></div>','<div class="input-row">',"<label>"+this.textValue+"</label>","</div>",'<div id="id-dlg-label-value" class="input-row"></div>',"</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var e=this;e.inputName=new Common.UI.InputField({el:$("#id-dlg-label-name"),allowBlank:!1,blankError:e.textNameError,style:"width: 100%;",maxLength:256,validateOnBlur:!1,validation:function(t){return!!t||""}}),e.inputName._input.on("input",function(t){null==e.copyvalue&&e.inputValue.getValue()==e.inputName.getValue()&&(e.copyvalue=1),1==e.copyvalue?e.inputValue.setValue($(t.target).val()):2==e.copyvalue&&(e.copyvalue=0)}),e.inputValue=new Common.UI.InputField({el:$("#id-dlg-label-value"),style:"width: 100%;",maxLength:256,validateOnBlur:!1,validation:function(t){if(""!==t&&e.options.store&&e.options.store.findWhere({value:t}))return e.textValueError;return!0}}),e.inputValue._input.on("input",function(t){null==e.copyvalue&&e.inputValue.getValue()==e.inputName.getValue()&&(e.copyvalue=2),2==e.copyvalue?e.inputName.setValue($(t.target).val()):1==e.copyvalue&&(e.copyvalue=0)}),this.getChild().find(".dlg-btn").on("click",_.bind(this.onBtnClick,this))},getFocusedComponents:function(){return[this.inputName,this.inputValue]},getDefaultFocusableComponent:function(){return this.inputName},onPrimary:function(t){return this._handleInput("ok"),!1},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},_handleInput:function(t){if(this.options.handler){if("ok"==t){if(!0!==this.inputName.checkValidate())return void this.inputName.focus();if(!0!==this.inputValue.checkValidate())return void this.inputValue.focus()}this.options.handler.call(this,t,this.inputName.getValue(),this.inputValue.getValue())}this.close()},setSettings:function(t){t&&(this.inputName.setValue(t.name||""),this.inputValue.setValue(t.value||""))}},DE.Views.EditListItemDialog||{}))}),define("documenteditor/main/app/view/ControlSettingsDialog",["text!documenteditor/main/app/template/ControlSettingsDialog.template","common/main/lib/util/utils","common/main/lib/component/CheckBox","common/main/lib/component/InputField","common/main/lib/view/AdvancedSettingsWindow","common/main/lib/view/SymbolTableDialog","documenteditor/main/app/view/EditListItemDialog"],function(e){"use strict";DE.Views.ControlSettingsDialog=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:310,height:405,toggleGroup:"control-adv-settings-group",storageName:"de-control-settings-adv-category"},initialize:function(t){_.extend(this.options,{title:this.textTitle,items:[{panelId:"id-adv-control-settings-general",panelCaption:this.strGeneral},{panelId:"id-adv-control-settings-lock",panelCaption:this.textLock},{panelId:"id-adv-control-settings-list",panelCaption:this.textCombobox},{panelId:"id-adv-control-settings-date",panelCaption:this.textDate},{panelId:"id-adv-control-settings-checkbox",panelCaption:this.textCheckbox},{panelId:"id-adv-control-settings-field",panelCaption:this.textField},{panelId:"id-adv-control-settings-additional",panelCaption:this.textAdditional}],contentTemplate:_.template(e)({scope:this})},t),this.handler=t.handler,this.props=t.props,this.api=t.api,Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var i=this,t=(this.txtName=new Common.UI.InputField({el:$("#control-settings-txt-name"),allowBlank:!0,validateOnChange:!1,validateOnBlur:!1,style:"width: 100%;",maxLength:64,value:""}),this.txtTag=new Common.UI.InputField({el:$("#control-settings-txt-tag"),allowBlank:!0,validateOnChange:!1,validateOnBlur:!1,style:"width: 100%;",maxLength:64,value:""}),this.txtPlaceholder=new Common.UI.InputField({el:$("#control-settings-txt-pholder"),allowBlank:!0,validateOnChange:!1,validateOnBlur:!1,style:"width: 100%;",value:""}),this.cmbShow=new Common.UI.ComboBox({el:$("#control-settings-combo-show"),cls:"input-group-nr",menuStyle:"min-width: 120px;",editable:!1,takeFocusOnClose:!0,data:[{displayValue:this.textBox,value:Asc.c_oAscSdtAppearance.Frame},{displayValue:this.textNone,value:Asc.c_oAscSdtAppearance.Hidden}]}),this.cmbShow.setValue(Asc.c_oAscSdtAppearance.Frame),this.btnColor=new Common.UI.ColorButton({parentEl:$("#control-settings-color-btn"),auto:{caption:this.textSystemColor,color:Common.Utils.ThemeColor.getHexColor(220,220,220)},additionalAlign:this.menuAddAlign,color:"auto",colors:["000000","993300","333300","003300","003366","000080","333399","333333","800000","FF6600","808000","00FF00","008080","0000FF","666699","808080","FF0000","FF9900","99CC00","339966","33CCCC","3366FF","800080","999999","FF00FF","FFCC00","FFFF00","00FF00","00FFFF","00CCFF","993366","C0C0C0","FF99CC","FFCC99","FFFF99","CCFFCC","CCFFFF","C9C8FF","CC99FF","FFFFFF"],themecolors:0,effects:0,cls:"move-focus",takeFocusOnClose:!0}),this.colors=this.btnColor.getPicker(),this.btnApplyAll=new Common.UI.Button({el:$("#control-settings-btn-all")}),this.btnApplyAll.on("click",_.bind(this.applyAllClick,this)),this.chTemp=new Common.UI.CheckBox({el:$("#control-settings-chb-temp"),labelText:this.txtRemContent}),this.chLockDelete=new Common.UI.CheckBox({el:$("#control-settings-chb-lock-delete"),labelText:this.txtLockDelete}),this.chLockEdit=new Common.UI.CheckBox({el:$("#control-settings-chb-lock-edit"),labelText:this.txtLockEdit}),this.list=new Common.UI.ListView({el:$("#control-settings-list",this.$window),store:new Common.UI.DataViewStore,emptyText:"",template:_.template(['<div class="listview inner" style=""></div>'].join("")),itemTemplate:_.template(['<div id="<%= id %>" class="list-item" style="width: 100%;display:inline-block;">','<div class="margin-right-5" style="width:90px;display: inline-block;vertical-align: middle; overflow: hidden; text-overflow: ellipsis;white-space: pre;"><%= Common.Utils.String.htmlEncode(name) %></div>','<div style="width:90px;display: inline-block;vertical-align: middle; overflow: hidden; text-overflow: ellipsis;white-space: pre;"><%= Common.Utils.String.htmlEncode(value) %></div>',"</div>"].join("")),tabindex:1}),this.list.on("item:select",_.bind(this.onSelectItem,this)),this.btnAdd=new Common.UI.Button({el:$("#control-settings-btn-add")}),this.btnAdd.on("click",_.bind(this.onAddItem,this)),this.btnChange=new Common.UI.Button({el:$("#control-settings-btn-change")}),this.btnChange.on("click",_.bind(this.onChangeItem,this)),this.btnDelete=new Common.UI.Button({el:$("#control-settings-btn-delete")}),this.btnDelete.on("click",_.bind(this.onDeleteItem,this)),this.btnUp=new Common.UI.Button({el:$("#control-settings-btn-up")}),this.btnUp.on("click",_.bind(this.onMoveItem,this,!0)),this.btnDown=new Common.UI.Button({el:$("#control-settings-btn-down")}),this.btnDown.on("click",_.bind(this.onMoveItem,this,!1)),[{value:1068},{value:1026},{value:1029},{value:1030},{value:3079},{value:1031},{value:2055},{value:1032},{value:3081},{value:2057},{value:1033},{value:3082},{value:2058},{value:1035},{value:1036},{value:4108},{value:1040},{value:2064},{value:1041},{value:1042},{value:1062},{value:1038},{value:1043},{value:1045},{value:1046},{value:2070},{value:1049},{value:1051},{value:1060},{value:2077},{value:1053},{value:1055},{value:1058},{value:1066},{value:2052}]);t.forEach(function(t){var e=Common.util.LanguageInfo.getLocalLanguageName(t.value);t.displayValue=e[1],t.langName=e[0]}),this.cmbLang=new Common.UI.ComboBox({el:$("#control-settings-lang"),menuStyle:"min-width: 100%; max-height: 185px;",cls:"input-group-nr",editable:!1,takeFocusOnClose:!0,data:t,search:!0,scrollAlwaysVisible:!0}),this.cmbLang.setValue(1033),this.cmbLang.on("selected",function(t,e){i.updateFormats(e.value)}),this.listFormats=new Common.UI.ListView({el:$("#control-settings-format"),store:new Common.UI.DataViewStore,scrollAlwaysVisible:!0,tabindex:1}),this.listFormats.on("item:select",_.bind(this.onSelectFormat,this)),this.txtDate=new Common.UI.InputField({el:$("#control-settings-txt-format"),allowBlank:!0,validateOnChange:!1,validateOnBlur:!1,style:"width: 100%;",value:""}),this.btnEditChecked=new Common.UI.Button({el:$("#control-settings-btn-checked-edit"),hint:this.tipChange}),this.btnEditChecked.cmpEl.css({"font-size":"16px","line-height":"16px"}),this.btnEditChecked.on("click",_.bind(this.onEditCheckbox,this,!0)),this.btnEditUnchecked=new Common.UI.Button({el:$("#control-settings-btn-unchecked-edit"),hint:this.tipChange}),this.btnEditUnchecked.cmpEl.css({"font-size":"16px","line-height":"16px"}),this.btnEditUnchecked.on("click",_.bind(this.onEditCheckbox,this,!1)),this.txtGroupKey=new Common.UI.InputField({el:$("#control-settings-txt-groupkey"),allowBlank:!0,validateOnChange:!1,validateOnBlur:!1,style:"width: 100%;",value:""}),this.txtKey=new Common.UI.InputField({el:$("#control-settings-txt-key"),allowBlank:!0,validateOnChange:!1,validateOnBlur:!1,style:"width: 100%;",value:""}),this.txtLabel=new Common.UI.InputField({el:$("#control-settings-txt-label"),allowBlank:!0,validateOnChange:!1,validateOnBlur:!1,style:"width: 100%;",value:""}),this.textareaHelp=this.$window.find("#control-settings-txt-help"),this.textareaHelp.keydown(function(t){t.keyCode==Common.UI.Keys.RETURN&&t.stopPropagation(),i.isHelpChanged=!0}),this.chRequired=new Common.UI.CheckBox({el:$("#control-settings-chb-required"),labelText:this.textRequired}),this.btnEditPlaceholder=new Common.UI.Button({el:$("#control-settings-btn-placeholder-edit"),hint:this.tipChange}),this.btnEditPlaceholder.cmpEl.css({"font-size":"16px","line-height":"16px"}),this.btnEditPlaceholder.on("click",_.bind(this.onEditPlaceholder,this)),this.spnWidth=new Common.UI.MetricSpinner({el:$("#control-settings-spin-width"),step:.1,width:80,defaultUnit:"cm",value:"Auto",allowAuto:!0,maxValue:55.88,minValue:.1}),this.spnMaxChars=new Common.UI.MetricSpinner({el:$("#control-settings-spin-max-chars"),step:1,width:53,defaultUnit:"",value:"10",maxValue:1e6,minValue:1}),this.chMaxChars=new Common.UI.CheckBox({el:$("#control-settings-chb-max-chars"),labelText:this.textMaxChars}),this.chMaxChars.on("change",_.bind(function(t,e,i,n){this.spnMaxChars.setDisabled("checked"!=t.getValue())},this)),this.chComb=new Common.UI.CheckBox({el:$("#control-settings-chb-comb"),labelText:this.textComb}),this.chComb.on("change",_.bind(function(t,e,i,n){t="checked"==t.getValue();t&&this.chMaxChars.setValue(!0),this.btnEditPlaceholder.setDisabled(!t),this.spnWidth.setDisabled(!t)},this)),this.afterRender()},getFocusedComponents:function(){return[this.txtName,this.txtTag,this.txtPlaceholder,this.chTemp,this.cmbShow,this.btnColor,this.btnApplyAll,this.chLockDelete,this.chLockEdit,this.list,this.txtDate,this.listFormats,this.cmbLang]},onCategoryClick:function(t,e){Common.Views.AdvancedSettingsWindow.prototype.onCategoryClick.call(this,t,e);var i=this;setTimeout(function(){0==e?i.txtName.focus():1==e?i.chLockDelete.focus():2==e?i.list.focus():3==e&&i.txtDate.focus()},100)},afterRender:function(){var t;this.updateMetricUnit(),this._setDefaults(this.props),this.storageName&&(t=Common.localStorage.getItem(this.storageName),this.setActiveCategory(null!==t?parseInt(t):0))},show:function(){Common.Views.AdvancedSettingsWindow.prototype.show.apply(this,arguments)},_setDefaults:function(t){if(t){var e,i=t.get_Alias(),n=(this.txtName.setValue(i||""),i=t.get_Tag(),this.txtTag.setValue(i||""),i=t.get_PlaceholderText(),this.txtPlaceholder.setValue(i||""),null!=(i=t.get_Appearance())&&this.cmbShow.setValue(i),(i=t.get_Color())?(i=Common.Utils.ThemeColor.getHexColor(i.get_r(),i.get_g(),i.get_b()),this.colors.selectByRGB(i,!0)):(this.colors.clearSelection(),i="auto"),this.btnColor.setAutoColor("auto"==i),this.btnColor.setColor(i),void 0===(i=t.get_Lock())&&(i=Asc.c_oAscSdtLockType.Unlocked),this.chLockDelete.setValue(i==Asc.c_oAscSdtLockType.SdtContentLocked||i==Asc.c_oAscSdtLockType.SdtLocked),this.chLockEdit.setValue(i==Asc.c_oAscSdtLockType.SdtContentLocked||i==Asc.c_oAscSdtLockType.ContentLocked),i=t.get_Temporary(),this.chTemp.setValue(!!i),t.get_SpecificType());if(this.btnsCategory[2].setVisible(n==Asc.c_oAscContentControlSpecificType.ComboBox||n==Asc.c_oAscContentControlSpecificType.DropDownList),n==Asc.c_oAscContentControlSpecificType.ComboBox||n==Asc.c_oAscContentControlSpecificType.DropDownList){if(this.btnsCategory[2].setCaption(n==Asc.c_oAscContentControlSpecificType.ComboBox?this.textCombobox:this.textDropDown),e=n==Asc.c_oAscContentControlSpecificType.ComboBox?t.get_ComboBoxPr():t.get_DropDownListPr()){for(var o=e.get_ItemsCount(),s=[],a=0;a<o;a++)s.push({value:e.get_ItemValue(a),name:e.get_ItemDisplayText(a)});this.list.store.reset(s)}this.disableListButtons()}this.btnsCategory[3].setVisible(n==Asc.c_oAscContentControlSpecificType.DateTime),n==Asc.c_oAscContentControlSpecificType.DateTime&&(e=t.get_DateTimePr())&&((d=(this.datetime=e).get_LangId()||this.options.controlLang)&&(d=(d=this.cmbLang.store.findWhere({value:d}))?d.get("value"):1033,this.cmbLang.setValue(d)),this.updateFormats(this.cmbLang.getValue()),d=e.get_DateFormat(),c=this.listFormats.store.findWhere({format:d}),this.listFormats.selectRecord(c),this.listFormats.scrollToRecord(c),this.txtDate.setValue(d)),this.btnsCategory[4].setVisible(n==Asc.c_oAscContentControlSpecificType.CheckBox),n==Asc.c_oAscContentControlSpecificType.CheckBox&&(e=t.get_CheckBoxPr())&&(l=e.get_CheckedSymbol(),(r=e.get_CheckedFont())&&this.btnEditChecked.cmpEl.css("font-family",r),l&&this.btnEditChecked.setCaption(String.fromCharCode(l)),this.checkedBox={code:l,font:r},l=e.get_UncheckedSymbol(),(r=e.get_UncheckedFont())&&this.btnEditUnchecked.cmpEl.css("font-family",r),l&&this.btnEditUnchecked.setCaption(String.fromCharCode(l)),this.uncheckedBox={code:l,font:r}),this.type=n;var l,r,c=t.get_FormPr(),d=(this.btnsCategory[6].setVisible(!!c),c&&(i=c.get_Key(),this.txtKey.setValue(i||""),i=c.get_Label(),this.txtLabel.setValue(i||""),i=c.get_HelpText(),this.textareaHelp.val(i||""),i=c.get_Required(),this.chRequired.setValue(!!i),d=!0,n==Asc.c_oAscContentControlSpecificType.CheckBox&&e&&(i=e.get_GroupKey(),this.txtGroupKey.setValue(i||""),(d="string"!=typeof i)||this.btnsCategory[4].setCaption(this.textRadiobox)),this.$window.find(".group-key").toggleClass("hidden",d)),t.get_TextFormPr());this.btnsCategory[5].setVisible(!!d),d&&(l=d.get_PlaceHolderSymbol(),(r=d.get_PlaceHolderFont())&&this.btnEditPlaceholder.cmpEl.css("font-family",r),l&&this.btnEditPlaceholder.setCaption(String.fromCharCode(l)),this.placeholder={code:l,font:r},i=d.get_Comb(),this.chComb.setValue(!!i,!0),this.btnEditPlaceholder.setDisabled(!i),this.spnWidth.setDisabled(!i),i=d.get_MaxCharacters(),this.chMaxChars.setValue(i&&0<=i,!0),this.spnMaxChars.setDisabled(!i||i<0),this.spnMaxChars.setValue(i&&0<=i?i:10),i=d.get_Width(),this.spnWidth.setValue(0!==i&&void 0!==i?Common.Utils.Metric.fnRecalcFromMM(25.4*i/20/72):-1,!0)),n!=Asc.c_oAscContentControlSpecificType.CheckBox&&n!=Asc.c_oAscContentControlSpecificType.Picture||c||this.txtPlaceholder.cmpEl&&this.txtPlaceholder.cmpEl.closest("tr").hide()}},getSettings:function(){var i,t,e=new AscCommon.CContentControlPr,n=(e.put_Alias(this.txtName.getValue()),e.put_Tag(this.txtTag.getValue()),e.put_PlaceholderText(this.txtPlaceholder.getValue()||"    "),e.put_Appearance(this.cmbShow.getValue()),this.btnColor.isAutoColor()?e.put_Color(null):(n=this.colors.getColor()||this.btnColor.color)&&(n=Common.Utils.ThemeColor.getRgbColor(n),e.put_Color(n.get_r(),n.get_g(),n.get_b())),e.put_Temporary("checked"===this.chTemp.getValue()),Asc.c_oAscSdtLockType.Unlocked);return"checked"==this.chLockDelete.getValue()&&"checked"==this.chLockEdit.getValue()?n=Asc.c_oAscSdtLockType.SdtContentLocked:"checked"==this.chLockDelete.getValue()?n=Asc.c_oAscSdtLockType.SdtLocked:"checked"==this.chLockEdit.getValue()&&(n=Asc.c_oAscSdtLockType.ContentLocked),e.put_Lock(n),this.type!=Asc.c_oAscContentControlSpecificType.ComboBox&&this.type!=Asc.c_oAscContentControlSpecificType.DropDownList||((i=this.type==Asc.c_oAscContentControlSpecificType.ComboBox?this.props.get_ComboBoxPr():this.props.get_DropDownListPr()).clear(),this.list.store.each(function(t,e){i.add_Item(t.get("name"),t.get("value"))}),this.type==Asc.c_oAscContentControlSpecificType.ComboBox?e.put_ComboBoxPr(i):e.put_DropDownListPr(i)),this.type==Asc.c_oAscContentControlSpecificType.DateTime&&((i=this.props.get_DateTimePr()).put_DateFormat(this.txtDate.getValue()),i.put_LangId(this.cmbLang.getValue()),e.put_DateTimePr(i)),this.type==Asc.c_oAscContentControlSpecificType.CheckBox&&(this.checkedBox&&this.checkedBox.changed||this.uncheckedBox&&this.uncheckedBox.changed)&&(i=this.props.get_CheckBoxPr(),this.checkedBox&&(i.put_CheckedSymbol(this.checkedBox.code),i.put_CheckedFont(this.checkedBox.font)),this.uncheckedBox&&(i.put_UncheckedSymbol(this.uncheckedBox.code),i.put_UncheckedFont(this.uncheckedBox.font)),e.put_CheckBoxPr(i)),this.btnsCategory[6].isVisible()&&((n=new AscCommon.CSdtFormPr).put_Key(this.txtKey.getValue()),n.put_Label(this.txtLabel.getValue()),n.put_Required("checked"==this.chRequired.getValue()),this.isHelpChanged&&n.put_HelpText(this.textareaHelp.val()),this.type!=Asc.c_oAscContentControlSpecificType.CheckBox||this.$window.find(".group-key").hasClass("hidden")||(i=this.props.get_CheckBoxPr())&&(i.put_GroupKey(this.txtGroupKey.getValue()),e.put_CheckBoxPr(i)),e.put_FormPr(n)),this.btnsCategory[5].isVisible()&&(n=new AscCommon.CSdtTextFormPr,this.spnWidth.getValue()?(t=this.spnWidth.getNumberValue(),n.put_Width(t<=0?0:parseInt(72*Common.Utils.Metric.fnRecalcToMM(t)*20/25.4))):n.put_Width(0),this.placeholder&&this.placeholder.changed&&(n.put_PlaceHolderSymbol(this.placeholder.code),n.put_PlaceHolderFont(this.placeholder.font)),n.put_Comb("checked"==this.chComb.getValue()),t="checked"==this.chMaxChars.getValue()||"checked"==this.chComb.getValue(),n.put_MaxCharacters(t),t&&n.put_MaxCharacters(this.spnMaxChars.getNumberValue()||10),e.put_TextFormPr(n)),e},onDlgBtnClick:function(t){t="object"==typeof t?t.currentTarget.attributes.result.value:t;"ok"==t&&this.handler&&this.handler.call(this,t,this.getSettings()),this.close()},applyAllClick:function(t,e){var i,n;this.api&&((i=new AscCommon.CContentControlPr).put_Appearance(this.cmbShow.getValue()),this.btnColor.isAutoColor()?i.put_Color(null):(n=this.colors.getColor()||this.btnColor.color)&&(n=Common.Utils.ThemeColor.getRgbColor(n),i.put_Color(n.get_r(),n.get_g(),n.get_b())),this.api.asc_SetContentControlProperties(i,null,!0))},onSelectItem:function(t,e,i){this.disableListButtons(!1)},disableListButtons:function(t){void 0===t&&(t=!this.list.getSelectedRec()),this.btnChange.setDisabled(t),this.btnDelete.setDisabled(t),this.btnUp.setDisabled(t),this.btnDown.setDisabled(t)},onAddItem:function(){var n=this;new DE.Views.EditListItemDialog({store:n.list.store,handler:function(t,e,i){"ok"==t&&(t=n.list.store.add({value:i,name:e}))&&(n.list.selectRecord(t),n.list.scrollToRecord(t),n.disableListButtons()),n.list.focus()}}).show()},onChangeItem:function(){var n=this,o=this.list.getSelectedRec(),t=new DE.Views.EditListItemDialog({store:n.list.store,handler:function(t,e,i){"ok"==t&&o&&o.set({value:i,name:e}),n.list.focus()}});o&&t.show(),o&&t.setSettings({name:o.get("name"),value:o.get("value")})},onDeleteItem:function(t,e){var i,n,o=this.list.getSelectedRec();o&&(i=this.list.store,n=_.indexOf(i.models,o),i.remove(o),n>i.length-1&&(n=i.length-1),0<i.length&&(this.list.selectByIndex(n),this.list.scrollToRecord(i.at(n)))),this.disableListButtons(),this.list.focus()},onMoveItem:function(t){var e,i=this.list.store,n=i.length,o=this.list.getSelectedRec();o&&(e=i.indexOf(o),i.add(i.remove(o),{at:t?Math.max(0,e-1):Math.min(n-1,e+1)}),this.list.selectRecord(o),this.list.scrollToRecord(o)),this.list.focus()},updateFormats:function(t){if(this.datetime){for(var e=this.datetime,i=e.get_FormatsExamples(),n=[],o=0,s=i.length;o<s;o++)e.get_String(i[o],void 0,t),(a=new Common.UI.DataViewModel).set({format:i[o],value:e.get_String(i[o],void 0,t)}),n.push(a);this.listFormats.store.reset(n),this.listFormats.selectByIndex(0);var a=this.listFormats.getSelectedRec();this.listFormats.scrollToRecord(a),this.txtDate.setValue(a.get("format"))}},onEditCheckbox:function(t){var n,o,e;this.api&&(n=t?this.checkedBox:this.uncheckedBox,o=t?this.btnEditChecked:this.btnEditUnchecked,(e=new Common.Views.SymbolTableDialog({api:this.api,lang:this.options.interfaceLang,modal:!0,type:0,font:n.font,code:n.code,handler:t=function(t,e,i){"ok"==e&&(n.changed=!0,n.code=i.code,n.font=i.font,n.font&&o.cmpEl.css("font-family",n.font),i.symbol&&o.setCaption(i.symbol))}})).show(),e.on("symbol:dblclick",t))},onEditPlaceholder:function(){var n,o,t,e;this.api&&(n=this.placeholder,o=this.btnEditPlaceholder,(e=new Common.Views.SymbolTableDialog({api:this.api,lang:this.options.interfaceLang,modal:!0,type:0,font:n.font,code:n.code,handler:t=function(t,e,i){"ok"==e&&(n.changed=!0,n.code=i.code,n.font=i.font,n.font&&o.cmpEl.css("font-family",n.font),i.symbol&&o.setCaption(i.symbol))}})).show(),e.on("symbol:dblclick",t))},onSelectFormat:function(t,e,i){i&&this.txtDate.setValue(i.get("format"))},updateMetricUnit:function(){this.spnWidth.setDefaultUnit(Common.Utils.Metric.getCurrentMetricName()),this.spnWidth.setStep(Common.Utils.Metric.getCurrentMetric()==Common.Utils.Metric.c_MetricUnits.pt?1:.1)}},DE.Views.ControlSettingsDialog||{}))}),define("documenteditor/main/app/view/NumberingValueDialog",["common/main/lib/component/Window","common/main/lib/component/MetricSpinner"],function(){"use strict";DE.Views.NumberingValueDialog=Common.UI.Window.extend(_.extend({options:{width:214,header:!0,style:"min-width: 214px;",cls:"modal-dlg",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:this.textTitle},t||{}),this.template=['<div class="box">','<div class="input-row">','<div id="id-spin-set-value"></div>',"</div>","</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),this.props=this.options.props,Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this),this.spnStart=new Common.UI.CustomSpinner({el:$("#id-spin-set-value"),step:1,width:182,defaultUnit:"",value:1,maxValue:16383,minValue:0,allowDecimal:!1,maskExp:/[0-9]/}),this.getChild().find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.spnStart.on("entervalue",_.bind(this.onPrimary,this)),this.spnStart.$el.find("input").focus(),this.afterRender()},afterRender:function(){this._setDefaults(this.props)},_setDefaults:function(t){t&&(this.spnStart.setValue(t.start),this.onFormatSelect(t.format))},_handleInput:function(t){this.options.handler&&this.options.handler.call(this,t,this.getSettings()),this.close()},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},getSettings:function(){return this.spnStart.getNumberValue()},onPrimary:function(){return this._handleInput("ok"),!1},onFormatSelect:function(t){var e=/[0-9]/,i=this;switch(t){case Asc.c_oAscNumberingFormat.UpperRoman:this.spnStart.options.toCustomFormat=this._10toRome,this.spnStart.options.fromCustomFormat=this._Rometo10,e=/[IVXLCDM]/;break;case Asc.c_oAscNumberingFormat.LowerRoman:this.spnStart.options.toCustomFormat=function(t){return i._10toRome(t).toLocaleLowerCase()},this.spnStart.options.fromCustomFormat=function(t){return i._Rometo10(t.toLocaleUpperCase())},e=/[ivxlcdm]/;break;case Asc.c_oAscNumberingFormat.UpperLetter:this.spnStart.options.toCustomFormat=this._10toS,this.spnStart.options.fromCustomFormat=this._Sto10,e=/[A-Z]/;break;case Asc.c_oAscNumberingFormat.LowerLetter:this.spnStart.options.toCustomFormat=function(t){return i._10toS(t).toLocaleLowerCase()},this.spnStart.options.fromCustomFormat=function(t){return i._Sto10(t.toLocaleUpperCase())},e=/[a-z]/;break;default:this.spnStart.options.toCustomFormat=function(t){return t},this.spnStart.options.fromCustomFormat=function(t){return t}}this.spnStart.setMask(e),this.spnStart.setValue(this.spnStart.getValue())},_10toS:function(t){t=parseInt(t);for(var e=Math.ceil(t/26),i=String.fromCharCode((t-1)%26+"A".charCodeAt(0)),n="",o=0;o<e;o++)n+=i;return n},_Sto10:function(t){var e;return t.length<1||new RegExp("[^"+t.charAt(0)+"]").test(t)||!/[A-Z]/.test(t)?1:(e=t.length-1,t.charCodeAt(0)-"A".charCodeAt(0)+1+26*e)},_10toRome:function(t){t=parseInt(t);for(var e="",i=[["M",1e3],["CM",900],["D",500],["CD",400],["C",100],["XC",90],["L",50],["XL",40],["X",10],["IX",9],["V",5],["IV",4],["I",1]],n=i[0][1],o=Math.floor(t/n),s=0,a=0;a<o;a++)e+=i[s][0];for(t-=o*n,s++;0<t;)0<=(o=t-i[s][1])?(e+=i[s][0],t=o):s++;return e},_Rometo10:function(t){if(!/[IVXLCDM]/.test(t)||t.length<1)return 1;for(var e={I:1,V:5,X:10,L:50,C:100,D:500,M:1e3},i=t.length-1,n=e[t.charAt(i)],o=n,s=i-1;0<=s;s--){var a=e[t.charAt(s)];if(a<o){if(10<o/a)return 1;a*=-1}n+=a,o=Math.abs(a)}return n}},DE.Views.NumberingValueDialog||{}))}),define("documenteditor/main/app/view/CellsAddDialog",["common/main/lib/component/Window","common/main/lib/component/ComboBox","common/main/lib/component/MetricSpinner","common/main/lib/component/RadioBox"],function(){"use strict";DE.Views.CellsAddDialog=Common.UI.Window.extend(_.extend({options:{width:214,header:!0,style:"min-width: 214px;",cls:"modal-dlg",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:this.textTitle},t||{}),this.template=['<div class="box">','<div style="margin-bottom: 10px;">','<div id="table-combo-row-col" class="input-group-nr margin-right-5" style="display: inline-block;"></div>','<div id="table-spin-row-col" style="display: inline-block;"></div>',"</div>",'<div id="table-radio-before" style="padding-bottom: 8px;"></div>','<div id="table-radio-after" style="padding-bottom: 8px;"></div>',"</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this),this.cmbRowCol=new Common.UI.ComboBox({el:$("#table-combo-row-col"),cls:"input-group-nr",style:"width: 110px;",menuStyle:"min-width: 110px;",editable:!1,takeFocusOnClose:!0,scrollAlwaysVisible:!0,data:[{value:0,displayValue:this.textRow},{value:1,displayValue:this.textCol}]}),this.cmbRowCol.setValue(0),this.cmbRowCol.on("selected",_.bind(function(t,e){e=0==e.value;this.spnCount.setMaxValue(e?100:64),this.spnCount.setValue(this.spnCount.getNumberValue()),this.radioBefore.setCaption(e?this.textUp:this.textLeft),this.radioAfter.setCaption(e?this.textDown:this.textRight)},this)),this.spnCount=new Common.UI.MetricSpinner({el:$("#table-spin-row-col"),step:1,width:65,value:1,defaultUnit:"",maxValue:100,minValue:1,allowDecimal:!1}),this.radioBefore=new Common.UI.RadioBox({el:$("#table-radio-before"),labelText:this.textUp,name:"asc-radio-table-cells-add",checked:!0}),this.radioAfter=new Common.UI.RadioBox({el:$("#table-radio-after"),labelText:this.textDown,name:"asc-radio-table-cells-add"}),this.getChild().find(".dlg-btn").on("click",_.bind(this.onBtnClick,this))},getFocusedComponents:function(){return[this.cmbRowCol,this.spnCount,this.radioBefore,this.radioAfter]},getDefaultFocusableComponent:function(){return this.spnCount},_handleInput:function(t){this.options.handler&&this.options.handler.call(this,t,this.getSettings()),this.close()},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},getSettings:function(){return{row:0==this.cmbRowCol.getValue(),before:this.radioBefore.getValue(),count:this.spnCount.getNumberValue()}},onPrimary:function(){return this._handleInput("ok"),!1}},DE.Views.CellsAddDialog||{}))}),define("documenteditor/main/app/view/ListIndentsDialog",["common/main/lib/component/Window","common/main/lib/component/MetricSpinner"],function(){"use strict";DE.Views.ListIndentsDialog=Common.UI.Window.extend(_.extend({options:{width:305,header:!0,style:"min-width: 216px;",cls:"modal-dlg",id:"window-list-indents",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:this.textTitle},t||{}),this.props=t.props,this.isBullet=t.isBullet||!1,this.template=['<div class="box" style="height: 85px;">','<table cols="2" style="width: 100%;">',"<tr>",'<td class="padding-right-10">','<label class="input-label">'+(this.isBullet?this.txtPosBullet:this.txtPosNumber)+"</label>",'<div id="id-dlg-indents-align-at" style="margin-bottom: 10px;"></div>',"</td>","<td>",'<label class="input-label">'+this.txtIndent+"</label>",'<div id="id-dlg-indents-indent" style="margin-bottom: 10px;"></div>',"</td>","</tr>","<tr>",'<td colspan="2">','<label class="input-label">'+(this.isBullet?this.txtFollowBullet:this.txtFollowNumber)+"</label>",'<div id="id-dlg-indents-follow" class="input-group-nr" style="width: 100%;margin-bottom: 10px;"></div>',"</td>","</tr>","</table>","</div>",'<div class="separator horizontal"></div>'].join(""),this.options.tpl=_.template(this.template)(this.options),this.spinners=[],this._noApply=!1,Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this.getChild();this.spnAlign=new Common.UI.MetricSpinner({el:t.findById("#id-dlg-indents-align-at"),step:.1,width:130,defaultUnit:"cm",defaultValue:0,value:"0 cm",maxValue:55.87,minValue:0}),this.spinners.push(this.spnAlign),this.spnAlign.on("change",_.bind(function(t,e,i,n){this._changedProps&&this._changedProps.put_NumberPosition(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue()))},this)),this.spnIndents=new Common.UI.MetricSpinner({el:t.findById("#id-dlg-indents-indent"),step:.1,width:130,defaultUnit:"cm",defaultValue:0,value:"0 cm",maxValue:55.87,minValue:0}),this.spinners.push(this.spnIndents),this.spnIndents.on("change",_.bind(function(t,e,i,n){this._changedProps&&this._changedProps.put_IndentSize(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue()))},this)),this.cmbFollow=new Common.UI.ComboBox({el:t.find("#id-dlg-indents-follow"),menuStyle:"min-width: 100%;",editable:!1,cls:"input-group-nr",data:[{value:Asc.c_oAscNumberingSuff.Tab,displayValue:this.textTab},{value:Asc.c_oAscNumberingSuff.Space,displayValue:this.textSpace},{value:Asc.c_oAscNumberingSuff.None,displayValue:this.txtNone}],takeFocusOnClose:!0}),this.cmbFollow.on("selected",_.bind(function(t,e){this._changedProps&&this._changedProps.put_Suff(e.value)},this)),t.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.updateMetricUnit(),this._setDefaults(this.props)},getFocusedComponents:function(){return[this.spnAlign,this.spnIndents,this.cmbFollow]},getDefaultFocusableComponent:function(){return this.spnAlign},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onPrimary:function(t){return this._handleInput("ok"),!1},_handleInput:function(t){this.options.handler&&this.options.handler.call(this,t,this._changedProps),this.close()},_setDefaults:function(t){t&&(this.spnAlign.setValue(Common.Utils.Metric.fnRecalcFromMM(t.get_NumberPosition()),!0),this.spnIndents.setValue(Common.Utils.Metric.fnRecalcFromMM(t.get_IndentSize()),!0),this.cmbFollow.setValue(t.get_Suff()),this.isBullet=t.get_Format()===Asc.c_oAscNumberingFormat.Bullet,this._changedProps=t)},updateMetricUnit:function(){if(this.spinners)for(var t=0;t<this.spinners.length;t++){var e=this.spinners[t];e.setDefaultUnit(Common.Utils.Metric.getCurrentMetricName()),e.setStep(Common.Utils.Metric.getCurrentMetric()==Common.Utils.Metric.c_MetricUnits.pt?1:.1)}}},DE.Views.ListIndentsDialog||{}))}),define("documenteditor/main/app/view/DocumentHolder",["jquery","underscore","backbone","gateway","common/main/lib/util/utils","common/main/lib/component/Menu","common/main/lib/component/Calendar","common/main/lib/view/InsertTableDialog","common/main/lib/view/CopyWarningDialog","common/main/lib/view/OptionsDialog","documenteditor/main/app/view/DropcapSettingsAdvanced","documenteditor/main/app/view/HyperlinkSettingsDialog","documenteditor/main/app/view/ParagraphSettingsAdvanced","documenteditor/main/app/view/TableSettingsAdvanced","documenteditor/main/app/view/ControlSettingsDialog","documenteditor/main/app/view/NumberingValueDialog","documenteditor/main/app/view/CellsAddDialog","documenteditor/main/app/view/ListIndentsDialog"],function(n,R,t,e){"use strict";DE.Views.DocumentHolder=t.View.extend(R.extend({el:"#editor_sdk",template:null,events:{},initialize:function(){this._currentMathObj=void 0,this._currentSpellObj=void 0,this._currentParaObjDisabled=!1,this._currLang={},this._isDisabled=!1,this._preventCustomClick=null,this._hasCustomItems=!1,this._docProtection={isReadOnly:!1,isReviewOnly:!1,isFormsOnly:!1,isCommentsOnly:!1}},render:function(){return this.fireEvent("render:before",this),this.cmpEl=n(this.el),this.fireEvent("render:after",this),this},setApi:function(t){return this.api=t,this},setMode:function(t){return this.mode=t,this._fillFormMode=!this.mode.isEdit&&this.mode.canFillForms,this},createDelayedElementsViewer:function(){var r=this;r.menuViewCopy=new Common.UI.MenuItem({iconCls:"menu__icon btn-copy",caption:r.textCopy,value:"copy"}),r.menuViewPaste=new Common.UI.MenuItem({iconCls:"menu__icon btn-paste",caption:r.textPaste,value:"paste"}),r.menuViewCut=new Common.UI.MenuItem({iconCls:"menu__icon btn-cut",caption:r.textCut,value:"cut"}),r.menuViewUndo=new Common.UI.MenuItem({iconCls:"menu__icon btn-undo",caption:r.textUndo}),r.menuViewCopySeparator=new Common.UI.MenuItem({caption:"--"}),r.menuViewAddComment=new Common.UI.MenuItem({iconCls:"menu__icon btn-menu-comments",caption:r.addCommentText}),r.menuSignatureViewSign=new Common.UI.MenuItem({caption:this.strSign,value:0}),r.menuSignatureDetails=new Common.UI.MenuItem({caption:this.strDetails,value:1}),r.menuSignatureViewSetup=new Common.UI.MenuItem({caption:this.strSetup,value:2}),r.menuSignatureRemove=new Common.UI.MenuItem({caption:this.strDelete,value:3}),r.menuViewSignSeparator=new Common.UI.MenuItem({caption:"--"}),r.menuViewPrint=new Common.UI.MenuItem({iconCls:"menu__icon btn-print",caption:r.txtPrintSelection}),this.viewModeMenu=new Common.UI.Menu({cls:"shifted-right",initMenu:function(t){var e=t.imgProps&&t.imgProps.value&&!R.isNull(t.imgProps.value.get_ChartProperties()),i=t.imgProps&&t.imgProps.value&&!R.isNull(t.imgProps.value.get_ShapeProperties()),n=t.imgProps&&t.imgProps.value&&r.mode.isSignatureSupport?t.imgProps.value.asc_getSignatureId():void 0,o=n?r.api.asc_getSignatureSetup(n):null,s=!!o&&r._canProtect,a=!!t.paraProps&&!(t.paraProps.value.can_DeleteBlockContentControl()&&t.paraProps.value.can_EditBlockContentControl()&&t.paraProps.value.can_DeleteInlineContentControl()&&t.paraProps.value.can_EditInlineContentControl()),e=!e&&!1!==r.api.can_AddQuotedComment()&&r.mode.canCoAuthoring&&r.mode.canComments&&!r._isDisabled&&!a,l=!1,i=(r.mode.compatibleFeatures&&(e=e&&!i),r.api.asc_IsContentControl()&&(i=(i=r.api.asc_GetContentControlProperties())?i.get_SpecificType():Asc.c_oAscContentControlSpecificType.None,e=e&&!(i==Asc.c_oAscContentControlSpecificType.CheckBox||i==Asc.c_oAscContentControlSpecificType.Picture||i==Asc.c_oAscContentControlSpecificType.ComboBox||i==Asc.c_oAscContentControlSpecificType.DropDownList||i==Asc.c_oAscContentControlSpecificType.DateTime),l=void 0!==i&&(i===Asc.c_oAscContentControlSpecificType.None||i===Asc.c_oAscContentControlSpecificType.ComboBox||i===Asc.c_oAscContentControlSpecificType.Complex)&&!a),r.menuViewUndo.setVisible(r.mode.canCoAuthoring&&r.mode.canComments&&!r._isDisabled),r.menuViewUndo.setDisabled(!r.api.asc_getCanUndo()||r._docProtection.isReadOnly),r.menuViewCopySeparator.setVisible(s),!!o&&o.asc_getRequested()),a=(r.menuSignatureViewSign.setVisible(s&&i),r.menuSignatureDetails.setVisible(s&&!i),r.menuSignatureViewSetup.setVisible(s),r.menuSignatureRemove.setVisible(s&&!i),r.menuViewSignSeparator.setVisible(e),s&&(r.menuSignatureViewSign.cmpEl.attr("data-value",n),r.menuSignatureDetails.cmpEl.attr("data-value",o.asc_getId()),r.menuSignatureViewSetup.cmpEl.attr("data-value",n),r.menuSignatureRemove.cmpEl.attr("data-value",n)),r.menuViewAddComment.setVisible(e),r.menuViewAddComment.setDisabled(t.paraProps&&!0===t.paraProps.locked||r._docProtection.isReadOnly||r._docProtection.isFormsOnly),t.paraProps&&!0===t.paraProps.locked),i=r.api&&r.api.can_CopyCut();r.menuViewCopy.setDisabled(!i),r.menuViewCut.setVisible(r._fillFormMode&&l),r.menuViewCut.setDisabled(a||!i||r._docProtection.isReadOnly||r._docProtection.isCommentsOnly),r.menuViewPaste.setVisible(r._fillFormMode&&l),r.menuViewPaste.setDisabled(a||r._docProtection.isReadOnly||r._docProtection.isCommentsOnly),r.menuViewPrint.setVisible(r.mode.canPrint&&!r._fillFormMode),r.menuViewPrint.setDisabled(!i)},items:[r.menuViewCut,r.menuViewCopy,r.menuViewPaste,r.menuViewUndo,r.menuViewPrint,r.menuViewCopySeparator,r.menuSignatureViewSign,r.menuSignatureDetails,r.menuSignatureViewSetup,r.menuSignatureRemove,r.menuViewSignSeparator,r.menuViewAddComment]}).on("hide:after",function(t,e,i){r.clearCustomItems(t),r.currentMenu=null,r.suppressEditComplete?r.suppressEditComplete=!1:i||r.fireEvent("editcomplete",r)}),this.fireEvent("createdelayedelements",[this,"view"])},createDelayedElementsPDFViewer:function(){var n=this;n.menuPDFViewCopy=new Common.UI.MenuItem({iconCls:"menu__icon btn-copy",caption:n.textCopy,value:"copy"}),this.viewPDFModeMenu=new Common.UI.Menu({cls:"shifted-right",initMenu:function(t){n.menuPDFViewCopy.setDisabled(!(n.api&&n.api.can_CopyCut()))},items:[n.menuPDFViewCopy]}).on("hide:after",function(t,e,i){n.clearCustomItems(t),n.currentMenu=null,n.suppressEditComplete?n.suppressEditComplete=!1:i||n.fireEvent("editcomplete",n)}),this.fireEvent("createdelayedelements",[this,"pdf"])},createDelayedElements:function(){var p=this,t=(p.menuInsertCaption=new Common.UI.MenuItem({caption:p.txtInsertCaption}),new Common.UI.MenuItem({caption:"--"})),e=(p.menuSaveAsPicture=new Common.UI.MenuItem({caption:p.textSaveAsPicture}),new Common.UI.MenuItem({caption:"--"})),u=(p.menuEquationInsertCaption=new Common.UI.MenuItem({caption:p.txtInsertCaption}),new Common.UI.MenuItem({caption:"--"})),d=(p.menuImageAlign=new Common.UI.MenuItem({caption:p.textAlign,menu:new Common.UI.Menu({cls:"ppm-toolbar shifted-right",menuAlign:"tl-tr",items:[new Common.UI.MenuItem({caption:p.textShapeAlignLeft,iconCls:"menu__icon btn-shape-align-left",value:Asc.c_oAscAlignShapeType.ALIGN_LEFT}),new Common.UI.MenuItem({caption:p.textShapeAlignCenter,iconCls:"menu__icon btn-shape-align-center",value:Asc.c_oAscAlignShapeType.ALIGN_CENTER}),new Common.UI.MenuItem({caption:p.textShapeAlignRight,iconCls:"menu__icon btn-shape-align-right",value:Asc.c_oAscAlignShapeType.ALIGN_RIGHT}),new Common.UI.MenuItem({caption:p.textShapeAlignTop,iconCls:"menu__icon btn-shape-align-top",value:Asc.c_oAscAlignShapeType.ALIGN_TOP}),new Common.UI.MenuItem({caption:p.textShapeAlignMiddle,iconCls:"menu__icon btn-shape-align-middle",value:Asc.c_oAscAlignShapeType.ALIGN_MIDDLE}),new Common.UI.MenuItem({caption:p.textShapeAlignBottom,iconCls:"menu__icon btn-shape-align-bottom",value:Asc.c_oAscAlignShapeType.ALIGN_BOTTOM}),{caption:"--"},new Common.UI.MenuItem({caption:p.txtDistribHor,iconCls:"menu__icon btn-shape-distribute-hor",value:6}),new Common.UI.MenuItem({caption:p.txtDistribVert,iconCls:"menu__icon btn-shape-distribute-vert",value:7})]})}),p.mnuGroup=new Common.UI.MenuItem({caption:this.txtGroup,iconCls:"menu__icon btn-shape-group"}),p.mnuUnGroup=new Common.UI.MenuItem({iconCls:"menu__icon btn-shape-ungroup",caption:this.txtUngroup}),p.menuImageArrange=new Common.UI.MenuItem({caption:p.textArrange,menu:new Common.UI.Menu({cls:"ppm-toolbar shifted-right",menuAlign:"tl-tr",items:[new Common.UI.MenuItem({caption:p.textArrangeFront,iconCls:"menu__icon btn-arrange-front",valign:Asc.c_oAscChangeLevel.BringToFront}),new Common.UI.MenuItem({caption:p.textArrangeBack,iconCls:"menu__icon btn-arrange-back",valign:Asc.c_oAscChangeLevel.SendToBack}),new Common.UI.MenuItem({caption:p.textArrangeForward,iconCls:"menu__icon btn-arrange-forward",valign:Asc.c_oAscChangeLevel.BringForward}),new Common.UI.MenuItem({caption:p.textArrangeBackward,iconCls:"menu__icon btn-arrange-backward",valign:Asc.c_oAscChangeLevel.BringBackward}),{caption:"--"},p.mnuGroup,p.mnuUnGroup]})}),p.menuWrapPolygon=new Common.UI.MenuItem({caption:p.textEditWrapBoundary,cls:"no-icon-wrap-item"}),p.menuImageWrap=new Common.UI.MenuItem({iconCls:"menu__icon btn-small-wrap-inline",caption:p.textWrap,menu:new Common.UI.Menu({cls:"ppm-toolbar shifted-right",menuAlign:"tl-tr",items:[new Common.UI.MenuItem({caption:p.txtInline,iconCls:"menu__icon btn-small-wrap-inline",toggleGroup:"popuppicturewrapping",wrapType:Asc.c_oAscWrapStyle2.Inline,checkmark:!1,checkable:!0}),{caption:"--"},new Common.UI.MenuItem({caption:p.txtSquare,iconCls:"menu__icon btn-small-wrap-square",toggleGroup:"popuppicturewrapping",wrapType:Asc.c_oAscWrapStyle2.Square,checkmark:!1,checkable:!0}),new Common.UI.MenuItem({caption:p.txtTight,iconCls:"menu__icon btn-small-wrap-tight",toggleGroup:"popuppicturewrapping",wrapType:Asc.c_oAscWrapStyle2.Tight,checkmark:!1,checkable:!0}),new Common.UI.MenuItem({caption:p.txtThrough,iconCls:"menu__icon btn-small-wrap-through",toggleGroup:"popuppicturewrapping",wrapType:Asc.c_oAscWrapStyle2.Through,checkmark:!1,checkable:!0}),new Common.UI.MenuItem({caption:p.txtTopAndBottom,iconCls:"menu__icon btn-small-wrap-topandbottom",toggleGroup:"popuppicturewrapping",wrapType:Asc.c_oAscWrapStyle2.TopAndBottom,checkmark:!1,checkable:!0}),{caption:"--"},new Common.UI.MenuItem({caption:p.txtInFront,iconCls:"menu__icon btn-small-wrap-infront",toggleGroup:"popuppicturewrapping",wrapType:Asc.c_oAscWrapStyle2.InFront,checkmark:!1,checkable:!0}),new Common.UI.MenuItem({caption:p.txtBehind,iconCls:"menu__icon btn-small-wrap-behind",toggleGroup:"popuppicturewrapping",wrapType:Asc.c_oAscWrapStyle2.Behind,checkmark:!1,checkable:!0}),{caption:"--"},p.menuWrapPolygon]})}),p.menuImageAdvanced=new Common.UI.MenuItem({iconCls:"menu__icon btn-menu-image",caption:p.advancedText}),p.menuChartEdit=new Common.UI.MenuItem({caption:p.editChartText}),p.menuOriginalSize=new Common.UI.MenuItem({caption:p.originalSizeText}),p.menuImgReplace=new Common.UI.MenuItem({caption:p.textReplace,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[new Common.UI.MenuItem({caption:this.textFromFile,value:0}),new Common.UI.MenuItem({caption:this.textFromUrl,value:1}),new Common.UI.MenuItem({caption:this.textFromStorage,value:2})]})}),p.menuImgCopy=new Common.UI.MenuItem({iconCls:"menu__icon btn-copy",caption:p.textCopy,value:"copy"}),p.menuImgPaste=new Common.UI.MenuItem({iconCls:"menu__icon btn-paste",caption:p.textPaste,value:"paste"}),p.menuImgCut=new Common.UI.MenuItem({iconCls:"menu__icon btn-cut",caption:p.textCut,value:"cut"}),p.menuImgAccept=new Common.UI.MenuItem({caption:p.textAccept,value:"accept"}),p.menuImgReject=new Common.UI.MenuItem({caption:p.textReject,value:"reject"}),new Common.UI.MenuItem({caption:"--"})),h=(p.menuImgPrint=new Common.UI.MenuItem({iconCls:"menu__icon btn-print",caption:p.txtPrintSelection}),p.menuSignatureEditSign=new Common.UI.MenuItem({caption:this.strSign,value:0}),p.menuSignatureEditSetup=new Common.UI.MenuItem({caption:this.strSetup,value:2}),new Common.UI.MenuItem({caption:"--"})),m=(p.menuImgRotate=new Common.UI.MenuItem({caption:p.textRotate,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[new Common.UI.MenuItem({iconCls:"menu__icon btn-rotate-90",caption:this.textRotate90,value:1}),new Common.UI.MenuItem({iconCls:"menu__icon btn-rotate-270",caption:this.textRotate270,value:0}),{caption:"--"},new Common.UI.MenuItem({iconCls:"menu__icon btn-flip-hor",caption:this.textFlipH,value:1}),new Common.UI.MenuItem({iconCls:"menu__icon btn-flip-vert",caption:this.textFlipV,value:0})]})}),p.menuImgCrop=new Common.UI.MenuItem({caption:p.textCrop,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[new Common.UI.MenuItem({caption:p.textCrop,checkable:!0,allowDepress:!0,value:0}),new Common.UI.MenuItem({caption:p.textCropFill,value:1}),new Common.UI.MenuItem({caption:p.textCropFit,value:2})]})}),p.menuImgRemoveControl=new Common.UI.MenuItem({iconCls:"menu__icon btn-cc-remove",caption:p.textRemoveControl,value:"remove"}),p.menuImgControlSettings=new Common.UI.MenuItem({caption:p.textEditControls,value:"settings"}),new Common.UI.MenuItem({caption:"--"})),g=(p.menuImgEditPoints=new Common.UI.MenuItem({caption:p.textEditPoints}),this.pictureMenu=new Common.UI.Menu({cls:"shifted-right",restoreHeightAndTop:!0,scrollToCheckedItem:!1,initMenu:function(t){if(!R.isUndefined(t.imgProps)){var e=!t.imgProps.value.get_CanBeFlow(),i=t.imgProps.value.get_WrappingStyle(),n=(p.menuImageWrap._originalProps=t.imgProps.value,"menu__icon ");if(e){for(var o=0;o<8;o++)p.menuImageWrap.menu.items[o].setChecked(!1);n+="btn-small-wrap-inline"}else switch(i){case Asc.c_oAscWrapStyle2.Inline:p.menuImageWrap.menu.items[0].setChecked(!0),n+="btn-small-wrap-inline";break;case Asc.c_oAscWrapStyle2.Square:p.menuImageWrap.menu.items[2].setChecked(!0),n+="btn-small-wrap-square";break;case Asc.c_oAscWrapStyle2.Tight:p.menuImageWrap.menu.items[3].setChecked(!0),n+="btn-small-wrap-tight";break;case Asc.c_oAscWrapStyle2.Through:p.menuImageWrap.menu.items[4].setChecked(!0),n+="btn-small-wrap-through";break;case Asc.c_oAscWrapStyle2.TopAndBottom:p.menuImageWrap.menu.items[5].setChecked(!0),n+="btn-small-wrap-topandbottom";break;case Asc.c_oAscWrapStyle2.Behind:p.menuImageWrap.menu.items[8].setChecked(!0),n+="btn-small-wrap-behind";break;case Asc.c_oAscWrapStyle2.InFront:p.menuImageWrap.menu.items[7].setChecked(!0),n+="btn-small-wrap-infront";break;default:for(o=0;o<8;o++)p.menuImageWrap.menu.items[o].setChecked(!1);n+="btn-small-wrap-infront"}p.menuImageWrap.setIconCls(n),R.each(p.menuImageWrap.menu.items,function(t){t.setDisabled(e)});var s=t.imgProps.isImg&&t.imgProps.isChart||t.imgProps.isImg&&t.imgProps.isShape||t.imgProps.isShape&&t.imgProps.isChart,s=(s?(p.menuImageAdvanced.setCaption(p.advancedText,!0),p.menuImageAdvanced.setIconCls("menu__icon btn-menu-image")):(p.menuImageAdvanced.setCaption(t.imgProps.isImg?p.imageText:t.imgProps.isChart?p.chartText:p.shapeText,!0),p.menuImageAdvanced.setIconCls("menu__icon "+(t.imgProps.isImg?"btn-menu-image":t.imgProps.isChart?"btn-menu-chart":"btn-menu-shape"))),p.menuChartEdit.setVisible(!R.isNull(t.imgProps.value.get_ChartProperties())&&!s),p.menuOriginalSize.setVisible(t.imgProps.isOnlyImg||!t.imgProps.isChart&&!t.imgProps.isShape),p.api.asc_IsContentControl()),a=s?p.api.asc_GetContentControlProperties():null,l=a?a.get_Lock():Asc.c_oAscSdtLockType.Unlocked,r=l==Asc.c_oAscSdtLockType.SdtContentLocked||l==Asc.c_oAscSdtLockType.ContentLocked,c=a&&a.get_FormPr(),s=(p.menuImgRemoveControl.setVisible(s),p.menuImgControlSettings.setVisible(s&&p.mode.canEditContentControl&&!c),m.setVisible(s),s&&(p.menuImgRemoveControl.setDisabled(l==Asc.c_oAscSdtLockType.SdtContentLocked||l==Asc.c_oAscSdtLockType.SdtLocked),p.menuImgRemoveControl.setCaption(c?p.getControlLabel(a):p.textRemoveControl)),t.imgProps.locked||void 0!==t.headerProps&&t.headerProps.locked||r),l=t.imgProps.value.asc_getPluginGuid(),c=(p.menuImgReplace.setVisible(t.imgProps.isOnlyImg&&null==l),p.menuImgReplace.isVisible()&&p.menuImgReplace.setDisabled(s||null===l),p.menuImgReplace.menu.items[2].setVisible(p.mode.canRequestInsertImage||p.mode.fileChoiceUrl&&-1<p.mode.fileChoiceUrl.indexOf("{documentType}")),p.menuImgRotate.setVisible(!t.imgProps.isChart&&null==l),p.menuImgRotate.isVisible()&&(p.menuImgRotate.setDisabled(s||t.imgProps.isSmartArt),p.menuImgRotate.menu.items[3].setDisabled(t.imgProps.isSmartArtInternal),p.menuImgRotate.menu.items[4].setDisabled(t.imgProps.isSmartArtInternal)),p.menuImgCrop.setVisible(p.api.asc_canEditCrop()),p.menuImgCrop.isVisible()&&p.menuImgCrop.setDisabled(s),p.menuChartEdit.isVisible()&&p.menuChartEdit.setDisabled(s||t.imgProps.value.get_SeveralCharts()),p.menuOriginalSize.setDisabled(s||null===t.imgProps.value.get_ImageUrl()||void 0===t.imgProps.value.get_ImageUrl()),p.menuImageAdvanced.setDisabled(s),p.menuImageAlign.setDisabled(s||i==Asc.c_oAscWrapStyle2.Inline),s||i==Asc.c_oAscWrapStyle2.Inline||(c=p.api.asc_getSelectedDrawingObjectsCount(),l=Common.Utils.InternalSettings.get("de-img-align-to"),p.menuImageAlign.menu.items[7].setDisabled(2==c&&(!l||3==l)),p.menuImageAlign.menu.items[8].setDisabled(2==c&&(!l||3==l))),p.menuImageArrange.setDisabled(i==Asc.c_oAscWrapStyle2.Inline&&!t.imgProps.value.get_FromGroup()||r||p.api&&!p.api.CanUnGroup()&&!p.api.CanGroup()&&t.imgProps.isSmartArtInternal),p.menuImageArrange.menu.items[0].setDisabled(t.imgProps.isSmartArtInternal),p.menuImageArrange.menu.items[1].setDisabled(t.imgProps.isSmartArtInternal),p.menuImageArrange.menu.items[2].setDisabled(t.imgProps.isSmartArtInternal),p.menuImageArrange.menu.items[3].setDisabled(t.imgProps.isSmartArtInternal),p.api&&(p.mnuUnGroup.setDisabled(s||!p.api.CanUnGroup()),p.mnuGroup.setDisabled(s||!p.api.CanGroup()),p.menuWrapPolygon.setDisabled(s||!p.api.CanChangeWrapPolygon())),p.menuImageWrap.setDisabled(s||t.imgProps.value.get_FromGroup()||e&&p.menuWrapPolygon.isDisabled()||!!a&&a.get_SpecificType()==Asc.c_oAscContentControlSpecificType.Picture&&!a.get_FormPr()),p.api&&p.api.can_CopyCut()),l=(p.menuImgCopy.setDisabled(!c),p.menuImgCut.setDisabled(s||!c),p.menuImgPaste.setDisabled(s),p.menuImgPrint.setVisible(p.mode.canPrint),p.menuImgPrint.setDisabled(!c),Common.Utils.InternalSettings.get("de-accept-reject-lock")),i=(p.menuImgAccept.setVisible(p.mode.canReview&&!p.mode.isReviewOnly&&!l),p.menuImgReject.setVisible(p.mode.canReview&&!p.mode.isReviewOnly&&!l),d.setVisible(p.mode.canReview&&!p.mode.isReviewOnly&&!l),t.imgProps&&t.imgProps.value&&p.mode.isSignatureSupport?t.imgProps.value.asc_getSignatureId():void 0),r=!!i,a=(p.menuSignatureEditSign.setVisible(r),p.menuSignatureEditSetup.setVisible(r),h.setVisible(r),r&&(p.menuSignatureEditSign.cmpEl.attr("data-value",i),p.menuSignatureEditSetup.cmpEl.attr("data-value",i)),p.api&&p.api.asc_canEditGeometry());p.menuImgEditPoints.setVisible(a),a&&p.menuImgEditPoints.setDisabled(s)}},items:[p.menuImgCut,p.menuImgCopy,p.menuImgPaste,p.menuImgPrint,{caption:"--"},p.menuImgAccept,p.menuImgReject,d,p.menuSignatureEditSign,p.menuSignatureEditSetup,h,p.menuImgRemoveControl,p.menuImgControlSettings,m,p.menuImageArrange,p.menuImageAlign,p.menuImageWrap,p.menuImgRotate,{caption:"--"},p.menuInsertCaption,t,p.menuSaveAsPicture,e,p.menuImgCrop,p.menuOriginalSize,p.menuImgReplace,p.menuChartEdit,p.menuImgEditPoints,p.menuImageAdvanced]}).on("hide:after",function(t,e,i){p.clearCustomItems(t),i||p.fireEvent("editcomplete",p),p.currentMenu=null}),p.menuTableInsertCaption=new Common.UI.MenuItem({caption:p.txtInsertCaption}),p.mnuTableMerge=new Common.UI.MenuItem({iconCls:"menu__icon btn-merge-cells",caption:p.mergeCellsText}),p.mnuTableSplit=new Common.UI.MenuItem({caption:p.splitCellsText}),p.menuTableCellAlign=new Common.UI.MenuItem({iconCls:"menu__icon btn-align-top",caption:p.cellAlignText,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[p.menuTableCellTop=new Common.UI.MenuItem({iconCls:"menu__icon btn-align-top",caption:p.textShapeAlignTop,toggleGroup:"popuptablecellalign",checkmark:!1,checkable:!0,checked:!1,valign:Asc.c_oAscVertAlignJc.Top}),p.menuTableCellCenter=new Common.UI.MenuItem({iconCls:"menu__icon btn-align-middle",caption:p.textShapeAlignMiddle,toggleGroup:"popuptablecellalign",checkmark:!1,checkable:!0,checked:!1,valign:Asc.c_oAscVertAlignJc.Center}),p.menuTableCellBottom=new Common.UI.MenuItem({iconCls:"menu__icon btn-align-bottom",caption:p.textShapeAlignBottom,toggleGroup:"popuptablecellalign",checkmark:!1,checkable:!0,checked:!1,valign:Asc.c_oAscVertAlignJc.Bottom})]})}),p.menuTableAdvanced=new Common.UI.MenuItem({iconCls:"menu__icon btn-menu-table",caption:p.advancedTableText}),p.menuParagraphAdvancedInTable=new Common.UI.MenuItem({iconCls:"menu__icon btn-paragraph",caption:p.advancedParagraphText}),new Common.UI.MenuItem({caption:"--"})),b=(p.menuEditHyperlinkTable=new Common.UI.MenuItem({caption:p.editHyperlinkText}),p.menuRemoveHyperlinkTable=new Common.UI.MenuItem({caption:p.removeHyperlinkText}),new Common.UI.MenuItem({iconCls:"menu__icon btn-inserthyperlink",caption:p.hyperlinkText,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[p.menuEditHyperlinkTable,p.menuRemoveHyperlinkTable]})})),C=(p.menuTableRemoveForm=new Common.UI.MenuItem({iconCls:"menu__icon btn-cc-remove",caption:p.textRemove,value:"remove"}),p.menuTableRemoveControl=new Common.UI.MenuItem({iconCls:"menu__icon btn-cc-remove",caption:p.textRemoveControl,value:"remove"}),p.menuTableControlSettings=new Common.UI.MenuItem({caption:p.textSettings,value:"settings"}),new Common.UI.MenuItem({caption:p.textContentControls,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[p.menuTableRemoveControl,p.menuTableControlSettings]})})),t=(p.menuTableTOC=new Common.UI.MenuItem({caption:p.textTOC,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:p.textSettings,value:"settings"},{caption:p.textUpdateAll,value:"all"},{caption:p.textUpdatePages,value:"pages"}]})}),p.menuAddCommentTable=new Common.UI.MenuItem({iconCls:"menu__icon btn-menu-comments",caption:p.addCommentText}),p.menuAddHyperlinkTable=new Common.UI.MenuItem({iconCls:"menu__icon btn-inserthyperlink",caption:p.hyperlinkText}),p.menuTableFollow=new Common.UI.MenuItem({caption:p.textFollow}),p.menuSpellTable=new Common.UI.MenuItem({caption:p.loadSpellText,disabled:!0}),p.menuSpellMoreTable=new Common.UI.MenuItem({caption:p.moreText,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",restoreHeight:!0,items:[]})}),R.template(['<a id="<%= id %>" tabindex="-1" type="menuitem" langval="<%= value %>" class="<% if (checked) { %> checked <% } %>">','<i class="icon <% if (spellcheck) { %> toolbar__icon btn-ic-docspell spellcheck-lang <% } %>"></i>',"<%= caption %>","</a>"].join(""))),e=(p.langTableMenu=new Common.UI.MenuItem({iconCls:"menu__icon btn-ic-doclang",caption:p.langText,menu:new Common.UI.MenuSimple({cls:"lang-menu",menuAlign:"tl-tr",restoreHeight:285,items:[],itemTemplate:t,search:!0,focusToCheckedItem:!0})}),p.menuIgnoreSpellTable=new Common.UI.MenuItem({caption:p.ignoreSpellText,value:!1}),p.menuIgnoreAllSpellTable=new Common.UI.MenuItem({caption:p.ignoreAllSpellText,value:!0}),p.menuToDictionaryTable=new Common.UI.MenuItem({caption:p.toDictionaryText}),new Common.UI.MenuItem({caption:"--"})),f=new Common.UI.MenuItem({caption:"--"}),v=(p.menuSpellCheckTable=new Common.UI.MenuItem({iconCls:"menu__icon btn-ic-docspell",caption:p.spellcheckText,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[p.menuSpellTable,p.menuSpellMoreTable,e,p.menuIgnoreSpellTable,p.menuIgnoreAllSpellTable,p.menuToDictionaryTable,{caption:"--"},p.langTableMenu]})}),p.menuTableCopy=new Common.UI.MenuItem({iconCls:"menu__icon btn-copy",caption:p.textCopy,value:"copy"}),p.menuTablePaste=new Common.UI.MenuItem({iconCls:"menu__icon btn-paste",caption:p.textPaste,value:"paste"}),p.menuTableCut=new Common.UI.MenuItem({iconCls:"menu__icon btn-cut",caption:p.textCut,value:"cut"}),p.menuTableAccept=new Common.UI.MenuItem({caption:p.textAccept,value:"accept"}),p.menuTableReject=new Common.UI.MenuItem({caption:p.textReject,value:"reject"}),new Common.UI.MenuItem({caption:"--"})),_=(p.menuTablePrint=new Common.UI.MenuItem({iconCls:"menu__icon btn-print",caption:p.txtPrintSelection}),new Common.UI.MenuItem({caption:"--"})),w=(p.menuTableDistRows=new Common.UI.MenuItem({caption:p.textDistributeRows,value:!1}),p.menuTableDistCols=new Common.UI.MenuItem({caption:p.textDistributeCols,value:!0}),p.menuTableDirection=new Common.UI.MenuItem({iconCls:"menu__icon btn-text-orient-hor",caption:p.directionText,menu:new Common.UI.Menu({cls:"ppm-toolbar shifted-right",menuAlign:"tl-tr",items:[p.menuTableDirectH=new Common.UI.MenuItem({caption:p.directHText,iconCls:"menu__icon btn-text-orient-hor",checkable:!0,checkmark:!1,checked:!1,toggleGroup:"popuptabledirect",direction:Asc.c_oAscCellTextDirection.LRTB}),p.menuTableDirect90=new Common.UI.MenuItem({caption:p.direct90Text,iconCls:"menu__icon btn-text-orient-rdown",checkable:!0,checkmark:!1,checked:!1,toggleGroup:"popuptabledirect",direction:Asc.c_oAscCellTextDirection.TBRL}),p.menuTableDirect270=new Common.UI.MenuItem({caption:p.direct270Text,iconCls:"menu__icon btn-text-orient-rup",checkable:!0,checkmark:!1,checked:!1,toggleGroup:"popuptabledirect",direction:Asc.c_oAscCellTextDirection.BTLR})]})}),p.menuTableStartNewList=new Common.UI.MenuItem({caption:p.textStartNewList}),p.menuTableStartNumberingFrom=new Common.UI.MenuItem({caption:p.textStartNumberingFrom}),p.menuTableContinueNumbering=new Common.UI.MenuItem({caption:p.textContinueNumbering}),p.menuTableListIndents=new Common.UI.MenuItem({caption:p.textIndents}),new Common.UI.MenuItem({caption:p.bulletsText,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[p.menuTableStartNewList,p.menuTableStartNumberingFrom,p.menuTableContinueNumbering,p.menuTableListIndents]})})),y=(p.menuTableRefreshField=new Common.UI.MenuItem({caption:p.textRefreshField}),new Common.UI.MenuItem({caption:"--"})),x=(p.menuTableEquation=new Common.UI.MenuItem({caption:p.advancedEquationText,iconCls:"menu__icon btn-equation",menu:p.createEquationMenu("popuptableeqinput","tl-tr")}),p.menuTableSelectText=new Common.UI.MenuItem({caption:p.selectText,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",style:"width: 100px",items:[new Common.UI.MenuItem({caption:p.cellText,value:2}),new Common.UI.MenuItem({caption:p.rowText,value:0}),new Common.UI.MenuItem({caption:p.columnText,value:1}),new Common.UI.MenuItem({caption:p.tableText,value:3})]})}),p.menuTableInsertText=new Common.UI.MenuItem({iconCls:"menu__icon btn-addcell",caption:p.insertText,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[new Common.UI.MenuItem({caption:p.insertColumnLeftText,value:0}),new Common.UI.MenuItem({caption:p.insertColumnRightText,value:1}),new Common.UI.MenuItem({caption:p.insertRowAboveText,value:2}),new Common.UI.MenuItem({caption:p.insertRowBelowText,value:3}),new Common.UI.MenuItem({caption:p.textSeveral,value:4})]})}),p.menuTableDeleteText=new Common.UI.MenuItem({iconCls:"menu__icon btn-delcell",caption:p.deleteText,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",style:"width: 100px",items:[new Common.UI.MenuItem({caption:p.textCells,value:3}),new Common.UI.MenuItem({caption:p.rowText,value:0}),new Common.UI.MenuItem({caption:p.columnText,value:1}),new Common.UI.MenuItem({caption:p.tableText,value:2})]})}),this.tableMenu=new Common.UI.Menu({cls:"shifted-right",restoreHeightAndTop:!0,scrollToCheckedItem:!1,initMenu:function(t){if(!R.isUndefined(t.tableProps)){for(var e=t.mathProps&&t.mathProps.value,i=11;i<30;i++)p.tableMenu.items[i].setVisible(!e);var n=t.tableProps.value.get_CellsVAlign(),o="";switch(n){case Asc.c_oAscVertAlignJc.Top:o="menu__icon btn-align-top";break;case Asc.c_oAscVertAlignJc.Center:o="menu__icon btn-align-middle";break;case Asc.c_oAscVertAlignJc.Bottom:o="menu__icon btn-align-bottom"}p.menuTableCellAlign.setIconCls(o),p.menuTableCellTop.setChecked(n==Asc.c_oAscVertAlignJc.Top),p.menuTableCellCenter.setChecked(n==Asc.c_oAscVertAlignJc.Center),p.menuTableCellBottom.setChecked(n==Asc.c_oAscVertAlignJc.Bottom);n=t.tableProps.value.get_CellsTextDirection(),o="";switch(n){case Asc.c_oAscCellTextDirection.LRTB:o="menu__icon btn-text-orient-hor";break;case Asc.c_oAscCellTextDirection.TBRL:o="menu__icon btn-text-orient-rdown";break;case Asc.c_oAscCellTextDirection.BTLR:o="menu__icon btn-text-orient-rup"}p.menuTableDirection.setIconCls(o),p.menuTableDirectH.setChecked(n==Asc.c_oAscCellTextDirection.LRTB),p.menuTableDirect90.setChecked(n==Asc.c_oAscCellTextDirection.TBRL),p.menuTableDirect270.setChecked(n==Asc.c_oAscCellTextDirection.BTLR);var s,a,n=t.tableProps.locked||void 0!==t.headerProps&&t.headerProps.locked,l=(p.tableMenu.items[14].setDisabled(n),p.tableMenu.items[15].setDisabled(n),p.api&&(p.mnuTableMerge.setDisabled(n||!p.api.CheckBeforeMergeCells()),p.mnuTableSplit.setDisabled(n||!p.api.CheckBeforeSplitCells())),p.menuTableDistRows.setDisabled(n),p.menuTableDistCols.setDisabled(n),p.menuTableCellAlign.setDisabled(n),p.menuTableDirection.setDisabled(n),p.menuTableAdvanced.setDisabled(n),p.api&&p.api.can_CopyCut()),l=(p.menuTableCopy.setDisabled(!l),p.menuTableCut.setDisabled(n||!l),p.menuTablePaste.setDisabled(n),p.menuTablePrint.setVisible(p.mode.canPrint),p.menuTablePrint.setDisabled(!l),Common.Utils.InternalSettings.get("de-accept-reject-lock")),l=(p.menuTableAccept.setVisible(p.mode.canReview&&!p.mode.isReviewOnly&&!l),p.menuTableReject.setVisible(p.mode.canReview&&!p.mode.isReviewOnly&&!l),v.setVisible(p.mode.canReview&&!p.mode.isReviewOnly&&!l),p.api.asc_GetCurrentNumberingId()),r=null!==l,c=(w.setVisible(r),r&&(l=(r=p.api.asc_GetNumberingPr(l).get_Lvl(p.api.asc_GetCurrentNumberingLvl())).get_Format(),c=p.api.asc_GetCalculatedNumberingValue(),p.menuTableStartNewList.setVisible(r.get_Start()!=c),p.menuTableStartNewList.value={start:r.get_Start()},p.menuTableStartNumberingFrom.setVisible(l!=Asc.c_oAscNumberingFormat.Bullet),p.menuTableStartNumberingFrom.value={format:l,start:c},p.menuTableStartNewList.setCaption(l==Asc.c_oAscNumberingFormat.Bullet?p.textSeparateList:p.textStartNewList),p.menuTableContinueNumbering.setCaption(l==Asc.c_oAscNumberingFormat.Bullet?p.textJoinList:p.textContinueNumbering),p.menuTableListIndents.value={format:l,props:r}),null),l=(p.api&&(c=p.api.can_AddHyperlink()),p.menuAddHyperlinkTable.setVisible(void 0===t.hyperProps&&!1!==c),b.setVisible(void 0!==t.hyperProps),p.menuEditHyperlinkTable.hyperProps=t.hyperProps,p.menuRemoveHyperlinkTable.hyperProps=t.hyperProps,!1!==c&&(p.menuAddHyperlinkTable.hyperProps={},p.menuAddHyperlinkTable.hyperProps.value=new Asc.CHyperlinkProperty,p.menuAddHyperlinkTable.hyperProps.value.put_Text(c)),p.api.asc_GetRevisionsChangesStack()),d=!1,r=(p.menuTableFollow.value=null,R.each(l,function(t){t.get_Type()!=Asc.c_oAscRevisionsChangeType.TextAdd&&t.get_Type()!=Asc.c_oAscRevisionsChangeType.TextRem||t.get_MoveType()==Asc.c_oAscRevisionsMove.NoMove||(p.menuTableFollow.value=t,d=!0)}),p.menuTableFollow.setVisible(d),g.setVisible(p.menuAddHyperlinkTable.isVisible()||b.isVisible()||w.isVisible()||p.menuTableFollow.isVisible()),p.menuParagraphAdvancedInTable.setVisible(void 0!==t.paraProps),p._currentParaObjDisabled=n=t.paraProps.locked||void 0!==t.headerProps&&t.headerProps.locked,p.menuAddHyperlinkTable.setDisabled(n),b.setDisabled(n||void 0!==t.hyperProps&&!0===t.hyperProps.isSeveralLinks),p.menuParagraphAdvancedInTable.setDisabled(n),p.menuSpellCheckTable.setVisible(void 0!==t.spellProps&&!1===t.spellProps.value.get_Checked()),p.menuToDictionaryTable.setVisible(p.mode.isDesktopApp),f.setVisible(void 0!==t.spellProps&&!1===t.spellProps.value.get_Checked()),p.langTableMenu.setDisabled(n),void 0!==t.spellProps&&!1===t.spellProps.value.get_Checked()&&null!==t.spellProps.value.get_Variants()&&void 0!==t.spellProps.value.get_Variants()?p.addWordVariants(!1):(p.menuSpellTable.setCaption(p.loadSpellText,!0),p.clearWordVariants(!1),p.menuSpellMoreTable.setVisible(!1)),p.menuSpellCheckTable.isVisible()&&p._currLang.id!==p._currLang.tableid&&(p.changeLanguageMenu(p.langTableMenu.menu),p._currLang.tableid=p._currLang.id),0),c=(e?r=p.addEquationMenu(!1,10):p.clearEquationMenu(!1,10),_.setVisible(e&&0<r),p.menuTableEquation.setVisible(e),p.menuTableEquation.setDisabled(n),e&&(c=p.api.asc_GetMathInputType(),l=p.api.asc_IsInlineMath(),r=Common.Utils.InternalSettings.get("de-equation-toolbar-hide"),p.menuTableEquation.menu.items[5].setChecked(c===Asc.c_oAscMathInputType.Unicode),p.menuTableEquation.menu.items[6].setChecked(c===Asc.c_oAscMathInputType.LaTeX),p.menuTableEquation.menu.items[8].options.isEquationInline=l,p.menuTableEquation.menu.items[8].setCaption(l?p.eqToDisplayText:p.eqToInlineText,!0),p.menuTableEquation.menu.items[9].options.isToolbarHide=r,p.menuTableEquation.menu.items[9].setCaption(r?p.showEqToolbar:p.hideEqToolbar,!0)),!!t.paraProps&&!(t.paraProps.value.can_DeleteBlockContentControl()&&t.paraProps.value.can_EditBlockContentControl()&&t.paraProps.value.can_DeleteInlineContentControl()&&t.paraProps.value.can_EditInlineContentControl())),l=p.api.asc_GetTableOfContentsPr(!0),r=!l&&p.api.asc_IsContentControl(),h=(r?(h=(s=p.api.asc_GetContentControlProperties())?s.get_Lock():Asc.c_oAscSdtLockType.Unlocked,a=s&&s.get_FormPr(),p.menuTableRemoveForm.setVisible(a),C.setVisible(!a),a?(p.menuTableRemoveForm.setDisabled(h==Asc.c_oAscSdtLockType.SdtContentLocked||h==Asc.c_oAscSdtLockType.SdtLocked),p.menuTableRemoveForm.setCaption(p.getControlLabel(s))):(p.menuTableRemoveControl.setDisabled(h==Asc.c_oAscSdtLockType.SdtContentLocked||h==Asc.c_oAscSdtLockType.SdtLocked),p.menuTableControlSettings.setVisible(p.mode.canEditContentControl)),a=s?s.get_SpecificType():Asc.c_oAscContentControlSpecificType.None,c=c||a==Asc.c_oAscContentControlSpecificType.CheckBox||a==Asc.c_oAscContentControlSpecificType.Picture||a==Asc.c_oAscContentControlSpecificType.ComboBox||a==Asc.c_oAscContentControlSpecificType.DropDownList||a==Asc.c_oAscContentControlSpecificType.DateTime):(C.setVisible(r),p.menuTableRemoveForm.setVisible(r)),p.menuTableTOC.setVisible(l),p.menuAddCommentTable.setVisible(!1!==p.api.can_AddQuotedComment()&&p.mode.canCoAuthoring&&p.mode.canComments&&!c),p.menuAddCommentTable.setDisabled(void 0!==t.paraProps&&!0===t.paraProps.locked),p.api.asc_HaveFields(!0));p.menuTableRefreshField.setVisible(!!h),p.menuTableRefreshField.setDisabled(n),y.setVisible(!!h)}},items:[p.menuSpellCheckTable,f,p.menuTableCut,p.menuTableCopy,p.menuTablePaste,p.menuTablePrint,{caption:"--"},p.menuTableAccept,p.menuTableReject,v,_,p.menuTableRefreshField,y,p.menuTableSelectText,p.menuTableInsertText,p.menuTableDeleteText,{caption:"--"},p.mnuTableMerge,p.mnuTableSplit,{caption:"--"},p.menuTableDistRows,p.menuTableDistCols,{caption:"--"},p.menuTableCellAlign,p.menuTableDirection,{caption:"--"},p.menuTableInsertCaption,{caption:"--"},p.menuTableAdvanced,{caption:"--"},p.menuAddCommentTable,w,p.menuAddHyperlinkTable,b,p.menuTableFollow,g,p.menuTableRemoveForm,C,p.menuTableTOC,p.menuParagraphAdvancedInTable,p.menuTableEquation]}).on("hide:after",function(t,e,i){p.clearCustomItems(t),p.currentMenu=null,p.suppressEditComplete?p.suppressEditComplete=!1:i||p.fireEvent("editcomplete",p)}),p.menuParagraphBreakBefore=new Common.UI.MenuItem({caption:p.breakBeforeText,checkable:!0}),p.menuParagraphKeepLines=new Common.UI.MenuItem({caption:p.keepLinesText,checkable:!0}),p.menuParagraphVAlign=new Common.UI.MenuItem({iconCls:"menu__icon btn-align-top",caption:p.vertAlignText,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[p.menuParagraphTop=new Common.UI.MenuItem({iconCls:"menu__icon btn-align-top",caption:p.textShapeAlignTop,checkmark:!1,checkable:!0,checked:!1,toggleGroup:"popupparagraphvalign",valign:Asc.c_oAscVAlign.Top}),p.menuParagraphCenter=new Common.UI.MenuItem({iconCls:"menu__icon btn-align-middle",caption:p.textShapeAlignMiddle,checkmark:!1,checkable:!0,checked:!1,toggleGroup:"popupparagraphvalign",valign:Asc.c_oAscVAlign.Center}),p.menuParagraphBottom=new Common.UI.MenuItem({iconCls:"menu__icon btn-align-bottom",caption:p.textShapeAlignBottom,checkmark:!1,checkable:!0,checked:!1,toggleGroup:"popupparagraphvalign",valign:Asc.c_oAscVAlign.Bottom})]})}),p.menuParagraphDirection=new Common.UI.MenuItem({iconCls:"menu__icon btn-text-orient-hor",caption:p.directionText,menu:new Common.UI.Menu({cls:"ppm-toolbar shifted-right",menuAlign:"tl-tr",items:[p.menuParagraphDirectH=new Common.UI.MenuItem({caption:p.directHText,iconCls:"menu__icon btn-text-orient-hor",checkable:!0,checkmark:!1,checked:!1,toggleGroup:"popupparagraphdirect",direction:Asc.c_oAscVertDrawingText.normal}),p.menuParagraphDirect90=new Common.UI.MenuItem({caption:p.direct90Text,iconCls:"menu__icon btn-text-orient-rdown",checkable:!0,checkmark:!1,checked:!1,toggleGroup:"popupparagraphdirect",direction:Asc.c_oAscVertDrawingText.vert}),p.menuParagraphDirect270=new Common.UI.MenuItem({caption:p.direct270Text,iconCls:"menu__icon btn-text-orient-rup",checkable:!0,checkmark:!1,checked:!1,toggleGroup:"popupparagraphdirect",direction:Asc.c_oAscVertDrawingText.vert270})]})}),p.menuParagraphAdvanced=new Common.UI.MenuItem({iconCls:"menu__icon btn-paragraph",caption:p.advancedParagraphText}),p.menuFrameAdvanced=new Common.UI.MenuItem({caption:p.advancedFrameText}),p.menuDropCapAdvanced=new Common.UI.MenuItem({iconCls:"menu__icon btn-dropcap-intext",caption:p.advancedDropCapText}),p.menuParagraphEquation=new Common.UI.MenuItem({caption:p.advancedEquationText,iconCls:"menu__icon btn-equation",menu:p.createEquationMenu("popupparaeqinput","tl-tr")}),new Common.UI.MenuItem({caption:"--"})),S=(p.menuAddCommentPara=new Common.UI.MenuItem({iconCls:"menu__icon btn-menu-comments",caption:p.addCommentText}),new Common.UI.MenuItem({caption:"--"})),T=(p.menuAddHyperlinkPara=new Common.UI.MenuItem({iconCls:"menu__icon btn-inserthyperlink",caption:p.hyperlinkText}),p.menuEditHyperlinkPara=new Common.UI.MenuItem({caption:p.editHyperlinkText}),p.menuRemoveHyperlinkPara=new Common.UI.MenuItem({caption:p.removeHyperlinkText}),new Common.UI.MenuItem({iconCls:"menu__icon btn-inserthyperlink",caption:p.hyperlinkText,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[p.menuEditHyperlinkPara,p.menuRemoveHyperlinkPara]})})),A=new Common.UI.MenuItemSeparator,k=new Common.UI.MenuItem({caption:p.styleText,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[p.menuStyleSave=new Common.UI.MenuItem({caption:p.saveStyleText}),p.menuStyleUpdate=new Common.UI.MenuItem({caption:p.updateStyleText.replace("%1",window.currentStyleName)})]})}),D=(p.menuSpellPara=new Common.UI.MenuItem({caption:p.loadSpellText,disabled:!0}),p.menuSpellMorePara=new Common.UI.MenuItem({caption:p.moreText,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",restoreHeight:!0,items:[]})}),p.langParaMenu=new Common.UI.MenuItem({iconCls:"menu__icon btn-ic-doclang",caption:p.langText,menu:new Common.UI.MenuSimple({cls:"lang-menu",menuAlign:"tl-tr",restoreHeight:285,items:[],itemTemplate:t,search:!0,focusToCheckedItem:!0})}),p.menuIgnoreSpellPara=new Common.UI.MenuItem({caption:p.ignoreSpellText,value:!1}),p.menuIgnoreAllSpellPara=new Common.UI.MenuItem({caption:p.ignoreAllSpellText,value:!0}),p.menuToDictionaryPara=new Common.UI.MenuItem({caption:p.toDictionaryText}),new Common.UI.MenuItem({caption:"--"})),I=new Common.UI.MenuItem({caption:"--"}),P=(p.menuParaCopy=new Common.UI.MenuItem({iconCls:"menu__icon btn-copy",caption:p.textCopy,value:"copy"}),p.menuParaPaste=new Common.UI.MenuItem({iconCls:"menu__icon btn-paste",caption:p.textPaste,value:"paste"}),p.menuParaCut=new Common.UI.MenuItem({iconCls:"menu__icon btn-cut",caption:p.textCut,value:"cut"}),p.menuParaAccept=new Common.UI.MenuItem({caption:p.textAccept,value:"accept"}),p.menuParaReject=new Common.UI.MenuItem({caption:p.textReject,value:"reject"}),new Common.UI.MenuItem({caption:"--"})),E=(p.menuParaPrint=new Common.UI.MenuItem({iconCls:"menu__icon btn-print",caption:p.txtPrintSelection}),new Common.UI.MenuItem({caption:"--"})),V=(p.menuParaRemoveControl=new Common.UI.MenuItem({iconCls:"menu__icon btn-cc-remove",caption:p.textRemoveControl,value:"remove"}),p.menuParaControlSettings=new Common.UI.MenuItem({caption:p.textEditControls,value:"settings"}),new Common.UI.MenuItem({caption:"--"})),M=(p.menuParaTOCSettings=new Common.UI.MenuItem({caption:p.textTOCSettings,value:"settings"}),p.menuParaTOCRefresh=new Common.UI.MenuItem({caption:p.textUpdateTOC,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:p.textUpdateAll,value:"all"},{caption:p.textUpdatePages,value:"pages"}]})}),new Common.UI.MenuItem({caption:"--"})),U=(p.menuParaRefreshField=new Common.UI.MenuItem({caption:p.textRefreshField}),new Common.UI.MenuItem({caption:"--"})),L=(p.menuParaStartNewList=new Common.UI.MenuItem({caption:p.textStartNewList}),p.menuParaStartNumberingFrom=new Common.UI.MenuItem({caption:p.textStartNumberingFrom}),p.menuParaContinueNumbering=new Common.UI.MenuItem({caption:p.textContinueNumbering}),p.menuParaListIndents=new Common.UI.MenuItem({caption:p.textIndents}),new Common.UI.MenuItem({caption:"--"})),F=(p.menuParaFollow=new Common.UI.MenuItem({caption:p.textFollow}),new Common.UI.MenuItem({caption:"--"})),i=(this.textMenu=new Common.UI.Menu({cls:"shifted-right",restoreHeightAndTop:!0,scrollToCheckedItem:!1,initMenu:function(t){var e=t.imgProps&&t.imgProps.value&&!R.isNull(t.imgProps.value.get_ShapeProperties()),i=t.imgProps&&t.imgProps.value&&!R.isNull(t.imgProps.value.get_ChartProperties()),n=t.mathProps&&t.mathProps.value,o=p.api.asc_GetTableOfContentsPr(!0),s=!o&&p.api.asc_IsContentControl(),a=s?p.api.asc_GetContentControlProperties():null,l=a&&a.get_FormPr();if(p.menuParagraphVAlign.setVisible(e&&!i&&!(n||l&&a.get_FormPr().get_Fixed())),p.menuParagraphDirection.setVisible(e&&!i&&!(n||l&&a.get_FormPr().get_Fixed())),e||i){var r=t.imgProps.value.get_VerticalTextAlign(),c="";switch(r){case Asc.c_oAscVAlign.Top:c="menu__icon btn-align-top";break;case Asc.c_oAscVAlign.Center:c="menu__icon btn-align-middle";break;case Asc.c_oAscVAlign.Bottom:c="menu__icon btn-align-bottom"}p.menuParagraphVAlign.setIconCls(c),p.menuParagraphTop.setChecked(r==Asc.c_oAscVAlign.Top),p.menuParagraphCenter.setChecked(r==Asc.c_oAscVAlign.Center),p.menuParagraphBottom.setChecked(r==Asc.c_oAscVAlign.Bottom);r=t.imgProps.value.get_Vert(),c="";switch(r){case Asc.c_oAscVertDrawingText.normal:c="menu__icon btn-text-orient-hor";break;case Asc.c_oAscVertDrawingText.vert:c="menu__icon btn-text-orient-rdown";break;case Asc.c_oAscVertDrawingText.vert270:c="menu__icon btn-text-orient-rup"}p.menuParagraphDirection.setIconCls(c),p.menuParagraphDirectH.setChecked(r==Asc.c_oAscVertDrawingText.normal),p.menuParagraphDirect90.setChecked(r==Asc.c_oAscVertDrawingText.vert),p.menuParagraphDirect270.setChecked(r==Asc.c_oAscVertDrawingText.vert270)}p.menuParagraphAdvanced.isChart=t.imgProps&&t.imgProps.isChart,p.menuParagraphAdvanced.isSmartArtInternal=t.imgProps&&t.imgProps.isSmartArtInternal,p.menuParagraphBreakBefore.setVisible(!e&&!i&&!n),p.menuParagraphKeepLines.setVisible(!e&&!i&&!n),t.paraProps&&(p.menuParagraphBreakBefore.setChecked(t.paraProps.value.get_PageBreakBefore()),p.menuParagraphKeepLines.setChecked(t.paraProps.value.get_KeepLines()));var r=null,r=(p.api&&(r=p.api.can_AddHyperlink()),p.menuAddHyperlinkPara.setVisible(void 0===t.hyperProps&&!1!==r),T.setVisible(void 0!==t.hyperProps),S.setVisible(p.menuAddHyperlinkPara.isVisible()||T.isVisible()),p.menuEditHyperlinkPara.hyperProps=t.hyperProps,p.menuRemoveHyperlinkPara.hyperProps=t.hyperProps,!1!==r&&(p.menuAddHyperlinkPara.hyperProps={},p.menuAddHyperlinkPara.hyperProps.value=new Asc.CHyperlinkProperty,p.menuAddHyperlinkPara.hyperProps.value.put_Text(r)),t.paraProps.locked||void 0!==t.headerProps&&t.headerProps.locked),d=(p._currentParaObjDisabled=r,p.menuAddHyperlinkPara.setDisabled(r),T.setDisabled(r||void 0!==t.hyperProps&&!0===t.hyperProps.isSeveralLinks),p.api.asc_GetRevisionsChangesStack()),h=!1,d=(p.menuParaFollow.value=null,R.each(d,function(t){t.get_Type()!=Asc.c_oAscRevisionsChangeType.TextAdd&&t.get_Type()!=Asc.c_oAscRevisionsChangeType.TextRem||t.get_MoveType()==Asc.c_oAscRevisionsMove.NoMove||(p.menuParaFollow.value=t,h=!0)}),p.menuParaFollow.setVisible(h),F.setVisible(h),p.menuParagraphBreakBefore.setDisabled(r||!R.isUndefined(t.headerProps)||!R.isUndefined(t.imgProps)),p.menuParagraphKeepLines.setDisabled(r),p.menuParagraphAdvanced.setDisabled(r||l&&l.get_Fixed()),p.menuFrameAdvanced.setDisabled(r),p.menuDropCapAdvanced.setDisabled(r),p.menuParagraphVAlign.setDisabled(r),p.menuParagraphDirection.setDisabled(r),p.api&&p.api.can_CopyCut()),d=(p.menuParaCopy.setDisabled(!d),p.menuParaCut.setDisabled(r||!d),p.menuParaPaste.setDisabled(r),p.menuParaPrint.setVisible(p.mode.canPrint),p.menuParaPrint.setDisabled(!d),Common.Utils.InternalSettings.get("de-accept-reject-lock")),d=(p.menuParaAccept.setVisible(p.mode.canReview&&!p.mode.isReviewOnly&&!d),p.menuParaReject.setVisible(p.mode.canReview&&!p.mode.isReviewOnly&&!d),P.setVisible(p.mode.canReview&&!p.mode.isReviewOnly&&!d),void 0!==t.spellProps&&!1===t.spellProps.value.get_Checked()),d=(p.menuSpellPara.setVisible(d),I.setVisible(d),p.menuIgnoreSpellPara.setVisible(d),p.menuIgnoreAllSpellPara.setVisible(d),p.menuToDictionaryPara.setVisible(d&&p.mode.isDesktopApp),p.langParaMenu.setVisible(d),p.langParaMenu.setDisabled(r),D.setVisible(d),d&&null!==t.spellProps.value.get_Variants()&&void 0!==t.spellProps.value.get_Variants()?p.addWordVariants(!0):(p.menuSpellPara.setCaption(p.loadSpellText,!0),p.clearWordVariants(!0),p.menuSpellMorePara.setVisible(!1)),p.langParaMenu.isVisible()&&p._currLang.id!==p._currLang.paraid&&(p.changeLanguageMenu(p.langParaMenu.menu),p._currLang.paraid=p._currLang.id),0),d=(n?d=p.addEquationMenu(!0,18):p.clearEquationMenu(!0,18),E.setVisible(n&&0<d),p.menuEquationInsertCaption.setVisible(n),u.setVisible(n),p.menuParagraphEquation.setVisible(n),p.menuParagraphEquation.setDisabled(r),n&&(d=p.api.asc_GetMathInputType(),n=p.api.asc_IsInlineMath(),m=Common.Utils.InternalSettings.get("de-equation-toolbar-hide"),p.menuParagraphEquation.menu.items[5].setChecked(d===Asc.c_oAscMathInputType.Unicode),p.menuParagraphEquation.menu.items[6].setChecked(d===Asc.c_oAscMathInputType.LaTeX),p.menuParagraphEquation.menu.items[8].options.isEquationInline=n,p.menuParagraphEquation.menu.items[8].setCaption(n?p.eqToDisplayText:p.eqToInlineText,!0),p.menuParagraphEquation.menu.items[9].options.isToolbarHide=m,p.menuParagraphEquation.menu.items[9].setCaption(m?p.showEqToolbar:p.hideEqToolbar,!0)),t.paraProps.value.get_FramePr()),n=(p.menuFrameAdvanced.setVisible(void 0!==d),p.menuDropCapAdvanced.setVisible(void 0!==d),d&&p.menuDropCapAdvanced.setIconCls(d.get_DropCap()===Asc.c_oAscDropCap.Drop?"menu__icon btn-dropcap-intext":"menu__icon btn-dropcap-inmargin"),p.mode.canEditStyles&&!(i||t.imgProps&&t.imgProps.isSmartArtInternal)),m=(A.setVisible(n),k.setVisible(n),n&&p.menuStyleUpdate.setCaption(p.updateStyleText.replace("%1",DE.getController("Main").translationTable[window.currentStyleName]||window.currentStyleName)),!!t.paraProps&&!(t.paraProps.value.can_DeleteBlockContentControl()&&t.paraProps.value.can_EditBlockContentControl()&&t.paraProps.value.can_DeleteInlineContentControl()&&t.paraProps.value.can_EditInlineContentControl())),s=(p.menuParaRemoveControl.setVisible(s),p.menuParaControlSettings.setVisible(s&&p.mode.canEditContentControl&&!l),V.setVisible(s),s&&(d=a?a.get_Lock():Asc.c_oAscSdtLockType.Unlocked,p.menuParaRemoveControl.setDisabled(d==Asc.c_oAscSdtLockType.SdtContentLocked||d==Asc.c_oAscSdtLockType.SdtLocked),p.menuParaRemoveControl.setCaption(l?p.getControlLabel(a):p.textRemoveControl),n=a?a.get_SpecificType():Asc.c_oAscContentControlSpecificType.None,m=m||n==Asc.c_oAscContentControlSpecificType.CheckBox||n==Asc.c_oAscContentControlSpecificType.Picture||n==Asc.c_oAscContentControlSpecificType.ComboBox||n==Asc.c_oAscContentControlSpecificType.DropDownList||n==Asc.c_oAscContentControlSpecificType.DateTime),p.menuParaTOCSettings.setVisible(o),p.menuParaTOCRefresh.setVisible(o),M.setVisible(o),!i&&!1!==p.api.can_AddQuotedComment()&&p.mode.canCoAuthoring&&p.mode.canComments&&!m),d=(p.mode.compatibleFeatures&&(s=s&&!e),x.setVisible(s),p.menuAddCommentPara.setVisible(s),p.menuAddCommentPara.setDisabled(t.paraProps&&!0===t.paraProps.locked),p.api.asc_HaveFields(!0)),l=(p.menuParaRefreshField.setVisible(!!d),p.menuParaRefreshField.setDisabled(r),U.setVisible(!!d),p.api.asc_GetCurrentNumberingId()),a=null!==l;L.setVisible(a),p.menuParaStartNewList.setVisible(a),p.menuParaStartNumberingFrom.setVisible(a),p.menuParaContinueNumbering.setVisible(a),p.menuParaListIndents.setVisible(a),a&&(n=p.api.asc_GetCurrentNumberingLvl(),i=(o=p.api.asc_GetNumberingPr(l).get_Lvl(n)).get_Format(),m=p.api.asc_GetCalculatedNumberingValue(),p.menuParaStartNewList.setVisible(o.get_Start()!=m),p.menuParaStartNewList.value={start:o.get_Start()},p.menuParaStartNumberingFrom.setVisible(i!=Asc.c_oAscNumberingFormat.Bullet),p.menuParaStartNumberingFrom.value={format:i,start:m},p.menuParaStartNewList.setCaption(i==Asc.c_oAscNumberingFormat.Bullet?p.textSeparateList:p.textStartNewList),p.menuParaContinueNumbering.setCaption(i==Asc.c_oAscNumberingFormat.Bullet?p.textJoinList:p.textContinueNumbering),p.menuParaListIndents.value={listId:l,level:n,format:i,props:o})},items:[p.menuSpellPara,p.menuSpellMorePara,I,p.menuIgnoreSpellPara,p.menuIgnoreAllSpellPara,p.menuToDictionaryPara,p.langParaMenu,D,p.menuParaCut,p.menuParaCopy,p.menuParaPaste,p.menuParaPrint,P,p.menuParaAccept,p.menuParaReject,u,p.menuEquationInsertCaption,{caption:"--"},E,p.menuParaRemoveControl,p.menuParaControlSettings,V,p.menuParaRefreshField,U,p.menuParaTOCSettings,p.menuParaTOCRefresh,M,p.menuParagraphBreakBefore,p.menuParagraphKeepLines,p.menuParagraphVAlign,p.menuParagraphDirection,p.menuParagraphAdvanced,p.menuFrameAdvanced,p.menuDropCapAdvanced,p.menuParagraphEquation,x,p.menuAddCommentPara,S,p.menuAddHyperlinkPara,T,F,p.menuParaFollow,L,p.menuParaStartNewList,p.menuParaStartNumberingFrom,p.menuParaContinueNumbering,p.menuParaListIndents,A,k]}).on("hide:after",function(t,e,i){p.clearCustomItems(t),p.currentMenu=null,p.suppressEditComplete?p.suppressEditComplete=!1:i||p.fireEvent("editcomplete",p)}),new Common.UI.MenuItem({caption:p.editHeaderText})),e=(this.hdrMenu=new Common.UI.Menu({cls:"shifted-right",initMenu:function(e){i.setCaption(e.Header?p.editHeaderText:p.editFooterText,!0),i.off("click").on("click",function(t){p.api&&(e.Header?p.api.GoToHeader(e.PageNum):p.api.GoToFooter(e.PageNum),p.fireEvent("editcomplete",p))})},items:[i]}).on("hide:after",function(t,e,i){p.clearCustomItems(t),i||p.fireEvent("editcomplete",p),p.currentMenu=null}),n("#id_buttonNextPage")),t=(e.attr("data-toggle","tooltip"),e.tooltip({title:p.textNextPage+Common.Utils.String.platformKey("Alt+PgDn"),placement:"top-right"}),n("#id_buttonPrevPage"));t.attr("data-toggle","tooltip"),t.tooltip({title:p.textPrevPage+Common.Utils.String.platformKey("Alt+PgUp"),placement:"top-right"}),this.fireEvent("createdelayedelements",[this,"edit"])},initEquationMenu:function(){var t=this;if(t._currentMathObj){var e,i=t._currentMathObj.get_Type(),n=t._currentMathObj,o=[];switch(i){case Asc.c_oAscMathInterfaceType.Accent:e=new Common.UI.MenuItem({caption:t.txtRemoveAccentChar,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"remove_AccentCharacter"}}),o.push(e);break;case Asc.c_oAscMathInterfaceType.BorderBox:e=new Common.UI.MenuItem({caption:t.txtBorderProps,equation:!0,disabled:t._currentParaObjDisabled,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:n.get_HideTop()?t.txtAddTop:t.txtHideTop,equationProps:{type:i,callback:"put_HideTop",value:!n.get_HideTop()}},{caption:n.get_HideBottom()?t.txtAddBottom:t.txtHideBottom,equationProps:{type:i,callback:"put_HideBottom",value:!n.get_HideBottom()}},{caption:n.get_HideLeft()?t.txtAddLeft:t.txtHideLeft,equationProps:{type:i,callback:"put_HideLeft",value:!n.get_HideLeft()}},{caption:n.get_HideRight()?t.txtAddRight:t.txtHideRight,equationProps:{type:i,callback:"put_HideRight",value:!n.get_HideRight()}},{caption:n.get_HideHor()?t.txtAddHor:t.txtHideHor,equationProps:{type:i,callback:"put_HideHor",value:!n.get_HideHor()}},{caption:n.get_HideVer()?t.txtAddVer:t.txtHideVer,equationProps:{type:i,callback:"put_HideVer",value:!n.get_HideVer()}},{caption:n.get_HideTopLTR()?t.txtAddLT:t.txtHideLT,equationProps:{type:i,callback:"put_HideTopLTR",value:!n.get_HideTopLTR()}},{caption:n.get_HideTopRTL()?t.txtAddLB:t.txtHideLB,equationProps:{type:i,callback:"put_HideTopRTL",value:!n.get_HideTopRTL()}}]})}),o.push(e);break;case Asc.c_oAscMathInterfaceType.Bar:e=new Common.UI.MenuItem({caption:t.txtRemoveBar,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"remove_Bar"}}),o.push(e),e=new Common.UI.MenuItem({caption:n.get_Pos()==Asc.c_oAscMathInterfaceBarPos.Top?t.txtUnderbar:t.txtOverbar,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_Pos",value:n.get_Pos()==Asc.c_oAscMathInterfaceBarPos.Top?Asc.c_oAscMathInterfaceBarPos.Bottom:Asc.c_oAscMathInterfaceBarPos.Top}}),o.push(e);break;case Asc.c_oAscMathInterfaceType.Script:var s=n.get_ScriptType();s==Asc.c_oAscMathInterfaceScript.PreSubSup?(e=new Common.UI.MenuItem({caption:t.txtScriptsAfter,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_ScriptType",value:Asc.c_oAscMathInterfaceScript.SubSup}}),o.push(e),e=new Common.UI.MenuItem({caption:t.txtRemScripts,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_ScriptType",value:Asc.c_oAscMathInterfaceScript.None}}),o.push(e)):(s==Asc.c_oAscMathInterfaceScript.SubSup&&(e=new Common.UI.MenuItem({caption:t.txtScriptsBefore,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_ScriptType",value:Asc.c_oAscMathInterfaceScript.PreSubSup}}),o.push(e)),s!=Asc.c_oAscMathInterfaceScript.SubSup&&s!=Asc.c_oAscMathInterfaceScript.Sub||(e=new Common.UI.MenuItem({caption:t.txtRemSubscript,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_ScriptType",value:s==Asc.c_oAscMathInterfaceScript.SubSup?Asc.c_oAscMathInterfaceScript.Sup:Asc.c_oAscMathInterfaceScript.None}}),o.push(e)),s!=Asc.c_oAscMathInterfaceScript.SubSup&&s!=Asc.c_oAscMathInterfaceScript.Sup||(e=new Common.UI.MenuItem({caption:t.txtRemSuperscript,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_ScriptType",value:s==Asc.c_oAscMathInterfaceScript.SubSup?Asc.c_oAscMathInterfaceScript.Sub:Asc.c_oAscMathInterfaceScript.None}}),o.push(e)));break;case Asc.c_oAscMathInterfaceType.Fraction:s=n.get_FractionType();s!=Asc.c_oAscMathInterfaceFraction.Skewed&&s!=Asc.c_oAscMathInterfaceFraction.Linear||(e=new Common.UI.MenuItem({caption:t.txtFractionStacked,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_FractionType",value:Asc.c_oAscMathInterfaceFraction.Bar}}),o.push(e)),s!=Asc.c_oAscMathInterfaceFraction.Bar&&s!=Asc.c_oAscMathInterfaceFraction.Linear||(e=new Common.UI.MenuItem({caption:t.txtFractionSkewed,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_FractionType",value:Asc.c_oAscMathInterfaceFraction.Skewed}}),o.push(e)),s!=Asc.c_oAscMathInterfaceFraction.Bar&&s!=Asc.c_oAscMathInterfaceFraction.Skewed||(e=new Common.UI.MenuItem({caption:t.txtFractionLinear,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_FractionType",value:Asc.c_oAscMathInterfaceFraction.Linear}}),o.push(e)),s!=Asc.c_oAscMathInterfaceFraction.Bar&&s!=Asc.c_oAscMathInterfaceFraction.NoBar||(e=new Common.UI.MenuItem({caption:s==Asc.c_oAscMathInterfaceFraction.Bar?t.txtRemFractionBar:t.txtAddFractionBar,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_FractionType",value:s==Asc.c_oAscMathInterfaceFraction.Bar?Asc.c_oAscMathInterfaceFraction.NoBar:Asc.c_oAscMathInterfaceFraction.Bar}}),o.push(e));break;case Asc.c_oAscMathInterfaceType.Limit:e=new Common.UI.MenuItem({caption:n.get_Pos()==Asc.c_oAscMathInterfaceLimitPos.Top?t.txtLimitUnder:t.txtLimitOver,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_Pos",value:n.get_Pos()==Asc.c_oAscMathInterfaceLimitPos.Top?Asc.c_oAscMathInterfaceLimitPos.Bottom:Asc.c_oAscMathInterfaceLimitPos.Top}}),o.push(e),e=new Common.UI.MenuItem({caption:t.txtRemLimit,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_Pos",value:Asc.c_oAscMathInterfaceLimitPos.None}}),o.push(e);break;case Asc.c_oAscMathInterfaceType.Matrix:e=new Common.UI.MenuItem({caption:n.get_HidePlaceholder()?t.txtShowPlaceholder:t.txtHidePlaceholder,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_HidePlaceholder",value:!n.get_HidePlaceholder()}}),o.push(e),e=new Common.UI.MenuItem({caption:t.insertText,equation:!0,disabled:t._currentParaObjDisabled,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:t.insertRowAboveText,equationProps:{type:i,callback:"insert_MatrixRow",value:!0}},{caption:t.insertRowBelowText,equationProps:{type:i,callback:"insert_MatrixRow",value:!1}},{caption:t.insertColumnLeftText,equationProps:{type:i,callback:"insert_MatrixColumn",value:!0}},{caption:t.insertColumnRightText,equationProps:{type:i,callback:"insert_MatrixColumn",value:!1}}]})}),o.push(e),e=new Common.UI.MenuItem({caption:t.deleteText,equation:!0,disabled:t._currentParaObjDisabled,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:t.deleteRowText,equationProps:{type:i,callback:"delete_MatrixRow"}},{caption:t.deleteColumnText,equationProps:{type:i,callback:"delete_MatrixColumn"}}]})}),o.push(e),e=new Common.UI.MenuItem({caption:t.txtMatrixAlign,equation:!0,disabled:t._currentParaObjDisabled,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:t.txtTop,checkable:!0,checked:n.get_MatrixAlign()==Asc.c_oAscMathInterfaceMatrixMatrixAlign.Top,equationProps:{type:i,callback:"put_MatrixAlign",value:Asc.c_oAscMathInterfaceMatrixMatrixAlign.Top}},{caption:t.centerText,checkable:!0,checked:n.get_MatrixAlign()==Asc.c_oAscMathInterfaceMatrixMatrixAlign.Center,equationProps:{type:i,callback:"put_MatrixAlign",value:Asc.c_oAscMathInterfaceMatrixMatrixAlign.Center}},{caption:t.txtBottom,checkable:!0,checked:n.get_MatrixAlign()==Asc.c_oAscMathInterfaceMatrixMatrixAlign.Bottom,equationProps:{type:i,callback:"put_MatrixAlign",value:Asc.c_oAscMathInterfaceMatrixMatrixAlign.Bottom}}]})}),o.push(e),e=new Common.UI.MenuItem({caption:t.txtColumnAlign,equation:!0,disabled:t._currentParaObjDisabled,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:t.leftText,checkable:!0,checked:n.get_ColumnAlign()==Asc.c_oAscMathInterfaceMatrixColumnAlign.Left,equationProps:{type:i,callback:"put_ColumnAlign",value:Asc.c_oAscMathInterfaceMatrixColumnAlign.Left}},{caption:t.centerText,checkable:!0,checked:n.get_ColumnAlign()==Asc.c_oAscMathInterfaceMatrixColumnAlign.Center,equationProps:{type:i,callback:"put_ColumnAlign",value:Asc.c_oAscMathInterfaceMatrixColumnAlign.Center}},{caption:t.rightText,checkable:!0,checked:n.get_ColumnAlign()==Asc.c_oAscMathInterfaceMatrixColumnAlign.Right,equationProps:{type:i,callback:"put_ColumnAlign",value:Asc.c_oAscMathInterfaceMatrixColumnAlign.Right}}]})}),o.push(e);break;case Asc.c_oAscMathInterfaceType.EqArray:e=new Common.UI.MenuItem({caption:t.txtInsertEqBefore,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"insert_Equation",value:!0}}),o.push(e),e=new Common.UI.MenuItem({caption:t.txtInsertEqAfter,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"insert_Equation",value:!1}}),o.push(e),e=new Common.UI.MenuItem({caption:t.txtDeleteEq,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"delete_Equation"}}),o.push(e),e=new Common.UI.MenuItem({caption:t.alignmentText,equation:!0,disabled:t._currentParaObjDisabled,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:t.txtTop,checkable:!0,checked:n.get_Align()==Asc.c_oAscMathInterfaceEqArrayAlign.Top,equationProps:{type:i,callback:"put_Align",value:Asc.c_oAscMathInterfaceEqArrayAlign.Top}},{caption:t.centerText,checkable:!0,checked:n.get_Align()==Asc.c_oAscMathInterfaceEqArrayAlign.Center,equationProps:{type:i,callback:"put_Align",value:Asc.c_oAscMathInterfaceEqArrayAlign.Center}},{caption:t.txtBottom,checkable:!0,checked:n.get_Align()==Asc.c_oAscMathInterfaceEqArrayAlign.Bottom,equationProps:{type:i,callback:"put_Align",value:Asc.c_oAscMathInterfaceEqArrayAlign.Bottom}}]})}),o.push(e);break;case Asc.c_oAscMathInterfaceType.LargeOperator:e=new Common.UI.MenuItem({caption:t.txtLimitChange,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_LimitLocation",value:n.get_LimitLocation()==Asc.c_oAscMathInterfaceNaryLimitLocation.UndOvr?Asc.c_oAscMathInterfaceNaryLimitLocation.SubSup:Asc.c_oAscMathInterfaceNaryLimitLocation.UndOvr}}),o.push(e),void 0!==n.get_HideUpper()&&(e=new Common.UI.MenuItem({caption:n.get_HideUpper()?t.txtShowTopLimit:t.txtHideTopLimit,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_HideUpper",value:!n.get_HideUpper()}}),o.push(e)),void 0!==n.get_HideLower()&&(e=new Common.UI.MenuItem({caption:n.get_HideLower()?t.txtShowBottomLimit:t.txtHideBottomLimit,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_HideLower",value:!n.get_HideLower()}}),o.push(e));break;case Asc.c_oAscMathInterfaceType.Delimiter:e=new Common.UI.MenuItem({caption:t.txtInsertArgBefore,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"insert_DelimiterArgument",value:!0}}),o.push(e),e=new Common.UI.MenuItem({caption:t.txtInsertArgAfter,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"insert_DelimiterArgument",value:!1}}),o.push(e),n.can_DeleteArgument()&&(e=new Common.UI.MenuItem({caption:t.txtDeleteArg,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"delete_DelimiterArgument"}}),o.push(e)),e=new Common.UI.MenuItem({caption:n.has_Separators()?t.txtDeleteCharsAndSeparators:t.txtDeleteChars,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"remove_DelimiterCharacters"}}),o.push(e),e=new Common.UI.MenuItem({caption:n.get_HideOpeningBracket()?t.txtShowOpenBracket:t.txtHideOpenBracket,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_HideOpeningBracket",value:!n.get_HideOpeningBracket()}}),o.push(e),e=new Common.UI.MenuItem({caption:n.get_HideClosingBracket()?t.txtShowCloseBracket:t.txtHideCloseBracket,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_HideClosingBracket",value:!n.get_HideClosingBracket()}}),o.push(e),e=new Common.UI.MenuItem({caption:t.txtStretchBrackets,equation:!0,disabled:t._currentParaObjDisabled,checkable:!0,checked:n.get_StretchBrackets(),equationProps:{type:i,callback:"put_StretchBrackets",value:!n.get_StretchBrackets()}}),o.push(e),e=new Common.UI.MenuItem({caption:t.txtMatchBrackets,equation:!0,disabled:!n.get_StretchBrackets()||t._currentParaObjDisabled,checkable:!0,checked:n.get_StretchBrackets()&&n.get_MatchBrackets(),equationProps:{type:i,callback:"put_MatchBrackets",value:!n.get_MatchBrackets()}}),o.push(e);break;case Asc.c_oAscMathInterfaceType.GroupChar:n.can_ChangePos()&&(e=new Common.UI.MenuItem({caption:n.get_Pos()==Asc.c_oAscMathInterfaceGroupCharPos.Top?t.txtGroupCharUnder:t.txtGroupCharOver,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_Pos",value:n.get_Pos()==Asc.c_oAscMathInterfaceGroupCharPos.Top?Asc.c_oAscMathInterfaceGroupCharPos.Bottom:Asc.c_oAscMathInterfaceGroupCharPos.Top}}),o.push(e),e=new Common.UI.MenuItem({caption:t.txtDeleteGroupChar,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_Pos",value:Asc.c_oAscMathInterfaceGroupCharPos.None}}),o.push(e));break;case Asc.c_oAscMathInterfaceType.Radical:void 0!==n.get_HideDegree()&&(e=new Common.UI.MenuItem({caption:n.get_HideDegree()?t.txtShowDegree:t.txtHideDegree,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_HideDegree",value:!n.get_HideDegree()}}),o.push(e)),e=new Common.UI.MenuItem({caption:t.txtDeleteRadical,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"remove_Radical"}}),o.push(e)}return n.can_IncreaseArgumentSize()&&(e=new Common.UI.MenuItem({caption:t.txtIncreaseArg,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"increase_ArgumentSize"}}),o.push(e)),n.can_DecreaseArgumentSize()&&(e=new Common.UI.MenuItem({caption:t.txtDecreaseArg,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"decrease_ArgumentSize"}}),o.push(e)),n.can_InsertManualBreak()&&(e=new Common.UI.MenuItem({caption:t.txtInsertBreak,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"insert_ManualBreak"}}),o.push(e)),n.can_DeleteManualBreak()&&(e=new Common.UI.MenuItem({caption:t.txtDeleteBreak,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"delete_ManualBreak"}}),o.push(e)),n.can_AlignToCharacter()&&(e=new Common.UI.MenuItem({caption:t.txtAlignToChar,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"align_ToCharacter"}}),o.push(e)),o}},addEquationMenu:function(t,i){var n=this,o=(R.isUndefined(t)&&(t=n.textMenu.isVisible()),n.clearEquationMenu(t,i),t?n.textMenu:n.tableMenu),t=n.initEquationMenu();return 0<t.length&&R.each(t,function(t,e){t.menu?R.each(t.menu.items,function(t){t.on("click",R.bind(n.equationCallback,n,t.options.equationProps))}):t.on("click",R.bind(n.equationCallback,n,t.options.equationProps)),o.insertItem(i,t),i++}),t.length},clearEquationMenu:function(t,e){for(var i=t?this.textMenu:this.tableMenu,n=e;n<i.items.length&&i.items[n].options.equation;n++)i.items[n].menu?R.each(i.items[n].menu.items,function(t){t.off("click")}):i.items[n].off("click"),i.removeItem(i.items[n]),n--},equationCallback:function(t){this.fireEvent("equation:callback",[t])},addWordVariants:function(t){var i,e,n,o,s,a=this;a.textMenu&&(a.textMenu.isVisible()||a.tableMenu.isVisible())&&(R.isUndefined(t)&&(t=a.textMenu.isVisible()),a.clearWordVariants(t),i=t?a.menuSpellMorePara:a.menuSpellMoreTable,e=t?a.menuSpellPara:a.menuSpellTable,n=[],o=[],0<(s=a._currentSpellObj.get_Variants()).length?(i.setVisible(3<s.length),i.setDisabled(a._currentParaObjDisabled),R.each(s,function(t,e){t=new Common.UI.MenuItem({caption:t,spellword:!0,disabled:a._currentParaObjDisabled}).on("click",function(t,e){a.api&&(a.api.asc_replaceMisspelledWord(t.caption,a._currentSpellObj),a.fireEvent("editcomplete",a))});(e<3?n:o).push(t)}),0<n.length&&(t?R.each(n,function(t,e){a.textMenu.insertItem(e,t)}):R.each(n,function(t,e){a.menuSpellCheckTable.menu.insertItem(e,t)})),0<o.length&&R.each(o,function(t,e){i.menu.addItem(t)}),e.setVisible(!1)):(i.setVisible(!1),e.setVisible(!0),e.setCaption(a.noSpellVariantsText,!0)))},clearWordVariants:function(t){for(var e=t?this.textMenu:this.menuSpellCheckTable.menu,i=0;i<e.items.length;i++)e.items[i].options.spellword&&(e.checkeditem==e.items[i]&&(e.checkeditem=void 0,e.activeItem=void 0),e.removeItem(e.items[i]),i--);(t?this.menuSpellMorePara:this.menuSpellMoreTable).menu.removeAll(),this.menuSpellMorePara.menu.checkeditem=void 0,this.menuSpellMorePara.menu.activeItem=void 0,this.menuSpellMoreTable.menu.checkeditem=void 0,this.menuSpellMoreTable.menu.activeItem=void 0},setLanguages:function(t){var e,i;t&&0<t.length&&this.langParaMenu&&this.langTableMenu&&(e=[],i=[],R.each(t,function(t){t={caption:t.displayValue,value:t.value,checkable:!0,langid:t.code,spellcheck:t.spellcheck};e.push(t),i.push(R.clone(t))}),this.langParaMenu.menu.resetItems(e),this.langTableMenu.menu.resetItems(i))},changeLanguageMenu:function(t){var e;null===this._currLang.id||void 0===this._currLang.id?t.clearAll():-1<(e=R.findIndex(t.items,{langid:this._currLang.id}))&&!t.items[e].checked&&t.setChecked(e,!0)},getControlLabel:function(t){switch(t?t.get_SpecificType():Asc.c_oAscContentControlSpecificType.None){case Asc.c_oAscContentControlSpecificType.CheckBox:return"string"!=typeof t.get_CheckBoxPr().get_GroupKey()?this.textRemCheckBox:this.textRemRadioBox;case Asc.c_oAscContentControlSpecificType.ComboBox:return this.textRemComboBox;case Asc.c_oAscContentControlSpecificType.DropDownList:return this.textRemDropdown;case Asc.c_oAscContentControlSpecificType.Picture:return this.textRemPicture;default:return this.textRemField}},createEquationMenu:function(t,e){return new Common.UI.Menu({cls:"ppm-toolbar shifted-right",menuAlign:e,items:[new Common.UI.MenuItem({caption:this.currProfText,iconCls:"menu__icon btn-professional-equation",type:"view",value:{all:!1,linear:!1}}),new Common.UI.MenuItem({caption:this.currLinearText,iconCls:"menu__icon btn-linear-equation",type:"view",value:{all:!1,linear:!0}}),new Common.UI.MenuItem({caption:this.allProfText,iconCls:"menu__icon btn-professional-equation",type:"view",value:{all:!0,linear:!1}}),new Common.UI.MenuItem({caption:this.allLinearText,iconCls:"menu__icon btn-linear-equation",type:"view",value:{all:!0,linear:!0}}),{caption:"--"},new Common.UI.MenuItem({caption:this.unicodeText,checkable:!0,checked:!1,toggleGroup:t,type:"input",value:Asc.c_oAscMathInputType.Unicode}),new Common.UI.MenuItem({caption:this.latexText,checkable:!0,checked:!1,toggleGroup:t,type:"input",value:Asc.c_oAscMathInputType.LaTeX}),{caption:"--"},new Common.UI.MenuItem({caption:this.eqToInlineText,isEquationInline:!1,type:"mode"}),new Common.UI.MenuItem({caption:this.hideEqToolbar,isToolbarHide:!1,type:"hide"})]})},updateCustomItems:function(s,t){var a,l,r,c,d;!s||!t||t.length<1||(l=(a=this).mode&&a.mode.lang?a.mode.lang.split(/[\-_]/)[0]:"en",a._preventCustomClick&&clearTimeout(a._preventCustomClick),a._hasCustomItems&&(a._preventCustomClick=setTimeout(function(){a._preventCustomClick=null},500)),a._hasCustomItems=!0,r=function(t,e){if(s&&0<s.items.length)for(var i=s.items.length-1;0<=i;i--)if(s.items[i].options.isCustomItem&&(void 0===e&&s.items[i].options.guid===t||s.items[i].options.guid===t&&s.items[i].value===e))return s.items[i]},c=function(t,e,i){return i?i.removeAll():((i=new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[]})).on("item:click",function(t,e,i){!a._preventCustomClick&&a.api&&a.api.onPluginContextMenuItemClick&&a.api.onPluginContextMenuItemClick(e.options.guid,e.value)}),i.on("menu:click",function(t,e){a._preventCustomClick&&e.stopPropagation()})),t.forEach(function(t){t.separator&&i.addItem({caption:"--",isCustomItem:!0,guid:e}),t.text&&i.addItem({caption:("object"==typeof t.text?t.text[l]||t.text.en:t.text)||"",isCustomItem:!0,value:t.id,guid:e,menu:!!t.items&&c(t.items,e),disabled:!!t.disabled})}),i},t.forEach(function(n){var o=!r(n.guid);n&&n.items&&0<n.items.length&&n.items.forEach(function(t){var e,i;t.separator&&o?s.addItem({caption:"--",isCustomItem:!0,guid:n.guid}):t.text&&(i=r(n.guid,t.id),e=("object"==typeof t.text?t.text[l]||t.text.en:t.text)||"",i?(i.setCaption(e),i.setDisabled(!!t.disabled),t.items&&(i.menu?(i.menu.isVisible()&&0<i.menu.cmpEl.find(" > li:not(.divider):not(.disabled):visible").find("> a").filter(":focus").length&&(i.menu.isOver=!0,d=i.cmpEl),c(t.items,n.guid,i.menu)):i.setMenu(c(t.items,n.guid)))):(i=new Common.UI.MenuItem({caption:e,isCustomItem:!0,value:t.id,guid:n.guid,menu:!!(t.items&&0<=t.items.length)&&c(t.items,n.guid),disabled:!!t.disabled}).on("click",function(t,e){!a._preventCustomClick&&a.api&&a.api.onPluginContextMenuItemClick&&a.api.onPluginContextMenuItemClick(t.options.guid,t.value)}),s.addItem(i)))})}),d&&0<(t=n("> [role=menu]",d).find("> li:not(.divider):not(.disabled):visible > a")).length&&t.eq(0).focus(),s.alignPosition())},clearCustomItems:function(t){if(t&&0<t.items.length)for(var e=0;e<t.items.length;e++)t.items[e].options.isCustomItem&&(t.removeItem(t.items[e]),e--);this._hasCustomItems=!1},focus:function(){var t=this;R.defer(function(){t.cmpEl.focus()},50)},SetDisabled:function(t,e,i){this._isDisabled=t,this._canProtect=!t||e,this._fillFormMode=!!t&&i}},DE.Views.DocumentHolder||{}))}),{LINERULE_LEAST:0,LINERULE_AUTO:1,LINERULE_EXACT:2}),c_paragraphSpecial={NONE_SPECIAL:0,FIRST_LINE:1,HANGING:2},c_paragraphTextAlignment={RIGHT:0,LEFT:1,CENTERED:2,JUSTIFIED:3},c_pageNumPosition={PAGE_NUM_POSITION_TOP:1,PAGE_NUM_POSITION_BOTTOM:2,PAGE_NUM_POSITION_RIGHT:0,PAGE_NUM_POSITION_LEFT:1,PAGE_NUM_POSITION_CENTER:2},c_tableWrap={TABLE_WRAP_NONE:0,TABLE_WRAP_PARALLEL:1},c_tableAlign={TABLE_ALIGN_LEFT:0,TABLE_ALIGN_CENTER:1,TABLE_ALIGN_RIGHT:2},c_tableBorder={BORDER_VERTICAL_LEFT:0,BORDER_HORIZONTAL_TOP:1,BORDER_VERTICAL_RIGHT:2,BORDER_HORIZONTAL_BOTTOM:3,BORDER_VERTICAL_CENTER:4,BORDER_HORIZONTAL_CENTER:5,BORDER_INNER:6,BORDER_OUTER:7,BORDER_ALL:8,BORDER_NONE:9,BORDER_ALL_TABLE:10,BORDER_NONE_TABLE:11,BORDER_INNER_TABLE:12,BORDER_OUTER_TABLE:13},Common,Common,Common,Common,Common,Common,Common,Common,Common,Common,Common,Common,Common,Common,Common,SCALE_MIN=(define("documenteditor/main/app/controller/DocumentHolder",["core","documenteditor/main/app/view/DocumentHolder"],function(){"use strict";DE.Controllers.DocumentHolder=Backbone.Controller.extend({models:[],collections:[],views:["DocumentHolder"],initialize:function(){this.addListeners({DocumentHolder:{createdelayedelements:this.createDelayedElements,"equation:callback":this.equationCallback}});var t=this,e=(t._TtHeight=20,t.usertips=[],t.fastcoauthtips=[],t._isDisabled=!1,t._state={},t.mode={},t.mouseMoveData=null,t.isTooltipHiding=!1,t.lastMathTrackBounds=[],t.screenTip={toolTip:new Common.UI.Tooltip({owner:this,html:!0,title:"<br><b>Press Ctrl and click link</b>",cls:"link-tooltip"}),strTip:"",isHidden:!0,isVisible:!1},t.eyedropperTip={isHidden:!0,isVisible:!1,eyedropperColor:null,tipInterval:null,isTipVisible:!1},t.userTooltip=!0,t.wrapEvents={userTipMousover:_.bind(t.userTipMousover,t),userTipMousout:_.bind(t.userTipMousout,t),onKeyUp:_.bind(t.onKeyUp,t)},{});t.hkComments=Common.Utils.isMac?"command+alt+a":"alt+h",e[t.hkComments]=function(){return!1!==t.api.can_AddQuotedComment()&&t.addComment(),!1},Common.util.Shortcuts.delegateShortcuts({shortcuts:e}),Common.Utils.InternalSettings.set("de-equation-toolbar-hide",Common.localStorage.getBool("de-equation-toolbar-hide"))},onLaunch:function(){this.documentHolder=this.createView("DocumentHolder").render(),this.documentHolder.el.tabIndex=-1,this.onAfterRender();var e=this;Common.NotificationCenter.on({"window:show":function(t){e.screenTip.toolTip.hide(),e.screenTip.isVisible=!1,e.userTipHide(),e.hideEyedropper(),e.mode&&e.mode.isDesktopApp&&e.api&&e.api.asc_onShowPopupWindow()},"modal:show":function(t){e.hideTips()},"layout:changed":function(t){e.screenTip.toolTip.hide(),e.screenTip.isVisible=!1,e.userTipHide(),e.hideTips(),e.hideEyedropper(),e.onDocumentHolderResize()}}),Common.NotificationCenter.on("protect:doclock",_.bind(e.onChangeProtectDocument,e))},setApi:function(t){return this.api=t,this.api&&(this.api.asc_registerCallback("asc_onContextMenu",_.bind(this.onContextMenu,this)),this.api.asc_registerCallback("asc_onMouseMoveStart",_.bind(this.onMouseMoveStart,this)),this.api.asc_registerCallback("asc_onMouseMoveEnd",_.bind(this.onMouseMoveEnd,this)),this.api.asc_registerCallback("asc_onHyperlinkClick",_.bind(this.onHyperlinkClick,this)),this.api.asc_registerCallback("asc_onMouseMove",_.bind(this.onMouseMove,this)),!0===this.mode.isEdit&&(this.api.asc_registerCallback("asc_onImgWrapStyleChanged",_.bind(this.onImgWrapStyleChanged,this)),this.api.asc_registerCallback("asc_onDialogAddHyperlink",_.bind(this.onDialogAddHyperlink,this)),this.api.asc_registerCallback("asc_doubleClickOnChart",_.bind(this.onDoubleClickOnChart,this)),this.api.asc_registerCallback("asc_doubleClickOnTableOleObject",_.bind(this.onDoubleClickOnTableOleObject,this)),this.api.asc_registerCallback("asc_onSpellCheckVariantsFound",_.bind(this.onSpellCheckVariantsFound,this)),this.api.asc_registerCallback("asc_onRulerDblClick",_.bind(this.onRulerDblClick,this)),this.api.asc_registerCallback("asc_ChangeCropState",_.bind(this.onChangeCropState,this)),this.api.asc_registerCallback("asc_onLockDocumentProps",_.bind(this.onApiLockDocumentProps,this)),this.api.asc_registerCallback("asc_onUnLockDocumentProps",_.bind(this.onApiUnLockDocumentProps,this)),this.api.asc_registerCallback("asc_onShowMathTrack",_.bind(this.onShowMathTrack,this)),this.api.asc_registerCallback("asc_onHideMathTrack",_.bind(this.onHideMathTrack,this)),this.api.asc_registerPlaceholderCallback(AscCommon.PlaceholderButtonType.Image,_.bind(this.onInsertImage,this)),this.api.asc_registerPlaceholderCallback(AscCommon.PlaceholderButtonType.ImageUrl,_.bind(this.onInsertImageUrl,this)),this.api.asc_registerCallback("asc_onHideEyedropper",_.bind(this.hideEyedropper,this)),this.api.asc_SetMathInputType(Common.localStorage.getBool("de-equation-input-latex")?Asc.c_oAscMathInputType.LaTeX:Asc.c_oAscMathInputType.Unicode)),this.api.asc_registerCallback("asc_onCoAuthoringDisconnect",_.bind(this.onCoAuthoringDisconnect,this)),Common.NotificationCenter.on("api:disconnect",_.bind(this.onCoAuthoringDisconnect,this)),this.api.asc_registerCallback("asc_onTextLanguage",_.bind(this.onTextLanguage,this)),this.api.asc_registerCallback("asc_onParaStyleName",_.bind(this.onApiParagraphStyleChange,this)),this.api.asc_registerCallback("asc_onShowForeignCursorLabel",_.bind(this.onShowForeignCursorLabel,this)),this.api.asc_registerCallback("asc_onHideForeignCursorLabel",_.bind(this.onHideForeignCursorLabel,this)),this.api.asc_registerCallback("asc_onFocusObject",_.bind(this.onFocusObject,this)),this.api.asc_registerCallback("asc_onShowSpecialPasteOptions",_.bind(this.onShowSpecialPasteOptions,this)),this.api.asc_registerCallback("asc_onHideSpecialPasteOptions",_.bind(this.onHideSpecialPasteOptions,this)),(this.mode.isEdit||this.mode.isRestrictedEdit&&this.mode.canFillForms)&&(this.api.asc_registerCallback("asc_onShowContentControlsActions",_.bind(this.onShowContentControlsActions,this)),this.api.asc_registerCallback("asc_onHideContentControlsActions",_.bind(this.onHideContentControlsActions,this))),this.api.asc_registerCallback("onPluginContextMenu",_.bind(this.onPluginContextMenu,this)),this.documentHolder.setApi(this.api)),this},setMode:function(t){this.mode=t,this.mode.canCoAuthoring&&this.mode.canComments?Common.util.Shortcuts.resumeEvents(this.hkComments):Common.util.Shortcuts.suspendEvents(this.hkComments),this.documentHolder.setMode(t)},createDelayedElements:function(t,e){var i,n,o=this,t=o.documentHolder;"view"==e?(t.menuViewCopy.on("click",_.bind(o.onCutCopyPaste,o)),t.menuViewPaste.on("click",_.bind(o.onCutCopyPaste,o)),t.menuViewCut.on("click",_.bind(o.onCutCopyPaste,o)),t.menuViewUndo.on("click",_.bind(o.onUndo,o)),t.menuViewAddComment.on("click",_.bind(o.addComment,o)),t.menuSignatureViewSign.on("click",_.bind(o.onSignatureClick,o)),t.menuSignatureDetails.on("click",_.bind(o.onSignatureClick,o)),t.menuSignatureViewSetup.on("click",_.bind(o.onSignatureClick,o)),t.menuSignatureRemove.on("click",_.bind(o.onSignatureClick,o)),t.menuViewPrint.on("click",_.bind(o.onPrintSelection,o))):"pdf"==e?t.menuPDFViewCopy.on("click",_.bind(o.onCutCopyPaste,o)):((i=this.getApplication().getController("Common.Controllers.ExternalDiagramEditor").getView("Common.Views.ExternalDiagramEditor"))&&(i.on("internalmessage",_.bind(function(t,e){e.data.command;e=e.data.data;this.api&&(i.isEditMode()?this.api.asc_editChartDrawingObject(e):this.api.asc_addChartDrawingObject(e))},this)),i.on("hide",_.bind(function(t,e){this.api&&(this.api.asc_onCloseChartFrame(),this.api.asc_enableKeyEvents(!0)),setTimeout(function(){o.editComplete()},10)},this))),(e=this.getApplication().getController("Common.Controllers.ExternalMergeEditor").getView("Common.Views.ExternalMergeEditor"))&&(e.on("internalmessage",_.bind(function(t,e){e.data.command;e=e.data.data;this.api&&this.api.asc_setMailMergeData(e)},this)),e.on("hide",_.bind(function(t,e){this.api&&this.api.asc_enableKeyEvents(!0),setTimeout(function(){o.editComplete()},10)},this))),(n=this.getApplication().getController("Common.Controllers.ExternalOleEditor").getView("Common.Views.ExternalOleEditor"))&&(n.on("internalmessage",_.bind(function(t,e){e.data.command;e=e.data.data;this.api&&(n.isEditMode()?this.api.asc_editTableOleObject(e):this.api.asc_addTableOleObject(e))},this)),n.on("hide",_.bind(function(t,e){this.api&&(this.api.asc_enableKeyEvents(!0),this.api.asc_onCloseChartFrame()),setTimeout(function(){o.editComplete()},10)},this))),t.menuInsertCaption.on("click",_.bind(o.onInsertCaption,o)),t.menuEquationInsertCaption.on("click",_.bind(o.onInsertCaption,o)),t.menuTableInsertCaption.on("click",_.bind(o.onInsertCaption,o)),t.menuChartEdit.on("click",_.bind(o.editChartClick,o)),t.menuImgCopy.on("click",_.bind(o.onCutCopyPaste,o)),t.menuImgPaste.on("click",_.bind(o.onCutCopyPaste,o)),t.menuImgCut.on("click",_.bind(o.onCutCopyPaste,o)),t.menuTableCopy.on("click",_.bind(o.onCutCopyPaste,o)),t.menuTablePaste.on("click",_.bind(o.onCutCopyPaste,o)),t.menuTableCut.on("click",_.bind(o.onCutCopyPaste,o)),t.menuParaCopy.on("click",_.bind(o.onCutCopyPaste,o)),t.menuParaPaste.on("click",_.bind(o.onCutCopyPaste,o)),t.menuParaCut.on("click",_.bind(o.onCutCopyPaste,o)),t.menuImgAccept.on("click",_.bind(o.onAcceptRejectChange,o)),t.menuImgReject.on("click",_.bind(o.onAcceptRejectChange,o)),t.menuTableAccept.on("click",_.bind(o.onAcceptRejectChange,o)),t.menuTableReject.on("click",_.bind(o.onAcceptRejectChange,o)),t.menuParaAccept.on("click",_.bind(o.onAcceptRejectChange,o)),t.menuParaReject.on("click",_.bind(o.onAcceptRejectChange,o)),t.menuImgPrint.on("click",_.bind(o.onPrintSelection,o)),t.menuTablePrint.on("click",_.bind(o.onPrintSelection,o)),t.menuParaPrint.on("click",_.bind(o.onPrintSelection,o)),t.menuSignatureEditSign.on("click",_.bind(o.onSignatureClick,o)),t.menuSignatureEditSetup.on("click",_.bind(o.onSignatureClick,o)),t.menuImgRotate.menu.items[0].on("click",_.bind(o.onImgRotate,o)),t.menuImgRotate.menu.items[1].on("click",_.bind(o.onImgRotate,o)),t.menuImgRotate.menu.items[3].on("click",_.bind(o.onImgFlip,o)),t.menuImgRotate.menu.items[4].on("click",_.bind(o.onImgFlip,o)),t.menuImgCrop.menu.on("item:click",_.bind(o.onImgCrop,o)),t.menuImgRemoveControl.on("click",_.bind(o.onControlsSelect,o)),t.menuImgControlSettings.on("click",_.bind(o.onControlsSelect,o)),t.menuTableRemoveForm.on("click",_.bind(o.onControlsSelect,o)),t.menuTableRemoveControl.on("click",_.bind(o.onControlsSelect,o)),t.menuTableControlSettings.on("click",_.bind(o.onControlsSelect,o)),t.menuParaRemoveControl.on("click",_.bind(o.onControlsSelect,o)),t.menuParaControlSettings.on("click",_.bind(o.onControlsSelect,o)),t.menuTableCellAlign.menu.on("item:click",_.bind(o.tableCellsVAlign,o)),t.menuTableAdvanced.on("click",_.bind(o.advancedTableClick,o)),t.menuParagraphAdvancedInTable.on("click",_.bind(o.advancedParagraphClick,o)),t.menuParagraphAdvanced.on("click",_.bind(o.advancedParagraphClick,o)),t.menuEditHyperlinkTable.on("click",_.bind(o.editHyperlink,o)),t.menuEditHyperlinkPara.on("click",_.bind(o.editHyperlink,o)),t.menuRemoveHyperlinkTable.on("click",_.bind(o.onRemoveHyperlink,o)),t.menuRemoveHyperlinkPara.on("click",_.bind(o.onRemoveHyperlink,o)),t.menuAddHyperlinkTable.on("click",_.bind(o.addHyperlink,o)),t.menuAddHyperlinkPara.on("click",_.bind(o.addHyperlink,o)),t.menuAddCommentTable.on("click",_.bind(o.addComment,o)),t.menuAddCommentPara.on("click",_.bind(o.addComment,o)),t.menuTableFollow.on("click",_.bind(o.onFollowMove,o)),t.menuParaFollow.on("click",_.bind(o.onFollowMove,o)),t.menuTableStartNewList.on("click",_.bind(o.onStartNumbering,o,1)),t.menuParaStartNewList.on("click",_.bind(o.onStartNumbering,o,1)),t.menuTableStartNumberingFrom.on("click",_.bind(o.onStartNumbering,o,"advanced")),t.menuParaStartNumberingFrom.on("click",_.bind(o.onStartNumbering,o,"advanced")),t.menuTableContinueNumbering.on("click",_.bind(o.onContinueNumbering,o)),t.menuParaContinueNumbering.on("click",_.bind(o.onContinueNumbering,o)),t.menuFrameAdvanced.on("click",_.bind(o.advancedFrameClick,o,!0)),t.menuDropCapAdvanced.on("click",_.bind(o.advancedFrameClick,o,!1)),t.menuStyleSave.on("click",_.bind(o.onMenuSaveStyle,o)),t.menuStyleUpdate.on("click",_.bind(o.onMenuUpdateStyle,o)),t.menuTableSelectText.menu.on("item:click",_.bind(o.tableSelectText,o)),t.menuTableInsertText.menu.on("item:click",_.bind(o.tableInsertText,o)),t.menuTableDeleteText.menu.on("item:click",_.bind(o.tableDeleteText,o)),t.menuImageAlign.menu.on("item:click",_.bind(o.onImgAlign,o)),t.menuImageArrange.menu.on("item:click",_.bind(o.onImgArrange,o)),t.mnuGroup.on("click",_.bind(o.onImgGroup,o)),t.mnuUnGroup.on("click",_.bind(o.onImgUnGroup,o)),t.menuWrapPolygon.on("click",_.bind(o.onImgWrapPolygon,o)),t.menuImageWrap.menu.on("item:click",_.bind(o.onImgWrap,o)),t.menuImageAdvanced.on("click",_.bind(o.onImgAdvanced,o)),t.menuOriginalSize.on("click",_.bind(o.onImgOriginalSize,o)),t.menuImgReplace.menu.on("item:click",_.bind(o.onImgReplace,o)),t.menuImgEditPoints.on("click",_.bind(o.onImgEditPoints,o)),t.mnuTableMerge.on("click",_.bind(o.onTableMerge,o)),t.mnuTableSplit.on("click",_.bind(o.onTableSplit,o)),t.menuIgnoreSpellTable.on("click",_.bind(o.onIgnoreSpell,o)),t.menuIgnoreSpellPara.on("click",_.bind(o.onIgnoreSpell,o)),t.menuIgnoreAllSpellTable.on("click",_.bind(o.onIgnoreSpell,o)),t.menuIgnoreAllSpellPara.on("click",_.bind(o.onIgnoreSpell,o)),t.menuToDictionaryTable.on("click",_.bind(o.onToDictionary,o)),t.menuToDictionaryPara.on("click",_.bind(o.onToDictionary,o)),t.menuTableDistRows.on("click",_.bind(o.onTableDist,o)),t.menuTableDistCols.on("click",_.bind(o.onTableDist,o)),t.menuTableDirection.menu.on("item:click",_.bind(o.tableDirection,o)),t.menuTableRefreshField.on("click",_.bind(o.onRefreshField,o)),t.menuParaRefreshField.on("click",_.bind(o.onRefreshField,o)),t.menuParagraphBreakBefore.on("click",_.bind(o.onParagraphBreakBefore,o)),t.menuParagraphKeepLines.on("click",_.bind(o.onParagraphKeepLines,o)),t.menuParagraphVAlign.menu.on("item:click",_.bind(o.paragraphVAlign,o)),t.menuParagraphDirection.menu.on("item:click",_.bind(o.paragraphDirection,o)),t.langParaMenu.menu.on("item:click",_.bind(o.onLangMenu,o,"para")),t.langTableMenu.menu.on("item:click",_.bind(o.onLangMenu,o,"table")),t.menuTableTOC.menu.on("item:click",_.bind(o.onTOCMenu,o)),t.menuParaTOCRefresh.menu.on("item:click",_.bind(o.onTOCMenu,o)),t.menuParaTOCSettings.on("click",_.bind(o.onParaTOCSettings,o)),t.menuTableEquation.menu.on("item:click",_.bind(o.convertEquation,o)),t.menuParagraphEquation.menu.on("item:click",_.bind(o.convertEquation,o)),t.menuTableListIndents.on("click",_.bind(o.onListIndents,o)),t.menuParaListIndents.on("click",_.bind(o.onListIndents,o)),t.menuSaveAsPicture.on("click",_.bind(o.saveAsPicture,o)),o.onChangeProtectDocument())},getView:function(t){return t?Backbone.Controller.prototype.getView.call():this.documentHolder},showPopupMenu:function(t,e,i,n,o){var s;_.isUndefined(t)||null===t||(Common.UI.Menu.Manager.hideAll(),i=[i.get_X(),i.get_Y()],s=$(this.documentHolder.el).find(Common.Utils.String.format("#menu-container-{0}",t.id)),t.rendered||(s.length<1&&(s=$(Common.Utils.String.format('<div id="menu-container-{0}" style="position: absolute; z-index: 10000;"><div class="dropdown-toggle" data-toggle="dropdown"></div></div>',t.id)),$(this.documentHolder.el).append(s)),t.render(s),t.cmpEl.attr({tabindex:"-1"})),s.css({left:i[0],top:i[1]}),t.show(),_.isFunction(t.options.initMenu)&&(t.options.initMenu(e),t.alignPosition()),_.delay(function(){t.cmpEl.focus()},10),this.documentHolder.currentMenu=t,this.api.onPluginContextMenuShow&&this.api.onPluginContextMenuShow())},fillMenuProps:function(t){if(t&&_.isArray(t)){for(var e=this.documentHolder,i={},n=e.textMenu,o=!0,s=0;s<t.length;s++){var a=t[s].get_ObjectType(),l=t[s].get_ObjectValue();if(Asc.c_oAscTypeSelectElement.Image==a){n=e.pictureMenu,void 0===i.imgProps&&(i.imgProps={});var r=l.get_ShapeProperties(),c=l.get_ChartProperties();if(r?r.get_FromChart()?i.imgProps.isChart=!0:r.get_FromImage()?i.imgProps.isOnlyImg=!0:(r.get_FromSmartArt()&&(i.imgProps.isSmartArt=!0),r.get_FromSmartArtInternal()&&(i.imgProps.isSmartArtInternal=!0),i.imgProps.isShape=!0):c?i.imgProps.isChart=!0:i.imgProps.isImg=!0,i.imgProps.value=l,i.imgProps.locked=!!l&&l.get_Locked(),o=!1,null==r&&null==c)break}else Asc.c_oAscTypeSelectElement.Table==a?(n=e.tableMenu,i.tableProps={},i.tableProps.value=l,i.tableProps.locked=!!l&&l.get_Locked(),o=!1):Asc.c_oAscTypeSelectElement.Paragraph==a?(i.paraProps={},i.paraProps.value=l,i.paraProps.locked=!!l&&l.get_Locked(),i.imgProps&&(i.imgProps.isChart||i.imgProps.isShape)&&void 0===i.tableProps&&(n=e.textMenu),o=!1):Asc.c_oAscTypeSelectElement.Hyperlink==a?(i.hyperProps?i.hyperProps.isSeveralLinks=!0:i.hyperProps={},i.hyperProps.value=l):Asc.c_oAscTypeSelectElement.Header==a?(i.headerProps={},i.headerProps.locked=!!l&&l.get_Locked()):Asc.c_oAscTypeSelectElement.SpellCheck==a?(i.spellProps={},i.spellProps.value=l,this.documentHolder._currentSpellObj=l):Asc.c_oAscTypeSelectElement.Math==a&&(i.mathProps={},i.mathProps.value=l,this.documentHolder._currentMathObj=l)}return o?null:{menu_to_show:n,menu_props:i}}},fillViewMenuProps:function(t){if(t&&_.isArray(t)){for(var e=this.documentHolder,i=(e.viewModeMenu||e.createDelayedElementsViewer(),{}),n=e.viewModeMenu,o=!0,s=0;s<t.length;s++){var a=t[s].get_ObjectType(),l=t[s].get_ObjectValue();Asc.c_oAscTypeSelectElement.Image==a?(i.imgProps={},i.imgProps.value=l,o=!1):Asc.c_oAscTypeSelectElement.Paragraph==a?(i.paraProps={},i.paraProps.value=l,i.paraProps.locked=!!l&&l.get_Locked(),o=!1):Asc.c_oAscTypeSelectElement.Text==a&&(e.viewPDFModeMenu||e.createDelayedElementsPDFViewer(),n=e.viewPDFModeMenu,o=!1)}return o?null:{menu_to_show:n,menu_props:i}}},showObjectMenu:function(t,e,i){var n;this.api&&(n=this.documentHolder._docProtection,(n=this.mode.isEdit&&!(this._isDisabled||n.isReadOnly||n.isFormsOnly||n.isCommentsOnly)?this.fillMenuProps(this.api.getSelectedElements()):this.fillViewMenuProps(this.api.getSelectedElements()))&&this.showPopupMenu(n.menu_to_show,n.menu_props,t,e,i))},onContextMenu:function(t){var e;Common.UI.HintManager.isHintVisible()&&Common.UI.HintManager.clearHints(),t?(e=this,_.delay(function(){0==t.get_Type()?e.showObjectMenu.call(e,t):e.showPopupMenu.call(e,e.documentHolder.hdrMenu,{Header:t.is_Header(),PageNum:t.get_PageNum()},t)},10)):Common.UI.Menu.Manager.hideAll()},onFocusObject:function(t){var e,i=this.documentHolder.currentMenu;if(i&&i.isVisible()&&i!==this.documentHolder.hdrMenu&&(e=this.documentHolder._docProtection,(e=this.mode.isEdit&&!(this._isDisabled||e.isReadOnly||e.isFormsOnly||e.isCommentsOnly)?this.fillMenuProps(t):this.fillViewMenuProps(t))&&e.menu_to_show===i&&(i.options.initMenu(e.menu_props),i.alignPosition())),this.mode&&this.mode.isEdit){for(var n=-1,o=!1,s=!1;++n<t.length;){var a=t[n].get_ObjectType();a===Asc.c_oAscTypeSelectElement.Math?o=!0:a!==Asc.c_oAscTypeSelectElement.Paragraph&&a!==Asc.c_oAscTypeSelectElement.Table&&a!==Asc.c_oAscTypeSelectElement.Header||(a=t[n].get_ObjectValue())&&(s=s||a.get_Locked())}o&&(this._state.equationLocked=s,this.disableEquationBar())}},handleDocumentWheel:function(t){var e;this.api&&(e=(_.isUndefined(t.originalEvent)?t:t.originalEvent).wheelDelta,_.isUndefined(e)&&(e=t.deltaY),t.ctrlKey&&!t.altKey&&(e<0?this.api.zoomOut():0<e&&this.api.zoomIn(),t.preventDefault(),t.stopPropagation()))},handleDocumentKeyDown:function(t){var e=this;if(e.api){var i=t.keyCode;if(e.hkSpecPaste&&(e._needShowSpecPasteMenu=!t.shiftKey&&!t.altKey&&t.keyCode==Common.UI.Keys.CTRL),(t.ctrlKey||t.metaKey)&&!t.shiftKey&&!t.altKey){if(i===Common.UI.Keys.NUM_PLUS||i===Common.UI.Keys.EQUALITY||Common.Utils.isGecko&&i===Common.UI.Keys.EQUALITY_FF||Common.Utils.isOpera&&43==i)return e.api.zoomIn(),t.preventDefault(),t.stopPropagation(),!1;if(i===Common.UI.Keys.NUM_MINUS||i===Common.UI.Keys.MINUS||Common.Utils.isGecko&&i===Common.UI.Keys.MINUS_FF||Common.Utils.isOpera&&45==i)return i===Common.UI.Keys.NUM_MINUS&&e.mode.isEdit||e.api.zoomOut(),t.preventDefault(),t.stopPropagation(),!1;if(i===Common.UI.Keys.ZERO||i===Common.UI.Keys.NUM_ZERO)return e.api.zoom(100),t.preventDefault(),t.stopPropagation(),!1}e.documentHolder.currentMenu&&e.documentHolder.currentMenu.isVisible()&&(i!=Common.UI.Keys.UP&&i!=Common.UI.Keys.DOWN||$("ul.dropdown-menu",e.documentHolder.currentMenu.el).focus()),i==Common.UI.Keys.ESC&&(Common.UI.Menu.Manager.hideAll(),Common.UI.HintManager.isHintVisible()||Common.NotificationCenter.trigger("leftmenu:change","hide"))}},onDocumentHolderResize:function(t){this._XY=[this.documentHolder.cmpEl.offset().left-$(window).scrollLeft(),this.documentHolder.cmpEl.offset().top-$(window).scrollTop()],this._Height=this.documentHolder.cmpEl.height(),this._Width=this.documentHolder.cmpEl.width(),this._BodyWidth=$("body").width()},onAfterRender:function(t){var e,i,n,o=this,s=o.documentHolder.cmpEl;s&&(s.on("contextmenu",function(t){return t.preventDefault(),t.stopPropagation(),!1}),s.on("click",function(t){"canvas"==t.target.localName&&(o._preventClick?o._preventClick=!1:s.focus())}),s.on("mousedown",function(t){"canvas"==t.target.localName&&Common.UI.Menu.Manager.hideAll()}),s.on("touchstart",function(t){"canvas"==t.target.localName&&Common.UI.Menu.Manager.hideAll()}),i=/Firefox/i.test(navigator.userAgent)?"DOMMouseScroll":"mousewheel",e=o.documentHolder.el,i=i,n=_.bind(o.handleDocumentWheel,o),e.addEventListener?e.addEventListener(i,n,!1):e.attachEvent("on"+i,n)),Common.Utils.isChrome?document.addEventListener("mousewheel",_.bind(o.handleDocumentWheel,o),{passive:!1}):$(document).on("mousewheel",_.bind(o.handleDocumentWheel,o)),$(document).on("keydown",_.bind(o.handleDocumentKeyDown,o)),$(window).on("resize",_.bind(o.onDocumentHolderResize,o)),o.getApplication().getController("Viewport").getView("Viewport").hlayout.on("layout:resizedrag",_.bind(o.onDocumentHolderResize,o))},getUserName:function(t){var e=DE.getCollection("Common.Collections.Users");if(e){e=e.findUser(t);if(e)return AscCommon.UserInfoParser.getParsedName(e.get("username"))}return this.documentHolder.guestText},isUserVisible:function(t){var e=DE.getCollection("Common.Collections.Users");if(e){e=e.findUser(t);if(e)return!e.get("hidden")}return!0},userTipMousover:function(t,e,i){!0===this.userTooltip&&(this.userTooltip=new Common.UI.Tooltip({owner:t.currentTarget,title:this.documentHolder.tipIsLocked}),this.userTooltip.show())},userTipHide:function(){if("object"==typeof this.userTooltip){this.userTooltip.hide(),this.userTooltip=void 0;for(var t=0;t<this.usertips.length;t++)this.usertips[t].off("mouseover",this.wrapEvents.userTipMousover),this.usertips[t].off("mouseout",this.wrapEvents.userTipMousout)}},userTipMousout:function(t,e,i){"object"==typeof this.userTooltip&&this.userTooltip.$element&&t.currentTarget===this.userTooltip.$element[0]&&this.userTipHide()},hideTips:function(){"object"==typeof this.userTooltip&&(this.userTooltip.hide(),this.userTooltip=!0),_.each(this.usertips,function(t){t.remove()}),this.usertips=[],this.usertipcount=0},onHyperlinkClick:function(e){var t;e&&((t=this.api.asc_getUrlType(e))===AscCommon.c_oAscUrlType.Http||t===AscCommon.c_oAscUrlType.Email?window.open(e):Common.UI.warning({msg:this.documentHolder.txtWarnUrl,buttons:["yes","no"],primary:"yes",callback:function(t){"yes"==t&&window.open(e)}}))},onDialogAddHyperlink:function(){var t,i,n,o,s=this,e=s.documentHolder._docProtection;s.api&&s.mode.isEdit&&!(s._isDisabled||e.isReadOnly||e.isFormsOnly||e.isCommentsOnly||s.getApplication().getController("LeftMenu").leftMenu.menuFile.isVisible())&&(!(e=function(t,e){"ok"==e&&(i=t.getSettings(),!1!==o?s.api.add_Hyperlink(i):s.api.change_Hyperlink(i)),s.editComplete()})!==(o=s.api.can_AddHyperlink())?(t=new DE.Views.HyperlinkSettingsDialog({api:s.api,handler:e}),(i=new Asc.CHyperlinkProperty).put_Text(o),t.show(),t.setSettings(i)):((n=s.api.getSelectedElements())&&_.isArray(n)&&_.each(n,function(t,e){n[e].get_ObjectType()==Asc.c_oAscTypeSelectElement.Hyperlink&&(i=n[e].get_ObjectValue())}),i&&((t=new DE.Views.HyperlinkSettingsDialog({api:s.api,handler:e})).show(),t.setSettings(i))),Common.component.Analytics.trackEvent("DocumentHolder","Add Hyperlink"))},onShowForeignCursorLabel:function(t,e,i,n){if(this.isUserVisible(t)){for(var o,s=0;s<this.fastcoauthtips.length;s++)if(this.fastcoauthtips[s].attr("userid")==t){o=this.fastcoauthtips[s];break}o||((o=$(document.createElement("div"))).addClass("username-tip"),o.attr("userid",t),o.css({height:this._TtHeight+"px",position:"absolute",zIndex:"900",display:"none","pointer-events":"none","background-color":"#"+Common.Utils.ThemeColor.getHexColor(n.get_r(),n.get_g(),n.get_b())}),o.text(this.getUserName(t)),$("#id_main_view").append(o),this.fastcoauthtips.push(o),o.fadeIn(150)),o.css({top:i-this._TtHeight+"px",left:e+"px"})}},onHideForeignCursorLabel:function(t){for(var e=0;e<this.fastcoauthtips.length;e++)if(this.fastcoauthtips[e].attr("userid")==t){var i=this.fastcoauthtips[e];this.fastcoauthtips[e].fadeOut(150,function(){i.remove()}),this.fastcoauthtips.splice(e,1);break}},hideEyedropper:function(){this.eyedropperTip.isVisible&&(this.eyedropperTip.isVisible=!1,this.eyedropperTip.eyedropperColor.css({left:"-1000px",top:"-1000px"})),this.eyedropperTip.isTipVisible&&(this.eyedropperTip.isTipVisible=!1,this.eyedropperTip.toolTip.hide())},onMouseMoveStart:function(){this.screenTip.isHidden=!0,0<this.usertips.length&&("object"==typeof this.userTooltip&&(this.userTooltip.hide(),this.userTooltip=!0),_.each(this.usertips,function(t){t.remove()})),this.usertips=[],this.usertipcount=0},onMouseMoveEnd:function(){var t=this;t.screenTip.isHidden&&t.screenTip.isVisible&&(t.screenTip.isVisible=!1,t.isTooltipHiding=!0,t.screenTip.toolTip.hide(function(){t.isTooltipHiding=!1,t.mouseMoveData&&t.onMouseMove(t.mouseMoveData),t.mouseMoveData=null})),t.eyedropperTip.isHidden&&t.hideEyedropper()},onMouseMove:function(t){var e=this,i=e.documentHolder.cmpEl,n=e.screenTip;if(void 0===e._XY&&(e._XY=[i.offset().left-$(window).scrollLeft(),i.offset().top-$(window).scrollTop()],e._Height=i.height(),e._Width=i.width(),e._BodyWidth=$("body").width()),t){var o,s,a,l,r,c,i=t.get_Type();if(i==Asc.c_oAscMouseMoveDataTypes.Hyperlink||i==Asc.c_oAscMouseMoveDataTypes.Footnote||i==Asc.c_oAscMouseMoveDataTypes.Form||i==Asc.c_oAscMouseMoveDataTypes.Review&&e.mode.reviewHoverMode||i==Asc.c_oAscMouseMoveDataTypes.Eyedropper||i===Asc.c_oAscMouseMoveDataTypes.Placeholder)if(e.isTooltipHiding)e.mouseMoveData=t;else{if(i==Asc.c_oAscMouseMoveDataTypes.Hyperlink){var d=t.get_Hyperlink();if(!d)return;(s=_.isEmpty(d.get_ToolTip())?d.get_Value():d.get_ToolTip())&&256<s.length&&(s=s.substr(0,256)+"...")}else if(i==Asc.c_oAscMouseMoveDataTypes.Footnote)(s=t.get_FootnoteText())&&1e3<s.length&&(s=s.substr(0,1e3)+"...");else if(i==Asc.c_oAscMouseMoveDataTypes.Form)(s=t.get_FormHelpText())&&1e3<s.length&&(s=s.substr(0,1e3)+"...");else if(i==Asc.c_oAscMouseMoveDataTypes.Review&&t.get_ReviewChange()){var d=e.getApplication().getController("Common.Controllers.ReviewChanges").readSDKChange([t.get_ReviewChange()]);(d=d&&0<d.length?d[0]:d)&&(s="<b>"+Common.Utils.String.htmlEncode(AscCommon.UserInfoParser.getParsedName(d.get("username")))+"  </b>",(s=(s+='<span class="review-date">'+d.get("date")+"</span><br>")+d.get("changetext"))&&1e3<s.length&&(s=s.substr(0,1e3)+"..."))}else if(i===Asc.c_oAscMouseMoveDataTypes.Placeholder)switch(t.get_PlaceholderType()){case AscCommon.PlaceholderButtonType.Image:s=e.documentHolder.txtInsImage;break;case AscCommon.PlaceholderButtonType.ImageUrl:s=e.documentHolder.txtInsImageUrl}else if(i==Asc.c_oAscMouseMoveDataTypes.Eyedropper)return e.eyedropperTip.isTipVisible&&(e.eyedropperTip.isTipVisible=!1,e.eyedropperTip.toolTip.hide()),e.eyedropperTip.toolTip||(d=$('<div id="tip-container-eyedroppertip" style="position: absolute; z-index: 10000;"></div>'),e.documentHolder.cmpEl.append(d),e.eyedropperTip.toolTip=new Common.UI.Tooltip({owner:d,html:!0,cls:"eyedropper-tooltip"})),d=t.get_EyedropperColor().asc_getColor(),l=d.get_r(),r=d.get_g(),c=d.get_b(),d=Common.Utils.ThemeColor.getHexColor(l,r,c),e.eyedropperTip.eyedropperColor||((h=$(document.createElement("div"))).addClass("eyedropper-color"),h.appendTo(document.body),e.eyedropperTip.eyedropperColor=h,$("#id_main_view").on("mouseleave",_.bind(e.hideEyedropper,e))),e.eyedropperTip.eyedropperColor.css({backgroundColor:"#"+d,left:t.get_X()+e._XY[0]+23+"px",top:t.get_Y()+e._XY[1]-53+"px"}),e.eyedropperTip.isVisible=!0,e.eyedropperTip.tipInterval&&clearInterval(e.eyedropperTip.tipInterval),e.eyedropperTip.tipInterval=setInterval(function(){clearInterval(e.eyedropperTip.tipInterval),e.eyedropperTip.isVisible&&(s="<div>RGB ("+l+","+r+","+c+")</div><div>"+t.get_EyedropperColor().asc_getName()+"</div>",e.eyedropperTip.toolTip.setTitle(s),e.eyedropperTip.isTipVisible=!0,e.eyedropperTip.toolTip.show([-1e4,-1e4]),e.eyedropperTip.tipWidth=e.eyedropperTip.toolTip.getBSTip().$tip.width(),(o=[t.get_X(),t.get_Y()])[1]+=e._XY[1]-57,o[0]+=e._XY[0]+58,o[0]+e.eyedropperTip.tipWidth>e._BodyWidth&&(o[0]=o[0]-e.eyedropperTip.tipWidth-40),e.eyedropperTip.toolTip.getBSTip().$tip.css({top:o[1]+"px",left:o[0]+"px"}))},800),void(e.eyedropperTip.isHidden=!1);var h=!1;n.isHidden=!1,((s=i!==Asc.c_oAscMouseMoveDataTypes.Review&&i!==Asc.c_oAscMouseMoveDataTypes.Placeholder?Common.Utils.String.htmlEncode(s):s)&&n.tipType!==i||n.tipLength!==s.length||n.strTip.indexOf(s)<0)&&(n.toolTip.setTitle(i==Asc.c_oAscMouseMoveDataTypes.Hyperlink?s+"<br><b>"+Common.Utils.String.platformKey("Ctrl",e.documentHolder.txtPressLink)+"</b>":s),n.tipLength=s.length,n.strTip=s,n.tipType=i,h=!0),(o=[t.get_X(),t.get_Y()])[1]+=e._XY[1]-15,o[0]+=e._XY[0]+5,n.isVisible&&!h||(n.isVisible=!0,n.toolTip.show([-1e4,-1e4])),h&&(n.tipHeight=n.toolTip.getBSTip().$tip.height(),n.tipWidth=n.toolTip.getBSTip().$tip.width()),h=!1,o[0]+n.tipWidth>e._BodyWidth&&(o[0]=e._BodyWidth-n.tipWidth,h=!0),o[1]-n.tipHeight<0?o[1]=h?o[1]+30:0:o[1]-=n.tipHeight,n.toolTip.getBSTip().$tip.css({top:o[1]+"px",left:o[0]+"px"})}else t.get_Type()==Asc.c_oAscMouseMoveDataTypes.LockedObject&&e.mode.isEdit&&e.isUserVisible(t.get_UserId())&&(e.usertipcount>=e.usertips.length&&((a=$(document.createElement("div"))).addClass("username-tip"),a.css({height:e._TtHeight+"px",position:"absolute",zIndex:"900",visibility:"visible"}),$(document.body).append(a),e.userTooltip&&(a.on("mouseover",e.wrapEvents.userTipMousover),a.on("mouseout",e.wrapEvents.userTipMousout)),e.usertips.push(a)),a=e.usertips[e.usertipcount],e.usertipcount++,s=e.getUserName(t.get_UserId()),d=(o=[t.get_X()+e._XY[0],t.get_Y()+e._XY[1]])[0],o[0]=e._BodyWidth-o[0],o[1]-=2==t.get_LockedObjectType()?e._TtHeight:0,o[1]>e._XY[1]&&o[1]+e._TtHeight<e._XY[1]+e._Height?(a.text(s),a.css({visibility:"visible",top:o[1]+"px",right:o[0]+"px","max-width":d+"px"})):a.css({visibility:"hidden"}))}},onShowSpecialPasteOptions:function(t){if(!this.mode||this.mode.isEdit){var i=this,e=i.documentHolder,n=t.asc_getCellCoord(),o=e.cmpEl.find("#special-paste-container"),t=t.asc_getOptions();if(t){if(o.length<1&&(i._arrSpecialPaste=[],i._arrSpecialPaste[Asc.c_oSpecialPasteProps.paste]=e.textPaste,i._arrSpecialPaste[Asc.c_oSpecialPasteProps.sourceformatting]=e.txtPasteSourceFormat,i._arrSpecialPaste[Asc.c_oSpecialPasteProps.keepTextOnly]=e.txtKeepTextOnly,i._arrSpecialPaste[Asc.c_oSpecialPasteProps.insertAsNestedTable]=e.textNest,i._arrSpecialPaste[Asc.c_oSpecialPasteProps.overwriteCells]=e.txtOverwriteCells,o=$('<div id="special-paste-container" style="position: absolute;"><div id="id-document-holder-btn-special-paste"></div></div>'),e.cmpEl.find("#id_main_view").append(o),i.btnSpecialPaste=new Common.UI.Button({parentEl:$("#id-document-holder-btn-special-paste"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-paste",caption:Common.Utils.String.format("({0})",Common.Utils.String.textCtrl),menu:new Common.UI.Menu({items:[]})}),i.initSpecialPasteEvents()),0<t.length){for(var s=i.btnSpecialPaste.menu,a=0;a<s.items.length;a++)s.removeItem(s.items[a]),a--;_.each(t,function(t,e){t=new Common.UI.MenuItem({caption:i._arrSpecialPaste[t]+" ("+i.hkSpecPaste[t]+")",value:t,checkable:!0,toggleGroup:"specialPasteGroup"}).on("click",_.bind(i.onSpecialPasteItemClick,i));s.addItem(t)}),0<s.items.length&&s.items[0].setChecked(!0,!0)}e=[n.asc_getX()+n.asc_getWidth()+3,n.asc_getY()+n.asc_getHeight()+3];n.asc_getX()<0||n.asc_getY()<0||e[0]>i._Width||e[1]>i._Height?(o.is(":visible")&&o.hide(),$(document).off("keyup",this.wrapEvents.onKeyUp)):(e[1]+o.height()>i._Height&&(e[1]=i._Height-o.height()),e[0]+o.width()>i._Width&&(e[0]=i._Width-o.width()),Common.Utils.InternalSettings.get("de-hidden-rulers")||(e=[e[0]-19,e[1]-26]),o.css({left:e[0],top:e[1]}),o.show(),setTimeout(function(){$(document).on("keyup",i.wrapEvents.onKeyUp)},10),this.disableSpecialPaste())}}},onHideSpecialPasteOptions:function(){var t;this.documentHolder&&this.documentHolder.cmpEl&&((t=this.documentHolder.cmpEl.find("#special-paste-container")).is(":visible")&&(t.hide(),$(document).off("keyup",this.wrapEvents.onKeyUp)))},disableSpecialPaste:function(){var t=this.documentHolder.cmpEl.find("#special-paste-container"),e=this.documentHolder._docProtection,e=this._isDisabled||e.isReadOnly||e.isCommentsOnly;0<t.length&&t.is(":visible")&&this.btnSpecialPaste.setDisabled(!!e)},onKeyUp:function(t){t.keyCode==Common.UI.Keys.CTRL&&this._needShowSpecPasteMenu&&!this.btnSpecialPaste.menu.isVisible()&&/area_id/.test(t.target.id)&&($("button",this.btnSpecialPaste.cmpEl).click(),t.preventDefault()),this._needShowSpecPasteMenu=!1},initSpecialPasteEvents:function(){var t,e,i=this;for(t in i.hkSpecPaste=[],i.hkSpecPaste[Asc.c_oSpecialPasteProps.paste]="P",i.hkSpecPaste[Asc.c_oSpecialPasteProps.sourceformatting]="K",i.hkSpecPaste[Asc.c_oSpecialPasteProps.keepTextOnly]="T",i.hkSpecPaste[Asc.c_oSpecialPasteProps.insertAsNestedTable]="N",i.hkSpecPaste[Asc.c_oSpecialPasteProps.overwriteCells]="O",i.hkSpecPaste)i.hkSpecPaste.hasOwnProperty(t)&&((e={})[i.hkSpecPaste[t]]=_.bind(i.onSpecialPasteItemClick,i,{value:parseInt(t)}),Common.util.Shortcuts.delegateShortcuts({shortcuts:e}),Common.util.Shortcuts.suspendEvents(i.hkSpecPaste[t],void 0,!0));i.btnSpecialPaste.menu.on("show:after",function(t){for(var e=0;e<t.items.length;e++)i.hkSpecPaste[t.items[e].value]&&Common.util.Shortcuts.resumeEvents(i.hkSpecPaste[t.items[e].value])}).on("hide:after",function(t){for(var e=0;e<t.items.length;e++)i.hkSpecPaste[t.items[e].value]&&Common.util.Shortcuts.suspendEvents(i.hkSpecPaste[t.items[e].value],void 0,!0)})},onDoubleClickOnChart:function(t){var e=this.documentHolder._docProtection;!this.mode.isEdit||this._isDisabled||e.isReadOnly||e.isFormsOnly||e.isCommentsOnly||(e=this.getApplication().getController("Common.Controllers.ExternalDiagramEditor").getView("Common.Views.ExternalDiagramEditor"))&&t&&(e.setEditMode(!0),e.show(),e.setChartData(new Asc.asc_CChartBinary(t)))},onDoubleClickOnTableOleObject:function(t){var e=this.documentHolder._docProtection;!this.mode.isEdit||this._isDisabled||e.isReadOnly||e.isFormsOnly||e.isCommentsOnly||(e=this.getApplication().getController("Common.Controllers.ExternalOleEditor").getView("Common.Views.ExternalOleEditor"))&&t&&(e.setEditMode(!0),e.show(),e.setOleData(Asc.asc_putBinaryDataToFrameFromTableOleObject(t)))},onImgWrapStyleChanged:function(t){var e=this.documentHolder.menuImageWrap;switch(t){case Asc.c_oAscWrapStyle2.Inline:e.menu.items[0].setChecked(!0);break;case Asc.c_oAscWrapStyle2.Square:e.menu.items[2].setChecked(!0);break;case Asc.c_oAscWrapStyle2.Tight:e.menu.items[3].setChecked(!0);break;case Asc.c_oAscWrapStyle2.Through:e.menu.items[4].setChecked(!0);break;case Asc.c_oAscWrapStyle2.TopAndBottom:e.menu.items[5].setChecked(!0);break;case Asc.c_oAscWrapStyle2.Behind:e.menu.items[8].setChecked(!0);break;case Asc.c_oAscWrapStyle2.InFront:e.menu.items[7].setChecked(!0)}},onChangeCropState:function(t){this.documentHolder.menuImgCrop&&this.documentHolder.menuImgCrop.menu.items[0].setChecked(t,!0)},onRulerDblClick:function(t){Common.UI.Menu.Manager.hideAll();var e,i=this;"tables"==t?(e=this.advancedTableClick())&&e.setActiveCategory(4):"indents"==t||"tabs"==t?(e=this.advancedParagraphClick({isChart:!1}))&&e.setActiveCategory("indents"==t?0:4):"margins"==t?i._state.lock_doc||((e=new DE.Views.PageMarginsDialog({api:i.api,handler:function(t,e){"ok"==e&&(e=t.getSettings(),Common.localStorage.setItem("de-pgmargins-top",e.get_TopMargin()),Common.localStorage.setItem("de-pgmargins-left",e.get_LeftMargin()),Common.localStorage.setItem("de-pgmargins-bottom",e.get_BottomMargin()),Common.localStorage.setItem("de-pgmargins-right",e.get_RightMargin()),Common.NotificationCenter.trigger("margins:update",e),i.api.asc_SetSectionProps(e),i.editComplete())}})).show(),e.setSettings(i.api.asc_GetSectionProps())):"columns"==t&&((e=new DE.Views.CustomColumnsDialog({handler:function(t,e){"ok"==e&&(i.api.asc_SetColumnsProps(t.getSettings()),i.editComplete())}})).show(),e.setSettings(i.api.asc_GetColumnsProps()))},onApiParagraphStyleChange:function(t){window.currentStyleName=t},onHideContentControlsActions:function(){this.listControlMenu&&this.listControlMenu.isVisible()&&this.listControlMenu.hide();var t=this.documentHolder.cmpEl.find("#calendar-control-container");t.is(":visible")&&t.hide()},onShowDateActions:function(t,e,i){var t=t.pr,n=t.get_DateTimePr(),o=this.documentHolder.cmpEl,s=o.find("#calendar-control-container"),a=this,t=(this._dateObj=t,s.length<1&&(s=$('<div id="calendar-control-container" style="position: absolute;z-index: 1000;"><div id="id-document-calendar-control" style="position: fixed; left: -1000px; top: -1000px;"></div></div>'),o.append(s)),Common.UI.Menu.Manager.hideAll(),s.css({left:e,top:i}),s.show(),this.cmpCalendar||(this.cmpCalendar=new Common.UI.Calendar({el:o.find("#id-document-calendar-control"),enableKeyEvents:!0,firstday:1}),this.cmpCalendar.on("date:click",function(t,e){var i=a._dateObj.get_DateTimePr();i.put_FullDate(new Date(e)),a.api.asc_SetContentControlDatePickerDate(i),s.hide(),a.api.asc_UncheckContentControlButtons(),a.editComplete()}),this.cmpCalendar.on("calendar:keydown",function(t,e){e.keyCode==Common.UI.Keys.ESC&&(s.hide(),a.api.asc_UncheckContentControlButtons())}),$(document).on("mousedown",function(t){"canvas"!==t.target.localName&&s.is(":visible")&&0==s.find(t.target).length&&(s.hide(),a.api.asc_UncheckContentControlButtons())})),n?n.get_FullDate():void 0),e=(this.cmpCalendar.setDate(t?new Date(t):new Date),s.offset()),i=Common.Utils.innerWidth(),o=Common.Utils.innerHeight()-10,n=this.cmpCalendar.cmpEl.outerWidth(),t=this.cmpCalendar.cmpEl.outerHeight(),l=e.left-n,e=e.top;o<e+t&&(e=o-t,l-=22),this.cmpCalendar.cmpEl.css({left:l=i<l+n?i-n:l,top:e=e<0?0:e}),this._preventClick=!0},onShowListActions:function(t,e,i){var n=t.type,t=t.pr,o=n==Asc.c_oAscContentControlSpecificType.ComboBox?t.get_ComboBoxPr():t.get_DropDownListPr(),s=!!t.get_FormPr(),n=this.documentHolder.cmpEl,a=this.listControlMenu,l=a?n.find(Common.Utils.String.format("#menu-container-{0}",a.id)):null,r=this;if(this._listObj=t,this._fromShowContentControls=!0,Common.UI.Menu.Manager.hideAll(),a||(this.listControlMenu=a=new Common.UI.Menu({maxHeight:207,menuAlign:"tr-bl",items:[]}),a.on("item:click",function(t,e){setTimeout(function(){-1!==e.value&&r.api.asc_SelectContentControlListItem(e.value,r._listObj.get_InternalId())},1)}),(!l||l.length<1)&&(l=$(Common.Utils.String.format('<div id="menu-container-{0}" style="position: absolute; z-index: 10000;"><div class="dropdown-toggle" data-toggle="dropdown"></div></div>',a.id)),n.append(l)),a.render(l),a.cmpEl.attr({tabindex:"-1"}),a.on("hide:after",function(){r.listControlMenu.removeAll(),r._fromShowContentControls||r.api.asc_UncheckContentControlButtons()})),o){s&&(n=t.get_PlaceholderText(),a.addItem(new Common.UI.MenuItem({caption:""!==n.trim()?n:this.documentHolder.txtEmpty,value:"",template:_.template(['<a id="<%= id %>" tabindex="-1" type="menuitem" style="<% if (options.value=="") { %> opacity: 0.6 <% } %>">',"<%= caption %>","</a>"].join(""))})));for(var c=o.get_ItemsCount(),d=0;d<c;d++)""===o.get_ItemValue(d)&&s||a.addItem(new Common.UI.MenuItem({caption:o.get_ItemDisplayText(d),value:o.get_ItemValue(d),template:_.template(['<a id="<%= id %>" style="<%= style %>" tabindex="-1" type="menuitem">',"<%= Common.Utils.String.htmlEncode(caption) %>","</a>"].join(""))}));!s&&a.items.length<1&&a.addItem(new Common.UI.MenuItem({caption:this.documentHolder.txtEmpty,value:-1}))}l.css({left:e,top:i}),l.attr("data-value","prevent-canvas-click"),this._preventClick=!0,a.show(),_.delay(function(){a.cmpEl.focus()},10),this._fromShowContentControls=!1},onShowContentControlsActions:function(t,e,i){switch(t.type){case Asc.c_oAscContentControlSpecificType.DateTime:this.onShowDateActions(t,e,i);break;case Asc.c_oAscContentControlSpecificType.Picture:if(t.pr&&t.pr.get_Lock){var n=t.pr.get_Lock();if(n==Asc.c_oAscSdtLockType.SdtContentLocked||n==Asc.c_oAscSdtLockType.ContentLocked)return}this.api.asc_addImage(t);var o=this;setTimeout(function(){o.api.asc_UncheckContentControlButtons()},500);break;case Asc.c_oAscContentControlSpecificType.DropDownList:case Asc.c_oAscContentControlSpecificType.ComboBox:this.onShowListActions(t,e,i)}},onApiLockDocumentProps:function(){this._state.lock_doc=!0},onApiUnLockDocumentProps:function(){this._state.lock_doc=!1},onCoAuthoringDisconnect:function(){this.mode.isEdit=!1},SetDisabled:function(t,e,i){this._isDisabled=t,this.documentHolder.SetDisabled(t,e,i),this.disableEquationBar(),this.disableSpecialPaste()},clearSelection:function(){this.onHideMathTrack(),this.onHideSpecialPasteOptions()},onTextLanguage:function(t){this.documentHolder._currLang.id=t},onSpellCheckVariantsFound:function(){var t,e=this.api.getSelectedElements(!0);if(e&&_.isArray(e))for(var i=0;i<e.length;i++)if(e[i].get_ObjectType()==Asc.c_oAscTypeSelectElement.SpellCheck){t=e[i].get_ObjectValue(),this.documentHolder._currentSpellObj=t;break}t&&!1===t.get_Checked()&&null!==t.get_Variants()&&void 0!==t.get_Variants()&&(this.documentHolder.addWordVariants(),this.documentHolder.textMenu&&this.documentHolder.textMenu.isVisible()&&this.documentHolder.textMenu.alignPosition())},equationCallback:function(t){if(t){var e;switch(t.type){case Asc.c_oAscMathInterfaceType.Accent:e=new CMathMenuAccent;break;case Asc.c_oAscMathInterfaceType.BorderBox:e=new CMathMenuBorderBox;break;case Asc.c_oAscMathInterfaceType.Box:e=new CMathMenuBox;break;case Asc.c_oAscMathInterfaceType.Bar:e=new CMathMenuBar;break;case Asc.c_oAscMathInterfaceType.Script:e=new CMathMenuScript;break;case Asc.c_oAscMathInterfaceType.Fraction:e=new CMathMenuFraction;break;case Asc.c_oAscMathInterfaceType.Limit:e=new CMathMenuLimit;break;case Asc.c_oAscMathInterfaceType.Matrix:e=new CMathMenuMatrix;break;case Asc.c_oAscMathInterfaceType.EqArray:e=new CMathMenuEqArray;break;case Asc.c_oAscMathInterfaceType.LargeOperator:e=new CMathMenuNary;break;case Asc.c_oAscMathInterfaceType.Delimiter:e=new CMathMenuDelimiter;break;case Asc.c_oAscMathInterfaceType.GroupChar:e=new CMathMenuGroupCharacter;break;case Asc.c_oAscMathInterfaceType.Radical:e=new CMathMenuRadical;break;case Asc.c_oAscMathInterfaceType.Common:e=new CMathMenuBase}e&&(e[t.callback](t.value),this.api.asc_SetMathProps(e))}this.editComplete()},changePosition:function(){var t=this.documentHolder.cmpEl;this._XY=[t.offset().left-$(window).scrollLeft(),t.offset().top-$(window).scrollTop()],this._Height=t.height(),this._Width=t.width(),this._BodyWidth=$("body").width(),this.onMouseMoveStart()},addHyperlink:function(t,e,i){var n,o=this;o.api&&((n=new DE.Views.HyperlinkSettingsDialog({api:o.api,handler:function(t,e){"ok"==e&&o.api.add_Hyperlink(t.getSettings()),o.editComplete()}})).show(),n.setSettings(t.hyperProps.value),Common.component.Analytics.trackEvent("DocumentHolder","Add Hyperlink"))},editHyperlink:function(t,e,i){var n,o=this;o.api&&((n=new DE.Views.HyperlinkSettingsDialog({api:o.api,handler:function(t,e){"ok"==e&&o.api.change_Hyperlink(n.getSettings()),o.editComplete()}})).show(),n.setSettings(t.hyperProps.value))},onRemoveHyperlink:function(t,e){this.api&&this.api.remove_Hyperlink(t.hyperProps.value),this.editComplete()},editChartClick:function(){var t,e=DE.getController("Common.Controllers.ExternalDiagramEditor").getView("Common.Views.ExternalDiagramEditor");e&&(e.setEditMode(!0),e.show(),(t=this.api.asc_getChartObject())&&e.setChartData(new Asc.asc_CChartBinary(t)))},advancedParagraphClick:function(t,e,i){var n,o=this;if(o.api){var s=o.api.getSelectedElements();if(s&&_.isArray(s))for(var a=s.length-1;0<=a;a--){var l=s[a].get_ObjectType(),r=s[a].get_ObjectValue();if(Asc.c_oAscTypeSelectElement.Paragraph==l){n=new DE.Views.ParagraphSettingsAdvanced({tableStylerRows:2,tableStylerColumns:1,paragraphProps:r,borderProps:o.borderAdvancedProps,isChart:!0===t.isChart,isSmartArtInternal:!0===t.isSmartArtInternal,api:o.api,handler:function(t,e){"ok"==t&&o.api&&(o.borderAdvancedProps=e.borderProps,o.api.paraApply(e.paragraphProps)),o.editComplete()}});break}}}if(n)return n.show(),n},advancedFrameClick:function(t,e,i,n){Common.NotificationCenter.trigger("dropcap:settings",t)},advancedTableClick:function(t,e,i){var n,o=this;if(o.api){var s=o.api.getSelectedElements();if(s&&_.isArray(s))for(var a=s.length-1;0<=a;a--){var l=s[a].get_ObjectType(),r=s[a].get_ObjectValue();if(Asc.c_oAscTypeSelectElement.Table==l){n=new DE.Views.TableSettingsAdvanced({tableStylerRows:null===r.get_CellBorders().get_InsideH()&&1==r.get_CellSelect()?1:2,tableStylerColumns:null===r.get_CellBorders().get_InsideV()&&1==r.get_CellSelect()?1:2,tableProps:r,borderProps:o.borderAdvancedProps,sectionProps:o.api.asc_GetSectionProps(),handler:function(t,e){"ok"==t&&o.api&&(o.borderAdvancedProps=e.borderProps,o.api.tblApply(e.tableProps)),o.editComplete()}});break}}}if(n)return n.show(),n},onMenuSaveStyle:function(t,e,i){this.api&&Common.NotificationCenter.trigger("style:commitsave",this.api.asc_GetStyleFromFormatting())},onMenuUpdateStyle:function(t,e,i){this.api&&Common.NotificationCenter.trigger("style:commitchange",this.api.asc_GetStyleFromFormatting())},addComment:function(t,e,i){var n;this.api&&this.mode.canCoAuthoring&&this.mode.canComments&&(this.documentHolder.suppressEditComplete=!0,(n=DE.getController("Common.Controllers.Comments"))&&n.addDummyComment())},onCutCopyPaste:function(t,e){var i=this;!i.api||("cut"==t.value?i.api.Cut():"copy"==t.value?i.api.Copy():i.api.Paste())||Common.localStorage.getBool("de-hide-copywarning")||new Common.Views.CopyWarningDialog({handler:function(t){t&&Common.localStorage.setItem("de-hide-copywarning",1),i.editComplete()}}).show(),i.editComplete()},onUndo:function(){this.api.Undo()},onAcceptRejectChange:function(t,e){this.api&&("accept"==t.value?this.api.asc_AcceptChangesBySelection(!1):"reject"==t.value&&this.api.asc_RejectChangesBySelection(!1)),this.editComplete()},onPrintSelection:function(t){var e,i;this.api&&((e=new Asc.asc_CAdjustPrint).asc_setPrintType(Asc.c_oAscPrintType.Selection),(i=new Asc.asc_CDownloadOptions(null,Common.Utils.isChrome||Common.Utils.isOpera||Common.Utils.isGecko&&86<Common.Utils.firefoxVersion)).asc_setAdvancedOptions(e),this.api.asc_Print(i),this.editComplete(),Common.component.Analytics.trackEvent("DocumentHolder","Print Selection"))},onControlsSelect:function(t,e){var i=this,n=this.api.asc_GetContentControlProperties();n&&("settings"==t.value?new DE.Views.ControlSettingsDialog({props:n,api:i.api,handler:function(t,e){"ok"==t&&i.api.asc_SetContentControlProperties(e,n.get_InternalId()),i.editComplete()}}).show():"remove"==t.value&&(n.get_FormPr()?this.api.asc_RemoveContentControl(n.get_InternalId()):this.api.asc_RemoveContentControlWrapper(n.get_InternalId()))),i.editComplete()},onInsertCaption:function(){this.documentHolder.fireEvent("links:caption")},onContinueNumbering:function(t,e){this.api.asc_ContinueNumbering(),this.editComplete()},onStartNumbering:function(t,e,i){var n;1==t?this.api.asc_RestartNumbering(e.value.start):(n=this,new DE.Views.NumberingValueDialog({title:n.documentHolder.textNumberingValue,props:e.value,handler:function(t,e){"ok"==t&&n.api.asc_RestartNumbering(e),n.editComplete()}}).show()),this.editComplete()},onCellsRemove:function(){var i=this;new Common.Views.OptionsDialog({title:i.documentHolder.textTitleCellsRemove,items:[{caption:this.documentHolder.textLeft,value:"left"},{caption:this.documentHolder.textRow,value:"row"},{caption:this.documentHolder.textCol,value:"col"}],handler:function(t,e){"ok"==e&&("row"==(e=t.getSettings())?i.api.remRow():"col"==e?i.api.remColumn():i.api.asc_RemoveTableCells()),i.editComplete()}}).show(),this.editComplete()},onCellsAdd:function(){var i=this;new DE.Views.CellsAddDialog({handler:function(t,e){"ok"==t&&(e.row?e.before?i.api.addRowAbove(e.count):i.api.addRowBelow(e.count):e.before?i.api.addColumnLeft(e.count):i.api.addColumnRight(e.count)),i.editComplete()}}).show(),this.editComplete()},onSignatureClick:function(t){var e=t.cmpEl.attr("data-value");switch(t.value){case 0:Common.NotificationCenter.trigger("protect:sign",e);break;case 1:this.api.asc_ViewCertificate(e);break;case 2:var i=this.documentHolder._docProtection;Common.NotificationCenter.trigger("protect:signature","visible",this._isDisabled||i.isReadOnly||i.isFormsOnly||i.isCommentsOnly,e);break;case 3:var n=this;Common.UI.warning({title:this.documentHolder.notcriticalErrorTitle,msg:this.documentHolder.txtRemoveWarning,buttons:["ok","cancel"],primary:"ok",callback:function(t){"ok"==t&&n.api.asc_RemoveSignature(e)}})}},onImgRotate:function(t){var e=new Asc.asc_CImgProperty;e.asc_putRotAdd(3.14159265358979*(1==t.value?90:270)/180),this.api.ImgApply(e),this.editComplete()},onImgFlip:function(t){var e=new Asc.asc_CImgProperty;1==t.value?e.asc_putFlipHInvert(!0):e.asc_putFlipVInvert(!0),this.api.ImgApply(e),this.editComplete()},onImgCrop:function(t,e){1==e.value?this.api.asc_cropFill():2==e.value?this.api.asc_cropFit():e.checked?this.api.asc_startEditCrop():this.api.asc_endEditCrop(),this.editComplete()},onFollowMove:function(t){this.api&&this.api.asc_FollowRevisionMove(t.value),this.editComplete()},tableCellsVAlign:function(t,e,i){var n;this.api&&((n=new Asc.CTableProp).put_CellsVAlign(e.options.valign),this.api.tblApply(n))},tableSelectText:function(t,e,i){if(this.api)switch(e.value){case 0:this.api.selectRow();break;case 1:this.api.selectColumn();break;case 2:this.api.selectCell();break;case 3:this.api.selectTable()}},tableInsertText:function(t,e,i){if(this.api)switch(e.value){case 0:this.api.addColumnLeft();break;case 1:this.api.addColumnRight();break;case 2:this.api.addRowAbove();break;case 3:this.api.addRowBelow();break;case 4:this.onCellsAdd()}},tableDeleteText:function(t,e,i){if(this.api)switch(e.value){case 0:this.api.remRow();break;case 1:this.api.remColumn();break;case 2:this.api.remTable();break;case 3:this.onCellsRemove()}},onImgAlign:function(t,e,i){var n;this.api&&(n=1==(n=Common.Utils.InternalSettings.get("de-img-align-to"))?Asc.c_oAscObjectsAlignType.Page:this.api.asc_getSelectedDrawingObjectsCount()<2&&!n||2==n?Asc.c_oAscObjectsAlignType.Margin:Asc.c_oAscObjectsAlignType.Selected,e.value<6?(this.api.put_ShapesAlign(e.value,n),Common.component.Analytics.trackEvent("DocumentHolder","Shape Align")):6==e.value?(this.api.DistributeHorizontally(n),Common.component.Analytics.trackEvent("DocumentHolder","Distribute Horizontally")):7==e.value&&(this.api.DistributeVertically(n),Common.component.Analytics.trackEvent("DocumentHolder","Distribute Vertically"))),this.editComplete()},onImgArrange:function(t,e,i){var n;this.api&&void 0!==e.options.valign&&((n=new Asc.asc_CImgProperty).put_ChangeLevel(e.options.valign),this.api.ImgApply(n)),this.editComplete()},onImgGroup:function(t){var e;this.api&&((e=new Asc.asc_CImgProperty).put_Group(1),this.api.ImgApply(e)),this.editComplete()},onImgUnGroup:function(t){var e;this.api&&((e=new Asc.asc_CImgProperty).put_Group(-1),this.api.ImgApply(e)),this.editComplete()},onImgWrapPolygon:function(t){this.api&&this.api.StartChangeWrapPolygon(),this.editComplete()},onImgWrap:function(t,e,i){var n;this.api&&void 0!==e.options.wrapType&&((n=new Asc.asc_CImgProperty).put_WrappingStyle(e.options.wrapType),this.documentHolder.menuImageWrap._originalProps.get_WrappingStyle()===Asc.c_oAscWrapStyle2.Inline&&e.wrapType!==Asc.c_oAscWrapStyle2.Inline&&(n.put_PositionH(new Asc.CImagePositionH),n.get_PositionH().put_UseAlign(!1),n.get_PositionH().put_RelativeFrom(Asc.c_oAscRelativeFromH.Column),e=this.documentHolder.menuImageWrap._originalProps.get_Value_X(Asc.c_oAscRelativeFromH.Column),n.get_PositionH().put_Value(e),n.put_PositionV(new Asc.CImagePositionV),n.get_PositionV().put_UseAlign(!1),n.get_PositionV().put_RelativeFrom(Asc.c_oAscRelativeFromV.Paragraph),e=this.documentHolder.menuImageWrap._originalProps.get_Value_Y(Asc.c_oAscRelativeFromV.Paragraph),n.get_PositionV().put_Value(e)),this.api.ImgApply(n)),this.editComplete()},onImgAdvanced:function(t,e){var i,n=this;if(n.api){var o=n.api.getSelectedElements();if(o&&_.isArray(o))for(var s=o.length-1;0<=s;s--)if(l=o[s].get_ObjectType(),i=o[s].get_ObjectValue(),Asc.c_oAscTypeSelectElement.Image==l){i.get_ChartProperties()||i.get_ShapeProperties()||n.documentHolder.menuOriginalSize.isDisabled()||!n.documentHolder.menuOriginalSize.isVisible()||(a=(a=n.api.get_OriginalSizeImage())&&{width:a.get_ImageWidth(),height:a.get_ImageHeight()});var a,l=new DE.Views.ImageSettingsAdvanced({imageProps:i,sizeOriginal:a,api:n.api,sectionProps:n.api.asc_GetSectionProps(),handler:function(t,e){"ok"==t&&n.api&&n.api.ImgApply(e.imageProps),n.editComplete()}});l.show(),l.btnOriginalSize.setVisible(n.documentHolder.menuOriginalSize.isVisible());break}}},onImgOriginalSize:function(t,e){var i,n;this.api&&(i=this.api.get_OriginalSizeImage(),(n=new Asc.asc_CImgProperty).put_Width(i.get_ImageWidth()),n.put_Height(i.get_ImageHeight()),n.put_ResetCrop(!0),n.put_Rot(0),this.api.ImgApply(n),this.editComplete())},onImgReplace:function(t,e,i){var n=this;1==e.value?new Common.Views.ImageFromUrlDialog({handler:function(t,e){"ok"==t&&n.api&&(t=e.replace(/ /g,""),_.isEmpty(t)||((e=new Asc.asc_CImgProperty).put_ImageUrl(t),n.api.ImgApply(e))),n.editComplete()}}).show():2==e.value?Common.NotificationCenter.trigger("storage:image-load","change"):setTimeout(function(){n.api&&n.api.ChangeImageFromFile(),n.editComplete()},10)},onImgEditPoints:function(t){this.api&&this.api.asc_editPointsGeometry()},onTableMerge:function(t){this.api&&this.api.MergeCells()},onTableSplit:function(t){var i=this;i.api&&new Common.Views.InsertTableDialog({split:!0,handler:function(t,e){"ok"==t&&(i.api&&i.api.SplitCell(e.columns,e.rows),Common.component.Analytics.trackEvent("DocumentHolder","Table")),i.editComplete()}}).show()},onIgnoreSpell:function(t,e){this.api&&this.api.asc_ignoreMisspelledWord(this.documentHolder._currentSpellObj,!!t.value),this.editComplete()},onToDictionary:function(t,e){this.api&&this.api.asc_spellCheckAddToDictionary(this.documentHolder._currentSpellObj),this.editComplete()},onTableDist:function(t,e){this.api&&this.api.asc_DistributeTableCells(!!t.value),this.editComplete()},tableDirection:function(t,e,i){var n;this.api&&((n=new Asc.CTableProp).put_CellsTextDirection(e.options.direction),this.api.tblApply(n))},onRefreshField:function(t,e){this.api&&this.api.asc_UpdateFields(!0),this.editComplete()},onParagraphBreakBefore:function(t,e){this.api&&this.api.put_PageBreak(t.checked)},onParagraphKeepLines:function(t,e){this.api&&this.api.put_KeepLines(t.checked)},paragraphVAlign:function(t,e,i){var n;this.api&&((n=new Asc.asc_CImgProperty).put_VerticalTextAlign(e.options.valign),this.api.ImgApply(n))},paragraphDirection:function(t,e,i){var n;this.api&&((n=new Asc.asc_CImgProperty).put_Vert(e.options.direction),this.api.ImgApply(n))},onLangMenu:function(t,e,i){this.api&&(_.isUndefined(i.langid)||this.api.put_TextPrLang(i.langid),"para"===t?this.documentHolder._currLang.paraid=i.langid:this.documentHolder._currLang.tableid=i.langid,this.editComplete())},onTOCMenu:function(t,e,i){this.documentHolder.fireEvent("settings"===e.value?"links:contents":"links:update",[e.value,!0])},onParaTOCSettings:function(t,e){this.documentHolder.fireEvent("links:contents",[t.value,!0])},onSpecialPasteItemClick:function(t,e){if(this.api){this.api.asc_SpecialPaste(t.value);var i=this.btnSpecialPaste.menu;if(!t.cmpEl)for(var n=0;n<i.items.length;n++)i.items[n].setChecked(i.items[n].value===t.value,!0);setTimeout(function(){i.hide()},100)}return!1},onShowMathTrack:function(t){if(!this.mode||this.mode.isEdit)if((this.lastMathTrackBounds=t)[3]<0||Common.Utils.InternalSettings.get("de-equation-toolbar-hide"))this.onHideMathTrack();else{var o=this,e=o.documentHolder,i=e.cmpEl.find("#equation-container");if(i.length<1){var n=o.getApplication().getCollection("EquationGroups"),s='<div id="equation-container" style="position: absolute;">';o.getApplication().getController("Toolbar").onMathTypes(),o.equationBtns=[];for(var a=0;a<n.length;++a)s+='<span id="id-document-holder-btn-equation-'+a+'"></span>';s=(s+='<div class="separator"></div>')+'<span id="id-document-holder-btn-equation-settings"></span>'+"</div>",i=$(s),e.cmpEl.find("#id_main_view").append(i);for(var l=function(t){var e=t.options.value,i=n.at(e);new Common.UI.DataViewSimple({el:$("#id-document-holder-btn-equation-menu-"+e,t.cmpEl),parentMenu:t,store:i.get("groupStore"),scrollAlwaysVisible:!0,showLast:!1,restoreHeight:450,itemTemplate:_.template('<div class="item-equation" style="" ><div class="equation-icon" style="background-position:<%= posX %>px <%= posY %>px;width:<%= width %>px;height:<%= height %>px;" id="<%= id %>"></div></div>')}).on("item:click",function(t,e,i,n){o.api&&i&&o.api.asc_AddMath(i.get("data").equationType)}),t.off("show:before",l)},r=function(t){i.addClass("has-open-menu")},c=function(t){i.removeClass("has-open-menu")},a=0;a<n.length;++a){var d=n.at(a),d=new Common.UI.Button({parentEl:$("#id-document-holder-btn-equation-"+a,e.cmpEl),cls:"btn-toolbar no-caret",iconCls:"svgicon "+d.get("groupIcon"),hint:d.get("groupName"),menu:new Common.UI.Menu({cls:"menu-shapes",value:a,items:[{template:_.template('<div id="id-document-holder-btn-equation-menu-'+a+'" class="menu-shape margin-left-5" style="width:'+(d.get("groupWidth")+8)+"px; "+d.get("groupHeightStr")+'"></div>')}]})});d.menu.on("show:before",l),d.menu.on("show:before",r),d.menu.on("hide:after",c),o.equationBtns.push(d)}o.equationSettingsBtn=new Common.UI.Button({parentEl:$("#id-document-holder-btn-equation-settings",e.cmpEl),cls:"btn-toolbar no-caret",iconCls:"toolbar__icon btn-more-vertical",hint:o.documentHolder.advancedEquationText,menu:o.documentHolder.createEquationMenu("popuptbeqinput","tl-bl")}),o.equationSettingsBtn.menu.options.initMenu=function(){var t=o.api.asc_GetMathInputType(),e=o.equationSettingsBtn.menu,i=o.api.asc_IsInlineMath(),n=Common.Utils.InternalSettings.get("de-equation-toolbar-hide");e.items[5].setChecked(t===Asc.c_oAscMathInputType.Unicode),e.items[6].setChecked(t===Asc.c_oAscMathInputType.LaTeX),e.items[8].options.isEquationInline=i,e.items[8].setCaption(i?o.documentHolder.eqToDisplayText:o.documentHolder.eqToInlineText,!0),e.items[9].options.isToolbarHide=n,e.items[9].setCaption(n?o.documentHolder.showEqToolbar:o.documentHolder.hideEqToolbar,!0)},o.equationSettingsBtn.menu.on("item:click",_.bind(o.convertEquation,o)),o.equationSettingsBtn.menu.on("show:before",function(t){r(),t.options.initMenu()}),o.equationSettingsBtn.menu.on("hide:after",c)}var h=[(t[0]+t[2])/2-i.outerWidth()/2,t[1]-i.outerHeight()-10],t=((h=Common.Utils.InternalSettings.get("de-hidden-rulers")?h:[h[0]-19,h[1]-26])[0]<0&&(h[0]=0),h[1]<0&&(h[1]=t[3]+10,Common.Utils.InternalSettings.get("de-hidden-rulers")||(h[1]-=26)),h[1]=Math.min(o._Height-i.outerHeight(),Math.max(0,h[1])),i.css({left:h[0],top:h[1]}),void 0===o._XY&&(o._XY=[e.cmpEl.offset().left-$(window).scrollLeft(),e.cmpEl.offset().top-$(window).scrollTop()],o._Height=e.cmpEl.height(),o._Width=e.cmpEl.width(),o._BodyWidth=$("body").width()),o._Height-h[1]-i.outerHeight()),h=o._XY[1]+(Common.Utils.InternalSettings.get("de-hidden-rulers")?0:26)+h[1],m=t<220&&t<.9*h?"bl-tl":"tl-bl";Common.UI.isRTL()&&(m="bl-tl"===m?"br-tr":"tr-br"),o.equationBtns.forEach(function(t){t&&(t.menu.menuAlign=m)}),o.equationSettingsBtn.menu.menuAlign=m,i.is(":visible")?o.equationSettingsBtn.menu.isVisible()&&(o.equationSettingsBtn.menu.options.initMenu(),o.equationSettingsBtn.menu.alignPosition()):i.show(),o.disableEquationBar()}},onHideMathTrack:function(){var t;this.documentHolder&&this.documentHolder.cmpEl&&((t=this.documentHolder.cmpEl.find("#equation-container")).is(":visible")&&t.hide())},disableEquationBar:function(){var t=this.documentHolder.cmpEl.find("#equation-container"),e=this.documentHolder._docProtection,i=this._isDisabled||this._state.equationLocked||e.isReadOnly||e.isFormsOnly||e.isCommentsOnly;0<t.length&&t.is(":visible")&&(this.equationBtns.forEach(function(t){t&&t.setDisabled(!!i)}),this.equationSettingsBtn.setDisabled(!!i))},convertEquation:function(t,e,i){this.api&&("input"==e.options.type?(this.api.asc_SetMathInputType(e.value),Common.localStorage.setBool("de-equation-input-latex",e.value===Asc.c_oAscMathInputType.LaTeX)):"view"==e.options.type?this.api.asc_ConvertMathView(e.value.linear,e.value.all):"mode"==e.options.type?(e.options.isEquationInline=!e.options.isEquationInline,this.api.asc_ConvertMathDisplayMode(e.options.isEquationInline)):"hide"==e.options.type&&(e.options.isToolbarHide=!e.options.isToolbarHide,Common.Utils.InternalSettings.set("de-equation-toolbar-hide",e.options.isToolbarHide),Common.localStorage.setBool("de-equation-toolbar-hide",e.options.isToolbarHide),e.options.isToolbarHide?this.onHideMathTrack():this.onShowMathTrack(this.lastMathTrackBounds)))},onListIndents:function(i,t){var n;this.api&&!this.api.asc_IsShowListIndentsSettings()?this.documentHolder.fireEvent("list:settings",[2]):(n=this).api&&new DE.Views.ListIndentsDialog({api:n.api,props:i.value.props,isBullet:i.value.format===Asc.c_oAscNumberingFormat.Bullet,handler:function(t,e){"ok"==t&&n.api&&n.api.asc_ChangeNumberingLvl(i.value.listId,e,i.value.level),n.editComplete()}}).show()},saveAsPicture:function(){this.api&&this.api.asc_SaveDrawingAsPicture()},onChangeProtectDocument:function(t){var e;(t=t?t:(e=this.getApplication().getController("DocProtection"))?e.getDocProps():null)&&this.documentHolder&&(this.documentHolder._docProtection=t,this.disableEquationBar(),this.disableSpecialPaste())},onInsertImage:function(t,e,i){!this.documentHolder||this.documentHolder._docProtection.isReadOnly||this.documentHolder._docProtection.isFormsOnly||this.documentHolder._docProtection.isCommentsOnly||(this.api&&this.api.asc_addImage(t),this.editComplete())},onInsertImageUrl:function(i,t,e){var n;!this.documentHolder||this.documentHolder._docProtection.isReadOnly||this.documentHolder._docProtection.isFormsOnly||this.documentHolder._docProtection.isCommentsOnly||(n=this,new Common.Views.ImageFromUrlDialog({handler:function(t,e){"ok"==t&&n.api&&(t=e.replace(/ /g,""),_.isEmpty(t)||n.api.AddImageUrl([t],void 0,void 0,i)),n.editComplete()}}).show())},onPluginContextMenu:function(t){t&&0<t.length&&this.documentHolder&&this.documentHolder.currentMenu&&this.documentHolder.currentMenu.isVisible()&&this.documentHolder.updateCustomItems(this.documentHolder.currentMenu,t)},editComplete:function(){this.documentHolder&&this.documentHolder.fireEvent("editcomplete",this.documentHolder)}})}),define("common/main/lib/view/ImageFromUrlDialog",["common/main/lib/component/Window"],function(){"use strict";Common.Views.ImageFromUrlDialog=Common.UI.Window.extend(_.extend({options:{width:330,header:!1,cls:"modal-dlg",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,t||{}),this.template=['<div class="box">','<div class="input-row">',"<label>"+(this.options.title||this.textUrl)+"</label>","</div>",'<div id="id-dlg-url" class="input-row"></div>',"</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var e=this;e.inputUrl=new Common.UI.InputField({el:$("#id-dlg-url"),allowBlank:!1,blankError:e.txtEmpty,style:"width: 100%;",validateOnBlur:!1,validation:function(t){return!!/((^https?)|(^ftp)):\/\/.+/i.test(t)||e.txtNotUrl}}),this.getChild().find(".dlg-btn").on("click",_.bind(this.onBtnClick,this))},show:function(){Common.UI.Window.prototype.show.apply(this,arguments);var t=this;_.delay(function(){t.getChild("input").focus()},100)},onPrimary:function(t){return this._handleInput("ok"),!1},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},_handleInput:function(t){if(this.options.handler){if("ok"==t&&!0!==this.inputUrl.checkValidate())return void this.inputUrl.cmpEl.find("input").focus();this.options.handler.call(this,t,this.inputUrl.getValue())}this.close()}},Common.Views.ImageFromUrlDialog||{}))}),void 0===Common&&(Common={}),define("common/main/lib/component/LoadMask",["common/main/lib/component/BaseView"],function(){"use strict";Common.UI.LoadMask=Common.UI.BaseView.extend({options:{cls:"",style:"",title:"Loading...",owner:document.body},template:_.template(['<div id="<%= id %>" class="asc-loadmask-body <%= cls %>" role="presentation" tabindex="-1">','<i id="loadmask-spinner" class="asc-loadmask-image"></i>','<div class="asc-loadmask-title"><%= title %></div>',"</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t),this.template=this.options.template||this.template,this.title=this.options.title,this.ownerEl=this.options.owner instanceof Common.UI.BaseView?$(this.options.owner.el):$(this.options.owner),this.loaderEl=$(this.template({id:this.id,cls:this.options.cls,style:this.options.style,title:this.title})),this.maskeEl=$('<div class="asc-loadmask"></div>'),this.timerId=0},render:function(){return this},internalShowLoader:function(){this.ownerEl.append(this.loaderEl),this.loaderEl.css("min-width",$(".asc-loadmask-title",this.loaderEl).width()+105),this.ownerEl&&0==this.ownerEl.closest(".asc-window.modal").length&&Common.util.Shortcuts.suspendEvents()},internalShowMask:function(){this.ownerEl.ismasked||(this.ownerEl.ismasked=!0,this.ownerEl.append(this.maskeEl))},show:function(t){var e;return this.internalShowMask(),this.ownerEl.hasloader||(this.ownerEl.hasloader=!0,(e=this).title!=e.options.title&&(e.options.title=e.title,$(".asc-loadmask-title",this.loaderEl).html(e.title)),t?e.internalShowLoader():e.timerId||(e.timerId=setTimeout(function(){e.internalShowLoader()},20))),this},hide:function(){var t=this.ownerEl;this.timerId&&(clearTimeout(this.timerId),this.timerId=0),t&&t.ismasked&&this.maskeEl&&this.maskeEl.remove(),delete t.ismasked,t&&t.hasloader&&(0!=t.closest(".asc-window.modal").length||Common.Utils.ModalWindow.isVisible()||Common.util.Shortcuts.resumeEvents(),this.loaderEl&&this.loaderEl.remove(),this.loaderEl&&this.loaderEl.find(".download-doc").remove()),delete t.hasloader},setTitle:function(t){var e;this.title=t,this.ownerEl&&this.ownerEl.hasloader&&this.loaderEl&&((e=$(".asc-loadmask-title",this.loaderEl)).html(t),this.loaderEl.css("min-width",e.width()+105))},isVisible:function(){return!!this.ownerEl.ismasked},updatePosition:function(){var t=this.ownerEl,e=this.loaderEl;t&&t.hasloader&&e&&(e.css({top:Math.round(t.height()/2-(e.height()+parseInt(e.css("padding-top"))+parseInt(e.css("padding-bottom")))/2)+"px",left:Math.round(t.width()/2-(e.width()+parseInt(e.css("padding-left"))+parseInt(e.css("padding-right")))/2)+"px"}),e.css({visibility:"visible"}))}})}),define("common/main/lib/view/SelectFileDlg",["common/main/lib/component/Window","common/main/lib/component/LoadMask"],function(){"use strict";Common.Views.SelectFileDlg=Common.UI.Window.extend(_.extend({initialize:function(t){var e={};_.extend(e,{title:this.textTitle,width:1024,height:621,header:!0},t),this.template=['<div id="id-select-file-placeholder"></div>'].join(""),e.tpl=_.template(this.template)(e),this.fileChoiceUrl=t.fileChoiceUrl||"",Common.UI.Window.prototype.initialize.call(this,e)},render:function(){Common.UI.Window.prototype.render.call(this),this.$window.find("> .body").css({height:"auto",overflow:"hidden"});var t=document.createElement("iframe"),e=(t.width="100%",t.height=585,t.align="top",t.frameBorder=0,t.scrolling="no",t.onload=_.bind(this._onLoad,this),$("#id-select-file-placeholder").append(t),this.loadMask=new Common.UI.LoadMask({owner:$("#id-select-file-placeholder")}),this.loadMask.setTitle(this.textLoading),this.loadMask.show(),t.src=this.fileChoiceUrl,this);this._eventfunc=function(t){e._onWindowMessage(t)},this._bindWindowEvents.call(this),this.on("close",function(t){e._unbindWindowEvents()})},_bindWindowEvents:function(){window.addEventListener?window.addEventListener("message",this._eventfunc,!1):window.attachEvent&&window.attachEvent("onmessage",this._eventfunc)},_unbindWindowEvents:function(){window.removeEventListener?window.removeEventListener("message",this._eventfunc):window.detachEvent&&window.detachEvent("onmessage",this._eventfunc)},_onWindowMessage:function(t){if(t&&window.JSON)try{this._onMessage.call(this,window.JSON.parse(t.data))}catch(t){}},_onMessage:function(t){var e;t&&"onlyoffice"==t.Referer&&void 0!==t.file&&(Common.NotificationCenter.trigger("window:close",this),e=this,setTimeout(function(){_.isEmpty(t.file)||e.trigger("selectfile",e,t.file)},50))},_onLoad:function(){this.loadMask&&this.loadMask.hide()}},Common.Views.SelectFileDlg||{}))}),void 0===Common&&(Common={}),void 0===Common.define&&(Common.define={}),define("common/main/lib/util/define",[],function(){"use strict";Common.define.c_oAscMathMainType={Symbol:0,Fraction:1,Script:2,Radical:3,Integral:4,LargeOperator:5,Bracket:6,Function:7,Accent:8,LimitLog:9,Operator:10,Matrix:11},Common.define.c_oAscMathType={Symbol_pm:0,Symbol_infinity:1,Symbol_equals:2,Symbol_neq:3,Symbol_about:4,Symbol_times:5,Symbol_div:6,Symbol_factorial:7,Symbol_propto:8,Symbol_less:9,Symbol_ll:10,Symbol_greater:11,Symbol_gg:12,Symbol_leq:13,Symbol_geq:14,Symbol_mp:15,Symbol_cong:16,Symbol_approx:17,Symbol_equiv:18,Symbol_forall:19,Symbol_additional:20,Symbol_partial:21,Symbol_sqrt:22,Symbol_cbrt:23,Symbol_qdrt:24,Symbol_cup:25,Symbol_cap:26,Symbol_emptyset:27,Symbol_percent:28,Symbol_degree:29,Symbol_fahrenheit:30,Symbol_celsius:31,Symbol_inc:32,Symbol_nabla:33,Symbol_exists:34,Symbol_notexists:35,Symbol_in:36,Symbol_ni:37,Symbol_leftarrow:38,Symbol_uparrow:39,Symbol_rightarrow:40,Symbol_downarrow:41,Symbol_leftrightarrow:42,Symbol_therefore:43,Symbol_plus:44,Symbol_minus:45,Symbol_not:46,Symbol_ast:47,Symbol_bullet:48,Symbol_vdots:49,Symbol_cdots:50,Symbol_rddots:51,Symbol_ddots:52,Symbol_aleph:53,Symbol_beth:54,Symbol_QED:55,Symbol_alpha:65536,Symbol_beta:65537,Symbol_gamma:65538,Symbol_delta:65539,Symbol_varepsilon:65540,Symbol_epsilon:65541,Symbol_zeta:65542,Symbol_eta:65543,Symbol_theta:65544,Symbol_vartheta:65545,Symbol_iota:65546,Symbol_kappa:65547,Symbol_lambda:65548,Symbol_mu:65549,Symbol_nu:65550,Symbol_xsi:65551,Symbol_o:65552,Symbol_pi:65553,Symbol_varpi:65554,Symbol_rho:65555,Symbol_varrho:65556,Symbol_sigma:65557,Symbol_varsigma:65558,Symbol_tau:65559,Symbol_upsilon:65560,Symbol_varphi:65561,Symbol_phi:65562,Symbol_chi:65563,Symbol_psi:65564,Symbol_omega:65565,Symbol_Alpha:131072,Symbol_Beta:131073,Symbol_Gamma:131074,Symbol_Delta:131075,Symbol_Epsilon:131076,Symbol_Zeta:131077,Symbol_Eta:131078,Symbol_Theta:131079,Symbol_Iota:131080,Symbol_Kappa:131081,Symbol_Lambda:131082,Symbol_Mu:131083,Symbol_Nu:131084,Symbol_Xsi:131085,Symbol_O:131086,Symbol_Pi:131087,Symbol_Rho:131088,Symbol_Sigma:131089,Symbol_Tau:131090,Symbol_Upsilon:131091,Symbol_Phi:131092,Symbol_Chi:131093,Symbol_Psi:131094,Symbol_Omega:131095,FractionVertical:16777216,FractionDiagonal:16777217,FractionHorizontal:16777218,FractionSmall:16777219,FractionDifferential_1:16842752,FractionDifferential_2:16842753,FractionDifferential_3:16842754,FractionDifferential_4:16842755,FractionPi_2:16842756,ScriptSup:33554432,ScriptSub:33554433,ScriptSubSup:33554434,ScriptSubSupLeft:33554435,ScriptCustom_1:33619968,ScriptCustom_2:33619969,ScriptCustom_3:33619970,ScriptCustom_4:33619971,RadicalSqrt:50331648,RadicalRoot_n:50331649,RadicalRoot_2:50331650,RadicalRoot_3:50331651,RadicalCustom_1:50397184,RadicalCustom_2:50397185,Integral:67108864,IntegralSubSup:67108865,IntegralCenterSubSup:67108866,IntegralDouble:67108867,IntegralDoubleSubSup:67108868,IntegralDoubleCenterSubSup:67108869,IntegralTriple:67108870,IntegralTripleSubSup:67108871,IntegralTripleCenterSubSup:67108872,IntegralOriented:67174400,IntegralOrientedSubSup:67174401,IntegralOrientedCenterSubSup:67174402,IntegralOrientedDouble:67174403,IntegralOrientedDoubleSubSup:67174404,IntegralOrientedDoubleCenterSubSup:67174405,IntegralOrientedTriple:67174406,IntegralOrientedTripleSubSup:67174407,IntegralOrientedTripleCenterSubSup:67174408,Integral_dx:67239936,Integral_dy:67239937,Integral_dtheta:67239938,LargeOperator_Sum:83886080,LargeOperator_Sum_CenterSubSup:83886081,LargeOperator_Sum_SubSup:83886082,LargeOperator_Sum_CenterSub:83886083,LargeOperator_Sum_Sub:83886084,LargeOperator_Prod:83951616,LargeOperator_Prod_CenterSubSup:83951617,LargeOperator_Prod_SubSup:83951618,LargeOperator_Prod_CenterSub:83951619,LargeOperator_Prod_Sub:83951620,LargeOperator_CoProd:83951621,LargeOperator_CoProd_CenterSubSup:83951622,LargeOperator_CoProd_SubSup:83951623,LargeOperator_CoProd_CenterSub:83951624,LargeOperator_CoProd_Sub:83951625,LargeOperator_Union:84017152,LargeOperator_Union_CenterSubSup:84017153,LargeOperator_Union_SubSup:84017154,LargeOperator_Union_CenterSub:84017155,LargeOperator_Union_Sub:84017156,LargeOperator_Intersection:84017157,LargeOperator_Intersection_CenterSubSup:84017158,LargeOperator_Intersection_SubSup:84017159,LargeOperator_Intersection_CenterSub:84017160,LargeOperator_Intersection_Sub:84017161,LargeOperator_Disjunction:84082688,LargeOperator_Disjunction_CenterSubSup:84082689,LargeOperator_Disjunction_SubSup:84082690,LargeOperator_Disjunction_CenterSub:84082691,LargeOperator_Disjunction_Sub:84082692,LargeOperator_Conjunction:84082693,LargeOperator_Conjunction_CenterSubSup:84082694,LargeOperator_Conjunction_SubSup:84082695,LargeOperator_Conjunction_CenterSub:84082696,LargeOperator_Conjunction_Sub:84082697,LargeOperator_Custom_1:84148224,LargeOperator_Custom_2:84148225,LargeOperator_Custom_3:84148226,LargeOperator_Custom_4:84148227,LargeOperator_Custom_5:84148228,Bracket_Round:100663296,Bracket_Square:100663297,Bracket_Curve:100663298,Bracket_Angle:100663299,Bracket_LowLim:100663300,Bracket_UppLim:100663301,Bracket_Line:100663302,Bracket_LineDouble:100663303,Bracket_Square_OpenOpen:100663304,Bracket_Square_CloseClose:100663305,Bracket_Square_CloseOpen:100663306,Bracket_SquareDouble:100663307,Bracket_Round_Delimiter_2:100728832,Bracket_Curve_Delimiter_2:100728833,Bracket_Angle_Delimiter_2:100728834,Bracket_Angle_Delimiter_3:100728835,Bracket_Round_OpenNone:100794368,Bracket_Round_NoneOpen:100794369,Bracket_Square_OpenNone:100794370,Bracket_Square_NoneOpen:100794371,Bracket_Curve_OpenNone:100794372,Bracket_Curve_NoneOpen:100794373,Bracket_Angle_OpenNone:100794374,Bracket_Angle_NoneOpen:100794375,Bracket_LowLim_OpenNone:100794376,Bracket_LowLim_NoneNone:100794377,Bracket_UppLim_OpenNone:100794378,Bracket_UppLim_NoneOpen:100794379,Bracket_Line_OpenNone:100794380,Bracket_Line_NoneOpen:100794381,Bracket_LineDouble_OpenNone:100794382,Bracket_LineDouble_NoneOpen:100794383,Bracket_SquareDouble_OpenNone:100794384,Bracket_SquareDouble_NoneOpen:100794385,Bracket_Custom_1:100859904,Bracket_Custom_2:100859905,Bracket_Custom_3:100859906,Bracket_Custom_4:100859907,Bracket_Custom_5:100925440,Bracket_Custom_6:100925441,Bracket_Custom_7:100925442,Function_Sin:117440512,Function_Cos:117440513,Function_Tan:117440514,Function_Csc:117440515,Function_Sec:117440516,Function_Cot:117440517,Function_1_Sin:117506048,Function_1_Cos:117506049,Function_1_Tan:117506050,Function_1_Csc:117506051,Function_1_Sec:117506052,Function_1_Cot:117506053,Function_Sinh:117571584,Function_Cosh:117571585,Function_Tanh:117571586,Function_Csch:117571587,Function_Sech:117571588,Function_Coth:117571589,Function_1_Sinh:117637120,Function_1_Cosh:117637121,Function_1_Tanh:117637122,Function_1_Csch:117637123,Function_1_Sech:117637124,Function_1_Coth:117637125,Function_Custom_1:117702656,Function_Custom_2:117702657,Function_Custom_3:117702658,Accent_Dot:134217728,Accent_DDot:134217729,Accent_DDDot:134217730,Accent_Hat:134217731,Accent_Check:134217732,Accent_Accent:134217733,Accent_Grave:134217734,Accent_Smile:134217735,Accent_Tilde:134217736,Accent_Bar:134217737,Accent_DoubleBar:134217738,Accent_CurveBracketTop:134217739,Accent_CurveBracketBot:134217740,Accent_GroupTop:134217741,Accent_GroupBot:134217742,Accent_ArrowL:134217743,Accent_ArrowR:134217744,Accent_ArrowD:134217745,Accent_HarpoonL:134217746,Accent_HarpoonR:134217747,Accent_BorderBox:134283264,Accent_BorderBoxCustom:134283265,Accent_BarTop:134348800,Accent_BarBot:134348801,Accent_Custom_1:134414336,Accent_Custom_2:134414337,Accent_Custom_3:134414338,LimitLog_LogBase:150994944,LimitLog_Log:150994945,LimitLog_Lim:150994946,LimitLog_Min:150994947,LimitLog_Max:150994948,LimitLog_Ln:150994949,LimitLog_Custom_1:151060480,LimitLog_Custom_2:151060481,Operator_ColonEquals:167772160,Operator_EqualsEquals:167772161,Operator_PlusEquals:167772162,Operator_MinusEquals:167772163,Operator_Definition:167772164,Operator_UnitOfMeasure:167772165,Operator_DeltaEquals:167772166,Operator_ArrowL_Top:167837696,Operator_ArrowR_Top:167837697,Operator_ArrowL_Bot:167837698,Operator_ArrowR_Bot:167837699,Operator_DoubleArrowL_Top:167837700,Operator_DoubleArrowR_Top:167837701,Operator_DoubleArrowL_Bot:167837702,Operator_DoubleArrowR_Bot:167837703,Operator_ArrowD_Top:167837704,Operator_ArrowD_Bot:167837705,Operator_DoubleArrowD_Top:167837706,Operator_DoubleArrowD_Bot:167837707,Operator_Custom_1:167903232,Operator_Custom_2:167903233,Matrix_1_2:184549376,Matrix_2_1:184549377,Matrix_1_3:184549378,Matrix_3_1:184549379,Matrix_2_2:184549380,Matrix_2_3:184549381,Matrix_3_2:184549382,Matrix_3_3:184549383,Matrix_Dots_Center:184614912,Matrix_Dots_Baseline:184614913,Matrix_Dots_Vertical:184614914,Matrix_Dots_Diagonal:184614915,Matrix_Identity_2:184680448,Matrix_Identity_2_NoZeros:184680449,Matrix_Identity_3:184680450,Matrix_Identity_3_NoZeros:184680451,Matrix_2_2_RoundBracket:184745984,Matrix_2_2_SquareBracket:184745985,Matrix_2_2_LineBracket:184745986,Matrix_2_2_DLineBracket:184745987,Matrix_Flat_Round:184811520,Matrix_Flat_Square:184811521},Common.define.chartData=_.extend(new function(){return{textLine:"Line",textColumn:"Column",textBar:"Bar",textArea:"Area",textPie:"Pie",textPoint:"XY (Scatter)",textStock:"Stock",textSurface:"Surface",textCharts:"Charts",textSparks:"Sparklines",textLineSpark:"Line",textColumnSpark:"Column",textWinLossSpark:"Win/Loss",textCombo:"Combo",textBarNormal:"Clustered column",textBarStacked:"Stacked column",textBarStackedPer:"100% Stacked column",textBarNormal3d:"3-D Clustered column",textBarStacked3d:"3-D Stacked column",textBarStackedPer3d:"3-D 100% Stacked column",textBarNormal3dPerspective:"3-D column",textLineStacked:"Stacked line",textLineStackedPer:"100% Stacked line",textLineMarker:"Line with markers",textLineStackedMarker:"Stacked line with markers",textLineStackedPerMarker:"100% Stacked line with markers",textLine3d:"3-D line",textDoughnut:"Doughnut",textPie3d:"3-D pie",textHBarNormal:"Clustered bar",textHBarStacked:"Stacked bar",textHBarStackedPer:"100% Stacked bar",textHBarNormal3d:"3-D Clustered bar",textHBarStacked3d:"3-D Stacked bar",textHBarStackedPer3d:"3-D 100% Stacked bar",textAreaStacked:"Stacked area",textAreaStackedPer:"100% Stacked area",textScatter:"Scatter",textScatterSmoothMarker:"Scatter with smooth lines and markers",textScatterSmooth:"Scatter with smooth lines",textScatterLineMarker:"Scatter with straight lines and markers",textScatterLine:"Scatter with straight lines",textComboBarLine:"Clustered column - line",textComboBarLineSecondary:"Clustered column - line on secondary axis",textComboAreaBar:"Stacked area - clustered column",textComboCustom:"Custom combination",textRadar:"Radar",textRadarMarker:"Radar with markers",textRadarFilled:"Filled radar",getChartGroupData:function(t){return[{id:"menu-chart-group-bar",caption:this.textColumn,headername:t?this.textCharts:void 0},{id:"menu-chart-group-line",caption:this.textLine},{id:"menu-chart-group-pie",caption:this.textPie},{id:"menu-chart-group-hbar",caption:this.textBar},{id:"menu-chart-group-area",caption:this.textArea,inline:!0},{id:"menu-chart-group-stock",caption:this.textStock,inline:!0},{id:"menu-chart-group-scatter",caption:this.textPoint},{id:"menu-chart-group-radar",caption:this.textRadar},{id:"menu-chart-group-combo",caption:this.textCombo}]},getChartData:function(){return[{group:"menu-chart-group-bar",type:Asc.c_oAscChartTypeSettings.barNormal,iconCls:"column-normal",tip:this.textBarNormal},{group:"menu-chart-group-bar",type:Asc.c_oAscChartTypeSettings.barStacked,iconCls:"column-stack",tip:this.textBarStacked},{group:"menu-chart-group-bar",type:Asc.c_oAscChartTypeSettings.barStackedPer,iconCls:"column-pstack",tip:this.textBarStackedPer},{group:"menu-chart-group-bar",type:Asc.c_oAscChartTypeSettings.barNormal3d,iconCls:"column-3d-normal",tip:this.textBarNormal3d,is3d:!0},{group:"menu-chart-group-bar",type:Asc.c_oAscChartTypeSettings.barStacked3d,iconCls:"column-3d-stack",tip:this.textBarStacked3d,is3d:!0},{group:"menu-chart-group-bar",type:Asc.c_oAscChartTypeSettings.barStackedPer3d,iconCls:"column-3d-pstack",tip:this.textBarStackedPer3d,is3d:!0},{group:"menu-chart-group-bar",type:Asc.c_oAscChartTypeSettings.barNormal3dPerspective,iconCls:"column-3d-normal-per",tip:this.textBarNormal3dPerspective,is3d:!0},{group:"menu-chart-group-line",type:Asc.c_oAscChartTypeSettings.lineNormal,iconCls:"line-normal",tip:this.textLine},{group:"menu-chart-group-line",type:Asc.c_oAscChartTypeSettings.lineStacked,iconCls:"line-stack",tip:this.textLineStacked},{group:"menu-chart-group-line",type:Asc.c_oAscChartTypeSettings.lineStackedPer,iconCls:"line-pstack",tip:this.textLineStackedPer},{group:"menu-chart-group-line",type:Asc.c_oAscChartTypeSettings.lineNormalMarker,iconCls:"line-normal-marker",tip:this.textLineMarker},{group:"menu-chart-group-line",type:Asc.c_oAscChartTypeSettings.lineStackedMarker,iconCls:"line-stack-marker",tip:this.textLineStackedMarker},{group:"menu-chart-group-line",type:Asc.c_oAscChartTypeSettings.lineStackedPerMarker,iconCls:"line-pstack-marker",tip:this.textLineStackedPerMarker},{group:"menu-chart-group-line",type:Asc.c_oAscChartTypeSettings.line3d,iconCls:"line-3d",tip:this.textLine3d,is3d:!0},{group:"menu-chart-group-pie",type:Asc.c_oAscChartTypeSettings.pie,iconCls:"pie-normal",tip:this.textPie},{group:"menu-chart-group-pie",type:Asc.c_oAscChartTypeSettings.doughnut,iconCls:"pie-doughnut",tip:this.textDoughnut},{group:"menu-chart-group-pie",type:Asc.c_oAscChartTypeSettings.pie3d,iconCls:"pie-3d-normal",tip:this.textPie3d,is3d:!0},{group:"menu-chart-group-hbar",type:Asc.c_oAscChartTypeSettings.hBarNormal,iconCls:"bar-normal",tip:this.textHBarNormal},{group:"menu-chart-group-hbar",type:Asc.c_oAscChartTypeSettings.hBarStacked,iconCls:"bar-stack",tip:this.textHBarStacked},{group:"menu-chart-group-hbar",type:Asc.c_oAscChartTypeSettings.hBarStackedPer,iconCls:"bar-pstack",tip:this.textHBarStackedPer},{group:"menu-chart-group-hbar",type:Asc.c_oAscChartTypeSettings.hBarNormal3d,iconCls:"bar-3d-normal",tip:this.textHBarNormal3d,is3d:!0},{group:"menu-chart-group-hbar",type:Asc.c_oAscChartTypeSettings.hBarStacked3d,iconCls:"bar-3d-stack",tip:this.textHBarStacked3d,is3d:!0},{group:"menu-chart-group-hbar",type:Asc.c_oAscChartTypeSettings.hBarStackedPer3d,iconCls:"bar-3d-pstack",tip:this.textHBarStackedPer3d,is3d:!0},{group:"menu-chart-group-area",type:Asc.c_oAscChartTypeSettings.areaNormal,iconCls:"area-normal",tip:this.textArea},{group:"menu-chart-group-area",type:Asc.c_oAscChartTypeSettings.areaStacked,iconCls:"area-stack",tip:this.textAreaStacked},{group:"menu-chart-group-area",type:Asc.c_oAscChartTypeSettings.areaStackedPer,iconCls:"area-pstack",tip:this.textAreaStackedPer},{group:"menu-chart-group-scatter",type:Asc.c_oAscChartTypeSettings.scatter,iconCls:"point-normal",tip:this.textScatter},{group:"menu-chart-group-scatter",type:Asc.c_oAscChartTypeSettings.scatterSmoothMarker,iconCls:"point-smooth-marker",tip:this.textScatterSmoothMarker},{group:"menu-chart-group-scatter",type:Asc.c_oAscChartTypeSettings.scatterSmooth,iconCls:"point-smooth",tip:this.textScatterSmooth},{group:"menu-chart-group-scatter",type:Asc.c_oAscChartTypeSettings.scatterLineMarker,iconCls:"point-line-marker",tip:this.textScatterLineMarker},{group:"menu-chart-group-scatter",type:Asc.c_oAscChartTypeSettings.scatterLine,iconCls:"point-line",tip:this.textScatterLine},{group:"menu-chart-group-stock",type:Asc.c_oAscChartTypeSettings.stock,iconCls:"stock-normal",tip:this.textStock},{group:"menu-chart-group-radar",type:Asc.c_oAscChartTypeSettings.radar,iconCls:"radar",tip:this.textRadar},{group:"menu-chart-group-radar",type:Asc.c_oAscChartTypeSettings.radarMarker,iconCls:"radar-with-markers",tip:this.textRadarMarker},{group:"menu-chart-group-radar",type:Asc.c_oAscChartTypeSettings.radarFilled,iconCls:"filled-radar",tip:this.textRadarFilled},{group:"menu-chart-group-combo",type:Asc.c_oAscChartTypeSettings.comboBarLine,iconCls:"combo-bar-line",tip:this.textComboBarLine},{group:"menu-chart-group-combo",type:Asc.c_oAscChartTypeSettings.comboBarLineSecondary,iconCls:"combo-bar-line-sec",tip:this.textComboBarLineSecondary},{group:"menu-chart-group-combo",type:Asc.c_oAscChartTypeSettings.comboAreaBar,iconCls:"combo-area-bar",tip:this.textComboAreaBar},{group:"menu-chart-group-combo",type:Asc.c_oAscChartTypeSettings.comboCustom,iconCls:"combo-custom",tip:this.textComboCustom}]},getSparkGroupData:function(t){return[{id:"menu-chart-group-sparkcolumn",inline:!0,headername:t?this.textSparks:void 0},{id:"menu-chart-group-sparkline",inline:!0},{id:"menu-chart-group-sparkwin",inline:!0}]},getSparkData:function(){return[{group:"menu-chart-group-sparkcolumn",type:Asc.c_oAscSparklineType.Column,allowSelected:!0,iconCls:"spark-column",tip:this.textColumnSpark},{group:"menu-chart-group-sparkline",type:Asc.c_oAscSparklineType.Line,allowSelected:!0,iconCls:"spark-line",tip:this.textLineSpark},{group:"menu-chart-group-sparkwin",type:Asc.c_oAscSparklineType.Stacked,allowSelected:!0,iconCls:"spark-win",tip:this.textWinLossSpark}]}}},Common.define.chartData||{}),Common.define.conditionalData=_.extend(new function(){return{textDate:"Date",textYesterday:"Yesterday",textToday:"Today",textTomorrow:"Tomorrow",textLast7days:"In the last 7 days",textLastWeek:"Last week",textThisWeek:"This week",textNextWeek:"Next week",textLastMonth:"Last month",textThisMonth:"This month",textNextMonth:"Next month",textText:"Text",textContains:"Contains",textNotContains:"Does not contain",textBegins:"Begins with",textEnds:"Ends with",textAverage:"Average",textAbove:"Above",textBelow:"Below",textEqAbove:"Equal to or above",textEqBelow:"Equal to or below",text1Above:"1 std dev above",text1Below:"1 std dev below",text2Above:"2 std dev above",text2Below:"2 std dev below",text3Above:"3 std dev above",text3Below:"3 std dev below",textGreater:"Greater than",textGreaterEq:"Greater than or equal to",textLess:"Less than",textLessEq:"Less than or equal to",textEqual:"Equal to",textNotEqual:"Not equal to",textBetween:"Between",textNotBetween:"Not between",textTop:"Top",textBottom:"Bottom",textBlank:"Blank",textError:"Error",textBlanks:"Contains blanks",textNotBlanks:"Does not contain blanks",textErrors:"Contains errors",textNotErrors:"Does not contain errors",textDuplicate:"Duplicate",textUnique:"Unique",textDataBar:"Data bar",textIconSets:"Icon sets",textFormula:"Formula",exampleText:"AaBbCcYyZz",noFormatText:"No format set",textValue:"Value is"}},Common.define.conditionalData||{}),Common.define.smartArt=_.extend(new function(){return{textList:"List",textProcess:"Process",textCycle:"Cycle",textHierarchy:"Hierarchy",textRelationship:"Relationship",textMatrix:"Matrix",textPyramid:"Pyramid",textPicture:"Picture",textBasicBlockList:"Basic Block List",textAlternatingHexagons:"Alternating Hexagons",textPictureCaptionList:"Picture Caption List",textLinedList:"Lined List",textVerticalBulletList:"Vertical Bullet List",textVerticalBoxList:"Vertical Box List",textHorizontalBulletList:"Horizontal Bullet List",textSquareAccentList:"Square Accent List",textPictureAccentList:"Picture Accent List",textBendingPictureAccentList:"Bending Picture Accent List",textStackedList:"Stacked List",textIncreasingCircleProcess:"Increasing Circle Process",textPieProcess:"Pie Process",textDetailedProcess:"Detailed Process",textGroupedList:"Grouped List",textHorizontalPictureList:"Horizontal Picture List",textContinuousPictureList:"Continuous Picture List",textPictureStrips:"Picture Strips",textVerticalPictureList:"Vertical Picture List",textAlternatingPictureBlocks:"Alternating Picture Blocks",textVerticalPictureAccentList:"Vertical Picture Accent List",textTitledPictureAccentList:"Titled Picture Accent List",textVerticalBlockList:"Vertical Block List",textVerticalChevronList:"Vertical Chevron List",textVerticalAccentList:"Vertical Accent List",textVerticalArrowList:"Vertical Arrow List",textTrapezoidList:"Trapezoid List",textDescendingBlockList:"Descending Block List",textTableList:"Table List",textSegmentedProcess:"Segmented Process",textVerticalCurvedList:"Vertical Curved List",textPyramidList:"Pyramid List",textTargetList:"Target List",textHierarchyList:"Hierarchy List",textVerticalCircleList:"Vertical Circle List",textTableHierarchy:"Table Hierarchy",textBasicProcess:"Basic Process",textStepUpProcess:"Step Up Process",textStepDownProcess:"Step Down Process",textAccentProcess:"Accent Process",textPictureAccentProcess:"Picture Accent Process",textAlternatingFlow:"Alternating Flow",textContinuousBlockProcess:"Continuous Block Process",textIncreasingArrowProcess:"Increasing Arrow Process",textContinuousArrowProcess:"Continuous Arrow Process",textProcessArrows:"Process Arrows",textCircleAccentTimeline:"Circle Accent Timeline",textBasicTimeline:"Basic Timeline",textBasicChevronProcess:"Basic Chevron Process",textClosedChevronProcess:"Closed Chevron Process",textChevronList:"Chevron List",textSubStepProcess:"Sub-Step Process",textPhasedProcess:"Phased Process",textRandomToResultProcess:"Random to Result Process",textVerticalProcess:"Vertical Process",textStaggeredProcess:"Staggered Process",textProcessList:"Process List",textCircleArrowProcess:"Circle Arrow Process",textBasicBendingProcess:"Basic Bending Process",textRepeatingBendingProcess:"Repeating Bending Process",textVerticalBendingProcess:"Vertical Bending Process",textAscendingPictureAccentProcess:"Ascending Picture Accent Process",textUpwardArrow:"Upward Arrow",textDescendingProcess:"Descending Process",textCircularBendingProcess:"Circular Bending Process",textEquation:"Equation",textVerticalEquation:"Vertical Equation",textFunnel:"Funnel",textGear:"Gear",textArrowRibbon:"Arrow Ribbon",textOpposingArrows:"Opposing Arrows",textConvergingArrows:"Converging Arrows",textDivergingArrows:"Diverging Arrows",textBasicCycle:"Basic Cycle",textTextCycle:"Text Cycle",textBlockCycle:"Block Cycle",textNondirectionalCycle:"Nondirectional Cycle",textContinuousCycle:"Continuous Cycle",textMultidirectionalCycle:"Multidirectional Cycle",textSegmentedCycle:"Segmented Cycle",textBasicPie:"Basic Pie",textRadialCycle:"Radial Cycle",textBasicRadial:"Basic Radial",textDivergingRadial:"Diverging Radial",textRadialVenn:"Radial Venn",textCycleMatrix:"Cycle Matrix",textRadialCluster:"Radial Cluster",textOrganizationChart:"Organization Chart",textNameAndTitleOrganizationChart:"Name and Title Organization Chart",textHalfCircleOrganizationChart:"Half Circle Organization Chart",textCirclePictureHierarchy:"Circle Picture Hierarchy",textLabeledHierarchy:"Labeled Hierarchy",textHorizontalOrganizationChart:"Horizontal Organization Chart",textHorizontalMultiLevelHierarchy:"Horizontal Multi-Level Hierarchy",textHorizontalHierarchy:"Horizontal Hierarchy",textHorizontalLabeledHierarchy:"Horizontal Labeled Hierarchy",textBalance:"Balance",textCircleRelationship:"Circle Relationship",textHexagonCluster:"Hexagon Cluster",textOpposingIdeas:"Opposing Ideas",textPlusAndMinus:"Plus and Minus",textReverseList:"Reverse List",textCounterbalanceArrows:"Counterbalance Arrows",textSegmentedPyramid:"Segmented Pyramid",textNestedTarget:"Nested Target",textConvergingRadial:"Converging Radial",textRadialList:"Radial List",textBasicTarget:"Basic Target",textBasicVenn:"Basic Venn",textLinearVenn:"Linear Venn",textStackedVenn:"Stacked Venn",textBasicMatrix:"Basic Matrix",textTitledMatrix:"Titled Matrix",textGridMatrix:"Grid Matrix",textBasicPyramid:"Basic Pyramid",textInvertedPyramid:"Inverted Pyramid",textAccentedPicture:"Accented Picture",textCircularPictureCallout:"Circular Picture Callout",textSnapshotPictureList:"Snapshot Picture List",textSpiralPicture:"Spiral Picture",textCaptionedPictures:"Captioned Pictures",textBendingPictureCaption:"Bending Picture Caption",textBendingPictureSemiTranparentText:"Bending Picture Semi-Tranparent Text",textBendingPictureBlocks:"Bending Picture Blocks",textBendingPictureCaptionList:"Bending Picture Caption List",textTitledPictureBlocks:"Titled Picture Blocks",textPictureGrid:"Picture Grid",textPictureAccentBlocks:"Picture Accent Blocks",textAlternatingPictureCircles:"Alternating Picture Circles",textTitlePictureLineup:"Title Picture Lineup",textPictureLineup:"Picture Lineup",textFramedTextPicture:"Framed Text Picture",textBubblePictureList:"Bubble Picture List",textOther:"Other",textPictureOrganizationChart:"Picture Organization Chart",textChevronAccentProcess:"Chevron Accent Process",textRadialPictureList:"Radial Picture List",textVerticalBracketList:"Vertical Bracket List",textInterconnectedBlockProcess:"Interconnected Block Process",textTabbedArc:"Tabbed Arc",textThemePictureAccent:"Theme Picture Accent",textVaryingWidthList:"Varying Width List",textConvergingText:"Converging Text",textInterconnectedRings:"Interconnected Rings",textArchitectureLayout:"Architecture Layout",textThemePictureAlternatingAccent:"Theme Picture Alternating Accent",textThemePictureGrid:"Theme Picture Grid",textCircleProcess:"Circle Process",textHexagonRadial:"Hexagon Radial",textPictureFrame:"PictureFrame",textTabList:"Tab List",getSmartArtData:function(){return[{id:"menu-smart-art-group-list",sectionId:Asc.c_oAscSmartArtSectionNames.List,caption:this.textList,icon:"btn-smart-list",items:[{type:Asc.c_oAscSmartArtTypes.BasicBlockList,tip:this.textBasicBlockList},{type:Asc.c_oAscSmartArtTypes.AlternatingHexagonList,tip:this.textAlternatingHexagons},{type:Asc.c_oAscSmartArtTypes.PictureCaptionList,tip:this.textPictureCaptionList},{type:Asc.c_oAscSmartArtTypes.LinedList,tip:this.textLinedList},{type:Asc.c_oAscSmartArtTypes.VerticalBulletList,tip:this.textVerticalBulletList},{type:Asc.c_oAscSmartArtTypes.VerticalBoxList,tip:this.textVerticalBoxList},{type:Asc.c_oAscSmartArtTypes.VerticalBracketList,tip:this.textVerticalBracketList},{type:Asc.c_oAscSmartArtTypes.VaryingWidthList,tip:this.textVaryingWidthList},{type:Asc.c_oAscSmartArtTypes.TabList,tip:this.textTabList},{type:Asc.c_oAscSmartArtTypes.HorizontalBulletList,tip:this.textHorizontalBulletList},{type:Asc.c_oAscSmartArtTypes.SquareAccentList,tip:this.textSquareAccentList},{type:Asc.c_oAscSmartArtTypes.PictureAccentList,tip:this.textPictureAccentList},{type:Asc.c_oAscSmartArtTypes.BendingPictureAccentList,tip:this.textBendingPictureAccentList},{type:Asc.c_oAscSmartArtTypes.StackedList,tip:this.textStackedList},{type:Asc.c_oAscSmartArtTypes.IncreasingCircleProcess,tip:this.textIncreasingCircleProcess},{type:Asc.c_oAscSmartArtTypes.PieProcess,tip:this.textPieProcess},{type:Asc.c_oAscSmartArtTypes.DetailedProcess,tip:this.textDetailedProcess},{type:Asc.c_oAscSmartArtTypes.GroupedList,tip:this.textGroupedList},{type:Asc.c_oAscSmartArtTypes.HorizontalPictureList,tip:this.textHorizontalPictureList},{type:Asc.c_oAscSmartArtTypes.ContinuousPictureList,tip:this.textContinuousPictureList},{type:Asc.c_oAscSmartArtTypes.PictureStrips,tip:this.textPictureStrips},{type:Asc.c_oAscSmartArtTypes.VerticalPictureList,tip:this.textVerticalPictureList},{type:Asc.c_oAscSmartArtTypes.AlternatingPictureBlocks,tip:this.textAlternatingPictureBlocks},{type:Asc.c_oAscSmartArtTypes.VerticalPictureAccentList,tip:this.textVerticalPictureAccentList},{type:Asc.c_oAscSmartArtTypes.TitledPictureAccentList,tip:this.textTitledPictureAccentList},{type:Asc.c_oAscSmartArtTypes.VerticalBlockList,tip:this.textVerticalBlockList},{type:Asc.c_oAscSmartArtTypes.VerticalChevronList,tip:this.textVerticalChevronList},{type:Asc.c_oAscSmartArtTypes.VerticalAccentList,tip:this.textVerticalAccentList},{type:Asc.c_oAscSmartArtTypes.VerticalArrowList,tip:this.textVerticalArrowList},{type:Asc.c_oAscSmartArtTypes.TrapezoidList,tip:this.textTrapezoidList},{type:Asc.c_oAscSmartArtTypes.DescendingBlockList,tip:this.textDescendingBlockList},{type:Asc.c_oAscSmartArtTypes.TableList,tip:this.textTableList},{type:Asc.c_oAscSmartArtTypes.SegmentedProcess,tip:this.textSegmentedProcess},{type:Asc.c_oAscSmartArtTypes.VerticalCurvedList,tip:this.textVerticalCurvedList},{type:Asc.c_oAscSmartArtTypes.PyramidList,tip:this.textPyramidList},{type:Asc.c_oAscSmartArtTypes.TargetList,tip:this.textTargetList},{type:Asc.c_oAscSmartArtTypes.HierarchyList,tip:this.textHierarchyList},{type:Asc.c_oAscSmartArtTypes.VerticalCircleList,tip:this.textVerticalCircleList},{type:Asc.c_oAscSmartArtTypes.TableHierarchy,tip:this.textTableHierarchy},{type:Asc.c_oAscSmartArtTypes.ArchitectureLayout,tip:this.textArchitectureLayout}]},{id:"menu-smart-art-group-process",sectionId:Asc.c_oAscSmartArtSectionNames.Process,caption:this.textProcess,icon:"btn-smart-process",items:[{type:Asc.c_oAscSmartArtTypes.BasicProcess,tip:this.textBasicProcess},{type:Asc.c_oAscSmartArtTypes.StepUpProcess,tip:this.textStepUpProcess},{type:Asc.c_oAscSmartArtTypes.StepDownProcess,tip:this.textStepDownProcess},{type:Asc.c_oAscSmartArtTypes.AccentProcess,tip:this.textAccentProcess},{type:Asc.c_oAscSmartArtTypes.PictureAccentProcess,tip:this.textPictureAccentProcess},{type:Asc.c_oAscSmartArtTypes.AlternatingFlow,tip:this.textAlternatingFlow},{type:Asc.c_oAscSmartArtTypes.IncreasingCircleProcess,tip:this.textIncreasingCircleProcess},{type:Asc.c_oAscSmartArtTypes.PieProcess,tip:this.textPieProcess},{type:Asc.c_oAscSmartArtTypes.ContinuousBlockProcess,tip:this.textContinuousBlockProcess},{type:Asc.c_oAscSmartArtTypes.IncreasingArrowsProcess,tip:this.textIncreasingArrowProcess},{type:Asc.c_oAscSmartArtTypes.InterconnectedBlockProcess,tip:this.textInterconnectedBlockProcess},{type:Asc.c_oAscSmartArtTypes.ContinuousArrowProcess,tip:this.textContinuousArrowProcess},{type:Asc.c_oAscSmartArtTypes.ConvergingText,tip:this.textConvergingText},{type:Asc.c_oAscSmartArtTypes.ProcessArrows,tip:this.textProcessArrows},{type:Asc.c_oAscSmartArtTypes.CircleAccentTimeline,tip:this.textCircleAccentTimeline},{type:Asc.c_oAscSmartArtTypes.BasicTimeline,tip:this.textBasicTimeline},{type:Asc.c_oAscSmartArtTypes.CircleProcess,tip:this.textCircleProcess},{type:Asc.c_oAscSmartArtTypes.BasicChevronProcess,tip:this.textBasicChevronProcess},{type:Asc.c_oAscSmartArtTypes.ChevronAccentProcess,tip:this.textChevronAccentProcess},{type:Asc.c_oAscSmartArtTypes.ClosedChevronProcess,tip:this.textClosedChevronProcess},{type:Asc.c_oAscSmartArtTypes.ChevronList,tip:this.textChevronList},{type:Asc.c_oAscSmartArtTypes.VerticalChevronList,tip:this.textVerticalChevronList},{type:Asc.c_oAscSmartArtTypes.SubStepProcess,tip:this.textSubStepProcess},{type:Asc.c_oAscSmartArtTypes.PhasedProcess,tip:this.textPhasedProcess},{type:Asc.c_oAscSmartArtTypes.RandomToResultProcess,tip:this.textRandomToResultProcess},{type:Asc.c_oAscSmartArtTypes.VerticalProcess,tip:this.textVerticalProcess},{type:Asc.c_oAscSmartArtTypes.StaggeredProcess,tip:this.textStaggeredProcess},{type:Asc.c_oAscSmartArtTypes.ProcessList,tip:this.textProcessList},{type:Asc.c_oAscSmartArtTypes.SegmentedProcess,tip:this.textSegmentedProcess},{type:Asc.c_oAscSmartArtTypes.CircleArrowProcess,tip:this.textCircleArrowProcess},{type:Asc.c_oAscSmartArtTypes.BasicBendingProcess,tip:this.textBasicBendingProcess},{type:Asc.c_oAscSmartArtTypes.RepeatingBendingProcess,tip:this.textRepeatingBendingProcess},{type:Asc.c_oAscSmartArtTypes.VerticalBendingProcess,tip:this.textVerticalBendingProcess},{type:Asc.c_oAscSmartArtTypes.ContinuousPictureList,tip:this.textContinuousPictureList},{type:Asc.c_oAscSmartArtTypes.DetailedProcess,tip:this.textDetailedProcess},{type:Asc.c_oAscSmartArtTypes.VerticalArrowList,tip:this.textVerticalArrowList},{type:Asc.c_oAscSmartArtTypes.AscendingPictureAccentProcess,tip:this.textAscendingPictureAccentProcess},{type:Asc.c_oAscSmartArtTypes.UpwardArrow,tip:this.textUpwardArrow},{type:Asc.c_oAscSmartArtTypes.DescendingProcess,tip:this.textDescendingProcess},{type:Asc.c_oAscSmartArtTypes.CircularBendingProcess,tip:this.textCircularBendingProcess},{type:Asc.c_oAscSmartArtTypes.Equation,tip:this.textEquation},{type:Asc.c_oAscSmartArtTypes.VerticalEquation,tip:this.textVerticalEquation},{type:Asc.c_oAscSmartArtTypes.Funnel,tip:this.textFunnel},{type:Asc.c_oAscSmartArtTypes.Gear,tip:this.textGear},{type:Asc.c_oAscSmartArtTypes.ArrowRibbon,tip:this.textArrowRibbon},{type:Asc.c_oAscSmartArtTypes.OpposingArrows,tip:this.textOpposingArrows},{type:Asc.c_oAscSmartArtTypes.ConvergingArrows,tip:this.textConvergingArrows},{type:Asc.c_oAscSmartArtTypes.DivergingArrows,tip:this.textDivergingArrows}]},{id:"menu-smart-art-group-cycle",sectionId:Asc.c_oAscSmartArtSectionNames.Cycle,caption:this.textCycle,icon:"btn-smart-cycle",items:[{type:Asc.c_oAscSmartArtTypes.BasicCycle,tip:this.textBasicCycle},{type:Asc.c_oAscSmartArtTypes.TextCycle,tip:this.textTextCycle},{type:Asc.c_oAscSmartArtTypes.BlockCycle,tip:this.textBlockCycle},{type:Asc.c_oAscSmartArtTypes.NonDirectionalCycle,tip:this.textNondirectionalCycle},{type:Asc.c_oAscSmartArtTypes.ContinuousCycle,tip:this.textContinuousCycle},{type:Asc.c_oAscSmartArtTypes.MultiDirectionalCycle,tip:this.textMultidirectionalCycle},{type:Asc.c_oAscSmartArtTypes.SegmentedCycle,tip:this.textSegmentedCycle},{type:Asc.c_oAscSmartArtTypes.BasicPie,tip:this.textBasicPie},{type:Asc.c_oAscSmartArtTypes.HexagonRadial,tip:this.textHexagonRadial},{type:Asc.c_oAscSmartArtTypes.RadialCycle,tip:this.textRadialCycle},{type:Asc.c_oAscSmartArtTypes.BasicRadial,tip:this.textBasicRadial},{type:Asc.c_oAscSmartArtTypes.DivergingRadial,tip:this.textDivergingRadial},{type:Asc.c_oAscSmartArtTypes.RadialVenn,tip:this.textRadialVenn},{type:Asc.c_oAscSmartArtTypes.CycleMatrix,tip:this.textCycleMatrix},{type:Asc.c_oAscSmartArtTypes.Gear,tip:this.textGear},{type:Asc.c_oAscSmartArtTypes.RadialCluster,tip:this.textRadialCluster},{type:Asc.c_oAscSmartArtTypes.CircleArrowProcess,tip:this.textCircleArrowProcess}]},{id:"menu-smart-art-group-hierarchy",sectionId:Asc.c_oAscSmartArtSectionNames.Hierarchy,caption:this.textHierarchy,icon:"btn-smart-hierarchy",items:[{type:Asc.c_oAscSmartArtTypes.OrganizationChart,tip:this.textOrganizationChart},{type:Asc.c_oAscSmartArtTypes.PictureOrganizationChart,tip:this.textPictureOrganizationChart},{type:Asc.c_oAscSmartArtTypes.NameAndTitleOrganizationChart,tip:this.textNameAndTitleOrganizationChart},{type:Asc.c_oAscSmartArtTypes.HalfCircleOrganizationChart,tip:this.textHalfCircleOrganizationChart},{type:Asc.c_oAscSmartArtTypes.CirclePictureHierarchy,tip:this.textCirclePictureHierarchy},{type:Asc.c_oAscSmartArtTypes.Hierarchy,tip:this.textHierarchy},{type:Asc.c_oAscSmartArtTypes.LabeledHierarchy,tip:this.textLabeledHierarchy},{type:Asc.c_oAscSmartArtTypes.TableHierarchy,tip:this.textTableHierarchy},{type:Asc.c_oAscSmartArtTypes.HorizontalOrganizationChart,tip:this.textHorizontalOrganizationChart},{type:Asc.c_oAscSmartArtTypes.ArchitectureLayout,tip:this.textArchitectureLayout},{type:Asc.c_oAscSmartArtTypes.HorizontalMultiLevelHierarchy,tip:this.textHorizontalMultiLevelHierarchy},{type:Asc.c_oAscSmartArtTypes.HorizontalHierarchy,tip:this.textHorizontalHierarchy},{type:Asc.c_oAscSmartArtTypes.HorizontalLabeledHierarchy,tip:this.textHorizontalLabeledHierarchy},{type:Asc.c_oAscSmartArtTypes.HierarchyList,tip:this.textHierarchyList},{type:Asc.c_oAscSmartArtTypes.LinedList,tip:this.textLinedList}]},{id:"menu-smart-art-group-relationship",sectionId:Asc.c_oAscSmartArtSectionNames.Relationship,caption:this.textRelationship,icon:"btn-smart-relationship",items:[{type:Asc.c_oAscSmartArtTypes.Balance,tip:this.textBalance},{type:Asc.c_oAscSmartArtTypes.CircleRelationship,tip:this.textCircleRelationship},{type:Asc.c_oAscSmartArtTypes.Funnel,tip:this.textFunnel},{type:Asc.c_oAscSmartArtTypes.Gear,tip:this.textGear},{type:Asc.c_oAscSmartArtTypes.HexagonCluster,tip:this.textHexagonCluster},{type:Asc.c_oAscSmartArtTypes.OpposingIdeas,tip:this.textOpposingIdeas},{type:Asc.c_oAscSmartArtTypes.PlusAndMinus,tip:this.textPlusAndMinus},{type:Asc.c_oAscSmartArtTypes.ReverseList,tip:this.textReverseList},{type:Asc.c_oAscSmartArtTypes.ArrowRibbon,tip:this.textArrowRibbon},{type:Asc.c_oAscSmartArtTypes.CounterbalanceArrows,tip:this.textCounterbalanceArrows},{type:Asc.c_oAscSmartArtTypes.ConvergingArrows,tip:this.textConvergingArrows},{type:Asc.c_oAscSmartArtTypes.DivergingArrows,tip:this.textDivergingArrows},{type:Asc.c_oAscSmartArtTypes.OpposingArrows,tip:this.textOpposingArrows},{type:Asc.c_oAscSmartArtTypes.SegmentedPyramid,tip:this.textSegmentedPyramid},{type:Asc.c_oAscSmartArtTypes.TableHierarchy,tip:this.textTableHierarchy},{type:Asc.c_oAscSmartArtTypes.ArchitectureLayout,tip:this.textArchitectureLayout},{type:Asc.c_oAscSmartArtTypes.TargetList,tip:this.textTargetList},{type:Asc.c_oAscSmartArtTypes.NestedTarget,tip:this.textNestedTarget},{type:Asc.c_oAscSmartArtTypes.GroupedList,tip:this.textGroupedList},{type:Asc.c_oAscSmartArtTypes.ContinuousPictureList,tip:this.textContinuousPictureList},{type:Asc.c_oAscSmartArtTypes.HierarchyList,tip:this.textHierarchyList},{type:Asc.c_oAscSmartArtTypes.PictureAccentList,tip:this.textPictureAccentList},{type:Asc.c_oAscSmartArtTypes.Equation,tip:this.textEquation},{type:Asc.c_oAscSmartArtTypes.VerticalEquation,tip:this.textVerticalEquation},{type:Asc.c_oAscSmartArtTypes.ConvergingRadial,tip:this.textConvergingRadial},{type:Asc.c_oAscSmartArtTypes.RadialCluster,tip:this.textRadialCluster},{type:Asc.c_oAscSmartArtTypes.RadialList,tip:this.textRadialList},{type:Asc.c_oAscSmartArtTypes.TabbedArc,tip:this.textTabbedArc},{type:Asc.c_oAscSmartArtTypes.RadialCycle,tip:this.textRadialCycle},{type:Asc.c_oAscSmartArtTypes.BasicRadial,tip:this.textBasicRadial},{type:Asc.c_oAscSmartArtTypes.DivergingRadial,tip:this.textDivergingRadial},{type:Asc.c_oAscSmartArtTypes.NonDirectionalCycle,tip:this.textNondirectionalCycle},{type:Asc.c_oAscSmartArtTypes.BasicTarget,tip:this.textBasicTarget},{type:Asc.c_oAscSmartArtTypes.CycleMatrix,tip:this.textCycleMatrix},{type:Asc.c_oAscSmartArtTypes.BasicPie,tip:this.textBasicPie},{type:Asc.c_oAscSmartArtTypes.BasicVenn,tip:this.textBasicVenn},{type:Asc.c_oAscSmartArtTypes.LinearVenn,tip:this.textLinearVenn},{type:Asc.c_oAscSmartArtTypes.StackedVenn,tip:this.textStackedVenn},{type:Asc.c_oAscSmartArtTypes.RadialVenn,tip:this.textRadialVenn},{type:Asc.c_oAscSmartArtTypes.InterconnectedRings,tip:this.textInterconnectedRings}]},{id:"menu-smart-art-group-matrix",sectionId:Asc.c_oAscSmartArtSectionNames.Matrix,caption:this.textMatrix,icon:"btn-smart-matrix",items:[{type:Asc.c_oAscSmartArtTypes.BasicMatrix,tip:this.textBasicMatrix},{type:Asc.c_oAscSmartArtTypes.TitledMatrix,tip:this.textTitledMatrix},{type:Asc.c_oAscSmartArtTypes.GridMatrix,tip:this.textGridMatrix},{type:Asc.c_oAscSmartArtTypes.CycleMatrix,tip:this.textCycleMatrix}]},{id:"menu-smart-art-group-pyramid",sectionId:Asc.c_oAscSmartArtSectionNames.Pyramid,caption:this.textPyramid,icon:"btn-smart-pyramid",items:[{type:Asc.c_oAscSmartArtTypes.BasicPyramid,tip:this.textBasicPyramid},{type:Asc.c_oAscSmartArtTypes.InvertedPyramid,tip:this.textInvertedPyramid},{type:Asc.c_oAscSmartArtTypes.PyramidList,tip:this.textPyramidList},{type:Asc.c_oAscSmartArtTypes.SegmentedPyramid,tip:this.textSegmentedPyramid}]},{id:"menu-smart-art-group-picture",sectionId:Asc.c_oAscSmartArtSectionNames.Picture,caption:this.textPicture,icon:"btn-menu-image",items:[{type:Asc.c_oAscSmartArtTypes.AccentedPicture,tip:this.textAccentedPicture},{type:Asc.c_oAscSmartArtTypes.CircularPictureCallout,tip:this.textCircularPictureCallout},{type:Asc.c_oAscSmartArtTypes.PictureCaptionList,tip:this.textPictureCaptionList},{type:Asc.c_oAscSmartArtTypes.RadialPictureList,tip:this.textRadialPictureList},{type:Asc.c_oAscSmartArtTypes.SnapshotPictureList,tip:this.textSnapshotPictureList},{type:Asc.c_oAscSmartArtTypes.SpiralPicture,tip:this.textSpiralPicture},{type:Asc.c_oAscSmartArtTypes.CaptionedPictures,tip:this.textCaptionedPictures},{type:Asc.c_oAscSmartArtTypes.BendingPictureCaption,tip:this.textBendingPictureCaption},{type:Asc.c_oAscSmartArtTypes.PictureFrame,tip:this.textPictureFrame},{type:Asc.c_oAscSmartArtTypes.BendingPictureSemiTransparentText,tip:this.textBendingPictureSemiTranparentText},{type:Asc.c_oAscSmartArtTypes.BendingPictureBlocks,tip:this.textBendingPictureBlocks},{type:Asc.c_oAscSmartArtTypes.BendingPictureCaptionList,tip:this.textBendingPictureCaptionList},{type:Asc.c_oAscSmartArtTypes.TitledPictureBlocks,tip:this.textTitledPictureBlocks},{type:Asc.c_oAscSmartArtTypes.PictureGrid,tip:this.textPictureGrid},{type:Asc.c_oAscSmartArtTypes.PictureAccentBlocks,tip:this.textPictureAccentBlocks},{type:Asc.c_oAscSmartArtTypes.PictureStrips,tip:this.textPictureStrips},{type:Asc.c_oAscSmartArtTypes.ThemePictureAccent,tip:this.textThemePictureAccent},{type:Asc.c_oAscSmartArtTypes.ThemePictureGrid,tip:this.textThemePictureGrid},{type:Asc.c_oAscSmartArtTypes.ThemePictureAlternatingAccent,tip:this.textThemePictureAlternatingAccent},{type:Asc.c_oAscSmartArtTypes.TitledPictureAccentList,tip:this.textTitledPictureAccentList},{type:Asc.c_oAscSmartArtTypes.AlternatingPictureBlocks,tip:this.textAlternatingPictureBlocks},{type:Asc.c_oAscSmartArtTypes.AscendingPictureAccentProcess,tip:this.textAscendingPictureAccentProcess},{type:Asc.c_oAscSmartArtTypes.AlternatingPictureCircles,tip:this.textAlternatingPictureCircles},{type:Asc.c_oAscSmartArtTypes.TitlePictureLineup,tip:this.textTitlePictureLineup},{type:Asc.c_oAscSmartArtTypes.PictureLineup,tip:this.textPictureLineup},{type:Asc.c_oAscSmartArtTypes.FramedTextPicture,tip:this.textFramedTextPicture},{type:Asc.c_oAscSmartArtTypes.HexagonCluster,tip:this.textHexagonCluster},{type:Asc.c_oAscSmartArtTypes.BubblePictureList,tip:this.textBubblePictureList},{type:Asc.c_oAscSmartArtTypes.CirclePictureHierarchy,tip:this.textCirclePictureHierarchy},{type:Asc.c_oAscSmartArtTypes.HorizontalPictureList,tip:this.textHorizontalPictureList},{type:Asc.c_oAscSmartArtTypes.ContinuousPictureList,tip:this.textContinuousPictureList},{type:Asc.c_oAscSmartArtTypes.VerticalPictureList,tip:this.textVerticalPictureList},{type:Asc.c_oAscSmartArtTypes.VerticalPictureAccentList,tip:this.textVerticalPictureAccentList},{type:Asc.c_oAscSmartArtTypes.BendingPictureAccentList,tip:this.textBendingPictureAccentList},{type:Asc.c_oAscSmartArtTypes.PictureAccentList,tip:this.textPictureAccentList},{type:Asc.c_oAscSmartArtTypes.PictureAccentProcess,tip:this.textPictureAccentProcess}]},{id:"menu-smart-art-group-other",sectionId:Asc.c_oAscSmartArtSectionNames.OfficeCom,caption:this.textOther,items:[{type:Asc.c_oAscSmartArtTypes.PictureOrganizationChart,tip:this.textPictureOrganizationChart},{type:Asc.c_oAscSmartArtTypes.ChevronAccentProcess,tip:this.textChevronAccentProcess},{type:Asc.c_oAscSmartArtTypes.RadialPictureList,tip:this.textRadialPictureList},{type:Asc.c_oAscSmartArtTypes.VerticalBracketList,tip:this.textVerticalBracketList},{type:Asc.c_oAscSmartArtTypes.InterconnectedBlockProcess,tip:this.textInterconnectedBlockProcess},{type:Asc.c_oAscSmartArtTypes.TabbedArc,tip:this.textTabbedArc},{type:Asc.c_oAscSmartArtTypes.ThemePictureAccent,tip:this.textThemePictureAccent},{type:Asc.c_oAscSmartArtTypes.VaryingWidthList,tip:this.textVaryingWidthList},{type:Asc.c_oAscSmartArtTypes.ConvergingText,tip:this.textConvergingText},{type:Asc.c_oAscSmartArtTypes.InterconnectedRings,tip:this.textInterconnectedRings},{type:Asc.c_oAscSmartArtTypes.ArchitectureLayout,tip:this.textArchitectureLayout},{type:Asc.c_oAscSmartArtTypes.ThemePictureAlternatingAccent,tip:this.textThemePictureAlternatingAccent},{type:Asc.c_oAscSmartArtTypes.ThemePictureGrid,tip:this.textThemePictureGrid},{type:Asc.c_oAscSmartArtTypes.CircleProcess,tip:this.textCircleProcess},{type:Asc.c_oAscSmartArtTypes.HexagonRadial,tip:this.textHexagonRadial},{type:Asc.c_oAscSmartArtTypes.PictureFrame,tip:this.textPictureFrame},{type:Asc.c_oAscSmartArtTypes.TabList,tip:this.textTabList}]}]}}},Common.define.smartArt||{})}),define("text!documenteditor/main/app/template/Toolbar.template",[],function(){return'<div class="toolbar">\n    <div class="box-tabs">\n        <div class="extra left"></div>\n        <%= tabsmarkup %>\n        <div class="extra right"></div>\n    </div>\n    <section class="box-controls">\n        <section class="panel static">\n            <div class="group no-mask small">\n                <div class="elset">\n                    <span class="btn-slot" id="slot-btn-save" data-layout-name="toolbar-save"></span>\n                </div>\n                <div class="elset">\n                    <span class="btn-slot" id="slot-btn-print"></span>\n                </div>\n            </div>\n            <div class="separator long"></div>\n            <div class="group small">\n                <div class="elset">\n                    <span class="btn-slot split" id="slot-btn-copy"></span>\n                    <span class="btn-slot" id="slot-btn-paste"></span>\n                </div>\n                <div class="elset">\n                    <span class="btn-slot split" id="slot-btn-undo"></span>\n                    <span class="btn-slot" id="slot-btn-redo"></span>\n                </div>\n            </div>\n            <div class="group small">\n                <div class="elset">\n                    <span class="btn-slot" id="slot-btn-cut"></span>\n                </div>\n                <div class="elset">\n                    <span class="btn-slot" id="slot-btn-copystyle"></span>\n                </div>\n            </div>\n            <div class="separator long"></div>\n        </section>\n        <section class="box-panels">\n            <section class="panel" data-tab="home">\n                <div class="group small">\n                    <div class="elset" style="width:208px;">\n                        <span class="btn-slot float-left" id="slot-field-fontname"></span>\n                        <span class="btn-slot margin-left-2 float-left" id="slot-field-fontsize"></span>\n                        <span class="btn-slot margin-left-2" id="slot-btn-incfont"></span>\n                        <span class="btn-slot margin-left-2" id="slot-btn-decfont"></span>\n                        <span class="btn-slot margin-left-2 split" id="slot-btn-changecase"></span>\n                    </div>\n                    <div class="elset font-attr">\n                        <span class="btn-slot" id="slot-btn-bold"></span>\n                        <span class="btn-slot" id="slot-btn-italic"></span>\n                        <span class="btn-slot" id="slot-btn-underline"></span>\n                        <span class="btn-slot" id="slot-btn-strikeout"></span>\n                        <span class="btn-slot" id="slot-btn-superscript"></span>\n                        <span class="btn-slot" id="slot-btn-subscript"></span>\n                        <span class="btn-slot split" id="slot-btn-highlight"></span>\n                        <span class="btn-slot split" id="slot-btn-fontcolor"></span>\n                    </div>\n                </div>\n                <div class="separator long"></div>\n                <div class="group small">\n                    <div class="elset">\n                        <span class="btn-slot split" id="slot-btn-markers"></span>\n                        <span class="btn-slot split" id="slot-btn-numbering"></span>\n                        <span class="btn-slot split" id="slot-btn-multilevels"></span>\n                        <span class="btn-slot split" id="slot-btn-decoffset"></span>\n                        <span class="btn-slot split" id="slot-btn-incoffset"></span>\n                        <span class="btn-slot split" id="slot-btn-linespace"></span>\n                    </div>\n                    <div class="elset">\n                        <span class="btn-slot split" id="<% if (!isRTL) { %>slot-btn-align-left<% } else { %>slot-btn-align-right<% } %>"></span>\n                        <span class="btn-slot split" id="slot-btn-align-center"></span>\n                        <span class="btn-slot split" id="<% if (!isRTL) { %>slot-btn-align-right<% } else { %>slot-btn-align-left<% } %>"></span>\n                        <span class="btn-slot split" id="slot-btn-align-just"></span>\n                        <span class="btn-slot split" id="slot-btn-hidenchars"></span>\n                        <span class="btn-slot split" id="slot-btn-paracolor"></span>\n                    </div>\n                </div>\n                <div class="separator long"></div>\n                <div class="group small">\n                    <div class="elset">\n                        <span class="btn-slot split" id="slot-btn-clearstyle"></span>\n                        <span class="btn-slot split" id="slot-btn-colorschemas"></span>\n                    </div>\n                    <div class="elset">\n                        <span class="btn-slot split" id="slot-btn-select-all"></span>\n                        <span class="btn-slot split" id="slot-btn-mailrecepients" data-layout-name="toolbar-home-mailmerge"></span>\n                    </div>\n                </div>\n                <div class="separator long invisible"></div>\n                <div class="group small flex field-styles" id="slot-field-styles" style="min-width: 151px;width: 100%; " data-group-width="100%"></div>\n            </section>\n            <section class="panel" data-tab="ins">\n                <div class="group">\n                    <span class="btn-slot text x-huge" id="slot-btn-blankpage"></span>\n                    <span class="btn-slot text x-huge btn-pagebreak"></span>\n                </div>\n                <div class="separator long"></div>\n                <div class="group">\n                    <span class="btn-slot text x-huge" id="slot-btn-instable"></span>\n                </div>\n                <div class="separator long"></div>\n                <div class="group">\n                    <span class="btn-slot text x-huge" id="slot-btn-insimage"></span>\n                    <span class="btn-slot text x-huge" id="slot-btn-insshape"></span>\n                    <span class="btn-slot text x-huge" id="slot-btn-inssmartart"></span>\n                    <span class="btn-slot text x-huge" id="slot-btn-inschart"></span>\n                </div>\n                <div class="separator long"></div>\n                <div class="group">\n                    <span class="btn-slot text x-huge slot-comment"></span>\n                    <span class="btn-slot text x-huge slot-inshyperlink"></span>\n                </div>\n                <div class="separator long"></div>\n                <div class="group">\n                    <span class="btn-slot text x-huge" id="slot-btn-editheader"></span>\n                    <span class="btn-slot text x-huge" id="slot-btn-datetime"></span>\n                </div>\n                <div class="separator long"></div>\n                <div class="group">\n                    <span class="btn-slot text x-huge" id="slot-btn-instext"></span>\n                    <span class="btn-slot text x-huge" id="slot-btn-instextart"></span>\n                </div>\n                <div class="separator long"></div>\n                <div class="group">\n                    <span class="btn-slot text x-huge" id="slot-btn-insequation"></span>\n                    <span class="btn-slot text x-huge" id="slot-btn-inssymbol"></span>\n                </div>\n                <div class="separator long"></div>\n                <div class="group">\n                    <span class="btn-slot text x-huge" id="slot-btn-dropcap"></span>\n                </div>\n                <div class="separator long"></div>\n                <div class="group">\n                    <span class="btn-slot text x-huge" id="slot-btn-controls"></span>\n                </div>\n            </section>\n            <section class="panel" data-tab="layout">\n                <div class="group">\n                    <span class="btn-slot text x-huge" id="slot-btn-pagemargins"></span>\n                    <span class="btn-slot text x-huge" id="slot-btn-pageorient"></span>\n                    <span class="btn-slot text x-huge" id="slot-btn-pagesize"></span>\n                    <span class="btn-slot text x-huge" id="slot-btn-columns"></span>\n                    <span class="btn-slot text x-huge btn-pagebreak"></span>\n                    <span class="btn-slot text x-huge" id="slot-btn-line-numbers"></span>\n                </div>\n                <div class="separator long"></div>\n                <div class="group">\n                    <span class="btn-slot text x-huge" id="slot-img-wrapping"></span>\n                    <span class="btn-slot text x-huge" id="slot-img-movefrwd"></span>\n                    <span class="btn-slot text x-huge" id="slot-img-movebkwd"></span>\n                    <span class="btn-slot text x-huge" id="slot-img-align"></span>\n                    <span class="btn-slot text x-huge" id="slot-img-group"></span>\n                </div>\n                <div class="separator long"></div>\n                <div class="group">\n                    <span class="btn-slot text x-huge" id="slot-btn-watermark"></span>\n                    <span class="btn-slot text x-huge" id="slot-btn-pagecolor"></span>\n                </div>\n                <div class="separator long"></div>\n                <div class="group">\n                    <span class="btn-slot text x-huge" id="slot-btn-colorschemas"></span>\n                </div>\n            </section>\n            <section class="panel" data-tab="links">\n                <div class="group">\n                    <span class="btn-slot text x-huge btn-contents"></span>\n                </div>\n                <div class="group small">\n                    <div class="elset">\n                        <span class="btn-slot text" id="slot-btn-add-text"></span>\n                    </div>\n                    <div class="elset">\n                        <span class="btn-slot text" id="slot-btn-contents-update"></span>\n                    </div>\n                </div>\n                <div class="separator long"></div>\n                <div class="group">\n                    <span class="btn-slot text x-huge slot-notes"></span>\n                </div>\n                <div class="separator long"></div>\n                <div class="group">\n                    <span class="btn-slot text x-huge slot-inshyperlink"></span>\n                    <span class="btn-slot text x-huge" id="slot-btn-bookmarks"></span>\n                </div>\n                <div class="separator long"></div>\n                <div class="group">\n                    <span class="btn-slot text x-huge" id="slot-btn-caption"></span>\n                    <span class="btn-slot text x-huge" id="slot-btn-crossref"></span>\n                </div>\n                <div class="group sheet-views small">\n                    <div class="elset">\n                        <span class="btn-slot text" id="slot-btn-tof"></span>\n                    </div>\n                    <div class="elset">\n                        <span class="btn-slot text" id="slot-btn-tof-update"></span>\n                    </div>\n                </div>\n            </section>\n        </section>\n    </section>\n</div>'}),define("text!documenteditor/main/app/template/ToolbarView.template",[],function(){return'<div class="toolbar toolbar-view">\n    <div class="box-tabs">\n        <div class="extra left"></div>\n        <%= tabsmarkup %>\n        <div class="extra right">\n        </div>\n    </div>\n    <section class="box-controls">\n        <section class="box-panels">\n        </section>\n    </section>\n</div>'}),void 0===Common&&(Common={}),Common.Models=Common.Models||{},define("common/main/lib/model/Font",["backbone"],function(t){"use strict";Common.Models.Font=t.Model.extend({defaults:function(){return{id:Common.UI.getId(),name:null,cloneid:null,imgidx:0,type:0}}})}),void 0===Common&&(Common={}),Common.Collections=Common.Collections||{},define("common/main/lib/collection/Fonts",["backbone","common/main/lib/model/Font"],function(t){"use strict";Common.Collections.Fonts=t.Collection.extend({model:Common.Models.Font})}),void 0===Common&&(Common={}),define("common/main/lib/component/ColorPalette",["common/main/lib/component/BaseView"],function(){"use strict";Common.UI.ColorPalette=Common.UI.BaseView.extend({options:{allowReselect:!0,cls:"",style:""},template:_.template(['<div class="palette-color">',"<% _.each(colors, function(color, index) { %>",'<span class="color-item" data-color="<%= color %>" style="background-color: #<%= color %>;"></span>',"<% }) %>","</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);this.id=this.options.id,this.cls=this.options.cls,this.style=this.options.style,this.colors=this.options.colors||[],this.value=this.options.value,this.options.el&&this.render()},render:function(t){return this.rendered?this.cmpEl=this.$el||$(this.el):(this.cmpEl=$(this.template({id:this.id,cls:this.cls,style:this.style,colors:this.colors})),(t?(this.setElement(t,!1),t):this.$el).html(this.cmpEl)),this.rendered||this.cmpEl.on("click","span.color-item",this.itemClick.bind(this)),this.rendered=!0,this},itemClick:function(t){t=$(t.target);this.select(t.attr("data-color"))},select:function(t,e){this.value!=t&&($("span.color-item",this.cmpEl).removeClass("selected"),(this.value=t)&&/#?[a-fA-F0-9]{6}/.test(t)&&(t=/#?([a-fA-F0-9]{6})/.exec(t)[1].toUpperCase(),$("span[data-color="+t+"]",this.cmpEl).addClass("selected"),e||this.trigger("select",this,this.value)))}})}),void 0===Common&&(Common={}),define("common/main/lib/component/DimensionPicker",["common/main/lib/component/BaseView"],function(){"use strict";Common.UI.DimensionPicker=Common.UI.BaseView.extend({options:{itemSize:20,minRows:5,minColumns:5,maxRows:20,maxColumns:20,direction:void 0},template:_.template(['<div style="width: 100%; height: 100%;">','<div dir="ltr" class="dimension-picker-status">0x0</div>','<div class="dimension-picker-observecontainer">','<div class="dimension-picker-mousecatcher"></div>','<div class="dimension-picker-unhighlighted"></div>','<div class="dimension-picker-highlighted"></div>',"</div>","</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);function e(t){var e;e="right"===o.direction&&o.areaMouseCatcher?(e=o.areaMouseCatcher.width(),void 0===t.offsetX?e-t.originalEvent.layerX:(e-t.offsetX)*Common.Utils.zoom()):void 0===t.offsetX?t.originalEvent.layerX:t.offsetX*Common.Utils.zoom(),o.setTableSize(Math.ceil(e/o.itemSize),Math.ceil((void 0===t.offsetY?t.originalEvent.layerY:t.offsetY*Common.Utils.zoom())/o.itemSize),t)}function i(t){o.setTableSize(0,0,t)}function n(t){o.trigger("select",o,o.curColumns,o.curRows,t)}var o=this,t=(this.render(),this.cmpEl=o.$el||$(this.el),this.cmpEl);o.itemSize=o.options.itemSize,o.minRows=o.options.minRows,o.minColumns=o.options.minColumns,o.maxRows=o.options.maxRows,o.maxColumns=o.options.maxColumns,o.direction=o.options.direction,Common.UI.isRTL()&&!o.direction&&(o.direction="right"),o.curColumns=0,o.curRows=0;t&&(o.areaMouseCatcher=t.find(".dimension-picker-mousecatcher"),o.areaUnHighLighted=t.find(".dimension-picker-unhighlighted"),o.areaHighLighted=t.find(".dimension-picker-highlighted"),o.areaStatus=t.find(".dimension-picker-status"),t.css({width:o.minColumns+"em"}),o.areaMouseCatcher.css("z-index",1),o.areaMouseCatcher.width(o.maxColumns+"em").height(o.maxRows+"em"),o.areaUnHighLighted.width(o.minColumns+"em").height(o.minRows+"em"),o.areaStatus.html(Common.UI.isRTL()?this.curRows+" x "+this.curColumns:this.curColumns+" x "+this.curRows),o.areaStatus.width(o.areaUnHighLighted.width()),o.areaMouseCatcher.on("mousemove",e),o.areaHighLighted.on("mousemove",e),o.areaUnHighLighted.on("mousemove",e),o.areaMouseCatcher.on("mouseleave",i),o.areaHighLighted.on("mouseleave",i),o.areaUnHighLighted.on("mouseleave",i),o.areaMouseCatcher.on("click",n),o.areaHighLighted.on("click",n),o.areaUnHighLighted.on("click",n),"right"===o.direction&&o.areaHighLighted.css({left:"auto",right:"0"}))},render:function(){return(this.$el||$(this.el)).html(this.template()),this},setTableSize:function(t,e,i){t>this.maxColumns&&(t=this.maxColumns),e>this.maxRows&&(e=this.maxRows),this.curColumns==t&&this.curRows==e||(this.curColumns=t,this.curRows=e,this.areaHighLighted.width(this.curColumns+"em").height(this.curRows+"em"),this.areaUnHighLighted.width((this.curColumns<this.minColumns?this.minColumns:this.curColumns+1>this.maxColumns?this.maxColumns:this.curColumns+1)+"em").height((this.curRows<this.minRows?this.minRows:this.curRows+1>this.maxRows?this.maxRows:this.curRows+1)+"em"),this.cmpEl.width(this.areaUnHighLighted.width()),this.areaStatus.html(Common.UI.isRTL()?this.curRows+" x "+this.curColumns:this.curColumns+" x "+this.curRows),this.areaStatus.width(this.areaUnHighLighted.width()),this.trigger("change",this,this.curColumns,this.curRows,i))},getColumnsCount:function(){return this.curColumns},getRowsCount:function(){return this.curRows}})}),void 0===Common&&(Common={}),define("common/main/lib/component/ComboDataView",["common/main/lib/component/BaseView","common/main/lib/component/DataView"],function(){"use strict";Common.UI.ComboDataView=Common.UI.BaseView.extend({options:{id:null,cls:"",style:"",hint:!1,itemWidth:80,itemHeight:40,menuMaxHeight:300,autoWidth:!1,enableKeyEvents:!1,beforeOpenHandler:null,additionalMenuItems:null,showLast:!0,minWidth:-1,dataHint:"",dataHintDirection:"",dataHintOffset:""},template:_.template(['<div id="<%= id %>" class="combo-dataview <%= cls %>" style="<%= style %>">','<div class="view"></div> ','<div class="button"></div> ',"</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t),this.id=this.options.id||Common.UI.getId(),this.cls=this.options.cls,this.style=this.options.style,this.hint=this.options.hint,this.store=this.options.store||new Common.UI.DataViewStore,this.groups=this.options.groups,this.itemWidth=this.options.itemWidth,this.itemHeight=this.options.itemHeight,this.menuMaxHeight=this.options.menuMaxHeight,this.beforeOpenHandler=this.options.beforeOpenHandler,this.showLast=this.options.showLast,this.wrapWidth=0,this.rootWidth=0,this.rootHeight=0,this.rendered=!1,this.needFillComboView=!1,this.minWidth=this.options.minWidth,this.autoWidth=this.initAutoWidth=!Common.Utils.isIE10&&!Common.Utils.isIE11&&this.options.autoWidth,this.delayRenderTips=this.options.delayRenderTips||!1,this.itemTemplate=this.options.itemTemplate||_.template(['<div class="style" id="<%= id %>">','<img src="<%= imageUrl %>" width="'+this.itemWidth+'" height="'+this.itemHeight+'" + <% if(typeof imageUrl === "undefined" || imageUrl===null || imageUrl==="") { %> style="visibility: hidden;" <% } %>/>','<% if (typeof title !== "undefined") {%>','<span class="title"><%= title %></span>',"<% } %>","</div>"].join("")),this.fieldPicker=new Common.UI.DataView({cls:"field-picker",allowScrollbar:!1,itemTemplate:this.itemTemplate,delayRenderTips:this.delayRenderTips}),this.openButton=new Common.UI.Button({cls:"open-menu",menu:new Common.UI.Menu({menuAlign:Common.UI.isRTL()?"tr-tr":"tl-tl",offset:[0,3],items:[{template:_.template('<div class="menu-picker-container"></div>')}].concat(null!=this.options.additionalMenuItems?this.options.additionalMenuItems:[])}),dataHint:this.options.dataHint,dataHintDirection:this.options.dataHintDirection,dataHintOffset:this.options.dataHintOffset}),this.menuPicker=new Common.UI.DataView({cls:"menu-picker",parentMenu:this.openButton.menu,outerMenu:this.options.additionalMenuItems?{menu:this.openButton.menu,index:0}:void 0,restoreHeight:this.menuMaxHeight,style:"max-height: "+this.menuMaxHeight+"px;",enableKeyEvents:this.options.enableKeyEvents,groups:this.groups,store:this.store,itemTemplate:this.itemTemplate,delayRenderTips:this.delayRenderTips}),null!=this.options.additionalMenuItems&&this.openButton.menu.setInnerMenu([{menu:this.menuPicker,index:0}]),setInterval(_.bind(this.checkSize,this),500),this.options.el&&this.render()},render:function(t){var e,i;return this.rendered||((e=this).trigger("render:before",e),e.cmpEl=e.$el||$(e.el),i=e.template({id:e.id,cls:e.cls,style:e.style}),t?(e.setElement(t,!1),e.cmpEl=$(i),t.html(e.cmpEl)):e.cmpEl.html(i),e.rootWidth=e.cmpEl.width(),e.rootHeight=e.cmpEl.height(),e.fieldPicker.render($(".view",e.cmpEl)),e.openButton.render($(".button",e.cmpEl)),e.menuPicker.render($(".menu-picker-container",e.cmpEl)),e.openButton.menu.cmpEl&&e.openButton.menu.cmpEl&&(e.openButton.menu.menuAlignEl=e.cmpEl,e.openButton.menu.cmpEl.css("min-width",e.itemWidth),e.openButton.menu.on("show:before",_.bind(e.onBeforeShowMenu,e)),e.openButton.menu.on("show:after",_.bind(e.onAfterShowMenu,e)),e.openButton.cmpEl.on("hide.bs.dropdown",_.bind(e.onBeforeHideMenu,e)),e.openButton.cmpEl.on("hidden.bs.dropdown",_.bind(e.onAfterHideMenu,e))),e.options.hint&&(e.cmpEl.attr("data-toggle","tooltip"),e.cmpEl.tooltip({title:e.options.hint,placement:e.options.hintAnchor||"cursor"})),e.fieldPicker.on("item:select",_.bind(e.onFieldPickerSelect,e)),e.menuPicker.on("item:select",_.bind(e.onMenuPickerSelect,e)),e.fieldPicker.on("item:click",_.bind(e.onFieldPickerClick,e)),e.menuPicker.on("item:click",_.bind(e.onMenuPickerClick,e)),e.fieldPicker.on("item:contextmenu",_.bind(e.onPickerItemContextMenu,e)),e.menuPicker.on("item:contextmenu",_.bind(e.onPickerItemContextMenu,e)),e.fieldPicker.el.addEventListener("contextmenu",_.bind(e.onPickerComboContextMenu,e),!1),e.menuPicker.el.addEventListener("contextmenu",_.bind(e.onPickerComboContextMenu,e),!1),Common.NotificationCenter.on("more:toggle",_.bind(this.onMoreToggle,this)),e.onResize(),e.rendered=!0,e.trigger("render:after",e)),this.disabled&&this.setDisabled(!!this.disabled),this},onMoreToggle:function(t,e){e&&this.checkSize()},checkSize:function(){var t,e,i;this.cmpEl&&this.cmpEl.is(":visible")&&(this.autoWidth&&0<this.menuPicker.store.length&&((e=this.$el.width())==this.wrapWidth&&!this.needFillComboView||(this.wrapWidth=e,this.autoChangeWidth(),i=(e=this.menuPicker).getSelectedRec(),this.fillComboView(i||e.store.at(0),!!i,!0))),e=(t=this).cmpEl.width(),i=this.cmpEl.height(),e<this.minWidth||this.rootWidth==e&&this.rootHeight==i||(this.rootWidth=e,this.rootHeight=i,setTimeout(function(){t.openButton.menu.cmpEl.outerWidth(),t.rootWidth=t.cmpEl.width()},10),this.onResize()))},onResize:function(){var t,e;this.openButton&&(t=$("button",this.openButton.cmpEl),e=$(".button",this.cmpEl),t&&0<e.width()&&t.css({width:e.width(),height:e.height()}),this.openButton.menu.hide(),(t=this.menuPicker)&&(e=t.getSelectedRec(),this.itemMarginLeft=void 0,this.fillComboView(e||t.store.at(0),!!e,!0),t.onResize())),this.isSuspendEvents||this.trigger("resize",this)},autoChangeWidth:function(){var t,e,i,n,o,s,a,l;this.menuPicker.dataViewItems[0]&&(a=this.$el.width(),t=this.menuPicker.dataViewItems[0].$el,l=this.itemWidth+parseFloat(t.css("padding-left"))+parseFloat(t.css("padding-right"))+2*parseFloat(t.css("border-width")),t=parseFloat(t.css("margin-left"))+parseFloat(t.css("margin-right")),i=this.fieldPicker.$el,e=parseFloat(i.css(Common.UI.isRTL()?"padding-left":"padding-right")),i=parseFloat(i.css("border-width")),n=parseFloat(this.fieldPicker.$el.find(".dataview").css("padding-left"))+parseFloat(this.fieldPicker.$el.find(".dataview").css("padding-right")),o=this.cmpEl,s=parseFloat(o.css("padding-left"))+parseFloat(o.css("padding-right")),(a=Math.floor((a-e-n-2*i-s)/(l+t)))>this.store.length&&(a=this.store.length),a=Math.ceil(10*(a*(l+t)+e+n+2*i+s))/10,l=parseFloat(o.css("max-width")),o.css("width",a=l<a?l:a),this.initAutoWidth&&(this.initAutoWidth=!1,o.css("position","absolute"),o.css("top","50%"),o.css("bottom","50%"),o.css("margin","auto 0")))},onBeforeShowMenu:function(t){var e=this;if(_.isFunction(e.beforeOpenHandler))e.beforeOpenHandler(e,t);else if(e.openButton.menu.cmpEl){var i=0;try{var n=$($(".dropdown-menu .dataview.inner .style",e.cmpEl)[0]),i=n?parseInt(n.css("margin-left"))+parseInt(n.css("margin-right")):0}catch(t){}e.openButton.menu.cmpEl.css({width:Math.round((e.cmpEl.width()+i*e.fieldPicker.store.length)/e.itemWidth-.2)*(e.itemWidth+i),"min-height":this.cmpEl.height()})}e.options.hint&&(n=e.cmpEl.data("bs.tooltip"))&&(void 0===n.dontShow&&(n.dontShow=!0),n.hide()),this.menuPicker.selectedBeforeHideRec=null},onBeforeHideMenu:function(t){if(this.trigger("hide:before",this,t),Common.UI.Scroller.isMouseCapture()&&t.preventDefault(),this.isStylesNotClosable)return!1},onAfterShowMenu:function(t){this.menuPicker.scroller&&this.menuPicker.scroller.update({includePadding:!0,suppressScrollX:!0,alwaysVisibleY:!0})},onAfterHideMenu:function(t,e){this.menuPicker.selectedBeforeHideRec=this.menuPicker.getSelectedRec(),this.showLast?this.menuPicker.showLastSelected():this.menuPicker.deselectAll(),this.trigger("hide:after",this,t,e)},onFieldPickerSelect:function(t,e,i){},onMenuPickerSelect:function(t,e,i,n){this.needFillComboView=this.disabled,this.disabled||!0===n||(this.fillComboView(i,!1),i&&!this.isSuspendEvents&&this.trigger("select",this,i))},onFieldPickerClick:function(t,e,i){this.disabled||(this.isSuspendEvents||this.trigger("click",this,i),this.options.hint&&(i=this.cmpEl.data("bs.tooltip"))&&(void 0===i.dontShow&&(i.dontShow=!0),i.hide()),this.showLast||this.fieldPicker.deselectAll())},onMenuPickerClick:function(t,e,i){this.disabled||this.isSuspendEvents||this.trigger("click",this,i)},onPickerItemContextMenu:function(t,e,i,n){if(!this.disabled)return this.isSuspendEvents||this.trigger("contextmenu",this,i,n),n.preventDefault(),n.stopPropagation(),!1},onPickerComboContextMenu:function(t){this.disabled||this.isSuspendEvents||this.trigger("contextmenu",this,void 0,t)},setDisabled:function(t){var e;this.disabled=t=!!t,this.rendered&&(this.cmpEl.toggleClass("disabled",t),$("button",this.openButton.cmpEl).toggleClass("disabled",t),this.fieldPicker.setDisabled(t),this.needFillComboView&&!t&&(t=this.menuPicker)&&(e=t.getSelectedRec(),this.fillComboView(e||t.store.at(0),!1)))},isDisabled:function(){return this.disabled},fillComboView:function(t,e,i){if(!_.isUndefined(t)&&t instanceof Backbone.Model){this.needFillComboView=!this.isVisible();var n=this,o=n.menuPicker.store,s=$(n.fieldPicker.el);if(o){if(i||!n.fieldPicker.store.findWhere({id:t.get("id")})){void 0!==n.itemMarginLeft||0<(i=!(i=$($(this.menuPicker.el).find(".inner > div:not(.grouped-data):not(.ps-scrollbar-x-rail):not(.ps-scrollbar-y-rail)")[0]))||i.length<1?$($(this.menuPicker.el).find(".inner .group-items-container > div:not(.grouped-data):not(.ps-scrollbar-x-rail):not(.ps-scrollbar-y-rail)")[0]):i).length&&(n.itemMarginLeft=parseInt(i.css("margin-left")),n.itemMarginRight=parseInt(i.css("margin-right")),n.itemPaddingLeft=parseInt(i.css("padding-left")),n.itemPaddingRight=parseInt(i.css("padding-right")),n.itemBorderLeft=parseInt(i.css("border-left-width")),n.itemBorderRight=parseInt(i.css("border-right-width")));i=o.indexOf(t);if(i<0)return;var a=o.length,l=Math.floor(Math.max(s.width(),n.minWidth)/(n.itemWidth+(n.itemMarginLeft||0)+(n.itemMarginRight||0)+(n.itemPaddingLeft||0)+(n.itemPaddingRight||0)+(n.itemBorderLeft||0)+(n.itemBorderRight||0))),r=[];2<s.height()/n.itemHeight&&(l*=Math.floor(s.height()/n.itemHeight));for(var c=i=a-(i=Math.floor(i/l)*l)<l?Math.max(a-l,0):i,d=0;c<a&&d<l;c++,d++)r.push(o.at(c));n.fieldPicker.store.reset(r)}return e&&(s=n.fieldPicker.store.findWhere({id:t.get("id")}))&&(n.suspendEvents(),n.fieldPicker.selectRecord(s,!0),n.resumeEvents()),n.fieldPicker.store.models}}},clearComboView:function(){this.fieldPicker.store.reset([])},selectByIndex:function(t){t<0&&this.fieldPicker.deselectAll(),this.menuPicker.selectByIndex(t)},selectRecord:function(t){t||this.fieldPicker.deselectAll(),this.menuPicker.selectRecord(t)},setItemWidth:function(t){this.itemWidth!=t&&(this.itemWidth=1<Common.Utils.applicationPixelRatio()?t/2:t)},setItemHeight:function(t){this.itemHeight!=t&&(this.itemHeight=1<Common.Utils.applicationPixelRatio()?t/2:t)},removeTips:function(){var t=this.menuPicker;_.each(t.dataViewItems,function(t){t=t.$el.data("bs.tooltip");t&&t.tip().remove()},t)}})}),void 0===Common&&(Common={}),define("common/main/lib/component/SynchronizeTip",["common/main/lib/component/BaseView"],function(){"use strict";Common.UI.SynchronizeTip=Common.UI.BaseView.extend(_.extend({options:{target:$(document.body),text:"",placement:"right-bottom",showLink:!0,showButton:!1,closable:!0},template:_.template(['<div class="synch-tip-root <% if (!!scope.options.extCls) {print(scope.options.extCls + " ");} %><%= scope.placement %>" style="<%= scope.style %>">','<div class="asc-synchronizetip">','<div class="tip-arrow <%= scope.placement %>"></div>',"<div>",'<div class="tip-text"><%= scope.text %></div>',"<% if ( scope.closable ) { %>",'<div class="close"></div>',"<% } %>","</div>","<% if ( scope.showLink ) { %>",'<div class="show-link"><label><%= scope.textLink %></label></div>',"<% } %>","<% if ( scope.showButton ) { %>",'<div class="btn-div"><%= scope.textButton %></div>',"<% } %>","</div>","</div>"].join("")),initialize:function(t){this.textSynchronize+=Common.Utils.String.platformKey("Ctrl+S"),Common.UI.BaseView.prototype.initialize.call(this,t),this.target=this.options.target,this.text=_.isEmpty(this.options.text)?this.textSynchronize:this.options.text,this.textLink=_.isEmpty(this.options.textLink)?this.textDontShow:this.options.textLink,this.placement=this.options.placement,this.showLink=this.options.showLink,this.showButton=this.options.showButton,this.closable=this.options.closable,this.textButton=this.options.textButton||"",this.position=this.options.position,this.style=this.options.style||""},render:function(){return this.cmpEl||(this.cmpEl=$(this.template({scope:this})),$(document.body).append(this.cmpEl),this.cmpEl.find(".close").on("click",_.bind(function(){this.trigger("closeclick")},this)),this.cmpEl.find(".show-link label").on("click",_.bind(function(){this.trigger("dontshowclick")},this)),this.cmpEl.find(".btn-div").on("click",_.bind(function(){this.trigger("buttonclick")},this)),this.closable&&this.cmpEl.addClass("closable")),this.applyPlacement(),this},show:function(){this.cmpEl?(this.applyPlacement(),this.cmpEl.show()):this.render()},hide:function(){this.cmpEl&&this.cmpEl.hide(),this.trigger("hide")},close:function(){this.cmpEl&&this.cmpEl.remove()},applyPlacement:function(){var t,e,i,n,o,s,a=this.target&&0<this.target.length?this.target:$(document.body),l=a.offset();"target"!=this.placement||this.position?this.position&&"object"==typeof this.position?(t=this.position.top,e=this.position.left,i=this.position.bottom,n=this.position.right,void 0!==i||void 0!==t?e=l.left+(a.width()-this.cmpEl.width())/2:t=l.top+(a.height()-this.cmpEl.height())/2,this.cmpEl.css({top:t=void 0!==t?t+"px":"auto",left:e=void 0!==e?e+"px":"auto",right:n=void 0!==n?n+"px":"auto",bottom:i=void 0!==i?i+"px":"auto"})):0<(s=this.placement.split("-")).length&&("top"==(o=s[0])?i=Common.Utils.innerHeight()-l.top:"bottom"==o?t=l.top+a.height():"left"==o?n=Common.Utils.innerWidth()-l.left:"right"==o&&(e=l.left+a.width()),"top"==(o=s[1])?i=Common.Utils.innerHeight()-l.top-a.height()/2:"bottom"==o?(t=l.top+a.height()/2)+(s=this.cmpEl.height())>Common.Utils.innerHeight()&&(t=Common.Utils.innerHeight()-s-10):"left"==o?n=Common.Utils.innerWidth()-l.left-a.width()/2:"right"==o?e=l.left+a.width()/2:void 0!==i||void 0!==t?e=l.left+(a.width()-this.cmpEl.width())/2:t=l.top+(a.height()-this.cmpEl.height())/2,t=void 0!==t?t+"px":"auto",i=void 0!==i?i+"px":"auto",n=void 0!==n?n+"px":"auto",void 0!==e?(e+(s=this.cmpEl.width())>Common.Utils.innerWidth()&&(e=Common.Utils.innerWidth()-s-10),e+="px"):e="auto",this.cmpEl.css({top:t,left:e,right:n,bottom:i})):this.cmpEl.css({top:l.top+5+"px",left:l.left+5+"px"})},isVisible:function(){return this.cmpEl&&this.cmpEl.is(":visible")},textDontShow:"Don't show this message again",textSynchronize:"The document has been changed by another user.<br>Please click to save your changes and reload the updates."},Common.UI.SynchronizeTip||{})),Common.UI.TooltipManager=new function(){function o(t){return a[t]&&!(a[t].name&&Common.localStorage.getItem(a[t].name))}function s(t){if(a[t]){if(o(t)&&(!a[t].prev||!o(a[t].prev))){var e=a[t],i=e.target;if(e.tip&&e.tip.isVisible())return!0;if(!((i="string"==typeof i?$(i):i)&&i.length&&i.is(":visible")))return!1;var n=e.placement;Common.UI.isRTL()&&(n=-1<n.indexOf("right")?n.replace("right","left"):n.replace("left","right")),i.addClass("highlight-tip"),e.tip=new Common.UI.SynchronizeTip({extCls:"colored",style:"min-width:200px;max-width:"+(e.maxwidth||250)+"px;",placement:n,target:i,text:e.text,textHeader:e.header,showLink:!!e.link,textLink:e.link?e.link.text:"",closable:!1!==e.closable,showButton:!1!==e.showButton,automove:!!e.automove}),e.tip.on({buttonclick:function(){e.tip&&e.tip.close(),e.tip=void 0},closeclick:function(){e.tip&&e.tip.close(),e.tip=void 0},dontshowclick:function(){Common.NotificationCenter.trigger("file:help",e.link.src)},close:function(){i.removeClass("highlight-tip"),e.name&&Common.localStorage.setItem(e.name,1),e.callback&&e.callback(),e.next&&s(e.next),delete a[t]}}),e.tip.show()}return!0}}var a={};return{showTip:s,closeTip:function(t,e,i){t=a[t];t&&(i&&(t.next=void 0),t.tip&&t.tip.close(),t.tip=void 0,e&&t.name&&Common.localStorage.setItem(t.name,1))},addTips:function(t){for(var e in t)t.hasOwnProperty(e)&&!Common.localStorage.getItem(t[e].name)&&(a[e]=t[e])},getNeedShow:o}}}),define("common/main/lib/component/Mixtbar",["backbone","common/main/lib/component/BaseView"],function(t){"use strict";function i(){var t=a.scrollLeft();o.toggleClass("disabled",0==t),s.toggleClass("disabled",Math.round(t)==a[0].scrollWidth-a[0].clientWidth)}function e(t,e){$(e.target).hasClass("disabled")||((e=a.scrollLeft())||"right"==t||Common.UI.isRTL()&&"left"==t)&&a.animate({scrollLeft:"left"==t?e-100:e+100},200,i)}function n(t){t.preventDefault(),t=t.deltaX||t.detail||t.deltaY,a.scrollLeft(a.scrollLeft()+60*t),i()}var a,o,s,l,r,c;Common.UI.Mixtbar=Common.UI.BaseView.extend((l={timeout:2e3},r={},{$tabs:void 0,$panels:void 0,isFolded:!(c=[]),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);var e=Common.UI.isRTL()?'<section class="tabs"><a class="scroll right" data-hint="0" data-hint-direction="bottom" data-hint-offset="-7, 0" data-hint-title="R"></a><ul><% for(var i in items) { %><% if (typeof items[i] == "object") { %><li class="ribtab<% if (items[i].haspanel===false) print(" x-lone") %><% if (items[i].extcls) print(\' \' + items[i].extcls) %>"<% if (typeof items[i].layoutname == "string") print(" data-layout-name=" + \' \' +  items[i].layoutname) + \' \' %>><a data-tab="<%= items[i].action %>" data-title="<%= items[i].caption %>" data-hint="0" data-hint-direction="bottom" data-hint-offset="small" <% if (typeof items[i].dataHintTitle !== "undefined") { %> data-hint-title="<%= items[i].dataHintTitle %>" <% } %>><%= items[i].caption %></a></li><% } %><% } %></ul><a class="scroll left" data-hint="0" data-hint-direction="bottom" data-hint-offset="-7, 0" data-hint-title="V"></a></section>':'<section class="tabs"><a class="scroll left" data-hint="0" data-hint-direction="bottom" data-hint-offset="-7, 0" data-hint-title="V"></a><ul><% for(var i in items) { %><% if (typeof items[i] == "object") { %><li class="ribtab<% if (items[i].haspanel===false) print(" x-lone") %><% if (items[i].extcls) print(\' \' + items[i].extcls) %>"<% if (typeof items[i].layoutname == "string") print(" data-layout-name=" + \' \' +  items[i].layoutname) + \' \' %>><a data-tab="<%= items[i].action %>" data-title="<%= items[i].caption %>" data-hint="0" data-hint-direction="bottom" data-hint-offset="small" <% if (typeof items[i].dataHintTitle !== "undefined") { %> data-hint-title="<%= items[i].dataHintTitle %>" <% } %>><%= items[i].caption %></a></li><% } %><% } %></ul><a class="scroll right" data-hint="0" data-hint-direction="bottom" data-hint-offset="-7, 0" data-hint-title="R"></a></section>';this.$layout=$(t.template({tabsmarkup:_.template(e)({items:t.tabs}),isRTL:Common.UI.isRTL()})),r.tabs=t.tabs,$(document.body).on("click",function(t){!this.isFolded||$(t.target).parents(".toolbar, #file-menu-panel").length||l.$bar&&l.$bar.hasClass("expanded")&&this.collapse()}.bind(this)),Common.NotificationCenter.on("tab:visible",_.bind(function(t,e){this.setVisible(t,e)},this)),Common.NotificationCenter.on("tab:resize",_.bind(this.onResizeTabs,this))},afterRender:function(){var t=this;a=t.$(".tabs > ul"),t.$tabs=a.find("> li"),t.$boxpanels=t.$(".box-panels"),t.$panels=t.$boxpanels.find("> .panel"),l.$bar=t.$(".toolbar"),s=t.$(".tabs .scroll.right"),(o=t.$(".tabs .scroll.left")).on("click",e.bind(this,"left")),s.on("click",e.bind(this,"right")),a.on("dblclick","> .ribtab",function(t){t=$(t.currentTarget).find("> a[data-tab]").data("tab"),this.dblclick_el==t&&(this.fireEvent("change:compact",[t]),this.dblclick_el=void 0)}.bind(this)),a.on("click","> .ribtab",t.onTabClick.bind(this)),a.on("mousewheel",n)},isTabActive:function(t){var e=this.$tabs.filter(".active").find("> a");return e.length&&e.data("tab")==t},setFolded:function(t){this.isFolded=t;var e;this.isFolded?(l.$box||(l.$box=this.$el.find(".box-controls")),l.$bar.addClass("folded z-clear").toggleClass("expanded",!1),l.$bar.find(".tabs .ribtab").removeClass("active"),l.$bar.on($.support.transition.end,function(t){l.$bar.hasClass("folded")&&!l.$bar.hasClass("expanded")&&l.$bar.toggleClass("z-clear",!0)}),l.$box.on({mouseleave:function(t){},mouseenter:function(t){}})):(l.$bar.removeClass("folded z-clear"),l.$box.off(),(t=l.$box.find(".panel.active")).length?(e=t.data("tab"),this.$tabs.find("> a[data-tab="+e+"]").parent().toggleClass("active",!0)):(e=this.$tabs.siblings(":not(.x-lone):visible").first().find("> a[data-tab]").data("tab"),this.setTab(e)))},collapse:function(){Common.UI.Menu.Manager.hideAll(),this.isFolded&&l.$bar&&(l.$bar.removeClass("expanded"),l.$bar.find(".tabs .ribtab").removeClass("active"))},expand:function(){l.$bar.removeClass("z-clear"),l.$bar.addClass("expanded")},onResizeTabs:function(t){this.hasTabInvisible()?a.parent().hasClass("short")||(a.parent().addClass("short"),i()):a.parent().hasClass("short")&&a.parent().removeClass("short")},onResize:function(t){this.onResizeTabs(),this.hideMoreBtns(),this.processPanelVisible()},onTabClick:function(t){var e=this,t=$(t.currentTarget),i=t.find("> a[data-tab]").data("tab");t.hasClass("x-lone")?e.isFolded&&e.collapse():t.hasClass("active")?e._timerSetTab||(e.dblclick_el=i,e.isFolded&&(e.collapse(),setTimeout(function(){e.dblclick_el=void 0},500))):(e._timerSetTab=!0,setTimeout(function(){e._timerSetTab=!1},500),e.setTab(i),e.isFolded?e.dblclick_el=i:(e.dblclick_timer&&clearTimeout(e.dblclick_timer),e.dblclick_timer=setTimeout(function(){e.dblclick_el=i,delete e.dblclick_timer},500)))},setTab:function(t){var e;t||(this.isFolded?this.collapse():t=this.lastPanel),t&&(this.$tabs.removeClass("active"),this.$panels.removeClass("active"),this.hideMoreBtns(),(e=this.$panels.filter("[data-tab="+t+"]")).length&&(this.lastPanel=t,e.addClass("active"),this.setMoreButton(t,e),this.processPanelVisible(null,!0,!0)),e.length?this.isFolded&&this.expand():this.isFolded&&this.collapse(),(e=this.$tabs.find("> a[data-tab="+t+"]").parent()).length&&e.addClass("active"),this.fireEvent("tab:active",[t]))},addTab:function(t,e,i){var n=_.template('<li class="ribtab" style="display: none;" <% if (typeof layoutname == "string") print(" data-layout-name=" + \' \' +  layoutname) + \' \' %>><a data-tab="<%= action %>" data-title="<%= caption %>" data-hint="0" data-hint-direction="bottom" data-hint-offset="small" <% if (typeof dataHintTitle !== "undefined") { %> data-hint-title="<%= dataHintTitle %>" <% } %> ><%= caption %></a></li>'),i=(r.tabs[i+1]=t,function t(e){return r.tabs[e]?r.tabs[e].action:t(--e)}(i)),o=this.$tabs||this.$layout.find(".tabs"),s=o.find("a[data-tab="+i+"]");s.length&&(s.parent().after(n(t)),e&&((s=(o=this.$panels||this.$layout.find(".box-panels > .panel")).filter("[data-tab="+i+"]")).length?s.after(e):e.appendTo(this.$layout.find(".box-panels"))),this.$tabs&&(this.$tabs=a.find("> li")),this.$panels&&(this.$panels=this.$el.find(".box-panels > .panel")))},isCompact:function(){return this.isFolded},hasTabInvisible:function(){var t,e,i,n;return!(a.length<1)&&(t=Math.round(a.offset().left),e=Math.round(t+a.width()),!!(i=this.$tabs.filter(Common.UI.isRTL()?":visible:last":":visible:first").get(0))&&(n=i.getBoundingClientRect(),Math.round(n.left)<t||(n=(i=this.$tabs.filter(Common.UI.isRTL()?":visible:first":":visible:last").get(0)).getBoundingClientRect(),Math.round(n.right)>e)))},processPanelVisible:function(h,t,m){var p=this;function e(){var t=h||p.$panels.filter(".active");if(t&&t.length){var e=t.parents(".box-controls").width(),i=(i=t.parents(".box-controls").find(".panel.static").outerWidth())||0,n=t.data(),o=n.rightedge,s=n.buttons,a=n.flex,l=t.find(".more-box");if(0===l.length&&p.setMoreButton(t.attr("data-tab"),t),o=o||t.outerWidth()+i,s||(s=[],_.each(t.find(".btn-slot .x-huge"),function(t){s.push($(t).closest(".btn-slot"))}),n.buttons=s),a||(a=[],_.each(t.find(".group.flex"),function(t){t=$(t);a.push({el:t,width:t.attr("data-group-width")||t.attr("max-width")})}),n.flex=a),e<o){if(!l.is(":visible")){if(0<a.length)for(var r=0;r<a.length;r++){var c=a[r].el,o=t.outerWidth()+i;if(Math.floor(c.outerWidth())>parseInt(c.css("min-width")))return void(n.rightedge=o);c.css("width",c.css("min-width"))}for(r=s.length-1;0<=r;r--){var d=s[r];if(!d.hasClass("compactwidth")&&!d.hasClass("slot-btn-more")&&(d.addClass("compactwidth"),(o=t.outerWidth()+i)<=e))break}n.rightedge=o}p.resizeToolbar(m)}else if(l.is(":visible")&&p.resizeToolbar(m),!l.is(":visible")){for(r=0;r<s.length;r++){d=s[r];if(d.hasClass("compactwidth")&&(d.removeClass("compactwidth"),e<(o=t.outerWidth()+i))){d.addClass("compactwidth"),o=t.outerWidth()+i;break}}if(n.rightedge=o,0<a.length&&t.find(".btn-slot.compactwidth").length<1)for(r=0;r<a.length;r++)(c=a[r]).el.css("width",c.width),n.rightedge=t.get(0).getBoundingClientRect().right}}}p._timer_id&&clearTimeout(p._timer_id),!0===t?e():p._timer_id=setTimeout(function(){delete p._timer_id,e()},100)},setExtra:function(t,e){!e||this.$tabs||("right"==t?this.$layout.find(".extra.right").html(e):"left"==t&&this.$layout.find(".extra.left").html(e))},setVisible:function(t,e){t&&this.$tabs&&(this.$tabs.find("> a[data-tab="+t+"]").parent().css("display",e?"":"none"),this.onResize())},setMoreButton:function(t,e){var i,n=this;c[t]||(i=e.position().top,i=$('<div class="more-box" style="top:'+i+'px;"><div class="separator long" style="position: relative;display: table-cell;"></div><div class="group" style=""><span class="btn-slot text x-huge slot-btn-more"></span></div></div>'),e.append(i),c[t]=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top dropdown-manual",caption:Common.Locale.get("textMoreButton",{name:"Common.Translation",default:"More"}),iconCls:"toolbar__icon btn-more",enableToggle:!0}),c[t].render(i.find(".slot-btn-more")),c[t].on("toggle",function(t,e,i){e?n.onMoreShow(t,i):n.onMoreHide(t,i),Common.NotificationCenter.trigger("more:toggle",t,e)}),e=$('<div class="dropdown-menu more-container" data-tab="'+t+'"><div style="display: inline;"></div></div>'),l.$bar.append(e),c[t].panel=e.find("div")),this.$moreBar=c[t].panel},clearMoreButton:function(t){var e,i=this.$panels.filter("[data-tab="+t+"]");i.length&&((e=i.data()).buttons=e.flex=e.rightedge=e.leftedge=void 0,i.find(".more-box").remove()),c[t]&&(l.$bar.find('.more-container[data-tab="'+t+'"]').remove(),c[t].remove(),delete c[t])},resizeToolbar:function(t){var e=this.$panels.filter(".active"),i=e.find(".more-box"),n=(0===i.length&&this.setMoreButton(e.attr("data-tab"),e),parseInt(i.css("width"))||0),o=e.parents(".box-controls").width(),s=o,a=(a=e.parents(".box-controls").find(".panel.static").outerWidth())||0,l=e.outerWidth()+a,r=this._prevBoxWidth?s-this._prevBoxWidth:-1,c=!1;if(this._prevBoxWidth=s,i.is(":visible")&&(s-=n),this.$moreBar&&this.$moreBar.parent().is(":visible")&&this.$moreBar.parent().css("max-width",Common.Utils.innerWidth()),(t||r<0)&&s<l){i.is(":visible")||(i.css("display","block"),s-=parseInt(i.css("width")));var d=null,h=null;0<(y=this.$moreBar.children().filter("[data-hidden-tb-item!=true]")).length&&((y=$(y[0])).hasClass("separator")&&(d=y),y.hasClass("group")&&"open"==y.attr("group-state")&&(h=y));for(var m=!1,p=(x=e.find("> div:not(.more-box)")).length-1;0<=p;p--)if((T=$(x[p])).is(":visible")||T.attr("hidden-on-resize"))if(T.hasClass("group")){if((l=e.outerWidth()+a)<=s)break;var u=T.get(0).getBoundingClientRect(),g=T.outerWidth(),b=T.children();if(!T.attr("inner-width")&&"open"!==T.attr("group-state")){T.attr("inner-width",g);for(var C=b.length-1;0<=C;C--)(k=$(b[C])).attr("inner-width",k.outerWidth())}if((u.left>s||Common.UI.isRTL()&&o-u.right>s||1==b.length)&&"open"!=T.attr("group-state"))this.$moreBar.prepend(T),d&&(d.css("display",""),d.removeAttr("hidden-on-resize")),c=!0;else{if(!((Common.UI.isRTL()?o-u.right:u.left)+g>s))break;for(C=b.length-1;0<=C;C--){if((k=$(b[C])).hasClass("elset")){this.$moreBar.prepend(T),d&&(d.css("display",""),d.removeAttr("hidden-on-resize")),c=!0;break}var f=k.get(0).getBoundingClientRect(),v=k.outerWidth();if(!((Common.UI.isRTL()?o-f.right:f.left)+v>s)){m=!0;break}if(!h){(h=$("<div></div>")).addClass(x[p].className);for(var _=x[p].attributes,w=0;w<_.length;w++)h.attr(_[w].name,_[w].value);this.$moreBar.prepend(h),d&&(d.css("display",""),d.removeAttr("hidden-on-resize"))}h.prepend(k),c=!0}if(T.children().length<1?(T.remove(),h&&h.removeAttr("group-state").attr("inner-width",T.attr("inner-width")),h=null):h&&h.attr("group-state","open")&&T.attr("group-state","open"),m)break}d=null}else T.hasClass("separator")&&(this.$moreBar.prepend(T),T.css("display","none"),T.attr("hidden-on-resize",!0),d=T,c=!0);else T.attr("data-hidden-tb-item",!0),this.$moreBar.prepend(T),c=!0}else if((t||0<r)&&i.is(":visible")){var y,x,d=null,h=null,S=0;if(0<(y=e.find("> div:not(.more-box)")).length&&((y=$(y[y.length-1])).hasClass("separator")&&(d=y,S=parseInt(d.css("margin-left"))+parseInt(d.css("margin-right"))+1),y.hasClass("group")&&"open"==y.attr("group-state")&&(h=y)),0<(x=this.$moreBar.children()).length)for(p=0;p<x.length;p++){var T=$(x[p]);if(l=e.outerWidth()+a,!T.is(":visible")&&T.attr("data-hidden-tb-item"))T.removeAttr("data-hidden-tb-item"),i.before(T),0==this.$moreBar.children().filter(".group").length&&(this.hideMoreBtns(),i.css("display","none"));else if(T.hasClass("group")){var A=!1;if(1==this.$moreBar.children().filter(".group").length&&(s=o,A=!0),l+S+(g=parseInt(T.attr("inner-width")||0))<s&&"open"!=T.attr("group-state"))i.before(T),d&&(d.css("display",""),d.removeAttr("hidden-on-resize")),0==this.$moreBar.children().filter(".group").length&&(this.hideMoreBtns(),i.css("display","none")),c=!0;else{if(!(l+S<s))break;for(b=T.children(),s=o-n,C=0;C<b.length;C++){A&&C==b.length-1&&(s=o);var k,l=e.outerWidth()+a;if((k=$(b[C])).hasClass("elset")){m=!0;break}if(!(l+S+(v=parseInt(k.attr("inner-width")||0)+(h?0:parseInt(T.css("padding-left"))))<s)){m=!0;break}if(!h){(h=$("<div></div>")).addClass(x[p].className);for(_=x[p].attributes,w=0;w<_.length;w++)h.attr(_[w].name,_[w].value);h.hasClass("flex")&&(e.data().flex=null),i.before(h),d&&(d.css("display",""),d.removeAttr("hidden-on-resize"))}h.append(k),c=!0}if(T.children().length<1?(T.remove(),h&&h.removeAttr("group-state").attr("inner-width",T.attr("inner-width")),h=null,0==this.$moreBar.children().filter(".group").length&&(this.hideMoreBtns(),i.css("display","none"))):h&&h.attr("group-state","open")&&T.attr("group-state","open"),m)break}d=null,S=0}else T.hasClass("separator")&&(i.before(T),T.css("display","none"),T.attr("hidden-on-resize",!0),d=T,S=parseInt(d.css("margin-left"))+parseInt(d.css("margin-right"))+1,c=!0)}else this.hideMoreBtns(),i.css("display","none")}c&&Common.UI.Menu.Manager.hideAll()},onMoreHide:function(t,e){var i=t.panel.parent();t.pressed&&t.toggle(!1,!0),i.is(":visible")&&(i.hide(),Common.NotificationCenter.trigger("edit:complete",this.toolbar,t))},onMoreShow:function(t,e){var i=t.panel.parent(),n=i.parent().offset(),t=t.$el,o=t.offset(),s=Common.Utils.innerWidth()-(o.left-n.left+t.width()),o=o.top-n.top+t.height()+10,n=Common.UI.isRTL()?{left:"6px",right:"auto",top:o,"max-width":Common.Utils.innerWidth()+"px"}:{right:s,left:"auto",top:o,"max-width":Common.Utils.innerWidth()+"px"};i.css(n),i.show()},hideMoreBtns:function(){for(var t in c)c[t]&&c[t].isActive()&&c[t].toggle(!1)}}))}),void 0===Common&&(Common={}),define("documenteditor/main/app/view/Toolbar",["jquery","underscore","backbone","text!documenteditor/main/app/template/Toolbar.template","text!documenteditor/main/app/template/ToolbarView.template","common/main/lib/collection/Fonts","common/main/lib/component/Button","common/main/lib/component/ComboBox","common/main/lib/component/DataView","common/main/lib/component/ColorPalette","common/main/lib/component/ThemeColorPalette","common/main/lib/component/Menu","common/main/lib/component/DimensionPicker","common/main/lib/component/Window","common/main/lib/component/ComboBoxFonts","common/main/lib/component/ComboDataView","common/main/lib/component/SynchronizeTip","common/main/lib/component/Mixtbar"],function(b,C,t,l,r){"use strict";Common.enumLock||(Common.enumLock={});var e,i={undoLock:"can-undo",redoLock:"can-redo",copyLock:"can-copy",paragraphLock:"para-lock",headerLock:"header-lock",headerFooterLock:"header-footer-lock",chartLock:"chart-lock",imageLock:"image-lock",richEditLock:"rich-edit-lock",plainEditLock:"plain-edit-lock",richDelLock:"rich-del-lock",plainDelLock:"plain-del-lock",contentLock:"content-lock",mmergeLock:"mmerge-lock",dropcapLock:"dropcap-lock",docPropsLock:"doc-props-lock",docSchemaLock:"doc-schema-lock",hyperlinkLock:"can-hyperlink",inSmartart:"in-smartart",inSmartartInternal:"in-smartart-internal",inSpecificForm:"in-specific-form",inChart:"in-chart",inEquation:"in-equation",inHeader:"in-header",inImage:"in-image",inImagePara:"in-image-para",inImageInline:"in-image-inline",inFootnote:"in-footnote",inControl:"in-control",inLightTheme:"light-theme",controlPlain:"control-plain",noParagraphSelected:"no-paragraph",cantAddTable:"cant-add-table",cantAddQuotedComment:"cant-add-quoted-comment",cantPrint:"cant-print",cantAddImagePara:"cant-add-image-para",cantAddEquation:"cant-add-equation",cantAddChart:"cant-add-chart",cantAddPageNum:"cant-add-page-num",cantPageBreak:"cant-page-break",cantUpdateTOF:"cant-update-tof",cantAddTextTOF:"cant-addtext-tof",cantGroup:"cant-group",cantWrap:"cant-wrap",cantArrange:"cant-arrange",noObjectSelected:"no-object",lostConnect:"disconnect",disableOnStart:"on-start",complexForm:"complex-form",formsNoRoles:"no-roles",fixedForm:"fixed-form"};for(e in i)i.hasOwnProperty(e)&&(Common.enumLock[e]=i[e]);DE.Views.Toolbar=Common.UI.Mixtbar.extend(C.extend({el:"#toolbar",events:{},initialize:function(){return this.SchemeNames=[this.txtScheme22,this.txtScheme1,this.txtScheme2,this.txtScheme3,this.txtScheme4,this.txtScheme5,this.txtScheme6,this.txtScheme7,this.txtScheme8,this.txtScheme9,this.txtScheme10,this.txtScheme11,this.txtScheme12,this.txtScheme13,this.txtScheme14,this.txtScheme15,this.txtScheme16,this.txtScheme17,this.txtScheme18,this.txtScheme19,this.txtScheme20,this.txtScheme21],this.paragraphControls=[],this.toolbarControls=[],this.textOnlyControls=[],this._state={hasCollaborativeChanges:void 0,previewmode:!1},Common.NotificationCenter.on("app:ready",this.onAppReady.bind(this)),this},applyLayout:function(t){var n,e,i,o,s=this,a=(s.lockControls=[],Common.enumLock);return t.isEdit?(Common.UI.Mixtbar.prototype.initialize.call(this,{template:C.template(l),tabs:[{caption:s.textTabFile,action:"file",extcls:"canedit",layoutname:"toolbar-file",haspanel:!1,dataHintTitle:"F"},{caption:s.textTabHome,action:"home",extcls:"canedit",dataHintTitle:"H"},{caption:s.textTabInsert,action:"ins",extcls:"canedit",dataHintTitle:"I"},{caption:s.textTabLayout,action:"layout",extcls:"canedit",layoutname:"toolbar-layout",dataHintTitle:"L"},{caption:s.textTabLinks,action:"links",extcls:"canedit",layoutname:"toolbar-references",dataHintTitle:"N"}]}),this.btnSaveCls="btn-save",this.btnSaveTip=this.tipSave+Common.Utils.String.platformKey("Ctrl+S"),this.btnPrint=new Common.UI.Button({id:"id-toolbar-btn-print",cls:"btn-toolbar",iconCls:"toolbar__icon btn-print no-mask",lock:[a.cantPrint,a.disableOnStart],signals:["disabled"],split:t.canQuickPrint,menu:t.canQuickPrint,dataHint:"1",dataHintDirection:"bottom",dataHintTitle:"P",printType:"print"}),this.toolbarControls.push(this.btnPrint),this.btnSave=new Common.UI.Button({id:"id-toolbar-btn-save",cls:"btn-toolbar",iconCls:"toolbar__icon no-mask "+this.btnSaveCls,lock:[a.lostConnect,a.disableOnStart],signals:["disabled"],dataHint:"1",dataHintDirection:"top",dataHintTitle:"S"}),this.toolbarControls.push(this.btnSave),this.btnCollabChanges=this.btnSave,this.btnUndo=new Common.UI.Button({id:"id-toolbar-btn-undo",cls:"btn-toolbar",iconCls:"toolbar__icon btn-undo",lock:[a.undoLock,a.previewReviewMode,a.lostConnect,a.disableOnStart,a.docLockView],signals:["disabled"],dataHint:"1",dataHintDirection:"bottom",dataHintTitle:"Z"}),this.toolbarControls.push(this.btnUndo),this.btnRedo=new Common.UI.Button({id:"id-toolbar-btn-redo",cls:"btn-toolbar",iconCls:"toolbar__icon btn-redo",lock:[a.redoLock,a.previewReviewMode,a.lostConnect,a.disableOnStart,a.docLockView],signals:["disabled"],dataHint:"1",dataHintDirection:"bottom",dataHintTitle:"Y"}),this.toolbarControls.push(this.btnRedo),this.btnCopy=new Common.UI.Button({id:"id-toolbar-btn-copy",cls:"btn-toolbar",iconCls:"toolbar__icon btn-copy",lock:[a.copyLock,a.previewReviewMode,a.viewFormMode,a.lostConnect,a.disableOnStart],dataHint:"1",dataHintDirection:"top",dataHintTitle:"C"}),this.toolbarControls.push(this.btnCopy),this.btnPaste=new Common.UI.Button({id:"id-toolbar-btn-paste",cls:"btn-toolbar",iconCls:"toolbar__icon btn-paste",lock:[a.paragraphLock,a.headerLock,a.richEditLock,a.plainEditLock,a.previewReviewMode,a.viewFormMode,a.lostConnect,a.disableOnStart,a.docLockView,a.docLockComments],dataHint:"1",dataHintDirection:"top",dataHintTitle:"V"}),this.paragraphControls.push(this.btnPaste),this.btnCut=new Common.UI.Button({id:"id-toolbar-btn-cut",cls:"btn-toolbar",iconCls:"toolbar__icon btn-cut",lock:[a.copyLock,a.paragraphLock,a.headerLock,a.richEditLock,a.plainEditLock,a.imageLock,a.previewReviewMode,a.viewFormMode,a.lostConnect,a.disableOnStart,a.docLockView,a.docLockComments],dataHint:"1",dataHintDirection:"top",dataHintTitle:"X"}),this.paragraphControls.push(this.btnCut),this.btnSelectAll=new Common.UI.Button({id:"id-toolbar-btn-select-all",cls:"btn-toolbar",iconCls:"toolbar__icon btn-select-all",lock:[a.viewFormMode,a.disableOnStart],dataHint:"1",dataHintDirection:"bottom"}),this.toolbarControls.push(this.btnSelectAll),this.btnIncFontSize=new Common.UI.Button({id:"id-toolbar-btn-incfont",cls:"btn-toolbar",iconCls:"toolbar__icon btn-incfont",lock:[a.paragraphLock,a.headerLock,a.richEditLock,a.plainEditLock,a.previewReviewMode,a.viewFormMode,a.lostConnect,a.disableOnStart,a.docLockView,a.docLockForms,a.docLockComments],dataHint:"1",dataHintDirection:"top"}),this.paragraphControls.push(this.btnIncFontSize),this.btnDecFontSize=new Common.UI.Button({id:"id-toolbar-btn-decfont",cls:"btn-toolbar",iconCls:"toolbar__icon btn-decfont",lock:[a.paragraphLock,a.headerLock,a.richEditLock,a.plainEditLock,a.previewReviewMode,a.viewFormMode,a.lostConnect,a.disableOnStart,a.docLockView,a.docLockForms,a.docLockComments],dataHint:"1",dataHintDirection:"top"}),this.paragraphControls.push(this.btnDecFontSize),this.btnBold=new Common.UI.Button({id:"id-toolbar-btn-bold",cls:"btn-toolbar",iconCls:"toolbar__icon btn-bold",lock:[a.paragraphLock,a.headerLock,a.richEditLock,a.plainEditLock,a.previewReviewMode,a.viewFormMode,a.lostConnect,a.disableOnStart,a.docLockView,a.docLockForms,a.docLockComments],enableToggle:!0,dataHint:"1",dataHintDirection:"bottom"}),this.paragraphControls.push(this.btnBold),this.btnItalic=new Common.UI.Button({id:"id-toolbar-btn-italic",cls:"btn-toolbar",iconCls:"toolbar__icon btn-italic",lock:[a.paragraphLock,a.headerLock,a.richEditLock,a.plainEditLock,a.previewReviewMode,a.viewFormMode,a.lostConnect,a.disableOnStart,a.docLockView,a.docLockForms,a.docLockComments],enableToggle:!0,dataHint:"1",dataHintDirection:"bottom"}),this.paragraphControls.push(this.btnItalic),this.btnUnderline=new Common.UI.Button({id:"id-toolbar-btn-underline",cls:"btn-toolbar",iconCls:"toolbar__icon btn-underline",lock:[a.paragraphLock,a.headerLock,a.richEditLock,a.plainEditLock,a.previewReviewMode,a.viewFormMode,a.lostConnect,a.disableOnStart,a.docLockView,a.docLockForms,a.docLockComments],enableToggle:!0,dataHint:"1",dataHintDirection:"bottom"}),this.paragraphControls.push(this.btnUnderline),this.btnStrikeout=new Common.UI.Button({id:"id-toolbar-btn-strikeout",cls:"btn-toolbar",iconCls:"toolbar__icon btn-strikeout",lock:[a.paragraphLock,a.headerLock,a.richEditLock,a.plainEditLock,a.previewReviewMode,a.viewFormMode,a.lostConnect,a.disableOnStart,a.docLockView,a.docLockForms,a.docLockComments],enableToggle:!0,dataHint:"1",dataHintDirection:"bottom"}),this.paragraphControls.push(this.btnStrikeout),this.btnSuperscript=new Common.UI.Button({id:"id-toolbar-btn-superscript",cls:"btn-toolbar",iconCls:"toolbar__icon btn-superscript",lock:[a.paragraphLock,a.headerLock,a.richEditLock,a.plainEditLock,a.inEquation,a.previewReviewMode,a.viewFormMode,a.lostConnect,a.disableOnStart,a.docLockView,a.docLockForms,a.docLockComments],enableToggle:!0,toggleGroup:"superscriptGroup",dataHint:"1",dataHintDirection:"bottom"}),this.paragraphControls.push(this.btnSuperscript),this.btnSubscript=new Common.UI.Button({id:"id-toolbar-btn-subscript",cls:"btn-toolbar",iconCls:"toolbar__icon btn-subscript",lock:[a.paragraphLock,a.headerLock,a.richEditLock,a.plainEditLock,a.inEquation,a.previewReviewMode,a.viewFormMode,a.lostConnect,a.disableOnStart,a.docLockView,a.docLockForms,a.docLockComments],enableToggle:!0,toggleGroup:"superscriptGroup",dataHint:"1",dataHintDirection:"bottom"}),this.paragraphControls.push(this.btnSubscript),this.btnHighlightColor=new Common.UI.ButtonColored({id:"id-toolbar-btn-highlight",cls:"btn-toolbar",iconCls:"toolbar__icon btn-highlight",lock:[a.paragraphLock,a.headerLock,a.richEditLock,a.plainEditLock,a.inChart,a.inSmartart,a.inSmartartInternal,a.previewReviewMode,a.viewFormMode,a.lostConnect,a.disableOnStart,a.docLockView,a.docLockForms,a.docLockComments],enableToggle:!0,allowDepress:!0,split:!0,menu:new Common.UI.Menu({style:"min-width: 100px;",items:[{template:C.template('<div id="id-toolbar-menu-highlight" style="width: 145px; display: inline-block;" class="palette-large"></div>')},{caption:"--"},this.mnuHighlightTransparent=new Common.UI.MenuItem({caption:this.strMenuNoFill,checkable:!0})]}),dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"0, -16"}),this.paragraphControls.push(this.btnHighlightColor),this.btnFontColor=new Common.UI.ButtonColored({id:"id-toolbar-btn-fontcolor",cls:"btn-toolbar",iconCls:"toolbar__icon btn-fontcolor",lock:[a.paragraphLock,a.headerLock,a.richEditLock,a.plainEditLock,a.previewReviewMode,a.viewFormMode,a.lostConnect,a.disableOnStart,a.docLockView,a.docLockForms,a.docLockComments],split:!0,menu:!0,auto:!0,eyeDropper:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"0, -16"}),this.paragraphControls.push(this.btnFontColor),this.btnParagraphColor=new Common.UI.ButtonColored({id:"id-toolbar-btn-paracolor",cls:"btn-toolbar",iconCls:"toolbar__icon btn-paracolor",lock:[a.paragraphLock,a.headerLock,a.richEditLock,a.plainEditLock,a.inChart,a.inSmartart,a.inSmartartInternal,a.previewReviewMode,a.viewFormMode,a.lostConnect,a.disableOnStart,a.docLockView,a.docLockForms,a.docLockComments],split:!0,transparent:!0,menu:!0,eyeDropper:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"0, -16"}),this.paragraphControls.push(this.btnParagraphColor),this.textOnlyControls.push(this.btnParagraphColor),this.btnChangeCase=new Common.UI.Button({id:"id-toolbar-btn-case",cls:"btn-toolbar",iconCls:"toolbar__icon btn-change-case",lock:[a.paragraphLock,a.headerLock,a.richEditLock,a.plainEditLock,a.previewReviewMode,a.viewFormMode,a.lostConnect,a.disableOnStart,a.docLockView,a.docLockForms,a.docLockComments],menu:new Common.UI.Menu({items:[{caption:this.mniSentenceCase,value:Asc.c_oAscChangeTextCaseType.SentenceCase},{caption:this.mniLowerCase,value:Asc.c_oAscChangeTextCaseType.LowerCase},{caption:this.mniUpperCase,value:Asc.c_oAscChangeTextCaseType.UpperCase},{caption:this.mniCapitalizeWords,value:Asc.c_oAscChangeTextCaseType.CapitalizeWords},{caption:this.mniToggleCase,value:Asc.c_oAscChangeTextCaseType.ToggleCase}]}),dataHint:"1",dataHintDirection:"top"}),this.paragraphControls.push(this.btnChangeCase),this.btnAlignLeft=new Common.UI.Button({id:"id-toolbar-btn-align-left",cls:"btn-toolbar",iconCls:"toolbar__icon btn-align-left",lock:[a.paragraphLock,a.headerLock,a.richEditLock,a.plainEditLock,a.previewReviewMode,a.viewFormMode,a.lostConnect,a.disableOnStart,a.docLockView,a.docLockForms,a.docLockComments,a.fixedForm],enableToggle:!0,toggleGroup:"alignGroup",dataHint:"1",dataHintDirection:"bottom"}),this.paragraphControls.push(this.btnAlignLeft),this.btnAlignCenter=new Common.UI.Button({id:"id-toolbar-btn-align-center",cls:"btn-toolbar",iconCls:"toolbar__icon btn-align-center",lock:[a.paragraphLock,a.headerLock,a.richEditLock,a.plainEditLock,a.previewReviewMode,a.viewFormMode,a.lostConnect,a.disableOnStart,a.docLockView,a.docLockForms,a.docLockComments,a.fixedForm],enableToggle:!0,toggleGroup:"alignGroup",dataHint:"1",dataHintDirection:"bottom"}),this.paragraphControls.push(this.btnAlignCenter),this.btnAlignRight=new Common.UI.Button({id:"id-toolbar-btn-align-right",cls:"btn-toolbar",iconCls:"toolbar__icon btn-align-right",lock:[a.paragraphLock,a.headerLock,a.richEditLock,a.plainEditLock,a.previewReviewMode,a.viewFormMode,a.lostConnect,a.disableOnStart,a.docLockView,a.docLockForms,a.docLockComments,a.fixedForm],enableToggle:!0,toggleGroup:"alignGroup",dataHint:"1",dataHintDirection:"bottom"}),this.paragraphControls.push(this.btnAlignRight),this.btnAlignJust=new Common.UI.Button({id:"id-toolbar-btn-align-just",cls:"btn-toolbar",iconCls:"toolbar__icon btn-align-just",lock:[a.paragraphLock,a.headerLock,a.richEditLock,a.plainEditLock,a.previewReviewMode,a.viewFormMode,a.lostConnect,a.disableOnStart,a.docLockView,a.docLockForms,a.docLockComments,a.fixedForm],enableToggle:!0,toggleGroup:"alignGroup",dataHint:"1",dataHintDirection:"bottom"}),this.paragraphControls.push(this.btnAlignJust),this.btnDecLeftOffset=new Common.UI.Button({id:"id-toolbar-btn-decoffset",cls:"btn-toolbar",iconCls:"toolbar__icon btn-decoffset",lock:[a.paragraphLock,a.headerLock,a.richEditLock,a.plainEditLock,a.inSmartartInternal,a.previewReviewMode,a.viewFormMode,a.lostConnect,a.disableOnStart,a.docLockView,a.docLockForms,a.docLockComments,a.fixedForm],dataHint:"1",dataHintDirection:"top"}),this.paragraphControls.push(this.btnDecLeftOffset),this.btnIncLeftOffset=new Common.UI.Button({id:"id-toolbar-btn-incoffset",cls:"btn-toolbar",iconCls:"toolbar__icon btn-incoffset",lock:[a.paragraphLock,a.headerLock,a.richEditLock,a.plainEditLock,a.inSmartartInternal,a.previewReviewMode,a.viewFormMode,a.lostConnect,a.disableOnStart,a.docLockView,a.docLockForms,a.docLockComments,a.fixedForm],dataHint:"1",dataHintDirection:"top"}),this.paragraphControls.push(this.btnIncLeftOffset),this.btnLineSpace=new Common.UI.Button({id:"id-toolbar-btn-linespace",cls:"btn-toolbar",iconCls:"toolbar__icon btn-linespace",lock:[a.paragraphLock,a.headerLock,a.richEditLock,a.plainEditLock,a.previewReviewMode,a.viewFormMode,a.lostConnect,a.disableOnStart,a.docLockView,a.docLockForms,a.docLockComments,a.fixedForm],menu:new Common.UI.Menu({style:"min-width: 60px;",items:[{caption:"1.0",value:1,checkable:!0,toggleGroup:"linesize"},{caption:"1.15",value:1.15,checkable:!0,toggleGroup:"linesize"},{caption:"1.5",value:1.5,checkable:!0,toggleGroup:"linesize"},{caption:"2.0",value:2,checkable:!0,toggleGroup:"linesize"},{caption:"2.5",value:2.5,checkable:!0,toggleGroup:"linesize"},{caption:"3.0",value:3,checkable:!0,toggleGroup:"linesize"}]}),dataHint:"1",dataHintDirection:"top",dataHintOffset:"0, -6"}),this.paragraphControls.push(this.btnLineSpace),this.btnShowHidenChars=new Common.UI.Button({id:"id-toolbar-btn-hidenchars",cls:"btn-toolbar",iconCls:"toolbar__icon btn-paragraph",lock:[a.previewReviewMode,a.viewFormMode,a.lostConnect,a.disableOnStart,a.docLockView,a.docLockForms,a.docLockComments],enableToggle:!0,split:!0,menu:new Common.UI.Menu({style:"min-width: 60px;",items:[{caption:this.mniHiddenChars,value:"characters",checkable:!0},{caption:this.mniHiddenBorders,value:"table",checkable:!0}]}),dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"0, -16"}),this.toolbarControls.push(this.btnShowHidenChars),this.btnMarkers=new Common.UI.Button({id:"id-toolbar-btn-markers",cls:"btn-toolbar",iconCls:"toolbar__icon "+(Common.UI.isRTL()?"btn-setmarkers-rtl":"btn-setmarkers"),lock:[a.paragraphLock,a.headerLock,a.richEditLock,a.plainEditLock,a.inChart,a.inSmartart,a.inSmartartInternal,a.previewReviewMode,a.viewFormMode,a.lostConnect,a.disableOnStart,a.docLockView,a.docLockForms,a.docLockComments,a.fixedForm],enableToggle:!0,toggleGroup:"markersGroup",split:!0,menu:!0,dataHint:"1",dataHintDirection:"top",dataHintOffset:"0, -16"}),this.paragraphControls.push(this.btnMarkers),this.textOnlyControls.push(this.btnMarkers),this.btnNumbers=new Common.UI.Button({id:"id-toolbar-btn-numbering",cls:"btn-toolbar",iconCls:"toolbar__icon "+(Common.UI.isRTL()?"btn-numbering-rtl":"btn-numbering"),lock:[a.paragraphLock,a.headerLock,a.richEditLock,a.plainEditLock,a.inChart,a.inSmartart,a.inSmartartInternal,a.previewReviewMode,a.viewFormMode,a.lostConnect,a.disableOnStart,a.docLockView,a.docLockForms,a.docLockComments,a.fixedForm],enableToggle:!0,toggleGroup:"markersGroup",split:!0,menu:!0,dataHint:"1",dataHintDirection:"top",dataHintOffset:"0, -16"}),this.paragraphControls.push(this.btnNumbers),this.textOnlyControls.push(this.btnNumbers),this.btnMultilevels=new Common.UI.Button({id:"id-toolbar-btn-multilevels",cls:"btn-toolbar",iconCls:"toolbar__icon "+(Common.UI.isRTL()?"btn-multilevels-rtl":"btn-multilevels"),lock:[a.paragraphLock,a.headerLock,a.richEditLock,a.plainEditLock,a.inChart,a.inSmartart,a.inSmartartInternal,a.previewReviewMode,a.viewFormMode,a.lostConnect,a.disableOnStart,a.docLockView,a.docLockForms,a.docLockComments,a.fixedForm],menu:!0,dataHint:"1",dataHintDirection:"top",dataHintOffset:"0, -6"}),this.paragraphControls.push(this.btnMultilevels),this.textOnlyControls.push(this.btnMultilevels),n=function(t){var e,i={};for(e in t)i[e]="object"==typeof t[e]?n(t[e]):t[e];return i},this.mnuMarkersPicker={conf:{index:0},selectByIndex:function(t){this.conf.index=t},deselectAll:function(){this.conf.index=-1}},this.mnuNumbersPicker=n(this.mnuMarkersPicker),this.mnuMultilevelPicker=n(this.mnuMarkersPicker),this.btnInsertTable=new Common.UI.Button({id:"tlbtn-inserttable",cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-inserttable",lock:[a.headerLock,a.richEditLock,a.plainEditLock,a.inEquation,a.controlPlain,a.richDelLock,a.plainDelLock,a.cantAddTable,a.previewReviewMode,a.viewFormMode,a.lostConnect,a.disableOnStart,a.docLockView,a.docLockForms,a.docLockComments],caption:s.capBtnInsTable,menu:new Common.UI.Menu({items:[{template:C.template('<div id="id-toolbar-menu-tablepicker" class="dimension-picker" style="margin: 5px 10px;"></div>')},{caption:this.mniCustomTable,value:"custom"},{caption:this.mniDrawTable,value:"draw",checkable:!0},{caption:this.mniEraseTable,value:"erase",checkable:!0},{caption:this.mniTextToTable,value:"convert"},{caption:this.mniInsertSSE,value:"sse"}]}),dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.paragraphControls.push(this.btnInsertTable),this.btnInsertImage=new Common.UI.Button({id:"tlbtn-insertimage",cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-insertimage",lock:[a.paragraphLock,a.headerLock,a.inEquation,a.controlPlain,a.richDelLock,a.plainDelLock,a.contentLock,a.cantAddImagePara,a.previewReviewMode,a.viewFormMode,a.lostConnect,a.disableOnStart,a.docLockView,a.docLockForms,a.docLockComments],caption:s.capBtnInsImage,menu:new Common.UI.Menu({items:[{caption:this.mniImageFromFile,value:"file"},{caption:this.mniImageFromUrl,value:"url"},{caption:this.mniImageFromStorage,value:"storage"}]}),dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.paragraphControls.push(this.btnInsertImage),this.btnInsertChart=new Common.UI.Button({id:"tlbtn-insertchart",cls:"btn-toolbar x-huge icon-top",caption:s.capBtnInsChart,iconCls:"toolbar__icon btn-insertchart",lock:[a.paragraphLock,a.headerLock,a.richEditLock,a.plainEditLock,a.controlPlain,a.richDelLock,a.plainDelLock,a.contentLock,a.chartLock,a.cantAddChart,a.previewReviewMode,a.viewFormMode,a.lostConnect,a.disableOnStart,a.docLockView,a.docLockForms,a.docLockComments],menu:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.paragraphControls.push(this.btnInsertChart),this.btnInsertText=new Common.UI.Button({id:"tlbtn-inserttext",cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-big-text",lock:[a.paragraphLock,a.headerLock,a.inEquation,a.controlPlain,a.contentLock,a.inFootnote,a.previewReviewMode,a.viewFormMode,a.lostConnect,a.disableOnStart,a.docLockView,a.docLockForms,a.docLockComments],caption:s.capBtnInsTextbox,enableToggle:!0,split:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small",textboxType:"textRect"}),this.paragraphControls.push(this.btnInsertText),this.btnInsertTextArt=new Common.UI.Button({id:"tlbtn-inserttextart",cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-textart",lock:[a.paragraphLock,a.headerLock,a.inEquation,a.controlPlain,a.richDelLock,a.plainDelLock,a.contentLock,a.inFootnote,a.cantAddImagePara,a.previewReviewMode,a.viewFormMode,a.lostConnect,a.disableOnStart,a.docLockView,a.docLockForms,a.docLockComments],caption:s.capBtnInsTextart,menu:new Common.UI.Menu({cls:"menu-shapes",items:[{template:C.template('<div id="id-toolbar-menu-insart" class="margin-left-5" style="width: 239px;"></div>')}]}),dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.paragraphControls.push(this.btnInsertTextArt),this.btnEditHeader=new Common.UI.Button({id:"id-toolbar-btn-editheader",cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-editheader",lock:[a.previewReviewMode,a.viewFormMode,a.inEquation,a.lostConnect,a.disableOnStart,a.docLockView,a.docLockForms,a.docLockComments],caption:s.capBtnInsHeader,menu:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.toolbarControls.push(this.btnEditHeader),this.mnuPageNumberPosPicker={conf:{disabled:!1},isDisabled:function(){return this.conf.disabled},setDisabled:function(t){this.conf.disabled=t},options:{}},this.mnuPageNumCurrentPos=n(this.mnuPageNumberPosPicker),this.mnuPageNumCurrentPos.options.lock=[a.paragraphLock,a.headerLock,a.richEditLock,a.plainEditLock],this.paragraphControls.push(this.mnuPageNumCurrentPos),this.mnuInsertPageCount=n(this.mnuPageNumberPosPicker),this.mnuInsertPageCount.options.lock=[a.paragraphLock,a.headerLock,a.richEditLock,a.plainEditLock],this.paragraphControls.push(this.mnuInsertPageCount),this.mnuInsertPageNum=n(this.mnuPageNumberPosPicker),this.mnuInsertPageNum.options.lock=[a.cantAddPageNum,a.controlPlain],this.mnuPageNumberPosPicker.options.lock=[a.headerFooterLock],this.btnInsDateTime=new Common.UI.Button({id:"id-toolbar-btn-datetime",cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-datetime",lock:[a.paragraphLock,a.headerLock,a.richEditLock,a.plainEditLock,a.richDelLock,a.plainDelLock,a.noParagraphSelected,a.previewReviewMode,a.viewFormMode,a.lostConnect,a.disableOnStart,a.docLockView,a.docLockForms,a.docLockComments],caption:s.capBtnDateTime,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.paragraphControls.push(this.btnInsDateTime),this.btnBlankPage=new Common.UI.Button({id:"id-toolbar-btn-blankpage",cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-blankpage",lock:[a.paragraphLock,a.headerLock,a.richEditLock,a.plainEditLock,a.inEquation,a.richDelLock,a.plainDelLock,a.inHeader,a.inFootnote,a.inControl,a.cantPageBreak,a.previewReviewMode,a.viewFormMode,a.lostConnect,a.disableOnStart,a.docLockView,a.docLockForms,a.docLockComments],caption:s.capBtnBlankPage,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.paragraphControls.push(this.btnBlankPage),this.btnInsertShape=new Common.UI.Button({id:"tlbtn-insertshape",cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-insertshape",lock:[a.paragraphLock,a.headerLock,a.inEquation,a.controlPlain,a.contentLock,a.inFootnote,a.previewReviewMode,a.viewFormMode,a.lostConnect,a.disableOnStart,a.docLockView,a.docLockForms,a.docLockComments],caption:s.capBtnInsShape,enableToggle:!0,menu:new Common.UI.Menu({cls:"menu-shapes menu-insert-shape"}),dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.paragraphControls.push(this.btnInsertShape),this.btnInsertSmartArt=new Common.UI.Button({id:"tlbtn-insertsmartart",cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-smart-art",lock:[a.paragraphLock,a.headerLock,a.inEquation,a.controlPlain,a.contentLock,a.inFootnote,a.previewReviewMode,a.viewFormMode,a.lostConnect,a.disableOnStart,a.docLockView,a.docLockForms,a.docLockComments],caption:s.capBtnInsSmartArt,menu:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.paragraphControls.push(this.btnInsertSmartArt),this.btnInsertEquation=new Common.UI.Button({id:"tlbtn-insertequation",cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-insertequation",lock:[a.paragraphLock,a.headerLock,a.richEditLock,a.plainEditLock,a.inChart,a.controlPlain,a.richDelLock,a.plainDelLock,a.cantAddEquation,a.previewReviewMode,a.viewFormMode,a.lostConnect,a.disableOnStart,a.docLockView,a.docLockForms,a.docLockComments],caption:s.capBtnInsEquation,split:!0,menu:new Common.UI.Menu({cls:"menu-shapes"}),dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.paragraphControls.push(this.btnInsertEquation),this.btnInsertSymbol=new Common.UI.Button({id:"tlbtn-insertsymbol",cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-symbol",lock:[a.paragraphLock,a.headerLock,a.richEditLock,a.plainEditLock,a.richDelLock,a.plainDelLock,a.noParagraphSelected,a.previewReviewMode,a.viewFormMode,a.lostConnect,a.disableOnStart,a.docLockView,a.docLockForms,a.docLockComments],caption:s.capBtnInsSymbol,menu:new Common.UI.Menu({style:"min-width: 100px;",items:[{template:C.template('<div id="id-toolbar-menu-symbols"></div>')},{caption:"--"},new Common.UI.MenuItem({caption:this.textMoreSymbols})]}),dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.paragraphControls.push(this.btnInsertSymbol),this.btnDropCap=new Common.UI.Button({id:"tlbtn-dropcap",cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-dropcap",lock:[a.paragraphLock,a.headerLock,a.richEditLock,a.plainEditLock,a.inEquation,a.controlPlain,a.dropcapLock,a.previewReviewMode,a.viewFormMode,a.lostConnect,a.disableOnStart,a.docLockView,a.docLockForms,a.docLockComments],caption:s.capBtnInsDropcap,menu:new Common.UI.Menu({cls:"ppm-toolbar shifted-right",items:[{caption:this.textNone,iconCls:"menu__icon btn-columns-one",checkable:!0,checkmark:!1,toggleGroup:"menuDropCap",value:Asc.c_oAscDropCap.None,checked:!0},{caption:this.textInText,iconCls:"menu__icon btn-dropcap-intext",checkable:!0,checkmark:!1,toggleGroup:"menuDropCap",value:Asc.c_oAscDropCap.Drop},{caption:this.textInMargin,iconCls:"menu__icon btn-dropcap-inmargin",checkable:!0,checkmark:!1,toggleGroup:"menuDropCap",value:Asc.c_oAscDropCap.Margin},{caption:"--"},this.mnuDropCapAdvanced=new Common.UI.MenuItem({caption:this.mniEditDropCap})]}),dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.paragraphControls.push(this.btnDropCap),this.btnContentControls=new Common.UI.Button({id:"tlbtn-controls",cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-controls",lock:[a.paragraphLock,a.headerLock,a.previewReviewMode,a.viewFormMode,a.lostConnect,a.disableOnStart,a.docLockView,a.docLockForms,a.docLockComments,a.inSmartart,a.inSmartartInternal],caption:s.capBtnInsControls,menu:new Common.UI.Menu({cls:"ppm-toolbar shifted-right",items:[{caption:this.textPlainControl,iconCls:"menu__icon btn-cc-plaintext",value:"plain"},{caption:this.textRichControl,iconCls:"menu__icon btn-cc-richtext",value:"rich"},{caption:this.textPictureControl,iconCls:"menu__icon btn-menu-image",value:"picture"},{caption:this.textComboboxControl,value:"combobox"},{caption:this.textDropdownControl,value:"dropdown"},{caption:this.textDateControl,value:"date"},{caption:this.textCheckboxControl,value:"checkbox"},{caption:"--"},{caption:this.textRemoveControl,iconCls:"menu__icon btn-cc-remove",value:"remove"},{caption:"--"},{caption:this.mniEditControls,value:"settings"},{caption:this.mniHighlightControls,value:"highlight",menu:this.mnuHighlightControls=new Common.UI.Menu({menuAlign:"tl-tr",items:[this.mnuNoControlsColor=new Common.UI.MenuItem({id:"id-toolbar-menu-no-highlight-controls",caption:this.textNoHighlight,checkable:!0}),{caption:"--"},{template:C.template('<div id="id-toolbar-menu-controls-color" style="width: 164px; display: inline-block;"></div>')},{caption:"--"},{id:"id-toolbar-menu-new-control-color",template:C.template('<a tabindex="-1" type="menuitem" style="'+(Common.UI.isRTL()?"padding-right:12px;":"padding-left:12px;")+'">'+this.textNewColor+"</a>")}]})}]}),dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.toolbarControls.push(this.btnContentControls),this.btnColumns=new Common.UI.Button({id:"tlbtn-columns",cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-columns",lock:[a.paragraphLock,a.headerLock,a.richEditLock,a.plainEditLock,a.controlPlain,a.inImage,a.docPropsLock,a.previewReviewMode,a.viewFormMode,a.lostConnect,a.disableOnStart,a.docLockView,a.docLockForms,a.docLockComments],caption:s.capBtnColumns,menu:new Common.UI.Menu({cls:"ppm-toolbar shifted-right",items:[{caption:this.textColumnsOne,iconCls:"menu__icon btn-columns-one",checkable:!0,checkmark:!1,toggleGroup:"menuColumns",value:0},{caption:this.textColumnsTwo,iconCls:"menu__icon btn-columns-two",checkable:!0,checkmark:!1,toggleGroup:"menuColumns",value:1},{caption:this.textColumnsThree,iconCls:"menu__icon btn-columns-three",checkable:!0,checkmark:!1,toggleGroup:"menuColumns",value:2},{caption:this.textColumnsLeft,iconCls:"menu__icon btn-columns-left",checkmark:!1,checkable:!0,toggleGroup:"menuColumns",value:3},{caption:this.textColumnsRight,iconCls:"menu__icon btn-columns-right",checkmark:!1,checkable:!0,toggleGroup:"menuColumns",value:4},{caption:"--"},{caption:this.textColumnsCustom,value:"advanced"}]}),dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.paragraphControls.push(this.btnColumns),this.btnPageOrient=new Common.UI.Button({id:"tlbtn-pageorient",cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-pageorient",lock:[a.docPropsLock,a.previewReviewMode,a.viewFormMode,a.lostConnect,a.disableOnStart,a.docLockView,a.docLockForms,a.docLockComments],caption:s.capBtnPageOrient,menu:new Common.UI.Menu({cls:"ppm-toolbar",items:[{caption:this.textPortrait,iconCls:"menu__icon btn-page-portrait",checkable:!0,checkmark:!1,toggleGroup:"menuOrient",value:!0},{caption:this.textLandscape,iconCls:"menu__icon btn-page-landscape",checkable:!0,checkmark:!1,toggleGroup:"menuOrient",value:!1}]}),dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.toolbarControls.push(this.btnPageOrient),t=Common.UI.isRTL()?C.template('<a id="<%= id %>" tabindex="-1" type="menuitem"><div><b><%= caption %></b></div><% if (options.value !== null) { %><div class="margin-vertical"><label><%= Common.Utils.Metric.getCurrentMetricName() %> <%= parseFloat(Common.Utils.Metric.fnRecalcFromMM(options.value[0]).toFixed(2)) %>'+this.textTop+"</label><label><%= Common.Utils.Metric.getCurrentMetricName() %> <%= parseFloat(Common.Utils.Metric.fnRecalcFromMM(options.value[1]).toFixed(2)) %>"+this.textLeft+'</label></div><div class="margin-horizontal"><label><%= Common.Utils.Metric.getCurrentMetricName() %> <%= parseFloat(Common.Utils.Metric.fnRecalcFromMM(options.value[2]).toFixed(2)) %>'+this.textBottom+"</label><label><%= Common.Utils.Metric.getCurrentMetricName() %> <%= parseFloat(Common.Utils.Metric.fnRecalcFromMM(options.value[3]).toFixed(2)) %>"+this.textRight+"</label></div><% } %></a>"):C.template('<a id="<%= id %>" tabindex="-1" type="menuitem"><div><b><%= caption %></b></div><% if (options.value !== null) { %><div class="margin-vertical"><label>'+this.textTop+"<%= parseFloat(Common.Utils.Metric.fnRecalcFromMM(options.value[0]).toFixed(2)) %> <%= Common.Utils.Metric.getCurrentMetricName() %></label><label>"+this.textLeft+'<%= parseFloat(Common.Utils.Metric.fnRecalcFromMM(options.value[1]).toFixed(2)) %> <%= Common.Utils.Metric.getCurrentMetricName() %></label></div><div class="margin-horizontal"><label>'+this.textBottom+"<%= parseFloat(Common.Utils.Metric.fnRecalcFromMM(options.value[2]).toFixed(2)) %> <%= Common.Utils.Metric.getCurrentMetricName() %></label><label>"+this.textRight+"<%= parseFloat(Common.Utils.Metric.fnRecalcFromMM(options.value[3]).toFixed(2)) %> <%= Common.Utils.Metric.getCurrentMetricName() %></label></div><% } %></a>"),this.btnPageMargins=new Common.UI.Button({id:"tlbtn-pagemargins",cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-pagemargins",lock:[a.docPropsLock,a.previewReviewMode,a.viewFormMode,a.lostConnect,a.disableOnStart,a.docLockView,a.docLockForms,a.docLockComments],caption:s.capBtnMargins,menu:new Common.UI.Menu({cls:"menu-margins",items:[{caption:this.textMarginsLast,checkable:!0,template:t,toggleGroup:"menuPageMargins"},{caption:this.textMarginsNormal,checkable:!0,template:t,toggleGroup:"menuPageMargins",value:[20,30,20,15]},{caption:this.textMarginsUsNormal,checkable:!0,template:t,toggleGroup:"menuPageMargins",value:[25.4,25.4,25.4,25.4]},{caption:this.textMarginsNarrow,checkable:!0,template:t,toggleGroup:"menuPageMargins",value:[12.7,12.7,12.7,12.7]},{caption:this.textMarginsModerate,checkable:!0,template:t,toggleGroup:"menuPageMargins",value:[25.4,19.1,25.4,19.1]},{caption:this.textMarginsWide,checkable:!0,template:t,toggleGroup:"menuPageMargins",value:[25.4,50.8,25.4,50.8]},{caption:"--"},{caption:this.textPageMarginsCustom,value:"advanced"}]}),dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.toolbarControls.push(this.btnPageMargins),t=Common.UI.isRTL()?C.template('<a id="<%= id %>" tabindex="-1" type="menuitem"><div><b><%= caption %></b></div><div dir="ltr"><%= Common.Utils.Metric.getCurrentMetricName() %> <%= parseFloat(Common.Utils.Metric.fnRecalcFromMM(options.value[1]).toFixed(2)) %> x <%= Common.Utils.Metric.getCurrentMetricName() %> <%= parseFloat(Common.Utils.Metric.fnRecalcFromMM(options.value[0]).toFixed(2)) %></div></a>'):C.template('<a id="<%= id %>" tabindex="-1" type="menuitem"><div><b><%= caption %></b></div><div dir="ltr"><%= parseFloat(Common.Utils.Metric.fnRecalcFromMM(options.value[0]).toFixed(2)) %> <%= Common.Utils.Metric.getCurrentMetricName() %> x <%= parseFloat(Common.Utils.Metric.fnRecalcFromMM(options.value[1]).toFixed(2)) %> <%= Common.Utils.Metric.getCurrentMetricName() %></div></a>'),this.btnPageSize=new Common.UI.Button({id:"tlbtn-pagesize",cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-pagesize",lock:[a.docPropsLock,a.previewReviewMode,a.viewFormMode,a.lostConnect,a.disableOnStart,a.docLockView,a.docLockForms,a.docLockComments],caption:s.capBtnPageSize,menu:new Common.UI.Menu({restoreHeight:!0,items:[{caption:"US Letter",subtitle:"21,59cm x 27,94cm",template:t,checkable:!0,toggleGroup:"menuPageSize",value:[215.9,279.4]},{caption:"US Legal",subtitle:"21,59cm x 35,56cm",template:t,checkable:!0,toggleGroup:"menuPageSize",value:[215.9,355.6]},{caption:"A4",subtitle:"21cm x 29,7cm",template:t,checkable:!0,toggleGroup:"menuPageSize",value:[210,297],checked:!0},{caption:"A5",subtitle:"14,81cm x 20,99cm",template:t,checkable:!0,toggleGroup:"menuPageSize",value:[148,210]},{caption:"B5",subtitle:"17,6cm x 25,01cm",template:t,checkable:!0,toggleGroup:"menuPageSize",value:[176,250]},{caption:"Envelope #10",subtitle:"10,48cm x 24,13cm",template:t,checkable:!0,toggleGroup:"menuPageSize",value:[104.8,241.3]},{caption:"Envelope DL",subtitle:"11,01cm x 22,01cm",template:t,checkable:!0,toggleGroup:"menuPageSize",value:[110,220]},{caption:"Tabloid",subtitle:"27,94cm x 43,17cm",template:t,checkable:!0,toggleGroup:"menuPageSize",value:[279.4,431.8]},{caption:"A3",subtitle:"29,7cm x 42,01cm",template:t,checkable:!0,toggleGroup:"menuPageSize",value:[297,420]},{caption:"Tabloid Oversize",subtitle:"30,48cm x 45,71cm",template:t,checkable:!0,toggleGroup:"menuPageSize",value:[304.8,457.1]},{caption:"ROC 16K",subtitle:"19,68cm x 27,3cm",template:t,checkable:!0,toggleGroup:"menuPageSize",value:[196.8,273]},{caption:"Envelope Choukei 3",subtitle:"11,99cm x 23,49cm",template:t,checkable:!0,toggleGroup:"menuPageSize",value:[119.9,234.9]},{caption:"Super B/A3",subtitle:"33,02cm x 48,25cm",template:t,checkable:!0,toggleGroup:"menuPageSize",value:[330.2,482.5]},{caption:"--"},{caption:this.textPageSizeCustom,value:"advanced"}]}),dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.toolbarControls.push(this.btnPageSize),this.btnLineNumbers=new Common.UI.Button({id:"tlbtn-line-numbers",cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-line-numbering",lock:[a.docPropsLock,a.inImagePara,a.previewReviewMode,a.viewFormMode,a.lostConnect,a.disableOnStart,a.docLockView,a.docLockForms,a.docLockComments],caption:s.capBtnLineNumbers,menu:new Common.UI.Menu({cls:"ppm-toolbar",items:[{caption:this.textNone,checkable:!0,toggleGroup:"menuLineNumbers",value:0},{caption:this.textContinuous,checkable:!0,toggleGroup:"menuLineNumbers",value:1},{caption:this.textRestartEachPage,checkable:!0,toggleGroup:"menuLineNumbers",value:2},{caption:this.textRestartEachSection,checkable:!0,toggleGroup:"menuLineNumbers",value:3},{caption:this.textSuppressForCurrentParagraph,checkable:!0,allowDepress:!0,value:4},{caption:"--"},{caption:this.textCustomLineNumbers,value:5}]}),dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.toolbarControls.push(this.btnLineNumbers),this.btnHyphenation=new Common.UI.Button({id:"tlbtn-line-hyphenation",cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-hyphenation",lock:[a.docPropsLock,a.previewReviewMode,a.viewFormMode,a.lostConnect,a.disableOnStart,a.docLockView,a.docLockForms,a.docLockComments],caption:this.capBtnHyphenation,menu:new Common.UI.Menu({cls:"ppm-toolbar",items:[{caption:this.textNone,checkable:!0,toggleGroup:"menuHyphenation",value:0},{caption:this.textAuto,checkable:!0,toggleGroup:"menuHyphenation",value:1},{caption:"--"},{caption:this.textCustomHyphen,value:"custom"}]}),dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.toolbarControls.push(this.btnHyphenation),this.btnClearStyle=new Common.UI.Button({id:"id-toolbar-btn-clearstyle",cls:"btn-toolbar",iconCls:"toolbar__icon btn-clearstyle",lock:[a.paragraphLock,a.headerLock,a.richEditLock,a.plainEditLock,a.inChart,a.inSmartart,a.inSmartartInternal,a.previewReviewMode,a.viewFormMode,a.lostConnect,a.disableOnStart,a.docLockView,a.docLockForms,a.docLockComments],dataHint:"1",dataHintDirection:"top"}),this.toolbarControls.push(this.btnClearStyle),this.btnCopyStyle=new Common.UI.Button({id:"id-toolbar-btn-copystyle",cls:"btn-toolbar",iconCls:"toolbar__icon btn-copystyle",lock:[a.previewReviewMode,a.viewFormMode,a.lostConnect,a.disableOnStart,a.docLockView,a.docLockForms,a.docLockComments],enableToggle:!0,dataHint:"1",dataHintDirection:"bottom"}),this.toolbarControls.push(this.btnCopyStyle),this.btnColorSchemas=new Common.UI.Button({id:"id-toolbar-btn-colorschemas",cls:"btn-toolbar",iconCls:"toolbar__icon btn-colorschemas",lock:[a.docSchemaLock,a.previewReviewMode,a.viewFormMode,a.lostConnect,a.disableOnStart,a.docLockView,a.docLockForms,a.docLockComments],menu:new Common.UI.Menu({cls:"shifted-left",items:[],restoreHeight:!0}),dataHint:"1",dataHintDirection:"top",dataHintOffset:"0, -6"}),this.toolbarControls.push(this.btnColorSchemas),this.btnMailRecepients=new Common.UI.Button({id:"id-toolbar-btn-mailrecepients",cls:"btn-toolbar",iconCls:"toolbar__icon btn-mailmerge",lock:[a.mmergeLock,a.previewReviewMode,a.viewFormMode,a.lostConnect,a.disableOnStart,a.docLockView,a.docLockForms,a.docLockComments],dataHint:"1",dataHintDirection:"bottom",menu:new Common.UI.Menu({items:[{caption:this.mniFromFile,value:"file"},{caption:this.mniFromUrl,value:"url"},{caption:this.mniFromStorage,value:"storage"}]})}),this.toolbarControls.push(this.btnMailRecepients),s.btnImgAlign=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-img-align",lock:[a.imageLock,a.contentLock,a.inImageInline,a.noObjectSelected,a.previewReviewMode,a.viewFormMode,a.lostConnect,a.disableOnStart,a.docLockView,a.docLockForms,a.docLockComments],caption:s.capImgAlign,menu:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),s.btnImgGroup=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-img-group",lock:[a.imageLock,a.contentLock,a.inImageInline,a.noObjectSelected,a.cantGroup,a.previewReviewMode,a.viewFormMode,a.lostConnect,a.disableOnStart,a.docLockView,a.docLockForms,a.docLockComments],caption:s.capImgGroup,menu:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),s.btnImgForward=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-img-frwd",lock:[a.cantArrange,a.lostConnect,a.contentLock,a.noObjectSelected,a.inSmartartInternal,a.previewReviewMode,a.viewFormMode,a.disableOnStart,a.docLockView,a.docLockForms,a.docLockComments],caption:s.capImgForward,split:!0,menu:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),s.btnImgBackward=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-img-bkwd",lock:[a.cantArrange,a.lostConnect,a.contentLock,a.noObjectSelected,a.inSmartartInternal,a.previewReviewMode,a.viewFormMode,a.disableOnStart,a.docLockView,a.docLockForms,a.docLockComments],caption:s.capImgBackward,split:!0,menu:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),s.btnImgWrapping=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-img-wrap",lock:[a.cantWrap,a.imageLock,a.contentLock,a.noObjectSelected,a.lostConnect,a.previewReviewMode,a.viewFormMode,a.disableOnStart,a.docLockView,a.docLockForms,a.docLockComments],caption:s.capImgWrapping,menu:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),s.btnWatermark=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-watermark",lock:[a.headerLock,a.previewReviewMode,a.viewFormMode,a.lostConnect,a.disableOnStart,a.docLockView,a.docLockForms,a.docLockComments],caption:s.capBtnWatermark,menu:new Common.UI.Menu({cls:"ppm-toolbar",items:[{caption:this.textEditWatermark,value:"edit"},{caption:this.textRemWatermark,value:"remove"}]}),dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),s.btnPageColor=new Common.UI.ButtonColored({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-page-color",lock:[a.docPropsLock,a.previewReviewMode,a.viewFormMode,a.lostConnect,a.disableOnStart,a.docLockView,a.docLockForms,a.docLockComments,a.viewMode],caption:s.capBtnPageColor,menu:!0,eyeDropper:!1,hideColorLine:!0,additionalItemsBefore:[s.mnuPageNoFill=new Common.UI.MenuItem({caption:s.strMenuNoFill,style:Common.UI.isRTL()?"padding-right:20px;":"padding-left:20px;",checkable:!0}),{caption:"--"}],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),s.toolbarControls.push(s.btnImgAlign,s.btnImgGroup,s.btnImgForward,s.btnImgBackward,s.btnImgWrapping,s.btnWatermark,s.btnPageColor),this.mnuLineSpace=this.btnLineSpace.menu,this.mnuNonPrinting=this.btnShowHidenChars.menu,this.mnuInsertTable=this.btnInsertTable.menu,this.mnuInsertImage=this.btnInsertImage.menu,this.mnuPageSize=this.btnPageSize.menu,this.mnuColorSchema=this.btnColorSchemas.menu,this.mnuChangeCase=this.btnChangeCase.menu,this.mnuMailRecepients=this.btnMailRecepients.menu,this.cmbFontSize=new Common.UI.ComboBox({cls:"input-group-nr",menuCls:"scrollable-menu",menuStyle:"min-width: 55px;max-height: 454px;",lock:[a.paragraphLock,a.headerLock,a.richEditLock,a.plainEditLock,a.previewReviewMode,a.viewFormMode,a.lostConnect,a.disableOnStart,a.docLockView,a.docLockForms,a.docLockComments],hint:this.tipFontSize,dataHint:"1",dataHintDirection:"top"}),this.paragraphControls.push(this.cmbFontSize),this.cmbFontName=new Common.UI.ComboBoxFonts({cls:"input-group-nr",menuCls:"scrollable-menu",menuStyle:"min-width: 325px;",lock:[a.paragraphLock,a.headerLock,a.richEditLock,a.plainEditLock,a.previewReviewMode,a.viewFormMode,a.lostConnect,a.disableOnStart,a.docLockView,a.docLockForms,a.docLockComments],hint:this.tipFontName,store:new Common.Collections.Fonts,dataHint:"1",dataHintDirection:"top"}),this.paragraphControls.push(this.cmbFontName),this.listStylesAdditionalMenuItem=new Common.UI.MenuItem({cls:"save-style-container",iconCls:"menu__icon btn-zoomup",caption:s.textStyleMenuNew}),this.listStyles=new Common.UI.ComboDataView({cls:"combo-styles",lock:[a.paragraphLock,a.headerLock,a.richEditLock,a.plainEditLock,a.inChart,a.inSmartart,a.inSmartartInternal,a.previewReviewMode,a.viewFormMode,a.lostConnect,a.disableOnStart,a.docLockView,a.docLockForms,a.docLockComments],itemWidth:104,itemHeight:40,style:"min-width:139px;",dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"-16, -4",enableKeyEvents:!0,additionalMenuItems:[this.listStylesAdditionalMenuItem],delayRenderTips:!0,autoWidth:!0,itemTemplate:C.template(['<div class="style" id="<%= id %>">','<div style="background-image: url(<%= imageUrl %>); width: 104px; height: 40px;"></div>',"</div>"].join("")),beforeOpenHandler:function(t){var e,i,n,o,s=this,a=s.openButton.menu;a.cmpEl&&(e=b(s.cmpEl.find(".dataview.inner .style").get(0)).parent(),o=parseFloat(e.css("margin-right")),e=e.is(":visible")?parseFloat(e.css("width")):s.itemWidth+parseFloat(e.css("padding-left"))+parseFloat(e.css("padding-right"))+parseFloat(e.css("border-left-width"))+parseFloat(e.css("border-right-width")),i=6<=s.menuPicker.store.length?6:s.menuPicker.store.length,n=(n=Math.min(s.menuPicker.store.length,Math.round(b(".dataview",b(s.fieldPicker.el)).width()/(o+e))))<i?i:n,a.menuAlignEl=s.cmpEl,a.menuAlign="tl-tl",i=n*(o+e),n=s.openButton.$el.offset().left,i>Common.Utils.innerWidth()&&(i=Math.max(Math.floor(Common.Utils.innerWidth()/(o+e)),2)*(o+e)),i=Math.ceil(10*i)/10,o=s.cmpEl.width()-s.openButton.$el.width()-Math.min(i,n),Common.UI.isRTL()&&(o=s.openButton.$el.width()),a.setOffset(Common.UI.isRTL()?o:Math.min(o,0)),a.cmpEl.css({width:i,"min-height":s.cmpEl.height()})),s.menuPicker.scroller&&s.menuPicker.scroller.update({includePadding:!0,suppressScrollX:!0}),s.removeTips()}}),this.paragraphControls.push(this.listStyles),this.textOnlyControls.push(this.listStyles),this.lockControls=s.toolbarControls.concat(s.paragraphControls),this.lockToolbar(Common.enumLock.disableOnStart,!0,{array:this.lockControls}),t=new Common.UI.MenuItem({caption:s.textStyleMenuUpdate}).on("click",C.bind(s.onStyleMenuUpdate,s)),a=new Common.UI.MenuItem({caption:s.textStyleMenuDelete}).on("click",C.bind(s.onStyleMenuDelete,s)),e=new Common.UI.MenuItem({caption:s.textStyleMenuRestore}).on("click",C.bind(s.onStyleMenuDelete,s)),i=new Common.UI.MenuItem({caption:s.textStyleMenuRestoreAll}).on("click",C.bind(s.onStyleMenuRestoreAll,s)),o=new Common.UI.MenuItem({caption:s.textStyleMenuDeleteAll}).on("click",C.bind(s.onStyleMenuDeleteAll,s)),null==this.styleMenu&&(this.styleMenu=new Common.UI.Menu({items:[t,a,e,i,o]})),this.on("render:after",C.bind(this.onToolbarAfterRender,this))):Common.UI.Mixtbar.prototype.initialize.call(this,{template:C.template(r),tabs:[{caption:s.textTabFile,action:"file",layoutname:"toolbar-file",haspanel:!1,dataHintTitle:"F"}]}),this},render:function(t){var e=this;return this.fireEvent("render:before",[this]),e.isCompactView=t.isCompactView,t.isEdit?e.$el.html(e.rendererComponents(e.$layout)):(e.$layout.find(".canedit").hide(),e.isCompactView&&e.$layout.addClass("folded"),e.$el.html(e.$layout)),this.fireEvent("render:after",[this]),Common.UI.Mixtbar.prototype.afterRender.call(this),Common.NotificationCenter.on({"window:resize":function(){Common.UI.Mixtbar.prototype.onResize.apply(e,arguments)}}),t.isEdit&&(this.showSynchTip=!Common.localStorage.getBool("de-hide-synch"),this.needShowSynchTip=!1,e.setTab("home"),e.onUpdateLastCustomMargins(),Common.NotificationCenter.on("margins:update",C.bind(e.onUpdateLastCustomMargins,e))),e.isCompactView&&e.setFolded(!0),this},onTabClick:function(t){var t=b(t.currentTarget).find("> a[data-tab]").data("tab"),e=this.isTabActive("file");Common.UI.Mixtbar.prototype.onTabClick.apply(this,arguments),e?this.fireEvent("file:close"):"file"==t&&(this.fireEvent("file:open"),this.setTab(t)),this.isTabActive("home")&&this.fireEvent("home:open")},rendererComponents:function(t){function e(t,e){Common.Utils.injectComponent(i.findById(t),e)}var i=b(t);return e("#slot-field-fontname",this.cmbFontName),e("#slot-field-fontsize",this.cmbFontSize),e("#slot-btn-print",this.btnPrint),e("#slot-btn-save",this.btnSave),e("#slot-btn-undo",this.btnUndo),e("#slot-btn-redo",this.btnRedo),e("#slot-btn-copy",this.btnCopy),e("#slot-btn-paste",this.btnPaste),e("#slot-btn-cut",this.btnCut),e("#slot-btn-select-all",this.btnSelectAll),e("#slot-btn-incfont",this.btnIncFontSize),e("#slot-btn-decfont",this.btnDecFontSize),e("#slot-btn-bold",this.btnBold),e("#slot-btn-italic",this.btnItalic),e("#slot-btn-underline",this.btnUnderline),e("#slot-btn-strikeout",this.btnStrikeout),e("#slot-btn-superscript",this.btnSuperscript),e("#slot-btn-subscript",this.btnSubscript),e("#slot-btn-highlight",this.btnHighlightColor),e("#slot-btn-fontcolor",this.btnFontColor),e("#slot-btn-changecase",this.btnChangeCase),e("#slot-btn-align-left",this.btnAlignLeft),e("#slot-btn-align-center",this.btnAlignCenter),e("#slot-btn-align-right",this.btnAlignRight),e("#slot-btn-align-just",this.btnAlignJust),e("#slot-btn-incoffset",this.btnIncLeftOffset),e("#slot-btn-decoffset",this.btnDecLeftOffset),e("#slot-btn-linespace",this.btnLineSpace),e("#slot-btn-hidenchars",this.btnShowHidenChars),e("#slot-btn-markers",this.btnMarkers),e("#slot-btn-numbering",this.btnNumbers),e("#slot-btn-multilevels",this.btnMultilevels),e("#slot-btn-instable",this.btnInsertTable),e("#slot-btn-insimage",this.btnInsertImage),e("#slot-btn-inschart",this.btnInsertChart),e("#slot-btn-instext",this.btnInsertText),e("#slot-btn-instextart",this.btnInsertTextArt),e("#slot-btn-dropcap",this.btnDropCap),e("#slot-btn-controls",this.btnContentControls),e("#slot-btn-columns",this.btnColumns),e("#slot-btn-line-numbers",this.btnLineNumbers),e("#slot-btn-editheader",this.btnEditHeader),e("#slot-btn-datetime",this.btnInsDateTime),e("#slot-btn-blankpage",this.btnBlankPage),e("#slot-btn-insshape",this.btnInsertShape),e("#slot-btn-inssmartart",this.btnInsertSmartArt),e("#slot-btn-insequation",this.btnInsertEquation),e("#slot-btn-inssymbol",this.btnInsertSymbol),e("#slot-btn-pageorient",this.btnPageOrient),e("#slot-btn-pagemargins",this.btnPageMargins),e("#slot-btn-pagesize",this.btnPageSize),e("#slot-btn-clearstyle",this.btnClearStyle),e("#slot-btn-copystyle",this.btnCopyStyle),e("#slot-btn-colorschemas",this.btnColorSchemas),e("#slot-btn-paracolor",this.btnParagraphColor),e("#slot-field-styles",this.listStyles),e("#slot-btn-mailrecepients",this.btnMailRecepients),e("#slot-img-align",this.btnImgAlign),e("#slot-img-group",this.btnImgGroup),e("#slot-img-movefrwd",this.btnImgForward),e("#slot-img-movebkwd",this.btnImgBackward),e("#slot-img-wrapping",this.btnImgWrapping),e("#slot-btn-watermark",this.btnWatermark),e("#slot-btn-hyphenation",this.btnHyphenation),e("#slot-btn-pagecolor",this.btnPageColor),this.btnsPageBreak=Common.Utils.injectButtons(i.find(".btn-slot.btn-pagebreak"),"","toolbar__icon btn-pagebreak",this.capBtnInsPagebreak,[Common.enumLock.paragraphLock,Common.enumLock.headerLock,Common.enumLock.richEditLock,Common.enumLock.plainEditLock,Common.enumLock.inEquation,Common.enumLock.richDelLock,Common.enumLock.plainDelLock,Common.enumLock.inHeader,Common.enumLock.inFootnote,Common.enumLock.inControl,Common.enumLock.cantPageBreak,Common.enumLock.previewReviewMode,Common.enumLock.viewFormMode,Common.enumLock.lostConnect,Common.enumLock.disableOnStart,Common.enumLock.docLockView,Common.enumLock.docLockForms,Common.enumLock.docLockComments],!0,!0,void 0,"1","bottom","small"),Array.prototype.push.apply(this.paragraphControls,this.btnsPageBreak),Array.prototype.push.apply(this.lockControls,this.btnsPageBreak),this.btnPrint.menu&&this.btnPrint.$el.addClass("split"),i},onAppReady:function(e){var t,i,n=this;n.cmbFontSize&&(i=(t=e.lang?e.lang.toLowerCase():"en").split(/[\-_]/)[0],n.cmbFontSize.setData("zh"===i&&"zh-tw"!==t&&"zh_tw"!==t?[{value:"42_str",displayValue:"初号"},{value:"36_str",displayValue:"小初"},{value:"26_str",displayValue:"一号"},{value:"24_str",displayValue:"小一"},{value:"22_str",displayValue:"二号"},{value:"18_str",displayValue:"小二"},{value:"16_str",displayValue:"三号"},{value:"15_str",displayValue:"小三"},{value:"14_str",displayValue:"四号"},{value:"12_str",displayValue:"小四"},{value:"10.5_str",displayValue:"五号"},{value:"9_str",displayValue:"小五"},{value:"7.5_str",displayValue:"六号"},{value:"6.5_str",displayValue:"小六"},{value:"5.5_str",displayValue:"七号"},{value:"5_str",displayValue:"八号"},{value:5,displayValue:"5"},{value:5.5,displayValue:"5.5"},{value:6.5,displayValue:"6.5"},{value:7.5,displayValue:"7.5"},{value:8,displayValue:"8"},{value:9,displayValue:"9"},{value:10,displayValue:"10"},{value:10.5,displayValue:"10.5"},{value:11,displayValue:"11"},{value:12,displayValue:"12"},{value:14,displayValue:"14"},{value:15,displayValue:"15"},{value:16,displayValue:"16"},{value:18,displayValue:"18"},{value:20,displayValue:"20"},{value:22,displayValue:"22"},{value:24,displayValue:"24"},{value:26,displayValue:"26"},{value:28,displayValue:"28"},{value:36,displayValue:"36"},{value:42,displayValue:"42"},{value:48,displayValue:"48"},{value:72,displayValue:"72"},{value:96,displayValue:"96"}]:[{value:8,displayValue:"8"},{value:9,displayValue:"9"},{value:10,displayValue:"10"},{value:11,displayValue:"11"},{value:12,displayValue:"12"},{value:14,displayValue:"14"},{value:16,displayValue:"16"},{value:18,displayValue:"18"},{value:20,displayValue:"20"},{value:22,displayValue:"22"},{value:24,displayValue:"24"},{value:26,displayValue:"26"},{value:28,displayValue:"28"},{value:36,displayValue:"36"},{value:48,displayValue:"48"},{value:72,displayValue:"72"},{value:96,displayValue:"96"}])),new Promise(function(t,e){t()}).then(function(){var t;e.isEdit&&(n.btnPrint.menu&&n.btnPrint.setMenu(new Common.UI.Menu({items:[{caption:n.tipPrint,iconCls:"menu__icon btn-print",toggleGroup:"viewPrint",value:"print",iconClsForMainBtn:"btn-print",platformKey:Common.Utils.String.platformKey("Ctrl+P")},{caption:n.tipPrintQuick,iconCls:"menu__icon btn-quick-print",toggleGroup:"viewPrint",value:"print-quick",iconClsForMainBtn:"btn-quick-print",platformKey:""}]})),n.btnsPageBreak.forEach(function(t){t.updateHint([n.textInsPageBreak,n.tipPageBreak]);var e=new Common.UI.Menu({menuAlign:"tl-tr",items:[{caption:n.textNextPage,value:Asc.c_oAscSectionBreakType.NextPage},{caption:n.textContPage,value:Asc.c_oAscSectionBreakType.Continuous},{caption:n.textEvenPage,value:Asc.c_oAscSectionBreakType.EvenPage},{caption:n.textOddPage,value:Asc.c_oAscSectionBreakType.OddPage}]}),e=new Common.UI.Menu({items:[{caption:n.textInsPageBreak,value:"page"},{caption:n.textInsColumnBreak,value:"column"},{caption:n.textInsSectionBreak,value:"section",menu:e}]});t.setMenu(e)}),t=DE.getController("DocumentHolder").getView(),n.btnImgForward.updateHint(n.tipSendForward),n.btnImgForward.setMenu(new Common.UI.Menu({items:[{caption:t.textArrangeFront,iconCls:"menu__icon btn-arrange-front",valign:Asc.c_oAscChangeLevel.BringToFront},{caption:t.textArrangeForward,iconCls:"menu__icon btn-arrange-forward",valign:Asc.c_oAscChangeLevel.BringForward}]})),n.btnImgBackward.updateHint(n.tipSendBackward),n.btnImgBackward.setMenu(new Common.UI.Menu({items:[{caption:t.textArrangeBack,iconCls:"menu__icon btn-arrange-back",valign:Asc.c_oAscChangeLevel.SendToBack},{caption:t.textArrangeBackward,iconCls:"menu__icon btn-arrange-backward",valign:Asc.c_oAscChangeLevel.BringBackward}]})),n.btnImgAlign.updateHint(n.tipImgAlign),n.mniAlignToPage=new Common.UI.MenuItem({caption:n.txtPageAlign,checkable:!0,toggleGroup:"imgalign",value:-1}).on("click",function(t){Common.Utils.InternalSettings.set("de-img-align-to",1)}),n.mniAlignToMargin=new Common.UI.MenuItem({caption:n.txtMarginAlign,checkable:!0,toggleGroup:"imgalign",value:-1}).on("click",function(t){Common.Utils.InternalSettings.set("de-img-align-to",2)}),n.mniAlignObjects=new Common.UI.MenuItem({caption:n.txtObjectsAlign,checkable:!0,toggleGroup:"imgalign",value:-1}).on("click",function(t){Common.Utils.InternalSettings.set("de-img-align-to",3)}),n.mniDistribHor=new Common.UI.MenuItem({caption:n.txtDistribHor,iconCls:"menu__icon btn-shape-distribute-hor",value:6}),n.mniDistribVert=new Common.UI.MenuItem({caption:n.txtDistribVert,iconCls:"menu__icon btn-shape-distribute-vert",value:7}),n.btnImgAlign.setMenu(new Common.UI.Menu({cls:"shifted-right",items:[{caption:t.textShapeAlignLeft,iconCls:"menu__icon btn-shape-align-left",value:Asc.c_oAscAlignShapeType.ALIGN_LEFT},{caption:t.textShapeAlignCenter,iconCls:"menu__icon btn-shape-align-center",value:Asc.c_oAscAlignShapeType.ALIGN_CENTER},{caption:t.textShapeAlignRight,iconCls:"menu__icon btn-shape-align-right",value:Asc.c_oAscAlignShapeType.ALIGN_RIGHT},{caption:t.textShapeAlignTop,iconCls:"menu__icon btn-shape-align-top",value:Asc.c_oAscAlignShapeType.ALIGN_TOP},{caption:t.textShapeAlignMiddle,iconCls:"menu__icon btn-shape-align-middle",value:Asc.c_oAscAlignShapeType.ALIGN_MIDDLE},{caption:t.textShapeAlignBottom,iconCls:"menu__icon btn-shape-align-bottom",value:Asc.c_oAscAlignShapeType.ALIGN_BOTTOM},{caption:"--"},n.mniDistribHor,n.mniDistribVert,{caption:"--"},n.mniAlignToPage,n.mniAlignToMargin,n.mniAlignObjects]})),n.btnImgGroup.updateHint(n.tipImgGroup),n.btnImgGroup.setMenu(new Common.UI.Menu({items:[{caption:t.txtGroup,iconCls:"menu__icon btn-shape-group",groupval:1},{caption:t.txtUngroup,iconCls:"menu__icon btn-shape-ungroup",groupval:-1}]})),n.btnImgWrapping.updateHint(n.tipImgWrapping),n.btnImgWrapping.setMenu(new Common.UI.Menu({cls:"ppm-toolbar shifted-right",items:[{caption:t.txtInline,iconCls:"menu__icon btn-small-wrap-inline",toggleGroup:"imgwrapping",wrapType:Asc.c_oAscWrapStyle2.Inline,checkmark:!1,checkable:!0},{caption:"--"},{caption:t.txtSquare,iconCls:"menu__icon btn-small-wrap-square",toggleGroup:"imgwrapping",wrapType:Asc.c_oAscWrapStyle2.Square,checkmark:!1,checkable:!0},{caption:t.txtTight,iconCls:"menu__icon btn-small-wrap-tight",toggleGroup:"imgwrapping",wrapType:Asc.c_oAscWrapStyle2.Tight,checkmark:!1,checkable:!0},{caption:t.txtThrough,iconCls:"menu__icon btn-small-wrap-through",toggleGroup:"imgwrapping",wrapType:Asc.c_oAscWrapStyle2.Through,checkmark:!1,checkable:!0},{caption:t.txtTopAndBottom,iconCls:"menu__icon btn-small-wrap-topandbottom",toggleGroup:"imgwrapping",wrapType:Asc.c_oAscWrapStyle2.TopAndBottom,checkmark:!1,checkable:!0},{caption:"--"},{caption:t.txtInFront,iconCls:"menu__icon btn-small-wrap-infront",toggleGroup:"imgwrapping",wrapType:Asc.c_oAscWrapStyle2.InFront,checkmark:!1,checkable:!0},{caption:t.txtBehind,iconCls:"menu__icon btn-small-wrap-behind",toggleGroup:"imgwrapping",wrapType:Asc.c_oAscWrapStyle2.Behind,checkmark:!1,checkable:!0},{caption:"--"},{caption:t.textEditWrapBoundary,wrapType:"edit"}]})),n.btnWatermark.updateHint(n.tipWatermark),!e.canFeatureContentControl&&n.btnContentControls.cmpEl&&n.btnContentControls.cmpEl.parents(".group").hide().prev(".separator").hide())})},createDelayedElements:function(){this.api&&(this.mnuNonPrinting.items[0].setChecked(this.api.get_ShowParaMarks(),!0),this.mnuNonPrinting.items[1].setChecked(this.api.get_ShowTableEmptyLine(),!0),this.btnShowHidenChars.toggle(this.mnuNonPrinting.items[0].checked,!0),this.updateMetricUnit()),this.btnPrint.updateHint(this.tipPrint+Common.Utils.String.platformKey("Ctrl+P")),this.btnSave.updateHint(this.btnSaveTip),this.btnUndo.updateHint(this.tipUndo+Common.Utils.String.platformKey("Ctrl+Z")),this.btnRedo.updateHint(this.tipRedo+Common.Utils.String.platformKey("Ctrl+Y")),this.btnCopy.updateHint(this.tipCopy+Common.Utils.String.platformKey("Ctrl+C")),this.btnPaste.updateHint(this.tipPaste+Common.Utils.String.platformKey("Ctrl+V")),this.btnCut.updateHint(this.tipCut+Common.Utils.String.platformKey("Ctrl+X")),this.btnSelectAll.updateHint(this.tipSelectAll+Common.Utils.String.platformKey("Ctrl+A")),this.btnIncFontSize.updateHint(this.tipIncFont+Common.Utils.String.platformKey("Ctrl+]")),this.btnDecFontSize.updateHint(this.tipDecFont+Common.Utils.String.platformKey("Ctrl+[")),this.btnBold.updateHint(this.textBold+Common.Utils.String.platformKey("Ctrl+B")),this.btnItalic.updateHint(this.textItalic+Common.Utils.String.platformKey("Ctrl+I")),this.btnUnderline.updateHint(this.textUnderline+Common.Utils.String.platformKey("Ctrl+U")),this.btnStrikeout.updateHint(this.textStrikeout),this.btnSuperscript.updateHint(this.textSuperscript),this.btnSubscript.updateHint(this.textSubscript),this.btnHighlightColor.updateHint(this.tipHighlightColor),this.btnFontColor.updateHint(this.tipFontColor),this.btnParagraphColor.updateHint(this.tipPrColor),this.btnChangeCase.updateHint(this.tipChangeCase),this.btnAlignLeft.updateHint(this.tipAlignLeft+Common.Utils.String.platformKey("Ctrl+L")),this.btnAlignCenter.updateHint(this.tipAlignCenter+Common.Utils.String.platformKey("Ctrl+E")),this.btnAlignRight.updateHint(this.tipAlignRight+Common.Utils.String.platformKey("Ctrl+R")),this.btnAlignJust.updateHint(this.tipAlignJust+Common.Utils.String.platformKey("Ctrl+J")),this.btnDecLeftOffset.updateHint(this.tipDecPrLeft+Common.Utils.String.platformKey("Ctrl+Shift+M")),this.btnIncLeftOffset.updateHint(this.tipIncPrLeft+Common.Utils.String.platformKey("Ctrl+M")),this.btnLineSpace.updateHint(this.tipLineSpace),this.btnShowHidenChars.updateHint(this.tipShowHiddenChars+Common.Utils.String.platformKey("Shift+8"," ("+Common.Utils.String.textCtrl+"+{0})")),this.btnMarkers.updateHint(this.tipMarkers),this.btnNumbers.updateHint(this.tipNumbers),this.btnMultilevels.updateHint(this.tipMultilevels),this.btnInsertTable.updateHint(this.tipInsertTable),this.btnInsertImage.updateHint(this.tipInsertImage),this.btnInsertChart.updateHint(this.tipInsertChart),this.btnInsertText.updateHint([this.tipInsertHorizontalText,this.tipInsertText]),this.btnInsertTextArt.updateHint(this.tipInsertTextArt),this.btnEditHeader.updateHint(this.tipEditHeader),this.btnInsDateTime.updateHint(this.tipDateTime),this.btnBlankPage.updateHint(this.tipBlankPage),this.btnInsertShape.updateHint(this.tipInsertShape),this.btnInsertSmartArt.updateHint(this.tipInsertSmartArt),this.btnInsertEquation.updateHint(this.tipInsertEquation),this.btnInsertSymbol.updateHint(this.tipInsertSymbol),this.btnDropCap.updateHint(this.tipDropCap),this.btnContentControls.updateHint(this.tipControls),this.btnColumns.updateHint(this.tipColumns),this.btnPageOrient.updateHint(this.tipPageOrient),this.btnPageSize.updateHint(this.tipPageSize),this.btnPageMargins.updateHint(this.tipPageMargins),this.btnLineNumbers.updateHint(this.tipLineNumbers),this.btnClearStyle.updateHint(this.tipClearStyle),this.btnCopyStyle.updateHint(this.tipCopyStyle+Common.Utils.String.platformKey("Alt+Ctrl+C")),this.btnColorSchemas.updateHint(this.tipColorSchemas),this.btnMailRecepients.updateHint(this.tipMailRecepients),this.btnHyphenation.updateHint(this.tipHyphenation),this.btnPageColor.updateHint(this.tipPageColor);for(var s=this,t=C.template('<a id="<%= id %>" tabindex="-1" type="menuitem"><div id="<%= options.previewId %>" class="menu-list-preview" style="width: 200px; height: 30px;"></div></a>'),e=[],i=[],n=0;n<9;n++)i.push("id-toolbar-menu-markers-level-"+n),e.push({template:t,previewId:i[n],level:n,checkable:!0});this.btnMarkers.setMenu(new Common.UI.Menu({cls:"shifted-left",style:"min-width: 145px",items:[{template:C.template('<div id="id-toolbar-menu-markers" class="menu-markers" style="width: 153px;"></div>')},{caption:"--"},this.mnuMarkerChangeLevel=new Common.UI.MenuItem({cls:"list-level",caption:this.textChangeLevel,disabled:0==(this.mnuMarkersPicker.conf.index||0),menu:new Common.UI.Menu({cls:"list-settings-level",menuAlign:"tl-tr",items:e,previewIds:i})}),this.mnuMarkerSettings=new Common.UI.MenuItem({caption:this.textListSettings,value:"settings"})]})),e=[];for(i=[],n=0;n<9;n++)i.push("id-toolbar-menu-numbering-level-"+n),e.push({template:t,previewId:i[n],level:n,checkable:!0});this.btnNumbers.setMenu(new Common.UI.Menu({cls:"shifted-left",items:[{template:C.template('<div id="id-toolbar-menu-numbering" class="menu-markers" style="width: 361px;"></div>')},{caption:"--"},this.mnuNumberChangeLevel=new Common.UI.MenuItem({cls:"list-level",caption:this.textChangeLevel,disabled:0==(this.mnuNumbersPicker.conf.index||0),menu:new Common.UI.Menu({cls:"list-settings-level",menuAlign:"tl-tr",items:e,previewIds:i})}),this.mnuNumberSettings=new Common.UI.MenuItem({caption:this.textListSettings,value:"settings"})]})),e=[],i=[];for(n=0;n<9;n++)i.push("id-toolbar-menu-multilevels-level-"+n),e.push({template:t,previewId:i[n],level:n,checkable:!0});this.btnMultilevels.setMenu(new Common.UI.Menu({cls:"shifted-left",style:"min-width: 177px",items:[{template:C.template('<div id="id-toolbar-menu-multilevels" class="menu-markers" style="width: 362px;"></div>')},{caption:"--"},this.mnuMultiChangeLevel=new Common.UI.MenuItem({cls:"list-level",caption:this.textChangeLevel,disabled:0==(this.mnuMultilevelPicker.conf.index||0),menu:new Common.UI.Menu({cls:"list-settings-level",menuAlign:"tl-tr",items:e,previewIds:i})}),this.mnuMultilevelSettings=new Common.UI.MenuItem({caption:this.textListSettings,value:"settings"})]}));var o=this.mnuPageNumCurrentPos.keepState,a=this.mnuInsertPageCount.keepState,l=this.mnuInsertPageNum.keepState,r=(this.btnEditHeader.setMenu(new Common.UI.Menu({items:[{caption:this.mniEditHeader,value:"header"},{caption:this.mniEditFooter,value:"footer"},{caption:"--"},{caption:this.mniRemoveHeader,value:"header-remove"},{caption:this.mniRemoveFooter,value:"footer-remove"},{caption:"--"},this.mnuInsertPageNum=new Common.UI.MenuItem({caption:this.textInsertPageNumber,lock:this.mnuInsertPageNum.options.lock,disabled:this.mnuInsertPageNum.isDisabled(),menu:new Common.UI.Menu({cls:"shifted-left",menuAlign:"tl-tr",style:"min-width: 90px;",items:[{template:C.template('<div id="id-toolbar-menu-pageposition" class="menu-pageposition"></div>')},this.mnuPageNumCurrentPos=new Common.UI.MenuItem({caption:this.textToCurrent,lock:this.mnuPageNumCurrentPos.options.lock,disabled:this.mnuPageNumCurrentPos.isDisabled(),value:"current"})]})}),this.mnuInsertPageCount=new Common.UI.MenuItem({caption:this.textInsertPageCount,lock:this.mnuInsertPageCount.options.lock,disabled:this.mnuInsertPageCount.isDisabled()})]})),this.mnuInsertPageNum.keepState=l,this.mnuPageNumCurrentPos.keepState=o,this.paragraphControls.push(this.mnuPageNumCurrentPos),this.lockControls.push(this.mnuPageNumCurrentPos),this.mnuInsertPageCount.keepState=a,this.paragraphControls.push(this.mnuInsertPageCount),this.lockControls.push(this.mnuInsertPageCount),this.btnInsertChart.setMenu(new Common.UI.Menu({style:"width: 364px;padding-top: 12px;",items:[{template:C.template('<div id="id-toolbar-menu-insertchart" class="menu-insertchart"></div>')}]})),function(t){new Common.UI.DataView({el:b("#id-toolbar-menu-insertchart"),parentMenu:t,showLast:!1,restoreHeight:535,groups:new Common.UI.DataViewGroupStore(Common.define.chartData.getChartGroupData()),store:new Common.UI.DataViewStore(Common.define.chartData.getChartData()),itemTemplate:C.template('<div id="<%= id %>" class="item-chartlist"><svg width="40" height="40" class="icon uni-scale"><use xlink:href="#chart-<%= iconCls %>"></use></svg></div>')}).on("item:click",function(t,e,i,n){i&&s.fireEvent("add:chart",[i.get("type")])}),t.off("show:before",r)});this.btnInsertChart.menu.on("show:before",r),this.btnInsertSmartArt.setMenu(new Common.UI.Menu({cls:"shifted-right",items:[]}));Common.define.smartArt.getSmartArtData().forEach(function(t,e){var i=t.items.length,i=i<5?78*i+9:399;s.btnInsertSmartArt.menu.addItem({caption:t.caption,value:t.sectionId,itemId:t.id,iconCls:t.icon?"menu__icon "+t.icon:void 0,menu:new Common.UI.Menu({items:[{template:C.template('<div id="'+t.id+'" class="menu-add-smart-art margin-left-5" style="width: '+i+'px; height: 500px;"></div>')}],menuAlign:"tl-tr"})})});var c=function(t){s.btnInsertSmartArt.menu.items.forEach(function(t,e){t.$el.one("mouseenter",function(){s.fireEvent("generate:smartart",[t.value]),t.$el.mouseenter()}),t.menuPicker=new Common.UI.DataView({el:b("#"+t.options.itemId),parentMenu:s.btnInsertSmartArt.menu.items[e].menu,itemTemplate:C.template(["<div>",'<img src="<%= imageUrl %>" width="70" height="70" />',"</div>"].join("")),store:new Common.UI.DataViewStore,delayRenderTips:!0,scrollAlwaysVisible:!0,showLast:!1}),t.menuPicker.on("item:click",function(t,e,i,n){i&&s.fireEvent("insert:smartart",[i.get("value")]),Common.NotificationCenter.trigger("edit:complete",s)})}),t.off("show:before",c)},d=(this.btnInsertSmartArt.menu.on("show:before",c),function(o){var t=DE.getCollection("Common.Collections.TextArt");t.length<1&&DE.getController("Main").fillTextArt(s.api.asc_getTextArtPreviews()),new Common.UI.DataView({el:b("#id-toolbar-menu-insart"),store:t,parentMenu:o,showLast:!1,itemTemplate:C.template('<div class="item-art"><img src="<%= imageUrl %>" id="<%= id %>" style="width:50px;height:50px;"></div>')}).on("item:click",function(t,e,i,n){i&&s.fireEvent("insert:textart",[i.get("data")]),"click"!==n.type&&o.hide()}),o.off("show:before",d)}),l=(this.btnInsertTextArt.menu.on("show:before",d),this.btnInsertText.setMenu(new Common.UI.Menu({items:[{caption:this.tipInsertHorizontalText,checkable:!0,checkmark:!1,iconCls:"menu__icon btn-text",toggleGroup:"textbox",value:"textRect",iconClsForMainBtn:"btn-big-text"},{caption:this.tipInsertVerticalText,checkable:!0,checkmark:!1,iconCls:"menu__icon btn-text-vertical",toggleGroup:"textbox",value:"textRectVertical",iconClsForMainBtn:"btn-big-text-vertical"}]})),this.specSymbols=[{symbol:8226,description:this.textBullet},{symbol:65509,description:this.textRmb},{symbol:8364,description:this.textEuro},{symbol:65284,description:this.textDollar},{symbol:169,description:this.textCopyright},{symbol:174,description:this.textRegistered},{symbol:189,description:this.textOneHalf},{symbol:188,description:this.textOneQuarter},{symbol:8800,description:this.textNotEqualTo},{symbol:177,description:this.textPlusMinus},{symbol:247,description:this.textDivision},{symbol:8730,description:this.textSquareRoot},{symbol:8804,description:this.textLessEqual},{symbol:8805,description:this.textGreaterEqual},{symbol:8482,description:this.textTradeMark},{symbol:8734,description:this.textInfinity},{symbol:126,description:this.textTilde},{symbol:176,description:this.textDegree},{symbol:167,description:this.textSection},{symbol:945,description:this.textAlpha},{symbol:946,description:this.textBetta},{symbol:960,description:this.textLetterPi},{symbol:916,description:this.textDelta},{symbol:9786,description:this.textSmile},{symbol:9829,description:this.textBlackHeart}],this.mnuInsertSymbolsPicker=new Common.UI.DataView({el:b("#id-toolbar-menu-symbols"),parentMenu:this.btnInsertSymbol.menu,outerMenu:{menu:this.btnInsertSymbol.menu,index:0},restoreHeight:290,delayRenderTips:!0,scrollAlwaysVisible:!0,store:new Common.UI.DataViewStore(this.loadRecentSymbolsFromStorage()),itemTemplate:C.template('<div class="item-symbol" <% if (typeof font !== "undefined" && font !=="") { %> style ="font-family: <%= font %>"<% } %>>&#<%= symbol %></div>')}),this.btnInsertSymbol.menu.setInnerMenu([{menu:this.mnuInsertSymbolsPicker,index:0}]),this.btnInsertSymbol.menu.on("show:before",C.bind(function(){this.mnuInsertSymbolsPicker.deselectAll()},this)),this.mnuMarkersPicker.conf),o=(this._markersArr=['{"Type":"remove"}','{"Type":"bullet","Lvl":[{"lvlJc":"left","suff":"tab","numFmt":{"val":"bullet"},"lvlText":"·","rPr":{"rFonts":{"ascii":"Symbol","cs":"Symbol","eastAsia":"Symbol","hAnsi":"Symbol"}}}]}','{"Type":"bullet","Lvl":[{"lvlJc":"left","suff":"tab","numFmt":{"val":"bullet"},"lvlText":"o","rPr":{"rFonts":{"ascii":"Courier New","cs":"Courier New","eastAsia":"Courier New","hAnsi":"Courier New"}}}]}','{"Type":"bullet","Lvl":[{"lvlJc":"left","suff":"tab","numFmt":{"val":"bullet"},"lvlText":"§","rPr":{"rFonts":{"ascii":"Wingdings","cs":"Wingdings","eastAsia":"Wingdings","hAnsi":"Wingdings"}}}]}','{"Type":"bullet","Lvl":[{"lvlJc":"left","suff":"tab","numFmt":{"val":"bullet"},"lvlText":"v","rPr":{"rFonts":{"ascii":"Wingdings","cs":"Wingdings","eastAsia":"Wingdings","hAnsi":"Wingdings"}}}]}','{"Type":"bullet","Lvl":[{"lvlJc":"left","suff":"tab","numFmt":{"val":"bullet"},"lvlText":"Ø","rPr":{"rFonts":{"ascii":"Wingdings","cs":"Wingdings","eastAsia":"Wingdings","hAnsi":"Wingdings"}}}]}','{"Type":"bullet","Lvl":[{"lvlJc":"left","suff":"tab","numFmt":{"val":"bullet"},"lvlText":"ü","rPr":{"rFonts":{"ascii":"Wingdings","cs":"Wingdings","eastAsia":"Wingdings","hAnsi":"Wingdings"}}}]}','{"Type":"bullet","Lvl":[{"lvlJc":"left","suff":"tab","numFmt":{"val":"bullet"},"lvlText":"¨","rPr":{"rFonts":{"ascii":"Symbol","cs":"Symbol","eastAsia":"Symbol","hAnsi":"Symbol"}}}]}','{"Type":"bullet","Lvl":[{"lvlJc":"left","suff":"tab","numFmt":{"val":"bullet"},"lvlText":"–","rPr":{"rFonts":{"ascii":"Arial","cs":"Arial","eastAsia":"Arial","hAnsi":"Arial"}}}]}'],{recentPath:"de-recent-bullets",recentCount:6,recentGroup:"menu-bullets-group-recent",docGroup:"menu-bullets-group-doc",docName:this.txtGroupBulletDoc}),a=this.loadListPresetsFromStorage(o.recentPath,o.recentGroup,o.recentCount),h=0<a.length?[{id:o.recentGroup,caption:this.txtGroupRecent,type:0}]:[],m="menu-bullets-group-lib",e=(h.push({id:m,caption:this.txtGroupBulletLib,type:1}),this.mnuMarkersPicker=new Common.UI.DataView({el:b("#id-toolbar-menu-markers"),parentMenu:this.btnMarkers.menu,outerMenu:{menu:this.btnMarkers.menu,index:0},restoreHeight:290,delayRenderTips:!0,scrollAlwaysVisible:!0,listSettings:o,groups:new Common.UI.DataViewGroupStore(h),store:new Common.UI.DataViewStore(a.concat([{id:"id-markers-"+Common.UI.getId(),numberingInfo:s._markersArr[0],skipRenderOnChange:!0,tip:this.textNone,group:m,type:1},{id:"id-markers-"+Common.UI.getId(),numberingInfo:s._markersArr[1],skipRenderOnChange:!0,tip:this.tipMarkersFRound,group:m,type:1},{id:"id-markers-"+Common.UI.getId(),numberingInfo:s._markersArr[2],skipRenderOnChange:!0,tip:this.tipMarkersHRound,group:m,type:1},{id:"id-markers-"+Common.UI.getId(),numberingInfo:s._markersArr[3],skipRenderOnChange:!0,tip:this.tipMarkersFSquare,group:m,type:1},{id:"id-markers-"+Common.UI.getId(),numberingInfo:s._markersArr[4],skipRenderOnChange:!0,tip:this.tipMarkersStar,group:m,type:1},{id:"id-markers-"+Common.UI.getId(),numberingInfo:s._markersArr[5],skipRenderOnChange:!0,tip:this.tipMarkersArrow,group:m,type:1},{id:"id-markers-"+Common.UI.getId(),numberingInfo:s._markersArr[6],skipRenderOnChange:!0,tip:this.tipMarkersCheckmark,group:m,type:1},{id:"id-markers-"+Common.UI.getId(),numberingInfo:s._markersArr[7],skipRenderOnChange:!0,tip:this.tipMarkersFRhombus,group:m,type:1},{id:"id-markers-"+Common.UI.getId(),numberingInfo:s._markersArr[8],skipRenderOnChange:!0,tip:this.tipMarkersDash,group:m,type:1}])),itemTemplate:C.template('<div id="<%= id %>" class="item-markerlist"></div>')}),this.btnMarkers.menu.setInnerMenu([{menu:this.mnuMarkersPicker,index:0}]),l&&this.mnuMarkersPicker.selectByIndex(l.index,!0),l=this.mnuNumbersPicker.conf,this._numbersArr=['{"Type":"remove"}','{"Type":"number","Lvl":[{"lvlJc":"left","suff":"tab","numFmt":{"val":"upperLetter"},"lvlText":"%1."}]}','{"Type":"number","Lvl":[{"lvlJc":"left","suff":"tab","numFmt":{"val":"lowerLetter"},"lvlText":"%1)"}]}','{"Type":"number","Lvl":[{"lvlJc":"left","suff":"tab","numFmt":{"val":"lowerLetter"},"lvlText":"%1."}]}','{"Type":"number","Lvl":[{"lvlJc":"right","suff":"tab","numFmt":{"val":"decimal"},"lvlText":"%1."}]}','{"Type":"number","Lvl":[{"lvlJc":"right","suff":"tab","numFmt":{"val":"decimal"},"lvlText":"%1)"}]}','{"Type":"number","Lvl":[{"lvlJc":"right","suff":"tab","numFmt":{"val":"upperRoman"},"lvlText":"%1."}]}','{"Type":"number","Lvl":[{"lvlJc":"right","suff":"tab","numFmt":{"val":"lowerRoman"},"lvlText":"%1."}]}','{"Type":"number","Lvl":[{"lvlJc":"left","numFmt":{"val":"russianUpper"},"lvlText":"%1."}]}','{"Type":"number","Lvl":[{"lvlJc":"left","numFmt":{"val":"russianUpper"},"lvlText":"%1)"}]}','{"Type":"number","Lvl":[{"lvlJc":"left","numFmt":{"val":"russianLower"},"lvlText":"%1."}]}','{"Type":"number","Lvl":[{"lvlJc":"left","numFmt":{"val":"russianLower"},"lvlText":"%1)"}]}'],o={recentPath:"de-recent-numbering",recentCount:8,recentGroup:"menu-numbering-group-recent",docGroup:"menu-numbering-group-doc",docName:this.txtGroupNumDoc},(h=0<(a=this.loadListPresetsFromStorage(o.recentPath,o.recentGroup,o.recentCount)).length?[{id:o.recentGroup,caption:this.txtGroupRecent,type:0}]:[]).push({id:m="menu-numbering-group-lib",caption:this.txtGroupNumLib,type:1}),[{id:"id-numbers-"+Common.UI.getId(),numberingInfo:this._numbersArr[0],skipRenderOnChange:!0,tip:this.textNone,group:m,type:1},{id:"id-numbers-"+Common.UI.getId(),numberingInfo:this._numbersArr[1],skipRenderOnChange:!0,tip:this.tipNumCapitalLetters,group:m,type:1},{id:"id-numbers-"+Common.UI.getId(),numberingInfo:this._numbersArr[2],skipRenderOnChange:!0,tip:this.tipNumLettersParentheses,group:m,type:1},{id:"id-numbers-"+Common.UI.getId(),numberingInfo:this._numbersArr[3],skipRenderOnChange:!0,tip:this.tipNumLettersPoints,group:m,type:1},{id:"id-numbers-"+Common.UI.getId(),numberingInfo:this._numbersArr[4],skipRenderOnChange:!0,tip:this.tipNumNumbersPoint,group:m,type:1},{id:"id-numbers-"+Common.UI.getId(),numberingInfo:this._numbersArr[5],skipRenderOnChange:!0,tip:this.tipNumNumbersParentheses,group:m,type:1},{id:"id-numbers-"+Common.UI.getId(),numberingInfo:this._numbersArr[6],skipRenderOnChange:!0,tip:this.tipNumRoman,group:m,type:1},{id:"id-numbers-"+Common.UI.getId(),numberingInfo:this._numbersArr[7],skipRenderOnChange:!0,tip:this.tipNumRomanSmall,group:m,type:1}]),p=("ru"===Common.Locale.getDefaultLanguage()&&(e=e.concat([{id:"id-numbers-"+Common.UI.getId(),numberingInfo:this._numbersArr[8],skipRenderOnChange:!0,tip:this.tipRusUpperPoints,group:m,type:1},{id:"id-numbers-"+Common.UI.getId(),numberingInfo:this._numbersArr[9],skipRenderOnChange:!0,tip:this.tipRusUpperParentheses,group:m,type:1},{id:"id-numbers-"+Common.UI.getId(),numberingInfo:this._numbersArr[10],skipRenderOnChange:!0,tip:this.tipRusLowerPoints,group:m,type:1},{id:"id-numbers-"+Common.UI.getId(),numberingInfo:this._numbersArr[11],skipRenderOnChange:!0,tip:this.tipRusLowerParentheses,group:m,type:1}])),this.mnuNumbersPicker=new Common.UI.DataView({el:b("#id-toolbar-menu-numbering"),parentMenu:this.btnNumbers.menu,outerMenu:{menu:this.btnNumbers.menu,index:0},restoreHeight:403,delayRenderTips:!0,scrollAlwaysVisible:!0,listSettings:o,groups:new Common.UI.DataViewGroupStore(h),store:new Common.UI.DataViewStore(a.concat(e)),itemTemplate:C.template('<div id="<%= id %>" class="item-multilevellist"></div>')}),this.btnNumbers.menu.setInnerMenu([{menu:this.mnuNumbersPicker,index:0}]),l&&this.mnuNumbersPicker.selectByIndex(l.index,!0),l=this.mnuMultilevelPicker.conf,o={recentPath:"de-recent-multilevels",recentCount:8,recentGroup:"menu-multilevels-group-recent",docGroup:"menu-multilevels-group-doc",docName:this.txtGroupMultiDoc},(h=0<(a=this.loadListPresetsFromStorage(o.recentPath,o.recentGroup,o.recentCount)).length?[{id:o.recentGroup,caption:this.txtGroupRecent,type:0}]:[]).push({id:m="menu-multilevels-group-lib",caption:this.txtGroupMultiLib,type:1}),"ru"===Common.Locale.getDefaultLanguage()?"Статья":"Article"),u="ru"===Common.Locale.getDefaultLanguage()?"Раздел":"Section",g="ru"===Common.Locale.getDefaultLanguage()?"Глава":"Chapter",p=(this._multilevelArr=['{"Type":"remove"}','{"Type":"number","Lvl":[{"lvlJc":"left","suff":"tab","numFmt":{"val":"decimal"},"lvlText":"%1)","pPr":{"ind":{"left":360,"firstLine":-360}}},{"lvlJc":"left","suff":"tab","numFmt":{"val":"lowerLetter"},"lvlText":"%2)","pPr":{"ind":{"left":720,"firstLine":-360}}},{"lvlJc":"left","suff":"tab","numFmt":{"val":"lowerRoman"},"lvlText":"%3)","pPr":{"ind":{"left":1080,"firstLine":-360}}},{"lvlJc":"left","suff":"tab","numFmt":{"val":"decimal"},"lvlText":"%4)","pPr":{"ind":{"left":1440,"firstLine":-360}}},{"lvlJc":"left","suff":"tab","numFmt":{"val":"lowerLetter"},"lvlText":"%5)","pPr":{"ind":{"left":1800,"firstLine":-360}}},{"lvlJc":"left","suff":"tab","numFmt":{"val":"lowerRoman"},"lvlText":"%6)","pPr":{"ind":{"left":2160,"firstLine":-360}}},{"lvlJc":"left","suff":"tab","numFmt":{"val":"decimal"},"lvlText":"%7)","pPr":{"ind":{"left":2520,"firstLine":-360}}},{"lvlJc":"left","suff":"tab","numFmt":{"val":"lowerLetter"},"lvlText":"%8)","pPr":{"ind":{"left":2880,"firstLine":-360}}},{"lvlJc":"left","suff":"tab","numFmt":{"val":"lowerRoman"},"lvlText":"%9)","pPr":{"ind":{"left":3240,"firstLine":-360}}}]}','{"Type":"number","Lvl":[{"lvlJc":"left","suff":"tab","numFmt":{"val":"decimal"},"lvlText":"%1.","pPr":{"ind":{"left":360,"firstLine":-360}}},{"lvlJc":"left","suff":"tab","numFmt":{"val":"decimal"},"lvlText":"%1.%2.","pPr":{"ind":{"left":792,"firstLine":-432}}},{"lvlJc":"left","suff":"tab","numFmt":{"val":"decimal"},"lvlText":"%1.%2.%3.","pPr":{"ind":{"left":1224,"firstLine":-504}}},{"lvlJc":"left","suff":"tab","numFmt":{"val":"decimal"},"lvlText":"%1.%2.%3.%4.","pPr":{"ind":{"left":1728,"firstLine":-648}}},{"lvlJc":"left","suff":"tab","numFmt":{"val":"decimal"},"lvlText":"%1.%2.%3.%4.%5.","pPr":{"ind":{"left":2232,"firstLine":-792}}},{"lvlJc":"left","suff":"tab","numFmt":{"val":"decimal"},"lvlText":"%1.%2.%3.%4.%5.%6.","pPr":{"ind":{"left":2736,"firstLine":-936}}},{"lvlJc":"left","suff":"tab","numFmt":{"val":"decimal"},"lvlText":"%1.%2.%3.%4.%5.%6.%7.","pPr":{"ind":{"left":3240,"firstLine":-1080}}},{"lvlJc":"left","suff":"tab","numFmt":{"val":"decimal"},"lvlText":"%1.%2.%3.%4.%5.%6.%7.%8.","pPr":{"ind":{"left":3744,"firstLine":-1224}}},{"lvlJc":"left","suff":"tab","numFmt":{"val":"decimal"},"lvlText":"%1.%2.%3.%4.%5.%6.%7.%8.%9.","pPr":{"ind":{"left":4320,"firstLine":-1440}}}]}','{"Type":"bullet","Lvl":[{"lvlJc":"left","suff":"tab","numFmt":{"val":"bullet"},"lvlText":"v","pPr":{"ind":{"left":360,"firstLine":-360}},"rPr":{"rFonts":{"ascii":"Wingdings","cs":"Wingdings","eastAsia":"Wingdings","hAnsi":"Wingdings"}}},{"lvlJc":"left","suff":"tab","numFmt":{"val":"bullet"},"lvlText":"Ø","pPr":{"ind":{"left":720,"firstLine":-360}},"rPr":{"rFonts":{"ascii":"Wingdings","cs":"Wingdings","eastAsia":"Wingdings","hAnsi":"Wingdings"}}},{"lvlJc":"left","suff":"tab","numFmt":{"val":"bullet"},"lvlText":"§","pPr":{"ind":{"left":1080,"firstLine":-360}},"rPr":{"rFonts":{"ascii":"Wingdings","cs":"Wingdings","eastAsia":"Wingdings","hAnsi":"Wingdings"}}},{"lvlJc":"left","suff":"tab","numFmt":{"val":"bullet"},"lvlText":"·","pPr":{"ind":{"left":1440,"firstLine":-360}},"rPr":{"rFonts":{"ascii":"Symbol","cs":"Symbol","eastAsia":"Symbol","hAnsi":"Symbol"}}},{"lvlJc":"left","suff":"tab","numFmt":{"val":"bullet"},"lvlText":"¨","pPr":{"ind":{"left":1800,"firstLine":-360}},"rPr":{"rFonts":{"ascii":"Symbol","cs":"Symbol","eastAsia":"Symbol","hAnsi":"Symbol"}}},{"lvlJc":"left","suff":"tab","numFmt":{"val":"bullet"},"lvlText":"Ø","pPr":{"ind":{"left":2160,"firstLine":-360}},"rPr":{"rFonts":{"ascii":"Wingdings","cs":"Wingdings","eastAsia":"Wingdings","hAnsi":"Wingdings"}}},{"lvlJc":"left","suff":"tab","numFmt":{"val":"bullet"},"lvlText":"§","pPr":{"ind":{"left":2520,"firstLine":-360}},"rPr":{"rFonts":{"ascii":"Wingdings","cs":"Wingdings","eastAsia":"Wingdings","hAnsi":"Wingdings"}}},{"lvlJc":"left","suff":"tab","numFmt":{"val":"bullet"},"lvlText":"·","pPr":{"ind":{"left":2880,"firstLine":-360}},"rPr":{"rFonts":{"ascii":"Symbol","cs":"Symbol","eastAsia":"Symbol","hAnsi":"Symbol"}}},{"lvlJc":"left","suff":"tab","numFmt":{"val":"bullet"},"lvlText":"¨","pPr":{"ind":{"left":3240,"firstLine":-360}},"rPr":{"rFonts":{"ascii":"Symbol","cs":"Symbol","eastAsia":"Symbol","hAnsi":"Symbol"}}}]}','{"Type":"number","Headings":true,"Lvl":[{"lvlJc":"left","suff":"tab","numFmt":{"val":"upperRoman"},"lvlText":"'+p+' %1.","pPr":{"ind":{"left":0,"firstLine":0}}},{"lvlJc":"left","suff":"tab","numFmt":{"val":"decimalZero"},"lvlText":"'+u+' %1.%2","pPr":{"ind":{"left":0,"firstLine":0}}},{"lvlJc":"left","suff":"tab","numFmt":{"val":"lowerLetter"},"lvlText":"(%3)","pPr":{"ind":{"left":720,"firstLine":-432}}},{"lvlJc":"right","suff":"tab","numFmt":{"val":"lowerRoman"},"lvlText":"(%4)","pPr":{"ind":{"left":864,"firstLine":-144}}},{"lvlJc":"left","suff":"tab","numFmt":{"val":"decimal"},"lvlText":"%5)","pPr":{"ind":{"left":1008,"firstLine":-432}}},{"lvlJc":"left","suff":"tab","numFmt":{"val":"lowerLetter"},"lvlText":"%6)","pPr":{"ind":{"left":1152,"firstLine":-432}}},{"lvlJc":"right","suff":"tab","numFmt":{"val":"lowerRoman"},"lvlText":"%7)","pPr":{"ind":{"left":1296,"firstLine":-288}}},{"lvlJc":"left","suff":"tab","numFmt":{"val":"lowerLetter"},"lvlText":"%8.","pPr":{"ind":{"left":1440,"firstLine":-432}}},{"lvlJc":"right","suff":"tab","numFmt":{"val":"lowerRoman"},"lvlText":"%9.","pPr":{"ind":{"left":1584,"firstLine":-144}}}]}','{"Type":"number","Headings":true,"Lvl":[{"lvlJc":"left","suff":"space","numFmt":{"val":"decimal"},"lvlText":"'+g+' %1","pPr":{"ind":{"left":0,"firstLine":0}}},{"lvlJc":"left","suff":"nothing","numFmt":{"val":"none"},"lvlText":"","pPr":{"ind":{"left":0,"firstLine":0}}},{"lvlJc":"left","suff":"nothing","numFmt":{"val":"none"},"lvlText":"","pPr":{"ind":{"left":0,"firstLine":0}}},{"lvlJc":"left","suff":"nothing","numFmt":{"val":"none"},"lvlText":"","pPr":{"ind":{"left":0,"firstLine":0}}},{"lvlJc":"left","suff":"nothing","numFmt":{"val":"none"},"lvlText":"","pPr":{"ind":{"left":0,"firstLine":0}}},{"lvlJc":"left","suff":"nothing","numFmt":{"val":"none"},"lvlText":"","pPr":{"ind":{"left":0,"firstLine":0}}},{"lvlJc":"left","suff":"nothing","numFmt":{"val":"none"},"lvlText":"","pPr":{"ind":{"left":0,"firstLine":0}}},{"lvlJc":"left","suff":"nothing","numFmt":{"val":"none"},"lvlText":"","pPr":{"ind":{"left":0,"firstLine":0}}},{"lvlJc":"left","suff":"nothing","numFmt":{"val":"none"},"lvlText":"","pPr":{"ind":{"left":0,"firstLine":0}}}]}','{"Type":"number","Headings":true,"Lvl":[{"lvlJc":"left","suff":"tab","numFmt":{"val":"upperRoman"},"lvlText":"%1.","pPr":{"ind":{"left":0,"firstLine":0}}},{"lvlJc":"left","suff":"tab","numFmt":{"val":"upperLetter"},"lvlText":"%2.","pPr":{"ind":{"left":720,"firstLine":0}}},{"lvlJc":"left","suff":"tab","numFmt":{"val":"decimal"},"lvlText":"%3.","pPr":{"ind":{"left":1440,"firstLine":0}}},{"lvlJc":"left","suff":"tab","numFmt":{"val":"lowerLetter"},"lvlText":"%4)","pPr":{"ind":{"left":2160,"firstLine":0}}},{"lvlJc":"left","suff":"tab","numFmt":{"val":"decimal"},"lvlText":"(%5)","pPr":{"ind":{"left":2880,"firstLine":0}}},{"lvlJc":"left","suff":"tab","numFmt":{"val":"lowerLetter"},"lvlText":"(%6)","pPr":{"ind":{"left":3600,"firstLine":0}}},{"lvlJc":"left","suff":"tab","numFmt":{"val":"lowerRoman"},"lvlText":"(%7)","pPr":{"ind":{"left":4320,"firstLine":0}}},{"lvlJc":"left","suff":"tab","numFmt":{"val":"lowerLetter"},"lvlText":"(%8)","pPr":{"ind":{"left":5040,"firstLine":0}}},{"lvlJc":"left","suff":"tab","numFmt":{"val":"lowerRoman"},"lvlText":"(%9)","pPr":{"ind":{"left":5760,"firstLine":0}}}]}','{"Type":"number","Headings":true,"Lvl":[{"lvlJc":"left","suff":"tab","numFmt":{"val":"decimal"},"lvlText":"%1.","pPr":{"ind":{"left":432,"firstLine":-432}}},{"lvlJc":"left","suff":"tab","numFmt":{"val":"decimal"},"lvlText":"%1.%2.","pPr":{"ind":{"left":576,"firstLine":-576}}},{"lvlJc":"left","suff":"tab","numFmt":{"val":"decimal"},"lvlText":"%1.%2.%3.","pPr":{"ind":{"left":720,"firstLine":-720}}},{"lvlJc":"left","suff":"tab","numFmt":{"val":"decimal"},"lvlText":"%1.%2.%3.%4.","pPr":{"ind":{"left":864,"firstLine":-864}}},{"lvlJc":"left","suff":"tab","numFmt":{"val":"decimal"},"lvlText":"%1.%2.%3.%4.%5.","pPr":{"ind":{"left":1008,"firstLine":-1008}}},{"lvlJc":"left","suff":"tab","numFmt":{"val":"decimal"},"lvlText":"%1.%2.%3.%4.%5.%6.","pPr":{"ind":{"left":1152,"firstLine":-1152}}},{"lvlJc":"left","suff":"tab","numFmt":{"val":"decimal"},"lvlText":"%1.%2.%3.%4.%5.%6.%7.","pPr":{"ind":{"left":1296,"firstLine":-1296}}},{"lvlJc":"left","suff":"tab","numFmt":{"val":"decimal"},"lvlText":"%1.%2.%3.%4.%5.%6.%7.%8.","pPr":{"ind":{"left":1440,"firstLine":-1440}}},{"lvlJc":"left","suff":"tab","numFmt":{"val":"decimal"},"lvlText":"%1.%2.%3.%4.%5.%6.%7.%8.%9.","pPr":{"ind":{"left":1584,"firstLine":-1584}}}]}'],this.mnuMultilevelPicker=new Common.UI.DataView({el:b("#id-toolbar-menu-multilevels"),parentMenu:this.btnMultilevels.menu,outerMenu:{menu:this.btnMultilevels.menu,index:0},restoreHeight:403,delayRenderTips:!0,scrollAlwaysVisible:!0,listSettings:o,groups:new Common.UI.DataViewGroupStore(h),store:new Common.UI.DataViewStore(a.concat([{id:"id-multilevels-"+Common.UI.getId(),numberingInfo:this._multilevelArr[0],skipRenderOnChange:!0,tip:this.textNone,group:m,type:1},{id:"id-multilevels-"+Common.UI.getId(),numberingInfo:this._multilevelArr[1],skipRenderOnChange:!0,tip:this.tipMultiLevelVarious,group:m,type:1},{id:"id-multilevels-"+Common.UI.getId(),numberingInfo:this._multilevelArr[2],skipRenderOnChange:!0,tip:this.tipMultiLevelNumbered,group:m,type:1},{id:"id-multilevels-"+Common.UI.getId(),numberingInfo:this._multilevelArr[3],skipRenderOnChange:!0,tip:this.tipMultiLevelSymbols,group:m,type:1},{id:"id-multilevels-"+Common.UI.getId(),numberingInfo:this._multilevelArr[4],skipRenderOnChange:!0,tip:this.tipMultiLevelArticl,group:m,type:1},{id:"id-multilevels-"+Common.UI.getId(),numberingInfo:this._multilevelArr[5],skipRenderOnChange:!0,tip:this.tipMultiLevelChapter,group:m,type:1},{id:"id-multilevels-"+Common.UI.getId(),numberingInfo:this._multilevelArr[6],skipRenderOnChange:!0,tip:this.tipMultiLevelHeadings,group:m,type:1},{id:"id-multilevels-"+Common.UI.getId(),numberingInfo:this._multilevelArr[7],skipRenderOnChange:!0,tip:this.tipMultiLevelHeadVarious,group:m,type:1}])),itemTemplate:C.template('<div id="<%= id %>" class="item-multilevellist"></div>')}),this.btnMultilevels.menu.setInnerMenu([{menu:this.mnuMultilevelPicker,index:0}]),l&&this.mnuMultilevelPicker.selectByIndex(l.index,!0),l=this.mnuPageNumberPosPicker?this.mnuPageNumberPosPicker.conf:void 0,this.mnuPageNumberPosPicker?this.mnuPageNumberPosPicker.keepState:void 0);this.mnuPageNumberPosPicker=new Common.UI.DataView({el:b("#id-toolbar-menu-pageposition"),lock:this.mnuPageNumberPosPicker.options.lock,allowScrollbar:!1,parentMenu:this.mnuInsertPageNum.menu,outerMenu:{menu:this.mnuInsertPageNum.menu,index:0},showLast:!1,store:new Common.UI.DataViewStore([{iconname:"btn-page-number-top-left",data:{type:c_pageNumPosition.PAGE_NUM_POSITION_TOP,subtype:c_pageNumPosition.PAGE_NUM_POSITION_LEFT}},{iconname:"btn-page-number-top-center",data:{type:c_pageNumPosition.PAGE_NUM_POSITION_TOP,subtype:c_pageNumPosition.PAGE_NUM_POSITION_CENTER}},{iconname:"btn-page-number-top-right",data:{type:c_pageNumPosition.PAGE_NUM_POSITION_TOP,subtype:c_pageNumPosition.PAGE_NUM_POSITION_RIGHT}},{iconname:"btn-page-number-bottom-left",data:{type:c_pageNumPosition.PAGE_NUM_POSITION_BOTTOM,subtype:c_pageNumPosition.PAGE_NUM_POSITION_LEFT}},{iconname:"btn-page-number-bottom-center",data:{type:c_pageNumPosition.PAGE_NUM_POSITION_BOTTOM,subtype:c_pageNumPosition.PAGE_NUM_POSITION_CENTER}},{iconname:"btn-page-number-bottom-right",data:{type:c_pageNumPosition.PAGE_NUM_POSITION_BOTTOM,subtype:c_pageNumPosition.PAGE_NUM_POSITION_RIGHT}}]),itemTemplate:C.template('<div id="<%= id %>" class="item-pagenumber options__icon options__icon-huge <%= iconname %>"></div>')}),this.mnuPageNumberPosPicker.keepState=p,l&&this.mnuPageNumberPosPicker.setDisabled(l.disabled),this.mnuInsertPageNum.menu.setInnerMenu([{menu:this.mnuPageNumberPosPicker,index:0}]),this.mnuTablePicker=new Common.UI.DimensionPicker({el:b("#id-toolbar-menu-tablepicker"),minRows:8,minColumns:10,maxRows:8,maxColumns:10})},onToolbarAfterRender:function(t){this.btnHighlightColor.cmpEl&&(this.btnHighlightColor.currentColor="FFFF00",this.btnHighlightColor.setColor(this.btnHighlightColor.currentColor),this.mnuHighlightColorPicker=new Common.UI.ThemeColorPalette({el:b("#id-toolbar-menu-highlight"),colors:["FFFF00","00FF00","00FFFF","FF00FF","0000FF","FF0000","00008B","008B8B","006400","800080","8B0000","808000","FFFFFF","D3D3D3","A9A9A9","000000"],colorHints:[Common.Utils.ThemeColor.txtYellow,Common.Utils.ThemeColor.txtBrightGreen,Common.Utils.ThemeColor.txtTurquosie,Common.Utils.ThemeColor.txtPink,Common.Utils.ThemeColor.txtBlue,Common.Utils.ThemeColor.txtRed,Common.Utils.ThemeColor.txtDarkBlue,Common.Utils.ThemeColor.txtTeal,Common.Utils.ThemeColor.txtGreen,Common.Utils.ThemeColor.txtViolet,Common.Utils.ThemeColor.txtDarkRed,Common.Utils.ThemeColor.txtDarkYellow,Common.Utils.ThemeColor.txtWhite,Common.Utils.ThemeColor.txtGray+"-25%",Common.Utils.ThemeColor.txtGray+"-50%",Common.Utils.ThemeColor.txtBlack],value:"FFFF00",dynamiccolors:0,themecolors:0,effects:0,columns:4,outerMenu:{menu:this.btnHighlightColor.menu,index:0,focusOnShow:!0}}),this.btnHighlightColor.setPicker(this.mnuHighlightColorPicker),this.btnHighlightColor.menu.setInnerMenu([{menu:this.mnuHighlightColorPicker,index:0}])),this.btnFontColor.cmpEl&&(this.btnFontColor.setMenu(),this.mnuFontColorPicker=this.btnFontColor.getPicker(),this.btnFontColor.setColor(this.btnFontColor.currentColor||"transparent")),this.btnParagraphColor.cmpEl&&(this.btnParagraphColor.setMenu(),this.mnuParagraphColorPicker=this.btnParagraphColor.getPicker(),this.btnParagraphColor.setColor(this.btnParagraphColor.currentColor||"transparent")),this.btnContentControls.cmpEl&&(this.mnuControlsColorPicker=new Common.UI.ThemeColorPalette({el:b("#id-toolbar-menu-controls-color"),colors:["000000","993300","333300","003300","003366","000080","333399","333333","800000","FF6600","808000","00FF00","008080","0000FF","666699","808080","FF0000","FF9900","99CC00","339966","33CCCC","3366FF","800080","999999","FF00FF","FFCC00","FFFF00","00FF00","00FFFF","00CCFF","993366","C0C0C0","FF99CC","FFCC99","FFFF99","CCFFCC","CCFFFF","C9C8FF","CC99FF","FFFFFF"],themecolors:0,effects:0,outerMenu:{menu:this.mnuHighlightControls,index:2}}),this.mnuHighlightControls.setInnerMenu([{menu:this.mnuControlsColorPicker,index:2}])),this.btnPageColor.cmpEl&&(this.btnPageColor.setMenu(),this.mnuPageColorPicker=this.btnPageColor.getPicker())},updateMetricUnit:function(){for(var t=this.btnPageMargins.menu.items,e=0;e<t.length;e++)(i=t[e]).checkable&&(n=i.checked,b(i.el).html(i.template({id:Common.UI.getId(),caption:i.caption,options:i.options})),n&&i.setChecked(n));for(var i,n,t=this.btnPageSize.menu.items,e=0;e<t.length;e++)(i=t[e]).checkable&&(n=i.checked,b(i.el).html(i.template({id:Common.UI.getId(),caption:i.caption,options:i.options})),n&&i.setChecked(n))},setApi:function(t){return this.api=t,this.api.asc_registerCallback("asc_onSendThemeColorSchemes",C.bind(this.onSendThemeColorSchemes,this)),this.api.asc_registerCallback("asc_onCollaborativeChanges",C.bind(this.onCollaborativeChanges,this)),this.api.asc_registerCallback("asc_onAuthParticipantsChanged",C.bind(this.onApiUsersChanged,this)),this.api.asc_registerCallback("asc_onParticipantsChanged",C.bind(this.onApiUsersChanged,this)),this},setMode:function(t){t.isDisconnected?(this.lockToolbar(Common.enumLock.lostConnect,!0),this.synchTooltip&&this.synchTooltip.hide(),t.enableDownload||this.lockToolbar(Common.enumLock.cantPrint,!0,{array:[this.btnPrint]})):(this.lockToolbar(Common.enumLock.cantPrint,!t.canPrint,{array:[this.btnPrint]}),t.canPrint||this.btnPrint.hide()),this.mode=t,this.btnMailRecepients.setVisible(1==t.canCoAuthoring&&t.canUseMailMerge),this.listStylesAdditionalMenuItem.setVisible(t.canEditStyles),this.btnContentControls.menu.items[10].setVisible(t.canEditContentControl),this.mnuInsertImage.items[2].setVisible(this.mode.canRequestInsertImage||this.mode.fileChoiceUrl&&-1<this.mode.fileChoiceUrl.indexOf("{documentType}"))},onSendThemeColorSchemes:function(t){var a=this,l=(this.mnuColorSchema&&0<this.mnuColorSchema.items.length&&C.each(this.mnuColorSchema.items,function(t){t.remove()}),null==this.mnuColorSchema&&(this.mnuColorSchema=new Common.UI.Menu({cls:"shifted-left",restoreHeight:!0})),this.mnuColorSchema.items=[],C.template(['<a id="<%= id %>"  tabindex="-1" type="menuitem" class="<%= options.cls %>">','<span class="colors">',"<% _.each(options.colors, function(color) { %>",'<span class="color" style="background: <%= color %>;"></span>',"<% }) %>","</span>",'<span class="text"><%= caption %></span>',"</a>"].join("")));C.each(t,function(t,e){for(var i=t.get_colors(),n=[],o=2;o<7;o++){var s="#"+Common.Utils.ThemeColor.getHexColor(i[o].get_r(),i[o].get_g(),i[o].get_b());n.push(s)}22==e&&this.mnuColorSchema.addItem({caption:"--"});t=t.get_name();this.mnuColorSchema.addItem({template:l,cls:"color-schemas-menu",colors:n,caption:e<22&&a.SchemeNames[e]||t,value:e,checkable:!0,toggleGroup:"menuSchema"})},this)},onCollaborativeChanges:function(){this._state.hasCollaborativeChanges||(!this.btnCollabChanges.rendered||this._state.previewmode?this.needShowSynchTip=!0:(this._state.hasCollaborativeChanges=!0,this.btnCollabChanges.cmpEl.addClass("notify"),this.showSynchTip?(this.btnCollabChanges.updateHint(""),void 0===this.synchTooltip&&this.createSynchTip(),this.synchTooltip.show()):this.btnCollabChanges.updateHint(this.tipSynchronize+Common.Utils.String.platformKey("Ctrl+S")),this.btnSave.setDisabled(!1),Common.Gateway.collaborativeChanges()))},createSynchTip:function(){this.synchTooltip=new Common.UI.SynchronizeTip({extCls:this.mode.customization&&this.mode.customization.compactHeader?void 0:"inc-index",placement:"right-bottom",target:this.btnCollabChanges.$el}),this.synchTooltip.on("dontshowclick",function(){this.showSynchTip=!1,this.synchTooltip.hide(),this.btnCollabChanges.updateHint(this.tipSynchronize+Common.Utils.String.platformKey("Ctrl+S")),Common.localStorage.setItem("de-hide-synch",1)},this),this.synchTooltip.on("closeclick",function(){this.synchTooltip.hide(),this.btnCollabChanges.updateHint(this.tipSynchronize+Common.Utils.String.platformKey("Ctrl+S"))},this)},synchronizeChanges:function(){!this._state.previewmode&&this.btnCollabChanges.rendered&&this.btnCollabChanges.cmpEl.hasClass("notify")&&(this.btnCollabChanges.cmpEl.removeClass("notify"),this.synchTooltip&&this.synchTooltip.hide(),this.btnCollabChanges.updateHint(this.btnSaveTip),this.btnSave.setDisabled(!this.mode.forcesave),this._state.hasCollaborativeChanges=!1)},onApiUsersChanged:function(t){var e=[],t=(C.each(t,function(t){t.asc_getView()||e.push(t)}),this),i=C.size(e),n=1<i?"btn-save-coauth":"btn-save";n!==t.btnSaveCls&&t.btnCollabChanges.rendered&&(t.btnSaveTip=(1<i?t.tipSaveCoauth:t.tipSave)+Common.Utils.String.platformKey("Ctrl+S"),t.btnCollabChanges.updateHint(t.btnSaveTip),t.btnCollabChanges.$icon.removeClass(t.btnSaveCls).addClass(n),t.btnSaveCls=n)},onStyleMenuUpdate:function(t,e,i){var n,o,s=this;s.api&&(n=s.api.asc_GetStyleFromFormatting(),t=t.styleTitle,o=n.get_Link(),n.put_Name(t),o.put_Name(t+"_character"),s.api.asc_AddNewStyle(n),setTimeout(function(){s.listStyles.openButton.menu.hide()},100))},onStyleMenuDelete:function(t,e,i){this.api&&this.api.asc_RemoveStyle(t.styleTitle)},onStyleMenuRestoreAll:function(t,e,i){var n=this;n.api&&C.each(window.styles.get_MergedStyles(),function(t){n.api.asc_IsStyleDefault(t.get_Name())&&n.api.asc_RemoveStyle(t.get_Name())})},onStyleMenuDeleteAll:function(t,e,i){this.api&&this.api.asc_RemoveAllCustomStyles()},onUpdateLastCustomMargins:function(t){var e,i,n,o;this.btnPageMargins&&(e=t?t.get_TopMargin():Common.localStorage.getItem("de-pgmargins-top"),i=t?t.get_LeftMargin():Common.localStorage.getItem("de-pgmargins-left"),n=t?t.get_BottomMargin():Common.localStorage.getItem("de-pgmargins-bottom"),t=t?t.get_RightMargin():Common.localStorage.getItem("de-pgmargins-right"),null!==e&&null!==i&&null!==n&&null!==t?((o=this.btnPageMargins.menu.items[0]).options.value=o.value=[parseFloat(e),parseFloat(i),parseFloat(n),parseFloat(t)],o.setVisible(!0),b(o.el).html(o.template({id:Common.UI.getId(),caption:o.caption,options:o.options}))):this.btnPageMargins.menu.items[0].setVisible(!1))},loadRecentSymbolsFromStorage:function(){var t=Common.localStorage.getItem("de-fastRecentSymbols"),t=t?JSON.parse(t):[{symbol:8226,font:"Arial"},{symbol:65509,font:"Arial"},{symbol:8364,font:"Arial"},{symbol:65284,font:"Arial"},{symbol:169,font:"Arial"},{symbol:174,font:"Arial"},{symbol:189,font:"Arial"},{symbol:188,font:"Arial"},{symbol:8800,font:"Arial"},{symbol:177,font:"Arial"},{symbol:247,font:"Arial"},{symbol:8730,font:"Arial"},{symbol:8804,font:"Arial"},{symbol:8805,font:"Arial"},{symbol:8482,font:"Arial"},{symbol:8734,font:"Arial"},{symbol:126,font:"Arial"},{symbol:176,font:"Arial"},{symbol:167,font:"Arial"},{symbol:945,font:"Arial"},{symbol:946,font:"Arial"},{symbol:960,font:"Arial"},{symbol:916,font:"Arial"},{symbol:9786,font:"Arial"},{symbol:9829,font:"Arial"}];return t.forEach(function(t){t.tip=this.getSymbolDescription(t.symbol)}.bind(this)),t},saveSymbol:function(e,i){var t=this.mnuInsertSymbolsPicker,n=t.store.find(function(t){return t.get("symbol")==e&&t.get("font")==i}),n=(n&&t.store.remove(n),t.store.add({symbol:e,font:i,tip:this.getSymbolDescription(e)},{at:0}),25<t.store.length&&t.store.remove(t.store.last()),t.store.map(function(t){return{symbol:t.get("symbol"),font:t.get("font")}})),t=JSON.stringify(n);Common.localStorage.setItem("de-fastRecentSymbols",t)},getSymbolDescription:function(e){var t=this.specSymbols.find(function(t){return t.symbol==e});return t?t.description:this.capBtnInsSymbol+": "+e},loadListPresetsFromStorage:function(t,e,i){for(var n=[],o=(o=Common.localStorage.getItem(t))?JSON.parse(o):[],s=0;s<o.length&&s<i;s++)n.push({id:"id-recent-list-"+Common.UI.getId(),numberingInfo:o[s],skipRenderOnChange:!0,group:e,type:0});return n},saveListPresetToStorage:function(t){var e;t&&(e=[],C.each(t.store.where({type:0}),function(t){e.push(t.get("numberingInfo"))}),Common.localStorage.setItem(t.options.listSettings.recentPath,JSON.stringify(e)))},lockToolbar:function(t,e,i){Common.Utils.lockControls(t,e,i,this.lockControls)}},DE.Views.Toolbar||{}))}),void 0===Common&&(Common={}),define("documenteditor/main/app/view/StyleTitleDialog",["common/main/lib/util/utils","common/main/lib/component/InputField","common/main/lib/component/Window"],function(){"use strict";DE.Views.StyleTitleDialog=Common.UI.Window.extend(_.extend({options:{width:350,height:196,style:"min-width: 230px;",cls:"modal-dlg",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:this.textHeader},t||{}),this.template=['<div class="box">','<label class="input-row" style="margin-bottom: -5px;">'+this.textTitle+" </label>",'<div id="id-dlg-style-title" class="input-row" style="margin-bottom: 5px;"></div>','<label class="input-row" style="margin-bottom: -5px; margin-top: 5px;">'+this.textNextStyle+"</label>",'<div id="id-dlg-style-next-par" class="input-group-nr" style="margin-bottom: 5px;" ></div>',"</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),this.options.formats=this.options.formats||[],Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var e=this,t=this.getChild();e.inputTitle=new Common.UI.InputField({el:$("#id-dlg-style-title"),allowBlank:!1,blankError:e.txtEmpty,style:"width: 100%;",validateOnBlur:!1,validation:function(t){return""!=(t=t.trim())||e.txtNotEmpty}}),t.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.options.formats.unshift({value:-1,displayValue:this.txtSameAs}),this.cmbNextStyle=new Common.UI.ComboBox({el:$("#id-dlg-style-next-par"),style:"width: 100%;",menuStyle:"width: 100%; max-height: 210px;",editable:!1,takeFocusOnClose:!0,cls:"input-group-nr",data:this.options.formats,disabled:0==this.options.formats.length}),this.cmbNextStyle.setValue(-1)},getFocusedComponents:function(){return[this.inputTitle,this.cmbNextStyle]},getDefaultFocusableComponent:function(){return this.inputTitle},getTitle:function(){return this.inputTitle.getValue().trim()},getNextStyle:function(){var t=this.cmbNextStyle.getValue();return-1!=t?t:null},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onPrimary:function(t){return this._handleInput("ok"),!1},_handleInput:function(t){if(this.options.handler){if("ok"==t)if(!0!==this.inputTitle.checkValidate())return void this.inputTitle.focus();this.options.handler.call(this,this,t)}this.close()}},DE.Views.StyleTitleDialog||{}))}),define("documenteditor/main/app/view/PageMarginsDialog",["common/main/lib/component/Window","common/main/lib/component/MetricSpinner"],function(){"use strict";DE.Views.PageMarginsDialog=Common.UI.Window.extend(_.extend({options:{width:404,header:!0,style:"min-width: 404px;",cls:"modal-dlg",id:"window-page-margins",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:this.textTitle},t||{}),this.template=['<div class="box" style="height: 245px;">','<div class="float-left">','<label class="font-weight-bold">'+this.textTitle+"</label>",'<div style="margin-top: 2px;">','<div style="display: inline-block;">','<label class="input-label">'+this.textTop+"</label>",'<div id="page-margins-spin-top"></div>',"</div>",'<div class="margin-left-8" style="display: inline-block;">','<label class="input-label">'+this.textBottom+"</label>",'<div id="page-margins-spin-bottom"></div>',"</div>","</div>",'<div style="margin-top: 4px;">','<div style="display: inline-block;">','<label class="input-label" id="margin-left-label">'+this.textLeft+"</label>",'<div id="page-margins-spin-left"></div>',"</div>",'<div class="margin-left-8" style="display: inline-block;">','<label class="input-label" id="margin-right-label">'+this.textRight+"</label>",'<div id="page-margins-spin-right"></div>',"</div>","</div>",'<div style="margin-top: 10px;">','<label class="font-weight-bold">'+this.textGutterPosition+"</label>","<div>",'<div style="display: inline-block;" id="page-margins-spin-gutter"></div>','<div style="display: inline-block;" id="page-margins-spin-gutter-position" class="margin-left-8"></div>',"</div>","</div>",'<div style="margin-top: 10px;">','<label class="font-weight-bold">'+this.textOrientation+"</label>",'<div id="page-margins-cmb-orientation"></div>',"</div>",'<div style="margin-top: 10px;">','<label class="font-weight-bold">'+this.textMultiplePages+"</label>",'<div id="page-margins-cmb-multiple-pages"></div>',"</div>","</div>",'<div class="float-right">','<label class="font-weight-bold">'+this.textPreview+"</label>",'<div id="page-margins-preview" style="margin-top: 2px; height: 120px; width: 162px;"></div>',"</div>","</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),this.spinners=[],this._noApply=!1,this.maxMarginsW=this.maxMarginsH=0,this.api=this.options.api,Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this),this.spnTop=new Common.UI.MetricSpinner({el:$("#page-margins-spin-top"),step:.1,width:86,defaultUnit:"cm",value:"1 cm",maxValue:55.88,minValue:-55.87}),this.spnTop.on("change",_.bind(function(t,e,i){this.api&&(this.properties=this.properties||new Asc.CDocumentSectionProps,this.properties.put_TopMargin(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())),this.api.SetDrawImagePreviewMargins("page-margins-preview",this.properties))},this)),this.spinners.push(this.spnTop),this.spnBottom=new Common.UI.MetricSpinner({el:$("#page-margins-spin-bottom"),step:.1,width:86,defaultUnit:"cm",value:"1 cm",maxValue:55.88,minValue:-55.87}),this.spnBottom.on("change",_.bind(function(t,e,i){this.api&&(this.properties=this.properties||new Asc.CDocumentSectionProps,this.properties.put_BottomMargin(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())),this.api.SetDrawImagePreviewMargins("page-margins-preview",this.properties))},this)),this.spinners.push(this.spnBottom),this.spnLeft=new Common.UI.MetricSpinner({el:$("#page-margins-spin-left"),step:.1,width:86,defaultUnit:"cm",value:"1 cm",maxValue:55.88,minValue:0}),this.spnLeft.on("change",_.bind(function(t,e,i){this.api&&(this.properties=this.properties||new Asc.CDocumentSectionProps,this.properties.put_LeftMargin(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())),this.api.SetDrawImagePreviewMargins("page-margins-preview",this.properties))},this)),this.spinners.push(this.spnLeft),this.spnRight=new Common.UI.MetricSpinner({el:$("#page-margins-spin-right"),step:.1,width:86,defaultUnit:"cm",value:"1 cm",maxValue:55.88,minValue:0}),this.spnRight.on("change",_.bind(function(t,e,i){this.api&&(this.properties=this.properties||new Asc.CDocumentSectionProps,this.properties.put_RightMargin(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())),this.api.SetDrawImagePreviewMargins("page-margins-preview",this.properties))},this)),this.spinners.push(this.spnRight),this.spnGutter=new Common.UI.MetricSpinner({el:$("#page-margins-spin-gutter"),step:.1,width:86,defaultUnit:"cm",value:"1 cm",maxValue:55.88,minValue:0}),this.spnGutter.on("change",_.bind(function(t,e,i){this.api&&(this.properties=this.properties||new Asc.CDocumentSectionProps,this.properties.put_Gutter(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())),this.api.SetDrawImagePreviewMargins("page-margins-preview",this.properties))},this)),this.spinners.push(this.spnGutter),this.cmbGutterPosition=new Common.UI.ComboBox({el:$("#page-margins-spin-gutter-position"),menuStyle:"min-width: 86px;",style:"width: 86px;",editable:!1,takeFocusOnClose:!0,cls:"input-group-nr",data:[{value:0,displayValue:this.textLeft},{value:1,displayValue:this.textTop}]}),this.cmbGutterPosition.on("selected",_.bind(function(t,e){this.api&&(this.properties=this.properties||new Asc.CDocumentSectionProps,this.properties.put_GutterAtTop(e.value),this.api.SetDrawImagePreviewMargins("page-margins-preview",this.properties))},this)),this.cmbOrientation=new Common.UI.ComboBox({el:$("#page-margins-cmb-orientation"),menuStyle:"min-width: 180px;",style:"width: 180px;",editable:!1,takeFocusOnClose:!0,cls:"input-group-nr",data:[{value:0,displayValue:this.textPortrait},{value:1,displayValue:this.textLandscape}]}),this.cmbOrientation.on("selected",_.bind(function(t,e){var i;this.api&&(this.properties=this.properties||new Asc.CDocumentSectionProps,this.properties.get_Orientation()!==e.value&&(this.properties.put_TopMargin(Common.Utils.Metric.fnRecalcToMM((e.value?this.spnLeft:this.spnRight).getNumberValue())),this.properties.put_BottomMargin(Common.Utils.Metric.fnRecalcToMM((e.value?this.spnRight:this.spnLeft).getNumberValue())),this.properties.put_LeftMargin(Common.Utils.Metric.fnRecalcToMM((e.value?this.spnBottom:this.spnTop).getNumberValue())),this.properties.put_RightMargin(Common.Utils.Metric.fnRecalcToMM((e.value?this.spnTop:this.spnBottom).getNumberValue())),i=this.properties.get_H(),this.properties.put_H(this.properties.get_W()),this.properties.put_W(i),this.properties.put_Orientation(e.value),this.maxMarginsH=Common.Utils.Metric.fnRecalcFromMM(this.properties.get_H()-2.6),this.maxMarginsW=Common.Utils.Metric.fnRecalcFromMM(this.properties.get_W()-12.7),this.spnTop.setMaxValue(this.maxMarginsH),this.spnBottom.setMaxValue(this.maxMarginsH),this.spnLeft.setMaxValue(this.maxMarginsW),this.spnRight.setMaxValue(this.maxMarginsW),this.spnTop.setValue(Common.Utils.Metric.fnRecalcFromMM(this.properties.get_TopMargin()),!0),this.spnBottom.setValue(Common.Utils.Metric.fnRecalcFromMM(this.properties.get_BottomMargin()),!0),this.spnLeft.setValue(Common.Utils.Metric.fnRecalcFromMM(this.properties.get_LeftMargin()),!0),this.spnRight.setValue(Common.Utils.Metric.fnRecalcFromMM(this.properties.get_RightMargin()),!0),this.api.SetDrawImagePreviewMargins("page-margins-preview",this.properties)))},this)),this.cmbMultiplePages=new Common.UI.ComboBox({el:$("#page-margins-cmb-multiple-pages"),menuStyle:"min-width: 180px;",style:"width: 180px;",editable:!1,takeFocusOnClose:!0,cls:"input-group-nr",data:[{value:0,displayValue:this.textNormal},{value:1,displayValue:this.textMirrorMargins}]}),this.cmbMultiplePages.on("selected",_.bind(function(t,e){0===e.value?(this.window.find("#margin-left-label").html(this.textLeft),this.window.find("#margin-right-label").html(this.textRight),this.cmbGutterPosition.setDisabled(!1)):(this.window.find("#margin-left-label").html(this.textInside),this.window.find("#margin-right-label").html(this.textOutside),this.cmbGutterPosition.setValue(0),this.cmbGutterPosition.setDisabled(!0)),this.api&&(this.properties=this.properties||new Asc.CDocumentSectionProps,this.properties.put_MirrorMargins(e.value),this.api.SetDrawImagePreviewMargins("page-margins-preview",this.properties))},this)),this.window=this.getChild(),this.window.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.on("animate:after",_.bind(this.onAnimateAfter,this)),this.updateMetricUnit()},getFocusedComponents:function(){return[this.spnTop,this.spnBottom,this.spnLeft,this.spnRight,this.spnGutter,this.cmbGutterPosition,this.cmbOrientation,this.cmbMultiplePages]},getDefaultFocusableComponent:function(){return this.spnTop},onAnimateAfter:function(){this.api&&this.properties&&this.api.SetDrawImagePreviewMargins("page-margins-preview",this.properties)},_handleInput:function(t){if(this.options.handler){if("ok"==t){var e=null;if(this.spnLeft.getNumberValue()+this.spnRight.getNumberValue()+(this.cmbGutterPosition.getValue()?0:this.spnGutter.getNumberValue())>this.maxMarginsW?e=this.txtMarginsW:Math.abs(this.spnTop.getNumberValue()+this.spnBottom.getNumberValue()+(this.cmbGutterPosition.getValue()?this.spnGutter.getNumberValue():0))>this.maxMarginsH&&(e=this.txtMarginsH),e)return void Common.UI.warning({title:this.notcriticalErrorTitle,msg:e})}this.options.handler.call(this,this,t)}this.close()},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onPrimary:function(t){return this._handleInput("ok"),!1},setSettings:function(t){t&&(this.properties=t,this.maxMarginsH=Common.Utils.Metric.fnRecalcFromMM(t.get_H()-2.6),this.maxMarginsW=Common.Utils.Metric.fnRecalcFromMM(t.get_W()-12.7),this.spnTop.setMaxValue(this.maxMarginsH),this.spnBottom.setMaxValue(this.maxMarginsH),this.spnLeft.setMaxValue(this.maxMarginsW),this.spnRight.setMaxValue(this.maxMarginsW),this.spnTop.setValue(Common.Utils.Metric.fnRecalcFromMM(t.get_TopMargin()),!0),this.spnBottom.setValue(Common.Utils.Metric.fnRecalcFromMM(t.get_BottomMargin()),!0),this.spnLeft.setValue(Common.Utils.Metric.fnRecalcFromMM(t.get_LeftMargin()),!0),this.spnRight.setValue(Common.Utils.Metric.fnRecalcFromMM(t.get_RightMargin()),!0),this.cmbOrientation.setValue(t.get_Orientation()),this.spnGutter.setValue(Common.Utils.Metric.fnRecalcFromMM(t.get_Gutter()),!0),this.cmbGutterPosition.setValue(t.get_GutterAtTop()?1:0),t=t.get_MirrorMargins(),this.cmbMultiplePages.setValue(t?1:0),t&&(this.window.find("#margin-left-label").html(this.textInside),this.window.find("#margin-right-label").html(this.textOutside),this.cmbGutterPosition.setValue(0)),this.cmbGutterPosition.setDisabled(t))},getSettings:function(){var t=new Asc.CDocumentSectionProps;return t.put_TopMargin(Common.Utils.Metric.fnRecalcToMM(this.spnTop.getNumberValue())),t.put_BottomMargin(Common.Utils.Metric.fnRecalcToMM(this.spnBottom.getNumberValue())),t.put_LeftMargin(Common.Utils.Metric.fnRecalcToMM(this.spnLeft.getNumberValue())),t.put_RightMargin(Common.Utils.Metric.fnRecalcToMM(this.spnRight.getNumberValue())),t.put_Orientation(this.cmbOrientation.getValue()),t.put_Gutter(Common.Utils.Metric.fnRecalcToMM(this.spnGutter.getNumberValue())),t.put_GutterAtTop(!!this.cmbGutterPosition.getValue()),t.put_MirrorMargins(!!this.cmbMultiplePages.getValue()),t.put_H(this.properties.get_H()),t.put_W(this.properties.get_W()),t},updateMetricUnit:function(){if(this.spinners)for(var t=0;t<this.spinners.length;t++){var e=this.spinners[t];e.setDefaultUnit(Common.Utils.Metric.getCurrentMetricName()),e.setStep(Common.Utils.Metric.getCurrentMetric()==Common.Utils.Metric.c_MetricUnits.pt?1:.1)}}},DE.Views.PageMarginsDialog||{}))}),define("documenteditor/main/app/view/PageSizeDialog",["common/main/lib/component/Window","common/main/lib/component/MetricSpinner"],function(){"use strict";DE.Views.PageSizeDialog=Common.UI.Window.extend(_.extend({options:{width:215,header:!0,style:"min-width: 216px;",cls:"modal-dlg",id:"window-page-size",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:this.textTitle},t||{}),this.template=['<div class="box" style="height: 85px;">','<table cols="2" style="width: 100%;">',"<tr>",'<td colspan="2">','<label class="input-label">'+this.textPreset+"</label>",'<div id="page-size-combo-preset" class="input-group-nr" style="margin-bottom: 10px;"></div>',"</td>","</tr>","<tr>",'<td class="padding-right-10">','<label class="input-label">'+this.textWidth+"</label>",'<div id="page-size-spin-width"></div>',"</td>","<td>",'<label class="input-label">'+this.textHeight+"</label>",'<div id="page-size-spin-height"></div>',"</td>","</tr>","</table>","</div>",'<div class="separator horizontal"></div>'].join(""),this.options.tpl=_.template(this.template)(this.options),this.spinners=[],this._noApply=!1,this.isOrientPortrait=!0,Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this),this.spnWidth=new Common.UI.MetricSpinner({el:$("#page-size-spin-width"),step:.1,width:86,defaultUnit:"cm",value:"10 cm",maxValue:118.9,minValue:0}),this.spinners.push(this.spnWidth),this.spnWidth.on("change",_.bind(function(t,e,i,n){!this._noApply&&-1<this.cmbPreset.getValue()&&this.cmbPreset.setValue(-1)},this)),this.spnHeight=new Common.UI.MetricSpinner({el:$("#page-size-spin-height"),step:.1,width:86,defaultUnit:"cm",value:"20 cm",maxValue:118.9,minValue:0}),this.spinners.push(this.spnHeight),this.spnHeight.on("change",_.bind(function(t,e,i,n){!this._noApply&&-1<this.cmbPreset.getValue()&&this.cmbPreset.setValue(-1)},this)),this.cmbPreset=new Common.UI.ComboBox({el:$("#page-size-combo-preset"),cls:"input-group-nr",menuStyle:"min-width: 183px;max-height: 208px;",editable:!1,takeFocusOnClose:!0,scrollAlwaysVisible:!0,data:[{value:0,displayValue:"US Letter",size:[215.9,279.4]},{value:1,displayValue:"US Legal",size:[215.9,355.6]},{value:2,displayValue:"A4",size:[210,297]},{value:3,displayValue:"A5",size:[148,210]},{value:4,displayValue:"B5",size:[176,250]},{value:5,displayValue:"Envelope #10",size:[104.8,241.3]},{value:6,displayValue:"Envelope DL",size:[110,220]},{value:7,displayValue:"Tabloid",size:[279.4,431.8]},{value:8,displayValue:"A3",size:[297,420]},{value:9,displayValue:"Tabloid Oversize",size:[304.8,457.1]},{value:10,displayValue:"ROC 16K",size:[196.8,273]},{value:11,displayValue:"Envelope Choukei 3",size:[119.9,234.9]},{value:12,displayValue:"Super B/A3",size:[330.2,482.5]},{value:13,displayValue:"A0",size:[841,1189]},{value:14,displayValue:"A1",size:[594,841]},{value:16,displayValue:"A2",size:[420,594]},{value:17,displayValue:"A6",size:[105,148]},{value:-1,displayValue:this.txtCustom,size:[]}]}),this.cmbPreset.setValue(-1),this.cmbPreset.on("selected",_.bind(function(t,e){var i;this._noApply=!0,e.value<0||(i=Common.Utils.Metric.fnRecalcFromMM(this.isOrientPortrait?e.size[0]:e.size[1]),e=Common.Utils.Metric.fnRecalcFromMM(this.isOrientPortrait?e.size[1]:e.size[0]),(i<this.spnWidth.getMinValue()||e<this.spnHeight.getMinValue())&&this.cmbPreset.setValue(-1),this.spnWidth.setValue(i,!0),this.spnHeight.setValue(e,!0)),this._noApply=!1},this)),this.getChild().find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.updateMetricUnit()},getFocusedComponents:function(){return[this.cmbPreset,this.spnWidth,this.spnHeight]},getDefaultFocusableComponent:function(){return this.cmbPreset},_handleInput:function(t){if(this.options.handler){if("ok"==t&&this.options.checkPageSize){var e=this.getSettings();if(this.options.checkPageSize(e[0],e[1]))return}this.options.handler.call(this,this,t)}this.close()},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onPrimary:function(t){return this._handleInput("ok"),!1},setSettings:function(t){var e,i;t&&(this.isOrientPortrait=t.get_W()<t.get_H(),this.spnWidth.setMinValue(Common.Utils.Metric.fnRecalcFromMM(t.get_LeftMargin()+t.get_RightMargin()+12.7)),this.spnWidth.setValue(Common.Utils.Metric.fnRecalcFromMM(t.get_W()),!0),this.spnHeight.setMinValue(Common.Utils.Metric.fnRecalcFromMM(t.get_TopMargin()+t.get_BottomMargin()+2.6)),this.spnHeight.setValue(Common.Utils.Metric.fnRecalcFromMM(t.get_H()),!0),e=this.isOrientPortrait?t.get_W():t.get_H(),i=this.isOrientPortrait?t.get_H():t.get_W(),t=this.cmbPreset.store.find(function(t){t=t.get("size");return Math.abs(t[0]-e)<.1&&Math.abs(t[1]-i)<.1}),this.cmbPreset.setValue(t?t.get("value"):-1))},getSettings:function(){return[Common.Utils.Metric.fnRecalcToMM(this.spnWidth.getNumberValue()),Common.Utils.Metric.fnRecalcToMM(this.spnHeight.getNumberValue())]},updateMetricUnit:function(){if(this.spinners)for(var t=0;t<this.spinners.length;t++){var e=this.spinners[t];e.setDefaultUnit(Common.Utils.Metric.getCurrentMetricName()),e.setStep(Common.Utils.Metric.getCurrentMetric()==Common.Utils.Metric.c_MetricUnits.pt?1:.1)}}},DE.Views.PageSizeDialog||{}))}),define("documenteditor/main/app/controller/PageLayout",["core"],function(){"use strict";var u;DE.Controllers.PageLayout=Backbone.Controller.extend({initialize:function(){},onLaunch:function(t){return this.toolbar=t,this.editMode=!0,this._state={},this},onAppReady:function(t){var n=this;n.toolbar.btnImgAlign.menu.on("item:click",n.onClickMenuAlign.bind(n)),n.toolbar.btnImgAlign.menu.on("show:before",n.onBeforeShapeAlign.bind(n)),n.toolbar.btnImgWrapping.menu.on("item:click",n.onClickMenuWrapping.bind(n)),n.toolbar.btnImgGroup.menu.on("item:click",n.onClickMenuGroup.bind(n)),n.toolbar.btnImgForward.menu.on("item:click",n.onClickMenuForward.bind(n)),n.toolbar.btnImgBackward.menu.on("item:click",n.onClickMenuForward.bind(n)),n.toolbar.btnImgForward.on("click",n.onClickMenuForward.bind(n,"forward")),n.toolbar.btnImgBackward.on("click",n.onClickMenuForward.bind(n,"backward")),n.toolbar.btnsPageBreak.forEach(function(t){t.menu.items[2].menu.on("item:click",function(t,e,i){n.toolbar.fireEvent("insert:break",[e.value])}),t.menu.on("item:click",function(t,e,i){"section"!=e.value&&n.toolbar.fireEvent("insert:break",[e.value])}),t.on("click",function(t){n.toolbar.fireEvent("insert:break",["page"])})})},setApi:function(t){return this.api=t,this.api.asc_registerCallback("asc_onImgWrapStyleChanged",this.onApiWrappingStyleChanged.bind(this)),this.api.asc_registerCallback("asc_onCoAuthoringDisconnect",this.onApiCoAuthoringDisconnect.bind(this)),this.api.asc_registerCallback("asc_onFocusObject",this.onApiFocusObject.bind(this)),this},onApiWrappingStyleChanged:function(t){var e=this.toolbar.btnImgWrapping.menu;switch(t){case Asc.c_oAscWrapStyle2.Inline:e.items[0].setChecked(!0);break;case Asc.c_oAscWrapStyle2.Square:e.items[2].setChecked(!0);break;case Asc.c_oAscWrapStyle2.Tight:e.items[3].setChecked(!0);break;case Asc.c_oAscWrapStyle2.Through:e.items[4].setChecked(!0);break;case Asc.c_oAscWrapStyle2.TopAndBottom:e.items[5].setChecked(!0);break;case Asc.c_oAscWrapStyle2.Behind:e.items[8].setChecked(!0);break;case Asc.c_oAscWrapStyle2.InFront:e.items[7].setChecked(!0);break;default:for(var i in e.items)e.items[i].setChecked(!1)}},onApiFocusObject:function(t){if(this.editMode){var e,i=this,n={},o=!1,s=!1,a=!1,l=!0;for(e in t)if(t[e].get_ObjectType()===Asc.c_oAscTypeSelectElement.Image){var r=t[e].get_ObjectValue(),c=!r.get_CanBeFlow(),d=r.get_ShapeProperties(),o=r.get_Locked(),h=r.get_WrappingStyle(),l=!1,m=(i.onApiWrappingStyleChanged(c?-1:h),_.each(i.toolbar.btnImgWrapping.menu.items,function(t){t.setDisabled(c)}),i.toolbar.btnImgWrapping.menu.items[10].setDisabled(!i.api.CanChangeWrapPolygon()),i.api.asc_IsContentControl()?this.api.asc_GetContentControlProperties():null),p=m?m.get_Lock():Asc.c_oAscSdtLockType.Unlocked,a=p==Asc.c_oAscSdtLockType.SdtContentLocked||p==Asc.c_oAscSdtLockType.ContentLocked;n.arrange=h==Asc.c_oAscWrapStyle2.Inline&&!r.get_FromGroup(),n.wrapping=r.get_FromGroup()||c&&!i.api.CanChangeWrapPolygon()||!!m&&m.get_SpecificType()==Asc.c_oAscContentControlSpecificType.Picture&&!m.get_FormPr(),n.group=o||h==Asc.c_oAscWrapStyle2.Inline||a,s=i.api.CanGroup()||i.api.CanUnGroup(),!n.group&&s&&(i.toolbar.btnImgGroup.menu.items[0].setDisabled(!i.api.CanGroup()),i.toolbar.btnImgGroup.menu.items[1].setDisabled(!i.api.CanUnGroup())),u=r;break}i.toolbar.lockToolbar(Common.enumLock.noObjectSelected,l,{array:[i.toolbar.btnImgAlign,i.toolbar.btnImgGroup,i.toolbar.btnImgWrapping,i.toolbar.btnImgForward,i.toolbar.btnImgBackward]}),i.toolbar.lockToolbar(Common.enumLock.imageLock,o,{array:[i.toolbar.btnImgAlign,i.toolbar.btnImgGroup,i.toolbar.btnImgWrapping]}),i.toolbar.lockToolbar(Common.enumLock.contentLock,a,{array:[i.toolbar.btnImgAlign,i.toolbar.btnImgGroup,i.toolbar.btnImgWrapping,i.toolbar.btnImgForward,i.toolbar.btnImgBackward]}),i.toolbar.lockToolbar(Common.enumLock.inImageInline,h==Asc.c_oAscWrapStyle2.Inline,{array:[i.toolbar.btnImgAlign,i.toolbar.btnImgGroup]}),i.toolbar.lockToolbar(Common.enumLock.inSmartartInternal,d&&d.asc_getFromSmartArtInternal(),{array:[i.toolbar.btnImgForward,i.toolbar.btnImgBackward]}),i.toolbar.lockToolbar(Common.enumLock.cantGroup,!s,{array:[i.toolbar.btnImgGroup]}),i.toolbar.lockToolbar(Common.enumLock.cantWrap,n.wrapping,{array:[i.toolbar.btnImgWrapping]}),i.toolbar.lockToolbar(Common.enumLock.cantArrange,n.arrange,{array:[i.toolbar.btnImgForward,i.toolbar.btnImgBackward]})}},onApiCoAuthoringDisconnect:function(){this.editMode=!1},onBeforeShapeAlign:function(){var t=this.api.asc_getSelectedDrawingObjectsCount(),e=Common.Utils.InternalSettings.get("de-img-align-to");this.toolbar.mniAlignObjects.setDisabled(t<2),this.toolbar.mniAlignObjects.setChecked(1<t&&(!e||3==e),!0),this.toolbar.mniAlignToMargin.setChecked(t<2&&!e||2==e,!0),this.toolbar.mniAlignToPage.setChecked(1==e,!0),this.toolbar.mniDistribHor.setDisabled(t<3&&this.toolbar.mniAlignObjects.isChecked()),this.toolbar.mniDistribVert.setDisabled(t<3&&this.toolbar.mniAlignObjects.isChecked())},onClickMenuAlign:function(t,e,i){var n=this.toolbar.mniAlignToPage.isChecked()?Asc.c_oAscObjectsAlignType.Page:this.toolbar.mniAlignToMargin.isChecked()?Asc.c_oAscObjectsAlignType.Margin:Asc.c_oAscObjectsAlignType.Selected;-1<e.value&&e.value<6?(this.api.put_ShapesAlign(e.value,n),Common.component.Analytics.trackEvent("ToolBar","Shape Align")):6==e.value?(this.api.DistributeHorizontally(n),Common.component.Analytics.trackEvent("ToolBar","Distribute")):7==e.value&&(this.api.DistributeVertically(n),Common.component.Analytics.trackEvent("ToolBar","Distribute")),this.toolbar.fireEvent("editcomplete",this.toolbar)},onClickMenuWrapping:function(t,e,i){var n;"edit"==e.options.wrapType?this.api.StartChangeWrapPolygon():((n=new Asc.asc_CImgProperty).put_WrappingStyle(e.options.wrapType),u.get_WrappingStyle()===Asc.c_oAscWrapStyle2.Inline&&e.options.wrapType!==Asc.c_oAscWrapStyle2.Inline&&(n.put_PositionH(new Asc.CImagePositionH),n.get_PositionH().put_UseAlign(!1),n.get_PositionH().put_RelativeFrom(Asc.c_oAscRelativeFromH.Column),e=u.get_Value_X(Asc.c_oAscRelativeFromH.Column),n.get_PositionH().put_Value(e),n.put_PositionV(new Asc.CImagePositionV),n.get_PositionV().put_UseAlign(!1),n.get_PositionV().put_RelativeFrom(Asc.c_oAscRelativeFromV.Paragraph),e=u.get_Value_Y(Asc.c_oAscRelativeFromV.Paragraph),n.get_PositionV().put_Value(e)),this.api.ImgApply(n)),this.toolbar.fireEvent("editcomplete",this.toolbar)},onClickMenuGroup:function(t,e,i){var n=new Asc.asc_CImgProperty;n.put_Group(e.options.groupval),this.api.ImgApply(n),this.toolbar.fireEvent("editcomplete",this.toolbar)},onClickMenuForward:function(t,e,i){var n=new Asc.asc_CImgProperty;"forward"==t?n.put_ChangeLevel(Asc.c_oAscChangeLevel.BringForward):"backward"==t?n.put_ChangeLevel(Asc.c_oAscChangeLevel.BringBackward):n.put_ChangeLevel(e.options.valign),this.api.ImgApply(n),this.toolbar.fireEvent("editcomplete",this.toolbar)}})}),define("documenteditor/main/app/view/CustomColumnsDialog",["common/main/lib/component/Window","common/main/lib/component/MetricSpinner","common/main/lib/component/CheckBox"],function(){"use strict";DE.Views.CustomColumnsDialog=Common.UI.Window.extend(_.extend({options:{width:300,header:!0,style:"min-width: 216px;",cls:"modal-dlg",id:"window-custom-columns",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:this.textTitle},t||{}),this.template=['<div class="box" style="height: 203px;">','<div class="input-row" style="margin-bottom: 10px;">','<label class="input-label">'+this.textColumns+'</label><div id="custom-columns-spin-num" class="float-right"></div>',"</div>",'<div id="custom-columns-list" style="width:100%; height: 113px;"></div>','<div class="input-row" style="margin: 10px 0;">','<div id="custom-columns-equal-width"></div>',"</div>",'<div class="input-row">','<div id="custom-columns-separator"></div>',"</div>","</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),this.totalWidth=558.7,this.minWidthCol=10,this.defaultSpacing=12.5,this._noApply=!1,Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var C=this;this.spnColumns=new Common.UI.MetricSpinner({el:$("#custom-columns-spin-num"),step:1,allowDecimal:!1,width:45,defaultUnit:"",value:1,maxValue:30,minValue:1,maskExp:/[0-9]/}),this.spnColumns.on("change",function(t,e,i,n){var o=parseInt(e),s=C.columnsList.store.length,e=s<o,a="checked"==C.chEqualWidth.getValue(),l=[];if(0!=s&&o!=s){if(a){var r=1==s?C.defaultSpacing:C.columnsList.store.at(0).get("spacing"),c=(C.totalWidth-r*(o-1))/o;c<C.minWidthCol&&(c=C.minWidthCol,r=(C.totalWidth-c*o)/(o-1));for(var d=0;d<o;d++)l.push({width:c,spacing:r})}else{for(var h=0,m=(C.columnsList.store.at(s-1).get("width")+(1<s?C.columnsList.store.at(s-2).get("spacing"):0))/C.totalWidth,p=[1],d=0,u=C.defaultSpacing;d<o;d++){var g=0;d<o-1&&(u=g=d<s-1?(1<s?C.columnsList.store.at(d).get("spacing"):C.defaultSpacing)/(m*o+1-s*m):u),p[d]=d<s?C.columnsList.store.at(d).get("width")/C.columnsList.store.at(0).get("width"):p[s-1],l.push({spacing:g}),h+=g}for(var b=(C.totalWidth-h)/p.reduce(function(t,e){return t+e}),d=0;d<o;d++)l[d].width=b*p[d]}C.updateColumnsList(l),C.setMaxValueSpinsForColumns(),e||a||C.setMaxColumns(),C.chEqualWidth.setDisabled(o<2),C.chSeparator.setDisabled(o<2)}}),this.columnsList=new Common.UI.ListView({el:$("#custom-columns-list",this.$window),store:new Common.UI.DataViewStore,showLast:!1,handleSelect:!1,tabindex:0,template:_.template(['<div class="listview inner" style=""></div>'].join("")),headers:[{name:"#",width:26},{name:this.textWidth,width:115},{name:this.textTitleSpacing,width:113}],itemTemplate:_.template(['<div id="custom-columns-list-item-<%= index %>" class="list-item" style="display:flex; align-items:center; width=100%;">','<label class="level-caption padding-right-5" style="flex-shrink:0; width:20px;"><%= index + 1 %></label>','<div style="display:inline-block;flex-grow: 1;">','<div style="padding: 0 5px;display: inline-block;vertical-align: top;"><div id="custom-columns-list-item-spin-width-<%= index %>" class="input-group-nr" style=""></div></div>','<div style="padding: 0 5px;display: inline-block;vertical-align: top;"><div id="custom-columns-list-item-spin-spacing-<%= index %>" class="input-group-nr"></div></div>',"</div>","</div>"].join(""))}),this.columnsList.on("item:add",_.bind(this.addControls,this)),this.chEqualWidth=new Common.UI.CheckBox({el:$("#custom-columns-equal-width"),labelText:this.textEqualWidth}).on("change",function(t,e,i){C.lockSpinsForEqualColumns("checked"==e),"checked"==e&&C.setEqualWidthColumns(),0<C.columnsList.store.length&&(C.setMaxColumns(),C.setMaxValueSpinsForColumns())}),this.chSeparator=new Common.UI.CheckBox({el:$("#custom-columns-separator"),labelText:this.textSeparator}),this.getChild().find(".dlg-btn").on("click",_.bind(this.onBtnClick,this))},getFocusedComponents:function(){return[this.spnColumns,this.chEqualWidth,this.chSeparator]},getDefaultFocusableComponent:function(){return this.spnColumns},_handleInput:function(t){this.options.handler&&this.options.handler.call(this,this,t),this.close()},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onPrimary:function(){return this._handleInput("ok"),!1},setSettings:function(t){if(t){for(var e,i=t.get_EqualWidth(),n=i?t.get_Num():t.get_ColsCount(),o=t.get_TotalWidth(),s=[],a=(this.totalWidth=o,this.spnColumns.setValue(n,!0),i&&1<n?this.calcWidthForEqualColumns(n,t.get_Space()):o),l=0;l<n;l++)!i&&1<n?(e=t.get_Col(l),s.push({width:e.get_W(),spacing:e.get_Space()}),e.get_W()<this.minWidthCol&&(this.minWidthCol=e.get_W())):s.push({width:a,spacing:t.get_Space()});this.chEqualWidth.setValue(i,!0),this.chEqualWidth.setDisabled(n<2),this.chSeparator.setValue(t.get_Sep()),this.chSeparator.setDisabled(n<2),this.updateColumnsList(s),this.setMaxColumns(),this.setMaxValueSpinsForColumns()}},getSettings:function(){var i=new Asc.CDocumentColumnsProps;return i.put_Num(this.spnColumns.getNumberValue()),i.put_Space(this.columnsList.store.at(0).get("spacing")),i.put_EqualWidth("checked"==this.chEqualWidth.getValue()),i.put_Sep("checked"==this.chSeparator.getValue()),"checked"!=this.chEqualWidth.getValue()&&this.columnsList.store.each(function(t,e){i.put_ColByValue(e,t.get("width"),t.get("spacing"))}),i},updateColumnsList:function(i){var t=i.map(function(t,e){return{index:e,allowSelected:!1,width:t.width,spacing:e!=i.length-1?t.spacing:0,widthSpin:null,spacingSpin:null}});this.columnsList.store.reset(t)},setMaxColumns:function(){var t=Math.floor(this.totalWidth/this.minWidthCol);if("checked"==this.chEqualWidth.getValue())this.spnColumns.setMaxValue(t);else{var i=this,e=i.columnsList.store.length,t=null,n=[];if(1<e){for(var o=0;o<e;o++)n[o]=i.columnsList.store.at(o).get("width")/i.columnsList.store.at(0).get("width");t=(i.columnsList.store.at(e-1).get("width")+i.columnsList.store.at(e-2).get("spacing"))/i.totalWidth}else n=[1,1],t=(i.totalWidth-i.defaultSpacing)/((e=2)*i.totalWidth);var s=_.min(n),a=(n=n.map(function(t){return t/s})).pop()*i.minWidthCol,l=n.reduce(function(t,e){return t+e})*i.minWidthCol,r=1<i.columnsList.store.length?i.columnsList.store.at(e-2).get("spacing"):i.defaultSpacing,c=0,d=(i.columnsList.store.each(function(t,e){e<i.columnsList.store.length-2&&(c+=t.get("spacing"))}),t*a),h=(1-e*t)*a-t*this.totalWidth+t*l+(1-e)*t*a+r,l=-this.totalWidth*(1-e*t)+l*(1-e*t)+a*(1-e)*(1-e*t)+c+r*(1-e),a=(Math.sqrt(h*h-4*d*l)-h)/(2*d);this.spnColumns.setMaxValue(Math.floor(.01+a))}},lockSpinsForEqualColumns:function(i){var n=this.columnsList.store.length;this.columnsList.store.each(function(t,e){t.get("widthSpin").setDisabled(i),t.get("spacingSpin").setDisabled(0!=e&&i||e==n-1)})},calcWidthForEqualColumns:function(t,e){return(this.totalWidth-(t-1)*e)/t},setEqualWidthColumns:function(){var i,n,o,s;0!=this.columnsList.store.length&&(n=(i=this).spnColumns.getNumberValue(),o=this.columnsList.store.at(0).get("spacing"),(s=this.calcWidthForEqualColumns(n,o))<this.minWidthCol&&(s=this.minWidthCol+1e-4,o=1<n?(this.totalWidth-n*s)/(n-1):0),this.columnsList.store.each(function(t,e){i.setWidthColumnValue(t,s),e!=n-1&&i.setSpacingColumnValue(t,o)}))},setWidthColumnValue:function(t,e){var i=t.get("widthSpin"),n=Common.Utils.Metric.fnRecalcFromMM(e);t.set("width",e,{silent:!0}),i.getMaxValue()<n&&i.setMaxValue(this.decimalRouding(n)),i.setValue(n,!0)},setSpacingColumnValue:function(t,e){t.set("spacing",e,{silent:!0}),t.get("spacingSpin").setValue(Common.Utils.Metric.fnRecalcFromMM(e),!0)},setMaxValueSpinsForColumns:function(){var t,e,i,n,o,s;"checked"==this.chEqualWidth.getValue()?(t=this.columnsList.store.at(0),n=this.columnsList.store.length,e=this.minWidthCol,s=1<n?Common.Utils.Metric.fnRecalcFromMM((this.totalWidth-n*e)/(n-1)):0,t.get("widthSpin").setMaxValue(1e6),t.get("spacingSpin").setMaxValue(1<n?this.decimalRouding(s):0)):(n=(i=this).columnsList.store.length,o=Common.Utils.Metric.fnRecalcFromMM(this.totalWidth-this.minWidthCol*(n-1)),s=Common.Utils.Metric.fnRecalcFromMM(this.totalWidth-this.minWidthCol*n),this.columnsList.store.each(function(t){t.get("widthSpin").setMaxValue(i.decimalRouding(o)),t.get("spacingSpin").setMaxValue(i.decimalRouding(s))}))},decimalRouding:function(t,e){e=Math.pow(10,e||2);return Math.round(t*e)/e},setNewValueSpinsForColumns:function(t,h,e){var m=this,i=[],n=[],p=0;function o(t,e,i,n){for(var o=function(t,e,i,n,o){null==n&&(n=!1);for(var s=[],a=e;a<i;a++){var l;void 0!==o&&o==a||(l=m.columnsList.store.at(a).get(t),("width"==t&&(n||l>m.minWidthCol)||"spacing"==t&&0<l)&&(void 0===r&&(r=a),s[a]=l/m.columnsList.store.at(r).get(t)))}if(n&&0==s.length)for(var r,a=e;a<i;a++)s[a]=1;return s}(t,e,i,h<0,n),s="width"==t?m.minWidthCol:0,a=[];0<o.length&&0<o.reduce(function(t,e){return t+(e?1:0)})&&0!=h;){p=h/o.reduce(function(t,e){return t+e});for(var l,r,c,d=e;d<i;d++)!o[d]||void 0!==n&&n==d||(l=p*o[d],(c=(r=void 0!==a[d]?a[d]:m.columnsList.store.at(d).get(t))-l)<s&&(l=r-s,c=s,o[d]=0),a[d]=c,h-=l);h=m.decimalRouding(h,6)}return a}i=o("width",t+1,m.columnsList.store.length),"width"==e?(0!=h&&(n=o("spacing",0,m.columnsList.store.length-1)),0!=h&&o("width",0,t).forEach(function(t,e){i[e]=t})):(0!=h&&o("width",0,t+1).forEach(function(t,e){i[e]=t}),0!=h&&(n=o("spacing",0,m.columnsList.store.length-1,t))),i.forEach(function(t,e){m.setWidthColumnValue(m.columnsList.store.at(e),t)}),n.forEach(function(t,e){m.setSpacingColumnValue(m.columnsList.store.at(e),t)})},addControls:function(t,e,o){var s,a,i,n,l,r;o&&(s=this,i=(a=o.get("index"))===s.columnsList.store.length-1,n="checked"==s.chEqualWidth.getValue(),r=Common.Utils.Metric.getCurrentMetricName(),l=new Common.UI.MetricSpinner({el:$("#custom-columns-list-item-spin-width-"+a),step:Common.Utils.Metric.getCurrentMetric()==Common.Utils.Metric.c_MetricUnits.pt?1:.1,width:105,tabindex:1,defaultUnit:r,value:s.decimalRouding(Common.Utils.Metric.fnRecalcFromMM(o.get("width")))+" "+r,maxValue:120,minValue:s.decimalRouding(Common.Utils.Metric.fnRecalcFromMM(s.minWidthCol)),disabled:n||0==a&&i}).on("change",function(t,e,i,n){e=Common.Utils.Metric.fnRecalcToMM(parseFloat(e)-Common.Utils.Metric.fnRecalcFromMM(o.get("width")).toFixed(2));o.set("width",o.get("width")+e,{silent:!0}),s.setNewValueSpinsForColumns(a,e,"width"),s.setMaxColumns()}),r=new Common.UI.MetricSpinner({el:$("#custom-columns-list-item-spin-spacing-"+a),step:Common.Utils.Metric.getCurrentMetric()==Common.Utils.Metric.c_MetricUnits.pt?1:.1,width:105,tabindex:1,defaultUnit:r,value:i?"":this.decimalRouding(Common.Utils.Metric.fnRecalcFromMM(o.get("spacing")))+" "+r,maxValue:120,minValue:0,disabled:n&&0!=a||i}).on("change",function(t,e,i,n){e=Common.Utils.Metric.fnRecalcToMM(parseFloat(e)-Common.Utils.Metric.fnRecalcFromMM(o.get("spacing")).toFixed(2));o.set("spacing",o.get("spacing")+e,{silent:!0}),"checked"==s.chEqualWidth.getValue()?s.setEqualWidthColumns():s.setNewValueSpinsForColumns(a,e,"spacing"),s.setMaxColumns()}),o.set("widthSpin",l,{silent:!0}),o.set("spacingSpin",r,{silent:!0}))}},DE.Views.CustomColumnsDialog||{}))}),define("text!documenteditor/main/app/template/WatermarkSettings.template",[],function(){return'<table cols="1">\n    <tr><td class="padding-small">\n        <div id="watermark-radio-none"></div>\n    </td></tr>\n    <tr><td class="padding-small">\n        <div id="watermark-radio-text"></div>\n    </td></tr>\n    <tr><td class="padding-large">\n        <table id="watermark-tbl-text" class="margin-left-22" cols="2">\n            <tr>\n                <td class="language padding-small">\n                    <label class="input-label"><%= scope.textLanguage %></label>\n                    <div id="watermark-combo-lang"></div>\n                </td>\n                <td class="text padding-small">\n                    <label class="input-label"><%= scope.textText %></label>\n                    <div id="watermark-combo-text"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-large" colspan="2">\n                    <label class="input-label font-label"><%= scope.textFont %></label>\n                    <div id="watermark-fonts" class="input-row"></div>\n                    <div id="watermark-font-size" class="input-row"></div>\n                    <div id="watermark-textcolor"></div>\n                    <div id="watermark-bold"></div><div id="watermark-italic"></div>\n                    <div id="watermark-underline"></div><div id="watermark-strikeout"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small" colspan="2">\n                    <div id="watermark-chb-transparency"></div>\n                </td>\n            </tr>\n            <tr>\n                <td colspan="2">\n                    <label class="layout-label"><%= scope.textLayout %></label>\n                    <div id="watermark-radio-diag"></div>\n                    <div id="watermark-radio-hor"></div>\n                </td>\n            </tr>\n        </table>\n    </td></tr>\n    <tr><td class="padding-small">\n        <div id="watermark-radio-image"></div>\n    </td></tr>\n    <tr><td class="padding-small">\n        <table id="watermark-tbl-image" class="margin-left-22" cols="2">\n            <tr>\n                <td class="select-image">\n                    <div id="watermark-select-image"></div>\n                </td>\n                <td rowspan="2">\n                    <div class="texture-img">\n                        <div id="watermark-texture-img"></div>\n                    </div>\n                </td>\n            </tr>\n            <tr>\n                <td class="scale">\n                    <label class="input-label"><%= scope.textScale %></label>\n                    <div id="watermark-combo-scale"></div>\n                </td>\n            </tr>\n            </table>\n    </td></tr>\n</table>\n'}),define("documenteditor/main/app/view/WatermarkSettingsDialog",["text!documenteditor/main/app/template/WatermarkSettings.template","common/main/lib/util/utils","common/main/lib/component/RadioBox","common/main/lib/component/InputField","common/main/lib/view/AdvancedSettingsWindow"],function(i){"use strict";DE.Views.WatermarkText=new function(){var o;return{get:function(){return o},load:function(n){o=[],Common.Utils.loadConfig("resources/watermark/wm-text.json",function(t){for(var e in t){var i=Common.util.LanguageInfo.getLocalLanguageCode(e);i&&o.push({code:i,name:Common.util.LanguageInfo.getLocalLanguageName(i)[1],shortname:Common.util.LanguageInfo.getLocalLanguageName(i)[0],text:t[e]})}o.sort(function(t,e){return t.shortname<e.shortname?-1:t.shortname>e.shortname?1:0}),n&&n(o)})}}},DE.Views.WatermarkSettingsDialog=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:400,height:442,id:"window-watermark"},initialize:function(t){_.extend(this.options,{title:this.textTitle,template:_.template(['<div class="box" style="height:'+(this.options.height-85)+'px;">','<div class="content-panel" style="padding: 10px 5px;"><div class="inner-content">','<div class="settings-panel active">',i,"</div></div>","</div>","</div>"].join(""))({scope:this})},t),this.handler=t.handler,this.props=t.props,this.fontStore=t.fontStore,this.api=t.api,this.storage=!!t.storage,this.textControls=[],this.imageControls=[],this.fontName="Arial",this.text="",this.isAutoColor=!1,this.isImageLoaded=!1;var t=t.lang||"en",e=Common.util.LanguageInfo.getLocalLanguageCode(t);this.lang=e?{value:t,displayValue:Common.util.LanguageInfo.getLocalLanguageName(e)[1],default:!0}:{value:"en",displayValue:"English",default:!0},Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);this.radioNone=new Common.UI.RadioBox({el:$("#watermark-radio-none"),name:"asc-radio-watermark-type",labelText:this.textNone,checked:!1}),this.radioNone.on("change",_.bind(function(t,e,i){e&&(this.props.put_Type(Asc.c_oAscWatermarkType.None),this.disableControls(Asc.c_oAscWatermarkType.None))},this)),this.radioImage=new Common.UI.RadioBox({el:$("#watermark-radio-image"),name:"asc-radio-watermark-type",labelText:this.textImageW,checked:!1}),this.radioImage.on("change",_.bind(function(t,e,i){e&&(this.props.put_Type(Asc.c_oAscWatermarkType.Image),this.disableControls(Asc.c_oAscWatermarkType.Image),this.focusControls())},this)),this.radioText=new Common.UI.RadioBox({el:$("#watermark-radio-text"),name:"asc-radio-watermark-type",labelText:this.textTextW,checked:!0}),this.radioText.on("change",_.bind(function(t,e,i){e&&(this.props.put_Type(Asc.c_oAscWatermarkType.Text),this.disableControls(Asc.c_oAscWatermarkType.Text),this.focusControls())},this)),this.btnSelectImage=new Common.UI.Button({parentEl:$("#watermark-select-image"),cls:"btn-text-menu-default",caption:this.textSelect,style:"width: 142px;",menu:new Common.UI.Menu({style:"min-width: 142px;",maxHeight:200,additionalAlign:this.menuAddAlign,items:[{caption:this.textFromFile,value:0},{caption:this.textFromUrl,value:1},{caption:this.textFromStorage,value:2}]})}),this.imageControls.push(this.btnSelectImage),this.btnSelectImage.menu.on("item:click",_.bind(this.onImageSelect,this)),this.btnSelectImage.menu.items[2].setVisible(this.storage),this.btnSelectImage.menu.items[1].setDisabled(!1),this.btnSelectImage.menu.items[2].setDisabled(!1),this._arrScale=[{displayValue:this.textAuto,value:-1},{displayValue:"500%",value:500},{displayValue:"200%",value:200},{displayValue:"150%",value:150},{displayValue:"100%",value:100},{displayValue:"50%",value:50}],this.cmbScale=new Common.UI.ComboBox({el:$("#watermark-combo-scale"),cls:"input-group-nr",menuStyle:"min-width: 142px;",data:this._arrScale,takeFocusOnClose:!0}).on("selected",_.bind(function(t,e){},this)),this.cmbScale.setValue(this._arrScale[0].value),this.imageControls.push(this.cmbScale),this.cmbLang=new Common.UI.ComboBox({el:$("#watermark-combo-lang"),cls:"input-group-nr",editable:!1,menuStyle:"min-width: 100%;max-height: 210px;",scrollAlwaysVisible:!0,data:[],takeFocusOnClose:!0}).on("selected",_.bind(this.onSelectLang,this)),this.cmbLang.setValue(Common.util.LanguageInfo.getLocalLanguageName(9)[1]),this.textControls.push(this.cmbLang),this.cmbText=new Common.UI.ComboBox({el:$("#watermark-combo-text"),cls:"input-group-nr",menuStyle:"min-width: 100%;max-height: 210px;",scrollAlwaysVisible:!0,displayField:"value",data:[{value:"ASAP"},{value:"CONFIDENTIAL"},{value:"COPY"},{value:"DO NOT COPY"},{value:"DRAFT"},{value:"ORIGINAL"},{value:"PERSONAL"},{value:"SAMPLE"},{value:"TOP SECRET"},{value:"URGENT"}],takeFocusOnClose:!0}).on("selected",_.bind(function(t,e){},this)),this.cmbText.setValue(this.cmbText.options.data[0].value),this.textControls.push(this.cmbText),this.cmbFonts=new Common.UI.ComboBoxFonts({el:$("#watermark-fonts"),cls:"input-group-nr",style:"width: 142px;",menuCls:"scrollable-menu",menuStyle:"min-width: 100%;max-height: 270px;",store:new Common.Collections.Fonts,recent:0,hint:this.tipFontName,takeFocusOnClose:!0}).on("selected",_.bind(function(t,e){this.fontName=e.name},this)),this.textControls.push(this.cmbFonts);var t=[{value:-1,displayValue:this.textAuto},{value:36,displayValue:"36"},{value:40,displayValue:"40"},{value:44,displayValue:"44"},{value:48,displayValue:"48"},{value:54,displayValue:"54"},{value:60,displayValue:"60"},{value:66,displayValue:"66"},{value:72,displayValue:"72"},{value:80,displayValue:"80"},{value:90,displayValue:"90"},{value:96,displayValue:"96"},{value:105,displayValue:"105"},{value:120,displayValue:"120"},{value:144,displayValue:"144"}];this.cmbFontSize=new Common.UI.ComboBox({el:$("#watermark-font-size"),cls:"input-group-nr",style:"width: 55px;",menuCls:"scrollable-menu",menuStyle:"min-width: 55px;max-height: 270px;",hint:this.tipFontSize,data:t,takeFocusOnClose:!0}),this.cmbFontSize.setValue(-1),this.textControls.push(this.cmbFontSize),this.btnBold=new Common.UI.Button({parentEl:$("#watermark-bold"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-bold",enableToggle:!0,hint:this.textBold}),this.textControls.push(this.btnBold),this.btnItalic=new Common.UI.Button({parentEl:$("#watermark-italic"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-italic",enableToggle:!0,hint:this.textItalic}),this.textControls.push(this.btnItalic),this.btnUnderline=new Common.UI.Button({parentEl:$("#watermark-underline"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-underline",enableToggle:!0,hint:this.textUnderline}),this.textControls.push(this.btnUnderline),this.btnStrikeout=new Common.UI.Button({parentEl:$("#watermark-strikeout"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-strikeout",enableToggle:!0,hint:this.textStrikeout}),this.textControls.push(this.btnStrikeout),this.btnTextColor=new Common.UI.ButtonColored({parentEl:$("#watermark-textcolor"),cls:"btn-toolbar move-focus",iconCls:"toolbar__icon btn-fontcolor",hint:this.textColor,additionalAlign:this.menuAddAlign,auto:!0,color:"c0c0c0",menu:!0,takeFocusOnClose:!0}),this.btnTextColor.setMenu(),this.mnuTextColorPicker=this.btnTextColor.getPicker(),this.btnTextColor.currentColor="c0c0c0",this.textControls.push(this.btnTextColor),this.btnTextColor.on("color:select",_.bind(this.onColorSelect,this)),this.btnTextColor.on("auto:select",_.bind(this.onAutoColor,this)),this.chTransparency=new Common.UI.CheckBox({el:$("#watermark-chb-transparency"),labelText:this.textTransparency,value:!0}),this.textControls.push(this.chTransparency),this.radioDiag=new Common.UI.RadioBox({el:$("#watermark-radio-diag"),name:"asc-radio-watermark-layout",labelText:this.textDiagonal,checked:!0}),this.textControls.push(this.radioDiag),this.radioHor=new Common.UI.RadioBox({el:$("#watermark-radio-hor"),name:"asc-radio-watermark-layout",labelText:this.textHor}),this.textControls.push(this.radioHor),this.btnOk=new Common.UI.Button({el:this.$window.find(".primary"),disabled:!0}),this.afterRender()},getFocusedComponents:function(){return[this.radioNone,this.radioText,this.cmbLang,this.cmbText,this.cmbFonts,this.cmbFontSize,this.btnTextColor,this.btnBold,this.btnItalic,this.btnUnderline,this.btnStrikeout,this.chTransparency,this.radioDiag,this.radioHor,this.radioImage,this.cmbScale]},getDefaultFocusableComponent:function(){return this.cmbLang.isDisabled()?this.cmbScale.isDisabled()?this.radioNone:this.cmbScale:this.cmbLang},focusControls:function(){var t=this.getDefaultFocusableComponent();t&&setTimeout(function(){t.focus()},10)},onColorSelect:function(t,e){this.isAutoColor=!1,this.btnTextColor.currentColor=e},updateThemeColors:function(){this.mnuTextColorPicker.updateColors(Common.Utils.ThemeColor.getEffectColors(),Common.Utils.ThemeColor.getStandartColors())},onAutoColor:function(t){this.isAutoColor=!0,this.btnTextColor.currentColor="000"},afterRender:function(){this.cmbFonts.fillFonts(this.fontStore),this.cmbFonts.selectRecord(this.fontStore.findWhere({name:this.fontName})),this.updateThemeColors(),this._setDefaults(this.props);function e(){n.isImageLoaded=!0,n.btnOk.setDisabled(!1)}function i(t){t&&t._urls&&"watermark"==t.c&&n.props.put_ImageUrl(t._urls[0],t.token)}var n=this;this.api.asc_registerCallback("asc_onWatermarkImageLoaded",e);Common.NotificationCenter.on("storage:image-insert",i),this.on("close",function(t){n.api.asc_unregisterCallback("asc_onWatermarkImageLoaded",e),Common.NotificationCenter.off("storage:image-insert",i)})},loadLanguages:function(){function t(t){var e=[];i.languages=t,i.languages&&i.languages.forEach(function(t){e.push({displayValue:t.name,value:t.shortname,wmtext:t.text})}),e.length?(i.cmbLang.setData(e),(t=i.loadWMText(i.lang.value))&&i.lang.default?i.cmbLang.setValue(t):i.cmbLang.setValue(i.lang.displayValue),i.cmbLang.setDisabled(!i.radioText.getValue()),i.text&&i.cmbText.setValue(i.text)):i.cmbLang.setDisabled(!0),n&&i.focusControls()}var i=this,n=!1,e=DE.Views.WatermarkText.get(),n=!e;e?t(e):DE.Views.WatermarkText.load(t)},onSelectLang:function(t,e){var i;e&&(i=[],e.wmtext.forEach(function(t){i.push({value:t})}),this.lang=e,0<i.length&&(this.cmbText.setData(i),this.cmbText.setValue(i[0].value)))},loadWMText:function(t){var e,i;if(t)return e=[],(i=(i=(i=(i=this.cmbLang.store.findWhere({value:t}))||this.cmbLang.store.findWhere({value:t.split(/[\-\_]/)[0]}))||this.cmbLang.store.findWhere({value:"en"}))||this.cmbLang.store.at(0))&&i.get("wmtext").forEach(function(t){e.push({value:t})}),0<e.length&&(this.cmbText.setData(e),this.cmbText.setValue(e[0].value)),i?i.get("displayValue"):null},onImageSelect:function(t,e){var i;1==e.value?(i=this,new Common.Views.ImageFromUrlDialog({handler:function(t,e){"ok"==t&&(t=e.replace(/ /g,""),_.isEmpty(t)||i.props.put_ImageUrl(t))}}).show()):2==e.value?Common.NotificationCenter.trigger("storage:image-load","watermark"):this.props.showFileDialog()},_setDefaults:function(t){if(this.loadLanguages(),t){t.put_DivId("watermark-texture-img"),t.put_Api(this.api);var e,i=t.get_Type();if(i==Asc.c_oAscWatermarkType.None)this.radioNone.setValue(!0,!0);else if(i==Asc.c_oAscWatermarkType.Image)this.radioImage.setValue(!0,!0),this.isImageLoaded=!!t.get_ImageUrl(),e=t.get_Scale()||-1,this.cmbScale.setValue(e<0?-1:Math.round(100*e),Math.round(100*e)+" %");else{if(this.radioText.setValue(!0,!0),t.get_IsDiagonal()||this.radioHor.setValue(!0),this.chTransparency.setValue(t.get_Opacity()<255),e=t.get_TextPr()){var n=Common.util.LanguageInfo.getLocalLanguageName(e.get_Lang()),n=(this.lang={value:n[0],displayValue:n[1]},this.cmbLang.setValue(n[1]),this.loadWMText(n[0]),e.get_FontFamily().get_Name()),o=(n&&(o=this.cmbFonts.store.findWhere({name:n}),this.fontName=o?o.get("name"):n,this.cmbFonts.setValue(this.fontName)),this.cmbFontSize.setValue(e.get_FontSize()),this.btnBold.toggle(e.get_Bold()),this.btnItalic.toggle(e.get_Italic()),this.btnUnderline.toggle(e.get_Underline()),this.btnStrikeout.toggle(e.get_Strikeout()),e.get_Color()),s="c0c0c0";if(o.get_auto())s="000",this.isAutoColor=!0,this.mnuTextColorPicker.clearSelection(),this.btnTextColor.setAutoColor(!0);else if("object"==typeof(s=o?o.get_type()==Asc.c_oAscColor.COLOR_TYPE_SCHEME?{color:Common.Utils.ThemeColor.getHexColor(o.get_r(),o.get_g(),o.get_b()),effectValue:o.get_value()}:Common.Utils.ThemeColor.getHexColor(o.get_r(),o.get_g(),o.get_b()):s)){for(var a=!1,l=0;l<10;l++)if(Common.Utils.ThemeColor.ThemeValues[l]==s.effectValue){this.mnuTextColorPicker.select(s,!0),a=!0;break}a||this.mnuTextColorPicker.clearSelection()}else this.mnuTextColorPicker.select(s,!0);this.btnTextColor.currentColor=s,this.btnTextColor.setColor(this.btnTextColor.currentColor)}(e=t.get_Text())&&this.cmbText.setValue(e),this.text=e||""}this.disableControls(i)}},getSettings:function(){var t,e=this.props,i=this.props.get_Type();return i==Asc.c_oAscWatermarkType.Image?(i=parseInt(this.cmbScale.getValue()),isNaN(i)&&(i=-1),e.put_Scale(i<0?i:i/100)):(e.put_Text(this.cmbText.getValue()),e.put_IsDiagonal(this.radioDiag.getValue()),e.put_Opacity("checked"==this.chTransparency.getValue()?128:255),(i=e.get_TextPr()||new Asc.CTextProp)&&(i.put_FontSize(Math.min(this.cmbFontSize.getValue(),1638)),(t=new AscCommon.asc_CTextFontFamily).put_Name(this.fontName),t.put_Index(-1),i.put_FontFamily(t),i.put_Bold(this.btnBold.pressed),i.put_Italic(this.btnItalic.pressed),i.put_Underline(this.btnUnderline.pressed),i.put_Strikeout(this.btnStrikeout.pressed),i.put_Lang(parseInt(Common.util.LanguageInfo.getLocalLanguageCode(this.lang.value))),t=new Asc.asc_CColor,this.isAutoColor?t.put_auto(!0):t=Common.Utils.ThemeColor.getRgbColor(this.btnTextColor.currentColor),i.put_Color(t),e.put_TextPr(i))),this.props},disableControls:function(t){var e=t!=Asc.c_oAscWatermarkType.Image;_.each(this.imageControls,function(t){t.setDisabled(e)}),e=t!=Asc.c_oAscWatermarkType.Text,_.each(this.textControls,function(t){t.setDisabled(e)}),this.cmbLang.setDisabled(e||!this.languages||this.languages.length<1),this.btnOk.setDisabled(t==Asc.c_oAscWatermarkType.Image&&!this.isImageLoaded)},onDlgBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onPrimary:function(){return this._handleInput("ok"),!1},_handleInput:function(t){if(this.handler){if("ok"==t&&this.btnOk.isDisabled())return;this.handler.call(this,t,this.getSettings())}this.close()}},DE.Views.WatermarkSettingsDialog||{}))}),define("documenteditor/main/app/view/ListTypesAdvanced",["common/main/lib/component/Window"],function(){"use strict";DE.Views.ListTypesAdvanced=Common.UI.Window.extend(_.extend({options:{header:!1,width:250,cls:"modal-dlg",buttons:["ok","cancel"]},template:'<div class="box"><div class="input-row"><label><%= label %></label></div><div class="input-row" id="id-advanced-list-type"></div></div>',initialize:function(t){_.extend(this.options,t||{},{label:this.labelSelect}),this.options.tpl=_.template(this.template)(this.options),this.lang=this.options.lang,Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this.getChild(),e=(t.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),[]),i=this,t=(Asc.c_oAscAllNumberingTypes&&Asc.c_oAscAllNumberingTypes.forEach(function(t){e.push({displayValue:AscCommon.IntToNumberFormat(1,t,i.lang)+", "+AscCommon.IntToNumberFormat(2,t,i.lang)+", "+AscCommon.IntToNumberFormat(3,t,i.lang)+",...",value:t})}),this.cmbTypes=new Common.UI.ComboBox({el:t.find("#id-advanced-list-type"),cls:"input-group-nr",menuStyle:"min-width: 100%; max-height: 190px;",data:e,editable:!1,takeFocusOnClose:!0,scrollAlwaysVisible:!0}),this.cmbTypes.scroller&&this.cmbTypes.scroller.update({alwaysVisibleY:!0}),void 0!==this.options.current?this.cmbTypes.store.findWhere({value:this.options.current}):null),i=(this.cmbTypes.setValue(t?t.value:Asc.c_oAscNumberingFormat.Decimal),this);setTimeout(function(){i.cmbTypes.focus()},100)},close:function(t){this.getChild().find(".combobox.open").length||Common.UI.Window.prototype.close.call(this,arguments)},onBtnClick:function(t){this.options.handler&&this.options.handler.call(this,t.currentTarget.attributes.result.value,this.cmbTypes.getValue()),this.close()},onPrimary:function(){return this.options.handler&&this.options.handler.call(this,"ok",this.cmbTypes.getValue()),this.close(),!1}},DE.Views.ListTypesAdvanced||{}))}),void 0===Common&&(Common={}),define("documenteditor/main/app/view/ListSettingsDialog",["common/main/lib/component/Window","common/main/lib/component/MetricSpinner","common/main/lib/component/ThemeColorPalette","common/main/lib/component/ColorButton","common/main/lib/component/ComboBox","common/main/lib/view/SymbolTableDialog","documenteditor/main/app/view/ListTypesAdvanced"],function(){"use strict";DE.Views.ListSettingsDialog=Common.UI.Window.extend(_.extend({options:{type:0,width:300,height:460,style:"min-width: 240px;",cls:"modal-dlg",split:!1,buttons:null},initialize:function(t){this.type=t.type||0,this.extended=!0,this.rightPanelWidth=210,_.extend(this.options,{title:this.txtTitle,height:2===this.type?451:1===this.type?470:424,width:2===this.type?415+(this.extended?this.rightPanelWidth:0):300},t||{}),this.template=['<table style="width:100%;" class="">',"<tr>",'<td style="vertical-align: top;">','<div class="box list-settings">',"<% if (type == 2) { %>",'<table style="width: 100%;">',"<tr>",'<td class="padding-right-5" style="width: 100%;">','<label class="input-label">'+this.txtType+"</label>",'<div id="id-dlg-numbering-format" class="input-group-nr" style="width: 100%;margin-bottom: 10px;"></div>',"</td>",'<td class="padding-left-5">','<label class="input-label">'+this.txtSize+"</label>",'<div id="id-dlg-bullet-size" class="input-group-nr" style="width: 115px;margin-bottom: 10px;"></div>',"</td>","</td>",'<td class="padding-left-5">','<label class="input-label"></label>','<div id="id-dlg-numbering-bold" style="margin-bottom: 10px;"></div>',"</td>",'<td class="padding-left-5">','<label class="input-label"></label>','<div id="id-dlg-numbering-italic" style="margin-bottom: 10px;"></div>',"</td>",'<td class="padding-left-5">','<label class="input-label"></label>','<div id="id-dlg-bullet-color" style="margin-bottom: 10px;"></div>',"</td>","</tr>","</table>",'<table style="width: 100%;">',"<tr>",'<td class="padding-right-5" style="width: 100%;">','<label class="input-label">'+this.txtNumFormatString+"</label>",'<div id="id-dlg-numbering-format-str" style="width: 100%;height:22px;margin-bottom: 10px;"></div>',"</td>",'<td class="padding-left-5">','<label class="input-label"></label>','<div id="id-dlg-btn-more" style="width: 100%;height:22px;margin-bottom: 10px;"></div>',"</td>","</tr>","</table>","<% } else if (type == 0) {%>",'<table cols="2" style="width: 100%;">',"<tr>",'<td class="padding-right-5">','<label class="input-label">'+this.txtType+"</label>",'<div id="id-dlg-numbering-format" class="input-group-nr" style="width: 100%;margin-bottom: 10px;"></div>',"</td>",'<td class="padding-left-5">','<label class="input-label">'+this.txtAlign+"</label>",'<div id="id-dlg-bullet-align" class="input-group-nr" style="width: 100%;margin-bottom: 10px;"></div>',"</td>","</tr>","<tr>",'<td colspan="2">','<label class="input-label" style="display: block;">'+this.txtSize+"</label>",'<div id="id-dlg-bullet-size" class="input-group-nr" style="width: 129px;display: inline-block;margin-bottom: 10px;vertical-align: middle;"></div>','<div id="id-dlg-numbering-bold" class="margin-left-4" style="display: inline-block;margin-bottom: 10px;vertical-align: middle;"></div>','<div id="id-dlg-numbering-italic" class="margin-left-4" style="display: inline-block;margin-bottom: 10px;vertical-align: middle;"></div>','<div id="id-dlg-bullet-color" class="margin-left-4" style="display: inline-block;margin-bottom: 10px;vertical-align: middle;"></div>',"</td>","</tr>","</table>","<% } else { %>",'<table cols="2" style="width: 100%;">',"<tr>",'<td class="padding-right-5">','<label class="input-label">'+this.txtType+"</label>",'<div id="id-dlg-numbering-format" class="input-group-nr" style="width: 100%;margin-bottom: 10px;"></div>',"</td>",'<td class="padding-left-5">','<label class="input-label">'+this.txtAlign+"</label>",'<div id="id-dlg-bullet-align" class="input-group-nr" style="width: 100%;margin-bottom: 10px;"></div>',"</td>","</tr>","<tr>",'<td colspan="2" style="width: 100%;">','<label class="input-label">'+this.txtNumFormatString+"</label>",'<div id="id-dlg-numbering-format-str" style="width: 100%;height:22px;margin-bottom: 10px;"></div>',"</td>","</tr>","</table>",'<table cols="2" style="width: 100%;">',"<tr>",'<td class="padding-right-5">','<label class="input-label" style="display: block;">'+this.txtFontName+"</label>",'<div id="id-dlg-numbering-font-name" style="display: inline-block;width: 90px;height:22px;margin-bottom: 10px;vertical-align: middle;"></div>','<div id="id-dlg-numbering-bold" class="margin-left-4" style="display: inline-block;margin-bottom: 10px;vertical-align: middle;"></div>','<div id="id-dlg-numbering-italic" class="margin-left-4" style="display: inline-block;margin-bottom: 10px;vertical-align: middle;"></div>','<div id="id-dlg-bullet-color" class="margin-left-4" style="display: inline-block;margin-bottom: 10px;vertical-align: middle;"></div>',"</td>",'<td class="padding-left-5">','<label class="input-label">'+this.txtSize+"</label>",'<div id="id-dlg-bullet-size" class="input-group-nr" style="width: 85px;margin-bottom: 10px;"></div>',"</td>","</tr>","</table>","<% } %>",'<table cols="2" style="width: 100%;">',"<tr>",'<td colspan="2">',"<label>"+(2===this.type?this.textSelectLevel:this.textPreview)+"</label>","</td>","</tr>","<tr>",'<td class="padding-right-10 <% if (type != 2) { %> hidden <% } %>" style="width: 50px;vertical-align: top;">','<div id="levels-list" class="no-borders" style="width:100%; height:235px;"></div>',"</td>","<td>",'<div id="bulleted-list-preview" style="height:'+(2===this.type?235:208)+'px;"></div>',"</td>","</tr>","</table>","</div>",'<div class="footer center">','<button class="btn normal dlg-btn primary" result="ok" style="width: 86px;">'+this.okButtonText+"</button>",'<button class="btn normal dlg-btn" result="cancel" style="width: 86px;">'+this.cancelButtonText+"</button>","</div>","</td>","<% if (type == 2) { %>",'<td style="width: '+this.rightPanelWidth+'px;vertical-align: top;">','<div id="id-dlg-panel-more-settings" class="padding-left-20" style="width: '+this.rightPanelWidth+'px;">','<table cols="2" style="width: 100%;">',"<tr>",'<td colspan="2">','<label class="input-label" style="display: block;">'+this.txtFontName+"</label>",'<div id="id-dlg-numbering-font-name" style="display: inline-block;width: 100%;height:22px;margin-bottom: 10px;"></div>',"</td>","</tr>","<tr>",'<td colspan="2">','<label class="input-label">'+this.txtInclcudeLevel+"</label>",'<div id="id-dlg-numbering-format-lvl" class="input-group-nr" style="width: 100%;margin-bottom: 10px;"></div>',"</td>","</tr>","<tr>",'<td colspan="2">','<label class="input-label">'+this.txtStart+"</label>",'<div id="id-dlg-numbering-spin-start" style="width: 100%;margin-bottom: 5px;"></div>',"</td>","</tr>","<tr>",'<td colspan="2">','<div id="id-dlg-numbering-restart" style="width: 100%;margin-bottom: 10px;"></div>',"</td>","</tr>","<tr>","<td>",'<label class="input-label">'+this.txtAlign+"</label>","</td>",'<td class="padding-left-5" style="vertical-align:bottom;">','<label class="input-label">'+this.txtAlignAt+"</label>","</td>","</tr>","<tr>","<td>",'<div id="id-dlg-bullet-align" class="input-group-nr" style="width: 100%;margin-bottom: 10px;"></div>',"</td>",'<td class="padding-left-5">','<div id="id-dlg-numbering-align-at" style="width: 100%;min-width40px;margin-bottom: 10px;"></div>',"</td>","</tr>","<tr>",'<td colspan="2">','<label class="input-label">'+this.txtIndent+"</label>",'<div id="id-dlg-numbering-indent" style="width: 100%;margin-bottom: 10px;"></div>',"</td>","</tr>","<tr>",'<td colspan="2">','<label class="input-label">'+this.txtFollow+"</label>",'<div id="id-dlg-numbering-follow" class="input-group-nr" style="width: 100%;margin-bottom: 10px;"></div>',"</td>","</tr>","<tr>",'<td colspan="2">','<div id="id-dlg-chk-tabstop" class="input-group-nr" style="width: 100%;margin-bottom: 3px;"></div>',"</td>","</tr>","<tr>",'<td colspan="2" class="padding-left-22">','<div id="id-dlg-num-tabstop" style="width: 100%;"></div>',"</td>","</tr>","</table>","</div>","</td>","<% } %>","</tr>","</table>"].join(""),this.props=t.props,this.level=t.level||0,this.api=t.api,this.fontStore=t.fontStore,this.fontName="",this.options.tpl=_.template(this.template)(this.options),this.levels=[],this.formatString={selectionStart:0,selectionEnd:0,text:"",lvlIndexes:[]},this.spinners=[],this.recentBullets=[],this.recentNumTypes=[],this.lang=this.api.asc_GetPossibleNumberingLanguage(),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);for(var n=this,t=this.getChild(),e=(t.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.btnColor=new Common.UI.ButtonColored({parentEl:t.find("#id-dlg-bullet-color"),cls:"btn-toolbar move-focus",iconCls:"toolbar__icon btn-fontcolor",hint:this.txtColor,menu:!0,takeFocusOnClose:!0,additionalItems:[{id:"id-dlg-bullet-text-color",caption:this.txtLikeText,checkable:!0,toggleGroup:"list-settings-color",style:Common.UI.isRTL()?"padding-right:20px;":"padding-left:20px;"},{id:"id-dlg-bullet-auto-color",caption:this.textAuto,checkable:!0,toggleGroup:"list-settings-color",style:Common.UI.isRTL()?"padding-right:20px;":"padding-left:20px;"},{caption:"--"}],additionalAlign:this.menuAddAlign}),this.btnColor.setMenu(),this.btnColor.on("color:select",_.bind(this.onColorsSelect,this)),this.btnColor.menu.items[0].on("toggle",_.bind(this.onLikeTextColor,this)),this.btnColor.menu.items[1].on("toggle",_.bind(this.onAutoColor,this)),this.colors=this.btnColor.getPicker(),["<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%= item.value %>"><a tabindex="-1" type="menuitem">','<%= item.displayValue %><% if (item.value === Asc.c_oAscNumberingFormat.Bullet) { %><span style="font-family:<%=item.font%>;"><%=item.symbol%></span><% } %>',"</a></li>","<% }); %>"]),i=['<div class="input-group combobox input-group-nr <%= cls %>" id="<%= id %>" style="<%= style %>">','<div class="form-control" style="display: block; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; padding-top:3px; line-height: 14px; cursor: pointer; <%= style %>"></div>','<div style="display: table-cell;"></div>','<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown"><span class="caret"></span></button>','<ul class="dropdown-menu <%= menuCls %>" style="<%= menuStyle %>" role="menu">'].concat(e).concat(["</ul>","</div>"]),o=(this._arrNumbers=[{displayValue:"1, 2, 3,...",value:Asc.c_oAscNumberingFormat.Decimal},{displayValue:"a, b, c,...",value:Asc.c_oAscNumberingFormat.LowerLetter},{displayValue:"A, B, C,...",value:Asc.c_oAscNumberingFormat.UpperLetter},{displayValue:"i, ii, iii,...",value:Asc.c_oAscNumberingFormat.LowerRoman},{displayValue:"I, II, III,...",value:Asc.c_oAscNumberingFormat.UpperRoman}],"ru"===Common.Locale.getDefaultLanguage()&&(this._arrNumbers=this._arrNumbers.concat([{displayValue:"а, б, в,...",value:Asc.c_oAscNumberingFormat.RussianLower},{displayValue:"А, Б, В,...",value:Asc.c_oAscNumberingFormat.RussianUpper}])),this._arrBullets=[{displayValue:this.txtSymbol+": ",value:Asc.c_oAscNumberingFormat.Bullet,symbol:"·",font:"Symbol"},{displayValue:this.txtSymbol+": ",value:Asc.c_oAscNumberingFormat.Bullet,symbol:"o",font:"Courier New"},{displayValue:this.txtSymbol+": ",value:Asc.c_oAscNumberingFormat.Bullet,symbol:"§",font:"Wingdings"},{displayValue:this.txtSymbol+": ",value:Asc.c_oAscNumberingFormat.Bullet,symbol:"v",font:"Wingdings"},{displayValue:this.txtSymbol+": ",value:Asc.c_oAscNumberingFormat.Bullet,symbol:"Ø",font:"Wingdings"},{displayValue:this.txtSymbol+": ",value:Asc.c_oAscNumberingFormat.Bullet,symbol:"ü",font:"Wingdings"},{displayValue:this.txtSymbol+": ",value:Asc.c_oAscNumberingFormat.Bullet,symbol:"¨",font:"Symbol"},{displayValue:this.txtSymbol+": ",value:Asc.c_oAscNumberingFormat.Bullet,symbol:"–",font:"Arial"}],this._itemNoneBullet={displayValue:this.txtNone,value:Asc.c_oAscNumberingFormat.None},this._itemNewBullet={displayValue:this.txtNewBullet,value:-1},this._itemMoreTypes={displayValue:this.txtMoreTypes,value:-2},this.loadRecent(),this.cmbFormat=new Common.UI.ComboBoxCustom({el:t.find("#id-dlg-numbering-format"),menuStyle:"min-width: 100%;max-height: 220px;",style:2===this.type?"width: 100%;":"width: 129px;",editable:!1,template:_.template(i.join("")),itemsTemplate:_.template(e.join("")),takeFocusOnClose:!0,data:[],updateFormControl:function(t,e){var i=$(this.el).find(".form-control");t?t.get("value")==Asc.c_oAscNumberingFormat.Bullet?i[0].innerHTML=t.get("displayValue")+'<span style="font-family:'+(t.get("font")||"Arial")+'">'+t.get("symbol")+"</span>":i[0].innerHTML=t.get("displayValue"):i[0].innerHTML=e||""}}),this.cmbFormat.on("selected",_.bind(function(t,e){var i;this._changedProps&&(-1==e.value?this.addNewBullet(function(t){n.fillLevelProps(n.levels[n.level])}):-2==e.value?this.addNewListType(function(t){n.fillLevelProps(n.levels[n.level])}):(i=this._changedProps.get_Format(),this._changedProps.put_Format(e.value),e.value==Asc.c_oAscNumberingFormat.Bullet?(this.bulletProps.font=e.font||void 0,this.bulletProps.symbol=e.symbol,this._changedProps.put_FontFamily(this.bulletProps.font),this._changedProps.put_Text([new Asc.CAscNumberingLvlText]),this._changedProps.get_Text()[0].put_Value(this.bulletProps.symbol)):i==Asc.c_oAscNumberingFormat.Bullet?(this._changedProps.put_FontFamily(void 0),this._changedProps.put_Text([new Asc.CAscNumberingLvlText]),this._changedProps.get_Text()[0].put_Type(Asc.c_oAscNumberingLvlTextType.Num),this._changedProps.get_Text()[0].put_Value(this.level)):i!=Asc.c_oAscNumberingFormat.None||this.formatString.lvlIndexes[this.level][this.level]||(e=this.txtNumFormat.$el.find("input")[0].selectionStart,this._changedProps.get_Text().splice(e,0,new Asc.CAscNumberingLvlText(Asc.c_oAscNumberingLvlTextType.Num,this.level))),this.fillLevelProps(this.levels[this.level]))),this.api&&this.api.SetDrawImagePreviewBullet("bulleted-list-preview",this.props,this.level,2==this.type)},this)),this.cmbAlign=new Common.UI.ComboBox({el:t.find("#id-dlg-bullet-align"),menuStyle:"min-width: 100%;",editable:!1,cls:"input-group-nr",data:[{value:AscCommon.align_Left,displayValue:this.textLeft},{value:AscCommon.align_Center,displayValue:this.textCenter},{value:AscCommon.align_Right,displayValue:this.textRight}],takeFocusOnClose:!0}),this.cmbAlign.on("selected",_.bind(function(t,e){this._changedProps&&this._changedProps.put_Align(e.value),this.api&&this.api.SetDrawImagePreviewBullet("bulleted-list-preview",this.props,this.level,2==this.type)},this)),this.cmbSize=new Common.UI.ComboBox({el:t.find("#id-dlg-bullet-size"),menuStyle:"min-width: 100%;max-height: 183px;",editable:!1,cls:"input-group-nr",data:[{value:-1,displayValue:this.txtLikeText},{value:8,displayValue:"8"},{value:9,displayValue:"9"},{value:10,displayValue:"10"},{value:11,displayValue:"11"},{value:12,displayValue:"12"},{value:14,displayValue:"14"},{value:16,displayValue:"16"},{value:18,displayValue:"18"},{value:20,displayValue:"20"},{value:22,displayValue:"22"},{value:24,displayValue:"24"},{value:26,displayValue:"26"},{value:28,displayValue:"28"},{value:36,displayValue:"36"},{value:48,displayValue:"48"},{value:72,displayValue:"72"},{value:96,displayValue:"96"}],takeFocusOnClose:!0}),this.cmbSize.on("selected",_.bind(function(t,e){this._changedProps&&this._changedProps.put_FontSize(0<e.value?e.value:void 0),this.api&&this.api.SetDrawImagePreviewBullet("bulleted-list-preview",this.props,this.level,2==this.type)},this)),[]),s=0;s<9;s++)o.push({value:s});this.levelsList=new Common.UI.ListView({el:$("#levels-list",this.$window),store:new Common.UI.DataViewStore(o),tabindex:1,itemTemplate:_.template('<div id="<%= id %>" class="list-item" style="pointer-events:none;overflow: hidden; text-overflow: ellipsis;line-height: 15px;"><%= (value+1) %></div>')}),this.levelsList.on("item:select",_.bind(this.onSelectLevel,this)),this.txtNumFormat=new Common.UI.InputField({el:t.find("#id-dlg-numbering-format-str"),allowBlank:!0,value:""});var a=this.txtNumFormat.$el.find("input"),l=(a.on("keydown",_.bind(this.onKeyDown,this)),a.on("keyup",_.bind(this.onKeyUp,this)),a.on("input",_.bind(this.onFormatInput,this)),function(t){n.checkMousePosition(a[0]),$(document).off("mouseup",l)});a.on("mousedown",_.bind(function(t){$(document).on("mouseup",l)},this)),a.on("contextmenu",function(t){return t.preventDefault(),t.stopPropagation(),!1}),this.cmbLevel=new Common.UI.ComboBox({el:t.find("#id-dlg-numbering-format-lvl"),menuStyle:"min-width: 100%;",style:"width: 100%;",editable:!1,cls:"input-group-nr",data:[],takeFocusOnClose:!0}),this.cmbLevel.on("selected",_.bind(this.onIncludeLevelSelected,this)),this.spnStart=new Common.UI.MetricSpinner({el:t.find("#id-dlg-numbering-spin-start"),step:1,width:"100%",defaultUnit:"",value:1,maxValue:16383,minValue:1,allowDecimal:!1}),this.spnStart.on("change",_.bind(function(t,e,i,n){this._changedProps&&(this._changedProps.put_Start(t.getNumberValue()),this.makeFormatStr(this._changedProps)),this.api&&this.api.SetDrawImagePreviewBullet("bulleted-list-preview",this.props,this.level,2==this.type)},this)),this.cmbFonts=new Common.UI.ComboBoxFonts({el:t.find("#id-dlg-numbering-font-name"),cls:"input-group-nr",style:"width: 100%;",menuCls:"scrollable-menu",menuStyle:"min-width: 100%;max-height: 270px;",store:new Common.Collections.Fonts,recent:0,hint:this.tipFontName,takeFocusOnClose:!0}).on("selected",_.bind(this.onFontName,this)),this.btnBold=new Common.UI.Button({parentEl:t.find("#id-dlg-numbering-bold"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-bold",enableToggle:!0,hint:this.textBold}),this.btnBold.on("click",_.bind(this.onBoldClick,this)),this.btnItalic=new Common.UI.Button({parentEl:t.find("#id-dlg-numbering-italic"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-italic",enableToggle:!0,hint:this.textItalic}),this.btnItalic.on("click",_.bind(this.onItalicClick,this)),this.spnAlign=new Common.UI.MetricSpinner({el:t.findById("#id-dlg-numbering-align-at"),step:.1,width:"100%",defaultUnit:"cm",defaultValue:0,value:"0 cm",maxValue:55.87,minValue:0}),this.spinners.push(this.spnAlign),this.spnAlign.on("change",_.bind(function(t,e,i,n){this._changedProps&&(this._changedProps.put_NumberPosition(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())),this.spnTabStop.setMinValue(t.getNumberValue()),this.spnTabStop.setValue(this.spnTabStop.getValue(),!0)),this.api&&this.api.SetDrawImagePreviewBullet("bulleted-list-preview",this.props,this.level,2==this.type)},this)),this.spnIndents=new Common.UI.MetricSpinner({el:t.findById("#id-dlg-numbering-indent"),step:.1,width:"100%",defaultUnit:"cm",defaultValue:0,value:"0 cm",maxValue:55.87,minValue:0}),this.spinners.push(this.spnIndents),this.spnIndents.on("change",_.bind(function(t,e,i,n){this._changedProps&&this._changedProps.put_IndentSize(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())),this.api&&this.api.SetDrawImagePreviewBullet("bulleted-list-preview",this.props,this.level,2==this.type)},this)),this.cmbFollow=new Common.UI.ComboBox({el:t.find("#id-dlg-numbering-follow"),menuStyle:"min-width: 100%;",editable:!1,cls:"input-group-nr",data:[{value:Asc.c_oAscNumberingSuff.Tab,displayValue:this.textTab},{value:Asc.c_oAscNumberingSuff.Space,displayValue:this.textSpace},{value:Asc.c_oAscNumberingSuff.None,displayValue:this.txtNone}],takeFocusOnClose:!0}),this.cmbFollow.on("selected",_.bind(function(t,e){this._changedProps&&this._changedProps.put_Suff(e.value),this.chTabStop.setDisabled(e.value!==Asc.c_oAscNumberingSuff.Tab),this.spnTabStop.setDisabled(e.value!==Asc.c_oAscNumberingSuff.Tab||"checked"!==this.chTabStop.getValue()),this.api&&this.api.SetDrawImagePreviewBullet("bulleted-list-preview",this.props,this.level,2==this.type)},this)),this.chRestart=new Common.UI.CheckBox({el:t.find("#id-dlg-numbering-restart"),labelText:this.txtRestart}),this.chRestart.on("change",_.bind(function(t,e,i,n){this._changedProps&&this._changedProps.put_Restart("checked"==t.getValue()?-1:0)},this)),this.chTabStop=new Common.UI.CheckBox({el:t.find("#id-dlg-chk-tabstop"),labelText:this.txtTabStop}),this.chTabStop.on("change",_.bind(function(t,e,i,n){this._changedProps&&(this._changedProps.put_StopTab("checked"===t.getValue()?Common.Utils.Metric.fnRecalcToMM(this.spnTabStop.getNumberValue()):null),this.spnTabStop.setDisabled("checked"!==t.getValue()||this.cmbFollow.getValue()!==Asc.c_oAscNumberingSuff.Tab)),this.api&&this.api.SetDrawImagePreviewBullet("bulleted-list-preview",this.props,this.level,2==this.type)},this)),this.spnTabStop=new Common.UI.MetricSpinner({el:t.findById("#id-dlg-num-tabstop"),step:.1,width:"100%",defaultUnit:"cm",defaultValue:0,value:"0 cm",maxValue:55.87,minValue:0}),this.spinners.push(this.spnTabStop),this.spnTabStop.on("change",_.bind(function(t,e,i,n){this._changedProps&&this._changedProps.put_StopTab(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())),this.api&&this.api.SetDrawImagePreviewBullet("bulleted-list-preview",this.props,this.level,2==this.type)},this)),this.panelMore=t.findById("#id-dlg-panel-more-settings"),this.panelMoreTable=this.panelMore.parent(),this.btnMore=new Common.UI.Button({parentEl:t.findById("#id-dlg-btn-more"),cls:"btn-toolbar bg-white",iconCls:this.extended?"caret-double-left":"caret-double-right",scaling:!1,hint:this.extended?this.textHide:this.textMore}),this.btnMore.on("click",_.bind(this.onMoreClick,this)),this.on("animate:after",_.bind(this.onAnimateAfter,this)),2==this.type&&Common.localStorage.getBool("de-hide-multilevel-settings",!0)&&this.onMoreClick(this.btnMore),this.afterRender()},getFocusedComponents:function(){switch(this.type){case 0:return[this.cmbFormat,this.cmbAlign,this.cmbSize,this.btnBold,this.btnItalic,this.btnColor];case 1:return[this.cmbFormat,this.cmbAlign,this.txtNumFormat,this.cmbFonts,this.btnBold,this.btnItalic,this.btnColor,this.cmbSize];case 2:return[this.cmbFormat,this.cmbSize,this.btnBold,this.btnItalic,this.btnColor,this.txtNumFormat,this.btnMore,this.levelsList,this.cmbFonts,this.cmbLevel,this.spnStart,this.chRestart,this.cmbAlign,this.spnAlign,this.spnIndents,this.cmbFollow,this.chTabStop,this.spnTabStop]}return[]},getDefaultFocusableComponent:function(){return this.cmbFormat},onAnimateAfter:function(){this.api&&this.api.SetDrawImagePreviewBullet("bulleted-list-preview",this.props,this.level,2==this.type)},afterRender:function(){this.cmbFonts.fillFonts(this.fontStore),this.cmbFonts.selectRecord(this.fontStore.findWhere({name:this.fontName})),this.updateMetricUnit(),this.updateThemeColors(),this._setDefaults(this.props);function e(t){i.levelsList.selectByIndex(t)}var i=this;this.api.asc_registerCallback("asc_onPreviewLevelChange",e),this.on("close",function(t){i.api.asc_unregisterCallback("asc_onPreviewLevelChange",e)})},updateMetricUnit:function(){if(this.spinners)for(var t=0;t<this.spinners.length;t++){var e=this.spinners[t];e.setDefaultUnit(Common.Utils.Metric.getCurrentMetricName()),e.setStep(Common.Utils.Metric.getCurrentMetric()==Common.Utils.Metric.c_MetricUnits.pt?1:.1)}},updateThemeColors:function(){this.colors.updateColors(Common.Utils.ThemeColor.getEffectColors(),Common.Utils.ThemeColor.getStandartColors())},onAutoColor:function(t,e){e&&(e=Common.Utils.ThemeColor.getHexColor(0,0,0),this.btnColor.setColor(e),this.colors.clearSelection(),this._changedProps&&((e=new Asc.asc_CColor).put_auto(!0),this._changedProps.put_Color(e)),this.api&&this.api.SetDrawImagePreviewBullet("bulleted-list-preview",this.props,this.level,2==this.type))},onLikeTextColor:function(t,e){e&&(e=Common.Utils.ThemeColor.getHexColor(0,0,0),this.btnColor.setColor(e),this.colors.clearSelection(),this._changedProps&&this._changedProps.put_Color(void 0),this.api&&this.api.SetDrawImagePreviewBullet("bulleted-list-preview",this.props,this.level,2==this.type))},onColorsSelect:function(t,e){this._changedProps&&this._changedProps.put_Color(Common.Utils.ThemeColor.getRgbColor(e)),this.btnColor.menu.items[0].setChecked(!1,!0),this.btnColor.menu.items[1].setChecked(!1,!0),this.api&&this.api.SetDrawImagePreviewBullet("bulleted-list-preview",this.props,this.level,2==this.type)},addNewBullet:function(n){function t(t,e,i){"ok"==(o=e)&&(a.changed=!0,a.code=i.code,a.font=i.font,a.symbol=i.symbol,s._changedProps&&(s._changedProps.put_Format(Asc.c_oAscNumberingFormat.Bullet),s._changedProps.put_FontFamily(a.font),s._changedProps.put_Text([new Asc.CAscNumberingLvlText]),s._changedProps.get_Text()[0].put_Value(a.symbol),s.api&&s.api.SetDrawImagePreviewBullet("bulleted-list-preview",s.props,s.level,2==s.type))),n&&n.call(s,e)}var o,s=this,a=s.bulletProps,e=new Common.Views.SymbolTableDialog({api:s.options.api,lang:s.options.interfaceLang,modal:!0,type:0,font:a.font,symbol:a.symbol,handler:t}).on("close",function(t){void 0===o&&n&&n.call(s),setTimeout(function(){s.cmbFormat.focus()},1)});e.show(),e.on("symbol:dblclick",t)},addNewListType:function(i){var n,o=this;new DE.Views.ListTypesAdvanced({modal:!0,lang:o.lang,handler:function(t,e){"ok"==(n=t)&&o._changedProps&&(o._changedProps.put_Format(e),o.api&&o.api.SetDrawImagePreviewBullet("bulleted-list-preview",o.props,o.level,2==o.type)),i&&i.call(o,t)}}).on("close",function(t){void 0===n&&i&&i.call(o),setTimeout(function(){o.cmbFormat.focus()},1)}).show()},_handleInput:function(t){if(this.options.handler){for(var e=[],i=[],n=0;n<9;n++)this.levels[n]&&(e.push(this.levels[n]),i.push(n));this.options.handler.call(this,t,{props:1==e.length?e[0]:e,num:1==i.length?i[0]:i})}this.close()},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onPrimary:function(t){return this._handleInput("ok"),!1},_setDefaults:function(t){this.bulletProps={},t&&(t=t.get_Lvl(this.level),this.level<0&&(this.level=0),this.levels[this.level]=t||new Asc.CAscNumberingLvl(this.level),2==this.type?this.levelsList.selectByIndex(this.level):this.fillLevelProps(this.levels[this.level])),this._changedProps=this.levels[this.level]},onSelectLevel:function(t,e,i){this.level=i.get("value"),void 0===this.levels[this.level]&&(this.levels[this.level]=this.props.get_Lvl(this.level)),this.fillLevelProps(this.levels[this.level]),this._changedProps=this.levels[this.level],this.api.SetDrawImagePreviewBullet("bulleted-list-preview",this.props,this.level,2==this.type)},fillLevelProps:function(t){if(t){var e,i,n=this,o=(this.cmbAlign.setValue(void 0!==t.get_Align()?t.get_Align():""),t.get_Format()),s=t.get_Text(),s=(s&&s.length&&o==Asc.c_oAscNumberingFormat.Bullet&&(this.bulletProps.symbol=s[0].get_Value()),this.cmbSize.setValue(t.get_FontSize()||-1),t.get_FontFamily()),a=(s?(e=this.cmbFonts.store.findWhere({name:s}),this.fontName=e?e.get("name"):s,this.cmbFonts.setValue(this.fontName)):this.cmbFonts.setValue(""),this.bulletProps.font=s,this.btnBold.toggle(!0===t.get_Bold(),!0),this.btnItalic.toggle(!0===t.get_Italic(),!0),t.get_Color());if(this.btnColor.menu.items[0].setChecked(void 0===a,!0),this.btnColor.menu.items[1].setChecked(!!a&&a.get_auto(),!0),a&&!a.get_auto())if("object"==typeof a){for(var l=!1,r=0;r<10;r++)if(Common.Utils.ThemeColor.ThemeValues[r]==a.effectValue){this.colors.select(a,!0),l=!0;break}l||this.colors.clearSelection(),a=Common.Utils.ThemeColor.getHexColor(a.get_r(),a.get_g(),a.get_b())}else this.colors.select(a,!0);else this.colors.clearSelection(),a="000000";if(this.btnColor.setColor(a),1===this.type?((o!==Asc.c_oAscNumberingFormat.None||this.cmbFormat.store.length<1)&&this.checkRecentNum(o),i=[this._itemNoneBullet].concat(this._arrNumbers),this.recentNumTypes.forEach(function(t){t&&(t=parseInt(t),i.push({displayValue:AscCommon.IntToNumberFormat(1,t,n.lang)+", "+AscCommon.IntToNumberFormat(2,t,n.lang)+", "+AscCommon.IntToNumberFormat(3,t,n.lang)+",...",value:t}))}),i.push(this._itemMoreTypes),this.cmbFormat.setData(i),this.cmbFormat.setValue(void 0!==o?o:""),this.makeFormatStr(t)):((o!==Asc.c_oAscNumberingFormat.None||this.cmbFormat.store.length<1)&&(o===Asc.c_oAscNumberingFormat.Bullet?this.checkRecent(this.bulletProps.symbol,this.bulletProps.font):o!==Asc.c_oAscNumberingFormat.None&&this.checkRecentNum(o),i=2===this.type?[this._itemNoneBullet].concat(this._arrNumbers):[],2===this.type&&this.recentNumTypes.forEach(function(t){t&&(t=parseInt(t),i.push({displayValue:AscCommon.IntToNumberFormat(1,t,n.lang)+", "+AscCommon.IntToNumberFormat(2,t,n.lang)+", "+AscCommon.IntToNumberFormat(3,t,n.lang)+",...",value:t}))}),i=i.concat(this._arrBullets),this.recentBullets.forEach(function(t){i.push({displayValue:n.txtSymbol+": ",value:Asc.c_oAscNumberingFormat.Bullet,symbol:t.symbol,font:t.font})}),2===this.type&&i.push(this._itemMoreTypes),i.push(this._itemNewBullet),this.cmbFormat.setData(i)),o===Asc.c_oAscNumberingFormat.Bullet?this.cmbFormat.selectRecord(this.cmbFormat.store.findWhere({value:Asc.c_oAscNumberingFormat.Bullet,symbol:this.bulletProps.symbol,font:this.bulletProps.font||""})):0===this.type&&o===Asc.c_oAscNumberingFormat.None?this.cmbFormat.setValue(Asc.c_oAscNumberingFormat.None,this.txtNone):this.cmbFormat.setValue(void 0!==o?o:"")),2===this.type){this.spnStart.setValue(t.get_Start(),!0),this.spnAlign.setValue(Common.Utils.Metric.fnRecalcFromMM(t.get_NumberPosition()),!0),this.spnIndents.setValue(Common.Utils.Metric.fnRecalcFromMM(t.get_IndentSize()),!0),this.cmbFollow.setValue(t.get_Suff()),this.chRestart.setValue(-1===t.get_Restart(),!0),this.chTabStop.setValue(null!==t.get_StopTab(),!0),this.spnTabStop.setMinValue(this.spnAlign.getNumberValue()),this.spnTabStop.setValue(null!==t.get_StopTab()?Common.Utils.Metric.fnRecalcFromMM(t.get_StopTab()):this.spnIndents.getNumberValue(),!0),this.txtNumFormat.setDisabled(o==Asc.c_oAscNumberingFormat.Bullet),this.spnStart.setDisabled(o==Asc.c_oAscNumberingFormat.Bullet),this.chRestart.setDisabled(0===this.level),this.chTabStop.setDisabled(t.get_Suff()!==Asc.c_oAscNumberingSuff.Tab),this.spnTabStop.setDisabled(null===t.get_StopTab()||t.get_Suff()!==Asc.c_oAscNumberingSuff.Tab);for(var c=[],n=this,d=0;d<this.level;d++){var h=this.props.get_Lvl(d).get_Format();h!==Asc.c_oAscNumberingFormat.None&&h!==Asc.c_oAscNumberingFormat.Bullet&&c.push({displayValue:n.textLevel+" "+(d+1),value:d})}this.cmbLevel.setData(c),this.cmbLevel.setValue(""),this.cmbLevel.setDisabled(o==Asc.c_oAscNumberingFormat.Bullet||0===this.level||c.length<1),this.makeFormatStr(t)}}},makeFormatStr:function(t){var i,n,o="";this.formatString.lvlIndexes[this.level]=[],t&&(t.get_Format()!==Asc.c_oAscNumberingFormat.Bullet?(t=t.get_Text(),n=(i=this).formatString.lvlIndexes[this.level],t.forEach(function(t,e){t.get_Type()===Asc.c_oAscNumberingLvlTextType.Text?o+=t.get_Value().toString():t.get_Type()===Asc.c_oAscNumberingLvlTextType.Num&&(t=t.get_Value(),void 0===i.levels[t]&&(i.levels[t]=i.props.get_Lvl(t)),n[t]={start:o.length,index:e},e=i.levels[t],o+=AscCommon.IntToNumberFormat(e.get_Start(),e.get_Format(),i.lang),n[t].end=o.length)}),this.txtNumFormat.$el.find("input").css("font-family","inherit")):(o=this.bulletProps.symbol,this.txtNumFormat.$el.find("input").css("font-family",this.bulletProps.font||"inherit"))),this.formatString.text=o,this.txtNumFormat.setValue(o)},onIncludeLevelSelected:function(t,e){var i=this.txtNumFormat.$el.find("input")[0].selectionStart;if(this._changedProps){for(var n,o=this._changedProps.get_Text(),s=this.formatString.lvlIndexes[this.level],a=0;a<s.length;a++)s[a]&&(n=s[a],a===e.value?(o.splice(n.index,1),n.end<i&&(i-=n.end-n.start)):n.end<i&&(i-=n.end-n.start-1));o.splice(i,0,new Asc.CAscNumberingLvlText(Asc.c_oAscNumberingLvlTextType.Num,e.value)),this._changedProps.put_Text(o),this.makeFormatStr(this._changedProps),this.cmbLevel.setValue("")}this.api&&this.api.SetDrawImagePreviewBullet("bulleted-list-preview",this.props,this.level,2==this.type)},posToIndex:function(t){if(this._changedProps)for(var e,i=this.formatString.lvlIndexes[this.level],n=0;n<i.length;n++)!i[n]||(e=i[n]).end<t&&(t-=e.end-e.start-1);return t},isPosInRange:function(t,e){if(this._changedProps)for(var i=this.formatString.lvlIndexes[this.level],n=0;n<i.length;n++)if(i[n]){var o=i[n];if(t>o.start&&t<o.end)return e?o.end:o.start}},checkMousePosition:function(e){var i=this;setTimeout(function(){var t;e.selectionStart===e.selectionEnd?void 0!==(t=i.isPosInRange(e.selectionStart))&&(e.selectionStart=e.selectionEnd=t):(void 0!==(t=i.isPosInRange(e.selectionStart))&&(e.selectionStart=t),void 0!==(t=i.isPosInRange(e.selectionEnd,!0))&&(e.selectionEnd=t)),i.formatString.selectionStart=e.selectionStart,i.formatString.selectionEnd=e.selectionEnd},0)},onFormatInput:function(t){var e,i,n=$(t.target).val(),o=this.formatString.text,n=n.slice(this.formatString.selectionStart,n.length-(o.length-this.formatString.selectionEnd)),o=this.posToIndex(this.formatString.selectionStart),s=this.posToIndex(this.formatString.selectionEnd);this._changedProps&&(e=this._changedProps.get_Text(),i=e.slice(0,o),n.split("").forEach(function(t){i.push(new Asc.CAscNumberingLvlText(Asc.c_oAscNumberingLvlTextType.Text,t))}),i=i.concat(e.slice(s,e.length)),this._changedProps.put_Text(i),this.api&&this.api.SetDrawImagePreviewBullet("bulleted-list-preview",this.props,this.level,2==this.type),this.makeFormatStr(this._changedProps),this.formatString.lvlIndexes[this.level][this.level]||(this._changedProps.put_Format(Asc.c_oAscNumberingFormat.None),this.cmbFormat.setValue(Asc.c_oAscNumberingFormat.None))),this.formatString.selectionStart=t.target.selectionStart,this.formatString.selectionEnd=t.target.selectionEnd},onKeyDown:function(t){var e,i=this,n=t.keyCode,o=t.shiftKey;n===Common.UI.Keys.LEFT?void 0!==(e=i.isPosInRange(t.target.selectionStart-1))&&setTimeout(function(){t.target.selectionStart=e,o||(t.target.selectionEnd=e),i.formatString.selectionStart=t.target.selectionStart,i.formatString.selectionEnd=t.target.selectionEnd},0):n===Common.UI.Keys.RIGHT?void 0!==(e=i.isPosInRange(t.target.selectionEnd+1,!0))&&setTimeout(function(){t.target.selectionEnd=e,o||(t.target.selectionStart=e),i.formatString.selectionStart=t.target.selectionStart,i.formatString.selectionEnd=t.target.selectionEnd},0):n===Common.UI.Keys.BACKSPACE?t.target.selectionStart===t.target.selectionEnd&&(this.formatString.selectionStart=t.target.selectionStart-1,this.formatString.selectionEnd=t.target.selectionEnd):n===Common.UI.Keys.DELETE&&t.target.selectionStart===t.target.selectionEnd&&(this.formatString.selectionStart=t.target.selectionStart,this.formatString.selectionEnd=t.target.selectionEnd+1)},onKeyUp:function(t){this.formatString.selectionStart=t.target.selectionStart,this.formatString.selectionEnd=t.target.selectionEnd},onFontName:function(t,e){this._changedProps&&(this._changedProps.put_FontFamily(e.name||void 0),this._changedProps.get_Format()===Asc.c_oAscNumberingFormat.Bullet&&this.fillLevelProps(this._changedProps)),this.api&&this.api.SetDrawImagePreviewBullet("bulleted-list-preview",this.props,this.level,2==this.type)},onBoldClick:function(){this._changedProps&&this._changedProps.put_Bold(this.btnBold.isActive()),this.api&&this.api.SetDrawImagePreviewBullet("bulleted-list-preview",this.props,this.level,2==this.type)},onItalicClick:function(){this._changedProps&&this._changedProps.put_Italic(this.btnItalic.isActive()),this.api&&this.api.SetDrawImagePreviewBullet("bulleted-list-preview",this.props,this.level,2==this.type)},loadRecent:function(){var t=Common.localStorage.getItem("de-recent-list-bullets");if(""!==t&&(t=JSON.parse(t)),_.isArray(t)){this.recentBullets=t;for(var e=0;e<this.recentBullets.length;++e)this.recentBullets[e].symbol||(this.recentBullets.splice(e,1),e--)}""!==(t=Common.localStorage.getItem("de-recent-list-formats"))&&(t=JSON.parse(t)),_.isArray(t)&&(this.recentNumTypes=t)},saveRecent:function(){var t=JSON.stringify(this.recentBullets);Common.localStorage.setItem("de-recent-list-bullets",t)},saveRecentNum:function(){var t=JSON.stringify(this.recentNumTypes);Common.localStorage.setItem("de-recent-list-formats",t)},checkRecent:function(t,e){if(t){e=e||"";for(var i=0;i<this._arrBullets.length;++i)if(this._arrBullets[i].symbol===t&&this._arrBullets[i].font===e)return;if(0===this.recentBullets.length)this.recentBullets.push({symbol:t,font:e});else{for(i=0;i<this.recentBullets.length;++i)if(this.recentBullets[i].symbol===t&&this.recentBullets[i].font===e){this.recentBullets.splice(i,1);break}this.recentBullets.splice(0,0,{symbol:t,font:e}),5<this.recentBullets.length&&this.recentBullets.splice(5,this.recentBullets.length-5)}this.saveRecent()}},checkRecentNum:function(t){if(null!=t){for(var e=0;e<this._arrNumbers.length;++e)if(this._arrNumbers[e].value===t)return;if(0===this.recentNumTypes.length)this.recentNumTypes.push(t);else{for(e=0;e<this.recentNumTypes.length;++e)if(this.recentNumTypes[e]===t){this.recentNumTypes.splice(e,1);break}this.recentNumTypes.splice(0,0,t),5<this.recentNumTypes.length&&this.recentNumTypes.splice(5,this.recentNumTypes.length-5)}this.saveRecentNum()}},onMoreClick:function(t){this.extended?(this.extended=!1,this.panelMore.css({display:"none"}),this.panelMoreTable.css({width:"auto"}),this.setWidth(this.getWidth()-this.rightPanelWidth),t.updateHint(this.textMore),t.setIconCls("icon caret-double-right"),Common.localStorage.setItem("de-hide-multilevel-settings",1)):(this.extended=!0,this.panelMore.css({display:"block"}),this.panelMoreTable.width(this.panelMore.width()),this.setWidth(this.getWidth()+this.rightPanelWidth),t.updateHint(this.textHide),t.setIconCls("icon caret-double-left"),Common.localStorage.setItem("de-hide-multilevel-settings",0))}},DE.Views.ListSettingsDialog||{}))}),define("documenteditor/main/app/view/DateTimeDialog",["common/main/lib/component/Window","common/main/lib/component/ComboBox","common/main/lib/component/ListView"],function(){"use strict";DE.Views.DateTimeDialog=Common.UI.Window.extend(_.extend({options:{width:350,style:"min-width: 230px;",cls:"modal-dlg",id:"window-date-time",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:this.txtTitle},t||{}),this.template=['<div class="box" style="height: 275px;">','<div class="input-row">','<label class="font-weight-bold">'+this.textLang+"</label>","</div>",'<div id="datetime-dlg-lang" class="input-row" style="margin-bottom: 8px;"></div>','<div class="input-row">','<label class="font-weight-bold">'+this.textFormat+"</label>","</div>",'<div id="datetime-dlg-format" class="" style="margin-bottom: 10px;width: 100%; height: 162px; overflow: hidden;"></div>','<div class="input-row">','<div id="datetime-dlg-update" style="margin-top: 3px;margin-bottom: 10px;"></div>','<button type="button" class="btn btn-text-default auto float-right" id="datetime-dlg-default">'+this.textDefault+"</button>","</div>","</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),this.api=this.options.api,this.lang=2052,this.handler=this.options.handler,Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var t=[{value:1068},{value:1026},{value:1029},{value:1030},{value:3079},{value:1031},{value:2055},{value:1032},{value:3081},{value:2057},{value:1033},{value:3082},{value:2058},{value:1035},{value:1036},{value:4108},{value:1040},{value:2064},{value:1041},{value:1042},{value:1062},{value:1038},{value:1043},{value:1045},{value:1046},{value:2070},{value:1049},{value:1051},{value:1060},{value:2077},{value:1053},{value:1055},{value:1058},{value:1066},{value:2052}];t.forEach(function(t){var e=Common.util.LanguageInfo.getLocalLanguageName(t.value);t.displayValue=e[1],t.langName=e[0]}),this.cmbLang=new Common.UI.ComboBox({el:$("#datetime-dlg-lang"),menuStyle:"min-width: 100%; max-height: 185px;",cls:"input-group-nr",editable:!1,takeFocusOnClose:!0,data:t,search:!0,scrollAlwaysVisible:!0}),this.cmbLang.setValue(2052),this.cmbLang.on("selected",_.bind(function(t,e){this.updateFormats(e.value)},this)),this.chUpdate=new Common.UI.CheckBox({el:$("#datetime-dlg-update"),labelText:this.textUpdate}),this.chUpdate.on("change",_.bind(function(t,e,i,n){this.onSelectFormat(this.listFormats,null,this.listFormats.getSelectedRec())},this)),this.listFormats=new Common.UI.ListView({el:$("#datetime-dlg-format"),store:new Common.UI.DataViewStore,tabindex:1,scrollAlwaysVisible:!0,cls:"dbl-clickable"}),this.listFormats.on("item:select",_.bind(this.onSelectFormat,this)),this.listFormats.on("item:dblclick",_.bind(this.onDblClickFormat,this)),this.listFormats.on("entervalue",_.bind(this.onPrimary,this)),this.btnDefault=new Common.UI.Button({el:$("#datetime-dlg-default")}),this.btnDefault.on("click",_.bind(function(t,e){var n=this.listFormats.getSelectedRec();Common.UI.warning({msg:Common.Utils.String.format(this.confirmDefault,Common.util.LanguageInfo.getLocalLanguageName(this.cmbLang.getValue())[1],n?n.get("value"):""),buttons:["yes","no"],primary:"yes",callback:_.bind(function(t){if("yes"==t){this.defaultFormats[this.cmbLang.getValue()]=n?n.get("format"):"";var e,i=[];for(e in this.defaultFormats)e&&i.push({lang:e,format:this.defaultFormats[e]});t=JSON.stringify(i);Common.localStorage.setItem("de-settings-datetime-default",t),Common.Utils.InternalSettings.set("de-settings-datetime-default",t)}this.listFormats.focus()},this)})},this)),this.chUpdate.$el.outerWidth()+this.btnDefault.$el.outerWidth()>this.$window.find(".box").width()&&(this.btnDefault.$el.removeClass("float-right"),this.listFormats.$el.height(139)),this.$window.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.afterRender()},afterRender:function(){var e=this,t=Common.Utils.InternalSettings.get("de-settings-datetime-default"),t=t?JSON.parse(t):[];this.defaultFormats=[],t.forEach(function(t){t.lang&&(e.defaultFormats[parseInt(t.lang)]=t.format)}),this._setDefaults()},getFocusedComponents:function(){return[this.cmbLang,this.listFormats,this.chUpdate,this.btnDefault]},getDefaultFocusableComponent:function(){return this.cmbLang},_setDefaults:function(){var t;this.props=new Asc.CAscDateTime,this.lang&&(t=(t=this.cmbLang.store.findWhere({value:this.lang}))?t.get("value"):2052,this.cmbLang.setValue(t)),this.updateFormats(this.cmbLang.getValue())},getSettings:function(){return this.props},updateFormats:function(t){this.props.put_Lang(t);for(var e=this.props.get_FormatsExamples(),i=[],n=this.listFormats.store,o=0,s=e.length;o<s;o++)(l=new Common.UI.DataViewModel).set({format:e[o],value:this.props.get_String(e[o],void 0,t)}),i.push(l);n.reset(i);var a=this.defaultFormats[t],l=(a?this.listFormats.selectRecord(n.findWhere({format:a})):this.listFormats.selectByIndex(0),this.listFormats.getSelectedRec());this.listFormats.scrollToRecord(l),this.onSelectFormat(this.listFormats,null,l)},onSelectFormat:function(t,e,i){i&&(this.props.put_Format(i.get("format")),this.props.put_Update("checked"==this.chUpdate.getValue()))},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onDblClickFormat:function(){this._handleInput("ok")},onPrimary:function(t){return this._handleInput("ok"),!1},_handleInput:function(t){this.options.handler&&this.options.handler.call(this,t,this.getSettings()),this.close()}},DE.Views.DateTimeDialog||{}))}),define("documenteditor/main/app/view/LineNumbersDialog",["common/main/lib/component/Window","common/main/lib/component/CheckBox","common/main/lib/component/MetricSpinner"],function(){"use strict";DE.Views.LineNumbersDialog=Common.UI.Window.extend(_.extend({options:{width:290,height:332,header:!0,style:"min-width: 290px;",cls:"modal-dlg",id:"window-line-numbers",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:this.textTitle},t||{}),this.template=['<div class="box" style="">','<div id="line-numbers-add-line-numbering" style="margin-bottom: 15px;"></div>','<div style="margin-bottom: 15px;">','<div class="margin-right-9" style="display: inline-block;"><label>'+this.textStartAt+'</label><div id="line-numbers-start-at"></div></div>','<div class="margin-right-9" style="display: inline-block;"><label>'+this.textFromText+'</label><div id="line-numbers-from-text"></div></div>','<div style="display: inline-block;"><label>'+this.textCountBy+'</label><div id="line-numbers-count-by"></div></div>',"</div>",'<div style="margin-bottom: 8px;"><label>'+this.textNumbering+"</label></div>",'<div id="line-numbers-restart-each-page" style="margin-bottom: 8px;"></div>','<div id="line-numbers-restart-each-section" style="margin-bottom: 8px;"></div>','<div id="line-numbers-continuous" style="margin-bottom: 15px;"></div>','<div style="margin-bottom: 5px;">',"<label>"+this.textApplyTo+'</label><div id="line-numbers-combo-apply" class="input-group-nr" style="width:150px;"></div>',"</div>","</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),this.spinners=[],this._noApply=!1,Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this),this.chAddLineNumbering=new Common.UI.CheckBox({el:$("#line-numbers-add-line-numbering"),labelText:this.textAddLineNumbering}).on("change",_.bind(function(t,e,i,n){t="checked"!==t.getValue();this.spnStartAt.setDisabled(t),this.spnFromText.setDisabled(t),this.spnCountBy.setDisabled(t),this.rbRestartEachPage.setDisabled(t),this.rbRestartEachSection.setDisabled(t),this.rbContinuous.setDisabled(t)},this)),this.spnStartAt=new Common.UI.MetricSpinner({el:$("#line-numbers-start-at"),step:1,width:80,defaultUnit:"",value:1,maxValue:32767,minValue:1,disabled:!0}),this.spnFromText=new Common.UI.MetricSpinner({el:$("#line-numbers-from-text"),step:.1,width:80,defaultUnit:"cm",value:"Auto",autoText:this.txtAutoText,maxValue:55.87,minValue:.1,allowAuto:!0,disabled:!0}),this.spinners.push(this.spnFromText),this.spnCountBy=new Common.UI.MetricSpinner({el:$("#line-numbers-count-by"),step:1,width:80,defaultUnit:"",value:1,maxValue:100,minValue:1,disabled:!0}),this.rbRestartEachPage=new Common.UI.RadioBox({el:$("#line-numbers-restart-each-page"),labelText:this.textRestartEachPage,name:"asc-radio-line-numbers",disabled:!0,checked:!0}),this.rbRestartEachSection=new Common.UI.RadioBox({el:$("#line-numbers-restart-each-section"),labelText:this.textRestartEachSection,name:"asc-radio-line-numbers",disabled:!0}),this.rbContinuous=new Common.UI.RadioBox({el:$("#line-numbers-continuous"),labelText:this.textContinuous,name:"asc-radio-line-numbers",disabled:!0}),this.cmbApply=new Common.UI.ComboBox({el:$("#line-numbers-combo-apply"),cls:"input-group-nr",menuStyle:"min-width: 150px;",takeFocusOnClose:!0,editable:!1,data:[{displayValue:this.textSection,value:Asc.c_oAscSectionApplyType.Current},{displayValue:this.textForward,value:Asc.c_oAscSectionApplyType.ToEnd},{displayValue:this.textDocument,value:Asc.c_oAscSectionApplyType.All}]}),this.cmbApply.setValue(this.options.applyTo),this.getChild().find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.updateMetricUnit()},getFocusedComponents:function(){return[this.chAddLineNumbering,this.spnStartAt,this.spnFromText,this.spnCountBy,this.rbRestartEachPage,this.rbRestartEachSection,this.rbContinuous,this.cmbApply]},getDefaultFocusableComponent:function(){return this.chAddLineNumbering},afterRender:function(){},setSettings:function(t){if(t){var e=t.get_Restart();switch(this.chAddLineNumbering.setValue(!0),e){case Asc.c_oAscLineNumberRestartType.Continuous:this.rbContinuous.setValue(!0,!0);break;case Asc.c_oAscLineNumberRestartType.NewPage:this.rbRestartEachPage.setValue(!0,!0);break;case Asc.c_oAscLineNumberRestartType.NewSection:this.rbRestartEachSection.setValue(!0,!0)}this.spnStartAt.setValue(null!==t.get_Start()&&void 0!==t.get_Start()?t.get_Start():"",!0),this.spnFromText.setValue(null!==t.get_Distance()&&void 0!==t.get_Distance()?Common.Utils.Metric.fnRecalcFromMM(25.4*t.get_Distance()/20/72):-1,!0),this.spnCountBy.setValue(null!==t.get_CountBy()&&void 0!==t.get_CountBy()?t.get_CountBy():"",!0)}else this.chAddLineNumbering.setValue(!1)},_handleInput:function(t){this.options.handler&&this.options.handler.call(this,this,t),this.close()},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onPrimary:function(){return this._handleInput("ok"),!1},getSettings:function(){var t,e;return"checked"===this.chAddLineNumbering.getValue()&&(t=new Asc.CSectionLnNumType,this.rbContinuous.getValue()?t.put_Restart(Asc.c_oAscLineNumberRestartType.Continuous):this.rbRestartEachPage.getValue()?t.put_Restart(Asc.c_oAscLineNumberRestartType.NewPage):this.rbRestartEachSection.getValue()&&t.put_Restart(Asc.c_oAscLineNumberRestartType.NewSection),t.put_Start(""!==this.spnStartAt.getValue()?this.spnStartAt.getNumberValue():void 0),e=this.spnFromText.getNumberValue(),t.put_Distance(e<0?null:parseInt(72*Common.Utils.Metric.fnRecalcToMM(e)*20/25.4)),t.put_CountBy(""!==this.spnCountBy.getValue()?this.spnCountBy.getNumberValue():void 0)),{props:t,type:this.cmbApply.getValue()}},updateMetricUnit:function(){if(this.spinners)for(var t=0;t<this.spinners.length;t++){var e=this.spinners[t];e.setDefaultUnit(Common.Utils.Metric.getCurrentMetricName()),e.setStep(Common.Utils.Metric.getCurrentMetric()==Common.Utils.Metric.c_MetricUnits.pt?1:.1)}}},DE.Views.LineNumbersDialog||{}))}),define("documenteditor/main/app/view/TextToTableDialog",["common/main/lib/view/AdvancedSettingsWindow","common/main/lib/component/CheckBox","common/main/lib/component/MetricSpinner"],function(){"use strict";DE.Views.TextToTableDialog=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:300,height:405,buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:this.textTitle,template:['<div class="box" style="height:'+(this.options.height-85)+'px;">','<div class="content-panel" style="padding: 0 5px;"><div class="inner-content">','<div class="settings-panel active">','<table cols="2" style="width: auto;">',"<tr>",'<td colspan="2" class="padding-small">','<label class="header">',this.textTableSize,"</label>","</td>","</tr>","<tr>",'<td class="padding-small">','<label class="margin-right-10">',this.textColumns,"</label>","</td>",'<td class="padding-small">','<div id="id-text-table-spn-columns"></div>',"</td>","</tr>","<tr>",'<td class="padding-large">','<label class="margin-right-10">',this.textRows,"</label>","</td>",'<td class="padding-large">','<div id="id-text-table-spn-rows"></div>',"</td>","</tr>","</table>",'<table cols="1">',"<tr>",'<td  style="padding-bottom: 5px;">','<label class="header">',this.textAutofit,"</label>","</td>","</tr>","<tr>",'<td style="padding-bottom: 5px;">','<div id="id-text-table-radio-fixed" class="margin-right-10"></div>','<div id="id-text-table-spn-fixed"></div>',"</td>","</tr>","<tr>",'<td class="padding-small">','<div id="id-text-table-radio-contents"></div>',"</td>","</tr>","<tr>",'<td class="padding-large">','<div id="id-text-table-radio-window"></div>',"</td>","</tr>","<tr>",'<td class="padding-small">','<label class="header">',this.textSeparator,"</label>","</td>","</tr>","<tr>",'<td class="padding-small">','<div id="id-text-table-radio-para"></div>',"</td>","</tr>","<tr>",'<td class="padding-small">','<div id="id-text-table-radio-tabs"></div>',"</td>","</tr>","<tr>",'<td style="padding-bottom: 5px;">','<div id="id-text-table-radio-semi"></div>',"</td>","</tr>","<tr>",'<td class="padding-small">','<div id="id-text-table-radio-other" class="margin-right-10" style="display: inline-block;vertical-align: middle;"></div>','<div id="id-text-table-txt-other" style="display: inline-block;vertical-align: middle;"></div>',"</td>","</tr>","</table>","</div></div>","</div>","</div>"].join("")},t),this.handler=t.handler,this.props=t.props,this.spinners=[],Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var t=this.getChild(),o=this;this.spnColumns=new Common.UI.MetricSpinner({el:t.find("#id-text-table-spn-columns"),step:1,width:80,value:2,defaultUnit:"",maxValue:63,minValue:1,allowDecimal:!1}).on("change",function(t,e,i,n){o.props&&(t=o.props.put_ColsCount(t.getNumberValue(),!0))&&o.spnRows.setValue(t[0],!0)}),this.spnRows=new Common.UI.MetricSpinner({el:t.find("#id-text-table-spn-rows"),step:1,width:80,value:2,defaultUnit:"",maxValue:100,minValue:1,allowDecimal:!1,disabled:!0}),this.spnWidth=new Common.UI.MetricSpinner({el:t.find("#id-text-table-spn-fixed"),step:.1,width:80,defaultUnit:"cm",value:"Auto",autoText:this.txtAutoText,maxValue:55.87,minValue:.42,allowAuto:!0}),this.spinners.push(this.spnWidth),this.rbFixed=new Common.UI.RadioBox({el:t.find("#id-text-table-radio-fixed"),labelText:this.textFixed,name:"asc-radio-text-table-autofit",value:1,checked:!0}).on("change",_.bind(this.onRadioAutofitChange,this)),this.rbContents=new Common.UI.RadioBox({el:t.find("#id-text-table-radio-contents"),labelText:this.textContents,name:"asc-radio-text-table-autofit",value:2}).on("change",_.bind(this.onRadioAutofitChange,this)),this.rbWindow=new Common.UI.RadioBox({el:t.find("#id-text-table-radio-window"),labelText:this.textWindow,name:"asc-radio-text-table-autofit",value:3}).on("change",_.bind(this.onRadioAutofitChange,this)),this.rbPara=new Common.UI.RadioBox({el:t.find("#id-text-table-radio-para"),labelText:this.textPara,name:"asc-radio-text-table-separator",value:1,checked:!0}).on("change",_.bind(this.onRadioSeparatorChange,this)),this.rbTabs=new Common.UI.RadioBox({el:t.find("#id-text-table-radio-tabs"),labelText:this.textTab,name:"asc-radio-text-table-separator",value:2}).on("change",_.bind(this.onRadioSeparatorChange,this)),this.rbSemi=new Common.UI.RadioBox({el:t.find("#id-text-table-radio-semi"),labelText:this.textSemicolon,name:"asc-radio-text-table-separator",value:";"}).on("change",_.bind(this.onRadioSeparatorChange,this)),this.rbOther=new Common.UI.RadioBox({el:t.find("#id-text-table-radio-other"),labelText:this.textOther,name:"asc-radio-text-table-separator",value:3}).on("change",_.bind(this.onRadioSeparatorChange,this)),this.inputOther=new Common.UI.InputField({el:t.find("#id-text-table-txt-other"),style:"width: 30px;",maxLength:1,validateOnChange:!0,validateOnBlur:!1,value:Common.Utils.InternalSettings.get("de-text-to-table-separator")||"-"}).on("changing",function(t,e){o.props&&e&&(o.props.put_SeparatorType(3,!0),(e=o.props.put_Separator(e.charCodeAt(0),!0))&&(o.spnColumns.setValue(e[1],!0),o.spnRows.setValue(e[0],!0)))}),this.afterRender()},getFocusedComponents:function(){return[this.spnColumns,this.spnStartAt,this.spnWidth,this.rbFixed,this.rbContents,this.rbWindow,this.rbPara,this.rbTabs,this.rbSemi,this.rbOther,this.inputOther]},getDefaultFocusableComponent:function(){return this.spnColumns},afterRender:function(){this.updateMetricUnit(),this._setDefaults(this.props)},_setDefaults:function(t){if(t){var e=t.get_Size();switch(this.spnColumns.setValue(e[1],!0),this.spnRows.setValue(e[0],!0),(1===(e=t.get_AutoFitType())?this.rbFixed:2===e?this.rbContents:this.rbWindow).setValue(!0,!0),1===e&&this.spnWidth.setValue(-1<t.get_Fit()?Common.Utils.Metric.fnRecalcFromMM(t.get_Fit()):-1,!0),this.spnWidth.setDisabled(1!==e),t.get_SeparatorType()){case 1:this.rbPara.setValue(!0,!0),this.inputOther.setDisabled(!0);break;case 2:this.rbTabs.setValue(!0,!0),this.inputOther.setDisabled(!0);break;case 3:";"==(e=String.fromCharCode(t.get_Separator()))?(this.rbSemi.setValue(!0,!0),this.inputOther.setDisabled(!0)):(this.rbOther.setValue(!0,!0),this.inputOther.setValue(e),this.inputOther.setDisabled(!1))}}},getSettings:function(){return this.props&&(this.props.put_AutoFitType(this.rbFixed.getValue()?1:this.rbContents.getValue()?2:3),this.rbFixed.getValue()&&this.props.put_Fit(Common.Utils.Metric.fnRecalcToMM(this.spnWidth.getNumberValue())),this.rbOther.getValue()&&Common.Utils.InternalSettings.set("de-text-to-table-separator",String.fromCharCode(this.props.get_Separator()))),this.props},onDlgBtnClick:function(t){t="object"==typeof t?t.currentTarget.attributes.result.value:t;if("ok"==t){if(!this.isRangeValid())return;this.handler&&this.handler.call(this,t,"ok"==t?this.getSettings():void 0)}this.close()},onPrimary:function(){return this.onDlgBtnClick("ok"),!1},isRangeValid:function(){var e;return!this.rbOther.getValue()||""!=this.inputOther.getValue()||(Common.UI.warning({msg:(e=this).textEmpty,maxwidth:600,callback:function(t){e.inputOther.focus()}}),!1)},onRadioAutofitChange:function(t,e,i){var t=t.options.value,n=this;e&&this.props&&(n.spnWidth.setDisabled(1!==t),1==t&&setTimeout(function(){n.spnWidth.focus()},1))},onRadioSeparatorChange:function(t,e,i){var n,t=t.options.value,o=this;e&&this.props&&(this.inputOther.setDisabled(3!==t),"string"==typeof t?n=this.props.put_Separator(t.charCodeAt(0),!0):3==t?(this.inputOther.getValue()&&(n=this.props.put_Separator(this.inputOther.getValue().charCodeAt(0),!0)),setTimeout(function(){o.inputOther.focus()},1)):n=this.props.put_SeparatorType(t,!0),n&&(this.spnColumns.setValue(n[1],!0),this.spnRows.setValue(n[0],!0)))},updateMetricUnit:function(){if(this.spinners)for(var t=0;t<this.spinners.length;t++){var e=this.spinners[t];e.setDefaultUnit(Common.Utils.Metric.getCurrentMetricName()),e.setStep(Common.Utils.Metric.getCurrentMetric()==Common.Utils.Metric.c_MetricUnits.pt?1:.1)}}},DE.Views.TextToTableDialog||{}))}),define("documenteditor/main/app/view/HyphenationDialog",["common/main/lib/component/Window","common/main/lib/component/CheckBox","common/main/lib/component/MetricSpinner"],function(){"use strict";DE.Views.HyphenationDialog=Common.UI.Window.extend(_.extend({options:{width:290,height:"auto",header:!0,style:"min-width: 290px;",cls:"modal-dlg",id:"window-hyphenation-dlg",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:this.textTitle},t||{}),this.template=['<div class="box" style="">','<table cols="2" style="width: 100%;">',"<tr>",'<td colspan="2" style="padding-bottom: 15px;">','<div id="hyphenation-chk-auto"></div>',"</td>","</tr>","<tr>",'<td colspan="2" style="padding-bottom: 15px;">','<div id="hyphenation-chk-caps"></div>',"</td>","</tr>","<tr>",'<td style="padding-bottom: 10px;">','<label class="margin-right-5">'+this.textZone+"</label>","</td>",'<td style="padding-bottom: 10px;">','<div id="hyphenation-num-zone" style="display: inline-block;"></div>',"</td>","</tr>","<tr>",'<td style="padding-bottom: 5px;">','<label class="margin-right-5">'+this.textLimit+"</label>","</td>",'<td style="padding-bottom: 5px;">','<div id="hyphenation-num-limit" style="display: inline-block;"></div>',"</td>","</tr>","</table>","</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),this._changedProps=null,this._noApply=!1,Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this.getChild();this.chAuto=new Common.UI.CheckBox({el:t.find("#hyphenation-chk-auto"),labelText:this.textAuto}).on("change",_.bind(function(t,e,i,n){this._changedProps&&this._changedProps.setAutoHyphenation("checked"===t.getValue())},this)),this.chCaps=new Common.UI.CheckBox({el:t.find("#hyphenation-chk-caps"),labelText:this.textCaps}).on("change",_.bind(function(t,e,i,n){this._changedProps&&this._changedProps.setHyphenateCaps("checked"===t.getValue())},this)),this.spnLimit=new Common.UI.MetricSpinner({el:t.find("#hyphenation-num-limit"),step:1,width:80,defaultUnit:"",value:-1,autoText:this.textNoLimit,allowAuto:!0,maxValue:32767,minValue:1}),this.spnLimit.setValue(-1),this.spnLimit.on("change",_.bind(function(t,e,i,n){this._changedProps&&(t=t.getNumberValue(),this._changedProps.setHyphenationLimit(t<0?0:t))},this)),this.spnLimit.on("changing",_.bind(function(t,e,i,n){0===parseInt(e)&&t.setValue(-1)},this)),this.spnZone=new Common.UI.MetricSpinner({el:t.find("#hyphenation-num-zone"),step:.1,width:80,defaultUnit:"cm",value:"1 cm",maxValue:55.87,minValue:0}),this.spnZone.on("change",_.bind(function(t,e,i,n){this._changedProps&&(t=t.getNumberValue(),this._changedProps.setHyphenationZone(parseInt(72*Common.Utils.Metric.fnRecalcToMM(t)*20/25.4)))},this)),this.getChild().find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.updateMetricUnit()},getFocusedComponents:function(){return[this.chAuto,this.chCaps,this.spnZone,this.spnLimit]},getDefaultFocusableComponent:function(){return this.chAuto},afterRender:function(){},setSettings:function(t){var e;t&&(this.chAuto.setValue(!!t.isAutoHyphenation(),!0),this.chCaps.setValue(!!t.isHyphenateCaps(),!0),e=t.getHyphenationLimit()||0,this.spnLimit.setValue(null!==e?0===e?-1:e:"",!0),e=t.getHyphenationZone(),this.spnZone.setValue(null!=e?Common.Utils.Metric.fnRecalcFromMM(25.4*e/20/72):"",!0)),this._changedProps=t||new AscCommon.AutoHyphenationSettings},_handleInput:function(t){this.options.handler&&this.options.handler.call(this,this,t),this.close()},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onPrimary:function(){return this._handleInput("ok"),!1},getSettings:function(){return this._changedProps},updateMetricUnit:function(){this.spnZone.setDefaultUnit(Common.Utils.Metric.getCurrentMetricName()),this.spnZone.setStep(Common.Utils.Metric.getCurrentMetric()==Common.Utils.Metric.c_MetricUnits.pt?1:.1)},textTitle:"Hyphenation",textAuto:"Automatically hyphenate document",textCaps:"Hyphenate words in CAPS",textLimit:"Limit consecutive hyphens to",textNoLimit:"No limit",textZone:"Hyphenation zone"},DE.Views.HyphenationDialog||{}))}),define("documenteditor/main/app/controller/Toolbar",["core","common/main/lib/component/Window","common/main/lib/view/CopyWarningDialog","common/main/lib/view/ImageFromUrlDialog","common/main/lib/view/InsertTableDialog","common/main/lib/view/SelectFileDlg","common/main/lib/view/SymbolTableDialog","common/main/lib/util/define","documenteditor/main/app/view/Toolbar","documenteditor/main/app/view/DropcapSettingsAdvanced","documenteditor/main/app/view/StyleTitleDialog","documenteditor/main/app/view/PageMarginsDialog","documenteditor/main/app/view/PageSizeDialog","documenteditor/main/app/controller/PageLayout","documenteditor/main/app/view/CustomColumnsDialog","documenteditor/main/app/view/ControlSettingsDialog","documenteditor/main/app/view/WatermarkSettingsDialog","documenteditor/main/app/view/ListSettingsDialog","documenteditor/main/app/view/DateTimeDialog","documenteditor/main/app/view/LineNumbersDialog","documenteditor/main/app/view/TextToTableDialog","documenteditor/main/app/view/HyphenationDialog"],function(){"use strict";DE.Controllers.Toolbar=Backbone.Controller.extend(_.extend({models:[],collections:[],controllers:[],views:["Toolbar"],initialize:function(){this._state={activated:!1,bullets:{format:Asc.c_oAscNumberingFormat.None,numberingInfo:""},prstyle:void 0,prcontrolsdisable:void 0,dropcap:Asc.c_oAscDropCap.None,clrhighlight:void 0,clrtext:void 0,pgsize:[0,0],linespace:void 0,pralign:void 0,clrback:void 0,valign:void 0,can_undo:void 0,can_redo:void 0,bold:void 0,italic:void 0,strike:void 0,underline:void 0,pgorient:void 0,lock_doc:void 0,can_copycut:void 0,pgmargins:void 0,fontsize:void 0,type_fontsize:void 0,in_equation:!1,in_chart:!1,linenum_apply:Asc.c_oAscSectionApplyType.All,suppress_num:void 0},this.flg={},this.diagramEditor=null,this._isAddingShape=!1,this.editMode=!0,this.binding={},this.addListeners({Toolbar:{"insert:break":this.onClickPageBreak,"change:compact":this.onClickChangeCompact,"home:open":this.onHomeOpen,"add:chart":this.onSelectChart,"insert:textart":this.onInsertTextart,"generate:smartart":this.generateSmartArt,"insert:smartart":this.onInsertSmartArt},FileMenu:{"menu:hide":this.onFileMenu.bind(this,"hide"),"menu:show":this.onFileMenu.bind(this,"show")},"Common.Views.Header":{print:function(t){this.getApplication().getController("Main").onPrint()},"print-quick":function(t){this.getApplication().getController("Main").onPrintQuick()},save:function(t){this.api.asc_Save()},undo:this.onUndo,redo:this.onRedo,downloadas:function(t){var e,i=this.getApplication().getController("Main"),n=i.document.fileType;if(n){if(/^pdf|xps|oxps|djvu/i.test(n))return void i.api.asc_DownloadOrigin();e=Asc.c_oAscFileType[n.toUpperCase()]}n=[Asc.c_oAscFileType.TXT,Asc.c_oAscFileType.RTF,Asc.c_oAscFileType.ODT,Asc.c_oAscFileType.DOCX,Asc.c_oAscFileType.HTML,Asc.c_oAscFileType.PDFA,Asc.c_oAscFileType.DOTX,Asc.c_oAscFileType.OTT,Asc.c_oAscFileType.FB2,Asc.c_oAscFileType.EPUB,Asc.c_oAscFileType.DOCM];i.appOptions.canFeatureForms&&(n=n.concat([Asc.c_oAscFileType.DOCXF,Asc.c_oAscFileType.OFORM])),(!e||n.indexOf(e)<0)&&(e=Asc.c_oAscFileType.PDF),i.api.asc_DownloadAs(new Asc.asc_CDownloadOptions(e))},download:function(){Common.Gateway._postMessage({event:"onDownload"})},"go:editor":function(){Common.Gateway.requestEditRights()}},ViewTab:{"toolbar:setcompact":this.onChangeCompactView.bind(this)},DocumentHolder:{"list:settings":this.onMarkerSettingsClick.bind(this)}});function i(t){var e=(t=$(t.target)).closest("#editor_sdk"),i=t.closest("button").attr("id");void 0===i&&(i=t.closest(".btn-group").attr("id")),"editor_sdk"!=t.attr("id")&&e.length<=0&&(n.toolbar.btnInsertText.pressed&&i!=n.toolbar.btnInsertText.id||n.toolbar.btnInsertShape.pressed&&i!=n.toolbar.btnInsertShape.id?(n._isAddingShape=!1,n._addAutoshape(!1),n.toolbar.btnInsertShape.toggle(!1,!0),n.toolbar.btnInsertText.toggle(!1,!0),Common.NotificationCenter.trigger("edit:complete",n.toolbar)):n.toolbar.btnInsertShape.pressed&&i==n.toolbar.btnInsertShape.id&&_.defer(function(){n.api.StartAddShape("",!1),Common.NotificationCenter.trigger("edit:complete",n.toolbar)},100))}var n=this;this.onApiEndAddShape=function(){this.toolbar.fireEvent("insertshape",this.toolbar),this.toolbar.btnInsertShape.pressed&&this.toolbar.btnInsertShape.toggle(!1,!0),this.toolbar.btnInsertText.pressed&&(this.toolbar.btnInsertText.toggle(!1,!0),this.toolbar.btnInsertText.menu.clearAll()),$(document.body).off("mouseup",i)},this._addAutoshape=function(t,e){this.api&&(t?(this.api.StartAddShape(e,!0),$(document.body).on("mouseup",i)):(this.api.StartAddShape("",!1),$(document.body).off("mouseup",i)))},Common.NotificationCenter.on("style:commitsave",_.bind(this.onSaveStyle,this)),Common.NotificationCenter.on("style:commitchange",_.bind(this.onUpdateStyle,this)),Common.NotificationCenter.on("toolbar:collapse",_.bind(function(){this.toolbar.collapse()},this))},onLaunch:function(){this.toolbar=this.createView("Toolbar"),this.toolbar.on("render:before",function(t){}),Common.NotificationCenter.on("app:ready",this.onAppReady.bind(this)),Common.NotificationCenter.on("app:face",this.onAppShowed.bind(this))},setMode:function(t){this.mode=t,this.toolbar.applyLayout(t)},attachUIEvents:function(t){t.btnPrint.on("click",_.bind(this.onPrint,this)),t.btnPrint.on("disabled",_.bind(this.onBtnChangeState,this,"print:disabled")),t.btnSave.on("click",_.bind(this.onSave,this)),t.btnUndo.on("click",_.bind(this.onUndo,this)),t.btnUndo.on("disabled",_.bind(this.onBtnChangeState,this,"undo:disabled")),t.btnRedo.on("click",_.bind(this.onRedo,this)),t.btnRedo.on("disabled",_.bind(this.onBtnChangeState,this,"redo:disabled")),t.btnCopy.on("click",_.bind(this.onCopyPaste,this,"copy")),t.btnPaste.on("click",_.bind(this.onCopyPaste,this,"paste")),t.btnCut.on("click",_.bind(this.onCopyPaste,this,"cut")),t.btnSelectAll.on("click",_.bind(this.onSelectAll,this)),t.btnIncFontSize.on("click",_.bind(this.onIncrease,this)),t.btnDecFontSize.on("click",_.bind(this.onDecrease,this)),t.mnuChangeCase.on("item:click",_.bind(this.onChangeCase,this)),t.btnBold.on("click",_.bind(this.onBold,this)),t.btnItalic.on("click",_.bind(this.onItalic,this)),t.btnUnderline.on("click",_.bind(this.onUnderline,this)),t.btnStrikeout.on("click",_.bind(this.onStrikeout,this)),t.btnSuperscript.on("click",_.bind(this.onSuperscript,this)),t.btnSubscript.on("click",_.bind(this.onSubscript,this)),t.btnAlignLeft.on("click",_.bind(this.onHorizontalAlign,this,1)),t.btnAlignCenter.on("click",_.bind(this.onHorizontalAlign,this,2)),t.btnAlignRight.on("click",_.bind(this.onHorizontalAlign,this,0)),t.btnAlignJust.on("click",_.bind(this.onHorizontalAlign,this,3)),t.btnDecLeftOffset.on("click",_.bind(this.onDecOffset,this)),t.btnIncLeftOffset.on("click",_.bind(this.onIncOffset,this)),t.btnMarkers.on("click",_.bind(this.onMarkers,this)),t.btnNumbers.on("click",_.bind(this.onNumbers,this)),t.cmbFontName.on("selected",_.bind(this.onFontNameSelect,this)),t.cmbFontName.on("show:after",_.bind(this.onComboOpen,this,!0)),t.cmbFontName.on("hide:after",_.bind(this.onHideMenus,this)),t.cmbFontName.on("combo:blur",_.bind(this.onComboBlur,this)),t.cmbFontName.on("combo:focusin",_.bind(this.onComboOpen,this,!1)),t.cmbFontSize.on("selected",_.bind(this.onFontSizeSelect,this)),t.cmbFontSize.on("changed:before",_.bind(this.onFontSizeChanged,this,!0)),t.cmbFontSize.on("changed:after",_.bind(this.onFontSizeChanged,this,!1)),t.cmbFontSize.on("combo:blur",_.bind(this.onComboBlur,this)),t.cmbFontSize.on("combo:focusin",_.bind(this.onComboOpen,this,!1)),t.cmbFontSize.on("show:after",_.bind(this.onComboOpen,this,!0)),t.cmbFontSize.on("hide:after",_.bind(this.onHideMenus,this)),t.mnuMarkersPicker.on("item:click",_.bind(this.onSelectBullets,this,t.btnMarkers)),t.mnuNumbersPicker.on("item:click",_.bind(this.onSelectBullets,this,t.btnNumbers)),t.mnuMultilevelPicker.on("item:click",_.bind(this.onSelectBullets,this,t.btnMultilevels)),t.btnMarkers.menu.on("show:after",_.bind(this.onListShowAfter,this,0,t.mnuMarkersPicker)),t.btnNumbers.menu.on("show:after",_.bind(this.onListShowAfter,this,1,t.mnuNumbersPicker)),t.btnMultilevels.menu.on("show:after",_.bind(this.onListShowAfter,this,2,t.mnuMultilevelPicker)),t.mnuMarkerSettings.on("click",_.bind(this.onMarkerSettingsClick,this,0)),t.mnuNumberSettings.on("click",_.bind(this.onMarkerSettingsClick,this,1)),t.mnuMultilevelSettings.on("click",_.bind(this.onMarkerSettingsClick,this,2)),t.mnuMarkerChangeLevel&&t.mnuMarkerChangeLevel.menu&&t.mnuMarkerChangeLevel.menu.on("show:after",_.bind(this.onChangeLevelShowAfter,this,0)),t.mnuMarkerChangeLevel.menu.on("item:click",_.bind(this.onChangeLevelClick,this,0)),t.mnuNumberChangeLevel&&t.mnuNumberChangeLevel.menu&&t.mnuNumberChangeLevel.menu.on("show:after",_.bind(this.onChangeLevelShowAfter,this,1)),t.mnuNumberChangeLevel.menu.on("item:click",_.bind(this.onChangeLevelClick,this,1)),t.mnuMultiChangeLevel&&t.mnuMultiChangeLevel.menu&&t.mnuMultiChangeLevel.menu.on("show:after",_.bind(this.onChangeLevelShowAfter,this,2)),t.mnuMultiChangeLevel.menu.on("item:click",_.bind(this.onChangeLevelClick,this,2)),t.btnHighlightColor.on("click",_.bind(this.onBtnHighlightColor,this)),t.btnFontColor.on("click",_.bind(this.onBtnFontColor,this)),t.btnFontColor.on("color:select",_.bind(this.onSelectFontColor,this)),t.btnFontColor.on("auto:select",_.bind(this.onAutoFontColor,this)),t.btnFontColor.on("eyedropper:start",_.bind(this.onEyedropperStart,this)),t.btnFontColor.on("eyedropper:end",_.bind(this.onEyedropperEnd,this)),t.btnParagraphColor.on("click",_.bind(this.onBtnParagraphColor,this)),t.btnParagraphColor.on("color:select",_.bind(this.onParagraphColorPickerSelect,this)),t.btnParagraphColor.on("eyedropper:start",_.bind(this.onEyedropperStart,this)),t.btnParagraphColor.on("eyedropper:end",_.bind(this.onEyedropperEnd,this)),this.mode.isEdit&&Common.NotificationCenter.on("eyedropper:start",_.bind(this.eyedropperStart,this)),t.mnuHighlightColorPicker.on("select",_.bind(this.onSelectHighlightColor,this)),t.mnuHighlightTransparent.on("click",_.bind(this.onHighlightTransparentClick,this)),t.mnuLineSpace.on("item:toggle",_.bind(this.onLineSpaceToggle,this)),t.mnuNonPrinting.on("item:toggle",_.bind(this.onMenuNonPrintingToggle,this)),t.btnShowHidenChars.on("toggle",_.bind(this.onNonPrintingToggle,this)),t.mnuTablePicker.on("select",_.bind(this.onTablePickerSelect,this)),t.mnuInsertTable.on("item:click",_.bind(this.onInsertTableClick,this)),t.mnuInsertTable.on("show:after",_.bind(this.onInsertTableShow,this)),t.mnuInsertImage.on("item:click",_.bind(this.onInsertImageClick,this)),t.btnInsertText.on("click",_.bind(this.onBtnInsertTextClick,this)),t.btnInsertText.menu.on("item:click",_.bind(this.onMenuInsertTextClick,this)),t.btnInsertShape.menu.on("hide:after",_.bind(this.onInsertShapeHide,this)),t.btnDropCap.menu.on("item:click",_.bind(this.onDropCapSelect,this)),t.btnContentControls.menu.on("item:click",_.bind(this.onControlsSelect,this)),t.mnuDropCapAdvanced.on("click",_.bind(this.onDropCapAdvancedClick,this,!1)),t.btnColumns.menu.on("item:click",_.bind(this.onColumnsSelect,this)),t.btnPageOrient.menu.on("item:click",_.bind(this.onPageOrientSelect,this)),t.btnPageMargins.menu.on("item:click",_.bind(this.onPageMarginsSelect,this)),t.btnWatermark.menu.on("item:click",_.bind(this.onWatermarkSelect,this)),t.btnClearStyle.on("click",_.bind(this.onClearStyleClick,this)),t.btnCopyStyle.on("toggle",_.bind(this.onCopyStyleToggle,this)),t.mnuPageSize.on("item:click",_.bind(this.onPageSizeClick,this)),t.mnuColorSchema.on("item:click",_.bind(this.onColorSchemaClick,this)),t.mnuColorSchema.on("show:after",_.bind(this.onColorSchemaShow,this)),t.mnuMailRecepients.on("item:click",_.bind(this.onSelectRecepientsClick,this)),t.mnuPageNumberPosPicker.on("item:click",_.bind(this.onInsertPageNumberClick,this)),t.btnEditHeader.menu.on("item:click",_.bind(this.onEditHeaderFooterClick,this)),t.btnInsDateTime.on("click",_.bind(this.onInsDateTimeClick,this)),t.mnuPageNumCurrentPos.on("click",_.bind(this.onPageNumCurrentPosClick,this)),t.mnuInsertPageCount.on("click",_.bind(this.onInsertPageCountClick,this)),t.btnBlankPage.on("click",_.bind(this.onBtnBlankPageClick,this)),t.listStyles.on("click",_.bind(this.onListStyleSelect,this)),t.listStyles.on("contextmenu",_.bind(this.onListStyleContextMenu,this)),t.styleMenu.on("hide:before",_.bind(this.onListStyleBeforeHide,this)),t.btnInsertEquation.on("click",_.bind(this.onInsertEquationClick,this)),t.btnInsertSymbol.menu.items[2].on("click",_.bind(this.onInsertSymbolClick,this)),t.mnuInsertSymbolsPicker.on("item:click",_.bind(this.onInsertSymbolItemClick,this)),t.mnuNoControlsColor.on("click",_.bind(this.onNoControlsColor,this)),t.mnuControlsColorPicker.on("select",_.bind(this.onSelectControlsColor,this)),t.btnLineNumbers.menu.on("item:click",_.bind(this.onLineNumbersSelect,this)),t.btnLineNumbers.menu.on("show:after",_.bind(this.onLineNumbersShow,this)),t.btnHyphenation.menu.on("item:click",_.bind(this.onHyphenationSelect,this)),t.btnHyphenation.menu.on("show:after",_.bind(this.onHyphenationShow,this)),Common.Gateway.on("insertimage",_.bind(this.insertImage,this)),Common.Gateway.on("setmailmergerecipients",_.bind(this.setMailMergeRecipients,this)),Common.Gateway.on("setrequestedspreadsheet",_.bind(this.setRequestedSpreadsheet,this)),Common.NotificationCenter.on("storage:spreadsheet-load",_.bind(this.openSpreadsheetFromStorage,this)),Common.NotificationCenter.on("storage:spreadsheet-insert",_.bind(this.insertSpreadsheetFromStorage,this)),$("#id-toolbar-menu-new-control-color").on("click",_.bind(this.onNewControlsColor,this)),t.listStylesAdditionalMenuItem.on("click",this.onMenuSaveStyle.bind(this)),t.btnPrint.menu&&t.btnPrint.menu.on("item:click",_.bind(this.onPrintMenu,this)),t.btnPageColor.menu.on("show:after",_.bind(this.onPageColorShowAfter,this)),t.btnPageColor.on("color:select",_.bind(this.onSelectPageColor,this)),t.mnuPageNoFill.on("click",_.bind(this.onPageNoFillClick,this)),this.onSetupCopyStyleButton(),this.onBtnChangeState("undo:disabled",t.btnUndo,t.btnUndo.isDisabled()),this.onBtnChangeState("redo:disabled",t.btnRedo,t.btnRedo.isDisabled())},setApi:function(t){this.api=t,this.mode.isEdit?(this.toolbar.setApi(t),this.api.asc_registerCallback("asc_onFontSize",_.bind(this.onApiFontSize,this)),this.api.asc_registerCallback("asc_onBold",_.bind(this.onApiBold,this)),this.api.asc_registerCallback("asc_onItalic",_.bind(this.onApiItalic,this)),this.api.asc_registerCallback("asc_onUnderline",_.bind(this.onApiUnderline,this)),this.api.asc_registerCallback("asc_onStrikeout",_.bind(this.onApiStrikeout,this)),this.api.asc_registerCallback("asc_onVerticalAlign",_.bind(this.onApiVerticalAlign,this)),this.api.asc_registerCallback("asc_onCanUndo",_.bind(this.onApiCanRevert,this,"undo")),this.api.asc_registerCallback("asc_onCanRedo",_.bind(this.onApiCanRevert,this,"redo")),this.api.asc_registerCallback("asc_onPrAlign",_.bind(this.onApiParagraphAlign,this)),this.api.asc_registerCallback("asc_onTextColor",_.bind(this.onApiTextColor,this)),this.api.asc_registerCallback("asc_onParaSpacingLine",_.bind(this.onApiLineSpacing,this)),this.api.asc_registerCallback("asc_onFocusObject",_.bind(this.onApiFocusObject,this)),this.api.asc_registerCallback("asc_onDocSize",_.bind(this.onApiPageSize,this)),this.api.asc_registerCallback("asc_onPaintFormatChanged",_.bind(this.onApiStyleChange,this)),this.api.asc_registerCallback("asc_onParaStyleName",_.bind(this.onApiParagraphStyleChange,this)),this.api.asc_registerCallback("asc_onEndAddShape",_.bind(this.onApiEndAddShape,this)),this.api.asc_registerCallback("asc_onPageOrient",_.bind(this.onApiPageOrient,this)),this.api.asc_registerCallback("asc_onLockDocumentProps",_.bind(this.onApiLockDocumentProps,this)),this.api.asc_registerCallback("asc_onUnLockDocumentProps",_.bind(this.onApiUnLockDocumentProps,this)),this.api.asc_registerCallback("asc_onLockDocumentSchema",_.bind(this.onApiLockDocumentSchema,this)),this.api.asc_registerCallback("asc_onUnLockDocumentSchema",_.bind(this.onApiUnLockDocumentSchema,this)),this.api.asc_registerCallback("asc_onLockHeaderFooters",_.bind(this.onApiLockHeaderFooters,this)),this.api.asc_registerCallback("asc_onUnLockHeaderFooters",_.bind(this.onApiUnLockHeaderFooters,this)),this.api.asc_registerCallback("asc_onZoomChange",_.bind(this.onApiZoomChange,this)),this.api.asc_registerCallback("asc_onMarkerFormatChanged",_.bind(this.onApiStartHighlight,this)),this.api.asc_registerCallback("asc_onTextHighLight",_.bind(this.onApiHighlightColor,this)),this.api.asc_registerCallback("asc_onInitEditorStyles",_.bind(this.onApiInitEditorStyles,this)),this.api.asc_registerCallback("asc_onCoAuthoringDisconnect",_.bind(this.onApiCoAuthoringDisconnect,this)),Common.NotificationCenter.on("api:disconnect",_.bind(this.onApiCoAuthoringDisconnect,this)),this.api.asc_registerCallback("asc_onCanCopyCut",_.bind(this.onApiCanCopyCut,this)),this.api.asc_registerCallback("asc_onMathTypes",_.bind(this.onApiMathTypes,this)),this.api.asc_registerCallback("asc_onColumnsProps",_.bind(this.onColumnsProps,this)),this.api.asc_registerCallback("asc_onSectionProps",_.bind(this.onSectionProps,this)),this.api.asc_registerCallback("asc_onLineNumbersProps",_.bind(this.onLineNumbersProps,this)),this.api.asc_registerCallback("asc_onContextMenu",_.bind(this.onContextMenu,this)),this.api.asc_registerCallback("asc_onShowParaMarks",_.bind(this.onShowParaMarks,this)),this.api.asc_registerCallback("asc_onChangeSdtGlobalSettings",_.bind(this.onChangeSdtGlobalSettings,this)),this.api.asc_registerCallback("asc_onTextLanguage",_.bind(this.onTextLanguage,this)),Common.NotificationCenter.on("fonts:change",_.bind(this.onApiChangeFont,this)),this.api.asc_registerCallback("asc_onTableDrawModeChanged",_.bind(this.onTableDraw,this)),this.api.asc_registerCallback("asc_onTableEraseModeChanged",_.bind(this.onTableErase,this)),Common.NotificationCenter.on("storage:image-load",_.bind(this.openImageFromStorage,this)),Common.NotificationCenter.on("storage:image-insert",_.bind(this.insertImageFromStorage,this)),Common.NotificationCenter.on("dropcap:settings",_.bind(this.onDropCapAdvancedClick,this)),this.api.asc_registerCallback("asc_onBeginSmartArtPreview",_.bind(this.onApiBeginSmartArtPreview,this)),this.api.asc_registerCallback("asc_onAddSmartArtPreview",_.bind(this.onApiAddSmartArtPreview,this)),this.api.asc_registerCallback("asc_onEndSmartArtPreview",_.bind(this.onApiEndSmartArtPreview,this)),this.api.asc_registerCallback("asc_updateListPatterns",_.bind(this.onApiUpdateListPatterns,this))):this.mode.isRestrictedEdit&&(this.api.asc_registerCallback("asc_onFocusObject",_.bind(this.onApiFocusObjectRestrictedEdit,this)),this.api.asc_registerCallback("asc_onCoAuthoringDisconnect",_.bind(this.onApiCoAuthoringDisconnect,this)),Common.NotificationCenter.on("api:disconnect",_.bind(this.onApiCoAuthoringDisconnect,this))),Common.NotificationCenter.on("protect:doclock",_.bind(this.onChangeProtectDocument,this))},onChangeCompactView:function(t,e){this.toolbar.setFolded(e),this.toolbar.fireEvent("view:compact",[this,e]),Common.localStorage.setBool("de-compact-toolbar",e),Common.NotificationCenter.trigger("layout:changed","toolbar"),Common.NotificationCenter.trigger("edit:complete",this.toolbar)},onClickChangeCompact:function(t){var e;"file"!=t&&(e=this,setTimeout(function(){e.onChangeCompactView(null,!e.toolbar.isCompact())},0))},onContextMenu:function(){this.toolbar.collapse()},onApiChangeFont:function(t){Common.Utils.ModalWindow.isVisible()||this.toolbar.cmbFontName.onApiChangeFont(t)},onApiFontSize:function(t){var e=this._state.type_fontsize,e="string"===(e=this.toolbar.cmbFontSize&&"string"===this._state.type_fontsize&&!this.toolbar.cmbFontSize.store.findWhere({value:t+"_str"})?"number":e)?t+"_str":t;this._state.fontsize!==e&&(this.toolbar.cmbFontSize.setValue(e),this._state.fontsize=e)},onApiBold:function(t){this._state.bold!==t&&(this.toolbar.btnBold.toggle(!0===t,!0),this._state.bold=t)},onApiItalic:function(t){this._state.italic!==t&&(this.toolbar.btnItalic.toggle(!0===t,!0),this._state.italic=t)},onApiUnderline:function(t){this._state.underline!==t&&(this.toolbar.btnUnderline.toggle(!0===t,!0),this._state.underline=t)},onApiStrikeout:function(t){this._state.strike!==t&&(this.toolbar.btnStrikeout.toggle(!0===t,!0),this._state.strike=t)},onApiVerticalAlign:function(t){this._state.valign!==t&&(this.toolbar.btnSuperscript.toggle(t==Asc.vertalign_SuperScript,!0),this.toolbar.btnSubscript.toggle(t==Asc.vertalign_SubScript,!0),this._state.valign=t)},onApiCanRevert:function(t,e){"undo"==t?this._state.can_undo!==e&&(this.toolbar.lockToolbar(Common.enumLock.undoLock,!e,{array:[this.toolbar.btnUndo]}),this._state.can_undo=e):this._state.can_redo!==e&&(this.toolbar.lockToolbar(Common.enumLock.redoLock,!e,{array:[this.toolbar.btnRedo]}),this._state.can_redo=e)},onApiCanCopyCut:function(t){this._state.can_copycut!==t&&(this.toolbar.lockToolbar(Common.enumLock.copyLock,!t,{array:[this.toolbar.btnCopy,this.toolbar.btnCut]}),this._state.can_copycut=t)},onApiParagraphAlign:function(t){if(this._state.pralign!==t){this._state.pralign=t;var e=this.toolbar;switch(t){case 0:0;break;case 1:0;break;case 2:0;break;case 3:0;break;default:0}null==t?(e.btnAlignRight.toggle(!1,!0),e.btnAlignLeft.toggle(!1,!0),e.btnAlignCenter.toggle(!1,!0),e.btnAlignJust.toggle(!1,!0)):(e.btnAlignRight.toggle(0===t,!0),e.btnAlignLeft.toggle(1===t,!0),e.btnAlignCenter.toggle(2===t,!0),e.btnAlignJust.toggle(3===t,!0))}},onApiLineSpacing:function(t){t=null===t.get_Line()||null===t.get_LineRule()||1!=t.get_LineRule()?-1:t.get_Line();this._state.linespace!==t&&(this._state.linespace=t,_.each(this.toolbar.mnuLineSpace.items,function(t){t.setChecked(!1,!0)}),t<0||(Math.abs(t-1)<1e-4?this.toolbar.mnuLineSpace.items[0].setChecked(!0,!0):Math.abs(t-1.15)<1e-4?this.toolbar.mnuLineSpace.items[1].setChecked(!0,!0):Math.abs(t-1.5)<1e-4?this.toolbar.mnuLineSpace.items[2].setChecked(!0,!0):Math.abs(t-2)<1e-4?this.toolbar.mnuLineSpace.items[3].setChecked(!0,!0):Math.abs(t-2.5)<1e-4?this.toolbar.mnuLineSpace.items[4].setChecked(!0,!0):Math.abs(t-3)<1e-4&&this.toolbar.mnuLineSpace.items[5].setChecked(!0,!0)))},onApiPageSize:function(t,e){var i,n;void 0!==this._state.pgorient&&(i=this._state.pgorient?t:e,n=this._state.pgorient?e:t,(.1<Math.abs(this._state.pgsize[0]-t)||.1<Math.abs(this._state.pgsize[1]-e))&&(this._state.pgsize=[t,e],this.toolbar.mnuPageSize&&(this.toolbar.mnuPageSize.clearAll(),_.each(this.toolbar.mnuPageSize.items,function(t){if(t.value&&"object"==typeof t.value&&Math.abs(t.value[0]-i)<.1&&Math.abs(t.value[1]-n)<.1)return t.setChecked(!0),!1},this))))},onSectionProps:function(t){var e,i,n,o;t&&(e=t.get_LeftMargin(),i=t.get_TopMargin(),n=t.get_RightMargin(),o=t.get_BottomMargin(),(!this._state.pgmargins||.1<Math.abs(this._state.pgmargins[0]-i)||.1<Math.abs(this._state.pgmargins[1]-e)||.1<Math.abs(this._state.pgmargins[2]-o)||.1<Math.abs(this._state.pgmargins[3]-n))&&(this._state.pgmargins=[i,e,o,n],this.toolbar.btnPageMargins.menu&&(this.toolbar.btnPageMargins.menu.clearAll(),_.each(this.toolbar.btnPageMargins.menu.items,function(t){if(t.value&&"object"==typeof t.value&&Math.abs(t.value[0]-i)<.1&&Math.abs(t.value[1]-e)<.1&&Math.abs(t.value[2]-o)<.1&&Math.abs(t.value[3]-n)<.1)return t.setChecked(!0),!1},this))))},onShowParaMarks:function(t){this.toolbar.mnuNonPrinting.items[0].setChecked(t,!0),this.toolbar.btnShowHidenChars.toggle(t,!0),Common.localStorage.setItem("de-show-hiddenchars",t)},onApiFocusObjectRestrictedEdit:function(t){if(this.editMode){for(var e,i=-1,n=!1,o=!1,s=!1,a=!1,l=void 0;++i<t.length;)(e=t[i].get_ObjectType())===Asc.c_oAscTypeSelectElement.Paragraph?(l=t[i].get_ObjectValue(),n=t[i].get_ObjectValue().get_Locked()):e===Asc.c_oAscTypeSelectElement.Header?o=t[i].get_ObjectValue().get_Locked():e===Asc.c_oAscTypeSelectElement.Image&&(a=!0,s=t[i].get_ObjectValue().get_Locked());var r,c=!!l&&!l.can_DeleteBlockContentControl(),d=!!l&&!l.can_EditBlockContentControl(),h=!!l&&!l.can_DeleteInlineContentControl(),m=!!l&&!l.can_EditInlineContentControl();this.btnsComment&&(this.toolbar.lockToolbar(Common.enumLock.cantAddQuotedComment,!this.api.can_AddQuotedComment(),{array:this.btnsComment}),this.toolbar.lockToolbar(Common.enumLock.imageLock,s,{array:this.btnsComment}),this.mode.compatibleFeatures&&this.toolbar.lockToolbar(Common.enumLock.inImage,a,{array:this.btnsComment}),this.api.asc_IsContentControl()?(r=(r=this.api.asc_GetContentControlProperties())?r.get_SpecificType():Asc.c_oAscContentControlSpecificType.None,this.toolbar.lockToolbar(Common.enumLock.inSpecificForm,r==Asc.c_oAscContentControlSpecificType.CheckBox||r==Asc.c_oAscContentControlSpecificType.Picture||r==Asc.c_oAscContentControlSpecificType.ComboBox||r==Asc.c_oAscContentControlSpecificType.DropDownList||r==Asc.c_oAscContentControlSpecificType.DateTime,{array:this.btnsComment})):this.toolbar.lockToolbar(Common.enumLock.inSpecificForm,!1,{array:this.btnsComment}),this.toolbar.lockToolbar(Common.enumLock.paragraphLock,n,{array:this.btnsComment}),this.toolbar.lockToolbar(Common.enumLock.headerLock,o,{array:this.btnsComment}),this.toolbar.lockToolbar(Common.enumLock.richEditLock,d,{array:this.btnsComment}),this.toolbar.lockToolbar(Common.enumLock.plainEditLock,m,{array:this.btnsComment}),this.toolbar.lockToolbar(Common.enumLock.richDelLock,c,{array:this.btnsComment}),this.toolbar.lockToolbar(Common.enumLock.plainDelLock,h,{array:this.btnsComment}))}},onApiFocusObject:function(t){if(this.editMode){for(var e,i,n,o=-1,s=!1,a=!1,l=!1,r=!1,c=!1,d=void 0,h=!0,m=void 0,p=void 0,u=this.toolbar,g=!1,b=!1,C=!1,f=!1,v=!1,_=!1,w=this.api.asc_IsCursorInFootnote()||this.api.asc_IsCursorInEndnote();++o<t.length;)n=t[o].get_ObjectType(),e=t[o].get_ObjectValue(),n===Asc.c_oAscTypeSelectElement.Paragraph?(s=e.get_Locked(),r=e.get_CanAddTable(),c=e.get_CanAddImage(),i=(m=e).get_Shade(),_=!0):n===Asc.c_oAscTypeSelectElement.Header?(a=e.get_Locked(),g=!0):n===Asc.c_oAscTypeSelectElement.Image?(v=!0,l=e.get_Locked(),e&&e.get_ChartProperties()&&(b=!0),e&&e.get_ShapeProperties()&&(p=e.get_ShapeProperties())):n===Asc.c_oAscTypeSelectElement.Math&&(C=!0,Asc.c_oAscMathInterfaceType.Common===e.get_Type()&&(f=!0)),!1!==(d=n!==Asc.c_oAscTypeSelectElement.Table&&n!==Asc.c_oAscTypeSelectElement.Header&&n!==Asc.c_oAscTypeSelectElement.Image?d:!1)&&n==Asc.c_oAscTypeSelectElement.Paragraph&&(d=!0);i&&this.onParagraphColor(i);var y=!!m&&!m.can_DeleteBlockContentControl(),x=!!m&&!m.can_EditBlockContentControl(),S=!!m&&!m.can_DeleteInlineContentControl(),T=!!m&&!m.can_EditInlineContentControl(),A=p&&p.asc_getFromSmartArt(),k=p&&p.asc_getFromSmartArtInternal(),T=(this.toolbar.lockToolbar(Common.enumLock.paragraphLock,s,{array:this.toolbar.paragraphControls.concat([u.btnContentControls,u.btnClearStyle])}),this.toolbar.lockToolbar(Common.enumLock.headerLock,a,{array:this.toolbar.paragraphControls.concat([u.btnContentControls,u.btnClearStyle,u.btnWatermark])}),this.toolbar.lockToolbar(Common.enumLock.richEditLock,x,{array:this.toolbar.paragraphControls.concat([u.btnClearStyle])}),this.toolbar.lockToolbar(Common.enumLock.plainEditLock,T,{array:this.toolbar.paragraphControls.concat([u.btnClearStyle])}),this.toolbar.lockToolbar(Common.enumLock.richDelLock,y,{array:u.btnsPageBreak.concat(this.btnsComment).concat([u.btnInsertTable,u.btnInsertImage,u.btnInsertChart,u.btnInsertTextArt,u.btnInsDateTime,u.btnBlankPage,u.btnInsertEquation,u.btnInsertSymbol])}),this.toolbar.lockToolbar(Common.enumLock.plainDelLock,S,{array:u.btnsPageBreak.concat(this.btnsComment).concat([u.btnInsertTable,u.btnInsertImage,u.btnInsertChart,u.btnInsertTextArt,u.btnInsDateTime,u.btnBlankPage,u.btnInsertEquation,u.btnInsertSymbol])}),this.toolbar.lockToolbar(Common.enumLock.inChart,b,{array:u.textOnlyControls.concat([u.btnClearStyle,u.btnInsertEquation])}),this.toolbar.lockToolbar(Common.enumLock.inSmartart,A,{array:u.textOnlyControls.concat([u.btnClearStyle,u.btnContentControls])}),this.toolbar.lockToolbar(Common.enumLock.inSmartartInternal,k,{array:u.textOnlyControls.concat([u.btnClearStyle,u.btnDecLeftOffset,u.btnIncLeftOffset,u.btnContentControls])}),this.toolbar.lockToolbar(Common.enumLock.inEquation,C,{array:u.btnsPageBreak.concat([u.btnDropCap,u.btnInsertTable,u.btnBlankPage,u.btnInsertShape,u.btnInsertText,u.btnInsertTextArt,u.btnInsertImage,u.btnInsertSmartArt,u.btnSuperscript,u.btnSubscript,u.btnEditHeader])}),(x=this.api.asc_IsContentControl())?this.api.asc_GetContentControlProperties():null),A=x&&T?T.get_Lock():Asc.c_oAscSdtLockType.Unlocked,k=!(!x||!T)&&T.get_ContentControlType()==Asc.c_oAscSdtLevelType.Inline,D=(A=void 0===A?Asc.c_oAscSdtLockType.Unlocked:A)==Asc.c_oAscSdtLockType.SdtContentLocked||A==Asc.c_oAscSdtLockType.ContentLocked,I=T&&T.get_FormPr();if(!u.btnContentControls.isDisabled()){for(var P=k||D,o=0;o<7;o++)u.btnContentControls.menu.items[o].setDisabled(P);u.btnContentControls.menu.items[8].setDisabled(!x||A==Asc.c_oAscSdtLockType.SdtContentLocked||A==Asc.c_oAscSdtLockType.SdtLocked||I),u.btnContentControls.menu.items[10].setDisabled(!x||I)}this.toolbar.lockToolbar(Common.enumLock.fixedForm,I&&I.get_Fixed(),{array:[u.btnAlignLeft,u.btnAlignCenter,u.btnAlignRight,u.btnAlignJust,u.btnMarkers,u.btnNumbers,u.btnMultilevels,u.btnDecLeftOffset,u.btnIncLeftOffset,u.btnLineSpace]}),this.toolbar.lockToolbar(Common.enumLock.controlPlain,k,{array:[u.btnInsertTable,u.btnInsertImage,u.btnInsertChart,u.btnInsertText,u.btnInsertTextArt,u.btnInsertShape,u.btnInsertSmartArt,u.btnInsertEquation,u.btnDropCap,u.btnColumns,u.mnuInsertPageNum]}),d&&m&&(A=m.get_FramePr(),I=Asc.c_oAscDropCap.None,void 0!==A?(d=(I=A.get_DropCap())===Asc.c_oAscDropCap.Drop||I===Asc.c_oAscDropCap.Margin,h=!1):d=m.get_CanAddDropCap(),d&&this.onDropCap(I)),this.toolbar.lockToolbar(Common.enumLock.dropcapLock,!d,{array:[u.btnDropCap]}),u.btnDropCap.isDisabled()||u.mnuDropCapAdvanced.setDisabled(h),this.toolbar.lockToolbar(Common.enumLock.cantAddTable,!r,{array:[u.btnInsertTable]}),this.toolbar.lockToolbar(Common.enumLock.cantAddPageNum,u.mnuPageNumCurrentPos.isDisabled()&&u.mnuPageNumberPosPicker.isDisabled(),{array:[u.mnuInsertPageNum]}),this.toolbar.lockToolbar(Common.enumLock.inHeader,g,{array:u.btnsPageBreak.concat([u.btnBlankPage])}),this.toolbar.lockToolbar(Common.enumLock.inControl,x,{array:u.btnsPageBreak.concat([u.btnBlankPage])}),this.toolbar.lockToolbar(Common.enumLock.cantPageBreak,v&&!f,{array:u.btnsPageBreak.concat([u.btnBlankPage])}),this.toolbar.lockToolbar(Common.enumLock.contentLock,D,{array:[u.btnInsertShape,u.btnInsertText,u.btnInsertImage,u.btnInsertTextArt,u.btnInsertChart,u.btnInsertSmartArt]}),this.toolbar.lockToolbar(Common.enumLock.inFootnote,w,{array:u.btnsPageBreak.concat([u.btnBlankPage,u.btnInsertShape,u.btnInsertText,u.btnInsertTextArt,u.btnInsertSmartArt])}),this.toolbar.lockToolbar(Common.enumLock.cantAddImagePara,_&&!c,{array:[u.btnInsertImage,u.btnInsertTextArt]}),b!==this._state.in_chart&&(u.btnInsertChart.updateHint(b?u.tipChangeChart:u.tipInsertChart),this._state.in_chart=b);A=s||a||C||k||y||S||D||_&&!c,h=(this.toolbar.lockToolbar(Common.enumLock.cantAddChart,!b&&A,{array:[u.btnInsertChart]}),this.toolbar.lockToolbar(Common.enumLock.chartLock,b&&l,{array:[u.btnInsertChart]}),this.toolbar.lockToolbar(Common.enumLock.cantAddEquation,!c&&!C,{array:[u.btnInsertEquation]}),this.toolbar.lockToolbar(Common.enumLock.noParagraphSelected,!_,{array:[u.btnInsertSymbol,u.btnInsDateTime]}),this.toolbar.lockToolbar(Common.enumLock.inImage,v,{array:[u.btnColumns]}),this.toolbar.lockToolbar(Common.enumLock.inImagePara,v&&_,{array:[u.btnLineNumbers]}),u.listStylesAdditionalMenuItem&&void 0===m!==u.listStylesAdditionalMenuItem.isDisabled()&&u.listStylesAdditionalMenuItem.setDisabled(void 0===m),this.btnsComment&&(this.toolbar.lockToolbar(Common.enumLock.cantAddQuotedComment,!this.api.can_AddQuotedComment(),{array:this.btnsComment}),this.toolbar.lockToolbar(Common.enumLock.imageLock,l,{array:this.btnsComment}),this.mode.compatibleFeatures&&this.toolbar.lockToolbar(Common.enumLock.inImage,v,{array:this.btnsComment}),T?(I=T.get_SpecificType(),this.toolbar.lockToolbar(Common.enumLock.inSpecificForm,I==Asc.c_oAscContentControlSpecificType.CheckBox||I==Asc.c_oAscContentControlSpecificType.Picture||I==Asc.c_oAscContentControlSpecificType.ComboBox||I==Asc.c_oAscContentControlSpecificType.DropDownList||I==Asc.c_oAscContentControlSpecificType.DateTime,{array:this.btnsComment})):this.toolbar.lockToolbar(Common.enumLock.inSpecificForm,!1,{array:this.btnsComment})),m&&(this._state.suppress_num=!!m.get_SuppressLineNumbers()),this._state.in_equation=C,this.api.asc_GetCurrentNumberingId()),x=null!==h?this.api.asc_GetNumberingPr(h).get_Lvl(this.api.asc_GetCurrentNumberingLvl()).get_Format():Asc.c_oAscNumberingFormat.None;this.toolbar.btnMarkers.toggle(x===Asc.c_oAscNumberingFormat.Bullet||x===Asc.c_oAscNumberingFormat.None&&null!==h,!0),this.toolbar.btnNumbers.toggle(x!==Asc.c_oAscNumberingFormat.None&&x!==Asc.c_oAscNumberingFormat.Bullet,!0)}},onApiStyleChange:function(t){this.toolbar.btnCopyStyle.toggle(t,!0),this.modeAlwaysSetStyle=!1},onTableDraw:function(t){this.toolbar.mnuInsertTable&&this.toolbar.mnuInsertTable.items[2].setChecked(!!t,!0)},onTableErase:function(t){this.toolbar.mnuInsertTable&&this.toolbar.mnuInsertTable.items[3].setChecked(!!t,!0)},onApiParagraphStyleChange:function(t){var e,i;this._state.prstyle!=t&&(e=this.toolbar.listStyles).rendered&&(e.suspendEvents(),i=e.menuPicker.store.findWhere({title:t}),this._state.prstyle=0<e.menuPicker.store.length||window.styles_loaded?t:void 0,e.menuPicker.selectRecord(i),e.resumeEvents())},onApiPageOrient:function(t){this._state.pgorient!==t&&(this.toolbar.btnPageOrient.menu.items[t?0:1].setChecked(!0),this._state.pgorient=t)},onApiLockDocumentProps:function(){!0!==this._state.lock_doc&&(this.toolbar.lockToolbar(Common.enumLock.docPropsLock,!0,{array:[this.toolbar.btnPageOrient,this.toolbar.btnPageSize,this.toolbar.btnPageMargins,this.toolbar.btnColumns,this.toolbar.btnLineNumbers,this.toolbar.btnHyphenation,this.toolbar.btnPageColor]}),this._state.activated&&(this._state.lock_doc=!0))},onApiUnLockDocumentProps:function(){!1!==this._state.lock_doc&&(this.toolbar.lockToolbar(Common.enumLock.docPropsLock,!1,{array:[this.toolbar.btnPageOrient,this.toolbar.btnPageSize,this.toolbar.btnPageMargins,this.toolbar.btnColumns,this.toolbar.btnLineNumbers,this.toolbar.btnHyphenation,this.toolbar.btnPageColor]}),this._state.activated&&(this._state.lock_doc=!1))},onApiLockDocumentSchema:function(){this.toolbar.lockToolbar(Common.enumLock.docSchemaLock,!0,{array:[this.toolbar.btnColorSchemas]})},onApiUnLockDocumentSchema:function(){this.toolbar.lockToolbar(Common.enumLock.docSchemaLock,!1,{array:[this.toolbar.btnColorSchemas]})},onApiLockHeaderFooters:function(){this.toolbar.lockToolbar(Common.enumLock.headerFooterLock,!0,{array:[this.toolbar.mnuPageNumberPosPicker]}),this.toolbar.lockToolbar(Common.enumLock.cantAddPageNum,this.toolbar.mnuPageNumCurrentPos.isDisabled(),{array:[this.toolbar.mnuInsertPageNum]})},onApiUnLockHeaderFooters:function(){this.toolbar.lockToolbar(Common.enumLock.headerFooterLock,!1,{array:[this.toolbar.mnuPageNumberPosPicker]}),this.toolbar.lockToolbar(Common.enumLock.cantAddPageNum,!1,{array:[this.toolbar.mnuInsertPageNum]})},onApiZoomChange:function(t,e){},onApiStartHighlight:function(t){this.toolbar.btnHighlightColor.toggle(t,!0)},onApiHighlightColor:function(t){var e=this.api.get_TextProps().get_TextPr();e&&(-1==(t=e.get_HighLight())?-1!=this._state.clrhighlight&&(this.toolbar.mnuHighlightTransparent.setChecked(!0,!0),this.toolbar.mnuHighlightColorPicker&&(this._state.clrhighlight=-1,this.toolbar.mnuHighlightColorPicker.clearSelection())):null!==t?this._state.clrhighlight!=t.get_hex().toUpperCase()&&(this.toolbar.mnuHighlightTransparent.setChecked(!1),this._state.clrhighlight=t.get_hex().toUpperCase(),this.toolbar.mnuHighlightColorPicker&&_.contains(this.toolbar.mnuHighlightColorPicker.colors,this._state.clrhighlight)&&this.toolbar.mnuHighlightColorPicker.selectByRGB(this._state.clrhighlight,!0)):this._state.clrhighlight!==t&&(this.toolbar.mnuHighlightTransparent.setChecked(!1,!0),this.toolbar.mnuHighlightColorPicker&&this.toolbar.mnuHighlightColorPicker.clearSelection(),this._state.clrhighlight=t))},onApiInitEditorStyles:function(t){this._onInitEditorStyles(t)},onChangeSdtGlobalSettings:function(){var t=this.api.asc_GetGlobalContentControlShowHighlight();this.toolbar.mnuNoControlsColor&&this.toolbar.mnuNoControlsColor.setChecked(!t,!0),this.toolbar.mnuControlsColorPicker&&this.toolbar.mnuControlsColorPicker.clearSelection(),t&&(t=this.api.asc_GetGlobalContentControlHighlightColor())&&(t=Common.Utils.ThemeColor.getHexColor(t.get_r(),t.get_g(),t.get_b()),this.toolbar.mnuControlsColorPicker&&this.toolbar.mnuControlsColorPicker.selectByRGB(t,!0))},onNewDocument:function(t,e){this.api&&this.api.OpenNewDocument(),Common.NotificationCenter.trigger("edit:complete",this.toolbar),Common.component.Analytics.trackEvent("ToolBar","New Document")},onOpenDocument:function(t,e){this.api&&this.api.LoadDocumentFromDisk(),Common.NotificationCenter.trigger("edit:complete",this.toolbar),Common.component.Analytics.trackEvent("ToolBar","Open Document")},onPrint:function(t){"print"==this.toolbar.btnPrint.options.printType?(Common.NotificationCenter.trigger("file:print",this.toolbar),Common.NotificationCenter.trigger("edit:complete",this.toolbar)):this.getApplication().getController("Main").onPrintQuick(),Common.component.Analytics.trackEvent("Print"),Common.component.Analytics.trackEvent("ToolBar","Print")},onPrintMenu:function(t,e){var i=this.toolbar.btnPrint.options.printType,n=e.value;n!=i&&(this.toolbar.btnPrint.changeIcon({next:e.options.iconClsForMainBtn,curr:this.toolbar.btnPrint.menu.items.filter(function(t){return t.value==i})[0].options.iconClsForMainBtn}),this.toolbar.btnPrint.updateHint([e.caption+e.options.platformKey]),this.toolbar.btnPrint.options.printType=n),this.onPrint(e)},onSave:function(t){var e=this.toolbar;if(this.api){var i=this.api.asc_isDocumentCanSave(),n=e.btnCollabChanges&&e.btnCollabChanges.cmpEl.hasClass("notify");if(!i&&!n&&!e.mode.forcesave)return;this.api.asc_Save()}e.btnSave.setDisabled(!e.mode.forcesave),Common.NotificationCenter.trigger("edit:complete",e),Common.component.Analytics.trackEvent("Save"),Common.component.Analytics.trackEvent("ToolBar","Save")},onBtnChangeState:function(t){/\:disabled$/.test(t)&&this.toolbar.fireEvent(t,[arguments[2]])},onUndo:function(t,e){this.api&&this.api.Undo(),Common.NotificationCenter.trigger("edit:complete",this.toolbar),Common.component.Analytics.trackEvent("ToolBar","Undo")},onRedo:function(t,e){this.api&&this.api.Redo(),Common.NotificationCenter.trigger("edit:complete",this.toolbar),Common.component.Analytics.trackEvent("ToolBar","Redo")},onCopyPaste:function(t,e){var i=this;i.api&&(("cut"===t?i.api.Cut():"copy"===t?i.api.Copy():i.api.Paste())?Common.component.Analytics.trackEvent("ToolBar","Copy Warning"):Common.localStorage.getBool("de-hide-copywarning")||new Common.Views.CopyWarningDialog({handler:function(t){t&&Common.localStorage.setItem("de-hide-copywarning",1),Common.NotificationCenter.trigger("edit:complete",i.toolbar)}}).show()),Common.NotificationCenter.trigger("edit:complete",i.toolbar)},onSelectAll:function(t){this.api&&this.api.asc_EditSelectAll(),Common.NotificationCenter.trigger("edit:complete",this.toolbar),Common.component.Analytics.trackEvent("ToolBar","Select All")},onIncrease:function(t){this.api&&this.api.FontSizeIn(),Common.NotificationCenter.trigger("edit:complete",this.toolbar),Common.component.Analytics.trackEvent("ToolBar","Font Size")},onDecrease:function(t){this.api&&this.api.FontSizeOut(),Common.NotificationCenter.trigger("edit:complete",this.toolbar),Common.component.Analytics.trackEvent("ToolBar","Font Size")},onBold:function(t,e){this._state.bold=void 0,this.api&&this.api.put_TextPrBold(t.pressed),Common.NotificationCenter.trigger("edit:complete",this.toolbar),Common.component.Analytics.trackEvent("ToolBar","Bold")},onItalic:function(t,e){this._state.italic=void 0,this.api&&this.api.put_TextPrItalic(t.pressed),Common.NotificationCenter.trigger("edit:complete",this.toolbar),Common.component.Analytics.trackEvent("ToolBar","Italic")},onUnderline:function(t,e){this._state.underline=void 0,this.api&&this.api.put_TextPrUnderline(t.pressed),Common.NotificationCenter.trigger("edit:complete",this.toolbar),Common.component.Analytics.trackEvent("ToolBar","Underline")},onStrikeout:function(t,e){this._state.strike=void 0,this.api&&this.api.put_TextPrStrikeout(t.pressed),Common.NotificationCenter.trigger("edit:complete",this.toolbar),Common.component.Analytics.trackEvent("ToolBar","Strikeout")},onSuperscript:function(t,e){this.toolbar.btnSubscript.pressed||(this._state.valign=void 0,this.api&&this.api.put_TextPrBaseline(t.pressed?Asc.vertalign_SuperScript:Asc.vertalign_Baseline),Common.NotificationCenter.trigger("edit:complete",this.toolbar),Common.component.Analytics.trackEvent("ToolBar","Superscript"))},onSubscript:function(t,e){this.toolbar.btnSuperscript.pressed||(this._state.valign=void 0,this.api&&this.api.put_TextPrBaseline(t.pressed?Asc.vertalign_SubScript:Asc.vertalign_Baseline),Common.NotificationCenter.trigger("edit:complete",this.toolbar),Common.component.Analytics.trackEvent("ToolBar","Subscript"))},onDecOffset:function(t,e){this.api&&this.api.DecreaseIndent(),Common.NotificationCenter.trigger("edit:complete",this.toolbar),Common.component.Analytics.trackEvent("ToolBar","Indent")},onIncOffset:function(t,e){this.api&&this.api.IncreaseIndent(),Common.NotificationCenter.trigger("edit:complete",this.toolbar),Common.component.Analytics.trackEvent("ToolBar","Indent")},onHorizontalAlign:function(t,e,i){this._state.pralign=void 0,this.api&&(e.pressed||(t=1==t?3:1),this.api.put_PrAlign(t)),Common.NotificationCenter.trigger("edit:complete",this.toolbar),Common.component.Analytics.trackEvent("ToolBar","Align")},onMarkers:function(t,e){t={numberingInfo:t.pressed?'{"Type":"bullet"}':'{"Type":"remove"}'};this.onSelectBullets(null,this.toolbar.mnuMarkersPicker,null,t),Common.NotificationCenter.trigger("edit:complete",this.toolbar)},onNumbers:function(t,e){t={numberingInfo:t.pressed?'{"Type":"number"}':'{"Type":"remove"}'};this.onSelectBullets(null,this.toolbar.mnuNumbersPicker,null,t),Common.NotificationCenter.trigger("edit:complete",this.toolbar)},onComboBlur:function(){Common.NotificationCenter.trigger("edit:complete",this.toolbar)},onFontNameSelect:function(t,e){this.api&&(e.isNewFont?Common.Utils.ModalWindow.isVisible()||Common.UI.warning({width:500,msg:this.confirmAddFontName,buttons:["yes","no"],primary:"yes",callback:_.bind(function(t){"yes"==t?(this.api.put_TextPrFontName(e.name),Common.component.Analytics.trackEvent("ToolBar","Font Name")):this.toolbar.cmbFontName.setValue(this.api.get_TextProps().get_TextPr().get_FontFamily().get_Name()),Common.NotificationCenter.trigger("edit:complete",this.toolbar)},this)}):(this.api.put_TextPrFontName(e.name),Common.component.Analytics.trackEvent("ToolBar","Font Name"))),Common.NotificationCenter.trigger("edit:complete",this.toolbar)},onComboOpen:function(e,i,t,n){n&&n.fromKeyDown||_.delay(function(){var t=$("input",i.cmpEl).select();e?t.focus():i.isMenuOpen()||t.one("mouseup",function(t){t.preventDefault()})},10)},onFontSizeSelect:function(t,e){this._state.fontsize=void 0,this._state.type_fontsize=typeof e.value,this.api&&this.api.put_TextPrFontSize("string"===this._state.type_fontsize?parseFloat(e.value):e.value),Common.NotificationCenter.trigger("edit:complete",this.toolbar),Common.component.Analytics.trackEvent("ToolBar","Font Size")},onFontSizeChanged:function(t,e,i,n){var o,s=this;if(t){t=e.store.findWhere({displayValue:i.value});if((!t||isNaN(Common.Utils.String.parseFloat(i.value)))&&(s._state.type_fontsize="number",!(o=/^\+?(\d*(\.|,)?\d+)$|^\+?(\d+(\.|,)?\d*)$/.exec(i.value))))return o=this._getApiTextSize(),setTimeout(function(){Common.UI.warning({msg:s.textFontSizeErr,callback:function(){_.defer(function(t){$("input",e.cmpEl).focus()})}})},1),e.setRawValue(o),n.preventDefault(),!1}else o=300<(o=Common.Utils.String.parseFloat(i.value))?300:o<1?1:Math.floor(2*(o+.4))/2,e.setRawValue(o),this._state.fontsize=void 0,this.api&&this.api.put_TextPrFontSize(o),Common.NotificationCenter.trigger("edit:complete",this.toolbar)},onChangeCase:function(t,e,i){this.api&&this.api.asc_ChangeTextCase(e.value),Common.NotificationCenter.trigger("edit:complete",this.toolbar)},showSelectedBulletOnOpen:function(t,e){for(var i=this.api.asc_GetCurrentNumberingId(),n=null!==i?this.api.asc_GetNumberingPr(i).get_Lvl(this.api.asc_GetCurrentNumberingLvl()).get_Format():Asc.c_oAscNumberingFormat.None,o=(e.deselectAll(!0),e.store),s=0;s<o.length;s++){var a=o.at(s);if(0<a.get("type")&&this.api.asc_IsCurrentNumberingPreset(a.get("numberingInfo"),2!==t)){e.selectByIndex(s,!0);break}}2===t?this.toolbar.mnuMultiChangeLevel&&this.toolbar.mnuMultiChangeLevel.setDisabled(n===Asc.c_oAscNumberingFormat.None):0===t?this.toolbar.mnuMarkerChangeLevel&&this.toolbar.mnuMarkerChangeLevel.setDisabled(!(n===Asc.c_oAscNumberingFormat.Bullet||n===Asc.c_oAscNumberingFormat.None&&null!==i)):this.toolbar.mnuNumberChangeLevel&&this.toolbar.mnuNumberChangeLevel.setDisabled(n===Asc.c_oAscNumberingFormat.Bullet||n===Asc.c_oAscNumberingFormat.None)},onListShowAfter:function(t,e,i,n){var o;n&&n.target===n.currentTarget&&(this.fillDocListPatterns(t,e),n=e.store,o=[],n.each(function(t){o.push({numberingInfo:JSON.parse(t.get("numberingInfo")),divId:t.get("id")})}),this.api&&this.api.SetDrawImagePreviewBulletForMenu(o,t),this.showSelectedBulletOnOpen(t,e))},onPageColorShowAfter:function(t,e){if(e&&e.target===e.currentTarget){Common.UI.TooltipManager.closeTip("pageColor");var i=this.toolbar.mnuPageColorPicker,n=this.api.asc_getPageColor();if(this.toolbar.mnuPageNoFill.setChecked(!n,!0),i.clearSelection(),n)if("object"==typeof(n=n.get_type()==Asc.c_oAscColor.COLOR_TYPE_SCHEME?{color:Common.Utils.ThemeColor.getHexColor(n.get_r(),n.get_g(),n.get_b()),effectValue:n.get_value()}:Common.Utils.ThemeColor.getHexColor(n.get_r(),n.get_g(),n.get_b()))){for(var o=0;o<10;o++)if(Common.Utils.ThemeColor.ThemeValues[o]==n.effectValue){i.select(n,!0);break}}else i.select(n,!0)}},onApiUpdateListPatterns:function(t){t&&(this._listPatterns=[t.singleBullet,t.singleNumbering,t.multiLevel])},fillDocListPatterns:function(t,e){if(this._listPatterns){var i=this._listPatterns[t];if(i){e.store.remove(e.store.where({type:2}));var n=e.groups.findWhere({type:2});!n&&0<i.length?e.groups.add({id:e.options.listSettings.docGroup,caption:e.options.listSettings.docName,type:2}):n&&0===i.length&&e.groups.remove(n);for(var o=0;o<i.length;o++){var s=i[o];e.store.add({id:"id-doc-list-"+Common.UI.getId(),numberingInfo:"string"==typeof s?s:JSON.stringify(s),skipRenderOnChange:!0,group:e.options.listSettings.docGroup,type:2})}e.scroller&&(e.scroller.update(),e.scroller.scrollTop(0)),this._listPatterns[t]=null}}},onSelectBullets:function(t,e,i,n){var o,s={};if(_.isFunction(n.toJSON)){if(!n.get("selected"))return;s=n.toJSON()}else s=n;this.api&&(n=this.api.put_ListTypeCustom(JSON.parse(s.numberingInfo)))&&(o=this,n.then(function(t){t&&(t="string"==typeof t?t:JSON.stringify(t),o.addListTypeToRecent(e,{numberingInfo:t}))})),Common.component.Analytics.trackEvent("ToolBar","List Type"),Common.NotificationCenter.trigger("edit:complete",this.toolbar)},addListTypeToRecent:function(t,e){if(t&&e&&!this.api.asc_CompareNumberingPresets('{"Type":"remove"}',e.numberingInfo)){t.groups.findWhere({type:0})||t.groups.add({id:t.options.listSettings.recentGroup,caption:this.toolbar.txtGroupRecent,type:0},{at:0});for(var i=t.store.where({type:0}),n=e.numberingInfo,o=0;o<i.length;o++){var s=i[o];if(this.api.asc_CompareNumberingPresets(s.get("numberingInfo"),n)){t.store.remove(s);break}}t.store.add({id:"id-recent-list-"+Common.UI.getId(),numberingInfo:"string"==typeof e.numberingInfo?e.numberingInfo:JSON.stringify(e.numberingInfo),skipRenderOnChange:!0,group:t.options.listSettings.recentGroup,type:0},{at:0}),(i=t.store.where({type:0}))&&i.length>t.options.listSettings.recentCount&&t.store.remove(i.slice(t.options.listSettings.recentCount,i.length)),this.toolbar.saveListPresetToStorage(t)}},onMarkerSettingsClick:function(i){var n,o=this,s=o.api.asc_GetCurrentNumberingId(),t=o.api.asc_GetCurrentNumberingLvl(),e=null===s?null:o.api.asc_GetNumberingPr(s),a=null===s?Asc.c_oAscNumberingFormat.None:e.get_Lvl(t).get_Format(),l=null===s||0===i&&!(a===Asc.c_oAscNumberingFormat.Bullet||a===Asc.c_oAscNumberingFormat.None)||1===i&&a===Asc.c_oAscNumberingFormat.Bullet,r=l?new Asc.CAscNumbering:e,c=0===i?o.toolbar.mnuMarkersPicker:1===i?o.toolbar.mnuNumbersPicker:o.toolbar.mnuMultilevelPicker;l&&c&&1<c.store.length&&((a=(a=c.store.findWhere({type:0}))||c.store.at(1))&&r.put_FromJSON(a.get("numberingInfo"))),r&&(o=this,_.isUndefined(o.fontstore)&&(o.fontstore=new Common.Collections.Fonts,e=o.toolbar.cmbFontName.store.toJSON(),n=[],_.each(e,function(t,e){t.cloneid||n.push(_.clone(t))}),o.fontstore.add(n)),new DE.Views.ListSettingsDialog({api:o.api,props:r,level:l?0:t,type:i,fontStore:o.fontstore,interfaceLang:o.mode.lang,handler:function(t,e){"ok"==t&&o.api&&(t=r.get_JSONNumbering(2!==i),l?o.api.put_ListTypeCustom(t):o.api.asc_ChangeNumberingLvl(s,e.props,e.num),o.addListTypeToRecent(c,{numberingInfo:JSON.stringify(t)})),Common.NotificationCenter.trigger("edit:complete",o.toolbar)}}).show())},onChangeLevelShowAfter:function(t,e){var i=this.api.asc_GetCurrentNumberingId(),n=this.api.asc_GetCurrentNumberingLvl(),i=null!==i?this.api.asc_GetNumberingPr(i):null,o=_.find(e.items,function(t){return t.options.level==n});e.clearAll(),o&&o.setChecked(!0),i&&this.api.SetDrawImagePreviewBulletChangeListLevel(e.options.previewIds,i)},onChangeLevelClick:function(t,e,i){this.api&&this.api.asc_SetNumberingLvl(i.options.level),Common.NotificationCenter.trigger("edit:complete",this.toolbar)},onLineSpaceToggle:function(t,e,i,n){i&&(this._state.linespace=void 0,this.api&&this.api.put_PrLineSpacing(c_paragraphLinerule.LINERULE_AUTO,e.value),Common.component.Analytics.trackEvent("ToolBar","Line Spacing"),Common.NotificationCenter.trigger("edit:complete",this.toolbar))},onMenuNonPrintingToggle:function(t,e,i,n){"characters"===e.value?(Common.localStorage.setItem("de-show-hiddenchars",i),this.toolbar.btnShowHidenChars.toggle(i,!0),this.api&&this.api.put_ShowParaMarks(i),Common.NotificationCenter.trigger("edit:complete",this),Common.component.Analytics.trackEvent("ToolBar","Hidden Characters")):"table"===e.value&&(Common.localStorage.setItem("de-show-tableline",i),this.api&&this.api.put_ShowTableEmptyLine(i),Common.NotificationCenter.trigger("edit:complete",this))},onNonPrintingToggle:function(t,e){e?(this.toolbar.mnuNonPrinting.items[0].setChecked(!0,!0),Common.component.Analytics.trackEvent("ToolBar","Hidden Characters")):this.toolbar.mnuNonPrinting.items[0].setChecked(!1,!0),this.api&&this.api.put_ShowParaMarks(e),Common.localStorage.setItem("de-show-hiddenchars",e),Common.NotificationCenter.trigger("edit:complete",this)},onClickPageBreak:function(t,e){"column"===t?(this.api.put_AddColumnBreak(),Common.component.Analytics.trackEvent("ToolBar","Column Break")):"page"==t?(this.api.put_AddPageBreak(),Common.component.Analytics.trackEvent("ToolBar","Page Break")):(this.api.add_SectionBreak(t),Common.component.Analytics.trackEvent("ToolBar","Section Break")),Common.NotificationCenter.trigger("edit:complete",this.toolbar)},onTablePickerSelect:function(t,e,i,n){this.api&&(this.toolbar.fireEvent("inserttable",this.toolbar),this.api.put_Table(e,i)),Common.NotificationCenter.trigger("edit:complete",this.toolbar),Common.component.Analytics.trackEvent("ToolBar","Table")},onInsertTableShow:function(t){var e=this.api.asc_GetSelectedText();t.items[4].setDisabled(!e||e.length<1)},onInsertTableClick:function(t,e,i){var n=this;"custom"===e.value?new Common.Views.InsertTableDialog({handler:function(t,e){"ok"==t&&(n.api&&(n.toolbar.fireEvent("inserttable",n.toolbar),n.api.put_Table(e.columns,e.rows)),Common.component.Analytics.trackEvent("ToolBar","Table")),Common.NotificationCenter.trigger("edit:complete",n.toolbar)}}).show():"draw"==e.value?(e.isChecked()&&t.items[3].setChecked(!1,!0),this.api.SetTableDrawMode(e.isChecked())):"erase"==e.value?(e.isChecked()&&t.items[2].setChecked(!1,!0),this.api.SetTableEraseMode(e.isChecked())):"convert"==e.value?new DE.Views.TextToTableDialog({props:this.api.asc_PreConvertTextToTable(),handler:function(t,e){"ok"==t&&n.api&&n.api.asc_ConvertTextToTable(e),Common.NotificationCenter.trigger("edit:complete",n.toolbar)}}).show():"sse"==e.value&&(t=this.getApplication().getController("Common.Controllers.ExternalOleEditor").getView("Common.Views.ExternalOleEditor"))&&(t.setEditMode(!1),t.show(),t.setOleData("empty"))},onInsertImageClick:function(t,e,i){var n=this;"file"===e.value?(this.toolbar.fireEvent("insertimage",this.toolbar),this.api&&setTimeout(function(){n.api.asc_addImage()},1),Common.NotificationCenter.trigger("edit:complete",n.toolbar),Common.component.Analytics.trackEvent("ToolBar","Image")):"url"===e.value?new Common.Views.ImageFromUrlDialog({handler:function(t,e){"ok"==t&&(n.api&&(t=e.replace(/ /g,""),_.isEmpty(t)?Common.UI.warning({msg:this.textEmptyImgUrl}):(n.toolbar.fireEvent("insertimage",n.toolbar),n.api.AddImageUrl([t]),Common.component.Analytics.trackEvent("ToolBar","Image"))),Common.NotificationCenter.trigger("edit:complete",n.toolbar))}}).show():"storage"===e.value&&Common.NotificationCenter.trigger("storage:image-load","add")},openImageFromStorage:function(i){var n=this;this.toolbar.mode.canRequestInsertImage?Common.Gateway.requestInsertImage(i):new Common.Views.SelectFileDlg({fileChoiceUrl:this.toolbar.mode.fileChoiceUrl.replace("{fileExt}","").replace("{documentType}","ImagesOnly")}).on("selectfile",function(t,e){e&&(e.c=i),e.images||(e.images=[{fileType:e.fileType,url:e.url}]),e.url=null,n.insertImage(e)}).show()},insertImageFromStorage:function(t){!t||!t._urls||t.c&&"add"!=t.c||(this.toolbar.fireEvent("insertimage",this.toolbar),0<t._urls.length&&this.api.AddImageUrl(t._urls,void 0,t.token),Common.component.Analytics.trackEvent("ToolBar","Image"))},insertImage:function(t){if(t&&(t.url||t.images)){t.url;var e=[];if(t.images&&0<t.images.length)for(var i=0;i<t.images.length;i++)t.images[i]&&t.images[i].url&&e.push(t.images[i].url);else t.url&&e.push(t.url);t._urls=e}Common.NotificationCenter.trigger("storage:image-insert",t)},onBtnInsertTextClick:function(e,t){e.menu.items.forEach(function(t){t.value==e.options.textboxType&&t.setChecked(!0)}),this.toolbar.btnInsertText.pressed||this.toolbar.btnInsertText.menu.clearAll(),this.onInsertText(e.options.textboxType,e,t)},onMenuInsertTextClick:function(t,e){var i=this.toolbar.btnInsertText.options.textboxType,n=e.value;this.toolbar.btnInsertText.toggle(!0),n!=i&&(this.toolbar.btnInsertText.changeIcon({next:e.options.iconClsForMainBtn,curr:this.toolbar.btnInsertText.menu.items.filter(function(t){return t.value==i})[0].options.iconClsForMainBtn}),this.toolbar.btnInsertText.updateHint([e.caption,this.views.Toolbar.prototype.tipInsertText]),this.toolbar.btnInsertText.options.textboxType=n),this.onInsertText(n,t,e)},onInsertText:function(t,e,i){this.api&&this._addAutoshape(this.toolbar.btnInsertText.pressed,t),this.toolbar.btnInsertShape.pressed&&this.toolbar.btnInsertShape.toggle(!1,!0),Common.NotificationCenter.trigger("edit:complete",this.toolbar,this.toolbar.btnInsertShape),Common.component.Analytics.trackEvent("ToolBar","Add Text")},onInsertShapeHide:function(t,e){this.toolbar.btnInsertShape.pressed&&!this._isAddingShape&&this.toolbar.btnInsertShape.toggle(!1,!0),this._isAddingShape=!1,Common.NotificationCenter.trigger("edit:complete",this.toolbar,this.toolbar.btnInsertShape)},onPageOrientSelect:function(t,e){this._state.pgorient=void 0,this.api&&e.checked&&this.api.change_PageOrient(e.value),Common.NotificationCenter.trigger("edit:complete",this.toolbar),Common.component.Analytics.trackEvent("ToolBar","Page Orientation")},onClearStyleClick:function(t,e){this.api&&this.api.ClearFormating(),Common.NotificationCenter.trigger("edit:complete",this.toolbar)},onCopyStyleToggle:function(t,e,i){this.api&&this.api.SetPaintFormat(e?1:0),Common.NotificationCenter.trigger("edit:complete",this.toolbar),this.modeAlwaysSetStyle=e},onPageSizeClick:function(t,e,i){if(this.api&&i){if(this._state.pgsize=[0,0],"advanced"!==e.value){if(this.checkPageSize(e.value[0],e.value[1]))return i=this.api.asc_GetSectionProps(),void this.onApiPageSize(i.get_W(),i.get_H());this.api.change_DocSize(e.value[0],e.value[1])}else{var n,o=this,i=new DE.Views.PageSizeDialog({checkPageSize:_.bind(this.checkPageSize,this),handler:function(t,e){"ok"==e&&(n=t.getSettings(),o.api.change_DocSize(n[0],n[1]),Common.NotificationCenter.trigger("edit:complete",o.toolbar))}});i.show(),i.setSettings(o.api.asc_GetSectionProps())}Common.component.Analytics.trackEvent("ToolBar","Page Size")}Common.NotificationCenter.trigger("edit:complete",this.toolbar)},onPageMarginsSelect:function(t,e){if(this.api){if(this._state.pgmargins=void 0,"advanced"!==e.value){if(this.checkPageSize(void 0,void 0,e.value[1],e.value[3],e.value[0],e.value[2]))return void this.onSectionProps(this.api.asc_GetSectionProps());(i=new Asc.CDocumentSectionProps).put_TopMargin(e.value[0]),i.put_LeftMargin(e.value[1]),i.put_BottomMargin(e.value[2]),i.put_RightMargin(e.value[3]),this.api.asc_SetSectionProps(i)}else{var i,n=this,e=new DE.Views.PageMarginsDialog({api:n.api,handler:function(t,e){"ok"==e&&(i=t.getSettings(),Common.localStorage.setItem("de-pgmargins-top",i.get_TopMargin()),Common.localStorage.setItem("de-pgmargins-left",i.get_LeftMargin()),Common.localStorage.setItem("de-pgmargins-bottom",i.get_BottomMargin()),Common.localStorage.setItem("de-pgmargins-right",i.get_RightMargin()),Common.NotificationCenter.trigger("margins:update",i),n.api.asc_SetSectionProps(i),Common.NotificationCenter.trigger("edit:complete",n.toolbar))}});e.show(),e.setSettings(n.api.asc_GetSectionProps())}Common.component.Analytics.trackEvent("ToolBar","Page Margins")}Common.NotificationCenter.trigger("edit:complete",this.toolbar)},checkPageSize:function(t,e,i,n,o,s){var a=this.api.asc_GetSectionProps(),l=(void 0===t&&(t=parseFloat(a.get_W().toFixed(4))),void 0===e&&(e=parseFloat(a.get_H().toFixed(4))),void 0===i&&(i=parseFloat(a.get_LeftMargin().toFixed(4))),void 0===n&&(n=parseFloat(a.get_RightMargin().toFixed(4))),void 0===o&&(o=parseFloat(a.get_TopMargin().toFixed(4))),void 0===s&&(s=parseFloat(a.get_BottomMargin().toFixed(4))),a.get_GutterAtTop()?0:parseFloat(a.get_Gutter().toFixed(4))),a=a.get_GutterAtTop()?parseFloat(a.get_Gutter().toFixed(4)):0,r=null;if(t-12.7<i+n+l?r=this.txtMarginsW:e-2.6<o+s+a&&(r=this.txtMarginsH),r)return Common.UI.warning({title:this.notcriticalErrorTitle,msg:r,callback:function(){Common.NotificationCenter.trigger("edit:complete",this.toolbar)}}),!0},onLineNumbersSelect:function(t,e){if(!_.isUndefined(e.value)){switch(e.value){case 0:this._state.linenum=void 0,this.api.asc_SetLineNumbersProps(Asc.c_oAscSectionApplyType.Current,null);break;case 1:case 2:case 3:this._state.linenum=void 0,this.api&&e.checked&&((n=new Asc.CSectionLnNumType).put_Restart(1==e.value?Asc.c_oAscLineNumberRestartType.Continuous:2==e.value?Asc.c_oAscLineNumberRestartType.NewPage:Asc.c_oAscLineNumberRestartType.NewSection),this.api.asc_GetLineNumbersProps()&&n.put_CountBy(void 0),this.api.asc_SetLineNumbersProps(Asc.c_oAscSectionApplyType.Current,n));break;case 4:this.api&&this.api.asc_SetParagraphSuppressLineNumbers(e.checked);break;case 5:var i=this,n=new DE.Views.LineNumbersDialog({applyTo:i._state.linenum_apply,handler:function(t,e){"ok"==e&&(e=t.getSettings(),i.api.asc_SetLineNumbersProps(e.type,e.props),i._state.linenum_apply=e.type,Common.NotificationCenter.trigger("edit:complete",i.toolbar))}});n.show(),n.setSettings(i.api.asc_GetLineNumbersProps())}Common.NotificationCenter.trigger("edit:complete",this.toolbar)}},onLineNumbersProps:function(t){var e=0;if(t)switch(t.get_Restart()){case Asc.c_oAscLineNumberRestartType.Continuous:e=1;break;case Asc.c_oAscLineNumberRestartType.NewPage:e=2;break;case Asc.c_oAscLineNumberRestartType.NewSection:e=3}this._state.linenum!==e&&(this.toolbar.btnLineNumbers.menu.items[e].setChecked(!0),this._state.linenum=e)},onLineNumbersShow:function(t){t.items[4].setChecked(this._state.suppress_num)},onHyphenationSelect:function(t,e){var i,n;_.isUndefined(e.value)||("custom"===e.value?(i=this,(n=new DE.Views.HyphenationDialog({handler:function(t,e){"ok"==e&&(i.api.asc_setAutoHyphenationSettings(t.getSettings()),Common.NotificationCenter.trigger("edit:complete",i.toolbar))}})).show(),i.api&&n.setSettings(i.api.asc_getAutoHyphenationSettings())):this.api&&this.api.asc_setAutoHyphenation(!!e.value),Common.NotificationCenter.trigger("edit:complete",this.toolbar))},onHyphenationShow:function(t){this.api&&t.items[this.api.asc_isAutoHyphenation()?1:0].setChecked(!0)},onColorSchemaClick:function(t,e){this.api&&(this.api.asc_ChangeColorSchemeByIdx(e.value),Common.component.Analytics.trackEvent("ToolBar","Color Scheme")),Common.NotificationCenter.trigger("edit:complete",this.toolbar)},onColorSchemaShow:function(t){var e,i;this.api&&(e=this.api.asc_GetCurrentColorSchemeIndex(),(i=_.find(t.items,function(t){return t.value==e}))?i.setChecked(!0):t.clearAll())},onDropCapSelect:function(t,e){if(!_.isUndefined(e.value)){if(this._state.dropcap=void 0,this.api&&e.checked)if(e.value===Asc.c_oAscDropCap.None)this.api.removeDropcap(!0);else for(var i=this.api.getSelectedElements(),n=-1;++n<i.length;)if(i[n].get_ObjectType()==Asc.c_oAscTypeSelectElement.Paragraph){var o=i[n].get_ObjectValue().get_FramePr();_.isUndefined(o)?this.api.asc_addDropCap(e.value===Asc.c_oAscDropCap.Drop):((o=new Asc.asc_CParagraphFrame).put_FromDropCapMenu(!0),o.put_DropCap(e.value),this.api.put_FramePr(o));break}Common.NotificationCenter.trigger("edit:complete",this.toolbar),Common.component.Analytics.trackEvent("ToolBar","Drop Cap")}},onDropCap:function(t){if(this._state.dropcap!==t){var e=-1;switch(t){case Asc.c_oAscDropCap.None:e=0;break;case Asc.c_oAscDropCap.Drop:e=1;break;case Asc.c_oAscDropCap.Margin:e=2}e<0?this.toolbar.btnDropCap.menu.clearAll():this.toolbar.btnDropCap.menu.items[e].setChecked(!0),this._state.dropcap=t}},onDropCapAdvancedClick:function(i){var t,e,n,o=this;if(!i&&_.isUndefined(o.fontstore)&&(o.fontstore=new Common.Collections.Fonts,e=o.toolbar.cmbFontName.store.toJSON(),n=[],_.each(e,function(t,e){t.cloneid||n.push(_.clone(t))}),o.fontstore.add(n)),o.api){var s=o.api.getSelectedElements(),a=s.length;if(s&&_.isArray(s))for(var l=0;l<a;l++)if(s[l].get_ObjectType()==Asc.c_oAscTypeSelectElement.Paragraph){t=s[l].get_ObjectValue();break}t&&new DE.Views.DropcapSettingsAdvanced({tableStylerRows:2,tableStylerColumns:1,fontStore:i?null:o.fontstore,paragraphProps:t,borderProps:o.borderAdvancedProps,api:o.api,isFrame:!!i,handler:function(t,e){"ok"==t&&(o.borderAdvancedProps=e.borderProps,e.paragraphProps&&(!i&&e.paragraphProps.get_DropCap()===Asc.c_oAscDropCap.None||i&&e.paragraphProps.get_Wrap()===c_oAscFrameWrap.None)?o.api.removeDropcap(!i):o.api.put_FramePr(e.paragraphProps)),Common.NotificationCenter.trigger("edit:complete",o.toolbar)}}).show()}},onControlsSelect:function(t,e){var i,n,o,s,a,l;this.mode&&this.mode.canFeatureContentControl&&("settings"==e.value||"remove"==e.value?this.api.asc_IsContentControl()&&(a=this.api.asc_GetContentControlProperties())&&(i=a.get_InternalId(),"settings"==e.value?(n=this,new DE.Views.ControlSettingsDialog({props:a,api:n.api,controlLang:n._state.lang,interfaceLang:n.mode.lang,handler:function(t,e){"ok"==t&&n.api.asc_SetContentControlProperties(e,i),Common.NotificationCenter.trigger("edit:complete",n.toolbar)}}).show()):(this.api.asc_RemoveContentControlWrapper(i),Common.component.Analytics.trackEvent("ToolBar","Remove Content Control"))):((o=0==e.value.indexOf("new-"))&&(s=new AscCommon.CSdtFormPr,this.toolbar.fireEvent("insertcontrol",this.toolbar)),"plain"==e.value||"rich"==e.value?this.api.asc_AddContentControl("plain"==e.value?Asc.c_oAscSdtLevelType.Inline:Asc.c_oAscSdtLevelType.Block):0<=e.value.indexOf("picture")?this.api.asc_AddContentControlPicture(s):0<=e.value.indexOf("checkbox")||0<=e.value.indexOf("radiobox")?(o&&(l=new AscCommon.CSdtCheckBoxPr,0<=e.value.indexOf("radiobox")&&l.put_GroupKey(this.textGroup+" 1")),this.api.asc_AddContentControlCheckBox(l,s)):"date"==e.value?this.api.asc_AddContentControlDatePicker():0<=e.value.indexOf("combobox")||0<=e.value.indexOf("dropdown")?this.api.asc_AddContentControlList(0<=e.value.indexOf("combobox"),l,s):"new-field"==e.value&&(a=new AscCommon.CContentControlPr,l=new AscCommon.CSdtTextFormPr,a.put_TextFormPr(l),a.put_FormPr(s),this.api.asc_AddContentControlTextForm(a)),Common.component.Analytics.trackEvent("ToolBar","Add Content Control")),Common.NotificationCenter.trigger("edit:complete",this.toolbar))},onNewControlsColor:function(t,e){this.toolbar.mnuControlsColorPicker.addNewColor()},onNoControlsColor:function(t){t.isChecked()?this.api.asc_SetGlobalContentControlShowHighlight(!1):this.api.asc_SetGlobalContentControlShowHighlight(!0,220,220,220)},onSelectControlsColor:function(t,e){e=Common.Utils.ThemeColor.getRgbColor(e);this.api&&this.api.asc_SetGlobalContentControlShowHighlight(!0,e.get_r(),e.get_g(),e.get_b()),Common.component.Analytics.trackEvent("ToolBar","Content Controls Color")},onColumnsSelect:function(t,e){var i,n,o,s;_.isUndefined(e.value)||(this._state.columns=void 0,this.api&&("advanced"==e.value?(i=this,(o=new DE.Views.CustomColumnsDialog({handler:function(t,e){"ok"==e&&(n=t.getSettings(),i.api.asc_SetColumnsProps(n),Common.NotificationCenter.trigger("edit:complete",i.toolbar))}})).show(),o.setSettings(i.api.asc_GetColumnsProps())):e.checked&&(n=new Asc.CDocumentColumnsProps,o=e.value,n.put_EqualWidth(o<3),o<3?(n.put_Num(o+1),n.put_Space(12.5)):(s=(e=this.api.asc_GetColumnsProps().get_TotalWidth())-12.5-(e=(e-25)/3),n.put_ColByValue(0,3==o?e:s,12.5),n.put_ColByValue(1,3==o?s:e,0)),this.api.asc_SetColumnsProps(n))),Common.NotificationCenter.trigger("edit:complete",this.toolbar),Common.component.Analytics.trackEvent("ToolBar","Insert Columns"))},onColumnsProps:function(t){var e,i,n,o;t&&(n=(i=t.get_EqualWidth())?t.get_Num():t.get_ColsCount(),e=-1,i&&n<4&&(1==n||Math.abs(t.get_Space()-12.5)<.1)?e=n-1:i||2!=n||(i=t.get_Col(0).get_W(),n=t.get_Col(0).get_Space(),o=t.get_Col(1).get_W(),t=t.get_TotalWidth(),Math.abs(n-12.5)<.1&&(t=(t-2*n)/3,i<o&&Math.abs(i-t)<.1?e=3:o<i&&Math.abs(o-t)<.1&&(e=4))),this._state.columns!==e&&(e<0?this.toolbar.btnColumns.menu.clearAll():this.toolbar.btnColumns.menu.items[e].setChecked(!0),this._state.columns=e))},onSelectChart:function(t){var e=!1,i=this.api.getSelectedElements();if(i&&_.isArray(i))for(var n=0;n<i.length;n++)if(Asc.c_oAscTypeSelectElement.Image==i[n].get_ObjectType()){var o=i[n].get_ObjectValue().get_ChartProperties();if(o){e=o;break}}e?((t==Asc.c_oAscChartTypeSettings.comboBarLine||t==Asc.c_oAscChartTypeSettings.comboBarLineSecondary||t==Asc.c_oAscChartTypeSettings.comboAreaBar||t==Asc.c_oAscChartTypeSettings.comboCustom)&&e.getSeries().length<2?Common.NotificationCenter.trigger("showerror",Asc.c_oAscError.ID.ComboSeriesError,Asc.c_oAscError.Level.NoCritical):e.changeType(t),Common.NotificationCenter.trigger("edit:complete",this.toolbar)):(this.diagramEditor||(this.diagramEditor=this.getApplication().getController("Common.Controllers.ExternalDiagramEditor").getView("Common.Views.ExternalDiagramEditor")),this.diagramEditor&&this.api&&(this.diagramEditor.setEditMode(!1),this.diagramEditor.show(),(e=this.api.asc_getChartObject(t))&&this.diagramEditor.setChartData(new Asc.asc_CChartBinary(e)),this.toolbar.fireEvent("insertchart",this.toolbar)))},onInsertTextart:function(t){this.api&&(this.toolbar.fireEvent("inserttextart",this.toolbar),this.api.AddTextArt(t),this.toolbar.btnInsertShape.pressed&&this.toolbar.btnInsertShape.toggle(!1,!0),Common.NotificationCenter.trigger("edit:complete",this.toolbar,this.toolbar.btnInsertTextArt),Common.component.Analytics.trackEvent("ToolBar","Add Text Art"))},onInsertPageNumberClick:function(t,e,i,n){this.api&&this.api.put_PageNum(i.get("data").type,i.get("data").subtype),"click"!==n.type&&this.toolbar.btnEditHeader.menu.hide(),Common.NotificationCenter.trigger("edit:complete",this.toolbar),Common.component.Analytics.trackEvent("ToolBar","Page Number")},onInsertPageCountClick:function(t,e){this.api&&this.api.asc_AddPageCount(),Common.NotificationCenter.trigger("edit:complete",this.toolbar),Common.component.Analytics.trackEvent("ToolBar","Pages Count")},onEditHeaderFooterClick:function(t,e){if(this.api){if("header"==e.value)this.api.GoToHeader(this.api.getCurrentPage());else if("footer"==e.value)this.api.GoToFooter(this.api.getCurrentPage());else if("header-remove"==e.value)this.api.asc_RemoveHeader(this.api.getCurrentPage());else{if("footer-remove"!=e.value)return;this.api.asc_RemoveFooter(this.api.getCurrentPage())}Common.NotificationCenter.trigger("edit:complete",this.toolbar),Common.component.Analytics.trackEvent("ToolBar","Edit "+e.value)}},onPageNumCurrentPosClick:function(t,e){this.api&&this.api.put_PageNum(-1),"click"!==e.type&&this.toolbar.btnEditHeader.menu.hide(),Common.NotificationCenter.trigger("edit:complete",this.toolbar),Common.component.Analytics.trackEvent("ToolBar","Page Number")},onBtnBlankPageClick:function(t){this.api&&this.api.asc_AddBlankPage(),Common.NotificationCenter.trigger("edit:complete",this.toolbar),Common.component.Analytics.trackEvent("ToolBar","Blank Page")},onWatermarkSelect:function(t,e){var i,n,o;this.api&&("remove"==e.value?this.api.asc_WatermarkRemove():(i=this,_.isUndefined(i.fontstore)&&(i.fontstore=new Common.Collections.Fonts,n=i.toolbar.cmbFontName.store.toJSON(),o=[],_.each(n,function(t,e){t.cloneid||o.push(_.clone(t))}),i.fontstore.add(o)),new DE.Views.WatermarkSettingsDialog({props:i.api.asc_GetWatermarkProps(),api:i.api,lang:i.mode.lang,storage:i.mode.canRequestInsertImage||i.mode.fileChoiceUrl&&-1<i.mode.fileChoiceUrl.indexOf("{documentType}"),fontStore:i.fontstore,handler:function(t,e){"ok"==t&&i.api.asc_SetWatermarkProps(e),Common.NotificationCenter.trigger("edit:complete",i.toolbar)}}).show()),Common.NotificationCenter.trigger("edit:complete",this.toolbar),Common.component.Analytics.trackEvent("ToolBar","Edit "+e.value))},onListStyleSelect:function(t,e){this._state.prstyle=void 0,this.api&&this.api.put_Style(e.get("title")),Common.NotificationCenter.trigger("edit:complete",this.toolbar),Common.component.Analytics.trackEvent("ToolBar","Style")},onListStyleBeforeHide:function(t,e){this.toolbar.listStyles.isStylesNotClosable=!1},onListStyleContextMenu:function(t,e,i){if(this.toolbar.mode.canEditStyles){var n=this.toolbar.styleMenu,o=this.api,s=!0,a=!0,l=(_.each(window.styles.get_MergedStyles(),function(t){o.asc_IsStyleDefault(t.get_Name())?o.asc_IsDefaultStyleChanged(t.get_Name())&&(a=!1):s=!1}),n.items[3].setDisabled(a),n.items[4].setDisabled(s),this.toolbar.$el.offset()),r=i.clientY*Common.Utils.zoom();if($("#header-container").is(":visible")&&(r-=$("#header-container").height()),i=[i.clientX*Common.Utils.zoom(),r-l.top],null!=e){var r=this.api.asc_IsStyleDefault(e.get("title"));for(h in n.items[0].setVisible(!0),n.items[1].setVisible(!r),n.items[2].setVisible(r),n.items[3].setVisible(r),n.items[4].setVisible(!r),n.items[2].setDisabled(!this.api.asc_IsDefaultStyleChanged(e.get("title"))),n.items)n.items[h].styleTitle=e.get("title");var c=o.getSelectedElements(),d=!1;if(c&&_.isArray(c))for(var h=0;h<c.length;h++)if(Asc.c_oAscTypeSelectElement.Paragraph==c[h].get_ObjectType()){d=!0;break}n.items[0].setDisabled(!d)}else n.items[0].setVisible(!1),n.items[1].setVisible(!1),n.items[2].setVisible(!1),n.items[3].setVisible(!0),n.items[4].setVisible(!0);null!=i&&(l=this.toolbar.$el.find("#menu-style-container"),n.rendered||(l.length<1&&(l=$('<div id="menu-style-container" style="position: absolute; z-index: 10000;"><div class="dropdown-toggle" data-toggle="dropdown"></div></div>',n.id),$(this.toolbar.el).append(l)),n.render(l),n.cmpEl.attr({tabindex:"-1"})),l.css({left:i[0],top:i[1]}),(r=$(n.el)).trigger($.Event("show.bs.dropdown")),r.trigger($.Event("hide.bs.dropdown")),n.isVisible()&&$(n).toggleClass("open").trigger("shown.bs.dropdown"),this.toolbar.listStyles.isStylesNotClosable=!0,n.show())}},onSaveStyle:function(n){window.styles_loaded=!1;var e,i,o=this;o.api&&(e=[],i=o.getApplication().getController("Main"),_.each(window.styles.get_MergedStyles(),function(t){e.push({value:t,displayValue:i.translationTable[t.get_Name()]||t.get_Name()})}),new DE.Views.StyleTitleDialog({handler:function(t,e){var i;"ok"==e&&(e=t.getTitle(),t=t.getNextStyle(),i=n.get_Link(),o._state.prstyle=e,n.put_Name(e),i.put_Name(e+"_character"),n.put_Next(t?t.asc_getName():null),o.api.asc_AddNewStyle(n)),Common.NotificationCenter.trigger("edit:complete",o.toolbar)},formats:e}).show()),Common.component.Analytics.trackEvent("ToolBar","Save as Style")},onMenuSaveStyle:function(t,e){this.api&&!this.toolbar.listStylesAdditionalMenuItem.isDisabled()&&this.onSaveStyle(this.api.asc_GetStyleFromFormatting())},onUpdateStyle:function(t){this.api&&(t.put_Name(this._state.prstyle),this.api.asc_AddNewStyle(t))},_getApiTextSize:function(){var t=12,e=this.api.get_TextProps();return t=e&&e.get_TextPr?e.get_TextPr().get_FontSize():t},onAutoFontColor:function(t){this._state.clrtext=this._state.clrtext_asccolor=void 0;var e=new Asc.asc_CColor;e.put_auto(!0),this.api.put_TextColor(e),this.toolbar.btnFontColor.currentColor={color:e,isAuto:!0},this.toolbar.mnuFontColorPicker.currentColor={color:e,isAuto:!0}},onSelectHighlightColor:function(t,e){this._setMarkerColor(e,"menu")},onSelectFontColor:function(t,e){this._state.clrtext=this._state.clrtext_asccolor=void 0,this.toolbar.btnFontColor.currentColor=e,this.toolbar.btnFontColor.setColor("object"==typeof e?e.isAuto?"000":e.color:e),this.toolbar.mnuFontColorPicker.currentColor=e,this.api&&this.api.put_TextColor(e.isAuto?e.color:Common.Utils.ThemeColor.getRgbColor(e)),Common.component.Analytics.trackEvent("ToolBar","Text Color")},onParagraphColorPickerSelect:function(t,e){this._state.clrback=this._state.clrshd_asccolor=void 0,this.toolbar.btnParagraphColor.currentColor=e,this.toolbar.btnParagraphColor.setColor(e),this.toolbar.mnuParagraphColorPicker.currentColor=e,this.api&&("transparent"==e?this.api.put_ParagraphShade(!1):this.api.put_ParagraphShade(!0,Common.Utils.ThemeColor.getRgbColor(e))),Common.NotificationCenter.trigger("edit:complete",this)},onSelectPageColor:function(t,e){this.api&&this.api.asc_putPageColor(Common.Utils.ThemeColor.getRgbColor(e)),Common.component.Analytics.trackEvent("ToolBar","Page Color")},onPageNoFillClick:function(t){this.api&&t.checked&&this.api.asc_putPageColor(null),Common.component.Analytics.trackEvent("ToolBar","Page Color")},eyedropperStart:function(){this.toolbar.btnCopyStyle.pressed&&(this.toolbar.btnCopyStyle.toggle(!1,!0),this.api.SetPaintFormat(AscCommon.c_oAscFormatPainterState.kOff),this.modeAlwaysSetStyle=!1),this.toolbar.btnHighlightColor.pressed&&this.toolbar.btnHighlightColor.toggle(!1,!0)},onEyedropperStart:function(t){this.toolbar._isEyedropperStart=!0,this.api.asc_startEyedropper(_.bind(t.eyedropperEnd,t))},onEyedropperEnd:function(){this.toolbar._isEyedropperStart=!1},onBtnHighlightColor:function(t){t.pressed?(this._setMarkerColor(t.currentColor),Common.component.Analytics.trackEvent("ToolBar","Highlight Color")):this.api.SetMarkerFormat(!1)},onBtnFontColor:function(){this.toolbar.mnuFontColorPicker.trigger("select",this.toolbar.mnuFontColorPicker,this.toolbar.mnuFontColorPicker.currentColor)},onBtnParagraphColor:function(){this.toolbar.mnuParagraphColorPicker.trigger("select",this.toolbar.mnuParagraphColorPicker,this.toolbar.mnuParagraphColorPicker.currentColor)},onHighlightTransparentClick:function(t,e){this._setMarkerColor("transparent","menu")},onParagraphColor:function(t){var e,i=this.toolbar.mnuParagraphColorPicker,n=typeof(e=null!=t&&t.get_Value()===Asc.c_oAscShdClear&&(n=t.get_Color())?n.get_type()==Asc.c_oAscColor.COLOR_TYPE_SCHEME?{color:Common.Utils.ThemeColor.getHexColor(n.get_r(),n.get_g(),n.get_b()),effectValue:n.get_value()}:Common.Utils.ThemeColor.getHexColor(n.get_r(),n.get_g(),n.get_b()):"transparent");if(n!=typeof this._state.clrback||"object"==n&&(e.effectValue!==this._state.clrback.effectValue||this._state.clrback.color.indexOf(e.color)<0)||"object"!=n&&this._state.clrback.indexOf(e)<0){if("object"==typeof e){for(var o=!1,s=0;s<10;s++)if(Common.Utils.ThemeColor.ThemeValues[s]==e.effectValue){i.select(e,!0),o=!0;break}o||i.clearSelection()}else i.select(e,!0);this._state.clrback=e}this._state.clrshd_asccolor=t},onApiTextColor:function(t){if(t.get_auto())"auto"!==this._state.clrtext&&(this.toolbar.btnFontColor.setAutoColor(!0),this.toolbar.mnuFontColorPicker.clearSelection(),this._state.clrtext="auto");else{var e,i=this.toolbar.mnuFontColorPicker,n=typeof(e=t?t.get_type()==Asc.c_oAscColor.COLOR_TYPE_SCHEME?{color:Common.Utils.ThemeColor.getHexColor(t.get_r(),t.get_g(),t.get_b()),effectValue:t.get_value()}:Common.Utils.ThemeColor.getHexColor(t.get_r(),t.get_g(),t.get_b()):e),o=typeof this._state.clrtext;if("auto"==this._state.clrtext||n!=o||"object"==n&&(e.effectValue!==this._state.clrtext.effectValue||this._state.clrtext.color.indexOf(e.color)<0)||"object"!=n&&this._state.clrtext.indexOf(e)<0){if(this.toolbar.btnFontColor.setAutoColor(!1),"object"==typeof e){for(var s=!1,a=0;a<10;a++)if(Common.Utils.ThemeColor.ThemeValues[a]==e.effectValue){i.select(e,!0),s=!0;break}s||i.clearSelection()}else i.select(e,!0);this._state.clrtext=e}}this._state.clrtext_asccolor=t},onApiAutoShapes:function(){function e(t){i.fillAutoShapes(),t.off("show:before",e)}var i=this;i.toolbar.btnInsertShape.menu.on("show:before",e)},fillAutoShapes:function(){var o=this,t=new Common.UI.MenuItem({template:_.template('<div id="id-toolbar-menu-insertshape" class="menu-insertshape"></div>')}),t=(o.toolbar.btnInsertShape.menu.addItem(t),Common.localStorage.getItem("de-recent-shapes"));new Common.UI.DataViewShape({el:$("#id-toolbar-menu-insertshape"),itemTemplate:_.template('<div class="item-shape" id="<%= id %>"><svg width="20" height="20" class="icon uni-scale"><use xlink:href="#svg-icon-<%= data.shapeType %>"></use></svg></div>'),groups:o.getApplication().getCollection("ShapeGroups"),parentMenu:o.toolbar.btnInsertShape.menu,restoreHeight:652,textRecentlyUsed:o.textRecentlyUsed,recentShapes:t?JSON.parse(t):null}).on("item:click",function(t,e,i,n){o.api&&(i&&(o._addAutoshape(!0,i.get("data").shapeType),o._isAddingShape=!0),o.toolbar.btnInsertText.pressed&&o.toolbar.btnInsertText.toggle(!1,!0),"click"!==n.type&&o.toolbar.btnInsertShape.menu.hide(),Common.NotificationCenter.trigger("edit:complete",o.toolbar,o.toolbar.btnInsertShape),Common.component.Analytics.trackEvent("ToolBar","Add Shape"))})},fillEquations:function(){if(this.toolbar.btnInsertEquation.rendered&&!(0<this.toolbar.btnInsertEquation.menu.items.length)){var o=this,i=this.getApplication().getCollection("EquationGroups"),n=(o.toolbar.btnInsertEquation.menu.removeAll(),function(t){for(var e=0;e<i.length;++e)new Common.UI.DataViewSimple({el:$("#id-toolbar-menu-equationgroup"+e,t.items[e].$el),parentMenu:t.items[e].menu,store:i.at(e).get("groupStore"),scrollAlwaysVisible:!0,itemTemplate:_.template('<div class="item-equation" style="" ><div class="equation-icon" style="background-position:<%= posX %>px <%= posY %>px;width:<%= width %>px;height:<%= height %>px;" id="<%= id %>"></div></div>')}).on("item:click",function(t,e,i,n){o.api&&(i&&o.api.asc_AddMath(i.get("data").equationType),o.toolbar.btnInsertText.pressed&&o.toolbar.btnInsertText.toggle(!1,!0),o.toolbar.btnInsertShape.pressed&&o.toolbar.btnInsertShape.toggle(!1,!0),"click"!==n.type&&o.toolbar.btnInsertEquation.menu.hide(),Common.NotificationCenter.trigger("edit:complete",o.toolbar,o.toolbar.btnInsertEquation),Common.component.Analytics.trackEvent("ToolBar","Add Equation"))});t.off("show:after",n)});o.toolbar.btnInsertEquation.menu.on("show:after",n);for(var t=0;t<i.length;++t){var e=i.at(t),e=new Common.UI.MenuItem({caption:e.get("groupName"),menu:new Common.UI.Menu({menuAlign:"tl-tr",items:[{template:_.template('<div id="id-toolbar-menu-equationgroup'+t+'" class="menu-shape margin-left-5" style="width:'+(e.get("groupWidth")+8)+"px; "+e.get("groupHeightStr")+'"></div>')}]})});o.toolbar.btnInsertEquation.menu.addItem(e)}}},onInsertEquationClick:function(){this.api&&!this._state.in_equation&&(this.api.asc_AddMath(),Common.component.Analytics.trackEvent("ToolBar","Add Equation")),Common.NotificationCenter.trigger("edit:complete",this.toolbar,this.toolbar.btnInsertEquation)},onInsertSymbolClick:function(){var n,t;this.dlgSymbolTable&&this.dlgSymbolTable.isVisible()||this.api&&(t=(n=this).api.asc_GetSelectedText(),n.dlgSymbolTable=new Common.Views.SymbolTableDialog({api:n.api,lang:n.mode.lang,modal:!1,type:1,special:!0,showShortcutKey:!0,font:t&&0<t.length?this.api.get_TextProps().get_TextPr().get_FontFamily().get_Name():void 0,symbol:t&&0<t.length?t.charAt(0):void 0,buttons:[{value:"ok",caption:this.textInsert},"close"],handler:function(t,e,i){"ok"==e?n.insertSymbol(i.font,i.code,i.special,i.speccharacter):Common.NotificationCenter.trigger("edit:complete",n.toolbar)}}),n.dlgSymbolTable.show(),n.dlgSymbolTable.on("symbol:dblclick",function(t,e,i){n.insertSymbol(i.font,i.code,i.special,i.speccharacter)}),n.dlgSymbolTable.on("close",function(t){Common.NotificationCenter.trigger("edit:complete",n.toolbar)}))},onInsertSymbolItemClick:function(t,e,i,n){this.api&&i&&this.insertSymbol(i.get("font"),i.get("symbol"),i.get("special"))},insertSymbol:function(t,e,i,n){t=t||this.api.get_TextProps().get_TextPr().get_FontFamily().get_Name();this.api.asc_insertSymbol(t,e,i),n||this.toolbar.saveSymbol(e,t)},onApiMathTypes:function(t){this._equationTemp=t;function e(t){i.onMathTypes(i._equationTemp),i._equationTemp&&0<i._equationTemp.get_Data().length&&i.fillEquations(),i.toolbar.btnInsertEquation.menu.off("show:before",e)}var i=this;i.toolbar.btnInsertEquation.menu.on("show:before",e)},onMathTypes:function(t){t=t||this._equationTemp;var e=[],i=this.getCollection("EquationGroups");if(!(0<i.length)){var n={},o=(n[Common.define.c_oAscMathMainType.Symbol]=[this.textSymbols,11,!1,"svg-icon-symbols"],n[Common.define.c_oAscMathMainType.Fraction]=[this.textFraction,4,!1,"svg-icon-fraction"],n[Common.define.c_oAscMathMainType.Script]=[this.textScript,4,!1,"svg-icon-script"],n[Common.define.c_oAscMathMainType.Radical]=[this.textRadical,4,!1,"svg-icon-radical"],n[Common.define.c_oAscMathMainType.Integral]=[this.textIntegral,3,!0,"svg-icon-integral"],n[Common.define.c_oAscMathMainType.LargeOperator]=[this.textLargeOperator,5,!0,"svg-icon-largeOperator"],n[Common.define.c_oAscMathMainType.Bracket]=[this.textBracket,4,!0,"svg-icon-bracket"],n[Common.define.c_oAscMathMainType.Function]=[this.textFunction,3,!0,"svg-icon-function"],n[Common.define.c_oAscMathMainType.Accent]=[this.textAccent,4,!1,"svg-icon-accent"],n[Common.define.c_oAscMathMainType.LimitLog]=[this.textLimitAndLog,3,!1,"svg-icon-limAndLog"],n[Common.define.c_oAscMathMainType.Operator]=[this.textOperator,4,!1,"svg-icon-operator"],n[Common.define.c_oAscMathMainType.Matrix]=[this.textMatrix,4,!0,"svg-icon-matrix"],{}),s="",a="";for(s in Common.define.c_oAscMathType)Common.define.c_oAscMathType.hasOwnProperty(s)&&(a=2==(b=s.split("_")).length&&"Symbol"==b[0]?"txt"+b[0]+"_"+b[1].toLocaleLowerCase():"txt"+s,o[Common.define.c_oAscMathType[s]]=this[a]);var l,r,c=null,d=null,h=null;if(t&&(l=(r=t.get_Data()).length)){for(var m=0;m<l;++m){var p=r[m],u=p.get_Id();if(w=p.get_W(),y=p.get_H(),c=new Backbone.Collection([],{model:DE.Models.EquationModel})){for(var g,b=[],C=p.get_Data().length,f=0;f<C;++f){for(var v=(d=p.get_Data()[f]).get_Data().length,_=0;_<v;++_)g=(h=d.get_Data()[_]).get_Id(),a="",o.hasOwnProperty(g)&&(a=o[g]),b.push({data:{equationType:g},tip:a,allowSelected:!0,selected:!1,width:d.get_W(),height:d.get_H(),posX:-h.get_X(),posY:-h.get_Y()});0}c.add(b);var w=n[u][1]*(w+10),y=parseInt(370/(y+10))*(y+10);e.push({groupName:n[u][0],groupStore:c,groupWidth:w,groupHeight:y,groupHeightStr:n[u][2]?" height:"+y+"px!important; ":"",groupIcon:n[u][3]})}}i.add(e)}}},activateControls:function(){this.toolbar.lockToolbar(Common.enumLock.disableOnStart,!1),this.toolbar.lockToolbar(Common.enumLock.undoLock,!0!==this._state.can_undo,{array:[this.toolbar.btnUndo]}),this.toolbar.lockToolbar(Common.enumLock.redoLock,!0!==this._state.can_redo,{array:[this.toolbar.btnRedo]}),this.toolbar.lockToolbar(Common.enumLock.copyLock,!0!==this._state.can_copycut,{array:[this.toolbar.btnCopy,this.toolbar.btnCut]}),this.toolbar.lockToolbar(Common.enumLock.mmergeLock,!!this._state.mmdisable,{array:[this.toolbar.btnMailRecepients]}),this._state.mmdisable||this.toolbar.mnuMailRecepients.items[2].setVisible(this.toolbar.mode.fileChoiceUrl||this.toolbar.mode.canRequestSelectSpreadsheet||this.toolbar.mode.canRequestMailMergeRecipients),this._state.activated=!0;var t=this.api.asc_GetSectionProps();this.onApiPageSize(t.get_W(),t.get_H())},DisableMailMerge:function(){this._state.mmdisable=!0,this.toolbar&&this.toolbar.btnMailRecepients&&this.toolbar.lockToolbar(Common.enumLock.mmergeLock,!0,{array:[this.toolbar.btnMailRecepients]})},updateThemeColors:function(){function t(t,e){if(t){for(var i,n=Common.Utils.ThemeColor.getEffectColors(),o=0;o<n.length;o++)"object"==typeof t.currentColor&&void 0===i&&t.currentColor.effectId==n[o].effectId&&(i=n[o]);t.updateColors(n,Common.Utils.ThemeColor.getStandartColors()),void 0===t.currentColor?t.currentColor=n[e]:void 0!==i&&(t.currentColor=i)}}t(this.toolbar.mnuFontColorPicker,1),void 0!==this.toolbar.btnFontColor.currentColor&&this.toolbar.btnFontColor.currentColor.isAuto||(this.toolbar.btnFontColor.currentColor=this.toolbar.mnuFontColorPicker.currentColor.color||this.toolbar.mnuFontColorPicker.currentColor,this.toolbar.btnFontColor.setColor(this.toolbar.btnFontColor.currentColor)),void 0!==this._state.clrtext_asccolor&&(this._state.clrtext=void 0,this.onApiTextColor(this._state.clrtext_asccolor)),this._state.clrtext_asccolor=void 0,t(this.toolbar.mnuParagraphColorPicker,0),this.toolbar.btnParagraphColor.currentColor=this.toolbar.mnuParagraphColorPicker.currentColor.color||this.toolbar.mnuParagraphColorPicker.currentColor,this.toolbar.btnParagraphColor.setColor(this.toolbar.btnParagraphColor.currentColor),void 0!==this._state.clrshd_asccolor&&(this._state.clrback=void 0,this.onParagraphColor(this._state.clrshd_asccolor)),this._state.clrshd_asccolor=void 0,t(this.toolbar.mnuPageColorPicker,1)},_onInitEditorStyles:function(t){window.styles_loaded=!1;var e,i,n,o=this.toolbar.listStyles;window.styles=t,o?(e=[],i=this.getApplication().getController("Main"),_.each(t.get_MergedStyles(),function(t){e.push({imageUrl:t.asc_getImage(),title:t.get_Name(),tip:i.translationTable[t.get_Name()]||t.get_Name(),id:Common.UI.getId()})}),o.menuPicker.store.reset(e),0<o.menuPicker.store.length&&o.rendered?(this._state.prstyle&&(n=o.menuPicker.store.findWhere({title:this._state.prstyle})),o.fillComboView(n||o.menuPicker.store.at(0),!0),Common.NotificationCenter.trigger("edit:complete",this)):o.rendered&&o.clearComboView(),window.styles_loaded=!0):this.styles=t},onHomeOpen:function(){var t,e=this.toolbar.listStyles;e&&e.needFillComboView&&0<e.menuPicker.store.length&&e.rendered&&(this._state.prstyle&&(t=e.menuPicker.store.findWhere({title:this._state.prstyle})),e.fillComboView(t||e.menuPicker.store.at(0),!0))},_setMarkerColor:function(t,e){var i,n=this;"menu"===e&&(n._state.clrhighlight=void 0,n.onApiHighlightColor(),n.toolbar.btnHighlightColor.currentColor=t,n.toolbar.btnHighlightColor.setColor(n.toolbar.btnHighlightColor.currentColor),n.toolbar.btnHighlightColor.toggle(!0,!0)),"transparent"==(t=t||"transparent")?n.api.SetMarkerFormat(!0,!1):(e=t[0]+t[1],i=t[2]+t[3],t=t[4]+t[5],n.api.SetMarkerFormat(!0,!0,parseInt(e,16),parseInt(i,16),parseInt(t,16))),Common.NotificationCenter.trigger("edit:complete",n.toolbar,n.toolbar.btnHighlightColor),Common.component.Analytics.trackEvent("ToolBar","Highlight Color")},onHideMenus:function(t){Common.NotificationCenter.trigger("edit:complete",this.toolbar)},onSetupCopyStyleButton:function(){this.modeAlwaysSetStyle=!1;var t=this;Common.NotificationCenter.on({"edit:complete":function(){t.api&&t.modeAlwaysSetStyle&&(t.api.SetPaintFormat(AscCommon.c_oAscFormatPainterState.kOff),t.toolbar.btnCopyStyle.toggle(!1,!0),t.modeAlwaysSetStyle=!1)}}),$(t.toolbar.btnCopyStyle.cmpEl).dblclick(function(){t.api&&(t.modeAlwaysSetStyle=!0,t.toolbar.btnCopyStyle.toggle(!0,!0),t.api.SetPaintFormat(AscCommon.c_oAscFormatPainterState.kMultiple))})},onApiCoAuthoringDisconnect:function(t){this.mode.isEdit&&this.toolbar.setMode({isDisconnected:!0,enableDownload:!!t}),this.editMode=!1,this.DisableToolbar(!0,!0)},DisableToolbar:function(t,e,i,n){void 0!==e&&(this.editMode=!e),t=t||!this.editMode;var o,e=$(".toolbar-mask"),s=$(".toolbar-group-mask"),a=i||n?s:e;t&&0<a.length||!t&&0==a.length||((o=this.toolbar).hideMoreBtns(),i?o.lockToolbar(Common.enumLock.previewReviewMode,t):n&&o.lockToolbar(Common.enumLock.viewFormMode,t),t?a=(i||n?$("<div class='toolbar-group-mask'>"):$("<div class='toolbar-mask'>")).appendTo(o.$el.find(".toolbar")):a.remove(),o.$el.find(".toolbar").toggleClass("masked",0<$(".toolbar-mask").length),t=t||(i||n?0<e.length:0<s.length),o.synchTooltip&&o.synchTooltip.hide(),o._state.previewmode=i&&t,i&&(o._state.previewmode&&o.btnSave&&o.btnSave.setDisabled(!0),o.needShowSynchTip&&(o.needShowSynchTip=!1,o.onCollaborativeChanges())),a=Common.Utils.isMac?"command+alt+a":"alt+h",t?Common.util.Shortcuts.suspendEvents(a):Common.util.Shortcuts.resumeEvents(a))},onSelectRecepientsClick:function(t,e,i){var n;this._mailMergeDlg||(n=this,"file"===e.value?this.api&&this.api.asc_StartMailMerge():"url"===e.value?new Common.Views.ImageFromUrlDialog({title:n.dataUrl,handler:function(t,e){"ok"==t&&(n.api&&(t=e.replace(/ /g,""),_.isEmpty(t)?Common.UI.warning({msg:n.textEmptyMMergeUrl}):n.api.asc_StartMailMerge({fileType:"csv",url:t})),Common.NotificationCenter.trigger("edit:complete",n.toolbar))}}).show():"storage"===e.value&&Common.NotificationCenter.trigger("storage:spreadsheet-load","mailmerge"))},setMailMergeRecipients:function(t){t&&(t.c="mailmerge"),this.setRequestedSpreadsheet(t)},openSpreadsheetFromStorage:function(i){var n=this;this.toolbar.mode.canRequestSelectSpreadsheet?Common.Gateway.requestSelectSpreadsheet(i):this.toolbar.mode.canRequestMailMergeRecipients?Common.Gateway.requestMailMergeRecipients():(n._mailMergeDlg=new Common.Views.SelectFileDlg({fileChoiceUrl:this.toolbar.mode.fileChoiceUrl.replace("{fileExt}","xlsx").replace("{documentType}","")}),n._mailMergeDlg.on("selectfile",function(t,e){e&&(e.c=i),n.setRequestedSpreadsheet(e)}).on("close",function(t){n._mailMergeDlg=void 0}),n._mailMergeDlg.show())},setRequestedSpreadsheet:function(t){Common.NotificationCenter.trigger("storage:spreadsheet-insert",t)},insertSpreadsheetFromStorage:function(t){t&&"mailmerge"===t.c&&(this.api.asc_StartMailMerge(t),this.mergeEditor||(this.mergeEditor=this.getApplication().getController("Common.Controllers.ExternalMergeEditor").getView("Common.Views.ExternalMergeEditor")),this.mergeEditor&&this.mergeEditor.setEditMode(!1))},createDelayedElements:function(){this.toolbar.createDelayedElements(),this.attachUIEvents(this.toolbar),this.onChangeProtectDocument(),Common.Utils.injectSvgIcons()},onAppShowed:function(t){var e,i,n=this,o=!(t.isEdit||t.isRestrictedEdit&&t.canFillForms&&t.isFormCreator),s=((t.isEdit||t.isRestrictedEdit&&t.canFillForms&&t.isFormCreator)&&(Common.localStorage.itemExists("de-compact-toolbar")?o=Common.localStorage.getBool("de-compact-toolbar"):t.customization&&t.customization.compactToolbar&&(o=!0)),n.toolbar.render(_.extend({isCompactView:o},t)),log.debug("工具栏显示","controller/Toolbar/onAppShowed",Date.now()-window.__start),t.canReview&&(e={action:"review",caption:n.toolbar.textTabCollaboration,dataHintTitle:"U",layoutname:"toolbar-collaboration"},(i=n.application.getController("Common.Controllers.ReviewChanges").createToolbarPanel())&&(n.toolbar.addTab(e,i,6),n.toolbar.setVisible("review",(t.isEdit||t.canCoAuthoring&&t.canComments)&&Common.UI.LayoutManager.isElementVisible("toolbar-collaboration")))),t.isEdit&&(n.toolbar.setMode(t),n.toolbar.btnSave.on("disabled",_.bind(n.onBtnChangeState,n,"save:disabled")),t.customization&&t.customization.compactHeader||(n.toolbar.btnPrint.$el.parents(".group").hide().next().hide(),s=n.toolbar.btnUndo.$el.hide().next().hide().parent(),n.toolbar.btnPaste.$el.detach().appendTo(s),n.toolbar.btnPaste.$el.find("button").attr("data-hint-direction","bottom"),n.toolbar.btnCopy.$el.removeClass("split"),n.toolbar.processPanelVisible(null,!0,!0)),(s=n.getApplication().getController("Common.Controllers.Draw")).setApi(n.api).setMode(t),(i=s.createToolbarPanel())&&(e={action:"draw",caption:n.toolbar.textTabDraw,extcls:"canedit",layoutname:"toolbar-draw",dataHintTitle:"C"},n.toolbar.addTab(e,i,2),n.toolbar.setVisible("draw",Common.UI.LayoutManager.isElementVisible("toolbar-draw")),Array.prototype.push.apply(n.toolbar.lockControls,s.getView().getButtons()),Array.prototype.push.apply(n.toolbar.paragraphControls,s.getView().getButtons())),t.canProtect&&(e={action:"protect",caption:n.toolbar.textTabProtect,layoutname:"toolbar-protect",dataHintTitle:"T"},(i=n.getApplication().getController("Common.Controllers.Protection").createToolbarPanel())&&((t.isSignatureSupport||t.isPasswordSupport)&&i.append($('<div class="separator long"></div>')),s=n.getApplication().getController("DocProtection"),i.append(s.createToolbarPanel()),n.toolbar.addTab(e,i,7),n.toolbar.setVisible("protect",Common.UI.LayoutManager.isElementVisible("toolbar-protect")),Array.prototype.push.apply(n.toolbar.lockControls,s.getView("DocProtection").getButtons()))),(s=n.getApplication().getController("Links")).setApi(n.api).setConfig({toolbar:n}),Array.prototype.push.apply(n.toolbar.lockControls,s.getView("Links").getButtons())),(t.isEdit&&t.canFeatureContentControl&&t.canFeatureForms||t.isRestrictedEdit&&t.canFillForms)&&t.isFormCreator&&(e={caption:n.textTabForms,action:"forms",dataHintTitle:"M"},(s=n.getApplication().getController("FormsTab")).setApi(n.api).setConfig({toolbar:n,config:t}),(i=s.createToolbarPanel())&&(n.toolbar.addTab(e,i,5),n.toolbar.setVisible("forms",!0),t.isEdit&&t.canFeatureContentControl&&t.canFeatureForms&&Array.prototype.push.apply(n.toolbar.lockControls,s.getView("FormsTab").getButtons()),!o&&(t.isFormCreator||t.isRestrictedEdit&&t.canFillForms)&&n.toolbar.setTab("forms"))),t.isEdit&&t.canFeatureContentControl&&n.onChangeSdtGlobalSettings(),e={caption:n.toolbar.textTabView,action:"view",extcls:t.isEdit?"canedit":"",layoutname:"toolbar-view",dataHintTitle:"W"},n.getApplication().getController("ViewTab"));s.setApi(n.api).setConfig({toolbar:n,mode:t}),(i=s.createToolbarPanel())&&(n.toolbar.addTab(e,i,8),n.toolbar.setVisible("view",Common.UI.LayoutManager.isElementVisible("toolbar-view")))},onAppReady:function(t){var e,i=this,n=(i.appOptions=t).lang?t.lang.toLowerCase():"en";"zh"===n.split(/[\-_]/)[0]&&"zh-tw"!==n&&"zh_tw"!==n&&(i._state.type_fontsize="string"),this.btnsComment=[],t.canCoAuthoring&&t.canComments&&(this.btnsComment=Common.Utils.injectButtons(this.toolbar.$el.find(".slot-comment"),"tlbtn-addcomment-","toolbar__icon btn-big-menu-comments",this.toolbar.capBtnComment,[Common.enumLock.paragraphLock,Common.enumLock.headerLock,Common.enumLock.richEditLock,Common.enumLock.plainEditLock,Common.enumLock.richDelLock,Common.enumLock.plainDelLock,Common.enumLock.cantAddQuotedComment,Common.enumLock.imageLock,Common.enumLock.inSpecificForm,Common.enumLock.inImage,Common.enumLock.lostConnect,Common.enumLock.disableOnStart,Common.enumLock.previewReviewMode,Common.enumLock.viewFormMode,Common.enumLock.docLockView,Common.enumLock.docLockForms],void 0,void 0,void 0,"1","bottom"),this.btnsComment.length&&(e=DE.getController("Common.Controllers.Comments").getView(),this.btnsComment.forEach(function(t){t.updateHint(e.textHintAddComment),t.on("click",function(t,e){Common.NotificationCenter.trigger("app:comment:add","toolbar")}),0<t.cmpEl.closest("#review-changes-panel").length&&t.setCaption(i.toolbar.capBtnAddComment)},this)),Array.prototype.push.apply(this.toolbar.paragraphControls,this.btnsComment),Array.prototype.push.apply(this.toolbar.lockControls,this.btnsComment)),new Promise(function(t){t()}).then(function(){t.isEdit&&(i.controllers.pageLayout=new DE.Controllers.PageLayout({id:"ImageLayout",application:i.getApplication()}),i.controllers.pageLayout.onLaunch(i.toolbar).setApi(i.api).onAppReady(t))})},getView:function(t){return t?Backbone.Controller.prototype.getView.apply(this,arguments):this.toolbar},onFileMenu:function(t){"show"==t?this.toolbar.isTabActive("file")||this.toolbar.setTab("file"):this.toolbar.isTabActive("file")&&this.toolbar.setTab()},onTextLanguage:function(t){this._state.lang=t},onInsDateTimeClick:function(){var i=this;new DE.Views.DateTimeDialog({api:this.api,lang:this._state.lang,handler:function(t,e){"ok"==t&&i.api&&i.api.asc_addDateTime(e),Common.NotificationCenter.trigger("edit:complete",i.toolbar)}}).show()},generateSmartArt:function(t){this.api.asc_generateSmartArtPreviews(t)},onApiBeginSmartArtPreview:function(){this.smartArtGroups=this.toolbar.btnInsertSmartArt.menu.items,this.smartArtData=Common.define.smartArt.getSmartArtData()},onApiAddSmartArtPreview:function(t){t.forEach(_.bind(function(t){var e=t.asc_getImage(),t=t.asc_getSectionId(),i=_.findWhere(this.smartArtData,{sectionId:t}),i=_.findWhere(i.items,{type:e.asc_getName()}),t=_.findWhere(this.smartArtGroups,{value:t}),n=t.menuPicker;i&&(i=[{tip:i.tip,value:i.type,imageUrl:e.asc_getImage()}],n.store.length<1?n.store.reset(i):n.store.add(i)),this.currentSmartArtMenu=t},this))},onApiEndSmartArtPreview:function(){this.currentSmartArtMenu&&this.currentSmartArtMenu.menu.alignPosition()},onInsertSmartArt:function(t){this.api&&this.api.asc_createSmartArt(t)},onChangeProtectDocument:function(t){var e;(t=t?t:(e=this.getApplication().getController("DocProtection"))?e.getDocProps():null)&&(this._state.docProtection=t,this.toolbar.lockToolbar(Common.enumLock.docLockView,t.isReadOnly),this.toolbar.lockToolbar(Common.enumLock.docLockForms,t.isFormsOnly),this.toolbar.lockToolbar(Common.enumLock.docLockReview,t.isReviewOnly),this.toolbar.lockToolbar(Common.enumLock.docLockComments,t.isCommentsOnly))}},DE.Controllers.Toolbar||{}))}),define("text!documenteditor/main/app/template/StatusBar.template",[],function(){return'\n<div class="statusbar" style="display:table;">\n    <div class="status-group dropup">\n        <label id="label-pages" class="status-label dropdown-toggle margin-top-large" data-toggle="dropdown" data-hint="0" data-hint-direction="top"><%= textPageNumber %></label>\n        <div id="status-goto-box" class="dropdown-menu">\n            <label class="float-left"><%= textGotoPage %></label>\n            <div id="status-goto-page" style="display:inline-block;"></div>\n        </div>\n    </div>\n    <div class="separator short"></div>\n    <div class="status-group">\n        <div id="slot-status-btn-info" style="display: inline-block;" class="margin-top-small"></div>\n    </div>\n    <div class="status-group" style="width:100%; text-align:center;">\n        <label id="label-action" class="status-label margin-top-large" data-layout-name="statusBar-actionStatus"></label>\n    </div>\n    <div class="status-group" style="">\n        \x3c!-- <div class="separator short el-edit"></div>\n        <span id="btn-cnt-lang" class="el-edit margin-top-small" data-layout-name="statusBar-textLang"></span>\n        <span id="btn-doc-lang" class="el-edit margin-top-small" data-layout-name="statusBar-docLang"></span>\n        <div class="separator short el-edit space"></div>\n        <span id="btn-doc-spell" class="el-edit margin-top-small"></span>\n        <div class="separator short el-edit el-lang"></div> --\x3e\n        <div id="btn-doc-review" class="el-edit el-review margin-top-small" style="display: inline-block;"></div>\n        <div class="separator short el-edit el-review"></div>\n        <div class="separator short hide-select-tools"></div>\n        <button id="status-btn-select-tool" type="button" class="btn small btn-toolbar hide-select-tools margin-top-small" data-hint="0" data-hint-direction="top" data-hint-offset="small"><i class="icon toolbar__icon btn-select-tool">&nbsp;</i></button>\n        <button id="status-btn-hand-tool" type="button" class="btn small btn-toolbar hide-select-tools margin-top-small" data-hint="0" data-hint-direction="top" data-hint-offset="small"><i class="icon toolbar__icon btn-hand-tool">&nbsp;</i></button>\n        <div class="separator short hide-select-tools"></div>\n        <button id="btn-zoom-topage" type="button" class="btn small btn-toolbar margin-top-small" data-hint="0" data-hint-direction="top" data-hint-offset="small"><i class="icon toolbar__icon btn-ic-zoomtopage">&nbsp;</i></button>\n        <button id="btn-zoom-towidth" type="button" class="btn small btn-toolbar margin-top-small" data-hint="0" data-hint-direction="top" data-hint-offset="small"><i class="icon toolbar__icon btn-ic-zoomtowidth">&nbsp;</i></button>\n        <button id="btn-zoom-down" type="button" class="btn small btn-toolbar margin-top-small"><i class="icon toolbar__icon btn-zoomdown">&nbsp;</i></button>\n        <div class="cnt-zoom">\n            <div class="dropdown-toggle" data-toggle="dropdown" data-hint="0" data-hint-direction="top">\n                <label id="label-zoom" class="status-label">Zoom 100%</label>\n            </div>\n        </div>\n        <button id="btn-zoom-up" type="button" class="btn small btn-toolbar margin-top-small"><i class="icon toolbar__icon btn-zoomup">&nbsp;</i></button>\n    </div>\n</div>\n'}),define("documenteditor/main/app/model/Pages",["underscore","backbone"],function(t,e){"use strict";DE.Models=DE.Models||{},DE.Models.Pages=e.Model.extend({defaults:{current:0,count:0}})}),define("documenteditor/main/app/view/Statusbar",["text!documenteditor/main/app/template/StatusBar.template","jquery","underscore","backbone","tip","common/main/lib/component/Menu","common/main/lib/component/Window","documenteditor/main/app/model/Pages"],function(t,n,s,e){"use strict";function i(t){this.pages.set("count",t)}function o(t){this.pages.set("current",t+1)}s.template("Page <%= current %> of <%= count %>");function a(t,e,i){n(".statusbar #label-pages",this.$el).text(Common.Utils.String.format(this.pageIndexText,t.get("current"),t.get("count")))}function l(t,e){this.langMenu.prevTip=e.value.value,this.btnLanguage.setCaption(e.caption),this.fireEvent("langchanged",[this,e.value.code,e.caption])}DE.Views.Statusbar=e.View.extend(s.extend({el:"#statusbar",template:s.template(t),events:{},api:void 0,pages:void 0,initialize:function(t){s.extend(this,t),this.pages=new DE.Models.Pages({current:1,count:1}),this.pages.on("change",s.bind(a,this)),this._state={docProtection:{isReadOnly:!1,isReviewOnly:!1,isFormsOnly:!1,isCommentsOnly:!1}},this._isDisabled=!1;var e=this,t=(this.$layout=n(this.template({textGotoPage:this.goToPageText,textPageNumber:Common.Utils.String.format(this.pageIndexText,1,1)})),this.btnSelectTool=new Common.UI.Button({hintAnchor:"top",toggleGroup:"select-tools",enableToggle:!0,allowDepress:!1}),this.btnHandTool=new Common.UI.Button({hintAnchor:"top",toggleGroup:"select-tools",enableToggle:!0,allowDepress:!1}),this.btnZoomToPage=new Common.UI.Button({hintAnchor:"top",toggleGroup:"status-zoom",enableToggle:!0}),this.btnZoomToWidth=new Common.UI.Button({hintAnchor:"top",toggleGroup:"status-zoom",enableToggle:!0}),this.cntZoom=new Common.UI.Button({hintAnchor:"top"}),this.btnZoomDown=new Common.UI.Button({hintAnchor:"top"}),this.btnZoomUp=new Common.UI.Button({hintAnchor:"top-right"}),this.btnLanguage=new Common.UI.Button({cls:"btn-toolbar",scaling:!1,caption:"English (United States)",hintAnchor:"top-left",disabled:!0,dataHint:"0",dataHintDirection:"top",menu:!0}),this.langMenu=new Common.UI.MenuSimple({cls:"lang-menu",style:"margin-top:-5px;",restoreHeight:285,itemTemplate:s.template(['<a id="<%= id %>" tabindex="-1" type="menuitem" langval="<%= value.value %>" class="<% if (checked) { %> checked <% } %>">','<i class="icon <% if (spellcheck) { %> toolbar__icon btn-ic-docspell spellcheck-lang <% } %>"></i>',"<%= caption %>","</a>"].join("")),menuAlign:"bl-tl",search:!0,focusToCheckedItem:!0}),this.zoomMenu=new Common.UI.Menu({style:"margin-top:-5px;",menuAlign:"bl-tl",items:[{caption:"50%",value:50},{caption:"75%",value:75},{caption:"100%",value:100},{caption:"125%",value:125},{caption:"150%",value:150},{caption:"175%",value:175},{caption:"200%",value:200},{caption:"300%",value:300},{caption:"400%",value:400},{caption:"500%",value:500}]}),this.txtGoToPage=new Common.UI.InputField({allowBlank:!0,validateOnChange:!0,style:"width: 60px;",maskExp:/[0-9]/,validation:function(t){return!!(/(^[0-9]+$)/.test(t)&&void 0!==(t=parseInt(t))&&0<t&&t<=e.pages.get("count"))||e.txtPageNumInvalid}}),s.template('<div style="display: flex;padding: 5px 20px;line-height: 16px;"><div style="flex-grow: 1;"><%= caption %></div><div class="margin-left-20 text-align-right" style="word-break: normal; min-width: 35px;"><%= options.value%></div></div>')),i=(this.btnDocInfo=new Common.UI.Button({cls:"btn-toolbar no-caret",caption:this.txtWordCount,iconCls:"toolbar__icon btn-word-count",hintAnchor:"top-left",dataHint:"0",dataHintDirection:"top",menu:new Common.UI.Menu({style:"margin-top:-5px;",menuAlign:"bl-tl",itemTemplate:t,items:[{caption:this.txtPages,value:0},{caption:this.txtParagraphs,value:0},{caption:this.txtWords,value:0},{caption:this.txtSymbols,value:0},{caption:this.txtSpaces,value:0}]})}),new Promise(function(t,e){t()}));Common.NotificationCenter.on("app:ready",function(t){i.then(function(t){var o=this;o.btnZoomToPage.updateHint(o.tipFitPage),o.btnZoomToWidth.updateHint(o.tipFitWidth),o.btnZoomDown.updateHint(o.tipZoomOut+Common.Utils.String.platformKey("Ctrl+-")),o.btnZoomUp.updateHint(o.tipZoomIn+Common.Utils.String.platformKey("Ctrl++")),t.canUseSelectHandTools&&(o.btnSelectTool.updateHint(o.tipSelectTool),o.btnHandTool.updateHint(o.tipHandTool)),o.btnLanguage&&o.btnLanguage.cmpEl&&(o.btnLanguage.updateHint(o.tipSetLang),o.langMenu.on("item:click",s.bind(l,this))),o.cntZoom.updateHint(o.tipZoomFactor),o.cntZoom.cmpEl.on({"show.bs.dropdown":function(){s.defer(function(){o.cntZoom.cmpEl.find("ul").focus()},100)},"hide.bs.dropdown":function(){s.defer(function(){o.api.asc_enableKeyEvents(!0)},100)}}),o.txtGoToPage.on({"keypress:after":function(t,e){var i,n;if(e.keyCode===Common.UI.Keys.RETURN)return i=(e=o.$el.find("#status-goto-box")).find("input[type=text]"),!(n=parseInt(i.val()))||n-- >o.pages.get("count")||n<0?i.select():(e.focus(),e.parent().removeClass("open"),o.api.goToPage(n),o.api.asc_enableKeyEvents(!0)),!1},"keyup:after":function(t,e){if(e.keyCode===Common.UI.Keys.ESC)return(e=o.$el.find("#status-goto-box")).focus(),e.parent().removeClass("open"),o.api.asc_enableKeyEvents(!0),!1}}),(t=o.$el.find("#status-goto-box")).on("click",function(){return!1}),t.parent().on({"show.bs.dropdown":function(){o.txtGoToPage.setValue(o.api.getCurrentPage()+1),o.txtGoToPage.checkValidate();var t=o.txtGoToPage.$el.find("input");s.defer(function(){t.focus().select()},100)},"hide.bs.dropdown":function(){var t=o.$el.find("#status-goto-box");o.api&&t&&(t.focus(),t.parent().removeClass("open"),o.api.asc_enableKeyEvents(!0))}}),o.zoomMenu.on("item:click",function(t,e){o.fireEvent("zoom:value",[e.value])}),o.btnDocInfo.menu.on("show:after",s.bind(this.onDocInfoShow,this)),o.onChangeProtectDocument()}.bind(this,t))}.bind(this))},render:function(t){var e=this;function i(t,e){t.setElement(e,!1),t.render()}return this.fireEvent("render:before",[this.$layout]),i(e.btnZoomToPage,n("#btn-zoom-topage",e.$layout)),i(e.btnZoomToWidth,n("#btn-zoom-towidth",e.$layout)),i(e.cntZoom,n(".cnt-zoom",e.$layout)),i(e.btnZoomDown,n("#btn-zoom-down",e.$layout)),i(e.btnZoomUp,n("#btn-zoom-up",e.$layout)),i(e.txtGoToPage,n("#status-goto-page",e.$layout)),t&&!t.isEdit||(e.btnLanguage.render(n("#btn-cnt-lang",e.$layout)),e.btnLanguage.setMenu(e.langMenu),e.langMenu.prevTip="en"),e.btnDocInfo.render(n("#slot-status-btn-info",e.$layout)),t.canUseSelectHandTools&&(i(e.btnSelectTool,n("#status-btn-select-tool",e.$layout)),i(e.btnHandTool,n("#status-btn-hand-tool",e.$layout))),e.zoomMenu.render(n(".cnt-zoom",e.$layout)),e.zoomMenu.cmpEl.attr({tabindex:-1}),this.$el.html(e.$layout),this.fireEvent("render:after",[this]),this},setApi:function(t){return this.api=t,this.api&&(this.api.asc_registerCallback("asc_onCountPages",s.bind(i,this)),this.api.asc_registerCallback("asc_onCurrentPage",s.bind(o,this)),this.api.asc_registerCallback("asc_onGetDocInfoStart",s.bind(this.onGetDocInfoStart,this)),this.api.asc_registerCallback("asc_onGetDocInfoStop",s.bind(this.onGetDocInfoEnd,this)),this.api.asc_registerCallback("asc_onDocInfo",s.bind(this.onDocInfo,this)),this.api.asc_registerCallback("asc_onGetDocInfoEnd",s.bind(this.onGetDocInfoEnd,this)),this.api.asc_registerCallback("asc_onCoAuthoringDisconnect",s.bind(this.onApiCoAuthoringDisconnect,this)),Common.NotificationCenter.on("api:disconnect",s.bind(this.onApiCoAuthoringDisconnect,this)),Common.NotificationCenter.on("protect:doclock",s.bind(this.onChangeProtectDocument,this))),this},setMode:function(t){this.mode=t},setVisible:function(t){t?this.show():this.hide()},isVisible:function(){return this.$el&&this.$el.is(":visible")},reloadLanguages:function(t){var e=[],i=this.langMenu.saved;s.each(t,function(t){e.push({caption:t.displayValue,value:{value:t.value,code:t.code},checkable:!0,checked:i==t.displayValue,spellcheck:t.spellcheck})}),this.langMenu.resetItems(e),0<this.langMenu.items.length&&(t=this._state.docProtection.isReadOnly||this._state.docProtection.isFormsOnly||this._state.docProtection.isCommentsOnly,this.btnLanguage.setDisabled(this._isDisabled||!!this.mode.isDisconnected||t))},setLanguage:function(e){var t;this.langMenu.prevTip!=e.value&&void 0!==e.code&&(this.btnLanguage.setCaption(e.displayValue),this.langMenu.prevTip=e.value,(t=s.find(this.langMenu.items,function(t){return t.caption==e.displayValue}))?this.langMenu.setChecked(this.langMenu.items.indexOf(t),!0):(this.langMenu.saved=e.displayValue,this.langMenu.clearAll()))},getStatusLabel:function(){return n(".statusbar #label-action")},showStatusMessage:function(t){this.getStatusLabel().text(t)},clearStatusMessage:function(){this.getStatusLabel().text("")},SetDisabled:function(t){this._isDisabled=t;var e=this._state.docProtection.isReadOnly||this._state.docProtection.isFormsOnly||this._state.docProtection.isCommentsOnly;this.btnLanguage.setDisabled(t||this.langMenu.items.length<1||e),this.btnTurnReview&&this.btnTurnReview.setDisabled(t||e)},onChangeProtectDocument:function(t){var e;(t=t?t:(e=DE.getController("DocProtection"))?e.getDocProps():null)&&(this._state.docProtection=t,this.SetDisabled(this._isDisabled))},onDocInfoShow:function(){this.api&&this.api.startGetDocInfo()},onGetDocInfoStart:function(){this.infoObj={PageCount:0,WordsCount:0,ParagraphCount:0,SymbolsCount:0,SymbolsWSCount:0}},onDocInfo:function(t){var e;t&&this.btnDocInfo&&this.btnDocInfo.menu&&(-1<t.get_PageCount()&&(this.btnDocInfo.menu.items[0].options.value=t.get_PageCount()),-1<t.get_ParagraphCount()&&(this.btnDocInfo.menu.items[1].options.value=t.get_ParagraphCount()),-1<t.get_WordsCount()&&(this.btnDocInfo.menu.items[2].options.value=t.get_WordsCount()),-1<t.get_SymbolsCount()&&(this.btnDocInfo.menu.items[3].options.value=t.get_SymbolsCount()),-1<t.get_SymbolsWSCount()&&(this.btnDocInfo.menu.items[4].options.value=t.get_SymbolsWSCount()),this.timerDocInfo||((e=this).timerDocInfo=setInterval(function(){e.fillDocInfo()},300),this.fillDocInfo()))},onGetDocInfoEnd:function(){clearInterval(this.timerDocInfo),this.timerDocInfo=void 0,this.fillDocInfo()},fillDocInfo:function(){this.btnDocInfo&&this.btnDocInfo.menu&&this.btnDocInfo.menu.isVisible()&&this.btnDocInfo.menu.items.forEach(function(t){n(t.el).html(t.template({id:t.id,caption:t.caption,options:t.options}))})},onApiCoAuthoringDisconnect:function(){this.setMode({isDisconnected:!0}),this.SetDisabled(!0)}},DE.Views.Statusbar||{}))}),void 0===window.Common&&(window.Common={}),Common.util=Common.util||{},Common.util.LanguageInfo=new function(){var i={54:["af","Afrikaans"],1078:["af-ZA","Afrikaans (Suid Afrika)","Afrikaans (South Africa)"],28:["sq","Shqipe"],1052:["sq-AL","Shqipe (Shqipëria)","Albanian (Albania)"],132:["gsw","Elsässisch"],1156:["gsw-FR","Elsässisch (Frànkrisch)","Alsatian (France)"],94:["am","አማርኛ"],1118:["am-ET","አማርኛ (ኢትዮጵያ)","Amharic (Ethiopia)"],1:["ar","العربية‏"],5121:["ar-DZ","العربية (الجزائر)‏","Arabic (Algeria)"],15361:["ar-BH","العربية (البحرين)‏","Arabic (Bahrain)"],3073:["ar-EG","العربية (مصر)‏","Arabic (Egypt)"],2049:["ar-IQ","العربية (العراق)‏","Arabic (Iraq)"],11265:["ar-JO","العربية (الأردن)‏","Arabic (Jordan)"],13313:["ar-KW","العربية (الكويت)‏","Arabic (Kuwait)"],12289:["ar-LB","العربية (لبنان)‏","Arabic (Lebanon)"],4097:["ar-LY","العربية (ليبيا)‏","Arabic (Libya)"],6145:["ar-MA","العربية (المملكة المغربية)‏","Arabic (Morocco)"],8193:["ar-OM","العربية (عمان)‏","Arabic (Oman)"],16385:["ar-QA","العربية (قطر)‏","Arabic (Qatar)"],1025:["ar-SA","العربية (المملكة العربية السعودية)‏","Arabic (Saudi Arabia)"],10241:["ar-SY","العربية (سوريا)‏","Arabic (Syria)"],7169:["ar-TN","العربية (تونس)‏","Arabic (Tunisia)"],14337:["ar-AE","العربية (الإمارات العربية المتحدة)‏","Arabic (U.A.E.)"],9217:["ar-YE","العربية (اليمن)‏","Arabic (Yemen)"],43:["hy","Հայերեն"],1067:["hy-AM","Հայերեն (Հայաստան)","Armenian (Armenia)"],77:["as","অসমীয়া"],1101:["as-IN","অসমীয়া (ভাৰত)","Assamese (India)"],44:["az","Azərbaycan­ılı"],29740:["az-Cyrl","Азәрбајҹан дили"],2092:["az-Cyrl-AZ","Азәрбајҹан (Азәрбајҹан)","Azeri (Cyrillic, Azerbaijan)"],30764:["az-Latn","Azərbaycan­ılı"],1068:["az-Latn-AZ","Azərbaycan­ılı (Azərbaycan)","Azeri (Latin, Azerbaijan)"],109:["ba","Башҡорт"],1133:["ba-RU","Башҡорт (Россия)","Bashkir (Russia)"],45:["eu","Euskara"],1069:["eu-ES","Euskara (Euskara)","Basque (Basque)"],35:["be","Беларускі"],1059:["be-BY","Беларускі (Беларусь)","Belarusian (Belarus)"],69:["bn","বাংলা"],2117:["bn-BD","বাংলা (বাংলাদেশ)","Bengali (Bangladesh)"],1093:["bn-IN","বাংলা (ভারত)","Bengali (India)"],30746:["bs","bosanski"],25626:["bs-Cyrl","Босански (Ћирилица)"],8218:["bs-Cyrl-BA","Босански (Босна и Херцеговина)","Bosnian (Cyrillic) (Bosnia and Herzegovina)"],26650:["bs-Latn","Bosanski (Latinica)"],5146:["bs-Latn-BA","Bosanski (Bosna i Hercegovina)","Bosnian (Latin) (Bosnia and Herzegovina)"],126:["br","Brezhoneg"],1150:["br-FR","Brezhoneg (Frañs)","Breton (France)"],2:["bg","Български"],1026:["bg-BG","Български (България)","Bulgarian (Bulgaria)"],3:["ca","Català"],1027:["ca-ES","Català (Català)","Catalan (Catalan)"],2051:["ca-ES-valencia","Català (Valencià)","Catalan (Valencia)"],30724:["zh","中文"],4:["zh-Hans","中文(简体)","Chinese (Simplified)"],2052:["zh-CN","中文(中华人民共和国)","Chinese (People's Republic of China)"],4100:["zh-SG","中文(新加坡)","Chinese (Simplified, Singapore)"],31748:["zh-Hant","中文(繁體)","Chinese (Traditional)"],3076:["zh-HK","中文(香港特別行政區)","Chinese (Traditional, Hong Kong S.A.R.)"],5124:["zh-MO","中文(澳門特別行政區)","Chinese (Traditional, Macao S.A.R.)"],1028:["zh-TW","中文(台灣)","Chinese (Traditional, Taiwan)"],131:["co","Corsu"],1155:["co-FR","Corsu (France)","Corsican (France)"],26:["hr","Hrvatski"],1050:["hr-HR","Hrvatski (Hrvatska)","Croatian (Croatia)"],4122:["hr-BA","Hrvatski (Bosna i Hercegovina)","Croatian (Bosnia and Herzegovina)"],5:["cs","Čeština"],1029:["cs-CZ","Čeština (Česká republika)","Czech (Czech Republic)"],6:["da","Dansk"],1030:["da-DK","Dansk (Danmark)","Danish (Denmark)"],140:["prs","درى‏"],1164:["prs-AF","درى (افغانستان)‏","Dari (Afghanistan)"],101:["dv","ދިވެހިބަސް‏"],1125:["dv-MV","ދިވެހިބަސް (ދިވެހި ރާއްޖެ)‏","Divehi (Maldives)"],19:["nl","Nederlands"],2067:["nl-BE","Nederlands (België)","Dutch (Belgium)"],1043:["nl-NL","Nederlands (Nederland)","Dutch (Netherlands)"],9:["en","English"],3081:["en-AU","English (Australia)","English (Australia)"],10249:["en-BZ","English (Belize)","English (Belize)"],4105:["en-CA","English (Canada)","English (Canada)"],9225:["en-029","English (Caribbean)","English (Caribbean)"],16393:["en-IN","English (India)","English (India)"],6153:["en-IE","English (Ireland)","English (Ireland)"],8201:["en-JM","English (Jamaica)","English (Jamaica)"],17417:["en-MY","English (Malaysia)","English (Malaysia)"],5129:["en-NZ","English (New Zealand)","English (New Zealand)"],13321:["en-PH","English (Philippines)","English (Philippines)"],18441:["en-SG","English (Singapore)","English (Singapore)"],7177:["en-ZA","English (South Africa)","English (South Africa)"],11273:["en-TT","English (Trinidad y Tobago)","English (Trinidad y Tobago)"],2057:["en-GB","English (United Kingdom)","English (United Kingdom)"],1033:["en-US","English (United States)","English (United States)"],12297:["en-ZW","English (Zimbabwe)","English (Zimbabwe)"],15369:["en-HK","English (Hong Kong)","English (Hong Kong)"],14345:["en-ID","English (Indonesia)","English (Indonesia)"],37:["et","Eesti"],1061:["et-EE","Eesti (Eesti)","Estonian (Estonia)"],56:["fo","Føroyskt"],1080:["fo-FO","Føroyskt (Føroyar)","Faroese (Faroe Islands)"],100:["fil","Filipino"],1124:["fil-PH","Filipino (Pilipinas)","Filipino (Philippines)"],11:["fi","Suomi"],1035:["fi-FI","Suomi (Suomi)","Finnish (Finland)"],12:["fr","Français"],2060:["fr-BE","Français (Belgique)","French (Belgium)"],3084:["fr-CA","Français (Canada)","French (Canada)"],1036:["fr-FR","Français (France)","French (France)"],5132:["fr-LU","Français (Luxembourg)","French (Luxembourg)"],6156:["fr-MC","Français (Principauté de Monaco)","French (Principality of Monaco)"],4108:["fr-CH","Français (Suisse)","French (Switzerland)"],15372:["fr-HT","Français (Haïti)","French (Haiti)"],9228:["fr-CG","Français (Congo-Brazzaville)","French (Congo)"],12300:["fr-CI","Français (Côte d’Ivoire)","French (Cote d'Ivoire)"],11276:["fr-CM","Français (Cameroun)","French (Cameroon)"],14348:["fr-MA","Français (Maroc)","French (Morocco)"],13324:["fr-ML","Français (Mali)","French (Mali)"],8204:["fr-RE","Français (La Réunion)","French (Reunion)"],10252:["fr-SN","Français (Sénégal)","French (Senegal)"],7180:["fr-West","French"],98:["fy","Frysk"],1122:["fy-NL","Frysk (Nederlân)","Frisian (Netherlands)"],86:["gl","Galego"],1110:["gl-ES","Galego (Galego)","Galician (Galician)"],55:["ka","ქართული"],1079:["ka-GE","ქართული (საქართველო)","Georgian (Georgia)"],7:["de","Deutsch"],3079:["de-AT","Deutsch (Österreich)","German (Austria)"],1031:["de-DE","Deutsch (Deutschland)","German (Germany)"],5127:["de-LI","Deutsch (Liechtenstein)","German (Liechtenstein)"],4103:["de-LU","Deutsch (Luxemburg)","German (Luxembourg)"],2055:["de-CH","Deutsch (Schweiz)","German (Switzerland)"],8:["el","Ελληνικά"],1032:["el-GR","Ελληνικά (Ελλάδα)","Greek (Greece)"],111:["kl","Kalaallisut"],1135:["kl-GL","Kalaallisut (Kalaallit Nunaat)","Greenlandic (Greenland)"],71:["gu","ગુજરાતી"],1095:["gu-IN","ગુજરાતી (ભારત)","Gujarati (India)"],104:["ha","Hausa"],31848:["ha-Latn","Hausa (Latin)"],1128:["ha-Latn-NG","Hausa (Nigeria)","Hausa (Latin) (Nigeria)"],13:["he","עברית‏"],1037:["he-IL","עברית (ישראל)‏","Hebrew (Israel)"],57:["hi","हिंदी"],1081:["hi-IN","हिंदी (भारत)","Hindi (India)"],14:["hu","Magyar"],1038:["hu-HU","Magyar (Magyarország)","Hungarian (Hungary)"],15:["is","Íslenska"],1039:["is-IS","Íslenska (Ísland)","Icelandic (Iceland)"],112:["ig","Igbo"],1136:["ig-NG","Igbo (Nigeria)","Igbo (Nigeria)"],33:["id","Bahasa Indonesia"],1057:["id-ID","Bahasa Indonesia (Indonesia)","Indonesian (Indonesia)"],93:["iu","Inuktitut"],31837:["iu-Latn","Inuktitut (Qaliujaaqpait)"],2141:["iu-Latn-CA","Inuktitut (Kanatami) (kanata)","Inuktitut (Latin) (Canada)"],30813:["iu-Cans","ᐃᓄᒃᑎᑐᑦ (ᖃᓂᐅᔮᖅᐸᐃᑦ)"],1117:["iu-Cans-CA","ᐃᓄᒃᑎᑐᑦ (ᑲᓇᑕᒥ)","Inuktitut (Canada)"],60:["ga","Gaeilge"],2108:["ga-IE","Gaeilge (Éire)","Irish (Ireland)"],52:["xh","isiXhosa"],1076:["xh-ZA","isiXhosa (uMzantsi Afrika)","isiXhosa (South Africa)"],53:["zu","isiZulu"],1077:["zu-ZA","isiZulu (iNingizimu Afrika)","isiZulu (South Africa)"],16:["it","Italiano"],1040:["it-IT","Italiano (Italia)","Italian (Italy)"],2064:["it-CH","Italiano (Svizzera)","Italian (Switzerland)"],17:["ja","日本語"],1041:["ja-JP","日本語 (日本)","Japanese (Japan)"],75:["kn","ಕನ್ನಡ"],1099:["kn-IN","ಕನ್ನಡ (ಭಾರತ)","Kannada (India)"],63:["kk","Қазақ"],1087:["kk-KZ","Қазақ (Қазақстан)","Kazakh (Kazakhstan)"],83:["km","ខ្មែរ"],1107:["km-KH","ខ្មែរ (កម្ពុជា)","Khmer (Cambodia)"],134:["qut","K'iche"],1158:["qut-GT","K'iche (Guatemala)","K'iche (Guatemala)"],135:["rw","Kinyarwanda"],1159:["rw-RW","Kinyarwanda (Rwanda)","Kinyarwanda (Rwanda)"],65:["sw","Kiswahili"],1089:["sw-KE","Kiswahili (Kenya)","Kiswahili (Kenya)"],87:["kok","कोंकणी"],1111:["kok-IN","कोंकणी (भारत)","Konkani (India)"],18:["ko","한국어"],1042:["ko-KR","한국어 (대한민국)","Korean (Korea)"],64:["ky","Кыргыз"],1088:["ky-KG","Кыргыз (Кыргызстан)","Kyrgyz (Kyrgyzstan)"],84:["lo","ລາວ"],1108:["lo-LA","ລາວ (ສ.ປ.ປ. ລາວ)","Lao (Lao P.D.R.)"],38:["lv","Latviešu"],1062:["lv-LV","Latviešu (Latvija)","Latvian (Latvia)"],39:["lt","Lietuvių"],1063:["lt-LT","Lietuvių (Lietuva)","Lithuanian (Lithuania)"],31790:["dsb","Dolnoserbšćina"],2094:["dsb-DE","Dolnoserbšćina (Nimska)","Lower Sorbian (Germany)"],110:["lb","Lëtzebuergesch"],1134:["lb-LU","Lëtzebuergesch (Luxembourg)","Luxembourgish (Luxembourg)"],1071:["mk-MK","Македонски јазик (Македонија)","Macedonian (Former Yugoslav Republic of Macedonia)"],47:["mk","Македонски јазик"],62:["ms","Bahasa Melayu"],2110:["ms-BN","Bahasa Melayu (Brunei Darussalam)","Malay (Brunei Darussalam)"],1086:["ms-MY","Bahasa Melayu (Malaysia)","Malay (Malaysia)"],76:["ml","മലയാളം"],1100:["ml-IN","മലയാളം (ഭാരതം)","Malayalam (India)"],58:["mt","Malti"],1082:["mt-MT","Malti (Malta)","Maltese (Malta)"],129:["mi","Reo Māori"],1153:["mi-NZ","Reo Māori (Aotearoa)","Maori (New Zealand)"],122:["arn","Mapudungun"],1146:["arn-CL","Mapudungun (Chile)","Mapudungun (Chile)"],78:["mr","मराठी"],1102:["mr-IN","मराठी (भारत)","Marathi (India)"],124:["moh","Kanien'kéha"],1148:["moh-CA","Kanien'kéha (Canada)","Mohawk (Canada)"],80:["mn","Монгол хэл"],30800:["mn-Cyrl","Монгол хэл"],1104:["mn-MN","Монгол хэл (Монгол улс)","Mongolian (Cyrillic, Mongolia)"],31824:["mn-Mong","ᠮᠤᠨᠭᠭᠤᠯ ᠬᠡᠯᠡ"],2128:["mn-Mong-CN","ᠮᠤᠨᠭᠭᠤᠯ ᠬᠡᠯᠡ (ᠪᠦᠭᠦᠳᠡ ᠨᠠᠢᠷᠠᠮᠳᠠᠬᠤ ᠳᠤᠮᠳᠠᠳᠤ ᠠᠷᠠᠳ ᠣᠯᠣᠰ)","Mongolian (Traditional Mongolian) (People's Republic of China)"],97:["ne","नेपाली"],1121:["ne-NP","नेपाली (नेपाल)","Nepali (Nepal)"],2145:["ne-IN","नेपाली (भारत)","Nepali (India)"],20:["no","Norsk"],31764:["nb","Norsk (bokmål)"],1044:["nb-NO","Norsk, bokmål (Norge)","Norwegian, Bokmål (Norway)"],30740:["nn","Norsk (Nynorsk)"],2068:["nn-NO","Norsk, nynorsk (Noreg)","Norwegian, Nynorsk (Norway)"],130:["oc","Occitan"],1154:["oc-FR","Occitan (França)","Occitan (France)"],72:["or","ଓଡ଼ିଆ"],1096:["or-IN","ଓଡ଼ିଆ (ଭାରତ)","Oriya (India)"],99:["ps","پښتو‏"],1123:["ps-AF","پښتو (افغانستان)‏","Pashto (Afghanistan)"],41:["fa","فارسى‏"],1065:["fa-IR","فارسى (ایران)‏","Persian (Iran)"],21:["pl","Polski"],1045:["pl-PL","Polski (Polska)","Polish (Poland)"],22:["pt","Português"],1046:["pt-BR","Português (Brasil)","Portuguese (Brazil)"],2070:["pt-PT","Português (Portugal)","Portuguese (Portugal)"],70:["pa","ਪੰਜਾਬੀ"],1094:["pa-IN","ਪੰਜਾਬੀ (ਭਾਰਤ)","Punjabi (India)"],107:["quz","Runasimi"],1131:["quz-BO","Runasimi (Qullasuyu)","Quechua (Bolivia)"],2155:["quz-EC","Runasimi (Ecuador)","Quechua (Ecuador)"],3179:["quz-PE","Runasimi (Piruw)","Quechua (Peru)"],24:["ro","Română"],1048:["ro-RO","Română (România)","Romanian (Romania)"],2072:["ro-MD","Română (Moldova)","Romanian (Republic of Moldova)"],23:["rm","Rumantsch"],1047:["rm-CH","Rumantsch (Svizra)","Romansh (Switzerland)"],25:["ru","Русский"],1049:["ru-RU","Русский (Россия)","Russian (Russia)"],2073:["ru-MD","Русский (Молдавия)","Russian (Republic of Moldova)"],28731:["smn","Sämikielâ"],9275:["smn-FI","Sämikielâ (Suomâ)","Sami (Inari) (Finland)"],31803:["smj","Julevusámegiella"],4155:["smj-NO","Julevusámegiella (Vuodna)","Sami (Lule) (Norway)"],5179:["smj-SE","Julevusámegiella (Svierik)","Sami (Lule) (Sweden)"],59:["se","Davvisámegiella"],3131:["se-FI","Davvisámegiella (Suopma)","Sami (Northern) (Finland)"],1083:["se-NO","Davvisámegiella (Norga)","Sami (Northern) (Norway)"],2107:["se-SE","Davvisámegiella (Ruoŧŧa)","Sami (Northern) (Sweden)"],29755:["sms","Sääm´ǩiõll"],8251:["sms-FI","Sääm´ǩiõll (Lää´ddjânnam)","Sami (Skolt) (Finland)"],30779:["sma","åarjelsaemiengiele"],6203:["sma-NO","åarjelsaemiengiele (Nöörje)","Sami (Southern) (Norway)"],7227:["sma-SE","åarjelsaemiengiele (Sveerje)","Sami (Southern) (Sweden)"],79:["sa","संस्कृत"],1103:["sa-IN","संस्कृत (भारतम्)","Sanskrit (India)"],145:["gd","Gàidhlig"],1169:["gd-GB","Gàidhlig (An Rìoghachd Aonaichte)","Scottish Gaelic (United Kingdom)"],31770:["sr","Srpski"],27674:["sr-Cyrl","Српски (Ћирилица)"],7194:["sr-Cyrl-BA","Српски (Босна и Херцеговина)","Serbian (Cyrillic) (Bosnia and Herzegovina)"],12314:["sr-Cyrl-ME","Српски (Црна Гора)","Serbian (Cyrillic, Montenegro)"],3098:["sr-Cyrl-CS","Српски (Србија и Црна Гора (Претходно))","Serbian (Cyrillic, Serbia and Montenegro (Former))"],10266:["sr-Cyrl-RS","Српски (Србија)","Serbian (Cyrillic, Serbia)"],28698:["sr-Latn","Srpski (Latinica)"],6170:["sr-Latn-BA","Srpski (Bosna i Hercegovina)","Serbian (Latin, Bosnia and Herzegovina)"],11290:["sr-Latn-ME","Srpski (Crna Gora)","Serbian (Latin, Montenegro)"],2074:["sr-Latn-CS","Srpski (Srbija i Crna Gora (Prethodno))","Serbian (Latin, Serbia and Montenegro (Former))"],9242:["sr-Latn-RS","Srpski (Srbija, Latinica)","Serbian (Latin, Serbia)"],108:["nso","Sesotho sa Leboa"],1132:["nso-ZA","Sesotho sa Leboa (Afrika Borwa)","Sesotho sa Leboa (South Africa)"],50:["tn","Setswana"],1074:["tn-ZA","Setswana (Aforika Borwa)","Setswana (South Africa)"],91:["si","සිංහ"],1115:["si-LK","සිංහල (ශ්‍රී ලංකාව)","Sinhala (Sri Lanka)"],27:["sk","Slovenčina"],1051:["sk-SK","Slovenčina (Slovenská republika)","Slovak (Slovakia)"],36:["sl","Slovenski"],1060:["sl-SI","Slovenski (Slovenija)","Slovenian (Slovenia)"],10:["es","Español"],11274:["es-AR","Español (Argentina)","Spanish (Argentina)"],16394:["es-BO","Español (Bolivia)","Spanish (Bolivia)"],13322:["es-CL","Español (Chile)","Spanish (Chile)"],9226:["es-CO","Español (Colombia)","Spanish (Colombia)"],5130:["es-CR","Español (Costa Rica)","Spanish (Costa Rica)"],7178:["es-DO","Español (República Dominicana)","Spanish (Dominican Republic)"],12298:["es-EC","Español (Ecuador)","Spanish (Ecuador)"],17418:["es-SV","Español (El Salvador)","Spanish (El Salvador)"],4106:["es-GT","Español (Guatemala)","Spanish (Guatemala)"],18442:["es-HN","Español (Honduras)","Spanish (Honduras)"],2058:["es-MX","Español (México)","Spanish (Mexico)"],19466:["es-NI","Español (Nicaragua)","Spanish (Nicaragua)"],6154:["es-PA","Español (Panamá)","Spanish (Panama)"],15370:["es-PY","Español (Paraguay)","Spanish (Paraguay)"],10250:["es-PE","Español (Perú)","Spanish (Peru)"],20490:["es-PR","Español (Puerto Rico)","Spanish (Puerto Rico)"],3082:["es-ES","Español (España, alfabetización internacional)","Spanish (Spain)"],21514:["es-US","Español (Estados Unidos)","Spanish (United States)"],14346:["es-UY","Español (Uruguay)","Spanish (Uruguay)"],8202:["es-VE","Español (Republica Bolivariana de Venezuela)","Spanish (Venezuela)"],1034:["es-ES_tradnl","Spanish"],22538:["es-419","Español (América Latina y el Caribe)","Spanish (Latin America and the Caribbean)"],23562:["es-CU","Español (Cuba)","Spanish (Cuba)"],29:["sv","Svenska"],2077:["sv-FI","Svenska (Finland)","Swedish (Finland)"],1053:["sv-SE","Svenska (Sverige)","Swedish (Sweden)"],90:["syr","ܣܘܪܝܝܐ‏"],1114:["syr-SY","ܣܘܪܝܝܐ (سوريا)‏","Syriac (Syria)"],40:["tg","Тоҷикӣ"],31784:["tg-Cyrl","Тоҷикӣ"],1064:["tg-Cyrl-TJ","Тоҷикӣ (Тоҷикистон)","Tajik (Cyrillic) (Tajikistan)"],95:["tzm","Tamazight"],31839:["tzm-Latn","Tamazight (Latin)"],2143:["tzm-Latn-DZ","Tamazight (Djazaïr)","Tamazight (Latin) (Algeria)"],73:["ta","தமிழ்"],1097:["ta-IN","தமிழ் (இந்தியா)","Tamil (India)"],68:["tt","Татар"],1092:["tt-RU","Татар (Россия)","Tatar (Russia)"],74:["te","తెలుగు"],1098:["te-IN","తెలుగు (భారత దేశం)","Telugu (India)"],30:["th","ไทย"],1054:["th-TH","ไทย (ไทย)","Thai (Thailand)"],81:["bo","བོད་ཡིག"],1105:["bo-CN","བོད་ཡིག (ཀྲུང་ཧྭ་མི་དམངས་སྤྱི་མཐུན་རྒྱལ་ཁབ།)","Tibetan (People's Republic of China)"],2129:["bo-BT","Tibetan (Bhutan)","Tibetan (Bhutan)"],31:["tr","Türkçe"],1055:["tr-TR","Türkçe (Türkiye)","Turkish (Turkey)"],66:["tk","Türkmençe"],1090:["tk-TM","Türkmençe (Türkmenistan)","Turkmen (Turkmenistan)"],34:["uk","Українська"],1058:["uk-UA","Українська (Україна)","Ukrainian (Ukraine)"],46:["hsb","Hornjoserbšćina"],1070:["hsb-DE","Hornjoserbšćina (Němska)","Upper Sorbian (Germany)"],32:["ur","اُردو‏"],1056:["ur-PK","اُردو (پاکستان)‏","Urdu (Islamic Republic of Pakistan)"],2080:["ur-IN","اُردو (بھارت)‏","Urdu (India)"],128:["ug","ئۇيغۇر يېزىقى‏"],1152:["ug-CN","(ئۇيغۇر يېزىقى (جۇڭخۇا خەلق جۇمھۇرىيىتى‏","Uighur (People's Republic of China)"],30787:["uz-Cyrl","Ўзбек"],2115:["uz-Cyrl-UZ","Ўзбек (Ўзбекистон)","Uzbek (Cyrillic, Uzbekistan)"],67:["uz","U'zbek"],31811:["uz-Latn","U'zbek"],1091:["uz-Latn-UZ","U'zbek (U'zbekiston Respublikasi)","Uzbek (Latin, Uzbekistan)"],42:["vi","Tiếng Việt"],1066:["vi-VN","Tiếng Việt (Việt Nam)","Vietnamese (Vietnam)"],82:["cy","Cymraeg"],1106:["cy-GB","Cymraeg (y Deyrnas Unedig)","Welsh (United Kingdom)"],136:["wo","Wolof"],1160:["wo-SN","Wolof (Sénégal)","Wolof (Senegal)"],133:["sah","Саха"],1157:["sah-RU","Саха (Россия)","Yakut (Russia)"],120:["ii","ꆈꌠꁱꂷ"],1144:["ii-CN","ꆈꌠꁱꂷ (ꍏꉸꏓꂱꇭꉼꇩ)","Yi (People's Republic of China)"],106:["yo","Yoruba"],1130:["yo-NG","Yoruba (Nigeria)","Yoruba (Nigeria)"],1126:["bin-NG","Bini (Nigeria)","Bini (Nigeria)"],1116:["chr-US","ᏣᎳᎩ (ᏌᏊ ᎢᏳᎾᎵᏍᏔᏅ ᏍᎦᏚᎩ)","Cherokee (United States)"],1127:["fuv-NG","Nigerian Fulfulde (Nigeria)","Nigerian Fulfulde (Nigeria)"],1138:["gaz-ET","West Central Oromo (Ethiopia)","West Central Oromo (Ethiopia)"],1140:["gn-PY","Guarani (Paraguay)","Guarani (Paraguay)"],1141:["haw-US","ʻŌlelo Hawaiʻi (ʻAmelika Hui Pū ʻIa)","Hawaiian (United States)"],1129:["ibb-NG","Ibibio (Nigeria)","Ibibio (Nigeria)"],1137:["kr-NG","Kanuri (Nigeria)","Kanuri (Nigeria)"],1112:["mni","Manipuri","Manipuri"],1109:["my-MM","Burmese (Myanmar)","Burmese (Myanmar)"],1145:["pap-AN","Papiamento, Netherlands Antilles","Papiamento, Netherlands Antilles"],2118:["pa-PK","Panjabi (Pakistan)","Panjabi (Pakistan)"],1165:["plt-MG","Plateau Malagasy (Madagascar)","Plateau Malagasy (Madagascar)"],1113:["sd-IN","Sindhi (India)","Sindhi (India)"],2137:["sd-PK","Sindhi (Pakistan)","Sindhi (Pakistan)"],1143:["so-SO","Soomaali (Soomaaliya)","Somali (Somalia)"],1072:["st-ZA","Southern Sotho (South Africa)","Southern Sotho (South Africa)"],1139:["ti-ER","ትግርኛ (ኤርትራ)","Tigrinya (Eritrea)"],2163:["ti-ET","ትግርኛ (ኢትዮጵያ)","Tigrinya (Ethiopia)"],1119:["tmz","Tamanaku"],3167:["tmz-MA","Tamaziɣt n laṭlaṣ (Meṛṛuk)","Tamanaku (Morocco)"],1073:["ts-ZA","Tsonga (South Africa)","Tsonga (South Africa)"],1075:["ven-ZA","South Africa","South Africa"]};return{getLocalLanguageName:function(t){return i[t]||["",t]},getLocalLanguageCode:function(t){if(t)for(var e in i)if(i[e][0].toLowerCase()===t.toLowerCase())return e;return null},getLanguages:function(){return i}}},define("common/main/lib/util/LanguageInfo",function(){}),define("documenteditor/main/app/controller/Statusbar",["core","documenteditor/main/app/view/Statusbar","common/main/lib/util/LanguageInfo"],function(){"use strict";DE.Controllers.Statusbar=Backbone.Controller.extend(_.extend({models:[],collections:[],views:["Statusbar"],initialize:function(){this.addListeners({Statusbar:{langchanged:this.onLangMenu,"zoom:value":function(t){this.api.zoom(t),Common.NotificationCenter.trigger("edit:complete",this.statusbar)}.bind(this)},ViewTab:{"statusbar:hide":_.bind(this.onChangeCompactView,this)}})},events:function(){return{"click #btn-zoom-down":_.bind(this.zoomDocument,this,"down"),"click #btn-zoom-up":_.bind(this.zoomDocument,this,"up"),"click #btn-zoom-topage":_.bind(this.onBtnZoomTo,this,"topage"),"click #btn-zoom-towidth":_.bind(this.onBtnZoomTo,this,"towidth")}},onLaunch:function(){this.statusbar=this.createView("Statusbar",{});var i=this;Common.NotificationCenter.on("app:face",function(t){i.statusbar.render(t),i.statusbar.$el.css("z-index",1);var e=$(".statusbar #label-zoom");e.css("min-width",80),e.text(Common.Utils.String.format(i.zoomText,100)),t.isEdit?(e=i.getApplication().getController("Common.Controllers.ReviewChanges").getView(),t.canReview?(i.btnTurnReview=e.getButton("turn","statusbar"),i.btnTurnReview.render(i.statusbar.$layout.find("#btn-doc-review")),i.statusbar.btnTurnReview=i.btnTurnReview):i.statusbar.$el.find(".el-review").hide(),i.btnSpelling=e.getButton("spelling","statusbar"),i.btnSpelling.render(i.statusbar.$layout.find("#btn-doc-spell")),i.btnDocLang=e.getButton("doclang","statusbar"),i.btnDocLang.render(i.statusbar.$layout.find("#btn-doc-lang")),e=(Common.UI.LayoutManager.isElementVisible("statusBar-textLang")||Common.UI.LayoutManager.isElementVisible("statusBar-docLang"))&&Common.UI.FeaturesManager.canChange("spellcheck"),i.btnDocLang.$el.find("+.separator.space")[e?"show":"hide"](),e=Common.UI.LayoutManager.isElementVisible("statusBar-textLang")||Common.UI.LayoutManager.isElementVisible("statusBar-docLang")||Common.UI.FeaturesManager.canChange("spellcheck"),i.statusbar.$el.find(".el-lang")[e?"show":"hide"]()):i.statusbar.$el.find(".el-edit, .el-review").hide(),t.canUseSelectHandTools&&i.statusbar.$el.find(".hide-select-tools").removeClass("hide-select-tools")}),Common.NotificationCenter.on("app:ready",i.onAppReady.bind(i))},onAppReady:function(i){var n=this;n._isDocReady=!0,new Promise(function(t){t()}).then(function(){n.bindViewEvents(n.statusbar,n.events),i.canUseSelectHandTools&&(n.statusbar.btnSelectTool.on("click",_.bind(n.onSelectTool,n,"select")),n.statusbar.btnHandTool.on("click",_.bind(n.onSelectTool,n,"hand")),n.statusbar.btnHandTool.toggle(!0,!0),n.api.asc_setViewerTargetType("hand"));var t,e=Common.localStorage.getBool("de-hidden-status");i.canReview&&!e&&(e=n.api.asc_IsTrackRevisions(),void 0===(t=i.customization&&i.customization.review?i.customization.review.trackChanges:void 0)&&(t=i.customization?i.customization.trackChanges:void 0),i.isReviewOnly||!0===t||!1!==t&&e?!Common.localStorage.getBool("de-track-changes-tip")?(n.btnTurnReview.updateHint(""),void 0===n.changesTooltip&&(n.changesTooltip=n.createChangesTip(n.textTrackChanges,"de-track-changes-tip")),n.hideTips(),n.changesTooltip.show()):n.btnTurnReview.updateHint(n.tipReview):e&&(t=!Common.localStorage.getBool("de-new-changes"),n.api.asc_HaveRevisionsChanges()&&t?(n.btnTurnReview.updateHint(""),void 0===n.newChangesTooltip&&(n.newChangesTooltip=n.createChangesTip(n.textHasChanges,"de-new-changes")),n.hideTips(),n.newChangesTooltip.show()):n.btnTurnReview.updateHint(n.tipReview)))})},onChangeCompactView:function(t,e){this.statusbar.setVisible(!e),Common.localStorage.setBool("de-hidden-status",e),"slot-btn-options"===t.$el.closest(".btn-slot").prop("id")&&this.statusbar.fireEvent("view:hide",[this,e]),Common.NotificationCenter.trigger("layout:changed","status"),Common.NotificationCenter.trigger("edit:complete",this.statusbar)},onApiTrackRevisionsChange:function(t,e,i){var n=null===t,e=n?e:t;this.btnTurnReview&&(e?i&&n&&(void 0===this.globalChangesTooltip&&(this.globalChangesTooltip=this.createChangesTip(this.textSetTrackChanges)),this.globalChangesTooltip.isVisible()||(this.hideTips(),this.globalChangesTooltip.show())):(this.hideTips(),this.btnTurnReview.updateHint(this.tipReview)))},setApi:function(t){this.api=t,this.api.asc_registerCallback("asc_onZoomChange",_.bind(this._onZoomChange,this)),this.api.asc_registerCallback("asc_onTextLanguage",_.bind(this._onTextLanguage,this)),this.api.asc_registerCallback("asc_onOnTrackRevisionsChange",_.bind(this.onApiTrackRevisionsChange,this)),this.statusbar.setApi(t)},onBtnZoomTo:function(t,e){var i,t="topage"==t?(i="btnZoomToPage","zoomFitToPage"):(i="btnZoomToWidth","zoomFitToWidth");this.statusbar[i].pressed?this.api[t]():this.api.zoomCustomMode(),Common.NotificationCenter.trigger("edit:complete",this.statusbar)},zoomDocument:function(t,e){switch(t){case"up":this.api.zoomIn();break;case"down":this.api.zoomOut()}Common.NotificationCenter.trigger("edit:complete",this.statusbar)},_onZoomChange:function(t,e){this.statusbar.btnZoomToPage.toggle(2==e,!0),this.statusbar.btnZoomToWidth.toggle(1==e,!0),$(".statusbar #label-zoom").text(Common.Utils.String.format(this.zoomText,t)),this._isDocReady&&Common.localStorage.setItem("de-last-zoom",t)},_onTextLanguage:function(t){var e=Common.util.LanguageInfo.getLocalLanguageName(t);this.statusbar.setLanguage({value:e[0],displayValue:e[1],code:t})},setLanguages:function(t){this.langs=t,this.statusbar.reloadLanguages(t)},setStatusCaption:function(t,e,i,n){this.timerCaption&&(new Date<this.timerCaption||0==t.length)&&!e||(this.timerCaption=void 0,t.length?(this.statusbar.showStatusMessage(t),n&&n(),0<i&&(this.timerCaption=(new Date).getTime()+i)):this.statusbar.clearStatusMessage())},createDelayedElements:function(){this.statusbar.$el.css("z-index","")},onLangMenu:function(t,e,i){this.api.put_TextPrLang(e)},synchronizeChanges:function(){this.setStatusCaption("")},hideTips:function(){this.changesTooltip&&this.changesTooltip.isVisible()&&this.changesTooltip.hide(),this.newChangesTooltip&&this.newChangesTooltip.isVisible()&&this.newChangesTooltip.hide(),this.globalChangesTooltip&&this.globalChangesTooltip.isVisible()&&this.globalChangesTooltip.hide()},createChangesTip:function(t,e){var i=this,n=new Common.UI.SynchronizeTip({target:i.btnTurnReview.$el,text:t,placement:"top-left",showLink:!!e});return n.on({dontshowclick:function(){Common.localStorage.setItem(e,1),n.hide(),i.btnTurnReview.updateHint(i.tipReview)},closeclick:function(){n.hide(),i.btnTurnReview.updateHint(i.tipReview)}}),n},showDisconnectTip:function(){var t,e=this;this.disconnectTip||(t=(t=this.statusbar.getStatusLabel()).is(":visible")?t.parent():this.statusbar.isVisible()?this.statusbar.$el:$(document.body),this.disconnectTip=new Common.UI.SynchronizeTip({target:t,text:this.textDisconnect,placement:"top",position:this.statusbar.isVisible()?void 0:{bottom:0},showLink:!1,style:"max-width: 310px;"}),this.disconnectTip.on({closeclick:function(){e.disconnectTip.hide(),e.disconnectTip=null}})),this.disconnectTip.show()},hideDisconnectTip:function(){this.disconnectTip&&this.disconnectTip.hide(),this.disconnectTip=null},onSelectTool:function(t,e,i){this.api&&this.api.asc_setViewerTargetType(t)}},DE.Controllers.Statusbar||{}))}),define("documenteditor/main/app/view/FormsTab",["common/main/lib/util/utils","common/main/lib/component/BaseView","common/main/lib/component/Layout"],function(){"use strict";DE.Views.FormsTab=Common.UI.BaseView.extend(_.extend({options:{},initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this),this.toolbar=t.toolbar,this.appConfig=t.config,this.paragraphControls=[],this._state={};var e,t=Common.enumLock;this.appConfig.isRestrictedEdit&&this.appConfig.canFillForms||(e=Common.localStorage.getBool("de-text-form-fixed",!0),this.btnTextField=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon "+(e?"btn-text-fixed-field":"btn-text-field"),lock:[t.paragraphLock,t.headerLock,t.controlPlain,t.contentLock,t.previewReviewMode,t.viewFormMode,t.lostConnect,t.disableOnStart,t.docLockView,t.docLockForms,t.docLockComments,t.inSmartart,t.inSmartartInternal],caption:this.capBtnText,fieldType:e?"fixed":"inline",split:!0,menu:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.paragraphControls.push(this.btnTextField),this.btnComboBox=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-combo-box",lock:[t.paragraphLock,t.headerLock,t.controlPlain,t.contentLock,t.previewReviewMode,t.viewFormMode,t.lostConnect,t.disableOnStart,t.docLockView,t.docLockForms,t.docLockComments,t.inSmartart,t.inSmartartInternal],caption:this.capBtnComboBox,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.paragraphControls.push(this.btnComboBox),this.btnDropDown=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-dropdown",lock:[t.paragraphLock,t.headerLock,t.controlPlain,t.contentLock,t.previewReviewMode,t.viewFormMode,t.lostConnect,t.disableOnStart,t.docLockView,t.docLockForms,t.docLockComments,t.inSmartart,t.inSmartartInternal],caption:this.capBtnDropDown,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.paragraphControls.push(this.btnDropDown),this.btnCheckBox=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-checkbox",lock:[t.paragraphLock,t.headerLock,t.controlPlain,t.contentLock,t.previewReviewMode,t.viewFormMode,t.lostConnect,t.disableOnStart,t.docLockView,t.docLockForms,t.docLockComments,t.inSmartart,t.inSmartartInternal],caption:this.capBtnCheckBox,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.paragraphControls.push(this.btnCheckBox),this.btnRadioBox=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-radio-button",lock:[t.paragraphLock,t.headerLock,t.controlPlain,t.contentLock,t.previewReviewMode,t.viewFormMode,t.lostConnect,t.disableOnStart,t.docLockView,t.docLockForms,t.docLockComments,t.inSmartart,t.inSmartartInternal],caption:this.capBtnRadioBox,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.paragraphControls.push(this.btnRadioBox),this.btnImageField=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-insertimage",lock:[t.paragraphLock,t.headerLock,t.controlPlain,t.contentLock,t.complexForm,t.previewReviewMode,t.viewFormMode,t.lostConnect,t.disableOnStart,t.docLockView,t.docLockForms,t.docLockComments,t.inSmartart,t.inSmartartInternal],caption:this.capBtnImage,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.paragraphControls.push(this.btnImageField),this.btnManager=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-ic-sharing",lock:[t.previewReviewMode,t.viewFormMode,t.lostConnect,t.disableOnStart,t.docLockView,t.docLockForms,t.docLockComments],caption:this.capBtnManager,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.paragraphControls.push(this.btnManager),this.btnEmailField=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-email",lock:[t.paragraphLock,t.headerLock,t.controlPlain,t.contentLock,t.previewReviewMode,t.viewFormMode,t.lostConnect,t.disableOnStart,t.docLockView,t.docLockForms,t.docLockComments,t.inSmartart,t.inSmartartInternal],caption:this.capBtnEmail,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.paragraphControls.push(this.btnEmailField),this.btnPhoneField=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-phone",lock:[t.paragraphLock,t.headerLock,t.controlPlain,t.contentLock,t.previewReviewMode,t.viewFormMode,t.lostConnect,t.disableOnStart,t.docLockView,t.docLockForms,t.docLockComments,t.inSmartart,t.inSmartartInternal],caption:this.capBtnPhone,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.paragraphControls.push(this.btnPhoneField),this.btnZipCode=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-zip-code",lock:[t.paragraphLock,t.headerLock,t.controlPlain,t.contentLock,t.previewReviewMode,t.viewFormMode,t.lostConnect,t.disableOnStart,t.docLockView,t.docLockForms,t.docLockComments,t.inSmartart,t.inSmartartInternal],caption:this.capZipCode,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.paragraphControls.push(this.btnZipCode),this.btnCreditCard=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-credit-card",lock:[t.paragraphLock,t.headerLock,t.controlPlain,t.contentLock,t.previewReviewMode,t.viewFormMode,t.lostConnect,t.disableOnStart,t.docLockView,t.docLockForms,t.docLockComments,t.inSmartart,t.inSmartartInternal],caption:this.capCreditCard,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.paragraphControls.push(this.btnCreditCard),this.btnDateTime=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-datetime",lock:[t.paragraphLock,t.headerLock,t.controlPlain,t.contentLock,t.previewReviewMode,t.viewFormMode,t.lostConnect,t.disableOnStart,t.docLockView,t.docLockForms,t.docLockComments,t.inSmartart,t.inSmartartInternal],caption:this.capDateTime,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.paragraphControls.push(this.btnDateTime),this.btnComplexField=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-complex-field",lock:[t.paragraphLock,t.headerLock,t.controlPlain,t.contentLock,t.complexForm,t.previewReviewMode,t.viewFormMode,t.lostConnect,t.disableOnStart,t.docLockView,t.docLockForms,t.docLockComments,t.inSmartart,t.inSmartartInternal],caption:this.capBtnComplex,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.paragraphControls.push(this.btnComplexField),this.btnViewFormRoles=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-sheet-view",lock:[t.previewReviewMode,t.formsNoRoles,t.lostConnect,t.disableOnStart,t.docLockView,t.docLockForms,t.docLockComments],caption:this.capBtnView,split:!0,menu:new Common.UI.Menu({cls:"menu-roles",maxHeight:270,style:"max-width: 400px;",items:[]}),enableToggle:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.paragraphControls.push(this.btnViewFormRoles)),this.btnClear=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-clear-style",caption:this.textClear,visible:!1,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.btnPrevForm=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-previous-field",lock:[t.previewReviewMode,t.lostConnect,t.disableOnStart,t.docLockView,t.docLockComments],caption:this.capBtnPrev,visible:!1,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.appConfig.isRestrictedEdit&&this.appConfig.canFillForms||this.paragraphControls.push(this.btnPrevForm),this.btnNextForm=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-next-field",lock:[t.previewReviewMode,t.lostConnect,t.disableOnStart,t.docLockView,t.docLockComments],caption:this.capBtnNext,visible:!1,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.appConfig.isRestrictedEdit&&this.appConfig.canFillForms||this.paragraphControls.push(this.btnNextForm),this.appConfig.canSubmitForms&&(this.btnSubmit=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-submit-form",lock:[t.lostConnect,t.disableOnStart],caption:this.capBtnSubmit,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.appConfig.isRestrictedEdit&&this.appConfig.canFillForms||this.paragraphControls.push(this.btnSubmit)),this.appConfig.canDownloadForms&&(this.btnSaveForm=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",lock:[t.lostConnect,t.disableOnStart],iconCls:"toolbar__icon btn-save-form",caption:this.appConfig.canRequestSaveAs||this.appConfig.saveAsUrl||this.appConfig.isOffline?this.capBtnSaveForm:this.capBtnDownloadForm,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.appConfig.isRestrictedEdit&&this.appConfig.canFillForms||this.paragraphControls.push(this.btnSaveForm)),Common.Utils.lockControls(Common.enumLock.disableOnStart,!0,{array:this.paragraphControls}),this._state={disabled:!1},Common.NotificationCenter.on("app:ready",this.onAppReady.bind(this))},render:function(t){return t&&t.html(this.getPanel()),this},onAppReady:function(e){var i=this;new Promise(function(t,e){t()}).then(function(){var t;e.isEdit&&e.canFeatureContentControl&&e.canFeatureForms&&(t=_.template('<a id="<%= id %>" tabindex="-1" type="menuitem" class="menu-item"><% if (!_.isEmpty(iconCls)) { %><span class="menu-item-icon <%= iconCls %>"></span><% } %><div><%= caption %></div><% if (options.description !== null) { %><label style="cursor: pointer;white-space: normal;"><%= options.description %></label><% } %></a>'),i.btnTextField.setMenu(new Common.UI.Menu({style:"max-width: 300px;",items:[{caption:i.txtInlineText,template:t,description:i.txtInlineDesc,iconCls:"menu__icon btn-field",value:"inline",iconClsForMainBtn:"btn-text-field",hintForMainBtn:[i.tipInlineText,i.tipTextField]},{caption:i.txtFixedText,template:t,description:i.txtFixedDesc,iconCls:"menu__icon btn-fixed-field",value:"fixed",iconClsForMainBtn:"btn-text-fixed-field",hintForMainBtn:[i.tipFixedText,i.tipTextField]}]})),i.btnTextField.updateHint([Common.localStorage.getBool("de-text-form-fixed",!0)?i.tipFixedText:i.tipInlineText,i.tipTextField]),i.btnComboBox.updateHint(i.tipComboBox),i.btnDropDown.updateHint(i.tipDropDown),i.btnCheckBox.updateHint(i.tipCheckBox),i.btnRadioBox.updateHint(i.tipRadioBox),i.btnImageField.updateHint(i.tipImageField),i.btnViewFormRoles.updateHint(i.tipViewForm),i.btnManager.updateHint(i.tipManager),i.btnEmailField.updateHint(i.tipEmailField),i.btnPhoneField.updateHint(i.tipPhoneField),i.btnComplexField.updateHint(i.tipComplexField),i.btnZipCode.updateHint(i.tipZipCode),i.btnCreditCard.updateHint(i.tipCreditCard),i.btnDateTime.updateHint(i.tipDateTime)),i.btnClear.updateHint(i.textClearFields),i.btnPrevForm.updateHint(i.tipPrevForm),i.btnNextForm.updateHint(i.tipNextForm),i.btnSubmit&&i.btnSubmit.updateHint(i.tipSubmit),i.btnSaveForm&&i.btnSaveForm.updateHint(e.canRequestSaveAs||e.saveAsUrl?i.tipSaveForm:i.tipDownloadForm),function(){var o=this;this.btnTextField&&this.btnTextField.on("click",function(t,e){o.fireEvent("forms:insert",["text",{fixed:"fixed"===t.options.fieldType}])}),this.btnTextField&&this.btnTextField.menu.on("item:click",function(t,e){var i=o.btnTextField.options.fieldType,n=e.value;n!==i&&(o.btnTextField.changeIcon({next:e.options.iconClsForMainBtn,curr:o.btnTextField.menu.items.filter(function(t){return t.value===i})[0].options.iconClsForMainBtn}),o.btnTextField.updateHint(e.options.hintForMainBtn),o.btnTextField.options.fieldType=n,Common.localStorage.setBool("de-text-form-fixed","fixed"===n)),o.fireEvent("forms:insert",["text",{fixed:"fixed"===n}])}),this.btnComboBox&&this.btnComboBox.on("click",function(t,e){o.fireEvent("forms:insert",["combobox"])}),this.btnDropDown&&this.btnDropDown.on("click",function(t,e){o.fireEvent("forms:insert",["dropdown"])}),this.btnCheckBox&&this.btnCheckBox.on("click",function(t,e){o.fireEvent("forms:insert",["checkbox"])}),this.btnRadioBox&&this.btnRadioBox.on("click",function(t,e){o.fireEvent("forms:insert",["radiobox"])}),this.btnImageField&&this.btnImageField.on("click",function(t,e){o.fireEvent("forms:insert",["picture"])}),this.btnComplexField&&this.btnComplexField.on("click",function(t,e){o.fireEvent("forms:insert",["complex"])}),this.btnEmailField&&this.btnEmailField.on("click",function(t,e){o.fireEvent("forms:insert",["text",{reg:"\\S+@\\S+\\.\\S+",placeholder:"user_name@email.com"}])}),this.btnPhoneField&&this.btnPhoneField.on("click",function(t,e){o.fireEvent("forms:insert",["text",{mask:"(999)999-9999",placeholder:"(999)999-9999"}])}),this.btnCreditCard&&this.btnCreditCard.on("click",function(t,e){o.fireEvent("forms:insert",["text",{mask:"9999-9999-9999-9999",placeholder:"9999-9999-9999-9999"}])}),this.btnZipCode&&this.btnZipCode.on("click",function(t,e){o.fireEvent("forms:insert",["text",{mask:"99999-9999",placeholder:"99999-9999"}])}),this.btnDateTime&&this.btnDateTime.on("click",function(t,e){o.fireEvent("forms:insert",["datetime"])}),this.btnViewFormRoles&&this.btnViewFormRoles.on("click",function(t,e){var i=t.menu.getChecked();i?i=i.caption:o._state.roles&&0<o._state.roles.length&&(i=o._state.roles[0].asc_getSettings().asc_getName()),o.fireEvent("forms:mode",[t.pressed,i])}),this.btnViewFormRoles.menu.on("item:click",_.bind(function(t,e){e.checked&&(o.btnViewFormRoles.toggle(!0,!0),o.fireEvent("forms:mode",[!0,e.caption]))},o)),this.btnViewFormRoles.menu.on("show:after",function(t){o.fillRolesMenu()}),this.btnManager&&this.btnManager.on("click",function(t,e){o.fireEvent("forms:manager")}),this.btnClear&&this.btnClear.on("click",function(t,e){o.fireEvent("forms:clear")}),this.btnPrevForm&&this.btnPrevForm.on("click",function(t,e){o.fireEvent("forms:goto",["prev"])}),this.btnNextForm&&this.btnNextForm.on("click",function(t,e){o.fireEvent("forms:goto",["next"])}),this.btnSubmit&&this.btnSubmit.on("click",function(t,e){o.fireEvent("forms:submit")}),this.btnSaveForm&&this.btnSaveForm.on("click",function(t,e){o.fireEvent("forms:save")})}.call(i)})},getPanel:function(){this.$el=$(_.template('<section class="panel" data-tab="forms"><div class="group forms-buttons" style="display: none;"><span class="btn-slot text x-huge" id="slot-btn-form-field"></span><span class="btn-slot text x-huge" id="slot-btn-form-combobox"></span><span class="btn-slot text x-huge" id="slot-btn-form-dropdown"></span><span class="btn-slot text x-huge" id="slot-btn-form-checkbox"></span><span class="btn-slot text x-huge" id="slot-btn-form-radiobox"></span><span class="btn-slot text x-huge" id="slot-btn-form-image"></span></div><div class="separator long forms-buttons" style="display: none;"></div><div class="group forms-buttons" style="display: none;"><span class="btn-slot text x-huge" id="slot-btn-form-email"></span><span class="btn-slot text x-huge" id="slot-btn-form-phone"></span><span class="btn-slot text x-huge" id="slot-btn-form-datetime"></span><span class="btn-slot text x-huge" id="slot-btn-form-zipcode"></span><span class="btn-slot text x-huge" id="slot-btn-form-credit"></span><span class="btn-slot text x-huge" id="slot-btn-form-complex"></span></div><div class="separator long forms-buttons" style="display: none;"></div><div class="group forms-buttons" style="display: none;"><span class="btn-slot text x-huge" id="slot-btn-manager"></span></div><div class="separator long forms-buttons" style="display: none;"></div><div class="group no-group-mask" style=""><span class="btn-slot text x-huge" id="slot-btn-form-view-roles"></span><span class="btn-slot text x-huge" id="slot-btn-form-prev"></span><span class="btn-slot text x-huge" id="slot-btn-form-next"></span><span class="btn-slot text x-huge" id="slot-btn-form-clear"></span><span class="btn-slot text x-huge" id="slot-btn-form-submit"></span><span class="btn-slot text x-huge" id="slot-btn-form-save"></span></div></section>')({}));var t=this.$el;return this.appConfig.canSubmitForms&&this.btnSubmit.render(t.find("#slot-btn-form-submit")),this.appConfig.canDownloadForms&&this.btnSaveForm.render(t.find("#slot-btn-form-save")),this.appConfig.isRestrictedEdit&&this.appConfig.canFillForms||(this.btnTextField.render(t.find("#slot-btn-form-field")),this.btnComboBox.render(t.find("#slot-btn-form-combobox")),this.btnDropDown.render(t.find("#slot-btn-form-dropdown")),this.btnCheckBox.render(t.find("#slot-btn-form-checkbox")),this.btnRadioBox.render(t.find("#slot-btn-form-radiobox")),this.btnImageField.render(t.find("#slot-btn-form-image")),this.btnViewFormRoles.render(t.find("#slot-btn-form-view-roles")),this.btnManager.render(t.find("#slot-btn-manager")),this.btnEmailField.render(t.find("#slot-btn-form-email")),this.btnPhoneField.render(t.find("#slot-btn-form-phone")),this.btnComplexField.render(t.find("#slot-btn-form-complex")),this.btnZipCode.render(t.find("#slot-btn-form-zipcode")),this.btnCreditCard.render(t.find("#slot-btn-form-credit")),this.btnDateTime.render(t.find("#slot-btn-form-datetime")),t.find(".forms-buttons").show()),this.btnClear.render(t.find("#slot-btn-form-clear")),this.btnPrevForm.render(t.find("#slot-btn-form-prev")),this.btnNextForm.render(t.find("#slot-btn-form-next")),this.$el},fillRolesMenu:function(t,n){var o,s,e;this.btnViewFormRoles&&this.btnViewFormRoles.menu&&this.btnViewFormRoles.menu.isVisible()?(t=t||this._state.roles,n=n||this._state.lastViewRole,this._state.roles=this._state.lastViewRole=void 0,t&&(o=0,(s=this).btnViewFormRoles.menu.removeAll(),t&&t.forEach(function(t,e){var t=t.asc_getSettings(),i=t.asc_getColor();t.asc_getName()===n&&(o=e),s.btnViewFormRoles.menu.addItem(new Common.UI.MenuItem({caption:t.asc_getName()||s.textAnyone,color:i?"#"+Common.Utils.ThemeColor.getHexColor(i.get_r(),i.get_g(),i.get_b()):"transparent",checkable:!0,toggleGroup:"formtab-view-role",template:_.template(['<a id="<%= id %>"  tabindex="-1" type="menuitem" class="<%= options.cls %>" style="overflow: hidden; text-overflow: ellipsis;">','<span class="color" style="background: <%= options.color %>;"></span>',"<%= Common.Utils.String.htmlEncode(caption) %>","</a>"].join(""))}))}),(e=0<this.btnViewFormRoles.menu.items.length)&&this.btnViewFormRoles.menu.items[o].setChecked(!0,!0),Common.Utils.lockControls(Common.enumLock.formsNoRoles,!e,{array:[this.btnViewFormRoles]}))):(this._state.roles=t,this._state.lastViewRole=n)},show:function(){Common.UI.BaseView.prototype.show.call(this),this.fireEvent("show",this)},getButtons:function(){return this.paragraphControls},setPreviewMode:function(t){this.btnClear.setVisible(t),this.btnPrevForm.setVisible(t),this.btnNextForm.setVisible(t),this.btnSubmit&&this.btnSubmit.setVisible(!t),this.btnSaveForm&&this.btnSaveForm.setVisible(!t)},SetDisabled:function(e){this._state.disabled=e,this.paragraphControls.forEach(function(t){t&&t.setDisabled(e)},this)}},DE.Views.FormsTab||{}))}),define("text!documenteditor/main/app/template/RolesManagerDlg.template",[],function(){return'<div class="settings-panel active">\n    <div class="inner-content">\n        <table cols="2" style="width: 100%;">\n            <tr>\n                <td class="padding-small">\n                    <label><%= scope.textDescription %></label>\n                </td>\n                <td class="padding-small" style="width: 60px;">\n                    <div id="roles-manager-btn-down" style="display: inline-block;" class="float-right margin-left-5"></div>\n                    <div id="roles-manager-btn-up" style="display: inline-block;" class="float-right"></div>\n                </td>\n            </tr>\n            <tr>\n                <td colspan=2 class="padding-small">\n                    <div id="roles-manager-roles-list" class="roles-tableview no-borders" style="width:480px; height: 170px;"></div>\n                </td>\n            </tr>\n            <tr>\n                <td colspan=2 class="padding-large">\n                    <button type="button" class="btn btn-text-default margin-right-5" id="roles-manager-btn-new" style="min-width: 100px;"><%= scope.textNew %></button>\n                    <button type="button" class="btn btn-text-default" id="roles-manager-btn-edit" style="min-width: 100px;"><%= scope.textEdit %></button>\n                    <button type="button" class="btn btn-text-default float-right" id="roles-manager-btn-delete" style="min-width: 100px;"><%= scope.textDelete %></button>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>'}),define("documenteditor/main/app/view/RoleEditDlg",["common/main/lib/component/Window","common/main/lib/component/InputField"],function(){"use strict";DE.Views.RoleEditDlg=Common.UI.Window.extend(_.extend({options:{width:330,cls:"modal-dlg",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,t||{}),this.template=['<div class="box">','<table cols="2" style="width: 100%;">',"<tr>",'<td class="padding-right-10" style="width: 50px;">',"<label></label>",'<div id="id-dlg-role-color" style="margin-bottom: 10px;"></div>',"</td>","<td>","<label>"+this.textName+"</label>",'<div id="id-dlg-role-name" class="input-row" style="margin-bottom: 10px; "></div>',"</td>","</tr>","</table>","</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),this.props=this.options.props,this.colors=this.options.colors,this.lastColor="FFEFBF",this.oformManager=this.options.oformManager,Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var e=this,t=this.getChild();t.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),e.inputName=new Common.UI.InputField({el:t.find("#id-dlg-role-name"),allowBlank:!1,blankError:e.textEmptyError,style:"width: 100%;",placeHolder:e.textNameEx,validateOnBlur:!1,validation:function(t){return t=t.trim(),_.isEmpty(t)?"":!((!e.props||t!==e.props.name)&&e.oformManager.asc_haveRole(t))||e.errNameExists}}),this.btnColor=new Common.UI.ColorButton({parentEl:t.find("#id-dlg-role-color"),additionalItems:[this.mnuNoFormsColor=new Common.UI.MenuItem({id:"id-dlg-role-menu-no-highlight",caption:this.textNoHighlight,checkable:!0,style:Common.UI.isRTL()?"padding-right:20px;":"padding-left:20px;"}),{caption:"--"}],additionalAlign:this.menuAddAlign,colors:["FEF8E5","FFEFBF","E2EFD8","C6E0B3","EDEDED","DBDBDB","CDD6E4","A2B2CA","F2F2F2","D9D9D9","DDEBF6","C2DDF2","FBECE2","F7D9C6","D6E3EE","B9CAE7","F2DADA","F2C2C2","F0DDF6","E5C2F2","E6FBD6","CDF7AC","EED6D6","E7B9B9","CCE1FF","9AC4FF","E4CDDB","D9ADC7"],color:this.lastColor,themecolors:0,effects:0,colorHints:!1,cls:"move-focus",takeFocusOnClose:!0}),this.btnColor.on("color:select",_.bind(this.onColorsSelect,this)),this.mnuNoFormsColor.on("click",_.bind(this.onNoColorClick,this)),this.mnuColorPicker=this.btnColor.getPicker(),this.afterRender()},afterRender:function(){this.setSettings(this.props),this.setTitle(this.options.isEdit?this.txtTitleEdit:this.txtTitleNew)},show:function(){Common.UI.Window.prototype.show.apply(this,arguments)},setSettings:function(t){var e;t?(e=t.color,this.mnuNoFormsColor.setChecked(!e,!0),this.mnuColorPicker.clearSelection(),e&&(this.mnuColorPicker.selectByRGB(e,!0),this.lastColor=e),this.btnColor.setColor(e||"transparent"),this.inputName.setValue(t.name||"")):0<(e=_.difference(this.btnColor.options.colors,this.colors)).length&&(t=Math.floor(Math.random()*e.length),this.lastColor=e[t],this.mnuColorPicker.selectByRGB(this.lastColor,!0),this.btnColor.setColor(this.lastColor))},getSettings:function(){return{name:this.inputName.getValue(),color:this.mnuNoFormsColor.isChecked()?null:Common.Utils.ThemeColor.getRgbColor(this.lastColor)}},onColorsSelect:function(t,e){this.lastColor=e,this.mnuNoFormsColor.setChecked(!1,!0)},onNoColorClick:function(t){t.isChecked()?(this.btnColor.setColor("transparent"),this.mnuColorPicker.clearSelection()):(this.btnColor.setColor(this.lastColor),this.mnuColorPicker.selectByRGB(this.lastColor,!0))},onPrimary:function(t){return this._handleInput("ok"),!1},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},getFocusedComponents:function(){return[this.btnColor,this.inputName]},getDefaultFocusableComponent:function(){return this.inputName},_handleInput:function(t){if(this.options.handler){if("ok"==t&&!0!==this.inputName.checkValidate())return void this.inputName.cmpEl.find("input").focus();this.options.handler.call(this,t,"ok"==t?this.getSettings():void 0)}this.close()}},DE.Views.RoleEditDlg||{}))}),define("documenteditor/main/app/view/RoleDeleteDlg",["common/main/lib/component/Window","common/main/lib/component/ComboBox"],function(){"use strict";DE.Views.RoleDeleteDlg=Common.UI.Window.extend(_.extend({options:{width:300,cls:"modal-dlg",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:this.textTitle},t||{}),this.template=['<div class="box">','<div class="" style="margin-bottom: 10px;">',"<label>"+this.textLabel+"</label>","</div>",'<div class="input-row" style="">',"<label>"+this.textSelect+"</label>","</div>",'<div style="margin-bottom: 12px;">','<div id="id-role-del-remove" class="input-group-nr"></div>',"</div>","</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),this.props=t.props,Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this.getChild();t.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.cmbRole=new Common.UI.ComboBox({el:$("#id-role-del-remove",t),style:"width: 100%;",menuStyle:"min-width: 100%;max-height: 190px;max-width: 400px;",cls:"input-group-nr",data:[],itemsTemplate:_.template(["<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%= item.value %>"><a tabindex="-1" type="menuitem" style="overflow: hidden; text-overflow: ellipsis;"><%= scope.getDisplayValue(item) %></a></li>',"<% }); %>"].join("")),editable:!1,takeFocusOnClose:!0}),this.afterRender()},getFocusedComponents:function(){return[this.cmbRole]},getDefaultFocusableComponent:function(){return this.cmbRole},afterRender:function(){this._setDefaults(this.props)},_setDefaults:function(i){var n;i&&(n=[],i.roles.each(function(t,e){t=t.get("name");t!==i.excludeName&&n.push({value:t,displayValue:t})}),this.cmbRole.setData(n),0<n.length&&this.cmbRole.setValue(n[0].value))},onPrimary:function(t){return this._handleInput("ok"),!1},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},_handleInput:function(t){this.options.handler&&this.options.handler.call(this,t,this.cmbRole.getValue()),this.close()}},DE.Views.RoleDeleteDlg||{}))}),define("documenteditor/main/app/view/RolesManagerDlg",["text!documenteditor/main/app/template/RolesManagerDlg.template","common/main/lib/view/AdvancedSettingsWindow","common/main/lib/component/ListView","documenteditor/main/app/view/RoleEditDlg","documenteditor/main/app/view/RoleDeleteDlg"],function(e){"use strict";DE.Views=DE.Views||{},DE.Views.RolesManagerDlg=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{alias:"RolesManagerDlg",contentWidth:500,height:353,buttons:null},initialize:function(t){_.extend(this.options,{title:this.txtTitle,template:['<div class="box" style="height:'+(this.options.height-85)+'px;">','<div class="content-panel" style="padding: 0;">'+_.template(e)({scope:this})+"</div>","</div>",'<div class="separator horizontal"></div>','<div class="footer center">','<button class="btn normal dlg-btn" result="cancel" style="width: 86px;">'+this.closeButtonText+"</button>","</div>"].join("")},t),this.api=t.api,this.handler=t.handler,this.props=t.props,this.oformManager=this.api.asc_GetOForm(),this.wrapEvents={onRefreshRolesList:_.bind(this.onRefreshRolesList,this)},this.arrColors=[],Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);this.rolesList=new Common.UI.ListView({el:$("#roles-manager-roles-list",this.$window),store:new Common.UI.DataViewStore,emptyText:this.textEmpty,itemTemplate:_.template(['<div id="<%= id %>" class="list-item" style="">','<div class="listitem-icon" style="flex-shrink: 0;"><svg class=""><use xlink:href="#svg-icon-<%= scope.getIconCls(index) %>"></use></svg></div>','<div class="padding-right-5" style="width: 25px;text-align:center;flex-shrink: 0;"><%= index+1 %></div>','<div style="width: 25px;flex-shrink: 0;">','<span class="color" style="background: <% if (color) { %>#<%= color %><% } else { %> transparent <% } %>;"></span>',"</div>",'<div class="padding-right-5" style="flex-grow: 1;"><%= Common.Utils.String.htmlEncode(name) %></div>','<div class="text-align-right" style="width: 25px;opacity: 0.8;flex-shrink: 0;"><%= fields %></div>',"</div>"].join("")),tabindex:1}),this.rolesList.on("item:select",_.bind(this.onSelectRoleItem,this)).on("item:keydown",_.bind(this.onKeyDown,this)).on("item:dblclick",_.bind(this.onDblClickItem,this)).on("entervalue",_.bind(this.onDblClickItem,this)),this.btnNewRole=new Common.UI.Button({el:$("#roles-manager-btn-new",this.$window)}),this.btnNewRole.on("click",_.bind(this.onEditRole,this,!1)),this.btnEditRole=new Common.UI.Button({el:$("#roles-manager-btn-edit",this.$window)}),this.btnEditRole.on("click",_.bind(this.onEditRole,this,!0)),this.btnDeleteRole=new Common.UI.Button({el:$("#roles-manager-btn-delete",this.$window)}),this.btnDeleteRole.on("click",_.bind(this.onDeleteRole,this)),this.btnUp=new Common.UI.Button({parentEl:$("#roles-manager-btn-up",this.$window),cls:"btn-toolbar bg-white",iconCls:"caret-up",scaling:!1,hint:this.textUp}),this.btnUp.on("click",_.bind(this.onMoveClick,this,!0)),this.btnDown=new Common.UI.Button({parentEl:$("#roles-manager-btn-down",this.$window),cls:"btn-toolbar bg-white",iconCls:"caret-down",scaling:!1,hint:this.textDown}),this.btnDown.on("click",_.bind(this.onMoveClick,this,!1)),this.afterRender()},getFocusedComponents:function(){return[this.btnUp,this.btnDown,this.rolesList,this.btnNewRole,this.btnEditRole,this.btnDeleteRole]},getDefaultFocusableComponent:function(){return this.rolesList},afterRender:function(){this._setDefaults(this.props)},_setDefaults:function(t){this.refreshRolesList(this.oformManager.asc_getAllRoles(),0),this.api.asc_registerCallback("asc_onUpdateOFormRoles",this.wrapEvents.onRefreshRolesList)},onRefreshRolesList:function(t){this.refreshRolesList(t)},refreshRolesList:function(t,e){var i,n;if(void 0===e&&(e=this.lastSelectedRole),(this.lastSelectedRole=void 0)===e&&0<this.rolesList.store.length&&(n=this.rolesList.getSelectedRec())&&(e=n.get("name")),this.arrColors=[],t){for(var o=[],s=0;s<t.length;s++){var a=t[s].asc_getSettings(),l=(l=a.asc_getColor())&&Common.Utils.ThemeColor.getHexColor(l.get_r(),l.get_g(),l.get_b());o.push({name:a.asc_getName()||this.textAnyone,color:l,fields:a.asc_getFieldCount()||0,index:s,scope:this}),l&&this.arrColors.push(l.toUpperCase())}this.rolesList.store.reset(o)}0<this.rolesList.store.length&&(i=this,"string"==typeof(e=void 0===e?0:e)?(n=this.rolesList.store.findWhere({name:e}),this.rolesList.selectRecord(n)):(e=Math.min(e,this.rolesList.store.length-1),n=this.rolesList.selectByIndex(e)),setTimeout(function(){i.rolesList.scrollToRecord(n||i.rolesList.store.at(0))},50)),this.updateButtons()},getIconCls:function(t){return 1===this.rolesList.store.length?"Point":0===t?"StartPoint":t===this.rolesList.store.length-1?"EndPoint":"MiddlePoint"},onEditRole:function(i){var n,t,o,e;this._isWarningVisible||(t=(n=this).$window.offset(),o=this.rolesList.getSelectedRec(),e=new DE.Views.RoleEditDlg({oformManager:n.oformManager,props:i&&o?{name:o.get("name"),color:o.get("color")}:null,colors:n.arrColors,isEdit:i&&o,handler:function(t,e){"ok"==t&&e&&(n.lastSelectedRole=e.name,(t=new AscCommon.CRoleSettings).asc_putName(e.name),t.asc_putColor(e.color),i&&o?n.oformManager.asc_editRole(o.get("name"),t):n.oformManager.asc_addRole(t))}}).on("close",function(){n.show(),setTimeout(function(){n.getDefaultFocusableComponent().focus()},100)}),n.hide(),e.show(t.left+65,t.top+77))},onDeleteRole:function(){var i,t,e,n=this,o=this.rolesList.store,s=this.rolesList.getSelectedRec();s&&(i=function(t){n.lastSelectedRole=o.indexOf(s),n.oformManager.asc_removeRole(s.get("name"),t)},1===o.length||s.get("fields")<1?(n._isWarningVisible=!0,Common.UI.warning({msg:Common.Utils.String.format(1===o.length?n.textDeleteLast:n.warnDelete,s.get("name")),maxwidth:600,buttons:["ok","cancel"],callback:function(t){"ok"==t&&i(),setTimeout(function(){n.getDefaultFocusableComponent().focus()},100),n._isWarningVisible=!1}})):(t=n.$window.offset(),e=new DE.Views.RoleDeleteDlg({props:{roles:this.rolesList.store,excludeName:s.get("name")},handler:function(t,e){"ok"==t&&e&&i(e)}}).on("close",function(){n.show(),setTimeout(function(){n.getDefaultFocusableComponent().focus()},100)}),n.hide(),e.show(t.left+65,t.top+77)))},getSettings:function(){},onPrimary:function(){return!0},onDlgBtnClick:function(t){this.handler&&this.handler.call(this,t.currentTarget.attributes.result.value,this.getSettings()),this.close()},onSelectRoleItem:function(t,e,i){i&&(this.lastSelectedRole=void 0,this.updateMoveButtons())},onMoveClick:function(t){var e=this.rolesList.getSelectedRec();e&&(this.lastSelectedRole=e.get("name"),t?this.oformManager.asc_moveUpRole(e.get("name")):this.oformManager.asc_moveDownRole(e.get("name")))},updateButtons:function(){this.btnEditRole.setDisabled(this.rolesList.store.length<1),this.btnDeleteRole.setDisabled(this.rolesList.store.length<1),this.updateMoveButtons(),this.rolesList.scroller&&this.rolesList.scroller.update()},updateMoveButtons:function(){var t=this.rolesList.getSelectedRec(),t=t?this.rolesList.store.indexOf(t):-1;this.btnUp.setDisabled(t<1),this.btnDown.setDisabled(t<0||t==this.rolesList.store.length-1)},hide:function(){Common.UI.Window.prototype.hide.call(this)},close:function(){this.api.asc_unregisterCallback("asc_onUpdateOFormRoles",this.wrapEvents.onRefreshRolesList),Common.UI.Window.prototype.close.call(this)},onKeyDown:function(t,e,i){i.keyCode!=Common.UI.Keys.DELETE||this.btnDeleteRole.isDisabled()||this.onDeleteRole()},onDblClickItem:function(t,e,i){this.btnEditRole.isDisabled()||this.onEditRole(!0)}},DE.Views.RolesManagerDlg||{}))}),define("documenteditor/main/app/view/SaveFormDlg",["common/main/lib/view/AdvancedSettingsWindow","common/main/lib/component/ListView","documenteditor/main/app/view/RoleEditDlg","documenteditor/main/app/view/RoleDeleteDlg"],function(t){"use strict";DE.Views=DE.Views||{},DE.Views.SaveFormDlg=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{alias:"SaveFormDlg",contentWidth:320,height:280,buttons:null},initialize:function(t){_.extend(this.options,{title:this.txtTitle,template:['<div class="box" style="height:'+(this.options.height-85)+'px;">','<div class="content-panel" style="padding: 0;">','<div class="settings-panel active">','<div class="inner-content">','<table style="width: 100%;">',"<tr>",'<td class="padding-small">',"<label>"+this.textDescription+"</label>","</td>","</tr>","<tr>","<td>","<label>"+this.textFill+"</label>","</td>","</tr>","<tr>","<td>",'<div id="save-form-roles-list" class="roles-tableview no-borders" style="width:300px; height: 116px;"></div>',"</td>","</tr>","</table>","</div>","</div>","</div>","</div>",'<div class="footer center">','<button class="btn normal dlg-btn primary" result="ok" style="width: 86px;">'+this.saveButtonText+"</button>",'<button class="btn normal dlg-btn" result="cancel" style="width: 86px;">'+this.cancelButtonText+"</button>","</div>"].join("")},t),this.handler=t.handler,this.roles=t.roles,Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);this.rolesList=new Common.UI.ListView({el:$("#save-form-roles-list",this.$window),store:new Common.UI.DataViewStore,simpleAddMode:!0,handleSelect:!1,enableKeyEvents:!1,showLast:!1,emptyText:this.textEmpty,itemTemplate:_.template(['<div id="<%= id %>" class="list-item" style="border-color: transparent;">','<div class="listitem-icon" style="flex-shrink: 0;"><svg class=""><use xlink:href="#svg-icon-<%= scope.getIconCls(index) %>"></use></svg></div>','<div class="padding-right-5" style="flex-grow: 1;"><%= Common.Utils.String.htmlEncode(name) %></div>',"</div>"].join(""))}),this.afterRender()},afterRender:function(){this.refreshRolesList(this.roles)},refreshRolesList:function(t,e){if(t){this.roles=t;for(var i=[],n=0;n<this.roles.length;n++){var o=t[n].asc_getSettings(),s=o.asc_getFieldCount();0<s&&i.push({name:o.asc_getName()||this.textAnyone,color:o.asc_getColor(),fields:s,index:i.length,scope:this})}this.rolesList.store.reset(i)}},getIconCls:function(t){return 1===this.rolesList.store.length?"Point":0===t?"StartPoint":t===this.rolesList.store.length-1?"EndPoint":"MiddlePoint"}},DE.Views.SaveFormDlg||{}))}),define("documenteditor/main/app/controller/FormsTab",["core","documenteditor/main/app/view/FormsTab","documenteditor/main/app/view/RolesManagerDlg","documenteditor/main/app/view/SaveFormDlg"],function(){"use strict";DE.Controllers.FormsTab=Backbone.Controller.extend(_.extend({models:[],collections:[],views:["FormsTab"],sdkViewName:"#id_main",initialize:function(){},onLaunch:function(){this._state={lastViewRole:void 0,lastRoleInList:void 0}},setApi:function(t){return t&&(this.api=t,this.api.asc_registerCallback("asc_onFocusObject",this.onApiFocusObject.bind(this)),this.api.asc_registerCallback("asc_onCoAuthoringDisconnect",_.bind(this.onCoAuthoringDisconnect,this)),Common.NotificationCenter.on("api:disconnect",_.bind(this.onCoAuthoringDisconnect,this)),Common.NotificationCenter.on("app:ready",this.onAppReady.bind(this)),this.api.asc_registerCallback("asc_onStartAction",_.bind(this.onLongActionBegin,this)),this.api.asc_registerCallback("asc_onEndAction",_.bind(this.onLongActionEnd,this)),this.api.asc_registerCallback("asc_onError",_.bind(this.onError,this)),this.api.asc_registerCallback("asc_onDownloadUrl",_.bind(this.onDownloadUrl,this)),this.api.asc_registerCallback("asc_onUpdateOFormRoles",_.bind(this.onRefreshRolesList,this))),Common.NotificationCenter.on("protect:doclock",_.bind(this.onChangeProtectDocument,this)),this},setConfig:function(t){this.toolbar=t.toolbar,this.appConfig=t.config,this.view=this.createView("FormsTab",{toolbar:this.toolbar.toolbar,config:t.config}),this.addListeners({FormsTab:{"forms:insert":this.onControlsSelect,"forms:clear":this.onClearClick,"forms:mode":this.onModeClick,"forms:goto":this.onGoTo,"forms:submit":this.onSubmitClick,"forms:save":this.onSaveFormClick,"forms:manager":this.onManagerClick},Toolbar:{"tab:active":this.onActiveTab}})},SetDisabled:function(t){this.view&&this.view.SetDisabled(t)},createToolbarPanel:function(){return this.view.getPanel()},getView:function(t){return!t&&this.view?this.view:Backbone.Controller.prototype.getView.call(this,t)},onCoAuthoringDisconnect:function(){this.SetDisabled(!0)},onApiFocusObject:function(t){if(this.toolbar.editMode&&!this.appConfig.isRestrictedEdit){for(var e,i,n=-1,o=!1,s=!1,a=void 0;++n<t.length;)i=t[n].get_ObjectType(),e=t[n].get_ObjectValue(),i===Asc.c_oAscTypeSelectElement.Paragraph?o=e.get_Locked():i===Asc.c_oAscTypeSelectElement.Header?s=e.get_Locked():i===Asc.c_oAscTypeSelectElement.Image&&e&&e.get_ShapeProperties()&&(a=e.get_ShapeProperties());var l=this.api.asc_IsContentControl(),r=l?this.api.asc_GetContentControlProperties():null,c=l&&r?r.get_Lock():Asc.c_oAscSdtLockType.Unlocked,c=(!l||!r||r.get_ContentControlType()===Asc.c_oAscSdtLevelType.Inline&&r.get_ComplexFormPr(),(c=void 0===c?Asc.c_oAscSdtLockType.Unlocked:c)!=Asc.c_oAscSdtLockType.SdtContentLocked&&Asc.c_oAscSdtLockType.ContentLocked,[this.view.btnTextField,this.view.btnComboBox,this.view.btnDropDown,this.view.btnCheckBox,this.view.btnRadioBox,this.view.btnImageField,this.view.btnEmailField,this.view.btnPhoneField,this.view.btnComplexField,this.view.btnCreditCard,this.view.btnZipCode,this.view.btnDateTime]),l=(Common.Utils.lockControls(Common.enumLock.paragraphLock,o,{array:c}),Common.Utils.lockControls(Common.enumLock.headerLock,s,{array:c}),Common.Utils.lockControls(Common.enumLock.complexForm,l&&!!r&&!!r.get_ComplexFormPr(),{array:[this.view.btnComplexField,this.view.btnImageField]}),a&&a.asc_getFromSmartArt()),r=a&&a.asc_getFromSmartArtInternal();Common.Utils.lockControls(Common.enumLock.inSmartart,l,{array:c}),Common.Utils.lockControls(Common.enumLock.inSmartartInternal,r,{array:c})}},onControlsSelect:function(t,e){var i,n,o,s,a;this.toolbar.mode&&this.toolbar.mode.canFeatureContentControl&&this.toolbar.mode.canFeatureForms&&((i=new AscCommon.CSdtFormPr).put_Role(Common.Utils.InternalSettings.get("de-last-form-role")||this._state.lastRoleInList),this.toolbar.toolbar.fireEvent("insertcontrol",this.toolbar.toolbar),"picture"==t?this.api.asc_AddContentControlPicture(i):"checkbox"==t||"radiobox"==t?(s=new AscCommon.CSdtCheckBoxPr,"radiobox"==t&&s.put_GroupKey(this.toolbar.textGroup+" 1"),this.api.asc_AddContentControlCheckBox(s,i)):"combobox"==t||"dropdown"==t?this.api.asc_AddContentControlList("combobox"==t,s,i):"datetime"==t?(o=new AscCommon.CContentControlPr,n=new AscCommon.CSdtDatePickerPr,o.put_FormPr(i),o.put_DateTimePr(n),o.put_PlaceholderText(n.get_String()),this.api.asc_AddContentControlDatePicker(o)):"text"==t?(o=new AscCommon.CContentControlPr,s=new AscCommon.CSdtTextFormPr,e&&(e.reg?s.put_RegExpFormat(e.reg):e.mask&&s.put_MaskFormat(e.mask),e.placeholder&&o.put_PlaceholderText(e.placeholder),void 0!==e.fixed&&i.put_Fixed&&i.put_Fixed(e.fixed)),o.put_TextFormPr(s),o.put_FormPr(i),this.api.asc_AddContentControlTextForm(o)):"complex"==t&&this.api.asc_AddComplexForm(),a=this,setTimeout(function(){a.showSaveFormTip()},500),Common.NotificationCenter.trigger("edit:complete",this.toolbar))},onModeClick:function(t,e){var i;this.api&&(this.disableEditing(t),this.view&&this.view.setPreviewMode(t),(i=new AscCommon.CRestrictionSettings).put_OFormRole(e),this.api.asc_setRestriction(t?Asc.c_oAscRestrictionType.OnlyForms:Asc.c_oAscRestrictionType.None,i),this.api.asc_SetPerformContentControlActionByClick(t),this.api.asc_SetHighlightRequiredFields(t),t&&(this._state.lastViewRole=e)),Common.NotificationCenter.trigger("edit:complete",this.toolbar)},changeViewFormMode:function(t){this.view&&t!==this.view.btnViewFormRoles.isActive()&&(this.view.btnViewFormRoles.toggle(t,!0),this.onModeClick(t))},onClearClick:function(){this.api&&this.api.asc_ClearAllSpecialForms(),Common.NotificationCenter.trigger("edit:complete",this.toolbar)},onGoTo:function(t){this.api&&this.api.asc_MoveToFillingForm("next"==t),Common.NotificationCenter.trigger("edit:complete",this.toolbar)},onSubmitClick:function(){var t;this.api.asc_IsAllRequiredFormsFilled()?(this.api.asc_SendForm(),Common.NotificationCenter.trigger("edit:complete",this.toolbar)):Common.UI.warning({msg:(t=this).view.textRequired,callback:function(){t.api.asc_MoveToFillingForm(!0,!0,!0),Common.NotificationCenter.trigger("edit:complete",t.toolbar)}})},onSaveFormClick:function(){this.showRolesList(function(){this.isFromFormSaveAs=this.appConfig.canRequestSaveAs||!!this.appConfig.saveAsUrl,this.api.asc_DownloadAs(new Asc.asc_CDownloadOptions(Asc.c_oAscFileType.OFORM,this.isFromFormSaveAs))})},onDownloadUrl:function(t,e){var i,n,o;this.isFromFormSaveAs&&(0<(o=(n=(n=(i=this).getApplication().getController("Viewport").getView("Common.Views.Header").getDocumentCaption())||i.view.txtUntitled).lastIndexOf("."))&&(n=n.substring(0,o)+".oform"),i.appConfig.canRequestSaveAs?Common.Gateway.requestSaveAs(t,n,e):(i._saveCopyDlg=new Common.Views.SaveAsDlg({saveFolderUrl:i.appConfig.saveAsUrl,saveFileUrl:t,defFileName:n}),i._saveCopyDlg.on("saveaserror",function(t,e){Common.UI.warning({closable:!1,msg:e,callback:function(t){Common.NotificationCenter.trigger("edit:complete",i)}})}).on("close",function(t){i._saveCopyDlg=void 0}),i._saveCopyDlg.show())),this.isFromFormSaveAs=!1},disableEditing:function(t){this._state.DisabledEditing!=t&&(this._state.DisabledEditing=t,Common.NotificationCenter.trigger("editing:disable",t,{viewMode:!1,reviewMode:!1,fillFormMode:!0,allowMerge:!1,allowSignature:!1,allowProtect:!1,rightMenu:{clear:!1,disable:!0},statusBar:!0,leftMenu:{disable:!1,previewMode:!0},fileMenu:{info:!0},navigation:{disable:!1,previewMode:!0},comments:{disable:!1,previewMode:!0},chat:!1,review:!0,viewport:!1,documentHolder:{clear:!1,disable:!0},toolbar:!0,plugins:!0,protect:!0},"forms"))},onLongActionBegin:function(t,e){e==Asc.c_oAscAsyncAction.Submit&&this.view.btnSubmit&&(this._submitFail=!1,this.submitedTooltip&&this.submitedTooltip.hide(),this.view.btnSubmit.setDisabled(!0))},onLongActionEnd:function(t,e){e==Asc.c_oAscAsyncAction.Submit&&this.view.btnSubmit&&(this.view.btnSubmit.setDisabled(!1),this.submitedTooltip||(this.submitedTooltip=new Common.UI.SynchronizeTip({text:this.view.textSubmited,extCls:"no-arrow",showLink:!1,target:$(".toolbar"),placement:"bottom"}),this.submitedTooltip.on("closeclick",function(){this.submitedTooltip.hide()},this)),this._submitFail||this.submitedTooltip.show())},onError:function(t,e,i){t==Asc.c_oAscError.ID.Submit&&(this._submitFail=!0,this.submitedTooltip&&this.submitedTooltip.hide())},onAppReady:function(t){var e=this;new Promise(function(t,e){t()}).then(function(){t.isEdit&&t.canFeatureContentControl&&t.isFormCreator&&e.showCreateFormTip(),e.onRefreshRolesList(),e.onChangeProtectDocument()})},showCreateFormTip:function(){var t,e;Common.localStorage.getItem("de-hide-createform-tip")||(t=$(".toolbar").find(".ribtab [data-tab=forms]").parent(),(e=new Common.UI.SynchronizeTip({extCls:"colored",placement:"bottom-right",target:t,text:this.view.textCreateForm,showLink:!1,closable:!1,showButton:!0,textButton:this.view.textGotIt})).on({buttonclick:function(){Common.localStorage.setItem("de-hide-createform-tip",1),e.close()}}),e.show())},showSaveFormTip:function(){var t;!this.view.btnSaveForm||Common.localStorage.getItem("de-hide-saveform-tip")||this.tipSaveForm||((t=this).tipSaveForm=new Common.UI.SynchronizeTip({extCls:"colored",placement:"bottom-right",target:this.view.btnSaveForm.$el,text:this.view.tipSaveForm,showLink:!1,closable:!1,showButton:!0,textButton:this.view.textGotIt}),t.tipSaveForm.on({buttonclick:function(){Common.localStorage.setItem("de-hide-saveform-tip",1),t.tipSaveForm.close()}}),t.tipSaveForm.show())},onRefreshRolesList:function(t){var e;t||(e=this.api.asc_GetOForm())&&(t=e.asc_getAllRoles()),this._state.lastRoleInList=t&&0<t.length?t[t.length-1].asc_getSettings().asc_getName():void 0,this.view&&this.view.fillRolesMenu(t,this._state.lastViewRole)},onManagerClick:function(){var i=this;this.api.asc_GetOForm()&&new DE.Views.RolesManagerDlg({api:i.api,handler:function(t,e){Common.NotificationCenter.trigger("edit:complete",i.toolbar)},props:void 0}).on("close",function(t){}).show()},showRolesList:function(i){var n=this,t=this.api.asc_GetOForm();t&&new DE.Views.SaveFormDlg({handler:function(t,e){"ok"==t?i.call(n):Common.NotificationCenter.trigger("edit:complete",n.toolbar)},roles:t.asc_getAllRoles()}).show()},onActiveTab:function(t){"forms"!==t&&this.tipSaveForm&&this.tipSaveForm.close()},onChangeProtectDocument:function(t){var e;(t=t?t:(e=this.getApplication().getController("DocProtection"))?e.getDocProps():null)&&(this._state.docProtection=t,this.view&&(e=this.view.getButtons(),Common.Utils.lockControls(Common.enumLock.docLockView,t.isReadOnly,{array:e}),Common.Utils.lockControls(Common.enumLock.docLockForms,t.isFormsOnly,{array:e}),Common.Utils.lockControls(Common.enumLock.docLockReview,t.isReviewOnly,{array:e}),Common.Utils.lockControls(Common.enumLock.docLockComments,t.isCommentsOnly,{array:e})))}},DE.Controllers.FormsTab||{}))}),define("documenteditor/main/app/view/Links",["common/main/lib/util/utils","common/main/lib/component/BaseView","common/main/lib/component/Layout"],function(){"use strict";DE.Views.Links=Common.UI.BaseView.extend(_.extend({options:{},initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this),this.toolbar=t.toolbar,this.btnsPrevNote=[],this.btnsNextNote=[],this.btnsPrevEndNote=[],this.btnsNextEndNote=[],this.paragraphControls=[];var t=Common.enumLock,e=this.toolbar.$el;this.btnsContents=Common.Utils.injectButtons(e.find(".btn-slot.btn-contents"),"","toolbar__icon btn-big-contents",this.capBtnInsContents,[t.inHeader,t.richEditLock,t.plainEditLock,t.richDelLock,t.plainDelLock,t.previewReviewMode,t.viewFormMode,t.lostConnect,t.disableOnStart,t.docLockView,t.docLockForms,t.docLockComments],!0,!0,void 0,"1","bottom","small"),this.btnsNotes=Common.Utils.injectButtons(e.find(".btn-slot.slot-notes"),"","toolbar__icon btn-notes",this.capBtnInsFootnote,[t.paragraphLock,t.inEquation,t.inImage,t.inHeader,t.controlPlain,t.richEditLock,t.plainEditLock,t.previewReviewMode,t.viewFormMode,t.lostConnect,t.disableOnStart,t.docLockView,t.docLockForms,t.docLockComments],!0,!0,void 0,"1","bottom","small"),this.btnsHyperlink=Common.Utils.injectButtons(e.find(".btn-slot.slot-inshyperlink"),"","toolbar__icon btn-inserthyperlink",this.capBtnInsLink,[t.paragraphLock,t.headerLock,t.hyperlinkLock,t.previewReviewMode,t.viewFormMode,t.lostConnect,t.disableOnStart,t.docLockView,t.docLockForms,t.docLockComments],void 0,void 0,void 0,"1","bottom","small"),Array.prototype.push.apply(this.paragraphControls,this.btnsContents.concat(this.btnsNotes,this.btnsHyperlink)),this.btnContentsUpdate=new Common.UI.Button({parentEl:e.find("#slot-btn-contents-update"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-update",lock:[t.previewReviewMode,t.viewFormMode,t.lostConnect,t.disableOnStart,t.docLockView,t.docLockForms,t.docLockForms,t.docLockComments],caption:this.capBtnContentsUpdate,split:!0,menu:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"0, -8"}),this.paragraphControls.push(this.btnContentsUpdate),this.btnAddText=new Common.UI.Button({parentEl:e.find("#slot-btn-add-text"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-add-text",lock:[t.cantAddTextTOF,t.inHeader,t.inFootnote,t.previewReviewMode,t.viewFormMode,t.lostConnect,t.disableOnStart,t.docLockView,t.docLockForms,t.docLockComments],caption:this.capBtnAddText,menu:new Common.UI.Menu({items:[]}),dataHint:"1",dataHintDirection:"left",dataHintOffset:"medium"}),this.paragraphControls.push(this.btnAddText),this.btnBookmarks=new Common.UI.Button({parentEl:e.find("#slot-btn-bookmarks"),cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-bookmarks",lock:[t.paragraphLock,t.inHeader,t.headerLock,t.controlPlain,t.previewReviewMode,t.viewFormMode,t.lostConnect,t.disableOnStart,t.docLockView,t.docLockForms,t.docLockComments],caption:this.capBtnBookmarks,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.paragraphControls.push(this.btnBookmarks),this.btnCaption=new Common.UI.Button({parentEl:e.find("#slot-btn-caption"),cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-caption",lock:[t.inHeader,t.previewReviewMode,t.viewFormMode,t.lostConnect,t.disableOnStart,t.docLockView,t.docLockForms,t.docLockComments],caption:this.capBtnCaption,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.paragraphControls.push(this.btnCaption),this.btnCrossRef=new Common.UI.Button({parentEl:e.find("#slot-btn-crossref"),cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-cross-reference",lock:[t.paragraphLock,t.headerLock,t.controlPlain,t.richEditLock,t.plainEditLock,t.contentLock,t.previewReviewMode,t.viewFormMode,t.lostConnect,t.disableOnStart,t.docLockView,t.docLockForms,t.docLockComments],caption:this.capBtnCrossRef,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.paragraphControls.push(this.btnCrossRef),this.btnTableFigures=new Common.UI.Button({parentEl:e.find("#slot-btn-tof"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-contents",lock:[t.inHeader,t.richEditLock,t.plainEditLock,t.richDelLock,t.plainDelLock,t.previewReviewMode,t.viewFormMode,t.lostConnect,t.disableOnStart,t.docLockView,t.docLockForms,t.docLockComments],caption:this.capBtnTOF,dataHint:"1",dataHintDirection:"left",dataHintOffset:"medium"}),this.paragraphControls.push(this.btnTableFigures),this.btnTableFiguresUpdate=new Common.UI.Button({parentEl:e.find("#slot-btn-tof-update"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-update",lock:[t.paragraphLock,t.inHeader,t.richEditLock,t.plainEditLock,t.richDelLock,t.plainDelLock,t.cantUpdateTOF,t.previewReviewMode,t.viewFormMode,t.lostConnect,t.disableOnStart,t.docLockView,t.docLockForms,t.docLockComments],caption:this.capBtnContentsUpdate,dataHint:"1",dataHintDirection:"left",dataHintOffset:"medium"}),this.paragraphControls.push(this.btnTableFiguresUpdate),Common.Utils.lockControls(Common.enumLock.disableOnStart,!0,{array:this.paragraphControls}),this._state={disabled:!1}},render:function(t){return this},onAppReady:function(t){var n=this;new Promise(function(t,e){t()}).then(function(){var i=_.template('<a id="<%= id %>" tabindex="-1" type="menuitem" class="item-contents"><div id="<%= options.previewId %>"></div></a>');n.btnsContents.forEach(function(t){t.updateHint(n.tipContents);var e=new Common.UI.Menu({cls:"toc-menu shifted-left",items:[{template:i,offsety:0,value:0,previewId:"id-toolbar-toc-0"},{template:i,offsety:72,value:1,previewId:"id-toolbar-toc-1"},{caption:n.textContentsSettings,value:"settings"},{caption:n.textContentsRemove,value:"remove"}]});t.setMenu(e)}),n.contentsMenu=new Common.UI.Menu({cls:"toc-menu shifted-left",items:[{template:i,offsety:0,value:0,previewId:"id-toolbar-toc-menu-0"},{template:i,offsety:72,value:1,previewId:"id-toolbar-toc-menu-1"},{caption:n.textContentsSettings,value:"settings"},{caption:n.textContentsRemove,value:"remove"}]}),n.btnContentsUpdate.updateHint([n.textUpdateAll,n.tipContentsUpdate]),n.btnContentsUpdate.setMenu(new Common.UI.Menu({items:[{caption:n.textUpdateAll,value:"all"},{caption:n.textUpdatePages,value:"pages"}]})),n.btnAddText.updateHint(n.tipAddText),n.contentsUpdateMenu=new Common.UI.Menu({items:[{caption:n.textUpdateAll,value:"all"},{caption:n.textUpdatePages,value:"pages"}]}),n.btnsNotes.forEach(function(t,e){t.updateHint(n.tipNotes);var i=new Common.UI.Menu({items:[{caption:n.mniInsFootnote,value:"ins_footnote"},{caption:n.mniInsEndnote,value:"ins_endnote"},{caption:"--"},new Common.UI.MenuItem({template:Common.UI.isRTL()?_.template(['<div class="menu-zoom" style="height: 26px;" ',"<% if(!_.isUndefined(options.stopPropagation)) { %>",'data-stopPropagation="true"',"<% } %>",">",'<label class="title float-left">'+n.textGotoFootnote+"</label>",'<button id="id-menu-goto-footnote-prev-'+e+'" type="button" class="btn small btn-toolbar prev float-right"><i class="icon menu__icon btn-previtem">&nbsp;</i></button>','<button id="id-menu-goto-footnote-next-'+e+'" type="button" class="btn small btn-toolbar next float-right"><i class="icon menu__icon btn-nextitem">&nbsp;</i></button>',"</div>"].join("")):_.template(['<div class="menu-zoom" style="height: 26px;" ',"<% if(!_.isUndefined(options.stopPropagation)) { %>",'data-stopPropagation="true"',"<% } %>",">",'<label class="title float-left">'+n.textGotoFootnote+"</label>",'<button id="id-menu-goto-footnote-next-'+e+'" type="button" class="btn small btn-toolbar next float-right"><i class="icon menu__icon btn-nextitem">&nbsp;</i></button>','<button id="id-menu-goto-footnote-prev-'+e+'" type="button" class="btn small btn-toolbar prev float-right"><i class="icon menu__icon btn-previtem">&nbsp;</i></button>',"</div>"].join("")),stopPropagation:!0}),new Common.UI.MenuItem({template:Common.UI.isRTL()?_.template(['<div class="menu-zoom" style="height: 26px;" ',"<% if(!_.isUndefined(options.stopPropagation)) { %>",'data-stopPropagation="true"',"<% } %>",">",'<label class="title float-left">'+n.textGotoEndnote+"</label>",'<button id="id-menu-goto-endnote-prev-'+e+'" type="button" class="btn small btn-toolbar prev float-right"><i class="icon menu__icon btn-previtem">&nbsp;</i></button>','<button id="id-menu-goto-endnote-next-'+e+'" type="button" class="btn small btn-toolbar next float-right"><i class="icon menu__icon btn-nextitem">&nbsp;</i></button>',"</div>"].join("")):_.template(['<div class="menu-zoom" style="height: 26px;" ',"<% if(!_.isUndefined(options.stopPropagation)) { %>",'data-stopPropagation="true"',"<% } %>",">",'<label class="title float-left">'+n.textGotoEndnote+"</label>",'<button id="id-menu-goto-endnote-next-'+e+'" type="button" class="btn small btn-toolbar next float-right"><i class="icon menu__icon btn-nextitem">&nbsp;</i></button>','<button id="id-menu-goto-endnote-prev-'+e+'" type="button" class="btn small btn-toolbar prev float-right"><i class="icon menu__icon btn-previtem">&nbsp;</i></button>',"</div>"].join("")),stopPropagation:!0}),{caption:"--"},{caption:n.mniDelFootnote,value:"delele"},{caption:n.mniConvertNote,value:"convert",menu:new Common.UI.Menu({menuAlign:"tl-tr",items:[{caption:n.textConvertToEndnotes,value:"to-endnotes"},{caption:n.textConvertToFootnotes,value:"to-footnotes"},{caption:n.textSwapNotes,value:"swap"}]})},{caption:n.mniNoteSettings,value:"settings"}]});t.setMenu(i),n.btnsPrevNote.push(new Common.UI.Button({el:$("#id-menu-goto-footnote-prev-"+e),cls:"btn-toolbar"})),n.btnsNextNote.push(new Common.UI.Button({el:$("#id-menu-goto-footnote-next-"+e),cls:"btn-toolbar"})),n.btnsPrevEndNote.push(new Common.UI.Button({el:$("#id-menu-goto-endnote-prev-"+e),cls:"btn-toolbar"})),n.btnsNextEndNote.push(new Common.UI.Button({el:$("#id-menu-goto-endnote-next-"+e),cls:"btn-toolbar"}))}),n.btnsHyperlink.forEach(function(t){t.updateHint(n.tipInsertHyperlink+Common.Utils.String.platformKey("Ctrl+K"))}),n.btnBookmarks.updateHint(n.tipBookmarks),n.btnCaption.updateHint(n.tipCaption),n.btnCrossRef.updateHint(n.tipCrossRef),n.btnTableFigures.updateHint(n.tipTableFigures),n.btnTableFiguresUpdate.updateHint(n.tipTableFiguresUpdate),function(){var n=this;this.btnsContents.forEach(function(t){t.menu.on("item:click",function(t,e,i){n.fireEvent("links:contents",[e.value])}),t.on("click",function(t,e){n.fireEvent("links:contents",[0])}),t.menu.on("show:after",function(t,e){n.fireEvent("links:contents-open",[t])})}),this.contentsMenu.on("item:click",function(t,e,i){setTimeout(function(){n.fireEvent("links:contents",[e.value,!0])},10)}),this.contentsMenu.on("show:after",function(t,e){n.fireEvent("links:contents-open",[t])}),this.btnContentsUpdate.menu.on("item:click",function(t,e,i){n.fireEvent("links:update",[e.value])}),this.btnContentsUpdate.on("click",function(t,e){n.fireEvent("links:update",["all"])}),this.contentsUpdateMenu.on("item:click",function(t,e,i){setTimeout(function(){n.fireEvent("links:update",[e.value,!0])},10)}),this.btnAddText.menu.on("item:click",function(t,e,i){n.fireEvent("links:addtext",[e.value])}),this.btnAddText.menu.on("show:after",function(t,e){n.fireEvent("links:addtext-open",[t])}),this.btnsNotes.forEach(function(t){t.menu.on("item:click",function(t,e,i){n.fireEvent("links:notes",[e.value])}),t.on("click",function(t,e){n.fireEvent("links:notes",["ins_footnote"])}),t.menu.items[7].menu.on("item:click",function(t,e,i){n.fireEvent("links:notes",[e.value])})}),this.btnsPrevNote.forEach(function(t){t.on("click",function(t,e){n.fireEvent("links:notes",["prev"])})}),this.btnsNextNote.forEach(function(t){t.on("click",function(t,e){n.fireEvent("links:notes",["next"])})}),this.btnsPrevEndNote.forEach(function(t){t.on("click",function(t,e){n.fireEvent("links:notes",["prev-end"])})}),this.btnsNextEndNote.forEach(function(t){t.on("click",function(t,e){n.fireEvent("links:notes",["next-end"])})}),this.btnsHyperlink.forEach(function(t){t.on("click",function(t,e){n.fireEvent("links:hyperlink")})}),this.btnBookmarks.on("click",function(t,e){n.fireEvent("links:bookmarks")}),this.btnCaption.on("click",function(t,e){n.fireEvent("links:caption")}),this.btnCrossRef.on("click",function(t,e){n.fireEvent("links:crossref")}),this.btnTableFigures.on("click",function(t,e){n.fireEvent("links:tof")}),this.btnTableFiguresUpdate.on("click",function(t,e){n.fireEvent("links:tof-update")})}.call(n)})},fillAddTextMenu:function(t,e,i){e=Math.max(e||3,i+1),t.removeAll(),t.addItem(new Common.UI.MenuItem({caption:this.txtDontShowTof,value:-1,checkable:!0,checked:i<0,toggleGroup:"addTextGroup"}));for(var n=0;n<e;n++)t.addItem(new Common.UI.MenuItem({caption:n+1+" "+this.txtLevel,value:n,checkable:!0,checked:i===n,toggleGroup:"addTextGroup"}))},show:function(){Common.UI.BaseView.prototype.show.call(this),this.fireEvent("show",this)},getButtons:function(){return this.paragraphControls},SetDisabled:function(e){this._state.disabled=e,this.paragraphControls.forEach(function(t){t&&t.setDisabled(e)},this)}},DE.Views.Links||{}))}),define("documenteditor/main/app/view/NoteSettingsDialog",["common/main/lib/util/utils","common/main/lib/component/MetricSpinner","common/main/lib/component/ComboBox","common/main/lib/view/AdvancedSettingsWindow"],function(){"use strict";DE.Views.NoteSettingsDialog=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:300,height:395,id:"window-note-settings",buttons:null},initialize:function(t){var e=this;_.extend(this.options,{title:this.textTitle,template:['<div class="box" style="height:'+(e.options.height-85)+'px;">','<div class="content-panel" style="padding: 0 5px;"><div class="inner-content">','<div class="settings-panel active">','<table cols="1" style="width: 100%;">',"<tr>",'<td class="padding-small">','<label class="header">',e.textLocation,"</label>","</td>","</tr>","<tr>",'<td class="padding-small">','<div id="note-settings-radio-foot" style="margin-top: 4px;display: inline-block"></div>','<div id="note-settings-combo-footnote" class="input-group-nr float-right" style="display: inline-block; width:150px;"></div>',"</td>","</tr>","<tr>",'<td class="padding-large">','<div id="note-settings-radio-end" style="margin-top: 4px;display: inline-block"></div>','<div id="note-settings-combo-endnote" class="input-group-nr float-right" style="display: inline-block; width:150px;"></div>',"</td>","</tr>","<tr>",'<td class="padding-small">','<label class="header">',e.textFormat,"</label>","</td>","</tr>","<tr>",'<td class="padding-small">','<div class="margin-right-10" style="display: inline-block; vertical-align: middle;">','<label class="input-label">',e.textNumFormat,"</label>",'<div id="note-settings-combo-format" class="input-group-nr" style="width:150px;"></div>',"</div>",'<div style="display: inline-block; vertical-align: middle;">','<label class="input-label">',e.textStart,"</label>",'<div id="note-settings-spin-start"></div>',"</div>","</td>","</tr>","<tr>",'<td class="padding-small">','<label class="input-label">',e.textNumbering,"</label>",'<div id="note-settings-combo-numbering" class="input-group-nr" style="width:150px;"></div>',"</td>","</tr>","<tr>",'<td class="padding-large">','<label class="input-label">',e.textCustom,"</label>",'<div id="note-settings-txt-custom"></div>',"</td>","</tr>","<tr>",'<td class="padding-small">','<label class="header">',e.textApplyTo,"</label>",'<div id="note-settings-combo-apply" class="input-group-nr" style="width:150px;"></div>',"</td>","</tr>","</table>","</div></div>","</div>","</div>",'<div class="footer center">','<button class="btn normal dlg-btn primary" result="insert" style="width: 86px;">'+e.textInsert+"</button>",'<button id="note-settings-btn-apply" class="btn normal dlg-btn" result="apply" style="width: 86px;">'+e.textApply+"</button>",'<button class="btn normal dlg-btn" result="cancel" style="width: 86px;">'+e.cancelButtonText+"</button>","</div>"].join("")},t),this.api=t.api,this.handler=t.handler,this.props=t.props,this.isEndNote=t.isEndNote||!1,this.hasSections=t.hasSections||!1,Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options),this._state={footnote:{numbering:Asc.c_oAscFootnoteRestart.Continuous,format:Asc.c_oAscNumberingFormat.Decimal,start:1},endnote:{numbering:Asc.c_oAscFootnoteRestart.Continuous,format:Asc.c_oAscNumberingFormat.LowerRoman,start:1}}},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var o=this,t=(this.radioFootnote=new Common.UI.RadioBox({el:$("#note-settings-radio-foot"),name:"asc-radio-notes",labelText:this.textFootnote,checked:!0}),this.radioFootnote.on("change",function(t,e,i){e&&(o.changeNoteType(!1),setTimeout(function(){o.cmbFootnote.focus()},1))}),this.radioEndnote=new Common.UI.RadioBox({el:$("#note-settings-radio-end"),labelText:this.textEndnote,name:"asc-radio-notes"}),this.radioEndnote.on("change",function(t,e,i){e&&(o.changeNoteType(!0),setTimeout(function(){o.cmbEndnote.focus()},1))}),this.cmbFootnote=new Common.UI.ComboBox({el:$("#note-settings-combo-footnote"),cls:"input-group-nr",menuStyle:"min-width: 150px;",editable:!1,takeFocusOnClose:!0,data:[{displayValue:this.textPageBottom,value:Asc.c_oAscFootnotePos.PageBottom},{displayValue:this.textTextBottom,value:Asc.c_oAscFootnotePos.BeneathText}]}),this.cmbFootnote.setValue(Asc.c_oAscFootnotePos.PageBottom),this.cmbEndnote=new Common.UI.ComboBox({el:$("#note-settings-combo-endnote"),cls:"input-group-nr",menuStyle:"min-width: 150px;",editable:!1,takeFocusOnClose:!0,data:[{displayValue:this.textSectEnd,value:Asc.c_oAscEndnotePos.SectEnd},{displayValue:this.textDocEnd,value:Asc.c_oAscEndnotePos.DocEnd}]}),this.cmbEndnote.setValue(Asc.c_oAscEndnotePos.DocEnd),this.cmbFormat=new Common.UI.ComboBox({el:$("#note-settings-combo-format"),cls:"input-group-nr",menuStyle:"min-width: 150px;",editable:!1,takeFocusOnClose:!0,data:[{displayValue:"1, 2, 3,...",value:Asc.c_oAscNumberingFormat.Decimal,maskExp:/[0-9]/,defValue:1},{displayValue:"a, b, c,...",value:Asc.c_oAscNumberingFormat.LowerLetter,maskExp:/[a-z]/,defValue:"a"},{displayValue:"A, B, C,...",value:Asc.c_oAscNumberingFormat.UpperLetter,maskExp:/[A-Z]/,defValue:"A"},{displayValue:"i, ii, iii,...",value:Asc.c_oAscNumberingFormat.LowerRoman,maskExp:/[ivxlcdm]/,defValue:"i"},{displayValue:"I, II, III,...",value:Asc.c_oAscNumberingFormat.UpperRoman,maskExp:/[IVXLCDM]/,defValue:"I"}]}),this.cmbFormat.setValue(this._state.footnote.format),this.cmbFormat.on("selected",_.bind(this.onFormatSelect,this)),this.spnStart=new Common.UI.CustomSpinner({el:$("#note-settings-spin-start"),step:1,width:85,defaultUnit:"",value:1,maxValue:16383,minValue:1,allowDecimal:!1,maskExp:/[0-9]/}),this.spnStart.on("change",function(t,e,i,n){1<t.getNumberValue()&&o.cmbNumbering.getValue()!==Asc.c_oAscFootnoteRestart.Continuous&&o.cmbNumbering.setValue(Asc.c_oAscFootnoteRestart.Continuous)}),this._arrNumbering=[{displayValue:this.textContinue,value:Asc.c_oAscFootnoteRestart.Continuous},{displayValue:this.textEachSection,value:Asc.c_oAscFootnoteRestart.EachSect},{displayValue:this.textEachPage,value:Asc.c_oAscFootnoteRestart.EachPage}],this.cmbNumbering=new Common.UI.ComboBox({el:$("#note-settings-combo-numbering"),cls:"input-group-nr",menuStyle:"min-width: 150px;",editable:!1,takeFocusOnClose:!0,data:this._arrNumbering}),this.cmbNumbering.setValue(Asc.c_oAscFootnoteRestart.Continuous),this.cmbNumbering.on("selected",function(t,e){e.value!=Asc.c_oAscFootnoteRestart.EachSect&&e.value!=Asc.c_oAscFootnoteRestart.EachPage||o.spnStart.setValue(1,!0)}),this.txtCustom=new Common.UI.InputField({el:$("#note-settings-txt-custom"),allowBlank:!0,validateOnChange:!0,validateOnBlur:!1,style:"width: 85px; vertical-align: middle;",value:""}).on("changing",function(t,e){o.cmbFormat.setDisabled(0<e.length),o.spnStart.setDisabled(0<e.length),o.btnApply.setDisabled(0<e.length)}),this.hasSections?[{displayValue:this.textSection,value:0}]:[]);t.push({displayValue:this.textDocument,value:1}),this.cmbApply=new Common.UI.ComboBox({el:$("#note-settings-combo-apply"),cls:"input-group-nr",menuStyle:"min-width: 150px;",editable:!1,takeFocusOnClose:!0,data:t}),this.cmbApply.setValue(t[0].value),this.btnApply=new Common.UI.Button({el:$("#note-settings-btn-apply")}),this.afterRender()},getFocusedComponents:function(){return[this.radioFootnote,this.cmbFootnote,this.radioEndnote,this.cmbEndnote,this.cmbFormat,this.spnStart,this.cmbNumbering,this.txtCustom,this.cmbApply]},getDefaultFocusableComponent:function(){return this.cmbFormat},afterRender:function(){this._setDefaults(this.props)},_setDefaults:function(t){var e;(this.isEndNote?this.radioEndnote:this.radioFootnote).setValue(!0,!0),this.changeNoteType(this.isEndNote),t&&(e=t.get_Pos(),(this.isEndNote?this.cmbEndnote:this.cmbFootnote).setValue(e),e=t.get_NumFormat(),this.cmbFormat.setValue(e),this.onFormatSelect(this.cmbFormat,this.cmbFormat.getSelectedRecord()),e=t.get_NumStart(),this.spnStart.setValue(e),e=t.get_NumRestart(),this.cmbNumbering.setValue(e))},getSettings:function(){var t=new Asc.CAscFootnotePr,e=(t.put_Pos((this.isEndNote?this.cmbEndnote:this.cmbFootnote).getValue()),t.put_NumRestart(this.cmbNumbering.getValue()),this.txtCustom.getValue());return _.isEmpty(e)&&(e=this.cmbFormat.getValue(),t.put_NumFormat(e),t.put_NumStart(this.spnStart.getNumberValue())),{props:t,applyToAll:1==this.cmbApply.getValue(),custom:_.isEmpty(e)?void 0:e,isEndNote:this.isEndNote}},onDlgBtnClick:function(t){this._handleInput("object"==typeof t?t.currentTarget.attributes.result.value:t)},onPrimary:function(){return this._handleInput("insert"),!1},_handleInput:function(t){this.handler&&this.handler.call(this,t,"insert"==t||"apply"==t?this.getSettings():void 0),this.close()},onFormatSelect:function(t,e){if(e){this.spnStart.setMask(e.maskExp);var i=this;switch(e.value){case Asc.c_oAscNumberingFormat.UpperRoman:this.spnStart.options.toCustomFormat=this._10toRome,this.spnStart.options.fromCustomFormat=this._Rometo10;break;case Asc.c_oAscNumberingFormat.LowerRoman:this.spnStart.options.toCustomFormat=function(t){return i._10toRome(t).toLocaleLowerCase()},this.spnStart.options.fromCustomFormat=function(t){return i._Rometo10(t.toLocaleUpperCase())};break;case Asc.c_oAscNumberingFormat.UpperLetter:this.spnStart.options.toCustomFormat=this._10toS,this.spnStart.options.fromCustomFormat=this._Sto10;break;case Asc.c_oAscNumberingFormat.LowerLetter:this.spnStart.options.toCustomFormat=function(t){return i._10toS(t).toLocaleLowerCase()},this.spnStart.options.fromCustomFormat=function(t){return i._Sto10(t.toLocaleUpperCase())};break;default:this.spnStart.options.toCustomFormat=function(t){return t},this.spnStart.options.fromCustomFormat=function(t){return t}}this.spnStart.setValue(this.spnStart.getValue()),this._state[this.isEndNote?"endnote":"footnote"].format=e.value}},_10toS:function(t){t=parseInt(t);for(var e=Math.ceil(t/26),i=String.fromCharCode((t-1)%26+"A".charCodeAt(0)),n="",o=0;o<e;o++)n+=i;return n},_Sto10:function(t){var e;return t.length<1||new RegExp("[^"+t.charAt(0)+"]").test(t)||!/[A-Z]/.test(t)?1:(e=t.length-1,t.charCodeAt(0)-"A".charCodeAt(0)+1+26*e)},_10toRome:function(t){t=parseInt(t);for(var e="",i=[["M",1e3],["CM",900],["D",500],["CD",400],["C",100],["XC",90],["L",50],["XL",40],["X",10],["IX",9],["V",5],["IV",4],["I",1]],n=i[0][1],o=Math.floor(t/n),s=0,a=0;a<o;a++)e+=i[s][0];for(t-=o*n,s++;0<t;)0<=(o=t-i[s][1])?(e+=i[s][0],t=o):s++;return e},_Rometo10:function(t){if(!/[IVXLCDM]/.test(t)||t.length<1)return 1;for(var e={I:1,V:5,X:10,L:50,C:100,D:500,M:1e3},i=t.length-1,n=e[t.charAt(i)],o=n,s=i-1;0<=s;s--){var a=e[t.charAt(s)];if(a<o){if(10<o/a)return 1;a*=-1}n+=a,o=Math.abs(a)}return n},changeNoteType:function(t){this._state[this.isEndNote?"endnote":"footnote"].start=this.spnStart.getNumberValue(),this._state[this.isEndNote?"endnote":"footnote"].numbering=this.cmbNumbering.getValue(),this.isEndNote=t,this.cmbFootnote.setDisabled(t),this.cmbEndnote.setDisabled(!t);var e=this._state[t?"endnote":"footnote"],t=t?this._arrNumbering.slice(0,2):this._arrNumbering;this.cmbNumbering.setData(t),this.cmbNumbering.setValue(e.numbering),this.cmbFormat.setValue(e.format),this.onFormatSelect(this.cmbFormat,this.cmbFormat.getSelectedRecord()),this.spnStart.setValue(e.start)}},DE.Views.NoteSettingsDialog||{}))}),define("documenteditor/main/app/view/TableOfContentsSettings",["common/main/lib/util/utils","common/main/lib/component/MetricSpinner","common/main/lib/component/ComboBox","common/main/lib/view/AdvancedSettingsWindow"],function(){"use strict";DE.Views.TableOfContentsSettings=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:500,height:460,id:"window-table-contents"},initialize:function(t){var e=t.type?385:460;_.extend(this.options,{title:t.type?this.textTitleTOF:this.textTitle,height:e,template:['<div class="box" style="height:'+(e-85)+'px;">','<div class="content-panel" style="padding: 15px 10px;"><div class="inner-content">','<div class="settings-panel active">','<table cols="2" style="width: 100%;">',"<tr>",'<td class="padding-small">','<div id="tableofcontents-chb-pages"></div>',"</td>",'<td rowspan="5" class="padding-small" style="vertical-align: top;">','<div class="canvas-box float-right" style="width: 240px; height: 182px; position:relative; overflow:hidden;">','<div id="tableofcontents-img" style="width: 230px; height: 100%;"></div>',"</div>","</td>","</tr>","<tr>",'<td class="padding-small">','<div id="tableofcontents-chb-align"></div>',"</td>","</tr>","<tr>",'<td class="padding-large">','<label class="input-label">'+this.textLeader+"</label>",'<div id="tableofcontents-combo-leader" class="input-group-nr margin-left-10" style="display: inline-block; width:95px;"></div>',"</td>","</tr>","<tr>",'<td class="padding-large">','<div id="tableofcontents-chb-links"></div>',"</td>","</tr>","<tr>",'<td class="padding-small">',"<% if (type == 1) { %>",'<label class="input-label padding-small" style="display: block;">'+this.textBuildTableOF+"</label>",'<div id="tableofcontents-radio-caption" class="padding-small" style="display: block;"></div>','<div id="tableofcontents-radio-style" class="" style="display: block;"></div>',"<% } else { %>",'<label class="input-label padding-small" style="display: block;">'+this.textBuildTable+"</label>",'<div id="tableofcontents-radio-levels" class="padding-small" style="display: block;"></div>','<div id="tableofcontents-radio-styles" class="" style="display: block;"></div>',"<% } %>","</td>","</tr>","<tr>",'<td class="padding-small" style="vertical-align: top;">',"<% if (type == 1) { %>",'<div id="tableofcontents-tof-from-caption" style="width:220px;">','<div id="tableofcontents-combo-captions" style="display: inline-block; width:129px; margin-bottom: 10px;"></div>',"</div>",'<div id="tableofcontents-tof-from-style" style="width:220px;" class="hidden">','<div id="tableofcontents-combo-tof-styles" style="display: inline-block; width:129px; margin-bottom: 10px;"></div>',"</div>",'<div id="tableofcontents-chb-full-caption"></div>',"<% } else { %>",'<div id="tableofcontents-from-levels" style="width:220px;">','<label class="input-label">'+this.textLevels+"</label>",'<div id="tableofcontents-spin-levels" class="margin-left-10" style="display: inline-block; width:95px;"></div>',"</div>",'<div id="tableofcontents-from-styles" class="hidden">',"<table>","<tr>","<td>",'<div id="tableofcontents-styles-list" class="header-styles-tableview" style="width:100%; height: 143px;"></div>',"</td>","</tr>","</table>","</div>","<% } %>","</td>",'<td class="padding-small" style="vertical-align: top;">','<label class="input-label margin-left-10">'+this.textStyles+"</label>",'<div id="tableofcontents-combo-styles" class="input-group-nr margin-left-10" style="display: inline-block; width:95px;"></div>',"</td>","</tr>","</table>","</div></div>","</div>","</div>",'<div class="separator horizontal"></div>'].join("")},t),this.api=t.api,this.handler=t.handler,this.props=t.props,this.type=t.type||0,this.startLevel=1,this.endLevel=3,this.isInitStylesListHeaders=!1,this._noApply=!0,this._originalProps=null,Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var n=this,t=(this.chPages=new Common.UI.CheckBox({el:$("#tableofcontents-chb-pages"),labelText:this.strShowPages,value:"checked"}),this.chPages.on("change",_.bind(function(t,e,i,n){var o,t="checked"==t.getValue(),s=1==this.type&&this.cmbStyles.getValue()==Asc.c_oAscTOFStylesType.Centered;this.chAlign.setDisabled(!t||s),this.cmbLeader.setDisabled(!t||s),this.api&&!this._noApply&&((o=this._originalProps||new Asc.CTableOfContentsPr).put_ShowPageNumbers(t),t&&!s&&(o.put_RightAlignTab("checked"==this.chAlign.getValue()),o.put_TabLeader(this.cmbLeader.getValue())),1==this.type?this.api.SetDrawImagePlaceTableOfFigures("tableofcontents-img",o):this.api.SetDrawImagePlaceContents("tableofcontents-img",o),this.scrollerY.update())},this)),this.chAlign=new Common.UI.CheckBox({el:$("#tableofcontents-chb-align"),labelText:this.strAlign,value:"checked"}),this.chAlign.on("change",_.bind(function(t,e,i,n){var o,t="checked"==t.getValue();this.cmbLeader.setDisabled(!t),this.api&&!this._noApply&&((o=this._originalProps||new Asc.CTableOfContentsPr).put_RightAlignTab(t),t&&o.put_TabLeader(this.cmbLeader.getValue()),1==this.type?this.api.SetDrawImagePlaceTableOfFigures("tableofcontents-img",o):this.api.SetDrawImagePlaceContents("tableofcontents-img",o),this.scrollerY.update())},this)),this.cmbLeader=new Common.UI.ComboBox({el:$("#tableofcontents-combo-leader"),style:"width: 85px;",menuStyle:"min-width: 85px;",editable:!1,takeFocusOnClose:!0,cls:"input-group-nr",data:[{value:Asc.c_oAscTabLeader.None,displayValue:this.textNone},{value:Asc.c_oAscTabLeader.Dot,displayValue:"...................."},{value:Asc.c_oAscTabLeader.Hyphen,displayValue:"-----------------"},{value:Asc.c_oAscTabLeader.Underscore,displayValue:"__________"}]}),this.cmbLeader.setValue(Asc.c_oAscTabLeader.Dot),this.cmbLeader.on("selected",_.bind(function(t,e){var i;this.api&&!this._noApply&&((i=this._originalProps||new Asc.CTableOfContentsPr).put_TabLeader(e.value),1==this.type?this.api.SetDrawImagePlaceTableOfFigures("tableofcontents-img",i):this.api.SetDrawImagePlaceContents("tableofcontents-img",i),this.scrollerY.update())},this)),this.chLinks=new Common.UI.CheckBox({el:$("#tableofcontents-chb-links"),labelText:1==this.type?this.strLinksOF:this.strLinks,value:"checked"}),this.chLinks.on("change",_.bind(function(t,e,i,n){var o;this.api&&!this._noApply&&((o=this._originalProps||new Asc.CTableOfContentsPr).put_Hyperlink("checked"==t.getValue()),1==this.type?this.api.SetDrawImagePlaceTableOfFigures("tableofcontents-img",o):this.api.SetDrawImagePlaceContents("tableofcontents-img",o),this.scrollerY.update())},this)),1==this.type?(this.radioCaption=new Common.UI.RadioBox({el:$("#tableofcontents-radio-caption"),labelText:this.textRadioCaption,name:"asc-radio-content-tof-build",checked:!0}),this.radioCaption.on("change",_.bind(function(t,e,i){e&&(this.captionContainer.toggleClass("hidden",!e),this.styleContainer.toggleClass("hidden",e),this.changeCaption(this.cmbCaptions.getSelectedRecord()),this.disableButtons())},this)),this.radioStyle=new Common.UI.RadioBox({el:$("#tableofcontents-radio-style"),labelText:this.textRadioStyle,name:"asc-radio-content-tof-build"}),this.radioStyle.on("change",_.bind(function(t,e,i){e&&(this.styleContainer.toggleClass("hidden",!e),this.captionContainer.toggleClass("hidden",e),this.changeTOFStyle(this.cmbTOFStyles.getSelectedRecord()),this.disableButtons())},this)),this.cmbCaptions=new Common.UI.ComboBox({el:$("#tableofcontents-combo-captions"),cls:"input-group-nr",menuStyle:"min-width: 100%;max-height: 233px;",editable:!1,takeFocusOnClose:!0,data:[]}),this.cmbCaptions.on("selected",_.bind(function(t,e){this.changeCaption(e),this.disableButtons()},this)),this.cmbTOFStyles=new Common.UI.ComboBox({el:$("#tableofcontents-combo-tof-styles"),cls:"input-group-nr",menuStyle:"min-width: 100%;max-height: 233px;",editable:!1,takeFocusOnClose:!0,data:[]}),this.cmbTOFStyles.on("selected",_.bind(function(t,e){this.changeTOFStyle(e)},this)),this.chFullCaption=new Common.UI.CheckBox({el:$("#tableofcontents-chb-full-caption"),labelText:this.strFullCaption,value:"checked"}),this.chFullCaption.on("change",_.bind(function(t,e,i,n){var o;this.api&&!this._noApply&&((o=this._originalProps||new Asc.CTableOfContentsPr).put_IncludeLabelAndNumber("checked"==t.getValue()),this.api.SetDrawImagePlaceTableOfFigures("tableofcontents-img",o),this.scrollerY.update())},this)),this.captionContainer=$("#tableofcontents-tof-from-caption"),this.styleContainer=$("#tableofcontents-tof-from-style")):(this.radioLevels=new Common.UI.RadioBox({el:$("#tableofcontents-radio-levels"),labelText:this.textRadioLevels,name:"asc-radio-content-build",checked:!0}),this.radioLevels.on("change",_.bind(function(t,e,i){e&&(this.levelsContainer.toggleClass("hidden",!e),this.stylesContainer.toggleClass("hidden",e),(this._needUpdateOutlineLevels||this._forceUpdateOutlineLevels)&&this.synchronizeLevelsFromStyles(!0))},this)),this.radioStyles=new Common.UI.RadioBox({el:$("#tableofcontents-radio-styles"),labelText:this.textRadioStyles,name:"asc-radio-content-build"}),this.radioStyles.on("change",_.bind(function(t,e,i){e&&(this.stylesContainer.toggleClass("hidden",!e),this.levelsContainer.toggleClass("hidden",e),e&&!this.isInitStylesListHeaders&&(this.initListHeaders(),this.stylesList.setOffsetFromHeader(!0),this.isInitStylesListHeaders=!0),this._needUpdateStyles&&this.synchronizeLevelsFromOutline(),this.stylesList.scroller.update({alwaysVisibleY:!0}),setTimeout(function(){var t=n.stylesLevels.findWhere({checked:!0});t&&n.stylesList.scrollToRecord(t)},10))},this)),this.spnLevels=new Common.UI.CustomSpinner({el:$("#tableofcontents-spin-levels"),step:1,width:85,defaultUnit:"",value:this.endLevel,maxValue:9,minValue:1,allowDecimal:!1,maskExp:/[1-9]/}),this.spnLevels.on("change",_.bind(this.onLevelsChange,this)),this.stylesLevels=new Common.UI.DataViewStore,this.stylesLevels&&(this.stylesList=new Common.UI.ListView({el:$("#tableofcontents-styles-list",this.$window),store:this.stylesLevels,simpleAddMode:!0,showLast:!1,tabindex:1,headers:[{name:n.textStyle,width:144,style:Common.UI.isRTL()?"margin-right: 16px;":"margin-left: 16px;"},{name:n.textLevel}],template:_.template(['<div class="listview inner" style=""></div>'].join("")),itemTemplate:_.template(['<div id="<%= id %>" class="list-item">','<div class="<% if (checked) { %>checked<% } %>"><%= Common.Utils.String.htmlEncode(displayValue) %></div>',"<div>",'<div class="input-field" style="width:40px;"><input type="text" class="form-control text-align-right" value="<%= value %>" maxLength="1">',"</div>","</div>","</div>"].join(""))}),this.stylesList.on("item:change",_.bind(this.onItemChange,this)),this.stylesList.on("item:add",_.bind(this.addEvents,this))),this.levelsContainer=$("#tableofcontents-from-levels"),this.stylesContainer=$("#tableofcontents-from-styles")),1==this.type?[{displayValue:this.txtCurrent,value:Asc.c_oAscTOFStylesType.Current},{displayValue:this.txtSimple,value:Asc.c_oAscTOFStylesType.Simple},{displayValue:this.txtOnline,value:Asc.c_oAscTOFStylesType.Web},{displayValue:this.txtClassic,value:Asc.c_oAscTOFStylesType.Classic},{displayValue:this.txtDistinctive,value:Asc.c_oAscTOFStylesType.Distinctive},{displayValue:this.txtCentered,value:Asc.c_oAscTOFStylesType.Centered},{displayValue:this.txtFormal,value:Asc.c_oAscTOFStylesType.Formal}]:[{displayValue:this.txtCurrent,value:Asc.c_oAscTOCStylesType.Current},{displayValue:this.txtSimple,value:Asc.c_oAscTOCStylesType.Simple},{displayValue:this.txtOnline,value:Asc.c_oAscTOCStylesType.Web},{displayValue:this.txtStandard,value:Asc.c_oAscTOCStylesType.Standard},{displayValue:this.txtModern,value:Asc.c_oAscTOCStylesType.Modern},{displayValue:this.txtClassic,value:Asc.c_oAscTOCStylesType.Classic}]);this.cmbStyles=new Common.UI.ComboBox({el:$("#tableofcontents-combo-styles"),cls:"input-group-nr",menuStyle:"min-width: 95px;",editable:!1,takeFocusOnClose:!0,data:t}),this.cmbStyles.setValue((1==this.type?Asc.c_oAscTOFStylesType:Asc.c_oAscTOCStylesType).Current),this.cmbStyles.on("selected",_.bind(function(t,e){var i;this.api&&!this._noApply&&((i=this._originalProps||new Asc.CTableOfContentsPr).put_StylesType(e.value),1==this.type&&(e=e.value!==Asc.c_oAscTOFStylesType.Centered,this.chAlign.setValue(e,!0),this.chAlign.setDisabled(!e),this.cmbLeader.setDisabled(!e),i.put_RightAlignTab(e),e&&i.put_TabLeader(this.cmbLeader.getValue())),1==this.type?this.api.SetDrawImagePlaceTableOfFigures("tableofcontents-img",i):this.api.SetDrawImagePlaceContents("tableofcontents-img",i),this.scrollerY.update())},this)),this.scrollerY=new Common.UI.Scroller({el:this.$window.find("#tableofcontents-img").parent(),minScrollbarLength:20}),this.scrollerY.update(),this.scrollerY.scrollTop(0),this.btnOk=new Common.UI.Button({el:this.$window.find(".primary")}),this.afterRender()},getFocusedComponents:function(){return[this.chPages,this.chAlign,this.cmbLeader,this.chLinks,this.radioLevels,this.radioStyles,this.spnLevels,this.stylesList,this.cmbStyles,this.radioCaption,this.radioStyle,this.cmbCaptions,this.cmbTOFStyles,this.chFullCaption]},getDefaultFocusableComponent:function(){return this.chPages},afterRender:function(){this._setDefaults(this.props)},close:function(){1==this.type?this.api.SetDrawImagePlaceTableOfFigures(null):this.api.SetDrawImagePlaceContents(null),this.scrollerY.update(),Common.Views.AdvancedSettingsWindow.prototype.close.apply(this)},_setDefaults:function(t){var e;this._noApply=!0,t&&(e=t.get_Hyperlink(),this.chLinks.setValue(null!=e?e:"indeterminate",!0),e=t.get_StylesType(),this.cmbStyles.setValue(null!==e?e:Asc.c_oAscTOCStylesType.Current),e=t.get_ShowPageNumbers(),this.chPages.setValue(null!=e?e:"indeterminate"),"checked"==this.chPages.getValue()?(e=t.get_RightAlignTab(),this.chAlign.setValue(null!=e?e:"indeterminate"),"checked"==this.chAlign.getValue()&&void 0!==(e=t.get_TabLeader())&&this.cmbLeader.setValue(e)):1==this.type&&this.cmbStyles.getValue()==Asc.c_oAscTOFStylesType.Centered&&this.chAlign.setValue(!1)),1==this.type?this.fillTOFProps(t):this.fillTOCProps(t),this._originalProps=t||new Asc.CTableOfContentsPr,t||(1==this.type?(this._originalProps.put_Caption(this.textFigure),this._originalProps.put_IncludeLabelAndNumber("checked"==this.chFullCaption.getValue())):this._originalProps.put_OutlineRange(this.startLevel,this.endLevel),this._originalProps.put_Hyperlink("checked"==this.chLinks.getValue()),this._originalProps.put_ShowPageNumbers("checked"==this.chPages.getValue()),"checked"==this.chPages.getValue()&&(this._originalProps.put_RightAlignTab("checked"==this.chAlign.getValue()),this._originalProps.put_TabLeader(this.cmbLeader.getValue()))),1==this.type?this.api.SetDrawImagePlaceTableOfFigures("tableofcontents-img",this._originalProps):this.api.SetDrawImagePlaceContents("tableofcontents-img",this._originalProps),this.scrollerY.update(),this._noApply=!1},initListHeaders:function(){var t=this.stylesList.headerEl.find(".table-header-item"),e=this.stylesList.headerEl.width(),i=$(t[0]).width(),n=parseFloat($(t[0]).css("margin-left")),o=($(t[0]).addClass("hidden"),$(t[1]).width());$(t[0]).removeClass("hidden"),e<n+i+o&&this.stylesList.setHeaderWidth(0,e-o-n)},fillTOCProps:function(t){var n=this,e=this.api.asc_GetStylesArray(),o=[],i=!1;if(_.each(e,function(t){var e=t.get_Name(),i=n.api.asc_GetHeadingLevel(e);(t.get_QFormat()||0<=i)&&o.push({name:e,displayValue:t.get_TranslatedName(),allowSelected:!1,checked:!1,value:"",headerLevel:0<=i?i+1:-1})}),t){for(var e=t.get_OutlineStart(),s=t.get_OutlineEnd(),a=t.get_StylesCount(),l=(this.startLevel=e,this.endLevel=s,(e<0||s<0)&&a<1&&(e=1,this.spnLevels.setValue(s=9,!0)),!1),r=0;r<a;r++){var c=t.get_StyleName(r),d=t.get_StyleLevel(r);(u=_.findWhere(o,{name:c}))?(u.checked=!0,u.value=d,u.headerLevel!==d&&(l=!0)):(o.push({name:c,displayValue:c,allowSelected:!1,checked:!0,value:d,headerLevel:-1}),l=!0)}if(0<e&&0<s)for(r=e;r<=s;r++)(u=_.findWhere(o,{headerLevel:r}))&&(u.checked=!0,u.value=r);for(var h=-1,m=-1,p=-1,r=0;r<9;r++){var u=_.findWhere(o,{headerLevel:r+1});if(u)if(u.headerLevel==(d=u.value)){if(!(p<1)){h=m=-1,l=!0;break}h<1&&(h=d),m=d}else{if(u.checked){h=m=-1,l=!0;break}0<h&&(p=r+1)}}this.spnLevels.setValue(0<m?m:"",!0),i=l||1<h}else for(r=this.startLevel;r<=this.endLevel;r++)(u=_.findWhere(o,{headerLevel:r}))&&(u.checked=!0,u.value=r);o.sort(function(t,e){t=t.displayValue.toLocaleLowerCase(),e=e.displayValue.toLocaleLowerCase();return t<e?-1:e<t?1:0}),this.stylesLevels.reset(o),i&&(this._forceUpdateOutlineLevels=!0,this.radioStyles.setValue(!0),this.stylesList.scroller.update({alwaysVisibleY:!0}),(u=this.stylesLevels.findWhere({checked:!0}))&&this.stylesList.scrollToRecord(u))},fillTOFProps:function(t){var e,i,n=!0,o=Common.Utils.InternalSettings.get("de-settings-captions");null==o&&(o=Common.localStorage.getItem("de-settings-captions")||"",Common.Utils.InternalSettings.set("de-settings-captions",o)),(o=(o=o?JSON.parse(o):[]).concat([{value:this.textEquation,displayValue:this.textEquation},{value:this.textFigure,displayValue:this.textFigure},{value:this.textTable,displayValue:this.textTable}])).sort(function(t,e){t=t.displayValue.toLowerCase(),e=e.displayValue.toLowerCase();return e<t?1:t<e?-1:0}),o=[{value:null,displayValue:this.textNone}].concat(o),this.cmbCaptions.setData(o),t&&(n=!!t.get_Caption(),(i=this.cmbCaptions.store.findWhere({value:t.get_Caption()}))&&(e=i.get("value"))),0<o.length&&this.cmbCaptions.setValue(e||this.textFigure),o=[],_.each(this.api.asc_getAllUsedParagraphStyles(),function(t,e){o.push({displayValue:t.get_TranslatedName(),styleName:t.get_Name(),value:e})}),o.sort(function(t,e){t=t.displayValue.toLocaleLowerCase(),e=e.displayValue.toLocaleLowerCase();return t<e?-1:e<t?1:0}),this.cmbTOFStyles.setData(o),e=void 0,t&&0<t.get_StylesCount()&&(i=this.cmbTOFStyles.store.findWhere({styleName:t.get_StyleName(0)}))&&(e=i.get("value")),0<o.length&&this.cmbTOFStyles.setValue(e||o[0].value),t&&(e=t.get_IncludeLabelAndNumber(),this.chFullCaption.setValue(null!=e?e:"indeterminate",!0)),n||this.radioStyle.setValue(!0)},synchronizeLevelsFromOutline:function(){var i=this.spnLevels.getNumberValue();this.stylesLevels.each(function(t){var e=t.get("headerLevel");1<=e&&e<=i?(t.set("checked",!0),t.set("value",e)):(t.set("checked",!1),t.set("value",""))}),this._needUpdateStyles=!1},synchronizeLevelsFromStyles:function(t){for(var e,i=-1,n=-1,o=-1,s=0;s<9;s++)if(e=this.stylesLevels.findWhere({headerLevel:s+1})){var a=e.get("headerLevel"),l=e.get("value");if(a==l){if(!(o<1)){i=n=-1,0;break}i<1&&(i=l),n=l}else{if(e.get("checked")){i=n=-1,0;break}0<i&&(o=s+1)}}i<0&&n<0&&((e=this.stylesLevels.findWhere({checked:!0}))||(i=1,n=9)),this.startLevel=i,this.endLevel=n,this.spnLevels.setValue(0<n?n:t?9:"",!0),t&&n<=0&&this.onLevelsChange(this.spnLevels),this._needUpdateOutlineLevels=!1,this._forceUpdateOutlineLevels=!1},getSettings:function(){var t,e=this._originalProps;return e.put_Hyperlink("checked"==this.chLinks.getValue()),e.put_ShowPageNumbers("checked"==this.chPages.getValue()),"checked"==this.chPages.getValue()&&(e.put_RightAlignTab("checked"==this.chAlign.getValue()),e.put_TabLeader(this.cmbLeader.getValue())),e.put_StylesType(this.cmbStyles.getValue()),e.clear_Styles(),1==this.type?this.radioCaption.getValue()?e.put_Caption(this.cmbCaptions.getValue()):(e.put_Caption(null),(t=this.cmbTOFStyles.getSelectedRecord())&&e.add_Style(t.styleName)):(this._needUpdateOutlineLevels&&this.synchronizeLevelsFromStyles(),this._needUpdateStyles||this.stylesLevels.each(function(t){t.get("checked")&&e.add_Style(t.get("name"),t.get("value"))}),e.put_OutlineRange(this.startLevel,this.endLevel)),e},addEvents:function(t,e,n){var o=e.$el.find("input"),s=this;o.on("keypress",function(t){var e=String.fromCharCode(t.which);/[1-9]/.test(e)||t.ctrlKey||(t.preventDefault(),t.stopPropagation())}),o.on("input",function(t){var e,i=_.isEmpty(o.val());n.get("checked")!==!i&&n.set("checked",!i),n.set("value",i?"":parseInt(o.val())),s._needUpdateOutlineLevels=!0,s.api&&!s._noApply&&((e=s._originalProps||new Asc.CTableOfContentsPr).clear_Styles(),s.stylesLevels.each(function(t){t.get("checked")&&e.add_Style(t.get("name"),t.get("value"))}),0<e.get_StylesCount()?e.put_OutlineRange(-1,-1):e.put_OutlineRange(1,9),s.api.SetDrawImagePlaceContents("tableofcontents-img",e),s.scrollerY.update())})},onItemChange:function(t,e,i){this.addEvents(t,e,i);var n=e.$el.find("input");setTimeout(function(){n.focus(),n[0].selectionStart=n[0].selectionEnd=n[0].value.length},10)},changeCaption:function(t){var e;this.api&&!this._noApply&&t&&((e=this._originalProps||new Asc.CTableOfContentsPr).put_Caption(t.value),e.clear_Styles(),this.api.SetDrawImagePlaceTableOfFigures("tableofcontents-img",e),this.scrollerY.update())},changeTOFStyle:function(t){var e;this.api&&!this._noApply&&((e=this._originalProps||new Asc.CTableOfContentsPr).put_Caption(null),e.clear_Styles(),e.add_Style(t.styleName),this.api.SetDrawImagePlaceTableOfFigures("tableofcontents-img",e),this.scrollerY.update())},onLevelsChange:function(t,e,i,n){this._needUpdateStyles=!0,this.startLevel=1,this.endLevel=t.getNumberValue(),this.api&&!this._noApply&&((t=this._originalProps||new Asc.CTableOfContentsPr).clear_Styles(),t.put_OutlineRange(this.startLevel,this.endLevel),this.api.SetDrawImagePlaceContents("tableofcontents-img",t),this.scrollerY.update())},disableButtons:function(){this.type&&this.btnOk.setDisabled(this.radioCaption.getValue()&&null===this.cmbCaptions.getValue()||this.radioStyle.getValue()&&this.cmbTOFStyles.length<1)},onDlgBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onPrimary:function(){return this._handleInput("ok"),!1},_handleInput:function(t){if(this.handler){if("ok"==t&&this.btnOk.isDisabled())return;this.handler.call(this,t,this.getSettings())}this.close()}},DE.Views.TableOfContentsSettings||{}))}),define("documenteditor/main/app/view/BookmarksDialog",["common/main/lib/util/utils","common/main/lib/component/ListView","common/main/lib/component/InputField","common/main/lib/component/Button","common/main/lib/component/RadioBox","common/main/lib/view/AdvancedSettingsWindow"],function(){"use strict";DE.Views.BookmarksDialog=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:320,height:366,buttons:null,id:"window-bookmarks"},initialize:function(t){_.extend(this.options,{title:this.textTitle,template:['<div class="box" style="height:'+(this.options.height-85)+'px;">','<div class="content-panel" style="padding: 0 5px;"><div class="inner-content">','<div class="settings-panel active">','<table cols="1" style="width: 100%;">',"<tr>",'<td class="padding-extra-small">','<label class="input-label">',this.textBookmarkName,"</label>","</td>","</tr>","<tr>",'<td class="padding-large">','<div id="bookmarks-txt-name" class="margin-right-10" style="display:inline-block;vertical-align: top;"></div>','<button type="button" result="add" class="btn btn-text-default" id="bookmarks-btn-add" style="vertical-align: top;">',this.textAdd,"</button>","</td>","</tr>","<tr>",'<td class="padding-extra-small">','<label class="header margin-right-10">',this.textSort,"</label>",'<div id="bookmarks-radio-name" class="margin-right-10"></div>','<div id="bookmarks-radio-location"></div>',"</td>","</tr>","<tr>",'<td class="padding-small">','<div id="bookmarks-list" style="width:100%; height: 139px;"></div>',"</td>","</tr>","<tr>",'<td class="padding-large">','<button type="button" class="btn btn-text-default margin-right-5" id="bookmarks-btn-goto">',this.textGoto,"</button>",'<div style="display: inline-block; position: relative;">','<button type="button" class="btn btn-text-default auto dropdown-toggle move-focus" id="bookmarks-btn-link" style="min-width: 75px;" data-toggle="dropdown">',this.textGetLink,"</button>",'<div id="id-clip-copy-box" class="dropdown-menu" style="width: 291px; left: -80px; padding: 10px;">','<div id="id-dlg-clip-copy"></div>','<button id="id-dlg-copy-btn" class="btn btn-text-default margin-left-5" style="width: 86px;">'+this.textCopy+"</button>","</div>","</div>",'<button type="button" class="btn btn-text-default float-right" id="bookmarks-btn-delete">',this.textDelete,"</button>","</td>","</tr>","<tr>","<td>",'<div id="bookmarks-checkbox-hidden"></div>',"</td>","</tr>","</table>","</div></div>","</div>","</div>",'<div class="footer center">','<button class="btn normal dlg-btn" result="cancel" style="width: 86px;">'+this.textClose+"</button>","</div>"].join("")},t),this.api=t.api,this.handler=t.handler,this.props=t.props,this.appOptions=t.appOptions,Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var e,t,n=this;this.txtName=new Common.UI.InputField({el:$("#bookmarks-txt-name"),allowBlank:!0,validateOnChange:!0,validateOnBlur:!0,style:"width: 215px;",value:"",maxLength:40,validation:function(t){var e=n.props.asc_CheckNewBookmarkName(t),i=n.props.asc_HaveBookmark(t);return n.btnAdd.setDisabled(!e&&!i),!!(e||_.isEmpty(t)||i)||n.txtInvalidName}}).on("changing",function(t,e){var i=n.props.asc_HaveBookmark(e);i?(e=n.bookmarksList.store.findWhere({value:e}),n.bookmarksList.selectRecord(e),n.bookmarksList.scrollToRecord(e)):n.bookmarksList.deselectAll(),n.btnGoto.setDisabled(!i),n.btnDelete.setDisabled(!i),n.btnGetLink.setDisabled(!i)}),this.radioName=new Common.UI.RadioBox({el:$("#bookmarks-radio-name"),labelText:this.textName,name:"asc-radio-bookmark-sort"}),this.radioName.on("change",_.bind(this.onRadioSort,this)),this.radioLocation=new Common.UI.RadioBox({el:$("#bookmarks-radio-location"),labelText:this.textLocation,name:"asc-radio-bookmark-sort"}),this.radioLocation.on("change",_.bind(this.onRadioSort,this)),(Common.Utils.InternalSettings.get("de-bookmarks-sort-location")?this.radioLocation:this.radioName).setValue(!0,!0),this.bookmarksList=new Common.UI.ListView({el:$("#bookmarks-list",this.$window),store:new Common.UI.DataViewStore,tabindex:1,cls:"dbl-clickable",itemTemplate:_.template('<div id="<%= id %>" class="list-item" style="overflow: hidden; text-overflow: ellipsis;"><%= Common.Utils.String.htmlEncode(value) %></div>')}),this.bookmarksList.store.comparator=function(t){return n.radioName.getValue()?t.get("value"):t.get("location")},this.bookmarksList.on("item:dblclick",_.bind(this.onDblClickBookmark,this)),this.bookmarksList.on("entervalue",_.bind(this.onPrimary,this)),this.bookmarksList.on("item:select",_.bind(this.onSelectBookmark,this)),this.btnAdd=new Common.UI.Button({el:$("#bookmarks-btn-add"),disabled:!0}),this.btnAdd.on("click",_.bind(this.addBookmark,this)),this.btnGoto=new Common.UI.Button({el:$("#bookmarks-btn-goto"),disabled:!0}),this.btnGoto.on("click",_.bind(this.gotoBookmark,this)),this.btnDelete=new Common.UI.Button({el:$("#bookmarks-btn-delete"),disabled:!0}),this.btnDelete.on("click",_.bind(this.deleteBookmark,this)),this.btnGetLink=new Common.UI.Button({el:$("#bookmarks-btn-link"),disabled:!0}),this.btnGetLink.on("click",_.bind(this.getBookmarkLink,this)),this.chHidden=new Common.UI.CheckBox({el:$("#bookmarks-checkbox-hidden"),labelText:this.textHidden,value:Common.Utils.InternalSettings.get("de-bookmarks-hidden")||!1}),this.chHidden.on("change",_.bind(this.onChangeHidden,this)),this.appOptions.canMakeActionLink&&(e=new Common.UI.InputField({el:$("#id-dlg-clip-copy"),editable:!1,style:"width: 176px;"}),(t=this.$window.find("#id-clip-copy-box")).on("click",_.bind(function(){return!1},this)),t.parent().on({"shown.bs.dropdown":function(){_.delay(function(){e._input.select().focus()},100)},"hide.bs.dropdown":function(){n.txtName._input.select().focus()}}),t.find("button").on("click",function(){e._input.select(),document.execCommand("copy")}),Common.Gateway.on("setactionlink",function(t){e.setValue(t)})),this.afterRender()},getFocusedComponents:function(){return[this.txtName,this.radioName,this.radioLocation,this.bookmarksList,this.btnAdd,this.btnGoto,this.btnGetLink,this.btnDelete,this.chHidden]},afterRender:function(){this._setDefaults(this.props);function e(){var t=i.bookmarksList.getSelectedRec();i.refreshBookmarks(),t&&((t=i.bookmarksList.store.findWhere({value:t.get("value")}))?(i.bookmarksList.selectRecord(t),i.bookmarksList.scrollToRecord(t)):(i.txtName.setValue(""),i.btnAdd.setDisabled(!0),i.btnGoto.setDisabled(!0),i.btnDelete.setDisabled(!0),i.btnGetLink.setDisabled(!0)))}var i=this;this.api.asc_registerCallback("asc_onBookmarksUpdate",e),this.on("close",function(t){i.api.asc_unregisterCallback("asc_onBookmarksUpdate",e)})},show:function(){Common.Views.AdvancedSettingsWindow.prototype.show.apply(this,arguments);var t=this;_.delay(function(){$("input",t.txtName.cmpEl).select().focus()},100)},close:function(){Common.Views.AdvancedSettingsWindow.prototype.close.apply(this,arguments),Common.Utils.InternalSettings.set("de-bookmarks-hidden","checked"==this.chHidden.getValue()),Common.Utils.InternalSettings.set("de-bookmarks-sort-location",this.radioLocation.getValue())},_setDefaults:function(t){this.refreshBookmarks(),this.btnGetLink.setVisible(this.appOptions.canMakeActionLink)},getSettings:function(){return{}},onDlgBtnClick:function(t){this.close()},onPrimary:function(){return!0},refreshBookmarks:function(){if(this.props){for(var t=this.bookmarksList.store,e=this.props.asc_GetCount(),i="checked"==this.chHidden.getValue(),n=[],o=0;o<e;o++){var s,a=this.props.asc_GetName(o);this.props.asc_IsInternalUseBookmark(a)||!i&&this.props.asc_IsHiddenBookmark(a)||((s=new Common.UI.DataViewModel).set({value:a,location:o}),n.push(s))}t.reset(n,{silent:!1})}},onSelectBookmark:function(t,e,i){i&&(i=i.get("value"),this.txtName.setValue(i),this.btnAdd.setDisabled(!1),this.btnGoto.setDisabled(!1),this.btnDelete.setDisabled(!1),this.btnGetLink.setDisabled(!1))},gotoBookmark:function(t,e){var i=this.bookmarksList.getSelectedRec();i?this.props.asc_SelectBookmark(i.get("value")):""!==this.txtName.getValue()&&this.props.asc_SelectBookmark(this.txtName.getValue())},addBookmark:function(t,e){this.props.asc_AddBookmark(this.txtName.getValue()),this.refreshBookmarks();var i=this.bookmarksList.store.findWhere({value:this.txtName.getValue()});this.bookmarksList.selectRecord(i),this.bookmarksList.scrollToRecord(i),this.txtName.focus()},onDblClickBookmark:function(t,e,i){this.props.asc_SelectBookmark(i.get("value"))},deleteBookmark:function(t,e){var i,n=this.bookmarksList.getSelectedRec();n&&(this.props.asc_RemoveBookmark(n.get("value")),i=this.bookmarksList.store,_.indexOf(i.models,n),i.remove(n),this.txtName.setValue(""),this.btnAdd.setDisabled(!0),this.btnGoto.setDisabled(!0),this.btnDelete.setDisabled(!0),this.btnGetLink.setDisabled(!0))},getBookmarkLink:function(t){t.cmpEl&&t.cmpEl.parent().hasClass("open")||(t=this.bookmarksList.getSelectedRec())&&Common.Gateway.requestMakeActionLink({action:{type:"bookmark",data:t.get("value")}})},onRadioSort:function(t,e,i){e&&(this.bookmarksList.store.sort(),this.bookmarksList.onResetItems())},onChangeHidden:function(t,e,i,n){this.refreshBookmarks()}},DE.Views.BookmarksDialog||{}))}),define("documenteditor/main/app/view/AddNewCaptionLabelDialog",["common/main/lib/component/Window","common/main/lib/component/InputField"],function(){"use strict";DE.Views.AddNewCaptionLabelDialog=Common.UI.Window.extend(_.extend({options:{width:330,header:!1,cls:"modal-dlg",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,t||{}),this.template=['<div class="box">','<div class="input-row">',"<label>"+this.textLabel+"</label>","</div>",'<div id="id-dlg-label-caption" class="input-row"></div>',"</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);this.inputLabel=new Common.UI.InputField({el:$("#id-dlg-label-caption"),allowBlank:!1,blankError:this.textLabelError,style:"width: 100%;",validateOnBlur:!1,validation:function(t){return!!t||""}}),this.getChild().find(".dlg-btn").on("click",_.bind(this.onBtnClick,this))},show:function(){Common.UI.Window.prototype.show.apply(this,arguments);var t=this;_.delay(function(){t.getChild("input").focus()},50)},onPrimary:function(t){return this._handleInput("ok"),!1},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},_handleInput:function(t){if(this.options.handler){if("ok"==t&&!0!==this.inputLabel.checkValidate())return void this.inputLabel.cmpEl.find("input").focus();this.options.handler.call(this,t,this.inputLabel.getValue())}this.close()}},DE.Views.AddNewCaptionLabelDialog||{}))}),define("documenteditor/main/app/view/CaptionDialog",["common/main/lib/util/utils","common/main/lib/component/MetricSpinner","common/main/lib/component/ComboBox","common/main/lib/view/AdvancedSettingsWindow","documenteditor/main/app/view/AddNewCaptionLabelDialog"],function(){"use strict";DE.Views.CaptionDialog=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:351,height:350,id:"window-caption"},initialize:function(t){var e=this;_.extend(this.options,{title:this.textTitle,template:['<div class="box" style="height:'+(e.options.height-85)+'px;">','<div class="content-panel" style="padding: 0 5px;"><div class="inner-content">','<div class="settings-panel active">','<table cols="4" style="width: auto;">',"<tr>",'<td colspan="3" class="padding-small">','<label class="input-label">',e.textCaption,"</label>",'<div id="caption-txt-caption" class="margin-right-10"></div>',"</td>",'<td class="padding-small">','<label class="input-label">',e.textInsert,"</label>",'<div id="caption-combo-position" class="input-group-nr" style="width:75px;"></div>',"</td>","</tr>","<tr>",'<td colspan="2" class="padding-small">','<label class="input-label">',e.textLabel,"</label>",'<div id="caption-combo-label" class="input-group-nr margin-right-10" style="width:160px;"></div>',"</td>",'<td class="padding-small" style="vertical-align: bottom;">','<button type="button" result="add" class="btn btn-text-default margin-right-10" id="caption-btn-add">',e.textAdd,"</button>","</td>",'<td class="padding-small" style="vertical-align: bottom;">','<button type="button" result="add" class="btn btn-text-default" id="caption-btn-delete">',e.textDelete,"</button>","</td>","</tr>","<tr>",'<td colspan="4" class="padding-small">','<div id="caption-checkbox-exclude"></div>',"</td>","</tr>","<tr>",'<td colspan="2" class="padding-large">','<label class="input-label" >',e.textNumbering,"</label>",'<div id="caption-combo-numbering" class="input-group-nr" style="width:160px;"></div>',"</td>",'<td class="padding-large">',"</td>",'<td class="padding-large">',"</td>","</tr>","<tr>",'<td colspan="4" class="padding-small">','<div id="caption-checkbox-chapter"></div>',"</td>","</tr>","<tr>",'<td colspan="2" class="padding-small">','<label class="input-label">',e.textChapter,"</label>",'<div id="caption-combo-chapter" class="input-group-nr margin-right-10" style="width:160px;"></div>',"</td>",'<td colspan="2" class="padding-small">','<label class="input-label" >',e.textSeparator,"</label>",'<div id="caption-combo-separator" class="input-group-nr" style="width:160px;"></div>',"</td>","</tr>","<tr>",'<td colspan="4" class="padding-small">','<label class="input-label" id="caption-label-example">',e.textExamples,"</label>","</td>","</tr>","</table>","</div>","</div></div>","</div>"].join("")},t),this.objectType=t.objectType,this.handler=t.handler,this.props=t.props,Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var t,n=this,e=(this.txtCaption=new Common.UI.InputField({el:$("#caption-txt-caption"),allowBlank:!1,value:""}),this.txtCaption.$el.find("input")),e=(e.on("mouseup",_.bind(this.checkStartPosition,this,"mouse")),e.on("keydown",_.bind(this.checkStartPosition,this,"key")),this.cmbPosition=new Common.UI.ComboBox({el:$("#caption-combo-position"),cls:"input-group-nr",menuStyle:"min-width: 75px;",editable:!1,disabled:void 0===this.objectType,takeFocusOnClose:!0,data:[{displayValue:this.textBefore,value:1},{displayValue:this.textAfter,value:0}]}),this.cmbPosition.setValue(Common.Utils.InternalSettings.get("de-settings-label-position")||0),this.cmbPosition.on("selected",function(t,e){n.props.put_Before(!!e.value)}),Common.Utils.InternalSettings.get("de-settings-captions")),i=(null==e&&(e=Common.localStorage.getItem("de-settings-captions")||"",Common.Utils.InternalSettings.set("de-settings-captions",e)),e=e?JSON.parse(e):[],this.arrLabel=e.concat([{displayValue:this.textEquation,value:this.textEquation,type:0},{displayValue:this.textFigure,value:this.textFigure,type:0},{displayValue:this.textTable,value:this.textTable,type:0}]),this.cmbLabel=new Common.UI.ComboBox({el:$("#caption-combo-label"),cls:"input-group-nr",menuStyle:"min-width: 160px;max-height:155px;",editable:!1,takeFocusOnClose:!0,data:this.arrLabel,alwaysVisibleY:!0}),this.cmbLabel.on("selected",function(t,e){var i=e.value,e=(n.props.put_Label(i),n.props.updateName(),n.txtCaption.setValue(n.props.get_Name()),1==e.type);n.btnDelete.setDisabled(!e),n.currentLabel=i,n.positionCaption=n.txtCaption.getValue().length}),Common.Utils.InternalSettings.get("de-settings-current-label")),e=(i&&(t=_.findIndex(this.arrLabel,function(t){return t.value===i})),t=i&&-1!==t?this.cmbLabel.store.at(t):(e=this.arrLabel.length-1,this.objectType===Asc.c_oAscTypeSelectElement.Math?e=this.arrLabel.length-3:this.objectType===Asc.c_oAscTypeSelectElement.Image&&(e=this.arrLabel.length-2),this.cmbLabel.store.at(e)),this.cmbLabel.selectRecord(t),this.btnAdd=new Common.UI.Button({el:$("#caption-btn-add")}),this.btnAdd.on("click",_.bind(function(t){var i=this;new DE.Views.AddNewCaptionLabelDialog({handler:function(t,e){"ok"==t&&((t=_.findWhere(i.arrLabel,{value:e}))?(i.cmbLabel.setValue(e),i.cmbLabel.trigger("selected",i.cmbLabel,t)):(i.arrLabel.unshift(t={displayValue:e,value:e,type:1}),i.cmbLabel.setData(i.arrLabel),i.cmbLabel.setValue(e),i.cmbLabel.trigger("selected",i.cmbLabel,t),i.cmbLabel.scroller.update({alwaysVisibleY:!0})))}}).on("close",function(){i.cmbLabel.focus()}).show()},this)),this.btnDelete=new Common.UI.Button({el:$("#caption-btn-delete"),disabled:!0}),this.btnDelete.on("click",_.bind(function(t){var e=this.cmbLabel.getValue();this.arrLabel=_.reject(this.arrLabel,function(t){return t.value===e}),this.cmbLabel.setData(this.arrLabel),this.cmbLabel.setValue(this.arrLabel[0].value),this.cmbLabel.trigger("selected",this.cmbLabel,this.arrLabel[0])},this)),this.chExclude=new Common.UI.CheckBox({el:$("#caption-checkbox-exclude"),labelText:this.textExclude}),this.chExclude.on("change",function(t,e,i){n.props.put_ExcludeLabel("checked"==e),n.props.updateName(),n.txtCaption.setValue(n.props.get_Name()),n.positionCaption=n.txtCaption.getValue().length}),this.chExclude.setValue(!!Common.Utils.InternalSettings.get("de-settings-label-exclude"),!0),this.cmbNumbering=new Common.UI.ComboBox({el:$("#caption-combo-numbering"),cls:"input-group-nr",menuStyle:"min-width: 160px;",editable:!1,takeFocusOnClose:!0,data:[{displayValue:"1, 2, 3,...",value:Asc.c_oAscNumberingFormat.Decimal,maskExp:/[0-9]/,defValue:1},{displayValue:"a, b, c,...",value:Asc.c_oAscNumberingFormat.LowerLetter,maskExp:/[a-z]/,defValue:"a"},{displayValue:"A, B, C,...",value:Asc.c_oAscNumberingFormat.UpperLetter,maskExp:/[A-Z]/,defValue:"A"},{displayValue:"i, ii, iii,...",value:Asc.c_oAscNumberingFormat.LowerRoman,maskExp:/[ivxlcdm]/,defValue:"i"},{displayValue:"I, II, III,...",value:Asc.c_oAscNumberingFormat.UpperRoman,maskExp:/[IVXLCDM]/,defValue:"I"}]}),Common.Utils.InternalSettings.get("de-settings-label-numbering")),o=(null==e&&(e=Asc.c_oAscNumberingFormat.Decimal),this.cmbNumbering.setValue(e),this.cmbNumbering.on("selected",function(t,e){n.props.put_Format(e.value),n.props.updateName(),n.txtCaption.setValue(n.props.get_Name())}),this.chChapter=new Common.UI.CheckBox({el:$("#caption-checkbox-chapter"),labelText:this.textChapterInc}),this.chChapter.on("change",function(t,e,i){n.props.put_IncludeChapterNumber("checked"==e),n.props.updateName(),n.txtCaption.setValue(n.props.get_Name()),n.positionCaption=n.txtCaption.getValue().length,n.cmbChapter.setDisabled("checked"!==e),n.cmbSeparator.setDisabled("checked"!==e)}),this.chChapter.setValue(!!Common.Utils.InternalSettings.get("de-settings-label-chapter-include"),!0),DE.getController("Main"));this._arrLevel=[];for(var s=0;s<9;s++)this._arrLevel.push({displayValue:o["txtStyle_Heading_"+(s+1)],value:s});this.cmbChapter=new Common.UI.ComboBox({el:$("#caption-combo-chapter"),cls:"input-group-nr",menuStyle:"min-width: 160px;max-height:135px;",editable:!1,takeFocusOnClose:!0,disabled:!0,data:this._arrLevel}),this.cmbChapter.setValue(Common.Utils.InternalSettings.get("de-settings-label-chapter")||0),this.cmbChapter.on("selected",function(t,e){n.props.put_HeadingLvl(e.value),n.props.updateName(),n.txtCaption.setValue(n.props.get_Name())}),this.cmbSeparator=new Common.UI.ComboBox({el:$("#caption-combo-separator"),cls:"input-group-nr",menuStyle:"min-width: 160px;",editable:!1,takeFocusOnClose:!0,disabled:!0,data:[{displayValue:"-     ("+this.textHyphen+")",value:"-"},{displayValue:".     ("+this.textPeriod+")",value:"."},{displayValue:":     ("+this.textColon+")",value:":"},{displayValue:"—  ("+this.textLongDash+")",value:"—"},{displayValue:"–    ("+this.textDash+")",value:"–"}]}),this.cmbSeparator.setValue(Common.Utils.InternalSettings.get("de-settings-label-separator")||"-"),this.cmbSeparator.on("selected",function(t,e){n.props.put_Separator(e.value),n.props.updateName(),n.txtCaption.setValue(n.props.get_Name())}),this.lblExample=this.$window.find("#caption-label-example"),this.afterRender()},getFocusedComponents:function(){return[this.txtCaption,this.cmbPosition,this.cmbLabel,this.btnAdd,this.btnDelete,this.chExclude,this.cmbNumbering,this.chChapter,this.cmbChapter,this.cmbSeparator]},getDefaultFocusableComponent:function(){return this.txtCaption},afterRender:function(){this._setDefaults(this.props)},close:function(){var t=_.where(this.arrLabel,{type:1}),t=JSON.stringify(t);Common.localStorage.setItem("de-settings-captions",t),Common.Utils.InternalSettings.set("de-settings-captions",t),Common.Views.AdvancedSettingsWindow.prototype.close.apply(this,arguments)},_setDefaults:function(t){this.props=new Asc.CAscCaptionProperties,this.props.put_Before(!!this.cmbPosition.getValue());var e=this.cmbLabel.getValue(),i=(this.props.put_Label(e),this.cmbLabel.getSelectedRecord());this.btnDelete.setDisabled(!i||0==i.type),this.props.put_ExcludeLabel("checked"==this.chExclude.getValue()),this.props.put_Format(this.cmbNumbering.getValue()),this.props.put_IncludeChapterNumber("checked"==this.chChapter.getValue()),this.props.put_HeadingLvl(this.cmbChapter.getValue()),this.props.put_Separator(this.cmbSeparator.getValue()),this.props.updateName(),this.txtCaption.setValue(this.props.get_Name()),this.currentLabel=e,this.positionCaption=this.txtCaption.getValue().length,this.cmbChapter.setDisabled("checked"!==this.chChapter.getValue()),this.cmbSeparator.setDisabled("checked"!==this.chChapter.getValue())},getSettings:function(){return this.props.put_Additional(this.txtCaption.getValue().substr(this.positionCaption)),this.props},onDlgBtnClick:function(t){this._handleInput("object"==typeof t?t.currentTarget.attributes.result.value:t)},onPrimary:function(){return this._handleInput("ok"),!1},_handleInput:function(t){this.handler&&this.handler.call(this,t,"ok"==t?this.getSettings():void 0),"ok"==t&&(Common.Utils.InternalSettings.set("de-settings-current-label",this.cmbLabel.getValue()),Common.Utils.InternalSettings.set("de-settings-label-position",this.cmbPosition.getValue()),Common.Utils.InternalSettings.set("de-settings-label-exclude","checked"==this.chExclude.getValue()),Common.Utils.InternalSettings.set("de-settings-label-numbering",this.cmbNumbering.getValue()),Common.Utils.InternalSettings.set("de-settings-label-chapter-include","checked"==this.chChapter.getValue()),Common.Utils.InternalSettings.set("de-settings-label-chapter",this.cmbChapter.getValue()),Common.Utils.InternalSettings.set("de-settings-label-separator",this.cmbSeparator.getValue())),this.close()},checkStartPosition:function(t,e){var i=this,n=e.key;"mouse"===t||"ArrowLeft"===n||"ArrowDown"===n?setTimeout(function(){e.target.selectionStart<i.positionCaption+1&&(e.target.selectionStart=i.positionCaption)},0):"ArrowUp"===n||"Home"===n?setTimeout(function(){e.target.selectionStart=i.positionCaption},0):e.target.selectionStart!==e.target.selectionEnd&&"ArrowRight"===n?e.target.selectionEnd>i.positionCaption?setTimeout(function(){e.target.selectionStart=e.target.selectionEnd},0):setTimeout(function(){e.target.selectionStart=i.positionCaption},0):"Backspace"===n?(e.target.selectionStart===e.target.selectionEnd&&e.target.selectionStart<i.positionCaption+1||e.target.selectionStart<i.positionCaption)&&e.preventDefault():"Delete"===n?e.target.selectionStart<i.positionCaption&&e.preventDefault():"End"!==n&&e.target.selectionStart!==e.target.selectionEnd&&0===e.target.selectionStart&&e.preventDefault()}},DE.Views.CaptionDialog||{}))}),define("documenteditor/main/app/view/NotesRemoveDialog",["common/main/lib/component/Window","common/main/lib/component/RadioBox"],function(){"use strict";DE.Views.NotesRemoveDialog=Common.UI.Window.extend(_.extend({options:{width:214,height:139,header:!0,style:"min-width: 214px;",cls:"modal-dlg",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:this.textTitle},t),this.template=['<div class="box">','<div id="notes-remove-chk-foot" style="margin-bottom: 5px;"></div>','<div id="notes-remove-chk-end"></div>',"</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this.getChild();t.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.chFootnote=new Common.UI.CheckBox({el:t.find("#notes-remove-chk-foot"),labelText:this.textFoot,value:!0}),this.chEndnote=new Common.UI.CheckBox({el:t.find("#notes-remove-chk-end"),labelText:this.textEnd,value:!0})},getFocusedComponents:function(){return[this.chFootnote,this.chEndnote]},getDefaultFocusableComponent:function(){return this.chFootnote},_handleInput:function(t){this.options.handler&&this.options.handler.call(this,this,t),this.close()},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},getSettings:function(){return{footnote:this.chFootnote.isChecked(),endnote:this.chEndnote.isChecked()}},onPrimary:function(){return this._handleInput("ok"),!1}},DE.Views.NotesRemoveDialog||{}))}),define("documenteditor/main/app/view/CrossReferenceDialog",["common/main/lib/component/Window","common/main/lib/component/ComboBox"],function(){"use strict";DE.Views.CrossReferenceDialog=Common.UI.Window.extend(_.extend({options:{width:400,height:410,style:"min-width: 240px;",cls:"modal-dlg",modal:!1,id:"window-cross-ref"},initialize:function(t){_.extend(this.options,{title:this.txtTitle,buttons:[{value:"ok",caption:this.textInsert},"close"]},t||{}),this.template=['<div class="box">','<table cols="2" style="width: 100%;">',"<tr>",'<td class="padding-right-5">','<label class="input-label">'+this.txtType+"</label>",'<div id="id-dlg-cross-type" class="input-group-nr" style="width: 100%;margin-bottom: 10px;"></div>',"</td>",'<td class="padding-left-5">','<label class="input-label">'+this.txtReference+"</label>",'<div id="id-dlg-cross-ref" class="input-group-nr" style="width: 100%;margin-bottom: 10px;"></div>',"</td>","</tr>","<tr>",'<td colspan="2" style="padding-bottom: 10px;">','<div id="id-dlg-cross-insert-as" style="width:100%;"></div>',"</td>","</tr>","<tr>",'<td colspan="2" style="padding-bottom: 7px;">','<div id="id-dlg-cross-below-above" style="width:100%;"></div>',"</td>","</tr>","<tr>",'<td colspan="2" style="padding-bottom: 10px;">','<div id="id-dlg-cross-separate" class="margin-right-10" style="display: inline-block;vertical-align: middle;"></div>','<div id="id-dlg-cross-separator" style="display: inline-block;vertical-align: middle;"></div>',"</td>","</tr>","<tr>",'<td colspan="2" style="width: 100%;">','<label id="id-dlg-cross-which">'+this.textWhich+"</label>",'<div id="id-dlg-cross-list" class="no-borders" style="width:368px; height:161px;margin-top: 2px; "></div>',"</td>","</tr>","</table>","</div>"].join(""),this.crossRefProps=t.crossRefProps,this.api=t.api,this.options.tpl=_.template(this.template)(this.options),this._locked=!1,Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this.getChild(),e=(t.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),Common.Utils.InternalSettings.get("de-settings-captions"));null==e&&(e=Common.localStorage.getItem("de-settings-captions")||"",Common.Utils.InternalSettings.set("de-settings-captions",e)),(e=(e=e?JSON.parse(e):[]).concat([{value:5,displayValue:this.textEquation},{value:6,displayValue:this.textFigure},{value:7,displayValue:this.textTable}])).sort(function(t,e){t=t.displayValue.toLowerCase(),e=e.displayValue.toLowerCase();return e<t?1:t<e?-1:0}),this.cmbType=new Common.UI.ComboBox({el:t.find("#id-dlg-cross-type"),menuStyle:"min-width: 100%;max-height: 233px;",editable:!1,cls:"input-group-nr",data:[{value:0,displayValue:this.textParagraph},{value:1,displayValue:this.textHeading},{value:2,displayValue:this.textBookmark},{value:3,displayValue:this.textFootnote},{value:4,displayValue:this.textEndnote}].concat(e)}),this.cmbType.on("selected",_.bind(this.onTypeSelected,this)),this.cmbReference=new Common.UI.ComboBox({el:t.find("#id-dlg-cross-ref"),menuStyle:"min-width: 100%;max-height: 233px;",editable:!1,cls:"input-group-nr",data:[]}),this.cmbReference.on("selected",_.bind(this.onReferenceSelected,this)),this.chInsertAs=new Common.UI.CheckBox({el:t.find("#id-dlg-cross-insert-as"),labelText:this.textInsertAs,value:!0}),this.chBelowAbove=new Common.UI.CheckBox({el:t.find("#id-dlg-cross-below-above"),labelText:this.textIncludeAbove}),this.chSeparator=new Common.UI.CheckBox({el:t.find("#id-dlg-cross-separate"),labelText:this.textSeparate}).on("change",_.bind(function(t,e,i,n){t="checked"===t.getValue();this.inputSeparator.setDisabled(!t)},this)),this.inputSeparator=new Common.UI.InputField({el:t.findById("#id-dlg-cross-separator"),style:"width: 35px;",validateOnBlur:!1,disabled:!0}),this.refList=new Common.UI.ListView({el:t.find("#id-dlg-cross-list"),store:new Common.UI.DataViewStore,cls:"dbl-clickable",itemTemplate:_.template('<div id="<%= id %>" class="list-item" style="overflow: hidden; text-overflow: ellipsis;white-space: pre;"><%= Common.Utils.String.htmlEncode(value) %></div>')}),this.refList.on("entervalue",_.bind(this.onPrimary,this)).on("item:dblclick",_.bind(this.onPrimary,this)),this.lblWhich=t.find("#id-dlg-cross-which"),this.btnInsert=new Common.UI.Button({el:t.find(".primary"),disabled:!0}),this.afterRender()},afterRender:function(){this._setDefaults();function e(){i.refreshReferences(i.cmbType.getSelectedRecord(),!0)}var i=this;this.api.asc_registerCallback("asc_onEndCalculate",e),this.on("close",function(t){i.api.asc_unregisterCallback("asc_onEndCalculate",e)})},_handleInput:function(t,e){if(this.options.handler&&this.options.handler.call(this,t),"ok"==t)return!e&&document.activeElement&&"textarea"==document.activeElement.localName&&/area_id/.test(document.activeElement.id)?void 0:void(this.btnInsert.isDisabled()||this.insertReference());this.close()},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value,!0)},onPrimary:function(t){return this._handleInput("ok"),!1},getSettings:function(){return{type:this.cmbType.getValue(),refType:this.cmbReference.getValue()}},_setDefaults:function(){var t,e;this.crossRefProps&&(t=this.cmbType.store.findWhere({value:this.crossRefProps.type}))&&(e=this.crossRefProps.refType),t?this.cmbType.selectRecord(t):this.cmbType.setValue(0),this.refreshReferenceTypes(this.cmbType.getSelectedRecord(),e)},insertReference:function(){var t=this.refList.getSelectedRec(),e=this.cmbType.getSelectedRecord(),i=1==e.type||4<e.value?5:e.value,n=this.cmbReference.getValue(),o="checked"==this.chInsertAs.getValue(),s="checked"==this.chBelowAbove.getValue(),a="checked"==this.chSeparator.getValue()?this.inputSeparator.getValue():void 0;switch(i){case 0:case 1:this.api.asc_AddCrossRefToParagraph(t.get("para"),n,o,s,a);break;case 2:this.api.asc_AddCrossRefToBookmark(t.get("value"),n,o,s,a);break;case 3:case 4:this.api.asc_AddCrossRefToNote(t.get("para"),n,o,s);break;case 5:n==Asc.c_oAscDocumentRefenceToType.OnlyCaptionText&&!1===t.get("para").asc_canAddRefToCaptionText(e.displayValue)?Common.UI.warning({msg:this.textEmpty}):this.api.asc_AddCrossRefToCaption(e.displayValue,t.get("para"),n,o,s)}},onTypeSelected:function(t,e){this.refreshReferenceTypes(e)},refreshReferenceTypes:function(t,e){var i=[],n=this.textWhich;if(1==t.type||4<t.value)i=[{value:Asc.c_oAscDocumentRefenceToType.Text,displayValue:this.textCaption},{value:Asc.c_oAscDocumentRefenceToType.OnlyLabelAndNumber,displayValue:this.textLabelNum},{value:Asc.c_oAscDocumentRefenceToType.OnlyCaptionText,displayValue:this.textOnlyCaption},{value:Asc.c_oAscDocumentRefenceToType.PageNum,displayValue:this.textPageNum},{value:Asc.c_oAscDocumentRefenceToType.AboveBelow,displayValue:this.textAboveBelow}];else switch(t.value){case 0:i=[{value:Asc.c_oAscDocumentRefenceToType.PageNum,displayValue:this.textPageNum},{value:Asc.c_oAscDocumentRefenceToType.ParaNum,displayValue:this.textParaNum},{value:Asc.c_oAscDocumentRefenceToType.ParaNumNoContext,displayValue:this.textParaNumNo},{value:Asc.c_oAscDocumentRefenceToType.ParaNumFullContex,displayValue:this.textParaNumFull},{value:Asc.c_oAscDocumentRefenceToType.Text,displayValue:this.textText},{value:Asc.c_oAscDocumentRefenceToType.AboveBelow,displayValue:this.textAboveBelow}],n=this.textWhichPara;break;case 1:i=[{value:Asc.c_oAscDocumentRefenceToType.Text,displayValue:this.textHeadingText},{value:Asc.c_oAscDocumentRefenceToType.PageNum,displayValue:this.textPageNum},{value:Asc.c_oAscDocumentRefenceToType.ParaNum,displayValue:this.textHeadingNum},{value:Asc.c_oAscDocumentRefenceToType.ParaNumNoContext,displayValue:this.textHeadingNumNo},{value:Asc.c_oAscDocumentRefenceToType.ParaNumFullContex,displayValue:this.textHeadingNumFull},{value:Asc.c_oAscDocumentRefenceToType.AboveBelow,displayValue:this.textAboveBelow}],n=this.textWhichHeading;break;case 2:i=[{value:Asc.c_oAscDocumentRefenceToType.Text,displayValue:this.textBookmarkText},{value:Asc.c_oAscDocumentRefenceToType.PageNum,displayValue:this.textPageNum},{value:Asc.c_oAscDocumentRefenceToType.ParaNum,displayValue:this.textParaNum},{value:Asc.c_oAscDocumentRefenceToType.ParaNumNoContext,displayValue:this.textParaNumNo},{value:Asc.c_oAscDocumentRefenceToType.ParaNumFullContex,displayValue:this.textParaNumFull},{value:Asc.c_oAscDocumentRefenceToType.AboveBelow,displayValue:this.textAboveBelow}],n=this.textWhichBookmark;break;case 3:i=[{value:Asc.c_oAscDocumentRefenceToType.NoteNumber,displayValue:this.textNoteNum},{value:Asc.c_oAscDocumentRefenceToType.PageNum,displayValue:this.textPageNum},{value:Asc.c_oAscDocumentRefenceToType.AboveBelow,displayValue:this.textAboveBelow},{value:Asc.c_oAscDocumentRefenceToType.NoteNumberFormatted,displayValue:this.textNoteNumForm}],n=this.textWhichNote;break;case 4:i=[{value:Asc.c_oAscDocumentRefenceToType.NoteNumber,displayValue:this.textEndNoteNum},{value:Asc.c_oAscDocumentRefenceToType.PageNum,displayValue:this.textPageNum},{value:Asc.c_oAscDocumentRefenceToType.AboveBelow,displayValue:this.textAboveBelow},{value:Asc.c_oAscDocumentRefenceToType.NoteNumberFormatted,displayValue:this.textEndNoteNumForm}],n=this.textWhichEndnote}this.cmbReference.setData(i);var o=this.cmbReference.store.findWhere({value:e});this.cmbReference.setValue(o?e:i[0].value),this.onReferenceSelected(this.cmbReference,this.cmbReference.getSelectedRecord()),this.lblWhich.text(n),this.refreshReferences(t)},refreshReferences:function(t,e){if(t){var i,n=this.refList.store,t=1==t.type||4<t.value?5:t.value,o=[],s=n.length,a=_.indexOf(n.models,this.refList.getSelectedRec());switch(t){case 0:i=this.api.asc_GetAllNumberedParagraphs();break;case 1:i=this.api.asc_GetAllHeadingParagraphs();break;case 2:i=this.api.asc_GetBookmarksManager();break;case 3:i=this.api.asc_GetAllFootNoteParagraphs();break;case 4:i=this.api.asc_GetAllEndNoteParagraphs();break;case 5:i=this.api.asc_GetAllCaptionParagraphs(this.cmbType.getSelectedRecord().displayValue)}if(2==t)for(var l=i.asc_GetCount(),r=0;r<l;r++){var c=i.asc_GetName(r);i.asc_IsInternalUseBookmark(c)||i.asc_IsHiddenBookmark(c)||o.push({value:c})}else if(i)for(r=0;r<i.length;r++)o.push({value:i[r].asc_getText(),para:i[r]});n.reset(o),0<n.length&&(t=e&&n.length==s&&0<=a&&a<n.length?n.at(a):n.at(0),this.refList.selectRecord(t),this.refList.scrollToRecord(t)),this.btnInsert.setDisabled(o.length<1||this._locked)}},onReferenceSelected:function(t,e){var i,n;e&&(e=e.value,n=5==(i=1==(i=this.cmbType.getSelectedRecord()).type||4<i.value?5:i.value)&&e!==Asc.c_oAscDocumentRefenceToType.PageNum||i<5&&(e==Asc.c_oAscDocumentRefenceToType.Text||e==Asc.c_oAscDocumentRefenceToType.AboveBelow),this.chBelowAbove.setDisabled(n),n=!(0==i||2==i)||e!==Asc.c_oAscDocumentRefenceToType.ParaNumFullContex,this.chSeparator.setDisabled(n),this.inputSeparator.setDisabled(n||"checked"!==this.chSeparator.getValue()))},setLocked:function(t){this._locked=t,this.btnInsert.setDisabled(this.refList.store.length<1||this._locked)}},DE.Views.CrossReferenceDialog||{}))}),define("documenteditor/main/app/controller/Links",["core","documenteditor/main/app/view/Links","documenteditor/main/app/view/NoteSettingsDialog","documenteditor/main/app/view/HyperlinkSettingsDialog","documenteditor/main/app/view/TableOfContentsSettings","documenteditor/main/app/view/BookmarksDialog","documenteditor/main/app/view/CaptionDialog","documenteditor/main/app/view/NotesRemoveDialog","documenteditor/main/app/view/CrossReferenceDialog","common/main/lib/view/OptionsDialog"],function(){"use strict";DE.Controllers.Links=Backbone.Controller.extend(_.extend({models:[],collections:[],views:["Links"],sdkViewName:"#id_main",initialize:function(){this.addListeners({Links:{"links:contents":this.onTableContents,"links:contents-open":this.onTableContentsOpen,"links:update":this.onTableContentsUpdate,"links:notes":this.onNotesClick,"links:hyperlink":this.onHyperlinkClick,"links:bookmarks":this.onBookmarksClick,"links:caption":this.onCaptionClick,"links:crossref":this.onCrossRefClick,"links:tof":this.onTableFigures,"links:tof-update":this.onTableFiguresUpdate,"links:addtext":this.onAddText,"links:addtext-open":this.onAddTextOpen},DocumentHolder:{"links:contents":this.onTableContents,"links:update":this.onTableContentsUpdate,"links:contents-open":this.onTableContentsOpen,"links:caption":this.onCaptionClick}})},onLaunch:function(){this._state={in_object:void 0},Common.Gateway.on("setactionlink",function(t){}.bind(this)),Common.NotificationCenter.on("app:ready",this.onAppReady.bind(this))},setApi:function(t){return t&&(this.api=t,this.api.asc_registerCallback("asc_onFocusObject",this.onApiFocusObject.bind(this)),this.api.asc_registerCallback("asc_onCanAddHyperlink",_.bind(this.onApiCanAddHyperlink,this)),this.api.asc_registerCallback("asc_onCoAuthoringDisconnect",_.bind(this.onCoAuthoringDisconnect,this)),Common.NotificationCenter.on("api:disconnect",_.bind(this.onCoAuthoringDisconnect,this)),this.api.asc_registerCallback("asc_onShowContentControlsActions",_.bind(this.onShowContentControlsActions,this)),this.api.asc_registerCallback("asc_onHideContentControlsActions",_.bind(this.onHideContentControlsActions,this)),this.api.asc_registerCallback("asc_onAscReplaceCurrentTOF",_.bind(this.onAscReplaceCurrentTOF,this)),this.api.asc_registerCallback("asc_onAscTOFUpdate",_.bind(this.onAscTOFUpdate,this))),Common.NotificationCenter.on("protect:doclock",_.bind(this.onChangeProtectDocument,this)),this},setConfig:function(t){this.toolbar=t.toolbar,this.view=this.createView("Links",{toolbar:this.toolbar.toolbar})},SetDisabled:function(t){this.view&&this.view.SetDisabled(t)},getView:function(t){return!t&&this.view?this.view:Backbone.Controller.prototype.getView.call(this,t)},onCoAuthoringDisconnect:function(){this.SetDisabled(!0)},onApiFocusObject:function(t){if(this.toolbar.editMode){for(var e,i,n,o=-1,s=!1,a=!1,l=!1,r=!1,c=!1,d=!1,h=!1,m=null;++o<t.length;)i=t[o].get_ObjectType(),e=t[o].get_ObjectValue(),i===Asc.c_oAscTypeSelectElement.Paragraph?(s=e.get_Locked(),m=e,h=!0):i===Asc.c_oAscTypeSelectElement.Header?(a=e.get_Locked(),l=!0):i===Asc.c_oAscTypeSelectElement.Image?(c=!0,d=e.get_WrappingStyle()===Asc.c_oAscWrapStyle2.Inline,n=i):i===Asc.c_oAscTypeSelectElement.Math?(r=!0,n=i):i===Asc.c_oAscTypeSelectElement.Table&&(n=i);this._state.in_object=n;var p=this.api.asc_IsContentControl()?this.api.asc_GetContentControlProperties():null,u=!!p&&p.get_ContentControlType()==Asc.c_oAscSdtLevelType.Inline,p=p?p.get_Lock():Asc.c_oAscSdtLockType.Unlocked,p=p==Asc.c_oAscSdtLockType.SdtContentLocked||p==Asc.c_oAscSdtLockType.ContentLocked,g=!!m&&!m.can_DeleteBlockContentControl(),b=!!m&&!m.can_EditBlockContentControl(),C=!!m&&!m.can_DeleteInlineContentControl(),f=!!m&&!m.can_EditInlineContentControl();this.lockToolbar(Common.enumLock.paragraphLock,s,{array:this.view.btnsNotes.concat(this.view.btnsHyperlink).concat([this.view.btnBookmarks,this.view.btnTableFiguresUpdate,this.view.btnCrossRef])}),this.lockToolbar(Common.enumLock.inHeader,l,{array:this.view.btnsNotes.concat(this.view.btnsContents).concat([this.view.btnBookmarks,this.view.btnTableFigures,this.view.btnTableFiguresUpdate,this.view.btnCaption])}),this.lockToolbar(Common.enumLock.controlPlain,u,{array:this.view.btnsNotes.concat([this.view.btnBookmarks,this.view.btnCrossRef])}),this.lockToolbar(Common.enumLock.richEditLock,b,{array:this.view.btnsNotes.concat(this.view.btnsContents).concat([this.view.btnTableFigures,this.view.btnTableFiguresUpdate,this.view.btnCrossRef])}),this.lockToolbar(Common.enumLock.plainEditLock,f,{array:this.view.btnsNotes.concat(this.view.btnsContents).concat([this.view.btnTableFigures,this.view.btnTableFiguresUpdate,this.view.btnCrossRef])}),this.lockToolbar(Common.enumLock.headerLock,a,{array:this.view.btnsHyperlink.concat([this.view.btnBookmarks,this.view.btnCrossRef])}),this.lockToolbar(Common.enumLock.inEquation,r,{array:this.view.btnsNotes}),this.lockToolbar(Common.enumLock.inImage,c,{array:this.view.btnsNotes}),this.lockToolbar(Common.enumLock.richDelLock,g,{array:this.view.btnsContents.concat([this.view.btnTableFigures,this.view.btnTableFiguresUpdate])}),this.lockToolbar(Common.enumLock.plainDelLock,C,{array:this.view.btnsContents.concat([this.view.btnTableFigures,this.view.btnTableFiguresUpdate])}),this.lockToolbar(Common.enumLock.contentLock,p,{array:[this.view.btnCrossRef]}),this.lockToolbar(Common.enumLock.cantUpdateTOF,!this.api.asc_CanUpdateTablesOfFigures(),{array:[this.view.btnTableFiguresUpdate]}),this.lockToolbar(Common.enumLock.inFootnote,this.api.asc_IsCursorInFootnote()||this.api.asc_IsCursorInEndnote(),{array:[this.view.btnAddText]}),this.lockToolbar(Common.enumLock.inHeader,l,{array:[this.view.btnAddText]}),this.lockToolbar(Common.enumLock.cantAddTextTOF,c&&!d&&!h,{array:[this.view.btnAddText]}),this.dlgCrossRefDialog&&this.dlgCrossRefDialog.isVisible()&&this.dlgCrossRefDialog.setLocked(this.view.btnCrossRef.isDisabled())}},lockToolbar:function(t,e,i){this.view&&Common.Utils.lockControls(t,e,i,this.view.getButtons())},onApiCanAddHyperlink:function(t){this.toolbar.editMode&&this.lockToolbar(Common.enumLock.hyperlinkLock,!t,{array:this.view.btnsHyperlink})},onHyperlinkClick:function(t){var e,i,n,o,s,a=this;a.api&&(!(n=function(t,e){"ok"==e&&(i=t.getSettings(),!1!==s?a.api.add_Hyperlink(i):a.api.change_Hyperlink(i)),Common.NotificationCenter.trigger("edit:complete",a.toolbar)})!==(s=a.api.can_AddHyperlink())?(e=new DE.Views.HyperlinkSettingsDialog({api:a.api,handler:n}),(i=new Asc.CHyperlinkProperty).put_Text(s),e.show(),e.setSettings(i)):((o=a.api.getSelectedElements())&&_.isArray(o)&&_.each(o,function(t,e){o[e].get_ObjectType()==Asc.c_oAscTypeSelectElement.Hyperlink&&(i=o[e].get_ObjectValue())}),i&&((e=new DE.Views.HyperlinkSettingsDialog({api:a.api,handler:n})).show(),e.setSettings(i)))),Common.component.Analytics.trackEvent("ToolBar","Add Hyperlink")},onTableContents:function(t,e){var i=this.api.asc_GetTableOfContentsPr(e=!!e);switch(t){case 0:i||(i=new Asc.CTableOfContentsPr).put_OutlineRange(1,9),i.put_Hyperlink(!0),i.put_ShowPageNumbers(!0),i.put_RightAlignTab(!0),i.put_TabLeader(Asc.c_oAscTabLeader.Dot),e?this.api.asc_SetTableOfContentsPr(i):this.api.asc_AddTableOfContents(null,i);break;case 1:i||(i=new Asc.CTableOfContentsPr).put_OutlineRange(1,9),i.put_Hyperlink(!0),i.put_ShowPageNumbers(!1),i.put_TabLeader(Asc.c_oAscTabLeader.None),i.put_StylesType(Asc.c_oAscTOCStylesType.Web),e?this.api.asc_SetTableOfContentsPr(i):this.api.asc_AddTableOfContents(null,i);break;case"settings":var n=this;new DE.Views.TableOfContentsSettings({api:this.api,props:i,type:0,handler:function(t,e){"ok"==t&&(i?n.api.asc_SetTableOfContentsPr(e):n.api.asc_AddTableOfContents(null,e)),Common.NotificationCenter.trigger("edit:complete",n.toolbar)}}).show();break;case"remove":e=e&&i?i.get_InternalClass():void 0,this.api.asc_RemoveTableOfContents(e)}Common.NotificationCenter.trigger("edit:complete",this.toolbar)},onTableContentsUpdate:function(t,e){var i=this.api.asc_GetTableOfContentsPr(e);e&&i&&(e=i.get_InternalClass()),this.api.asc_UpdateTableOfContents("pages"==t,e),Common.NotificationCenter.trigger("edit:complete",this.toolbar)},onTableContentsOpen:function(t){this.api.asc_getButtonsTOC(t.items[0].options.previewId,t.items[1].options.previewId)},onAddTextOpen:function(t){var e=this.api.asc_GetTableOfContentsPr(),e=e?e.get_OutlineEnd():3;this.view.fillAddTextMenu(t,e=e<0?9:e,this.api.asc_GetCurrentLevelTOC())},onAddText:function(t){this.api.asc_AddParagraphToTOC(t)},onNotesClick:function(t){var i=this;switch(t){case"ins_footnote":this.api.asc_AddFootnote();break;case"ins_endnote":this.api.asc_AddEndnote();break;case"delele":new DE.Views.NotesRemoveDialog({handler:function(t,e){"ok"==e&&((e=t.getSettings()).footnote||e.endnote)&&i.api.asc_RemoveAllFootnotes(e.footnote,e.endnote),Common.NotificationCenter.trigger("edit:complete",i.toolbar)}}).show();break;case"settings":var e=i.api.asc_IsCursorInEndnote(),n=i.api.asc_IsCursorInFootnote(),e=e||n?e:Common.Utils.InternalSettings.get("de-settings-note-last")||!1;new DE.Views.NoteSettingsDialog({api:i.api,handler:function(t,e){e&&(e.isEndNote?i.api.asc_SetEndnoteProps(e.props,e.applyToAll):i.api.asc_SetFootnoteProps(e.props,e.applyToAll),"insert"==t&&setTimeout(function(){e.isEndNote?i.api.asc_AddEndnote(e.custom):i.api.asc_AddFootnote(e.custom)},1),"insert"!=t&&"apply"!=t||Common.Utils.InternalSettings.set("de-settings-note-last",e.isEndNote)),Common.NotificationCenter.trigger("edit:complete",i.toolbar)},isEndNote:e,hasSections:1<i.api.asc_GetSectionsCount(),props:e?i.api.asc_GetEndnoteProps():i.api.asc_GetFootnoteProps()}).show();break;case"prev":this.api.asc_GotoFootnote(!1),setTimeout(function(){Common.NotificationCenter.trigger("edit:complete",i.toolbar)},50);break;case"next":this.api.asc_GotoFootnote(!0),setTimeout(function(){Common.NotificationCenter.trigger("edit:complete",i.toolbar)},50);break;case"prev-end":this.api.asc_GotoEndnote(!1),setTimeout(function(){Common.NotificationCenter.trigger("edit:complete",i.toolbar)},50);break;case"next-end":this.api.asc_GotoEndnote(!0),setTimeout(function(){Common.NotificationCenter.trigger("edit:complete",i.toolbar)},50);break;case"to-endnotes":this.api.asc_ConvertFootnoteType(!1,!0,!1),setTimeout(function(){Common.NotificationCenter.trigger("edit:complete",i.toolbar)},50);break;case"to-footnotes":this.api.asc_ConvertFootnoteType(!1,!1,!0),setTimeout(function(){Common.NotificationCenter.trigger("edit:complete",i.toolbar)},50);break;case"swap":this.api.asc_ConvertFootnoteType(!1,!0,!0),setTimeout(function(){Common.NotificationCenter.trigger("edit:complete",i.toolbar)},50)}},onBookmarksClick:function(t){var i=this;new DE.Views.BookmarksDialog({api:i.api,appOptions:i.toolbar.appOptions,props:i.api.asc_GetBookmarksManager(),handler:function(t,e){Common.NotificationCenter.trigger("edit:complete",i.toolbar)}}).show()},onCaptionClick:function(t){var i=this;new DE.Views.CaptionDialog({objectType:this._state.in_object,handler:function(t,e){"ok"==t&&i.api.asc_AddObjectCaption(e),Common.NotificationCenter.trigger("edit:complete",i.toolbar)}}).show()},onShowTOCActions:function(t,e,i){var n=t.button==AscCommon.CCButtonType.Toc?this.view.contentsUpdateMenu:this.view.contentsMenu,t=this.getApplication().getController("DocumentHolder"),o=t.getView(),s=o.cmpEl.find(Common.Utils.String.format("#menu-container-{0}",n.id)),a=this;n&&(this._fromShowContentControls=!0,Common.UI.Menu.Manager.hideAll(),n.rendered||(s.length<1&&(s=$(Common.Utils.String.format('<div id="menu-container-{0}" style="position: absolute; z-index: 10000;"><div class="dropdown-toggle" data-toggle="dropdown"></div></div>',n.id)),o.cmpEl.append(s)),n.render(s),n.cmpEl.attr({tabindex:"-1"}),n.on("hide:after",function(){a._fromShowContentControls||a.api.asc_UncheckContentControlButtons()})),s.css({left:e,top:i}),s.attr("data-value","prevent-canvas-click"),t._preventClick=!0,n.show(),n.alignPosition(),_.delay(function(){n.cmpEl.focus()},10),this._fromShowContentControls=!1)},onHideContentControlsActions:function(){this.view.contentsMenu&&this.view.contentsMenu.hide(),this.view.contentsUpdateMenu&&this.view.contentsUpdateMenu.hide()},onShowContentControlsActions:function(t,e,i){t.type==Asc.c_oAscContentControlSpecificType.TOC&&this.onShowTOCActions(t,e,i)},onCrossRefClick:function(t){var i;this.dlgCrossRefDialog&&this.dlgCrossRefDialog.isVisible()||((i=this).dlgCrossRefDialog=new DE.Views.CrossReferenceDialog({api:i.api,crossRefProps:i.crossRefProps,handler:function(t,e){"ok"!=t&&Common.NotificationCenter.trigger("edit:complete",i.toolbar)}}),i.dlgCrossRefDialog.on("close",function(t){i.crossRefProps=i.dlgCrossRefDialog.getSettings(),Common.NotificationCenter.trigger("edit:complete",i.toolbar)}),i.dlgCrossRefDialog.show())},onTableFigures:function(){var t=this.api.asc_GetTableOfFiguresPr(),i=this;new DE.Views.TableOfContentsSettings({api:this.api,props:t,type:1,handler:function(t,e){"ok"==t&&i.api.asc_AddTableOfFigures(e),Common.NotificationCenter.trigger("edit:complete",i.toolbar)}}).show(),Common.NotificationCenter.trigger("edit:complete",this.toolbar)},onTableFiguresUpdate:function(){this.api.asc_UpdateTablesOfFigures(),Common.NotificationCenter.trigger("edit:complete",this.toolbar)},onAscReplaceCurrentTOF:function(e){Common.UI.warning({msg:this.view.confirmReplaceTOF,buttons:["yes","no","cancel"],primary:"yes",callback:_.bind(function(t){"yes"!=t&&"no"!=t||e&&e("yes"===t),Common.NotificationCenter.trigger("edit:complete",this.toolbar)},this)})},onAscTOFUpdate:function(i){var n=this;new Common.Views.OptionsDialog({width:300,title:this.view.titleUpdateTOF,items:[{caption:this.view.textUpdatePages,value:!0,checked:!0},{caption:this.view.textUpdateAll,value:!1,checked:!1}],handler:function(t,e){"ok"==e&&i&&i(t.getSettings()),Common.NotificationCenter.trigger("edit:complete",n.toolbar)}}).show()},onChangeProtectDocument:function(t){var e;(t=t?t:(e=this.getApplication().getController("DocProtection"))?e.getDocProps():null)&&(this._state.docProtection=t,this.lockToolbar(Common.enumLock.docLockView,t.isReadOnly),this.lockToolbar(Common.enumLock.docLockForms,t.isFormsOnly),this.lockToolbar(Common.enumLock.docLockReview,t.isReviewOnly),this.lockToolbar(Common.enumLock.docLockComments,t.isCommentsOnly))},onAppReady:function(t){var e=this;new Promise(function(t,e){t()}).then(function(){e.view&&(e.view.onAppReady(t),e.onChangeProtectDocument())})}},DE.Controllers.Links||{}))}),define("documenteditor/main/app/collection/Navigation",["underscore","backbone","common/main/lib/component/TreeView"],function(t,e){"use strict";DE.Collections=DE.Collections||{},DE.Collections.Navigation=Common.UI.TreeViewStore.extend({model:Common.UI.TreeViewModel})}),define("documenteditor/main/app/controller/Navigation",["core","documenteditor/main/app/collection/Navigation","documenteditor/main/app/view/Navigation"],function(){"use strict";DE.Controllers.Navigation=Backbone.Controller.extend(_.extend({models:[],collections:["Navigation"],views:["Navigation"],initialize:function(){var t=this;this.addListeners({Navigation:{show:function(){this.canUseViwerNavigation?t.panelNavigation&&t.panelNavigation.viewNavigationList&&t.panelNavigation.viewNavigationList.scroller&&t.panelNavigation.viewNavigationList.scroller.update({alwaysVisibleY:!0}):t.api.asc_ShowDocumentOutline(),t.mode.isEdit||t.mode.isRestrictedEdit||t.panelNavigation.viewNavigationList.focus()},hide:function(){this.canUseViwerNavigation||t.api&&t.api.asc_HideDocumentOutline()}}})},events:function(){},onLaunch:function(){this.panelNavigation=this.createView("Navigation",{storeNavigation:this.getApplication().getCollection("Navigation")}),this.panelNavigation.on("render:after",_.bind(this.onAfterRender,this)),this._navigationObject=null,this._viewerNavigationObject=null,this._isDisabled=!1},setApi:function(t){return this.api=t,this.api.asc_registerCallback("asc_onDocumentOutlineUpdate",_.bind(this.updateNavigation,this)),this.api.asc_registerCallback("asc_onDocumentOutlineCurrentPosition",_.bind(this.onChangeOutlinePosition,this)),this.api.asc_registerCallback("asc_onDocumentOutlineUpdateAdd",_.bind(this.updateNavigation,this)),this.api.asc_registerCallback("asc_onDocumentOutlineUpdateChange",_.bind(this.updateChangeNavigation,this)),this.api.asc_registerCallback("asc_onDocumentOutlineUpdateRemove",_.bind(this.updateNavigation,this)),this.api.asc_registerCallback("asc_onViewerBookmarksUpdate",_.bind(this.updateViewerNavigation,this)),this},setMode:function(t){return this.mode=t,this.canUseViwerNavigation=this.mode.canUseViwerNavigation,this.panelNavigation&&this.panelNavigation.viewNavigationList&&(this.panelNavigation.viewNavigationList.setEmptyText(this.mode.isEdit?this.panelNavigation.txtEmpty:this.panelNavigation.txtEmptyViewer),this.panelNavigation.viewNavigationList.enableKeyEvents=!this.mode.isEdit&&!this.mode.isRestrictedEdit),this},onAfterRender:function(t){t.viewNavigationList.on("item:click",_.bind(this.onSelectItem,this)),t.viewNavigationList.on("item:contextmenu",_.bind(this.onItemContextMenu,this)),t.viewNavigationList.on("item:add",_.bind(this.onItemAdd,this)),t.navigationMenu.on("item:click",_.bind(this.onMenuItemClick,this)),t.navigationMenu.items[11].menu.on("item:click",_.bind(this.onMenuLevelsItemClick,this)),t.btnSettingsMenu.on("item:click",_.bind(this.onMenuSettingsItemClick,this)),t.btnSettingsMenu.items[2].menu.on("item:click",_.bind(this.onMenuLevelsItemClick,this)),t.btnSettingsMenu.items[4].menu.on("item:click",_.bind(this.onMenuFontSizeClick,this)),t.btnClose.on("click",_.bind(this.onClickClosePanel,this)),this.getApplication().getController("Viewport").getView("Viewport").hlayout.on("layout:resizedrag",function(){t.viewNavigationList&&t.viewNavigationList.scroller&&t.viewNavigationList.scroller.update({alwaysVisibleY:!0})})},updateNavigation:function(){if(this._navigationObject||(this._navigationObject=this.api.asc_GetDocumentOutlineManager()),this._navigationObject){this.timerUpdateId&&(clearTimeout(this.timerUpdateId),this.timerUpdateId=0);for(var t=this._navigationObject.get_ElementsCount(),e=-1,i=-1,n=!this._navigationObject.isFirstItemNotHeader(),o=[],s=0;s<t;s++){var a=this._navigationObject.get_Level(s),l=!0;e<a&&0<s&&o[s-1].set("hasSubItems",!0),(i<0||a<=i)&&((0<s||n)&&(i=a),l=!1),o.push(new Common.UI.TreeViewModel({name:this._navigationObject.get_Text(s),level:a,index:s,hasParent:l,isEmptyItem:this._navigationObject.isEmptyItem(s)})),e=a}0<t&&!n&&(o[0].set("hasSubItems",!1),o[0].set("isNotHeader",!0),o[0].set("name",this.txtBeginning),o[0].set("tip",this.txtGotoBeginning));var r=this,c=this.getApplication().getCollection("Navigation");c.reset(o.splice(0,50)),this._currentPos=this._navigationObject.get_CurrentPosition(),!function e(){o.length<1?(r.timerUpdateId&&(clearTimeout(r.timerUpdateId),r.timerUpdateId=0),r.panelNavigation.viewNavigationList.scroller&&r.panelNavigation.viewNavigationList.scroller.update({alwaysVisibleY:!0}),-1<r._currentPos&&r._currentPos<c.length&&r.onChangeOutlinePosition(r._currentPos),r._currentPos=-1):r.timerUpdateId=setTimeout(function(){var t=o.splice(0,100);t.forEach(function(t){var e=t.get("index");t.set("name",r._navigationObject.get_Text(e)),t.set("isEmptyItem",r._navigationObject.isEmptyItem(e))}),c.add(t),-1<r._currentPos&&r._currentPos<c.length&&(r.onChangeOutlinePosition(r._currentPos),r._currentPos=-1),e()},1)}()}},updateChangeNavigation:function(t){var e;this._navigationObject||(this._navigationObject=this.api.asc_GetDocumentOutlineManager()),!this._navigationObject||(e=this.getApplication().getCollection("Navigation")).length<=t||((e=e.at(t)).get("level")!==this._navigationObject.get_Level(t)||0==t&&e.get("isNotHeader")!==this._navigationObject.isFirstItemNotHeader()?this.updateNavigation():(e.set("name",this._navigationObject.get_Text(t)),e.set("isEmptyItem",this._navigationObject.isEmptyItem(t)),this.panelNavigation.viewNavigationList.updateTip(e.get("dataItem"))))},onChangeOutlinePosition:function(t){t<this.panelNavigation.viewNavigationList.store.length?this.panelNavigation.viewNavigationList.scrollToRecord(this.panelNavigation.viewNavigationList.selectByIndex(t)):this._currentPos=t},onItemContextMenu:function(t,e,i,n){for(var o=this.panelNavigation.navigationMenu,s=(o.isVisible()&&o.hide(),this.panelNavigation.$el.offset()),a=n.clientY*Common.Utils.zoom(),n=[n.clientX*Common.Utils.zoom()+5,a-s.top+5],l=0;l<7;l++)o.items[l].setVisible(this.mode.isEdit);o.items[7].setVisible(!this.canUseViwerNavigation),o.items[8].setVisible(!this.canUseViwerNavigation);a=i.get("isNotHeader");o.items[0].setDisabled(a||this._isDisabled),o.items[1].setDisabled(a||this._isDisabled),o.items[3].setDisabled(a||this._isDisabled),o.items[4].setDisabled(this._isDisabled),o.items[5].setDisabled(this._isDisabled),o.items[7].setDisabled(a),null!=n&&(s=this.panelNavigation.$el.find("#menu-navigation-container"),o.rendered||(s.length<1&&(s=$('<div id="menu-navigation-container" style="position: absolute; z-index: 10000;"><div class="dropdown-toggle" data-toggle="dropdown"></div></div>',o.id),$(this.panelNavigation.$el).append(s)),o.render(s),o.cmpEl.attr({tabindex:"-1"})),o.cmpEl.attr("data-value",i.get("index")),s.css({left:n[0],top:n[1]}),o.show(),_.delay(function(){o.cmpEl.focus()},10))},onSelectItem:function(t,e,i,n){this._navigationObject?this._navigationObject.goto(i.get("index")):this._viewerNavigationObject&&this.api.asc_viewerNavigateTo(i.get("index")),(this.mode.isEdit||this.mode.isRestrictedEdit)&&Common.NotificationCenter.trigger("edit:complete",this.panelNavigation)},onItemAdd:function(t,e,i,n){i.set("dataItem",e)},onMenuItemClick:function(t,e){(this._navigationObject||this._viewerNavigationObject)&&(t=parseInt(t.cmpEl.attr("data-value")),"promote"==e.value?this._navigationObject.promote(t):"demote"==e.value?this._navigationObject.demote(t):"before"==e.value?this._navigationObject.insertHeader(t,!0):"after"==e.value?this._navigationObject.insertHeader(t,!1):"new"==e.value?this._navigationObject.insertSubHeader(t):"select"==e.value?this._navigationObject.selectContent(t):"expand"==e.value?this.panelNavigation.viewNavigationList.expandAll():"collapse"==e.value&&this.panelNavigation.viewNavigationList.collapseAll())},onClickClosePanel:function(){Common.NotificationCenter.trigger("leftmenu:change","hide")},onMenuSettingsItemClick:function(t,e){switch(e.value){case"expand":this.panelNavigation.viewNavigationList.expandAll();break;case"collapse":this.panelNavigation.viewNavigationList.collapseAll();break;case"wrap":this.panelNavigation.changeWrapHeadings()}},onMenuLevelsItemClick:function(t,e){this.panelNavigation.viewNavigationList.expandToLevel(e.value-1)},onMenuFontSizeClick:function(t,e){this.panelNavigation.changeFontSize(e.value)},SetDisabled:function(t){this._isDisabled=t},updateViewerNavigation:function(t){if(this._viewerNavigationObject=0<t.length?t:null,this._viewerNavigationObject){for(var e=this._viewerNavigationObject.length,i=-1,n=-1,o=[],s=0;s<e;s++){var a=this._viewerNavigationObject[s].level-1,l=!0;i<a&&0<s&&o[s-1].set("hasSubItems",!0),(n<0||a<=n)&&(n=a,l=!1),o.push(new Common.UI.TreeViewModel({name:this._viewerNavigationObject[s].description,level:a,index:s,hasParent:l,isEmptyItem:!this._viewerNavigationObject[s].description})),i=a}this.getApplication().getCollection("Navigation").reset(o),this.panelNavigation&&this.panelNavigation.viewNavigationList&&this.panelNavigation.viewNavigationList.scroller&&this.panelNavigation.viewNavigationList.scroller.update({alwaysVisibleY:!0})}}},DE.Controllers.Navigation||{}))}),void 0===Common&&(Common={}),define("common/main/lib/component/Slider",["common/main/lib/component/BaseView","underscore"],function(t,c){"use strict";Common.UI.SingleSlider=Common.UI.BaseView.extend({options:{width:100,minValue:0,maxValue:100,step:1,value:100,enableKeyEvents:!1,direction:"horizontal"},disabled:!1,template:c.template(['<div class="slider single-slider <% if (this.options.direction === \'vertical\') { %>vertical<% } %>" style="">','<div class="track"></div>','<div class="thumb" style=""></div>',"<% if (this.options.enableKeyEvents) { %>",'<input type="text" style="position: absolute; top:-10px; width: 1px; height: 1px;">',"<% } %>","</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);t=this;t.width=t.options.width,t.minValue=t.options.minValue,t.maxValue=t.options.maxValue,t.delta=100/(t.maxValue-t.minValue),t.step=t.options.step,t.direction=t.options.direction,t.options.el&&t.render(),this.setValue(t.options.value)},render:function(t){var e,i,n=this,o=(n.rendered?this.cmpEl=n.$el:(this.cmpEl=$(this.template({})),(t?(this.setElement(t,!1),t):n.$el).html(this.cmpEl)),this.cmpEl.find(".track-center").width(n.options.width-14),this.cmpEl["vertical"===n.direction?"height":"width"](n.options.width),this.thumb=this.cmpEl.find(".thumb"),function(t){t.preventDefault(),t.stopPropagation();t=Math.max(0,Math.min(100,Math.round(("vertical"===n.direction?t.pageY*Common.Utils.zoom()-n.cmpEl.offset().top:t.pageX*Common.Utils.zoom()-n.cmpEl.offset().left-n._dragstart)/n.width*100)));n.setThumbPosition(t),n.lastValue=n.value,n.value=t/n.delta+n.minValue,n.thumb.removeClass("active"),$(document).off("mouseup",o),$(document).off("mousemove",s),n._dragstart=void 0,n.trigger("changecomplete",n,Common.UI.isRTL()?n.maxValue-n.value:n.value,n.lastValue)}),s=function(t){n.disabled||void 0!==n._dragstart&&(t.preventDefault(),t.stopPropagation(),t=Math.max(0,Math.min(100,Math.round(("vertical"===n.direction?t.pageY*Common.Utils.zoom()-n.cmpEl.offset().top:t.pageX*Common.Utils.zoom()-n.cmpEl.offset().left-n._dragstart)/n.width*100))),n.setThumbPosition(t),n.lastValue=n.value,n.value=t/n.delta+n.minValue,.001<Math.abs(n.value-n.lastValue)&&n.trigger("change",n,Common.UI.isRTL()?n.maxValue-n.value:n.value,n.lastValue))},a=function(t){n.lastValue=n.value,n.value=Math.max(n.minValue,Math.min(n.maxValue,n.value+(t?n.step:-n.step))),n.setThumbPosition(Math.round((n.value-n.minValue)*n.delta)),n.trigger("change",n,Common.UI.isRTL()?n.maxValue-n.value:n.value,n.lastValue)},l=function(t){n.disabled||t.keyCode!=Common.UI.Keys.UP&&t.keyCode!=Common.UI.Keys.DOWN&&t.keyCode!=Common.UI.Keys.LEFT&&t.keyCode!=Common.UI.Keys.RIGHT||(t.preventDefault(),t.stopPropagation(),i.off("keydown","input",l),e=setInterval(c.bind(a,n,t.keyCode==Common.UI.Keys.UP||t.keyCode==Common.UI.Keys.RIGHT),100))};return n.rendered||((i=n.cmpEl).on("mousedown",".thumb",function(t){n.disabled||(n._dragstart="vertical"===n.direction?t.pageY*Common.Utils.zoom()-n.thumb.offset().top:t.pageX*Common.Utils.zoom()-n.thumb.offset().left-7,n.thumb.addClass("active"),$(document).on("mouseup",o),$(document).on("mousemove",s),n.options.enableKeyEvents&&setTimeout(function(){n.input.focus()},10))}),i.on("mousedown",".track",function(t){n.disabled||(t=Math.max(0,Math.min(100,Math.round(("vertical"===n.direction?t.pageY*Common.Utils.zoom()-n.cmpEl.offset().top:t.pageX*Common.Utils.zoom()-n.cmpEl.offset().left)/n.width*100))),n.setThumbPosition(t),n.lastValue=n.value,n.value=t/n.delta+n.minValue,n.trigger("change",n,Common.UI.isRTL()?n.maxValue-n.value:n.value,n.lastValue),n.trigger("changecomplete",n,Common.UI.isRTL()?n.maxValue-n.value:n.value,n.lastValue))}),this.options.enableKeyEvents&&(i.on("keydown","input",l),i.on("keyup","input",function(t){n.disabled||(t.keyCode==Common.UI.Keys.UP||t.keyCode==Common.UI.Keys.DOWN||Common.UI.Keys.LEFT||Common.UI.Keys.RIGHT)&&(t.stopPropagation(),t.preventDefault(),clearInterval(e),a(t.keyCode==Common.UI.Keys.UP||t.keyCode==Common.UI.Keys.RIGHT),i.on("keydown","input",l),n.trigger("changecomplete",n,Common.UI.isRTL()?n.maxValue-n.value:n.value,n.lastValue))}))),n.rendered=!0,this},setThumbPosition:function(t){"vertical"===this.direction?this.thumb.css({top:t+"%"}):this.thumb.css({left:t+"%"})},setValue:function(t){this.lastValue=this.value,this.value=Math.max(this.minValue,Math.min(this.maxValue,t)),this.setThumbPosition(Math.round(((Common.UI.isRTL()?this.maxValue-t:t)-this.minValue)*this.delta))},getValue:function(){return this.value},setDisabled:function(t){(t=!!t)!==this.disabled&&this.cmpEl.toggleClass("disabled",t),this.disabled=t}}),Common.UI.MultiSlider=Common.UI.BaseView.extend({options:{width:100,minValue:0,maxValue:100,values:[0,100],includeSnap:!1,intervalSnap:void 0,thumbTemplate:'<div class="thumb" style=""></div>'},disabled:!1,template:c.template(['<div class="slider multi-slider">','<div class="track">','<div class="track-left"></div>','<div class="track-center""></div>','<div class="track-right" style=""></div>',"</div>","<% _.each(items, function(item) { %>","<%= thumbTemplate %>","<% }); %>","</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);t=this;t.width=t.options.width,t.minValue=t.options.minValue,t.maxValue=t.options.maxValue,t.delta=100/(t.maxValue-t.minValue),t.includeSnap=t.options.includeSnap,t.intervalSnap=t.options.intervalSnap,t.thumbs=[],t.options.el&&t.render()},render:function(t){var r=this,t=(r.rendered?this.cmpEl=this.$el:(this.cmpEl=$(this.template({items:this.options.values,thumbTemplate:this.options.thumbTemplate})),(t?(this.setElement(t,!1),t):this.$el).html(this.cmpEl)),this.cmpEl),n=(t.find(".track-center").width(r.options.width-14),t.width(r.options.width),function(i){var n,o;r.includeSnap&&(n=r.minValue,o=function(t){return(.01*r.width*t+r.cmpEl.offset().left+r._dragstart)/Common.Utils.zoom()},r.centers=[],c.each(r.thumbs,function(t,e){e!=i&&n!=t.position&&(r.centers.push(o((t.position-n)/2+n)),n=t.position)}),n!=r.maxValue&&r.centers.push(o((r.maxValue-n)/2+n)))}),a=function(e){r.includeSnap&&c.each(r.centers,function(t){e.pageX<=t+r.intervalSnap&&e.pageX>=t-r.intervalSnap&&(e.pageX=t)})},o=function(t){for(var e=100,i=0,n=r.thumbs.length,o=0;o<n;o++){var s,a,l=Math.abs(r.thumbs[o].position-t);Math.abs(l<=e)&&(s=r.thumbs[o+1],void 0!==(a=r.thumbs[o-1])&&t<a.position||void 0!==s&&t>s.position||(i=o,e=l))}return i};return this.binding={onMouseUp:c.bind(function(t){t.preventDefault(),t.stopPropagation(),a(t);var e=t.data.index,i=r.thumbs[e].value,n=e-1<0?0:r.thumbs[e-1].position,o=e+1<r.thumbs.length?r.thumbs[e+1].position:100,t=Math.round((t.pageX*Common.Utils.zoom()-r.cmpEl.offset().left-r._dragstart)/r.width*100),n=t<n||o<t,o=Math.max(0,Math.min(100,t)),t=o/r.delta+r.minValue;r.thumbs.length<3&&(r.isRemoveThumb=!1),r.isRemoveThumb?(r.trigger("removethumb",r,c.findIndex(r.thumbs,{index:e})),r.trigger("change",r,t,i),r.trigger("changecomplete",r,t,i)):(r.setThumbPosition(e,o),r.thumbs[e].value=t,n&&r.sortThumbs()),$(document).off("mouseup",r.binding.onMouseUp),$(document).off("mousemove",r.binding.onMouseMove),r._dragstart=void 0,r.isRemoveThumb||r.trigger("changecomplete",r,t,i),r.isRemoveThumb=void 0},this),onMouseMove:c.bind(function(t){var e,i,n,o,s;r.disabled||void 0!==r._dragstart&&(t.preventDefault(),t.stopPropagation(),a(t),e=t.data.index,i=r.thumbs[e].value,n=e-1<0?0:r.thumbs[e-1].position,s=e+1<r.thumbs.length?r.thumbs[e+1].position:100,n=(o=Math.round((t.pageX*Common.Utils.zoom()-r.cmpEl.offset().left-r._dragstart)/r.width*100))<n||s<o,o=(s=Math.max(0,Math.min(100,o)))/r.delta+r.minValue,r.setThumbPosition(e,s),r.thumbs[e].value=o,n&&r.sortThumbs(),s=t.pageY*Common.Utils.zoom()-r.cmpEl.offset().top,r.isRemoveThumb=s>r.cmpEl.height()||s<0,r.setRemoveThumb(e,r.isRemoveThumb),.001<Math.abs(o-i)&&r.trigger("change",r,o,i))},this),onMouseDown:c.bind(function(t){var i,e;r.disabled||(i=t.data.index,e=r.thumbs[i].thumb,r._dragstart=t.pageX*Common.Utils.zoom()-e.offset().left-e.width()/2,n(i),r.setActiveThumb(i),c.each(r.thumbs,function(t,e){i==e?t.thumb.css("z-index",500):t.thumb.css("z-index","")}),$(document).on("mouseup",null,t.data,r.binding.onMouseUp),$(document).on("mousemove",null,t.data,r.binding.onMouseMove))},this)},this.$thumbs=t.find(".thumb"),c.each(this.$thumbs,function(t,e){t=$(t);r.thumbs.push({thumb:t,index:e}),r.setValue(e,r.options.values[e]),t.on("mousedown",null,r.thumbs[e],r.binding.onMouseDown)}),r.setActiveThumb(0,!0),r.rendered||t.on("mouseup",".track",function(t){var e,i;r.disabled||!c.isUndefined(r._dragstart)||9<r.thumbs.length||(t=Math.max(0,Math.min(100,Math.round((t.pageX*Common.Utils.zoom()-r.cmpEl.offset().left)/r.width*100))),e=o(t),r.thumbs[e].colorValue,r.thumbs[e].value,e=t/r.delta+r.minValue,r.addThumb(),i=r.thumbs.length-1,r.setThumbPosition(i,t),r.thumbs[i].value=e,r.trigger("addthumb",r,i,t),r.trigger("change",r),r.trigger("changecomplete",r))}),r.rendered=!0,this},setActiveThumb:function(t,e){this.currentThumb=t,this.$thumbs=this.cmpEl.find(".thumb"),this.$thumbs.removeClass("active"),this.thumbs[t].thumb.addClass("active"),!0!==e&&this.trigger("thumbclick",this,t)},setRemoveThumb:function(t,e){-1!==c.findIndex(this.thumbs,{index:t})&&(e&&2<this.thumbs.length?this.$el.find(".active").addClass("remove"):this.$el.find(".remove").removeClass("remove"))},setThumbPosition:function(t,e){this.thumbs[t].position=e,this.thumbs[t].thumb.css({left:e+"%"})},setValue:function(t,e){this.thumbs[t].value=Math.max(this.minValue,Math.min(this.maxValue,e)),this.setThumbPosition(t,Math.round((e-this.minValue)*this.delta))},getValue:function(t){return this.thumbs[t].value},getValues:function(){var e=[];return c.each(this.thumbs,function(t){e.push(t.value)}),e},setDisabled:function(t){(t=!!t)!==this.disabled&&this.cmpEl.toggleClass("disabled",t),this.disabled=t},sortThumbs:function(){this.thumbs.sort(function(t,e){return t.position-e.position});var i=[];return c.each(this.thumbs,function(t,e){i.push(t.index),t.index=e}),i},setThumbs:function(t){var e=this.thumbs.length;if(e!=t)for(var i=0;i<Math.abs(t-e);i++)e<t?this.addThumb():this.removeThumb()},addThumb:function(){var t=this.cmpEl,e=$(this.options.thumbTemplate),i=this.thumbs.length;t.append(e),this.thumbs.push({thumb:e,index:i}),0<i&&this.setValue(i,this.getValue(i-1)),e.on("mousedown",null,this.thumbs[i],this.binding.onMouseDown)},removeThumb:function(t){0<(t=void 0===t?this.thumbs.length-1:t)&&(this.thumbs[t].thumb.remove(),this.thumbs.splice(t,1))}})}),define("documenteditor/main/app/view/PageThumbnails",["common/main/lib/util/utils","common/main/lib/component/BaseView","common/main/lib/component/Layout","common/main/lib/component/TreeView","common/main/lib/component/Slider"],function(t){"use strict";DE.Views.PageThumbnails=Common.UI.BaseView.extend(_.extend({el:"#left-panel-thumbnails",storeThumbnails:void 0,template:_.template(['<div id="thumbnails-box" class="layout-ct vbox">','<div id="thumbnails-header">',"<label><%= scope.textPageThumbnails %></label>",'<div id="thumbnails-btn-close" class="float-right margin-left-4"></div>','<div id="thumbnails-btn-settings" class="float-right"></div>',"</div>",'<div id="thumbnails-list">',"</div>","</div>"].join("")),initialize:function(t){_.extend(this,t),Common.UI.BaseView.prototype.initialize.call(this,arguments)},render:function(t){return this.rendered||(t=t||this.el,$(t).html(this.template({scope:this})),this.$el=$(t),this.buttonClose=new Common.UI.Button({parentEl:$("#thumbnails-btn-close",this.$el),cls:"btn-toolbar",iconCls:"toolbar__icon btn-close",hint:this.textClosePanel}),this.buttonClose.on("click",_.bind(this.onClickClosePanel,this)),this.mnuSizeSetting=new Common.UI.MenuItem({template:_.template(['<div id="thumbnails-size"',"<% if(!_.isUndefined(options.stopPropagation)) { %>",'data-stopPropagation="true"',"<% } %>",">","<label>"+this.textThumbnailsSize+"</label>",'<div class="thumbnails-sld-box">','<span class="menu-item-icon menu__icon btn-thumbnail-small"></span>','<div id="sld-thumbnails-size"></div>','<span class="menu-item-icon menu__icon btn-thumbnail-big"></span>',"</div>","</div>"].join("")),stopPropagation:!0}),this.buttonSettings=new Common.UI.Button({parentEl:$("#thumbnails-btn-settings",this.$el),cls:"btn-toolbar",iconCls:"toolbar__icon btn-settings",hint:this.textThumbnailsSettings,menu:new Common.UI.Menu({menuAlign:"tr-br",style:"min-width: 198px;",items:[this.mnuSizeSetting,{caption:"--"},{caption:this.textHighlightVisiblePart,checkable:!0,value:"highlight",checked:Common.localStorage.getBool("de-thumbnails-highlight",!0)}]})})),this.sldrThumbnailsSize=new Common.UI.SingleSlider({el:$("#sld-thumbnails-size"),width:120,minValue:0,maxValue:100,value:50}),this.rendered=!0,this.trigger("render:after",this),this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this.fireEvent("show",this)},hide:function(){Common.UI.BaseView.prototype.hide.call(this,arguments),this.fireEvent("hide",this)},ChangeSettings:function(t){},onClickClosePanel:function(){Common.NotificationCenter.trigger("leftmenu:change","hide")}},DE.Views.PageThumbnails||{}))}),define("documenteditor/main/app/controller/PageThumbnails",["core","documenteditor/main/app/view/PageThumbnails"],function(){"use strict";DE.Controllers.PageThumbnails=Backbone.Controller.extend(_.extend({models:[],views:["PageThumbnails"],initialize:function(){this._sendUndoPoint=!0,this.firstShow=!0,this.addListeners({PageThumbnails:{show:_.bind(function(){this.api.asc_viewerThumbnailsResize(),this.firstShow&&(this.api.asc_setViewerThumbnailsUsePageRect(Common.localStorage.getBool("de-thumbnails-highlight",!0)),this.firstShow=!1)},this)}})},events:function(){},onLaunch:function(){this.panelThumbnails=this.createView("PageThumbnails"),this.panelThumbnails.on("render:after",_.bind(this.onAfterRender,this))},setApi:function(t){return this.api=t,this.api.asc_registerCallback("asc_onViewerThumbnailsZoomUpdate",_.bind(this.updateSize,this)),this},setMode:function(t){return this.mode=t,this},onAfterRender:function(t){t.sldrThumbnailsSize.on("change",_.bind(this.onChangeSize,this)),t.buttonSettings.menu.on("item:click",_.bind(this.onHighlightVisiblePart,this)),t.buttonSettings.menu.on("show:before",_.bind(function(){this.panelThumbnails.sldrThumbnailsSize.setValue(this.thumbnailsSize)},this)),DE.getController("Viewport").getView("Viewport").hlayout.on("layout:resizedrag",_.bind(function(){this.firstShow||this.api.asc_viewerThumbnailsResize()},this))},onHighlightVisiblePart:function(t,e,i){"highlight"===e.value&&(e=e.isChecked(),this.api.asc_setViewerThumbnailsUsePageRect(e),Common.localStorage.setBool("de-thumbnails-highlight",e))},updateSize:function(t){this.thumbnailsSize=Math.min(100*t,100)},onChangeSize:function(t,e){void 0!==e&&(this.thumbnailsSize=e,this.api.asc_setViewerThumbnailsZoom(e/100))}},DE.Controllers.PageThumbnails||{}))}),define("text!documenteditor/main/app/template/RightMenu.template",[],function(){return'<div id="view-right-menu" class="tool-menu right">\n    <div class="right-panel">\n        <div id="id-paragraph-settings" class="settings-panel">\n        </div>\n        <div id="id-table-settings" class="settings-panel">\n        </div>\n        <div id="id-image-settings" class="settings-panel">\n        </div>\n        <div id="id-header-settings" class="settings-panel">\n        </div>\n        <div id="id-shape-settings" class="settings-panel">\n        </div>\n        <div id="id-chart-settings" class="settings-panel">\n        </div>\n        <div id="id-mail-merge-settings" class="settings-panel">\n        </div>\n        <div id="id-textart-settings" class="settings-panel">\n        </div>\n        <div id="id-signature-settings" class="settings-panel">\n        </div>\n        <div id="id-form-settings" class="settings-panel">\n        </div>\n    </div>\n    <div class="tool-menu-btns">\n        <div class="ct-btn-category arrow-left"></div>\n        <button id="id-right-menu-text" class="btn btn-category arrow-left" data-hint="0" data-hint-direction="left" data-hint-offset="big" content-target="id-paragraph-settings"><i class="icon toolbar__icon btn-paragraph">&nbsp;</i></button>\n        <button id="id-right-menu-table" class="btn btn-category arrow-left" data-hint="0" data-hint-direction="left" data-hint-offset="big" content-target="id-table-settings"><i class="icon toolbar__icon btn-menu-table">&nbsp;</i></button>\n        <button id="id-right-menu-image" class="btn btn-category arrow-left" data-hint="0" data-hint-direction="left" data-hint-offset="big" content-target="id-image-settings"><i class="icon toolbar__icon btn-menu-image">&nbsp;</i></button>\n        <button id="id-right-menu-shape" class="btn btn-category arrow-left" data-hint="0" data-hint-direction="left" data-hint-offset="big" content-target="id-shape-settings"><i class="icon toolbar__icon btn-menu-shape">&nbsp;</i></button>\n        <button id="id-right-menu-chart" class="btn btn-category arrow-left" data-hint="0" data-hint-direction="left" data-hint-offset="big" content-target="id-chart-settings"><i class="icon toolbar__icon btn-menu-chart">&nbsp;</i></button>\n        <button id="id-right-menu-header" class="btn btn-category arrow-left" data-hint="0" data-hint-direction="left" data-hint-offset="big" content-target="id-header-settings"><i class="icon toolbar__icon btn-menu-header">&nbsp;</i></button>\n        <button id="id-right-menu-textart" class="btn btn-category arrow-left" data-hint="0" data-hint-direction="left" data-hint-offset="big" content-target="id-textart-settings"><i class="icon toolbar__icon btn-menu-textart">&nbsp;</i></button>\n        <button id="id-right-menu-mail-merge" class="btn btn-category arrow-left hidden" data-hint="0" data-hint-direction="left" data-hint-offset="big" content-target="id-mail-merge-settings"><i class="icon toolbar__icon btn-mailmerge">&nbsp;</i></button>\n        <button id="id-right-menu-signature" class="btn btn-category arrow-left hidden" data-hint="0" data-hint-direction="left" data-hint-offset="big" content-target="id-signature-settings"><i class="icon toolbar__icon btn-menu-signature">&nbsp;</i></button>\n        <button id="id-right-menu-form" class="btn btn-category arrow-left hidden" data-hint="0" data-hint-direction="left" data-hint-offset="big" content-target="id-form-settings"><i class="icon toolbar__icon btn-field">&nbsp;</i></button>\n    </div>\n</div>'}),define("text!documenteditor/main/app/template/ParagraphSettings.template",[],function(){return'<table cols="2">\n    <tr>\n        <td colspan=2>\n            <label class="header"><%= scope.strLineHeight %></label>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" width="50%">\n            <div id="paragraph-combo-line-rule" style="width: 85px;"></div>\n        </td>\n        <td class="padding-small" width="50%">\n            <div id="paragraph-spin-line-height"></div>\n        </td>\n    </tr>\n    <tr>\n        <td colspan=2>\n            <label class="header"><%= scope.strParagraphSpacing %></label>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" width="50%">\n            <label class="input-label"><%= scope.strSpacingBefore %></label>\n            <div id="paragraph-spin-spacing-before"></div>\n        </td>\n        <td class="padding-small" width="50%">\n            <label class="input-label"><%= scope.strSpacingAfter %></label>\n            <div id="paragraph-spin-spacing-after"></div>\n        </td>\n    </tr>\n    <tr class="text-only">\n        <td class="padding-small" colspan=2>\n            <div id="paragraph-checkbox-add-interval"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" colspan=2>\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr>\n        <td colspan=2>\n            <label class="header"><%= scope.strIndent %></label>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" width="50%">\n            <label class="input-label"><%= scope.strIndentsLeftText %></label>\n            <div id="paragraph-spin-indent-left"></div>\n        </td>\n        <td class="padding-small" width="50%">\n            <label class="input-label"><%= scope.strIndentsRightText %></label>\n            <div id="paragraph-spin-indent-right"></div>\n        </td>\n    </tr>\n    <tr>\n        <td colspan=2>\n            <label class="input-label"><%= scope.strIndentsSpecial %></label>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" width="50%">\n            <div id="paragraph-combo-special" style="width: 85px;"></div>\n        </td>\n        <td class="padding-small" width="50%">\n            <div id="paragraph-spin-special-by"></div>\n        </td>\n    </tr>\n    <tr class="text-only">\n        <td class="padding-small" colspan=2>\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr class="text-only">\n        <td class="padding-small" colspan=2>\n            <div class="color-btn-wrap">\n                <div id="paragraph-color-btn" style="display: inline-block;"></div>\n                <label class="input-label margin"><%= scope.textBackColor %></label>\n            </div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" colspan=2>\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr>\n        <td align="center" colspan=2>\n            <label class="link" id="paragraph-advanced-link" data-hint="1" data-hint-direction="bottom" data-hint-offset="medium"><%= scope.textAdvanced %></label>\n        </td>\n    </tr>\n    <tr class="finish-cell"></tr>\n</table>'}),define("documenteditor/main/app/view/ParagraphSettings",["text!documenteditor/main/app/template/ParagraphSettings.template","jquery","underscore","backbone","common/main/lib/component/ComboBox","common/main/lib/component/MetricSpinner","common/main/lib/component/CheckBox","common/main/lib/component/ThemeColorPalette","common/main/lib/component/ColorButton","documenteditor/main/app/view/ParagraphSettingsAdvanced"],function(t,i,n,e){"use strict";DE.Views.ParagraphSettings=e.View.extend(n.extend({el:"#id-paragraph-settings",template:n.template(t),events:{},options:{alias:"ParagraphSettings"},initialize:function(){this._initSettings=!0,this._state={LineRuleIdx:null,LineHeight:null,LineSpacingBefore:null,LineSpacingAfter:null,AddInterval:!1,BackColor:"#000000",DisabledControls:!0,HideTextOnlySettings:!1,LeftIndent:null,RightIndent:null,FirstLine:null,CurSpecial:void 0},this.spinners=[],this.lockedControls=[],this._locked=!0,this.isChart=!1,this.isSmartArtInternal=!1,this._arrLineRule=[{displayValue:this.textAtLeast,defaultValue:5,value:c_paragraphLinerule.LINERULE_LEAST,minValue:.03,step:.01,defaultUnit:"cm"},{displayValue:this.textAuto,defaultValue:1,value:c_paragraphLinerule.LINERULE_AUTO,minValue:.5,step:.01,defaultUnit:""},{displayValue:this.textExact,defaultValue:5,value:c_paragraphLinerule.LINERULE_EXACT,minValue:.03,step:.01,defaultUnit:"cm"}],this._arrSpecial=[{displayValue:this.textNoneSpecial,value:c_paragraphSpecial.NONE_SPECIAL,defaultValue:0},{displayValue:this.textFirstLine,value:c_paragraphSpecial.FIRST_LINE,defaultValue:12.7},{displayValue:this.textHanging,value:c_paragraphSpecial.HANGING,defaultValue:12.7}],this.render()},render:function(){var t=i(this.template({scope:this})),e=this;this.cmbLineRule=new Common.UI.ComboBox({el:t.findById("#paragraph-combo-line-rule"),cls:"input-group-nr",menuStyle:"min-width: 85px;",editable:!1,data:this._arrLineRule,disabled:this._locked,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbLineRule.setValue(""),this.lockedControls.push(this.cmbLineRule),this.numLineHeight=new Common.UI.MetricSpinner({el:t.findById("#paragraph-spin-line-height"),step:.01,width:85,value:"",defaultUnit:"",maxValue:132,minValue:.5,disabled:this._locked,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.lockedControls.push(this.numLineHeight),this.numSpacingBefore=new Common.UI.MetricSpinner({el:t.findById("#paragraph-spin-spacing-before"),step:.1,width:85,value:"",defaultUnit:"cm",maxValue:55.88,minValue:0,allowAuto:!0,autoText:this.txtAutoText,disabled:this._locked,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.spinners.push(this.numSpacingBefore),this.lockedControls.push(this.numSpacingBefore),this.numSpacingAfter=new Common.UI.MetricSpinner({el:t.findById("#paragraph-spin-spacing-after"),step:.1,width:85,value:"",defaultUnit:"cm",maxValue:55.88,minValue:0,allowAuto:!0,autoText:this.txtAutoText,disabled:this._locked,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.spinners.push(this.numSpacingAfter),this.lockedControls.push(this.numSpacingAfter),this.chAddInterval=new Common.UI.CheckBox({el:t.findById("#paragraph-checkbox-add-interval"),labelText:this.strSomeParagraphSpace,disabled:this._locked,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.lockedControls.push(this.chAddInterval),this.btnColor=new Common.UI.ColorButton({parentEl:t.findById("#paragraph-color-btn"),disabled:this._locked,transparent:!0,menu:!0,eyeDropper:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"medium"}),this.lockedControls.push(this.btnColor),this.numIndentsLeft=new Common.UI.MetricSpinner({el:t.findById("#paragraph-spin-indent-left"),step:.1,width:85,defaultUnit:"cm",defaultValue:0,value:"0 cm",maxValue:55.87,minValue:-55.87,disabled:this._locked,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.spinners.push(this.numIndentsLeft),this.lockedControls.push(this.numIndentsLeft),this.numIndentsRight=new Common.UI.MetricSpinner({el:t.findById("#paragraph-spin-indent-right"),step:.1,width:85,defaultUnit:"cm",defaultValue:0,value:"0 cm",maxValue:55.87,minValue:-55.87,disabled:this._locked,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.spinners.push(this.numIndentsRight),this.lockedControls.push(this.numIndentsRight),this.cmbSpecial=new Common.UI.ComboBox({el:t.findById("#paragraph-combo-special"),cls:"input-group-nr",editable:!1,data:this._arrSpecial,style:"width: 85px;",menuStyle:"min-width: 85px;",disabled:this._locked,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbSpecial.setValue(""),this.lockedControls.push(this.cmbSpecial),this.numSpecialBy=new Common.UI.MetricSpinner({el:t.findById("#paragraph-spin-special-by"),step:.1,width:85,defaultUnit:"cm",defaultValue:0,value:"0 cm",maxValue:55.87,minValue:0,disabled:this._locked,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.spinners.push(this.numSpecialBy),this.lockedControls.push(this.numSpecialBy),this.numLineHeight.on("change",this.onNumLineHeightChange.bind(this)),this.numSpacingBefore.on("change",this.onNumSpacingBeforeChange.bind(this)),this.numSpacingAfter.on("change",this.onNumSpacingAfterChange.bind(this)),this.numLineHeight.on("inputleave",function(){e.fireEvent("editcomplete",e)}),this.numSpacingBefore.on("inputleave",function(){e.fireEvent("editcomplete",e)}),this.numSpacingAfter.on("inputleave",function(){e.fireEvent("editcomplete",e)}),this.chAddInterval.on("change",this.onAddIntervalChange.bind(this)),this.cmbLineRule.on("selected",this.onLineRuleSelect.bind(this)),this.cmbLineRule.on("hide:after",this.onHideMenus.bind(this)),this.btnColor.on("color:select",this.onColorPickerSelect.bind(this)),this.btnColor.on("eyedropper:start",this.onEyedropperStart.bind(this)),this.btnColor.on("eyedropper:end",this.onEyedropperEnd.bind(this)),this.numIndentsLeft.on("change",this.onNumIndentsLeftChange.bind(this)),this.numIndentsRight.on("change",this.onNumIndentsRightChange.bind(this)),this.numSpecialBy.on("change",this.onFirstLineChange.bind(this)),this.cmbSpecial.on("selected",n.bind(this.onSpecialSelect,this)),this.numIndentsLeft.on("inputleave",function(){e.fireEvent("editcomplete",e)}),this.numIndentsRight.on("inputleave",function(){e.fireEvent("editcomplete",e)}),this.numSpecialBy.on("inputleave",function(){e.fireEvent("editcomplete",e)}),this.linkAdvanced=t.findById("#paragraph-advanced-link"),this.linkAdvanced.toggleClass("disabled",this._locked),this.$el.on("click","#paragraph-advanced-link",this.openAdvancedSettings.bind(this)),this.$el.html(t),this.TextOnlySettings=i(".text-only",this.$el),this.rendered=!0},setApi:function(t){return this.api=t,this.api&&this.api.asc_registerCallback("asc_onParaSpacingLine",n.bind(this._onLineSpacing,this)),this},onNumLineHeightChange:function(t,e,i,n){""!==this.cmbLineRule.getRawValue()&&(c_paragraphLinerule.LINERULE_AUTO,this.api&&this.api.put_PrLineSpacing(this.cmbLineRule.getValue(),this.cmbLineRule.getValue()==c_paragraphLinerule.LINERULE_AUTO?t.getNumberValue():Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())))},onNumSpacingBeforeChange:function(t,e,i,n){this.api&&(t=t.getNumberValue(),this._state.LineSpacingBefore=t<0?-1:Common.Utils.Metric.fnRecalcToMM(t),this.api.put_LineSpacingBeforeAfter(0,this._state.LineSpacingBefore))},onNumSpacingAfterChange:function(t,e,i,n){this.api&&(t=t.getNumberValue(),this._state.LineSpacingAfter=t<0?-1:Common.Utils.Metric.fnRecalcToMM(t),this.api.put_LineSpacingBeforeAfter(1,this._state.LineSpacingAfter))},onAddIntervalChange:function(t,e,i,n){this.api&&this.api.put_AddSpaceBetweenPrg("checked"==t.getValue()),this.fireEvent("editcomplete",this)},onLineRuleSelect:function(t,e){this.api&&this.api.put_PrLineSpacing(e.value,e.defaultValue),this.numLineHeight.setDefaultUnit(this._arrLineRule[e.value].defaultUnit),this.numLineHeight.setMinValue(this._arrLineRule[e.value].minValue),this.numLineHeight.setStep(this._arrLineRule[e.value].step),this.fireEvent("editcomplete",this)},_onLineSpacing:function(t){var e,i=t.get_LineRule(),t=t.get_Line();this._state.LineRuleIdx!==i&&(this.cmbLineRule.setValue(null!==i?this._arrLineRule[i].value:""),this.numLineHeight.setMinValue(this._arrLineRule[null!==i?i:1].minValue),this.numLineHeight.setDefaultUnit(this._arrLineRule[null!==i?i:1].defaultUnit),this.numLineHeight.setStep(this._arrLineRule[null!==i?i:1].step),this._state.LineRuleIdx=i),(.001<Math.abs(this._state.LineHeight-t)||(null===this._state.LineHeight||null===t)&&this._state.LineHeight!==t)&&(e="",i==c_paragraphLinerule.LINERULE_AUTO?e=t:null!==i&&null!==t&&(e=Common.Utils.Metric.fnRecalcFromMM(t)),this.numLineHeight.setValue(null!==e?e:"",!0),this._state.LineHeight=t)},onColorPickerSelect:function(t,e){this.BackColor=e,this._state.BackColor=this.BackColor,this.api&&("transparent"==e?this.api.put_ParagraphShade(!1):this.api.put_ParagraphShade(!0,Common.Utils.ThemeColor.getRgbColor(e))),this.fireEvent("editcomplete",this)},onSpecialSelect:function(t,e){var i,e=e.value,n=e===c_paragraphSpecial.NONE_SPECIAL?0:this.numSpecialBy.getNumberValue(),e=(0===(n=Common.Utils.Metric.fnRecalcToMM(n))&&(n=this._arrSpecial[e].defaultValue),e===c_paragraphSpecial.HANGING&&(n=-n),new Asc.asc_CParagraphProperty);e.put_Ind(new Asc.asc_CParagraphInd),e.get_Ind().put_FirstLine(n),(n<0||this._state.FirstLine<0)&&null!=(i=this._state.LeftIndent)&&e.get_Ind().put_Left(n<0?i-n:i),this.api&&this.api.paraApply(e),this.fireEvent("editcomplete",this)},onFirstLineChange:function(t,e,i,n){var o,t=Common.Utils.Metric.fnRecalcToMM(t.getNumberValue()),s=(this._state.CurSpecial===c_paragraphSpecial.HANGING&&(t=-t),new Asc.asc_CParagraphProperty);s.put_Ind(new Asc.asc_CParagraphInd),s.get_Ind().put_FirstLine(t),(t<0||this._state.FirstLine<0)&&null!=(o=this._state.LeftIndent)&&s.get_Ind().put_Left(t<0?o-t:o),this.api&&this.api.paraApply(s)},onNumIndentsLeftChange:function(t,e,i,n){var t=Common.Utils.Metric.fnRecalcToMM(t.getNumberValue()),o=(this._state.FirstLine<0&&(t-=this._state.FirstLine),new Asc.asc_CParagraphProperty);o.put_Ind(new Asc.asc_CParagraphInd),o.get_Ind().put_Left(t),this.api&&this.api.paraApply(o)},onNumIndentsRightChange:function(t,e,i,n){var o=new Asc.asc_CParagraphProperty;o.put_Ind(new Asc.asc_CParagraphInd),o.get_Ind().put_Right(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())),this.api&&this.api.paraApply(o)},ChangeSettings:function(t){if(this._initSettings&&this.createDelayedElements(),this.disableControls(this._locked),this.hideTextOnlySettings(this.isChart||this.isSmartArtInternal),t){var e={Line:t.get_Spacing().get_Line(),Before:t.get_Spacing().get_Before(),After:t.get_Spacing().get_After(),LineRule:t.get_Spacing().get_LineRule()},i={ContextualSpacing:t.get_ContextualSpacing()},n=(this._state.LineRuleIdx!==e.LineRule&&(this.cmbLineRule.setValue(null!==e.LineRule?this._arrLineRule[e.LineRule].value:""),this.numLineHeight.setMinValue(this._arrLineRule[null!==e.LineRule?e.LineRule:1].minValue),this.numLineHeight.setDefaultUnit(this._arrLineRule[null!==e.LineRule?e.LineRule:1].defaultUnit),this.numLineHeight.setStep(this._arrLineRule[null!==e.LineRule?e.LineRule:1].step),this._state.LineRuleIdx=e.LineRule),(.001<Math.abs(this._state.LineHeight-e.Line)||(null===this._state.LineHeight||null===e.Line)&&this._state.LineHeight!==e.Line)&&(n="",e.LineRule==c_paragraphLinerule.LINERULE_AUTO?n=e.Line:null!==e.LineRule&&null!==e.Line&&(n=Common.Utils.Metric.fnRecalcFromMM(e.Line)),this.numLineHeight.setValue(null!==n?n:"",!0),this._state.LineHeight=e.Line),(.001<Math.abs(this._state.LineSpacingBefore-e.Before)||(null===this._state.LineSpacingBefore||null===e.Before)&&this._state.LineSpacingBefore!==e.Before)&&(this.numSpacingBefore.setValue(null!==e.Before?e.Before<0?e.Before:Common.Utils.Metric.fnRecalcFromMM(e.Before):"",!0),this._state.LineSpacingBefore=e.Before),(.001<Math.abs(this._state.LineSpacingAfter-e.After)||(null===this._state.LineSpacingAfter||null===e.After)&&this._state.LineSpacingAfter!==e.After)&&(this.numSpacingAfter.setValue(null!==e.After?e.After<0?e.After:Common.Utils.Metric.fnRecalcFromMM(e.After):"",!0),this._state.LineSpacingAfter=e.After),this._state.AddInterval!==i.ContextualSpacing&&(this.chAddInterval.setValue(null!=i.ContextualSpacing?i.ContextualSpacing:"indeterminate",!0),this._state.AddInterval=i.ContextualSpacing),t.get_Ind()),e=null!==n?n.get_FirstLine():null,i=null!==n?n.get_Left():null,i=(e<0&&null!==i&&(i+=e),(.001<Math.abs(this._state.LeftIndent-i)||(null===this._state.LeftIndent||null===i)&&this._state.LeftIndent!==i)&&(this.numIndentsLeft.setValue(null!==i?Common.Utils.Metric.fnRecalcFromMM(i):"",!0),this._state.LeftIndent=i),(.001<Math.abs(this._state.FirstLine-e)||(null===this._state.FirstLine||null===e)&&this._state.FirstLine!==e)&&(this.numSpecialBy.setValue(null!==e?Math.abs(Common.Utils.Metric.fnRecalcFromMM(e)):"",!0),this._state.FirstLine=e),null!==n?n.get_Right():null),n=((.001<Math.abs(this._state.RightIndent-i)||(null===this._state.RightIndent||null===i)&&this._state.RightIndent!==i)&&(this.numIndentsRight.setValue(null!==i?Common.Utils.Metric.fnRecalcFromMM(i):"",!0),this._state.RightIndent=i),i=0===e?c_paragraphSpecial.NONE_SPECIAL:0<e?c_paragraphSpecial.FIRST_LINE:c_paragraphSpecial.HANGING,this._state.CurSpecial!==i&&(this.cmbSpecial.setValue(i),this._state.CurSpecial=i),t.get_Shade()),i=(null!=n&&n.get_Value()===Asc.c_oAscShdClear&&(e=n.get_Color())?e.get_type()==Asc.c_oAscColor.COLOR_TYPE_SCHEME?this.BackColor={color:Common.Utils.ThemeColor.getHexColor(e.get_r(),e.get_g(),e.get_b()),effectValue:e.get_value()}:this.BackColor=Common.Utils.ThemeColor.getHexColor(e.get_r(),e.get_g(),e.get_b()):this.BackColor="transparent",typeof this.BackColor);if(i!=typeof this._state.BackColor||"object"==i&&(this.BackColor.effectValue!==this._state.BackColor.effectValue||this._state.BackColor.color.indexOf(this.BackColor.color)<0)||"object"!=i&&this._state.BackColor.indexOf(this.BackColor)<0){if(this.btnColor.setColor(this.BackColor),"object"==typeof this.BackColor){for(var o=!1,s=0;s<10;s++)if(Common.Utils.ThemeColor.ThemeValues[s]==this.BackColor.effectValue){this.mnuColorPicker.select(this.BackColor,!0),o=!0;break}o||this.mnuColorPicker.clearSelection()}else this.mnuColorPicker.select(this.BackColor,!0);this._state.BackColor=this.BackColor}}},updateMetricUnit:function(){if(this.spinners)for(var t=0;t<this.spinners.length;t++){var e=this.spinners[t];e.setDefaultUnit(Common.Utils.Metric.getCurrentMetricName()),"paragraphadv-spin-position"==e.el.id||"paragraph-spin-spacing-before"==e.el.id||"paragraph-spin-spacing-after"==e.el.id?e.setStep(Common.Utils.Metric.getCurrentMetric()==Common.Utils.Metric.c_MetricUnits.pt?1:.01):e.setStep(Common.Utils.Metric.getCurrentMetric()==Common.Utils.Metric.c_MetricUnits.pt?1:.1)}this._arrLineRule[2].defaultUnit=this._arrLineRule[0].defaultUnit=Common.Utils.Metric.getCurrentMetricName(),this._arrLineRule[2].minValue=this._arrLineRule[0].minValue=parseFloat(Common.Utils.Metric.fnRecalcFromMM(.3).toFixed(2)),this._arrLineRule[2].step=this._arrLineRule[0].step=Common.Utils.Metric.getCurrentMetric()==Common.Utils.Metric.c_MetricUnits.pt?1:.01,null!==this._state.LineRuleIdx&&(this.numLineHeight.setDefaultUnit(this._arrLineRule[this._state.LineRuleIdx].defaultUnit),this.numLineHeight.setStep(this._arrLineRule[this._state.LineRuleIdx].step),i="",this._state.LineRuleIdx==c_paragraphLinerule.LINERULE_AUTO?i=this._state.LineHeight:null!==this._state.LineHeight&&(i=Common.Utils.Metric.fnRecalcFromMM(this._state.LineHeight)),this.numLineHeight&&this.numLineHeight.setValue(null!==i?i:"",!0));var i=this._state.LineSpacingBefore;this.numSpacingBefore&&this.numSpacingBefore.setValue(null!==i?i<0?i:Common.Utils.Metric.fnRecalcFromMM(i):"",!0),i=this._state.LineSpacingAfter,this.numSpacingAfter&&this.numSpacingAfter.setValue(null!==i?i<0?i:Common.Utils.Metric.fnRecalcFromMM(i):"",!0)},createDelayedElements:function(){this._initSettings=!1,this.UpdateThemeColors(),this.updateMetricUnit()},openAdvancedSettings:function(t){if(!this.linkAdvanced.hasClass("disabled")){var i=this;if(i.api&&!this._locked){var e=i.api.getSelectedElements();if(e&&0<e.length)for(var n,o,s=e.length-1;0<=s;s--)if(n=e[s].get_ObjectType(),o=e[s].get_ObjectValue(),Asc.c_oAscTypeSelectElement.Paragraph==n){new DE.Views.ParagraphSettingsAdvanced({tableStylerRows:2,tableStylerColumns:1,paragraphProps:o,borderProps:i.borderAdvancedProps,isChart:i.isChart,isSmartArtInternal:i.isSmartArtInternal,api:i.api,handler:function(t,e){"ok"==t&&i.api&&(i.borderAdvancedProps=e.borderProps,i.api.paraApply(e.paragraphProps)),i.fireEvent("editcomplete",i)}}).show();break}}}},UpdateThemeColors:function(){this.mnuColorPicker||(this.btnColor.setMenu(),this.mnuColorPicker=this.btnColor.getPicker()),this.mnuColorPicker.updateColors(Common.Utils.ThemeColor.getEffectColors(),Common.Utils.ThemeColor.getStandartColors())},onHideMenus:function(t,e,i){i||this.fireEvent("editcomplete",this)},setLocked:function(t){this._locked=t},disableControls:function(e){this._state.DisabledControls!==e&&(this._state.DisabledControls=e,n.each(this.lockedControls,function(t){t.setDisabled(e)}),this.linkAdvanced.toggleClass("disabled",e))},hideTextOnlySettings:function(t){this._state.HideTextOnlySettings!==t&&(this._state.HideTextOnlySettings=t,this.TextOnlySettings.toggleClass("hidden",1==t))},onEyedropperStart:function(t){this.api.asc_startEyedropper(n.bind(t.eyedropperEnd,t)),this.fireEvent("eyedropper",!0)},onEyedropperEnd:function(){this.fireEvent("eyedropper",!1)}},DE.Views.ParagraphSettings||{}))}),define("text!documenteditor/main/app/template/HeaderFooterSettings.template",[],function(){return'<table cols="1">\n    <tr>\n        <td>\n            <label class="header"><%= scope.textPosition %></label>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <label id="headerfooter-label-position" class="input-label"><%= scope.textHeaderFromTop %></label>\n            <div id="headerfooter-spin-position"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <label class="header"><%= scope.textOptions %></label>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <div id="headerfooter-check-diff-first"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <div id="headerfooter-check-diff-odd"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <div id="headerfooter-check-same-as"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <label class="header"><%= scope.textPageNum %></label>\n        </td>\n    </tr>\n    <tr>\n        <td>\n            <label><%= scope.textTopPage %></label>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <div id="headerfooter-button-top-left"></div>\n            <div id="headerfooter-button-top-center"></div>\n            <div id="headerfooter-button-top-right"></div>\n        </td>\n    </tr>\n    <tr>\n        <td>\n            <label><%= scope.textBottomPage %></label>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <div id="headerfooter-button-bottom-left"></div>\n            <div id="headerfooter-button-bottom-center"></div>\n            <div id="headerfooter-button-bottom-right"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <button type="button" class="btn btn-text-default" id="headerfooter-button-current" style="width:100%;" data-hint="1" data-hint-direction="bottom" data-hint-offset="big"><%= scope.textInsertCurrent %></button>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <label class="header"><%= scope.textPageNumbering %></label>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <div id="headerfooter-radio-prev"></div>\n            <div id="headerfooter-radio-from"></div>\n            <div id="headerfooter-spin-from"></div>\n        </td>\n    </tr>\n    <tr class="finish-cell"></tr>\n</table>'}),define("documenteditor/main/app/view/HeaderFooterSettings",["text!documenteditor/main/app/template/HeaderFooterSettings.template","jquery","underscore","backbone","common/main/lib/component/Button","common/main/lib/component/MetricSpinner","common/main/lib/component/CheckBox","common/main/lib/component/RadioBox"],function(t,n,o,e){"use strict";DE.Views.HeaderFooterSettings=e.View.extend(o.extend({el:"#id-header-settings",template:o.template(t),events:{},options:{alias:"HeaderFooterSettings"},initialize:function(){this._initSettings=!0,this._state={PositionType:c_pageNumPosition.PAGE_NUM_POSITION_TOP,Position:12.5,DiffFirst:!1,DiffOdd:!1,SameAs:!1,DisabledControls:!1,Numbering:void 0},this.spinners=[],this.lockedControls=[],this._locked=!1,this.render()},render:function(){(this.$el||n(this.el)).html(this.template({scope:this}))},setApi:function(t){return this.api=t,this},ChangeSettings:function(t){var e;this._initSettings&&this.createDelayedElements(),this.disableControls(this._locked),t&&(e=t.get_Type(),this._state.PositionType!==e&&(e==c_pageNumPosition.PAGE_NUM_POSITION_BOTTOM?this.lblPosition[0].innerHTML=this.textHeaderFromBottom:this.lblPosition[0].innerHTML=this.textHeaderFromTop,this._state.PositionType=e),e=t.get_Position(),.001<Math.abs(this._state.Position-e)&&(this.numPosition.setValue(Common.Utils.Metric.fnRecalcFromMM(e),!0),this._state.Position=e),e=t.get_DifferentFirst(),this._state.DiffFirst!==e&&(this.chDiffFirst.setValue(e,!0),this._state.DiffFirst=e),e=t.get_DifferentEvenOdd(),this._state.DiffOdd!==e&&(this.chDiffOdd.setValue(e,!0),this._state.DiffOdd=e),e=t.get_LinkToPrevious(),this._state.SameAs!==e&&(this.chSameAs.setDisabled(null===e||this._locked),this.chSameAs.setValue(1==e,!0),this._state.SameAs=e),e=t.get_StartPageNumber(),this._state.Numbering!==e&&null!==e&&(e<0?this.radioPrev.setValue(!0,!0):(this.radioFrom.setValue(!0,!0),this.numFrom.setValue(e,!0)),this._state.Numbering=e))},onBtnPositionClick:function(t,e){this.api&&this.api.put_PageNum(t.options.posWhere,t.options.posAlign),this.fireEvent("editcomplete",this)},onNumPositionChange:function(t,e,i,n){this.api&&this.api.put_HeadersAndFootersDistance(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue()))},onDiffFirstChange:function(t,e,i,n){this.api&&this.api.HeadersAndFooters_DifferentFirstPage("checked"==t.getValue()),this.fireEvent("editcomplete",this)},onDiffOddChange:function(t,e,i,n){this.api&&this.api.HeadersAndFooters_DifferentOddandEvenPage("checked"==t.getValue()),this.fireEvent("editcomplete",this)},onSameAsChange:function(t,e,i,n){this.api&&this.api.HeadersAndFooters_LinkToPrevious("checked"==t.getValue()),this.fireEvent("editcomplete",this)},onInsertCurrentClick:function(){this.api&&this.api.put_PageNum(-1),this.fireEvent("editcomplete",this)},onRadioPrev:function(t,e,i){e&&this.api&&this.api.asc_SetSectionStartPage(-1),this.fireEvent("editcomplete",this)},onRadioFrom:function(t,e,i){e&&this.api&&(o.isEmpty(this.numFrom.getValue())&&this.numFrom.setValue(1,!0),this.api.asc_SetSectionStartPage(this.numFrom.getNumberValue())),this.fireEvent("editcomplete",this)},onNumFromChange:function(t,e,i,n){this.api&&(this.radioFrom.setValue(!0,!0),this.api.asc_SetSectionStartPage(t.getNumberValue()))},updateMetricUnit:function(){if(this.spinners){for(var t=0;t<this.spinners.length;t++){var e=this.spinners[t];e.setDefaultUnit(Common.Utils.Metric.getCurrentMetricName()),e.setStep(Common.Utils.Metric.getCurrentMetric()==Common.Utils.Metric.c_MetricUnits.pt?1:.01)}this.numPosition&&this.numPosition.setValue(Common.Utils.Metric.fnRecalcFromMM(this._state.Position),!0)}},createDelayedControls:function(){var t=this,e=[[c_pageNumPosition.PAGE_NUM_POSITION_TOP,c_pageNumPosition.PAGE_NUM_POSITION_LEFT,"btn-page-number-top-left","headerfooter-button-top-left",this.textTopLeft],[c_pageNumPosition.PAGE_NUM_POSITION_TOP,c_pageNumPosition.PAGE_NUM_POSITION_CENTER,"btn-page-number-top-center","headerfooter-button-top-center",this.textTopCenter],[c_pageNumPosition.PAGE_NUM_POSITION_TOP,c_pageNumPosition.PAGE_NUM_POSITION_RIGHT,"btn-page-number-top-right","headerfooter-button-top-right",this.textTopRight],[c_pageNumPosition.PAGE_NUM_POSITION_BOTTOM,c_pageNumPosition.PAGE_NUM_POSITION_LEFT,"btn-page-number-bottom-left","headerfooter-button-bottom-left",this.textBottomLeft],[c_pageNumPosition.PAGE_NUM_POSITION_BOTTOM,c_pageNumPosition.PAGE_NUM_POSITION_CENTER,"btn-page-number-bottom-center","headerfooter-button-bottom-center",this.textBottomCenter],[c_pageNumPosition.PAGE_NUM_POSITION_BOTTOM,c_pageNumPosition.PAGE_NUM_POSITION_RIGHT,"btn-page-number-bottom-right","headerfooter-button-bottom-right",this.textBottomRight]];this._btnsPosition=[],o.each(e,function(t,e,i){t=new Common.UI.Button({parentEl:n("#"+t[3]),cls:"btn-options huge-1 bg-white",iconCls:"options__icon options__icon-huge "+t[2],posWhere:t[0],posAlign:t[1],hint:t[4],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"});t.on("click",o.bind(this.onBtnPositionClick,this)),this._btnsPosition.push(t),this.lockedControls.push(t)},this),this.numPosition=new Common.UI.MetricSpinner({el:n("#headerfooter-spin-position"),step:.1,width:85,value:"1.25 cm",defaultUnit:"cm",maxValue:55.88,minValue:0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.spinners.push(this.numPosition),this.lockedControls.push(this.numPosition),this.lblPosition=n(this.el).find("#headerfooter-label-position"),this.chDiffFirst=new Common.UI.CheckBox({el:n("#headerfooter-check-diff-first"),labelText:this.textDiffFirst,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.lockedControls.push(this.chDiffFirst),this.chDiffOdd=new Common.UI.CheckBox({el:n("#headerfooter-check-diff-odd"),labelText:this.textDiffOdd,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.lockedControls.push(this.chDiffOdd),this.chSameAs=new Common.UI.CheckBox({el:n("#headerfooter-check-same-as"),labelText:this.textSameAs,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.numPosition.on("change",o.bind(this.onNumPositionChange,this)),this.numPosition.on("inputleave",function(){t.fireEvent("editcomplete",t)}),this.chDiffFirst.on("change",o.bind(this.onDiffFirstChange,this)),this.chDiffOdd.on("change",o.bind(this.onDiffOddChange,this)),this.chSameAs.on("change",o.bind(this.onSameAsChange,this)),this.btnInsertCurrent=new Common.UI.Button({el:n("#headerfooter-button-current")}),this.lockedControls.push(this.btnInsertCurrent),this.btnInsertCurrent.on("click",o.bind(this.onInsertCurrentClick,this)),this.radioPrev=new Common.UI.RadioBox({el:n("#headerfooter-radio-prev"),labelText:this.textPrev,name:"asc-radio-header-numbering",checked:!0,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}).on("change",o.bind(this.onRadioPrev,this)),this.lockedControls.push(this.radioPrev),this.radioFrom=new Common.UI.RadioBox({el:n("#headerfooter-radio-from"),labelText:this.textFrom,name:"asc-radio-header-numbering",dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}).on("change",o.bind(this.onRadioFrom,this)),this.lockedControls.push(this.radioFrom),this.numFrom=new Common.UI.MetricSpinner({el:n("#headerfooter-spin-from"),step:1,width:85,value:"1",defaultUnit:"",maxValue:2147483646,minValue:0,allowDecimal:!1,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.lockedControls.push(this.numFrom),this.numFrom.on("change",o.bind(this.onNumFromChange,this)),this.numFrom.on("inputleave",function(){t.fireEvent("editcomplete",t)})},createDelayedElements:function(){this.createDelayedControls(),this.updateMetricUnit(),this._initSettings=!1},setLocked:function(t){this._locked=t},disableControls:function(e){this._initSettings||this._state.DisabledControls!==e&&(this._state.DisabledControls=e,o.each(this.lockedControls,function(t){t.setDisabled(e)}),this.chSameAs.setDisabled(e||null===this._state.SameAs))}},DE.Views.HeaderFooterSettings||{}))}),define("text!documenteditor/main/app/template/ImageSettings.template",[],function(){return'<table cols="2">\n    <tr>\n        <td colspan=2>\n            <label class="header"><%= scope.textSize %></label>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" width="50%">\n            <label id="image-label-width" class="input-label"><%= scope.textWidth %></label>\n        </td>\n        <td class="padding-small" width="50%">\n            <label id="image-label-height" class="input-label"><%= scope.textHeight %></label>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" colspan=2>\n            <button type="button" class="btn btn-text-default" id="image-button-original-size" style="min-width:100px;width: auto;" data-hint="1" data-hint-direction="bottom" data-hint-offset="big"><%= scope.textOriginalSize %></button>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" colspan=2>\n            <button type="button" class="btn btn-text-default" id="image-button-fit-margins" style="min-width:100px;width: auto;" data-hint="1" data-hint-direction="bottom" data-hint-offset="big"><%= scope.textFitMargins %></button>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" colspan=2>\n            <div id="image-button-crop" style="min-width: 100px;"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" colspan=2>\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr>\n        <td colspan=2 class="padding-small">\n            <label class="header"><%= scope.textRotation %></label>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" width="50%">\n            <label class="input-label"><%= scope.textRotate90 %></label>\n            <div>\n                <div id="image-button-270" class="margin-right-4"></div>\n                <div id="image-button-90"></div>\n            </div>\n        </td>\n        <td class="padding-small" width="50%">\n            <label class="input-label"><%= scope.textFlip %></label>\n            <div>\n                <div id="image-button-fliph" class="margin-right-4"></div>\n                <div id="image-button-flipv"></div>\n            </div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" colspan=2>\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr>\n        <td colspan=2 class="padding-small">\n            <label class="header"><%= scope.textWrap %></label>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" colspan=2>\n            <div id="image-combo-wrap" style="width: 100%;"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" colspan=2>\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr>\n        <td colspan=2>\n            <div id="image-button-replace" style="width:100%;"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" colspan=2>\n            <button type="button" class="btn btn-text-default hidden" id="image-button-edit-object" style="width:100%;"><%= scope.textEditObject %></button>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" colspan=2>\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr>\n        <td align="center" colspan=2>\n            <label class="link" id="image-advanced-link" data-hint="1" data-hint-direction="bottom" data-hint-offset="medium"><%= scope.textAdvanced %></label>\n        </td>\n    </tr>\n    <tr class="finish-cell"></tr>\n</table>'}),define("text!documenteditor/main/app/template/ImageSettingsAdvanced.template",[],function(){return'<div id="id-adv-image-width" class="settings-panel active">\n    <div class="inner-content">\n    <table cols="4" width="100%">\n        <tr>\n            <td width="78px">\n                <label class="input-label"><%= scope.textWidth %></label>\n                <div id="image-advanced-spin-width"></div>\n            </td>\n            <td width="28px" style="vertical-align: bottom;">\n                <div id="image-advanced-button-ratio"></div>\n            </td>\n            <td width="78px">\n                <label class="input-label"><%= scope.textHeight %></label>\n                <div id="image-advanced-spin-height"></div>\n            </td>\n            <td style="vertical-align: bottom;">\n                <button type="button" class="btn btn-text-default auto" id="image-advanced-button-original-size" style="min-width:100px;"><%= scope.textOriginalSize %></button>\n            </td>\n        </tr>\n    </table>\n    </div>\n</div>\n<div id="id-adv-shape-size" class="settings-panel active">\n    <div class="inner-content">\n    <table cols="3">\n        <tr>\n            <td colspan="3">\n                <label class="header"><%= scope.textWidth %></label>\n            </td>\n        </tr>\n        <tr>\n            <td style="vertical-align: bottom; padding-bottom: 12px;">\n                <div id="shape-radio-hsize"></div>\n            </td>\n            <td class="padding-small">\n                <label class="input-label"><%= scope.textAbsoluteWH %></label>\n                <div id="shape-advanced-spin-width"></div>\n            </td>\n        </tr>\n        <tr>\n            <td style="vertical-align: bottom; padding-bottom: 19px;">\n                <div id="shape-radio-hsizepc"></div>\n            </td>\n            <td class="padding-large padding-right-15">\n                <label class="input-label"><%= scope.textRelativeWH %></label>\n                <div id="shape-advanced-spin-width-rel"></div>\n            </td>\n            <td class="padding-large">\n                <label class="input-label"><%= scope.textRelative %></label>\n                <div id="shape-combo-width-rel" style="width: 115px;"></div>\n            </td>\n        </tr>\n        <tr>\n            <td colspan="3">\n                <label class="header"><%= scope.textHeight %></label>\n            </td>\n        </tr>\n        <tr>\n            <td style="vertical-align: bottom; padding-bottom: 12px;">\n                <div id="shape-radio-vsize"></div>\n            </td>\n            <td class="padding-small">\n                <label class="input-label"><%= scope.textAbsoluteWH %></label>\n                <div id="shape-advanced-spin-height"></div>\n            </td>\n        </tr>\n        <tr>\n            <td style="vertical-align: bottom; padding-bottom: 19px;">\n                <div id="shape-radio-vsizepc"></div>\n            </td>\n            <td class="padding-large padding-right-15">\n                <label class="input-label"><%= scope.textRelativeWH %></label>\n                <div id="shape-advanced-spin-height-rel"></div>\n            </td>\n            <td class="padding-large">\n                <label class="input-label"><%= scope.textRelative %></label>\n                <div id="shape-combo-height-rel" style="width: 115px;"></div>\n            </td>\n        </tr>\n    </table>\n    </div>\n    <div class="separator horizontal padding-large"></div>\n    <div class="inner-content">\n        <table cols="1" style="width: 100%;">\n            <tr>\n                <td>\n                    <div id="shape-checkbox-ratio"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-adv-image-rotate" class="settings-panel active">\n    <div class="inner-content  padding-large">\n        <div style="width: 100%;">\n            <label class="input-label"><%= scope.textAngle %></label>\n            <div id="image-advanced-spin-angle" class="margin-left-5" style="display: inline-block;"></div>\n        </div>\n    </div>\n    <div class="separator horizontal padding-large"></div>\n    <div class="inner-content  padding-large">\n        <table cols="2">\n            <tr>\n                <td rowspan="2" class="padding-small" style="vertical-align: top;">\n                    <label class="input-label margin-right-15" style="vertical-align: top;"><%= scope.textFlipped %></label>\n                </td>\n                <td class="padding-small">\n                    <div id="image-advanced-checkbox-hor"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="image-advanced-checkbox-vert"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-adv-image-wrap" class="settings-panel">\n    <div class="inner-content padding-large">\n        <label class="header padding-small"><%= scope.textWrap %></label>\n        <div class="padding-small">\n            <div id="image-advanced-button-wrap-inline" class="margin-right-7" style="display: inline-block;"></div>\n            <div id="image-advanced-button-wrap-square" class="margin-right-7" style="display: inline-block;"></div>\n            <div id="image-advanced-button-wrap-tight" class="margin-right-7" style="display: inline-block;"></div>\n            <div id="image-advanced-button-wrap-through" class="margin-right-7" style="display: inline-block;"></div>\n        </div>\n        <div class="padding-small">\n            <div id="image-advanced-button-wrap-topbottom" class="margin-right-7" style="display: inline-block;"></div>\n            <div id="image-advanced-button-wrap-infront" class="margin-right-7" style="display: inline-block;"></div>\n            <div id="image-advanced-button-wrap-behind" style="display: inline-block;"></div>\n        </div>\n    </div>\n    <div class="separator horizontal padding-large"></div>\n    <div class="inner-content">\n        <table cols="2" style="width: 100%;">\n            <tr>\n                <td colspan=2 class="padding-small">\n                    <label class="header"><%= scope.textDistance %></label>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small" width="125px">\n                    <label class="input-label"><%= scope.textTop %></label>\n                    <div id="image-advanced-distance-top"></div>\n                </td>\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textLeft %></label>\n                    <div id="image-advanced-distance-left"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textBottom %></label>\n                    <div id="image-advanced-distance-bottom"></div>\n                </td>\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textRight %></label>\n                    <div id="image-advanced-distance-right"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-adv-image-position" class="settings-panel">\n    <div class="inner-content">\n        <table cols="3" style="width: 100%;">\n            <tr>\n                <td colspan="3">\n                    <label class="header"><%= scope.textHorizontal %></label>\n                </td>\n            </tr>\n            <tr>\n                <td style="vertical-align: bottom; padding-bottom: 12px;">\n                    <div id="image-radio-halign"></div>\n                </td>\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textAlignment %></label>\n                    <div id="image-combo-halign" style="width: 115px;"></div>\n                </td>\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textRelative %></label>\n                    <div id="image-combo-hrelative" style="width: 115px;"></div>\n                </td>\n            </tr>\n            <tr>\n                <td style="vertical-align: bottom; padding-bottom: 12px;">\n                    <div id="image-radio-hposition"></div>\n                </td>\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textPositionAbs %></label>\n                    <div id="image-spin-x"></div>\n                </td>\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textRightOf %></label>\n                    <div id="image-combo-hposition" style="width: 115px;"></div>\n                </td>\n            </tr>\n            <tr>\n                <td style="vertical-align: bottom; padding-bottom: 19px;">\n                    <div id="image-radio-hpositionpc"></div>\n                </td>\n                <td class="padding-large">\n                    <label class="input-label"><%= scope.textPositionPc %></label>\n                    <div id="image-spin-xpc"></div>\n                </td>\n                <td class="padding-large">\n                    <label class="input-label"><%= scope.textRelative %></label>\n                    <div id="image-combo-hpositionpc" style="width: 115px;"></div>\n                </td>\n            </tr>\n            <tr>\n                <td colspan="3">\n                    <label class="header"><%= scope.textVertical %></label>\n                </td>\n            </tr>\n            <tr>\n                <td style="vertical-align: bottom; padding-bottom: 12px;">\n                    <div id="image-radio-valign"></div>\n                </td>\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textAlignment %></label>\n                    <div id="image-combo-valign" style="width: 115px;"></div>\n                </td>\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textRelative %></label>\n                    <div id="image-combo-vrelative" style="width: 115px;"></div>\n                </td>\n            </tr>\n            <tr>\n                <td style="vertical-align: bottom; padding-bottom: 12px;">\n                    <div id="image-radio-vposition"></div>\n                </td>\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textPositionAbs %></label>\n                    <div id="image-spin-y"></div>\n                </td>\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textBelow %></label>\n                    <div id="image-combo-vposition" style="width: 115px;"></div>\n                </td>\n            </tr>\n            <tr>\n                <td style="vertical-align: bottom; padding-bottom: 19px;">\n                    <div id="image-radio-vpositionpc"></div>\n                </td>\n                <td class="padding-large">\n                    <label class="input-label"><%= scope.textPositionPc %></label>\n                    <div id="image-spin-ypc"></div>\n                </td>\n                <td class="padding-large">\n                    <label class="input-label"><%= scope.textRelative %></label>\n                    <div id="image-combo-vpositionpc" style="width: 115px;"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n    <div class="separator horizontal padding-small"></div>\n    <div class="inner-content">\n        <table cols="2" style="width: 100%;">\n            <tr>\n                <td colspan="2">\n                    <label class="header"><%= scope.textOptions %></label>\n                </td>\n            </tr>\n            <tr>\n                <td>\n                    <div id="image-checkbox-move"></div>\n                </td>\n                <td>\n                    <div id="image-checkbox-overlap"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-adv-image-shape" class="settings-panel">\n    <div class="inner-content">\n        <table cols="2" style="width: 100%;">\n            <tr>\n                <td colspan=2 class="padding-small">\n                    <label class="header"><%= scope.textLineStyle %></label>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-large" width="125px">\n                    <label class="input-label"><%= scope.textCapType %></label>\n                    <div id="shape-advanced-cap-type" style="width: 100px;"></div>\n                </td>\n                <td class="padding-large">\n                    <label class="input-label"><%= scope.textJoinType %></label>\n                    <div id="shape-advanced-join-type" style="width: 100px;"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n    <div class="separator horizontal padding-large"></div>\n    <div class="inner-content">\n        <table cols="2" style="width: 100%;">\n            <tr>\n                <td colspan=2 class="padding-small">\n                    <label class="header"><%= scope.textArrows %></label>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small" width="125px">\n                    <label class="input-label"><%= scope.textBeginStyle %></label>\n                    <div id="shape-advanced-begin-style" style="width: 100px;"></div>\n                </td>\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textEndStyle %></label>\n                    <div id="shape-advanced-end-style" style="width: 100px;"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textBeginSize %></label>\n                    <div id="shape-advanced-begin-size" style="width: 100px;"></div>\n                </td>\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textEndSize %></label>\n                    <div id="shape-advanced-end-size" style="width: 100px;"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-adv-image-margins" class="settings-panel">\n    <div class="inner-content">\n        <table cols="1" style="width: 100%;">\n            <tr>\n                <td class="padding-small">\n                    <label class="header"><%= scope.textAutofit %></label>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-large">\n                    <div id="shape-checkbox-autofit"></div>\n                </td>\n            </tr>\n        </table>\n        <div class="separator horizontal padding-large"></div>\n        <table cols="2" style="width: 100%;">\n            <tr>\n                <td colspan=2 class="padding-small">\n                    <label class="header"><%= scope.strMargins %></label>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small" width="125px">\n                    <label class="input-label"><%= scope.textTop %></label>\n                    <div id="image-margin-top"></div>\n                </td>\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textLeft %></label>\n                    <div id="image-margin-left"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textBottom %></label>\n                    <div id="image-margin-bottom"></div>\n                </td>\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textRight %></label>\n                    <div id="image-margin-right"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-adv-image-alttext" class="settings-panel">\n    <div class="inner-content">\n        <table cols="1" width="100%">\n            <tr>\n                <td class="padding-large">\n                    <label class="header"><%= scope.textAltTitle %></label>\n                    <div id="image-advanced-alt-title"></div>\n                </td>\n            </tr>\n            <tr>\n                <td>\n                    <label class="header"><%= scope.textAltDescription %></label>\n                    <textarea id="image-advanced-alt-description" class="form-control" style="width: 100%; height: 120px;"></textarea>\n                </td>\n            </tr>\n            <tr>\n                <td>\n                    <label><%= scope.textAltTip %></label>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>'}),define("documenteditor/main/app/view/ImageSettingsAdvanced",["text!documenteditor/main/app/template/ImageSettingsAdvanced.template","common/main/lib/view/AdvancedSettingsWindow","common/main/lib/component/ComboBox","common/main/lib/component/MetricSpinner","common/main/lib/component/CheckBox","common/main/lib/component/RadioBox"],function(e){"use strict";DE.Views.ImageSettingsAdvanced=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:340,height:485,toggleGroup:"image-adv-settings-group",sizeOriginal:{width:0,height:0},sizeMax:{width:55.88,height:55.88},properties:null,storageName:"de-img-settings-adv-category"},initialize:function(t){_.extend(this.options,{title:this.textTitle,items:[{panelId:"id-adv-image-width",panelCaption:this.textSize},{panelId:"id-adv-shape-size",panelCaption:this.textSize},{panelId:"id-adv-image-rotate",panelCaption:this.textRotation},{panelId:"id-adv-image-wrap",panelCaption:this.textBtnWrap},{panelId:"id-adv-image-position",panelCaption:this.textPosition},{panelId:"id-adv-image-shape",panelCaption:this.textWeightArrows},{panelId:"id-adv-image-margins",panelCaption:this.textTextBox},{panelId:"id-adv-image-alttext",panelCaption:this.textAlt}],contentTemplate:_.template(e)({scope:this})},t),Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options),this.spinners=[],this._state={HAlignType:Asc.c_oAscAlignH.Left,HAlignFrom:Asc.c_oAscRelativeFromH.Character,HPositionFrom:Asc.c_oAscRelativeFromH.Character,HPositionPcFrom:Asc.c_oAscRelativeFromH.Page,ShapeWidthPcFrom:Asc.c_oAscRelativeFromH.Margin,VAlignType:Asc.c_oAscAlignV.Top,VAlignFrom:Asc.c_oAscRelativeFromV.Paragraph,VPositionFrom:Asc.c_oAscRelativeFromV.Paragraph,VPositionPcFrom:Asc.c_oAscRelativeFromV.Page,ShapeHeightPcFrom:Asc.c_oAscRelativeFromV.Margin,spnXChanged:!1,spnYChanged:!1,spnXPcChanged:!1,spnYPcChanged:!1},this._objectType=Asc.c_oAscTypeSelectElement.Image,this.Margins=void 0,this._nRatio=1,this._originalProps=this.options.imageProps,this.sectionProps=this.options.sectionProps,this.pageWidth=this.options.sectionProps?this.options.sectionProps.get_W():210,this.pageHeight=this.options.sectionProps?this.options.sectionProps.get_H():297,this.api=this.options.api,this._changedProps=null,this._changedShapeProps=null,this._isSmartArt=!1},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var e=this,t=(this.spnWidth=new Common.UI.MetricSpinner({el:$("#image-advanced-spin-width"),step:.1,width:70,defaultUnit:"cm",value:"3 cm",maxValue:55.88,minValue:0}),this.spnWidth.on("change",_.bind(function(t,e,i,n){var o,s;this.btnRatio.pressed&&((s=t.getNumberValue()/this._nRatio)>this.sizeMax.height&&(o=(s=this.sizeMax.height)*this._nRatio,this.spnWidth.setValue(o,!0)),this.spnHeight.setValue(s,!0)),this._changedProps&&(this._changedProps.put_Width(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())),this._changedProps.put_Height(Common.Utils.Metric.fnRecalcToMM(this.spnHeight.getNumberValue())),this._changedProps.put_ResetCrop(!1))},this)),this.spinners.push(this.spnWidth),this.spnHeight=new Common.UI.MetricSpinner({el:$("#image-advanced-spin-height"),step:.1,width:70,defaultUnit:"cm",value:"3 cm",maxValue:55.88,minValue:0}),this.spnHeight.on("change",_.bind(function(t,e,i,n){var o=t.getNumberValue(),s=null;this.btnRatio.pressed&&((s=o*this._nRatio)>this.sizeMax.width&&(o=(s=this.sizeMax.width)/this._nRatio,this.spnHeight.setValue(o,!0)),this.spnWidth.setValue(s,!0)),this._changedProps&&(this._changedProps.put_Height(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())),this._changedProps.put_Width(Common.Utils.Metric.fnRecalcToMM(this.spnWidth.getNumberValue())),this._changedProps.put_ResetCrop(!1))},this)),this.spinners.push(this.spnHeight),this.btnOriginalSize=new Common.UI.Button({el:$("#image-advanced-button-original-size")}),this.btnOriginalSize.on("click",_.bind(function(t,e){this.spnAngle.setValue(0),this.spnWidth.setValue(this.sizeOriginal.width,!0),this.spnHeight.setValue(this.sizeOriginal.height,!0),this._nRatio=this.sizeOriginal.width/this.sizeOriginal.height,this._changedProps&&(this._changedProps.put_Height(Common.Utils.Metric.fnRecalcToMM(this.spnHeight.getNumberValue())),this._changedProps.put_Width(Common.Utils.Metric.fnRecalcToMM(this.spnWidth.getNumberValue())),this._changedProps.put_ResetCrop(!0),this._changedProps.put_Rot(0))},this)),this.btnRatio=new Common.UI.Button({parentEl:$("#image-advanced-button-ratio"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-advanced-ratio",style:"margin-bottom: 1px;",enableToggle:!0,hint:this.textKeepRatio}),this.btnRatio.on("click",_.bind(function(t,e){t.pressed&&0<this.spnHeight.getNumberValue()&&(this._nRatio=this.spnWidth.getNumberValue()/this.spnHeight.getNumberValue()),this._changedProps&&this._changedProps.asc_putLockAspect(t.pressed)},this)),this.radioHSize=new Common.UI.RadioBox({el:$("#shape-radio-hsize"),name:"asc-radio-width",checked:!0}),this.radioHSize.on("change",_.bind(this.onRadioHSizeChange,this)),this.radioHSizePc=new Common.UI.RadioBox({el:$("#shape-radio-hsizepc"),name:"asc-radio-width"}),this.radioHSizePc.on("change",_.bind(this.onRadioHSizePcChange,this)),this.radioVSize=new Common.UI.RadioBox({el:$("#shape-radio-vsize"),name:"asc-radio-height",checked:!0}),this.radioVSize.on("change",_.bind(this.onRadioVSizeChange,this)),this.radioVSizePc=new Common.UI.RadioBox({el:$("#shape-radio-vsizepc"),name:"asc-radio-height"}),this.radioVSizePc.on("change",_.bind(this.onRadioVSizePcChange,this)),this.chRatio=new Common.UI.CheckBox({el:$("#shape-checkbox-ratio"),labelText:this.textAspectRatio}),this.chRatio.on("change",_.bind(function(t,e,i,n){"checked"==t.getValue()&&0<this.spnShapeHeight.getNumberValue()&&(this._nRatio=this.spnShapeWidth.getNumberValue()/this.spnShapeHeight.getNumberValue()),this._changedProps&&this._changedProps.asc_putLockAspect("checked"==t.getValue())},this)),this.spnShapeWidth=new Common.UI.MetricSpinner({el:$("#shape-advanced-spin-width"),step:.1,width:80,defaultUnit:"cm",value:"3 cm",maxValue:55.88,minValue:0}),this.spnShapeWidth.on("change",_.bind(function(t,e,i,n){var o,s;"checked"!=this.chRatio.getValue()||this.chRatio.isDisabled()&&!this._isSmartArt||((s=t.getNumberValue()/this._nRatio)>this.sizeMax.height&&(o=(s=this.sizeMax.height)*this._nRatio,this.spnShapeWidth.setValue(o,!0)),this.spnShapeHeight.setValue(s,!0)),this._changedProps&&(this._changedProps.put_Width(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())),this.fillShapeHeight())},this)),this.spinners.push(this.spnShapeWidth),this.spnShapeHeight=new Common.UI.MetricSpinner({el:$("#shape-advanced-spin-height"),step:.1,width:80,defaultUnit:"cm",value:"3 cm",maxValue:55.88,minValue:0}),this.spnShapeHeight.on("change",_.bind(function(t,e,i,n){var o=t.getNumberValue(),s=null;"checked"!=this.chRatio.getValue()||this.chRatio.isDisabled()&&!this._isSmartArt||((s=o*this._nRatio)>this.sizeMax.width&&(o=(s=this.sizeMax.width)/this._nRatio,this.spnShapeHeight.setValue(o,!0)),this.spnShapeWidth.setValue(s,!0)),this._changedProps&&(this._changedProps.put_Height(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())),this.fillShapeWidth())},this)),this.spinners.push(this.spnShapeHeight),this.spnShapeWidthPc=new Common.UI.MetricSpinner({el:$("#shape-advanced-spin-width-rel"),disabled:!0,step:1,width:80,defaultUnit:"%",value:"1 %",maxValue:1e3,minValue:1}),this.spnShapeWidthPc.on("change",_.bind(function(t,e,i,n){this._changedProps&&(null!==this._changedProps.get_SizeRelH()&&void 0!==this._changedProps.get_SizeRelH()||this._changedProps.put_SizeRelH(new Asc.CImagePositionH),this._changedProps.get_SizeRelH().put_Value(t.getNumberValue()),this._changedProps.get_SizeRelH().put_RelativeFrom(this._state.ShapeWidthPcFrom),this.fillShapeHeight())},this)),this.spnShapeHeightPc=new Common.UI.MetricSpinner({el:$("#shape-advanced-spin-height-rel"),disabled:!0,step:1,width:80,defaultUnit:"%",value:"1 %",maxValue:1e3,minValue:1}),this.spnShapeHeightPc.on("change",_.bind(function(t,e,i,n){this._changedProps&&(null!==this._changedProps.get_SizeRelV()&&void 0!==this._changedProps.get_SizeRelV()||this._changedProps.put_SizeRelV(new Asc.CImagePositionV),this._changedProps.get_SizeRelV().put_Value(t.getNumberValue()),this._changedProps.get_SizeRelV().put_RelativeFrom(this._state.ShapeHeightPcFrom),this.fillShapeWidth())},this)),this._arrHRelativePc=[{displayValue:this.textMargin,value:Asc.c_oAscRelativeFromH.Margin,size:this.sectionProps.get_W()-this.sectionProps.get_LeftMargin()-this.sectionProps.get_RightMargin()},{displayValue:this.textPage,value:Asc.c_oAscRelativeFromH.Page,size:this.sectionProps.get_W()},{displayValue:this.textLeftMargin,value:Asc.c_oAscRelativeFromH.LeftMargin,size:this.sectionProps.get_LeftMargin()},{displayValue:this.textRightMargin,value:Asc.c_oAscRelativeFromH.RightMargin,size:this.sectionProps.get_RightMargin()}],this.cmbWidthPc=new Common.UI.ComboBox({el:$("#shape-combo-width-rel"),cls:"input-group-nr",menuStyle:"min-width: 115px;",editable:!1,data:this._arrHRelativePc,takeFocusOnClose:!0}),this.cmbWidthPc.setDisabled(!0),this.cmbWidthPc.setValue(this._state.ShapeWidthPcFrom),this.cmbWidthPc.on("selected",_.bind(this.onCmbWidthPcSelect,this)),this._arrVRelativePc=[{displayValue:this.textMargin,value:Asc.c_oAscRelativeFromV.Margin,size:this.sectionProps.get_H()-this.sectionProps.get_TopMargin()-this.sectionProps.get_BottomMargin()},{displayValue:this.textPage,value:Asc.c_oAscRelativeFromV.Page,size:this.sectionProps.get_H()},{displayValue:this.textTopMargin,value:Asc.c_oAscRelativeFromV.TopMargin,size:this.sectionProps.get_TopMargin()},{displayValue:this.textBottomMargin,value:Asc.c_oAscRelativeFromV.BottomMargin,size:this.sectionProps.get_BottomMargin()}],this.cmbHeightPc=new Common.UI.ComboBox({el:$("#shape-combo-height-rel"),cls:"input-group-nr",menuStyle:"min-width: 115px;",editable:!1,data:this._arrVRelativePc,takeFocusOnClose:!0}),this.cmbHeightPc.setDisabled(!0),this.cmbHeightPc.setValue(this._state.ShapeHeightPcFrom),this.cmbHeightPc.on("selected",_.bind(this.onCmbHeightPcSelect,this)),this.spnAngle=new Common.UI.MetricSpinner({el:$("#image-advanced-spin-angle"),step:1,width:80,defaultUnit:"°",value:"0 °",maxValue:3600,minValue:-3600}),this.chFlipHor=new Common.UI.CheckBox({el:$("#image-advanced-checkbox-hor"),labelText:this.textHorizontally}),this.chFlipVert=new Common.UI.CheckBox({el:$("#image-advanced-checkbox-vert"),labelText:this.textVertically}),this.btnWrapInline=new Common.UI.Button({parentEl:$("#image-advanced-button-wrap-inline"),cls:"btn-options huge-1",iconCls:"icon-advanced-wrap options__icon options__icon-huge btn-wrap-inline",posId:Asc.c_oAscWrapStyle2.Inline,hint:this.textWrapInlineTooltip,enableToggle:!0,allowDepress:!1,toggleGroup:"imgAdvWrapGroup"}),this.btnWrapInline.on("click",_.bind(this.onBtnWrapClick,this)),this.btnWrapSquare=new Common.UI.Button({parentEl:$("#image-advanced-button-wrap-square"),cls:"btn-options huge-1",iconCls:"icon-advanced-wrap options__icon options__icon-huge btn-wrap-square",posId:Asc.c_oAscWrapStyle2.Square,hint:this.textWrapSquareTooltip,enableToggle:!0,allowDepress:!1,toggleGroup:"imgAdvWrapGroup"}),this.btnWrapSquare.on("click",_.bind(this.onBtnWrapClick,this)),this.btnWrapTight=new Common.UI.Button({parentEl:$("#image-advanced-button-wrap-tight"),cls:"btn-options huge-1",iconCls:"icon-advanced-wrap options__icon options__icon-huge btn-wrap-tight",posId:Asc.c_oAscWrapStyle2.Tight,hint:this.textWrapTightTooltip,enableToggle:!0,allowDepress:!1,toggleGroup:"imgAdvWrapGroup"}),this.btnWrapTight.on("click",_.bind(this.onBtnWrapClick,this)),this.btnWrapThrough=new Common.UI.Button({parentEl:$("#image-advanced-button-wrap-through"),cls:"btn-options huge-1",iconCls:"icon-advanced-wrap options__icon options__icon-huge btn-wrap-through",posId:Asc.c_oAscWrapStyle2.Through,hint:this.textWrapThroughTooltip,enableToggle:!0,allowDepress:!1,toggleGroup:"imgAdvWrapGroup"}),this.btnWrapThrough.on("click",_.bind(this.onBtnWrapClick,this)),this.btnWrapTopBottom=new Common.UI.Button({parentEl:$("#image-advanced-button-wrap-topbottom"),cls:"btn-options huge-1",iconCls:"icon-advanced-wrap options__icon options__icon-huge btn-wrap-topbottom",posId:Asc.c_oAscWrapStyle2.TopAndBottom,hint:this.textWrapTopbottomTooltip,enableToggle:!0,allowDepress:!1,toggleGroup:"imgAdvWrapGroup"}),this.btnWrapTopBottom.on("click",_.bind(this.onBtnWrapClick,this)),this.btnWrapBehind=new Common.UI.Button({parentEl:$("#image-advanced-button-wrap-behind"),cls:"btn-options huge-1",iconCls:"icon-advanced-wrap options__icon options__icon-huge btn-wrap-behind",posId:Asc.c_oAscWrapStyle2.Behind,hint:this.textWrapBehindTooltip,enableToggle:!0,allowDepress:!1,toggleGroup:"imgAdvWrapGroup"}),this.btnWrapBehind.on("click",_.bind(this.onBtnWrapClick,this)),this.btnWrapInFront=new Common.UI.Button({parentEl:$("#image-advanced-button-wrap-infront"),cls:"btn-options huge-1",iconCls:"icon-advanced-wrap options__icon options__icon-huge btn-wrap-infront",posId:Asc.c_oAscWrapStyle2.InFront,hint:this.textWrapInFrontTooltip,enableToggle:!0,allowDepress:!1,toggleGroup:"imgAdvWrapGroup"}),this.btnWrapInFront.on("click",_.bind(this.onBtnWrapClick,this)),this.spnTop=new Common.UI.MetricSpinner({el:$("#image-advanced-distance-top"),step:.1,width:85,defaultUnit:"cm",value:"0 cm",maxValue:55.87,minValue:0}),this.spnTop.on("change",_.bind(function(t,e,i,n){this._changedProps&&(null!==this._changedProps.get_Paddings()&&void 0!==this._changedProps.get_Paddings()||this._changedProps.put_Paddings(new Asc.asc_CPaddings),this._changedProps.get_Paddings().put_Top(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())))},this)),this.spinners.push(this.spnTop),this.spnBottom=new Common.UI.MetricSpinner({el:$("#image-advanced-distance-bottom"),step:.1,width:85,defaultUnit:"cm",value:"0 cm",maxValue:55.87,minValue:0}),this.spnBottom.on("change",_.bind(function(t,e,i,n){this._changedProps&&(null!==this._changedProps.get_Paddings()&&void 0!==this._changedProps.get_Paddings()||this._changedProps.put_Paddings(new Asc.asc_CPaddings),this._changedProps.get_Paddings().put_Bottom(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())))},this)),this.spinners.push(this.spnBottom),this.spnLeft=new Common.UI.MetricSpinner({el:$("#image-advanced-distance-left"),step:.1,width:85,defaultUnit:"cm",value:"0.32 cm",maxValue:55.87,minValue:0}),this.spnLeft.on("change",_.bind(function(t,e,i,n){this._changedProps&&(null!==this._changedProps.get_Paddings()&&void 0!==this._changedProps.get_Paddings()||this._changedProps.put_Paddings(new Asc.asc_CPaddings),this._changedProps.get_Paddings().put_Left(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())))},this)),this.spinners.push(this.spnLeft),this.spnRight=new Common.UI.MetricSpinner({el:$("#image-advanced-distance-right"),step:.1,width:85,defaultUnit:"cm",value:"0.32 cm",maxValue:55.87,minValue:0}),this.spnRight.on("change",_.bind(function(t,e,i,n){this._changedProps&&(null!==this._changedProps.get_Paddings()&&void 0!==this._changedProps.get_Paddings()||this._changedProps.put_Paddings(new Asc.asc_CPaddings),this._changedProps.get_Paddings().put_Right(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())))},this)),this.spinners.push(this.spnRight),this.spnX=new Common.UI.MetricSpinner({el:$("#image-spin-x"),step:.1,width:115,disabled:!0,defaultUnit:"cm",defaultValue:0,value:"0 cm",maxValue:55.87,minValue:-55.87}),this.spnX.on("change",_.bind(function(t,e,i,n){this._changedProps&&(null!==this._changedProps.get_PositionH()&&void 0!==this._changedProps.get_PositionH()||this._changedProps.put_PositionH(new Asc.CImagePositionH),this._changedProps.get_PositionH().put_UseAlign(!1),this._changedProps.get_PositionH().put_Percent(!1),this._changedProps.get_PositionH().put_RelativeFrom(this._state.HPositionFrom),this._changedProps.get_PositionH().put_Value(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())),this._state.spnXChanged=!0)},this)),this.spinners.push(this.spnX),this.spnY=new Common.UI.MetricSpinner({el:$("#image-spin-y"),step:.1,width:115,disabled:!0,defaultUnit:"cm",defaultValue:0,value:"0 cm",maxValue:55.87,minValue:-55.87}),this.spnY.on("change",_.bind(function(t,e,i,n){this._changedProps&&(null!==this._changedProps.get_PositionV()&&void 0!==this._changedProps.get_PositionV()||this._changedProps.put_PositionV(new Asc.CImagePositionV),this._changedProps.get_PositionV().put_UseAlign(!1),this._changedProps.get_PositionV().put_Percent(!1),this._changedProps.get_PositionV().put_RelativeFrom(this._state.VPositionFrom),this._changedProps.get_PositionV().put_Value(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())),this._state.spnYChanged=!0)},this)),this.spinners.push(this.spnY),this._arrHAlign=[{displayValue:this.textLeft,value:Asc.c_oAscAlignH.Left},{displayValue:this.textCenter,value:Asc.c_oAscAlignH.Center},{displayValue:this.textRight,value:Asc.c_oAscAlignH.Right}],this.cmbHAlign=new Common.UI.ComboBox({el:$("#image-combo-halign"),cls:"input-group-nr",menuStyle:"min-width: 115px;",editable:!1,data:this._arrHAlign,takeFocusOnClose:!0}),this.cmbHAlign.setValue(this._state.HAlignType),this.cmbHAlign.on("selected",_.bind(this.onHAlignSelect,this)),this._arrHRelative=[{displayValue:this.textMargin,value:Asc.c_oAscRelativeFromH.Margin},{displayValue:this.textPage,value:Asc.c_oAscRelativeFromH.Page},{displayValue:this.textColumn,value:Asc.c_oAscRelativeFromH.Column},{displayValue:this.textCharacter,value:Asc.c_oAscRelativeFromH.Character},{displayValue:this.textLeftMargin,value:Asc.c_oAscRelativeFromH.LeftMargin},{displayValue:this.textRightMargin,value:Asc.c_oAscRelativeFromH.RightMargin}],this.cmbHRelative=new Common.UI.ComboBox({el:$("#image-combo-hrelative"),cls:"input-group-nr",menuStyle:"min-width: 115px;",editable:!1,data:this._arrHRelative,takeFocusOnClose:!0}),this.cmbHRelative.setValue(this._state.HAlignFrom),this.cmbHRelative.on("selected",_.bind(this.onHRelativeSelect,this)),this.cmbHPosition=new Common.UI.ComboBox({el:$("#image-combo-hposition"),cls:"input-group-nr",menuStyle:"min-width: 115px;",editable:!1,data:this._arrHRelative,takeFocusOnClose:!0}),this.cmbHPosition.setDisabled(!0),this.cmbHPosition.setValue(this._state.HPositionFrom),this.cmbHPosition.on("selected",_.bind(this.onHPositionSelect,this)),this.spnXPc=new Common.UI.MetricSpinner({el:$("#image-spin-xpc"),step:1,width:115,disabled:!0,defaultUnit:"%",defaultValue:0,value:"0 %",maxValue:1e3,minValue:-1e3}),this.spnXPc.on("change",_.bind(function(t,e,i,n){this._changedProps&&(null!==this._changedProps.get_PositionH()&&void 0!==this._changedProps.get_PositionH()||this._changedProps.put_PositionH(new Asc.CImagePositionH),this._changedProps.get_PositionH().put_UseAlign(!1),this._changedProps.get_PositionH().put_Percent(!0),this._changedProps.get_PositionH().put_RelativeFrom(this._state.HPositionPcFrom),this._changedProps.get_PositionH().put_Value(t.getNumberValue()),this._state.spnXPcChanged=!0)},this)),this.cmbHPositionPc=new Common.UI.ComboBox({el:$("#image-combo-hpositionpc"),cls:"input-group-nr",menuStyle:"min-width: 115px;",editable:!1,data:this._arrHRelativePc,takeFocusOnClose:!0}),this.cmbHPositionPc.setDisabled(!0),this.cmbHPositionPc.setValue(this._state.HPositionPcFrom),this.cmbHPositionPc.on("selected",_.bind(this.onHPositionPcSelect,this)),this._arrVAlign=[{displayValue:this.textTop,value:Asc.c_oAscAlignV.Top},{displayValue:this.textCenter,value:Asc.c_oAscAlignV.Center},{displayValue:this.textBottom,value:Asc.c_oAscAlignV.Bottom}],this.cmbVAlign=new Common.UI.ComboBox({el:$("#image-combo-valign"),cls:"input-group-nr",menuStyle:"min-width: 115px;",editable:!1,data:this._arrVAlign,takeFocusOnClose:!0}),this.cmbVAlign.setValue(this._state.VAlignType),this.cmbVAlign.on("selected",_.bind(this.onVAlignSelect,this)),this._arrVRelative=[{displayValue:this.textMargin,value:Asc.c_oAscRelativeFromV.Margin},{displayValue:this.textPage,value:Asc.c_oAscRelativeFromV.Page},{displayValue:this.textParagraph,value:Asc.c_oAscRelativeFromV.Paragraph},{displayValue:this.textLine,value:Asc.c_oAscRelativeFromV.Line},{displayValue:this.textTopMargin,value:Asc.c_oAscRelativeFromV.TopMargin},{displayValue:this.textBottomMargin,value:Asc.c_oAscRelativeFromV.BottomMargin}],this.cmbVRelative=new Common.UI.ComboBox({el:$("#image-combo-vrelative"),cls:"input-group-nr",menuStyle:"min-width: 115px;",editable:!1,data:this._arrVRelative,takeFocusOnClose:!0}),this.cmbVRelative.setValue(this._state.VAlignFrom),this.cmbVRelative.on("selected",_.bind(this.onVRelativeSelect,this)),this.cmbVPosition=new Common.UI.ComboBox({el:$("#image-combo-vposition"),cls:"input-group-nr",menuStyle:"min-width: 115px;",editable:!1,data:this._arrVRelative,takeFocusOnClose:!0}),this.cmbVPosition.setDisabled(!0),this.cmbVPosition.setValue(this._state.VPositionFrom),this.cmbVPosition.on("selected",_.bind(this.onVPositionSelect,this)),this.spnYPc=new Common.UI.MetricSpinner({el:$("#image-spin-ypc"),step:1,width:115,disabled:!0,defaultUnit:"%",defaultValue:0,value:"0 %",maxValue:1e3,minValue:-1e3}),this.spnYPc.on("change",_.bind(function(t,e,i,n){this._changedProps&&(null!==this._changedProps.get_PositionV()&&void 0!==this._changedProps.get_PositionV()||this._changedProps.put_PositionV(new Asc.CImagePositionV),this._changedProps.get_PositionV().put_UseAlign(!1),this._changedProps.get_PositionV().put_Percent(!0),this._changedProps.get_PositionV().put_RelativeFrom(this._state.VPositionPcFrom),this._changedProps.get_PositionV().put_Value(t.getNumberValue()),this._state.spnYPcChanged=!0)},this)),this.cmbVPositionPc=new Common.UI.ComboBox({el:$("#image-combo-vpositionpc"),cls:"input-group-nr",menuStyle:"min-width: 115px;",editable:!1,data:this._arrVRelativePc,takeFocusOnClose:!0}),this.cmbVPositionPc.setDisabled(!0),this.cmbVPositionPc.setValue(this._state.VPositionPcFrom),this.cmbVPositionPc.on("selected",_.bind(this.onVPositionPcSelect,this)),this.radioHAlign=new Common.UI.RadioBox({el:$("#image-radio-halign"),name:"asc-radio-horizontal",checked:!0}),this.radioHAlign.on("change",_.bind(this.onRadioHAlignChange,this)),this.radioHPosition=new Common.UI.RadioBox({el:$("#image-radio-hposition"),name:"asc-radio-horizontal"}),this.radioHPosition.on("change",_.bind(this.onRadioHPositionChange,this)),this.radioHPositionPc=new Common.UI.RadioBox({el:$("#image-radio-hpositionpc"),name:"asc-radio-horizontal"}),this.radioHPositionPc.on("change",_.bind(this.onRadioHPositionPcChange,this)),this.radioVAlign=new Common.UI.RadioBox({el:$("#image-radio-valign"),name:"asc-radio-vertical",checked:!0}),this.radioVAlign.on("change",_.bind(this.onRadioVAlignChange,this)),this.radioVPosition=new Common.UI.RadioBox({el:$("#image-radio-vposition"),name:"asc-radio-vertical"}),this.radioVPosition.on("change",_.bind(this.onRadioVPositionChange,this)),this.radioVPositionPc=new Common.UI.RadioBox({el:$("#image-radio-vpositionpc"),name:"asc-radio-vertical"}),this.radioVPositionPc.on("change",_.bind(this.onRadioVPositionPcChange,this)),this.chMove=new Common.UI.CheckBox({el:$("#image-checkbox-move"),labelText:this.textMove}),this.chMove.on("change",_.bind(function(t,e,i,n){var o;this._changedProps&&(t=this._arrVRelative["checked"==t.getValue()?3:4].value,this.cmbVRelative.isDisabled()?(this.cmbVPosition.setValue(t),(o=this.cmbVPosition.getSelectedRecord())&&this.onVPositionSelect(this.cmbVPosition,o)):(this.cmbVRelative.setValue(t),(o=this.cmbVRelative.getSelectedRecord())&&this.onVRelativeSelect(this.cmbVRelative,o)))},this)),this.chOverlap=new Common.UI.CheckBox({el:$("#image-checkbox-overlap"),labelText:this.textOverlap}),this.chOverlap.on("change",_.bind(function(t,e,i,n){this._changedProps&&this._changedProps.put_AllowOverlap("checked"==t.getValue())},this)),this.spnMarginTop=new Common.UI.MetricSpinner({el:$("#image-margin-top"),step:.1,width:100,defaultUnit:"cm",value:"0 cm",maxValue:55.87,minValue:0}),this.spnMarginTop.on("change",_.bind(function(t,e,i,n){this._changedProps&&(void 0===this.Margins&&(this.Margins=new Asc.asc_CPaddings),this.Margins.put_Top(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())))},this)),this.spinners.push(this.spnMarginTop),this.spnMarginBottom=new Common.UI.MetricSpinner({el:$("#image-margin-bottom"),step:.1,width:100,defaultUnit:"cm",value:"0 cm",maxValue:55.87,minValue:0}),this.spnMarginBottom.on("change",_.bind(function(t,e,i,n){this._changedProps&&(void 0===this.Margins&&(this.Margins=new Asc.asc_CPaddings),this.Margins.put_Bottom(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())))},this)),this.spinners.push(this.spnMarginBottom),this.spnMarginLeft=new Common.UI.MetricSpinner({el:$("#image-margin-left"),step:.1,width:100,defaultUnit:"cm",value:"0.19 cm",maxValue:9.34,minValue:0}),this.spnMarginLeft.on("change",_.bind(function(t,e,i,n){this._changedProps&&(void 0===this.Margins&&(this.Margins=new Asc.asc_CPaddings),this.Margins.put_Left(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())))},this)),this.spinners.push(this.spnMarginLeft),this.spnMarginRight=new Common.UI.MetricSpinner({el:$("#image-margin-right"),step:.1,width:100,defaultUnit:"cm",value:"0.19 cm",maxValue:9.34,minValue:0}),this.spnMarginRight.on("change",_.bind(function(t,e,i,n){this._changedProps&&(void 0===this.Margins&&(this.Margins=new Asc.asc_CPaddings),this.Margins.put_Right(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())))},this)),this.spinners.push(this.spnMarginRight),this.chAutofit=new Common.UI.CheckBox({el:$("#shape-checkbox-autofit"),labelText:this.textResizeFit}),this.chAutofit.on("change",_.bind(function(t,e,i,n){this._changedShapeProps&&this._changedShapeProps.asc_putTextFitType("checked"==t.getValue()?AscFormat.text_fit_Auto:AscFormat.text_fit_No)},this)),this._arrCapType=[{displayValue:this.textFlat,value:Asc.c_oAscLineCapType.Flat},{displayValue:this.textRound,value:Asc.c_oAscLineCapType.Round},{displayValue:this.textSquare,value:Asc.c_oAscLineCapType.Square}],this.cmbCapType=new Common.UI.ComboBox({el:$("#shape-advanced-cap-type"),cls:"input-group-nr",menuStyle:"min-width: 100px;",editable:!1,data:this._arrCapType,takeFocusOnClose:!0}),this.cmbCapType.setValue(Asc.c_oAscLineCapType.Flat),this.cmbCapType.on("selected",_.bind(function(t,e){this._changedShapeProps&&(null===this._changedShapeProps.get_stroke()&&this._changedShapeProps.put_stroke(new Asc.asc_CStroke),this._changedShapeProps.get_stroke().put_linecap(e.value))},this)),this._arrJoinType=[{displayValue:this.textRound,value:Asc.c_oAscLineJoinType.Round},{displayValue:this.textBevel,value:Asc.c_oAscLineJoinType.Bevel},{displayValue:this.textMiter,value:Asc.c_oAscLineJoinType.Miter}],this.cmbJoinType=new Common.UI.ComboBox({el:$("#shape-advanced-join-type"),cls:"input-group-nr",menuStyle:"min-width: 100px;",editable:!1,data:this._arrJoinType,takeFocusOnClose:!0}),this.cmbJoinType.setValue(Asc.c_oAscLineJoinType.Round),this.cmbJoinType.on("selected",_.bind(function(t,e){this._changedShapeProps&&(null===this._changedShapeProps.get_stroke()&&this._changedShapeProps.put_stroke(new Asc.asc_CStroke),this._changedShapeProps.get_stroke().put_linejoin(e.value))},this)),[]),i=[];t.push({type:Asc.c_oAscLineBeginType.None,idsvg:"no-"}),t.push({type:Asc.c_oAscLineBeginType.Triangle,idsvg:""}),t.push({type:Asc.c_oAscLineBeginType.Arrow,idsvg:"open-"}),t.push({type:Asc.c_oAscLineBeginType.Stealth,idsvg:"stealth-"}),t.push({type:Asc.c_oAscLineBeginType.Diamond,idsvg:"dimond-"}),t.push({type:Asc.c_oAscLineBeginType.Oval,idsvg:"oval-"});for(var n=0;n<6;n++)t[n].value=n;for(n=0;n<9;n++)i.push({value:n,typearrow:""});i[0].type=Asc.c_oAscLineBeginSize.small_small,i[1].type=Asc.c_oAscLineBeginSize.small_mid,i[2].type=Asc.c_oAscLineBeginSize.small_large,i[3].type=Asc.c_oAscLineBeginSize.mid_small,i[4].type=Asc.c_oAscLineBeginSize.mid_mid,i[5].type=Asc.c_oAscLineBeginSize.mid_large,i[6].type=Asc.c_oAscLineBeginSize.large_small,i[7].type=Asc.c_oAscLineBeginSize.large_mid,i[8].type=Asc.c_oAscLineBeginSize.large_large,this.btnBeginStyle=new Common.UI.ComboBox({el:$("#shape-advanced-begin-style"),template:_.template(['<div class="input-group combobox combo-dataview-menu input-group-nr dropdown-toggle combo-arrow-style"  data-toggle="dropdown">','<div class="form-control" style="width: 100px;">','<i class="img-arrows"><svg><use xlink:href="#no-arrow-5"></use></svg></i>',"</div>",'<div style="display: table-cell;"></div>','<button type="button" class="btn btn-default">','<span class="caret"></span>',"</button>","</div>"].join(""))}),this.btnBeginStyleMenu=new Common.UI.Menu({style:"min-width: 105px;",additionalAlign:this.menuAddAlign,items:[{template:_.template('<div id="shape-advanced-menu-begin-style" style="width: 105px; margin: 0 5px;"></div>')}]}).render($("#shape-advanced-begin-style")),this.mnuBeginStylePicker=new Common.UI.DataView({el:$("#shape-advanced-menu-begin-style"),parentMenu:this.btnBeginStyleMenu,store:new Common.UI.DataViewStore(t),itemTemplate:_.template('<div id="<%= id %>" class="item-arrow img-arrows"><svg><use xlink:href= "#<%= idsvg %>arrow-5"></use></svg></div>')}),this.mnuBeginStylePicker.on("item:click",_.bind(this.onSelectBeginStyle,this)),this._selectStyleItem(this.btnBeginStyle,null),this.btnBeginSize=new Common.UI.ComboBox({el:$("#shape-advanced-begin-size"),template:_.template(['<div class="input-group combobox combo-dataview-menu input-group-nr dropdown-toggle combo-arrow-style"  data-toggle="dropdown">','<div class="form-control" style="width: 100px;">','<i class="img-arrows"><svg><use xlink:href=""></use></svg></i>',"</div>",'<div style="display: table-cell;"></div>','<button type="button" class="btn btn-default">','<span class="caret"></span>',"</button>","</div>"].join(""))}),this.btnBeginSizeMenu=new Common.UI.Menu({style:"min-width: 160px;",additionalAlign:this.menuAddAlign,items:[{template:_.template('<div id="shape-advanced-menu-begin-size" style="width: 160px; margin: 0 5px;"></div>')}]}).render($("#shape-advanced-begin-size")),this.mnuBeginSizePicker=new Common.UI.DataView({el:$("#shape-advanced-menu-begin-size"),parentMenu:this.btnBeginSizeMenu,store:new Common.UI.DataViewStore(i),itemTemplate:_.template('<div id="<%= id %>" class="item-arrow img-arrows"><svg><use xlink:href="#<%= typearrow %>arrow-<%= (value+1) %>"></use></svg></div>')}),this.mnuBeginSizePicker.on("item:click",_.bind(this.onSelectBeginSize,this)),this._selectStyleItem(this.btnBeginSize,null),this.btnEndStyle=new Common.UI.ComboBox({el:$("#shape-advanced-end-style"),template:_.template(['<div class="input-group combobox combo-dataview-menu input-group-nr dropdown-toggle combo-arrow-style"  data-toggle="dropdown">','<div class="form-control" style="width: 100px;">','<i class="img-arrows"><svg class ="svg-mirror"><use xlink:href="#no-arrow-5"></use></svg></i>',"</div>",'<div style="display: table-cell;"></div>','<button type="button" class="btn btn-default">','<span class="caret"></span>',"</button>","</div>"].join(""))}),this.btnEndStyleMenu=new Common.UI.Menu({style:"min-width: 105px;",additionalAlign:this.menuAddAlign,items:[{template:_.template('<div id="shape-advanced-menu-end-style" style="width: 105px; margin: 0 5px;"></div>')}]}).render($("#shape-advanced-end-style")),this.mnuEndStylePicker=new Common.UI.DataView({el:$("#shape-advanced-menu-end-style"),parentMenu:this.btnEndStyleMenu,store:new Common.UI.DataViewStore(t),itemTemplate:_.template('<div id="<%= id %>" class="item-arrow img-arrows"><svg class ="svg-mirror"><use xlink:href="#<%= idsvg %>arrow-5"></use></svg></div>')}),this.mnuEndStylePicker.on("item:click",_.bind(this.onSelectEndStyle,this)),this._selectStyleItem(this.btnEndStyle,null),this.btnEndSize=new Common.UI.ComboBox({el:$("#shape-advanced-end-size"),template:_.template(['<div class="input-group combobox combo-dataview-menu input-group-nr dropdown-toggle combo-arrow-style"  data-toggle="dropdown">','<div class="form-control" style="width: 100px;">','<i class="img-arrows"><svg class ="svg-mirror"><use xlink:href=""></use></svg></i>',"</div>",'<div style="display: table-cell;"></div>','<button type="button" class="btn btn-default">','<span class="caret"></span>',"</button>","</div>"].join(""))}),this.btnEndSizeMenu=new Common.UI.Menu({style:"min-width: 160px;",additionalAlign:this.menuAddAlign,items:[{template:_.template('<div id="shape-advanced-menu-end-size" style="width: 160px; margin: 0 5px;"></div>')}]}).render($("#shape-advanced-end-size")),this.mnuEndSizePicker=new Common.UI.DataView({el:$("#shape-advanced-menu-end-size"),parentMenu:this.btnEndSizeMenu,store:new Common.UI.DataViewStore(i),itemTemplate:_.template('<div id="<%= id %>" class="item-arrow img-arrows"><svg class ="svg-mirror"><use xlink:href="#<%= typearrow %>arrow-<%= (value + 1) %>"></use></svg></div>')}),this.mnuEndSizePicker.on("item:click",_.bind(this.onSelectEndSize,this)),this._selectStyleItem(this.btnEndSize,null),this.inputAltTitle=new Common.UI.InputField({el:$("#image-advanced-alt-title"),allowBlank:!0,validateOnBlur:!1,style:"width: 100%;"}).on("changed:after",function(){e.isAltTitleChanged=!0}),this.textareaAltDescription=this.$window.find("textarea"),this.textareaAltDescription.keydown(function(t){t.keyCode==Common.UI.Keys.RETURN&&t.stopPropagation(),e.isAltDescChanged=!0}),this.afterRender()},getFocusedComponents:function(){return[this.spnWidth,this.btnRatio,this.spnHeight,this.btnOriginalSize,this.radioHSize,this.spnShapeWidth,this.spnShapeWidthPc,this.radioHSizePc,this.cmbWidthPc,this.radioVSize,this.spnShapeHeight,this.spnShapeHeightPc,this.radioVSizePc,this.cmbHeightPc,this.chRatio,this.spnAngle,this.chFlipHor,this.chFlipVert,this.spnTop,this.spnLeft,this.spnBottom,this.spnRight,this.radioHAlign,this.radioHPosition,this.radioHPositionPc,this.cmbHAlign,this.cmbHRelative,this.spnX,this.cmbHPosition,this.spnXPc,this.cmbHPositionPc,this.radioVAlign,this.radioVPosition,this.radioVPositionPc,this.cmbVAlign,this.cmbVRelative,this.spnY,this.cmbVPosition,this.spnYPc,this.cmbVPositionPc,this.chMove,this.chOverlap,this.cmbCapType,this.cmbJoinType,this.chAutofit,this.spnMarginTop,this.spnMarginLeft,this.spnMarginBottom,this.spnMarginRight,this.inputAltTitle,this.textareaAltDescription]},onCategoryClick:function(t,e){Common.Views.AdvancedSettingsWindow.prototype.onCategoryClick.call(this,t,e);var i=this;setTimeout(function(){switch(e){case 0:i.spnWidth.focus();break;case 1:(i.spnShapeWidth.isDisabled()?i.spnShapeWidthPc:i.spnShapeWidth).focus();break;case 2:i.spnAngle.focus();break;case 3:i.spnTop.focus();break;case 4:(i.cmbHAlign.isDisabled()?i.spnX.isDisabled()?i.spnXPc:i.spnX:i.cmbHAlign).focus();break;case 5:i.cmbCapType.focus();break;case 6:i.chAutofit.focus();break;case 7:i.inputAltTitle.focus()}},10)},afterRender:function(){var t;this.updateMetricUnit(),this._setDefaults(this._originalProps),this.btnsCategory[this._objectType==Asc.c_oAscTypeSelectElement.Shape?0:1].setVisible(!1),this.storageName&&(t=Common.localStorage.getItem(this.storageName),this.setActiveCategory(null!==t?parseInt(t):0))},_setDefaults:function(t){if(t){this._objectType=Asc.c_oAscTypeSelectElement.Image;var e=t.get_WrappingStyle();if(t.get_CanBeFlow()){switch(e){case Asc.c_oAscWrapStyle2.Inline:this.btnWrapInline.toggle(!0);break;case Asc.c_oAscWrapStyle2.Square:this.btnWrapSquare.toggle(!0);break;case Asc.c_oAscWrapStyle2.Tight:this.btnWrapTight.toggle(!0);break;case Asc.c_oAscWrapStyle2.Through:this.btnWrapThrough.toggle(!0);break;case Asc.c_oAscWrapStyle2.TopAndBottom:this.btnWrapTopBottom.toggle(!0);break;case Asc.c_oAscWrapStyle2.Behind:this.btnWrapBehind.toggle(!0);break;case Asc.c_oAscWrapStyle2.InFront:this.btnWrapInFront.toggle(!0);break;default:this.btnWrapInline.toggle(!1),this.btnWrapSquare.toggle(!1),this.btnWrapTight.toggle(!1),this.btnWrapThrough.toggle(!1),this.btnWrapTopBottom.toggle(!1),this.btnWrapBehind.toggle(!1),this.btnWrapInFront.toggle(!1)}this._DisableElem(e)}else this.btnWrapInline.toggle(!0),this.btnWrapSquare.setDisabled(!0),this.btnWrapTight.setDisabled(!0),this.btnWrapThrough.setDisabled(!0),this.btnWrapTopBottom.setDisabled(!0),this.btnWrapBehind.setDisabled(!0),this.btnWrapInFront.setDisabled(!0),this._DisableElem(Asc.c_oAscWrapStyle2.Inline);t.get_Paddings()&&(null!=(i={Top:t.get_Paddings().get_Top(),Right:t.get_Paddings().get_Right(),Bottom:t.get_Paddings().get_Bottom(),Left:t.get_Paddings().get_Left()}).Top&&this.spnTop.setValue(Common.Utils.Metric.fnRecalcFromMM(i.Top),!0),null!=i.Left&&this.spnLeft.setValue(Common.Utils.Metric.fnRecalcFromMM(i.Left),!0),null!=i.Bottom&&this.spnBottom.setValue(Common.Utils.Metric.fnRecalcFromMM(i.Bottom),!0),null!=i.Right&&this.spnRight.setValue(Common.Utils.Metric.fnRecalcFromMM(i.Right),!0));var i=t.get_PositionH();if(i)if(i.get_UseAlign()){for(var e=i.get_Align(),n=0;n<this._arrHAlign.length;n++)if(e==this._arrHAlign[n].value){this.cmbHAlign.setValue(e),this._state.HAlignType=e;break}e=i.get_RelativeFrom();for(n=0;n<this._arrHRelative.length;n++)if(e==this._arrHRelative[n].value){this.cmbHRelative.setValue(e),this._state.HAlignFrom=e;break}}else if(i.get_Percent()){for(this.radioHPositionPc.setValue(!0),this.spnXPc.setValue(i.get_Value()),e=i.get_RelativeFrom(),n=0;n<this._arrHRelativePc.length;n++)if(e==this._arrHRelativePc[n].value){this.cmbHPositionPc.setValue(e),this._state.HPositionPcFrom=e;break}}else for(this.radioHPosition.setValue(!0),e=i.get_Value(),this.spnX.setValue(Common.Utils.Metric.fnRecalcFromMM(e)),e=i.get_RelativeFrom(),n=0;n<this._arrHRelative.length;n++)if(e==this._arrHRelative[n].value){this.cmbHPosition.setValue(e),this._state.HPositionFrom=e;break}if(i=t.get_PositionV()){if(i.get_UseAlign()){for(e=i.get_Align(),n=0;n<this._arrVAlign.length;n++)if(e==this._arrVAlign[n].value){this.cmbVAlign.setValue(e),this._state.VAlignType=e;break}for(e=i.get_RelativeFrom(),n=0;n<this._arrVRelative.length;n++)if(e==this._arrVRelative[n].value){this.cmbVRelative.setValue(e),this._state.VAlignFrom=e;break}}else if(i.get_Percent()){for(this.radioVPositionPc.setValue(!0),this.spnYPc.setValue(i.get_Value()),e=i.get_RelativeFrom(),n=0;n<this._arrVRelativePc.length;n++)if(e==this._arrVRelativePc[n].value){this.cmbVPositionPc.setValue(e),this._state.VPositionPcFrom=e;break}}else for(this.radioVPosition.setValue(!0),e=i.get_Value(),this.spnY.setValue(Common.Utils.Metric.fnRecalcFromMM(e)),e=i.get_RelativeFrom(),n=0;n<this._arrVRelative.length;n++)if(e==this._arrVRelative[n].value){this.cmbVPosition.setValue(e),this._state.VPositionFrom=e;break}this.chMove.setValue(e==Asc.c_oAscRelativeFromV.Line||e==Asc.c_oAscRelativeFromV.Paragraph,!0),this.chMove.setDisabled(!i.get_UseAlign()&&i.get_Percent())}this.chOverlap.setValue(null!==t.get_AllowOverlap()&&void 0!==t.get_AllowOverlap()?t.get_AllowOverlap():"indeterminate",!0),0<t.get_Height()&&(this._nRatio=t.get_Width()/t.get_Height());var i=t.get_ShapeProperties(),o=t.get_ChartProperties(),s=t.asc_getPluginGuid(),a=this.api&&this.api.asc_IsContentControl()?this.api.asc_GetContentControlProperties():null,l=!1;if(a&&(l=((d=a.get_SpecificType())==Asc.c_oAscContentControlSpecificType.CheckBox||d==Asc.c_oAscContentControlSpecificType.ComboBox||d==Asc.c_oAscContentControlSpecificType.DropDownList||d==Asc.c_oAscContentControlSpecificType.None||d==Asc.c_oAscContentControlSpecificType.Picture||d==Asc.c_oAscContentControlSpecificType.Complex||d==Asc.c_oAscContentControlSpecificType.DateTime)&&a.get_FormPr()&&a.get_FormPr().get_Fixed()),this.btnOriginalSize.setVisible(!(i||o)),this.btnOriginalSize.setDisabled(null===t.get_ImageUrl()||void 0===t.get_ImageUrl()),this.btnsCategory[5].setVisible(null!==i&&!i.get_FromChart()&&!l),this.btnsCategory[6].setVisible(null!==i&&!i.get_FromChart()&&!l),this.btnsCategory[7].setVisible(!l),this.btnsCategory[2].setVisible(!o&&null==s),this.btnsCategory[3].setDisabled(t.get_FromGroup()||!!a&&a.get_SpecificType()==Asc.c_oAscContentControlSpecificType.Picture&&!a.get_FormPr()),i){this._objectType=Asc.c_oAscTypeSelectElement.Shape,this._setShapeDefaults(i),this.setTitle(this.textTitleShape),e=t.asc_getLockAspect(),this.chRatio.setValue(e||this._isSmartArt,!0),this.spnShapeWidth.setMaxValue(this.sizeMax.width),this.spnShapeHeight.setMaxValue(this.sizeMax.height);var r=t.get_SizeRelH();if(r){for(this.radioHSizePc.setValue(!0),this.spnShapeWidthPc.setValue(r.get_Value()),e=r.get_RelativeFrom(),n=0;n<this._arrHRelativePc.length;n++)if(e==this._arrHRelativePc[n].value){this.cmbWidthPc.setValue(e),this.spnShapeWidth.setValue(Common.Utils.Metric.fnRecalcFromMM(this._arrHRelativePc[n].size*r.get_Value()/100).toFixed(2),!0),this._state.ShapeWidthPcFrom=e;break}}else this.radioHSize.setValue(!0),e=t.get_Width(),this.spnShapeWidth.setValue(void 0!==e?Common.Utils.Metric.fnRecalcFromMM(e).toFixed(2):"",!0);var c=t.get_SizeRelV();if(c){for(this.radioVSizePc.setValue(!0),this.spnShapeHeightPc.setValue(c.get_Value()),e=c.get_RelativeFrom(),n=0;n<this._arrVRelativePc.length;n++)if(e==this._arrVRelativePc[n].value){this.cmbHeightPc.setValue(e),this.spnShapeHeight.setValue(Common.Utils.Metric.fnRecalcFromMM(this._arrVRelativePc[n].size*c.get_Value()/100).toFixed(2),!0),this._state.ShapeHeightPcFrom=e;break}}else this.radioVSize.setValue(!0),e=t.get_Height(),this.spnShapeHeight.setValue(void 0!==e?Common.Utils.Metric.fnRecalcFromMM(e).toFixed(2):"",!0);this.chRatio.setDisabled(this.radioVSizePc.getValue()||this.radioHSizePc.getValue()||this._isSmartArt);var d=i.get_paddings();d&&(l=d.get_Left(),this.spnMarginLeft.setValue(null!=l?Common.Utils.Metric.fnRecalcFromMM(l):"",!0),l=d.get_Top(),this.spnMarginTop.setValue(null!=l?Common.Utils.Metric.fnRecalcFromMM(l):"",!0),l=d.get_Right(),this.spnMarginRight.setValue(null!=l?Common.Utils.Metric.fnRecalcFromMM(l):"",!0),l=d.get_Bottom(),this.spnMarginBottom.setValue(null!=l?Common.Utils.Metric.fnRecalcFromMM(l):"",!0)),this.chAutofit.setValue(i.asc_getTextFitType()==AscFormat.text_fit_Auto),this.btnsCategory[6].setDisabled(null===d),this.btnsCategory[5].setDisabled(i.get_stroke().get_type()==Asc.c_oAscStrokeType.STROKE_NONE)}else e=t.asc_getLockAspect(),o?(this._objectType=Asc.c_oAscTypeSelectElement.Chart,this.setTitle(this.textTitleChart)):this.setTitle(this.textTitle),this.btnRatio.toggle(e),this.spnWidth.setMaxValue(this.sizeMax.width),this.spnHeight.setMaxValue(this.sizeMax.height),e=t.get_Width(),this.spnWidth.setValue(void 0!==e?Common.Utils.Metric.fnRecalcFromMM(e).toFixed(2):"",!0),e=t.get_Height(),this.spnHeight.setValue(void 0!==e?Common.Utils.Metric.fnRecalcFromMM(e).toFixed(2):"",!0);o||(e=t.asc_getRot(),this.spnAngle.setValue(null==e||null===e?"":Math.floor(180*e/3.14159265358979+.5),!0),this.chFlipHor.setValue(t.asc_getFlipH()),this.chFlipVert.setValue(t.asc_getFlipV())),e=t.asc_getTitle(),this.inputAltTitle.setValue(e||""),e=t.asc_getDescription(),this.textareaAltDescription.val(e||""),this._changedProps=new Asc.asc_CImgProperty}},getSettings:function(){var t,e=this._changedProps;return this._objectType==Asc.c_oAscTypeSelectElement.Shape&&(e.put_ShapeProperties(this._changedShapeProps),this.Margins&&(null!==e.get_ShapeProperties()&&void 0!==e.get_ShapeProperties()||e.put_ShapeProperties(new Asc.asc_CShapeProperty),e.get_ShapeProperties().put_paddings(this.Margins))),this._originalProps.get_WrappingStyle()===Asc.c_oAscWrapStyle2.Inline&&void 0!==e.get_WrappingStyle()&&e.get_WrappingStyle()!==Asc.c_oAscWrapStyle2.Inline&&(null!==e.get_PositionH()&&void 0!==e.get_PositionH()||(e.put_PositionH(new Asc.CImagePositionH),e.get_PositionH().put_UseAlign(!1),e.get_PositionH().put_Percent(!1),e.get_PositionH().put_RelativeFrom(Asc.c_oAscRelativeFromH.Column),t=this._originalProps.get_Value_X(Asc.c_oAscRelativeFromH.Column),e.get_PositionH().put_Value(t)),null!==e.get_PositionV()&&void 0!==e.get_PositionV()||(e.put_PositionV(new Asc.CImagePositionV),e.get_PositionV().put_UseAlign(!1),e.get_PositionV().put_Percent(!1),e.get_PositionV().put_RelativeFrom(Asc.c_oAscRelativeFromV.Paragraph),t=this._originalProps.get_Value_Y(Asc.c_oAscRelativeFromV.Paragraph),e.get_PositionV().put_Value(t))),this._objectType!=Asc.c_oAscTypeSelectElement.Chart&&(e.asc_putRot(3.14159265358979*this.spnAngle.getNumberValue()/180),e.asc_putFlipH("checked"==this.chFlipHor.getValue()),e.asc_putFlipV("checked"==this.chFlipVert.getValue())),this.isAltTitleChanged&&e.asc_putTitle(this.inputAltTitle.getValue()),this.isAltDescChanged&&e.asc_putDescription(this.textareaAltDescription.val()),{imageProps:e}},_setShapeDefaults:function(t){if(t){t.get_FromSmartArt()&&(this.radioHSizePc.setDisabled(!0),this.radioVSizePc.setDisabled(!0),this.btnsCategory[2].setDisabled(!0),this._isSmartArt=!0),t.get_FromSmartArtInternal()&&(this.chAutofit.setDisabled(!0),this.chFlipHor.setDisabled(!0),this.chFlipVert.setDisabled(!0),this.btnsCategory[1].setDisabled(!0));t=t.get_stroke();if(t){for(var e=t.get_linejoin(),i=0;i<this._arrJoinType.length;i++)if(e==this._arrJoinType[i].value){this.cmbJoinType.setValue(e);break}for(e=t.get_linecap(),i=0;i<this._arrCapType.length;i++)if(e==this._arrCapType[i].value){this.cmbCapType.setValue(e);break}var n=t.get_canChangeArrows();this.btnBeginStyle.setDisabled(!n),this.btnEndStyle.setDisabled(!n),this.btnBeginSize.setDisabled(!n),this.btnEndSize.setDisabled(!n),n?(e=t.get_linebeginsize(),(n=this.mnuBeginSizePicker.store.findWhere({type:e}))?this._beginSizeIdx=n.get("value"):(this._beginSizeIdx=null,this._selectStyleItem(this.btnBeginSize,null)),e=t.get_linebeginstyle(),(n=this.mnuBeginStylePicker.store.findWhere({type:e}))?(this.mnuBeginStylePicker.selectRecord(n,!0),this._updateSizeArr(this.btnBeginSize,this.mnuBeginSizePicker,n,this._beginSizeIdx),this._selectStyleItem(this.btnBeginStyle,n)):this._selectStyleItem(this.btnBeginStyle,null),e=t.get_lineendsize(),(n=this.mnuEndSizePicker.store.findWhere({type:e}))?this._endSizeIdx=n.get("value"):(this._endSizeIdx=null,this._selectStyleItem(this.btnEndSize,null)),e=t.get_lineendstyle(),(n=this.mnuEndStylePicker.store.findWhere({type:e}))?(this.mnuEndStylePicker.selectRecord(n,!0),this._updateSizeArr(this.btnEndSize,this.mnuEndSizePicker,n,this._endSizeIdx),this._selectStyleItem(this.btnEndStyle,n)):this._selectStyleItem(this.btnEndStyle,null)):(this._selectStyleItem(this.btnBeginStyle),this._selectStyleItem(this.btnEndStyle),this._selectStyleItem(this.btnBeginSize),this._selectStyleItem(this.btnEndSize))}}this._changedShapeProps=new Asc.asc_CShapeProperty},updateMetricUnit:function(){if(this.spinners)for(var t=0;t<this.spinners.length;t++){var e=this.spinners[t];e.setDefaultUnit(Common.Utils.Metric.getCurrentMetricName()),e.setStep(Common.Utils.Metric.getCurrentMetric()==Common.Utils.Metric.c_MetricUnits.pt?1:.01)}this.sizeMax={width:Common.Utils.Metric.fnRecalcFromMM(10*this.options.sizeMax.width),height:Common.Utils.Metric.fnRecalcFromMM(10*this.options.sizeMax.height)},this.options.sizeOriginal&&(this.sizeOriginal={width:Common.Utils.Metric.fnRecalcFromMM(this.options.sizeOriginal.width),height:Common.Utils.Metric.fnRecalcFromMM(this.options.sizeOriginal.height)})},onBtnWrapClick:function(t,e){this._DisableElem(t.options.posId),this._changedProps&&this._changedProps.put_WrappingStyle(t.options.posId)},_DisableElem:function(t){var e=t==Asc.c_oAscWrapStyle2.Inline||t==Asc.c_oAscWrapStyle2.Behind||t==Asc.c_oAscWrapStyle2.InFront||t==Asc.c_oAscWrapStyle2.TopAndBottom,i=t==Asc.c_oAscWrapStyle2.Inline||t==Asc.c_oAscWrapStyle2.Behind||t==Asc.c_oAscWrapStyle2.InFront||t==Asc.c_oAscWrapStyle2.Tight||t==Asc.c_oAscWrapStyle2.Through;this.spnLeft.setDisabled(e),this.spnRight.setDisabled(e),this.spnTop.setDisabled(i),this.spnBottom.setDisabled(i),this.btnsCategory[4].setDisabled(t==Asc.c_oAscWrapStyle2.Inline)},onHAlignSelect:function(t,e){this._changedProps&&(null!==this._changedProps.get_PositionH()&&void 0!==this._changedProps.get_PositionH()||this._changedProps.put_PositionH(new Asc.CImagePositionH),this._state.HAlignType=e.value,this._changedProps.get_PositionH().put_UseAlign(!0),this._changedProps.get_PositionH().put_Percent(!1),this._changedProps.get_PositionH().put_RelativeFrom(this._state.HAlignFrom),this._changedProps.get_PositionH().put_Align(this._state.HAlignType))},onHRelativeSelect:function(t,e){this._changedProps&&(null!==this._changedProps.get_PositionH()&&void 0!==this._changedProps.get_PositionH()||this._changedProps.put_PositionH(new Asc.CImagePositionH),this._state.HAlignFrom=e.value,this._changedProps.get_PositionH().put_UseAlign(!0),this._changedProps.get_PositionH().put_Percent(!1),this._changedProps.get_PositionH().put_RelativeFrom(this._state.HAlignFrom),this._changedProps.get_PositionH().put_Align(this._state.HAlignType))},onHPositionSelect:function(t,e){this._changedProps&&(null!==this._changedProps.get_PositionH()&&void 0!==this._changedProps.get_PositionH()||this._changedProps.put_PositionH(new Asc.CImagePositionH),this._state.HPositionFrom=e.value,this._changedProps.get_PositionH().put_UseAlign(!1),this._changedProps.get_PositionH().put_Percent(!1),this._changedProps.get_PositionH().put_RelativeFrom(this._state.HPositionFrom),this._state.spnXChanged||(e=this._originalProps.get_Value_X(this._state.HPositionFrom),this.spnX.setValue(Common.Utils.Metric.fnRecalcFromMM(e),!0)),this._changedProps.get_PositionH().put_Value(Common.Utils.Metric.fnRecalcToMM(this.spnX.getNumberValue())))},onHPositionPcSelect:function(t,e){this._changedProps&&(null!==this._changedProps.get_PositionH()&&void 0!==this._changedProps.get_PositionH()||this._changedProps.put_PositionH(new Asc.CImagePositionH),this._state.HPositionPcFrom=e.value,this._changedProps.get_PositionH().put_UseAlign(!1),this._changedProps.get_PositionH().put_Percent(!0),this._changedProps.get_PositionH().put_RelativeFrom(this._state.HPositionPcFrom),this._state.spnXPcChanged||(e=this._originalProps.get_Value_X(this._state.HPositionPcFrom),this.spnXPc.setValue(parseFloat((100*e/this.pageWidth).toFixed(2)),!0)),this._changedProps.get_PositionH().put_Value(this.spnXPc.getNumberValue()))},onVAlignSelect:function(t,e){this._changedProps&&(null!==this._changedProps.get_PositionV()&&void 0!==this._changedProps.get_PositionV()||this._changedProps.put_PositionV(new Asc.CImagePositionV),this._state.VAlignType=e.value,this._changedProps.get_PositionV().put_UseAlign(!0),this._changedProps.get_PositionV().put_Percent(!1),this._changedProps.get_PositionV().put_RelativeFrom(this._state.VAlignFrom),this._changedProps.get_PositionV().put_Align(this._state.VAlignType))},onVRelativeSelect:function(t,e){this._changedProps&&(null!==this._changedProps.get_PositionV()&&void 0!==this._changedProps.get_PositionV()||this._changedProps.put_PositionV(new Asc.CImagePositionV),this._state.VAlignFrom=e.value,this._changedProps.get_PositionV().put_UseAlign(!0),this._changedProps.get_PositionV().put_Percent(!1),this._changedProps.get_PositionV().put_RelativeFrom(this._state.VAlignFrom),this._changedProps.get_PositionV().put_Align(this._state.VAlignType),this.chMove.setValue(this._state.VAlignFrom==Asc.c_oAscRelativeFromV.Line||this._state.VAlignFrom==Asc.c_oAscRelativeFromV.Paragraph,!0))},onVPositionSelect:function(t,e){this._changedProps&&(null!==this._changedProps.get_PositionV()&&void 0!==this._changedProps.get_PositionV()||this._changedProps.put_PositionV(new Asc.CImagePositionV),this._state.VPositionFrom=e.value,this._changedProps.get_PositionV().put_UseAlign(!1),this._changedProps.get_PositionV().put_Percent(!1),this._changedProps.get_PositionV().put_RelativeFrom(this._state.VPositionFrom),this._state.spnYChanged||(e=this._originalProps.get_Value_Y(this._state.VPositionFrom),this.spnY.setValue(Common.Utils.Metric.fnRecalcFromMM(e),!0)),this._changedProps.get_PositionV().put_Value(Common.Utils.Metric.fnRecalcToMM(this.spnY.getNumberValue())),this.chMove.setValue(this._state.VPositionFrom==Asc.c_oAscRelativeFromV.Line||this._state.VPositionFrom==Asc.c_oAscRelativeFromV.Paragraph,!0))},onVPositionPcSelect:function(t,e){this._changedProps&&(null!==this._changedProps.get_PositionV()&&void 0!==this._changedProps.get_PositionV()||this._changedProps.put_PositionV(new Asc.CImagePositionV),this._state.VPositionPcFrom=e.value,this._changedProps.get_PositionV().put_UseAlign(!1),this._changedProps.get_PositionV().put_Percent(!0),this._changedProps.get_PositionV().put_RelativeFrom(this._state.VPositionPcFrom),this._state.spnYPcChanged||(e=this._originalProps.get_Value_Y(this._state.VPositionPcFrom),this.spnYPc.setValue(parseFloat((100*e/this.pageHeight).toFixed(2)),!0)),this._changedProps.get_PositionV().put_Value(this.spnYPc.getNumberValue()))},onRadioHAlignChange:function(t,e,i){this._changedProps&&(null!==this._changedProps.get_PositionH()&&void 0!==this._changedProps.get_PositionH()||this._changedProps.put_PositionH(new Asc.CImagePositionH),this._changedProps.get_PositionH().put_UseAlign(e),e&&(this._changedProps.get_PositionH().put_Percent(!1),this._changedProps.get_PositionH().put_Align(this._state.HAlignType),this._changedProps.get_PositionH().put_RelativeFrom(this._state.HAlignFrom))),e&&(this.cmbHAlign.setDisabled(!1),this.cmbHAlign.focus(),this.cmbHRelative.setDisabled(!1),this.spnX.setDisabled(!0),this.cmbHPosition.setDisabled(!0),this.spnXPc.setDisabled(!0),this.cmbHPositionPc.setDisabled(!0))},onRadioHPositionChange:function(t,e,i){this._changedProps&&(null!==this._changedProps.get_PositionH()&&void 0!==this._changedProps.get_PositionH()||this._changedProps.put_PositionH(new Asc.CImagePositionH),e&&(this._changedProps.get_PositionH().put_UseAlign(!1),this._changedProps.get_PositionH().put_Percent(!1),this._changedProps.get_PositionH().put_Value(Common.Utils.Metric.fnRecalcToMM(this.spnX.getNumberValue())),this._changedProps.get_PositionH().put_RelativeFrom(this._state.HPositionFrom))),e&&(this.cmbHAlign.setDisabled(!0),this.cmbHRelative.setDisabled(!0),this.spnX.setDisabled(!1),this.spnX.focus(),this.cmbHPosition.setDisabled(!1),this.spnXPc.setDisabled(!0),this.cmbHPositionPc.setDisabled(!0))},onRadioHPositionPcChange:function(t,e,i){this._changedProps&&(null!==this._changedProps.get_PositionH()&&void 0!==this._changedProps.get_PositionH()||this._changedProps.put_PositionH(new Asc.CImagePositionH),this._changedProps.get_PositionH().put_Percent(e),e&&(this._changedProps.get_PositionH().put_UseAlign(!1),this._changedProps.get_PositionH().put_Value(this.spnXPc.getNumberValue()),this._changedProps.get_PositionH().put_RelativeFrom(this._state.HPositionPcFrom))),e&&(this.cmbHAlign.setDisabled(!0),this.cmbHRelative.setDisabled(!0),this.spnX.setDisabled(!0),this.cmbHPosition.setDisabled(!0),this.spnXPc.setDisabled(!1),this.spnXPc.focus(),this.cmbHPositionPc.setDisabled(!1))},onRadioVAlignChange:function(t,e,i){this._changedProps&&(null!==this._changedProps.get_PositionV()&&void 0!==this._changedProps.get_PositionV()||this._changedProps.put_PositionV(new Asc.CImagePositionV),this._changedProps.get_PositionV().put_UseAlign(e),e&&(this._changedProps.get_PositionV().put_Percent(!1),this._changedProps.get_PositionV().put_Align(this._state.VAlignType),this._changedProps.get_PositionV().put_RelativeFrom(this._state.VAlignFrom))),e&&(this.cmbVAlign.setDisabled(!1),this.cmbVAlign.focus(),this.cmbVRelative.setDisabled(!1),this.spnY.setDisabled(!0),this.cmbVPosition.setDisabled(!0),this.chMove.setValue(this._state.VAlignFrom==Asc.c_oAscRelativeFromV.Line||this._state.VAlignFrom==Asc.c_oAscRelativeFromV.Paragraph,!0),this.chMove.setDisabled(!1),this.spnYPc.setDisabled(!0),this.cmbVPositionPc.setDisabled(!0))},onRadioVPositionChange:function(t,e,i){this._changedProps&&(null!==this._changedProps.get_PositionV()&&void 0!==this._changedProps.get_PositionV()||this._changedProps.put_PositionV(new Asc.CImagePositionV),e&&(this._changedProps.get_PositionV().put_UseAlign(!1),this._changedProps.get_PositionV().put_Percent(!1),this._changedProps.get_PositionV().put_Value(Common.Utils.Metric.fnRecalcToMM(this.spnY.getNumberValue())),this._changedProps.get_PositionV().put_RelativeFrom(this._state.VPositionFrom))),e&&(this.cmbVAlign.setDisabled(!0),this.cmbVRelative.setDisabled(!0),this.spnY.setDisabled(!1),this.spnY.focus(),this.cmbVPosition.setDisabled(!1),this.chMove.setValue(this._state.VPositionFrom==Asc.c_oAscRelativeFromV.Line||this._state.VPositionFrom==Asc.c_oAscRelativeFromV.Paragraph,!0),this.chMove.setDisabled(!1),this.spnYPc.setDisabled(!0),this.cmbVPositionPc.setDisabled(!0))},onRadioVPositionPcChange:function(t,e,i){this._changedProps&&(null!==this._changedProps.get_PositionV()&&void 0!==this._changedProps.get_PositionV()||this._changedProps.put_PositionV(new Asc.CImagePositionV),this._changedProps.get_PositionV().put_Percent(e),e&&(this._changedProps.get_PositionV().put_UseAlign(!1),this._changedProps.get_PositionV().put_Value(this.spnYPc.getNumberValue()),this._changedProps.get_PositionV().put_RelativeFrom(this._state.VPositionPcFrom))),e&&(this.cmbVAlign.setDisabled(!0),this.cmbVRelative.setDisabled(!0),this.spnY.setDisabled(!0),this.cmbVPosition.setDisabled(!0),this.chMove.setValue(!1,!0),this.chMove.setDisabled(!0),this.spnYPc.setDisabled(!1),this.spnYPc.focus(),this.cmbVPositionPc.setDisabled(!1))},onRadioHSizeChange:function(t,e,i){e&&(this._changedProps&&(this._changedProps.put_Width(Common.Utils.Metric.fnRecalcToMM(this.spnShapeWidth.getNumberValue())),this._changedProps.put_SizeRelH(void 0),this.fillShapeHeight()),this.chRatio.setDisabled(this.radioVSizePc.getValue()),this.cmbWidthPc.setDisabled(!0),this.spnShapeWidthPc.setDisabled(!0),this.spnShapeWidth.setDisabled(!1),this.spnShapeWidth.focus())},onRadioHSizePcChange:function(t,e,i){e&&(this._changedProps&&(null!==this._changedProps.get_SizeRelH()&&void 0!==this._changedProps.get_SizeRelH()||this._changedProps.put_SizeRelH(new Asc.CImagePositionH),this._changedProps.get_SizeRelH().put_Value(this.spnShapeWidthPc.getNumberValue()),this._changedProps.get_SizeRelH().put_RelativeFrom(this._state.ShapeWidthPcFrom),this.fillShapeHeight()),this.chRatio.setDisabled(!0),this.cmbWidthPc.setDisabled(!1),this.spnShapeWidthPc.setDisabled(!1),this.spnShapeWidthPc.focus(),this.spnShapeWidth.setDisabled(!0))},onRadioVSizeChange:function(t,e,i){e&&(this._changedProps&&(this._changedProps.put_Height(Common.Utils.Metric.fnRecalcToMM(this.spnShapeHeight.getNumberValue())),this._changedProps.put_SizeRelV(void 0),this.fillShapeWidth()),this.chRatio.setDisabled(this.radioHSizePc.getValue()),this.cmbHeightPc.setDisabled(!0),this.spnShapeHeightPc.setDisabled(!0),this.spnShapeHeight.setDisabled(!1),this.spnShapeHeight.focus())},onRadioVSizePcChange:function(t,e,i){e&&(this._changedProps&&(null!==this._changedProps.get_SizeRelV()&&void 0!==this._changedProps.get_SizeRelV()||this._changedProps.put_SizeRelV(new Asc.CImagePositionV),this._changedProps.get_SizeRelV().put_Value(this.spnShapeHeightPc.getNumberValue()),this._changedProps.get_SizeRelV().put_RelativeFrom(this._state.ShapeHeightPcFrom),this.fillShapeWidth()),this.chRatio.setDisabled(!0),this.cmbHeightPc.setDisabled(!1),this.spnShapeHeightPc.setDisabled(!1),this.spnShapeHeightPc.focus(),this.spnShapeHeight.setDisabled(!0))},onCmbWidthPcSelect:function(t,e){this._changedProps&&(null!==this._changedProps.get_SizeRelH()&&void 0!==this._changedProps.get_SizeRelH()||this._changedProps.put_SizeRelH(new Asc.CImagePositionH),this._state.ShapeWidthPcFrom=e.value,this._changedProps.get_SizeRelH().put_Value(this.spnShapeWidthPc.getNumberValue()),this._changedProps.get_SizeRelH().put_RelativeFrom(this._state.ShapeWidthPcFrom),this.fillShapeHeight())},onCmbHeightPcSelect:function(t,e){this._changedProps&&(null!==this._changedProps.get_SizeRelV()&&void 0!==this._changedProps.get_SizeRelV()||this._changedProps.put_SizeRelV(new Asc.CImagePositionV),this._state.ShapeHeightPcFrom=e.value,this._changedProps.get_SizeRelV().put_Value(this.spnShapeHeightPc.getNumberValue()),this._changedProps.get_SizeRelV().put_RelativeFrom(this._state.ShapeHeightPcFrom),this.fillShapeWidth())},fillShapeWidth:function(t,e){this.radioHSize.getValue()?this._changedProps.put_Width(Common.Utils.Metric.fnRecalcToMM(this.spnShapeWidth.getNumberValue())):(null!==this._changedProps.get_SizeRelH()&&void 0!==this._changedProps.get_SizeRelH()||this._changedProps.put_SizeRelH(new Asc.CImagePositionH),this._changedProps.get_SizeRelH().put_Value(this.spnShapeWidthPc.getNumberValue()),this._changedProps.get_SizeRelH().put_RelativeFrom(this._state.ShapeWidthPcFrom))},fillShapeHeight:function(t,e){this.radioVSize.getValue()?this._changedProps.put_Height(Common.Utils.Metric.fnRecalcToMM(this.spnShapeHeight.getNumberValue())):(null!==this._changedProps.get_SizeRelV()&&void 0!==this._changedProps.get_SizeRelV()||this._changedProps.put_SizeRelV(new Asc.CImagePositionV),this._changedProps.get_SizeRelV().put_Value(this.spnShapeHeightPc.getNumberValue()),this._changedProps.get_SizeRelV().put_RelativeFrom(this._state.ShapeHeightPcFrom))},_updateSizeArr:function(t,e,i,n){0<i.get("value")?(e.store.each(function(t){t.set({typearrow:i.get("idsvg")})},this),t.setDisabled(!1),null!==n?(e.selectByIndex(n,!0),this._selectStyleItem(t,e.store.at(n))):this._selectStyleItem(t,null)):(this._selectStyleItem(t,null),t.setDisabled(!0))},_selectStyleItem:function(t,e){var i,n,t=$(t.el).find(".form-control > .img-arrows use");t.length&&(n="",e&&(n=void 0!==(i=e.get("idsvg"))?i+"arrow-5":e.get("typearrow")+"arrow-"+(e.get("value")+1)),t[0].setAttribute("xlink:href","#"+n))},onSelectBeginStyle:function(t,e,i,n){this._changedShapeProps&&(null===this._changedShapeProps.get_stroke()&&this._changedShapeProps.put_stroke(new Asc.asc_CStroke),this._changedShapeProps.get_stroke().put_linebeginstyle(i.get("type"))),null!==this._beginSizeIdx&&void 0!==this._beginSizeIdx||(this._beginSizeIdx=4),this._updateSizeArr(this.btnBeginSize,this.mnuBeginSizePicker,i,this._beginSizeIdx),this._selectStyleItem(this.btnBeginStyle,i)},onSelectBeginSize:function(t,e,i,n){this._changedShapeProps&&(null===this._changedShapeProps.get_stroke()&&this._changedShapeProps.put_stroke(new Asc.asc_CStroke),this._changedShapeProps.get_stroke().put_linebeginsize(i.get("type"))),this._beginSizeIdx=i.get("value"),this._selectStyleItem(this.btnBeginSize,i)},onSelectEndStyle:function(t,e,i,n){this._changedShapeProps&&(null===this._changedShapeProps.get_stroke()&&this._changedShapeProps.put_stroke(new Asc.asc_CStroke),this._changedShapeProps.get_stroke().put_lineendstyle(i.get("type"))),null!==this._endSizeIdx&&void 0!==this._endSizeIdx||(this._endSizeIdx=4),this._updateSizeArr(this.btnEndSize,this.mnuEndSizePicker,i,this._endSizeIdx),this._selectStyleItem(this.btnEndStyle,i)},onSelectEndSize:function(t,e,i,n){this._changedShapeProps&&(null===this._changedShapeProps.get_stroke()&&this._changedShapeProps.put_stroke(new Asc.asc_CStroke),this._changedShapeProps.get_stroke().put_lineendsize(i.get("type"))),this._endSizeIdx=i.get("value"),this._selectStyleItem(this.btnEndSize,i)}},DE.Views.ImageSettingsAdvanced||{}))}),define("documenteditor/main/app/view/ImageSettings",["text!documenteditor/main/app/template/ImageSettings.template","jquery","underscore","backbone","common/main/lib/component/Button","common/main/lib/view/ImageFromUrlDialog","documenteditor/main/app/view/ImageSettingsAdvanced"],function(t,i,n,e){"use strict";DE.Views.ImageSettings=e.View.extend(n.extend({el:"#id-image-settings",template:n.template(t),events:{},options:{alias:"ImageSettings"},initialize:function(){this._initSettings=!0,this._state={WrappingStyle:Asc.c_oAscWrapStyle2.Inline,CanBeFlow:!0,Width:0,Height:0,FromGroup:!1,DisabledControls:!1,isOleObject:!1,cropMode:!1,isPictureControl:!1},this.lockedControls=[],this._locked=!1,this._originalProps=null,this.render()},render:function(){var t=this.$el||i(this.el);t.html(this.template({scope:this})),this.labelWidth=t.find("#image-label-width"),this.labelHeight=t.find("#image-label-height")},setApi:function(t){return this.api=t,this.api&&(this.api.asc_registerCallback("asc_onImgWrapStyleChanged",n.bind(this._ImgWrapStyleChanged,this)),this.api.asc_registerCallback("asc_ChangeCropState",n.bind(this._changeCropState,this))),Common.NotificationCenter.on("storage:image-insert",n.bind(this.insertImageFromStorage,this)),this},setMode:function(t){this.mode=t},updateMetricUnit:function(){var t=Common.Utils.Metric.fnRecalcFromMM(this._state.Width);this.labelWidth[0].innerHTML=this.textWidth+": "+t.toFixed(2)+" "+Common.Utils.Metric.getCurrentMetricName(),t=Common.Utils.Metric.fnRecalcFromMM(this._state.Height),this.labelHeight[0].innerHTML=this.textHeight+": "+t.toFixed(2)+" "+Common.Utils.Metric.getCurrentMetricName()},createDelayedControls:function(){var t=this,e=[{icon:"btn-wrap-inline",data:Asc.c_oAscWrapStyle2.Inline,tip:this.txtInline,selected:!0},{icon:"btn-wrap-square",data:Asc.c_oAscWrapStyle2.Square,tip:this.txtSquare},{icon:"btn-wrap-tight",data:Asc.c_oAscWrapStyle2.Tight,tip:this.txtTight},{icon:"btn-wrap-through",data:Asc.c_oAscWrapStyle2.Through,tip:this.txtThrough},{icon:"btn-wrap-topbottom",data:Asc.c_oAscWrapStyle2.TopAndBottom,tip:this.txtTopAndBottom},{icon:"btn-wrap-infront",data:Asc.c_oAscWrapStyle2.InFront,tip:this.txtInFront},{icon:"btn-wrap-behind",data:Asc.c_oAscWrapStyle2.Behind,tip:this.txtBehind}],e=(this.cmbWrapType=new Common.UI.ComboDataView({itemWidth:50,itemHeight:50,menuMaxHeight:300,enableKeyEvents:!0,store:new Common.UI.DataViewStore(e),cls:"combo-chart-style",dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"-10, 0",delayRenderTips:!0,itemTemplate:n.template(['<div class="item-icon-box" id="<%= id %>" style="">','<img src="data:image/gif;base64,R0lGODlhAQABAID/AMDAwAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" class="combo-wrap-item options__icon options__icon-huge <%= icon %>"',"</div>"].join(""))}),this.cmbWrapType.render(i("#image-combo-wrap")),this.cmbWrapType.openButton.menu.cmpEl.css({"min-width":178,"max-width":178}),this.cmbWrapType.on("click",n.bind(this.onSelectWrap,this)),this.cmbWrapType.openButton.menu.on("show:after",function(){t.cmbWrapType.menuPicker.scroller.update({alwaysVisibleY:!0})}),this.lockedControls.push(this.cmbWrapType),this.btnOriginalSize=new Common.UI.Button({el:i("#image-button-original-size")}),this.lockedControls.push(this.btnOriginalSize),this.btnFitMargins=new Common.UI.Button({el:i("#image-button-fit-margins")}),this.lockedControls.push(this.btnFitMargins),Math.max(this.btnOriginalSize.cmpEl.width(),this.btnFitMargins.cmpEl.width())),e=(this.btnOriginalSize.cmpEl.width(e),this.btnFitMargins.cmpEl.width(e),this.btnEditObject=new Common.UI.Button({el:i("#image-button-edit-object")}),this.lockedControls.push(this.btnEditObject),this.btnOriginalSize.on("click",n.bind(this.setOriginalSize,this)),this.btnEditObject.on("click",n.bind(function(t){var e,i;this.api&&((e=this.api.asc_canEditTableOleObject(!0))?(i=DE.getController("Common.Controllers.ExternalOleEditor").getView("Common.Views.ExternalOleEditor"))&&(i.setEditMode(!0),i.show(),i.setOleData(Asc.asc_putBinaryDataToFrameFromTableOleObject(e))):this.api.asc_startEditCurrentOleObject()),this.fireEvent("editcomplete",this)},this)),this.btnFitMargins.on("click",n.bind(this.setFitMargins,this)),this.btnRotate270=new Common.UI.Button({parentEl:i("#image-button-270",t.$el),cls:"btn-toolbar",iconCls:"toolbar__icon btn-rotate-270",value:0,hint:this.textHint270,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.btnRotate270.on("click",n.bind(this.onBtnRotateClick,this)),this.lockedControls.push(this.btnRotate270),this.btnRotate90=new Common.UI.Button({parentEl:i("#image-button-90",t.$el),cls:"btn-toolbar",iconCls:"toolbar__icon btn-rotate-90",value:1,hint:this.textHint90,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.btnRotate90.on("click",n.bind(this.onBtnRotateClick,this)),this.lockedControls.push(this.btnRotate90),this.btnFlipV=new Common.UI.Button({parentEl:i("#image-button-flipv",t.$el),cls:"btn-toolbar",iconCls:"toolbar__icon btn-flip-vert",value:0,hint:this.textHintFlipV,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.btnFlipV.on("click",n.bind(this.onBtnFlipClick,this)),this.lockedControls.push(this.btnFlipV),this.btnFlipH=new Common.UI.Button({parentEl:i("#image-button-fliph",t.$el),cls:"btn-toolbar",iconCls:"toolbar__icon btn-flip-hor",value:1,hint:this.textHintFlipH,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.btnFlipH.on("click",n.bind(this.onBtnFlipClick,this)),this.lockedControls.push(this.btnFlipH),this.btnOriginalSize.cmpEl.outerWidth());this.btnCrop=new Common.UI.Button({parentEl:i("#image-button-crop"),cls:"btn-text-split-default",caption:this.textCrop,split:!0,enableToggle:!0,allowDepress:!0,pressed:this._state.cropMode,width:e,menu:new Common.UI.Menu({style:"min-width:"+e+"px;",items:[{caption:this.textCrop,checkable:!0,allowDepress:!0,checked:this._state.cropMode,value:0},{caption:this.textCropToShape,menu:new Common.UI.Menu({menuAlign:"tl-tl",cls:"menu-shapes menu-change-shape",items:[]})},{caption:this.textCropFill,value:1},{caption:this.textCropFit,value:2}]}),dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.btnCrop.on("click",n.bind(this.onCrop,this)),this.btnCrop.menu.on("item:click",n.bind(this.onCropMenu,this)),this.lockedControls.push(this.btnCrop),this.btnChangeShape=this.btnCrop.menu.items[1],this.btnSelectImage=new Common.UI.Button({parentEl:i("#image-button-replace"),cls:"btn-text-menu-default",caption:this.textInsert,style:"width:100%;",menu:new Common.UI.Menu({style:"min-width: 194px;",maxHeight:200,items:[{caption:this.textFromFile,value:0},{caption:this.textFromUrl,value:1},{caption:this.textFromStorage,value:2}]}),dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.lockedControls.push(this.btnSelectImage),this.btnSelectImage.menu.on("item:click",n.bind(this.onImageSelect,this)),this.btnSelectImage.menu.items[2].setVisible(this.mode.canRequestInsertImage||this.mode.fileChoiceUrl&&-1<this.mode.fileChoiceUrl.indexOf("{documentType}")),this.linkAdvanced=i("#image-advanced-link"),i(this.el).on("click","#image-advanced-link",n.bind(this.openAdvancedSettings,this))},_changeCropState:function(t){this._state.cropMode=t,this.btnCrop&&(this.btnCrop.toggle(t,!0),this.btnCrop.menu.items[0].setChecked(t,!0))},createDelayedElements:function(){this.createDelayedControls(),this.updateMetricUnit(),this.onApiAutoShapes(),this._initSettings=!1},onApiAutoShapes:function(){function e(t){i.fillAutoShapes(),t.off("show:before",e)}var i=this;i.btnChangeShape.menu.on("show:before",e)},fillAutoShapes:function(){var o=this,t=Common.localStorage.getItem("de-recent-shapes"),e=new Common.UI.MenuItem({template:n.template('<div id="id-img-change-shape-menu" class="menu-insertshape"></div>'),index:0});o.btnChangeShape.menu.addItem(e),new Common.UI.DataViewShape({el:i("#id-img-change-shape-menu"),itemTemplate:n.template('<div class="item-shape" id="<%= id %>"><svg width="20" height="20" class="icon uni-scale"><use xlink:href="#svg-icon-<%= data.shapeType %>"></use></svg></div>'),groups:o.application.getCollection("ShapeGroups"),parentMenu:o.btnChangeShape.menu,restoreHeight:652,textRecentlyUsed:o.textRecentlyUsed,recentShapes:t?JSON.parse(t):null,hideTextRect:!0,hideLines:!0}).on("item:click",function(t,e,i,n){o.api&&(o.api.ChangeShapeType(i.get("data").shapeType),o.fireEvent("editcomplete",o)),"click"!==n.type&&o.btnCrop.menu.hide()})},ChangeSettings:function(t){var e,i,n;this._initSettings&&this.createDelayedElements(),this.disableControls(this._locked),t&&(this._originalProps=new Asc.asc_CImgProperty(t),n=t.get_WrappingStyle(),this._state.WrappingStyle!==n&&(this.cmbWrapType.suspendEvents(),e=this.cmbWrapType.menuPicker.store.findWhere({data:n}),this.cmbWrapType.menuPicker.selectRecord(e),this.cmbWrapType.resumeEvents(),this._state.WrappingStyle=n),n=t.get_CanBeFlow()&&!this._locked,e=t.get_FromGroup()||this._locked,i=!!(i=this.api.asc_IsContentControl()?this.api.asc_GetContentControlProperties():null)&&i.get_SpecificType()==Asc.c_oAscContentControlSpecificType.Picture&&!i.get_FormPr()||this._locked,this.cmbWrapType.setDisabled(!n||e||i),this._state.CanBeFlow=n,this._state.FromGroup=e,this._state.isPictureControl=i,n=t.get_Width(),.001<Math.abs(this._state.Width-n)&&(this.labelWidth[0].innerHTML=this.textWidth+": "+Common.Utils.Metric.fnRecalcFromMM(n).toFixed(2)+" "+Common.Utils.Metric.getCurrentMetricName(),this._state.Width=n),n=t.get_Height(),.001<Math.abs(this._state.Height-n)&&(this.labelHeight[0].innerHTML=this.textHeight+": "+Common.Utils.Metric.fnRecalcFromMM(n).toFixed(2)+" "+Common.Utils.Metric.getCurrentMetricName(),this._state.Height=n),this.btnOriginalSize.setDisabled(null===t.get_ImageUrl()||void 0===t.get_ImageUrl()||this._locked),e=t.asc_getPluginGuid(),this._state.isOleObject!==(n=null!=e)&&(this.btnSelectImage.setVisible(!n),this.btnEditObject.setVisible(n),this._state.isOleObject=n),this.btnRotate270.setDisabled(n||this._locked),this.btnRotate90.setDisabled(n||this._locked),this.btnFlipV.setDisabled(n||this._locked),this.btnFlipH.setDisabled(n||this._locked),this._state.isOleObject?(i=DE.getCollection("Common.Collections.Plugins").findWhere({guid:e}),this.btnEditObject.setDisabled(!this.api.asc_canEditTableOleObject()&&null==i||this._locked)):this.btnSelectImage.setDisabled(null===e||this._locked))},_ImgWrapStyleChanged:function(t){var e;this.cmbWrapType&&this._state.WrappingStyle!==t&&(this.cmbWrapType.suspendEvents(),e=this.cmbWrapType.menuPicker.store.findWhere({data:t}),this.cmbWrapType.menuPicker.selectRecord(e),this.cmbWrapType.resumeEvents(),this._state.WrappingStyle=t)},onSelectWrap:function(t,e){var i;this.api&&(i=new Asc.asc_CImgProperty,e=e.get("data"),i.put_WrappingStyle(e),this._state.WrappingStyle===Asc.c_oAscWrapStyle2.Inline&&e!==Asc.c_oAscWrapStyle2.Inline&&(i.put_PositionH(new Asc.CImagePositionH),i.get_PositionH().put_UseAlign(!1),i.get_PositionH().put_RelativeFrom(Asc.c_oAscRelativeFromH.Column),e=this._originalProps.get_Value_X(Asc.c_oAscRelativeFromH.Column),i.get_PositionH().put_Value(e),i.put_PositionV(new Asc.CImagePositionV),i.get_PositionV().put_UseAlign(!1),i.get_PositionV().put_RelativeFrom(Asc.c_oAscRelativeFromV.Paragraph),e=this._originalProps.get_Value_Y(Asc.c_oAscRelativeFromV.Paragraph),i.get_PositionV().put_Value(e)),this.api.ImgApply(i)),this.fireEvent("editcomplete",this)},setOriginalSize:function(){var t,e,i;this.api&&(t=(e=this.api.get_OriginalSizeImage()).get_ImageWidth(),e=e.get_ImageHeight(),this.labelWidth[0].innerHTML=this.textWidth+": "+Common.Utils.Metric.fnRecalcFromMM(t).toFixed(2)+" "+Common.Utils.Metric.getCurrentMetricName(),this.labelHeight[0].innerHTML=this.textHeight+": "+Common.Utils.Metric.fnRecalcFromMM(e).toFixed(2)+" "+Common.Utils.Metric.getCurrentMetricName(),(i=new Asc.asc_CImgProperty).put_Width(t),i.put_Height(e),i.put_ResetCrop(!0),i.put_Rot(0),this.api.ImgApply(i),this.fireEvent("editcomplete",this))},setFitMargins:function(){var t,e,i,n,o,s,a;this.api&&(i=this.api.asc_GetSectionProps(),t=0<this._state.Height?this._state.Width/this._state.Height:1,(s=(e=this.api.asc_GetCurrentColumnWidth?this.api.asc_GetCurrentColumnWidth():i.get_W()-i.get_LeftMargin()-i.get_RightMargin())/(i=i.get_H()-i.get_TopMargin()-i.get_BottomMargin()))<t?o=(n=e)/t:t<s?n=(o=i)*t:(n=e,o=i),this.labelWidth[0].innerHTML=this.textWidth+": "+Common.Utils.Metric.fnRecalcFromMM(n).toFixed(2)+" "+Common.Utils.Metric.getCurrentMetricName(),this.labelHeight[0].innerHTML=this.textHeight+": "+Common.Utils.Metric.fnRecalcFromMM(o).toFixed(2)+" "+Common.Utils.Metric.getCurrentMetricName(),(s=new Asc.asc_CImgProperty).put_Width(n),s.put_Height(o),this._state.WrappingStyle!==Asc.c_oAscWrapStyle2.Inline&&(1<=t&&((a=new Asc.CImagePositionH).put_UseAlign(!0),a.put_Percent(!1),a.put_RelativeFrom(Asc.c_oAscRelativeFromH.Margin),a.put_Align(Asc.c_oAscAlignH.Left),s.put_PositionH(a)),t<=1&&((a=new Asc.CImagePositionV).put_UseAlign(!0),a.put_Percent(!1),a.put_RelativeFrom(Asc.c_oAscRelativeFromV.Margin),a.put_Align(Asc.c_oAscAlignV.Top),s.put_PositionV(a))),this.api.ImgApply(s),this.fireEvent("editcomplete",this))},setImageUrl:function(t,e){var i=new Asc.asc_CImgProperty;i.put_ImageUrl(t,e),this.api.ImgApply(i)},insertImageFromStorage:function(t){t&&t._urls&&"change"==t.c&&this.setImageUrl(t._urls[0],t.token)},onImageSelect:function(t,e){var i;1==e.value?(i=this,new Common.Views.ImageFromUrlDialog({handler:function(t,e){"ok"==t&&i.api&&(t=e.replace(/ /g,""),n.isEmpty(t)||i.setImageUrl(t)),i.fireEvent("editcomplete",i)}}).show()):2==e.value?Common.NotificationCenter.trigger("storage:image-load","change"):this._isFromFile||(this._isFromFile=!0,this.api&&this.api.ChangeImageFromFile(),this.fireEvent("editcomplete",this),this._isFromFile=!1)},onBtnRotateClick:function(t){var e=new Asc.asc_CImgProperty;e.asc_putRotAdd(3.14159265358979*(1==t.options.value?90:270)/180),this.api.ImgApply(e),this.fireEvent("editcomplete",this)},onBtnFlipClick:function(t){var e=new Asc.asc_CImgProperty;1==t.options.value?e.asc_putFlipHInvert(!0):e.asc_putFlipVInvert(!0),this.api.ImgApply(e),this.fireEvent("editcomplete",this)},onCrop:function(t,e){this.api&&(t.pressed?this.api.asc_startEditCrop():this.api.asc_endEditCrop()),this.fireEvent("editcomplete",this)},onCropMenu:function(t,e){this.api&&(1==e.value?this.api.asc_cropFill():2==e.value?this.api.asc_cropFit():e.checked?this.api.asc_startEditCrop():this.api.asc_endEditCrop()),this.fireEvent("editcomplete",this)},openAdvancedSettings:function(t){if(!this.linkAdvanced.hasClass("disabled")){var i=this;if(i.api&&!this._locked){var e=i.api.getSelectedElements();if(e&&0<e.length)for(var n,o,s,a=e.length-1;0<=a;a--)if(n=e[a].get_ObjectType(),o=e[a].get_ObjectValue(),Asc.c_oAscTypeSelectElement.Image==n){i.btnOriginalSize.isDisabled()||(s=(s=i.api.get_OriginalSizeImage())&&{width:s.get_ImageWidth(),height:s.get_ImageHeight()}),new DE.Views.ImageSettingsAdvanced({imageProps:o,sizeOriginal:s,api:i.api,sectionProps:i.api.asc_GetSectionProps(),handler:function(t,e){"ok"==t&&i.api&&i.api.ImgApply(e.imageProps),i.fireEvent("editcomplete",i)}}).show();break}}}},setLocked:function(t){this._locked=t},disableControls:function(e){this._initSettings||(this._state.DisabledControls!==e&&(this._state.DisabledControls=e,n.each(this.lockedControls,function(t){t.setDisabled(e)}),this.linkAdvanced.toggleClass("disabled",e)),this.btnCrop.setDisabled(e||!this.api.asc_canEditCrop()))}},DE.Views.ImageSettings||{}))}),define("text!documenteditor/main/app/template/ChartSettings.template",[],function(){return'<table cols="2">\n    <tr>\n        <td colspan=2>\n            <label class="header"><%= scope.textSize %></label>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" width="50%">\n            <label id="chart-label-width" class="input-label"><%= scope.textWidth %></label>\n        </td>\n        <td class="padding-small" width="50%">\n            <label id="chart-label-height" class="input-label"><%= scope.textHeight %></label>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" colspan=2>\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr>\n        <td colspan=2 class="padding-small">\n            <label class="header"><%= scope.textWrap %></label>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" colspan=2>\n            <div id="chart-combo-wrap" style="width: 100%;"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" colspan=2>\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr>\n        <td colspan=2>\n            <label class="header"><%= scope.textChartType %></label>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" colspan=2>\n            <div id="chart-button-type" style=""></div>\n        </td>\n    </tr>\n    <tr class="not-combined">\n        <td class="padding-small" colspan=2>\n            <div class="" id="chart-combo-style" style="width: 100%;"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" colspan=2>\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" colspan=2>\n            <button type="button" class="btn btn-text-default auto" id="chart-button-edit-data" style="min-width:115px;" data-hint="1" data-hint-direction="bottom" data-hint-offset="big"><%= scope.textEditData %></button>\n        </td>\n    </tr>\n</table>\n<table cols="1" id="chart-panel-3d-rotate">\n    <tr>\n        <td class="padding-small">\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <label class="header"><%= scope.text3dRotation %></label>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <label class="fixed" style="margin-top: 3px;width: 88px;"><%= scope.textX %></label>\n            <div id="chart-btn-x-right" style="display: inline-block;" class="float-right margin-left-4"></div>\n            <div id="chart-btn-x-left" style="display: inline-block;" class="float-right margin-left-4"></div>\n            <div id="chart-spin-x" style="display: inline-block;" class="float-right"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <label class="fixed" style="margin-top: 3px;width: 88px;"><%= scope.textY %></label>\n            <div id="chart-btn-y-down" style="display: inline-block;" class="float-right margin-left-4"></div>\n            <div id="chart-btn-y-up" style="display: inline-block;" class="float-right margin-left-4"></div>\n            <div id="chart-spin-y" style="display: inline-block" class="float-right"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <label class="fixed" style="margin-top: 3px;width: 88px;"><%= scope.textPerspective %></label>\n            <div id="chart-btn-widen" style="display: inline-block;" class="float-right margin-left-4"></div>\n            <div id="chart-btn-narrow" style="display: inline-block;" class="float-right margin-left-4"></div>\n            <div id="chart-spin-persp" style="display: inline-block;" class="float-right"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <div id="chart-checkbox-right-angle"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <div id="chart-checkbox-autoscale"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <label class="fixed" style="margin-top: 3px;width: 122px;"><%= scope.text3dDepth %></label>\n            <div id="chart-spin-3d-depth" style="display: inline-block;" class="float-right"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <label class="fixed" style="margin-top: 3px;width: 122px;"><%= scope.text3dHeight %></label>\n            <div id="chart-spin-3d-height" style="display: inline-block;" class="float-right"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <label class="link" id="chart-def-rotate-link" data-hint="1" data-hint-direction="bottom" data-hint-offset="medium"><%= scope.textDefault %></label>\n        </td>\n    </tr>\n</table>\n<table cols="2">\n    <tr>\n        <td class="padding-small" colspan=2>\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr>\n        <td align="center" colspan=2>\n            <label class="link" id="chart-advanced-link" data-hint="1" data-hint-direction="bottom" data-hint-offset="medium"><%= scope.textAdvanced %></label>\n        </td>\n    </tr>\n    <tr class="finish-cell"></tr>\n</table>'}),define("documenteditor/main/app/view/ChartSettings",["text!documenteditor/main/app/template/ChartSettings.template","jquery","underscore","backbone","common/main/lib/component/Button","common/main/lib/component/ComboDataView","documenteditor/main/app/view/ImageSettingsAdvanced"],function(t,o,s,e){"use strict";DE.Views.ChartSettings=e.View.extend(s.extend({el:"#id-chart-settings",template:s.template(t),events:{},options:{alias:"ChartSettings"},initialize:function(){this._initSettings=!0,this._state={WrappingStyle:Asc.c_oAscWrapStyle2.Inline,CanBeFlow:!0,Width:0,Height:0,FromGroup:!1,ChartStyle:1,ChartType:-1,SeveralCharts:!1,DisabledControls:!1},this.lockedControls=[],this._locked=!1,this._noApply=!1,this._originalProps=null,this.render()},render:function(){var t=this.$el||o(this.el);t.html(this.template({scope:this})),this.labelWidth=t.find("#chart-label-width"),this.labelHeight=t.find("#chart-label-height"),this.NotCombinedSettings=o(".not-combined"),this.Chart3DContainer=o("#chart-panel-3d-rotate")},setApi:function(t){return this.api=t,this.api&&(this.api.asc_registerCallback("asc_onImgWrapStyleChanged",s.bind(this._ChartWrapStyleChanged,this)),this.api.asc_registerCallback("asc_onUpdateChartStyles",s.bind(this._onUpdateChartStyles,this)),this.api.asc_registerCallback("asc_onAddChartStylesPreview",s.bind(this.onAddChartStylesPreview,this))),this},ChangeSettings:function(t){var e,i,n;this._initSettings&&this.createDelayedElements(),this.disableControls(this._locked),t&&t.get_ChartProperties()&&(this._originalProps=new Asc.asc_CImgProperty(t),this._noApply=!0,e=t.get_WrappingStyle(),this._state.WrappingStyle!==e&&(this.cmbWrapType.suspendEvents(),n=this.cmbWrapType.menuPicker.store.findWhere({data:e}),this.cmbWrapType.menuPicker.selectRecord(n),this.cmbWrapType.resumeEvents(),this._state.WrappingStyle=e),this.chartProps=t.get_ChartProperties(),e=t.get_SeveralCharts()||this._locked,this.btnEditData.setDisabled(e),this._state.SeveralCharts=e,e=t.get_SeveralChartTypes(),this._state.SeveralCharts&&e?(this.btnChartType.setIconCls("svgicon"),this._state.ChartType=null):(i=this.chartProps.getType(),this._state.ChartType!==i&&(n=this.mnuChartTypePicker.store.findWhere({type:i}),this.mnuChartTypePicker.selectRecord(n,!0),n?this.btnChartType.setIconCls("svgicon chart-"+n.get("iconCls")):this.btnChartType.setIconCls("svgicon"),this.ShowCombinedProps(i),null!==i&&i!=Asc.c_oAscChartTypeSettings.comboBarLine&&i!=Asc.c_oAscChartTypeSettings.comboBarLineSecondary&&i!=Asc.c_oAscChartTypeSettings.comboAreaBar&&i!=Asc.c_oAscChartTypeSettings.comboCustom&&this.updateChartStyles(this.api.asc_getChartPreviews(i,void 0,!0)),this._state.ChartType=i)),i!=Asc.c_oAscChartTypeSettings.comboBarLine&&i!=Asc.c_oAscChartTypeSettings.comboBarLineSecondary&&i!=Asc.c_oAscChartTypeSettings.comboAreaBar&&i!=Asc.c_oAscChartTypeSettings.comboCustom&&(e=t.get_SeveralChartStyles(),this._state.SeveralCharts&&e?(this.cmbChartStyle.fieldPicker.deselectAll(),this.cmbChartStyle.menuPicker.deselectAll(),this._state.ChartStyle=null):(e=this.chartProps.getStyle(),this._state.ChartStyle===e&&!this._isChartStylesChanged||(this._state.ChartStyle=e,n=this.selectCurrentChartStyle(),this._isChartStylesChanged&&this.api.asc_generateChartPreviews(this._state.ChartType,n))),this._isChartStylesChanged=!1),this._noApply=!1,e=t.get_CanBeFlow()&&!this._locked,i=t.get_FromGroup()||this._locked,this.cmbWrapType.setDisabled(!e||i),this._state.CanBeFlow=e,this._state.FromGroup=i,e=t.get_Width(),.001<Math.abs(this._state.Width-e)&&(this.labelWidth[0].innerHTML=this.textWidth+": "+Common.Utils.Metric.fnRecalcFromMM(e).toFixed(1)+" "+Common.Utils.Metric.getCurrentMetricName(),this._state.Width=e),e=t.get_Height(),.001<Math.abs(this._state.Height-e)&&(this.labelHeight[0].innerHTML=this.textHeight+": "+Common.Utils.Metric.fnRecalcFromMM(e).toFixed(1)+" "+Common.Utils.Metric.getCurrentMetricName(),this._state.Height=e),n=this.chartProps?this.chartProps.getView3d():null,this.ShowHideElem(!!n),n&&(e=n.asc_getRotX(),((void 0===this._state.X||void 0===e)&&this._state.X!==e||.001<Math.abs(this._state.X-e))&&(this.spnX.setValue(null!=e?e:"",!0),this._state.X=e),e=n.asc_getRotY(),((void 0===this._state.Y||void 0===e)&&this._state.Y!==e||.001<Math.abs(this._state.Y-e))&&(this.spnY.setValue(null!=e?e:"",!0),this._state.Y=e),e=n.asc_getRightAngleAxes(),this._state.RightAngle!==e&&(this.chRightAngle.setValue(null!=e?e:"indeterminate",!0),this._state.RightAngle=e),e=n.asc_getPerspective(),((void 0===this._state.Perspective||void 0===e)&&this._state.Perspective!==e||.001<Math.abs(this._state.Perspective-e))&&(this.spnPerspective.setMinValue(null!=e?.1:0),this.spnPerspective.setValue(null!=e?e:0,!0),this._state.Perspective=e),this.spnPerspective.setDisabled(this._locked||!!this._state.RightAngle),this.btnNarrow.setDisabled(this._locked||!!this._state.RightAngle),this.btnWiden.setDisabled(this._locked||!!this._state.RightAngle),e=n.asc_getDepth(),(.001<Math.abs(this._state.Depth-e)||(void 0===this._state.Depth||void 0===e)&&this._state.Depth!==e)&&(this.spn3DDepth.setValue(null!=e?e:"",!0),this._state.Depth=e),e=n.asc_getHeight(),(.001<Math.abs(this._state.Height3d-e)||(void 0===this._state.Height3d||null===this._state.Height3d||null===e)&&this._state.Height3d!==e)&&(null!==e&&this.spn3DHeight.setValue(e,!0),this.chAutoscale.setValue(null===e,!0),this._state.Height3d=e),this.spn3DHeight.setDisabled(this._locked||null===e)))},updateMetricUnit:function(){var t=Common.Utils.Metric.fnRecalcFromMM(this._state.Width);this.labelWidth[0].innerHTML=this.textWidth+": "+t.toFixed(1)+" "+Common.Utils.Metric.getCurrentMetricName(),t=Common.Utils.Metric.fnRecalcFromMM(this._state.Height),this.labelHeight[0].innerHTML=this.textHeight+": "+t.toFixed(1)+" "+Common.Utils.Metric.getCurrentMetricName()},createDelayedControls:function(){var e=this,t=[{icon:"btn-wrap-inline",data:Asc.c_oAscWrapStyle2.Inline,tip:this.txtInline,selected:!0},{icon:"btn-wrap-square",data:Asc.c_oAscWrapStyle2.Square,tip:this.txtSquare},{icon:"btn-wrap-tight",data:Asc.c_oAscWrapStyle2.Tight,tip:this.txtTight},{icon:"btn-wrap-through",data:Asc.c_oAscWrapStyle2.Through,tip:this.txtThrough},{icon:"btn-wrap-topbottom",data:Asc.c_oAscWrapStyle2.TopAndBottom,tip:this.txtTopAndBottom},{icon:"btn-wrap-infront",data:Asc.c_oAscWrapStyle2.InFront,tip:this.txtInFront},{icon:"btn-wrap-behind",data:Asc.c_oAscWrapStyle2.Behind,tip:this.txtBehind}];this.cmbWrapType=new Common.UI.ComboDataView({itemWidth:50,itemHeight:50,menuMaxHeight:300,enableKeyEvents:!0,store:new Common.UI.DataViewStore(t),cls:"combo-chart-style",dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big",delayRenderTips:!0,itemTemplate:s.template(['<div class="item-icon-box" id="<%= id %>">','<img src="data:image/gif;base64,R0lGODlhAQABAID/AMDAwAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" class="combo-wrap-item options__icon options__icon-huge <%= icon %>" ',"</div>"].join(""))}),this.cmbWrapType.render(o("#chart-combo-wrap")),this.cmbWrapType.openButton.menu.cmpEl.css({"min-width":178,"max-width":178}),this.cmbWrapType.on("click",s.bind(this.onSelectWrap,this)),this.cmbWrapType.openButton.menu.on("show:after",function(){e.cmbWrapType.menuPicker.scroller.update({alwaysVisibleY:!0})}),this.lockedControls.push(this.cmbWrapType),this.btnChartType=new Common.UI.Button({cls:"btn-large-dataview",iconCls:"svgicon chart-column-normal",menu:new Common.UI.Menu({style:"width: 364px;",items:[{template:s.template('<div id="id-chart-menu-type" class="menu-insertchart" ></div>')}]}),dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.btnChartType.on("render:after",function(t){e.mnuChartTypePicker=new Common.UI.DataView({el:o("#id-chart-menu-type"),parentMenu:t.menu,restoreHeight:535,groups:new Common.UI.DataViewGroupStore(Common.define.chartData.getChartGroupData()),store:new Common.UI.DataViewStore(Common.define.chartData.getChartData()),itemTemplate:s.template('<div id="<%= id %>" class="item-chartlist"><svg width="40" height="40" class="icon uni-scale"><use xlink:href="#chart-<%= iconCls %>"></use></svg></div>'),delayRenderTips:!0,delaySelect:Common.Utils.isSafari})}),this.btnChartType.render(o("#chart-button-type")),this.mnuChartTypePicker.on("item:click",s.bind(this.onSelectType,this,this.btnChartType)),this.lockedControls.push(this.btnChartType),this.btnEditData=new Common.UI.Button({el:o("#chart-button-edit-data")}),this.lockedControls.push(this.btnEditData),this.btnEditData.on("click",s.bind(this.setEditData,this)),this.spnX=new Common.UI.MetricSpinner({el:o("#chart-spin-x"),step:10,width:57,defaultUnit:"°",value:"20 °",maxValue:359.9,minValue:0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.lockedControls.push(this.spnX),this.spnX.on("change",s.bind(this.onXRotation,this)),this.spnX.on("inputleave",function(){e.fireEvent("editcomplete",e)}),this.btnLeft=new Common.UI.Button({parentEl:o("#chart-btn-x-left",e.$el),cls:"btn-toolbar",iconCls:"toolbar__icon btn-rotate-270",hint:this.textLeft,dataHint:"1",dataHintDirection:"top"}),this.lockedControls.push(this.btnLeft),this.btnLeft.on("click",s.bind(function(){this.spnX.setValue(10*Math.ceil((this.spnX.getNumberValue()-10)/10))},this)),this.btnRight=new Common.UI.Button({parentEl:o("#chart-btn-x-right",e.$el),cls:"btn-toolbar",iconCls:"toolbar__icon btn-rotate-90",hint:this.textRight,dataHint:"1",dataHintDirection:"top"}),this.lockedControls.push(this.btnRight),this.btnRight.on("click",s.bind(function(){this.spnX.setValue(10*Math.floor((this.spnX.getNumberValue()+10)/10))},this)),this.spnY=new Common.UI.MetricSpinner({el:o("#chart-spin-y"),step:10,width:57,defaultUnit:"°",value:"15 °",maxValue:90,minValue:-90,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.lockedControls.push(this.spnY),this.spnY.on("change",s.bind(this.onYRotation,this)),this.spnY.on("inputleave",function(){e.fireEvent("editcomplete",e)}),this.btnUp=new Common.UI.Button({parentEl:o("#chart-btn-y-up",e.$el),cls:"btn-toolbar",iconCls:"toolbar__icon btn-rotate-y-clockwise",hint:this.textUp,dataHint:"1",dataHintDirection:"top"}),this.lockedControls.push(this.btnUp),this.btnUp.on("click",s.bind(function(){this.spnY.setValue(10*Math.ceil((this.spnY.getNumberValue()-10)/10))},this)),this.btnDown=new Common.UI.Button({parentEl:o("#chart-btn-y-down",e.$el),cls:"btn-toolbar",iconCls:"toolbar__icon btn-rotate-y-counterclockwise",hint:this.textDown,dataHint:"1",dataHintDirection:"top"}),this.lockedControls.push(this.btnDown),this.btnDown.on("click",s.bind(function(){this.spnY.setValue(10*Math.floor((this.spnY.getNumberValue()+10)/10))},this)),this.spnPerspective=new Common.UI.MetricSpinner({el:o("#chart-spin-persp"),step:5,width:57,defaultUnit:"°",value:"0 °",maxValue:100,minValue:.1,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.lockedControls.push(this.spnPerspective),this.spnPerspective.on("change",s.bind(this.onPerspective,this)),this.spnPerspective.on("inputleave",function(){e.fireEvent("editcomplete",e)}),this.btnNarrow=new Common.UI.Button({parentEl:o("#chart-btn-narrow",e.$el),cls:"btn-toolbar",iconCls:"toolbar__icon btn-rotate-up",hint:this.textNarrow,dataHint:"1",dataHintDirection:"top"}),this.lockedControls.push(this.btnNarrow),this.btnNarrow.on("click",s.bind(function(){this.spnPerspective.setValue(5*Math.ceil((this.spnPerspective.getNumberValue()-5)/5))},this)),this.btnWiden=new Common.UI.Button({parentEl:o("#chart-btn-widen",e.$el),cls:"btn-toolbar",iconCls:"toolbar__icon btn-rotate-down",hint:this.textWiden,dataHint:"1",dataHintDirection:"top"}),this.lockedControls.push(this.btnWiden),this.btnWiden.on("click",s.bind(function(){this.spnPerspective.setValue(5*Math.floor((this.spnPerspective.getNumberValue()+5)/5))},this)),this.chRightAngle=new Common.UI.CheckBox({el:o("#chart-checkbox-right-angle"),labelText:this.textRightAngle}),this.lockedControls.push(this.chRightAngle),this.chRightAngle.on("change",s.bind(function(t,e,i,n){var o,s;this.api&&!this._noApply&&this.chartProps&&(o=new Asc.asc_CImgProperty,(s=this.chartProps.getView3d())&&(s.asc_setRightAngleAxes("checked"==t.getValue()),this.chartProps.putView3d(s),o.put_ChartProperties(this.chartProps),this.api.ImgApply(o)))},this)),this.chAutoscale=new Common.UI.CheckBox({el:o("#chart-checkbox-autoscale"),labelText:this.textAutoscale}),this.lockedControls.push(this.chAutoscale),this.chAutoscale.on("change",s.bind(function(t,e,i,n){var o,s;this.api&&this.chartProps&&(o=new Asc.asc_CImgProperty,(s=this.chartProps.getView3d())&&(s.asc_setHeight("checked"==t.getValue()?null:this.spn3DHeight.getNumberValue()),this.chartProps.putView3d(s),o.put_ChartProperties(this.chartProps),this.api.ImgApply(o)))},this)),this.spn3DDepth=new Common.UI.MetricSpinner({el:o("#chart-spin-3d-depth"),step:10,width:70,defaultUnit:"%",value:"0 %",maxValue:2e3,minValue:0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.lockedControls.push(this.spn3DDepth),this.spn3DDepth.on("change",s.bind(this.on3DDepth,this)),this.spn3DDepth.on("inputleave",function(){e.fireEvent("editcomplete",e)}),this.spn3DHeight=new Common.UI.MetricSpinner({el:o("#chart-spin-3d-height"),step:10,width:70,defaultUnit:"%",value:"50 %",maxValue:500,minValue:5,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.lockedControls.push(this.spn3DHeight),this.spn3DHeight.on("change",s.bind(this.on3DHeight,this)),this.spn3DHeight.on("inputleave",function(){e.fireEvent("editcomplete",e)}),this.linkDefRotation=o("#chart-def-rotate-link"),o(this.el).on("click","#chart-def-rotate-link",s.bind(this.onDefRotation,this)),this.linkAdvanced=o("#chart-advanced-link"),o(this.el).on("click","#chart-advanced-link",s.bind(this.openAdvancedSettings,this))},createDelayedElements:function(){this.createDelayedControls(),this.updateMetricUnit(),this._initSettings=!1},_ChartWrapStyleChanged:function(t){var e;this.cmbWrapType&&this._state.WrappingStyle!==t&&(this.cmbWrapType.suspendEvents(),e=this.cmbWrapType.menuPicker.store.findWhere({data:t}),this.cmbWrapType.menuPicker.selectRecord(e),this.cmbWrapType.resumeEvents(),this._state.WrappingStyle=t)},onSelectWrap:function(t,e){var i;this.api&&(i=new Asc.asc_CImgProperty,e=e.get("data"),i.put_WrappingStyle(e),this._state.WrappingStyle===Asc.c_oAscWrapStyle2.Inline&&e!==Asc.c_oAscWrapStyle2.Inline&&(i.put_PositionH(new Asc.CImagePositionH),i.get_PositionH().put_UseAlign(!1),i.get_PositionH().put_RelativeFrom(Asc.c_oAscRelativeFromH.Column),e=this._originalProps.get_Value_X(Asc.c_oAscRelativeFromH.Column),i.get_PositionH().put_Value(e),i.put_PositionV(new Asc.CImagePositionV),i.get_PositionV().put_UseAlign(!1),i.get_PositionV().put_RelativeFrom(Asc.c_oAscRelativeFromV.Paragraph),e=this._originalProps.get_Value_Y(Asc.c_oAscRelativeFromV.Paragraph),i.get_PositionV().put_Value(e)),this.api.ImgApply(i)),this.fireEvent("editcomplete",this)},setEditData:function(){var t,e=DE.getController("Common.Controllers.ExternalDiagramEditor").getView("Common.Views.ExternalDiagramEditor");e&&(e.setEditMode(!0),e.show(),(t=this.api.asc_getChartObject())&&e.setChartData(new Asc.asc_CChartBinary(t)))},openAdvancedSettings:function(t){if(!this.linkAdvanced.hasClass("disabled")){var i=this;if(i.api&&!this._locked){var e=i.api.getSelectedElements();if(e&&0<e.length)for(var n,o,s=e.length-1;0<=s;s--)if(n=e[s].get_ObjectType(),o=e[s].get_ObjectValue(),Asc.c_oAscTypeSelectElement.Image==n){new DE.Views.ImageSettingsAdvanced({imageProps:o,sectionProps:i.api.asc_GetSectionProps(),handler:function(t,e){"ok"==t&&i.api&&i.api.ImgApply(e.imageProps),i.fireEvent("editcomplete",i)}}).show();break}}}},onSelectType:function(t,e,i,n){if(!this._noApply){var o={};if(s.isFunction(n.toJSON)){if(!n.get("selected"))return;o=n.toJSON()}else o=n;this.api&&!this._noApply&&this.chartProps&&((o.type==Asc.c_oAscChartTypeSettings.comboBarLine||o.type==Asc.c_oAscChartTypeSettings.comboBarLineSecondary||o.type==Asc.c_oAscChartTypeSettings.comboAreaBar||o.type==Asc.c_oAscChartTypeSettings.comboCustom)&&this.chartProps.getSeries().length<2?(Common.NotificationCenter.trigger("showerror",Asc.c_oAscError.ID.ComboSeriesError,Asc.c_oAscError.Level.NoCritical),this.mnuChartTypePicker.selectRecord(this.mnuChartTypePicker.store.findWhere({type:this.chartProps.getType()}),!0)):(this.btnChartType.setIconCls("svgicon chart-"+o.iconCls),this._state.ChartType=-1,this.chartProps.changeType(o.type))),this.fireEvent("editcomplete",this)}},onSelectStyle:function(t,e){var i;this._noApply||(this.api&&!this._noApply&&this.chartProps&&(i=new Asc.asc_CImgProperty,this.chartProps.putStyle(e.get("data")),i.put_ChartProperties(this.chartProps),this.api.ImgApply(i)),this.fireEvent("editcomplete",this))},selectCurrentChartStyle:function(){if(this.cmbChartStyle){this.cmbChartStyle.suspendEvents();var t=this.cmbChartStyle.menuPicker.store.findWhere({data:this._state.ChartStyle});if(this.cmbChartStyle.menuPicker.selectRecord(t),this.cmbChartStyle.resumeEvents(),this._isChartStylesChanged){var i,t=t?this.cmbChartStyle.fillComboView(this.cmbChartStyle.menuPicker.getSelectedRec(),!0):this.cmbChartStyle.fillComboView(this.cmbChartStyle.menuPicker.store.at(0),!0);if(t&&0<t.length)return i=[],s.each(t,function(t,e){i.push(t.get("data"))}),i}}},onAddChartStylesPreview:function(t){var n;!this.cmbChartStyle||t&&0<t.length&&((n=this.cmbChartStyle.menuPicker.store)&&s.each(t,function(t,e){var i=n.findWhere({data:t.asc_getName()});i&&i.set("imageUrl",t.asc_getImage())}))},_onUpdateChartStyles:function(){this.api&&null!==this._state.ChartType&&-1<this._state.ChartType&&this._state.ChartType!=Asc.c_oAscChartTypeSettings.comboBarLine&&this._state.ChartType!=Asc.c_oAscChartTypeSettings.comboBarLineSecondary&&this._state.ChartType!=Asc.c_oAscChartTypeSettings.comboAreaBar&&this._state.ChartType!=Asc.c_oAscChartTypeSettings.comboCustom&&(this.updateChartStyles(this.api.asc_getChartPreviews(this._state.ChartType,void 0,!0)),this.api.asc_generateChartPreviews(this._state.ChartType,this.selectCurrentChartStyle()))},updateChartStyles:function(t){var e,i,n=this;this._isChartStylesChanged=!0,this.cmbChartStyle||(this.cmbChartStyle=new Common.UI.ComboDataView({itemWidth:50,itemHeight:50,menuMaxHeight:270,enableKeyEvents:!0,cls:"combo-chart-style",dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big",delayRenderTips:!0}),this.cmbChartStyle.render(o("#chart-combo-style")),this.cmbChartStyle.openButton.menu.cmpEl.css({"min-width":178,"max-width":178}),this.cmbChartStyle.on("click",s.bind(this.onSelectStyle,this)),this.cmbChartStyle.openButton.menu.on("show:after",function(){n.cmbChartStyle.menuPicker.scroller.update({alwaysVisibleY:!0})}),this.lockedControls.push(this.cmbChartStyle)),t&&0<t.length?(e=this.cmbChartStyle.menuPicker.store)&&(i=[],s.each(t,function(t,e){i.push({imageUrl:t.asc_getImage(),data:t.asc_getName(),tip:n.textStyle+" "+t.asc_getName()})}),e.reset(i,{silent:!1})):(this.cmbChartStyle.menuPicker.store.reset(),this.cmbChartStyle.clearComboView()),this.cmbChartStyle.setDisabled(!t||t.length<1||this._locked)},ShowCombinedProps:function(t){this.NotCombinedSettings.toggleClass("settings-hidden",null===t||t==Asc.c_oAscChartTypeSettings.comboBarLine||t==Asc.c_oAscChartTypeSettings.comboBarLineSecondary||t==Asc.c_oAscChartTypeSettings.comboAreaBar||t==Asc.c_oAscChartTypeSettings.comboCustom)},ShowHideElem:function(t){this.Chart3DContainer.toggleClass("settings-hidden",!t)},onXRotation:function(t,e,i,n){var o,s;this._noApply||this.chartProps&&(o=new Asc.asc_CImgProperty,(s=this.chartProps.getView3d())&&(s.asc_setRotX(t.getNumberValue()),this.chartProps.putView3d(s),o.put_ChartProperties(this.chartProps),this.api.ImgApply(o)))},onYRotation:function(t,e,i,n){var o,s;this._noApply||this.chartProps&&(o=new Asc.asc_CImgProperty,(s=this.chartProps.getView3d())&&(s.asc_setRotY(t.getNumberValue()),this.chartProps.putView3d(s),o.put_ChartProperties(this.chartProps),this.api.ImgApply(o)))},onPerspective:function(t,e,i,n){var o,s;this._noApply||this.chartProps&&(o=new Asc.asc_CImgProperty,(s=this.chartProps.getView3d())&&(s.asc_setPerspective(t.getNumberValue()),this.chartProps.putView3d(s),o.put_ChartProperties(this.chartProps),this.api.ImgApply(o)))},on3DDepth:function(t,e,i,n){var o,s;this._noApply||this.chartProps&&(o=new Asc.asc_CImgProperty,(s=this.chartProps.getView3d())&&(s.asc_setDepth(t.getNumberValue()),this.chartProps.putView3d(s),o.put_ChartProperties(this.chartProps),this.api.ImgApply(o)))},on3DHeight:function(t,e,i,n){var o,s;this._noApply||this.chartProps&&(o=new Asc.asc_CImgProperty,(s=this.chartProps.getView3d())&&(s.asc_setHeight(t.getNumberValue()),this.chartProps.putView3d(s),o.put_ChartProperties(this.chartProps),this.api.ImgApply(o)))},onDefRotation:function(){var t,e;this._noApply||this.chartProps&&(t=new Asc.asc_CImgProperty,(e=this.chartProps.getView3d())&&(e.asc_setRotX(20),e.asc_setRotY(15),this.chartProps.putView3d(e),t.put_ChartProperties(this.chartProps),this.api.ImgApply(t)))},setLocked:function(t){this._locked=t},disableControls:function(e){this._initSettings||this._state.DisabledControls!==e&&(this._state.DisabledControls=e,s.each(this.lockedControls,function(t){t.setDisabled(e)}),this.linkAdvanced.toggleClass("disabled",e))}},DE.Views.ChartSettings||{}))}),define("text!documenteditor/main/app/template/TableSettings.template",[],function(){return'<table cols="2">\n    <tr>\n        <td width="50%">\n            <label class="header"><%= scope.textRows %></label>\n        </td>\n        <td width="50%">\n            <label class="header"><%= scope.textColumns %></label>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <div id="table-checkbox-header"></div>\n        </td>\n        <td class="padding-small">\n            <div id="table-checkbox-first"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <div id="table-checkbox-total"></div>\n        </td>\n        <td class="padding-small">\n            <div id="table-checkbox-last"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <div id="table-checkbox-banded"></div>\n        </td>\n        <td class="padding-small">\n            <div id="table-checkbox-col-banded"></div>\n        </td>\n    </tr>\n    <tr>\n        <td colspan=2>\n            <label class="header"><%= scope.textTemplate %></label>\n        </td>\n    </tr>\n    <tr>\n        <td colspan=2 class="padding-small">\n            <div class="" id="table-btn-template" style="width: 100%; height: 58px;"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" colspan=2>\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr>\n        <td colspan=2 class="padding-small">\n            <label class="header"><%= scope.textBorders %></label>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" colspan=2>\n            <div id="table-combo-border-size"></div>\n            <div class="table-color color-btn-wrap float-right">\n                <label class="input-label margin-right-5"><%= scope.textBorderColor %></label>\n                <div id="table-border-color-btn"></div>\n            </div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" colspan=2>\n            <label class="input-label"><%= scope.textSelectBorders %></label>\n        </td>\n    </tr>\n    <tr>\n        <td colspan=2 class="padding-small">\n            <div id="table-button-border-all" style="display: inline-block;"></div>\n            <div id="table-button-border-none" style="display: inline-block;"></div>\n            <div id="table-button-border-inner" style="display: inline-block;"></div>\n            <div id="table-button-border-outer" style="display: inline-block;"></div>\n        </td>\n    </tr>\n    <tr>\n        <td colspan=2 class="padding-small">\n            <div id="table-button-border-left" style="display: inline-block;"></div>\n            <div id="table-button-border-inner-vert" style="display: inline-block;"></div>\n            <div id="table-button-border-right" style="display: inline-block;"></div>\n            <div id="table-button-border-top" style="display: inline-block;"></div>\n            <div id="table-button-border-inner-hor" style="display: inline-block;"></div>\n            <div id="table-button-border-bottom" style="display: inline-block;"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" colspan=2 align="right">\n            <div class="color-btn-wrap">\n                <label class="input-label margin-right-5"><%= scope.textBackColor %></label>\n                <div id="table-back-color-btn" style="display: inline-block;"></div>\n            </div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" colspan=2>\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" colspan=2>\n            <div id="table-btn-edit" style="width:100%;"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" colspan=2>\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr>\n        <td colspan=2>\n            <label class="header"><%= scope.textCellSize %></label>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" colspan=2>\n            <label style="margin-top: 3px;"><%= scope.textHeight %></label>\n            <div id="table-btn-distrub-rows" class="float-right margin-left-4"></div>\n            <div id="table-spin-cell-height" class="float-right"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" colspan=2>\n            <label style="margin-top: 3px;"><%= scope.textWidth %></label>\n            <div id="table-btn-distrub-cols" class="float-right margin-left-4"></div>\n            <div id="table-spin-cell-width" class="float-right"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" colspan=2>\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" colspan=2>\n            <button type="button" class="btn btn-text-default" id="table-btn-add-formula" style="width:100%;" data-hint="1" data-hint-direction="bottom" data-hint-offset="big"><%= scope.textAddFormula %></button>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" colspan=2>\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" colspan=2>\n            <div id="table-checkbox-repeat-row"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" colspan=2>\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" colspan=2>\n            <div id="table-btn-convert-to-text" style="width:100%;"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" colspan=2>\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr>\n        <td align="center" colspan=2>\n            <label class="link" id="table-advanced-link" data-hint="1" data-hint-direction="bottom" data-hint-offset="medium"><%= scope.textAdvanced %></label>\n        </td>\n    </tr>\n    <tr class="finish-cell"></tr>\n</table>'}),void 0===Common&&(Common={}),define("common/main/lib/component/ComboBorderSize",["common/main/lib/component/ComboBox"],function(){"use strict";Common.UI.BordersModel=Backbone.Model.extend({defaults:function(){return{value:null,displayValue:null,pxValue:null,id:Common.UI.getId(),imgId:void 0}}}),Common.UI.BordersStore=Backbone.Collection.extend({model:Common.UI.BordersModel}),Common.UI.ComboBorderSize=Common.UI.ComboBox.extend(_.extend({template:_.template(['<div class="input-group combobox combo-border-size input-group-nr <%= cls %>" id="<%= id %>" style="<%= style %>">','<div class="form-control" style="<%= style %>" data-hint="<%= dataHint %>" data-hint-direction="<%= dataHintDirection %>" data-hint-offset="<%= dataHintOffset %>">','<i class="img-line"><svg><use xlink:href="#half-pt"></use></svg></i>','<span class="text"></span>',"</div>",'<div style="display: table-cell;"></div>','<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">','<span class="caret"></span>',"</button>",'<ul class="dropdown-menu <%= menuCls %>" style="<%= menuStyle %>" role="menu">',"<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%= item.value %>"><a tabindex="-1" type="menuitem">',"<span><%= item.displayValue %></span>","<% if(item.imgId!==undefined) { %>",'<span class="border-line">',"<svg>",'<use xlink:href="#<%= item.imgId %>"></use>',"</svg>","</span>","<% } %>","</a></li>","<% }); %>","</ul>","</div>"].join("")),initialize:function(t){var e=Common.Utils.Metric.getMetricName(Common.Utils.Metric.c_MetricUnits.pt),e=[{displayValue:"0.5 "+e,value:.5,pxValue:.5,imgId:"half-pt"},{displayValue:"1 "+e,value:1,pxValue:1,imgId:"one-pt"},{displayValue:"1.5 "+e,value:1.5,pxValue:2,imgId:"one-and-half-pt"},{displayValue:"2.25 "+e,value:2.25,pxValue:3,imgId:"two-and-quarter-pt"},{displayValue:"3 "+e,value:3,pxValue:4,imgId:"three-pt"},{displayValue:"4.5 "+e,value:4.5,pxValue:6,imgId:"four-and-half-pt"},{displayValue:"6 "+e,value:6,pxValue:8,imgId:"six-pt"}];!1!==t.allowNoBorders&&e.unshift({displayValue:this.txtNoBorders,value:0,pxValue:0}),Common.UI.ComboBox.prototype.initialize.call(this,_.extend({editable:!1,store:new Common.UI.BordersStore,data:e,menuStyle:"min-width: 160px;"},t))},render:function(t){return Common.UI.ComboBox.prototype.render.call(this,t),this._formControl=this.cmpEl.find(".form-control"),this},itemClicked:function(t){var e=$(t.currentTarget).parent();this._selectedItem=this.store.findWhere({id:e.attr("id")}),this._selectedItem&&($(".selected",$(this.el)).removeClass("selected"),e.addClass("selected"),this.updateFormControl(this._selectedItem),this.trigger("selected",this,_.extend({},this._selectedItem.toJSON()),t),t.preventDefault())},updateFormControl:function(t){var e=$(this.el).find(".form-control"),i=e.find("> .img-line"),n=e.find("> .text");0<t.get("value")?(0<(e=e.find("use")).length&&e[0].setAttribute("xlink:href","#"+t.get("imgId")),i.show(),n.hide()):(i.hide(),n.text(this.txtNoBorders).show())},setValue:function(e){this._selectedItem=null==e?void 0:_.find(this.store.models,function(t){if(e<t.attributes.value+.01&&e>t.attributes.value-.01)return!0}),$(".selected",$(this.el)).removeClass("selected"),this._selectedItem?(this.updateFormControl(this._selectedItem),$("#"+this._selectedItem.get("id"),$(this.el)).addClass("selected")):$(this.el).find(".form-control > .text").text("").show()},focus:function(){this._formControl&&this._formControl.focus()},txtNoBorders:"No Borders"},Common.UI.ComboBorderSize||{})),Common.UI.ComboBorderSizeEditable=Common.UI.ComboBox.extend(_.extend({template:_.template(['<span class="input-group combobox combo-border-size input-group-nr <%= cls %>" id="<%= id %>" style="<%= style %>">','<input type="text" class="form-control text" data-hint="<%= dataHint %>" data-hint-direction="<%= dataHintDirection %>" data-hint-offset="<%= dataHintOffset %>">','<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">','<span class="caret"></span>',"</button>",'<ul class="dropdown-menu <%= menuCls %>" style="<%= menuStyle %>" role="menu">',"<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%= item.value %>"><a tabindex="-1" type="menuitem">',"<% if (!isRTL) { %>","<span><%= item.displayValue %></span>","<% if (item.imgId!==undefined) { %>",'<span class="border-line">',"<svg>",'<use xlink:href="#<%= item.imgId %>"></use>',"</svg>","</span>","<% } %>","<% } else { %>","<% if (item.imgId!==undefined) { %>",'<span class="border-line">',"<svg>",'<use xlink:href="#<%= item.imgId %>"></use>',"</svg>","</span>","<% } %>","<span><%= item.displayValue %></span>","<% } %>","</a></li>","<% }); %>","</ul>","</span>"].join("")),initialize:function(t){this.txtNoBorders=t.txtNoBorders||this.txtNoBorders;var e=Common.Utils.Metric.getMetricName(Common.Utils.Metric.c_MetricUnits.pt),e=[{displayValue:"0.5 "+e,value:.5,pxValue:.5,imgId:"half-pt"},{displayValue:"1 "+e,value:1,pxValue:1,imgId:"one-pt"},{displayValue:"1.5 "+e,value:1.5,pxValue:2,imgId:"one-and-half-pt"},{displayValue:"2.25 "+e,value:2.25,pxValue:3,imgId:"two-and-quarter-pt"},{displayValue:"3 "+e,value:3,pxValue:4,imgId:"three-pt"},{displayValue:"4.5 "+e,value:4.5,pxValue:6,imgId:"four-and-half-pt"},{displayValue:"6 "+e,value:6,pxValue:8,imgId:"six-pt"}];!1!==t.allowNoBorders&&e.unshift({displayValue:this.txtNoBorders,value:0,pxValue:0}),Common.UI.ComboBox.prototype.initialize.call(this,_.extend({editable:!0,store:new Common.UI.BordersStore,data:e,menuStyle:"min-width: 160px;"},t))},render:function(t){return Common.UI.ComboBox.prototype.render.call(this,t),this},txtNoBorders:"No Borders"},Common.UI.ComboBorderSizeEditable||{})),Common.UI.ComboBorderType=Common.UI.ComboBorderSize.extend(_.extend({template:_.template(['<div class="input-group combobox combo-border-size combo-border-type input-group-nr <%= cls %>" id="<%= id %>" style="<%= style %>">','<div class="form-control" style="<%= style %>" data-hint="<%= dataHint %>" data-hint-direction="<%= dataHintDirection %>" data-hint-offset="<%= dataHintOffset %>">','<i class="img-line"><svg><use xlink:href="#solid"></use></svg></i>',"</div>",'<div style="display: table-cell;"></div>','<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">','<span class="caret"></span>',"</button>",'<ul class="dropdown-menu <%= menuCls %>" style="<%= menuStyle %>" role="menu">',"<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%= item.value %>"><a tabindex="-1" type="menuitem">',"<% if (item.imgId!==undefined) { %>","<span>",'<svg><use xlink:href="#<%= item.imgId %>"></use></svg>',"</span>","<% } %>","</a></li>","<% }); %>","</ul>","</div>"].join("")),initialize:function(t){Common.UI.ComboBorderSize.prototype.initialize.call(this,_.extend({store:new Common.UI.BordersStore,data:[{value:Asc.c_oDashType.solid,imgId:"solid"},{value:Asc.c_oDashType.sysDot,imgId:"dots"},{value:Asc.c_oDashType.sysDash,imgId:"dashes"},{value:Asc.c_oDashType.dash,imgId:"dashes-spaced"},{value:Asc.c_oDashType.dashDot,imgId:"dash-dot"},{value:Asc.c_oDashType.lgDash,imgId:"dashes-wide"},{value:Asc.c_oDashType.lgDashDot,imgId:"wide-dash-dot"},{value:Asc.c_oDashType.lgDashDotDot,imgId:"wide-dash-dot-dot"}]},t))},render:function(t){return Common.UI.ComboBorderSize.prototype.render.call(this,t),this},updateFormControl:function(t){var e,i;t?((e=$(this.el).find(".form-control > .img-line use")).length&&(i=(i=Math.ceil(t.get("pxValue")))||3,e[0].setAttribute("xlink:href","#"+t.get("imgId")),e.parent().css("height",i+"px")),$(this.el).find(".form-control > .img-line").show()):$(this.el).find(".form-control > .img-line").hide()},setValue:function(e){this._selectedItem=null==e?void 0:_.find(this.store.models,function(t){if(e<t.attributes.value+.01&&e>t.attributes.value-.01)return!0}),$(".selected",$(this.el)).removeClass("selected"),this.updateFormControl(this._selectedItem),this._selectedItem&&$("#"+this._selectedItem.get("id"),$(this.el)).addClass("selected")}},Common.UI.ComboBorderType||{})),Common.UI.ComboBoxColor=Common.UI.ComboBox.extend(_.extend({template:_.template(['<div class="input-group combobox combo-color combobox-color input-group-nr <%= cls %>" id="<%= id %>" style="<%= style %>">','<div class="form-control" style="<%= style %>">',"<div></div>","</div>",'<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">','<span class="caret"></span>',"</button>",'<ul class="dropdown-menu <%= menuCls %>" style="<%= menuStyle %>" role="menu">',"<% _.each(items, function(item) { %>","<% if (item.value==-1) { %>",'<li id="<%= item.id %>" data-value="<%= item.value %>"><a tabindex="-1" type="menuitem"><%= scope.getDisplayValue(item) %></a></li>',"<% } else { %>",'<li id="<%= item.id %>" data-value="<%= item.value %>">','<a tabindex="-1" type="menuitem"><div style="<%= item.styleStr %>"><%= scope.getDisplayValue(item) %></div></a>',"</li>","<% } %>","<% }); %>","</ul>","</div>"].join("")),itemClicked:function(t){var e=$(t.currentTarget).parent();this._selectedItem=this.store.findWhere({id:e.attr("id")}),this._selectedItem&&($(".selected",$(this.el)).removeClass("selected"),e.addClass("selected"),this.updateFormControl(this._selectedItem),this.trigger("selected",this,_.extend({},this._selectedItem.toJSON()),t),t.preventDefault())},updateFormControl:function(t){var e=$(this.el).find(".form-control > div");e[0].innerHTML=t.get("displayValue"),-1!=t.get("value")?e.css({"margin-top":"0"}):e.css({"margin-top":"1px"}),e.css(t.get("styleObj"))},setValue:function(t){var e;this._selectedItem=this.store.findWhere(((e={})[this.valueField]=t,e)),$(".selected",$(this.el)).removeClass("selected"),this._selectedItem?(this.updateFormControl(this._selectedItem),$("#"+this._selectedItem.get("id"),$(this.el)).addClass("selected")):((e=$(this.el).find(".form-control > div"))[0].innerHTML=t,e.css("margin-top","1px"),e.css({color:"","text-align":"",background:"",border:""}))},onResetItems:function(){this.itemsTemplate?$(this.el).find("ul").html($(this.itemsTemplate({items:this.store.toJSON(),scope:this}))):$(this.el).find("ul").html(_.template(["<% _.each(items, function(item) { %>","<% if (item.value==-1) { %>",'<li id="<%= item.id %>" data-value="<%= item.value %>"><a tabindex="-1" type="menuitem"><%= scope.getDisplayValue(item) %></a></li>',"<% } else { %>",'<li id="<%= item.id %>" data-value="<%= item.value %>">','<a tabindex="-1" type="menuitem""><div style="<%= item.styleStr %>"><%= scope.getDisplayValue(item) %></div></a>',"</li>","<% } %>","<% }); %>"].join(""))({items:this.store.toJSON(),scope:this})),_.isUndefined(this.scroller)||(this.scroller.destroy(),delete this.scroller),this.scroller=new Common.UI.Scroller(_.extend({el:$(".dropdown-menu",this.cmpEl),minScrollbarLength:40,includePadding:!0,wheelSpeed:10,alwaysVisibleY:this.scrollAlwaysVisible},this.options.scroller))}},Common.UI.ComboBoxColor||{})),Common.UI.ComboBoxIcons=Common.UI.ComboBox.extend(_.extend({template:_.template(['<div class="input-group combobox combobox-icons combo-color input-group-nr <%= cls %>" id="<%= id %>" style="<%= style %>">','<div class="form-control" style="<%= style %>">',"<div></div>","</div>",'<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">','<span class="caret"></span>',"</button>",'<ul class="dropdown-menu <%= menuCls %>" style="<%= menuStyle %>" role="menu">',"<% _.each(items, function(item) { %>","<% if (item.value==-1) { %>",'<li id="<%= item.id %>" data-value="<%= item.value %>"><a tabindex="-1" type="menuitem"><%= scope.getDisplayValue(item) %></a></li>',"<% } else { %>",'<li id="<%= item.id %>" data-value="<%= item.value %>">','<a tabindex="-1" type="menuitem">',"<% _.each(item.data.iconSet, function(icon) { %>","<img src=\"<%= item.data.icons.at(icon-1).get('icon') %>\">","<% }) %>","</a>","</li>","<% } %>","<% }); %>","</ul>","</div>"].join("")),itemClicked:function(t){var e=$(t.currentTarget).parent();this._selectedItem=this.store.findWhere({id:e.attr("id")}),this._selectedItem&&($(".selected",$(this.el)).removeClass("selected"),e.addClass("selected"),this.updateFormControl(this._selectedItem),this.trigger("selected",this,_.extend({},this._selectedItem.toJSON()),t),t.preventDefault())},updateFormControl:function(e){var i,t=$(this.el).find(".form-control > div");-1!=e.get("value")?(i="",_.each(e.get("data").iconSet,function(t){i+='<img src="'+e.get("data").icons.at(t-1).get("icon")+'">'}),t[0].innerHTML=i,t.css({"margin-top":"0"})):(t[0].innerHTML=e.get("displayValue"),t.css({"margin-top":"1px"}))},setValue:function(t){var e;this._selectedItem=this.store.findWhere(((e={})[this.valueField]=t,e)),$(".selected",$(this.el)).removeClass("selected"),this._selectedItem?(this.updateFormControl(this._selectedItem),$("#"+this._selectedItem.get("id"),$(this.el)).addClass("selected")):((e=$(this.el).find(".form-control > div"))[0].innerHTML=t,e.css({"margin-top":"1px"}))},onResetItems:function(){this.itemsTemplate?$(this.el).find("ul").html($(this.itemsTemplate({items:this.store.toJSON(),scope:this}))):$(this.el).find("ul").html(_.template(["<% _.each(items, function(item) { %>","<% if (item.value==-1) { %>",'<li id="<%= item.id %>" data-value="<%= item.value %>"><a tabindex="-1" type="menuitem"><%= scope.getDisplayValue(item) %></a></li>',"<% } else { %>",'<li id="<%= item.id %>" data-value="<%= item.value %>">','<a tabindex="-1" type="menuitem" style="padding: 5px;">',"<% _.each(item.data.iconSet, function(icon) { %>","<img src=\"<%= item.data.icons.at(icon-1).get('icon') %>\">","<% }) %>","</a>","</li>","<% } %>","<% }); %>"].join(""))({items:this.store.toJSON(),scope:this})),_.isUndefined(this.scroller)||(this.scroller.destroy(),delete this.scroller),this.scroller=new Common.UI.Scroller(_.extend({el:$(".dropdown-menu",this.cmpEl),minScrollbarLength:40,includePadding:!0,wheelSpeed:10,alwaysVisibleY:this.scrollAlwaysVisible},this.options.scroller))}},Common.UI.ComboBoxIcons||{}))}),define("documenteditor/main/app/view/TableFormulaDialog",["common/main/lib/component/InputField","common/main/lib/component/Window"],function(){"use strict";DE.Views.TableFormulaDialog=Common.UI.Window.extend(_.extend({options:{width:300,style:"min-width: 230px;",cls:"modal-dlg",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:this.textTitle},t||{}),this.template=['<div class="box" style="height: 150px;">','<div class="input-row">',"<label>"+this.textFormula+"</label>","</div>",'<div id="id-dlg-formula-formula" class="input-row" style="margin-bottom: 5px;"></div>','<div class="input-row">',"<label>"+this.textFormat+"</label>","</div>",'<div id="id-dlg-formula-format" class="input-row" style="margin-bottom: 20px;"></div>','<div class="input-row">','<div id="id-dlg-formula-function" style="display: inline-block; width: 50%;" class="float-left padding-right-10"></div>','<div id="id-dlg-formula-bookmark" style="display: inline-block; width: 50%;"></div>',"</div>","</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),this.bookmarks=this.options.bookmarks,this.api=this.options.api,Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var n=this,t=this.getChild();this.inputFormula=new Common.UI.InputField({el:$("#id-dlg-formula-formula"),allowBlank:!0,validateOnChange:!0,style:"width: 100%;"}).on("changing",_.bind(this.checkFormulaInput,this)),this.cmbFormat=new Common.UI.ComboBox({el:$("#id-dlg-formula-format"),cls:"input-group-nr",menuStyle:"min-width: 100%; max-height: 200px;",takeFocusOnClose:!0}),this.cmbFunction=new Common.UI.ComboBox({el:$("#id-dlg-formula-function"),cls:"input-group-nr",menuStyle:"min-width: 100%; max-height: 150px;",editable:!1,takeFocusOnClose:!0,scrollAlwaysVisible:!0,data:[{displayValue:"ABS",value:1},{displayValue:"AND",value:1},{displayValue:"AVERAGE",value:1},{displayValue:"COUNT",value:1},{displayValue:"DEFINED",value:1},{displayValue:"FALSE",value:0},{displayValue:"IF",value:1},{displayValue:"INT",value:1},{displayValue:"MAX",value:1},{displayValue:"MIN",value:1},{displayValue:"MOD",value:1},{displayValue:"NOT",value:1},{displayValue:"OR",value:1},{displayValue:"PRODUCT",value:1},{displayValue:"ROUND",value:1},{displayValue:"SIGN",value:1},{displayValue:"SUM",value:1},{displayValue:"TRUE",value:0}]}),this.cmbFunction.on("selected",_.bind(function(t,e){t.setValue(this.textInsertFunction);var t=n.inputFormula._input,i=t[0].selectionEnd;t.val(t.val().substring(0,i)+e.displayValue+(e.value?"()":"")+t.val().substring(i)),t.focus(),t[0].selectionStart=t[0].selectionEnd=i+e.displayValue.length+e.value,this.btnOk.setDisabled(!1)},this)),this.cmbFunction.setValue(this.textInsertFunction),this.cmbBookmark=new Common.UI.ComboBox({el:$("#id-dlg-formula-bookmark"),cls:"input-group-nr",menuStyle:"min-width: 100%; max-height: 150px;",editable:!1,takeFocusOnClose:!0}),this.cmbBookmark.on("selected",_.bind(function(t,e){t.setValue(this.textBookmark);var t=n.inputFormula._input,i=t[0].selectionEnd;t.val(t.val().substring(0,i)+e.displayValue+t.val().substring(i)),t.focus(),t[0].selectionStart=t[0].selectionEnd=i+e.displayValue.length,this.btnOk.setDisabled(!1)},this)),this.cmbBookmark.setValue(this.textBookmark),n.btnOk=new Common.UI.Button({el:t.find(".primary")}),t.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.afterRender()},getFocusedComponents:function(){return[this.inputFormula,this.cmbFormat,this.cmbFunction,this.cmbBookmark]},getDefaultFocusableComponent:function(){return this.inputFormula},onSelectItem:function(t,e,i,n){this.btnOk.setDisabled(0==i.get("level")&&0<i.get("index"))},afterRender:function(){this.refreshBookmarks(),this._setDefaults()},_setDefaults:function(){var e=[],t=(_.each(this.api.asc_GetTableFormulaFormats(),function(t){e.push({value:t,displayValue:t})}),this.cmbFormat.setData(e),this.api.asc_ParseTableFormulaInstrLine(this.api.asc_GetTableFormula()));this.inputFormula.setValue(t[0]),this.cmbFormat.setValue(t[1]),this.checkFormulaInput(this.inputFormula,this.inputFormula.getValue())},refreshBookmarks:function(){var t=[];if(this.bookmarks){for(var e=this.bookmarks.asc_GetCount(),i=0;i<e;i++){var n=this.bookmarks.asc_GetName(i);this.bookmarks.asc_IsInternalUseBookmark(n)||t.push({value:i,displayValue:n})}this.cmbBookmark.setData(t),this.cmbBookmark.setValue(this.textBookmark)}this.cmbBookmark.setDisabled(t.length<1)},checkFormulaInput:function(t,e){e=e.trim();this.btnOk.setDisabled(""==e||"="==e)},getSettings:function(){return this.api.asc_CreateInstructionLine(this.inputFormula.getValue(),this.cmbFormat.getValue())},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onPrimary:function(t){return this._handleInput("ok"),!1},_handleInput:function(t){this.options.handler&&this.options.handler.call(this,t,this.getSettings()),this.close()}},DE.Views.TableFormulaDialog||{}))}),define("documenteditor/main/app/view/TableToTextDialog",["common/main/lib/component/Window","common/main/lib/component/CheckBox","common/main/lib/component/RadioBox"],function(){"use strict";DE.Views.TableToTextDialog=Common.UI.Window.extend(_.extend({options:{width:300,height:254,header:!0,style:"min-width: 240px;",cls:"modal-dlg",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:this.textTitle},t||{}),this.template=['<div class="box">','<div style="margin-bottom: 8px;"><label class="font-weight-bold">'+this.textSeparator+"</label></div>",'<div id="id-table-text-radio-para" style="margin-bottom: 8px;"></div>','<div id="id-table-text-radio-tabs" style="margin-bottom: 8px;"></div>','<div id="id-table-text-radio-semi" style="margin-bottom: 5px;"></div>','<div style="margin-bottom: 24px;">','<div id="id-table-text-radio-other" class="margin-right-10" style="display: inline-block;vertical-align: middle;"></div>','<div id="id-table-text-txt-other" style="display: inline-block;vertical-align: middle;"></div>',"</div>",'<div id="id-table-text-check-nested"></div>',"</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this.getChild();this.rbPara=new Common.UI.RadioBox({el:t.find("#id-table-text-radio-para"),labelText:this.textPara,name:"asc-radio-table-text-separator",value:1}).on("change",_.bind(this.onRadioSeparatorChange,this)),this.rbTabs=new Common.UI.RadioBox({el:t.find("#id-table-text-radio-tabs"),labelText:this.textTab,name:"asc-radio-table-text-separator",value:2,checked:!0}).on("change",_.bind(this.onRadioSeparatorChange,this)),this.rbSemi=new Common.UI.RadioBox({el:t.find("#id-table-text-radio-semi"),labelText:this.textSemicolon,name:"asc-radio-table-text-separator",value:";"}).on("change",_.bind(this.onRadioSeparatorChange,this)),this.rbOther=new Common.UI.RadioBox({el:t.find("#id-table-text-radio-other"),labelText:this.textOther,name:"asc-radio-table-text-separator",value:3}).on("change",_.bind(this.onRadioSeparatorChange,this)),this.inputOther=new Common.UI.InputField({el:t.find("#id-table-text-txt-other"),style:"width: 30px;",maxLength:1,validateOnChange:!0,validateOnBlur:!1,value:"-",disabled:!0}),this.chNested=new Common.UI.CheckBox({el:t.find("#id-table-text-check-nested"),labelText:this.textNested,value:!0,disabled:!0}),this.getChild().find(".dlg-btn").on("click",_.bind(this.onBtnClick,this))},getFocusedComponents:function(){return[this.rbPara,this.rbTabs,this.rbSemi,this.rbOther,this.inputOther,this.chNested]},getDefaultFocusableComponent:function(){return this.rbTabs},setSettings:function(t){},_handleInput:function(t){if(this.options.handler){if("ok"==t&&!this.isRangeValid())return;this.options.handler.call(this,this,t)}this.close()},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onPrimary:function(){return this._handleInput("ok"),!1},getSettings:function(){return{type:this.rbPara.getValue()?1:this.rbTabs.getValue()?2:3,separator:this.rbSemi.getValue()?";".charCodeAt(0):this.rbOther.getValue()?this.inputOther.getValue().charCodeAt(0):void 0,nested:"checked"===this.chNested.getValue()}},onRadioSeparatorChange:function(t,e,i){var t=t.options.value,n=this;e&&(this.inputOther.setDisabled(3!==t),3==t&&setTimeout(function(){n.inputOther.focus()},1),1!==t&&this.chNested.setValue(!0),this.chNested.setDisabled(1!==t))},isRangeValid:function(){var e;return!this.rbOther.getValue()||""!=this.inputOther.getValue()||(Common.UI.warning({msg:(e=this).textEmpty,maxwidth:600,callback:function(t){e.inputOther.focus()}}),!1)}},DE.Views.TableToTextDialog||{}))}),define("documenteditor/main/app/view/TableSettings",["text!documenteditor/main/app/template/TableSettings.template","jquery","underscore","backbone","common/main/lib/component/Button","common/main/lib/component/CheckBox","common/main/lib/component/ThemeColorPalette","common/main/lib/component/ColorButton","common/main/lib/component/ComboBorderSize","common/main/lib/component/ComboDataView","common/main/lib/view/InsertTableDialog","documenteditor/main/app/view/TableSettingsAdvanced","documenteditor/main/app/view/TableFormulaDialog","documenteditor/main/app/view/TableToTextDialog"],function(t,n,o,e){"use strict";DE.Views.TableSettings=e.View.extend(o.extend({el:"#id-table-settings",template:o.template(t),events:{},options:{alias:"TableSettings"},initialize:function(){this._initSettings=!0,this._state={TemplateId:void 0,CheckHeader:!1,CheckTotal:!1,CheckBanded:!1,CheckFirst:!1,CheckLast:!1,CheckColBanded:!1,BackColor:"#000000",RepeatRow:!1,DisabledControls:!1,Width:null,Height:null,beginPreviewStyles:!0,previewStylesCount:-1,currentStyleFound:!1},this.spinners=[],this.lockedControls=[],this._locked=!1,this._originalLook=new Asc.CTablePropLook,this._originalProps=null,this.CellBorders={},this.CellColor={Value:1,Color:"transparent"},this.BorderSize=1,this._noApply=!1,this.render()},onCheckTemplateChange:function(t,e,i,n,o){if(this.api){var s=new Asc.CTableProp,a=this._originalLook||new Asc.CTablePropLook;switch(t){case 0:a.put_FirstRow("checked"==e.getValue());break;case 1:a.put_LastRow("checked"==e.getValue());break;case 2:a.put_BandHor("checked"==e.getValue());break;case 3:a.put_FirstCol("checked"==e.getValue());break;case 4:a.put_LastCol("checked"==e.getValue());break;case 5:a.put_BandVer("checked"==e.getValue())}s.put_TableLook(a),this.api.tblApply(s)}this.fireEvent("editcomplete",this)},onTableTemplateSelect:function(t,e,i,n){var o;this.api&&!this._noApply&&((o=new Asc.CTableProp).put_TableStyle(n.get("templateId")),this.api.tblApply(o)),this.fireEvent("editcomplete",this)},onCheckRepeatRowChange:function(t,e,i,n){var o;this.api&&((o=new Asc.CTableProp).put_RowsInHeader("checked"==t.getValue()),this.api.tblApply(o)),this.fireEvent("editcomplete",this)},onColorsBackSelect:function(t,e){var i;this.CellColor={Value:1,Color:e},this.api&&(e=new Asc.CTableProp,i=new Asc.CBackground,e.put_CellsBackground(i),"transparent"==this.CellColor.Color?i.put_Value(1):(i.put_Value(0),i.put_Color(Common.Utils.ThemeColor.getRgbColor(this.CellColor.Color))),e.put_CellSelect(!0),this.api.tblApply(e)),this.fireEvent("editcomplete",this)},onBtnBordersClick:function(t,e){this._UpdateBordersStyle(t.options.strId,!0),this.api&&((t=new Asc.CTableProp).put_CellBorders(this.CellBorders),t.put_CellSelect(!0),this.api.tblApply(t)),this.fireEvent("editcomplete",this)},onBorderSizeSelect:function(t,e){this.BorderSize=e.value},onEditClick:function(t,e,i){if(this.api)switch(e.value){case 0:this.api.selectRow();break;case 1:this.api.selectColumn();break;case 2:this.api.selectCell();break;case 3:this.api.selectTable();break;case 4:this.api.addRowAbove();break;case 5:this.api.addRowBelow();break;case 6:this.api.addColumnLeft();break;case 7:this.api.addColumnRight();break;case 8:this.api.remRow();break;case 9:this.api.remColumn();break;case 10:this.api.remTable();break;case 11:this.api.MergeCells();break;case 12:this.splitCells(t,e,i)}this.fireEvent("editcomplete",this)},splitCells:function(t,e,i){var n=this;new Common.Views.InsertTableDialog({split:!0,handler:function(t,e){"ok"==t&&n.api&&n.api.SplitCell(e.columns,e.rows),n.fireEvent("editcomplete",n)}}).show()},render:function(){(this.$el||n(this.el)).html(this.template({scope:this}))},setApi:function(t){return(this.api=t)&&(this.api.asc_registerCallback("asc_onInitTableTemplates",o.bind(this.onInitTableTemplates,this)),this.api.asc_registerCallback("asc_onBeginTableStylesPreview",o.bind(this.onBeginTableStylesPreview,this)),this.api.asc_registerCallback("asc_onAddTableStylesPreview",o.bind(this.onAddTableStylesPreview,this)),this.api.asc_registerCallback("asc_onEndTableStylesPreview",o.bind(this.onEndTableStylesPreview,this))),this},createDelayedControls:function(){var t=this,e=(this._tableTemplates&&this._onInitTemplates(),this.chHeader=new Common.UI.CheckBox({el:n("#table-checkbox-header"),labelText:this.textHeader,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.lockedControls.push(this.chHeader),this.chTotal=new Common.UI.CheckBox({el:n("#table-checkbox-total"),labelText:this.textTotal,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.lockedControls.push(this.chTotal),this.chBanded=new Common.UI.CheckBox({el:n("#table-checkbox-banded"),labelText:this.textBanded,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.lockedControls.push(this.chBanded),this.chFirst=new Common.UI.CheckBox({el:n("#table-checkbox-first"),labelText:this.textFirst,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.lockedControls.push(this.chFirst),this.chLast=new Common.UI.CheckBox({el:n("#table-checkbox-last"),labelText:this.textLast,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.lockedControls.push(this.chLast),this.chColBanded=new Common.UI.CheckBox({el:n("#table-checkbox-col-banded"),labelText:this.textColBanded,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.lockedControls.push(this.chColBanded),this.chHeader.on("change",o.bind(this.onCheckTemplateChange,this,0)),this.chTotal.on("change",o.bind(this.onCheckTemplateChange,this,1)),this.chBanded.on("change",o.bind(this.onCheckTemplateChange,this,2)),this.chFirst.on("change",o.bind(this.onCheckTemplateChange,this,3)),this.chLast.on("change",o.bind(this.onCheckTemplateChange,this,4)),this.chColBanded.on("change",o.bind(this.onCheckTemplateChange,this,5)),[["l","toolbar__icon btn-border-left","table-button-border-left",this.tipLeft,"bottom"],["c","toolbar__icon btn-border-insidevert","table-button-border-inner-vert",this.tipInnerVert,"bottom"],["r","toolbar__icon btn-border-right","table-button-border-right",this.tipRight,"bottom"],["t","toolbar__icon btn-border-top","table-button-border-top",this.tipTop,"bottom"],["m","toolbar__icon btn-border-insidehor","table-button-border-inner-hor",this.tipInnerHor,"bottom"],["b","toolbar__icon btn-border-bottom","table-button-border-bottom",this.tipBottom,"bottom"],["cm","toolbar__icon btn-border-inside","table-button-border-inner",this.tipInner,"top"],["lrtb","toolbar__icon btn-border-out","table-button-border-outer",this.tipOuter,"top"],["lrtbcm","toolbar__icon btn-border-all","table-button-border-all",this.tipAll,"top"],["","toolbar__icon btn-border-no","table-button-border-none",this.tipNone,"top"]]);this._btnsBorderPosition=[],o.each(e,function(t,e,i){t=new Common.UI.Button({parentEl:n("#"+t[2]),cls:"btn-toolbar borders--small",iconCls:t[1],strId:t[0],hint:t[3],dataHint:"1",dataHintDirection:t[4],dataHintOffset:"small"});t.on("click",o.bind(this.onBtnBordersClick,this)),this._btnsBorderPosition.push(t),this.lockedControls.push(t)},this),this.cmbBorderSize=new Common.UI.ComboBorderSize({el:n("#table-combo-border-size"),style:"width: 93px;",dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.BorderSize=this.cmbBorderSize.store.at(1).get("value"),this.cmbBorderSize.setValue(this.BorderSize),this.cmbBorderSize.on("selected",o.bind(this.onBorderSizeSelect,this)),this.lockedControls.push(this.cmbBorderSize),this.btnEdit=new Common.UI.Button({parentEl:n("#table-btn-edit"),cls:"btn-toolbar align-left",iconCls:"toolbar__icon btn-rows-and-columns",caption:this.textEdit,style:"width: 100%;",menu:new Common.UI.Menu({menuAlign:"tr-br",items:[{caption:this.selectRowText,value:0},{caption:this.selectColumnText,value:1},{caption:this.selectCellText,value:2},{caption:this.selectTableText,value:3},{caption:"--"},{caption:this.insertRowAboveText,value:4},{caption:this.insertRowBelowText,value:5},{caption:this.insertColumnLeftText,value:6},{caption:this.insertColumnRightText,value:7},{caption:"--"},{caption:this.deleteRowText,value:8},{caption:this.deleteColumnText,value:9},{caption:this.deleteTableText,value:10},{caption:"--"},{caption:this.mergeCellsText,value:11},{caption:this.splitCellsText,value:12}]}),dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.mnuMerge=this.btnEdit.menu.items[this.btnEdit.menu.items.length-2],this.mnuSplit=this.btnEdit.menu.items[this.btnEdit.menu.items.length-1],this.btnEdit.menu.on("show:after",o.bind(function(){this.api&&(this.mnuMerge.setDisabled(!this.api.CheckBeforeMergeCells()),this.mnuSplit.setDisabled(!this.api.CheckBeforeSplitCells()))},this)),this.btnEdit.menu.on("item:click",o.bind(this.onEditClick,this)),this.lockedControls.push(this.btnEdit),this.chRepeatRow=new Common.UI.CheckBox({el:n("#table-checkbox-repeat-row"),labelText:this.strRepeatRow,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.chRepeatRow.on("change",o.bind(this.onCheckRepeatRowChange,this)),this.lockedControls.push(this.chRepeatRow),this.numHeight=new Common.UI.MetricSpinner({el:n("#table-spin-cell-height"),step:.1,width:90,defaultUnit:"cm",value:"1 cm",maxValue:55.88,minValue:0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.numHeight.on("change",o.bind(function(t,e,i,n){var o=new Asc.CTableProp;o.put_RowHeight(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())),this.api.tblApply(o)},this)),this.numHeight.on("inputleave",function(){t.fireEvent("editcomplete",t)}),this.lockedControls.push(this.numHeight),this.spinners.push(this.numHeight),this.numWidth=new Common.UI.MetricSpinner({el:n("#table-spin-cell-width"),step:.1,width:90,defaultUnit:"cm",value:"1 cm",maxValue:55.88,minValue:0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.numWidth.on("change",o.bind(function(t,e,i,n){var o=new Asc.CTableProp;o.put_ColumnWidth(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())),this.api.tblApply(o)},this)),this.numWidth.on("inputleave",function(){t.fireEvent("editcomplete",t)}),this.lockedControls.push(this.numWidth),this.spinners.push(this.numWidth),this.btnDistributeRows=new Common.UI.Button({parentEl:n("#table-btn-distrub-rows",t.$el),cls:"btn-toolbar",iconCls:"toolbar__icon btn-distribute-rows",hint:this.textDistributeRows,dataHint:"1",dataHintDirection:"top"}),this.lockedControls.push(this.btnDistributeRows),this.btnDistributeRows.on("click",o.bind(function(t){this.api.asc_DistributeTableCells(!1)},this)),this.btnDistributeCols=new Common.UI.Button({parentEl:n("#table-btn-distrub-cols",t.$el),cls:"btn-toolbar",iconCls:"toolbar__icon btn-distribute-columns",hint:this.textDistributeCols,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.lockedControls.push(this.btnDistributeCols),this.btnDistributeCols.on("click",o.bind(function(t){this.api.asc_DistributeTableCells(!0)},this)),this.btnAddFormula=new Common.UI.Button({el:n("#table-btn-add-formula")}),this.lockedControls.push(this.btnAddFormula),this.btnAddFormula.on("click",o.bind(this.onAddFormula,this)),this.btnConvert=new Common.UI.Button({parentEl:n("#table-btn-convert-to-text"),cls:"btn-toolbar align-left",iconCls:"toolbar__icon btn-table-to-text",caption:this.textConvert,dataHint:"1",dataHintDirection:"left",dataHintOffset:"medium"}),this.btnConvert.on("click",o.bind(this.onConvertTable,this)),this.lockedControls.push(this.btnConvert),this.linkAdvanced=n("#table-advanced-link"),n(this.el).on("click","#table-advanced-link",o.bind(this.openAdvancedSettings,this))},createDelayedElements:function(){this._initSettings=!1,this.createDelayedControls(),this.UpdateThemeColors(),this.updateMetricUnit()},ChangeSettings:function(t){if(this._initSettings&&this.createDelayedElements(),this.disableControls(this._locked),t){this._originalProps=new Asc.CTableProp(t),this._originalProps.put_CellSelect(!0);var e=t.get_ColumnWidth(),i=(((void 0===this._state.Width||void 0===e)&&this._state.Width!==e||.001<Math.abs(this._state.Width-e))&&(this.numWidth.setValue(null!=e?Common.Utils.Metric.fnRecalcFromMM(e):"",!0),this._state.Width=e),e=t.get_RowHeight(),((void 0===this._state.Height||void 0===e)&&this._state.Height!==e||.001<Math.abs(this._state.Height-e))&&(this.numHeight.setValue(null!=e?Common.Utils.Metric.fnRecalcFromMM(e):"",!0),this._state.Height=e),e=t.get_TableStyle(),this._state.TemplateId===e&&!this._isTemplatesChanged||(this._state.TemplateId=e,(i=this.api.asc_getTableStylesPreviews(!1,[this._state.TemplateId]))&&0<i.length&&this.$el.find(".icon-template-table").css({"background-image":"url("+i[0].asc_getImage()+")",height:"52px",width:"72px","background-position":"center","background-size":"auto 52px"}),this._state.currentStyleFound=!1,this.selectCurrentTableStyle()),this._isTemplatesChanged=!1,t.get_TableLook()),i=(i&&(e=i.get_FirstRow(),this._state.CheckHeader!==e&&(this.chHeader.setValue(e,!0),this._state.CheckHeader=e,this._originalLook.put_FirstRow(e)),e=i.get_LastRow(),this._state.CheckTotal!==e&&(this.chTotal.setValue(e,!0),this._state.CheckTotal=e,this._originalLook.put_LastRow(e)),e=i.get_BandHor(),this._state.CheckBanded!==e&&(this.chBanded.setValue(e,!0),this._state.CheckBanded=e,this._originalLook.put_BandHor(e)),e=i.get_FirstCol(),this._state.CheckFirst!==e&&(this.chFirst.setValue(e,!0),this._state.CheckFirst=e,this._originalLook.put_FirstCol(e)),e=i.get_LastCol(),this._state.CheckLast!==e&&(this.chLast.setValue(e,!0),this._state.CheckLast=e,this._originalLook.put_LastCol(e)),e=i.get_BandVer(),this._state.CheckColBanded!==e&&(this.chColBanded.setValue(e,!0),this._state.CheckColBanded=e,this._originalLook.put_BandVer(e))),t.get_CellsBackground()),i=(i?0==i.get_Value()&&(i=i.get_Color())?i.get_type()==Asc.c_oAscColor.COLOR_TYPE_SCHEME?this.CellColor={Value:1,Color:{color:Common.Utils.ThemeColor.getHexColor(i.get_r(),i.get_g(),i.get_b()),effectValue:i.get_value()}}:this.CellColor={Value:1,Color:Common.Utils.ThemeColor.getHexColor(i.get_r(),i.get_g(),i.get_b())}:this.CellColor={Value:1,Color:"transparent"}:this.CellColor={Value:0,Color:"transparent"},typeof this.CellColor.Color);if(i!=typeof this._state.BackColor||"object"==i&&(this.CellColor.Color.effectValue!==this._state.BackColor.effectValue||this._state.BackColor.color.indexOf(this.CellColor.Color.color)<0)||"object"!=i&&this._state.BackColor.indexOf(this.CellColor.Color)<0){if(this.btnBackColor.setColor(this.CellColor.Color),"object"==typeof this.CellColor.Color){for(var n=!1,o=0;o<10;o++)if(Common.Utils.ThemeColor.ThemeValues[o]==this.CellColor.Color.effectValue){this.colorsBack.select(this.CellColor.Color,!0),n=!0;break}n||this.colorsBack.clearSelection()}else this.colorsBack.select(this.CellColor.Color,!0);this._state.BackColor=this.CellColor.Color}e=t.get_RowsInHeader(),this._state.RepeatRow!==e&&(this.chRepeatRow.setValue(!!e,!0),this._state.RepeatRow=e),this.chRepeatRow.setDisabled(null===this._state.RepeatRow||this._locked)}},updateMetricUnit:function(){if(this.spinners){for(var t=0;t<this.spinners.length;t++){var e=this.spinners[t];e.setDefaultUnit(Common.Utils.Metric.getCurrentMetricName()),e.setStep(Common.Utils.Metric.getCurrentMetric()==Common.Utils.Metric.c_MetricUnits.pt?1:.1)}var i=this._state.Width;this.numWidth&&this.numWidth.setValue(null!=i?Common.Utils.Metric.fnRecalcFromMM(i):"",!0),i=this._state.Height,this.numHeight&&this.numHeight.setValue(null!=i?Common.Utils.Metric.fnRecalcFromMM(i):"",!0)}},_UpdateBordersStyle:function(t){this.CellBorders=new Asc.CBorders;var e=this.CellBorders,i=""!=t;(-1<t.indexOf("l")||!i)&&(null!==e.get_Left()&&void 0!==e.get_Left()||e.put_Left(new Asc.asc_CTextBorder),this._UpdateBorderStyle(e.get_Left(),i)),(-1<t.indexOf("t")||!i)&&(null!==e.get_Top()&&void 0!==e.get_Top()||e.put_Top(new Asc.asc_CTextBorder),this._UpdateBorderStyle(e.get_Top(),i)),(-1<t.indexOf("r")||!i)&&(null!==e.get_Right()&&void 0!==e.get_Right()||e.put_Right(new Asc.asc_CTextBorder),this._UpdateBorderStyle(e.get_Right(),i)),(-1<t.indexOf("b")||!i)&&(null!==e.get_Bottom()&&void 0!==e.get_Bottom()||e.put_Bottom(new Asc.asc_CTextBorder),this._UpdateBorderStyle(e.get_Bottom(),i)),(-1<t.indexOf("c")||!i)&&(null!==e.get_InsideV()&&void 0!==e.get_InsideV()||e.put_InsideV(new Asc.asc_CTextBorder),this._UpdateBorderStyle(e.get_InsideV(),i)),(-1<t.indexOf("m")||!i)&&(null!==e.get_InsideH()&&void 0!==e.get_InsideH()||e.put_InsideH(new Asc.asc_CTextBorder),this._UpdateBorderStyle(e.get_InsideH(),i))},_UpdateBorderStyle:function(t,e){var i;null==t&&(t=new Asc.asc_CTextBorder),e&&0<this.BorderSize?(e=parseFloat(this.BorderSize),t.put_Value(1),t.put_Size(25.4*e/72),this.btnBorderColor.isAutoColor()?(i=new Asc.asc_CColor).put_auto(!0):i=Common.Utils.ThemeColor.getRgbColor(this.btnBorderColor.color),t.put_Color(i)):t.put_Value(0)},UpdateThemeColors:function(){this._initSettings||(this.btnBackColor||(this.btnBorderColor=new Common.UI.ColorButton({parentEl:n("#table-border-color-btn"),color:"auto",auto:!0,eyeDropper:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.lockedControls.push(this.btnBorderColor),this.borderColor=this.btnBorderColor.getPicker(),this.btnBorderColor.on("eyedropper:start",o.bind(this.onEyedropperStart,this)),this.btnBorderColor.on("eyedropper:end",o.bind(this.onEyedropperEnd,this)),this.btnBackColor=new Common.UI.ColorButton({parentEl:n("#table-back-color-btn"),transparent:!0,eyeDropper:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.lockedControls.push(this.btnBackColor),this.colorsBack=this.btnBackColor.getPicker(),this.btnBackColor.on("color:select",o.bind(this.onColorsBackSelect,this)),this.btnBackColor.on("eyedropper:start",o.bind(this.onEyedropperStart,this)),this.btnBackColor.on("eyedropper:end",o.bind(this.onEyedropperEnd,this))),this.colorsBack.updateColors(Common.Utils.ThemeColor.getEffectColors(),Common.Utils.ThemeColor.getStandartColors()),this.borderColor.updateColors(Common.Utils.ThemeColor.getEffectColors(),Common.Utils.ThemeColor.getStandartColors()),this.btnBorderColor.isAutoColor()||this.btnBorderColor.setColor(this.borderColor.getColor()))},selectCurrentTableStyle:function(){var t;this.mnuTableTemplatePicker&&!this._state.beginPreviewStyles&&(t=(t=this.mnuTableTemplatePicker.store.findWhere({templateId:this._state.TemplateId}))||this._state.previewStylesCount!==this.mnuTableTemplatePicker.store.length?t:this.mnuTableTemplatePicker.store.at(0))&&(this._state.currentStyleFound=!0,this.btnTableTemplate.suspendEvents(),this.mnuTableTemplatePicker.selectRecord(t,!0),this.btnTableTemplate.resumeEvents(),this.$el.find(".icon-template-table").css({"background-image":"url("+t.get("imageUrl")+")",height:"52px",width:"72px","background-position":"center","background-size":"auto 52px"}))},onBeginTableStylesPreview:function(t){this._state.beginPreviewStyles=!0,this._state.currentStyleFound=!1,this._state.previewStylesCount=t,this._state.groups={"menu-table-group-custom":{id:"menu-table-group-custom",caption:this.txtGroupTable_Custom,index:0,templateCount:0},"menu-table-group-plain":{id:"menu-table-group-plain",caption:this.txtGroupTable_Plain,index:1,templateCount:0},"menu-table-group-grid":{id:"menu-table-group-grid",caption:this.txtGroupTable_Grid,index:2,templateCount:0},"menu-table-group-list":{id:"menu-table-group-list",caption:this.txtGroupTable_List,index:3,templateCount:0},"menu-table-group-bordered-and-lined":{id:"menu-table-group-bordered-and-lined",caption:this.txtGroupTable_BorderedAndLined,index:4,templateCount:0},"menu-table-group-no-name":{id:"menu-table-group-no-name",caption:"&nbsp",index:5,templateCount:0}}},onEndTableStylesPreview:function(){this._state.currentStyleFound||this.selectCurrentTableStyle(),this.mnuTableTemplatePicker&&(this.mnuTableTemplatePicker.scroller.update({alwaysVisibleY:!0}),this.mnuTableTemplatePicker.isVisible()&&this.mnuTableTemplatePicker.scrollToRecord(this.mnuTableTemplatePicker.getSelectedRec()))},onAddTableStylesPreview:function(t){var a=this;o.each(t,function(t){var e,i=t.asc_getDisplayName(),n="",o=(0==t.asc_getType()?(o=i.split(" "),new RegExp("Table Grid","i").test(i)?n="menu-table-group-plain":new RegExp("Lined|Bordered","i").test(i)?n="menu-table-group-bordered-and-lined":(o[0]&&(n="menu-table-group-"+o[0].toLowerCase()),0==a._state.groups.hasOwnProperty(n)&&(n="menu-table-group-no-name")),["Table Grid","Plain Table","Grid Table","List Table","Light","Dark","Colorful","Accent","Bordered & Lined","Bordered","Lined"].forEach(function(t){var e="txtTable_"+t.replace("&","And").replace(new RegExp(" ","g"),"");a[e]&&(i=i.replace(t,a[e]))})):n="menu-table-group-custom",{imageUrl:t.asc_getImage(),id:Common.UI.getId(),group:n,templateId:t.asc_getId(),tip:i}),s=0;for(e in a._state.groups)a._state.groups[e].index<=a._state.groups[n].index&&(s+=a._state.groups[e].templateCount);a._state.beginPreviewStyles?(a._state.beginPreviewStyles=!1,a.mnuTableTemplatePicker&&a.mnuTableTemplatePicker.groups.reset(a._state.groups[n]),a.mnuTableTemplatePicker&&a.mnuTableTemplatePicker.store.reset(o),a.mnuTableTemplatePicker.groups.comparator=function(t){return t.get("index")}):(0==a._state.groups[n].templateCount&&a.mnuTableTemplatePicker&&a.mnuTableTemplatePicker.groups.add(a._state.groups[n]),a.mnuTableTemplatePicker&&a.mnuTableTemplatePicker.store.add(o,{at:s})),a._state.groups[n].templateCount+=1}),this._state.currentStyleFound||this.selectCurrentTableStyle()},onInitTableTemplates:function(){this._initSettings?this._tableTemplates=!0:this._onInitTemplates()},_onInitTemplates:function(){var e=this;this._isTemplatesChanged=!0,this.btnTableTemplate||(this.btnTableTemplate=new Common.UI.Button({cls:"btn-large-dataview template-table",iconCls:"icon-template-table",scaling:!1,menu:new Common.UI.Menu({style:"width: 588px;",items:[{template:o.template('<div id="id-table-menu-template" class="menu-table-template"></div>')}]}),dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.btnTableTemplate.on("render:after",function(t){e.mnuTableTemplatePicker=new Common.UI.DataView({el:n("#id-table-menu-template"),parentMenu:t.menu,restoreHeight:350,groups:new Common.UI.DataViewGroupStore,store:new Common.UI.DataViewStore,itemTemplate:o.template('<div id="<%= id %>" class="item"><img src="<%= imageUrl %>" height="52" width="72"></div>'),style:"max-height: 350px;",cls:"classic",delayRenderTips:!0})}),this.btnTableTemplate.render(n("#table-btn-template")),this.btnTableTemplate.cmpEl.find(".icon-template-table").css({height:"52px",width:"72px","background-position":"center","background-size":"auto 52px"}),this.lockedControls.push(this.btnTableTemplate),this.mnuTableTemplatePicker.on("item:click",o.bind(this.onTableTemplateSelect,this,this.btnTableTemplate))),this.api.asc_generateTableStylesPreviews()},openAdvancedSettings:function(t){if(!this.linkAdvanced.hasClass("disabled")){var i=this;if(i.api&&!this._locked){var e=i.api.getSelectedElements();if(e&&0<e.length)for(var n,o,s=e.length-1;0<=s;s--)if(n=e[s].get_ObjectType(),o=e[s].get_ObjectValue(),Asc.c_oAscTypeSelectElement.Table==n){new DE.Views.TableSettingsAdvanced({tableStylerRows:null===o.get_CellBorders().get_InsideH()&&1==o.get_CellSelect()?1:2,tableStylerColumns:null===o.get_CellBorders().get_InsideV()&&1==o.get_CellSelect()?1:2,tableProps:o,borderProps:i.borderAdvancedProps,sectionProps:i.api.asc_GetSectionProps(),handler:function(t,e){"ok"==t&&i.api&&(i.borderAdvancedProps=e.borderProps,i.api.tblApply(e.tableProps)),i.fireEvent("editcomplete",i)}}).show();break}}}},onAddFormula:function(t){var i=this;i.api&&!this._locked&&new DE.Views.TableFormulaDialog({api:i.api,bookmarks:i.api.asc_GetBookmarksManager(),handler:function(t,e){"ok"==t&&i.api&&i.api.asc_AddTableFormula(e),i.fireEvent("editcomplete",i)}}).show()},onConvertTable:function(t){var i=this;i.api&&!this._locked&&new DE.Views.TableToTextDialog({handler:function(t,e){"ok"==e&&(e=t.getSettings(),i.api.asc_ConvertTableToText(e.type,e.separator,e.nested)),i.fireEvent("editcomplete",i)}}).show()},setLocked:function(t){this._locked=t},disableControls:function(e){this._initSettings||this._state.DisabledControls!==e&&(this._state.DisabledControls=e,o.each(this.lockedControls,function(t){t.setDisabled(e)}),this.linkAdvanced&&this.linkAdvanced.toggleClass("disabled",e))},onEyedropperStart:function(t){this.api.asc_startEyedropper(o.bind(t.eyedropperEnd,t)),this.fireEvent("eyedropper",!0)},onEyedropperEnd:function(){this.fireEvent("eyedropper",!1)}},DE.Views.TableSettings||{}))}),define("text!documenteditor/main/app/template/ShapeSettings.template",[],function(){return'<table cols="1">\n    <tr class="no-form">\n        <td>\n            <label class="header"><%= scope.strFill %></label>\n        </td>\n    </tr>\n    <tr class="no-form">\n        <td class="padding-small">\n            <div id="shape-combo-fill-src" style="width: 100%;"></div>\n        </td>\n    </tr>\n    <tr class="no-form">\n        <td>\n            <div id="shape-panel-color-fill" class="padding-small" style="width: 100%;">\n                <div id="shape-back-color-btn" style=""></div>\n            </div>\n            <div id="shape-panel-image-fill" class="settings-hidden padding-small" style="width: 100%;">\n                <table cols="2" style="width: 100%;">\n                <tr>\n                    <td colspan="2" class="padding-small">\n                        <div id="shape-button-replace" style="width:100%;"></div>\n                    </td>\n                </tr>\n                <tr>\n                    <td style="vertical-align: top">\n                        <div id="shape-combo-fill-type" style="width: 90px;"></div>\n                    </td>\n                    <td rowspan="2">\n                        <div class="texture-img float-right">\n                            <div id="shape-texture-img" style="width: 50px;height: 50px;"></div>\n                        </div>\n                    </td>\n                </tr>\n                <tr>\n                    <td style="vertical-align: bottom">\n                        <label class="input-label" style=""><%= scope.textTexture %></label>\n                        <div id="shape-combo-fill-texture" style="width: 90px;"></div>\n                    </td>\n                </tr>\n            </table>\n            </div>\n            <div id="shape-panel-pattern-fill" class="settings-hidden padding-small" style="width: 100%;">\n                <label class="input-label" style="margin-top: 3px;"><%= scope.strPattern %></label>\n                <div id="shape-combo-pattern" style="width: 100%; height: 42px; margin-bottom: 8px;"></div>\n                <div style="width: 100%; height: 25px; margin-bottom: 8px;">\n                    <label class="input-label" style="margin-top: 3px;"><%= scope.strForeground %></label>\n                    <div id="shape-foreground-color-btn" class="float-right"></div>\n                </div>\n                <div style="width: 100%; height: 25px;">\n                    <label class="input-label" style="margin-top: 3px;"><%= scope.strBackground %></label>\n                    <div id="shape-background-color-btn" class="float-right"></div>\n                </div>\n            </div>\n            <div id="shape-panel-gradient-fill" class="settings-hidden padding-small" style="width: 100%;">\n                <table cols="3" style="margin-bottom: 10px;">\n                    <tr valign="top">\n                        <td colspan="2">\n                            <div>\n                                <label class="input-label" style=""><%= scope.textStyle %></label>\n                                <div id="shape-combo-grad-type" style="width: 100%;"></div>\n                            </div>\n                        </td>\n                        <td rowspan="2" style="width: 100%;">\n                            <div class="float-right">\n                                <label class="input-label"><%= scope.textDirection %></label>\n                                <div id="shape-button-direction"></div>\n                            </div>\n                        </td>\n                    </tr>\n                    <tr valign="bottom">\n                        <td>\n                            <label class="input-label angle-label"><%= scope.textAngle %></label>\n                        </td>\n                        <td>\n                            <div id="shape-spin-gradient-angle" style="display: inline-block; width: 60px;"></div>\n                        </td>\n                    </tr>\n                </table>\n                <label class="input-label" style="display:block;margin-bottom: 5px;"><%= scope.textGradient %></label>\n                <div style="display: inline-block; margin-top: 3px;">\n                    <div id="shape-slider-gradient" style="display: inline-block; vertical-align: middle;"></div>\n                </div>\n                <div style="height: 40px;margin-top:6px;display:flex;justify-content:space-between;">\n                    <div style="display: flex;">\n                    <div style="">\n                        <label class="input-label" style=""><%= scope.strColor %></label>\n                        <div id="shape-gradient-color-btn"></div>\n                    </div>\n                    <div class="margin-left-10">\n                        <label class="input-label" style=""><%= scope.textPosition %></label>\n                        <div id="shape-gradient-position"></div>\n                    </div>\n                    </div>\n                    <div style="display:flex;padding-top:15px;">\n                        <div id="shape-gradient-add-step"></div>\n                        <div id="shape-gradient-remove-step"></div>\n                    </div>\n                </div>\n            </div>\n        </td>\n    </tr>\n    <tr class="no-form">\n        <td>\n            <div class="padding-small" id="shape-panel-transparent-fill">\n                <label class="header"><%= scope.strTransparency %></label>\n                <div class="shape-slider">\n                    <label id="shape-lbl-transparency-start">0</label>\n                    <div id="shape-slider-transparency"></div>\n                    <label id="shape-lbl-transparency-end">100</label>\n                </div>\n                <div id="shape-spin-transparency" class="float-right"></div>\n            </div>\n        </td>\n    </tr>\n    <tr class="no-form">\n        <td class="padding-small">\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr class="no-form">\n        <td>\n            <label class="header"><%= scope.strStroke %></label>\n        </td>\n    </tr>\n    <tr class="no-form">\n        <td class="padding-small">\n        <div style="display:inline-block;width:100px;vertical-align: middle;">\n            <label class="input-label" style=""><%= scope.strSize %></label>\n            <div id="shape-combo-border-size" style="width: 93px;"></div>\n        </div>\n        <div style="display:inline-block;vertical-align: middle;">\n            <label class="input-label" style=""><%= scope.strColor %></label>\n            <div id="shape-border-color-btn" style=""></div>\n        </div>\n        </td>\n    </tr>\n    <tr class="no-form">\n        <td class="padding-small">\n        <div style="display:inline-block;width:100px;vertical-align: middle;">\n            <label class="input-label" style=""><%= scope.strType %></label>\n            <div id="shape-combo-border-type" style="width: 93px;"></div>\n        </div>\n        </td>\n    </tr>\n    <tr class="no-form">\n        <td>\n           <div class="padding-small" id="shape-line-panel-transparent">\n               <label class="header"><%= scope.strTransparency %></label>\n               <div class="shape-slider">\n                   <label id="shape-line-lbl-transparency-start">0</label>\n                   <div id="shape-line-slider-transparency"></div>\n                   <label id="shape-line-lbl-transparency-end">100</label>\n               </div>\n               <div id="shape-line-spin-transparency" class="float-right"></div>\n           </div>\n        </td>\n    </tr>\n    <tr class="shape-only-separator">\n        <td class="padding-small">\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr class="shape-rotation">\n        <td class="padding-small">\n            <label class="header"><%= scope.textRotation %></label>\n        </td>\n    </tr>\n    <tr class="shape-rotation">\n        <td>\n            <table cols="2" style="width: 100%;">\n                <tr>\n                    <td class="padding-small" width="50%">\n                        <label class="input-label"><%= scope.textRotate90 %></label>\n                        <div>\n                            <div id="shape-button-270" class="margin-right-4"></div>\n                            <div id="shape-button-90"></div>\n                        </div>\n                    </td>\n                    <td class="padding-small" width="50%">\n                        <label class="input-label"><%= scope.textFlip %></label>\n                        <div>\n                            <div id="shape-button-fliph" class="margin-right-4"></div>\n                            <div id="shape-button-flipv"></div>\n                        </div>\n                    </td>\n                </tr>\n            </table>\n        </td>\n    </tr>\n    <tr class="shape-only">\n        <td class="padding-small">\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr class="shape-only">\n        <td class="padding-small">\n            <label class="header"><%= scope.textWrap %></label>\n        </td>\n    </tr>\n    <tr class="shape-only">\n        <td>\n            <div id="shape-combo-wrap" style="width: 100%;"></div>\n        </td>\n    </tr>\n    <tr class="shape-only">\n        <td class="padding-small"></td>\n    </tr>\n    <tr class="change-type">\n        <td class="padding-small">\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr class="change-type">\n        <td>\n            <div class="padding-small" id="shape-button-edit-shape-container">\n                <div id="shape-button-edit-shape" style="width:100%;"></div>\n            </div>\n        </td>\n    </tr>\n    <tr class="change-type">\n        <td>\n            <div class="padding-small" id="shape-button-change-shape-container">\n                <div id="shape-button-change-shape" style="width:100%;"></div>\n            </div>\n        </td>\n    </tr>\n    <tr class="no-form">\n        <td class="padding-small" colspan=2>\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr class="no-form">\n        <td class="padding-small" colspan=2>\n            <div id="shape-checkbox-shadow"></div>\n        </td>\n    </tr>\n    <tr class="shape-only">\n        <td class="padding-small">\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr class="shape-only">\n        <td align="center">\n            <label class="link" id="shape-advanced-link" data-hint="1" data-hint-direction="bottom" data-hint-offset="medium"><%= scope.textAdvanced %></label>\n        </td>\n    </tr>\n    <tr class="finish-cell"></tr>\n</table>'}),void 0===Common&&(Common={}),define("common/main/lib/component/MultiSliderGradient",["common/main/lib/component/Slider","underscore"],function(t,s){"use strict";Common.UI.MultiSliderGradient=Common.UI.MultiSlider.extend({options:{width:100,minValue:0,maxValue:100,values:[0,100],colorValues:["#000000","#ffffff"],currentThumb:0,includeSnap:!0,intervalSnap:5,thumbTemplate:'<div class="thumb" style=""><div class="thumb-top"><div class="thumb-top-inner"></div></div><div class="thumb-bottom"><div class="thumb-bottom-inner"></div></div></div>'},disabled:!1,template:s.template(['<div class="slider multi-slider-gradient">','<div class="track"></div>',"<% _.each(items, function(item) { %>","<%= thumbTemplate %>","<% }); %>","</div>"].join("")),initialize:function(t){this.styleStr={},Common.UI.MultiSlider.prototype.initialize.call(this,t)},render:function(t){Common.UI.MultiSlider.prototype.render.call(this,t);var e=this;e.trackEl=e.cmpEl.find(".track");for(var i=0;i<e.thumbs.length;i++)e.thumbs[i].thumb.on("dblclick",null,function(){e.trigger("thumbdblclick",e)}),e.thumbs[i].thumbcolor=e.thumbs[i].thumb.find("> div"),e.setColorValue(e.options.colorValues[i],i);e.changeSliderStyle(),e.changeGradientStyle(),e.on("change",s.bind(e.changeGradientStyle,e))},setColorValue:function(t,e){e=void 0!==e?e:this.currentThumb;this.thumbs[e].colorValue=t,this.thumbs[e].thumbcolor.css("background-color",t),this.changeGradientStyle()},getColorValue:function(t){t=void 0!==t?t:this.currentThumb;return this.thumbs[t].colorValue},setValue:function(t,e){Common.UI.MultiSlider.prototype.setValue.call(this,t,e),this.changeGradientStyle()},getColorValues:function(){var e=[];return s.each(this.thumbs,function(t){e.push(t.colorValue)}),e},changeGradientStyle:function(){var t;this.rendered&&(this.styleStr.specific&&(t=Common.Utils.String.format(this.styleStr.specific,this.getColorValues().concat(this.getValues())),this.trackEl.css("background",t)),Common.Utils.isIE&&(t=Common.Utils.String.format("progid:DXImageTransform.Microsoft.gradient( startColorstr={0}, endColorstr={1},GradientType=1 )",this.getColorValue(0),this.getColorValue(this.thumbs.length-1)),this.trackEl.css("filter",t)),this.styleStr.common&&(t=Common.Utils.String.format(this.styleStr.common,this.getColorValues().concat(this.getValues())),this.trackEl.css("background",t)))},sortThumbs:function(){var t=Common.UI.MultiSlider.prototype.sortThumbs.call(this);return this.trigger("sortthumbs",this,t),t},findLeftThumb:function(t){for(var e,i,n,o=100,s=0,a=this.thumbs.length,l=0;l<a;l++)0<(n=t-this.thumbs[l].position)&&n<=o&&(e=this.thumbs[l+1],void 0!==(i=this.thumbs[l-1])&&t<i.position||void 0!==e&&t>e.position||(s=l,o=n));return s},calculationNewColor:function(t,e,i){var i=i?i/100:.5,n=1-i,t=Common.Utils.ThemeColor.getRgbColor(t),e=Common.Utils.ThemeColor.getRgbColor(e),t=[Math.round(t.get_r()*n+e.get_r()*i),Math.round(t.get_g()*n+e.get_g()*i),Math.round(t.get_b()*n+e.get_b()*i)];return Common.Utils.ThemeColor.getHexColor(t[0],t[1],t[2])},addThumb:function(){Common.UI.MultiSlider.prototype.addThumb.call(this);var t=this,e=t.thumbs.length-1;t.thumbs[e].thumb.on("dblclick",null,function(){t.trigger("thumbdblclick",t)}),t.thumbs[e].thumbcolor=t.thumbs[e].thumb.find("> div"),0<e&&this.setColorValue(this.getColorValue(e-1),e),t.changeSliderStyle()},addNewThumb:function(t,e,i){var n,o=this.findLeftThumb(e);return s.isUndefined(i)?n=(i=100*(e-this.thumbs[o].value)/(this.thumbs[o+1].value-this.thumbs[o].value))<0?this.thumbs[o].colorValue:this.calculationNewColor(this.thumbs[o].colorValue,this.thumbs[o===t-1?o:o+1].colorValue,i):(this.addThumb(),t=this.thumbs.length-1,n=this.calculationNewColor(this.thumbs[o].colorValue,this.thumbs[o===t-1?o:o+1].colorValue),this.setThumbPosition(t,e),i=e/this.delta+this.minValue,this.thumbs[t].value=i),this.thumbs[t].thumbcolor=this.thumbs[t].thumb.find("> div"),0<t&&this.setColorValue("#"+n,t),this.sortThumbs(),this.changeSliderStyle(),this.changeGradientStyle(),n},removeThumb:function(t){void 0===t&&(t=this.thumbs.length-1),2<this.thumbs.length&&(this.thumbs[t].thumb.remove(),this.thumbs.splice(t,1),this.sortThumbs(),this.changeSliderStyle())},changeSliderStyle:function(){this.styleStr={specific:"",common:"linear-gradient(to right"},Common.Utils.isChrome&&Common.Utils.chromeVersion<10||Common.Utils.isSafari&&Common.Utils.safariVersion<5.1?this.styleStr.specific="-webkit-gradient(linear, left top, right top":Common.Utils.isChrome||Common.Utils.isSafari?this.styleStr.specific="-webkit-linear-gradient(left":Common.Utils.isGecko?this.styleStr.specific="-moz-linear-gradient(left":Common.Utils.isOpera&&11<Common.Utils.operaVersion?this.styleStr.specific="-o-linear-gradient(left":Common.Utils.isIE&&(this.styleStr.specific="-ms-linear-gradient(left");for(var t=0;t<this.thumbs.length;t++)this.styleStr.common+=", {"+t+"} {"+(this.thumbs.length+t)+"}%",Common.Utils.isChrome&&Common.Utils.chromeVersion<10||Common.Utils.isSafari&&Common.Utils.safariVersion<5.1?this.styleStr.specific+=", color-stop({"+(this.thumbs.length+t)+"}%,{"+t+"})":this.styleStr.specific+=", {"+t+"} {"+(this.thumbs.length+t)+"}%";this.styleStr.specific+=")",this.styleStr.common+=")"}})}),define("documenteditor/main/app/view/ShapeSettings",["text!documenteditor/main/app/template/ShapeSettings.template","jquery","underscore","backbone","common/main/lib/component/ComboBox","common/main/lib/component/ComboBorderSize","common/main/lib/component/MetricSpinner","common/main/lib/component/ThemeColorPalette","common/main/lib/component/ColorButton","common/main/lib/component/ComboDataView","common/main/lib/component/Slider","common/main/lib/component/MultiSliderGradient","common/main/lib/view/ImageFromUrlDialog","documenteditor/main/app/view/ImageSettingsAdvanced"],function(t,f,v,e){"use strict";DE.Views.ShapeSettings=e.View.extend(v.extend({el:"#id-shape-settings",template:v.template(t),events:{},options:{alias:"ShapeSettings"},initialize:function(){this._initSettings=!0,this._originalProps=null,this._noApply=!0,this.imgprops=null,this._sendUndoPoint=!0,this._sliderChanged=!1,this._sliderChangedLine=!1,this._texturearray=null,this.txtPt=Common.Utils.Metric.getMetricName(Common.Utils.Metric.c_MetricUnits.pt),this._state={Transparency:null,FillType:Asc.c_oAscFill.FILL_TYPE_SOLID,ShapeColor:"transparent",BlipFillType:Asc.c_oAscFillBlipType.STRETCH,StrokeType:Asc.c_oAscStrokeType.STROKE_COLOR,StrokeWidth:this._pt2mm(1),StrokeColor:"000000",StrokeBorderType:Asc.c_oDashType.solid,FGColor:"000000",BGColor:"ffffff",GradColor:"000000",GradFillType:Asc.c_oAscFillGradType.GRAD_LINEAR,WrappingStyle:Asc.c_oAscWrapStyle2.Inline,CanBeFlow:!0,FromGroup:!1,DisabledFillPanels:!1,DisabledControls:!1,HideShapeOnlySettings:!1,HideChangeTypeSettings:!1,HideRotationSettings:!1,isFromImage:!1,isFromSmartArtInternal:!1,isFixedForm:!1},this.lockedControls=[],this._locked=!1,this.OriginalFillType=Asc.c_oAscFill.FILL_TYPE_SOLID,this.ShapeColor={Value:1,Color:"transparent"},this.BlipFillType=Asc.c_oAscFillBlipType.STRETCH,this.GradFillType=Asc.c_oAscFillGradType.GRAD_LINEAR,this.GradColor={values:[0,100],colors:["000000","ffffff"],currentIdx:0},this.GradRadialDirectionIdx=0,this.GradLinearDirectionType=0,this.PatternFillType=0,this.FGColor={Value:1,Color:"000000"},this.BGColor={Value:1,Color:"ffffff"},this.BorderColor={Value:1,Color:"transparent"},this.BorderSize=0,this.BorderType=Asc.c_oDashType.solid,this.textureNames=[this.txtCanvas,this.txtCarton,this.txtDarkFabric,this.txtGrain,this.txtGranite,this.txtGreyPaper,this.txtKnit,this.txtLeather,this.txtBrownPaper,this.txtPapyrus,this.txtWood],this.fillControls=[],this.gradientColorsStr="#000, #fff",this.typeGradient=90,this.shapeRestoreHeight=615,this.render()},render:function(){(this.$el||f(this.el)).html(this.template({scope:this})),this.FillColorContainer=f("#shape-panel-color-fill"),this.FillImageContainer=f("#shape-panel-image-fill"),this.FillPatternContainer=f("#shape-panel-pattern-fill"),this.FillGradientContainer=f("#shape-panel-gradient-fill"),this.TransparencyContainer=f("#shape-panel-transparent-fill"),this.EditShapeContainer=f("#shape-button-edit-shape-container"),this.EditChangeShapeContainer=f("#shape-button-change-shape-container"),this.ShapeOnlySettings=f(".shape-only"),this.CanChangeType=f(".change-type"),this.RotationSettings=f(".shape-rotation"),this.NoFormSettings=f(".no-form"),this.ShapeOnlySeparator=f(".shape-only-separator")},setApi:function(t){return this.api=t,this.api&&(this.api.asc_registerCallback("asc_onImgWrapStyleChanged",v.bind(this._ImgWrapStyleChanged,this)),this.api.asc_setInterfaceDrawImagePlaceShape("shape-texture-img"),this.api.asc_registerCallback("asc_onInitStandartTextures",v.bind(this.onInitStandartTextures,this))),Common.NotificationCenter.on("storage:image-insert",v.bind(this.insertImageFromStorage,this)),this},setMode:function(t){this.mode=t},onFillSrcSelect:function(t,e){switch(this.ShowHideElem(e.value),e.value){case Asc.c_oAscFill.FILL_TYPE_SOLID:this._state.FillType=Asc.c_oAscFill.FILL_TYPE_SOLID,this._noApply||(o=new Asc.asc_CShapeProperty,(s=new Asc.asc_CShapeFill).put_type(Asc.c_oAscFill.FILL_TYPE_SOLID),s.put_fill(new Asc.asc_CFillSolid),s.get_fill().put_color(Common.Utils.ThemeColor.getRgbColor("transparent"==this.ShapeColor.Color?{color:"4f81bd",effectId:24}:this.ShapeColor.Color)),o.put_fill(s),this.imgprops.put_ShapeProperties(o),this.api.ImgApply(this.imgprops));break;case Asc.c_oAscFill.FILL_TYPE_GRAD:var i;this._state.FillType=Asc.c_oAscFill.FILL_TYPE_GRAD,this._noApply||(o=new Asc.asc_CShapeProperty,(s=new Asc.asc_CShapeFill).put_type(Asc.c_oAscFill.FILL_TYPE_GRAD),s.put_fill(new Asc.asc_CFillGrad),s.get_fill().put_grad_type(this.GradFillType),this.GradFillType==Asc.c_oAscFillGradType.GRAD_LINEAR&&(s.get_fill().put_linear_angle(6e4*this.GradLinearDirectionType),s.get_fill().put_linear_scale(!0)),this.OriginalFillType!==Asc.c_oAscFill.FILL_TYPE_GRAD&&(this.GradColor.values=[0,100],this.GradColor.colors=[this.GradColor.colors[0],this.GradColor.colors[this.GradColor.colors.length-1]],this.GradColor.currentIdx=0,i=Common.Utils.ThemeColor.getRgbColor(this.GradColor.colors[0]).get_color().get_hex(),n=Common.Utils.ThemeColor.getRgbColor(this.GradColor.colors[1]).get_color().get_hex(),i="ffffff"===i&&"ffffff"===n?{color:"4f81bd",effectId:24}:this.GradColor.colors[0],s.get_fill().put_positions([1e3*this.GradColor.values[0],1e3*this.GradColor.values[1]]),s.get_fill().put_colors([Common.Utils.ThemeColor.getRgbColor(i),Common.Utils.ThemeColor.getRgbColor(this.GradColor.colors[1])])),o.put_fill(s),this.imgprops.put_ShapeProperties(o),this.api.ImgApply(this.imgprops));break;case Asc.c_oAscFill.FILL_TYPE_BLIP:this._state.FillType=Asc.c_oAscFill.FILL_TYPE_BLIP;break;case Asc.c_oAscFill.FILL_TYPE_PATT:var n;this._state.FillType=Asc.c_oAscFill.FILL_TYPE_PATT,this._noApply||(o=new Asc.asc_CShapeProperty,(s=new Asc.asc_CShapeFill).put_type(Asc.c_oAscFill.FILL_TYPE_PATT),s.put_fill(new Asc.asc_CFillHatch),s.get_fill().put_pattern_type(this.PatternFillType),n=Common.Utils.ThemeColor.getRgbColor(this.FGColor.Color).get_color().get_hex(),n="ffffff"===Common.Utils.ThemeColor.getRgbColor(this.BGColor.Color).get_color().get_hex()&&"ffffff"===n?{color:"4f81bd",effectId:24}:this.FGColor.Color,s.get_fill().put_color_fg(Common.Utils.ThemeColor.getRgbColor(n)),s.get_fill().put_color_bg(Common.Utils.ThemeColor.getRgbColor(this.BGColor.Color)),o.put_fill(s),this.imgprops.put_ShapeProperties(o),this.api.ImgApply(this.imgprops));break;case Asc.c_oAscFill.FILL_TYPE_NOFILL:var o,s;this._state.FillType=Asc.c_oAscFill.FILL_TYPE_NOFILL,this._noApply||(o=new Asc.asc_CShapeProperty,(s=new Asc.asc_CShapeFill).put_type(Asc.c_oAscFill.FILL_TYPE_NOFILL),s.put_fill(null),o.put_fill(s),this.imgprops.put_ShapeProperties(o),this.api.ImgApply(this.imgprops))}this.fireEvent("editcomplete",this)},onColorsBackSelect:function(t,e){var i;this.ShapeColor={Value:1,Color:e},this.api&&!this._noApply&&(e=new Asc.asc_CShapeProperty,i=new Asc.asc_CShapeFill,"transparent"==this.ShapeColor.Color?(i.put_type(Asc.c_oAscFill.FILL_TYPE_NOFILL),i.put_fill(null)):(i.put_type(Asc.c_oAscFill.FILL_TYPE_SOLID),i.put_fill(new Asc.asc_CFillSolid),i.get_fill().put_color(Common.Utils.ThemeColor.getRgbColor(this.ShapeColor.Color))),e.put_fill(i),this.imgprops.put_ShapeProperties(e),this.api.ImgApply(this.imgprops)),this.fireEvent("editcomplete",this)},onPatternSelect:function(t,e){var i;this.api&&!this._noApply&&(this.PatternFillType=e.get("type"),e=new Asc.asc_CShapeProperty,(i=new Asc.asc_CShapeFill).put_type(Asc.c_oAscFill.FILL_TYPE_PATT),i.put_fill(new Asc.asc_CFillHatch),i.get_fill().put_pattern_type(this.PatternFillType),this.OriginalFillType!==Asc.c_oAscFill.FILL_TYPE_PATT&&(i.get_fill().put_color_fg(Common.Utils.ThemeColor.getRgbColor(this.FGColor.Color)),i.get_fill().put_color_bg(Common.Utils.ThemeColor.getRgbColor(this.BGColor.Color))),e.put_fill(i),this.imgprops.put_ShapeProperties(e),this.api.ImgApply(this.imgprops)),this.fireEvent("editcomplete",this)},onColorsFGSelect:function(t,e){var i;this.FGColor={Value:1,Color:e},this.api&&!this._noApply&&(e=new Asc.asc_CShapeProperty,(i=new Asc.asc_CShapeFill).put_type(Asc.c_oAscFill.FILL_TYPE_PATT),i.put_fill(new Asc.asc_CFillHatch),i.get_fill().put_color_fg(Common.Utils.ThemeColor.getRgbColor(this.FGColor.Color)),this.OriginalFillType!==Asc.c_oAscFill.FILL_TYPE_PATT&&(i.get_fill().put_pattern_type(this.PatternFillType),i.get_fill().put_color_bg(Common.Utils.ThemeColor.getRgbColor(this.BGColor.Color))),e.put_fill(i),this.imgprops.put_ShapeProperties(e),this.api.ImgApply(this.imgprops)),this.fireEvent("editcomplete",this)},onColorsBGSelect:function(t,e){var i;this.BGColor={Value:1,Color:e},this.api&&!this._noApply&&(e=new Asc.asc_CShapeProperty,(i=new Asc.asc_CShapeFill).put_type(Asc.c_oAscFill.FILL_TYPE_PATT),i.put_fill(new Asc.asc_CFillHatch),this.OriginalFillType!==Asc.c_oAscFill.FILL_TYPE_PATT&&(i.get_fill().put_pattern_type(this.PatternFillType),i.get_fill().put_color_fg(Common.Utils.ThemeColor.getRgbColor(this.FGColor.Color))),i.get_fill().put_color_bg(Common.Utils.ThemeColor.getRgbColor(this.BGColor.Color)),e.put_fill(i),this.imgprops.put_ShapeProperties(e),this.api.ImgApply(this.imgprops)),this.fireEvent("editcomplete",this)},onFillTypeSelect:function(t,e){var i;this.BlipFillType=e.value,this.api&&!0!==this._fromTextureCmb&&this.OriginalFillType==Asc.c_oAscFill.FILL_TYPE_BLIP&&(e=new Asc.asc_CShapeProperty,(i=new Asc.asc_CShapeFill).put_type(Asc.c_oAscFill.FILL_TYPE_BLIP),i.put_fill(new Asc.asc_CFillBlip),i.get_fill().put_type(this.BlipFillType),e.put_fill(i),this.imgprops.put_ShapeProperties(e),this.api.ImgApply(this.imgprops)),this.fireEvent("editcomplete",this)},onNumTransparencyChange:function(t,e,i,n){var o,s;this.sldrTransparency.setValue(t.getNumberValue(),!0),this.api&&(t=t.getNumberValue(),o=new Asc.asc_CShapeProperty,(s=new Asc.asc_CShapeFill).put_transparent(2.55*t),o.put_fill(s),this.imgprops.put_ShapeProperties(o),this.api.ImgApply(this.imgprops))},onTransparencyChange:function(t,e,i){this._sliderChanged=e,this.numTransparency.setValue(e,!0),this._sendUndoPoint&&(this.api.setStartPointHistory(),this._sendUndoPoint=!1,this.updateslider=setInterval(v.bind(this._transparencyApplyFunc,this),100))},onTransparencyChangeComplete:function(t,e,i){clearInterval(this.updateslider),this._sliderChanged=e,this._sendUndoPoint||(this.api.setEndPointHistory(),this._transparencyApplyFunc()),this._sendUndoPoint=!0},_transparencyApplyFunc:function(){var t,e;void 0!==this._sliderChanged&&(t=new Asc.asc_CShapeProperty,(e=new Asc.asc_CShapeFill).put_transparent(2.55*this._sliderChanged),t.put_fill(e),this.imgprops.put_ShapeProperties(t),this.api.ImgApply(this.imgprops),this._sliderChanged=void 0)},onGradTypeSelect:function(t,e){var i;this.GradFillType=e.value,this.GradFillType==Asc.c_oAscFillGradType.GRAD_LINEAR?(this.mnuDirectionPicker.store.reset(this._viewDataLinear),this.mnuDirectionPicker.cmpEl.width(175),this.mnuDirectionPicker.restoreHeight=174,e=this.mnuDirectionPicker.store.findWhere({type:this.GradLinearDirectionType}),this.mnuDirectionPicker.selectRecord(e,!0),this.typeGradient=e?this.GradLinearDirectionType+90:-1,this.numGradientAngle.setValue(this.GradLinearDirectionType,!0),this.numGradientAngle.setDisabled(this._locked)):this.GradFillType==Asc.c_oAscFillGradType.GRAD_PATH&&(this.mnuDirectionPicker.store.reset(this._viewDataRadial),this.mnuDirectionPicker.cmpEl.width(60),this.mnuDirectionPicker.restoreHeight=58,this.mnuDirectionPicker.selectByIndex(this.GradRadialDirectionIdx,!0),0<=this.GradRadialDirectionIdx?this.typeGradient=this._viewDataRadial[this.GradRadialDirectionIdx].type:this.typeGradient=-1,this.numGradientAngle.setValue(0,!0),this.numGradientAngle.setDisabled(!0)),this.api&&!this._noApply&&(e=new Asc.asc_CShapeProperty,(i=new Asc.asc_CShapeFill).put_type(Asc.c_oAscFill.FILL_TYPE_GRAD),i.put_fill(new Asc.asc_CFillGrad),i.get_fill().put_grad_type(this.GradFillType),this.GradFillType==Asc.c_oAscFillGradType.GRAD_LINEAR&&(i.get_fill().put_linear_angle(6e4*this.GradLinearDirectionType),i.get_fill().put_linear_scale(!0)),e.put_fill(i),this.imgprops.put_ShapeProperties(e),this.api.ImgApply(this.imgprops)),this.fireEvent("editcomplete",this)},onSelectGradient:function(t,e,i,n){if(!this._noApply){var o,s={};if(v.isFunction(n.toJSON)){if(!n.get("selected"))return;s=n.toJSON()}else s=n;this.GradFillType===Asc.c_oAscFillGradType.GRAD_LINEAR?(this.GradLinearDirectionType=s.type,this.typeGradient=s.type+90):(this.GradRadialDirectionIdx=0,this.typeGradient=s.type),this.api&&this.GradFillType==Asc.c_oAscFillGradType.GRAD_LINEAR&&(this.numGradientAngle.setValue(s.type,!0),n=new Asc.asc_CShapeProperty,(o=new Asc.asc_CShapeFill).put_type(Asc.c_oAscFill.FILL_TYPE_GRAD),o.put_fill(new Asc.asc_CFillGrad),o.get_fill().put_grad_type(this.GradFillType),o.get_fill().put_linear_angle(6e4*s.type),o.get_fill().put_linear_scale(!0),n.put_fill(o),this.imgprops.put_ShapeProperties(n),this.api.ImgApply(this.imgprops)),this.fireEvent("editcomplete",this)}},onColorsGradientSelect:function(t,e){var i,n;this.GradColor.colors[this.GradColor.currentIdx]=e,this.sldrGradient.setColorValue(Common.Utils.String.format("#{0}","object"==typeof e?e.color:e)),this.api&&!this._noApply&&(e=new Asc.asc_CShapeProperty,(i=new Asc.asc_CShapeFill).put_type(Asc.c_oAscFill.FILL_TYPE_GRAD),i.put_fill(new Asc.asc_CFillGrad),i.get_fill().put_grad_type(this.GradFillType),n=[],this.GradColor.colors.forEach(function(t){n.push(Common.Utils.ThemeColor.getRgbColor(t))}),i.get_fill().put_colors(n),this.OriginalFillType!==Asc.c_oAscFill.FILL_TYPE_GRAD&&(this.GradFillType==Asc.c_oAscFillGradType.GRAD_LINEAR&&(i.get_fill().put_linear_angle(6e4*this.GradLinearDirectionType),i.get_fill().put_linear_scale(!0)),n=[],this.GradColor.values.forEach(function(t){n.push(1e3*t)}),i.get_fill().put_positions(n)),e.put_fill(i),this.imgprops.put_ShapeProperties(e),this.api.ImgApply(this.imgprops)),this.fireEvent("editcomplete",this)},onGradientChange:function(t,e,i){this.GradColor.values=t.getValues();t=this.GradColor.values[this.GradColor.currentIdx];this.spnGradPosition.setValue(Common.UI.isRTL()?this.sldrGradient.maxValue-t:t,!0),this._sliderChanged=!0,this.api&&!this._noApply&&this._sendUndoPoint&&(this.api.setStartPointHistory(),this._sendUndoPoint=!1,this.updateslider=setInterval(v.bind(this._gradientApplyFunc,this),100))},onGradientChangeComplete:function(t,e,i){clearInterval(this.updateslider),this._sliderChanged=!0,this._sendUndoPoint||(this.api.setEndPointHistory(),this._gradientApplyFunc()),this._sendUndoPoint=!0},_gradientApplyFunc:function(){var t,e,i;this._sliderChanged&&(t=new Asc.asc_CShapeProperty,(e=new Asc.asc_CShapeFill).put_type(Asc.c_oAscFill.FILL_TYPE_GRAD),e.put_fill(new Asc.asc_CFillGrad),e.get_fill().put_grad_type(this.GradFillType),i=[],this.GradColor.values.forEach(function(t){i.push(1e3*t)}),e.get_fill().put_positions(i),this.GradFillType==Asc.c_oAscFillGradType.GRAD_LINEAR&&(e.get_fill().put_linear_angle(6e4*this.GradLinearDirectionType),e.get_fill().put_linear_scale(!0)),i=[],this.GradColor.colors.forEach(function(t){i.push(Common.Utils.ThemeColor.getRgbColor(t))}),e.get_fill().put_colors(i),t.put_fill(e),this.imgprops.put_ShapeProperties(t),this.api.ImgApply(this.imgprops),this._sliderChanged=!1)},applyBorderSize:function(t){var e;t=Common.Utils.String.parseFloat(t),t=isNaN(t)?0:Math.max(0,Math.min(1584,t)),this.BorderSize=t,this.api&&!this._noApply&&(t=new Asc.asc_CShapeProperty,e=new Asc.asc_CStroke,this.BorderSize<1e-5?(e.put_type(Asc.c_oAscStrokeType.STROKE_NONE),this._state.StrokeType=this._state.StrokeWidth=-1):(e.put_type(Asc.c_oAscStrokeType.STROKE_COLOR),"transparent"==this.BorderColor.Color||"transparent"==this.BorderColor.Color.color?e.put_color(Common.Utils.ThemeColor.getRgbColor({color:"000000",effectId:29})):this._state.StrokeType!=Asc.c_oAscStrokeType.STROKE_NONE&&null!==this._state.StrokeType||e.put_color(Common.Utils.ThemeColor.getRgbColor(Common.Utils.ThemeColor.colorValue2EffectId(this.BorderColor.Color))),e.asc_putPrstDash(this.BorderType),e.put_width(this._pt2mm(this.BorderSize)),e.put_transparent(this._state.LineTransparency)),t.put_stroke(e),this.imgprops.put_ShapeProperties(t),this.api.ImgApply(this.imgprops)),this.fireEvent("editcomplete",this)},onComboBlur:function(){this.fireEvent("editcomplete",this)},onBorderSizeChanged:function(t,e,i,n){var o=this;t?(t=parseFloat(i.value),(!new RegExp("^\\s*(\\d*(\\.|,)?\\d+)\\s*("+o.txtPt+")?\\s*$").exec(i.value)||t<0||1584<t)&&(this._state.StrokeType=this._state.StrokeWidth=-1,setTimeout(function(){Common.UI.error({msg:o.textBorderSizeErr,callback:function(){v.defer(function(t){o.fireEvent("editcomplete",o)})}})},10))):this.applyBorderSize(i.value)},onBorderSizeSelect:function(t,e){this.applyBorderSize(e.value)},onBorderTypeSelect:function(t,e){var i;this.BorderType=e.value,this.api&&!this._noApply&&(e=new Asc.asc_CShapeProperty,i=new Asc.asc_CStroke,this.BorderSize<1e-5?i.put_type(Asc.c_oAscStrokeType.STROKE_NONE):(i.put_type(Asc.c_oAscStrokeType.STROKE_COLOR),i.put_color(Common.Utils.ThemeColor.getRgbColor(this.BorderColor.Color)),i.put_width(this._pt2mm(this.BorderSize)),i.asc_putPrstDash(this.BorderType),i.put_transparent(this._state.LineTransparency)),e.put_stroke(i),this.imgprops.put_ShapeProperties(e),this.api.ImgApply(this.imgprops)),this.fireEvent("editcomplete",this)},onColorsBorderSelect:function(t,e){var i;this.BorderColor={Value:1,Color:e},this.api&&0<this.BorderSize&&!this._noApply&&(e=new Asc.asc_CShapeProperty,i=new Asc.asc_CStroke,this.BorderSize<1e-5?i.put_type(Asc.c_oAscStrokeType.STROKE_NONE):(i.put_type(Asc.c_oAscStrokeType.STROKE_COLOR),i.put_color(Common.Utils.ThemeColor.getRgbColor(this.BorderColor.Color)),i.put_width(this._pt2mm(this.BorderSize)),i.asc_putPrstDash(this.BorderType),i.put_transparent(this._state.LineTransparency)),e.put_stroke(i),this.imgprops.put_ShapeProperties(e),this.api.ImgApply(this.imgprops)),this.fireEvent("editcomplete",this)},onNumLineTransparencyChange:function(t,e,i,n){var o;this.sldrLineTransparency.setValue(t.getNumberValue(),!0),this._state.LineTransparency=2.55*t.getNumberValue(),this.api&&0<this.BorderSize&&!this._noApply&&(t=new Asc.asc_CShapeProperty,(o=new Asc.asc_CStroke).put_transparent(this._state.LineTransparency),t.put_stroke(o),this.imgprops.put_ShapeProperties(t),this.api.ImgApply(this.imgprops))},onLineTransparencyChange:function(t,e,i){this.numLineTransparency.setValue(e,!0),this._sliderChangedLine=e,this._sendUndoPoint&&(this.api.setStartPointHistory(),this._sendUndoPoint=!1,this.updatesliderline=setInterval(v.bind(this._transparencyLineApplyFunc,this),100))},onLineTransparencyChangeComplete:function(t,e,i){clearInterval(this.updatesliderline),this._sliderChangedLine=e,this._sendUndoPoint||(this.api.setEndPointHistory(),this._transparencyLineApplyFunc()),this._sendUndoPoint=!0},_transparencyLineApplyFunc:function(){var t,e;void 0!==this._sliderChangedLine&&(this._state.LineTransparency=2.55*this._sliderChangedLine,t=new Asc.asc_CShapeProperty,(e=new Asc.asc_CStroke).put_transparent(this._state.LineTransparency),t.put_stroke(e),this.imgprops.put_ShapeProperties(t),this.api.ImgApply(this.imgprops),this._sliderChangedLine=void 0)},_ImgWrapStyleChanged:function(t){var e;this.cmbWrapType&&this._state.WrappingStyle!==t&&(this.cmbWrapType.suspendEvents(),e=this.cmbWrapType.menuPicker.store.findWhere({data:t}),this.cmbWrapType.menuPicker.selectRecord(e),this.cmbWrapType.resumeEvents(),this._state.WrappingStyle=t)},onSelectWrap:function(t,e){var i;this.api&&(i=new Asc.asc_CImgProperty,e=e.get("data"),i.put_WrappingStyle(e),this._state.WrappingStyle===Asc.c_oAscWrapStyle2.Inline&&e!==Asc.c_oAscWrapStyle2.Inline&&(i.put_PositionH(new Asc.CImagePositionH),i.get_PositionH().put_UseAlign(!1),i.get_PositionH().put_RelativeFrom(Asc.c_oAscRelativeFromH.Column),e=this._originalProps.get_Value_X(Asc.c_oAscRelativeFromH.Column),i.get_PositionH().put_Value(e),i.put_PositionV(new Asc.CImagePositionV),i.get_PositionV().put_UseAlign(!1),i.get_PositionV().put_RelativeFrom(Asc.c_oAscRelativeFromV.Paragraph),e=this._originalProps.get_Value_Y(Asc.c_oAscRelativeFromV.Paragraph),i.get_PositionV().put_Value(e)),this.api.ImgApply(i)),this.fireEvent("editcomplete",this)},setImageUrl:function(t,e){var i,n;null!==this.BlipFillType&&(i=new Asc.asc_CShapeProperty,(n=new Asc.asc_CShapeFill).put_type(Asc.c_oAscFill.FILL_TYPE_BLIP),n.put_fill(new Asc.asc_CFillBlip),n.get_fill().put_type(this.BlipFillType),n.get_fill().put_url(t,e),i.put_fill(n),this.imgprops.put_ShapeProperties(i),this.api.ImgApply(this.imgprops))},insertImageFromStorage:function(t){t&&t._urls&&"fill"==t.c&&this.setImageUrl(t._urls[0],t.token)},onImageSelect:function(t,e){var i;1==e.value?(i=this,new Common.Views.ImageFromUrlDialog({handler:function(t,e){"ok"==t&&i.api&&(t=e.replace(/ /g,""),v.isEmpty(t)||i.setImageUrl(t)),i.fireEvent("editcomplete",i)}}).show()):2==e.value?Common.NotificationCenter.trigger("storage:image-load","fill"):(this.api&&this.api.ChangeShapeImageFromFile(this.BlipFillType),this.fireEvent("editcomplete",this))},openAdvancedSettings:function(t){if(!this.linkAdvanced.hasClass("disabled")){var i=this;if(i.api&&!this._locked){var e=i.api.getSelectedElements();if(e&&0<e.length)for(var n,o,s=e.length-1;0<=s;s--)if(n=e[s].get_ObjectType(),o=e[s].get_ObjectValue(),Asc.c_oAscTypeSelectElement.Image==n){new DE.Views.ImageSettingsAdvanced({imageProps:o,api:i.api,sectionProps:i.api.asc_GetSectionProps(),handler:function(t,e){"ok"==t&&i.api&&i.api.ImgApply(e.imageProps),i.fireEvent("editcomplete",i)}}).show();break}}}},ChangeSettings:function(t){null==this.imgprops?this.imgprops=new Asc.asc_CImgProperty:this.imgprops.put_ImageUrl(null),this._initSettings&&this.createDelayedElements();var e=this.api.asc_IsContentControl()?this.api.asc_GetContentControlProperties():null;if(e=!!e&&(((i=e.get_SpecificType())==Asc.c_oAscContentControlSpecificType.CheckBox||i==Asc.c_oAscContentControlSpecificType.ComboBox||i==Asc.c_oAscContentControlSpecificType.DropDownList||i==Asc.c_oAscContentControlSpecificType.None||i==Asc.c_oAscContentControlSpecificType.Picture||i==Asc.c_oAscContentControlSpecificType.Complex||i==Asc.c_oAscContentControlSpecificType.DateTime)&&e.get_FormPr()&&e.get_FormPr().get_Fixed()),t&&t.get_ShapeProperties()){var i=t.get_ShapeProperties(),n=i.asc_getType(),n=(this._originalProps=new Asc.asc_CImgProperty(t),this._noApply=!0,this._state.isFromImage=!!i.get_FromImage(),this._state.isFromSmartArtInternal=!!i.get_FromSmartArtInternal(),this.disableControls(this._locked,!i.get_CanFill()),this.hideShapeOnlySettings(i.get_FromChart()||!!i.get_FromImage()),this.hideRotationSettings(i.get_FromChart()||!!i.get_FromImage()||i.get_FromSmartArt()),this.canEditPoint=this.api&&this.api.asc_canEditGeometry(),this.toggleBtnEditShape(),i.get_FromChart()||i.get_FromSmartArt()||"line"==n||"bentConnector2"==n||"bentConnector3"==n||"bentConnector4"==n||"bentConnector5"==n||"curvedConnector2"==n||"curvedConnector3"==n||"curvedConnector4"==n||"curvedConnector5"==n||"straightConnector1"==n),n=(this.hideChangeTypeSettings(n||e),!n&&this.btnChangeShape.menu.items.length&&this.btnChangeShape.shapePicker.hideTextRect(i.get_FromImage()||this._state.isFromSmartArtInternal),t.get_WrappingStyle()),t=(this._state.WrappingStyle!==n&&(this.cmbWrapType.suspendEvents(),o=this.cmbWrapType.menuPicker.store.findWhere({data:n}),this.cmbWrapType.menuPicker.selectRecord(o),this.cmbWrapType.resumeEvents(),this._state.WrappingStyle=n),n=t.get_CanBeFlow()&&!this._locked,t.get_FromGroup()||this._locked),o=(this.cmbWrapType.setDisabled(!n||t),this._state.CanBeFlow=n,this._state.FromGroup=t,null),s=(t=i.get_fill()).get_type(),a=null,l=t.get_transparent();if(!(.001<Math.abs(this._state.Transparency-l)||.001<Math.abs(this.numTransparency.getNumberValue()-l))&&(null!==this._state.Transparency&&null!==l||this._state.Transparency===l&&this.numTransparency.getNumberValue()===l)||(void 0!==l&&(this.sldrTransparency.setValue(null===l?100:l/255*100,!0),this.numTransparency.setValue(this.sldrTransparency.getValue(),!0)),this._state.Transparency=l),null===t||null===s)this.OriginalFillType=null;else if(s==Asc.c_oAscFill.FILL_TYPE_NOFILL)this.OriginalFillType=Asc.c_oAscFill.FILL_TYPE_NOFILL;else if(s==Asc.c_oAscFill.FILL_TYPE_SOLID)(a=(t=t.get_fill()).get_color())?a.get_type()==Asc.c_oAscColor.COLOR_TYPE_SCHEME?this.ShapeColor={Value:1,Color:{color:Common.Utils.ThemeColor.getHexColor(a.get_r(),a.get_g(),a.get_b()),effectValue:a.get_value()}}:this.ShapeColor={Value:1,Color:Common.Utils.ThemeColor.getHexColor(a.get_r(),a.get_g(),a.get_b())}:this.ShapeColor={Value:0,Color:"transparent"},this.OriginalFillType=Asc.c_oAscFill.FILL_TYPE_SOLID,this.FGColor="transparent"!==this.ShapeColor.Color?{Value:1,Color:Common.Utils.ThemeColor.colorValue2EffectId(this.ShapeColor.Color)}:{Value:1,Color:"000000"},this.BGColor={Value:1,Color:"ffffff"},this.GradColor.colors[0]="transparent"!==this.ShapeColor.Color?Common.Utils.ThemeColor.colorValue2EffectId(this.ShapeColor.Color):"000000",this.GradColor.colors[this.GradColor.colors.length-1]="ffffff";else if(s==Asc.c_oAscFill.FILL_TYPE_BLIP)t=t.get_fill(),this.BlipFillType=t.get_type(),this._state.BlipFillType!==this.BlipFillType&&(this.BlipFillType==Asc.c_oAscFillBlipType.STRETCH||this.BlipFillType==Asc.c_oAscFillBlipType.TILE?this.cmbFillType.setValue(this.BlipFillType):this.cmbFillType.setValue(""),this._state.BlipFillType=this.BlipFillType),this.OriginalFillType=Asc.c_oAscFill.FILL_TYPE_BLIP;else if(s==Asc.c_oAscFill.FILL_TYPE_PATT){t=t.get_fill();this.PatternFillType=t.get_pattern_type(),this._state.PatternFillType!==this.PatternFillType&&(this.cmbPattern.suspendEvents(),o=this.cmbPattern.menuPicker.store.findWhere({type:this.PatternFillType}),this.cmbPattern.menuPicker.selectRecord(o),this.cmbPattern.resumeEvents(),this._state.PatternFillType=this.PatternFillType),(a=t.get_color_fg())?a.get_type()==Asc.c_oAscColor.COLOR_TYPE_SCHEME?this.FGColor={Value:1,Color:{color:Common.Utils.ThemeColor.getHexColor(a.get_r(),a.get_g(),a.get_b()),effectValue:a.get_value()}}:this.FGColor={Value:1,Color:Common.Utils.ThemeColor.getHexColor(a.get_r(),a.get_g(),a.get_b())}:this.FGColor={Value:1,Color:"000000"},(a=t.get_color_bg())?a.get_type()==Asc.c_oAscColor.COLOR_TYPE_SCHEME?this.BGColor={Value:1,Color:{color:Common.Utils.ThemeColor.getHexColor(a.get_r(),a.get_g(),a.get_b()),effectValue:a.get_value()}}:this.BGColor={Value:1,Color:Common.Utils.ThemeColor.getHexColor(a.get_r(),a.get_g(),a.get_b())}:this.BGColor={Value:1,Color:"ffffff"},this.OriginalFillType=Asc.c_oAscFill.FILL_TYPE_PATT,this.ShapeColor={Value:1,Color:Common.Utils.ThemeColor.colorValue2EffectId(this.FGColor.Color)},this.GradColor.colors[0]=Common.Utils.ThemeColor.colorValue2EffectId(this.FGColor.Color),this.GradColor.colors[this.GradColor.colors.length-1]="ffffff"}else if(s==Asc.c_oAscFill.FILL_TYPE_GRAD){for(var s=(t=t.get_fill()).get_grad_type(),r=(this._state.GradFillType===s&&this.GradFillType===s||(this.GradFillType=s,o=void 0,this.GradFillType==Asc.c_oAscFillGradType.GRAD_LINEAR||this.GradFillType==Asc.c_oAscFillGradType.GRAD_PATH?(this.cmbGradType.setValue(this.GradFillType),o=this.cmbGradType.store.findWhere({value:this.GradFillType}),this.onGradTypeSelect(this.cmbGradType,o.attributes)):(this.cmbGradType.setValue(""),this.btnDirection.setIconCls("")),this._state.GradFillType=this.GradFillType),this.GradFillType==Asc.c_oAscFillGradType.GRAD_LINEAR?(n=Math.floor(t.get_linear_angle()/6e4),.001<Math.abs(this.GradLinearDirectionType-n)&&(this.GradLinearDirectionType=n,s=this.mnuDirectionPicker.store.findWhere({type:n}),this.mnuDirectionPicker.selectRecord(s,!0),this.typeGradient=s?n+90:-1,this.numGradientAngle.setValue(n,!0))):this.numGradientAngle.setValue(0,!0),this),o=t.get_colors(),c=t.get_positions(),d=(o||this.GradColor.colors).length,h=(this.sldrGradient.setThumbs(d),this.GradColor.colors.length>d&&(this.GradColor.colors.splice(d,this.GradColor.colors.length-d),this.GradColor.values.splice(d,this.GradColor.colors.length-d),this.GradColor.currentIdx=0),o&&o.forEach(function(t,e){t?t.get_type()==Asc.c_oAscColor.COLOR_TYPE_SCHEME?(r.GradColor.colors[e]={color:Common.Utils.ThemeColor.getHexColor(t.get_r(),t.get_g(),t.get_b()),effectValue:t.get_value()},Common.Utils.ThemeColor.colorValue2EffectId(r.GradColor.colors[e])):r.GradColor.colors[e]=Common.Utils.ThemeColor.getHexColor(t.get_r(),t.get_g(),t.get_b()):r.GradColor.colors[e]="000000";t=c[e];null!==t&&(r.GradColor.values[e]=t/=1e3)}),[]),m=this.GradFillType==Asc.c_oAscFillGradType.GRAD_LINEAR?1:.7,p=0;p<d;p++)r.sldrGradient.setColorValue(Common.Utils.String.format("#{0}","object"==typeof r.GradColor.colors[p]?r.GradColor.colors[p].color:r.GradColor.colors[p]),p),r.sldrGradient.setValue(p,r.GradColor.values[p]),h.push(r.sldrGradient.getColorValue(p)+" "+r.sldrGradient.getValue(p)*m+"%");this.btnDirectionRedraw(r.sldrGradient,h.join(", ")),(v.isUndefined(r.GradColor.currentIdx)||r.GradColor.currentIdx>=this.GradColor.colors.length)&&(r.GradColor.currentIdx=0),r.sldrGradient.setActiveThumb(r.GradColor.currentIdx);s=this.GradColor.values[this.GradColor.currentIdx];this.spnGradPosition.setValue(Common.UI.isRTL()?this.sldrGradient.maxValue-s:s),this.OriginalFillType=Asc.c_oAscFill.FILL_TYPE_GRAD,this.FGColor={Value:1,Color:this.GradColor.colors[0]},this.BGColor={Value:1,Color:"ffffff"},this.ShapeColor={Value:1,Color:this.GradColor.colors[0]}}this._state.FillType!==this.OriginalFillType&&(this.cmbFillSrc.setValue(null===this.OriginalFillType?"":this.OriginalFillType),this._state.FillType=this.OriginalFillType,this.ShowHideElem(this.OriginalFillType)),f(this.btnTexture.el).find(".form-control").prop("innerHTML",this.textSelectTexture);n=typeof this.ShapeColor.Color;if(n!=typeof this._state.ShapeColor||"object"==n&&(this.ShapeColor.Color.effectValue!==this._state.ShapeColor.effectValue||this._state.ShapeColor.color.indexOf(this.ShapeColor.Color.color)<0)||"object"!=n&&this._state.ShapeColor.indexOf(this.ShapeColor.Color)<0){if(this.btnBackColor.setColor(this.ShapeColor.Color),"object"==typeof this.ShapeColor.Color){for(var u=!1,g=0;g<10;g++)if(Common.Utils.ThemeColor.ThemeValues[g]==this.ShapeColor.Color.effectValue){this.colorsBack.select(this.ShapeColor.Color,!0),u=!0;break}u||this.colorsBack.clearSelection()}else this.colorsBack.select(this.ShapeColor.Color,!0);this._state.ShapeColor=this.ShapeColor.Color}var b,C,t=i.get_stroke(),o=t.get_type(),s="transparent"==this._state.StrokeColor&&"transparent"!==this.BorderColor.Color;if(t?(l=t.get_transparent(),(.001<Math.abs(this._state.LineTransparency-l)||.001<Math.abs(this.numLineTransparency.getNumberValue()-l)||!(null!==this._state.LineTransparency&&null!==l||this._state.LineTransparency===l&&this.numLineTransparency.getNumberValue()===l))&&(void 0!==l&&(this.sldrLineTransparency.setValue(null===l?100:l/255*100,!0),this.numLineTransparency.setValue(this.sldrLineTransparency.getValue(),!0)),this._state.LineTransparency=l),o==Asc.c_oAscStrokeType.STROKE_COLOR&&(a=t.get_color())?a.get_type()==Asc.c_oAscColor.COLOR_TYPE_SCHEME?this.BorderColor={Value:1,Color:{color:Common.Utils.ThemeColor.getHexColor(a.get_r(),a.get_g(),a.get_b()),effectValue:a.get_value()}}:this.BorderColor={Value:1,Color:Common.Utils.ThemeColor.getHexColor(a.get_r(),a.get_g(),a.get_b())}:this.BorderColor={Value:1,Color:"transparent"},b=t.asc_getPrstDash()):(o=null,this.BorderColor={Value:0,Color:"transparent"}),n=typeof this.BorderColor.Color,l=typeof this._state.StrokeColor,s||n!=l||"object"==n&&(this.BorderColor.Color.effectValue!==this._state.StrokeColor.effectValue||this._state.StrokeColor.color.indexOf(this.BorderColor.Color.color)<0)||"object"!=n&&(this._state.StrokeColor.indexOf(this.BorderColor.Color)<0||"object"==typeof this.btnBorderColor.color)){if(this.btnBorderColor.setColor(this.BorderColor.Color),"object"==typeof this.BorderColor.Color){for(u=!1,g=0;g<10;g++)if(Common.Utils.ThemeColor.ThemeValues[g]==this.BorderColor.Color.effectValue){this.colorsBorder.select(this.BorderColor.Color,!0),u=!0;break}u||this.colorsBorder.clearSelection()}else this.colorsBorder.select(this.BorderColor.Color,!0);this._state.StrokeColor=this.BorderColor.Color}if(this._state.StrokeType===o&&o!=Asc.c_oAscStrokeType.STROKE_COLOR||(o==Asc.c_oAscStrokeType.STROKE_COLOR?(C=t.get_width(),s=Math.abs(this._state.StrokeWidth-C)<1e-5&&!new RegExp(this.txtPt+"\\s*$").test(this.cmbBorderSize.getRawValue()),(1e-5<Math.abs(this._state.StrokeWidth-C)||s||(null===this._state.StrokeWidth||null===C)&&this._state.StrokeWidth!==C)&&((l=null===(C=null!==(this._state.StrokeWidth=C)?this._mm2pt(C):C)?C:v.find(this.cmbBorderSize.store.models,function(t){if(C<t.attributes.value+1e-4&&C>t.attributes.value-1e-4)return!0}))?this.cmbBorderSize.selectRecord(l):this.cmbBorderSize.setValue(null!==C?parseFloat(C.toFixed(2))+" "+this.txtPt:""),this.BorderSize=C)):o==Asc.c_oAscStrokeType.STROKE_NONE?(this._state.StrokeWidth=0,this.BorderSize=this.cmbBorderSize.store.at(0).get("value"),this.cmbBorderSize.setValue(this.BorderSize)):(this._state.StrokeWidth=null,this.BorderSize=-1,this.cmbBorderSize.setValue(null)),this._state.StrokeType=o),this._state.StrokeBorderType!==b&&(this.BorderType=this._state.StrokeBorderType=b,this.cmbBorderType.setValue(b)),(n=typeof this.FGColor.Color)!=typeof this._state.FGColor||"object"==n&&(this.FGColor.Color.effectValue!==this._state.FGColor.effectValue||this._state.FGColor.color.indexOf(this.FGColor.Color.color)<0)||"object"!=n&&this._state.FGColor.indexOf(this.FGColor.Color)<0){if(this.btnFGColor.setColor(this.FGColor.Color),"object"==typeof this.FGColor.Color){for(u=!1,g=0;g<10;g++)if(Common.Utils.ThemeColor.ThemeValues[g]==this.FGColor.Color.effectValue){this.colorsFG.select(this.FGColor.Color,!0),u=!0;break}u||this.colorsFG.clearSelection()}else this.colorsFG.select(this.FGColor.Color,!0);this._state.FGColor=this.FGColor.Color}if((n=typeof this.BGColor.Color)!=typeof this._state.BGColor||"object"==n&&(this.BGColor.Color.effectValue!==this._state.BGColor.effectValue||this._state.BGColor.color.indexOf(this.BGColor.Color.color)<0)||"object"!=n&&this._state.BGColor.indexOf(this.BGColor.Color)<0){if(this.btnBGColor.setColor(this.BGColor.Color),"object"==typeof this.BGColor.Color){for(u=!1,g=0;g<10;g++)if(Common.Utils.ThemeColor.ThemeValues[g]==this.BGColor.Color.effectValue){this.colorsBG.select(this.BGColor.Color,!0),u=!0;break}u||this.colorsBG.clearSelection()}else this.colorsBG.select(this.BGColor.Color,!0);this._state.BGColor=this.BGColor.Color}if((n=typeof(a=this.GradColor.colors[this.GradColor.currentIdx]))!=typeof this._state.GradColor||"object"==n&&(a.effectValue!==this._state.GradColor.effectValue||this._state.GradColor.color.indexOf(a.color)<0)||"object"!=n&&this._state.GradColor.indexOf(a)<0){if(this.btnGradColor.setColor(a),"object"==typeof a){for(u=!1,g=0;g<10;g++)if(Common.Utils.ThemeColor.ThemeValues[g]==a.effectValue){this.colorsGrad.select(a,!0),u=!0;break}u||this.colorsGrad.clearSelection()}else this.colorsGrad.select(a,!0);this._state.GradColor=a}this.chShadow.setDisabled(!!i.get_FromChart()||this._locked),this.chShadow.setValue(!!i.asc_getShadow(),!0),this._noApply=!1}this.hideNoFormSettings(e),this.ShapeOnlySeparator.toggleClass("hidden",!0===(e||this._state.HideShapeOnlySettings||this._state.HideRotationSettings))},btnDirectionRedraw:function(t,e){this.gradientColorsStr=e,v.each(this._viewDataLinear,function(t){t.gradientColorsStr=e}),this._viewDataRadial.gradientColorsStr=this.gradientColorsStr,this.mnuDirectionPicker.store.each(function(t){t.set("gradientColorsStr",e)},this),-1==this.typeGradient?this.btnDirection.$icon.css({background:"none"}):2==this.typeGradient?this.btnDirection.$icon.css({background:"radial-gradient("+e+")"}):this.btnDirection.$icon.css({background:"linear-gradient("+this.typeGradient+"deg, "+e+")"})},createDelayedControls:function(){var o=this,t=(this._arrFillSrc=[{displayValue:this.textNoFill,value:Asc.c_oAscFill.FILL_TYPE_NOFILL},{displayValue:this.textColor,value:Asc.c_oAscFill.FILL_TYPE_SOLID},{displayValue:this.textGradientFill,value:Asc.c_oAscFill.FILL_TYPE_GRAD},{displayValue:this.textImageTexture,value:Asc.c_oAscFill.FILL_TYPE_BLIP},{displayValue:this.textPatternFill,value:Asc.c_oAscFill.FILL_TYPE_PATT}],this.cmbFillSrc=new Common.UI.ComboBox({el:f("#shape-combo-fill-src"),cls:"input-group-nr",style:"width: 100%;",menuStyle:"min-width: 100%;",editable:!1,data:this._arrFillSrc,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbFillSrc.setValue(this._arrFillSrc[0].value),this.cmbFillSrc.on("selected",v.bind(this.onFillSrcSelect,this)),this.fillControls.push(this.cmbFillSrc),this.cmbPattern=new Common.UI.ComboDataView({itemWidth:28,itemHeight:28,menuMaxHeight:300,enableKeyEvents:!0,cls:"combo-pattern",dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big",itemTemplate:v.template(['<div class="style" id="<%= id %>">','<img src="data:image/gif;base64,R0lGODlhAQABAID/AMDAwAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" class="combo-pattern-item" ','width="28" height="28" ','style="background-position: -<%= offsetx %>px -<%= offsety %>px;"/>',"</div>"].join(""))}),this.cmbPattern.render(f("#shape-combo-pattern")),this.cmbPattern.openButton.menu.cmpEl.css({"min-width":178,"max-width":178}),this.cmbPattern.on("click",v.bind(this.onPatternSelect,this)),this.cmbPattern.openButton.menu.on("show:after",function(){o.cmbPattern.menuPicker.scroller.update({alwaysVisibleY:!0})}),this.fillControls.push(this.cmbPattern),this.btnSelectImage=new Common.UI.Button({parentEl:f("#shape-button-replace"),cls:"btn-text-menu-default",caption:this.textSelectImage,style:"width:100%;",menu:new Common.UI.Menu({style:"min-width: 194px;",maxHeight:200,items:[{caption:this.textFromFile,value:0},{caption:this.textFromUrl,value:1},{caption:this.textFromStorage,value:2}]}),dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.fillControls.push(this.btnSelectImage),this.btnSelectImage.menu.on("item:click",v.bind(this.onImageSelect,this)),this.btnSelectImage.menu.items[2].setVisible(this.mode.canRequestInsertImage||this.mode.fileChoiceUrl&&-1<this.mode.fileChoiceUrl.indexOf("{documentType}")),this._arrFillType=[{displayValue:this.textStretch,value:Asc.c_oAscFillBlipType.STRETCH},{displayValue:this.textTile,value:Asc.c_oAscFillBlipType.TILE}],this.cmbFillType=new Common.UI.ComboBox({el:f("#shape-combo-fill-type"),cls:"input-group-nr",menuStyle:"min-width: 90px;",editable:!1,data:this._arrFillType,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbFillType.setValue(this._arrFillType[0].value),this.cmbFillType.on("selected",v.bind(this.onFillTypeSelect,this)),this.fillControls.push(this.cmbFillType),this.numTransparency=new Common.UI.MetricSpinner({el:f("#shape-spin-transparency"),step:1,width:62,value:"100 %",defaultUnit:"%",maxValue:100,minValue:0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.numTransparency.on("change",v.bind(this.onNumTransparencyChange,this)),this.numTransparency.on("inputleave",function(){o.fireEvent("editcomplete",o)}),this.fillControls.push(this.numTransparency),this.sldrTransparency=new Common.UI.SingleSlider({el:f("#shape-slider-transparency"),width:75,minValue:0,maxValue:100,value:100}),this.sldrTransparency.on("change",v.bind(this.onTransparencyChange,this)),this.sldrTransparency.on("changecomplete",v.bind(this.onTransparencyChangeComplete,this)),this.fillControls.push(this.sldrTransparency),this.lblTransparencyStart=f(this.el).find("#shape-lbl-transparency-start"),this.lblTransparencyEnd=f(this.el).find("#shape-lbl-transparency-end"),this._arrGradType=[{displayValue:this.textLinear,value:Asc.c_oAscFillGradType.GRAD_LINEAR},{displayValue:this.textRadial,value:Asc.c_oAscFillGradType.GRAD_PATH}],this.cmbGradType=new Common.UI.ComboBox({el:f("#shape-combo-grad-type"),cls:"input-group-nr",menuStyle:"min-width: 100%;",editable:!1,data:this._arrGradType,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbGradType.setValue(this._arrGradType[0].value),this.cmbGradType.on("selected",v.bind(this.onGradTypeSelect,this)),this.fillControls.push(this.cmbGradType),this._viewDataLinear=[{type:45,subtype:-1},{type:90,subtype:4},{type:135,subtype:5},{type:0,subtype:6,cls:"item-gradient-separator",selected:!0},{type:180,subtype:1},{type:315,subtype:2},{type:270,subtype:3},{type:225,subtype:7}],v.each(this._viewDataLinear,function(t){t.gradientColorsStr=o.gradientColorsStr}),this._viewDataRadial=[{type:2,subtype:5,gradientColorsStr:this.gradientColorsStr}],this.btnDirection=new Common.UI.Button({cls:"btn-large-dataview",scaling:!1,iconCls:"item-gradient",menu:new Common.UI.Menu({style:"min-width: 60px;",menuAlign:"tr-br",items:[{template:v.template('<div id="id-shape-menu-direction" style="width: 175px; margin: 0 5px;"></div>')}]}),dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.btnDirection.on("render:after",function(t){o.mnuDirectionPicker=new Common.UI.DataView({el:f("#id-shape-menu-direction"),parentMenu:t.menu,restoreHeight:174,allowScrollbar:!1,store:new Common.UI.DataViewStore(o._viewDataLinear),itemTemplate:v.template('<div id="<%= id %>" class="item-gradient" style="background: <% if(type!=2) {%>linear-gradient(<%= type + 90 %>deg,<%= gradientColorsStr %>) <%} else {%> radial-gradient(<%= gradientColorsStr %>) <%}%>;"></div>')})}),this.btnDirection.render(f("#shape-button-direction")),this.mnuDirectionPicker.on("item:click",v.bind(this.onSelectGradient,this,this.btnDirection)),this.fillControls.push(this.btnDirection),this.sldrGradient=new Common.UI.MultiSliderGradient({el:f("#shape-slider-gradient"),width:192,minValue:0,maxValue:100,values:[0,100]}),this.sldrGradient.on("change",v.bind(this.onGradientChange,this)),this.sldrGradient.on("changecomplete",v.bind(this.onGradientChangeComplete,this)),this.sldrGradient.on("thumbclick",function(t,e){o.GradColor.currentIdx=e;e=o.GradColor.colors[o.GradColor.currentIdx],o.btnGradColor.setColor(e),o.colorsGrad.select(e,!1),e=o.GradColor.values[o.GradColor.currentIdx];o.spnGradPosition.setValue(Common.UI.isRTL()?o.sldrGradient.maxValue-e:e,!0)}),this.sldrGradient.on("thumbdblclick",function(t){o.btnGradColor.cmpEl.find("button").dropdown("toggle")}),this.sldrGradient.on("sortthumbs",function(t,e){var i,n=[];v.each(e,function(t,e){n.push(o.GradColor.colors[t]),o.GradColor.currentIdx==t&&(i=e)}),o.OriginalFillType=null,o.GradColor.colors=n,o.GradColor.currentIdx=i}),this.sldrGradient.on("addthumb",function(t,e,i){o.GradColor.colors[e]=o.GradColor.colors[o.GradColor.currentIdx],o.GradColor.currentIdx=e;e=o.sldrGradient.addNewThumb(e,i);o.GradColor.colors[o.GradColor.currentIdx]=e}),this.sldrGradient.on("removethumb",function(t,e){o.sldrGradient.removeThumb(e),o.GradColor.values.splice(e,1),o.sldrGradient.changeGradientStyle(),(v.isUndefined(o.GradColor.currentIdx)||o.GradColor.currentIdx>=o.GradColor.colors.length)&&(e=0===(e=0<e?e-1:e)&&2<o.GradColor.values.length?o.GradColor.values.length-2:e,o.GradColor.currentIdx=e),o.sldrGradient.setActiveThumb(o.GradColor.currentIdx)}),this.fillControls.push(this.sldrGradient),this.spnGradPosition=new Common.UI.MetricSpinner({el:f("#shape-gradient-position"),step:1,width:60,defaultUnit:"%",value:"50 %",allowDecimal:!1,maxValue:100,minValue:0,disabled:this._locked,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.fillControls.push(this.spnGradPosition),this.spnGradPosition.on("change",v.bind(this.onPositionChange,this)),this.spnGradPosition.on("inputleave",function(){o.fireEvent("editcomplete",o)}),this.btnAddGradientStep=new Common.UI.Button({parentEl:f("#shape-gradient-add-step"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-add-breakpoint",disabled:this._locked,hint:this.tipAddGradientPoint,dataHint:"1",dataHintDirection:"bottom"}),this.btnAddGradientStep.on("click",v.bind(this.onAddGradientStep,this)),this.fillControls.push(this.btnAddGradientStep),this.btnRemoveGradientStep=new Common.UI.Button({parentEl:f("#shape-gradient-remove-step"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-remove-breakpoint",disabled:this._locked,hint:this.tipRemoveGradientPoint,dataHint:"1",dataHintDirection:"bottom"}),this.btnRemoveGradientStep.on("click",v.bind(this.onRemoveGradientStep,this)),this.fillControls.push(this.btnRemoveGradientStep),this.numGradientAngle=new Common.UI.MetricSpinner({el:f("#shape-spin-gradient-angle"),step:10,width:60,defaultUnit:"°",value:"0 °",allowDecimal:!0,maxValue:359.9,minValue:0,disabled:this._locked,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.fillControls.push(this.numGradientAngle),this.numGradientAngle.on("change",v.bind(this.onGradientAngleChange,this)),this.numGradientAngle.on("inputleave",function(){o.fireEvent("editcomplete",o)}),this.cmbBorderSize=new Common.UI.ComboBorderSizeEditable({el:f("#shape-combo-border-size"),style:"width: 93px;",txtNoBorders:this.txtNoBorders,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}).on("selected",v.bind(this.onBorderSizeSelect,this)).on("changed:before",v.bind(this.onBorderSizeChanged,this,!0)).on("changed:after",v.bind(this.onBorderSizeChanged,this,!1)).on("combo:blur",v.bind(this.onComboBlur,this,!1)),this.BorderSize=this.cmbBorderSize.store.at(2).get("value"),this.cmbBorderSize.setValue(this.BorderSize),this.lockedControls.push(this.cmbBorderSize),this.cmbBorderType=new Common.UI.ComboBorderType({el:f("#shape-combo-border-type"),style:"width: 93px;",menuStyle:"min-width: 93px;",dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}).on("selected",v.bind(this.onBorderTypeSelect,this)).on("combo:blur",v.bind(this.onComboBlur,this,!1)),this.BorderType=Asc.c_oDashType.solid,this.cmbBorderType.setValue(this.BorderType),this.lockedControls.push(this.cmbBorderType),this.sldrLineTransparency=new Common.UI.SingleSlider({el:f("#shape-line-slider-transparency"),width:75,minValue:0,maxValue:100,value:100}),this.sldrLineTransparency.on("change",v.bind(this.onLineTransparencyChange,this)),this.sldrLineTransparency.on("changecomplete",v.bind(this.onLineTransparencyChangeComplete,this)),this.lockedControls.push(this.sldrLineTransparency),this.lblLineTransparencyStart=f(this.el).find("#shape-line-lbl-transparency-start"),this.lblLineTransparencyEnd=f(this.el).find("#shape-line-lbl-transparency-end"),this.numLineTransparency=new Common.UI.MetricSpinner({el:f("#shape-line-spin-transparency"),step:1,width:62,value:"100 %",defaultUnit:"%",maxValue:100,minValue:0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.numLineTransparency.on("change",v.bind(this.onNumLineTransparencyChange,this)),this.numLineTransparency.on("inputleave",function(){o.fireEvent("editcomplete",o)}),this.lockedControls.push(this.numLineTransparency),this.btnRotate270=new Common.UI.Button({parentEl:f("#shape-button-270",o.$el),cls:"btn-toolbar",iconCls:"toolbar__icon btn-rotate-270",value:0,hint:this.textHint270,dataHint:"1",dataHintDirection:"bottom"}),this.btnRotate270.on("click",v.bind(this.onBtnRotateClick,this)),this.lockedControls.push(this.btnRotate270),this.btnRotate90=new Common.UI.Button({parentEl:f("#shape-button-90",o.$el),cls:"btn-toolbar",iconCls:"toolbar__icon btn-rotate-90",value:1,hint:this.textHint90,dataHint:"1",dataHintDirection:"bottom"}),this.btnRotate90.on("click",v.bind(this.onBtnRotateClick,this)),this.lockedControls.push(this.btnRotate90),this.btnFlipV=new Common.UI.Button({parentEl:f("#shape-button-flipv",o.$el),cls:"btn-toolbar",iconCls:"toolbar__icon btn-flip-vert",value:0,hint:this.textHintFlipV,dataHint:"1",dataHintDirection:"bottom"}),this.btnFlipV.on("click",v.bind(this.onBtnFlipClick,this)),this.lockedControls.push(this.btnFlipV),this.btnFlipH=new Common.UI.Button({parentEl:f("#shape-button-fliph",o.$el),cls:"btn-toolbar",iconCls:"toolbar__icon btn-flip-hor",value:1,hint:this.textHintFlipH,dataHint:"1",dataHintDirection:"bottom"}),this.btnFlipH.on("click",v.bind(this.onBtnFlipClick,this)),this.lockedControls.push(this.btnFlipH),[{icon:"btn-wrap-inline",data:Asc.c_oAscWrapStyle2.Inline,tip:this.txtInline,selected:!0},{icon:"btn-wrap-square",data:Asc.c_oAscWrapStyle2.Square,tip:this.txtSquare},{icon:"btn-wrap-tight",data:Asc.c_oAscWrapStyle2.Tight,tip:this.txtTight},{icon:"btn-wrap-through",data:Asc.c_oAscWrapStyle2.Through,tip:this.txtThrough},{icon:"btn-wrap-topbottom",data:Asc.c_oAscWrapStyle2.TopAndBottom,tip:this.txtTopAndBottom},{icon:"btn-wrap-infront",data:Asc.c_oAscWrapStyle2.InFront,tip:this.txtInFront},{icon:"btn-wrap-behind",data:Asc.c_oAscWrapStyle2.Behind,tip:this.txtBehind}]);this.cmbWrapType=new Common.UI.ComboDataView({itemWidth:50,itemHeight:50,menuMaxHeight:300,enableKeyEvents:!0,store:new Common.UI.DataViewStore(t),cls:"combo-chart-style",dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big",delayRenderTips:!0,itemTemplate:v.template(['<div class="item-icon-box" id="<%= id %>">','<img src="data:image/gif;base64,R0lGODlhAQABAID/AMDAwAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" class="combo-wrap-item options__icon options__icon-huge <%= icon %>"',"</div>"].join(""))}),this.cmbWrapType.render(f("#shape-combo-wrap")),this.cmbWrapType.openButton.menu.cmpEl.css({"min-width":178,"max-width":178}),this.cmbWrapType.on("click",v.bind(this.onSelectWrap,this)),this.cmbWrapType.openButton.menu.on("show:after",function(){o.cmbWrapType.menuPicker.scroller.update({alwaysVisibleY:!0})}),this.lockedControls.push(this.cmbWrapType),this.btnEditShape=new Common.UI.Button({parentEl:f("#shape-button-edit-shape"),cls:"btn-toolbar align-left",caption:this.textEditShape,iconCls:"toolbar__icon btn-menu-shape",style:"width:100%;",menu:new Common.UI.Menu({style:"min-width: 194px;",maxHeight:200,cls:"shifted-right",items:[{caption:this.textEditPoints,value:0,iconCls:"toolbar__icon btn-edit-points"},{caption:this.strChange,menu:new Common.UI.Menu({menuAlign:"tl-tl",cls:"menu-shapes menu-change-shape",items:[],restoreHeightAndTop:!0,additionalAlign:function(t,e,i){t.css({left:e,top:Math.max(f(o.el).parent().offset().top,Common.Utils.innerHeight()-10-o.shapeRestoreHeight)-parseInt(t.css("margin-top"))})}})}]}),dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.lockedControls.push(this.btnEditShape),this.btnChangeShape=this.btnEditShape.menu.items[1],this.btnEditShape.menu.items[0].on("click",v.bind(this.onShapeEditPoints,this)),this.btnEditChangeShape=new Common.UI.Button({parentEl:f("#shape-button-change-shape"),cls:"btn-toolbar align-left",caption:this.textEditShape,iconCls:"toolbar__icon btn-menu-shape",style:"width:100%;",menu:new Common.UI.Menu({menuAlign:"tr-br",cls:"menu-shapes menu-change-shape",items:[]}),scaling:!1,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.lockedControls.push(this.btnEditChangeShape),this.chShadow=new Common.UI.CheckBox({el:f("#shape-checkbox-shadow"),labelText:this.strShadow,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.chShadow.on("change",v.bind(this.onCheckShadow,this)),this.lockedControls.push(this.chShadow),this.linkAdvanced=f("#shape-advanced-link"),f(this.el).on("click","#shape-advanced-link",v.bind(this.openAdvancedSettings,this))},createDelayedElements:function(){this._initSettings=!1,this.createDelayedControls();var t=[0,1,3,2,4,53,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,22,23,24,25,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,49,50,51,52];this.patternViewData=[];for(var e=0;e<13;e++)for(var i=0;i<4;i++){var n=4*e+i;this.patternViewData[n]={offsetx:28*i,offsety:28*e,type:t[n]}}this.patternViewData.splice(this.patternViewData.length-2,2);for(e=0;e<this.patternViewData.length;e++)this.patternViewData[e].id=Common.UI.getId();this.cmbPattern.menuPicker.store.add(this.patternViewData),0<this.cmbPattern.menuPicker.store.length&&(this.cmbPattern.fillComboView(this.cmbPattern.menuPicker.store.at(0),!0),this.PatternFillType=this.patternViewData[0].type),this.onInitStandartTextures(),this.onApiAutoShapes(this.btnEditShape.menu.items[1]),this.onApiAutoShapes(this.btnEditChangeShape),this.UpdateThemeColors()},onInitStandartTextures:function(t){var e,i=this;t&&0<t.length&&(i._texturearray=[],v.each(t,function(t){i._texturearray.push({imageUrl:t.get_image(),name:i.textureNames[t.get_id()],type:t.get_id(),selected:!1})})),!i._texturearray||i._texturearray.length<1||this._initSettings||this.btnTexture||(this.btnTexture=new Common.UI.ComboBox({el:f("#shape-combo-fill-texture"),template:v.template(['<div class="input-group combobox combo-dataview-menu input-group-nr dropdown-toggle" tabindex="0" data-toggle="dropdown">','<div class="form-control text" style="width: 90px;" data-hint="1" data-hint-direction="bottom" data-hint-offset="big">'+this.textSelectTexture+"</div>",'<div style="display: table-cell;"></div>','<button type="button" class="btn btn-default">','<span class="caret"></span>',"</button>","</div>"].join(""))}),this.textureMenu=new Common.UI.Menu({items:[{template:v.template('<div id="id-shape-menu-texture" style="width: 233px; margin: 0 5px;"></div>')}]}),this.textureMenu.render(f("#shape-combo-fill-texture")),this.fillControls.push(this.btnTexture),e=function(t){new Common.UI.DataView({el:f("#id-shape-menu-texture"),restoreHeight:174,parentMenu:t,showLast:!1,store:new Common.UI.DataViewStore(i._texturearray||[]),itemTemplate:v.template('<div class="item-texture"><img src="<%= imageUrl %>" id="<%= id %>"></div>')}).on("item:click",v.bind(i.onSelectTexture,i)),t.off("show:before",e)},this.textureMenu.on("show:before",e))},onSelectTexture:function(t,e,i){var n,o;this._fromTextureCmb=!0,this.cmbFillType.setValue(this._arrFillType[1].value),this._fromTextureCmb=!1,this.api&&(n=new Asc.asc_CShapeProperty,(o=new Asc.asc_CShapeFill).put_type(Asc.c_oAscFill.FILL_TYPE_BLIP),o.put_fill(new Asc.asc_CFillBlip),o.get_fill().put_type(Asc.c_oAscFillBlipType.TILE),o.get_fill().put_texture_id(i.get("type")),n.put_fill(o),this.imgprops.put_ShapeProperties(n),this.api.ImgApply(this.imgprops)),f(this.btnTexture.el).find(".form-control").prop("innerHTML",i.get("name")),this.fireEvent("editcomplete",this)},onBtnRotateClick:function(t){var e=new Asc.asc_CImgProperty;e.asc_putRotAdd(3.14159265358979*(1==t.options.value?90:270)/180),this.api.ImgApply(e),this.fireEvent("editcomplete",this)},onBtnFlipClick:function(t){var e=new Asc.asc_CImgProperty;1==t.options.value?e.asc_putFlipHInvert(!0):e.asc_putFlipVInvert(!0),this.api.ImgApply(e),this.fireEvent("editcomplete",this)},toggleBtnEditShape:function(){this.EditShapeContainer.toggleClass("settings-hidden",!this.canEditPoint),this.EditChangeShapeContainer.toggleClass("settings-hidden",this.canEditPoint),this.btnChangeShape=this.canEditPoint?this.btnEditShape.menu.items[1]:this.btnEditChangeShape},onShapeEditPoints:function(){this.api&&this.api.asc_editPointsGeometry()},onCheckShadow:function(t,e,i,n){var o;this.api&&((o=new Asc.asc_CShapeProperty).asc_putShadow("checked"==t.getValue()?new Asc.asc_CShadowProperty:null),this.imgprops.put_ShapeProperties(o),this.api.ImgApply(this.imgprops)),this.fireEvent("editcomplete",this)},onApiAutoShapes:function(t){function e(t){i.fillAutoShapes(),t.off("show:before",e)}var i=this;t.menu.on("show:before",e)},fillAutoShapes:function(){var o=this,t=Common.localStorage.getItem("de-recent-shapes"),e=o.canEditPoint?"id-edit-shape-menu":"id-change-shape-menu",i=new Common.UI.MenuItem({template:v.template('<div id="'+e+'" class="menu-insertshape"></div>')});o.btnChangeShape.menu.addItem(i),o.btnChangeShape.shapePicker=new Common.UI.DataViewShape({el:f("#"+e),itemTemplate:v.template('<div class="item-shape" id="<%= id %>"><svg width="20" height="20" class="icon uni-scale"><use xlink:href="#svg-icon-<%= data.shapeType %>"></use></svg></div>'),groups:o.application.getCollection("ShapeGroups"),parentMenu:o.btnChangeShape.menu,restoreHeight:o.shapeRestoreHeight,textRecentlyUsed:o.textRecentlyUsed,recentShapes:t?JSON.parse(t):null,hideTextRect:o._state.isFromImage||o._state.isFromSmartArtInternal,hideLines:!0}),o.btnChangeShape.shapePicker.on("item:click",function(t,e,i,n){o.api&&(o.api.ChangeShapeType(i.get("data").shapeType),o.fireEvent("editcomplete",o)),"click"!==n.type&&(o.canEditPoint?o.btnEditShape:o.btnEditChangeShape).menu.hide()})},UpdateThemeColors:function(){this._initSettings||(this.btnBackColor||(this.btnBackColor=new Common.UI.ColorButton({parentEl:f("#shape-back-color-btn"),transparent:!0,color:"transparent",eyeDropper:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.fillControls.push(this.btnBackColor),this.colorsBack=this.btnBackColor.getPicker(),this.btnBackColor.on("color:select",v.bind(this.onColorsBackSelect,this)),this.btnBackColor.on("eyedropper:start",v.bind(this.onEyedropperStart,this)),this.btnBackColor.on("eyedropper:end",v.bind(this.onEyedropperEnd,this)),this.btnFGColor=new Common.UI.ColorButton({parentEl:f("#shape-foreground-color-btn"),color:"000000",eyeDropper:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.fillControls.push(this.btnFGColor),this.colorsFG=this.btnFGColor.getPicker(),this.btnFGColor.on("color:select",v.bind(this.onColorsFGSelect,this)),this.btnFGColor.on("eyedropper:start",v.bind(this.onEyedropperStart,this)),this.btnFGColor.on("eyedropper:end",v.bind(this.onEyedropperEnd,this)),this.btnBGColor=new Common.UI.ColorButton({parentEl:f("#shape-background-color-btn"),color:"ffffff",eyeDropper:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.fillControls.push(this.btnBGColor),this.colorsBG=this.btnBGColor.getPicker(),this.btnBGColor.on("color:select",v.bind(this.onColorsBGSelect,this)),this.btnBGColor.on("eyedropper:start",v.bind(this.onEyedropperStart,this)),this.btnBGColor.on("eyedropper:end",v.bind(this.onEyedropperEnd,this)),this.btnGradColor=new Common.UI.ColorButton({parentEl:f("#shape-gradient-color-btn"),color:"000000",eyeDropper:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.fillControls.push(this.btnGradColor),this.colorsGrad=this.btnGradColor.getPicker(),this.btnGradColor.on("color:select",v.bind(this.onColorsGradientSelect,this)),this.btnGradColor.on("eyedropper:start",v.bind(this.onEyedropperStart,this)),this.btnGradColor.on("eyedropper:end",v.bind(this.onEyedropperEnd,this)),this.btnBorderColor=new Common.UI.ColorButton({parentEl:f("#shape-border-color-btn"),color:"000000",eyeDropper:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.lockedControls.push(this.btnBorderColor),this.colorsBorder=this.btnBorderColor.getPicker(),this.btnBorderColor.on("color:select",v.bind(this.onColorsBorderSelect,this)),this.btnBorderColor.on("eyedropper:start",v.bind(this.onEyedropperStart,this)),this.btnBorderColor.on("eyedropper:end",v.bind(this.onEyedropperEnd,this))),this.colorsBorder.updateColors(Common.Utils.ThemeColor.getEffectColors(),Common.Utils.ThemeColor.getStandartColors()),this.colorsBack.updateColors(Common.Utils.ThemeColor.getEffectColors(),Common.Utils.ThemeColor.getStandartColors()),this.colorsFG.updateColors(Common.Utils.ThemeColor.getEffectColors(),Common.Utils.ThemeColor.getStandartColors()),this.colorsBG.updateColors(Common.Utils.ThemeColor.getEffectColors(),Common.Utils.ThemeColor.getStandartColors()),this.colorsGrad.updateColors(Common.Utils.ThemeColor.getEffectColors(),Common.Utils.ThemeColor.getStandartColors()))},_pt2mm:function(t){return 25.4*t/72},_mm2pt:function(t){return 72*t/25.4},disableFillPanels:function(e){this._state.DisabledFillPanels!==e&&(this._state.DisabledFillPanels=e,v.each(this.fillControls,function(t){t.setDisabled(e)}),this.lblTransparencyStart.toggleClass("disabled",e),this.lblTransparencyEnd.toggleClass("disabled",e),this.numGradientAngle.setDisabled(e||this.GradFillType!==Asc.c_oAscFillGradType.GRAD_LINEAR))},ShowHideElem:function(t){this.FillColorContainer.toggleClass("settings-hidden",t!==Asc.c_oAscFill.FILL_TYPE_SOLID),this.FillImageContainer.toggleClass("settings-hidden",t!==Asc.c_oAscFill.FILL_TYPE_BLIP),this.FillPatternContainer.toggleClass("settings-hidden",t!==Asc.c_oAscFill.FILL_TYPE_PATT),this.FillGradientContainer.toggleClass("settings-hidden",t!==Asc.c_oAscFill.FILL_TYPE_GRAD),this.TransparencyContainer.toggleClass("settings-hidden",t===Asc.c_oAscFill.FILL_TYPE_NOFILL||null===t)},setLocked:function(t){this._locked=t},disableControls:function(e,t){this._initSettings||(this.disableFillPanels(e||t),this._state.DisabledControls!==e&&(this._state.DisabledControls=e,v.each(this.lockedControls,function(t){t.setDisabled(e)}),this.linkAdvanced.toggleClass("disabled",e),this.lblLineTransparencyStart.toggleClass("disabled",e),this.lblLineTransparencyEnd.toggleClass("disabled",e)),this.btnFlipV.setDisabled(e||this._state.isFromSmartArtInternal),this.btnFlipH.setDisabled(e||this._state.isFromSmartArtInternal))},hideShapeOnlySettings:function(t){this._state.HideShapeOnlySettings!==t&&(this._state.HideShapeOnlySettings=t,this.ShapeOnlySettings.toggleClass("hidden",1==t))},hideChangeTypeSettings:function(t){this._state.HideChangeTypeSettings!==t&&(this._state.HideChangeTypeSettings=t,this.CanChangeType.toggleClass("hidden",1==t))},hideRotationSettings:function(t){this._state.HideRotationSettings!==t&&(this._state.HideRotationSettings=t,this.RotationSettings.toggleClass("hidden",1==t))},hideNoFormSettings:function(t){this._state.isFixedForm!==t&&(this._state.isFixedForm=t,this.NoFormSettings.toggleClass("hidden",1==t))},onPositionChange:function(t){var e,t=t.getNumberValue(),i=(Common.UI.isRTL()&&(t=this.sldrGradient.maxValue-t),this.GradColor.currentIdx-1<0?0:this.GradColor.values[this.GradColor.currentIdx-1]),n=this.GradColor.currentIdx+1<this.GradColor.values.length?this.GradColor.values[this.GradColor.currentIdx+1]:100,i=t<i||n<t;this.api&&(this.GradColor.values[this.GradColor.currentIdx]=t,n=new Asc.asc_CShapeProperty,(t=new Asc.asc_CShapeFill).asc_putType(Asc.c_oAscFill.FILL_TYPE_GRAD),t.asc_putFill(new Asc.asc_CFillGrad),t.asc_getFill().asc_putGradType(this.GradFillType),e=[],this.GradColor.values.forEach(function(t){e.push(1e3*t)}),t.asc_getFill().asc_putPositions(e),n.asc_putFill(t),this.imgprops.put_ShapeProperties(n),this.api.ImgApply(this.imgprops),i&&(this.sldrGradient.sortThumbs(),this.sldrGradient.trigger("change",this.sldrGradient),this.sldrGradient.trigger("changecomplete",this.sldrGradient)))},onAddGradientStep:function(){var t,e;9<this.GradColor.colors.length||(t=this.GradColor.currentIdx,e=(this.GradColor.values[t]+this.GradColor.values[t<this.GradColor.colors.length-1?t+1:t-1])/2,this.GradColor.colors[this.GradColor.colors.length]=this.GradColor.colors[t],this.GradColor.currentIdx=this.GradColor.colors.length-1,e=this.sldrGradient.addNewThumb(void 0,e,t),this.GradColor.colors[this.GradColor.currentIdx]=e,this.sldrGradient.trigger("change",this.sldrGradient),this.sldrGradient.trigger("changecomplete",this.sldrGradient))},onRemoveGradientStep:function(){var t;this.GradColor.values.length<3||(t=this.GradColor.currentIdx,this.GradColor.values.splice(this.GradColor.currentIdx,1),this.sldrGradient.removeThumb(this.GradColor.currentIdx),(v.isUndefined(this.GradColor.currentIdx)||this.GradColor.currentIdx>=this.GradColor.colors.length)&&(t=0===(t=0<t?t-1:t)&&2<this.GradColor.values.length?this.GradColor.values.length-2:t,this.GradColor.currentIdx=t),this.sldrGradient.setActiveThumb(this.GradColor.currentIdx),this.sldrGradient.trigger("change",this.sldrGradient),this.sldrGradient.trigger("changecomplete",this.sldrGradient))},onGradientAngleChange:function(t,e,i,n){var o,s;this.api&&!this._noApply&&(o=new Asc.asc_CShapeProperty,(s=new Asc.asc_CShapeFill).put_type(Asc.c_oAscFill.FILL_TYPE_GRAD),s.put_fill(new Asc.asc_CFillGrad),s.get_fill().put_grad_type(this.GradFillType),s.get_fill().put_linear_angle(6e4*t.getNumberValue()),s.get_fill().put_linear_scale(!0),o.put_fill(s),this.imgprops.put_ShapeProperties(o),this.api.ImgApply(this.imgprops))},onEyedropperStart:function(t){this.api.asc_startEyedropper(v.bind(t.eyedropperEnd,t)),this.fireEvent("eyedropper",!0)},onEyedropperEnd:function(){this.fireEvent("eyedropper",!1)}},DE.Views.ShapeSettings||{}))}),define("text!documenteditor/main/app/template/MailMerge.template",[],function(){return'<table cols="1">\n    <tr>\n        <td class="padding-small">\n            <button type="button" class="btn btn-text-default" id="mmerge-button-edit-data" style="width:100%;" data-hint="1" data-hint-direction="bottom" data-hint-offset="big"><%= scope.textEditData %></button>\n            <label id="mmerge-lbl-add-recipients" style="margin-top: 4px;"><%= scope.textAddRecipients %></label>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr>\n        <td>\n            <label class="header"><%= scope.textMergeFields %></label>\n        </td>\n    </tr>\n    <tr>\n        <td style="padding-bottom: 13px;">\n            <div id="mmerge-btn-ins-field" style="width:100%;"></div>\n        </td>\n    </tr>\n    <tr>\n        <td  style="padding-bottom: 13px;">\n            <div id="mmerge-switcher-highlight" style="display: inline-block; vertical-align: top;"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <div id="mmerge-switcher-preview" style="display: inline-block; vertical-align: top;"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <div id="mmerge-button-first"></div>\n            <div id="mmerge-button-prev"></div>\n            <div id="mmerge-field-num"></div>\n            <div id="mmerge-button-next"></div>\n            <div id="mmerge-button-last"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr>\n        <td>\n            <label class="header"><%= scope.textMergeTo %></label>\n        </td>\n    </tr>\n    <tr>\n        <td class="">\n            <div id="mmerge-combo-merge-to" style="width: 100%;padding-bottom: 2px;"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-medium">\n            <label style=""><%= scope.textMaxRecepients %></label>\n            <label class="link-solid" id="mmerge-readmore-link" data-hint="1" data-hint-direction="bottom" data-hint-offset="small"><%= scope.textReadMore %></label>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-large">\n            <div id="mmerge-radio-all"></div>\n            <div id="mmerge-radio-current"></div>\n            <div id="mmerge-radio-from-to"></div>\n            <div id="mmerge-field-from"></div>\n            <label class="text-to-label"><%= scope.textTo %></label>\n            <div id="mmerge-field-to"></div>\n        </td>\n    </tr>\n</table>\n<table cols="2">\n    <tr>\n        <td width="50%">\n            <button type="button" class="btn btn-text-default" id="mmerge-button-download" style="width:90px;" data-hint="1" data-hint-direction="bottom" data-hint-offset="big"><%= scope.textDownload %></button>\n            <button type="button" class="btn btn-text-default hidden" id="mmerge-button-merge" style="width:90px;" data-hint="1" data-hint-direction="bottom" data-hint-offset="big"><%= scope.textMerge %></button>\n        </td>\n        <td class="text-align-right" width="50%">\n            <button type="button" class="btn btn-text-default" id="mmerge-button-portal" style="width:90px;" data-hint="1" data-hint-direction="bottom" data-hint-offset="big"><%= scope.textPortal %></button>\n        </td>\n    </tr>\n    <tr class="finish-cell"></tr>\n</table>'}),define("common/main/lib/view/SaveAsDlg",["common/main/lib/component/Window","common/main/lib/component/LoadMask"],function(){"use strict";Common.Views.SaveAsDlg=Common.UI.Window.extend(_.extend({initialize:function(t){var e={};_.extend(e,{title:this.textTitle,width:420,height:681,header:!0},t),this.template=['<div id="id-saveas-folder-placeholder"></div>'].join(""),e.tpl=_.template(this.template)(e),this.saveFolderUrl=t.saveFolderUrl||"",this.saveFileUrl=t.saveFileUrl||"",this.defFileName=t.defFileName||"",this.saveFolderUrl=this.saveFolderUrl.replace("{title}",encodeURIComponent(this.defFileName)).replace("{fileuri}",encodeURIComponent(this.saveFileUrl)),Common.UI.Window.prototype.initialize.call(this,e)},render:function(){Common.UI.Window.prototype.render.call(this),this.$window.find("> .body").css({height:"auto",overflow:"hidden"});var t=document.createElement("iframe"),e=(t.width="100%",t.height=645,t.align="top",t.frameBorder=0,t.scrolling="no",t.onload=_.bind(this._onLoad,this),$("#id-saveas-folder-placeholder").append(t),this.loadMask=new Common.UI.LoadMask({owner:$("#id-saveas-folder-placeholder")}),this.loadMask.setTitle(this.textLoading),this.loadMask.show(),t.src=this.saveFolderUrl,this);this._eventfunc=function(t){e._onWindowMessage(t)},this._bindWindowEvents.call(this),this.on("close",function(t){e._unbindWindowEvents()})},_bindWindowEvents:function(){window.addEventListener?window.addEventListener("message",this._eventfunc,!1):window.attachEvent&&window.attachEvent("onmessage",this._eventfunc)},_unbindWindowEvents:function(){window.removeEventListener?window.removeEventListener("message",this._eventfunc):window.detachEvent&&window.detachEvent("onmessage",this._eventfunc)},_onWindowMessage:function(t){if(t&&window.JSON)try{this._onMessage.call(this,window.JSON.parse(t.data))}catch(t){}},_onMessage:function(t){t&&"onlyoffice"==t.Referer&&(_.isEmpty(t.error)?_.isEmpty(t.message)||Common.NotificationCenter.trigger("showmessage",{msg:t.message}):this.trigger("saveaserror",this,t.error),Common.NotificationCenter.trigger("window:close",this))},_onLoad:function(){this.loadMask&&this.loadMask.hide()}},Common.Views.SaveAsDlg||{}))}),define("text!documenteditor/main/app/template/MailMergeEmailDlg.template",[],function(){return'<div id="id-merge-email-dlg" class="settings-panel active">\n    <div class="inner-content">\n        <table cols="2" style="width: 100%;" cellpadding="10">\n            <tr>\n                <td class="padding-small">\n                    <label class="input-label header"><%= scope.textFrom %></label>\n                    <div id="merge-email-dlg-from" class="margin-right-5"></div>\n                </td>\n                <td class="padding-small">\n                    <label class="input-label header"><%= scope.textTo %></label>\n                    <div id="merge-email-dlg-to"></div>\n                </td>\n            </tr>\n            <tr>\n                <td colspan="2" class="padding-small">\n                    <label class="input-label header"><%= scope.textSubject %></label>\n                    <div id="merge-email-dlg-subject" style="width: 100%;"></div>\n                </td>\n            </tr>\n            <tr>\n                <td colspan="2" class="padding-small">\n                    <label class="input-label header"><%= scope.textFormat %></label>\n                    <div id="merge-email-dlg-format" style="width: 170px;"></div>\n                </td>\n            </tr>\n            <tr>\n                <td colspan="2" class="padding-small">\n                    <label id="merge-email-dlg-lbl-filename"  class="input-label disabled header"><%= scope.textFileName %></label>\n                    <div id="merge-email-dlg-filename" style="width: 100%;"></div>\n                </td>\n            </tr>\n            <tr>\n                <td colspan="2" class="padding-small">\n                    <label id="merge-email-dlg-lbl-message" class="input-label disabled header"><%= scope.textMessage %></label>\n                     <textarea id="merge-email-dlg-message" class="disabled form-control" disabled="disabled" style="width: 100%;height: 70px;margin-bottom: 0;"></textarea>\n                </td>\n            </tr>\n            <tr>\n                <td colspan="2" class="padding-small">\n                    <label class="header"><%= scope.textWarning %></label>\n                    <label class=""><%= scope.textWarningMsg %></label>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>'}),define("documenteditor/main/app/view/MailMergeEmailDlg",["text!documenteditor/main/app/template/MailMergeEmailDlg.template","common/main/lib/view/AdvancedSettingsWindow","common/main/lib/component/ComboBox","common/main/lib/component/InputField"],function(e){"use strict";DE.Views.MailMergeEmailDlg=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{alias:"MailMergeEmail",contentWidth:500,height:435},initialize:function(t){_.extend(this.options,{title:this.textTitle,template:['<div class="box" style="height:'+(this.options.height-85)+'px;">','<div class="content-panel" style="padding: 0;">'+_.template(e)({scope:this})+"</div>","</div>",'<div class="separator horizontal"></div>'].join("")},t),Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var e=this;this._arrFrom=[],this.cmbFrom=new Common.UI.ComboBox({el:$("#merge-email-dlg-from"),cls:"input-group-nr",menuStyle:"min-width: 100%;",editable:!1,data:this._arrFrom}),this._arrTo=[],this.cmbTo=new Common.UI.ComboBox({el:$("#merge-email-dlg-to"),cls:"input-group-nr",menuStyle:"min-width: 100%;",editable:!1,data:this._arrTo}),this.inputSubject=new Common.UI.InputField({el:$("#merge-email-dlg-subject"),allowBlank:!0,validateOnBlur:!1,placeHolder:this.subjectPlaceholder,style:"width: 100%;"}),this._arrFormat=[{displayValue:this.textHTML,value:Asc.c_oAscFileType.HTML},{displayValue:this.textAttachDocx,value:Asc.c_oAscFileType.DOCX},{displayValue:this.textAttachPdf,value:Asc.c_oAscFileType.PDF}],this.cmbFormat=new Common.UI.ComboBox({el:$("#merge-email-dlg-format"),cls:"input-group-nr",menuStyle:"min-width: 100%;",editable:!1,data:this._arrFormat}),this.cmbFormat.setValue(Asc.c_oAscFileType.HTML),this.cmbFormat.on("selected",_.bind(this.onCmbFormatSelect,this)),this.inputFileName=new Common.UI.InputField({el:$("#merge-email-dlg-filename"),allowBlank:!0,validateOnBlur:!1,disabled:!0,placeHolder:this.filePlaceholder,style:"width: 100%;"}),this.textareaMessage=this.$window.find("textarea"),this.lblFileName=$("#merge-email-dlg-lbl-filename"),this.lblMessage=$("#merge-email-dlg-lbl-message"),this._eventfunc=function(t){e._onWindowMessage(t)},this.mergeProps=this.options.props,this.mergedFileUrl=this.options.mergedFileUrl||"",this.afterRender()},_bindWindowEvents:function(){window.addEventListener?window.addEventListener("message",this._eventfunc,!1):window.attachEvent&&window.attachEvent("onmessage",this._eventfunc)},_unbindWindowEvents:function(){window.removeEventListener?window.removeEventListener("message",this._eventfunc):window.detachEvent&&window.detachEvent("onmessage",this._eventfunc)},_onWindowMessage:function(t){if(t&&window.JSON)try{this._onMessage.call(this,window.JSON.parse(t.data))}catch(t){}},_onMessage:function(t){t&&t.Referer},afterRender:function(){this._setDefaults(this.mergeProps)},getSettings:function(){var t,e=this.inputFileName.getValue(),i=this.cmbFormat.getValue();return i!==Asc.c_oAscFileType.HTML&&(t=0<(t=(e=_.isEmpty(e)?"attach":e).lastIndexOf("."))?e.substring(t,e.length).toLowerCase():"",i==Asc.c_oAscFileType.PDF&&".pdf"!==t?e+=".pdf":i==Asc.c_oAscFileType.DOCX&&".docx"!==t&&(e+=".docx")),{from:this.cmbFrom.getValue(),to:this.cmbTo.getValue(),subject:this.inputSubject.getValue(),mailFormat:i,fileName:e,message:this.textareaMessage.val()}},_setDefaults:function(t){var i;t&&(t.fieldsList&&(i=[],_.each(t.fieldsList,function(t,e){i.push({displayValue:"<"+t+">",value:t})}),this.cmbTo.setData(i),0<i.length&&this.cmbTo.setValue(i[0].value)),t.emailAddresses&&(i=[],_.each(t.emailAddresses,function(t,e){i.push({displayValue:t,value:t})}),this.cmbFrom.setData(i),0<i.length&&this.cmbFrom.setValue(i[0].value)))},onPrimary:function(){return!0},onDlgBtnClick:function(t){t=t.currentTarget.attributes.result.value;"ok"==t&&this.handler&&this.handler.call(this,t,"ok"==t?this.getSettings():void 0),this.close()},onCmbFormatSelect:function(t,e){e=e.value==Asc.c_oAscFileType.HTML;this.inputFileName.setDisabled(e),this.lblFileName.toggleClass("disabled",e),e?this.textareaMessage.attr("disabled","disabled"):this.textareaMessage.removeAttr("disabled"),this.textareaMessage.toggleClass("disabled",e),this.lblMessage.toggleClass("disabled",e)}},DE.Views.MailMergeEmailDlg||{}))}),define("documenteditor/main/app/view/MailMergeSettings",["text!documenteditor/main/app/template/MailMerge.template","jquery","underscore","backbone","common/main/lib/component/Button","common/main/lib/component/CheckBox","common/main/lib/view/SaveAsDlg","common/main/lib/view/SelectFileDlg","documenteditor/main/app/view/MailMergeEmailDlg"],function(t,a,l,e){"use strict";DE.enumLockMM={lostConnect:"disconnect",preview:"preview",coAuth:"co-auth",noFields:"no-fields",noRecipients:"no-recipients",radioAllCurr:"radio-all-curr"},DE.Views.MailMergeSettings=e.View.extend(l.extend({el:"#id-mail-merge-settings",template:l.template(t),events:{},options:{alias:"MailMergeSettings"},initialize:function(){DE.enumLockMM;this._initSettings=!0,this._state={recipientsCount:0,fieldsList:[]},this._locked=!1,this.emptyDBControls=[],this._noApply=!1,this._originalProps=null,this.defFileName="",this.emailAddresses=void 0,this.mergeMailData=void 0,this.render()},render:function(){this.$el.html(this.template({scope:this}))},setApi:function(t){return this.api=t,this.api&&(this.api.asc_registerCallback("asc_onPreviewMailMergeResult",l.bind(this.onPreviewMailMergeResult,this)),this.api.asc_registerCallback("asc_onEndPreviewMailMergeResult",l.bind(this.onEndPreviewMailMergeResult,this)),this.api.asc_registerCallback("asc_onStartMailMerge",l.bind(this.onStartMailMerge,this)),this.api.asc_registerCallback("asc_onSaveMailMerge",l.bind(this.onSaveMailMerge,this)),this.api.asc_registerCallback("asc_onEndAction",l.bind(this.onLongActionEnd,this)),Common.Gateway.on("setemailaddresses",l.bind(this.onSetEmailAddresses,this)),Common.Gateway.on("processmailmerge",l.bind(this.onProcessMailMerge,this))),this},createDelayedControls:function(){var s=this,t=DE.enumLockMM;this.btnInsField=new Common.UI.Button({parentEl:a("#mmerge-btn-ins-field",s.$el),cls:"btn-text-menu-default",caption:this.textInsertField,style:"width: 100%;",lock:[t.noFields,t.preview,t.coAuth,t.lostConnect],menu:new Common.UI.Menu({style:"min-width: 190px;max-width: 400px;",maxHeight:200,items:[]}),dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.txtFieldNum=new Common.UI.InputField({el:a("#mmerge-field-num",s.$el),allowBlank:!0,validateOnChange:!1,style:"width: 80px; vertical-align: middle;",maskExp:/[0-9]/,value:1,validation:function(t){return!/(^[0-9]+$)/.test(t)||null==(t=parseInt(t))||t<1?s.txtFieldNum.setValue(1):t>s._state.recipientsCount&&s.txtFieldNum.setValue(s._state.recipientsCount),!0},lock:[t.noRecipients,t.lostConnect],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}).on("changed:after",function(t,e,i,n){var o=parseInt(s.txtFieldNum.getValue());o!==parseInt(i)&&(s.api.asc_PreviewMailMergeResult(o-1),s.fireEvent("editcomplete",s))}),this.emptyDBControls.push(this.txtFieldNum),this.btnEditData=new Common.UI.Button({el:s.$el.find("#mmerge-button-edit-data"),lock:[t.preview,t.lostConnect]}),this.btnEditData.on("click",l.bind(this.onEditData,this)),this.lblAddRecipients=a("#mmerge-lbl-add-recipients"),this.chHighlight=new Common.UI.CheckBox({el:s.$el.find("#mmerge-switcher-highlight"),labelText:this.textHighlight,lock:[t.noFields,t.lostConnect],dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.chHighlight.on("change",l.bind(this.onCheckHighlightChange,this)),this.chPreview=new Common.UI.CheckBox({el:s.$el.find("#mmerge-switcher-preview"),labelText:this.textPreview,lock:[t.noRecipients,t.lostConnect],dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.chPreview.on("change",l.bind(this.onCheckPreviewChange,this)),this.emptyDBControls.push(this.chPreview),this.btnFirst=new Common.UI.Button({parentEl:a("#mmerge-button-first",s.$el),cls:"btn-toolbar",iconCls:"toolbar__icon "+(Common.UI.isRTL()?"btn-lastitem":"btn-firstitem"),disabled:!0,value:0,hint:this.txtFirst,lock:[t.noRecipients,t.lostConnect],dataHint:"1",dataHintDirection:"bottom"}),this.btnFirst.on("click",l.bind(this.onBtnPreviewFieldClick,this)),this.emptyDBControls.push(this.btnFirst),this.btnPrev=new Common.UI.Button({parentEl:a("#mmerge-button-prev",s.$el),cls:"btn-toolbar",iconCls:"toolbar__icon "+(Common.UI.isRTL()?"btn-nextitem":"btn-previtem"),disabled:!0,value:1,hint:this.txtPrev,lock:[t.noRecipients,t.lostConnect],dataHint:"1",dataHintDirection:"bottom"}),this.btnPrev.on("click",l.bind(this.onBtnPreviewFieldClick,this)),this.emptyDBControls.push(this.btnPrev),this.btnNext=new Common.UI.Button({parentEl:a("#mmerge-button-next",s.$el),cls:"btn-toolbar",iconCls:"toolbar__icon "+(Common.UI.isRTL()?"btn-previtem":"btn-nextitem"),value:2,hint:this.txtNext,lock:[t.noRecipients,t.lostConnect],dataHint:"1",dataHintDirection:"bottom"}),this.btnNext.on("click",l.bind(this.onBtnPreviewFieldClick,this)),this.emptyDBControls.push(this.btnNext),this.btnLast=new Common.UI.Button({parentEl:a("#mmerge-button-last",s.$el),cls:"btn-toolbar",iconCls:"toolbar__icon "+(Common.UI.isRTL()?"btn-firstitem":"btn-lastitem"),value:3,hint:this.txtLast,lock:[t.noRecipients,t.lostConnect],dataHint:"1",dataHintDirection:"bottom"}),this.btnLast.on("click",l.bind(this.onBtnPreviewFieldClick,this)),this.emptyDBControls.push(this.btnLast),this._arrMergeSrc=[{displayValue:this.textPdf,value:Asc.c_oAscFileType.PDF},{displayValue:this.textDocx,value:Asc.c_oAscFileType.DOCX},{displayValue:this.textEmail,value:Asc.c_oAscFileType.HTML}],this.cmbMergeTo=new Common.UI.ComboBox({el:a("#mmerge-combo-merge-to",s.$el),cls:"input-group-nr",style:"width: 100%;",menuStyle:"min-width: 190px;",editable:!1,data:this._arrMergeSrc,lock:[t.noRecipients,t.lostConnect],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbMergeTo.setValue(this._arrMergeSrc[0].value),this.cmbMergeTo.on("selected",l.bind(this.onCmbMergeToSelect,this)),this.emptyDBControls.push(this.cmbMergeTo),this.radioAll=new Common.UI.RadioBox({el:a("#mmerge-radio-all",s.$el),labelText:this.textAll,name:"asc-radio-merge",checked:!0,lock:[t.noRecipients,t.lostConnect],dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}).on("change",l.bind(this.onRadioAllCurrent,this)),this.emptyDBControls.push(this.radioAll),this.radioCurrent=new Common.UI.RadioBox({el:a("#mmerge-radio-current",s.$el),labelText:this.textCurrent,name:"asc-radio-merge",lock:[t.noRecipients,t.lostConnect],dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}).on("change",l.bind(this.onRadioAllCurrent,this)),this.emptyDBControls.push(this.radioCurrent),this.radioFromTo=new Common.UI.RadioBox({el:a("#mmerge-radio-from-to",s.$el),labelText:this.textFrom,name:"asc-radio-merge",lock:[t.noRecipients,t.lostConnect],dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}).on("change",l.bind(this.onRadioFromToChange,this)),this.emptyDBControls.push(this.radioFromTo),this.txtFieldFrom=new Common.UI.InputField({el:a("#mmerge-field-from",s.$el),allowBlank:!0,validateOnChange:!1,style:"width: 50px;",maskExp:/[0-9]/,value:0,disabled:!0,lock:[t.radioAllCurr,t.noRecipients,t.lostConnect],validation:function(t){!/(^[0-9]+$)/.test(t)||null==(t=parseInt(t))||t<1?s.txtFieldFrom.setValue(1):t>s._state.recipientsCount&&s.txtFieldFrom.setValue(s._state.recipientsCount),t=parseInt(s.txtFieldFrom.getValue());var e=Math.min(s._state.recipientsCount,t+99);if(parseInt(s.txtFieldTo.getValue())>e&&s.txtFieldTo.setValue(e),s._checkFromToValues){if(t>parseInt(s.txtFieldTo.getValue()))return s.txtFromToError;s._checkFromToValues=!1,s.txtFieldTo.checkValidate()}return!0},dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.emptyDBControls.push(this.txtFieldFrom),this.txtFieldTo=new Common.UI.InputField({el:a("#mmerge-field-to",s.$el),allowBlank:!0,validateOnChange:!1,style:"width: 50px;",maskExp:/[0-9]/,value:0,disabled:!0,lock:[t.radioAllCurr,t.noRecipients,t.lostConnect],validation:function(t){var e;if(!/(^[0-9]+$)/.test(t)||null==(t=parseInt(t))||t<1?s.txtFieldTo.setValue(1):(e=Math.min(s._state.recipientsCount,parseInt(s.txtFieldFrom.getValue())+99))<t&&s.txtFieldTo.setValue(e),s._checkFromToValues){if(parseInt(s.txtFieldFrom.getValue())>parseInt(s.txtFieldTo.getValue()))return s.txtFromToError;s._checkFromToValues=!1,s.txtFieldFrom.checkValidate()}return!0},dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.txtFieldTo.on("changed:after",function(){s._isToChanged=!0}),this.emptyDBControls.push(this.txtFieldTo),this.onRadioAllCurrent(this.radioAll,!0),this.btnDownload=new Common.UI.Button({el:a("#mmerge-button-download",s.$el),lock:[t.noRecipients,t.lostConnect]}).on("click",l.bind(this.onDownloadClick,this,!0)),this.emptyDBControls.push(this.btnDownload),this.btnPortal=new Common.UI.Button({el:a("#mmerge-button-portal",s.$el),lock:[t.noRecipients,t.lostConnect]}).on("click",l.bind(this.onDownloadClick,this,!1)),this.btnMerge=new Common.UI.Button({el:a("#mmerge-button-merge",s.$el),lock:[t.noRecipients,t.lostConnect]}).on("click",l.bind(this.onMergeClick,this,!1)),this.emptyDBControls.push(this.btnMerge),this.linkReadMore=a("#mmerge-readmore-link",this.$el),this.$el.on("click","#mmerge-readmore-link",l.bind(this.openHelp,this)),this.mode&&(this.mode.canRequestSaveAs||this.mode.mergeFolderUrl||this.btnPortal.setVisible(!1),this.mode.canSendEmailAddresses||(this._arrMergeSrc.pop(),this.cmbMergeTo.setData(this._arrMergeSrc),this.cmbMergeTo.setValue(this._arrMergeSrc[0].value))),this._initSettings=!1},ChangeSettings:function(t){var i,e;this._initSettings&&this.createDelayedControls(),this.disableInsertControls(this._locked),t&&((i=this)._state.recipientsCount=t.recipientsCount,this._state.fieldsList=t.fieldsList||[],this.btnInsField.menu.items.length<1&&l.each(this._state.fieldsList,function(t,e){t=new Common.UI.MenuItem({caption:"«"+Common.Utils.String.htmlEncode(t)+"»",field:t}).on("click",function(t,e){i.api&&(i.api.asc_AddMailMergeField(t.options.field),i.fireEvent("editcomplete",i))});i.btnInsField.menu.addItem(t)}),t=parseInt(this.txtFieldFrom.getValue()),((t=isNaN(t)?0:t-1)<0||t>this._state.recipientsCount-1)&&(t=0),e=this._isToChanged?parseInt(this.txtFieldTo.getValue()):this._state.recipientsCount,(e=(e=isNaN(e)?0:e-1)<0||e>this._state.recipientsCount-1?Math.max(this._state.recipientsCount-1,0):e)<t&&(t=0,e=this._state.recipientsCount-1),this.txtFieldFrom.setValue(t+1),this.txtFieldTo.setValue(Math.min(e+1,t+100)),e=parseInt(this.txtFieldNum.getValue()),(e=(e=isNaN(e)?0:e-1)<0?0:e)>this._state.recipientsCount-1&&(e=this._state.recipientsCount-1),this.lockControls(DE.enumLockMM.noRecipients,this._state.recipientsCount<1,{array:this.mode.canRequestSaveAs||this.mode.mergeFolderUrl?[this.btnPortal]:[],merge:!0}),this.lockControls(DE.enumLockMM.noFields,this._state.fieldsList.length<1,{array:[this.btnInsField,this.chHighlight]}),this.lblAddRecipients[this._state.fieldsList.length<1?"show":"hide"](),this.disableFieldBtns(e))},onEditData:function(){var t,e=DE.getController("Common.Controllers.ExternalMergeEditor").getView("Common.Views.ExternalMergeEditor");e&&(e.show(),(t=this.api.asc_getMailMergeData())&&e.setMergeData(t))},onCheckHighlightChange:function(t,e,i){this.api&&this.api.asc_SetHighlightMailMergeFields("checked"==t.getValue()),this.fireEvent("editcomplete",this)},onCheckPreviewChange:function(t,e,i){var t="checked"==t.getValue(),n=parseInt(this.txtFieldNum.getValue());this.api&&(t?this.api.asc_PreviewMailMergeResult(isNaN(n)?0:n-1):this.api.asc_EndPreviewMailMergeResult()),this.fireEvent("editcomplete",this)},onRadioFromToChange:function(t,e,i){e&&this.lockControls(DE.enumLockMM.radioAllCurr,!1,{array:[this.txtFieldFrom,this.txtFieldTo]})},onRadioAllCurrent:function(t,e,i){e&&this.lockControls(DE.enumLockMM.radioAllCurr,!0,{array:[this.txtFieldFrom,this.txtFieldTo]})},checkFromToValues:function(){this._checkFromToValues=!0;var t=this.txtFieldFrom.checkValidate(),e=this.txtFieldTo.checkValidate();return!0!==t||!0!==e?(this.txtFieldTo.cmpEl.find("input").focus(),!1):!(this._checkFromToValues=!1)},onDownloadClick:function(t,e,i){if(this.api){var n=0,o=Math.min(Math.max(this._state.recipientsCount-1,0),99);if(this.radioCurrent.getValue())n=o=parseInt(this.txtFieldNum.getValue())-1;else if(this.radioFromTo.getValue()){if(!this.checkFromToValues())return;n=parseInt(this.txtFieldFrom.getValue())-1,o=parseInt(this.txtFieldTo.getValue())-1,o=Math.min(o,n+99),this.txtFieldTo.setValue(o+1)}this.api.asc_DownloadAsMailMerge(this.cmbMergeTo.getValue(),n,o,t)?t||((n=DE.getController("Main")).loadMask||(n.loadMask=new Common.UI.LoadMask({owner:a("#viewport")})),n.loadMask.setTitle(this.downloadMergeTitle),n.loadMask.show()):(o={closable:!1,title:this.notcriticalErrorTitle,msg:this.errorMailMergeSaveFile,iconCls:"warn",buttons:["ok"],callback:l.bind(function(t){this.fireEvent("editcomplete",this)},this)},Common.UI.alert(o))}},onSaveMailMerge:function(t,e){var i,n=DE.getController("Main").loadMask;n&&n.hide(),this._mailMergeDlg||(i=this).cmbMergeTo.getValue()!=Asc.c_oAscFileType.HTML&&(n=i.defFileName+(this.cmbMergeTo.getValue()==Asc.c_oAscFileType.PDF?".pdf":".docx"),i.mode.canRequestSaveAs?Common.Gateway.requestSaveAs(t,n,e):(i._mailMergeDlg=new Common.Views.SaveAsDlg({saveFolderUrl:i.mode.mergeFolderUrl,saveFileUrl:t,defFileName:n}),i._mailMergeDlg.on("saveasfolder",function(t,e){}).on("saveaserror",function(t,e){e={closable:!1,title:i.notcriticalErrorTitle,msg:e,iconCls:"warn",buttons:["ok"],callback:function(t){i.fireEvent("editcomplete",i)}};Common.UI.alert(e)}).on("close",function(t){i._mailMergeDlg=void 0}),i._mailMergeDlg.show()))},onMergeClick:function(t,e,i){var n,o;Math.min(Math.max(this._state.recipientsCount-1,0),99);if(this.radioFromTo.getValue()){if(!this.checkFromToValues())return;o=parseInt(this.txtFieldFrom.getValue())-1,n=parseInt(this.txtFieldTo.getValue())-1,n=Math.min(n,99+o),this.txtFieldTo.setValue(n+1)}null==this.emailAddresses?((o=DE.getController("Main")).loadMask||(o.loadMask=new Common.UI.LoadMask({owner:a("#viewport")})),o.loadMask.setTitle(this.requestMailsTitle),o.loadMask.show(),Common.Gateway.requestEmailAddresses()):this.showMergeMailDlg()},onSetEmailAddresses:function(e){var t=DE.getController("Main").loadMask;t&&t.hide(),e&&e.data&&(e.data.error?(t={width:500,closable:!1,title:this.notcriticalErrorTitle,msg:e.data.error,iconCls:"warn",buttons:l.isEmpty(e.data.createEmailAccountUrl)?["ok"]:["custom","cancel"],primary:l.isEmpty(e.data.createEmailAccountUrl)?["ok"]:"custom",customButtonText:this.textGoToMail,callback:l.bind(function(t){"custom"==t&&window.open(e.data.createEmailAccountUrl,"_blank"),this.fireEvent("editcomplete",this)},this)},Common.UI.alert(t)):(this.emailAddresses=e.data.emailAddresses,this.showMergeMailDlg()))},showMergeMailDlg:function(){var i;this._mailMergeDlg||((i=this)._mailMergeDlg=new DE.Views.MailMergeEmailDlg({props:{fieldsList:this._state.fieldsList,emailAddresses:this.emailAddresses},handler:function(t,e){"ok"==t&&(i.mergeMailData=e,(t=DE.getController("Main")).loadMask||(t.loadMask=new Common.UI.LoadMask({owner:a("#viewport")})),t.loadMask.setTitle(i.downloadMergeTitle),t.loadMask.show(),Common.Gateway.requestStartMailMerge()),i.fireEvent("editcomplete",i)}}),i._mailMergeDlg.on("close",function(t){i._mailMergeDlg=void 0}),i._mailMergeDlg.show())},onProcessMailMerge:function(t){var e=DE.getController("Main").loadMask;e&&e.hide(),t&&(t.enabled?this.sendMergeDataByEmail():(e={closable:!1,title:this.notcriticalErrorTitle,msg:l.isEmpty(t.message)?this.warnProcessMailMerge:t.message,iconCls:"warn",buttons:["ok"],callback:l.bind(function(t){this.fireEvent("editcomplete",this)},this)},Common.UI.alert(e)))},sendMergeDataByEmail:function(){var t,e,i;this.api&&(t=0,e=Math.min(Math.max(this._state.recipientsCount-1,0),99),this.radioCurrent.getValue()?t=e=parseInt(this.txtFieldNum.getValue())-1:this.radioFromTo.getValue()&&(t=parseInt(this.txtFieldFrom.getValue())-1,e=parseInt(this.txtFieldTo.getValue())-1),(i=new Asc.CMailMergeSendData).put_RecordFrom(t),i.put_RecordTo(e),i.put_From(this.mergeMailData.from),i.put_To(this.mergeMailData.to),i.put_Subject(this.mergeMailData.subject),i.put_MailFormat(this.mergeMailData.mailFormat),this.mergeMailData.mailFormat!==Asc.c_oAscFileType.HTML&&(i.put_FileName(this.mergeMailData.fileName),i.put_Message(this.mergeMailData.message)),this.api.asc_sendMailMergeData(i),this.fireEvent("editcomplete",this))},onLongActionEnd:function(t,e){e==Asc.c_oAscAsyncAction.SendMailMerge&&Common.UI.info({closable:!1,width:500,msg:this.textSendMsg,iconCls:"info",buttons:["ok"],callback:l.bind(function(t){this.fireEvent("editcomplete",this)},this)})},onBtnPreviewFieldClick:function(t,e){var i=parseInt(this.txtFieldNum.getValue()),i=isNaN(i)?0:i-1;switch(t.options.value){case 0:i=0;break;case 1:i--;break;case 2:i++;break;case 3:i=this._state.recipientsCount-1}(i=i<0?0:i)>this._state.recipientsCount-1&&(i=this._state.recipientsCount-1),this.api.asc_PreviewMailMergeResult(i),this.fireEvent("editcomplete",this)},disableFieldBtns:function(t){var e=this._state.recipientsCount<1||"checked"!==this.chPreview.getValue(),i=e||t<1;this.btnFirst.isDisabled()!==i&&this.btnFirst.setDisabled(i),this.btnPrev.isDisabled()!==i&&this.btnPrev.setDisabled(i),i=e||t>this._state.recipientsCount-2,this.btnLast.isDisabled()!==i&&this.btnLast.setDisabled(i),this.btnNext.isDisabled()!==i&&this.btnNext.setDisabled(i),i=e||t<0,this.txtFieldNum.isDisabled()!==i&&this.txtFieldNum.setDisabled(i),0<=t&&this.txtFieldNum.setValue(t+1)},onPreviewMailMergeResult:function(t){"checked"!==this.chPreview.getValue()&&this.chPreview.setValue(!0),this.disableFieldBtns(t),this.disableEditing(!0)},onEndPreviewMailMergeResult:function(){"checked"==this.chPreview.getValue()&&this.chPreview.setValue(!1),this.disableFieldBtns(-1),this.disableEditing(!1)},onStartMailMerge:function(){this.btnInsField&&this.btnInsField.menu.removeAll(),this.txtFieldNum&&this.txtFieldNum.setValue(1),this.ChangeSettings({recipientsCount:this.api.asc_GetReceptionsCount(),fieldsList:this.api.asc_GetMailMergeFieldsNameList()})},onCmbMergeToSelect:function(t,e){e=e.value==Asc.c_oAscFileType.HTML;this.btnMerge.setVisible(e),this.btnPortal.setVisible(!e&&(this.mode.canRequestSaveAs||this.mode.mergeFolderUrl)),this.btnDownload.setVisible(!e)},setLocked:function(t){this._locked=t},disableControls:function(t){this._initSettings||this.lockControls(DE.enumLockMM.lostConnect,t,{array:l.union([this.btnEditData,this.btnInsField,this.chHighlight],this.mode.canRequestSaveAs||this.mode.mergeFolderUrl?[this.btnPortal]:[]),merge:!0})},disableInsertControls:function(t){this.lockControls(DE.enumLockMM.coAuth,t,{array:[this.btnInsField]})},setMode:function(t){this.mode=t},disableEditing:function(t){Common.NotificationCenter.trigger("editing:disable",t,{viewMode:t,reviewMode:!1,fillFormMode:!1,allowMerge:!0,allowSignature:!1,allowProtect:!1,rightMenu:{clear:!1,disable:!0},statusBar:!0,leftMenu:{disable:!1,previewMode:!0},fileMenu:!1,navigation:{disable:!1,previewMode:!0},comments:{disable:!1,previewMode:!0},chat:!1,review:!0,viewport:!1,documentHolder:{clear:!1,disable:!0},toolbar:!0,plugins:!1,protect:!1},"mailmerge"),this.lockControls(DE.enumLockMM.preview,t,{array:[this.btnInsField,this.btnEditData]})},setDocumentName:function(t){this.defFileName=t||this.txtUntitled;t=this.defFileName.lastIndexOf(".");0<t&&(this.defFileName=this.defFileName.substring(0,t))},openHelp:function(t){DE.getController("LeftMenu").getView("LeftMenu").showMenu("file:help","UsageInstructions/UseMailMerge.htm")},disablePreviewMode:function(){this.api&&this.chPreview&&"checked"==this.chPreview.getValue()&&this.api.asc_EndPreviewMailMergeResult()},lockControls:function(t,e,i){Common.Utils.lockControls(t,e,i,this.emptyDBControls)}},DE.Views.MailMergeSettings||{}))}),define("text!documenteditor/main/app/template/TextArtSettings.template",[],function(){return'<table cols="1">\n    <tr>\n        <td>\n            <label class="header"><%= scope.textTemplate %></label>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <div class="" id="textart-combo-template" style="width: 100%; height: 64px;"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr>\n        <td>\n            <label class="header"><%= scope.strFill %></label>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <div id="textart-combo-fill-src" style="width: 100%;"></div>\n        </td>\n    </tr>\n    <tr>\n        <td>\n            <div id="textart-panel-color-fill" class="padding-small" style="width: 100%;">\n                <div id="textart-back-color-btn" style=""></div>\n            </div>\n            <div id="textart-panel-gradient-fill" class="settings-hidden padding-small" style="width: 100%;">\n                <table cols="3" style="margin-bottom: 10px;">\n                    <tr valign="top">\n                        <td colspan="2">\n                            <div>\n                                <label class="input-label" style=""><%= scope.textStyle %></label>\n                                <div id="textart-combo-grad-type" style="width: 100%;"></div>\n                            </div>\n                        </td>\n                        <td rowspan="2" style="width: 100%;">\n                            <div class="float-right">\n                                <label class="input-label"><%= scope.textDirection %></label>\n                                <div id="textart-button-direction"></div>\n                            </div>\n                        </td>\n                    </tr>\n                    <tr valign="bottom">\n                        <td>\n                            <label class="input-label angle-label"><%= scope.textAngle %></label>\n                        </td>\n                        <td>\n                            <div id="textart-spin-gradient-angle" style="display: inline-block; width: 60px;"></div>\n                        </td>\n                    </tr>\n                </table>\n                <label class="input-label" style="display:block;margin-bottom: 5px;"><%= scope.textGradient %></label>\n                <div style="display: inline-block; margin-top: 3px;">\n                    <div id="textart-slider-gradient" style="display: inline-block; vertical-align: middle;"></div>\n                </div>\n                <div style="height: 40px;margin-top:6px;display:flex;justify-content:space-between;">\n                    <div style="display: flex;">\n                    <div style="">\n                        <label class="input-label" style=""><%= scope.strColor %></label>\n                        <div id="textart-gradient-color-btn"></div>\n                    </div>\n                    <div class="margin-left-10">\n                        <label class="input-label" style=""><%= scope.textPosition %></label>\n                        <div id="textart-gradient-position"></div>\n                    </div>\n                    </div>\n                    <div style="display:flex;padding-top:15px;">\n                        <div id="textart-gradient-add-step"></div>\n                        <div id="textart-gradient-remove-step"></div>\n                    </div>\n                </div>\n            </div>\n        </td>\n    </tr>\n    <tr>\n        <td>\n            <div class="padding-small" id="textart-panel-transparent-fill" style="width: 100%;">\n                <label class="header" style="display:block;"><%= scope.strTransparency %></label>\n                <div style="display: inline-block; margin-top: 3px;">\n                    <label id="textart-lbl-transparency-start">0</label>\n                    <div id="textart-slider-transparency" style="display: inline-block;margin: 0 4px; vertical-align: middle;"></div>\n                    <label id="textart-lbl-transparency-end">100</label>\n                </div>\n                <div id="textart-spin-transparency" class="float-right"></div>\n            </div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr>\n        <td>\n            <label class="header"><%= scope.strStroke %></label>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n        <div style="display:inline-block;width:100px;vertical-align: middle;">\n            <label class="input-label" style=""><%= scope.strSize %></label>\n            <div id="textart-combo-border-size" style="width: 93px;"></div>\n        </div>\n        <div style="display:inline-block;vertical-align: middle;">\n            <label class="input-label" style=""><%= scope.strColor %></label>\n            <div id="textart-border-color-btn" style=""></div>\n        </div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n        <div style="display:inline-block;width:100px;vertical-align: middle;">\n            <label class="input-label" style=""><%= scope.strType %></label>\n            <div id="textart-combo-border-type" style="width: 93px;"></div>\n        </div>\n        </td>\n    </tr>\n     <tr>\n        <td>\n            <div class="padding-small" id="textart-line-panel-transparent" style="width: 100%;">\n                <label class="header" style="display:block;"><%= scope.strTransparency %></label>\n                <div style="display: inline-block; margin-top: 3px;">\n                    <label id="textart-line-lbl-transparency-start">0</label>\n                    <div id="textart-line-slider-transparency" style="display: inline-block;margin: 0 4px; vertical-align: middle;"></div>\n                    <label id="textart-line-lbl-transparency-end">100</label>\n                </div>\n                <div id="textart-line-spin-transparency" class="float-right"></div>\n            </div>\n        </td>\n    </tr>\n    <tr class="textart-transform">\n        <td class="padding-small">\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr class="textart-transform">\n        <td>\n            <label class="header"><%= scope.textTransform %></label>\n        </td>\n    </tr>\n    <tr class="textart-transform">\n        <td class="padding-small">\n            <div class="" id="textart-combo-transform" style="width: 100%; height: 42px;"></div>\n        </td>\n    </tr>\n    <tr class="finish-cell"></tr>\n</table>'}),define("documenteditor/main/app/view/TextArtSettings",["text!documenteditor/main/app/template/TextArtSettings.template","jquery","underscore","backbone","common/main/lib/component/ComboBox","common/main/lib/component/ComboBorderSize","common/main/lib/component/MetricSpinner","common/main/lib/component/ThemeColorPalette","common/main/lib/component/ColorButton","common/main/lib/component/ComboDataView","common/main/lib/component/Slider","common/main/lib/component/MultiSliderGradient"],function(t,s,f,e){"use strict";DE.Views.TextArtSettings=e.View.extend(f.extend({el:"#id-textart-settings",template:f.template(t),events:{},options:{alias:"TextArtSettings"},initialize:function(){this._initSettings=!0,this._noApply=!0,this.imgprops=null,this.shapeprops=null,this._sendUndoPoint=!0,this._sliderChanged=!1,this._sliderChangedLine=this._sliderChanged,this.txtPt=Common.Utils.Metric.getMetricName(Common.Utils.Metric.c_MetricUnits.pt),this._state={Transparency:null,FillType:Asc.c_oAscFill.FILL_TYPE_SOLID,ShapeColor:"transparent",StrokeType:Asc.c_oAscStrokeType.STROKE_COLOR,StrokeWidth:this._pt2mm(1),StrokeColor:"000000",StrokeBorderType:Asc.c_oDashType.solid,GradColor:"000000",GradFillType:Asc.c_oAscFillGradType.GRAD_LINEAR,FormId:null,DisabledControls:!1,applicationPixelRatio:Common.Utils.applicationPixelRatio(),isFromSmartArtInternal:!1,HideTransformSettings:!1},this.lockedControls=[],this._locked=!1,this.OriginalFillType=Asc.c_oAscFill.FILL_TYPE_SOLID,this.ShapeColor={Value:1,Color:"transparent"},this.GradFillType=Asc.c_oAscFillGradType.GRAD_LINEAR,this.GradColor={values:[0,100],colors:["000000","ffffff"],currentIdx:0},this.GradRadialDirectionIdx=0,this.GradLinearDirectionType=0,this.BorderColor={Value:1,Color:"transparent"},this.BorderSize=0,this.BorderType=Asc.c_oDashType.solid,this.gradientColorsStr="#000, #fff",this.typeGradient=90,DE.getCollection("Common.Collections.TextArt").bind({reset:this.fillTextArt.bind(this)}),this.render()},render:function(){(this.$el||s(this.el)).html(this.template({scope:this})),this.FillColorContainer=s("#textart-panel-color-fill"),this.FillGradientContainer=s("#textart-panel-gradient-fill"),this.TransparencyContainer=s("#textart-panel-transparent-fill"),this.LineTransparencyContainer=s("#textart-line-panel-transparent"),this.TransformSettings=s(".textart-transform"),s(window).on("resize",f.bind(this.onWindowResize,this))},setApi:function(t){return this.api=t,this},onFillSrcSelect:function(t,e){switch(this.ShowHideElem(e.value),e.value){case Asc.c_oAscFill.FILL_TYPE_SOLID:this._state.FillType=Asc.c_oAscFill.FILL_TYPE_SOLID,this._noApply||(o=new Asc.asc_TextArtProperties,(s=new Asc.asc_CShapeFill).put_type(Asc.c_oAscFill.FILL_TYPE_SOLID),s.put_fill(new Asc.asc_CFillSolid),s.get_fill().put_color(Common.Utils.ThemeColor.getRgbColor("transparent"==this.ShapeColor.Color?{color:"4f81bd",effectId:24}:this.ShapeColor.Color)),o.asc_putFill(s),this.shapeprops.put_TextArtProperties(o),this.api.ImgApply(this.imgprops));break;case Asc.c_oAscFill.FILL_TYPE_GRAD:var i,n;this._state.FillType=Asc.c_oAscFill.FILL_TYPE_GRAD,this._noApply||(o=new Asc.asc_TextArtProperties,(s=new Asc.asc_CShapeFill).put_type(Asc.c_oAscFill.FILL_TYPE_GRAD),s.put_fill(new Asc.asc_CFillGrad),s.get_fill().put_grad_type(this.GradFillType),this.GradFillType==Asc.c_oAscFillGradType.GRAD_LINEAR&&(s.get_fill().put_linear_angle(6e4*this.GradLinearDirectionType),s.get_fill().put_linear_scale(!0)),this.OriginalFillType!==Asc.c_oAscFill.FILL_TYPE_GRAD&&(this.GradColor.values=[0,100],this.GradColor.colors=[this.GradColor.colors[0],this.GradColor.colors[this.GradColor.colors.length-1]],this.GradColor.currentIdx=0,n=Common.Utils.ThemeColor.getRgbColor(this.GradColor.colors[0]).get_color().get_hex(),i=Common.Utils.ThemeColor.getRgbColor(this.GradColor.colors[1]).get_color().get_hex(),n="ffffff"===n&&"ffffff"===i?{color:"4f81bd",effectId:24}:this.GradColor.colors[0],s.get_fill().put_positions([1e3*this.GradColor.values[0],1e3*this.GradColor.values[1]]),s.get_fill().put_colors([Common.Utils.ThemeColor.getRgbColor(n),Common.Utils.ThemeColor.getRgbColor(this.GradColor.colors[1])])),o.asc_putFill(s),this.shapeprops.put_TextArtProperties(o),this.api.ImgApply(this.imgprops));break;case Asc.c_oAscFill.FILL_TYPE_NOFILL:var o,s;this._state.FillType=Asc.c_oAscFill.FILL_TYPE_NOFILL,this._noApply||(o=new Asc.asc_TextArtProperties,(s=new Asc.asc_CShapeFill).put_type(Asc.c_oAscFill.FILL_TYPE_NOFILL),s.put_fill(null),o.asc_putFill(s),this.shapeprops.put_TextArtProperties(o),this.api.ImgApply(this.imgprops))}this.fireEvent("editcomplete",this)},onColorsBackSelect:function(t,e){var i;this.ShapeColor={Value:1,Color:e},this.api&&!this._noApply&&(e=new Asc.asc_TextArtProperties,i=new Asc.asc_CShapeFill,"transparent"==this.ShapeColor.Color?(i.put_type(Asc.c_oAscFill.FILL_TYPE_NOFILL),i.put_fill(null)):(i.put_type(Asc.c_oAscFill.FILL_TYPE_SOLID),i.put_fill(new Asc.asc_CFillSolid),i.get_fill().put_color(Common.Utils.ThemeColor.getRgbColor(this.ShapeColor.Color))),e.asc_putFill(i),this.shapeprops.put_TextArtProperties(e),this.api.ImgApply(this.imgprops)),this.fireEvent("editcomplete",this)},onNumTransparencyChange:function(t,e,i,n){var o,s;this.sldrTransparency.setValue(t.getNumberValue(),!0),this.api&&(t=t.getNumberValue(),o=new Asc.asc_TextArtProperties,(s=new Asc.asc_CShapeFill).put_transparent(2.55*t),o.asc_putFill(s),this.shapeprops.put_TextArtProperties(o),this.api.ImgApply(this.imgprops))},onTransparencyChange:function(t,e,i){this._sliderChanged=e,this.numTransparency.setValue(e,!0),this._sendUndoPoint&&(this.api.setStartPointHistory(),this._sendUndoPoint=!1,this.updateslider=setInterval(f.bind(this._transparencyApplyFunc,this),100))},onTransparencyChangeComplete:function(t,e,i){clearInterval(this.updateslider),this._sliderChanged=e,this._sendUndoPoint||(this.api.setEndPointHistory(),this._transparencyApplyFunc()),this._sendUndoPoint=!0},_transparencyApplyFunc:function(){var t,e;void 0!==this._sliderChanged&&(t=new Asc.asc_TextArtProperties,(e=new Asc.asc_CShapeFill).put_transparent(2.55*this._sliderChanged),t.asc_putFill(e),this.shapeprops.put_TextArtProperties(t),this.api.ImgApply(this.imgprops),this._sliderChanged=void 0)},onGradTypeSelect:function(t,e){var i;this.GradFillType=e.value,this.GradFillType==Asc.c_oAscFillGradType.GRAD_LINEAR?(this.mnuDirectionPicker.store.reset(this._viewDataLinear),this.mnuDirectionPicker.cmpEl.width(175),this.mnuDirectionPicker.restoreHeight=174,e=this.mnuDirectionPicker.store.findWhere({type:this.GradLinearDirectionType}),this.mnuDirectionPicker.selectRecord(e,!0),this.typeGradient=e?this.GradLinearDirectionType+90:-1,this.numGradientAngle.setValue(this.GradLinearDirectionType,!0),this.numGradientAngle.setDisabled(this._locked)):this.GradFillType==Asc.c_oAscFillGradType.GRAD_PATH&&(this.mnuDirectionPicker.store.reset(this._viewDataRadial),this.mnuDirectionPicker.cmpEl.width(60),this.mnuDirectionPicker.restoreHeight=58,this.mnuDirectionPicker.selectByIndex(this.GradRadialDirectionIdx,!0),0<=this.GradRadialDirectionIdx?this.typeGradient=this._viewDataRadial[this.GradRadialDirectionIdx].type:this.typeGradient=-1,this.numGradientAngle.setValue(0,!0),this.numGradientAngle.setDisabled(!0)),this.api&&!this._noApply&&(e=new Asc.asc_TextArtProperties,(i=new Asc.asc_CShapeFill).put_type(Asc.c_oAscFill.FILL_TYPE_GRAD),i.put_fill(new Asc.asc_CFillGrad),i.get_fill().put_grad_type(this.GradFillType),this.GradFillType==Asc.c_oAscFillGradType.GRAD_LINEAR&&(i.get_fill().put_linear_angle(6e4*this.GradLinearDirectionType),i.get_fill().put_linear_scale(!0)),e.asc_putFill(i),this.shapeprops.put_TextArtProperties(e),this.api.ImgApply(this.imgprops)),this.fireEvent("editcomplete",this)},onSelectGradient:function(t,e,i,n){if(!this._noApply){var o,s={};if(f.isFunction(n.toJSON)){if(!n.get("selected"))return;s=n.toJSON()}else s=n;this.GradFillType===Asc.c_oAscFillGradType.GRAD_LINEAR?(this.GradLinearDirectionType=s.type,this.typeGradient=s.type+90):(this.GradRadialDirectionIdx=0,this.typeGradient=s.type),this.api&&this.GradFillType==Asc.c_oAscFillGradType.GRAD_LINEAR&&(this.numGradientAngle.setValue(s.type,!0),n=new Asc.asc_TextArtProperties,(o=new Asc.asc_CShapeFill).put_type(Asc.c_oAscFill.FILL_TYPE_GRAD),o.put_fill(new Asc.asc_CFillGrad),o.get_fill().put_grad_type(this.GradFillType),o.get_fill().put_linear_angle(6e4*s.type),o.get_fill().put_linear_scale(!0),n.asc_putFill(o),this.shapeprops.put_TextArtProperties(n),this.api.ImgApply(this.imgprops)),this.fireEvent("editcomplete",this)}},onColorsGradientSelect:function(t,e){var i,n;this.GradColor.colors[this.GradColor.currentIdx]=e,this.sldrGradient.setColorValue(Common.Utils.String.format("#{0}","object"==typeof e?e.color:e)),this.api&&!this._noApply&&(e=new Asc.asc_TextArtProperties,(i=new Asc.asc_CShapeFill).put_type(Asc.c_oAscFill.FILL_TYPE_GRAD),i.put_fill(new Asc.asc_CFillGrad),i.get_fill().put_grad_type(this.GradFillType),n=[],this.GradColor.colors.forEach(function(t){n.push(Common.Utils.ThemeColor.getRgbColor(t))}),i.get_fill().put_colors(n),this.OriginalFillType!==Asc.c_oAscFill.FILL_TYPE_GRAD&&(this.GradFillType==Asc.c_oAscFillGradType.GRAD_LINEAR&&(i.get_fill().put_linear_angle(6e4*this.GradLinearDirectionType),i.get_fill().put_linear_scale(!0)),n=[],this.GradColor.values.forEach(function(t){n.push(1e3*t)}),i.get_fill().put_positions(n)),e.asc_putFill(i),this.shapeprops.put_TextArtProperties(e),this.api.ImgApply(this.imgprops)),this.fireEvent("editcomplete",this)},onGradientChange:function(t,e,i){this.GradColor.values=t.getValues();t=this.GradColor.values[this.GradColor.currentIdx];this.spnGradPosition.setValue(Common.UI.isRTL()?this.sldrGradient.maxValue-t:t,!0),this._sliderChanged=!0,this.api&&!this._noApply&&this._sendUndoPoint&&(this.api.setStartPointHistory(),this._sendUndoPoint=!1,this.updateslider=setInterval(f.bind(this._gradientApplyFunc,this),100))},onGradientChangeComplete:function(t,e,i){clearInterval(this.updateslider),this._sliderChanged=!0,this._sendUndoPoint||(this.api.setEndPointHistory(),this._gradientApplyFunc()),this._sendUndoPoint=!0},_gradientApplyFunc:function(){var t,e,i;this._sliderChanged&&(t=new Asc.asc_TextArtProperties,(e=new Asc.asc_CShapeFill).put_type(Asc.c_oAscFill.FILL_TYPE_GRAD),e.put_fill(new Asc.asc_CFillGrad),e.get_fill().put_grad_type(this.GradFillType),i=[],this.GradColor.values.forEach(function(t){i.push(1e3*t)}),e.get_fill().put_positions(i),this.OriginalFillType!==Asc.c_oAscFill.FILL_TYPE_GRAD&&(this.GradFillType==Asc.c_oAscFillGradType.GRAD_LINEAR&&(e.get_fill().put_linear_angle(6e4*this.GradLinearDirectionType),e.get_fill().put_linear_scale(!0)),i=[],this.GradColor.colors.forEach(function(t){i.push(Common.Utils.ThemeColor.getRgbColor(t))}),e.get_fill().put_colors(i)),t.asc_putFill(e),this.shapeprops.put_TextArtProperties(t),this.api.ImgApply(this.imgprops),this._sliderChanged=!1)},applyBorderSize:function(t){var e;t=Common.Utils.String.parseFloat(t),t=isNaN(t)?0:Math.max(0,Math.min(1584,t)),this.BorderSize=t,this.api&&!this._noApply&&(t=new Asc.asc_TextArtProperties,e=new Asc.asc_CStroke,this.BorderSize<1e-5?(e.put_type(Asc.c_oAscStrokeType.STROKE_NONE),this._state.StrokeType=this._state.StrokeWidth=-1):(e.put_type(Asc.c_oAscStrokeType.STROKE_COLOR),"transparent"==this.BorderColor.Color||"transparent"==this.BorderColor.Color.color?e.put_color(Common.Utils.ThemeColor.getRgbColor({color:"000000",effectId:29})):this._state.StrokeType!=Asc.c_oAscStrokeType.STROKE_NONE&&null!==this._state.StrokeType||e.put_color(Common.Utils.ThemeColor.getRgbColor(Common.Utils.ThemeColor.colorValue2EffectId(this.BorderColor.Color))),e.asc_putPrstDash(this.BorderType),e.put_width(this._pt2mm(this.BorderSize)),e.put_transparent(this._state.LineTransparency)),t.asc_putLine(e),this.shapeprops.put_TextArtProperties(t),this.api.ImgApply(this.imgprops)),this.fireEvent("editcomplete",this)},onComboBlur:function(){this.fireEvent("editcomplete",this)},onBorderSizeChanged:function(t,e,i,n){var o=this;t?(t=parseFloat(i.value),(!new RegExp("^\\s*(\\d*(\\.|,)?\\d+)\\s*("+o.txtPt+")?\\s*$").exec(i.value)||t<0||1584<t)&&(this._state.StrokeType=this._state.StrokeWidth=-1,setTimeout(function(){Common.UI.error({msg:o.textBorderSizeErr,callback:function(){f.defer(function(t){o.fireEvent("editcomplete",o)})}})},10))):this.applyBorderSize(i.value)},onBorderSizeSelect:function(t,e){this.applyBorderSize(e.value)},onBorderTypeSelect:function(t,e){var i;this.BorderType=e.value,this.api&&!this._noApply&&(e=new Asc.asc_TextArtProperties,i=new Asc.asc_CStroke,this.BorderSize<1e-5?i.put_type(Asc.c_oAscStrokeType.STROKE_NONE):(i.put_type(Asc.c_oAscStrokeType.STROKE_COLOR),i.put_color(Common.Utils.ThemeColor.getRgbColor(this.BorderColor.Color)),i.put_width(this._pt2mm(this.BorderSize)),i.asc_putPrstDash(this.BorderType),i.put_transparent(this._state.LineTransparency)),e.asc_putLine(i),this.shapeprops.put_TextArtProperties(e),this.api.ImgApply(this.imgprops)),this.fireEvent("editcomplete",this)},onColorsBorderSelect:function(t,e){var i;this.BorderColor={Value:1,Color:e},this.api&&0<this.BorderSize&&!this._noApply&&(e=new Asc.asc_TextArtProperties,i=new Asc.asc_CStroke,this.BorderSize<1e-5?i.put_type(Asc.c_oAscStrokeType.STROKE_NONE):(i.put_type(Asc.c_oAscStrokeType.STROKE_COLOR),i.put_color(Common.Utils.ThemeColor.getRgbColor(this.BorderColor.Color)),i.put_width(this._pt2mm(this.BorderSize)),i.asc_putPrstDash(this.BorderType),i.put_transparent(this._state.LineTransparency)),e.asc_putLine(i),this.shapeprops.put_TextArtProperties(e),this.api.ImgApply(this.imgprops)),this.fireEvent("editcomplete",this)},onNumLineTransparencyChange:function(t,e,i,n){var o;this.sldrLineTransparency.setValue(t.getNumberValue(),!0),this._state.LineTransparency=2.55*t.getNumberValue(),this.api&&0<this.BorderSize&&!this._noApply&&(t=new Asc.asc_TextArtProperties,(o=new Asc.asc_CStroke).put_transparent(this._state.LineTransparency),t.asc_putLine(o),this.shapeprops.put_TextArtProperties(t),this.api.ImgApply(this.imgprops))},onLineTransparencyChange:function(t,e,i){this._sliderChangedLine=e,this.numLineTransparency.setValue(e,!0),this._sendUndoPoint&&(this.api.setStartPointHistory(),this._sendUndoPoint=!1,this.updatesliderline=setInterval(f.bind(this._transparencyLineApplyFunc,this),100))},onLineTransparencyChangeComplete:function(t,e,i){clearInterval(this.updatesliderline),this._sliderChangedLine=e,this._sendUndoPoint||(this.api.setEndPointHistory(),this._transparencyLineApplyFunc()),this._sendUndoPoint=!0},_transparencyLineApplyFunc:function(){var t,e;void 0!==this._sliderChangedLine&&(this._state.LineTransparency=2.55*this._sliderChangedLine,t=new Asc.asc_TextArtProperties,(e=new Asc.asc_CStroke).put_transparent(this._state.LineTransparency),t.asc_putLine(e),this.shapeprops.put_TextArtProperties(t),this.api.ImgApply(this.imgprops),this._sliderChangedLine=void 0)},ChangeSettings:function(t){if(null==this.imgprops?(this.imgprops=new Asc.asc_CImgProperty,this.imgprops.put_ShapeProperties(new Asc.asc_CShapeProperty),this.shapeprops=this.imgprops.get_ShapeProperties()):this.imgprops.put_ImageUrl(null),this._initSettings&&this.createDelayedElements(),this._state.isFromSmartArtInternal=t.get_ShapeProperties()&&t.get_ShapeProperties().get_FromSmartArtInternal(),this.hideTransformSettings(this._state.isFromSmartArtInternal),t&&t.get_ShapeProperties()&&t.get_ShapeProperties().get_TextArtProperties()){var t=t.get_ShapeProperties().get_TextArtProperties(),e=(this._noApply=!0,this.disableControls(this._locked),null),i=(h=t.asc_getFill())?h.get_type():null,n=null;if(h&&(b=h.get_transparent(),(.001<Math.abs(this._state.Transparency-b)||.001<Math.abs(this.numTransparency.getNumberValue()-b)||!(null!==this._state.Transparency&&null!==b||this._state.Transparency===b&&this.numTransparency.getNumberValue()===b))&&(void 0!==b&&(this.sldrTransparency.setValue(null===b?100:b/255*100,!0),this.numTransparency.setValue(this.sldrTransparency.getValue(),!0)),this._state.Transparency=b)),null==h||null===i)this.OriginalFillType=null;else if(i==Asc.c_oAscFill.FILL_TYPE_NOFILL)this.OriginalFillType=Asc.c_oAscFill.FILL_TYPE_NOFILL;else if(i==Asc.c_oAscFill.FILL_TYPE_SOLID)(n=(h=h.get_fill()).get_color())?n.get_type()==Asc.c_oAscColor.COLOR_TYPE_SCHEME?this.ShapeColor={Value:1,Color:{color:Common.Utils.ThemeColor.getHexColor(n.get_r(),n.get_g(),n.get_b()),effectValue:n.get_value()}}:this.ShapeColor={Value:1,Color:Common.Utils.ThemeColor.getHexColor(n.get_r(),n.get_g(),n.get_b())}:this.ShapeColor={Value:0,Color:"transparent"},this.OriginalFillType=Asc.c_oAscFill.FILL_TYPE_SOLID,this.GradColor.colors[0]="transparent"!==this.ShapeColor.Color?Common.Utils.ThemeColor.colorValue2EffectId(this.ShapeColor.Color):"000000",this.GradColor.colors[this.GradColor.colors.length-1]="ffffff";else if(i==Asc.c_oAscFill.FILL_TYPE_GRAD){for(var i=(h=h.get_fill()).get_grad_type(),o=(this._state.GradFillType===i&&this.GradFillType===i||(this.GradFillType=i,e=void 0,this.GradFillType==Asc.c_oAscFillGradType.GRAD_LINEAR||this.GradFillType==Asc.c_oAscFillGradType.GRAD_PATH?(this.cmbGradType.setValue(this.GradFillType),e=this.cmbGradType.store.findWhere({value:this.GradFillType}),this.onGradTypeSelect(this.cmbGradType,e.attributes)):(this.cmbGradType.setValue(""),this.typeGradient=-1),this._state.GradFillType=this.GradFillType),this.GradFillType==Asc.c_oAscFillGradType.GRAD_LINEAR?(i=Math.floor(h.get_linear_angle()/6e4),.001<Math.abs(this.GradLinearDirectionType-i)&&(this.GradLinearDirectionType=i,s=this.mnuDirectionPicker.store.findWhere({type:i}),this.mnuDirectionPicker.selectRecord(s,!0),this.typeGradient=s?i+90:-1,this.numGradientAngle.setValue(i,!0))):this.numGradientAngle.setValue(0,!0),this),s=h.get_colors(),a=h.get_positions(),l=(s||this.GradColor.colors).length,r=(this.sldrGradient.setThumbs(l),this.GradColor.colors.length>l&&(this.GradColor.colors.splice(l,this.GradColor.colors.length-l),this.GradColor.values.splice(l,this.GradColor.colors.length-l),this.GradColor.currentIdx=0),s&&s.forEach(function(t,e){t?t.get_type()==Asc.c_oAscColor.COLOR_TYPE_SCHEME?(o.GradColor.colors[e]={color:Common.Utils.ThemeColor.getHexColor(t.get_r(),t.get_g(),t.get_b()),effectValue:t.get_value()},Common.Utils.ThemeColor.colorValue2EffectId(o.GradColor.colors[e])):o.GradColor.colors[e]=Common.Utils.ThemeColor.getHexColor(t.get_r(),t.get_g(),t.get_b()):o.GradColor.colors[e]="000000";t=a[e];null!==t&&(o.GradColor.values[e]=t/=1e3)}),[]),c=this.GradFillType==Asc.c_oAscFillGradType.GRAD_LINEAR?1:.7,d=0;d<l;d++)o.sldrGradient.setColorValue(Common.Utils.String.format("#{0}","object"==typeof o.GradColor.colors[d]?o.GradColor.colors[d].color:o.GradColor.colors[d]),d),o.sldrGradient.setValue(d,o.GradColor.values[d]),r.push(o.sldrGradient.getColorValue(d)+" "+o.sldrGradient.getValue(d)*c+"%");this.btnDirectionRedraw(o.sldrGradient,r.join(", ")),(f.isUndefined(o.GradColor.currentIdx)||o.GradColor.currentIdx>=this.GradColor.colors.length)&&(o.GradColor.currentIdx=0),o.sldrGradient.setActiveThumb(o.GradColor.currentIdx);i=this.GradColor.values[this.GradColor.currentIdx];this.spnGradPosition.setValue(Common.UI.isRTL()?o.sldrGradient.maxValue-i:i),this.OriginalFillType=Asc.c_oAscFill.FILL_TYPE_GRAD,this.ShapeColor={Value:1,Color:this.GradColor.colors[0]}}this._state.FillType!==this.OriginalFillType&&(this.cmbFillSrc.setValue(null===this.OriginalFillType?"":this.OriginalFillType),this._state.FillType=this.OriginalFillType,this.ShowHideElem(this.OriginalFillType));var h=typeof this.ShapeColor.Color;if(h!=typeof this._state.ShapeColor||"object"==h&&(this.ShapeColor.Color.effectValue!==this._state.ShapeColor.effectValue||this._state.ShapeColor.color.indexOf(this.ShapeColor.Color.color)<0)||"object"!=h&&this._state.ShapeColor.indexOf(this.ShapeColor.Color)<0){if(this.btnBackColor.setColor(this.ShapeColor.Color),"object"==typeof this.ShapeColor.Color){for(var m=!1,p=0;p<10;p++)if(Common.Utils.ThemeColor.ThemeValues[p]==this.ShapeColor.Color.effectValue){this.colorsBack.select(this.ShapeColor.Color,!0),m=!0;break}m||this.colorsBack.clearSelection()}else this.colorsBack.select(this.ShapeColor.Color,!0);this._state.ShapeColor=this.ShapeColor.Color}var u,g,b,s=t.asc_getLine(),i=s?s.get_type():null,C="transparent"==this._state.StrokeColor&&"transparent"!==this.BorderColor.Color;if(s?(b=s.get_transparent(),(.001<Math.abs(this._state.LineTransparency-b)||.001<Math.abs(this.numLineTransparency.getNumberValue()-b)||!(null!==this._state.LineTransparency&&null!==b||this._state.LineTransparency===b&&this.numLineTransparency.getNumberValue()===b))&&(void 0!==b&&(this.sldrLineTransparency.setValue(null===b?100:b/255*100,!0),this.numLineTransparency.setValue(this.sldrLineTransparency.getValue(),!0)),this._state.LineTransparency=b),i==Asc.c_oAscStrokeType.STROKE_COLOR&&(n=s.get_color())?n.get_type()==Asc.c_oAscColor.COLOR_TYPE_SCHEME?this.BorderColor={Value:1,Color:{color:Common.Utils.ThemeColor.getHexColor(n.get_r(),n.get_g(),n.get_b()),effectValue:n.get_value()}}:this.BorderColor={Value:1,Color:Common.Utils.ThemeColor.getHexColor(n.get_r(),n.get_g(),n.get_b())}:this.BorderColor={Value:1,Color:"transparent"},u=s.asc_getPrstDash()):this.BorderColor={Value:0,Color:"transparent"},h=typeof this.BorderColor.Color,b=typeof this._state.StrokeColor,C||h!=b||"object"==h&&(this.BorderColor.Color.effectValue!==this._state.StrokeColor.effectValue||this._state.StrokeColor.color.indexOf(this.BorderColor.Color.color)<0)||"object"!=h&&(this._state.StrokeColor.indexOf(this.BorderColor.Color)<0||"object"==typeof this.btnBorderColor.color)){if(this.btnBorderColor.setColor(this.BorderColor.Color),"object"==typeof this.BorderColor.Color){for(m=!1,p=0;p<10;p++)if(Common.Utils.ThemeColor.ThemeValues[p]==this.BorderColor.Color.effectValue){this.colorsBorder.select(this.BorderColor.Color,!0),m=!0;break}m||this.colorsBorder.clearSelection()}else this.colorsBorder.select(this.BorderColor.Color,!0);this._state.StrokeColor=this.BorderColor.Color}if(this._state.StrokeType===i&&i!=Asc.c_oAscStrokeType.STROKE_COLOR||(i==Asc.c_oAscStrokeType.STROKE_COLOR?(g=s.get_width(),C=Math.abs(this._state.StrokeWidth-g)<1e-5&&!new RegExp(this.txtPt+"\\s*$").test(this.cmbBorderSize.getRawValue()),(1e-5<Math.abs(this._state.StrokeWidth-g)||C||(null===this._state.StrokeWidth||null===g)&&this._state.StrokeWidth!==g)&&((b=null===(g=null!==(this._state.StrokeWidth=g)?this._mm2pt(g):g)?g:f.find(this.cmbBorderSize.store.models,function(t){if(g<t.attributes.value+1e-4&&g>t.attributes.value-1e-4)return!0}))?this.cmbBorderSize.selectRecord(b):this.cmbBorderSize.setValue(null!==g?parseFloat(g.toFixed(2))+" "+this.txtPt:""),this.BorderSize=g)):i==Asc.c_oAscStrokeType.STROKE_NONE?(this._state.StrokeWidth=0,this.BorderSize=this.cmbBorderSize.store.at(0).get("value"),this.cmbBorderSize.setValue(this.BorderSize)):(this._state.StrokeWidth=null,this.BorderSize=-1,this.cmbBorderSize.setValue(null)),this._state.StrokeType=i),this._state.StrokeBorderType!==u&&(this.BorderType=this._state.StrokeBorderType=u,this.cmbBorderType.setValue(u)),(h=typeof(n=this.GradColor.colors[this.GradColor.currentIdx]))!=typeof this._state.GradColor||"object"==h&&(n.effectValue!==this._state.GradColor.effectValue||this._state.GradColor.color.indexOf(n.color)<0)||"object"!=h&&this._state.GradColor.indexOf(n)<0){if(this.btnGradColor.setColor(n),"object"==typeof n){for(m=!1,p=0;p<10;p++)if(Common.Utils.ThemeColor.ThemeValues[p]==n.effectValue){this.colorsGrad.select(n,!0),m=!0;break}m||this.colorsGrad.clearSelection()}else this.colorsGrad.select(n,!0);this._state.GradColor=n}s=t.asc_getForm();this._state.FormId!==s&&(this.cmbTransform.suspendEvents(),e=this.cmbTransform.menuPicker.store.findWhere({type:s}),this.cmbTransform.menuPicker.selectRecord(e),this.cmbTransform.resumeEvents(),this._state.FormId=s),this._noApply=!1}},btnDirectionRedraw:function(t,e){this.gradientColorsStr=e,f.each(this._viewDataLinear,function(t){t.gradientColorsStr=e}),this._viewDataRadial.gradientColorsStr=this.gradientColorsStr,this.mnuDirectionPicker.store.each(function(t){t.set("gradientColorsStr",e)},this),-1==this.typeGradient?this.btnDirection.$icon.css({background:"none"}):2==this.typeGradient?this.btnDirection.$icon.css({background:"radial-gradient("+e+")"}):this.btnDirection.$icon.css({background:"linear-gradient("+this.typeGradient+"deg, "+e+")"})},createDelayedControls:function(){var o=this;this._arrFillSrc=[{displayValue:this.textNoFill,value:Asc.c_oAscFill.FILL_TYPE_NOFILL},{displayValue:this.textColor,value:Asc.c_oAscFill.FILL_TYPE_SOLID},{displayValue:this.textGradientFill,value:Asc.c_oAscFill.FILL_TYPE_GRAD}],this.cmbFillSrc=new Common.UI.ComboBox({el:s("#textart-combo-fill-src"),cls:"input-group-nr",style:"width: 100%;",menuStyle:"min-width: 100%;",editable:!1,data:this._arrFillSrc,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbFillSrc.setValue(this._arrFillSrc[0].value),this.cmbFillSrc.on("selected",f.bind(this.onFillSrcSelect,this)),this.lockedControls.push(this.cmbFillSrc),this.numTransparency=new Common.UI.MetricSpinner({el:s("#textart-spin-transparency"),step:1,width:62,value:"100 %",defaultUnit:"%",maxValue:100,minValue:0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.numTransparency.on("change",f.bind(this.onNumTransparencyChange,this)),this.numTransparency.on("inputleave",function(){o.fireEvent("editcomplete",o)}),this.lockedControls.push(this.numTransparency),this.sldrTransparency=new Common.UI.SingleSlider({el:s("#textart-slider-transparency"),width:75,minValue:0,maxValue:100,value:100}),this.sldrTransparency.on("change",f.bind(this.onTransparencyChange,this)),this.sldrTransparency.on("changecomplete",f.bind(this.onTransparencyChangeComplete,this)),this.lockedControls.push(this.sldrTransparency),this.lblTransparencyStart=s(this.el).find("#textart-lbl-transparency-start"),this.lblTransparencyEnd=s(this.el).find("#textart-lbl-transparency-end"),this._arrGradType=[{displayValue:this.textLinear,value:Asc.c_oAscFillGradType.GRAD_LINEAR},{displayValue:this.textRadial,value:Asc.c_oAscFillGradType.GRAD_PATH}],this.cmbGradType=new Common.UI.ComboBox({el:s("#textart-combo-grad-type"),cls:"input-group-nr",menuStyle:"min-width: 100%;",editable:!1,data:this._arrGradType,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbGradType.setValue(this._arrGradType[0].value),this.cmbGradType.on("selected",f.bind(this.onGradTypeSelect,this)),this.lockedControls.push(this.cmbGradType),this._viewDataLinear=[{type:45,subtype:-1},{type:90,subtype:4},{type:135,subtype:5},{type:0,subtype:6,cls:"item-gradient-separator",selected:!0},{type:180,subtype:1},{type:315,subtype:2},{type:270,subtype:3},{type:225,subtype:7}],f.each(this._viewDataLinear,function(t){t.gradientColorsStr=o.gradientColorsStr}),this._viewDataRadial=[{type:2,subtype:5,gradientColorsStr:this.gradientColorsStr}],this.btnDirection=new Common.UI.Button({cls:"btn-large-dataview",scaling:!1,iconCls:"item-gradient gradient-left",menu:new Common.UI.Menu({style:"min-width: 60px;",menuAlign:"tr-br",items:[{template:f.template('<div id="id-textart-menu-direction" style="width: 175px; margin: 0 5px;"></div>')}]}),dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.btnDirection.on("render:after",function(t){o.mnuDirectionPicker=new Common.UI.DataView({el:s("#id-textart-menu-direction"),parentMenu:t.menu,restoreHeight:174,store:new Common.UI.DataViewStore(o._viewDataLinear),itemTemplate:f.template('<div id="<%= id %>" class="item-gradient" style="background: <% if(type!=2) {%>linear-gradient(<%= type + 90 %>deg,<%= gradientColorsStr %>) <%} else {%> radial-gradient(<%= gradientColorsStr %>) <%}%>;"></div>')})}),this.btnDirection.render(s("#textart-button-direction")),this.mnuDirectionPicker.on("item:click",f.bind(this.onSelectGradient,this,this.btnDirection)),this.lockedControls.push(this.btnDirection),this.sldrGradient=new Common.UI.MultiSliderGradient({el:s("#textart-slider-gradient"),width:192,minValue:0,maxValue:100,values:[0,100]}),this.sldrGradient.on("change",f.bind(this.onGradientChange,this)),this.sldrGradient.on("changecomplete",f.bind(this.onGradientChangeComplete,this)),this.sldrGradient.on("thumbclick",function(t,e){o.GradColor.currentIdx=e;e=o.GradColor.colors[o.GradColor.currentIdx],o.btnGradColor.setColor(e),o.colorsGrad.select(e,!1),e=o.GradColor.values[o.GradColor.currentIdx];o.spnGradPosition.setValue(Common.UI.isRTL()?o.sldrGradient.maxValue-e:e,!0)}),this.sldrGradient.on("thumbdblclick",function(t){o.btnGradColor.cmpEl.find("button").dropdown("toggle")}),this.sldrGradient.on("sortthumbs",function(t,e){var i,n=[];f.each(e,function(t,e){n.push(o.GradColor.colors[t]),o.GradColor.currentIdx==t&&(i=e)}),o.OriginalFillType=null,o.GradColor.colors=n,o.GradColor.currentIdx=i}),this.sldrGradient.on("addthumb",function(t,e,i){o.GradColor.colors[e]=o.GradColor.colors[o.GradColor.currentIdx],o.GradColor.currentIdx=e;e=o.sldrGradient.addNewThumb(e,i);o.GradColor.colors[o.GradColor.currentIdx]=e}),this.sldrGradient.on("removethumb",function(t,e){o.sldrGradient.removeThumb(e),o.GradColor.values.splice(e,1),o.sldrGradient.changeGradientStyle(),(f.isUndefined(o.GradColor.currentIdx)||o.GradColor.currentIdx>=o.GradColor.colors.length)&&(e=0===(e=0<e?e-1:e)&&2<o.GradColor.values.length?o.GradColor.values.length-2:e,o.GradColor.currentIdx=e),o.sldrGradient.setActiveThumb(o.GradColor.currentIdx)}),this.lockedControls.push(this.sldrGradient),this.spnGradPosition=new Common.UI.MetricSpinner({el:s("#textart-gradient-position"),step:1,width:60,defaultUnit:"%",value:"50 %",allowDecimal:!1,maxValue:100,minValue:0,disabled:this._locked,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.lockedControls.push(this.spnGradPosition),this.spnGradPosition.on("change",f.bind(this.onPositionChange,this)),this.spnGradPosition.on("inputleave",function(){o.fireEvent("editcomplete",o)}),this.btnAddGradientStep=new Common.UI.Button({parentEl:s("#textart-gradient-add-step"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-add-breakpoint",disabled:this._locked,hint:this.tipAddGradientPoint,dataHint:"1",dataHintDirection:"bottom"}),this.btnAddGradientStep.on("click",f.bind(this.onAddGradientStep,this)),this.lockedControls.push(this.btnAddGradientStep),this.btnRemoveGradientStep=new Common.UI.Button({parentEl:s("#textart-gradient-remove-step"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-remove-breakpoint",disabled:this._locked,hint:this.tipRemoveGradientPoint,dataHint:"1",dataHintDirection:"bottom"}),this.btnRemoveGradientStep.on("click",f.bind(this.onRemoveGradientStep,this)),this.lockedControls.push(this.btnRemoveGradientStep),this.numGradientAngle=new Common.UI.MetricSpinner({el:s("#textart-spin-gradient-angle"),step:10,width:60,defaultUnit:"°",value:"0 °",allowDecimal:!0,maxValue:359.9,minValue:0,disabled:this._locked,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.lockedControls.push(this.numGradientAngle),this.numGradientAngle.on("change",f.bind(this.onGradientAngleChange,this)),this.numGradientAngle.on("inputleave",function(){o.fireEvent("editcomplete",o)}),this.cmbBorderSize=new Common.UI.ComboBorderSizeEditable({el:s("#textart-combo-border-size"),style:"width: 93px;",txtNoBorders:this.txtNoBorders,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}).on("selected",f.bind(this.onBorderSizeSelect,this)).on("changed:before",f.bind(this.onBorderSizeChanged,this,!0)).on("changed:after",f.bind(this.onBorderSizeChanged,this,!1)).on("combo:blur",f.bind(this.onComboBlur,this,!1)),this.BorderSize=this.cmbBorderSize.store.at(2).get("value"),this.cmbBorderSize.setValue(this.BorderSize),this.lockedControls.push(this.cmbBorderSize),this.cmbBorderType=new Common.UI.ComboBorderType({el:s("#textart-combo-border-type"),style:"width: 93px;",menuStyle:"min-width: 93px;",dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}).on("selected",f.bind(this.onBorderTypeSelect,this)).on("combo:blur",f.bind(this.onComboBlur,this,!1)),this.BorderType=Asc.c_oDashType.solid,this.cmbBorderType.setValue(this.BorderType),this.lockedControls.push(this.cmbBorderType),this.numLineTransparency=new Common.UI.MetricSpinner({el:s("#textart-line-spin-transparency"),step:1,width:62,value:"100 %",defaultUnit:"%",maxValue:100,minValue:0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.numLineTransparency.on("change",f.bind(this.onNumLineTransparencyChange,this)),this.numLineTransparency.on("inputleave",function(){o.fireEvent("editcomplete",o)}),this.lockedControls.push(this.numLineTransparency),this.sldrLineTransparency=new Common.UI.SingleSlider({el:s("#textart-line-slider-transparency"),width:75,minValue:0,maxValue:100,value:100}),this.sldrLineTransparency.on("change",f.bind(this.onLineTransparencyChange,this)),this.sldrLineTransparency.on("changecomplete",f.bind(this.onLineTransparencyChangeComplete,this)),this.lockedControls.push(this.sldrLineTransparency),this.lblLineTransparencyStart=s(this.el).find("#textart-line-lbl-transparency-start"),this.lblLineTransparencyEnd=s(this.el).find("#textart-line-lbl-transparency-end"),this.cmbTransform=new Common.UI.ComboDataView({itemWidth:50,itemHeight:50,menuMaxHeight:300,enableKeyEvents:!0,cls:"combo-textart",dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbTransform.render(s("#textart-combo-transform")),this.cmbTransform.openButton.menu.cmpEl.css({"min-width":178,"max-width":178}),this.cmbTransform.on("click",f.bind(this.onTransformSelect,this)),this.cmbTransform.openButton.menu.on("show:after",function(){o.cmbTransform.menuPicker.scroller.update({alwaysVisibleY:!0})}),this.lockedControls.push(this.cmbTransform)},createDelayedElements:function(){this._initSettings=!1,this.createDelayedControls(),this.UpdateThemeColors(),this.fillTransform(this.api.asc_getPropertyEditorTextArts()),this.fillTextArt()},fillTextArt:function(){var t,e,i,n;this._initSettings||((t=this).cmbTextArt||(this.cmbTextArt=new Common.UI.ComboDataView({itemWidth:50,itemHeight:50,menuMaxHeight:300,enableKeyEvents:!0,showLast:!1,cls:"combo-textart",dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbTextArt.render(s("#textart-combo-template")),this.cmbTextArt.openButton.menu.cmpEl.css({"min-width":178,"max-width":178}),this.cmbTextArt.on("click",f.bind(this.onTextArtSelect,this)),this.cmbTextArt.openButton.menu.on("show:after",function(){t.cmbTextArt.menuPicker.scroller.update({alwaysVisibleY:!0})}),this.lockedControls.push(this.cmbTextArt)),e=this.application.getCollection("Common.Collections.TextArt").models,i=this.cmbTextArt.menuPicker.store.length,e.length<1?DE.getController("Main").fillTextArt(this.api.asc_getTextArtPreviews()):0<i&&i==e.length?(n=this.cmbTextArt.menuPicker.store.models,f.each(e,function(t,e){n[e].set("imageUrl",t.get("imageUrl"))})):(this.cmbTextArt.menuPicker.store.reset(e),0<this.cmbTextArt.menuPicker.store.length&&this.cmbTextArt.fillComboView(this.cmbTextArt.menuPicker.store.at(0))))},onTextArtSelect:function(t,e){var i;this.api&&!this._noApply&&((i=new Asc.asc_TextArtProperties).asc_putStyle(e.get("data")),this.shapeprops.put_TextArtProperties(i),this.api.ImgApply(this.imgprops)),this.fireEvent("editcomplete",this)},fillTransform:function(t){if(t){for(var e=[],i=0;i<t.length;i++){var n=t[i];e.push({imageUrl:n.Image,type:n.Type,selected:!1})}this.cmbTransform.menuPicker.store.reset(e),0<this.cmbTransform.menuPicker.store.length&&this.cmbTransform.fillComboView(this.cmbTransform.menuPicker.store.at(0),!0)}},onTransformSelect:function(t,e){var i;this.api&&!this._noApply&&((i=new Asc.asc_TextArtProperties).asc_putForm(e.get("type")),this.shapeprops.put_TextArtProperties(i),this.api.ImgApply(this.imgprops)),this.fireEvent("editcomplete",this)},UpdateThemeColors:function(){this._initSettings||(this.btnBackColor||(this.btnBorderColor=new Common.UI.ColorButton({parentEl:s("#textart-border-color-btn"),color:"000000",eyeDropper:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.lockedControls.push(this.btnBorderColor),this.colorsBorder=this.btnBorderColor.getPicker(),this.btnBorderColor.on("color:select",f.bind(this.onColorsBorderSelect,this)),this.btnBorderColor.on("eyedropper:start",f.bind(this.onEyedropperStart,this)),this.btnBorderColor.on("eyedropper:end",f.bind(this.onEyedropperEnd,this)),this.btnGradColor=new Common.UI.ColorButton({parentEl:s("#textart-gradient-color-btn"),color:"000000",eyeDropper:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.lockedControls.push(this.btnGradColor),this.colorsGrad=this.btnGradColor.getPicker(),this.btnGradColor.on("color:select",f.bind(this.onColorsGradientSelect,this)),this.btnGradColor.on("eyedropper:start",f.bind(this.onEyedropperStart,this)),this.btnGradColor.on("eyedropper:end",f.bind(this.onEyedropperEnd,this)),this.btnBackColor=new Common.UI.ColorButton({parentEl:s("#textart-back-color-btn"),transparent:!0,color:"transparent",eyeDropper:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.lockedControls.push(this.btnBackColor),this.colorsBack=this.btnBackColor.getPicker(),this.btnBackColor.on("color:select",f.bind(this.onColorsBackSelect,this)),this.btnBackColor.on("eyedropper:start",f.bind(this.onEyedropperStart,this)),this.btnBackColor.on("eyedropper:end",f.bind(this.onEyedropperEnd,this))),this.colorsBorder.updateColors(Common.Utils.ThemeColor.getEffectColors(),Common.Utils.ThemeColor.getStandartColors()),this.colorsBack.updateColors(Common.Utils.ThemeColor.getEffectColors(),Common.Utils.ThemeColor.getStandartColors()),this.colorsGrad.updateColors(Common.Utils.ThemeColor.getEffectColors(),Common.Utils.ThemeColor.getStandartColors()))},_pt2mm:function(t){return 25.4*t/72},_mm2pt:function(t){return 72*t/25.4},ShowHideElem:function(t){this.FillColorContainer.toggleClass("settings-hidden",t!==Asc.c_oAscFill.FILL_TYPE_SOLID),this.FillGradientContainer.toggleClass("settings-hidden",t!==Asc.c_oAscFill.FILL_TYPE_GRAD),this.TransparencyContainer.toggleClass("settings-hidden",t===Asc.c_oAscFill.FILL_TYPE_NOFILL||null===t)},setLocked:function(t){this._locked=t},disableControls:function(e){this._initSettings||this._state.DisabledControls!==e&&(this._state.DisabledControls=e,f.each(this.lockedControls,function(t){t.setDisabled(e)}),this.numGradientAngle.setDisabled(e||this.GradFillType!==Asc.c_oAscFillGradType.GRAD_LINEAR),this.lblLineTransparencyStart.toggleClass("disabled",e),this.lblLineTransparencyEnd.toggleClass("disabled",e))},onPositionChange:function(t){var e,t=t.getNumberValue(),i=(Common.UI.isRTL()&&(t=this.sldrGradient.maxValue-t),this.GradColor.currentIdx-1<0?0:this.GradColor.values[this.GradColor.currentIdx-1]),n=this.GradColor.currentIdx+1<this.GradColor.values.length?this.GradColor.values[this.GradColor.currentIdx+1]:100,i=t<i||n<t;this.api&&(this.GradColor.values[this.GradColor.currentIdx]=t,n=new Asc.asc_TextArtProperties,(t=new Asc.asc_CShapeFill).asc_putType(Asc.c_oAscFill.FILL_TYPE_GRAD),t.asc_putFill(new Asc.asc_CFillGrad),t.asc_getFill().asc_putGradType(this.GradFillType),e=[],this.GradColor.values.forEach(function(t){e.push(1e3*t)}),t.asc_getFill().asc_putPositions(e),n.asc_putFill(t),this.shapeprops.put_TextArtProperties(n),this.api.ImgApply(this.imgprops),i&&(this.sldrGradient.sortThumbs(),this.sldrGradient.trigger("change",this.sldrGradient),this.sldrGradient.trigger("changecomplete",this.sldrGradient)))},onAddGradientStep:function(){var t,e;9<this.GradColor.colors.length||(t=this.GradColor.currentIdx,e=(this.GradColor.values[t]+this.GradColor.values[t<this.GradColor.colors.length-1?t+1:t-1])/2,this.GradColor.colors[this.GradColor.colors.length]=this.GradColor.colors[t],this.GradColor.currentIdx=this.GradColor.colors.length-1,e=this.sldrGradient.addNewThumb(void 0,e,t),this.GradColor.colors[this.GradColor.currentIdx]=e,this.sldrGradient.trigger("change",this.sldrGradient),this.sldrGradient.trigger("changecomplete",this.sldrGradient))},onRemoveGradientStep:function(){var t;this.GradColor.values.length<3||(t=this.GradColor.currentIdx,this.GradColor.values.splice(this.GradColor.currentIdx,1),this.sldrGradient.removeThumb(this.GradColor.currentIdx),(f.isUndefined(this.GradColor.currentIdx)||this.GradColor.currentIdx>=this.GradColor.colors.length)&&(t=0===(t=0<t?t-1:t)&&2<this.GradColor.values.length?this.GradColor.values.length-2:t,this.GradColor.currentIdx=t),this.sldrGradient.setActiveThumb(this.GradColor.currentIdx),this.sldrGradient.trigger("change",this.sldrGradient),this.sldrGradient.trigger("changecomplete",this.sldrGradient))},onGradientAngleChange:function(t,e,i,n){var o,s;this.api&&!this._noApply&&(o=new Asc.asc_TextArtProperties,(s=new Asc.asc_CShapeFill).put_type(Asc.c_oAscFill.FILL_TYPE_GRAD),s.put_fill(new Asc.asc_CFillGrad),s.get_fill().put_grad_type(this.GradFillType),s.get_fill().put_linear_angle(6e4*t.getNumberValue()),s.get_fill().put_linear_scale(!0),o.asc_putFill(s),this.shapeprops.put_TextArtProperties(o),this.api.ImgApply(this.imgprops))},onWindowResize:function(){this._initSettings||this._state.applicationPixelRatio===Common.Utils.applicationPixelRatio()||this.fillTransform(this.api.asc_getPropertyEditorTextArts()),this._state.applicationPixelRatio=Common.Utils.applicationPixelRatio()},hideTransformSettings:function(t){this._state.HideTransformSettings!==t&&(this._state.HideTransformSettings=t,this.TransformSettings.toggleClass("hidden",!0===t))},onEyedropperStart:function(t){this.api.asc_startEyedropper(f.bind(t.eyedropperEnd,t)),this.fireEvent("eyedropper",!0)},onEyedropperEnd:function(){this.fireEvent("eyedropper",!1)}},DE.Views.TextArtSettings||{}))}),define("text!documenteditor/main/app/template/SignatureSettings.template",[],function(){return'<table cols="2">\n    <tr>\n        <td class="padding-large">\n            <label style="font-size: 18px;"><%= scope.strSignature %></label>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-large">\n            <div id="signature-invisible-sign" style="width:100%;"></div>\n        </td>\n    </tr>\n    <tr class="requested">\n        <td class="padding-small">\n            <label class="header"><%= scope.strRequested %></label>\n        </td>\n    </tr>\n    <tr class="requested">\n        <td class="padding-large">\n            <div id="signature-requested-sign"></div>\n        </td>\n    </tr>\n    <tr class="valid">\n        <td class="padding-small">\n            <label class="header"><%= scope.strValid %></label>\n        </td>\n    </tr>\n    <tr class="valid">\n        <td class="padding-large">\n            <div id="signature-valid-sign"></div>\n        </td>\n    </tr>\n    <tr class="invalid">\n        <td class="padding-small">\n            <label class="header" style="color:#bb3d3d;"><%= scope.strInvalid %></label>\n        </td>\n    </tr>\n    <tr class="invalid">\n        <td><div id="signature-invalid-sign"></div></td>\n    </tr>\n    <tr class="finish-cell"></tr>\n</table>'}),define("documenteditor/main/app/view/SignatureSettings",["text!documenteditor/main/app/template/SignatureSettings.template","jquery","underscore","backbone","common/main/lib/component/Button"],function(t,r,c,e){"use strict";DE.Views.SignatureSettings=e.View.extend(c.extend({el:"#id-signature-settings",template:c.template(t),events:{},options:{alias:"SignatureSettings"},initialize:function(){this._state={DisabledEditing:!1,ready:!1,hasValid:!1,hasInvalid:!1,hasRequested:!1,tip:void 0},this._locked=!1,this._protected=!1,this.render()},render:function(){this.$el.html(this.template({scope:this}));var t=DE.getController("Common.Controllers.Protection").getView();this.btnAddInvisibleSign=t.getButton("signature"),this.btnAddInvisibleSign.render(this.$el.find("#signature-invisible-sign")),this.viewRequestedList=new Common.UI.DataView({el:r("#signature-requested-sign"),enableKeyEvents:!1,itemTemplate:c.template(['<div id="<%= id %>" class="signature-item requested">','<div class="caret img-commonctrl nomargin"></div>','<div class="name"><%= Common.Utils.String.htmlEncode(name) %></div>',"</div>"].join(""))}),this.viewValidList=new Common.UI.DataView({el:r("#signature-valid-sign"),enableKeyEvents:!1,itemTemplate:c.template(['<div id="<%= id %>" class="signature-item">','<div class="caret img-commonctrl img-colored <% if (name == "" || date == "") { %>nomargin<% } %>"></div>','<div class="name"><%= Common.Utils.String.htmlEncode(name) %></div>','<div class="date"><%= Common.Utils.String.htmlEncode(date) %></div>',"</div>"].join(""))}),this.viewInvalidList=new Common.UI.DataView({el:r("#signature-invalid-sign"),enableKeyEvents:!1,itemTemplate:c.template(['<div id="<%= id %>" class="signature-item">','<div class="caret img-commonctrl <% if (name == "" || date == "") { %>nomargin<% } %>"></div>','<div class="name"><%= Common.Utils.String.htmlEncode(name) %></div>','<div class="date"><%= Common.Utils.String.htmlEncode(date) %></div>',"</div>"].join(""))}),this.viewRequestedList.on("item:click",c.bind(this.onSelectSignature,this)),this.viewValidList.on("item:click",c.bind(this.onSelectSignature,this)),this.viewInvalidList.on("item:click",c.bind(this.onSelectSignature,this)),this.viewRequestedList.on("item:contextmenu",c.bind(this.onItemContextMenu,this)),this.viewValidList.on("item:contextmenu",c.bind(this.onItemContextMenu,this)),this.viewInvalidList.on("item:contextmenu",c.bind(this.onItemContextMenu,this)),this.signatureMenu=new Common.UI.Menu({menuAlign:"tr-br",items:[{caption:this.strSign,value:0},{caption:this.strDetails,value:1},{caption:this.strSetup,value:2},{caption:this.strDelete,value:3}]}),this.signatureMenu.on("item:click",c.bind(this.onMenuSignatureClick,this))},setApi:function(t){return this.api=t,this.api&&this.api.asc_registerCallback("asc_onUpdateSignatures",c.bind(this.onApiUpdateSignatures,this)),Common.NotificationCenter.on("document:ready",c.bind(this.onDocumentReady,this)),this},ChangeSettings:function(t){this._state.hasRequested||this._state.hasValid||this._state.hasInvalid||this.updateSignatures(this.api.asc_getSignatures(),this.api.asc_getRequestSignatures())},setLocked:function(t){this._locked=t},setProtected:function(t){this._protected=t},setMode:function(t){this.mode=t},onApiUpdateSignatures:function(t,e){this._state.ready&&(this.updateSignatures(t,e),this.showSignatureTooltip(this._state.hasValid,this._state.hasInvalid))},updateSignatures:function(t,e){var n=this,o=[],s=[],a=[],l=1;c.each(e,function(t,e){var i=t.asc_getSigner1();o.push({name:""!==i?i:n.strSigner+" "+l++,guid:t.asc_getGuid(),requested:!0})}),c.each(t,function(t,e){var i=t.asc_getDate(),i={name:t.asc_getSigner1(),certificateId:t.asc_getId(),guid:t.asc_getGuid(),date:c.isEmpty(i)?"":new Date(i).toLocaleString(),invisible:!t.asc_getVisible()};(0==t.asc_getValid()?s:a).push(i)}),n._state.hasValid=0<s.length,n._state.hasInvalid=0<a.length,n._state.hasRequested=0<o.length,this.viewRequestedList.store.reset(o),this.viewValidList.store.reset(s),this.viewInvalidList.store.reset(a),this.$el.find(".requested").toggleClass("hidden",!n._state.hasRequested),this.$el.find(".valid").toggleClass("hidden",!n._state.hasValid),this.$el.find(".invalid").toggleClass("hidden",!n._state.hasInvalid),n.disableEditing(n._state.hasValid||n._state.hasInvalid)},onItemContextMenu:function(t,e,i,n){var o=this.signatureMenu,s=(o.isVisible()&&o.hide(),r(this.el).offset()),n=[n.clientX*Common.Utils.zoom()-s.left+5,n.clientY*Common.Utils.zoom()-s.top+5];this.showSignatureMenu(i,n),o.menuAlign=Common.UI.isRTL()?"tr-br":"tl-bl",o.menuAlignEl=null,o.setOffset(15,5),o.show(),c.delay(function(){o.cmpEl.focus()},10)},onSelectSignature:function(t,e,i,n){var o,s,a,l;i&&((s=r(n.target))&&s.hasClass("caret")?(o=this.signatureMenu).isVisible()?o.hide():(l=(s=r(n.currentTarget)).offset(),a=r(this.el).offset(),l=[l.left-a.left+s.width(),l.top-a.top+s.height()/2],this.showSignatureMenu(i,l),o.menuAlign=Common.UI.isRTL()?"tl-bl":"tr-br",o.menuAlignEl=s,o.setOffset(-20,-s.height()/2+3),o.show(),c.delay(function(){o.cmpEl.focus()},10),n.stopPropagation(),n.preventDefault()):this.api.asc_gotoSignature(i.get("guid")))},showSignatureMenu:function(t,e){this.api.asc_gotoSignature(t.get("guid"));var i=this.signatureMenu,n=r(this.el),o=n.find("#menu-signature-container"),n=(i.rendered||(o.length<1&&(o=r('<div id="menu-signature-container" style="position: absolute; z-index: 10000;"><div class="dropdown-toggle" data-toggle="dropdown"></div></div>',i.id),n.append(o)),i.render(o),i.cmpEl.attr({tabindex:"-1"}),i.on({"show:after":function(t){t&&t.menuAlignEl&&t.menuAlignEl.toggleClass("over",!0)},"hide:after":function(t){t&&t.menuAlignEl&&t.menuAlignEl.toggleClass("over",!1)}})),t.get("requested")),s=this._state.hasValid||this._state.hasInvalid;i.items[0].setVisible(n),i.items[1].setVisible(!n),i.items[2].setVisible(n||!t.get("invisible")),i.items[3].setVisible(!n),i.items[0].setDisabled(this._locked),i.items[3].setDisabled(this._locked||this._protected),i.items[1].cmpEl.attr("data-value",t.get("certificateId")),i.items[2].cmpEl.attr("data-value",s?1:0),i.cmpEl.attr("data-value",t.get("guid")),o.css({left:e[0],top:e[1]})},onMenuSignatureClick:function(t,e){var i=t.cmpEl.attr("data-value");switch(e.value){case 0:Common.NotificationCenter.trigger("protect:sign",i);break;case 1:this.api.asc_ViewCertificate(e.cmpEl.attr("data-value"));break;case 2:Common.NotificationCenter.trigger("protect:signature","visible",!!parseInt(e.cmpEl.attr("data-value"))||this._protected,i);break;case 3:var n=this;Common.UI.warning({title:this.notcriticalErrorTitle,msg:this.txtRemoveWarning,buttons:["ok","cancel"],primary:"ok",callback:function(t){"ok"==t&&n.api.asc_RemoveSignature(i)}})}},onDocumentReady:function(){this._state.ready=!0,this.updateSignatures(this.api.asc_getSignatures(),this.api.asc_getRequestSignatures()),this.showSignatureTooltip(this._state.hasValid,this._state.hasInvalid,this._state.hasRequested)},showSignatureTooltip:function(t,e,i){var n,o=this,s=o._state.tip;t||e||i?(n=t||e,e=e?o.txtSignedInvalid:t?o.txtSigned:"",i&&(e=o.txtRequestedSignatures+"<br><br>"+e),s&&s.isVisible()&&(e!==s.text||n!==s.showLink)&&(s.close(),o._state.tip=void 0),o._state.tip||((s=new Common.UI.SynchronizeTip({target:DE.getController("RightMenu").getView("RightMenu").btnSignature.btnEl,text:e,showLink:n,textLink:this.txtContinueEditing,placement:"left-bottom"})).on({dontshowclick:function(){Common.UI.warning({title:o.notcriticalErrorTitle,msg:o.txtEditWarning,buttons:["ok","cancel"],primary:"ok",callback:function(t){"ok"==t&&(s.close(),o._state.tip=void 0,o.api.asc_RemoveAllSignatures())}})},closeclick:function(){s.close(),o._state.tip=void 0}}),(o._state.tip=s).show())):s&&s.isVisible()&&(s.close(),o._state.tip=void 0)},hideSignatureTooltip:function(){var t=this._state.tip;t&&t.isVisible()&&(t.close(),this._state.tip=void 0)},disableEditing:function(t){this._state.DisabledEditing!=t&&(this._state.DisabledEditing=t,Common.NotificationCenter.trigger("editing:disable",t,{viewMode:t,reviewMode:!1,fillFormMode:!1,allowMerge:!1,allowSignature:!0,allowProtect:!0,rightMenu:{clear:!1,disable:!0},statusBar:!0,leftMenu:{disable:!1,previewMode:!0},fileMenu:!1,navigation:{disable:!1,previewMode:!0},comments:{disable:!1,previewMode:!0},chat:!1,review:!0,viewport:!1,documentHolder:{clear:!0,disable:!0},toolbar:!0,plugins:!1,protect:!1},"signature"))}},DE.Views.SignatureSettings||{}))}),define("text!documenteditor/main/app/template/FormSettings.template",[],function(){return'<table cols="1">\n    <tr>\n        <td>\n            <label class="header padding-small" id="form-settings-name"><%= scope.textField %></label>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <label class="input-label"><%= scope.textFillRoles %></label>\n            <div id="form-combo-roles" style="width: 100%;"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr class="form-keyfield">\n        <td class="padding-small">\n            <label class="input-label"><%= scope.textKey %></label>\n            <div id="form-combo-key" style="width: 100%;"></div>\n        </td>\n    </tr>\n    <tr class="form-connected">\n        <td class="padding-small">\n            <label style="opacity: 0.5;" class="margin-right-5" id="form-settings-connected"><%= scope.textConnected %></label>\n            <label class="link-solid" id="form-settings-disconnect"><%= scope.textDisconnect %></label>\n        </td>\n    </tr>\n    <tr class="form-radiobox">\n        <td class="padding-small">\n            <label class="input-label"><%= scope.textGroupKey %></label>\n            <div id="form-combo-group-key" style="width: 100%;"></div>\n        </td>\n    </tr>\n    <tr class="form-placeholder">\n        <td class="padding-small">\n            <label class="input-label"><%= scope.textPlaceholder %></label>\n            <div id="form-txt-pholder"></div>\n        </td>\n    </tr>\n    <tr class="form-not-in-complex">\n        <td class="padding-small">\n            <label class="input-label"><%= scope.textTag %></label>\n            <div id="form-txt-tag"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <label class="input-label"><%= scope.textTip %></label>\n            <div id="form-txt-help"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <label class="input-label"><%= scope.textDefValue %></label>\n            <div id="form-combo-def-value" style="width: 100%;"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <label class="input-label"><%= scope.textDefValue %></label>\n            <div id="form-txt-def-value"></div>\n        </td>\n    </tr>\n    <tr class="form-datetime">\n        <td class="padding-small">\n            <label class="input-label"><%= scope.textDefValue %></label>\n            <div id="form-date-def-value"></div>\n        </td>\n    </tr>\n    <tr class="form-textfield">\n        <td class="padding-small">\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr class="form-textfield">\n        <td class="padding-small">\n            <label class="input-label"><%= scope.textFormat %></label>\n            <div id="form-combo-format" style="width: 100%;"></div>\n        </td>\n    </tr>\n    <tr class="form-textfield-mask">\n        <td class="padding-small">\n            <div id="form-txt-mask" style="width: 100%;"></div>\n        </td>\n    </tr>\n    <tr class="form-textfield-regexp">\n        <td class="padding-small">\n            <div id="form-txt-regexp"></div>\n        </td>\n    </tr>\n    <tr class="form-textfield">\n        <td class="padding-small">\n            <label class="input-label"><%= scope.textFormatSymbols %></label>\n            <div id="form-txt-format-symbols"></div>\n        </td>\n    </tr>\n</table>\n<table cols="2">\n    <tr class="form-list">\n        <td colspan="2" class="padding-small">\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr class="form-list">\n        <td colspan="2" class="padding-small">\n            <label class="input-label"><%= scope.textValue %></label>\n        </td>\n    </tr>\n    <tr class="form-list" style="vertical-align: top;">\n        <td class="padding-small">\n            <div id="form-txt-new-value" style="width:164px;" class="margin-right-5"></div>\n        </td>\n        <td class="padding-small">\n            <div id="form-list-add" class="margin-left-5"></div>\n        </td>\n    </tr>\n    <tr class="form-list" style="vertical-align: top;">\n        <td class="padding-large">\n            <div id="form-list-list" style="width:164px; height: 95px;" class="margin-right-5"></div>\n        </td>\n        <td class="padding-large">\n            <div id="form-list-delete" style="margin-bottom: 5px;" class="margin-left-5"></div>\n            <div id="form-list-up" style="margin-bottom: 5px;" class="margin-left-5"></div>\n            <div id="form-list-down" class="margin-left-5"></div>\n        </td>\n    </tr>\n</table>\n<table cols="1">\n    <tr class="form-datetime">\n        <td class="padding-small">\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr class="form-datetime">\n        <td class="padding-small">\n            <label class="input-label"><%= scope.textDateFormat %></label>\n            <div id="form-cmb-date-format" style="width: 100%;"></div>\n        </td>\n    </tr>\n    <tr class="form-datetime">\n        <td class="padding-small">\n            <label class="input-label"><%= scope.textLang %></label>\n            <div id="form-cmb-date-lang" style="width: 100%;"></div>\n        </td>\n    </tr>\n</table>\n<table cols="1">\n    <tr class="form-checkbox">\n        <td class="padding-small">\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr class="form-checkbox">\n        <td class="padding-small">\n            <div id="form-chb-def-value"></div>\n        </td>\n    </tr>\n    <tr class="form-fixed">\n        <td class="padding-small">\n            <div id="form-chb-fixed"></div>\n        </td>\n    </tr>\n    <tr class="form-textfield-simple">\n        <td class="padding-small">\n            <div id="form-chb-autofit"></div>\n        </td>\n    </tr>\n    <tr class="form-textfield-simple">\n        <td class="padding-small">\n            <div id="form-chb-multiline"></div>\n        </td>\n    </tr>\n    <tr class="form-textfield-simple">\n        <td class="padding-small">\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr class="form-textfield">\n        <td class="padding-small">\n            <div id="form-chb-max-chars" style="display: inline-block;margin-top: 4px;"></div>\n            <div id="form-spin-max-chars" style="display: inline-block;" class="float-right"></div>\n        </td>\n    </tr>\n    <tr class="form-textfield">\n        <td class="padding-small">\n            <div id="form-chb-comb"></div>\n        </td>\n    </tr>\n</table>\n<table cols="2">\n    <tr class="form-textfield">\n        <td colspan=2 class="padding-left-22">\n            <label class="input-label"><%= scope.textWidth %></label>\n        </td>\n    </tr>\n    <tr class="form-textfield">\n        <td class="padding-small padding-left-22">\n            <div id="form-combo-width-rule" style="width: 82px;"></div>\n        </td>\n        <td class="padding-small">\n            <div id="form-spin-width" class="float-right"></div>\n        </td>\n    </tr>\n</table>\n<table cols="1">\n    <tr class="form-image">\n        <td class="padding-small">\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr class="form-image">\n        <td class="padding-small">\n            <label class="input-label"><%= scope.textScale %></label>\n            <div id="form-combo-scale" style="width: 100%;"></div>\n        </td>\n    </tr>\n    <tr class="form-image">\n        <td class="padding-large">\n            <div id="form-chb-aspect"></div>\n        </td>\n    </tr>\n    <tr class="form-image">\n        <td class="padding-large">\n            <div id="form-cnt-position" style="width: 100%;">\n                <div class="row">\n                    <div id="form-img-position-preview">\n                        <div id="form-img-example"><%= scope.textImage %></div>\n                    </div>\n                    <div id="form-img-slider-position-y"></div>\n                </div>\n                <div class="row">\n                    <div id="form-img-slider-position-x"></div>\n                    <label id="form-img-slider-value"></label>\n                </div>\n            </div>\n        </td>\n    </tr>\n    <tr class="form-image">\n        <td class="padding-large">\n            <div id="form-button-replace" style="width:100%;"></div>\n        </td>\n    </tr>\n</table>\n<table cols="1">\n    <tr>\n        <td class="padding-small">\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <label class="input-label" style="margin-top: 4px;"><%= scope.textColor %></label>\n            <div id="form-color-btn" style="display: inline-block;" class="float-right"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <label class="input-label" style="margin-top: 4px;"><%= scope.textBackgroundColor %></label>\n            <div id="form-background-color-btn" style="display: inline-block;" class="float-right"></div>\n        </td>\n    </tr>\n</table>\n<table cols="1">\n    <tr>\n        <td class="padding-small">\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr class="form-not-in-complex">\n        <td class="padding-small">\n            <div id="form-chb-required"></div>\n        </td>\n    </tr>\n    <tr class="form-not-in-complex">\n        <td class="padding-small">\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <div id="form-btn-delete"></div>\n        </td>\n    </tr>\n    <tr class="form-not-in-complex">\n        <td class="padding-small">\n            <div id="form-btn-lock"></div>\n        </td>\n    </tr>\n    <tr class="finish-cell"></tr>\n</table>'}),void 0===Common&&(Common={}),define("common/main/lib/component/TextareaField",["common/main/lib/component/BaseView","common/main/lib/component/Tooltip"],function(){"use strict";Common.UI.TextareaField=Common.UI.BaseView.extend({options:{id:null,cls:"",style:"",value:"",maxlength:void 0,placeHolder:"",spellcheck:!1,disabled:!1,resize:!1},template:_.template(['<div class="textarea-field" style="<%= style %>">',"<textarea ",'spellcheck="<%= spellcheck %>" ','class="form-control <%= cls %>" ','placeholder="<%= placeHolder %>" ',"<% if (dataHint) {%>",'data-hint="<%= dataHint %>" ',"<% } %>","<% if (dataHintDirection) {%>",'data-hint-direction="<%= dataHintDirection %>" ',"<% } %>","<% if (dataHintOffset) {%>",'data-hint-offset="<%= dataHintOffset %>" ',"<% } %>","></textarea>","</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);t=this;this.id=t.options.id||Common.UI.getId(),this.cls=t.options.cls,this.style=t.options.style,this.value=t.options.value,this.placeHolder=t.options.placeHolder,this.template=t.options.template||t.template,this.disabled=t.options.disabled,this.spellcheck=t.options.spellcheck,this.maxLength=t.options.maxLength,t.rendered=t.options.rendered||!1,t.options.el&&t.render()},render:function(t){return this.rendered?this.cmpEl=this.$el:(this.cmpEl=$(this.template({id:this.id,cls:this.cls,style:this.style,placeHolder:this.placeHolder,spellcheck:this.spellcheck,dataHint:this.options.dataHint,dataHintDirection:this.options.dataHintDirection,dataHintOffset:this.options.dataHintOffset,scope:this})),(t?(this.setElement(t,!1),t):this.$el).html(this.cmpEl)),this.rendered||(this.cmpEl,this._input=this.cmpEl.find("textarea").addBack().filter("textarea"),this._input.on("blur",_.bind(this.onInputChanged,this)),this._input.on("keydown",_.bind(this.onKeyDown,this)),this.maxLength&&this._input.attr("maxlength",this.maxLength),this.resize||this._input.css("resize","none"),this.disabled&&this.setDisabled(this.disabled)),this.rendered=!0,this.value&&this.setValue(this.value),this},_doChange:function(t,e){var i;e&&e.synthetic||(e=$(t.target).val(),i=this.value,this.trigger("changed:before",this,e,i,t),t.isDefaultPrevented()||(this.value=e,this.trigger("changed:after",this,e,i,t)))},onInputChanged:function(t,e){this._doChange(t,e)},onKeyDown:function(t){this.trigger("keydown:before",this,t),t.isDefaultPrevented()||(t.keyCode===Common.UI.Keys.RETURN&&t.stopPropagation(),t.keyCode==Common.UI.Keys.ESC&&this.setValue(this.value),t.keyCode==Common.UI.Keys.ESC&&this.trigger("inputleave",this))},setDisabled:function(t){this.disabled=t=!!t,$(this.el).toggleClass("disabled",t),t?this._input.attr("disabled",!0):this._input.removeAttr("disabled")},isDisabled:function(){return this.disabled},setValue:function(t){this.value=t,this.rendered&&this._input.val(t)},getValue:function(){return this.value},focus:function(){this._input.focus()}})}),define("documenteditor/main/app/view/FormSettings",["text!documenteditor/main/app/template/FormSettings.template","jquery","underscore","backbone","common/main/lib/component/ComboBox","common/main/lib/component/MetricSpinner","common/main/lib/component/TextareaField","common/main/lib/component/CheckBox","common/main/lib/view/ImageFromUrlDialog"],function(t,o,p,e){"use strict";DE.Views.FormSettings=e.View.extend(p.extend({el:"#id-form-settings",template:p.template(t),events:{},options:{alias:"FormSettings"},initialize:function(){this._initSettings=!0,this._state={DisabledControls:void 0,LockDelete:void 0},this.spinners=[],this.lockedControls=[],this.internalId=null,this._locked=!0,this._originalTextFormProps=null,this._originalFormProps=null,this._originalProps=null,this._arrWidthRule=[{displayValue:this.textAuto,value:Asc.CombFormWidthRule.Auto},{displayValue:this.textAtLeast,value:Asc.CombFormWidthRule.AtLeast},{displayValue:this.textExact,value:Asc.CombFormWidthRule.Exact}],this.render()},render:function(){var t=this.$el||o(this.el);t.html(this.template({scope:this})),this.TextOnlySettings=t.find(".form-textfield"),this.TextOnlySimpleSettings=t.find(".form-textfield-simple"),this.TextOnlySettingsMask=t.find(".form-textfield-mask"),this.TextOnlySettingsRegExp=t.find(".form-textfield-regexp"),this.PlaceholderSettings=t.find(".form-placeholder"),this.KeySettings=t.find(".form-keyfield"),this.KeySettingsTd=this.KeySettings.find("td"),this.CheckOnlySettings=t.find(".form-checkbox"),this.RadioOnlySettings=t.find(".form-radiobox"),this.ListOnlySettings=t.find(".form-list"),this.ImageOnlySettings=t.find(".form-image"),this.ConnectedSettings=t.find(".form-connected"),this.FixedSettings=t.find(".form-fixed"),this.NotInComplexSettings=t.find(".form-not-in-complex"),this.DateOnlySettings=t.find(".form-datetime"),this.DefValueText=t.find("#form-txt-def-value").closest("tr"),this.DefValueDropDown=t.find("#form-combo-def-value").closest("tr")},createDelayedElements:function(){this._initSettings=!1;var t=this.$el||o(this.el),i=this,e=(this.labelFormName=t.findById("#form-settings-name"),this.labelConnectedFields=t.findById("#form-settings-connected"),t.findById("#form-settings-disconnect").on("click",p.bind(this.onDisconnect,this)),this.cmbKey=new Common.UI.ComboBox({el:t.findById("#form-combo-key"),cls:"input-group-nr",menuCls:"menu-absolute",menuStyle:"min-width: 195px; max-height: 190px;",editable:!0,data:[],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbKey.setValue(""),this.lockedControls.push(this.cmbKey),this.cmbKey.on("selected",this.onKeyChanged.bind(this)),this.cmbKey.on("changed:after",this.onKeyChanged.bind(this)),this.cmbKey.on("hide:after",this.onHideMenus.bind(this)),this.txtPlaceholder=new Common.UI.InputField({el:t.findById("#form-txt-pholder"),allowBlank:!0,validateOnChange:!1,validateOnBlur:!1,style:"width: 100%;",value:"",dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.lockedControls.push(this.txtPlaceholder),this.txtPlaceholder.on("changed:after",this.onPlaceholderChanged.bind(this)),this.txtPlaceholder.on("inputleave",function(){i.fireEvent("editcomplete",i)}),this.txtPlaceholder.cmpEl.on("focus","input.form-control",function(){setTimeout(function(){i.txtPlaceholder._input&&i.txtPlaceholder._input.select()},1)}),this.txtTag=new Common.UI.InputField({el:t.findById("#form-txt-tag"),allowBlank:!0,validateOnChange:!1,validateOnBlur:!1,style:"width: 100%;",value:"",dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.lockedControls.push(this.txtTag),this.txtTag.on("changed:after",this.onTagChanged.bind(this)),this.txtTag.on("inputleave",function(){i.fireEvent("editcomplete",i)}),this.txtTag.cmpEl.on("focus","input.form-control",function(){setTimeout(function(){i.txtTag._input&&i.txtTag._input.select()},1)}),this.textareaHelp=new Common.UI.TextareaField({el:t.findById("#form-txt-help"),style:"width: 100%; height: 36px;",value:"",dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.lockedControls.push(this.textareaHelp),this.textareaHelp.on("changed:after",this.onHelpChanged.bind(this)),this.textareaHelp.on("inputleave",function(){i.fireEvent("editcomplete",i)}),this.txtDefValue=new Common.UI.InputField({el:t.findById("#form-txt-def-value"),allowBlank:!0,validateOnChange:!1,validateOnBlur:!1,style:"width: 100%;",value:"",dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.lockedControls.push(this.txtDefValue),this.txtDefValue.on("changed:after",this.onTxtDefChanged.bind(this)),this.txtDefValue.on("inputleave",function(){i.fireEvent("editcomplete",i)}),this.txtDefValue.cmpEl.on("focus","input.form-control",function(){setTimeout(function(){i.txtDefValue._input&&i.txtDefValue._input.select()},1)}),this.txtDateDefValue=new Common.UI.InputFieldBtnCalendar({el:t.findById("#form-date-def-value"),allowBlank:!0,validateOnChange:!1,validateOnBlur:!1,style:"width: 100%;",value:"",dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.lockedControls.push(this.txtDateDefValue),this.txtDateDefValue.on("changed:after",this.onTxtDefChanged.bind(this)),this.txtDateDefValue.on("inputleave",function(){i.fireEvent("editcomplete",i)}),this.txtDateDefValue.on("date:click",this.onDateDefClick.bind(this)),this.txtDateDefValue.cmpEl.on("focus","input.form-control",function(){setTimeout(function(){i.txtDateDefValue._input&&i.txtDateDefValue._input.select()},1)}),this.cmbDefValue=new Common.UI.ComboBox({el:t.findById("#form-combo-def-value"),cls:"input-group-nr",menuCls:"menu-absolute",menuStyle:"min-width: 195px; max-height: 190px;",editable:!1,data:[],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbDefValue.setValue(""),this.lockedControls.push(this.cmbDefValue),this.cmbDefValue.on("selected",this.onComboDefChanged.bind(this)),this.chDefValue=new Common.UI.CheckBox({el:t.findById("#form-chb-def-value"),labelText:this.textCheckDefault,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.chDefValue.on("change",this.onChDefValue.bind(this)),this.lockedControls.push(this.chDefValue),this.chMaxChars=new Common.UI.CheckBox({el:t.findById("#form-chb-max-chars"),labelText:this.textMaxChars,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.chMaxChars.on("change",this.onChMaxCharsChanged.bind(this)),this.lockedControls.push(this.chMaxChars),this.spnMaxChars=new Common.UI.MetricSpinner({el:t.findById("#form-spin-max-chars"),step:1,width:45,defaultUnit:"",value:"10",maxValue:1e6,minValue:1,allowDecimal:!1,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.spnMaxChars.on("change",this.onMaxCharsChange.bind(this)),this.spnMaxChars.on("inputleave",function(){i.fireEvent("editcomplete",i)}),this.chComb=new Common.UI.CheckBox({el:t.findById("#form-chb-comb"),labelText:this.textComb,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.chComb.on("change",this.onChCombChanged.bind(this)),this.lockedControls.push(this.chComb),this.cmbWidthRule=new Common.UI.ComboBox({el:t.findById("#form-combo-width-rule"),cls:"input-group-nr",menuStyle:"min-width: 82px;",editable:!1,data:this._arrWidthRule,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbWidthRule.setValue(""),this.cmbWidthRule.on("selected",this.onWidthRuleSelect.bind(this)),this.spnWidth=new Common.UI.MetricSpinner({el:t.findById("#form-spin-width"),step:.1,width:82,defaultUnit:"cm",value:"",allowAuto:!1,maxValue:55.88,minValue:.1,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.spinners.push(this.spnWidth),this.spnWidth.on("change",this.onWidthChange.bind(this)),this.spnWidth.on("inputleave",function(){i.fireEvent("editcomplete",i)}),this.chAutofit=new Common.UI.CheckBox({el:t.findById("#form-chb-autofit"),labelText:this.textAutofit,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.chAutofit.on("change",this.onChAutofit.bind(this)),this.chMulti=new Common.UI.CheckBox({el:t.findById("#form-chb-multiline"),labelText:this.textMulti,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.chMulti.on("change",this.onChMulti.bind(this)),this.chRequired=new Common.UI.CheckBox({el:t.findById("#form-chb-required"),labelText:this.textRequired,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.chRequired.on("change",this.onChRequired.bind(this)),this.lockedControls.push(this.chRequired),this.chFixed=new Common.UI.CheckBox({el:t.findById("#form-chb-fixed"),labelText:this.textFixed,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.chFixed.on("change",this.onChFixed.bind(this)),this.lockedControls.push(this.chFixed),this.cmbGroupKey=new Common.UI.ComboBox({el:t.findById("#form-combo-group-key"),cls:"input-group-nr",menuCls:"menu-absolute",menuStyle:"min-width: 195px; max-height: 190px;",editable:!0,data:[],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbGroupKey.setValue(""),this.lockedControls.push(this.cmbGroupKey),this.cmbGroupKey.on("selected",this.onGroupKeyChanged.bind(this)),this.cmbGroupKey.on("changed:after",this.onGroupKeyChanged.bind(this)),this.cmbGroupKey.on("hide:after",this.onHideMenus.bind(this)),this.txtNewValue=new Common.UI.InputField({el:t.findById("#form-txt-new-value"),allowBlank:!0,validateOnChange:!0,validateOnBlur:!1,style:"width: 100%;",value:"",dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}).on("changing",function(t,e){i.btnListAdd.setDisabled(e.length<1||i._state.DisabledControls)}),this.lockedControls.push(this.txtNewValue),this.txtNewValue.on("inputleave",function(){i.fireEvent("editcomplete",i)}),this.txtNewValue._input.on("keydown",p.bind(this.onNewValueKeydown,this)),this.txtNewValue.cmpEl.on("focus","input.form-control",function(){setTimeout(function(){i.txtNewValue._input&&i.txtNewValue._input.select()},1)}),this.list=new Common.UI.ListView({el:t.findById("#form-list-list"),store:new Common.UI.DataViewStore,emptyText:"",template:p.template(['<div class="listview inner" style=""></div>'].join("")),itemTemplate:p.template(['<div id="<%= id %>" class="list-item" style="width: 100%;display:inline-block;">','<div style="width:145px;display: inline-block;vertical-align: middle; overflow: hidden; text-overflow: ellipsis;white-space: pre;"><%= Common.Utils.String.htmlEncode(name) %></div>',"</div>"].join(""))}),this.list.on("item:select",p.bind(this.onSelectItem,this)),this.lockedControls.push(this.list),this.btnListAdd=new Common.UI.Button({parentEl:t.findById("#form-list-add"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-zoomup",hint:this.textTipAdd,dataHint:"1",dataHintDirection:"left",dataHintOffset:"big"}),this.btnListAdd.on("click",p.bind(this.onAddItem,this)),this.btnListDelete=new Common.UI.Button({parentEl:t.findById("#form-list-delete"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-cc-remove",hint:this.textTipDelete,dataHint:"1",dataHintDirection:"left",dataHintOffset:"big"}),this.btnListDelete.on("click",p.bind(this.onDeleteItem,this)),this.lockedControls.push(this.btnListDelete),this.btnListUp=new Common.UI.Button({parentEl:t.findById("#form-list-up"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-arrow-up",hint:this.textTipUp,dataHint:"1",dataHintDirection:"left",dataHintOffset:"big"}),this.btnListUp.on("click",p.bind(this.onMoveItem,this,!0)),this.lockedControls.push(this.btnListUp),this.btnListDown=new Common.UI.Button({parentEl:t.findById("#form-list-down"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-arrow-down",hint:this.textTipDown,dataHint:"1",dataHintDirection:"left",dataHintOffset:"big"}),this.btnListDown.on("click",p.bind(this.onMoveItem,this,!1)),this.lockedControls.push(this.btnListDown),this.btnSelectImage=new Common.UI.Button({parentEl:o("#form-button-replace"),cls:"btn-text-menu-default",caption:this.textSelectImage,style:"width:100%;",menu:new Common.UI.Menu({style:"min-width: 194px;",maxHeight:200,items:[{caption:this.textFromFile,value:0},{caption:this.textFromUrl,value:1},{caption:this.textFromStorage,value:2}]}),dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.lockedControls.push(this.btnSelectImage),this.btnSelectImage.menu.on("item:click",p.bind(this.onImageSelect,this)),this.btnSelectImage.menu.items[2].setVisible(this.mode.canRequestInsertImage||this.mode.fileChoiceUrl&&-1<this.mode.fileChoiceUrl.indexOf("{documentType}")),this.btnRemForm=new Common.UI.Button({parentEl:t.findById("#form-btn-delete"),cls:"btn-toolbar align-left",iconCls:"toolbar__icon btn-cc-remove",caption:this.textDelete,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.btnRemForm.on("click",p.bind(function(t){this.api.asc_RemoveContentControl(this._state.id)},this)),this.lockedControls.push(this.btnRemForm),this.btnLockForm=new Common.UI.Button({parentEl:t.findById("#form-btn-lock"),cls:"btn-toolbar align-left",iconCls:"toolbar__icon btn-lock",caption:this.textLock,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.btnLockForm.on("click",p.bind(function(t){var e;this.api&&!this._noApply&&((e=this._originalProps||new AscCommon.CContentControlPr).put_Lock(this._state.LockDelete?Asc.c_oAscSdtLockType.Unlocked:Asc.c_oAscSdtLockType.SdtLocked),this.api.asc_SetContentControlProperties(e,this.internalId))},this)),this.chAspect=new Common.UI.CheckBox({el:t.findById("#form-chb-aspect"),labelText:this.textAspect,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.chAspect.on("change",this.onChAspect.bind(this)),this.cmbScale=new Common.UI.ComboBox({el:t.findById("#form-combo-scale"),cls:"input-group-nr",menuStyle:"min-width: 100%;",editable:!1,data:[{displayValue:this.textAlways,value:Asc.c_oAscPictureFormScaleFlag.Always},{displayValue:this.textNever,value:Asc.c_oAscPictureFormScaleFlag.Never},{displayValue:this.textTooBig,value:Asc.c_oAscPictureFormScaleFlag.Bigger},{displayValue:this.textTooSmall,value:Asc.c_oAscPictureFormScaleFlag.Smaller}],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbScale.setValue(Asc.c_oAscPictureFormScaleFlag.Always),this.lockedControls.push(this.cmbScale),this.cmbScale.on("selected",this.onScaleChanged.bind(this)),this.cmbScale.on("changed:after",this.onScaleChanged.bind(this)),this.cmbScale.on("hide:after",this.onHideMenus.bind(this)),this.imagePositionPreview=t.findById("#form-img-example"),this.imagePositionLabel=t.findById("#form-img-slider-value"),this.sldrPreviewPositionX=new Common.UI.SingleSlider({el:o("#form-img-slider-position-x"),width:116,minValue:0,maxValue:100,value:50}),this.sldrPreviewPositionX.on("change",p.bind(this.onImagePositionChange,this,"x")),this.sldrPreviewPositionX.on("changecomplete",p.bind(this.onImagePositionChangeComplete,this,"x")),this.sldrPreviewPositionY=new Common.UI.SingleSlider({el:o("#form-img-slider-position-y"),width:116,minValue:0,maxValue:100,value:50,direction:"vertical"}),this.sldrPreviewPositionY.on("change",p.bind(this.onImagePositionChange,this,"y")),this.sldrPreviewPositionY.on("changecomplete",p.bind(this.onImagePositionChangeComplete,this,"y")),this.sldrPreviewPositionX.getValue()),n=this.sldrPreviewPositionY.getValue(),e=(this.imagePositionLabel.text(e+","+n),["<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%= Common.Utils.String.htmlEncode(item.value) %>"><a tabindex="-1" type="menuitem" style="'+(Common.UI.isRTL()?"padding-right: 10px;":"padding-left: 10px;")+'overflow: hidden; text-overflow: ellipsis;">','<span class="color" style="background: <%= item.color %>;"></span>',"<%= Common.Utils.String.htmlEncode(item.displayValue) %>","</a></li>","<% }); %>"]),n=['<div class="input-group combobox input-group-nr <%= cls %>" id="<%= id %>" style="<%= style %>">','<div class="form-control" style="display: block; padding-top:3px; line-height: 14px; cursor: pointer; overflow: hidden;text-overflow: ellipsis;white-space: nowrap;<%= style %>"></div>','<div style="display: table-cell;"></div>','<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown"><span class="caret"></span></button>','<ul class="dropdown-menu <%= menuCls %>" style="<%= menuStyle %>" role="menu">'].concat(e).concat(["</ul>","</div>"]),n=(this.cmbRoles=new Common.UI.ComboBoxCustom({el:t.findById("#form-combo-roles"),cls:"menu-roles",menuCls:"menu-absolute",menuStyle:"min-width: 194px; max-height: 190px;max-width: 400px;",style:"width: 194px;",editable:!1,template:p.template(n.join("")),itemsTemplate:p.template(e.join("")),data:[],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big",updateFormControl:function(t){var e=o(this.el).find(".form-control");e[0].innerHTML=t?'<span class="color" style="background:'+t.get("color")+';"></span>'+Common.Utils.String.htmlEncode(t.get("displayValue")):""}}),this.onRefreshRolesList(this.roles),this.lockedControls.push(this.cmbRoles),this.cmbRoles.on("selected",this.onRolesChanged.bind(this)),this.cmbFormat=new Common.UI.ComboBox({el:t.findById("#form-combo-format"),cls:"input-group-nr",menuStyle:"min-width: 100%;",editable:!1,data:[{displayValue:this.textNone,value:Asc.TextFormFormatType.None},{displayValue:this.textDigits,value:Asc.TextFormFormatType.Digit},{displayValue:this.textLetters,value:Asc.TextFormFormatType.Letter},{displayValue:this.textMask,value:Asc.TextFormFormatType.Mask},{displayValue:this.textReg,value:Asc.TextFormFormatType.RegExp}],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.lockedControls.push(this.cmbFormat),this.cmbFormat.setValue(Asc.TextFormFormatType.None),this.cmbFormat.on("selected",this.onFormatSelect.bind(this)),this.txtRegExp=new Common.UI.InputField({el:t.findById("#form-txt-regexp"),allowBlank:!0,validateOnChange:!1,validateOnBlur:!1,style:"width: 100%;",value:"",dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.lockedControls.push(this.txtRegExp),this.txtRegExp.on("changed:after",this.onRegExpChanged.bind(this)),this.txtRegExp.on("inputleave",function(){i.fireEvent("editcomplete",i)}),this.txtRegExp.cmpEl.on("focus","input.form-control",function(){setTimeout(function(){i.txtRegExp._input&&i.txtRegExp._input.select()},1)}),this.cmbMask=new Common.UI.ComboBoxCustom({el:t.findById("#form-txt-mask"),cls:"input-group-nr",menuCls:"menu-absolute",menuStyle:"min-width: 195px;",editable:!0,data:[{displayValue:this.textPhone1,value:"(999)999-9999"},{displayValue:this.textPhone2,value:"+999999999999"},{displayValue:this.textZipCodeUS,value:"99999-9999"},{displayValue:this.textUSSSN,value:"999-99-9999"},{displayValue:this.textUKPassport,value:"999999999"},{displayValue:this.textCreditCard,value:"9999-9999-9999-9999"}],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big",updateFormControl:function(t){t&&this.setRawValue(t.get("value"))}}),this.cmbMask.setValue(""),this.lockedControls.push(this.cmbMask),this.cmbMask.on("selected",this.onMaskChanged.bind(this)),this.cmbMask.on("changed:after",this.onMaskChanged.bind(this)),this.cmbMask.on("hide:after",this.onHideMenus.bind(this)),this.cmbMask.cmpEl.on("focus","input.form-control",function(){setTimeout(function(){i.cmbMask._input&&i.cmbMask._input.select()},1)}),this.txtFormatSymbols=new Common.UI.InputField({el:t.findById("#form-txt-format-symbols"),allowBlank:!0,validateOnChange:!1,validateOnBlur:!1,style:"width: 100%;",value:"",dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.lockedControls.push(this.txtFormatSymbols),this.txtFormatSymbols.on("changed:after",this.onFormatSymbolsChanged.bind(this)),this.txtFormatSymbols.on("inputleave",function(){i.fireEvent("editcomplete",i)}),this.txtFormatSymbols.cmpEl.on("focus","input.form-control",function(){setTimeout(function(){i.txtFormatSymbols._input&&i.txtFormatSymbols._input.select()},1)}),this.cmbDateFormat=new Common.UI.ComboBox({el:t.findById("#form-cmb-date-format"),cls:"input-group-nr",menuCls:"menu-absolute",menuStyle:"min-width: 195px; max-height: 190px;",editable:!1,data:[],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbDateFormat.setValue(""),this.lockedControls.push(this.cmbDateFormat),this.cmbDateFormat.on("selected",this.onDateFormatChanged.bind(this)),this.cmbDateFormat.on("changed:after",this.onDateFormatChanged.bind(this)),this.cmbDateFormat.on("hide:after",this.onHideMenus.bind(this)),this.cmbDateFormat.cmpEl.on("focus","input.form-control",function(){setTimeout(function(){i.cmbDateFormat._input&&i.cmbDateFormat._input.select()},1)}),[{value:1068},{value:1026},{value:1029},{value:1030},{value:3079},{value:1031},{value:2055},{value:1032},{value:3081},{value:2057},{value:1033},{value:3082},{value:2058},{value:1035},{value:1036},{value:4108},{value:1040},{value:2064},{value:1041},{value:1042},{value:1062},{value:1038},{value:1043},{value:1045},{value:1046},{value:2070},{value:1049},{value:1051},{value:1060},{value:2077},{value:1053},{value:1055},{value:1058},{value:1066},{value:2052}]);n.forEach(function(t){var e=Common.util.LanguageInfo.getLocalLanguageName(t.value);t.displayValue=e[1],t.langName=e[0]}),this.cmbLang=new Common.UI.ComboBox({el:t.findById("#form-cmb-date-lang"),cls:"input-group-nr",menuCls:"menu-absolute",menuStyle:"min-width: 195px; max-height: 190px;",editable:!1,data:n,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.lockedControls.push(this.cmbLang),this.cmbLang.setValue(1033),this.cmbLang.on("selected",function(t,e){i.updateDateFormats(e.value)}),this.updateMetricUnit(),this.UpdateThemeColors()},setApi:function(t){return this.api=t,this.api&&this.api.asc_registerCallback("asc_onUpdateOFormRoles",p.bind(this.onRefreshRolesList,this)),Common.NotificationCenter.on("storage:image-insert",p.bind(this.insertImageFromStorage,this)),this},setMode:function(t){this.mode=t},onKeyChanged:function(t,e){var i,n;this.api&&!this._noApply&&(this._state.Key=void 0,i=this._originalProps||new AscCommon.CContentControlPr,(n=this._originalFormProps||new AscCommon.CSdtFormPr).put_Key(e.value),i.put_FormPr(n),this.api.asc_SetContentControlProperties(i,this.internalId),this.fireEvent("editcomplete",this))},onPlaceholderChanged:function(t,e,i,n){this.api&&!this._noApply&&e!==i&&((i=this._originalProps||new AscCommon.CContentControlPr).put_PlaceholderText(e||"    "),this.api.asc_SetContentControlProperties(i,this.internalId),n.relatedTarget&&("input"==n.relatedTarget.localName||"textarea"==n.relatedTarget.localName)&&/form-control/.test(n.relatedTarget.className)||this.fireEvent("editcomplete",this))},onTagChanged:function(t,e,i,n){this.api&&!this._noApply&&e!==i&&((i=this._originalProps||new AscCommon.CContentControlPr).put_Tag(e),this.api.asc_SetContentControlProperties(i,this.internalId),n.relatedTarget&&("input"==n.relatedTarget.localName||"textarea"==n.relatedTarget.localName)&&/form-control/.test(n.relatedTarget.className)||this.fireEvent("editcomplete",this))},onHelpChanged:function(t,e,i,n){var o;this.api&&!this._noApply&&e!==i&&(i=this._originalProps||new AscCommon.CContentControlPr,(o=this._originalFormProps||new AscCommon.CSdtFormPr).put_HelpText(e),i.put_FormPr(o),this.api.asc_SetContentControlProperties(i,this.internalId),n.relatedTarget&&("input"==n.relatedTarget.localName||"textarea"==n.relatedTarget.localName)&&/form-control/.test(n.relatedTarget.className)||this.fireEvent("editcomplete",this))},onTxtDefChanged:function(t,e,i,n){this.api&&!this._noApply&&e!==i&&(this.api.asc_SetFormValue(e,this.internalId),n.relatedTarget&&("input"==n.relatedTarget.localName||"textarea"==n.relatedTarget.localName)&&/form-control/.test(n.relatedTarget.className)||this.fireEvent("editcomplete",this))},onDateDefClick:function(t,e){var i;this.api&&!this._noApply&&((i=this._originalDateProps||new AscCommon.CSdtDatePickerPr).put_FullDate(e),this.api.asc_SetContentControlDatePickerPr(i,this.internalId,!0),this.fireEvent("editcomplete",this))},onComboDefChanged:function(t,e){this.api&&!this._noApply&&(this.api.asc_SetFormValue(e.value,this.internalId),this.fireEvent("editcomplete",this))},onChDefValue:function(t,e,i,n){this.api&&!this._noApply&&(this.api.asc_SetFormValue("checked"==t.getValue(),this.internalId),this.fireEvent("editcomplete",this))},onChMaxCharsChanged:function(t,e,i,n){var o,s,t="checked"==t.getValue();this.spnMaxChars.setDisabled(!t||this._state.FormatType===Asc.TextFormFormatType.Mask||this._state.DisabledControls),t||(this.chComb.setValue(!1,!0),this.spnWidth.setDisabled(!0),this.cmbWidthRule.setDisabled(!0)),this.api&&!this._noApply&&(o=this._originalProps||new AscCommon.CContentControlPr,s=this._originalTextFormProps||new AscCommon.CSdtTextFormPr,t||s.put_Comb(t),s.put_MaxCharacters(t&&(this.spnMaxChars.getNumberValue()||10)),o.put_TextFormPr(s),this.api.asc_SetContentControlProperties(o,this.internalId),this.fireEvent("editcomplete",this))},onMaxCharsChange:function(t,e,i,n){var o,s,a;this.api&&!this._noApply&&(o=this._originalProps||new AscCommon.CContentControlPr,s=this._originalTextFormProps||new AscCommon.CSdtTextFormPr,a="checked"==this.chMaxChars.getValue()||"checked"==this.chComb.getValue(),s.put_MaxCharacters(a&&(t.getNumberValue()||10)),o.put_TextFormPr(s),this.api.asc_SetContentControlProperties(o,this.internalId))},onChCombChanged:function(t,e,i,n){var o,s,t="checked"==t.getValue();t&&(this.chMaxChars.setValue(!0,!0),this.spnMaxChars.setDisabled(this._state.FormatType===Asc.TextFormFormatType.Mask||this._state.DisabledControls)),this.cmbWidthRule.setDisabled(!t||this._state.Fixed||this._state.DisabledControls),this.spnWidth.setDisabled(!t||this._state.WidthRule===Asc.CombFormWidthRule.Auto||this._state.DisabledControls),this.api&&!this._noApply&&(o=this._originalProps||new AscCommon.CContentControlPr,(s=this._originalTextFormProps||new AscCommon.CSdtTextFormPr).put_Comb(t),t&&(s.put_MaxCharacters(this.spnMaxChars.getNumberValue()||10),this.spnWidth.getValue()?(t=this.spnWidth.getNumberValue(),s.put_Width(t<=0?0:parseInt(72*Common.Utils.Metric.fnRecalcToMM(t)*20/25.4+.5))):s.put_Width(0)),o.put_TextFormPr(s),this.api.asc_SetContentControlProperties(o,this.internalId),this.fireEvent("editcomplete",this))},onWidthChange:function(t,e,i,n){var o,s,a;this.api&&!this._noApply&&(o=this._originalProps||new AscCommon.CContentControlPr,s=this._originalTextFormProps||new AscCommon.CSdtTextFormPr,this.spnWidth.getValue()?(a=this.spnWidth.getNumberValue(),s.put_Width(a<=0?0:parseInt(72*Common.Utils.Metric.fnRecalcToMM(a)*20/25.4+.5)),s.put_WidthRule(this.cmbWidthRule.getValue())):s.put_Width(0),o.put_TextFormPr(s),this.api.asc_SetContentControlProperties(o,this.internalId))},onWidthRuleSelect:function(t,e){var i,n;this.api&&!this._noApply&&(i=this._originalProps||new AscCommon.CContentControlPr,(n=this._originalTextFormProps||new AscCommon.CSdtTextFormPr).put_WidthRule(e.value),e.value===Asc.CombFormWidthRule.Auto&&n.put_Width(this._state.WidthPlaceholder),i.put_TextFormPr(n),this.api.asc_SetContentControlProperties(i,this.internalId),this.fireEvent("editcomplete",this))},onChRequired:function(t,e,i,n){var o,s,t="checked"==t.getValue();this.api&&!this._noApply&&(o=this._originalProps||new AscCommon.CContentControlPr,(s=this._originalFormProps||new AscCommon.CSdtFormPr).put_Required(t),o.put_FormPr(s),this.api.asc_SetContentControlProperties(o,this.internalId),this.fireEvent("editcomplete",this))},onChAutofit:function(t,e,i,n){var o,s,t="checked"==t.getValue();this.api&&!this._noApply&&(o=this._originalProps||new AscCommon.CContentControlPr,(s=this._originalTextFormProps||new AscCommon.CSdtTextFormPr).put_AutoFit(t),o.put_TextFormPr(s),this.api.asc_SetContentControlProperties(o,this.internalId),this.fireEvent("editcomplete",this))},onChMulti:function(t,e,i,n){var o,s,t="checked"==t.getValue();this.api&&!this._noApply&&(o=this._originalProps||new AscCommon.CContentControlPr,(s=this._originalTextFormProps||new AscCommon.CSdtTextFormPr).put_MultiLine(t),o.put_TextFormPr(s),this.api.asc_SetContentControlProperties(o,this.internalId),this.fireEvent("editcomplete",this))},onChFixed:function(t,e,i,n){this.api&&!this._noApply&&(this._originalProps||new AscCommon.CContentControlPr,this.cmbWidthRule.setDisabled(!this._state.Comb||"checked"==t.getValue()||this._state.DisabledControls),this.api.asc_SetFixedForm(this.internalId,"checked"==t.getValue()),this.fireEvent("editcomplete",this))},onChAspect:function(t,e,i,n){var o,s;this.api&&!this._noApply&&(o=this._originalProps||new AscCommon.CContentControlPr,(s=this._originalPictProps||new AscCommon.CSdtPictureFormPr).put_ConstantProportions("checked"==t.getValue()),o.put_PictureFormPr(s),this.api.asc_SetContentControlProperties(o,this.internalId),this.fireEvent("editcomplete",this))},onScaleChanged:function(t,e){var i,n;this.api&&!this._noApply&&(i=this._originalProps||new AscCommon.CContentControlPr,(n=this._originalPictProps||new AscCommon.CSdtPictureFormPr).put_ScaleFlag(e.value),i.put_PictureFormPr(n),this.api.asc_SetContentControlProperties(i,this.internalId),this.fireEvent("editcomplete",this))},onGroupKeyChanged:function(t,e){var i,n;this.api&&!this._noApply&&""!==e.value?(i=this._originalProps||new AscCommon.CContentControlPr,(n=this._originalCheckProps||new AscCommon.CSdtCheckBoxPr).put_GroupKey(e.value),i.put_CheckBoxPr(n),this.api.asc_SetContentControlProperties(i,this.internalId)):this.cmbGroupKey.setValue(this._state.groupKey||""),this.fireEvent("editcomplete",this)},fillListProps:function(){var t,i;this.api&&!this._noApply&&(t=this._originalProps||new AscCommon.CContentControlPr,(i=this._originalListProps||new AscCommon.CSdtComboBoxPr).clear(),this.list.store.each(function(t,e){i.add_Item(t.get("name"),t.get("value"))}),this.type==Asc.c_oAscContentControlSpecificType.ComboBox?t.put_ComboBoxPr(i):t.put_DropDownListPr(i),this.api.asc_SetContentControlProperties(t,this.internalId))},onNewValueKeydown:function(t){this.api&&!this._noApply&&t.keyCode==Common.UI.Keys.RETURN&&this.onAddItem()},onAddItem:function(){var t=this.list.store,e=this.txtNewValue.getValue();""===e||t.findWhere({value:e})||(t.add({value:e,name:e}),this._state.listValue=e,this._state.listIndex=void 0,this.fillListProps()),this.fireEvent("editcomplete",this)},onDeleteItem:function(t,e){var i,n=this.list.getSelectedRec();n&&(i=this.list.store,this._state.listIndex=i.indexOf(n),this._state.listValue=void 0,i.remove(n),this.fillListProps()),this.fireEvent("editcomplete",this)},onMoveItem:function(t){var e,i=this.list.store,n=i.length,o=this.list.getSelectedRec();o&&(e=i.indexOf(o),i.add(i.remove(o),{at:t?Math.max(0,e-1):Math.min(n-1,e+1)}),this.fillListProps()),this.fireEvent("editcomplete",this)},setImageUrl:function(t,e){this.api.asc_SetContentControlPictureUrl(t,this.internalId,e)},insertImageFromStorage:function(t){t&&t._urls&&"control"==t.c&&this.setImageUrl(t._urls[0],t.token)},onImageSelect:function(t,e){var i;1==e.value?(i=this,new Common.Views.ImageFromUrlDialog({handler:function(t,e){"ok"==t&&i.api&&(t=e.replace(/ /g,""),p.isEmpty(t)||i.setImageUrl(t)),i.fireEvent("editcomplete",i)}}).show()):2==e.value?Common.NotificationCenter.trigger("storage:image-load","control"):this._isFromFile||(this._isFromFile=!0,this.api&&this.api.asc_addImage(this._originalProps),this.fireEvent("editcomplete",this),this._isFromFile=!1)},onColorBGSelect:function(t,e){this.BackgroundColor=e,this._state.BackgroundColor=void 0;var i=this._originalProps||new AscCommon.CContentControlPr,n=this._originalFormProps||new AscCommon.CSdtFormPr;this.api&&("transparent"===e?n.put_Shd(!1):n.put_Shd(!0,Common.Utils.ThemeColor.getRgbColor(e)),i.put_FormPr(n),this.api.asc_SetContentControlProperties(i,this.internalId)),this.fireEvent("editcomplete",this)},onColorPickerSelect:function(t,e){var i,n,o;this.BorderColor=e,this._state.BorderColor=void 0,this.api&&!this._noApply&&(i=this._originalProps||new AscCommon.CContentControlPr,n=this._originalFormProps||new AscCommon.CSdtFormPr,"transparent"==e?n.put_Border():((o=(o=n.get_Border())||new Asc.asc_CTextBorder).put_Value(1),o.put_Color(Common.Utils.ThemeColor.getRgbColor(e)),n.put_Border(o)),i.put_FormPr(n),this.api.asc_SetContentControlProperties(i,this.internalId),this.fireEvent("editcomplete",this))},onNoBorderClick:function(t){var e,i;this.BorderColor="transparent",this._state.BorderColor=void 0,this.api&&!this._noApply&&(e=this._originalProps||new AscCommon.CContentControlPr,(i=this._originalFormProps||new AscCommon.CSdtFormPr).put_Border(),e.put_FormPr(i),this.api.asc_SetContentControlProperties(e,this.internalId),this.fireEvent("editcomplete",this))},onFormatSelect:function(t,e){if(this.api&&!this._noApply){var i=this._originalProps||new AscCommon.CContentControlPr,n=this._originalTextFormProps||new AscCommon.CSdtTextFormPr;switch(e.value){case Asc.TextFormFormatType.None:n.put_NoneFormat();break;case Asc.TextFormFormatType.Digit:n.put_DigitFormat();break;case Asc.TextFormFormatType.Letter:n.put_LetterFormat();break;case Asc.TextFormFormatType.Mask:this.cmbMask.setValue("*"),n.put_MaskFormat(this.cmbMask.getValue());break;case Asc.TextFormFormatType.RegExp:this.txtRegExp.setValue("."),n.put_RegExpFormat(this.txtRegExp.getValue())}i.put_TextFormPr(n),this.api.asc_SetContentControlProperties(i,this.internalId),this.fireEvent("editcomplete",this)}},onMaskChanged:function(t,e){var i,n;this.api&&!this._noApply?(i=this._originalProps||new AscCommon.CContentControlPr,(n=this._originalTextFormProps||new AscCommon.CSdtTextFormPr).put_MaskFormat(e.value),this._state.placeholder===this._state.Mask&&i.put_PlaceholderText(e.value),i.put_TextFormPr(n),this.api.asc_SetContentControlProperties(i,this.internalId)):this.cmbMask.setValue(this._state.Mask||""),this.fireEvent("editcomplete",this)},onRegExpChanged:function(t,e,i,n){var o;this.api&&!this._noApply&&e!==i&&(i=this._originalProps||new AscCommon.CContentControlPr,(o=this._originalTextFormProps||new AscCommon.CSdtTextFormPr).put_RegExpFormat(e),i.put_TextFormPr(o),this.api.asc_SetContentControlProperties(i,this.internalId),n.relatedTarget&&("input"==n.relatedTarget.localName||"textarea"==n.relatedTarget.localName)&&/form-control/.test(n.relatedTarget.className)||this.fireEvent("editcomplete",this))},onFormatSymbolsChanged:function(t,e,i,n){var o;this.api&&!this._noApply&&e!==i&&(i=this._originalProps||new AscCommon.CContentControlPr,(o=this._originalTextFormProps||new AscCommon.CSdtTextFormPr).put_FormatSymbols(e),i.put_TextFormPr(o),this.api.asc_SetContentControlProperties(i,this.internalId),n.relatedTarget&&("input"==n.relatedTarget.localName||"textarea"==n.relatedTarget.localName)&&/form-control/.test(n.relatedTarget.className)||this.fireEvent("editcomplete",this))},ChangeSettings:function(t,e){if(this._initSettings&&this.createDelayedElements(),t){this._originalProps=t,this._noApply=!0,this.internalId=t.get_InternalId();var i,n=t.get_PlaceholderText(),o=(this._state.placeholder!==n&&(this.txtPlaceholder.setValue(n||""),this._state.placeholder=n),n=t.get_Tag(),this._state.tag!==n&&(this.txtTag.setValue(n||""),this._state.tag=n),void 0===(n=t.get_Lock())&&(n=Asc.c_oAscSdtLockType.Unlocked),this._state.LockDelete!==(n==Asc.c_oAscSdtLockType.SdtContentLocked||n==Asc.c_oAscSdtLockType.SdtLocked)&&(this._state.LockDelete=n==Asc.c_oAscSdtLockType.SdtContentLocked||n==Asc.c_oAscSdtLockType.SdtLocked,this.btnLockForm.setCaption(this._state.LockDelete?this.textUnlock:this.textLock)),this.disableControls(this._locked),t.get_SpecificType()),s=!1;if(o==Asc.c_oAscContentControlSpecificType.ComboBox||o==Asc.c_oAscContentControlSpecificType.DropDownList){if(this.labelFormName.text(o==Asc.c_oAscContentControlSpecificType.ComboBox?this.textCombobox:this.textDropDown),i=o==Asc.c_oAscContentControlSpecificType.ComboBox?t.get_ComboBoxPr():t.get_DropDownListPr()){for(var a=(this._originalListProps=i).get_ItemsCount(),l=[],r=0;r<a;r++)""!==i.get_ItemValue(r)&&l.push({value:i.get_ItemValue(r),name:i.get_ItemDisplayText(r)});this.list.store.reset(l);var c=null;0<l.length&&this._state.internalId===this.internalId&&(void 0!==this._state.listValue||void 0!==this._state.listIndex)&&(void 0!==this._state.listIndex&&this._state.listIndex>=this.list.store.length&&(this._state.listIndex=this.list.store.length-1),c=void 0!==this._state.listValue?this.list.store.findWhere({value:this._state.listValue}):this.list.store.at(this._state.listIndex)),c?(this.list.selectRecord(c,this.txtNewValue._input.is(":focus")),this.list.scrollToRecord(c)):this.txtNewValue._input.is(":focus")||(this.txtNewValue.setValue(""),this.btnListAdd.setDisabled(!0),this._state.listValue=this._state.listIndex=void 0),o==Asc.c_oAscContentControlSpecificType.DropDownList?(l.forEach(function(t){t.value=t.displayValue=t.name}),0<l.length&&l.unshift({value:"",displayValue:this.textNone}),this.cmbDefValue.setData(l),this.cmbDefValue.setDisabled(l.length<1),this.cmbDefValue.setValue(this.api.asc_GetFormValue(this.internalId)||"")):(n=this.api.asc_GetFormValue(this.internalId),this._state.DefValue!==n&&(this.txtDefValue.setValue(n||""),this._state.DefValue=n))}this.disableListButtons()}else o==Asc.c_oAscContentControlSpecificType.CheckBox&&(i=t.get_CheckBoxPr(),this._originalCheckProps=i);c=t.get_FormPr();if(c){this._originalFormProps=c,o==Asc.c_oAscContentControlSpecificType.Picture&&this.labelFormName.text(this.textImage);var d=this.api.asc_GetFormKeysByType(o),d=((!this._state.arrKey||this._state.arrKey.length!==d.length||0<p.difference(this._state.arrKey,d).length)&&(l=[],d.forEach(function(t){l.push({displayValue:t,value:t})}),this.cmbKey.setData(l),this._state.arrKey=d,this._state.Key=void 0),n=c.get_Role(),this._state.Role!==n&&(this.cmbRoles.setValue(n||""),this._state.Role=n),n=c.get_Key(),this._state.Key!==n&&(this.cmbKey.setValue(n||""),this._state.Key=n),(s=n?1<(n=this.api.asc_GetFormsCountByKey(n)):s)&&this.labelConnectedFields.text(this.textConnected+": "+n),n=c.get_HelpText(),this._state.help!==n&&(this.textareaHelp.setValue(n||""),this._state.help=n),n=c.get_Required(),this._state.Required!==n&&(this.chRequired.setValue(!!n,!0),this._state.Required=n),o==Asc.c_oAscContentControlSpecificType.CheckBox&&i&&((m="string"!=typeof(n=i.get_GroupKey()))||(d=this.api.asc_GetRadioButtonGroupKeys(),(!this._state.arrGroupKey||this._state.arrGroupKey.length!==d.length||0<p.difference(this._state.arrGroupKey,d).length)&&(l=[],d.forEach(function(t){l.push({displayValue:t,value:t})}),this.cmbGroupKey.setData(l),this._state.arrGroupKey=d,this._state.groupKey=void 0),this._state.groupKey!==n&&(this.cmbGroupKey.setValue(n||""),this._state.groupKey=n)),this.labelFormName.text(m?this.textCheckbox:this.textRadiobox),this.chDefValue.setCaption(m?this.textCheckDefault:this.textRadioDefault),n=this.api.asc_GetFormValue(this.internalId),this._state.ChDefValue!==n&&(this.chDefValue.setValue(!!n,!0),this._state.ChDefValue=n)),o!==Asc.c_oAscContentControlSpecificType.Picture&&(n=c.get_Fixed(),this._state.Fixed!==n&&(this.chFixed.setValue(!!n,!0),this._state.Fixed=n),this.chFixed.setDisabled(!n&&e)),c.get_Border()),e=(d&&(m=d.get_Color())?m.get_type()==Asc.c_oAscColor.COLOR_TYPE_SCHEME?this.BorderColor={color:Common.Utils.ThemeColor.getHexColor(m.get_r(),m.get_g(),m.get_b()),effectValue:m.get_value()}:this.BorderColor=Common.Utils.ThemeColor.getHexColor(m.get_r(),m.get_g(),m.get_b()):this.BorderColor="transparent",typeof this.BorderColor),d=((e!=typeof this._state.BorderColor||"object"==e&&(this.BorderColor.effectValue!==this._state.BorderColor.effectValue||this._state.BorderColor.color.indexOf(this.BorderColor.color)<0)||"object"!=e&&this._state.BorderColor.indexOf(this.BorderColor)<0)&&(this.btnColor.setColor(this.BorderColor),this.mnuColorPicker.clearSelection(),this.mnuNoBorder.setChecked("transparent"==this.BorderColor,!0),"transparent"!=this.BorderColor&&this.mnuColorPicker.selectByRGB("object"==typeof this.BorderColor?this.BorderColor.color:this.BorderColor,!0),this._state.BorderColor=this.BorderColor),c.get_Shd());if(d&&(m=d.get_Color())?m.get_type()===Asc.c_oAscColor.COLOR_TYPE_SCHEME?this.BackgroundColor={color:Common.Utils.ThemeColor.getHexColor(m.get_r(),m.get_g(),m.get_b()),effectValue:m.get_value()}:this.BackgroundColor=Common.Utils.ThemeColor.getHexColor(m.get_r(),m.get_g(),m.get_b()):this.BackgroundColor="transparent",(e=typeof this.BackgroundColor)!=typeof this._state.BackgroundColor||"object"==e&&(this.BackgroundColor.effectValue!==this._state.BackgroundColor.effectValue||this._state.BackgroundColor.color.indexOf(this.BackgroundColor.color)<0)||"object"!=e&&this._state.BackgroundColor.indexOf(this.BackgroundColor)<0){if(this.btnBGColor.setColor(this.BackgroundColor),"object"==typeof this.BackgroundColor){for(var h=!1,r=0;r<10;r++)if(Common.Utils.ThemeColor.ThemeValues[r]===this.BackgroundColor.effectValue){this.mnuBGColorPicker.select(this.BackgroundColor,!0),h=!0;break}h||this.mnuBGColorPicker.clearSelection()}else this.mnuBGColorPicker.select(this.BackgroundColor,!0);this._state.BackgroundColor=this.BackgroundColor}}var c=t.get_PictureFormPr(),m=(c&&(n=(this._originalPictProps=c).get_ConstantProportions(),this._state.Aspect!==n&&(this.chAspect.setValue(!!n,!0),this._state.Aspect=n),n=c.get_ScaleFlag(),this._state.scaleFlag!==n&&(this.cmbScale.setValue(n),this._state.scaleFlag=n),n=100*c.get_ShiftX(),this._state.imgPositionX!==n&&(this.sldrPreviewPositionX.setValue(n),this._state.imgPositionX=n),n=100*c.get_ShiftY(),this._state.imgPositionY!==n&&(this.sldrPreviewPositionY.setValue(n),this._state.imgPositionY=n),this.imagePositionLabel.text(Math.round(this._state.imgPositionX)+","+Math.round(this._state.imgPositionY)),n=50*this._state.imgPositionX/100-1,this.imagePositionPreview.css({left:n+"px"}),n=50*this._state.imgPositionY/100-1,this.imagePositionPreview.css({top:n+"px"}),this.chAspect.setDisabled(this._state.scaleFlag===Asc.c_oAscPictureFormScaleFlag.Never||this._state.DisabledControls),d=this._state.scaleFlag===Asc.c_oAscPictureFormScaleFlag.Always&&!this._state.Aspect||this._state.DisabledControls,this.sldrPreviewPositionX.setDisabled(d),this.sldrPreviewPositionY.setDisabled(d)),t.get_TextFormPr()),e=!!m&&!this._originalTextFormProps||!m&&!!this._originalTextFormProps,c=(m?(this._originalTextFormProps=m,this.labelFormName.text(this.textField),n=m.get_Comb(),this._state.Comb!==n&&(this.chComb.setValue(!!n,!0),this._state.Comb=n),n=m.get_MultiLine(),this._state.Multi!==n&&(this.chMulti.setValue(!!n,!0),this._state.Multi=n),this.chMulti.setDisabled(!this._state.Fixed||this._state.Comb||this._state.DisabledControls),n=m.get_AutoFit(),this._state.AutoFit!==n&&(this.chAutofit.setValue(!!n,!0),this._state.AutoFit=n),this.chAutofit.setDisabled(!this._state.Fixed||this._state.Comb||this._state.DisabledControls),this.cmbWidthRule.setDisabled(!this._state.Comb||this._state.Fixed||this._state.DisabledControls),n=this._state.Fixed?Asc.CombFormWidthRule.Exact:m.get_WidthRule(),this._state.WidthRule!==n&&(this.cmbWidthRule.setValue(null!=n?n:""),this._state.WidthRule=n),n=this.api.asc_GetTextFormAutoWidth(),(this._state.WidthPlaceholder!==n||.01<Math.abs(this._state.WidthPlaceholder-n))&&(this.spnWidth.setDefaultValue(null!=n?Common.Utils.Metric.fnRecalcFromMM(25.4*(n+1)/20/72):this.spnWidth.getMinValue()),this._state.WidthPlaceholder=n),this.spnWidth.setDisabled(!this._state.Comb||this._state.WidthRule===Asc.CombFormWidthRule.Auto||this._state.DisabledControls),n=m.get_Width(),((void 0===(n=this._state.WidthRule===Asc.CombFormWidthRule.Auto||void 0===n||0===n?this._state.WidthPlaceholder:n)||void 0===this._state.Width)&&this._state.Width!==n||.1<Math.abs(this._state.Width-n))&&(this.spnWidth.setValue(0!==n&&void 0!==n?Common.Utils.Metric.fnRecalcFromMM(25.4*n/20/72):"",!0),this._state.Width=n),n=m.get_FormatType(),this._state.FormatType!==n&&(this.cmbFormat.setValue(null!=n?n:Asc.TextFormFormatType.None),this._state.FormatType=n),this._state.FormatType===Asc.TextFormFormatType.Mask&&(n=m.get_MaskFormat(),this.cmbMask.setValue(null!=n?n:""),this._state.Mask=n),this._state.FormatType===Asc.TextFormFormatType.RegExp&&(n=m.get_RegExpFormat(),this.txtRegExp.setValue(null!=n?n:""),this._state.RegExp=n),n=m.get_FormatSymbols(),this._state.FormatSymbols!==n&&(this.txtFormatSymbols.setValue(null!=n?n:""),this._state.FormatSymbols=n),n=m.get_MaxCharacters(),this.chMaxChars.setValue(n&&0<=n),this.chMaxChars.setDisabled(this._state.FormatType===Asc.TextFormFormatType.Mask||this._state.DisabledControls),this.spnMaxChars.setDisabled(!n||n<0||this._state.FormatType===Asc.TextFormFormatType.Mask||this._state.DisabledControls),((void 0===n||void 0===this._state.MaxChars)&&this._state.MaxChars!==n||.1<Math.abs(this._state.MaxChars-n))&&(this.spnMaxChars.setValue(n&&0<=n?n:10,!0),this._state.MaxChars=n),n=this.api.asc_GetFormValue(this.internalId),this._state.DefValue!==n&&(this.txtDefValue.setValue(n||""),this._state.DefValue=n)):this._originalTextFormProps=null,t.get_DateTimePr()),d=(c&&o==Asc.c_oAscContentControlSpecificType.DateTime&&(this.labelFormName.text(this.textDateField),(d=(this._originalDateProps=c).get_LangId()||this.options.controlLang)&&(d=(d=this.cmbLang.store.findWhere({value:d}))?d.get("value"):1033,this.cmbLang.setValue(d)),this.updateDateFormats(this.cmbLang.getValue()),d=c.get_DateFormat(),this.cmbDateFormat.setValue(d,c.get_String()),this._state.DateFormat=d,n=this.api.asc_GetFormValue(this.internalId),this._state.DefDateValue!==n&&(this.txtDateDefValue.setValue(n||""),this._state.DefDateValue=n,n=c.get_FullDate(),this.txtDateDefValue.setDate(n?new Date(n):new Date))),!!t.get_ComplexFormPr()),c=!!this.api.asc_GetCurrentComplexForm()&&!d;d&&this.labelFormName.text(this.textComplex),this._noApply=!1,this.KeySettingsTd.toggleClass("padding-small",!s),this.ConnectedSettings.toggleClass("hidden",!s),this.TextOnlySettingsMask.toggleClass("hidden",!(o===Asc.c_oAscContentControlSpecificType.None&&m)||this._state.FormatType!==Asc.TextFormFormatType.Mask),this.TextOnlySettingsRegExp.toggleClass("hidden",!(o===Asc.c_oAscContentControlSpecificType.None&&m)||this._state.FormatType!==Asc.TextFormFormatType.RegExp),this.type===o&&this.isSimpleInsideComplex===c&&!e&&o!=Asc.c_oAscContentControlSpecificType.CheckBox||this.showHideControls(o,m,i,c),this.type=o,this._state.isSimpleInsideComplex=c,this._state.internalId=this.internalId}},updateMetricUnit:function(){if(this.spinners){for(var t=0;t<this.spinners.length;t++){var e=this.spinners[t];e.setDefaultUnit(Common.Utils.Metric.getCurrentMetricName()),e.setStep(Common.Utils.Metric.getCurrentMetric()==Common.Utils.Metric.c_MetricUnits.pt?1:.1)}var i=this._state.Width;this.spnWidth&&this.spnWidth.setMinValue(Common.Utils.Metric.fnRecalcFromMM(1)),this.spnWidth&&this.spnWidth.setValue(0!==i&&void 0!==i?Common.Utils.Metric.fnRecalcFromMM(25.4*i/20/72):"",!0)}},UpdateThemeColors:function(){this._initSettings||(this.btnColor||(this.btnColor=new Common.UI.ColorButton({parentEl:(this.$el||o(this.el)).findById("#form-color-btn"),additionalItems:[this.mnuNoBorder=new Common.UI.MenuItem({style:Common.UI.isRTL()?"padding-right:20px;":"padding-left:20px;",caption:this.textNoBorder,toggleGroup:"form-settings-no-border",checkable:!0}),{caption:"--"}],menu:!0,colors:["FEF8E5","FFEFBF","E2EFD8","C6E0B3","EDEDED","DBDBDB","CDD6E4","A2B2CA","F2F2F2","D9D9D9","DDEBF6","C2DDF2","FBECE2","F7D9C6","D6E3EE","B9CAE7","F2DADA","F2C2C2","F0DDF6","E5C2F2","E6FBD6","CDF7AC","EED6D6","E7B9B9","CCE1FF","9AC4FF","E4CDDB","D9ADC7"],themecolors:0,effects:0,dataHint:"1",colorHints:!1,dataHintDirection:"bottom",dataHintOffset:"big"}),this.lockedControls.push(this.btnColor),this.mnuNoBorder.on("click",p.bind(this.onNoBorderClick,this)),this.btnColor.on("color:select",this.onColorPickerSelect.bind(this)),this.btnColor.setMenu(),this.mnuColorPicker=this.btnColor.getPicker()),this.btnBGColor||(this.btnBGColor=new Common.UI.ColorButton({parentEl:o("#form-background-color-btn"),transparent:!0,menu:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.lockedControls.push(this.btnBGColor),this.btnBGColor.on("color:select",p.bind(this.onColorBGSelect,this)),this.btnBGColor.setMenu(),this.mnuBGColorPicker=this.btnBGColor.getPicker()),this.mnuBGColorPicker.updateColors(Common.Utils.ThemeColor.getEffectColors(),Common.Utils.ThemeColor.getStandartColors()))},onHideMenus:function(t,e,i){i||this.fireEvent("editcomplete",this)},setLocked:function(t){this._locked=t},disableControls:function(t){var e,i;this._initSettings||((e=this)._state.DisabledControls!==(this._state.LockDelete||t)&&(this._state.DisabledControls=this._state.LockDelete||t,p.each(this.lockedControls,function(t){t.setDisabled(e._state.DisabledControls)})),this.chMaxChars.setDisabled(this._state.FormatType===Asc.TextFormFormatType.Mask||this._state.DisabledControls),this.spnMaxChars.setDisabled("checked"!==this.chMaxChars.getValue()||this._state.FormatType===Asc.TextFormFormatType.Mask||this._state.DisabledControls),this.cmbWidthRule.setDisabled(!this._state.Comb||this._state.Fixed||this._state.DisabledControls),this.spnWidth.setDisabled(!this._state.Comb||this._state.WidthRule===Asc.CombFormWidthRule.Auto||this._state.DisabledControls),this.chMulti.setDisabled(!this._state.Fixed||this._state.Comb||this._state.DisabledControls),this.chAutofit.setDisabled(!this._state.Fixed||this._state.Comb||this._state.DisabledControls),this.chAspect.setDisabled(this._state.scaleFlag===Asc.c_oAscPictureFormScaleFlag.Never||this._state.DisabledControls),i=this._state.scaleFlag===Asc.c_oAscPictureFormScaleFlag.Always&&!this._state.Aspect,this.sldrPreviewPositionX.setDisabled(i||this._state.DisabledControls),this.sldrPreviewPositionY.setDisabled(i||this._state.DisabledControls),this.btnListAdd.setDisabled(this.txtNewValue.length<1||this._state.DisabledControls),this.btnLockForm.setDisabled(t))},showHideControls:function(t,e,i,n){var o=!1,s=!1,a=!1,l=!1,r=!1,c=!1,i=(t==Asc.c_oAscContentControlSpecificType.ComboBox||t==Asc.c_oAscContentControlSpecificType.DropDownList?l=!!i:t==Asc.c_oAscContentControlSpecificType.CheckBox?i&&(a=!(s="string"!=typeof i.get_GroupKey())):t==Asc.c_oAscContentControlSpecificType.Picture?r=!0:t==Asc.c_oAscContentControlSpecificType.DateTime?c=!0:t!=Asc.c_oAscContentControlSpecificType.None&&t!=Asc.c_oAscContentControlSpecificType.Complex||(o=!!e),this.TextOnlySettings.toggleClass("hidden",!o),this.TextOnlySimpleSettings.toggleClass("hidden",!o||n),this.ListOnlySettings.toggleClass("hidden",!l),this.ImageOnlySettings.toggleClass("hidden",!r),this.RadioOnlySettings.toggleClass("hidden",!a),this.KeySettings.toggleClass("hidden",a||n),s||a);this.PlaceholderSettings.toggleClass("hidden",i),this.CheckOnlySettings.toggleClass("hidden",!i),this.FixedSettings.toggleClass("hidden",r||n),this.NotInComplexSettings.toggleClass("hidden",n),this.DateOnlySettings.toggleClass("hidden",!c),this.DefValueText.toggleClass("hidden",!(t===Asc.c_oAscContentControlSpecificType.ComboBox||o)),this.DefValueDropDown.toggleClass("hidden",t!==Asc.c_oAscContentControlSpecificType.DropDownList)},onSelectItem:function(t,e,i){i&&(this.txtNewValue.setValue(i.get("name")),this._state.listValue=i.get("name"),this._state.listIndex=void 0,this.btnListAdd.setDisabled(this.txtNewValue.length<1||this._state.DisabledControls),this.disableListButtons())},onDisconnect:function(){this.onKeyChanged(this.cmbKey,{value:(this._originalProps||new AscCommon.CContentControlPr).get_NewKey()})},disableListButtons:function(){var t=this.list.getSelectedRec(),t=t?this.list.store.indexOf(t):-1;this.btnListDelete.setDisabled(t<0||this._state.DisabledControls),this.btnListUp.setDisabled(t<1||this._state.DisabledControls),this.btnListDown.setDisabled(t<0||t>this.list.store.length-2||this._state.DisabledControls)},onImagePositionChange:function(t,e,i,n){var o=50*i/100-1;"x"===t?(this.imagePositionPreview.css({left:o+"px"}),this._state.imgPositionX=i):(this.imagePositionPreview.css({top:o+"px"}),this._state.imgPositionY=i),p.isUndefined(this._state.imgPositionX)?this._state.imgPositionX=50:p.isUndefined(this._state.imgPositionY)&&(this._state.imgPositionY=50),this.imagePositionLabel.text(Math.round(this._state.imgPositionX)+","+Math.round(this._state.imgPositionY))},onImagePositionChangeComplete:function(t,e,i,n){"x"===t?this._state.imgPositionX=i:this._state.imgPositionY=i,this.imgPositionApplyFunc(t)},imgPositionApplyFunc:function(t){var e,i,n;this.api&&!this._noApply&&(e=this._originalProps||new AscCommon.CContentControlPr,i=this._originalPictProps||new AscCommon.CSdtPictureFormPr,"x"===t?(n=this._state.imgPositionX/100,i.put_ShiftX(n)):(n=this._state.imgPositionY/100,i.put_ShiftY(n)),e.put_PictureFormPr(i),this.api.asc_SetContentControlProperties(e,this.internalId),this.fireEvent("editcomplete",this))},onRefreshRolesList:function(t){var e,i,n;this._initSettings?this.roles=t:(t||(e=this.api.asc_GetOForm())&&(t=e.asc_getAllRoles()),e=(e=this.cmbRoles.getSelectedRecord())?e.value:"",i=[],n=this,t&&t.forEach(function(t){var t=t.asc_getSettings(),e=t.asc_getColor();i.push({displayValue:t.asc_getName()||n.textAnyone,value:t.asc_getName(),color:e?"#"+Common.Utils.ThemeColor.getHexColor(e.get_r(),e.get_g(),e.get_b()):"transparent"})}),this.cmbRoles.setData(i),this.cmbRoles.setValue(e))},onRolesChanged:function(t,e){var i,n;this.api&&!this._noApply&&(this._state.Role=void 0,i=this._originalProps||new AscCommon.CContentControlPr,(n=this._originalFormProps||new AscCommon.CSdtFormPr).put_Role(e.value),i.put_FormPr(n),this.api.asc_SetContentControlProperties(i,this.internalId),Common.Utils.InternalSettings.set("de-last-form-role",e.value),this.fireEvent("editcomplete",this))},updateDateFormats:function(t){if(this._originalDateProps){for(var e=this._originalDateProps,i=e.get_FormatsExamples(),n=[],o=0,s=i.length;o<s;o++)n.push({value:i[o],displayValue:e.get_String(i[o],void 0,t)});this.cmbDateFormat.setData(n),this.cmbDateFormat.setValue(n[0].value),this.api&&!this._noApply&&this.onDateFormatChanged()}},onDateFormatChanged:function(t,e){var i,n;this.api&&!this._noApply?(i=this._originalProps||new AscCommon.CContentControlPr,(n=this._originalDateProps||new AscCommon.CSdtDatePickerPr).put_DateFormat(this.cmbDateFormat.getValue()),n.put_LangId(this.cmbLang.getValue()),i.put_DateTimePr(n),i.put_PlaceholderText(n.get_String()),this.api.asc_SetContentControlProperties(i,this.internalId)):this.cmbDateFormat.setValue(this._state.DateFormat||""),this.fireEvent("editcomplete",this)}},DE.Views.FormSettings||{}))}),40),MENU_SCALE_PART=260,Common,Common,Common,Common,Common,Common,Common,Common,Common,Common,Common,Common,Common,Common,Common,Common,Common,Common,Common,Common,Common,Common,Common,Common,Common,Common,Common,Common,Common,Common,Common,Common,Common,Common,Common,Common,Common,reqerr;define("documenteditor/main/app/view/RightMenu",["text!documenteditor/main/app/template/RightMenu.template","jquery","underscore","backbone","common/main/lib/component/Button","common/main/lib/component/MetricSpinner","common/main/lib/component/CheckBox","documenteditor/main/app/view/ParagraphSettings","documenteditor/main/app/view/HeaderFooterSettings","documenteditor/main/app/view/ImageSettings","documenteditor/main/app/view/ChartSettings","documenteditor/main/app/view/TableSettings","documenteditor/main/app/view/ShapeSettings","documenteditor/main/app/view/MailMergeSettings","documenteditor/main/app/view/TextArtSettings","documenteditor/main/app/view/SignatureSettings","documenteditor/main/app/view/FormSettings","common/main/lib/component/Scroller"],function(t,o,s,e){"use strict";DE.Views.RightMenu=e.View.extend(s.extend({el:"#right-menu",template:s.template(t),events:{},initialize:function(){return this.minimizedMode=!0,this.btnText=new Common.UI.Button({hint:this.txtParagraphSettings,asctype:Common.Utils.documentSettingsType.Paragraph,enableToggle:!0,disabled:!0,iconCls:"btn-paragraph",toggleGroup:"tabpanelbtnsGroup",allowMouseEventsOnDisabled:!0}),this.btnTable=new Common.UI.Button({hint:this.txtTableSettings,asctype:Common.Utils.documentSettingsType.Table,enableToggle:!0,disabled:!0,iconCls:"btn-menu-table",toggleGroup:"tabpanelbtnsGroup",allowMouseEventsOnDisabled:!0}),this.btnImage=new Common.UI.Button({hint:this.txtImageSettings,asctype:Common.Utils.documentSettingsType.Image,enableToggle:!0,disabled:!0,iconCls:"btn-menu-image",toggleGroup:"tabpanelbtnsGroup",allowMouseEventsOnDisabled:!0}),this.btnHeaderFooter=new Common.UI.Button({hint:this.txtHeaderFooterSettings,asctype:Common.Utils.documentSettingsType.Header,enableToggle:!0,disabled:!0,iconCls:"btn-menu-header",toggleGroup:"tabpanelbtnsGroup",allowMouseEventsOnDisabled:!0}),this.btnChart=new Common.UI.Button({hint:this.txtChartSettings,asctype:Common.Utils.documentSettingsType.Chart,enableToggle:!0,disabled:!0,iconCls:"btn-menu-chart",toggleGroup:"tabpanelbtnsGroup",allowMouseEventsOnDisabled:!0}),this.btnShape=new Common.UI.Button({hint:this.txtShapeSettings,asctype:Common.Utils.documentSettingsType.Shape,enableToggle:!0,disabled:!0,iconCls:"btn-menu-shape",toggleGroup:"tabpanelbtnsGroup",allowMouseEventsOnDisabled:!0}),this.btnTextArt=new Common.UI.Button({hint:this.txtTextArtSettings,asctype:Common.Utils.documentSettingsType.TextArt,enableToggle:!0,disabled:!0,iconCls:"btn-menu-textart",toggleGroup:"tabpanelbtnsGroup",allowMouseEventsOnDisabled:!0}),this._settings=[],this._settings[Common.Utils.documentSettingsType.Paragraph]={panel:"id-paragraph-settings",btn:this.btnText},this._settings[Common.Utils.documentSettingsType.Table]={panel:"id-table-settings",btn:this.btnTable},this._settings[Common.Utils.documentSettingsType.Image]={panel:"id-image-settings",btn:this.btnImage},this._settings[Common.Utils.documentSettingsType.Header]={panel:"id-header-settings",btn:this.btnHeaderFooter},this._settings[Common.Utils.documentSettingsType.Shape]={panel:"id-shape-settings",btn:this.btnShape},this._settings[Common.Utils.documentSettingsType.Chart]={panel:"id-chart-settings",btn:this.btnChart},this._settings[Common.Utils.documentSettingsType.TextArt]={panel:"id-textart-settings",btn:this.btnTextArt},this},render:function(t){this.trigger("render:before",this),this.defaultHideRightMenu=t.customization&&!!t.customization.hideRightMenu;var e=!Common.localStorage.getBool("de-hide-right-settings",this.defaultHideRightMenu),i=(Common.Utils.InternalSettings.set("de-hide-right-settings",!e),this.$el.css("width",(e?MENU_SCALE_PART:SCALE_MIN)+"px"),this.$el.show(),o(this.template({})));return this.$el.html(i),this.btnText.setElement(i.findById("#id-right-menu-text"),!1),this.btnText.render(),this.btnTable.setElement(i.findById("#id-right-menu-table"),!1),this.btnTable.render(),this.btnImage.setElement(i.findById("#id-right-menu-image"),!1),this.btnImage.render(),this.btnHeaderFooter.setElement(i.findById("#id-right-menu-header"),!1),this.btnHeaderFooter.render(),this.btnChart.setElement(i.findById("#id-right-menu-chart"),!1),this.btnChart.render(),this.btnShape.setElement(i.findById("#id-right-menu-shape"),!1),this.btnShape.render(),this.btnTextArt.setElement(i.findById("#id-right-menu-textart"),!1),this.btnTextArt.render(),this.btnText.on("click",this.onBtnMenuClick.bind(this)),this.btnTable.on("click",this.onBtnMenuClick.bind(this)),this.btnImage.on("click",this.onBtnMenuClick.bind(this)),this.btnHeaderFooter.on("click",this.onBtnMenuClick.bind(this)),this.btnChart.on("click",this.onBtnMenuClick.bind(this)),this.btnShape.on("click",this.onBtnMenuClick.bind(this)),this.btnTextArt.on("click",this.onBtnMenuClick.bind(this)),this.paragraphSettings=new DE.Views.ParagraphSettings,this.headerSettings=new DE.Views.HeaderFooterSettings,this.imageSettings=new DE.Views.ImageSettings,this.chartSettings=new DE.Views.ChartSettings,this.tableSettings=new DE.Views.TableSettings,this.shapeSettings=new DE.Views.ShapeSettings,this.textartSettings=new DE.Views.TextArtSettings,t&&t.canCoAuthoring&&t.canUseMailMerge&&(this.btnMailMerge=new Common.UI.Button({hint:this.txtMailMergeSettings,asctype:Common.Utils.documentSettingsType.MailMerge,enableToggle:!0,disabled:!0,iconCls:"btn-mailmerge",toggleGroup:"tabpanelbtnsGroup",allowMouseEventsOnDisabled:!0}),this._settings[Common.Utils.documentSettingsType.MailMerge]={panel:"id-mail-merge-settings",btn:this.btnMailMerge},this.btnMailMerge.setElement(i.findById("#id-right-menu-mail-merge"),!1),this.btnMailMerge.render().setVisible(!0),this.btnMailMerge.on("click",this.onBtnMenuClick.bind(this)),this.mergeSettings=new DE.Views.MailMergeSettings),t&&t.isSignatureSupport&&(this.btnSignature=new Common.UI.Button({hint:this.txtSignatureSettings,asctype:Common.Utils.documentSettingsType.Signature,enableToggle:!0,disabled:!0,iconCls:"btn-menu-signature",toggleGroup:"tabpanelbtnsGroup",allowMouseEventsOnDisabled:!0}),this._settings[Common.Utils.documentSettingsType.Signature]={panel:"id-signature-settings",btn:this.btnSignature},this.btnSignature.setElement(i.findById("#id-right-menu-signature"),!1),this.btnSignature.render().setVisible(!0),this.btnSignature.on("click",this.onBtnMenuClick.bind(this)),this.signatureSettings=new DE.Views.SignatureSettings),t&&t.canFeatureContentControl&&t.canEditContentControl&&t.isFormCreator&&(this.btnForm=new Common.UI.Button({hint:this.txtFormSettings,asctype:Common.Utils.documentSettingsType.Form,enableToggle:!0,disabled:!0,iconCls:"btn-field",toggleGroup:"tabpanelbtnsGroup",allowMouseEventsOnDisabled:!0}),this._settings[Common.Utils.documentSettingsType.Form]={panel:"id-form-settings",btn:this.btnForm},this.btnForm.setElement(i.findById("#id-right-menu-form"),!1),this.btnForm.render().setVisible(!0),this.btnForm.on("click",this.onBtnMenuClick.bind(this)),this.formSettings=new DE.Views.FormSettings),s.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:o(this.el).find(".right-panel"),suppressScrollX:!0,useKeyboard:!1})),e&&(i.findById("#id-paragraph-settings").parent().css("display","inline-block"),i.findById("#id-paragraph-settings").addClass("active")),this.trigger("render:after",this),this},setApi:function(t){function e(){n.fireEvent("editcomplete",n)}function i(t){this._isEyedropperStart=t}var n=this;n.api=t;this.paragraphSettings.setApi(t).on("editcomplete",e).on("eyedropper",s.bind(i,this)),this.headerSettings.setApi(t).on("editcomplete",e),this.imageSettings.setApi(t).on("editcomplete",e),this.chartSettings.setApi(t).on("editcomplete",e),this.tableSettings.setApi(t).on("editcomplete",e).on("eyedropper",s.bind(i,this)),this.shapeSettings.setApi(t).on("editcomplete",e).on("eyedropper",s.bind(i,this)),this.textartSettings.setApi(t).on("editcomplete",e).on("eyedropper",s.bind(i,this)),this.mergeSettings&&this.mergeSettings.setApi(t).on("editcomplete",e),this.signatureSettings&&this.signatureSettings.setApi(t).on("editcomplete",e),this.formSettings&&this.formSettings.setApi(t).on("editcomplete",e)},setMode:function(t){this.mergeSettings&&this.mergeSettings.setMode(t),this.imageSettings&&this.imageSettings.setMode(t),this.shapeSettings&&this.shapeSettings.setMode(t),this.formSettings&&this.formSettings.setMode(t)},onBtnMenuClick:function(t,e){var i=o("#"+this._settings[t.options.asctype].panel),n=i.parent();t.pressed?(this.minimizedMode&&(o(this.el).width(MENU_SCALE_PART),n.css("display","inline-block"),this.minimizedMode=!1,Common.localStorage.setItem("de-hide-right-settings",0),Common.Utils.InternalSettings.set("de-hide-right-settings",!1)),n.find("> .active").removeClass("active"),i.addClass("active"),this.scroller&&this.scroller.scrollTop(0)):(n.css("display","none"),o(this.el).width(SCALE_MIN),this.minimizedMode=!0,Common.localStorage.setItem("de-hide-right-settings",1),Common.Utils.InternalSettings.set("de-hide-right-settings",!0)),this.fireEvent("rightmenuclick",[this,t.options.asctype,this.minimizedMode,e])},SetActivePane:function(t,e){this.minimizedMode&&!0!==e||void 0===this._settings[t]||(this.minimizedMode?(this._settings[t].btn.toggle(!0,!1),this._settings[t].btn.trigger("click",this._settings[t].btn)):((e=this.$el.find("#"+this._settings[t].panel)).hasClass("active")||(e.parent().find("> .active").removeClass("active"),e.addClass("active"),this.scroller&&(this.scroller.update(),this.scroller.scrollTop(0))),this._settings[t].btn.isActive()||this._settings[t].btn.toggle(!0,!1)))},GetActivePane:function(){return this.minimizedMode?null:this.$el.find(".settings-panel.active")[0].id},clearSelection:function(){this.mergeSettings&&this.mergeSettings.disablePreviewMode();var t=o(".right-panel");t.find("> .active").removeClass("active"),this._settings.forEach(function(t){t.btn.isActive()&&t.btn.toggle(!1,!0)}),t.css("display","none"),o(this.el).width(SCALE_MIN),this.minimizedMode=!0,Common.NotificationCenter.trigger("layout:changed","rightmenu")},updateScroller:function(){this.scroller&&(this.scroller.update(),this.scroller.scrollTop(0))}},DE.Views.RightMenu||{}))}),define("documenteditor/main/app/controller/RightMenu",["core","documenteditor/main/app/view/RightMenu"],function(){"use strict";DE.Controllers.RightMenu=Backbone.Controller.extend({models:[],collections:[],views:["RightMenu"],initialize:function(){this.editMode=!0,this._initSettings=!0,this._state={docProtection:{isReadOnly:!1,isReviewOnly:!1,isFormsOnly:!1,isCommentsOnly:!1}},this.addListeners({RightMenu:{rightmenuclick:this.onRightMenuClick},ViewTab:{"rightmenu:hide":_.bind(this.onRightMenuHide,this)}}),Common.Utils.InternalSettings.set("de-rightpanel-active-form",1)},onLaunch:function(){this.rightmenu=this.createView("RightMenu"),this.rightmenu.on("render:after",_.bind(this.onRightMenuAfterRender,this))},onRightMenuAfterRender:function(t){t.imageSettings.application=t.shapeSettings.application=t.textartSettings.application=this.getApplication(),this._settings=[],this._settings[Common.Utils.documentSettingsType.Paragraph]={panelId:"id-paragraph-settings",panel:t.paragraphSettings,btn:t.btnText,hidden:1,locked:!1},this._settings[Common.Utils.documentSettingsType.Table]={panelId:"id-table-settings",panel:t.tableSettings,btn:t.btnTable,hidden:1,locked:!1},this._settings[Common.Utils.documentSettingsType.Image]={panelId:"id-image-settings",panel:t.imageSettings,btn:t.btnImage,hidden:1,locked:!1},this._settings[Common.Utils.documentSettingsType.Header]={panelId:"id-header-settings",panel:t.headerSettings,btn:t.btnHeaderFooter,hidden:1,locked:!1,needShow:!0},this._settings[Common.Utils.documentSettingsType.Shape]={panelId:"id-shape-settings",panel:t.shapeSettings,btn:t.btnShape,hidden:1,locked:!1},this._settings[Common.Utils.documentSettingsType.TextArt]={panelId:"id-textart-settings",panel:t.textartSettings,btn:t.btnTextArt,hidden:1,locked:!1},this._settings[Common.Utils.documentSettingsType.Chart]={panelId:"id-chart-settings",panel:t.chartSettings,btn:t.btnChart,hidden:1,locked:!1},this._settings[Common.Utils.documentSettingsType.MailMerge]={panelId:"id-mail-merge-settings",panel:t.mergeSettings,btn:t.btnMailMerge,hidden:1,props:{},locked:!1},this._settings[Common.Utils.documentSettingsType.Signature]={panelId:"id-signature-settings",panel:t.signatureSettings,btn:t.btnSignature,hidden:1,props:{},locked:!1},this._settings[Common.Utils.documentSettingsType.Form]={panelId:"id-form-settings",panel:t.formSettings,btn:t.btnForm,hidden:1,props:{},locked:!1}},setApi:function(t){this.api=t,this.api.asc_registerCallback("asc_onUpdateSignatures",_.bind(this.onApiUpdateSignatures,this)),Common.NotificationCenter.on("protect:doclock",_.bind(this.onChangeProtectDocument,this)),this.api.asc_registerCallback("asc_onCoAuthoringDisconnect",_.bind(this.onCoAuthoringDisconnect,this)),Common.NotificationCenter.on("api:disconnect",_.bind(this.onCoAuthoringDisconnect,this))},setMode:function(t){this.editMode=t.isEdit},onRightMenuClick:function(t,e,i,n){var o;!i&&this.editMode?(n&&!this._settings[Common.Utils.documentSettingsType.Form].hidden&&(e==Common.Utils.documentSettingsType.Form?(this._settings[Common.Utils.documentSettingsType.Paragraph].hidden||Common.Utils.InternalSettings.set("de-rightpanel-active-para",0),this._settings[Common.Utils.documentSettingsType.Image].hidden||Common.Utils.InternalSettings.set("de-rightpanel-active-image",0),this._settings[Common.Utils.documentSettingsType.Shape].hidden||Common.Utils.InternalSettings.set("de-rightpanel-active-shape",0)):e==Common.Utils.documentSettingsType.Paragraph?Common.Utils.InternalSettings.set("de-rightpanel-active-para",2):e==Common.Utils.documentSettingsType.Image?(Common.Utils.InternalSettings.set("de-rightpanel-active-image",2),Common.Utils.InternalSettings.set("de-rightpanel-active-shape",0)):e==Common.Utils.documentSettingsType.Shape&&(Common.Utils.InternalSettings.set("de-rightpanel-active-shape",2),Common.Utils.InternalSettings.set("de-rightpanel-active-image",0))),n=this._settings[e].panel,(o=this._settings[e].props)&&n&&(n.ChangeSettings.call(n,e==Common.Utils.documentSettingsType.MailMerge||e==Common.Utils.documentSettingsType.Signature?void 0:o),this.rightmenu.updateScroller())):i&&e==Common.Utils.documentSettingsType.MailMerge&&this.rightmenu.mergeSettings.disablePreviewMode(),Common.NotificationCenter.trigger("layout:changed","rightmenu"),this.rightmenu.fireEvent("editcomplete",this.rightmenu)},onApiFocusObject:function(t){this.onFocusObject(t)},onFocusObject:function(t,e,i){if(this.editMode||e){for(var i=this._initSettings?!Common.localStorage.getBool("de-hide-right-settings",this.rightmenu.defaultHideRightMenu):!!i,n=this._initSettings=!1,o=!1,s=0;s<this._settings.length;s++)s!=Common.Utils.documentSettingsType.MailMerge&&s!=Common.Utils.documentSettingsType.Signature&&this._settings[s]&&(this._settings[s].hidden=1,this._settings[s].locked=!1);this._settings[Common.Utils.documentSettingsType.MailMerge].locked=!1;var a=this._settings[Common.Utils.documentSettingsType.Signature].locked=!1,l=!1,r=!1,c=this._state.docProtection.isReadOnly||this._state.docProtection.isFormsOnly||this._state.docProtection.isCommentsOnly,d=this.api.asc_IsContentControl()?this.api.asc_GetContentControlProperties():null,h=d&&d.get_FormPr(),m=!1;for(s=0;s<t.length;s++){var p,u=!1,g=t[s].get_ObjectType(),b=this.getDocumentSettingsType(g);g===Asc.c_oAscTypeSelectElement.Math&&(o=!0),void 0===b||b>=this._settings.length||void 0===this._settings[b]||(g=t[s].get_ObjectValue(),b==Common.Utils.documentSettingsType.Image?(u=(p=d?d.get_Lock():Asc.c_oAscSdtLockType.Unlocked)==Asc.c_oAscSdtLockType.SdtContentLocked||p==Asc.c_oAscSdtLockType.ContentLocked,null!==g.get_ChartProperties()?(a=!0,b=Common.Utils.documentSettingsType.Chart):null!==g.get_ShapeProperties()&&(l=!0,a=g.get_ShapeProperties().get_FromChart(),r=g.get_ShapeProperties().get_FromSmartArtInternal(),b=Common.Utils.documentSettingsType.Shape,g.get_ShapeProperties().asc_getTextArtProperties()&&(this._settings[Common.Utils.documentSettingsType.TextArt].props=g,this._settings[Common.Utils.documentSettingsType.TextArt].hidden=0,this._settings[Common.Utils.documentSettingsType.TextArt].locked=g.get_Locked()||u||c)),m=m||g.get_Locked()):b!=Common.Utils.documentSettingsType.Paragraph||h&&h.get_Fixed()||(this._settings[b].panel.isChart=a,this._settings[b].panel.isSmartArtInternal=r,n=g.get_CanAddTable(),m=m||g.get_Locked()),this._settings[b].props=g,this._settings[b].hidden=0,this._settings[b].locked=g.get_Locked()||u||c,this._settings[Common.Utils.documentSettingsType.MailMerge].locked||(this._settings[Common.Utils.documentSettingsType.MailMerge].locked=g.get_Locked()||c),this._settings[Common.Utils.documentSettingsType.Signature].locked||(this._settings[Common.Utils.documentSettingsType.Signature].locked=g.get_Locked()))}if(h&&h.get_Fixed()&&(this._settings[Common.Utils.documentSettingsType.Paragraph].hidden=1),h&&this.rightmenu.formSettings&&((v=d.get_SpecificType())!=Asc.c_oAscContentControlSpecificType.CheckBox&&v!=Asc.c_oAscContentControlSpecificType.Picture&&v!=Asc.c_oAscContentControlSpecificType.Complex&&v!=Asc.c_oAscContentControlSpecificType.ComboBox&&v!=Asc.c_oAscContentControlSpecificType.DropDownList&&v!=Asc.c_oAscContentControlSpecificType.None&&v!=Asc.c_oAscContentControlSpecificType.DateTime||(b=Common.Utils.documentSettingsType.Form,this._settings[b].props=d,this._settings[b].locked=m||c,this._settings[b].hidden=0,h.get_Fixed()&&(this._settings[Common.Utils.documentSettingsType.TextArt].hidden=1))),this._settings[Common.Utils.documentSettingsType.Header].locked)for(s=0;s<this._settings.length;s++)this._settings[s]&&(this._settings[s].locked=!0);this._settings[Common.Utils.documentSettingsType.MailMerge].locked||(this._settings[Common.Utils.documentSettingsType.MailMerge].locked=!n||o);var C,f,v,_,w,y,x=-1,S=-1,T=this.rightmenu.GetActivePane();for(s=0;s<this._settings.length;s++){var A=this._settings[s];void 0!==A&&void 0!==A.btn&&void 0!==A.panel&&(A.hidden?(A.btn.isDisabled()||A.btn.setDisabled(!0),T==A.panelId&&(C=-1)):(A.btn.isDisabled()&&A.btn.setDisabled(!1),s!=Common.Utils.documentSettingsType.MailMerge&&s!=Common.Utils.documentSettingsType.Signature&&(x=s),A.needShow?(A.needShow=!1,S=s):T==A.panelId&&(C=s),A.panel.setLocked(A.locked)))}if(this._settings[Common.Utils.documentSettingsType.MailMerge].hidden||this._settings[Common.Utils.documentSettingsType.MailMerge].panel.setLocked(this._settings[Common.Utils.documentSettingsType.MailMerge].locked),this._settings[Common.Utils.documentSettingsType.Signature].hidden||this._settings[Common.Utils.documentSettingsType.Signature].panel.setProtected(c),!this.rightmenu.minimizedMode||i)if(S<0&&!(this._settings[Common.Utils.documentSettingsType.Form].hidden||this._settings[Common.Utils.documentSettingsType.Paragraph].hidden&&this._settings[Common.Utils.documentSettingsType.Image].hidden&&this._settings[Common.Utils.documentSettingsType.Shape].hidden)&&(v=Common.Utils.InternalSettings.get("de-rightpanel-active-image")||0,_=Common.Utils.InternalSettings.get("de-rightpanel-active-shape")||0,w=Common.Utils.InternalSettings.get("de-rightpanel-active-para")||0,y=Common.Utils.InternalSettings.get("de-rightpanel-active-form")||0,this._settings[Common.Utils.documentSettingsType.Paragraph].hidden?this._settings[Common.Utils.documentSettingsType.Paragraph].Image&&this._settings[Common.Utils.documentSettingsType.Shape].hidden||(S=_<y&&v<y?Common.Utils.documentSettingsType.Form:y<_&&v<_?Common.Utils.documentSettingsType.Shape:Common.Utils.documentSettingsType.Image):S=w<y?Common.Utils.documentSettingsType.Form:Common.Utils.documentSettingsType.Paragraph),-1<S?f=S:0<=x&&C<0?f=x:0<=C?f=C:e&&!this._settings[Common.Utils.documentSettingsType.Signature].hidden?f=Common.Utils.documentSettingsType.Signature:this._settings[Common.Utils.documentSettingsType.MailMerge].hidden||(f=Common.Utils.documentSettingsType.MailMerge),void 0!==(f=null==f&&i&&0<=x?x:f))this.rightmenu.SetActivePane(f,i),f===Common.Utils.documentSettingsType.Form?this._settings[f].panel.ChangeSettings.call(this._settings[f].panel,this._settings[f].props,l):f!=Common.Utils.documentSettingsType.MailMerge&&f!=Common.Utils.documentSettingsType.Signature?this._settings[f].panel.ChangeSettings.call(this._settings[f].panel,this._settings[f].props):this._settings[f].panel.ChangeSettings.call(this._settings[f].panel);else if(T)for(s=0;s<this._settings.length;s++)if(this._settings[s]&&this._settings[s].panelId===T){this._settings[s].locked=!0,this._settings[s].panel.setLocked(!0),this._settings[s].panel.disableControls(!0);break}this._settings[Common.Utils.documentSettingsType.Image].needShow=!1,this._settings[Common.Utils.documentSettingsType.Chart].needShow=!1}},onCoAuthoringDisconnect:function(){this.SetDisabled(!0,!1)},onInsertTable:function(){this._settings[Common.Utils.documentSettingsType.Table].needShow=!0},onInsertImage:function(){this._settings[Common.Utils.documentSettingsType.Image].needShow=!0},onInsertChart:function(){this._settings[Common.Utils.documentSettingsType.Chart].needShow=!0},onInsertShape:function(){this._settings[Common.Utils.documentSettingsType.Shape].needShow=!0},onInsertTextArt:function(){this._settings[Common.Utils.documentSettingsType.TextArt].needShow=!0},onInsertControl:function(){this._settings[Common.Utils.documentSettingsType.Form]&&(this._settings[Common.Utils.documentSettingsType.Form].needShow=!0)},UpdateThemeColors:function(){this.rightmenu.paragraphSettings.UpdateThemeColors(),this.rightmenu.tableSettings.UpdateThemeColors(),this.rightmenu.shapeSettings.UpdateThemeColors(),this.rightmenu.textartSettings.UpdateThemeColors(),this.rightmenu.formSettings&&this.rightmenu.formSettings.UpdateThemeColors()},updateMetricUnit:function(){this.rightmenu.headerSettings.updateMetricUnit(),this.rightmenu.paragraphSettings.updateMetricUnit(),this.rightmenu.chartSettings.updateMetricUnit(),this.rightmenu.imageSettings.updateMetricUnit(),this.rightmenu.tableSettings.updateMetricUnit(),this.rightmenu.formSettings&&this.rightmenu.formSettings.updateMetricUnit()},createDelayedElements:function(){var t;this.api&&(this.api.asc_registerCallback("asc_onFocusObject",_.bind(this.onApiFocusObject,this)),this.api.asc_registerCallback("asc_doubleClickOnObject",_.bind(this.onDoubleClickOnObject,this)),this.rightmenu.mergeSettings&&(this.rightmenu.mergeSettings.setDocumentName(this.getApplication().getController("Viewport").getView("Common.Views.Header").getDocumentCaption()),this.api.asc_registerCallback("asc_onStartMailMerge",_.bind(this.onStartMailMerge,this))),this.api.asc_registerCallback("asc_onError",_.bind(this.onError,this))),this.editMode&&this.api&&(0<(t=this.api.getSelectedElements()).length&&this.onFocusObject(t)),this.onChangeProtectDocument()},onDoubleClickOnObject:function(t){var e;this.editMode&&(e=t.get_ObjectType(),void 0===(e=this.getDocumentSettingsType(e))||e>=this._settings.length||void 0===this._settings[e]||(t=t.get_ObjectValue(),e==Common.Utils.documentSettingsType.Image&&(null!==t.get_ChartProperties()?e=Common.Utils.documentSettingsType.Chart:null!==t.get_ShapeProperties()&&(e=Common.Utils.documentSettingsType.Shape)),e!==Common.Utils.documentSettingsType.Paragraph&&(this.rightmenu.SetActivePane(e,!0),this._settings[e].panel.ChangeSettings.call(this._settings[e].panel,this._settings[e].props))))},onStartMailMerge:function(){var t=Common.Utils.documentSettingsType.MailMerge;this._settings[t].hidden=0,this._settings[t].btn.setDisabled(!1),this.rightmenu.SetActivePane(t,!0),this._settings[t].panel.setLocked(this._settings[t].locked),this._settings[t].panel.ChangeSettings.call(this._settings[t].panel)},onError:function(t,e,i){t==Asc.c_oAscError.ID.MailMergeLoadFile&&(this._settings[Common.Utils.documentSettingsType.MailMerge].hidden=1,this._settings[Common.Utils.documentSettingsType.MailMerge].btn.setDisabled(!0),0<(t=this.api.getSelectedElements()).length&&this.onFocusObject(t))},onApiUpdateSignatures:function(t,e){this.rightmenu.signatureSettings&&(t=(!t||t.length<1)&&(!e||e.length<1),e=Common.Utils.documentSettingsType.Signature,this._settings[e].hidden=t?1:0,this._settings[e].btn.setDisabled(t),this._settings[e].panel.setLocked(this._settings[e].locked),this._settings[e].panel.setProtected(!!this._state.docProtection&&(this._state.docProtection.isReadOnly||this._state.docProtection.isFormsOnly||this._state.docProtection.isCommentsOnly)))},SetDisabled:function(t,e,i){this.setMode({isEdit:!t}),this.rightmenu&&this.rightmenu.paragraphSettings&&(this.rightmenu.paragraphSettings.disableControls(t),this.rightmenu.shapeSettings.disableControls(t),this.rightmenu.textartSettings.disableControls(t),this.rightmenu.headerSettings.disableControls(t),this.rightmenu.tableSettings.disableControls(t),this.rightmenu.imageSettings.disableControls(t),this.rightmenu.formSettings&&this.rightmenu.formSettings.disableControls(t),!e&&this.rightmenu.mergeSettings&&(this.rightmenu.mergeSettings.disableControls(t),t&&this.rightmenu.btnMailMerge.setDisabled(t)),this.rightmenu.chartSettings.disableControls(t),this.rightmenu.signatureSettings&&(i||this.rightmenu.btnSignature.setDisabled(t),i&&t&&this.onFocusObject([],!0)),t?(this.rightmenu.btnText.setDisabled(t),this.rightmenu.btnTable.setDisabled(t),this.rightmenu.btnImage.setDisabled(t),this.rightmenu.btnHeaderFooter.setDisabled(t),this.rightmenu.btnShape.setDisabled(t),this.rightmenu.btnTextArt.setDisabled(t),this.rightmenu.btnChart.setDisabled(t),this.rightmenu.btnForm&&this.rightmenu.btnForm.setDisabled(t)):0<(e=this.api.getSelectedElements()).length&&this.onFocusObject(e,!1,!Common.Utils.InternalSettings.get("de-hide-right-settings")&&!Common.Utils.InternalSettings.get("de-hidden-rightmenu")))},getDocumentSettingsType:function(t){switch(t){case Asc.c_oAscTypeSelectElement.Paragraph:return Common.Utils.documentSettingsType.Paragraph;case Asc.c_oAscTypeSelectElement.Table:return Common.Utils.documentSettingsType.Table;case Asc.c_oAscTypeSelectElement.Image:return Common.Utils.documentSettingsType.Image;case Asc.c_oAscTypeSelectElement.Header:return Common.Utils.documentSettingsType.Header}},onChangeProtectDocument:function(t){var e;(t=t?t:(e=this.getApplication().getController("DocProtection"))?e.getDocProps():null)&&(this._state.docProtection=t,this.api&&0<(e=this.api.getSelectedElements()).length&&this.onFocusObject(e))},onRightMenuHide:function(t,e){this.rightmenu&&(e||this.rightmenu.clearSelection(),e?this.rightmenu.show():this.rightmenu.hide(),Common.localStorage.setBool("de-hidden-rightmenu",!e),Common.Utils.InternalSettings.set("de-hidden-rightmenu",!e),e?0<(e=this.api.getSelectedElements()).length&&this.onFocusObject(e,!1,!Common.Utils.InternalSettings.get("de-hide-right-settings")):this.rightmenu.signatureSettings&&this.rightmenu.signatureSettings.hideSignatureTooltip()),Common.NotificationCenter.trigger("layout:changed","main"),Common.NotificationCenter.trigger("edit:complete",this.rightmenu)}})}),!function(e){for(var r,c,d={},h={16:!1,18:!1,17:!1,91:!1},i="all",m={"⇧":16,shift:16,"⌥":18,alt:18,option:18,"⌃":17,ctrl:17,control:17,"⌘":91,command:91},n={backspace:8,tab:9,clear:12,enter:13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,home:36,end:35,pageup:33,pagedown:34,",":188,".":190,"/":191,"`":192,"-":189,"=":187,";":186,"'":222,"[":219,"]":221,"\\":220,"ff-":173,"ff=":61,numplus:107,numminus:109,0:48},p=function(t){return n[t]||t.toUpperCase().charCodeAt(0)},u=[],g=1;g<20;g++)n["f"+g]=111+g;function b(t,e){for(var i=t.length;i--;)if(t[i]===e)return i;return-1}function C(t,e){if(t.length==e.length){for(var i=0;i<t.length;i++)if(t[i]!==e[i])return;return 1}}var f={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey"};function o(t){var e,i,n,o,s,a=t.keyCode;if(Common.UI.HintManager&&Common.UI.HintManager.isHintVisible())if(112===a)Common.UI.HintManager.clearHints();else if(27!==a)return;if(-1==b(u,a)&&u.push(a),(a=93!=a&&224!=a?a:91)in h)for(i in h[a]=!0,m)m[i]==a&&(v[i]=!0);else{var l=t;for(g in h)h[g]=l[f[g]];if(v.filter.call(this,t)&&a in d)for(s=_(),n=0;n<d[a].length;n++)if((e=d[a][n]).scope==s||"all"==e.scope){for(i in o=0<e.mods.length,h)(!h[i]&&-1<b(e.mods,+i)||h[i]&&-1==b(e.mods,+i))&&(o=!1);(0!=e.mods.length||h[16]||h[18]||h[17]||h[91])&&!o||!0!==r&&!e.locked&&!1!==e.method(t,e)||!0===r&&c||e.locked&&e.propagate||(t.preventDefault?t.preventDefault():t.returnValue=!1,t.stopPropagation&&t.stopPropagation(),t.cancelBubble&&(t.cancelBubble=!0))}}}function v(t,e,i){var n,o=w(t);void 0===i&&(i=e,e="all");for(var s=0;s<o.length;s++)n=[],1<(t=o[s].split("+")).length&&(n=y(t),t=[t[t.length-1]]),t=t[0],(t=p(t))in d||(d[t]=[]),d[t].push({shortcut:o[s],scope:e,method:i,key:o[s],mods:n})}for(g in m)v[g]=!1;function _(){return i||"all"}function w(t){return""==(t=(t=t.replace(/\s/g,"")).split(","))[t.length-1]&&(t[t.length-2]+=","),t}function y(t){for(var e=t.slice(0,t.length-1),i=0;i<e.length;i++)e[i]=m[e[i]];return e}function t(t,e,i){t.addEventListener?t.addEventListener(e,i,!1):t.attachEvent&&t.attachEvent("on"+e,function(){i(window.event)})}t(document,"keydown",function(t){o(t)}),t(document,"keyup",function(t){var e,i=t.keyCode;if(0<=(t=b(u,i))&&u.splice(t,1),(i=93!=i&&224!=i?i:91)in h)for(e in h[i]=!1,m)m[e]==i&&(v[e]=!1)}),t(window,"focus",function(){for(g in h)h[g]=!1;for(g in m)v[g]=!1});var s=e.key;function a(t,e,i,n){for(var o,s,a,l=[],r=w(t),c=r.length;c--;)if(1<(o=r[c].split("+")).length&&(l=y(o)),0<o.length&&(t=o[o.length-1]),t=p(t),void 0===e&&(e=_()),d[t])for(s in d[t])(a=d[t][s]).scope===e&&C(a.mods,l)&&(d[t][s][i]=n)}e.key=v,e.key.setScope=function(t){i=t||"all"},e.key.getScope=_,e.key.deleteScope=function(t){var e,i,n;for(e in d)for(i=d[e],n=0;n<i.length;)i[n].scope===t?i.splice(n,1):n++},e.key.filter=function(t){return!("INPUT"==(t=(t.target||t.srcElement).tagName)||"SELECT"==t||"TEXTAREA"==t)},e.key.isPressed=function(t){return"string"==typeof t&&(t=p(t)),-1!=b(u,t)},e.key.getPressedKeyCodes=function(){return u.slice(0)},e.key.noConflict=function(){var t=e.key;return e.key=s,t},e.key.unbind=function(t,e){for(var i,n,o,s=[],a=w(t),l=0;l<a.length;l++){if(1<(i=a[l].split("+")).length&&(s=y(i)),0<i.length&&(t=i[i.length-1]),t=p(t),void 0===e&&(e=_()),!d[t])return;for(n in d[t])(o=d[t][n]).scope===e&&C(o.mods,s)&&(d[t][n]={})}},e.key.suspend=function(t,e,i){t?(a(t,e,"locked",!0),i&&a(t,e,"propagate",!0)):(r=!0,i&&(c=!0))},e.key.resume=function(t,e){t?(a(t,e,"locked",!1),a(t,e,"propagate",!1)):r=c=!1},"undefined"!=typeof module&&(module.exports=key)}(this),define("keymaster",function(){}),void 0===Common&&(Common={}),Common.util=Common.util||{},define("common/main/lib/util/Shortcuts",["backbone","keymaster"],function(t){"use strict";function e(t){return this.cid=_.uniqueId("shortcuts"),this.initialize.apply(this,arguments),this}_.extend(e.prototype,t.Events,{initialize:function(){window.key.filter=function(t){return!0},Common.NotificationCenter.on({"modal:show":function(t){window.key.suspend()},"modal:close":function(t,e){e&&window.key.resume()},"modal:hide":function(t,e){e&&window.key.resume()}})},delegateShortcuts:function(t){if(t&&t.shortcuts){this.removeShortcuts(t);var e,i,n,o,s=[];for(n in t.shortcuts){if(i=t.shortcuts[n],_.isFunction(i))e=i;else if(!(e=t[i]))throw new Error("Method "+i+" does not exist");o=(i=n.match(/^(\S+)\s*(.*)$/))[1],i=i[2].length?i[2]:"all",e=_.bind(e,this),s.push(window.key(o,i,e))}}},removeShortcuts:function(t){if(t&&t.shortcuts){var e,i,n;for(i in t.shortcuts)n=(e=i.match(/^(\S+)\s*(.*)$/))[1],e=e[2].length?e[2]:"all",window.key.unbind(n,e)}},suspendEvents:function(t,e,i){window.key.suspend(t,e,i)},resumeEvents:function(t,e){window.key.resume(t,e)}}),e.extend=t.View.extend,Common.util.Shortcuts=new e}),define("documenteditor/main/app/view/ViewTab",["common/main/lib/util/utils","common/main/lib/component/BaseView","common/main/lib/component/Layout"],function(){"use strict";DE.Views.ViewTab=Common.UI.BaseView.extend(_.extend({options:{},setEvents:function(){var i=this;i.btnNavigation.on("click",function(t,e){i.fireEvent("viewtab:navigation",[t.pressed])}),i.btnFitToPage.on("click",function(){i.fireEvent("zoom:topage")}),i.btnFitToWidth.on("click",function(){i.fireEvent("zoom:towidth")}),i.chToolbar.on("change",_.bind(function(t,e){i.fireEvent("toolbar:setcompact",[i.chToolbar,"checked"!==e])},i)),i.chStatusbar.on("change",_.bind(function(t,e){i.fireEvent("statusbar:hide",[i.chStatusbar,"checked"!==e])},i)),i.chRulers.on("change",_.bind(function(t,e){i.fireEvent("rulers:change",[i.chRulers,"checked"===e])},i)),i.chLeftMenu.on("change",_.bind(function(t,e){i.fireEvent("leftmenu:hide",[i.chLeftMenu,"checked"===e])},i)),i.chRightMenu.on("change",_.bind(function(t,e){i.fireEvent("rightmenu:hide",[i.chRightMenu,"checked"===e])},i)),i.btnDarkDocument.on("click",_.bind(function(){i.fireEvent("darkmode:change")},i)),i.cmbZoom.on("combo:focusin",_.bind(this.onComboOpen,this,!1)),i.cmbZoom.on("show:after",_.bind(this.onComboOpen,this,!0))},initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this),this.toolbar=t.toolbar,this.appConfig=t.mode,this.lockedControls=[];var e=Common.enumLock;this.btnNavigation=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-big-menu-navigation",lock:[e.lostConnect,e.disableOnStart],caption:this.textOutline,enableToggle:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.lockedControls.push(this.btnNavigation),this.cmbZoom=new Common.UI.ComboBox({cls:"input-group-nr",lock:[e.lostConnect,e.disableOnStart],menuStyle:"min-width: 55px;",editable:!0,data:[{displayValue:"50%",value:50},{displayValue:"75%",value:75},{displayValue:"100%",value:100},{displayValue:"125%",value:125},{displayValue:"150%",value:150},{displayValue:"175%",value:175},{displayValue:"200%",value:200},{displayValue:"300%",value:300},{displayValue:"400%",value:400},{displayValue:"500%",value:500}],dataHint:"1",dataHintDirection:"top",dataHintOffset:"small"}),this.cmbZoom.setValue(100),this.lockedControls.push(this.cmbZoom),this.btnFitToPage=new Common.UI.Button({cls:"btn-toolbar",iconCls:"toolbar__icon btn-ic-zoomtopage",lock:[e.lostConnect,e.disableOnStart],caption:this.textFitToPage,toggleGroup:"view-zoom",enableToggle:!0,dataHint:"1",dataHintDirection:"left",dataHintOffset:"medium"}),this.lockedControls.push(this.btnFitToPage),this.btnFitToWidth=new Common.UI.Button({cls:"btn-toolbar",iconCls:"toolbar__icon btn-ic-zoomtowidth",lock:[e.lostConnect,e.disableOnStart],caption:this.textFitToWidth,toggleGroup:"view-zoom",enableToggle:!0,dataHint:"1",dataHintDirection:"left",dataHintOffset:"medium"}),this.lockedControls.push(this.btnFitToWidth),this.btnInterfaceTheme=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-day",lock:[e.lostConnect,e.disableOnStart],caption:this.textInterfaceTheme,menu:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.lockedControls.push(this.btnInterfaceTheme),this.btnDarkDocument=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-dark-mode",lock:[e.inLightTheme,e.lostConnect,e.disableOnStart],caption:this.textDarkDocument,enableToggle:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.lockedControls.push(this.btnDarkDocument),this.chStatusbar=new Common.UI.CheckBox({lock:[e.lostConnect,e.disableOnStart],labelText:this.textStatusBar,value:!Common.localStorage.getBool("de-hidden-status"),dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.lockedControls.push(this.chStatusbar),this.chToolbar=new Common.UI.CheckBox({lock:[e.lostConnect,e.disableOnStart],labelText:this.textAlwaysShowToolbar,value:!t.compactToolbar,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.lockedControls.push(this.chToolbar),this.chRightMenu=new Common.UI.CheckBox({lock:[e.lostConnect,e.disableOnStart],labelText:this.textRightMenu,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.lockedControls.push(this.chRightMenu),this.chLeftMenu=new Common.UI.CheckBox({lock:[e.lostConnect,e.disableOnStart],labelText:this.textLeftMenu,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.lockedControls.push(this.chLeftMenu),this.chRulers=new Common.UI.CheckBox({lock:[e.lostConnect,e.disableOnStart],labelText:this.textRulers,value:!Common.Utils.InternalSettings.get("de-hidden-rulers"),dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.lockedControls.push(this.chRulers),Common.Utils.lockControls(e.disableOnStart,!0,{array:this.lockedControls}),Common.NotificationCenter.on("app:ready",this.onAppReady.bind(this))},render:function(t){return t&&t.html(this.getPanel()),this},getPanel:function(){this.$el=$(_.template('<section class="panel" data-tab="view"><div class="group" data-layout-name="toolbar-view-navigation"><span class="btn-slot text x-huge" id="slot-btn-navigation"></span></div><div class="separator long" data-layout-name="toolbar-view-navigation"></div><div class="group small"><div class="elset" style="display: flex;"><span class="btn-slot" id="slot-field-zoom" style="flex-grow: 1;"></span></div><div class="elset" style="text-align: center;"><span class="btn-slot text font-size-normal" id="slot-lbl-zoom" style="text-align: center;margin-top: 4px;"></span></div></div><div class="group small"><div class="elset"><span class="btn-slot text" id="slot-btn-ftp" style="text-align: center;"></span></div><div class="elset"><span class="btn-slot text" id="slot-btn-ftw" style="text-align: center;"></span></div></div><div class="separator long"></div><div class="group"><span class="btn-slot text x-huge" id="slot-btn-interface-theme"></span><span class="btn-slot text x-huge" id="slot-btn-dark-document"></span></div><div class="separator long separator-theme"></div><div class="group small"><div class="elset"><span class="btn-slot text" id="slot-chk-toolbar"></span></div><div class="elset"><span class="btn-slot text" id="slot-chk-statusbar"></span></div></div><div class="group small"><div class="elset"><span class="btn-slot text" id="slot-chk-leftmenu"></span></div><div class="elset"><span class="btn-slot text" id="slot-chk-rightmenu"></span></div></div><div class="separator long separator-rulers"></div><div class="group small"><div class="elset"><span class="btn-slot text" id="slot-chk-rulers"></span></div><div class="elset"></div></div></section>')({}));var t=this.$el;return this.btnNavigation.render(t.find("#slot-btn-navigation")),this.cmbZoom.render(t.find("#slot-field-zoom")),t.find("#slot-lbl-zoom").text(this.textZoom),this.btnFitToPage.render(t.find("#slot-btn-ftp")),this.btnFitToWidth.render(t.find("#slot-btn-ftw")),this.btnInterfaceTheme.render(t.find("#slot-btn-interface-theme")),this.btnDarkDocument.render(t.find("#slot-btn-dark-document")),this.chStatusbar.render(t.find("#slot-chk-statusbar")),this.chToolbar.render(t.find("#slot-chk-toolbar")),this.chRulers.render(t.find("#slot-chk-rulers")),this.chLeftMenu.render(t.find("#slot-chk-leftmenu")),this.chRightMenu.render(t.find("#slot-chk-rightmenu")),this.$el},onAppReady:function(){this.btnNavigation.updateHint(this.tipHeadings),this.btnFitToPage.updateHint(this.tipFitToPage),this.btnFitToWidth.updateHint(this.tipFitToWidth),this.btnInterfaceTheme.updateHint(this.tipInterfaceTheme),this.btnDarkDocument.updateHint(this.tipDarkDocument);var t=Common.UI.LayoutManager.getInitValue("leftMenu");this.chLeftMenu.setValue(!Common.localStorage.getBool("de-hidden-leftmenu",void 0!==t&&!t)),t=Common.UI.LayoutManager.getInitValue("rightMenu"),this.chRightMenu.setValue(!Common.localStorage.getBool("de-hidden-rightmenu",void 0!==t&&!t))},show:function(){Common.UI.BaseView.prototype.show.call(this),this.fireEvent("show",this)},getButtons:function(t){return void 0===t?this.lockedControls:[]},SetDisabled:function(e){this.lockedControls&&this.lockedControls.forEach(function(t){t&&t.setDisabled(e)},this)},turnNavigation:function(t){this.btnNavigation&&this.btnNavigation.toggle(t,!0)},onComboOpen:function(e,i,t,n){n&&n.fromKeyDown||_.delay(function(){var t=$("input",i.cmpEl).select();e?t.focus():i.isMenuOpen()||t.one("mouseup",function(t){t.preventDefault()})},10)}},DE.Views.ViewTab||{}))}),define("documenteditor/main/app/controller/LeftMenu",["core","common/main/lib/util/Shortcuts","common/main/lib/view/SaveAsDlg","documenteditor/main/app/view/LeftMenu","documenteditor/main/app/view/FileMenu","documenteditor/main/app/view/ViewTab"],function(){"use strict";DE.Controllers.LeftMenu=Backbone.Controller.extend(_.extend({views:["LeftMenu","FileMenu","ViewTab"],initialize:function(){this.addListeners({"Common.Views.Chat":{hide:_.bind(this.onHideChat,this)},"Common.Views.Header":{"history:show":function(){this.leftMenu.panelHistory.isVisible()||this.clickMenuFileItem("header","history")}.bind(this),rename:_.bind(function(t){this.mode&&this.mode.wopi&&this.api?this.api.asc_wopi_renameFile(t):Common.Gateway.requestRename(t)},this)},"Common.Views.About":{show:_.bind(this.aboutShowHide,this,!1),hide:_.bind(this.aboutShowHide,this,!0)},"Common.Views.Plugins":{"plugin:open":_.bind(this.onPluginOpen,this),hide:_.bind(this.onHidePlugins,this)},LeftMenu:{"comments:show":_.bind(this.commentsShowHide,this,"show"),"comments:hide":_.bind(this.commentsShowHide,this,"hide")},FileMenu:{"menu:hide":_.bind(this.menuFilesShowHide,this,"hide"),"menu:show":_.bind(this.menuFilesShowHide,this,"show"),"item:click":_.bind(this.clickMenuFileItem,this),"saveas:format":_.bind(this.clickSaveAsFormat,this),"settings:apply":_.bind(this.applySettings,this),"create:new":_.bind(this.onCreateNew,this),"recent:open":_.bind(this.onOpenRecent,this)},Toolbar:{"file:settings":_.bind(this.clickToolbarSettings,this),"file:open":this.clickToolbarTab.bind(this,"file"),"file:close":this.clickToolbarTab.bind(this,"other"),"save:disabled":this.changeToolbarSaveState.bind(this)},"Common.Views.ReviewChanges":{"collaboration:chat":_.bind(this.onShowHideChat,this)},ViewTab:{"viewtab:navigation":_.bind(this.onShowHideNavigation,this),"leftmenu:hide":_.bind(this.onLeftMenuHide,this)},SearchBar:{"search:show":_.bind(this.onShowHideSearch,this)}}),Common.NotificationCenter.on("leftmenu:change",_.bind(this.onMenuChange,this)),Common.NotificationCenter.on("app:comment:add",_.bind(this.onAppAddComment,this)),Common.NotificationCenter.on("collaboration:history",_.bind(function(){this.leftMenu.panelHistory.isVisible()||this.clickMenuFileItem(null,"history")},this)),Common.NotificationCenter.on("protect:doclock",_.bind(this.onChangeProtectDocument,this)),Common.NotificationCenter.on("file:print",_.bind(this.clickToolbarPrint,this))},onLaunch:function(){this.leftMenu=this.createView("LeftMenu").render(),this.leftMenu.btnSearchBar.on("toggle",_.bind(this.onMenuSearchBar,this)),this._state={disableEditing:!1,docProtection:{isReadOnly:!1,isReviewOnly:!1,isFormsOnly:!1,isCommentsOnly:!1}};var t={"command+shift+s,ctrl+shift+s":_.bind(this.onShortcut,this,"save"),"command+f,ctrl+f":_.bind(this.onShortcut,this,"search"),"ctrl+h":_.bind(this.onShortcut,this,"replace"),esc:_.bind(this.onShortcut,this,"escape"),"command+shift+h,ctrl+shift+h":_.bind(this.onShortcut,this,"comments"),f1:_.bind(this.onShortcut,this,"help")};t[Common.Utils.isMac?"ctrl+alt+f":"alt+f"]=_.bind(this.onShortcut,this,"file"),t[Common.Utils.isMac?"ctrl+alt+q":"alt+q"]=_.bind(this.onShortcut,this,"chat"),Common.util.Shortcuts.delegateShortcuts({shortcuts:t}),Common.util.Shortcuts.suspendEvents()},setApi:function(t){if(this.api=t,this.api.asc_registerCallback("asc_onCoAuthoringDisconnect",_.bind(this.onApiServerDisconnect,this)),Common.NotificationCenter.on("api:disconnect",_.bind(this.onApiServerDisconnect,this)),this.api.asc_registerCallback("asc_onDownloadUrl",_.bind(this.onDownloadUrl,this)),this.mode.canCoAuthoring&&(this.mode.canChat&&this.api.asc_registerCallback("asc_onCoAuthoringChatReceiveMessage",_.bind(this.onApiChatMessage,this)),this.mode.canComments)){this.api.asc_registerCallback("asc_onAddComment",_.bind(this.onApiAddComment,this)),this.api.asc_registerCallback("asc_onAddComments",_.bind(this.onApiAddComments,this));for(var e=this.getApplication().getCollection("Common.Collections.Comments"),i=Common.Utils.InternalSettings.get("de-settings-resolvedcomment"),n=0;n<e.length;++n){var o=e.at(n);if(!o.get("hide")&&o.get("userid")!==this.mode.user.id&&(i||!o.get("resolved"))){this.leftMenu.markCoauthOptions("comments",!0);break}}}return this.leftMenu.getMenu("file").setApi(t),this.mode.canUseHistory&&this.getApplication().getController("Common.Controllers.History").setApi(this.api).setMode(this.mode),this.getApplication().getController("PageThumbnails").setApi(this.api).setMode(this.mode),this.getApplication().getController("Search").setApi(this.api).setMode(this.mode),this.leftMenu.setOptionsPanel("advancedsearch",this.getApplication().getController("Search").getView("Common.Views.SearchPanel")),this},setMode:function(t){return this.mode=t,this.leftMenu.setMode(t),this.leftMenu.getMenu("file").setMode(t),t.isEdit||Common.util.Shortcuts.removeShortcuts({shortcuts:{"command+shift+s,ctrl+shift+s":_.bind(this.onShortcut,this,"save"),"alt+f":_.bind(this.onShortcut,this,"file"),"ctrl+alt+f":_.bind(this.onShortcut,this,"file")}}),this},createDelayedElements:function(){return this.mode.canCoAuthoring?(this.leftMenu.btnComments[this.mode.canViewComments&&!this.mode.isLightVersion?"show":"hide"](),this.mode.canViewComments&&this.leftMenu.setOptionsPanel("comment",this.getApplication().getController("Common.Controllers.Comments").getView()),this.leftMenu.btnChat[this.mode.canChat&&!this.mode.isLightVersion?"show":"hide"](),this.mode.canChat&&this.leftMenu.setOptionsPanel("chat",this.getApplication().getController("Common.Controllers.Chat").getView("Common.Views.Chat"))):(this.leftMenu.btnChat.hide(),this.leftMenu.btnComments.hide()),this.mode.canUseHistory&&this.leftMenu.setOptionsPanel("history",this.getApplication().getController("Common.Controllers.History").getView("Common.Views.History")),this.leftMenu.setOptionsPanel("navigation",this.getApplication().getController("Navigation").getView("Navigation")),this.mode.canUseThumbnails?this.leftMenu.setOptionsPanel("thumbnails",this.getApplication().getController("PageThumbnails").getView("PageThumbnails")):this.leftMenu.btnThumbnails.hide(),(this.mode.trialMode||this.mode.isBeta)&&this.leftMenu.setDeveloperMode(this.mode.trialMode,this.mode.isBeta,this.mode.buildVersion),this.onChangeProtectDocument(),Common.util.Shortcuts.resumeEvents(),this},enablePlugins:function(){this.mode.canPlugins?this.leftMenu.setOptionsPanel("plugins",this.getApplication().getController("Common.Controllers.Plugins").getView("Common.Views.Plugins")):this.leftMenu.btnPlugins.hide(),(this.mode.trialMode||this.mode.isBeta)&&this.leftMenu.setDeveloperMode(this.mode.trialMode,this.mode.isBeta,this.mode.buildVersion)},clickMenuFileItem:function(t,e,i){var n=!0;switch(e){case"back":break;case"save":this.api.asc_Save();break;case"save-desktop":this.api.asc_DownloadAs();break;case"saveas":i?n=!1:this.clickSaveAsFormat();break;case"save-copy":i?n=!1:this.clickSaveAsFormat(void 0,void 0,!0);break;case"print":this.api.asc_Print(new Asc.asc_CDownloadOptions(null,Common.Utils.isChrome||Common.Utils.isOpera||Common.Utils.isGecko&&86<Common.Utils.firefoxVersion));break;case"exit":Common.NotificationCenter.trigger("goback");break;case"edit":this.getApplication().getController("Statusbar").setStatusCaption(this.requestEditRightsText),Common.Gateway.requestEditRights();break;case"new":i?n=!1:this.onCreateNew(void 0,"blank");break;case"file:open":i?n=!1:this.onOpenFile(void 0,"blank");break;case"set-default":i?n=!1:this.onSetDefault();break;case"feedback":i?n=!1:this.onFeedback();break;case"uninstall":i?n=!1:this.onUnInstall();break;case"toggle-online":i?n=!1:this.onToggleOnline();break;case"download-online":i?n=!1:this.onDownloadOnline();break;case"history":this.leftMenu.panelHistory.isVisible()||(this.api.isDocumentModified()?((o=this).api.asc_stopSaving(),Common.UI.warning({closable:!1,width:500,title:this.notcriticalErrorTitle,msg:this.leavePageText,buttons:["ok","cancel"],primary:"ok",callback:function(t){"ok"==t?(o.api.asc_undoAllChanges(),o.api.asc_continueSaving(),o.showHistory()):o.api.asc_continueSaving()}})):this.showHistory());break;case"rename":var o,s=(o=this).api.asc_getDocumentName();new Common.Views.RenameDialog({filename:s,maxLength:this.mode.wopi?this.mode.wopi.FileNameMaxLength:void 0,handler:function(t,e){"ok"!=t||_.isEmpty(e.trim())||s===e.trim()||(o.mode.wopi?o.api.asc_wopi_renameFile(e):Common.Gateway.requestRename(e)),Common.NotificationCenter.trigger("edit:complete",o)}}).show();break;case"external-help":n=!!i;break;default:n=!1}n&&t&&t.hide()},_saveAsFormat:function(i,e,n,t){var o,s=!!n;i?((o=new Asc.asc_CDownloadOptions(e,s)).asc_setTextParams(t),e==Asc.c_oAscFileType.TXT||e==Asc.c_oAscFileType.RTF?Common.UI.warning({title:this.notcriticalErrorTitle,msg:e==Asc.c_oAscFileType.TXT?this.warnDownloadAs:this.warnDownloadAsRTF,buttons:["ok","cancel"],callback:_.bind(function(t){"ok"==t&&(this.isFromFileDownloadAs=n,e==Asc.c_oAscFileType.TXT?Common.NotificationCenter.trigger("download:advanced",Asc.c_oAscAdvancedOptionsID.TXT,this.api.asc_getAdvancedOptions(),2,o):this.api.asc_DownloadAs(o),i.hide())},this)}):e==Asc.c_oAscFileType.DOCX||e==Asc.c_oAscFileType.DOCM||e==Asc.c_oAscFileType.DOTX?Common.Utils.InternalSettings.get("de-settings-compatible")||Common.localStorage.getBool("de-hide-save-compatible")||!this.api.asc_isCompatibilityMode()?(this.isFromFileDownloadAs=n,o.asc_setCompatible(!!Common.Utils.InternalSettings.get("de-settings-compatible")),this.api.asc_DownloadAs(o),i.hide()):Common.UI.warning({closable:!1,width:600,title:this.notcriticalErrorTitle,msg:this.txtCompatible,buttons:["ok","cancel"],dontshow:!0,callback:_.bind(function(t,e){e&&Common.localStorage.setItem("de-hide-save-compatible",1),"ok"==t&&(this.isFromFileDownloadAs=n,o.asc_setCompatible(!1),this.api.asc_DownloadAs(o),i.hide())},this)}):(this.isFromFileDownloadAs=n,this.api.asc_DownloadAs(o),i.hide())):(this.isFromFileDownloadAs=s,this.api.asc_DownloadOrigin(s))},clickSaveAsFormat:function(e,i,n){var o=this,t=this.getApplication().getController("Main").document.fileType;/^pdf|xps|oxps|djvu$/.test(t)?void 0===i?(this._saveAsFormat(void 0,i,n),e&&e.hide()):i==Asc.c_oAscFileType.PDF||i==Asc.c_oAscFileType.PDFA||i==Asc.c_oAscFileType.JPG||i==Asc.c_oAscFileType.PNG?this._saveAsFormat(e,i,n):i==Asc.c_oAscFileType.TXT||i==Asc.c_oAscFileType.RTF?o._saveAsFormat(e,i,n,new AscCommon.asc_CTextParams(Asc.c_oAscTextAssociation.PlainLine)):Common.UI.warning({width:600,title:this.notcriticalErrorTitle,msg:Common.Utils.String.format(this.warnDownloadAsPdf,t.toUpperCase()),buttons:["ok","cancel"],callback:_.bind(function(t){"ok"==t&&o._saveAsFormat(e,i,n,new AscCommon.asc_CTextParams(Asc.c_oAscTextAssociation.PlainLine))},this)}):this._saveAsFormat(e,i,n)},onDownloadUrl:function(t,e){var i,n,o;this.isFromFileDownloadAs&&(o=(o=(i=this).getApplication().getController("Viewport").getView("Common.Views.Header").getDocumentCaption())||i.txtUntitled,"string"==typeof this.isFromFileDownloadAs&&0<(n=o.lastIndexOf("."))&&(o=o.substring(0,n)+this.isFromFileDownloadAs),i.mode.canRequestSaveAs?Common.Gateway.requestSaveAs(t,o,e):(i._saveCopyDlg=new Common.Views.SaveAsDlg({saveFolderUrl:i.mode.saveAsUrl,saveFileUrl:t,defFileName:o}),i._saveCopyDlg.on("saveaserror",function(t,e){e={closable:!1,title:i.notcriticalErrorTitle,msg:e,iconCls:"warn",buttons:["ok"],callback:function(t){Common.NotificationCenter.trigger("edit:complete",i)}};Common.UI.alert(e)}).on("close",function(t){i._saveCopyDlg=void 0}),i._saveCopyDlg.show())),this.isFromFileDownloadAs=!1},applySettings:function(t){var e=Common.Utils.InternalSettings.get("de-settings-coauthmode");if(this.mode.isEdit&&!this.mode.isOffline&&this.mode.canCoAuthoring){switch(this.mode.canChangeCoAuthoring&&(e=Common.localStorage.getBool("de-settings-coauthmode",!0),Common.Utils.InternalSettings.set("de-settings-coauthmode",e),this.api.asc_SetFastCollaborative(e)),i=Common.localStorage.getItem(e?"de-settings-showchanges-fast":"de-settings-showchanges-strict"),Common.Utils.InternalSettings.set(e?"de-settings-showchanges-fast":"de-settings-showchanges-strict",i),i){case"all":i=Asc.c_oAscCollaborativeMarksShowType.All;break;case"none":i=Asc.c_oAscCollaborativeMarksShowType.None;break;case"last":i=Asc.c_oAscCollaborativeMarksShowType.LastChanges;break;default:i=e?Asc.c_oAscCollaborativeMarksShowType.None:Asc.c_oAscCollaborativeMarksShowType.LastChanges}this.api.SetCollaborativeMarksShowType(i)}else this.mode.canLiveView&&!this.mode.isOffline&&this.mode.canChangeCoAuthoring&&(e=Common.localStorage.getBool("de-settings-view-coauthmode",!1),Common.Utils.InternalSettings.set("de-settings-coauthmode",e),this.api.asc_SetFastCollaborative(e));i=Common.localStorage.getBool("de-settings-livecomment",!0),Common.Utils.InternalSettings.set("de-settings-livecomment",i);var i,n=Common.localStorage.getBool("de-settings-resolvedcomment");switch(Common.Utils.InternalSettings.set("de-settings-resolvedcomment",n),(i=this.mode.canViewComments&&this.leftMenu.panelComments&&this.leftMenu.panelComments.isVisible()?n=!0:i)?this.api.asc_showComments(n):this.api.asc_hideComments(),this.getApplication().getController("Common.Controllers.ReviewChanges").commentsShowHide(i?"show":"hide"),i=Common.localStorage.getBool("de-settings-cachemode",!0),Common.Utils.InternalSettings.set("de-settings-cachemode",i),this.api.asc_setDefaultBlitMode(i),i=Common.localStorage.getItem("de-settings-fontrender"),Common.Utils.InternalSettings.set("de-settings-fontrender",i),i){case"1":this.api.SetFontRenderingMode(1);break;case"2":this.api.SetFontRenderingMode(2);break;case"0":this.api.SetFontRenderingMode(3)}this.mode.isEdit&&(!this.mode.canChangeCoAuthoring&&e||(i=parseInt(Common.localStorage.getItem("de-settings-autosave")),Common.Utils.InternalSettings.set("de-settings-autosave",i),this.api.asc_setAutoSaveGap(i)),Common.UI.FeaturesManager.canChange("spellcheck")&&(i=Common.localStorage.getBool("de-settings-spellcheck",!0),Common.Utils.InternalSettings.set("de-settings-spellcheck",i),this.api.asc_setSpellCheck(i),n=new AscCommon.CSpellCheckSettings,i=Common.localStorage.getBool("de-spellcheck-ignore-uppercase-words",!0),Common.Utils.InternalSettings.set("de-spellcheck-ignore-uppercase-words",i),n.put_IgnoreWordsInUppercase(i),i=Common.localStorage.getBool("de-spellcheck-ignore-numbers-words",!0),Common.Utils.InternalSettings.set("de-spellcheck-ignore-numbers-words",i),n.put_IgnoreWordsWithNumbers(i),this.api.asc_setSpellCheckSettings(n)),i=parseInt(Common.localStorage.getItem("de-settings-paste-button")),Common.Utils.InternalSettings.set("de-settings-paste-button",i),this.api.asc_setVisiblePasteButton(!!i),i=Common.localStorage.getBool("de-settings-smart-selection"),Common.Utils.InternalSettings.set("de-settings-smart-selection",i),this.api.asc_putSmartParagraphSelection(i)),this.api.put_ShowSnapLines(Common.Utils.InternalSettings.get("de-settings-showsnaplines")),t.hide()},onCreateNew:function(t,e){Common.Gateway.requestCreateNew({type:e})},onOpenFile:function(t){Common.Gateway._postMessage({event:"onRequestOpenFile",data:{type:"word"}})},onSetDefault:function(){Common.Gateway._postMessage({event:"onRequestSetDefault",data:{type:"word"}})},onFeedback:function(){Common.Gateway._postMessage({event:"onRequestFeedback",data:{type:"word"}})},onUnInstall:function(){Common.Gateway._postMessage({event:"onRequestUnInstall",data:{type:"word"}})},onToggleOnline:function(){Common.Gateway._postMessage({event:"onRequestToggleOnline",data:{type:"word"}})},onDownloadOnline:function(){Common.Gateway._postMessage({event:"onRequestDownloadOnline",data:{type:"word"}})},onOpenRecent:function(t,e){t&&t.hide();t=window.open(e);t&&t.focus(),Common.component.Analytics.trackEvent("Open Recent")},clickToolbarSettings:function(t){this.leftMenu.showMenu("file:opts")},clickToolbarTab:function(t,e){"file"==t?this.leftMenu.showMenu("file"):this.leftMenu.menuFile.hide()},clickToolbarPrint:function(){this.mode.canPreviewPrint?this.leftMenu.showMenu("file:printpreview"):this.mode.canPrint&&this.clickMenuFileItem(null,"print")},changeToolbarSaveState:function(t){var e=this.leftMenu.menuFile.getButton("save");e&&e.setDisabled(t)},onHideChat:function(){$(this.leftMenu.btnChat.el).blur(),Common.NotificationCenter.trigger("layout:changed","leftmenu")},onHidePlugins:function(){Common.NotificationCenter.trigger("layout:changed","leftmenu")},onApiServerDisconnect:function(t){this.mode.isEdit=!1,this.leftMenu.close(),this.leftMenu.btnComments.setDisabled(!0),this.leftMenu.btnChat.setDisabled(!0),this.leftMenu.btnPlugins.setDisabled(!0),this.leftMenu.btnNavigation.setDisabled(!0),this.leftMenu.getMenu("file").setMode({isDisconnected:!0,enableDownload:!!t})},setPreviewMode:function(t){this._state.disableEditing=t,this.updatePreviewMode()},updatePreviewMode:function(){var t=this._state.disableEditing||this._state.docProtection.isReadOnly||this._state.docProtection.isFormsOnly||this._state.docProtection.isCommentsOnly;this.viewmode!==t&&(this.viewmode=t,this.leftMenu.panelSearch&&this.leftMenu.panelSearch.setSearchMode(this.viewmode?"no-replace":"search"))},SetDisabled:function(t,e){this.leftMenu._state.disabled!==t&&((this.leftMenu._state.disabled=t)?(this.previsEdit=this.mode.isEdit,this.prevcanEdit=this.mode.canEdit,this.mode.isEdit=this.mode.canEdit=!t):(this.mode.isEdit=this.previsEdit,this.mode.canEdit=this.prevcanEdit)),t&&this.leftMenu.close(),(!e||e.comments&&e.comments.disable)&&this.leftMenu.btnComments.setDisabled(t),e&&!e.chat||this.leftMenu.btnChat.setDisabled(t),(!e||e.navigation&&e.navigation.disable)&&this.leftMenu.btnNavigation.setDisabled(t),this.leftMenu.btnPlugins.setDisabled(t)},onApiChatMessage:function(){this.leftMenu.markCoauthOptions("chat")},onApiAddComment:function(t,e){var i=Common.Utils.InternalSettings.get("de-settings-resolvedcomment");e&&e.asc_getUserId()!==this.mode.user.id&&(i||!e.asc_getSolved())&&AscCommon.UserInfoParser.canViewComment(e.asc_getUserName())&&this.leftMenu.markCoauthOptions("comments")},onApiAddComments:function(t){for(var e=Common.Utils.InternalSettings.get("de-settings-resolvedcomment"),i=0;i<t.length;++i)if(t[i].asc_getUserId()!==this.mode.user.id&&(e||!t[i].asc_getSolved())&&AscCommon.UserInfoParser.canViewComment(t.asc_getUserName())){this.leftMenu.markCoauthOptions("comments");break}},onAppAddComment:function(t){var e=this;!1===this.api.can_AddQuotedComment()&&new Promise(function(t,e){t()}).then(function(){Common.UI.Menu.Manager.hideAll(),e.leftMenu.showMenu("comments");var t=DE.getController("Common.Controllers.Comments");t.getView().showEditContainer(!0),t.onAfterShow()})},commentsShowHide:function(t){var e=Common.Utils.InternalSettings.get("de-settings-livecomment"),i=Common.Utils.InternalSettings.get("de-settings-resolvedcomment");e&&i||("show"===t?this.api.asc_showComments(!0):e?this.api.asc_showComments(i):this.api.asc_hideComments()),"show"===t&&this.getApplication().getController("Common.Controllers.Comments").onAfterShow(),$(this.leftMenu.btnComments.el).blur()},aboutShowHide:function(t){this.api&&this.api.asc_enableKeyEvents(t),t&&$(this.leftMenu.btnAbout.el).blur(),t&&this.leftMenu._state.pluginIsRunning&&(this.leftMenu.panelPlugins.show(),this.mode.canCoAuthoring&&(this.mode.canViewComments&&this.leftMenu.panelComments.hide(),this.mode.canChat&&this.leftMenu.panelChat.hide()))},menuFilesShowHide:function(t){this.api&&"hide"==t&&this.api.asc_enableKeyEvents(!0)},onMenuChange:function(t){"hide"===t&&this.api&&(this.leftMenu.btnComments.isActive()?(this.leftMenu.btnComments.toggle(!1),this.leftMenu.onBtnMenuClick(this.leftMenu.btnComments),this.api.asc_enableKeyEvents(!0)):this.leftMenu.btnThumbnails.isActive()?(this.leftMenu.btnThumbnails.toggle(!1),this.leftMenu.panelThumbnails.hide(),this.leftMenu.onBtnMenuClick(this.leftMenu.btnThumbnails)):this.leftMenu.btnSearchBar.isActive()?(this.leftMenu.btnSearchBar.toggle(!1),this.leftMenu.onBtnMenuClick(this.leftMenu.btnSearchBar)):this.leftMenu.btnNavigation.isActive()&&(this.leftMenu.btnNavigation.toggle(!1),this.leftMenu.panelNavigation.hide(),this.leftMenu.onBtnMenuClick(this.leftMenu.btnNavigation)))},onShortcut:function(t,e){if(this.mode)switch(t){case"replace":case"search":this.leftMenu.btnAbout.toggle(!1),Common.UI.Menu.Manager.hideAll();var i=this.api.asc_GetSelectedText();if(this.isSearchPanelVisible())i&&this.leftMenu.panelSearch.setFindText(i),this.leftMenu.panelSearch.focus(""!==i?t:"search"),this.leftMenu.fireEvent("search:aftershow",this.leftMenu,i||void 0);else{if(this.getApplication().getController("Viewport").isSearchBarVisible()){var n=this.getApplication().getController("Viewport");if("replace"!==t)return i&&n.searchBar.setText(i),n.searchBar.focus(),!1;n.header.btnSearch.toggle(!1),this.onShowHideSearch(!0,n.searchBar.inputSearch.val())}else{if("search"===t)return Common.NotificationCenter.trigger("search:show"),!1;this.onShowHideSearch(!0,i||void 0)}this.leftMenu.btnSearchBar.toggle(!0,!0),this.leftMenu.panelSearch.focus(i?t:"search")}return!1;case"save":return(this.mode.canDownload||this.mode.canDownloadOrigin)&&(this.mode.isDesktopApp&&this.mode.isOffline?this.api.asc_DownloadAs():this.mode.canDownload?(Common.UI.Menu.Manager.hideAll(),this.leftMenu.showMenu("file:saveas")):this.api.asc_DownloadOrigin()),!1;case"help":return this.mode.isEdit&&this.mode.canHelp&&(Common.UI.Menu.Manager.hideAll(),this.leftMenu.showMenu("file:help")),!1;case"file":return Common.UI.Menu.Manager.hideAll(),this.leftMenu.showMenu("file"),!1;case"escape":n=this.getApplication().getController("Viewport").header.btnSearch;if(n.pressed&&n.toggle(!1),this.leftMenu.menuFile.isVisible())return Common.UI.HintManager.needCloseFileMenu()&&this.leftMenu.menuFile.hide(),!1;i=DE.getController("Statusbar").statusbar.$el.find('.open > [data-toggle="dropdown"]');if(i.length)return $.fn.dropdown.Constructor.prototype.keydown.call(i[0],e),!1;if(this.mode.canPlugins&&this.leftMenu.panelPlugins&&(i=this.leftMenu.panelPlugins.$el.find('#menu-plugin-container.open > [data-toggle="dropdown"]')).length)return $.fn.dropdown.Constructor.prototype.keydown.call(i[0],e),!1;if(this.leftMenu.btnAbout.pressed||this.leftMenu.btnPlugins.pressed||$(e.target).parents("#left-menu").length)return Common.UI.HintManager.isHintVisible()||(this.leftMenu.close(),Common.NotificationCenter.trigger("layout:changed","leftmenu")),!1;break;case"chat":return this.mode.canCoAuthoring&&this.mode.canChat&&!this.mode.isLightVersion&&(Common.UI.Menu.Manager.hideAll(),this.leftMenu.showMenu("chat")),!1;case"comments":return this.mode.canCoAuthoring&&this.mode.canViewComments&&!this.mode.isLightVersion&&(Common.UI.Menu.Manager.hideAll(),this.leftMenu.showMenu("comments"),this.getApplication().getController("Common.Controllers.Comments").onAfterShow()),!1}},onPluginOpen:function(t,e,i){"onboard"==e&&("open"==i?(this.tryToShowLeftMenu(),this.leftMenu.close(),this.leftMenu.panelPlugins.show(),this.leftMenu.onBtnMenuClick({pressed:!0,options:{action:"plugins"}}),this.leftMenu._state.pluginIsRunning=!0):(this.leftMenu._state.pluginIsRunning=!1,this.leftMenu.close()))},showHistory:function(){var t;this.mode.wopi||((t=DE.getController("Main")).loadMask||(t.loadMask=new Common.UI.LoadMask({owner:$("#viewport")})),t.loadMask.setTitle(this.textLoadHistory),t.loadMask.show()),Common.Gateway.requestHistory()},onShowHideChat:function(t){this.mode.canCoAuthoring&&this.mode.canChat&&!this.mode.isLightVersion&&(t?(Common.UI.Menu.Manager.hideAll(),this.tryToShowLeftMenu(),this.leftMenu.showMenu("chat")):(this.leftMenu.btnChat.toggle(!1,!0),this.leftMenu.onBtnMenuClick(this.leftMenu.btnChat)))},onShowHideNavigation:function(t){t?(Common.UI.Menu.Manager.hideAll(),this.tryToShowLeftMenu(),this.leftMenu.showMenu("navigation")):(this.leftMenu.btnNavigation.toggle(!1,!0),this.leftMenu.onBtnMenuClick(this.leftMenu.btnNavigation))},onShowHideSearch:function(t,e){t?(Common.UI.Menu.Manager.hideAll(),this.tryToShowLeftMenu(),this.leftMenu.showMenu("advancedsearch",void 0,!0),this.leftMenu.fireEvent("search:aftershow",this.leftMenu,e)):(this.leftMenu.btnSearchBar.toggle(!1,!0),this.leftMenu.onBtnMenuClick(this.leftMenu.btnSearchBar))},onMenuSearchBar:function(t,e){e&&(e=this.mode.isEdit&&!this.viewmode?void 0:"no-replace",this.leftMenu.panelSearch.setSearchMode(e))},isSearchPanelVisible:function(){return this.leftMenu&&this.leftMenu.panelSearch&&this.leftMenu.panelSearch.isVisible()},isCommentsVisible:function(){return this.leftMenu&&this.leftMenu.panelComments&&this.leftMenu.panelComments.isVisible()},onChangeProtectDocument:function(t){var e;(t=t?t:(e=this.getApplication().getController("DocProtection"))?e.getDocProps():null)&&(this._state.docProtection=t,this.updatePreviewMode())},onLeftMenuHide:function(t,e){this.leftMenu&&(e||this.leftMenu.close(),e?this.leftMenu.show():this.leftMenu.hide(),Common.localStorage.setBool("de-hidden-leftmenu",!e),t||this.leftMenu.fireEvent("view:hide",[this,!e])),Common.NotificationCenter.trigger("layout:changed","main"),Common.NotificationCenter.trigger("edit:complete",this.leftMenu)},tryToShowLeftMenu:function(){this.mode.canBrandingExt&&this.mode.customization&&!1===this.mode.customization.leftMenu||!Common.UI.LayoutManager.isElementVisible("leftMenu")||this.onLeftMenuHide(null,!0)}},DE.Controllers.LeftMenu||{}))}),void 0===Common&&(Common={}),Common.IrregularStack=function(t){function e(t,e){return"object"==typeof t&&"object"==typeof e&&window.JSON?window.JSON.stringify(t)===window.JSON.stringify(e):t===e}function i(t,e){for(var i=n.length-1;0<=i;i--)if(e(n[i],t))return i;return-1}var n=[],o=(t=t||{}).strongCompare||e,s=t.weakCompare||e;return{push:function(t){n.push(t)},pop:function(t){t=i(t,o);if(-1!=t)return n.splice(t,1)[0]},get:function(t){t="object"==typeof t?i(t,s):t;if(-1!=t)return n[t]},exist:function(t){return!(i(t,o)<0)},length:function(){return n.length}}},define("irregularstack",function(){}),void 0===Common&&(Common={}),Common.Controllers=Common.Controllers||{},define("common/main/lib/controller/Fonts",["core","common/main/lib/collection/Fonts"],function(){"use strict";function t(t,e){if(t.showlastused)for(var i,n=t.store,t=e,o=t.get("type")==r,s=-1,a=n.length,l=t.get("name");!o&&++s<a&&(i=n.at(s)).get("type")==r;)o=i.get("name")==l}function e(t){Common.NotificationCenter.trigger("fonts:change",t)}function i(t,e){var i=[];_.each(t,function(t){var e=t.asc_getFontId();i.push({id:_.isEmpty(e)?Common.UI.getId():e,name:t.asc_getFontName(),imgidx:t.asc_getFontThumbnail(),type:t.asc_getFontType()})});const n=window.__fonts_sort;i.sort((t,e)=>n.indexOf(t.name)-n.indexOf(e.name));t=this.getCollection("Common.Collections.Fonts");t&&t.add(i),Common.NotificationCenter.trigger("fonts:load",t,e)}var r;Common.Controllers.Fonts=Backbone.Controller.extend((r=4,{models:["Common.Models.Fonts"],collections:["Common.Collections.Fonts"],views:[],initialize:function(){Common.NotificationCenter.on("fonts:select",_.bind(t,this))},onLaunch:function(){},setApi:function(t){this.api=t,this.api.asc_registerCallback("asc_onInitEditorFonts",_.bind(i,this)),this.api.asc_registerCallback("asc_onFontFamily",_.bind(e,this))}}))}),void 0===Common&&(Common={}),Common.Collections=Common.Collections||{},define("common/main/lib/collection/TextArt",["backbone"],function(t){"use strict";Common.Collections.TextArt=t.Collection.extend({model:t.Model.extend({defaults:function(){return{id:Common.UI.getId(),imageUrl:null,data:null}}})})}),define("common/main/lib/view/OpenDialog",["common/main/lib/component/Window"],function(){"use strict";Common.Views.OpenDialog=Common.UI.Window.extend(_.extend({applyFunction:void 0,initialize:function(t){var e,i,n=this,o={};if(t.preview)e=414,i=t.type==Common.Utils.importTextType.Data?385:277;else switch(e=t.type!==Common.Utils.importTextType.DRM?340:t.warning?420:280,t.type){case Common.Utils.importTextType.CSV:case Common.Utils.importTextType.Paste:case Common.Utils.importTextType.Columns:i=190;break;case Common.Utils.importTextType.Data:i=245;break;default:i=t.warning?187:147}_.extend(o,{closable:!1,preview:t.preview,warning:t.warning,codepages:t.codepages,warningMsg:t.warningMsg,width:e,height:i,header:!0,cls:"open-dlg",contentTemplate:"",toolcallback:_.bind(n.onToolClose,n),closeFile:!1},t),this.txtOpenFile=t.txtOpenFile||this.txtOpenFile,this.template=t.template||['<div class="box" style="height:'+(o.height-85)+'px;">','<div class="content-panel" >',"<% if (type == Common.Utils.importTextType.DRM) { %>","<% if (warning) { %>","<div>",'<div class="icon warn"></div>','<div class="padding-left-50"><div style="font-size: 12px;">'+("string"==typeof o.warningMsg?o.warningMsg:n.txtProtected)+"</div>",'<label class="header" style="margin-top: 15px;">'+n.txtPassword+"</label>",'<div id="id-password-txt" style="width: 290px;"></div></div>',"</div>","<% } else { %>","<div>",'<label class="">'+n.txtOpenFile+"</label>",'<div id="id-password-txt"></div>',"</div>","<% } %>","<% } else { %>","<% if (codepages && codepages.length>0) { %>",'<div <% if (!!preview && (type == Common.Utils.importTextType.CSV || type == Common.Utils.importTextType.Paste || type == Common.Utils.importTextType.Columns)) { %> class="margin-right-10" style="width: 230px;display: inline-block;margin-bottom:15px;" <% } else { %> style="width: 100%;margin-bottom:15px;"<% } %> >','<label class="header">'+n.txtEncoding+"</label>","<div>",'<div id="id-codepages-combo" class="input-group-nr" style="width: 100%; display: inline-block; vertical-align: middle;"></div>',"</div>","</div>","<% } %>","<% if (type == Common.Utils.importTextType.CSV) { %>",'<div style="display: inline-block; margin-bottom:15px;">','<label class="header">'+n.txtDelimiter+"</label>","<div>",'<div id="id-delimiters-combo" class="input-group-nr" style="max-width: 100px;display: inline-block; vertical-align: middle;"></div>','<div id="id-delimiter-other" class="input-row margin-left-10" style="display: inline-block; vertical-align: middle;"></div>',"</div>","</div>","<% } %>","<% if (type == Common.Utils.importTextType.Paste || type == Common.Utils.importTextType.Columns || type == Common.Utils.importTextType.Data) { %>",'<div style="display: inline-block; margin-bottom:15px;width: 100%;">','<label class="header">'+n.txtDelimiter+"</label>","<div>",'<div id="id-delimiters-combo" class="input-group-nr" style="max-width: 100px;display: inline-block; vertical-align: middle;"></div>','<div id="id-delimiter-other" class="input-row margin-left-10" style="display: inline-block; vertical-align: middle;"></div>','<button type="button" class="btn auto btn-text-default float-right" id="id-delimiters-advanced" style="min-width:100px; display: inline-block;">'+n.txtAdvanced+"</button>","</div>","</div>","<% } %>","<% if (!!preview) { %>",'<div style="">','<label class="header">'+n.txtPreview+"</label>",'<div style="position: relative;">','<div style="width: 100%;">','<div id="id-preview">',"<div>",'<div style="position: absolute; top: 0;"><div id="id-preview-data"></div></div>',"</div>","</div>","</div>","</div>","</div>","<% } %>","<% if (type == Common.Utils.importTextType.Data) { %>",'<label class="header" style="margin-top:15px;">'+n.txtDestData+"</label>",'<div id="id-open-data-range" class="input-row" style="width: 100%;"></div>',"<% } %>","<% } %>","</div>","</div>",'<div class="footer center">','<button class="btn normal dlg-btn primary" result="ok">'+n.okButtonText+"</button>","<% if (closeFile) { %>",'<button class="btn normal dlg-btn custom margin-left-10" result="cancel">'+n.closeButtonText+"</button>","<% } %>","<% if (closable) { %>",'<button class="btn normal dlg-btn custom margin-left-10" result="cancel">'+n.cancelButtonText+"</button>","<% } %>","</div>"].join(""),this.handler=o.handler,this.type=o.type,this.preview=o.preview,this.previewData=o.previewData,this.warning=o.warning||!1,this.closable=o.closable,this.codepages=o.codepages,this.settings=o.settings,this.api=o.api,this.validatePwd=o.validatePwd||!1,o.tpl=_.template(this.template)(o),this._previewTdWidth=[],this._previewTdMaxLength=0,Common.UI.Window.prototype.initialize.call(this,o)},render:function(){var e;Common.UI.Window.prototype.render.call(this),this.$window&&((e=this).closable||this.$window.find(".tool").hide(),this.$window.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.previewPanel=this.$window.find("#id-preview-data"),this.previewParent=this.previewPanel.parent(),this.previewScrolled=this.$window.find("#id-preview"),this.previewInner=this.previewScrolled.find("> div:first-child"),this.type==Common.Utils.importTextType.DRM?this.inputPwd=new Common.UI.InputFieldBtnPassword({el:$("#id-password-txt"),type:"password",showCls:("svg"===this.options.iconType?"svg-icon":"toolbar__icon")+" btn-sheet-view",hideCls:"svg"===this.options.iconType?"svg-icon hide-password":"toolbar__icon btn-hide-password",maxLength:this.options.maxPasswordLength,validateOnBlur:!1,showPwdOnClick:!0,validation:function(t){return e.txtIncorrectPwd}}):(this.initCodePages(),this.preview&&(this.previewData?this.previewCallback(this.previewData):this.updatePreview())),this.type==Common.Utils.importTextType.Data&&(this.txtDestRange=new Common.UI.InputFieldBtn({el:$("#id-open-data-range"),name:"range",style:"width: 100%;",btnHint:this.textSelectData,allowBlank:!0,validateOnChange:!0,validateOnBlur:!1}),this.txtDestRange.on("button:click",_.bind(this.onSelectData,this)),this.dataDestValid=this.api.asc_getActiveRangeStr(Asc.referenceType.A,!0),this.txtDestRange.setValue(this.dataDestValid)),this.onPrimary=function(){return e._handleInput("ok"),!1})},getFocusedComponents:function(){var t=[];return this.inputPwd&&t.push(this.inputPwd),this.cmbEncoding&&t.push(this.cmbEncoding),this.cmbDelimiter&&t.push(this.cmbDelimiter),this.inputDelimiter&&t.push(this.inputDelimiter),this.btnAdvanced&&t.push(this.btnAdvanced),this.txtDestRange&&t.push(this.txtDestRange),t},show:function(){Common.UI.Window.prototype.show.apply(this,arguments);var t,e=this;this.type==Common.Utils.importTextType.DRM?setTimeout(function(){e.inputPwd.focus(),e.validatePwd&&e.inputPwd.checkValidate()},500):(t=e.txtDestRange||e.cmbEncoding||e.cmbDelimiter)&&setTimeout(function(){t.focus()},500)},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onToolClose:function(){this._handleInput("cancel")},_handleInput:function(t){if(this.handler)if(this.type==Common.Utils.importTextType.DRM)this.handler.call(this,t,{drmOptions:new Asc.asc_CDRMAdvancedOptions(this.inputPwd.getValue())});else{if(this.type==Common.Utils.importTextType.Data&&"ok"==t&&!this.isRangeValid())return;var e=this.cmbEncoding&&!this.cmbEncoding.isDisabled()?this.cmbEncoding.getValue():this.settings&&this.settings.asc_getCodePage()?this.settings.asc_getCodePage():0,i=this.cmbDelimiter?this.cmbDelimiter.getValue():null,n=-1==i?this.inputDelimiter.getValue():null,o=(-1==i&&(i=null),this.closable||this.type!=Common.Utils.importTextType.TXT||Common.localStorage.setItem("de-settings-open-encoding",e),this.type===Common.Utils.importTextType.CSV&&(Common.localStorage.setItem("sse-settings-csv-delimiter",null===i?-1:i),Common.localStorage.setItem("sse-settings-csv-delimiter-char",n||""),Common.localStorage.setItem("sse-settings-csv-encoding",e)),this.separatorOptions?this.separatorOptions.decimal:void 0),s=this.separatorOptions?this.separatorOptions.thousands:void 0,a=this.separatorOptions?this.separatorOptions.qualifier:'"',e=new Asc.asc_CTextOptions(e,i,n);o&&e.asc_setNumberDecimalSeparator(o),s&&e.asc_setNumberGroupSeparator(s),a&&e.asc_setTextQualifier(a),this.handler.call(this,t,{textOptions:e,range:this.txtDestRange?this.txtDestRange.getValue():"",data:this.data})}this.close()},initCodePages:function(){var t,e,i,n,o=[],s=[],a=0;if(this.codepages){for(o=[],t=0;t<this.codepages.length;++t)i=this.codepages[t],(e=[])[0]=i.asc_getCodePage(),e[1]=i.asc_getCodePageName(),e[2]=i.asc_getLcid(),o.push(e);a=50}if(n=o.length){for(t=0;t<n;++t)s.push({value:o[t][0],displayValue:Common.Utils.String.htmlEncode(o[t][1]),lcid:o[t][2]||""});var l,a=_.template(["<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%= item.value %>"><a tabindex="-1" type="menuitem">','<div style="display: inline-block;"><%= item.displayValue %></div>','<label class="text-align-right" style="width:'+a+'px;"><%= item.lcid %></label>',"</a></li>","<% }); %>"].join("")),a=(this.cmbEncoding=new Common.UI.ComboBox({el:$("#id-codepages-combo",this.$window),style:"width: 100%;",menuStyle:"min-width: 100%; max-height: 200px;",cls:"input-group-nr",menuCls:"scrollable-menu",data:s,editable:!1,disabled:!0,search:!0,itemsTemplate:a,takeFocusOnClose:!0}),this.cmbEncoding.setDisabled(!1),this.settings&&this.settings.asc_getCodePage()?this.settings.asc_getCodePage():o[0][0]),a=(this.closable||this.type!=Common.Utils.importTextType.TXT?this.type===Common.Utils.importTextType.CSV&&(l=Common.localStorage.getItem("sse-settings-csv-encoding"))&&(a=parseInt(l)):(l=Common.localStorage.getItem("de-settings-open-encoding"))&&(a=parseInt(l)),this.cmbEncoding.setValue(a),this.preview&&this.cmbEncoding.on("selected",_.bind(this.onCmbEncodingSelect,this)),this.cmbEncoding.cmpEl.find("ul")),r=a.find("li:nth(0) a"),r=a.width()-parseInt(r.css("padding-left"))-parseInt(r.css("padding-right"))-50;a.find("li div").width(r)}this.type!=Common.Utils.importTextType.CSV&&this.type!=Common.Utils.importTextType.Paste&&this.type!=Common.Utils.importTextType.Columns&&this.type!=Common.Utils.importTextType.Data||(a=this.settings&&this.settings.asc_getDelimiter()?this.settings.asc_getDelimiter():4,r=this.settings&&this.settings.asc_getDelimiterChar()?this.settings.asc_getDelimiterChar():"",this.type==Common.Utils.importTextType.CSV&&(l=Common.localStorage.getItem("sse-settings-csv-delimiter"))&&(l=parseInt(l),isNaN(l)||-1===(a=l)&&(r=Common.localStorage.getItem("sse-settings-csv-delimiter-char")||"")),this.cmbDelimiter=new Common.UI.ComboBox({el:$("#id-delimiters-combo",this.$window),style:"width: 100px;",menuStyle:"min-width: 100px;",cls:"input-group-nr",data:[{value:4,displayValue:this.txtComma},{value:2,displayValue:this.txtSemicolon},{value:3,displayValue:this.txtColon},{value:1,displayValue:this.txtTab},{value:5,displayValue:this.txtSpace},{value:-1,displayValue:this.txtOther}],editable:!1,takeFocusOnClose:!0}),this.cmbDelimiter.setValue(a),this.cmbDelimiter.on("selected",_.bind(this.onCmbDelimiterSelect,this)),this.inputDelimiter=new Common.UI.InputField({el:$("#id-delimiter-other"),style:"width: 30px;",maxLength:1,validateOnChange:!0,validateOnBlur:!1,value:r}),this.inputDelimiter.setVisible(-1===a),this.preview&&this.inputDelimiter.on("changing",_.bind(this.updatePreview,this)),this.type!=Common.Utils.importTextType.Paste&&this.type!=Common.Utils.importTextType.Columns&&this.type!=Common.Utils.importTextType.Data||(this.btnAdvanced=new Common.UI.Button({el:$("#id-delimiters-advanced")}),this.btnAdvanced.on("click",_.bind(this.onAdvancedClick,this))))},updatePreview:function(){this._previewTdWidth=[],this._previewTdMaxLength=0;var t=this.cmbEncoding&&!this.cmbEncoding.isDisabled()?this.cmbEncoding.getValue():this.settings&&this.settings.asc_getCodePage()?this.settings.asc_getCodePage():0,e=this.cmbDelimiter?this.cmbDelimiter.getValue():null,i=-1==e?this.inputDelimiter.getValue():null,n=(-1==e&&(e=null),new Asc.asc_CTextOptions(t,e,i));switch(this.separatorOptions&&(n.asc_setNumberDecimalSeparator(this.separatorOptions.decimal),n.asc_setNumberGroupSeparator(this.separatorOptions.thousands),n.asc_setTextQualifier(this.separatorOptions.qualifier)),this.type){case Common.Utils.importTextType.CSV:case Common.Utils.importTextType.TXT:case Common.Utils.importTextType.Data:this.api.asc_decodeBuffer(this.preview,n,_.bind(this.previewCallback,this));break;case Common.Utils.importTextType.Paste:case Common.Utils.importTextType.Columns:this.api.asc_TextImport(n,_.bind(this.previewCallback,this),this.type==Common.Utils.importTextType.Paste)}},previewCallback:function(t){t&&t.length&&(this.data=t,this.previewInner.height(17*t.length),this.scrollerY||(this.scrollerY=new Common.UI.Scroller({el:this.previewScrolled,minScrollbarLength:20,alwaysVisibleY:!0,alwaysVisibleX:!0,onChange:_.bind(function(){var t,e,i;this.scrollerY&&(t=this.scrollerY.getScrollTop(),(i=(e=Math.floor(t/17+.5))+Math.min(6,this.data.length))>this.data.length&&(i=this.data.length,t=17*(e=this.data.length-6)),this.previewParent.height(108),this.previewParent.css({top:t}),this.previewDataBlock(this.data.slice(e,i)))},this)})),this.scrollerY.update(),this.scrollerY.scrollTop(0))},previewDataBlock:function(t){if(_.isUndefined(this.scrollerX)||(this.scrollerX.destroy(),delete this.scrollerX),this.type==Common.Utils.importTextType.CSV||this.type==Common.Utils.importTextType.Paste||this.type==Common.Utils.importTextType.Columns||this.type==Common.Utils.importTextType.Data){for(var e=0,i=0;i<t.length;i++)(o=t[i]||"").length>e&&(e=o.length);this._previewTdMaxLength=Math.max(this._previewTdMaxLength,e);for(var n="<table>",i=0;i<t.length;i++){var o=t[i]||"";n+='<tr style="vertical-align: top;">';for(var s=0;s<o.length;s++){var a="";n+="<td "+(a=0==i&&this._previewTdWidth[s]?'style="min-width:'+this._previewTdWidth[s]+'px;"':a)+">"+Common.Utils.String.htmlEncode(o[s])+"</td>"}for(s=o.length;s<this._previewTdMaxLength;s++){a="";n+="<td "+(a=0==i&&this._previewTdWidth[s]?'style="min-width:'+this._previewTdWidth[s]+'px;"':a)+"></td>"}n+="</tr>"}}else for(n="<table>",i=0;i<t.length;i++){o=t[i]||"";n+='<tr style="vertical-align: top;"><td>'+Common.Utils.String.htmlEncode(o)+"</td></tr>"}var l;this.previewPanel.html(n+="</table>"),0<t.length&&(0===(l=this)._previewTdWidth.length&&this.previewScrolled.scrollLeft(0),this.previewPanel.find("tr:first td").each(function(t,e){l._previewTdWidth[t]=Math.max(Math.max(Math.ceil($(e).outerWidth()),30),l._previewTdWidth[t]||0)})),this.scrollerX=new Common.UI.Scroller({el:this.previewPanel,suppressScrollY:!0,alwaysVisibleX:!0,minScrollbarLength:20})},onCmbDelimiterSelect:function(t,e){this.inputDelimiter.setVisible(-1==e.value);var i=this;-1==e.value&&setTimeout(function(){i.inputDelimiter.focus()},10),this.preview&&this.updatePreview()},onCmbEncodingSelect:function(t,e){this.updatePreview()},onAdvancedClick:function(){var i,n,o,t;SSE&&(n=(i=this).separatorOptions?this.separatorOptions.decimal:this.api.asc_getDecimalSeparator(),o=this.separatorOptions?this.separatorOptions.thousands:this.api.asc_getGroupSeparator(),t=this.separatorOptions?this.separatorOptions.qualifier:(this.settings||new Asc.asc_CTextOptions).asc_getTextQualifier(),new SSE.Views.AdvancedSeparatorDialog({props:{decimal:n,thousands:o,qualifier:t},handler:function(t,e){"ok"==t&&(i.separatorOptions={decimal:0<e.decimal.length?e.decimal:n,thousands:0<e.thousands.length?e.thousands:o,qualifier:e.qualifier},i.preview&&i.updatePreview())}}).show())},onSelectData:function(t){var e,i,n=this,o=n.txtDestRange;n.api&&(e=new SSE.Views.CellRangeDialog({handler:function(t,e){"ok"==e&&(e=t.getSettings(),n.dataDestValid=e,o.setValue(e),o.checkValidate())}}).on("close",function(){n.show(),_.delay(function(){o.focus()},1)}),i=n.$window.offset(),n.hide(),e.show(i.left+160,i.top+125),e.setSettings({api:n.api,range:_.isEmpty(o.getValue())||1!=o.checkValidate()?n.dataDestValid:o.getValue(),type:Asc.c_oAscSelectionDialogType.Chart}))},isRangeValid:function(){var t=!0,e="";return _.isEmpty(this.txtDestRange.getValue())?(t=!1,e=this.txtEmpty):(t=(t=this.api.asc_checkDataRange(Asc.c_oAscSelectionDialogType.Chart,this.txtDestRange.getValue()))==Asc.c_oAscError.ID.No)||(e=this.textInvalidRange),t||(this.txtDestRange.showError([e]),this.txtDestRange.focus()),t}},Common.Views.OpenDialog||{}))}),define("common/main/lib/view/UserNameDialog",["common/main/lib/component/Window","common/main/lib/component/InputField"],function(){"use strict";Common.Views.UserNameDialog=Common.UI.Window.extend(_.extend({options:{width:330,header:!1,modal:!1,cls:"modal-dlg",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,t||{}),this.template=['<div class="box">','<div style="margin-bottom: 2px;">'+(this.options.label||this.textLabel)+"</div>",'<div id="id-dlg-username-caption" class="input-row"></div>','<div id="id-dlg-username-chk-use" class="" style="margin-top: 10px;"></div>',"</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);this.inputLabel=new Common.UI.InputField({el:$("#id-dlg-username-caption"),allowBlank:!0,style:"width: 100%;",maxLength:128,validateOnBlur:!1,validation:this.options.validation||function(t){return!!t||""}}),this.inputLabel.setValue(this.options.value||""),this.chDontShow=new Common.UI.CheckBox({el:$("#id-dlg-username-chk-use"),labelText:this.textDontShow,value:this.options.check}),this.getChild().find(".dlg-btn").on("click",_.bind(this.onBtnClick,this))},show:function(){Common.UI.Window.prototype.show.apply(this,arguments);var t=this;_.delay(function(){t.getChild("input").focus()},50)},onPrimary:function(t){return this._handleInput("ok"),!1},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},_handleInput:function(t){if(this.options.handler){if("ok"==t&&!0!==this.inputLabel.checkValidate())return void this.inputLabel.cmpEl.find("input").focus();this.options.handler.call(this,t,{input:this.inputLabel.getValue(),checkbox:"checked"==this.chDontShow.getValue()})}this.close()}},Common.Views.UserNameDialog||{}))}),define("documenteditor/main/app/model/ShapeGroup",["backbone"],function(t){"use strict";DE.Models=DE.Models||{},DE.Models.ShapeModel=t.Model.extend({defaults:function(){return{id:Common.UI.getId(),imageUrl:null,data:null}}}),DE.Models.ShapeGroup=t.Model.extend({defaults:function(){return{id:Common.UI.getId(),groupName:null,groupId:null,groupStore:null}}})}),define("documenteditor/main/app/collection/ShapeGroups",["backbone","documenteditor/main/app/model/ShapeGroup"],function(t){"use strict";var e;(e=void 0===e?{}:e).Collections=e.Collections||{},DE.Collections=DE.Collections||{},DE.Collections.ShapeGroups=t.Collection.extend({model:DE.Models.ShapeGroup})}),define("documenteditor/main/app/model/EquationGroup",["backbone"],function(t){"use strict";DE.Models=DE.Models||{},DE.Models.EquationModel=t.Model.extend({defaults:function(){return{id:Common.UI.getId(),data:null,width:0,height:0,posX:0,posY:0}}}),DE.Models.EquationGroup=t.Model.extend({defaults:function(){return{id:Common.UI.getId(),groupName:null,groupId:null,groupStore:null}}})}),define("documenteditor/main/app/collection/EquationGroups",["backbone","documenteditor/main/app/model/EquationGroup"],function(t){"use strict";DE.Collections=DE.Collections||{},DE.Collections.EquationGroups=t.Collection.extend({model:DE.Models.EquationGroup})}),void 0===Common&&(Common={}),void 0===Common.UI&&(Common.UI={}),Common.UI.HintManager=new function(){function r(){S="",0===v&&Common.NotificationCenter.trigger("toolbar:collapse"),(0===x.length||$("#file-menu-panel").is(":visible")&&1===v)&&a(),0<x.length?(s||V(!0),f=!0,x.forEach(function(t){t.show()}),t=setInterval(function(){0<S.length&&(S="")},5e3)):f=!1,Common.NotificationCenter.trigger("hints:show",f,v)}function c(t){L(),x.length=0,void(y.length=0)!==t?v=t:v++}function g(t){return t.hasClass("disabled")||t.parent().hasClass("disabled")||t.attr("disabled")}function e(){y=[],I=[];var e=[],i=[],t=(_.isArray(w)?w.forEach(function(t){e=e.concat($(t).find("[data-hint="+v+"]").toArray()),i=i.concat($(t).find("[data-hint-title][data-hint="+v+"]").toArray())}):(e=$(w).find("[data-hint="+v+"]").toArray(),i=$(w).find("[data-hint-title][data-hint="+v+"]").toArray()),e.filter(function(t){return $(t).is(":visible")})),n=i.filter(function(t){return $(t).is(":visible")});if(t.length===n.length)t.forEach(function(t){t=$(t);if("en"!==h){var e=t.attr("data-hint-title").toLowerCase(),i=e.charAt(0);if(-1===m.indexOf(i)){for(var n="",o=0;o<e.length;o++){var s=e.charAt(o);n+=U(s)}t.attr("data-hint-title",n.toUpperCase())}}y.push(t)});else{var o=[],a=[];if(0===v)for(var s in P){s=P[s].charAt(0).toLowerCase(),s=(I.push(s),m.indexOf(s));a.indexOf(s)<0&&a.push(s)}o=t.length+(0===v?_.size(P):0)>m.length?(n.forEach(function(t){t=$(t).data("hint-title").charAt(0).toLowerCase(),t=U(t);I.indexOf(t)<0&&I.push(t)}),function(t){for(var e,i,n=m.slice(),o=0;m.length,!e;o++)-1===I.indexOf(m[o])&&(e=m[o],i=o);n[i]=e+m[0];for(o=0;n.length<t;o++)e+m[o]!==n[i]&&n.push(e+m[o]);return n}(t.length+(0===v?_.size(P):0))):m.slice(),0<i.length&&t.forEach(function(t){t=$(t);if(e=t.attr("data-hint-title")){var e,i=(e=e.toLowerCase()).charAt(0),n=p.indexOf(i);if(-1===n)s=m.indexOf(i),a.indexOf(s)<0&&a.push(s);else if(a.indexOf(n)<0&&a.push(n),"en"!==h){for(var o="",s=0;s<e.length;s++)o+=U(e.charAt(s));t.attr("data-hint-title",o.toUpperCase())}}});var l=0;t.forEach(function(t){for(t=$(t);-1!==a.indexOf(l);)l++;t.attr("data-hint-title")||l>o.length||(t.attr("data-hint-title",o[l].toUpperCase()),l++),y.push(t)})}}function i(t){if(!(Common.Utils.isIE||Common.UI.isMac&&Common.Utils.isGecko)&&(f&&M(),0<x.length&&F(),s&&V(!1),t&&(T=!0),0<$(".hint-div").length&&$(".hint-div").remove(),0<$("iframe").length))try{$("iframe").contents().find(".hint-div").remove()}catch(t){}}function n(t){D!==t&&(D=t)}var t,d,o,h="en",m=[],p=[],u=[],b=[],C=!1,f=!1,v=0,w=document,y=[],x=[],S="",T=!1,s=!1,A=!1,k=!1,D=!0,I=[],P={"scroll-right":"R","scroll-left":"V"},E=function(t,e){e?w=e:"esc"===t?0===v&&(w=document):w=k?[$(window.parent.document).find(".advanced-settings-dlg:visible")[0],window.document]:$("#file-menu-panel").is(":visible")?$("#file-menu-panel"):t&&t.closest(".hint-section")||document},V=function(t){o&&(s=t,o.asc_enableKeyEvents(!t))},M=function(){f=!1,x&&x.forEach(function(t){t.remove()}),clearInterval(t),Common.NotificationCenter.trigger("hints:show",!1)},U=function(t){var e;return-1===m.indexOf(t)&&(e=p.indexOf(t),t=m[e]),t},a=function(){var h=k?window.parent.innerHeight*Common.Utils.zoom():Common.Utils.innerHeight()-20,m=k?window.parent.innerWidth*Common.Utils.zoom():Common.Utils.innerWidth(),t=k?w[0]:w,p=0!==v&&0<$(t).length&&!k?$(t).offset().top:0,u=0!==v&&0<$(t).length&&!k?p+$(t).height():h;"toolbar"===$(t).prop("id")&&$(t).outerHeight()<$(t).find(".box-controls").outerHeight()&&(u+=$(t).find(".box-controls").outerHeight()),0===y.length&&e(),y.forEach(function(t,e){if(!g(t)){var i=0,n=m;if(!(!k&&"toolbar"===$(w).prop("id")&&0<$(w).find(".toolbar-mask").length||$("#about-menu-panel").is(":visible")&&"right-menu"===t.closest(".hint-section").prop("id"))){if(window.SSE&&"statusbar_bottom"===t.parent().prop("id")){var o=t.parent();if(t.offset().left>o.offset().left+o.width())return}0===v&&0<t.closest(".tabs.short").length&&(n=(i=(o=t.closest(".tabs.short")).offset().left)+o.width(),t.hasClass("scroll")||(i+=20,n-=20));var o=$('<div style="" class="hint-div">'+t.attr("data-hint-title")+"</div>"),s=t.attr("data-hint-direction"),a=(window.SSE&&!k&&9!==w.nodeType&&"toolbar"===w.prop("id")&&"data"===t.closest(".panel").attr("data-tab")&&(t.parent().hasClass("slot-sortdesc")||t.parent().hasClass("slot-btn-setfilter")?t.attr("data-hint-direction",s="top"):(t.parent().hasClass("slot-btn-clear-filter")||t.parent().hasClass("slot-sortasc"))&&t.attr("data-hint-direction",s="bottom")),h),l=($("#file-menu-panel").is(":visible")&&1<v&&($(".fms-flex-apply").is(":visible")||$("#fms-flex-apply").is(":visible"))&&t.closest(".fms-flex-apply").length<1&&t.closest("#fms-flex-apply").length<1&&(a=h-$(".fms-flex-apply").height()),t.attr("data-hint-offset")),r="big"===l?6:"medium"===l?4:"small"===l?2:0;if(r)switch(s){case"bottom":l=[-r,0];break;case"top":l=[r,0];break;case"right":l=[0,-r];break;case"left":l=[0,r]}else l=l?t.attr("data-hint-offset").split(",").map(function(t){return parseInt(t)}):[0,0];var c,d=t.offset(),s="left-top"===s?(c=d.top-10+l[0],d.left-10+l[1]):"top"===s?(c=d.top-18+l[0],d.left+(t.outerWidth()-18)/2+l[1]):"right"===s?(c=d.top+(t.outerHeight()-18)/2+l[0],d.left+t.outerWidth()+l[1]):"left"===s?(c=d.top+(t.outerHeight()-18)/2+l[0],d.left-18+l[1]):(c=d.top+t.outerHeight()+l[0],d.left+(t.outerWidth()-18)/2+l[1]);c<a&&s<m&&p<c&&c<u&&i<s&&s+18<n&&(o.css({top:c,left:s}),(k&&e<2?(o.css("z-index","1060"),$(window.parent.document.body)):$(document.body)).append(o)),x.push(o)}}})},L=function(){x&&x.forEach(function(t){t.remove()})},F=function(){v=$("#file-menu-panel").is(":visible")||k?1:0,E(),x.length=0,y.length=0};return{init:function(t){Common.Utils.isIE||Common.UI.isMac&&Common.Utils.isGecko||(o=t,t=Common.localStorage.getKeysFilter(),d=t&&t.length?t.split(",")[0]:"",Common.NotificationCenter.on({"app:ready":function(t){var s,t=t.lang?t.lang.toLowerCase():"en";s=t,cacheFiles={"../../common/main/resources/alphabetletters/alphabetletters.json":{en:["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],ru:["а","б","в","г","д","е","ж","з","и","й","к","л","м","н","о","п","р","с","т","у","ф","х","ц","ч","ш","щ","э","ю","я"]},"../../common/main/resources/alphabetletters/qwertyletters.json":{en:["q","w","e","r","t","y","u","i","o","p","[","]","a","s","d","f","g","h","j","k","l",";","'","z","x","c","v","b","n","m",",","."],ru:["й","ц","у","к","е","н","г","ш","щ","з","х","ъ","ф","ы","в","а","п","р","о","л","д","ж","э","я","ч","с","м","и","т","ь","б","ю"],de:["q","w","e","r","t","z","u","i","o","p","ü","a","s","d","f","g","h","j","k","l","ö","ä","z","x","c","v","b","n","m"],fr:["a","z","e","r","t","y","u","i","o","p","q","s","d","f","g","h","j","k","l","m","w","x","c","v","b","n"]}},Common.Utils.loadConfig2=function(t,e){e(cacheFiles[t])},Common.Utils.loadConfig2("../../common/main/resources/alphabetletters/alphabetletters.json",function(e){p=e.en;function t(t){return m=e[h=t]}var i=!!t(s)||(!!t(s.split(/[\-_]/)[0])||t("en"));if(i&&"en"!==h)for(var n in P){var o=U(P[n].toLowerCase());o&&(P[n]=o.toUpperCase())}return i}),Common.Utils.loadConfig2("../../common/main/resources/alphabetletters/qwertyletters.json",function(t){u=t[h],"en"!==h&&(b=t.en)}),A=!0},"hints:clear":i,"window:resize":i}),$("#editor_sdk").on("click",function(){i()}),$(document).on("mousedown",function(){i()}),$(document).on("keyup",function(t){t.keyCode!=Common.UI.Keys.ALT&&91!==t.keyCode||!C||window.SSE&&window.SSE.getController("Statusbar").getIsDragDrop()?f&&t.preventDefault():(t.preventDefault(),f?(M(),F(),s&&(s=!1,o.asc_enableKeyEvents(!0))):($("input:focus").blur(),v=$("#file-menu-panel").is(":visible")||k?1:0,E(),r())),C=!1}),$(document).on("keydown",function(t){if(f)if(t.preventDefault(),t.keyCode==Common.UI.Keys.ESC)setTimeout(function(){0===v?(M(),F(),V(!1)):(L(),x.length=0,y.length=0,v--,E("esc"),r())},10);else{var e,i=null,n=!1,o=t.keyCode;if(i=16!==o&&17!==o&&18!==o&&91!==o?"en"===h?47<o&&o<58||64<o&&o<91?String.fromCharCode(t.keyCode):null:/[.*+?^${}()|[\]\\]/g.test(t.key)?null:t.key:i){"en"===h||-1!==m.indexOf(i.toLowerCase())||-1!==(o=b.indexOf(i.toLowerCase()))&&(i=u[o]),S+=i.toUpperCase();for(var s=0;s<y.length;s++){var a=y[s];if(!g(a)){var l=a.attr("data-hint-title");if(new RegExp("^"+S).test(l)&&(n=!0),l===S){e=a;break}}}if(e){o=e.prop("tagName").toLowerCase();if(window.SSE&&"statusbar_bottom"===e.parent().prop("id"))M(),e.contextmenu(),F();else if("input"===o||"textarea"===o)M(),e.trigger(jQuery.Event("click",{which:1})),e.focus(),F();else if(e.hasClass("listview"))M(),e.focus(),F();else{if(T=!1,M(),!k&&"toolbar"===$(w).prop("id")&&0<$(w).find(".toolbar-mask").length)return void F();i=e.attr("content-target")&&!$("#"+e.attr("content-target")).is(":visible")||"slot-btn-chat"===e.parent().prop("id")&&!$("#left-panel-chat").is(":visible")||e.parent().hasClass("ribtab")&&!$("#toolbar").children(".toolbar").hasClass("expanded");if((e.attr("content-target")||"slot-btn-chat"===e.parent().prop("id"))&&!i||$("#file-menu-panel").is(":visible")&&("fm-btn-info"===e.parent().prop("id")&&$("#panel-info").is(":visible")||"fm-btn-settings"===e.parent().prop("id")&&$("#panel-settings").is(":visible"))||(e.attr("for")?$("#"+e.attr("for")).trigger(jQuery.Event("click",{which:1})):(e.trigger(jQuery.Event("click",{which:1})),i&&(T=!1))),"btn-go-back"===e.prop("id")||"slot-btn-options"===e.closest(".btn-slot").prop("id")||"slot-btn-mode"===e.closest(".btn-slot").prop("id")||"id-btn-favorite"===e.prop("id")||"tlb-box-users"===e.parent().prop("id")||"left-btn-thumbs"===e.prop("id")||e.hasClass("scroll")||"left-btn-about"===e.prop("id")||"left-btn-support"===e.prop("id")||"slot-btn-search"===e.closest(".btn-slot").prop("id")||"slot-btn-pdf-mode"===e.closest(".btn-slot").prop("id"))return void F();if("add-comment-doc"===e.prop("id"))return L(),x.length=0,y.length=0,void r();T||("slot-btn-chat"===e.parent().prop("id")?(c(1),E(void 0,$("#left-menu.hint-section"))):("id-right-menu-signature"===e.prop("id")?c(2):c(),E(e)),r(),x.length<1&&F())}}else n||(S="")}}C=Common.Utils.InternalSettings.get(d+"settings-show-alt-hints")&&!t.shiftKey&&t.keyCode==Common.UI.Keys.ALT&&!Common.Utils.ModalWindow.isVisible()&&A&&0<m.length&&!(window.PE&&$("#pe-preview").is(":visible")),Common.Utils.InternalSettings.get(d+"settings-show-alt-hints")&&t.altKey&&115!==t.keyCode&&D&&t.preventDefault()}))},setMode:function(t){k=t.isEditDiagram||t.isEditMailMerge||t.isEditOle,n(!!k)},clearHints:i,needCloseFileMenu:function(){return!(f&&1<v)},isHintVisible:function(){return f},getStaticHint:function(t){return P[t]},setInternalEditorLoading:n}},define("common/main/lib/controller/HintManager",function(){}),void 0===Common&&(Common={}),void 0===Common.UI&&(Common.UI={}),Common.UI.LayoutManager=new function(){function o(t,e,i){if(t=t||a,l&&t)for(var n in t)t.hasOwnProperty(n)&&("object"==typeof t[n]?o(t[n],e,(i||"")+n+"-"):!1===t[n]&&(n="[data-layout-name="+(i||"")+n+"]",(n=e?e.find(n):$(n))&&n.hide&&n.hide()))}function s(t,e,i){if(e=e||a,!l||!e)return!0;var n,o=!0;for(n in e)if(e.hasOwnProperty(n)&&("object"==typeof e[n]?o=s(t,e[n],(i||"")+n+"-"):t===(i||"")+n&&(o=e[n]),!1===o))return o;return o}var a,l;return{init:function(t,e){a=t,l=e},applyCustomization:o,isElementVisible:s,getInitValue:function(t){if(l&&a){for(var e=t.split("-"),i=0,n=a,i=0;i<e.length&&("object"==typeof n[e[i]]&&n[e[i]]);i++)n=n[e[i]];if(i===e.length)return"object"==typeof n&&n?n.mode:n}}}},Common.UI.FeaturesManager=new function(){var i,n;return{init:function(t,e){i=t,n=e},canChange:function(t,e){return!((n||e)&&i&&"object"==typeof i[t]&&i[t]&&!1===i[t].change)},getInitValue:function(t,e){if((n||e)&&i&&void 0!==i[t])return"object"==typeof i[t]&&i[t]?void 0!==i[t].mode?i[t].mode:void 0:i[t]}}},define("common/main/lib/controller/LayoutManager",function(){}),void 0===Common&&(Common={}),void 0===Common.UI&&(Common.UI={}),Common.UI.ExternalUsers=new function(){var i=[],n=!1;return{init:function(t){t&&(Common.Gateway.on("setusers",function(t){var e;null===t.users?i=[]:(e=t.c||"mention",i[e]=t.users||[],n=!1,Common.NotificationCenter.trigger("mentions:setusers",e,i[e]))}),Common.NotificationCenter.on("mentions:clearusers",function(){i=[]}))},get:function(t){n||(void 0===i[t=t||"mention"]?(n=!0,Common.Gateway.requestUsers(t||"mention")):Common.NotificationCenter.trigger("mentions:setusers",t,i[t]))}}},define("common/main/lib/controller/ExternalUsers",function(){}),define("documenteditor/main/app/controller/Main",["core","irregularstack","common/main/lib/component/Window","common/main/lib/component/LoadMask","common/main/lib/component/Tooltip","common/main/lib/controller/Fonts","common/main/lib/collection/TextArt","common/main/lib/view/OpenDialog","common/main/lib/view/UserNameDialog","common/main/lib/util/LocalStorage","documenteditor/main/app/collection/ShapeGroups","documenteditor/main/app/collection/EquationGroups","common/main/lib/controller/FocusManager","common/main/lib/controller/HintManager","common/main/lib/controller/LayoutManager","common/main/lib/controller/ExternalUsers"],function(){"use strict";DE.Controllers.Main=Backbone.Controller.extend(_.extend(function(){var appHeader,ApplyEditRights=-255,LoadingDocument=-256,mapCustomizationElements={about:"button#left-btn-about",feedback:"button#left-btn-support",goback:"#fm-btn-back > a, #header-back > div",chat:"button#left-btn-chat"},mapCustomizationExtElements={toolbar:"#viewport #toolbar",leftMenu:"#viewport #left-menu, #viewport #id-toolbar-full-placeholder-btn-settings, #viewport #id-toolbar-short-placeholder-btn-settings",rightMenu:"#viewport #right-menu",statusBar:"#statusbar"};return Common.localStorage.setId("text"),Common.localStorage.setKeysFilter("de-,asc.text"),Common.localStorage.sync(),{models:[],collections:["ShapeGroups","EquationGroups","Common.Collections.HistoryUsers","Common.Collections.TextArt"],views:[],initialize:function(){this.addListeners({FileMenu:{"settings:apply":_.bind(this.applySettings,this)},"Common.Views.ReviewChanges":{"settings:apply":_.bind(this.applySettings,this)}});var e=this,i={Series:this.txtSeries,"Diagram Title":this.txtDiagramTitle,"X Axis":this.txtXAxis,"Y Axis":this.txtYAxis,"Your text here":this.txtArt,"Error! Bookmark not defined.":this.txtBookmarkError,above:this.txtAbove,below:this.txtBelow,"on page ":this.txtOnPage+" ",Header:this.txtHeader,Footer:this.txtFooter," -Section ":" "+this.txtSection+" ","First Page ":this.txtFirstPage+" ","Even Page ":this.txtEvenPage+" ","Odd Page ":this.txtOddPage+" ","Same as Previous":this.txtSameAsPrev,"Current Document":this.txtCurrentDocument,"No table of contents entries found.":this.txtNoTableOfContents,"Table of Contents":this.txtTableOfContents,"Syntax Error":this.txtSyntaxError,"Missing Operator":this.txtMissOperator,"Missing Argument":this.txtMissArg,"Number Too Large To Format":this.txtTooLarge,"Zero Divide":this.txtZeroDivide,"Is Not In Table":this.txtNotInTable,"Index Too Large":this.txtIndTooLarge,"The Formula Not In Table":this.txtFormulaNotInTable,"Table Index Cannot be Zero":this.txtTableInd,"Undefined Bookmark":this.txtUndefBookmark,"Unexpected End of Formula":this.txtEndOfFormula,Hyperlink:this.txtHyperlink,"Error! Main Document Only.":this.txtMainDocOnly,"Error! Not a valid bookmark self-reference.":this.txtNotValidBookmark,"Error! No text of specified style in document.":this.txtNoText,"Choose an item":this.txtChoose,"Enter a date":this.txtEnterDate,"Type equation here":this.txtTypeEquation,"Click to load image":this.txtClickToLoad,None:this.txtNone,"No table of figures entries found.":this.txtNoTableOfFigures,"table of figures":this.txtTableOfFigures,"TOC Heading":this.txtTOCHeading,Anyone:this.textAnyone,Text:this.textText};["Normal","No Spacing","Heading 1","Heading 2","Heading 3","Heading 4","Heading 5","Heading 6","Heading 7","Heading 8","Heading 9","Title","Subtitle","Quote","Intense Quote","List Paragraph","footnote text","Caption","endnote text"].forEach(function(t){i[t]=e["txtStyle_"+t.replace(/ /g,"_")]||t}),e.translationTable=i},onLaunch:function(){var i=this;if(this.stackLongActions=new Common.IrregularStack({strongCompare:function(t,e){return t.id===e.id&&t.type===e.type},weakCompare:function(t,e){return t.type===e.type}}),this.stackDisableActions=new Common.IrregularStack({strongCompare:function(t,e){return t.type===e.type},weakCompare:function(t,e){return t.type===e.type}}),this.stackMacrosRequests=[],this._state={isDisconnected:!1,usersCount:1,fastCoauth:!0,lostEditingRights:!1,licenseType:!1,isDocModified:!1},this.languages=null,Common.Utils.isBrowserSupported()){if(window.flat_desine=!0,this.api=this.getApplication().getController("Viewport").getApi(),Common.UI.FocusManager.init(),Common.UI.HintManager.init(this.api),Common.UI.Themes.init(this.api),this.api){this.api.SetDrawingFreeze(!0);var t=Common.localStorage.getBool("de-settings-cachemode",!0);switch(Common.Utils.InternalSettings.set("de-settings-cachemode",t),this.api.asc_setDefaultBlitMode(!!t),t=Common.localStorage.getItem("de-settings-fontrender"),Common.Utils.InternalSettings.set("de-settings-fontrender",t=null===t?"0":t),t){case"0":this.api.SetFontRenderingMode(3);break;case"1":this.api.SetFontRenderingMode(1);break;case"2":this.api.SetFontRenderingMode(2)}this.api.asc_registerCallback("asc_onError",_.bind(this.onError,this)),this.api.asc_registerCallback("asc_onDocumentContentReady",_.bind(this.onDocumentContentReady,this)),this.api.asc_registerCallback("asc_onOpenDocumentProgress",_.bind(this.onOpenDocument,this)),this.api.asc_registerCallback("asc_onDocumentUpdateVersion",_.bind(this.onUpdateVersion,this)),this.api.asc_registerCallback("asc_onServerVersion",_.bind(this.onServerVersion,this)),this.api.asc_registerCallback("asc_onAdvancedOptions",_.bind(this.onAdvancedOptions,this)),this.api.asc_registerCallback("asc_onDocumentName",_.bind(this.onDocumentName,this)),this.api.asc_registerCallback("asc_onPrintUrl",_.bind(this.onPrintUrl,this)),this.api.asc_registerCallback("asc_onMeta",_.bind(this.onMeta,this)),this.api.asc_registerCallback("asc_onSpellCheckInit",_.bind(this.loadLanguages,this)),this.api.asc_registerCallback("asc_onTriggerEvent",t=>{Common.Gateway._postMessage(t)}),this.api.asc_registerCallback("asc_onImageDoubleClick",(t,e)=>{log.verbose("asc_onImageDoubleClick: ",t,e)}),Common.NotificationCenter.on("api:disconnect",_.bind(this.onCoAuthoringDisconnect,this)),Common.NotificationCenter.on("goback",_.bind(this.goBack,this)),Common.NotificationCenter.on("markfavorite",_.bind(this.markFavorite,this)),Common.NotificationCenter.on("download:advanced",_.bind(this.onAdvancedOptions,this)),Common.NotificationCenter.on("showmessage",_.bind(this.onExternalMessage,this)),Common.NotificationCenter.on("showerror",_.bind(this.onError,this)),Common.NotificationCenter.on("editing:disable",_.bind(this.onEditingDisable,this)),this.isShowOpenDialog=!1,this.editorConfig={},this.appOptions={},Common.Gateway.on("init",_.bind(this.loadConfig,this)),Common.Gateway.on("showmessage",_.bind(this.onExternalMessage,this)),Common.Gateway.on("opendocument",_.bind(this.loadDocument,this)),Common.Gateway.on("asc_CloseFile",_.bind(this.asc_CloseFile,this)),Common.Gateway.on("asc_openDocument",_.bind(this.openDocument,this)),Common.Gateway.on("asc_setImageUrls",_.bind(this.asc_setImageUrls,this)),Common.Gateway.on("asc_showPasswordDialog",()=>{this.api.asc_showPasswordDialog()}),Common.Gateway.on("asc_Alert",e=>{this.onLongActionEnd(Asc.c_oAscAsyncActionType.BlockInteraction,LoadingDocument);var t=$.extend({},e);t.callback=t=>{e.button=t,Common.Gateway._postMessage({event:"onAlertOK",data:e})},Common.UI.alert(t)}),Common.Gateway.on("asc_Toast",t=>{const e=new Common.UI.SynchronizeTip({extCls:"no-arrow",placement:"bottom",target:$(".toolbar"),text:t.text,showLink:!1}).on("closeclick",function(){this.close()});e.show(),setTimeout(()=>{e.close()},t.duration||3e3)}),Common.Gateway.on("asc_trackEvent",t=>{Common.Analytics.send(t.gif,[i.document.fileType,t._referer])}),Common.Gateway.on("asc_setDocumentName",_.bind(this.onDocumentName,this)),Common.Gateway.on("asc_setUnchangedDocument",()=>{this.api.SetUnchangedDocument()}),Common.Gateway.on("asc_updateRecent",t=>{this.appOptions.recent=t.recent,Common.NotificationCenter.trigger("reset:recents",t.recent)}),Common.Gateway.on("grabfocus",_.bind(this.onGrabFocus,this)),Common.Gateway.appReady(),log.verbose("编辑器Ready","controller/Main/onLaunch/appReady()",Date.now()-window.__start),this.getApplication().getController("Viewport").setApi(this.api),this.getApplication().getController("Statusbar").setApi(this.api),this.contComments=this.getApplication().getController("Common.Controllers.Comments"),$(document.body).on("focus","input, textarea",function(t){/area_id/.test(t.target.id)||(/msg-reply/.test(t.target.className)?(i.dontCloseDummyComment=!0,i.beforeShowDummyComment=i.beforeCloseDummyComment=!1):/textarea-control/.test(t.target.className)?i.inTextareaControl=!0:!Common.Utils.ModalWindow.isVisible()&&/form-control/.test(t.target.className)&&(i.inFormControl=!0))}),$(document.body).on("blur","input, textarea",function(t){Common.Utils.ModalWindow.isVisible()||(/form-control/.test(t.target.className)&&(i.inFormControl=!1),i.getApplication().getController("LeftMenu").getView("LeftMenu").getMenu("file").isVisible()||t.relatedTarget&&(/area_id/.test(t.target.id)||"input"==t.target.localName&&0<$(t.target).parent().find(t.relatedTarget).length||"textarea"==t.target.localName&&0<$(t.target).closest(".asc-window").find(".dropdown-menu").find(t.relatedTarget).length||"input"==t.relatedTarget.localName&&/form-control/.test(t.relatedTarget.className)||"textarea"==t.relatedTarget.localName&&!/area_id/.test(t.relatedTarget.id))||Common.Utils.isIE&&t.originalEvent&&t.originalEvent.target&&/area_id/.test(t.originalEvent.target.id)&&t.originalEvent.target===t.originalEvent.srcElement||(Common.Utils.isLinux&&i.appOptions&&i.appOptions.isDesktopApp&&!t.relatedTarget&&t.originalEvent&&!t.originalEvent.sourceCapabilities||i.api.asc_enableKeyEvents(!0),i.dontCloseDummyComment&&/msg-reply/.test(t.target.className)?$(t.target).closest(".user-comment-item").find(t.relatedTarget).length<1?i.dontCloseDummyComment=i.beforeCloseDummyComment=!1:i.beforeCloseDummyComment=!0:/textarea-control/.test(t.target.className)&&(i.inTextareaControl=!1)))}).on("dragover",function(t){t=t.originalEvent;if(t.target&&$(t.target).closest("#editor_sdk").length<1)return t.preventDefault(),!(t.dataTransfer.dropEffect="none")}).on("dragstart",function(t){var e,t=t.originalEvent;t.target&&(0<(e=$(t.target)).closest(".combobox").length||0<e.closest(".dropdown-menu").length||0<e.closest(".input-field").length||0<e.closest(".spinner").length||0<e.closest(".textarea-field").length||0<e.closest(".ribtab").length||0<e.closest(".combo-dataview").length)&&t.preventDefault()}).on("mouseup",function(t){i.beforeCloseDummyComment&&setTimeout(function(){i.dontCloseDummyComment=i.beforeCloseDummyComment=!1},10)}),Common.Utils.isChrome&&$(document.body).on("keydown","textarea",function(t){t.keyCode!==Common.UI.Keys.PAGEUP&&t.keyCode!==Common.UI.Keys.PAGEDOWN||setTimeout(function(){$("#viewport").scrollLeft(0),$("#viewport").scrollTop(0)},0)}),Common.NotificationCenter.on({"modal:show":function(){Common.Utils.ModalWindow.show(),i.api.asc_enableKeyEvents(!1)},"modal:close":function(t){Common.Utils.ModalWindow.close(),Common.Utils.ModalWindow.isVisible()||i.api.asc_enableKeyEvents(!0)},"modal:hide":function(t){Common.Utils.ModalWindow.close(),Common.Utils.ModalWindow.isVisible()||i.api.asc_enableKeyEvents(!0)},"settings:unitschanged":_.bind(this.unitsChanged,this),"dataview:focus":function(t){},"dataview:blur":function(t){Common.Utils.ModalWindow.isVisible()||i.api.asc_enableKeyEvents(!0)},"menu:show":function(t){},"menu:hide":function(t,e){Common.Utils.ModalWindow.isVisible()||e||i.api.asc_enableKeyEvents(!0)},"edit:complete":_.bind(i.onEditComplete,i)}),this.initNames(),Common.util.Shortcuts.delegateShortcuts({shortcuts:{"command+s,ctrl+s,command+p,ctrl+p,command+k,ctrl+k,command+d,ctrl+d":_.bind(function(t){t.preventDefault(),t.stopPropagation()},this)}})}i.defaultTitleText="",i.warnNoLicense=i.warnNoLicense.replace(/%1/g,"ONLYOFFICE"),i.warnNoLicenseUsers=i.warnNoLicenseUsers.replace(/%1/g,"ONLYOFFICE"),i.textNoLicenseTitle=i.textNoLicenseTitle.replace(/%1/g,"ONLYOFFICE"),i.warnLicenseExceeded=i.warnLicenseExceeded.replace(/%1/g,"ONLYOFFICE"),i.warnLicenseUsersExceeded=i.warnLicenseUsersExceeded.replace(/%1/g,"ONLYOFFICE")}else Common.Utils.showBrowserRestriction(),Common.Gateway.reportError(void 0,this.unsupportedBrowserErrorText)},loadConfig:function(t){var e;if(this.editorConfig=$.extend(this.editorConfig,t.config),this.appOptions.customization=this.editorConfig.customization,this.appOptions.canRenameAnonymous=!("object"==typeof this.appOptions.customization&&"object"==typeof this.appOptions.customization.anonymous&&!1===this.appOptions.customization.anonymous.request),this.appOptions.guestName="object"==typeof this.appOptions.customization&&"object"==typeof this.appOptions.customization.anonymous&&"string"==typeof this.appOptions.customization.anonymous.label&&""!==this.appOptions.customization.anonymous.label.trim()?Common.Utils.String.htmlEncode(this.appOptions.customization.anonymous.label):this.textGuest,this.appOptions.canRenameAnonymous&&(e=Common.localStorage.getItem("guest-username"),Common.Utils.InternalSettings.set("guest-username",e),Common.Utils.InternalSettings.set("save-guest-username",!!e)),this.appOptions.customization.font){if(this.appOptions.customization.font.name&&"string"==typeof this.appOptions.customization.font.name){for(var i=this.appOptions.customization.font.name.split(","),n=0;n<i.length;n++){var o=i[n].trim();o&&/[\s0-9\.]/.test(o)&&(i[n]="'"+o+"'")}document.documentElement.style.setProperty("--font-family-base-custom",i.join(","))}this.appOptions.customization.font.size&&(t=parseInt(this.appOptions.customization.font.size),isNaN(t)||document.documentElement.style.setProperty("--font-size-base-app-custom",t+"px"))}this.editorConfig.user=this.appOptions.user=Common.Utils.fillUserInfo(this.editorConfig.user,this.editorConfig.lang,e?e+" ("+this.appOptions.guestName+")":this.textAnonymous,Common.localStorage.getItem("guest-id")||"uid-"+Date.now()),this.appOptions.user.anonymous&&Common.localStorage.setItem("guest-id",this.appOptions.user.id),this.appOptions.isDesktopApp="desktop"==this.editorConfig.targetApp,this.appOptions.canCreateNew=this.editorConfig.canRequestCreateNew||!_.isEmpty(this.editorConfig.createUrl)||this.editorConfig.templates&&this.editorConfig.templates.length,this.appOptions.canOpenRecent=void 0!==this.editorConfig.recent&&!this.appOptions.isDesktopApp,this.appOptions.templates=this.editorConfig.templates,this.appOptions.recent=this.editorConfig.recent,this.appOptions.createUrl=this.editorConfig.createUrl,this.appOptions.canRequestCreateNew=this.editorConfig.canRequestCreateNew,this.appOptions.lang=this.editorConfig.lang,this.appOptions.location="string"==typeof this.editorConfig.location?this.editorConfig.location.toLowerCase():"",this.appOptions.sharingSettingsUrl=this.editorConfig.sharingSettingsUrl,this.appOptions.fileChoiceUrl=this.editorConfig.fileChoiceUrl,this.appOptions.mergeFolderUrl=this.editorConfig.mergeFolderUrl,this.appOptions.saveAsUrl=this.editorConfig.saveAsUrl,this.appOptions.canAnalytics=!1,this.appOptions.canRequestClose=this.editorConfig.canRequestClose,this.appOptions.canBackToFolder=!1!==this.editorConfig.canBackToFolder&&"object"==typeof this.editorConfig.customization&&"object"==typeof this.editorConfig.customization.goback&&(!_.isEmpty(this.editorConfig.customization.goback.url)||this.editorConfig.customization.goback.requestClose&&this.appOptions.canRequestClose),this.appOptions.canBack=!0===this.appOptions.canBackToFolder,this.appOptions.canPlugins=!1,this.appOptions.canMakeActionLink=this.editorConfig.canMakeActionLink,this.appOptions.canRequestUsers=this.editorConfig.canRequestUsers,this.appOptions.canRequestSendNotify=this.editorConfig.canRequestSendNotify,this.appOptions.canRequestSaveAs=this.editorConfig.canRequestSaveAs,this.appOptions.canRequestInsertImage=this.editorConfig.canRequestInsertImage,this.appOptions.canRequestCompareFile=this.editorConfig.canRequestCompareFile,this.appOptions.canRequestMailMergeRecipients=this.editorConfig.canRequestMailMergeRecipients,this.appOptions.canRequestSharingSettings=this.editorConfig.canRequestSharingSettings,this.appOptions.canRequestSelectDocument=this.editorConfig.canRequestSelectDocument,this.appOptions.canRequestSelectSpreadsheet=this.editorConfig.canRequestSelectSpreadsheet,this.appOptions.compatibleFeatures="object"==typeof this.appOptions.customization&&!!this.appOptions.customization.compatibleFeatures,this.appOptions.canFeatureComparison=!1,this.appOptions.canFeatureContentControl=!0,this.appOptions.canFeatureForms=!!this.api.asc_isSupportFeature("forms"),this.appOptions.uiRtl=!1,this.appOptions.disableNetworkFunctionality=!1,this.appOptions.mentionShare=!("object"==typeof this.appOptions.customization&&0==this.appOptions.customization.mentionShare),this.appOptions.user.guest&&this.appOptions.canRenameAnonymous&&Common.NotificationCenter.on("user:rename",_.bind(this.showRenameUserDialog,this)),(appHeader=this.getApplication().getController("Viewport").getView("Common.Views.Header")).setCanBack(!0===this.appOptions.canBackToFolder,this.appOptions.canBackToFolder?this.editorConfig.customization.goback.text:""),this.editorConfig.lang&&this.api.asc_setLocale(this.editorConfig.lang),"us"!=this.appOptions.location&&"ca"!=this.appOptions.location||Common.Utils.Metric.setDefaultMetric(Common.Utils.Metric.c_MetricUnits.inch),e=null===(e=Common.localStorage.getItem("de-macros-mode"))?"enable"==(e=this.editorConfig.customization?this.editorConfig.customization.macrosMode:"warn")?1:"disable"==e?2:0:parseInt(e),Common.Utils.InternalSettings.set("de-macros-mode",e),e=Common.localStorage.getItem("de-allow-macros-request"),Common.Utils.InternalSettings.set("de-allow-macros-request",null!==e?parseInt(e):0),this.appOptions.wopi=this.editorConfig.wopi,appHeader.setWopi(this.appOptions.wopi),Common.Controllers.Desktop.init(this.appOptions),Common.UI.HintManager.setMode(this.appOptions)},loadDocument:function(t){log.verbose("加载编辑器配置","controller/Main/loadDocument()",t),this.permissions={},this.appOptions.document=this.document=t.doc;var e,i={},n=(t.doc&&(this.permissions=$.extend(this.permissions,t.doc.permissions),e=$.extend({},t.doc.options,this.editorConfig.actionLink||{}),(n=new Asc.asc_CUserInfo).put_Id(this.appOptions.user.id),n.put_FullName(this.appOptions.user.fullname),n.put_IsAnonymousUser(!!this.appOptions.user.anonymous),(i=new Asc.asc_CDocInfo).put_Id(t.doc.key),i.put_Url(t.doc.url),i.put_DirectUrl(t.doc.directUrl),i.put_Title(t.doc.title),i.put_Format(t.doc.fileType),i.put_VKey(t.doc.vkey),i.put_Options(e),i.put_UserInfo(n),i.put_CallbackUrl(this.editorConfig.callbackUrl),i.put_Token(t.doc.token),i.put_Permissions(t.doc.permissions),i.put_EncryptedInfo(this.editorConfig.encryptionKeys),i.put_Lang(this.editorConfig.lang),i.put_Mode(this.editorConfig.mode),e=!this.editorConfig.customization||!1!==this.editorConfig.customization.macros,i.asc_putIsEnabledMacroses(!!e),e=!this.editorConfig.customization||!1!==this.editorConfig.customization.plugins,i.asc_putIsEnabledPlugins(!!e),e=(n=/^(?:(pdf|djvu|xps|oxps))$/.exec(t.doc.fileType))&&"string"==typeof n[1]?"strict":this.editorConfig.coEditing&&"object"==typeof this.editorConfig.coEditing&&("view"!==this.editorConfig.mode||!1===this.editorConfig.coEditing.change)&&this.editorConfig.coEditing.mode||"fast",i.put_CoEditingMode(e),n&&"string"==typeof n[1]&&(this.permissions.edit=this.permissions.review=!1)),this.editorConfig.customization&&(this.editorConfig.customization.toolbarNoTabs||"desktop"!==this.editorConfig.targetApp&&(this.editorConfig.customization.loaderName||this.editorConfig.customization.loaderLogo))||($("#editor-container").css("overflow","hidden"),$("#editor-container").append('<div class="doc-placeholder">'+'<div class="line"></div>'.repeat(20)+"</div>"),window.__append_placeholder=Date.now(),log.verbose("开始显示骨架图"),"view"!=this.editorConfig.mode&&(!1!==this.permissions.edit||this.permissions.review)||$("#editor-container").find(".doc-placeholder").css("margin-top",19)),!!t.doc&&/^(?:(docxf))$/.exec(t.doc.fileType));this.appOptions.isFormCreator=!(!n||"string"!=typeof n[1])&&this.appOptions.canFeatureForms,(n=!!t.doc&&/^(?:(oform))$/.exec(t.doc.fileType))&&"string"==typeof n[1]&&(void 0===this.permissions.fillForms&&(this.permissions.fillForms=!1!==this.permissions.edit),this.permissions.edit=this.permissions.review=this.permissions.comment=!1),this.api.asc_registerCallback("asc_onGetEditorPermissions",_.bind(this.onEditorPermissions,this)),this.api.asc_registerCallback("asc_onLicenseChanged",_.bind(this.onLicenseChanged,this)),this.api.asc_registerCallback("asc_onMacrosPermissionRequest",_.bind(this.onMacrosPermissionRequest,this)),this.api.asc_registerCallback("asc_onRunAutostartMacroses",_.bind(this.onRunAutostartMacroses,this)),this.api.asc_setDocInfo(i),this.api.asc_getEditorPermissions(this.editorConfig.licenseUrl,this.editorConfig.customerId),this.api._onLicense({type:"license",license:{type:3,light:!0,rights:1,branding:!0,customization:!0}}),this.api._onAuth({type:"auth",result:1}),Common.component.Analytics.init("WORD",this.document),t.doc&&appHeader.setDocumentCaption(t.doc.title)},asc_CloseFile:function(){try{this.api.asc_CloseFile()}catch(t){}},openDocument:function(t){this.api.asc_setLocalRestrictions(t.localRestrintions||0),this.api.onEndLoadFile({bSerFormat:!0,data:t.buf})},asc_setImageUrls:function(t){AscCommon.g_oDocumentUrls.init(t.urls)},writeFile:function(t,e,i){Common.Gateway.off("asc_writeFileCallback"),Common.Gateway.on("asc_writeFileCallback",t=>{i(t,!0,"ok")}),Common.Gateway._postMessage({event:"writeFile",data:{file:t,data:e}})},onProcessSaveResult:function(t){this.api.asc_OnSaveEnd(t.result),t&&!1===t.result&&Common.UI.error({title:this.criticalErrorTitle,msg:_.isEmpty(t.message)?this.errorProcessSaveResult:t.message})},onProcessRightsChange:function(t){var e,i;t&&!1===t.enabled&&(i=(e=this)._state.lostEditingRights,this._state.lostEditingRights=!this._state.lostEditingRights,this.api.asc_coAuthoringDisconnect(),Common.NotificationCenter.trigger("collaboration:sharingdeny"),Common.NotificationCenter.trigger("api:disconnect"),i||Common.UI.warning({title:this.notcriticalErrorTitle,maxwidth:600,msg:_.isEmpty(t.message)?this.warnProcessRightsChange:t.message,callback:function(){e._state.lostEditingRights=!1,e.onEditComplete()}}))},onDownloadAs:function(t){if(this.appOptions.canDownload||this.appOptions.canDownloadOrigin){this._state.isFromGatewayDownloadAs=!0;var e,i=t&&"string"==typeof t?Asc.c_oAscFileType[t.toUpperCase()]:null,n=null,o=[Asc.c_oAscFileType.TXT,Asc.c_oAscFileType.RTF,Asc.c_oAscFileType.ODT,Asc.c_oAscFileType.DOCX,Asc.c_oAscFileType.HTML,Asc.c_oAscFileType.DOTX,Asc.c_oAscFileType.OTT,Asc.c_oAscFileType.FB2,Asc.c_oAscFileType.EPUB,Asc.c_oAscFileType.DOCM,Asc.c_oAscFileType.JPG,Asc.c_oAscFileType.PNG],s=/^(?:(pdf|djvu|xps|oxps))$/.exec(this.document.fileType);if(s&&"string"==typeof s[1]){if(!t||"string"!=typeof t||s[1]===t.toLowerCase())return void this.api.asc_DownloadOrigin(!0);/^xps|oxps$/.test(this.document.fileType)?o=o.concat([Asc.c_oAscFileType.PDF,Asc.c_oAscFileType.PDFA]):/^djvu$/.test(this.document.fileType)&&(o=[Asc.c_oAscFileType.PDF]),e=new AscCommon.asc_CTextParams(Asc.c_oAscTextAssociation.PlainLine)}else o=o.concat([Asc.c_oAscFileType.PDF,Asc.c_oAscFileType.PDFA]),n=Asc.c_oAscFileType.DOCX;this.appOptions.canFeatureForms&&!/^djvu$/.test(this.document.fileType)&&(o=o.concat([Asc.c_oAscFileType.DOCXF,Asc.c_oAscFileType.OFORM])),(i=!i||o.indexOf(i)<0?n:i)?(s=new Asc.asc_CDownloadOptions(i,!0),e&&s.asc_setTextParams(e),this.api.asc_DownloadAs(s)):this.api.asc_DownloadOrigin(!0)}else Common.Gateway.reportError(Asc.c_oAscError.ID.AccessDeny,this.errorAccessDeny)},onProcessMouse:function(t){var e;"mouseup"==t.type&&(e=document.getElementById("editor_sdk"))&&(e=e.getBoundingClientRect(),this.api.OnMouseUp(t.x-e.left,t.y-e.top))},onRefreshHistory:function(t){if(this.appOptions.canUseHistory)if(this.loadMask&&this.loadMask.hide(),t.data.error||!t.data.history)(e=this.getApplication().getCollection("Common.Collections.HistoryVersions"))&&0<e.size()&&e.each(function(t){t.set("canRestore",!1)}),Common.UI.alert({title:this.notcriticalErrorTitle,msg:t.data.error||this.txtErrorLoadHistory,iconCls:"warn",buttons:["ok"],callback:_.bind(function(t){this.onEditComplete()},this)});else{this.api.asc_coAuthoringDisconnect(),appHeader.setCanRename(!1),appHeader.getButton("users")&&appHeader.getButton("users").hide(),appHeader.getButton("share")&&appHeader.getButton("share").setVisible(!1),this.getApplication().getController("LeftMenu").getView("LeftMenu").showHistory(),this.disableEditing(!0),this._renameDialog&&this._renameDialog.close();var e,i=t.data.history,n=null;if(e=this.getApplication().getCollection("Common.Collections.HistoryVersions")){for(var o,s,a=[],l=-1,r=-1,c=[],d=this.getApplication().getCollection("Common.Collections.HistoryUsers"),h=null,m=0,p=i.length-1;0<=p;p--)if(void 0!==(o=i[p]).versionGroup&&null!==o.versionGroup||(o.versionGroup=o.version),o){if(o.user||(o.user={}),s=0<p&&i[p-1]?i[p-1].key:o.key+"0",(h=d.findUser(o.user.id))||(h=new Common.Models.User({id:o.user.id,username:o.user.name||this.textAnonymous,colorval:Asc.c_oAscArrUserColors[m],color:this.generateUserColor(Asc.c_oAscArrUserColors[m++])}),d.add(h)),a.push(new Common.Models.HistoryVersion({version:o.versionGroup,revision:o.version,userid:o.user.id,username:o.user.name||this.textAnonymous,usercolor:h.get("color"),created:o.created,docId:o.key,markedAsVersion:l!==o.versionGroup,selected:t.data.currentVersion==o.version,canRestore:this.appOptions.canHistoryRestore&&p<i.length-1,isExpanded:!0,serverVersion:o.serverVersion,fileType:"docx"})),t.data.currentVersion==o.version&&(n=a[a.length-1]),l=o.versionGroup,r!==o.version){for(r=o.version,c.reverse(),g=0;g<c.length;g++)a[a.length-g-2].set("arrColors",c);c=[]}c.push(h.get("colorval"));var u,g,b=o.changes;if(b&&0<b.length){if(a[a.length-1].set("docIdPrev",s),!_.isEmpty(o.serverVersion)&&o.serverVersion==this.appOptions.buildVersion)for(a[a.length-1].set("changeid",b.length-1),a[a.length-1].set("hasChanges",1<b.length),g=b.length-2;0<=g;g--)u=b[g],(h=d.findUser(u.user.id))||(h=new Common.Models.User({id:u.user.id,username:u.user.name||this.textAnonymous,colorval:Asc.c_oAscArrUserColors[m],color:this.generateUserColor(Asc.c_oAscArrUserColors[m++])}),d.add(h)),a.push(new Common.Models.HistoryVersion({version:o.versionGroup,revision:o.version,changeid:g,userid:u.user.id,username:u.user.name||this.textAnonymous,usercolor:h.get("color"),created:u.created,docId:o.key,docIdPrev:s,selected:!1,canRestore:this.appOptions.canHistoryRestore&&this.appOptions.canDownload,isRevision:!1,isVisible:!0,serverVersion:o.serverVersion,fileType:"docx"})),c.push(h.get("colorval"))}else 0==p&&1==i.length&&a[a.length-1].set("docId",o.key+"1")}if(0<c.length){for(c.reverse(),g=0;g<c.length;g++)a[a.length-g-1].set("arrColors",c);c=[]}e.reset(a),null===n&&0<e.size()&&(n=e.at(0)).set("selected",!0),n&&this.getApplication().getController("Common.Controllers.History").onSelectRevision(null,null,n)}}},generateUserColor:function(t){return"#"+("000000"+t.toString(16)).substr(-6)},disableEditing:function(t,e){this.getApplication();Common.NotificationCenter.trigger("editing:disable",t,{viewMode:t,reviewMode:!1,fillFormMode:!1,allowMerge:!1,allowSignature:!1,allowProtect:!1,rightMenu:{clear:!e,disable:!0},statusBar:!0,leftMenu:{disable:!0,previewMode:!0},fileMenu:{protect:!0,history:e},navigation:{disable:!e,previewMode:!0},comments:{disable:!e,previewMode:!0},chat:!0,review:!0,viewport:!0,documentHolder:{clear:!e,disable:!0},toolbar:!0,plugins:!1,protect:!1},e?"reconnect":"disconnect")},onEditingDisable:function(t,e,i){var n=this.getApplication(),o={type:i,disable:t,options:e},o=(t&&!this.stackDisableActions.get({type:i})&&this.stackDisableActions.push(o),t||this.stackDisableActions.pop({type:i}),!t&&0<this.stackDisableActions.length()?this.stackDisableActions.get(this.stackDisableActions.length()-1):null);e.rightMenu&&n.getController("RightMenu")&&(e.rightMenu.clear&&n.getController("RightMenu").getView("RightMenu").clearSelection(),e.rightMenu.disable&&n.getController("RightMenu").SetDisabled(t,e.allowMerge,e.allowSignature)),e.statusBar&&n.getController("Statusbar").getView("Statusbar").SetDisabled(t),e.review&&n.getController("Common.Controllers.ReviewChanges").SetDisabled(t,e.reviewMode,e.fillFormMode),e.viewport&&n.getController("Viewport").SetDisabled(t),e.toolbar&&n.getController("Toolbar").DisableToolbar(t,e.viewMode,e.reviewMode,e.fillFormMode),e.documentHolder&&(e.documentHolder.clear&&n.getController("DocumentHolder").clearSelection(),e.documentHolder.disable&&n.getController("DocumentHolder").SetDisabled(t,e.allowProtect,e.fillFormMode)),e.leftMenu&&(e.leftMenu.disable&&n.getController("LeftMenu").SetDisabled(t,e),e.leftMenu.previewMode&&n.getController("LeftMenu").setPreviewMode(t)),e.fileMenu&&(n.getController("LeftMenu").leftMenu.getMenu("file").SetDisabled(t,e.fileMenu),e.leftMenu.disable&&n.getController("LeftMenu").leftMenu.getMenu("file").applyMode()),e.comments&&(i=this.getApplication().getController("Common.Controllers.Comments"))&&e.comments.previewMode&&i.setPreviewMode(t),e.navigation&&e.navigation.previewMode&&n.getController("Navigation")&&n.getController("Navigation").SetDisabled(t),e.plugins&&n.getController("Common.Controllers.Plugins").getView("Common.Views.Plugins").SetDisabled(t,e.reviewMode,e.fillFormMode),e.protect&&n.getController("Common.Controllers.Protection").SetDisabled(t,!1),o&&this.onEditingDisable(o.disable,o.options,o.type)},disableLiveViewing:function(t){this.appOptions.canLiveView=!t,this.api.asc_SetFastCollaborative(!t),Common.Utils.InternalSettings.set("de-settings-coauthmode",!t)},onRequestClose:function(){var e=this;this.api.isDocumentModified()?(this.api.asc_stopSaving(),Common.UI.warning({closable:!1,width:500,title:this.notcriticalErrorTitle,msg:this.leavePageTextOnClose,buttons:["ok","cancel"],primary:"ok",callback:function(t){"ok"==t?(e.api.asc_undoAllChanges(),e.api.asc_continueSaving(),Common.Gateway.requestClose()):e.api.asc_continueSaving()}})):Common.Gateway.requestClose()},goBack:function(t){var e;Common.Controllers.Desktop.process("goback")||(this.appOptions.customization.goback.requestClose&&this.appOptions.canRequestClose?this.onRequestClose():(e=this.appOptions.customization.goback.url,t||!1===this.appOptions.customization.goback.blank?parent.location.href=e:window.open(e,"_blank")))},markFavorite:function(t){Common.Controllers.Desktop.process("markfavorite")||Common.Gateway.metaChange({favorite:t})},onSetFavorite:function(t){this.appOptions.canFavorite&&appHeader.setFavorite(!!t)},onEditComplete:function(t){var e,i=this.getApplication(),n=i.getController("Toolbar").getView(),o=i.getController("RightMenu").getView("RightMenu");!this.appOptions.isEdit||!n||!n.btnInsertShape.pressed&&!n.btnInsertText.pressed||_.isObject(arguments[1])&&"tlbtn-insertshape"===arguments[1].id||(this.api&&this.api.StartAddShape("",!1),n.btnInsertShape.toggle(!1,!1),n.btnInsertText.toggle(!1,!1)),this.appOptions.isEdit&&n&&n.btnHighlightColor.pressed&&(!_.isObject(arguments[1])||"id-toolbar-btn-highlight"!==arguments[1].id)&&(this.api.SetMarkerFormat(!1),n.btnHighlightColor.toggle(!1,!1)),this.appOptions.isEdit&&(n&&n._isEyedropperStart||o&&o._isEyedropperStart)&&(n._isEyedropperStart?n._isEyedropperStart=!1:o._isEyedropperStart=!1,this.api.asc_cancelEyedropper()),i.getController("DocumentHolder").getView().focus(),this.api&&this.appOptions.isEdit&&!n._state.previewmode&&(o=this.api.asc_isDocumentCanSave(),i=this.appOptions.forcesave,e=!!n.btnCollabChanges.rendered&&n.btnCollabChanges.cmpEl.hasClass("notify"),o=!o&&!e&&!i||this._state.isDisconnected||this._state.fastCoauth&&1<this._state.usersCount&&!i,n.btnSave.setDisabled(o)),Common.UI.HintManager.clearHints(!0)},onLongActionBegin:function(t,e){e={id:e,type:t};this.stackLongActions.push(e),this.setLongActionView(e)},onLongActionEnd:function(t,e){var i,n;this.stackLongActions.pop({id:e,type:t}),appHeader&&appHeader.setDocumentCaption(this.api.asc_getDocumentName()),this.updateWindowTitle(!0),(i=this.stackLongActions.get({type:Asc.c_oAscAsyncActionType.Information}))?this.setLongActionView(i):(n=this,e!=Asc.c_oAscAsyncAction.Save&&e!=Asc.c_oAscAsyncAction.ForceSaveButton||this.appOptions.isOffline?this.getApplication().getController("Statusbar").setStatusCaption(""):this._state.fastCoauth&&1<this._state.usersCount?n._state.timerSave=setTimeout(function(){n.getApplication().getController("Statusbar").setStatusCaption(n.textChangesSaved,!1,3e3)},500):n.getApplication().getController("Statusbar").setStatusCaption(n.textChangesSaved,!1,3e3)),(i=this.stackLongActions.get({type:Asc.c_oAscAsyncActionType.BlockInteraction}))?this.setLongActionView(i):this.loadMask&&this.loadMask.hide(),this.appOptions.isEdit&&(e==Asc.c_oAscAsyncAction.Save||e==Asc.c_oAscAsyncAction.ForceSaveButton)&&(!this._state.fastCoauth||this._state.usersCount<2||this.getApplication().getController("Common.Controllers.ReviewChanges").isPreviewChangesMode())?this.synchronizeChanges():this.appOptions.isEdit&&(e==Asc.c_oAscAsyncAction.Save||e==Asc.c_oAscAsyncAction.ForceSaveButton||e==Asc.c_oAscAsyncAction.ApplyChanges)&&this._state.fastCoauth&&this.getApplication().getController("Common.Controllers.ReviewChanges").synchronizeChanges(),e==Asc.c_oAscAsyncAction.Open&&(Common.Utils.InternalSettings.get("de-settings-livecomment")?this.api.asc_showComments(Common.Utils.InternalSettings.get("de-settings-resolvedcomment")):this.api.asc_hideComments()),e==Asc.c_oAscAsyncAction.Disconnect&&(this._state.timerDisconnect&&clearTimeout(this._state.timerDisconnect),this.disableEditing(!1,!0),this.getApplication().getController("Statusbar").hideDisconnectTip(),this.getApplication().getController("Statusbar").setStatusCaption(this.textReconnect)),t!=Asc.c_oAscAsyncActionType.BlockInteraction||this.getApplication().getController("LeftMenu").dlgSearch&&this.getApplication().getController("LeftMenu").dlgSearch.isVisible()||this.getApplication().getController("Toolbar").dlgSymbolTable&&this.getApplication().getController("Toolbar").dlgSymbolTable.isVisible()||(e==Asc.c_oAscAsyncAction.LoadDocumentFonts||e==Asc.c_oAscAsyncAction.ApplyChanges||e==Asc.c_oAscAsyncAction.DownloadAs)&&(this.dontCloseDummyComment||this.inTextareaControl||Common.Utils.ModalWindow.isVisible()||this.inFormControl)||this.api.asc_enableKeyEvents(!0)},setLongActionView:function(t){var e="",i="",n=!1,o=null;switch(t.id){case Asc.c_oAscAsyncAction.Open:e=this.openTitleText,i=this.openTextText;break;case Asc.c_oAscAsyncAction.Save:case Asc.c_oAscAsyncAction.ForceSaveButton:clearTimeout(this._state.timerSave),n=!0,e=this.saveTitleText,i=this.appOptions.isOffline?"":this.saveTextText;break;case Asc.c_oAscAsyncAction.LoadDocumentFonts:e=this.loadFontsTitleText,i=this.loadFontsTextText;break;case Asc.c_oAscAsyncAction.LoadDocumentImages:e=this.loadImagesTitleText,i=this.loadImagesTextText;break;case Asc.c_oAscAsyncAction.LoadFont:e=this.loadFontTitleText,i=this.loadFontTextText;break;case Asc.c_oAscAsyncAction.LoadImage:e=this.loadImageTitleText,i=this.loadImageTextText;break;case Asc.c_oAscAsyncAction.DownloadAs:e=this.downloadTitleText,i=this.downloadTextText;break;case Asc.c_oAscAsyncAction.Print:e=this.printTitleText,i=this.printTextText;break;case Asc.c_oAscAsyncAction.UploadImage:e=this.uploadImageTitleText,i=this.uploadImageTextText;break;case Asc.c_oAscAsyncAction.ApplyChanges:e=this.applyChangesTitleText,i=this.applyChangesTextText;break;case Asc.c_oAscAsyncAction.MailMergeLoadFile:e=this.mailMergeLoadFileText,i=this.mailMergeLoadFileTitle;break;case Asc.c_oAscAsyncAction.DownloadMerge:e=this.downloadMergeTitle,i=this.downloadMergeText;break;case Asc.c_oAscAsyncAction.SendMailMerge:e=this.sendMergeTitle,i=this.sendMergeText;break;case Asc.c_oAscAsyncAction.Waiting:e=this.waitText,i=this.waitText;break;case ApplyEditRights:e=this.txtEditingMode,i=this.txtEditingMode;break;case LoadingDocument:e=this.loadingDocumentTitleText+"           ",i=this.loadingDocumentTextText;break;case Asc.c_oAscAsyncAction.Disconnect:i=this.textDisconnect,Common.UI.Menu.Manager.hideAll(),this.disableEditing(!0,!0);var s=this,o=function(){s._state.timerDisconnect=setTimeout(function(){s.getApplication().getController("Statusbar").showDisconnectTip()},s._state.unloadTimer||0)};break;default:"string"==typeof t.id&&(e=t.id,i=t.id)}t.type==Asc.c_oAscAsyncActionType.BlockInteraction?(this.loadMask||(this.loadMask=new Common.UI.LoadMask({owner:$("#viewport")})),this.loadMask.setTitle(e),this.isShowOpenDialog||this.loadMask.show(t.id===Asc.c_oAscAsyncAction.Open)):this.getApplication().getController("Statusbar").setStatusCaption(i,n,0,o)},onApplyEditRights:function(t){this.getApplication().getController("Statusbar").setStatusCaption(""),t&&!t.allowed&&Common.UI.info({title:this.requestEditFailedTitleText,msg:t.message||this.requestEditFailedMessageText})},onDocumentContentReady:function(){if(!this._isDocReady){this._state.openDlg&&this._state.openDlg.close();var me=this,value,zf=(me._isDocReady=!0,Common.NotificationCenter.trigger("app:ready",this.appOptions),me.api.SetDrawingFreeze(!1),me.hidePreloader(),me.onLongActionEnd(Asc.c_oAscAsyncActionType.BlockInteraction,LoadingDocument),Common.Utils.InternalSettings.set("de-settings-datetime-default",Common.localStorage.getItem("de-settings-datetime-default")),this.isLiveCommenting=Common.localStorage.getBool("de-settings-livecomment",!0),Common.Utils.InternalSettings.set("de-settings-livecomment",this.isLiveCommenting),value=Common.localStorage.getBool("de-settings-resolvedcomment"),Common.Utils.InternalSettings.set("de-settings-resolvedcomment",value),this.isLiveCommenting?this.api.asc_showComments(value):this.api.asc_hideComments(),value=Common.localStorage.getItem("de-settings-zoom"),Common.Utils.InternalSettings.set("de-settings-zoom",value),null!==value?parseInt(value):this.appOptions.customization&&this.appOptions.customization.zoom?parseInt(this.appOptions.customization.zoom):100),value=Common.localStorage.getItem("de-last-zoom"),lastZoom=null!==value?parseInt(value):0;switch(-1==zf?this.api.zoomFitToPage():-2==zf?this.api.zoomFitToWidth():this.api.zoom(0<zf?zf:-3==zf&&0<lastZoom?lastZoom:100),value=Common.localStorage.getItem("de-show-hiddenchars"),me.api.put_ShowParaMarks(null!==value&&eval(value)),value=Common.localStorage.getItem("de-show-tableline"),me.api.put_ShowTableEmptyLine(null===value||eval(value)),value=Common.UI.FeaturesManager.getInitValue("spellcheck",!0),value=void 0!==value?value:!(this.appOptions.customization&&!1===this.appOptions.customization.spellcheck),this.appOptions.customization&&this.appOptions.customization.spellcheck,Common.UI.FeaturesManager.canChange("spellcheck")&&(value=Common.localStorage.getBool("de-settings-spellcheck",value),Common.Utils.InternalSettings.set("de-settings-spellcheck",value)),me.api.asc_setSpellCheck(value),Common.NotificationCenter.trigger("spelling:turn",value?"on":"off",!0),Common.UI.FeaturesManager.canChange("spellcheck")&&(value=Common.localStorage.getBool("de-spellcheck-ignore-uppercase-words",!0),Common.Utils.InternalSettings.set("de-spellcheck-ignore-uppercase-words",value),value=Common.localStorage.getBool("de-spellcheck-ignore-numbers-words",!0),Common.Utils.InternalSettings.set("de-spellcheck-ignore-numbers-words",value),value=new AscCommon.CSpellCheckSettings,value.put_IgnoreWordsInUppercase(Common.Utils.InternalSettings.get("de-spellcheck-ignore-uppercase-words")),value.put_IgnoreWordsWithNumbers(Common.Utils.InternalSettings.get("de-spellcheck-ignore-numbers-words")),this.api.asc_setSpellCheckSettings(value)),value=Common.localStorage.getBool("de-settings-compatible",!1),Common.Utils.InternalSettings.set("de-settings-compatible",value),Common.Utils.InternalSettings.set("de-settings-showsnaplines",me.api.get_ShowSnapLines()),void 0!==document.hidden&&document.hidden?document.addEventListener("visibilitychange",checkWarns):checkWarns(),me.api.asc_registerCallback("asc_onStartAction",_.bind(me.onLongActionBegin,me)),me.api.asc_registerCallback("asc_onEndAction",_.bind(me.onLongActionEnd,me)),me.api.asc_registerCallback("asc_onCoAuthoringDisconnect",_.bind(me.onCoAuthoringDisconnect,me)),me.api.asc_registerCallback("asc_onPrint",_.bind(me.onPrint,me)),me.api.asc_registerCallback("asc_onConfirmAction",_.bind(me.onConfirmAction,me)),me.api.asc_registerCallback("asc_onSave",_.bind(me.onSave,me)),me.api.asc_registerCallback("asc_writeFile",_.bind(me.writeFile,me)),appHeader.setDocumentCaption(me.api.asc_getDocumentName()),me.updateWindowTitle(!0),value=Common.localStorage.getBool("de-settings-show-alt-hints",!0),Common.Utils.InternalSettings.set("de-settings-show-alt-hints",value),me._state.fastCoauth=Common.Utils.InternalSettings.get("de-settings-coauthmode"),me.api.asc_SetFastCollaborative(me._state.fastCoauth),value=Common.Utils.InternalSettings.get(me._state.fastCoauth?"de-settings-showchanges-fast":"de-settings-showchanges-strict"),value){case"all":value=Asc.c_oAscCollaborativeMarksShowType.All;break;case"none":value=Asc.c_oAscCollaborativeMarksShowType.None;break;case"last":value=Asc.c_oAscCollaborativeMarksShowType.LastChanges;break;default:value=me._state.fastCoauth?Asc.c_oAscCollaborativeMarksShowType.None:Asc.c_oAscCollaborativeMarksShowType.LastChanges}me.api.SetCollaborativeMarksShowType(value),me.api.asc_setAutoSaveGap(Common.Utils.InternalSettings.get("de-settings-autosave")),me.api.asc_SetPerformContentControlActionByClick(me.appOptions.isRestrictedEdit&&me.appOptions.canFillForms);var application=me.getApplication(),toolbarController=application.getController("Toolbar"),statusbarController=application.getController("Statusbar"),documentHolderController=application.getController("DocumentHolder"),fontsController=application.getController("Common.Controllers.Fonts"),rightmenuController=application.getController("RightMenu"),leftmenuController=application.getController("LeftMenu"),chatController=application.getController("Common.Controllers.Chat"),pluginsController=application.getController("Common.Controllers.Plugins"),navigationController=application.getController("Navigation"),timer_sl,dummyClass=(leftmenuController.getView("LeftMenu").getMenu("file").loadDocument({doc:me.document}),leftmenuController.createDelayedElements().setApi(me.api),navigationController.setMode(me.appOptions).setApi(me.api),application.getController("Common.Controllers.ExternalDiagramEditor").setApi(this.api).loadConfig({config:this.editorConfig,customization:this.editorConfig.customization}),application.getController("Common.Controllers.ExternalMergeEditor").setApi(this.api).loadConfig({config:this.editorConfig,customization:this.editorConfig.customization}),application.getController("Common.Controllers.ExternalOleEditor").setApi(this.api).loadConfig({config:this.editorConfig,customization:this.editorConfig.customization}),pluginsController.setApi(me.api),documentHolderController.setApi(me.api),statusbarController.createDelayedElements(),leftmenuController.getView("LeftMenu").disableMenu("all",!1),documentHolderController.getView().on("editcomplete",_.bind(me.onEditComplete,me)),me.appOptions.isEdit?(me.appOptions.canForcesave&&(me.appOptions.forcesave=Common.localStorage.getBool("de-settings-forcesave",me.appOptions.canForcesave),Common.Utils.InternalSettings.set("de-settings-forcesave",me.appOptions.forcesave),me.api.asc_setIsForceSaveOnUserSave(me.appOptions.forcesave)),value=Common.localStorage.getItem("de-settings-paste-button"),null===value&&(value="1"),Common.Utils.InternalSettings.set("de-settings-paste-button",parseInt(value)),me.api.asc_setVisiblePasteButton(!!parseInt(value)),value=Common.localStorage.getBool("de-settings-smart-selection",!0),Common.Utils.InternalSettings.set("de-settings-smart-selection",value),me.api.asc_putSmartParagraphSelection(value),me.loadAutoCorrectSettings(),me.needToUpdateVersion&&Common.NotificationCenter.trigger("api:disconnect"),timer_sl=setInterval(function(){var t;window.styles_loaded&&(clearInterval(timer_sl),toolbarController.createDelayedElements(),documentHolderController.getView().createDelayedElements(),me.setLanguages(),(t=me.api.asc_getPropertyEditorShapes())&&me.fillAutoShapes(t[0],t[1]),rightmenuController.createDelayedElements(),me.updateThemeColors(),toolbarController.activateControls(),me.needToUpdateVersion&&toolbarController.onApiCoAuthoringDisconnect(),me.api.UpdateInterfaceState(),Common.NotificationCenter.trigger("document:ready","main"),me.applyLicense())},50)):(documentHolderController.getView().createDelayedElementsViewer(),Common.NotificationCenter.trigger("document:ready","main"),me.applyLicense()),~~(1e6*Math.random()));$(".toolbar").prepend(Common.Utils.String.format('<div class="lazy-{0} x-huge"><div class="toolbar__icon" style="position: absolute; width: 1px; height: 1px;"></div>',dummyClass)),setTimeout(function(){$(Common.Utils.String.format(".toolbar .lazy-{0}",dummyClass)).remove()},10),this.appOptions.canAnalytics,Common.Gateway.on("applyeditrights",_.bind(me.onApplyEditRights,me)),Common.Gateway.on("processsaveresult",_.bind(me.onProcessSaveResult,me)),Common.Gateway.on("processrightschange",_.bind(me.onProcessRightsChange,me)),Common.Gateway.on("processmouse",_.bind(me.onProcessMouse,me)),Common.Gateway.on("refreshhistory",_.bind(me.onRefreshHistory,me)),Common.Gateway.on("downloadas",_.bind(me.onDownloadAs,me)),Common.Gateway.on("setfavorite",_.bind(me.onSetFavorite,me)),Common.Gateway.on("requestclose",_.bind(me.onRequestClose,me)),Common.Gateway.sendInfo({mode:me.appOptions.isEdit?"edit":"view"}),$(document).on("contextmenu",_.bind(me.onContextMenu,me)),Common.Gateway.documentReady(),$("#editor-container").css("overflow",""),$(".doc-placeholder").remove();const loadingTime=Date.now()-window.__append_placeholder;function checkWarns(){var t=[];Common.Utils.isIE9m&&t.push(me.warnBrowserIE9),t.length&&me.showTips(t),document.removeEventListener("visibilitychange",checkWarns)}log.debug("删除骨架图",Date.now()-window.__start,"骨架图显示时间：",loadingTime),Common.Analytics.trackPerf(loadingTime),this.appOptions.user.guest&&this.appOptions.canRenameAnonymous&&null===Common.Utils.InternalSettings.get("guest-username")&&this.showRenameUserDialog(),this._needToSaveAsFile&&this.getApplication().getController("LeftMenu").leftMenu.showMenu("file:saveas")}},onLicenseChanged:function(t){t=t.asc_getLicenseType();void 0!==t&&(this.appOptions.canEdit||this.appOptions.isRestrictedEdit)&&"view"!==this.editorConfig.mode&&(t===Asc.c_oLicenseResult.Connections||t===Asc.c_oLicenseResult.UsersCount||t===Asc.c_oLicenseResult.ConnectionsOS||t===Asc.c_oLicenseResult.UsersCountOS||t===Asc.c_oLicenseResult.SuccessLimit&&0!=(this.appOptions.trialMode&Asc.c_oLicenseMode.Limited))&&(this._state.licenseType=t),void 0===t||!this.appOptions.canLiveView||t!==Asc.c_oLicenseResult.ConnectionsLive&&t!==Asc.c_oLicenseResult.ConnectionsLiveOS&&t!==Asc.c_oLicenseResult.UsersViewCount&&t!==Asc.c_oLicenseResult.UsersViewCountOS||(this._state.licenseType=t),this._isDocReady&&this.applyLicense()},applyLicense:function(){},onOpenDocument:function(t){},onEditorPermissions:function(t){var e,i=t.asc_getLicenseType();Asc.c_oLicenseResult.Expired===i||Asc.c_oLicenseResult.Error===i||Asc.c_oLicenseResult.ExpiredTrial===i||Asc.c_oLicenseResult.NotBefore===i||Asc.c_oLicenseResult.ExpiredLimited===i?Common.UI.warning({title:Asc.c_oLicenseResult.NotBefore===i?this.titleLicenseNotActive:this.titleLicenseExp,msg:Asc.c_oLicenseResult.NotBefore===i?this.warnLicenseBefore:this.warnLicenseExp,buttons:[],closable:!1}):!this.onServerVersion(t.asc_getBuildVersion())&&this.onLanguageLoaded()&&(e=/^(?:(pdf|djvu|xps|oxps))$/.test(this.document.fileType),this.permissions.review=void 0===this.permissions.review?!1!==this.permissions.edit:this.permissions.review,t.asc_getRights()!==Asc.c_oRights.Edit&&(this.permissions.edit=this.permissions.review=!1),this.appOptions.permissionsLicense=i,this.appOptions.canAnalytics=t.asc_getIsAnalyticsEnable(),this.appOptions.canLicense=i===Asc.c_oLicenseResult.Success||i===Asc.c_oLicenseResult.SuccessLimit,this.appOptions.isLightVersion=t.asc_getIsLight(),this.appOptions.canCoAuthoring=!this.appOptions.isLightVersion,this.appOptions.isOffline=this.api.asc_isOffline(),this.appOptions.canCreateNew=this.appOptions.canCreateNew&&!(this.appOptions.isOffline&&e),this.appOptions.isCrypted=this.api.asc_isCrypto(),this.appOptions.isReviewOnly=!0===this.permissions.review&&!1===this.permissions.edit,this.appOptions.canRequestEditRights=this.editorConfig.canRequestEditRights,this.appOptions.canEdit=(!1!==this.permissions.edit||!0===this.permissions.review)&&(this.editorConfig.canRequestEditRights||"view"!==this.editorConfig.mode)&&(!this.appOptions.isReviewOnly||this.appOptions.canLicense),this.appOptions.isEdit=this.appOptions.canLicense&&this.appOptions.canEdit&&"view"!==this.editorConfig.mode,this.appOptions.canReview=!0===this.permissions.review&&this.appOptions.canLicense&&this.appOptions.isEdit,this.appOptions.canViewReview=!0,this.appOptions.canUseHistory=this.appOptions.canLicense&&this.editorConfig.canUseHistory&&this.appOptions.canCoAuthoring&&!this.appOptions.isOffline,this.appOptions.canHistoryClose=this.editorConfig.canHistoryClose,this.appOptions.canHistoryRestore=this.editorConfig.canHistoryRestore,this.appOptions.canUseMailMerge=this.appOptions.canLicense&&this.appOptions.canEdit&&!this.appOptions.isOffline,this.appOptions.canSendEmailAddresses=this.appOptions.canLicense&&this.editorConfig.canSendEmailAddresses&&this.appOptions.canEdit&&this.appOptions.canCoAuthoring,this.appOptions.canComments=this.appOptions.canLicense&&(void 0===this.permissions.comment?this.appOptions.isEdit:this.permissions.comment)&&"view"!==this.editorConfig.mode,this.appOptions.canComments=!e&&this.appOptions.canComments&&!("object"==typeof this.editorConfig.customization&&!1===this.editorConfig.customization.comments),this.appOptions.canViewComments=this.appOptions.canComments||!e&&!("object"==typeof this.editorConfig.customization&&!1===this.editorConfig.customization.comments),this.appOptions.canChat=this.appOptions.canLicense&&!this.appOptions.isOffline&&!(!1===this.permissions.chat||void 0===this.permissions.chat&&"object"==typeof this.editorConfig.customization&&!1===this.editorConfig.customization.chat),"object"==typeof this.editorConfig.customization&&this.editorConfig.customization.chat,this.appOptions.canEditStyles=this.appOptions.canLicense&&this.appOptions.canEdit,this.appOptions.canPrint=!1!==this.permissions.print,this.appOptions.canPreviewPrint=this.appOptions.canPrint&&!Common.Utils.isMac&&this.appOptions.isDesktopApp,this.appOptions.canQuickPrint=this.appOptions.canPrint&&!Common.Utils.isMac&&this.appOptions.isDesktopApp,this.appOptions.canRename=this.editorConfig.canRename,this.appOptions.buildVersion=t.asc_getBuildVersion(),this.appOptions.canForcesave=this.appOptions.isEdit&&!this.appOptions.isOffline&&"object"==typeof this.editorConfig.customization&&!!this.editorConfig.customization.forcesave,this.appOptions.forcesave=this.appOptions.canForcesave,this.appOptions.canEditComments=this.appOptions.isOffline||!this.permissions.editCommentAuthorOnly,this.appOptions.canDeleteComments=this.appOptions.isOffline||!this.permissions.deleteCommentAuthorOnly,"object"==typeof this.editorConfig.customization&&!0===this.editorConfig.customization.commentAuthorOnly&&void 0===this.permissions.editCommentAuthorOnly&&void 0===this.permissions.deleteCommentAuthorOnly&&(this.appOptions.canEditComments=this.appOptions.canDeleteComments=this.appOptions.isOffline),"object"==typeof this.editorConfig.customization&&(this.editorConfig.customization.showReviewChanges,this.editorConfig.customization.reviewDisplay,this.editorConfig.customization.trackChanges),this.appOptions.trialMode=t.asc_getLicenseMode(),this.appOptions.isBeta=t.asc_getIsBeta(),this.appOptions.isSignatureSupport=this.appOptions.isEdit&&this.appOptions.isDesktopApp&&this.appOptions.isOffline&&this.api.asc_isSignaturesSupport()&&!1!==this.permissions.protect,this.appOptions.isPasswordSupport=this.appOptions.isEdit&&this.api.asc_isProtectionSupport()&&!1!==this.permissions.protect,this.appOptions.canProtect=!1!==this.permissions.protect,this.appOptions.canEditContentControl=!1!==this.permissions.modifyContentControl,this.appOptions.canHelp=!("object"==typeof this.editorConfig.customization&&!1===this.editorConfig.customization.help),this.appOptions.canSubmitForms=!1,this.appOptions.canFillForms=this.appOptions.canLicense&&(!!this.appOptions.isEdit||this.permissions.fillForms)&&"view"!==this.editorConfig.mode,this.appOptions.isRestrictedEdit=!this.appOptions.isEdit&&(this.appOptions.canComments||this.appOptions.canFillForms),this.appOptions.isRestrictedEdit&&this.appOptions.canComments&&this.appOptions.canFillForms&&(this.appOptions.canComments=!1),this.appOptions.isLightVersion&&(this.appOptions.canUseHistory=this.appOptions.isReviewOnly=!1),this.appOptions.canCoAuthoring||(this.appOptions.canChat=!1),this.appOptions.canDownloadOrigin=!1,this.appOptions.canDownload=!1!==this.permissions.download,this.appOptions.canUseSelectHandTools=this.appOptions.canUseThumbnails=this.appOptions.canUseViwerNavigation=e,this.appOptions.canDownloadForms=this.appOptions.canLicense&&this.appOptions.canDownload,this.appOptions.fileKey=this.document.key,this.appOptions.canBranding=t.asc_getCustomization(),this.appOptions.canBranding&&appHeader.setBranding(this.editorConfig.customization),this.appOptions.canFavorite=this.document.info&&void 0!==this.document.info.favorite&&null!==this.document.info.favorite&&!this.appOptions.isOffline,this.appOptions.canFavorite&&appHeader.setFavorite(this.document.info.favorite),this.appOptions.canUseReviewPermissions=this.appOptions.canLicense&&(!!this.permissions.reviewGroups||this.editorConfig.customization&&this.editorConfig.customization.reviewPermissions&&"object"==typeof this.editorConfig.customization.reviewPermissions),this.appOptions.canUseCommentPermissions=this.appOptions.canLicense&&!!this.permissions.commentGroups,this.appOptions.canUseUserInfoPermissions=this.appOptions.canLicense&&!!this.permissions.userInfoGroups,this.appOptions.canUseReviewPermissions&&AscCommon.UserInfoParser.setReviewPermissions(this.permissions.reviewGroups,this.editorConfig.customization.reviewPermissions),this.appOptions.canUseCommentPermissions&&AscCommon.UserInfoParser.setCommentPermissions(this.permissions.commentGroups),this.appOptions.canUseUserInfoPermissions&&AscCommon.UserInfoParser.setUserInfoPermissions(this.permissions.userInfoGroups),this.appOptions.canRename&&appHeader.setCanRename(!0),this.appOptions.canBrandingExt=t.asc_getCanBranding()&&("object"==typeof this.editorConfig.customization||this.editorConfig.plugins),this.getApplication().getController("Common.Controllers.Plugins").setMode(this.appOptions,this.api),this.editorConfig.customization&&Common.UI.LayoutManager.init(this.editorConfig.customization.layout,this.appOptions.canBrandingExt),this.editorConfig.customization&&Common.UI.FeaturesManager.init(this.editorConfig.customization.features,this.appOptions.canBrandingExt),Common.UI.ExternalUsers.init(this.appOptions.canRequestUsers),this.appOptions.canComments&&Common.NotificationCenter.on("comments:cleardummy",_.bind(this.onClearDummyComment,this)),Common.NotificationCenter.on("comments:showdummy",_.bind(this.onShowDummyComment,this)),this.appOptions.canLiveView=!!t.asc_getLiveViewerSupport()&&"view"===this.editorConfig.mode&&!e,this.appOptions.canChangeCoAuthoring=this.appOptions.isEdit&&this.appOptions.canCoAuthoring&&!(this.editorConfig.coEditing&&"object"==typeof this.editorConfig.coEditing&&!1===this.editorConfig.coEditing.change)||this.appOptions.canLiveView&&!(this.editorConfig.coEditing&&"object"==typeof this.editorConfig.coEditing&&!1===this.editorConfig.coEditing.change),this.appOptions.isAnonymousSupport=!!this.api.asc_isAnonymousSupport(),this.loadCoAuthSettings(),this.applyModeCommonElements(),this.applyModeEditorElements(),this.appOptions.isEdit||(Common.NotificationCenter.trigger("app:face",this.appOptions),this.hidePreloader(),this.onLongActionBegin(Asc.c_oAscAsyncActionType.BlockInteraction,LoadingDocument)),this.api.asc_setViewMode(!this.appOptions.isEdit&&!this.appOptions.isRestrictedEdit),this.appOptions.isRestrictedEdit&&this.appOptions.canComments&&this.api.asc_setRestriction(Asc.c_oAscRestrictionType.OnlyComments),this.appOptions.isRestrictedEdit&&this.appOptions.canFillForms&&this.api.asc_setRestriction(Asc.c_oAscRestrictionType.OnlyForms),this.appOptions.isRestrictedEdit&&this.appOptions.canFillForms&&this.api.asc_SetHighlightRequiredFields(!0),this.api.asc_LoadDocument())},loadCoAuthSettings:function(){var t,e=!0,i=1;this.appOptions.isEdit&&!this.appOptions.isOffline&&this.appOptions.canCoAuthoring?(this.appOptions.canChangeCoAuthoring?null===(t=Common.localStorage.getItem("de-settings-coauthmode"))&&null===(t=this.editorConfig.coEditing&&void 0!==this.editorConfig.coEditing.mode?"strict"===this.editorConfig.coEditing.mode?0:1:null)&&!Common.localStorage.itemExists("de-settings-autosave")&&this.appOptions.customization&&!1===this.appOptions.customization.autosave&&(t=0):null===(t=this.editorConfig.coEditing&&void 0!==this.editorConfig.coEditing.mode?"strict"===this.editorConfig.coEditing.mode?0:1:null)&&this.appOptions.customization&&!1===this.appOptions.customization.autosave&&(t=0),e=null===t||1==parseInt(t),t=Common.localStorage.getItem(e?"de-settings-showchanges-fast":"de-settings-showchanges-strict"),Common.Utils.InternalSettings.set(e?"de-settings-showchanges-fast":"de-settings-showchanges-strict",t=null==t?e?"none":"last":t)):!this.appOptions.isEdit&&this.appOptions.isRestrictedEdit?e=!0:this.appOptions.canLiveView&&!this.appOptions.isOffline?(t=Common.localStorage.getItem("de-settings-view-coauthmode"),this.appOptions.canChangeCoAuthoring&&null!==t||(t=this.editorConfig.coEditing&&"strict"===this.editorConfig.coEditing.mode?0:1),e=1==parseInt(t),Common.Utils.InternalSettings.set("de-settings-showchanges-fast","none"),Common.Utils.InternalSettings.set("de-settings-showchanges-strict","none")):(e=!1,i=0),this.appOptions.isEdit&&(null===(t=Common.localStorage.getItem("de-settings-autosave"))&&this.appOptions.customization&&!1===this.appOptions.customization.autosave&&(t=0),i=e||null===t?this.appOptions.canCoAuthoring?1:0:parseInt(t)),Common.Utils.InternalSettings.set("de-settings-coauthmode",e),Common.Utils.InternalSettings.set("de-settings-autosave",i)},applyModeCommonElements:function(){window.editor_elements_prepared=!0;var t=this.getApplication(),e=t.getController("Viewport").getView("Viewport"),i=t.getController("Statusbar").getView("Statusbar"),n=t.getController("DocumentHolder"),o=t.getController("Toolbar"),s=t.getController("LeftMenu"),i=(e&&e.setMode(this.appOptions),i&&i.setMode(this.appOptions),o.setMode(this.appOptions),n.setMode(this.appOptions),s.setMode(this.appOptions),e.applyCommonMode(),t.getController("Print")),o=(i&&this.api&&i.setApi(this.api).setMode(this.appOptions),this.api.asc_registerCallback("asc_onSendThemeColors",_.bind(this.onSendThemeColors,this)),this.api.asc_registerCallback("asc_onDownloadUrl",_.bind(this.onDownloadUrl,this)),this.api.asc_registerCallback("asc_onAuthParticipantsChanged",_.bind(this.onAuthParticipantsChanged,this)),this.api.asc_registerCallback("asc_onParticipantsChanged",_.bind(this.onAuthParticipantsChanged,this)),this.api.asc_registerCallback("asc_onDocumentModifiedChanged",_.bind(this.onDocumentModifiedChanged,this)),Common.localStorage.getItem("de-settings-unit"));void 0===(o=null!==o?parseInt(o):this.appOptions.customization&&this.appOptions.customization.unit?Common.Utils.Metric.c_MetricUnits[this.appOptions.customization.unit.toLocaleLowerCase()]:Common.Utils.Metric.getDefaultMetric())&&(o=Common.Utils.Metric.getDefaultMetric()),Common.Utils.Metric.setCurrentMetric(o),Common.Utils.InternalSettings.set("de-settings-unit",o)},applyModeEditorElements:function(){this.contComments.setMode(this.appOptions),this.contComments.setConfig({config:this.editorConfig},this.api);var t,e,i=this,n=this.getApplication(),o=(n.getController("Common.Controllers.ReviewChanges").setMode(i.appOptions).setConfig({config:i.editorConfig},i.api).loadDocument({doc:i.document}),n.getController("Toolbar"));o&&o.setApi(i.api),this.appOptions.isRestrictedEdit?n.getController("DocProtection").setMode(i.appOptions).setConfig({config:i.editorConfig},i.api):this.appOptions.isEdit&&(e=n.getController("RightMenu"),(t=n.getController("Common.Controllers.Fonts"))&&t.setApi(i.api),e&&e.setApi(i.api),n.getController("Common.Controllers.Protection").setMode(i.appOptions).setConfig({config:i.editorConfig},i.api),n.getController("DocProtection").setMode(i.appOptions).setConfig({config:i.editorConfig},i.api),this.getApplication().getController("Viewport").getView("Viewport").applyEditorMode(),(t=e.getView("RightMenu"))&&(t.setApi(i.api),t.on("editcomplete",_.bind(i.onEditComplete,i)),t.setMode(i.appOptions)),(n=o?o.getView():null)&&(n.setApi(i.api),n.on("editcomplete",_.bind(i.onEditComplete,i)),n.on("insertimage",_.bind(i.onInsertImage,i)),n.on("inserttable",_.bind(i.onInsertTable,i)),n.on("insertshape",_.bind(i.onInsertShape,i)),n.on("inserttextart",_.bind(i.onInsertTextArt,i)),n.on("insertchart",_.bind(i.onInsertChart,i)),n.on("insertcontrol",_.bind(i.onInsertControl,i))),e=Common.Utils.InternalSettings.get("de-settings-unit"),i.api.asc_SetDocumentUnits(e==Common.Utils.Metric.c_MetricUnits.inch?Asc.c_oAscDocumentUnits.Inch:e==Common.Utils.Metric.c_MetricUnits.pt?Asc.c_oAscDocumentUnits.Point:Asc.c_oAscDocumentUnits.Millimeter),e=Common.localStorage.itemExists("de-hidden-rulers")?Common.localStorage.getBool("de-hidden-rulers"):this.appOptions.customization&&!!this.appOptions.customization.hideRulers,Common.Utils.InternalSettings.set("de-hidden-rulers",e),i.api.asc_SetViewRulers(!e),i.api.asc_registerCallback("asc_onDocumentCanSaveChanged",_.bind(i.onDocumentCanSaveChanged,i)),i.api.asc_registerCallback("asc_onCollaborativeChanges",_.bind(i.onCollaborativeChanges,i)),i.api.asc_registerCallback("asc_OnTryUndoInFastCollaborative",_.bind(i.onTryUndoInFastCollaborative,i)),i.api.asc_registerCallback("asc_onConvertEquationToMath",_.bind(i.onConvertEquationToMath,i)),i.stackLongActions.exist({id:ApplyEditRights,type:Asc.c_oAscAsyncActionType.BlockInteraction})?i.onLongActionEnd(Asc.c_oAscAsyncActionType.BlockInteraction,ApplyEditRights):this._isDocReady||(Common.NotificationCenter.trigger("app:face",i.appOptions),i.hidePreloader(),i.onLongActionBegin(Asc.c_oAscAsyncActionType.BlockInteraction,LoadingDocument)),window.onbeforeunload=_.bind(i.onBeforeUnload,i),window.onunload=_.bind(i.onUnload,i))},onExternalMessage:function(t,e){t&&t.msg&&(t.msg=t.msg.toString(),this.showTips([t.msg.charAt(0).toUpperCase()+t.msg.substring(1)],e),Common.component.Analytics.trackEvent("External Error"))},onError:function(e,t,i){if(e==Asc.c_oAscError.ID.LoadingScriptError)this.showTips([this.scriptLoadError]),this.tooltip&&this.tooltip.getBSTip().$tip.css("z-index",1e4);else if(e==Asc.c_oAscError.ID.CanNotPasteImage)this.showTips([this.errorCannotPasteImg],{timeout:7e3,hideCloseTip:!0});else{this.hidePreloader(),this.onLongActionEnd(Asc.c_oAscAsyncActionType.BlockInteraction,LoadingDocument);var n={closable:!0};switch(e){case Asc.c_oAscError.ID.Unknown:n.msg=this.unknownErrorText;break;case Asc.c_oAscError.ID.ConvertationTimeout:n.msg=this.convertationTimeoutText;break;case Asc.c_oAscError.ID.ConvertationOpenError:n.msg=this.openErrorText;break;case Asc.c_oAscError.ID.ConvertationSaveError:n.msg=this.appOptions.isDesktopApp&&this.appOptions.isOffline?this.saveErrorTextDesktop:this.saveErrorText;break;case Asc.c_oAscError.ID.DownloadError:n.msg=this.downloadErrorText;break;case Asc.c_oAscError.ID.UplImageSize:n.msg=this.uploadImageSizeMessage;break;case Asc.c_oAscError.ID.UplImageExt:n.msg=this.uploadImageExtMessage;break;case Asc.c_oAscError.ID.UplImageFileCount:n.msg=this.uploadImageFileCountMessage;break;case Asc.c_oAscError.ID.UplDocumentSize:n.msg=this.uploadDocSizeMessage;break;case Asc.c_oAscError.ID.UplDocumentExt:n.msg=this.uploadDocExtMessage;break;case Asc.c_oAscError.ID.UplDocumentFileCount:n.msg=this.uploadDocFileCountMessage;break;case Asc.c_oAscError.ID.SplitCellMaxRows:n.msg=this.splitMaxRowsErrorText.replace("%1",i.get_Value());break;case Asc.c_oAscError.ID.SplitCellMaxCols:n.msg=this.splitMaxColsErrorText.replace("%1",i.get_Value());break;case Asc.c_oAscError.ID.SplitCellRowsDivider:n.msg=this.splitDividerErrorText.replace("%1",i.get_Value());break;case Asc.c_oAscError.ID.VKeyEncrypt:n.msg=this.errorToken;break;case Asc.c_oAscError.ID.KeyExpire:n.msg=this.errorTokenExpire;break;case Asc.c_oAscError.ID.UserCountExceed:n.msg=this.errorUsersExceed;break;case Asc.c_oAscError.ID.CoAuthoringDisconnect:n.msg=this.errorViewerDisconnect;break;case Asc.c_oAscError.ID.ConvertationPassword:n.msg=this.errorFilePassProtect;break;case Asc.c_oAscError.ID.StockChartError:n.msg=this.errorStockChart;break;case Asc.c_oAscError.ID.DataRangeError:n.msg=this.errorDataRange;break;case Asc.c_oAscError.ID.Database:n.msg=this.errorDatabaseConnection;break;case Asc.c_oAscError.ID.UserDrop:if(this._state.lostEditingRights)return void(this._state.lostEditingRights=!1);this._state.lostEditingRights=!0,n.msg=this.errorUserDrop,Common.NotificationCenter.trigger("collaboration:sharingdeny");break;case Asc.c_oAscError.ID.MailMergeLoadFile:n.msg=this.errorMailMergeLoadFile;break;case Asc.c_oAscError.ID.MailMergeSaveFile:n.msg=this.errorMailMergeSaveFile;break;case Asc.c_oAscError.ID.Warning:n.msg=this.errorConnectToServer,n.closable=!1;break;case Asc.c_oAscError.ID.SessionAbsolute:n.msg=this.errorSessionAbsolute;break;case Asc.c_oAscError.ID.SessionIdle:n.msg=this.errorSessionIdle;break;case Asc.c_oAscError.ID.SessionToken:n.msg=this.errorSessionToken;break;case Asc.c_oAscError.ID.AccessDeny:n.msg=this.errorAccessDeny;break;case Asc.c_oAscError.ID.UplImageUrl:n.msg=this.errorBadImageUrl;break;case Asc.c_oAscError.ID.ForceSaveButton:case Asc.c_oAscError.ID.ForceSaveTimeout:n.msg=this.errorForceSave,n.maxwidth=600;break;case Asc.c_oAscError.ID.DataEncrypted:n.msg=this.errorDataEncrypted;break;case Asc.c_oAscError.ID.EditingError:n.msg=this.appOptions.isDesktopApp&&this.appOptions.isOffline?this.errorEditingSaveas:this.errorEditingDownloadas;break;case Asc.c_oAscError.ID.MailToClientMissing:n.msg=this.errorEmailClient;break;case Asc.c_oAscError.ID.ConvertationOpenLimitError:n.msg=this.errorFileSizeExceed;break;case Asc.c_oAscError.ID.UpdateVersion:n.msg=this.errorUpdateVersionOnDisconnect,n.maxwidth=600;break;case Asc.c_oAscError.ID.DirectUrl:n.msg=this.errorDirectUrl;break;case Asc.c_oAscError.ID.CannotCompareInCoEditing:n.msg=this.errorCompare;break;case Asc.c_oAscError.ID.ComboSeriesError:n.msg=this.errorComboSeries;break;case Asc.c_oAscError.ID.Password:n.msg=this.errorSetPassword;break;case Asc.c_oAscError.ID.Submit:n.msg=this.errorSubmit;break;case Asc.c_oAscError.ID.LoadingFontError:n.msg=this.errorLoadingFont;break;case Asc.c_oAscError.ID.ComplexFieldEmptyTOC:n.maxwidth=600,n.msg=this.errorEmptyTOC;break;case Asc.c_oAscError.ID.ComplexFieldNoTOC:n.msg=this.errorNoTOC;break;case Asc.c_oAscError.ID.TextFormWrongFormat:n.msg=this.errorTextFormWrongFormat;break;case Asc.c_oAscError.ID.PasswordIsNotCorrect:n.msg=this.errorPasswordIsNotCorrect;break;case Asc.c_oAscError.ID.ConvertationOpenFormat:n.maxwidth=600,n.msg="pdf"===i?this.errorInconsistentExtPdf.replace("%1",this.document.fileType||""):"docx"===i?this.errorInconsistentExtDocx.replace("%1",this.document.fileType||""):"xlsx"===i?this.errorInconsistentExtXlsx.replace("%1",this.document.fileType||""):"pptx"===i?this.errorInconsistentExtPptx.replace("%1",this.document.fileType||""):this.errorInconsistentExt;break;default:n.msg="string"==typeof e?e:this.errorDefaultMessage.replace("%1",e)}t==Asc.c_oAscError.Level.Critical?(Common.Gateway.reportError(e,n.msg),n.title=this.criticalErrorTitle,n.iconCls="error",n.closable=!1,this.appOptions.canBackToFolder&&!this.appOptions.isDesktopApp&&"string"!=typeof e&&(n.msg+="<br><br>"+this.criticalErrorExtText,n.callback=function(t){"ok"==t&&Common.NotificationCenter.trigger("goback",!0)}),/^https?:\/\//i.test(this.appOptions.document&&this.appOptions.document.url)&&(n.msg+=`，<a href="${this.appOptions.document.url}" download><b class="download">下载到本地</b></a>`),n.callback=t=>{Common.Gateway._postMessage({event:"onAlertOK",data:{button:t,type:"closeWindow"}})},e!=Asc.c_oAscError.ID.DataEncrypted&&e!=Asc.c_oAscError.ID.ConvertationOpenLimitError||(this.api.asc_coAuthoringDisconnect(),Common.NotificationCenter.trigger("api:disconnect"))):(Common.Gateway.reportWarning(e,n.msg),n.title=this.notcriticalErrorTitle,n.iconCls="warn",n.buttons=["ok"],n.callback=_.bind(function(t){var i;e==Asc.c_oAscError.ID.Warning&&"ok"==t&&(this.appOptions.canDownload||this.appOptions.canDownloadOrigin)?(Common.UI.Menu.Manager.hideAll(),this.appOptions.isDesktopApp&&this.appOptions.isOffline?this.api.asc_DownloadAs():this.appOptions.canDownload?this._isDocReady?this.getApplication().getController("LeftMenu").leftMenu.showMenu("file:saveas"):this._needToSaveAsFile=!0:this.api.asc_DownloadOrigin()):e==Asc.c_oAscError.ID.SplitCellMaxRows||e==Asc.c_oAscError.ID.SplitCellMaxCols||e==Asc.c_oAscError.ID.SplitCellRowsDivider?(i=this,setTimeout(function(){new Common.Views.InsertTableDialog({split:!0,handler:function(t,e){"ok"==t&&i.api&&i.api.SplitCell(e.columns,e.rows),i.onEditComplete()}}).show()},10)):e==Asc.c_oAscError.ID.EditingError&&(this.disableEditing(!0),Common.NotificationCenter.trigger("api:disconnect",!0)),this._state.lostEditingRights=!1,this.onEditComplete()},this)),(!Common.Utils.ModalWindow.isVisible()||$(".asc-window.modal.alert[data-value="+e+"]").length<1)&&Common.UI.alert(n).$window.attr("data-value",e),void 0!==e&&Common.component.Analytics.trackEvent("Internal Error",e.toString())}},onCoAuthoringDisconnect:function(){this.getApplication().getController("Viewport").getView("Viewport").setMode({isDisconnected:!0}),appHeader.setCanRename(!1),this.appOptions.canRename=!1,this._state.isDisconnected=!0},showTips:function(e,i){var n=this;function o(t){n.tipTimeout&&clearTimeout(n.tipTimeout),setTimeout(s,300)}function s(){var t=e.shift();t&&(i&&i.hideCloseTip||(t+="\n"+n.textCloseTip),n.tooltip.setTitle(t),n.tooltip.show(),n.tipTimeout&&clearTimeout(n.tipTimeout),i&&i.timeout&&(n.tipTimeout=setTimeout(function(){n.tooltip.hide(),o()},i.timeout)))}e.length&&("object"!=typeof e&&(e=[e]),this.tooltip||(this.tooltip=new Common.UI.Tooltip({owner:this.getApplication().getController("Toolbar").getView(),hideonclick:!0,placement:"bottom",cls:"main-info",offset:30}),this.tooltip.on("tooltip:hideonclick",o)),s())},updateWindowTitle:function(t){var e=this.api.isDocumentModified();this._state.isDocModified===e&&!t||(t=this.defaultTitleText,appHeader&&!_.isEmpty(appHeader.getDocumentCaption())&&(t=appHeader.getDocumentCaption()+(t?" - ":"")+t),e&&(clearTimeout(this._state.timerCaption),_.isUndefined(t)||(t="* "+t)),window.parent.document.title!=t&&(window.parent.document.title=t),this._isDocReady&&this._state.isDocModified!==e&&Common.Gateway.setDocumentModified(e),e&&(!this._state.fastCoauth||this._state.usersCount<2)&&this.getApplication().getController("Statusbar").setStatusCaption("",!0),this._state.isDocModified=e)},onDocumentModifiedChanged:function(){var t,e,i=this.api.asc_isDocumentCanSave(),n=(this._state.isDocModified!==i&&this._isDocReady&&Common.Gateway.setDocumentModified(this.api.isDocumentModified()),this.updateWindowTitle(),this.getApplication().getController("Toolbar").getView());n&&n.btnCollabChanges&&!n._state.previewmode&&(t=n.btnCollabChanges.cmpEl.hasClass("notify"),e=this.appOptions.forcesave,i=!i&&!t&&!e||this._state.isDisconnected||this._state.fastCoauth&&1<this._state.usersCount&&!e,n.btnSave.setDisabled(i))},onDocumentCanSaveChanged:function(t){var e,i,n=this.getApplication().getController("Toolbar").getView();n&&this.api&&!n._state.previewmode&&(i=n.btnCollabChanges.cmpEl.hasClass("notify"),e=this.appOptions.forcesave,i=!t&&!i&&!e||this._state.isDisconnected||this._state.fastCoauth&&1<this._state.usersCount&&!e,n.btnSave.setDisabled(i)),Common.Gateway._postMessage({event:"onDocumentCanSaveChanged",data:{isCanSave:t}})},onContextMenu:function(t){var e=t.target.getAttribute("data-can-copy"),i=t.target instanceof HTMLInputElement||t.target instanceof HTMLTextAreaElement;if(i&&"false"===e||!i&&"true"!==e)return t.stopPropagation(),t.preventDefault(),!1},onBeforeUnload:function(){var t;if(Common.localStorage.save(),this.api.isDocumentModified())return(t=this).api.asc_stopSaving(),this._state.unloadTimer=1e3,this.continueSavingTimer=window.setTimeout(function(){t.api.asc_continueSaving(),t._state.unloadTimer=0},500),this.leavePageText;this._state.unloadTimer=1e4},onUnload:function(){this.continueSavingTimer&&clearTimeout(this.continueSavingTimer)},hidePreloader:function(){var t;this._state.customizationDone||(this._state.customizationDone=!0,this.appOptions.customization&&(this.appOptions.isDesktopApp?this.appOptions.customization.about=!1:this.appOptions.canBrandingExt||(this.appOptions.customization.about=!0)),Common.Utils.applyCustomization(this.appOptions.customization,mapCustomizationElements),this.appOptions.canBrandingExt&&(Common.Utils.applyCustomization(this.appOptions.customization,mapCustomizationExtElements),Common.UI.LayoutManager.applyCustomization(),this.appOptions.customization&&"object"==typeof this.appOptions.customization&&(this.appOptions.customization.leftMenu,this.appOptions.customization.rightMenu,this.appOptions.customization.statusBar,this.appOptions.customization.toolbar),t=this.getApplication().getController("Common.Controllers.Plugins").applyUICustomization())),Common.NotificationCenter.trigger("layout:changed","main"),(t||new Promise(function(t,e){t()})).then(function(){$("#loading-mask").hide().remove()})},onDownloadUrl:function(t,e){this._state.isFromGatewayDownloadAs&&Common.Gateway.downloadAs(t,e),this._state.isFromGatewayDownloadAs=!1},onUpdateVersion:function(t){var e=this;e.needToUpdateVersion=!0,e.onLongActionEnd(Asc.c_oAscAsyncActionType.BlockInteraction,LoadingDocument),Common.UI.warning({title:e.titleUpdateVersion,msg:this.errorUpdateVersion,callback:function(){_.defer(function(){Common.Gateway.updateVersion(),t&&t.call(e),e.onLongActionBegin(Asc.c_oAscAsyncActionType.BlockInteraction,LoadingDocument)})}})},onServerVersion:function(t){return!1},onCollaborativeChanges:function(){this._state.hasCollaborativeChanges||(this._state.hasCollaborativeChanges=!0,this.appOptions.isEdit&&this.getApplication().getController("Statusbar").setStatusCaption(this.txtNeedSynchronize,!0))},synchronizeChanges:function(){this.getApplication().getController("Statusbar").synchronizeChanges(),this.getApplication().getController("Common.Controllers.ReviewChanges").synchronizeChanges(),this.getApplication().getController("DocumentHolder").hideTips(),this.getApplication().getController("Toolbar").getView().synchronizeChanges(),this._state.hasCollaborativeChanges=!1},initNames:function(){this.shapeGroupNames=[this.txtLines,this.txtRectangles,this.txtBasicShapes,this.txtFiguredArrows,this.txtMath,this.txtCharts,this.txtStarsRibbons,this.txtCallouts,this.txtButtons]},fillAutoShapes:function(t,a){var l,r,e,c;_.isEmpty(a)||_.isEmpty(t)||a.length!=t.length||(r=[],e=(l=this).getCollection("ShapeGroups"),c={},e.reset(),_.each(t,function(t,e){var i=new Backbone.Collection([],{model:DE.Models.ShapeModel}),n=[],o=18<a[e].length?7:6,s=35*Math.ceil(a[e].length/o)+3,o=30*o;_.each(a[e],function(t,e){var i=l["txtShape_"+t.Type];n.push({data:{shapeType:t.Type},tip:i||l.textShape+" "+(e+1),allowSelected:!0,selected:!1}),i&&(c[t.Type]=i)}),i.add(n),r.push({groupName:l.shapeGroupNames[e],groupStore:i,groupWidth:o,groupHeight:s})}),e.add(r),setTimeout(function(){l.getApplication().getController("Toolbar").onApiAutoShapes()},50),this.api.asc_setShapeNames(c))},fillTextArt:function(t){var i=[],e=this.getCollection("Common.Collections.TextArt");!t&&0<e.length&&(t=this.api.asc_getTextArtPreviews()),_.isEmpty(t)||(_.each(t,function(t,e){i.push({imageUrl:t,data:e,allowSelected:!0,selected:!1})}),e.reset(i))},updateThemeColors:function(){var t=this;setTimeout(function(){t.getApplication().getController("RightMenu").UpdateThemeColors()},50),setTimeout(function(){t.getApplication().getController("Toolbar").updateThemeColors()},50)},onSendThemeColors:function(t,e){var i;Common.Utils.ThemeColor.setColors(t,e),window.styles_loaded&&(this.updateThemeColors(),i=this,setTimeout(function(){i.fillTextArt()},1))},loadLanguages:function(t){var e,i,n=[],o=Common.util.LanguageInfo.getLanguages();for(i in o)o.hasOwnProperty(i)&&(e=o[i])[2]&&n.push({displayValue:e[1],value:e[0],code:parseInt(i),spellcheck:-1<_.indexOf(t,i)});n.sort(function(t,e){return t.value<e.value?-1:t.value>e.value?1:0}),this.languages=n,window.styles_loaded&&this.setLanguages()},setLanguages:function(){(!this.languages||this.languages.length<1)&&this.loadLanguages([]),this.languages&&0<this.languages.length&&(this.getApplication().getController("DocumentHolder").getView().setLanguages(this.languages),this.getApplication().getController("Statusbar").setLanguages(this.languages),this.getApplication().getController("Common.Controllers.ReviewChanges").setLanguages(this.languages))},onInsertTable:function(){this.getApplication().getController("RightMenu").onInsertTable()},onInsertImage:function(){this.getApplication().getController("RightMenu").onInsertImage()},onInsertChart:function(){this.getApplication().getController("RightMenu").onInsertChart()},onInsertShape:function(){this.getApplication().getController("RightMenu").onInsertShape()},onInsertTextArt:function(){this.getApplication().getController("RightMenu").onInsertTextArt()},onInsertControl:function(){this.getApplication().getController("RightMenu").onInsertControl()},unitsChanged:function(t){var e=null!==(e=Common.localStorage.getItem("de-settings-unit"))?parseInt(e):Common.Utils.Metric.getDefaultMetric();Common.Utils.Metric.setCurrentMetric(e),Common.Utils.InternalSettings.set("de-settings-unit",e),this.api.asc_SetDocumentUnits(e==Common.Utils.Metric.c_MetricUnits.inch?Asc.c_oAscDocumentUnits.Inch:e==Common.Utils.Metric.c_MetricUnits.pt?Asc.c_oAscDocumentUnits.Point:Asc.c_oAscDocumentUnits.Millimeter),this.getApplication().getController("RightMenu").updateMetricUnit(),this.getApplication().getController("Toolbar").getView().updateMetricUnit(),this.appOptions.canPreviewPrint&&this.getApplication().getController("Print").getView("PrintWithPreview").updateMetricUnit()},onAdvancedOptions:function(i,t,n,o){var s;this._state.openDlg||(s=this,i==Asc.c_oAscAdvancedOptionsID.TXT?s._state.openDlg=new Common.Views.OpenDialog({title:Common.Views.OpenDialog.prototype.txtTitle.replace("%1","TXT"),closable:2==n,type:Common.Utils.importTextType.TXT,preview:t.asc_getData(),codepages:t.asc_getCodePages(),settings:t.asc_getRecommendedSettings(),api:s.api,handler:function(t,e){s.isShowOpenDialog=!1,"ok"==t&&s&&s.api&&(2==n?(o&&o.asc_setAdvancedOptions(e.textOptions),s.api.asc_DownloadAs(o)):s.api.asc_setAdvancedOptions(i,e.textOptions)),s._state.openDlg=null}}):i==Asc.c_oAscAdvancedOptionsID.DRM&&(s._state.openDlg=new Common.Views.OpenDialog({title:Common.Views.OpenDialog.prototype.txtTitleProtected,closeFile:s.appOptions.canRequestClose,type:Common.Utils.importTextType.DRM,warning:!(s.appOptions.isDesktopApp&&s.appOptions.isOffline)&&"string"==typeof t,warningMsg:t,validatePwd:!!s._state.isDRM,handler:function(t,e){s.isShowOpenDialog=!1,"ok"==t?s.api&&(s.api.asc_setAdvancedOptions(i,e.drmOptions),s.loadMask&&s.loadMask.show()):(Common.Gateway.requestClose(),Common.Controllers.Desktop.requestClose()),s._state.openDlg=null}}),s._state.isDRM=!0),s._state.openDlg&&(this.isShowOpenDialog=!0,this.loadMask&&this.loadMask.hide(),this.onLongActionEnd(Asc.c_oAscAsyncActionType.BlockInteraction,LoadingDocument),s._state.openDlg.show()))},onTryUndoInFastCollaborative:function(){Common.localStorage.getBool("de-hide-try-undoredo")||Common.UI.info({width:500,msg:this.appOptions.canChangeCoAuthoring?this.textTryUndoRedo:this.textTryUndoRedoWarn,iconCls:"info",buttons:this.appOptions.canChangeCoAuthoring?["custom","cancel"]:["ok"],primary:this.appOptions.canChangeCoAuthoring?"custom":"ok",customButtonText:this.textStrict,dontshow:!0,callback:_.bind(function(t,e){e&&Common.localStorage.setItem("de-hide-try-undoredo",1),"custom"==t&&(Common.localStorage.setItem("de-settings-coauthmode",0),Common.Utils.InternalSettings.set("de-settings-coauthmode",!1),this.api.asc_SetFastCollaborative(!1),this._state.fastCoauth=!1,Common.localStorage.setItem("de-settings-showchanges-strict","last"),this.api.SetCollaborativeMarksShowType(Asc.c_oAscCollaborativeMarksShowType.LastChanges),this.getApplication().getController("Common.Controllers.ReviewChanges").applySettings()),this.onEditComplete()},this)})},onAuthParticipantsChanged:function(t){var e=0;_.each(t,function(t){t.asc_getView()||e++}),this._state.usersCount=e},applySettings:function(){var t;this.appOptions.isEdit&&!this.appOptions.isOffline&&this.appOptions.canCoAuthoring&&(t=this._state.fastCoauth,this._state.fastCoauth=Common.localStorage.getBool("de-settings-coauthmode",!0),this._state.fastCoauth&&!t&&this.synchronizeChanges()),this.appOptions.canForcesave&&(this.appOptions.forcesave=Common.localStorage.getBool("de-settings-forcesave",this.appOptions.canForcesave),Common.Utils.InternalSettings.set("de-settings-forcesave",this.appOptions.forcesave),this.api.asc_setIsForceSaveOnUserSave(this.appOptions.forcesave))},onDocumentName:function(t){this.api.asc_setDocumentName(t),appHeader.setDocumentCaption(t),this.updateWindowTitle(!0)},onSave:function(e,t,i){Common.Gateway.off("asc_onSaveCallback"),Common.Gateway.on("asc_onSaveCallback",t=>{i({type:e.c,data:t},!0,"ok")}),Common.Gateway._postMessage({event:"onSave",data:{option:e,data:t}})},onMeta:function(t){appHeader.setDocumentCaption(t.title),this.updateWindowTitle(!0),this.document.title=t.title;var e=this.getApplication().getController("LeftMenu").getView("LeftMenu").getMenu("file");e.loadDocument({doc:this.document}),e.panels&&e.panels.info&&e.panels.info.updateInfo(this.document),this.getApplication().getController("Common.Controllers.ReviewChanges").loadDocument({doc:this.document}),Common.Gateway.metaChange(t),this.appOptions.wopi&&(e=t.title.lastIndexOf("."),Common.Gateway.requestRename(0<e?t.title.substring(0,e):t.title))},onPrint:function(){this.appOptions.canPrint&&!Common.Utils.ModalWindow.isVisible()&&(Common.NotificationCenter.trigger("file:print"),Common.component.Analytics.trackEvent("Print"))},onPrintUrl:function(e){if(this.iframePrint&&(this.iframePrint.parentNode.removeChild(this.iframePrint),this.iframePrint=null),!this.iframePrint){var i=this;this.iframePrint=document.createElement("iframe"),this.iframePrint.id="id-print-frame",this.iframePrint.style.display="none",this.iframePrint.style.visibility="hidden",this.iframePrint.style.position="fixed",this.iframePrint.style.right="0",this.iframePrint.style.bottom="0",document.body.appendChild(this.iframePrint),Date.now();this.iframePrint.onload=function(){clearTimeout(t);try{i.iframePrint.contentWindow.focus(),i.iframePrint.contentWindow.print(),i.iframePrint.contentWindow.blur(),window.focus()}catch(t){i.onSave({actionType:101,downloadUrl:e})}};let t=setTimeout(this.iframePrint.onload,500)}e&&(this.iframePrint.src=e)},onPrintQuick:function(){var t,i,n;this.appOptions.canQuickPrint&&(t=Common.localStorage.getBool("de-hide-quick-print-warning"),i=this,n=function(){var t=new Asc.asc_CAdjustPrint,e=(t.asc_setNativeOptions({quickPrint:!0}),new Asc.asc_CDownloadOptions(null,!0));e.asc_setAdvancedOptions(t),i.api.asc_Print(e),Common.component.Analytics.trackEvent("Print")},t?n.call(this):Common.UI.warning({msg:this.textTryQuickPrint,buttons:["yes","no"],primary:"yes",dontshow:!0,maxwidth:500,callback:function(t,e){e&&Common.localStorage.setBool("de-hide-quick-print-warning",!0),"yes"===t&&setTimeout(n,1)}}))},onClearDummyComment:function(){this.dontCloseDummyComment=!1},onShowDummyComment:function(){this.beforeShowDummyComment=!0},DisableMailMerge:function(){this.appOptions.mergeFolderUrl="";var t=this.getApplication().getController("Toolbar");t&&t.DisableMailMerge()},DisableVersionHistory:function(){this.editorConfig.canUseHistory=!1,this.appOptions.canUseHistory=!1},onConvertEquationToMath:function(i){var e=this,t=this.textConvertEquation+'<br><br><a id="id-equation-convert-help" style="cursor: pointer;">'+this.textLearnMore+"</a>",n=Common.UI.warning({width:500,msg:t,buttons:["yes","cancel"],primary:"yes",dontshow:!0,textDontShow:this.textApplyAll,callback:_.bind(function(t,e){"yes"==t&&this.api.asc_ConvertEquationToMath(i,e),this.onEditComplete()},this)});n.$window.find("#id-equation-convert-help").on("click",function(t){n&&n.close(),e.getApplication().getController("LeftMenu").getView("LeftMenu").showMenu("file:help","UsageInstructions/InsertEquation.htm#convertequation")})},warningDocumentIsLocked:function(){var e=this;Common.Utils.warningDocumentIsLocked({disablefunc:function(t){e.disableEditing(t,!0)}})},onRunAutostartMacroses:function(){var t,i=this;this.editorConfig.customization&&!1===this.editorConfig.customization.macros||(1==(t=Common.Utils.InternalSettings.get("de-macros-mode"))?this.api.asc_runAutostartMacroses():0===t&&Common.UI.warning({msg:this.textHasMacros+"<br>",buttons:["yes","no"],primary:"yes",dontshow:!0,textDontShow:this.textRemember,callback:function(t,e){e&&(Common.Utils.InternalSettings.set("de-macros-mode","yes"==t?1:2),Common.localStorage.setItem("de-macros-mode","yes"==t?1:2)),"yes"==t&&setTimeout(function(){i.api.asc_runAutostartMacroses()},1)}}))},onMacrosPermissionRequest:function(t,i){if(t&&i){if(this.stackMacrosRequests.push({url:t,callback:i}),1<this.stackMacrosRequests.length)return}else{if(!(0<this.stackMacrosRequests.length))return;t=this.stackMacrosRequests[0].url,i=this.stackMacrosRequests[0].callback}var n=this,e=Common.Utils.InternalSettings.get("de-allow-macros-request");0<e?(i&&i(1===e),this.stackMacrosRequests.shift(),this.onMacrosPermissionRequest()):Common.UI.warning({msg:this.textRequestMacros.replace("%1",t),buttons:["yes","no"],primary:"yes",dontshow:!0,textDontShow:this.textRememberMacros,maxwidth:600,callback:function(t,e){e&&(Common.Utils.InternalSettings.set("de-allow-macros-request","yes"==t?1:2),Common.localStorage.setItem("de-allow-macros-request","yes"==t?1:2)),setTimeout(function(){i&&i("yes"==t),n.stackMacrosRequests.shift(),n.onMacrosPermissionRequest()},1)}})},loadAutoCorrectSettings:function(){var n=this,o=Common.localStorage.getItem("de-settings-math-correct-add"),s=(Common.Utils.InternalSettings.set("de-settings-math-correct-add",o),o?JSON.parse(o):[]),o=Common.localStorage.getItem("de-settings-math-correct-rem"),a=(Common.Utils.InternalSettings.set("de-settings-math-correct-rem",o),o?JSON.parse(o):[]);o=Common.localStorage.getBool("de-settings-math-correct-replace-type",!0),Common.Utils.InternalSettings.set("de-settings-math-correct-replace-type",o),n.api.asc_refreshOnStartAutoCorrectMathSymbols(a,s,o),o=Common.localStorage.getItem("de-settings-rec-functions-add"),Common.Utils.InternalSettings.set("de-settings-rec-functions-add",o),s=o?JSON.parse(o):[],o=Common.localStorage.getItem("de-settings-rec-functions-rem"),Common.Utils.InternalSettings.set("de-settings-rec-functions-rem",o),a=o?JSON.parse(o):[],n.api.asc_refreshOnStartAutoCorrectMathFunctions(a,s),o=Common.localStorage.getBool("de-settings-autoformat-bulleted",!0),Common.Utils.InternalSettings.set("de-settings-autoformat-bulleted",o),n.api.asc_SetAutomaticBulletedLists(o),o=Common.localStorage.getBool("de-settings-autoformat-numbered",!0),Common.Utils.InternalSettings.set("de-settings-autoformat-numbered",o),n.api.asc_SetAutomaticNumberedLists(o),o=Common.localStorage.getBool("de-settings-autoformat-smart-quotes",!0),Common.Utils.InternalSettings.set("de-settings-autoformat-smart-quotes",o),n.api.asc_SetAutoCorrectSmartQuotes(o),o=Common.localStorage.getBool("de-settings-autoformat-hyphens",!0),Common.Utils.InternalSettings.set("de-settings-autoformat-hyphens",o),n.api.asc_SetAutoCorrectHyphensWithDash(o),o=null!==(o=Common.localStorage.getItem("de-settings-letter-exception-sentence"))?0!=parseInt(o):Common.localStorage.getBool("de-settings-autoformat-fl-sentence",!0),Common.Utils.InternalSettings.set("de-settings-letter-exception-sentence",o),n.api.asc_SetAutoCorrectFirstLetterOfSentences(o),o=null!==(o=Common.localStorage.getItem("de-settings-letter-exception-cells"))?0!=parseInt(o):Common.localStorage.getBool("de-settings-autoformat-fl-cells",!0),Common.Utils.InternalSettings.set("de-settings-letter-exception-cells",o),n.api.asc_SetAutoCorrectFirstLetterOfCells(o),[1033,1049].forEach(function(t){var e=n.api.asc_GetAutoCorrectSettings().get_FirstLetterExceptionManager(),i=(o=Common.localStorage.getItem("de-settings-letter-exception-add-"+t),Common.Utils.InternalSettings.set("de-settings-letter-exception-add-"+t,o),s=o?JSON.parse(o):[],o=Common.localStorage.getItem("de-settings-letter-exception-rem-"+t),Common.Utils.InternalSettings.set("de-settings-letter-exception-rem-"+t,o),a=o?JSON.parse(o):[],_.union(e.get_Exceptions(t),s));(i=_.difference(i,a)).sort(),e.put_Exceptions(i,t)}),o=Common.localStorage.getBool("de-settings-autoformat-hyperlink",!0),Common.Utils.InternalSettings.set("de-settings-autoformat-hyperlink",o),n.api.asc_SetAutoCorrectHyperlinks(o),o=Common.localStorage.getBool("de-settings-autoformat-double-space",Common.Utils.isMac),Common.Utils.InternalSettings.set("de-settings-autoformat-double-space",o),n.api.asc_SetAutoCorrectDoubleSpaceWithPeriod(o)},showRenameUserDialog:function(){var n;this._renameDialog||((n=this)._renameDialog=new Common.Views.UserNameDialog({label:this.textRenameLabel,error:this.textRenameError,value:Common.Utils.InternalSettings.get("guest-username")||"",check:Common.Utils.InternalSettings.get("save-guest-username")||!1,validation:function(t){return t.length<128||n.textLongName},handler:function(t,e){var i;"ok"==t&&(t=e.input?e.input+" ("+n.appOptions.guestName+")":n.textAnonymous,(i=new Asc.asc_CUserInfo).put_FullName(t),(t=new Asc.asc_CDocInfo).put_UserInfo(i),n.api.asc_changeDocInfo(t),e.checkbox?Common.localStorage.setItem("guest-username",e.input):Common.localStorage.removeItem("guest-username"),Common.Utils.InternalSettings.set("guest-username",e.input),Common.Utils.InternalSettings.set("save-guest-username",e.checkbox))}}),this._renameDialog.on("close",function(){n._renameDialog=void 0}),this._renameDialog.show(Common.Utils.innerWidth()-this._renameDialog.options.width-15,30))},onGrabFocus:function(){this.getApplication().getController("DocumentHolder").getView().focus()},onLanguageLoaded:function(){return!!Common.Locale.getCurrentLanguage()||(Common.UI.warning({msg:this.errorLang,buttons:[],closable:!1}),!1)},onConfirmAction:function(t,e,i){var n=this;t==Asc.c_oAscConfirm.ConfirmMaxChangesSize&&Common.UI.warning({title:this.notcriticalErrorTitle,msg:this.confirmMaxChangesSize,buttons:[{value:"ok",caption:this.textUndo,primary:!0},{value:"cancel",caption:this.textContinue}],maxwidth:600,callback:_.bind(function(t){e&&e("ok"===t),n.onEditComplete()},this)})}}}(),DE.Controllers.Main||{}))}),define("documenteditor/main/app/controller/ViewTab",["core","documenteditor/main/app/view/ViewTab"],function(){"use strict";DE.Controllers.ViewTab=Backbone.Controller.extend(_.extend({models:[],collections:[],views:["ViewTab"],sdkViewName:"#id_main",initialize:function(){},onLaunch:function(){this._state={},Common.NotificationCenter.on("app:ready",this.onAppReady.bind(this)),Common.NotificationCenter.on("contenttheme:dark",this.onContentThemeChangedToDark.bind(this)),Common.NotificationCenter.on("uitheme:changed",this.onThemeChanged.bind(this)),Common.NotificationCenter.on("document:ready",_.bind(this.onDocumentReady,this))},setApi:function(t){return t&&(this.api=t,this.api.asc_registerCallback("asc_onZoomChange",_.bind(this.onZoomChange,this)),this.api.asc_registerCallback("asc_onCoAuthoringDisconnect",_.bind(this.onCoAuthoringDisconnect,this)),Common.NotificationCenter.on("api:disconnect",_.bind(this.onCoAuthoringDisconnect,this))),this},setConfig:function(t){var e=t.mode;this.toolbar=t.toolbar,this.view=this.createView("ViewTab",{toolbar:this.toolbar.toolbar,mode:e,compactToolbar:this.toolbar.toolbar.isCompactView}),this.addListeners({ViewTab:{"zoom:topage":_.bind(this.onBtnZoomTo,this,"topage"),"zoom:towidth":_.bind(this.onBtnZoomTo,this,"towidth"),"rulers:change":_.bind(this.onChangeRulers,this),"darkmode:change":_.bind(this.onChangeDarkMode,this)},Toolbar:{"view:compact":_.bind(function(t,e){this.view.chToolbar.setValue(!e,!0)},this)},Statusbar:{"view:hide":_.bind(function(t,e){this.view.chStatusbar.setValue(!e,!0)},this)},LeftMenu:{"view:hide":_.bind(function(t,e){this.view.chLeftMenu.setValue(!e,!0)},this)}})},SetDisabled:function(t){this.view&&this.view.SetDisabled(t)},createToolbarPanel:function(){return this.view.getPanel()},getView:function(t){return!t&&this.view?this.view:Backbone.Controller.prototype.getView.call(this,t)},onCoAuthoringDisconnect:function(){Common.Utils.lockControls(Common.enumLock.lostConnect,!0,{array:this.view.lockedControls})},onAppReady:function(i){var n=this;n.view&&new Promise(function(t,e){t()}).then(function(){n.view.setEvents(),Common.UI.Themes.available()||(n.view.btnInterfaceTheme.$el.closest(".group").remove(),n.view.$el.find(".separator-theme").remove());var t=[];function e(){var t,e=this.view.btnInterfaceTheme,i=("object"==typeof e.menu?e.menu.removeAll():e.setMenu(new Common.UI.Menu),Common.UI.Themes.currentThemeId()||Common.UI.Themes.defaultThemeId());for(t in Common.UI.Themes.map())e.menu.addItem({value:t,caption:Common.UI.Themes.get(t).text,checked:t===i,checkable:!0,toggleGroup:"interface-theme"})}(i.canBrandingExt&&i.customization&&!1===i.customization.statusBar||!Common.UI.LayoutManager.isElementVisible("statusBar"))&&(t.push(n.view.chStatusbar.$el.closest(".elset")),n.view.chStatusbar.$el.remove()),i.canBrandingExt&&i.customization&&!1===i.customization.leftMenu||!Common.UI.LayoutManager.isElementVisible("leftMenu")?(t.push(n.view.chLeftMenu.$el.closest(".elset")),n.view.chLeftMenu.$el.remove()):0<t.length&&(t.push(n.view.chLeftMenu.$el.closest(".elset")),t.shift().append(n.view.chLeftMenu.$el[0])),!i.isEdit||i.canBrandingExt&&i.customization&&!1===i.customization.rightMenu||!Common.UI.LayoutManager.isElementVisible("rightMenu")?(t.push(n.view.chRightMenu.$el.closest(".elset")),n.view.chRightMenu.$el.remove()):0<t.length&&(t.push(n.view.chRightMenu.$el.closest(".elset")),t.shift().append(n.view.chRightMenu.$el[0])),1<t.length&&t[t.length-1].closest(".group").remove(),i.isEdit||(n.view.chRulers.$el.closest(".group").remove(),n.view.chRulers.$el.remove(),n.view.$el.find(".separator-rulers").remove()),n.view.cmbZoom.on("selected",_.bind(n.onSelectedZoomValue,n)).on("changed:before",_.bind(n.onZoomChanged,n,!0)).on("changed:after",_.bind(n.onZoomChanged,n,!1)).on("combo:blur",_.bind(n.onComboBlur,n,!1)),n.getApplication().getController("LeftMenu").leftMenu.btnNavigation.on("toggle",function(t,e){e!==n.view.btnNavigation.pressed&&n.view.turnNavigation(e)}),Common.UI.Themes.available()&&(Common.NotificationCenter.on("uitheme:countchanged",e.bind(n)),e.call(n),n.view.btnInterfaceTheme.menu.items.length&&(n.view.btnInterfaceTheme.menu.on("item:click",_.bind(function(t,e){e=e.value;Common.UI.Themes.setTheme(e),Common.Utils.lockControls(Common.enumLock.inLightTheme,!Common.UI.Themes.isDarkTheme(),{array:[n.view.btnDarkDocument]})},n)),setTimeout(function(){n.onContentThemeChangedToDark(Common.UI.Themes.isContentThemeDark()),Common.Utils.lockControls(Common.enumLock.inLightTheme,!Common.UI.Themes.isDarkTheme(),{array:[n.view.btnDarkDocument]})},0)))})},onDocumentReady:function(){Common.Utils.lockControls(Common.enumLock.disableOnStart,!1,{array:this.view.lockedControls})},onZoomChange:function(t,e){this.view.btnFitToPage.toggle(2==e,!0),this.view.btnFitToWidth.toggle(1==e,!0),this.view.cmbZoom.setValue(t,t+"%"),this._state.zoomValue=t},applyZoom:function(t){t=Math.max(10,Math.min(500,t));this._state.zoomValue===t&&this.view.cmbZoom.setValue(this._state.zoomValue,this._state.zoomValue+"%"),this.api.zoom(t),Common.NotificationCenter.trigger("edit:complete",this.view)},onSelectedZoomValue:function(t,e){this.applyZoom(e.value)},onZoomChanged:function(t,e,i,n){var o=parseFloat(i.value);t?new RegExp("^\\s*(\\d*(\\.|,)?\\d+)\\s*(%)?\\s*$").exec(i.value)||(this.view.cmbZoom.setValue(this._state.zoomValue,this._state.zoomValue+"%"),Common.NotificationCenter.trigger("edit:complete",this.view)):this._state.zoomValue===o||isNaN(o)?i.value!==this._state.zoomValue+"%"&&this.view.cmbZoom.setValue(this._state.zoomValue,this._state.zoomValue+"%"):this.applyZoom(o)},onBtnZoomTo:function(t){var e,t="topage"===t?(e="btnFitToPage","zoomFitToPage"):(e="btnFitToWidth","zoomFitToWidth");this.view[e].pressed?this.api[t]():this.api.zoomCustomMode(),Common.NotificationCenter.trigger("edit:complete",this.view)},onChangeRulers:function(t,e){Common.localStorage.setBool("de-hidden-rulers",!e),Common.Utils.InternalSettings.set("de-hidden-rulers",!e),this.api.asc_SetViewRulers(e),Common.NotificationCenter.trigger("layout:changed","rulers"),Common.NotificationCenter.trigger("edit:complete",this.view)},onChangeDarkMode:function(){Common.UI.Themes.toggleContentTheme()},onContentThemeChangedToDark:function(t){this.view&&this.view.btnDarkDocument.toggle(t,!0)},onThemeChanged:function(){var t;this.view&&Common.UI.Themes.available()&&(t=Common.UI.Themes.currentThemeId()||Common.UI.Themes.defaultThemeId(),(t=_.findWhere(this.view.btnInterfaceTheme.menu.items,{value:t}))&&(this.view.btnInterfaceTheme.menu.clearAll(),t.setChecked(!0,!0)),Common.Utils.lockControls(Common.enumLock.inLightTheme,!Common.UI.Themes.isDarkTheme(),{array:[this.view.btnDarkDocument]}))},onComboBlur:function(){Common.NotificationCenter.trigger("edit:complete",this.view)}},DE.Controllers.ViewTab||{}))}),define("text!common/main/lib/template/SearchPanel.template",[],function(){return'<div id="search-box" class="layout-ct vbox search-panel">\n    <div id="search-header">\n        <label id="search-adv-title"></label>\n        <div id="search-btn-close" class="float-right"></div>\n    </div>\n    <div id="search-container">\n    <div id="search-adv-settings">\n        <table cols="1">\n            <tbody>\n                <tr>\n                    <td class="padding-small"><div id="search-adv-text"></div></td>\n                </tr>\n                <tr class="edit-setting">\n                    <td class="padding-large"><div id="search-adv-replace-text"></div></td>\n                </tr>\n                <tr>\n                    <td class="padding-large">\n                        <label id="search-adv-results-number" style="display: inline-block;">\n                            <%= scope.textSearchResults %>\n                        </label>\n                        <div class="search-nav-btns float-right">\n                            <div id="search-adv-back"></div>\n                            <div id="search-adv-next"></div>\n                        </div>\n                    </td>\n                </tr>\n                <tr class="edit-setting">\n                    <td class="padding-large">\n                       <button type="button" class="btn btn-text-default" id="search-adv-replace" data-hint="1" data-hint-direction="bottom" data-hint-offset="big"><%= scope.textReplace %></button>\n                       <button type="button" class="btn btn-text-default" id="search-adv-replace-all" data-hint="1" data-hint-direction="bottom" data-hint-offset="big"><%= scope.textReplaceAll %></button>\n                    </td>\n                </tr>\n                <tr class="search-options-block">\n                    <td class="padding-large">\n                        <div id="open-search-options" data-hint="1" data-hint-direction="left" data-hint-offset="0, -15">\n                            <div class="search-options-caret img-commonctrl"></div>\n                            <div class="search-options-txt"><%= scope.textSearchOptions %></div>\n                        </div>\n                        <div id="search-options">\n                            <label class="input-label"><%= scope.textWithin %></label>\n                            <div id="search-adv-cmb-within"></div>\n                            <div id="search-adv-select-range"></div>\n                            <label class="input-label"><%= scope.textSearch %></label>\n                            <div id="search-adv-cmb-search"></div>\n                            <label class="input-label"><%= scope.textLookIn %></label>\n                            <div id="search-adv-cmb-look-in"></div>\n                        </div>\n                    </td>\n                </tr>\n                <tr>\n                    <td class="padding-small"><div id="search-adv-case-sensitive"></div></td>\n                </tr>\n                \x3c!---<tr>\n                    <td class="padding-small"><div id="search-adv-use-regexp"></div></td>\n                </tr>--\x3e\n                <tr>\n                    <td class="padding-large"><div id="search-adv-match-word"></div></td>\n                </tr>\n            </tbody>\n        </table>\n    </div>\n    <div id="search-results" class="ps-container oo">\n    </div>\n    </div>\n</div>'}),define("common/main/lib/view/SearchPanel",["text!common/main/lib/template/SearchPanel.template","common/main/lib/util/utils","common/main/lib/component/BaseView","common/main/lib/component/Layout"],function(t){"use strict";Common.Views.SearchPanel=Common.UI.BaseView.extend(_.extend({el:"#left-panel-search",template:_.template(t),initialize:function(t){_.extend(this,t),Common.UI.BaseView.prototype.initialize.call(this,arguments),this.mode=!1,window.SSE&&(this.extendedOptions=Common.localStorage.getBool("sse-search-options-extended",!0))},render:function(t){var i=this;return this.rendered||(t=t||this.el,$(t).html(this.template({scope:this})),this.$el=$(t),this.inputText=new Common.UI.InputField({el:$("#search-adv-text"),placeHolder:this.textFind,allowBlank:!0,validateOnBlur:!1,style:"width: 100%;",dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.inputText._input.on("input",_.bind(function(){this.fireEvent("search:input",[this.inputText._input.val()])},this)).on("keydown",_.bind(function(t){this.fireEvent("search:keydown",[this.inputText._input.val(),t])},this)),this.inputReplace=new Common.UI.InputField({el:$("#search-adv-replace-text"),placeHolder:this.textReplaceWith,allowBlank:!0,validateOnBlur:!1,style:"width: 100%;",dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.inputReplace._input.on("keydown",_.bind(function(t){t.keyCode!==Common.UI.Keys.RETURN||this.btnReplace.isDisabled()||this.onReplaceClick("replace")},this)),this.btnBack=new Common.UI.Button({parentEl:$("#search-adv-back"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-arrow-up",hint:this.tipPreviousResult,dataHint:"1",dataHintDirection:"bottom"}),this.btnBack.on("click",_.bind(this.onBtnNextClick,this,"back")),this.btnNext=new Common.UI.Button({parentEl:$("#search-adv-next"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-arrow-down",hint:this.tipNextResult,dataHint:"1",dataHintDirection:"bottom"}),this.btnNext.on("click",_.bind(this.onBtnNextClick,this,"next")),this.btnReplace=new Common.UI.Button({el:$("#search-adv-replace")}),this.btnReplace.on("click",_.bind(this.onReplaceClick,this,"replace")),this.btnReplaceAll=new Common.UI.Button({el:$("#search-adv-replace-all")}),this.btnReplaceAll.on("click",_.bind(this.onReplaceClick,this,"replaceall")),this.$reaultsNumber=$("#search-adv-results-number"),this.updateResultsNumber("no-results"),this.chCaseSensitive=new Common.UI.CheckBox({el:$("#search-adv-case-sensitive"),labelText:this.textCaseSensitive,value:!1,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}).on("change",function(t){i.fireEvent("search:options",["case-sensitive","checked"===t.getValue()])}),this.chMatchWord=new Common.UI.CheckBox({el:$("#search-adv-match-word"),labelText:window.SSE?this.textItemEntireCell:this.textWholeWords,value:!1,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}).on("change",function(t){i.fireEvent("search:options",["match-word","checked"===t.getValue()])}),this.buttonClose=new Common.UI.Button({parentEl:$("#search-btn-close",this.$el),cls:"btn-toolbar",iconCls:"toolbar__icon btn-close",hint:this.textCloseSearch,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"medium"}),this.buttonClose.on("click",_.bind(this.onClickClosePanel,this)),this.$resultsContainer=$("#search-results"),this.$resultsContainer.hide(),this.$searchContainer=$("#search-container"),this.$searchContainer.scroller=new Common.UI.Scroller({el:$("#search-container"),useKeyboard:!0,minScrollbarLength:40}),Common.NotificationCenter.on("search:updateresults",_.bind(this.disableNavButtons,this)),window.SSE?(this.cmbWithin=new Common.UI.ComboBox({el:$("#search-adv-cmb-within"),menuStyle:"min-width: 100%;",style:"width: 219px;",editable:!1,cls:"input-group-nr",data:[{value:0,displayValue:this.textSheet},{value:1,displayValue:this.textWorkbook},{value:2,displayValue:this.textSpecificRange}],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}).on("selected",function(t,e){i.fireEvent("search:options",["within",e.value])}),this.inputSelectRange=new Common.UI.InputFieldBtn({el:$("#search-adv-select-range"),placeHolder:this.textSelectDataRange,allowBlank:!0,validateOnChange:!0,validateOnBlur:!0,style:"width: 219px; margin-top: 8px",disabled:!0,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}).on("keyup:after",function(t,e){i.fireEvent("search:options",["range",t.getValue(),e.keyCode!==Common.UI.Keys.RETURN])}),this.inputSelectRange.$el.hide(),this.cmbSearch=new Common.UI.ComboBox({el:$("#search-adv-cmb-search"),menuStyle:"min-width: 100%;",style:"width: 219px;",editable:!1,cls:"input-group-nr",data:[{value:0,displayValue:this.textByRows},{value:1,displayValue:this.textByColumns}],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}).on("selected",function(t,e){i.fireEvent("search:options",["search",!e.value])}),this.cmbLookIn=new Common.UI.ComboBox({el:$("#search-adv-cmb-look-in"),menuStyle:"min-width: 100%;",style:"width: 219px;",editable:!1,cls:"input-group-nr",data:[{value:0,displayValue:this.textFormulas},{value:1,displayValue:this.textValues}],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}).on("selected",function(t,e){i.fireEvent("search:options",["lookIn",!e.value])}),this.$searchOptionsBlock=$(".search-options-block"),this.$searchOptionsBlock.show(),$("#open-search-options").on("click",_.bind(this.expandSearchOptions,this)),this.extendedOptions||this.$searchOptionsBlock.addClass("no-expand"),this.cmbWithin.setValue(0),this.cmbSearch.setValue(0),this.cmbLookIn.setValue(0),t='<div class="search-table"><div class="header-items"><div class="header-item">'+this.textSheet+'</div><div class="header-item">'+this.textName+'</div><div class="header-item">'+this.textCell+'</div><div class="header-item">'+this.textValue+'</div><div class="header-item">'+this.textFormula+'</div></div><div class="ps-container oo search-items"></div></div>',t=$(t).appendTo(this.$resultsContainer),this.$resultsContainer.scroller=new Common.UI.Scroller({el:t.find(".search-items"),includePadding:!0,useKeyboard:!0,minScrollbarLength:40,alwaysVisibleY:!0}),this.$resultsTable=this.$resultsContainer.find(".search-table")):this.$resultsContainer.scroller=new Common.UI.Scroller({el:this.$resultsContainer,includePadding:!0,useKeyboard:!0,minScrollbarLength:40,alwaysVisibleY:!0}),Common.NotificationCenter.on("window:resize",function(){i.updateResultsContainerHeight()})),this.rendered=!0,this.trigger("render:after",this),this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this.fireEvent("show",this),this.updateResultsContainerHeight()},hide:function(){Common.UI.BaseView.prototype.hide.call(this,arguments),this.fireEvent("hide",this)},focus:function(t){var e=("replace"===t?this.inputReplace:"range"===t?this.inputSelectRange:this.inputText).$el;setTimeout(function(){e.find("input").focus(),e.find("input").select()},10)},setSearchMode:function(t){this.mode!==t&&(this.$el.find(".edit-setting")["no-replace"!==t?"show":"hide"](),this.$el.find("#search-adv-title").text("no-replace"!==t?this.textFindAndReplace:this.textFind),this.mode=t)},ChangeSettings:function(t){},updateScrollers:function(){this.$resultsContainer.scroller.update({alwaysVisibleY:!0}),this.$searchContainer.scroller.update({alwaysVisibleY:!0}),setTimeout(_.bind(function(){this.$searchContainer.find("> .ps-scrollbar-y-rail").is(":visible")?this.$resultsContainer.find(".ps-scrollbar-y-rail").addClass("set-left"):this.$resultsContainer.find(".ps-scrollbar-y-rail").removeClass("set-left")},this),100)},updateResultsContainerHeight:function(){this.$resultsContainer&&(this.$resultsContainer.outerHeight(Math.max($("#search-box").outerHeight()-$("#search-header").outerHeight()-$("#search-adv-settings").outerHeight(),112)),this.updateScrollers())},updateResultsNumber:function(t,e){var i,n;this.$resultsContainer&&"content-changed"!==t&&"replace-all"!==t&&"replace"!==t&&(300<e?this.showToManyResults():(this.$resultsContainer.find(".many-results").remove(),window.SSE&&this.$resultsTable.show())),i="no-results"===t?this.textNoSearchResults:"stop"===t?this.textSearchHasStopped:"content-changed"===t?this.textContentChanged+" "+Common.Utils.String.format(this.textSearchAgain,'<a class="search-again">',"</a>"):"replace-all"===t?Common.Utils.String.format(this.textItemsSuccessfullyReplaced,e):"replace"===t?Common.Utils.String.format(this.textPartOfItemsNotReplaced,e[0],e[1],e[2]):e?Common.Utils.String.format(this.textSearchResults,t+1,e):this.textNoMatches,"content-changed"===t?((n=this).$reaultsNumber.html(i),this.$reaultsNumber.find(".search-again").on("click",function(){n.fireEvent("search:next",[n.inputText.getValue(),!0])})):this.$reaultsNumber.text(i),this.updateResultsContainerHeight(),window.SSE||this.disableReplaceButtons(!e)},showToManyResults:function(){window.SSE?(this.$resultsTable.hide(),this.$resultsTable.find(".search-items").empty(),this.$resultsContainer.find(".many-results").remove()):this.$resultsContainer.empty(),this.$resultsContainer.append('<div class="many-results">'+this.textTooManyResults+"</div>"),this.$resultsContainer.is(":visible")||this.$resultsContainer.show()},onClickClosePanel:function(){Common.NotificationCenter.trigger("leftmenu:change","hide"),this.fireEvent("hide",this)},onBtnNextClick:function(t){this.fireEvent("search:"+t,[this.inputText.getValue(),!0])},onReplaceClick:function(t){this.fireEvent("search:"+t,[this.inputText.getValue(),this.inputReplace.getValue()])},getSettings:function(){return{textsearch:this.inputText.getValue(),matchcase:this.chCaseSensitive.checked,matchword:this.chMatchWord.checked}},expandSearchOptions:function(){this.extendedOptions=!this.extendedOptions,this.$searchOptionsBlock[this.extendedOptions?"removeClass":"addClass"]("no-expand"),Common.localStorage.setBool("sse-search-options-extended",this.extendedOptions),this.updateResultsContainerHeight()},setFindText:function(t){this.inputText.setValue(t)},clearResultsNumber:function(){this.updateResultsNumber("no-results")},disableNavButtons:function(t,e){e=""===this.inputText._input.val()&&!window.SSE||!e;this.btnBack.setDisabled(e),this.btnNext.setDisabled(e)},disableReplaceButtons:function(t){this.btnReplace.setDisabled(t),this.btnReplaceAll.setDisabled(t)}},Common.Views.SearchPanel||{}))}),define("documenteditor/main/app/controller/Search",["core","common/main/lib/view/SearchPanel"],function(){"use strict";DE.Controllers.Search=Backbone.Controller.extend(_.extend({sdkViewName:"#id_main",views:["Common.Views.SearchPanel"],initialize:function(){this.addListeners({SearchBar:{"search:back":_.bind(this.onSearchNext,this,"back"),"search:next":_.bind(this.onSearchNext,this,"next"),"search:input":_.bind(function(t){this._state.searchText===t?Common.NotificationCenter.trigger("search:updateresults",this._state.currentResult,this._state.resultsNumber):this.onInputSearchChange(t)},this),"search:keydown":_.bind(this.onSearchNext,this,"keydown"),show:_.bind(this.onSelectSearchingResults,this,!0),hide:_.bind(this.onSelectSearchingResults,this,!1)},"Common.Views.SearchPanel":{"search:back":_.bind(this.onSearchNext,this,"back"),"search:next":_.bind(this.onSearchNext,this,"next"),"search:replace":_.bind(this.onQueryReplace,this),"search:replaceall":_.bind(this.onQueryReplaceAll,this),"search:input":_.bind(this.onInputSearchChange,this),"search:options":_.bind(this.onChangeSearchOption,this),"search:keydown":_.bind(this.onSearchNext,this,"keydown"),show:_.bind(this.onShowPanel,this),hide:_.bind(this.onHidePanel,this)},LeftMenu:{"search:aftershow":_.bind(this.onShowAfterSearch,this)}})},onLaunch:function(){this._state={searchText:"",matchCase:!1,matchWord:!1,useRegExp:!1,isHighlightedResults:!1,isContentChanged:!1}},setMode:function(t){this.view=this.createView("Common.Views.SearchPanel",{mode:t})},setApi:function(t){return t&&(this.api=t,this.api.asc_registerCallback("asc_onSetSearchCurrent",_.bind(this.onUpdateSearchCurrent,this)),this.api.asc_registerCallback("asc_onStartTextAroundSearch",_.bind(this.onStartTextAroundSearch,this)),this.api.asc_registerCallback("asc_onEndTextAroundSearch",_.bind(this.onEndTextAroundSearch,this)),this.api.asc_registerCallback("asc_onGetTextAroundSearchPack",_.bind(this.onApiGetTextAroundSearch,this)),this.api.asc_registerCallback("asc_onRemoveTextAroundSearch",_.bind(this.onApiRemoveTextAroundSearch,this)),this.api.asc_registerCallback("asc_onSearchEnd",_.bind(this.onApiSearchEnd,this)),this.api.asc_registerCallback("asc_onReplaceAll",_.bind(this.onApiTextReplaced,this))),this},getView:function(t){return!t&&this.view?this.view:Backbone.Controller.prototype.getView.call(this,t)},checkPunctuation:function(t){if(t){for(var e=!1,i=0;i<t.length;i++){var n=t.charCodeAt(i),o=t.charAt(i);if(AscCommon.IsPunctuation(n)||""===o.trim()){e=!0;break}}e?(this._state.matchWord&&(this.view.chMatchWord.setValue(!1,!0),this._state.matchWord=!1),this.view.chMatchWord.setDisabled(!0)):this.view.chMatchWord.isDisabled()&&this.view.chMatchWord.setDisabled(!1)}},onChangeSearchOption:function(t,e){switch(t){case"case-sensitive":this._state.matchCase=e;break;case"match-word":this._state.matchWord=e;break;case"regexp":this._state.useRegExp=e}this._state.searchText&&this.onQuerySearch()},onSearchNext:function(t,e,i){i="keydown"===t&&i.keyCode===Common.UI.Keys.RETURN;e&&0<e.length&&(i||"keydown"!==t)&&(this.checkPunctuation(e),this._state.searchText=e,this.onQuerySearch(t,!(this.searchTimer||i)))},onInputSearchChange:function(t){var e=this;(t&&this._state.searchText!==t||!t&&this._state.newSearchText)&&(this._state.newSearchText=t,this._lastInputChange=new Date,void 0===this.searchTimer&&(this.searchTimer=setInterval(function(){new Date-e._lastInputChange<400||(e.checkPunctuation(e._state.newSearchText),e._state.searchText=e._state.newSearchText,""!==e._state.newSearchText&&e.onQuerySearch()||""!==e._state.newSearchText||(e.api.asc_endFindText(),e.view.updateResultsNumber("no-results"),e.hideResults(),e.view.disableNavButtons(),e.view.disableReplaceButtons(!0),clearInterval(e.searchTimer),e.searchTimer=void 0,Common.NotificationCenter.trigger("search:updateresults")))},10)))},onQuerySearch:function(t,e){var e=!e||this._state.isContentChanged,i=(this._state.isContentChanged=!1,this.searchTimer&&clearInterval(this.searchTimer),this.searchTimer=void 0,e&&this.hideResults(),new AscCommon.CSearchSettings);return i.put_Text(this._state.searchText),i.put_MatchCase(this._state.matchCase),i.put_WholeWords(this._state.matchWord),this.api.asc_findText(i,"back"!=t)?(e&&this.view.$el.is(":visible")&&0===this.view.$resultsContainer.find(".many-results").length&&this.api.asc_StartTextAroundSearch(),this.view.disableReplaceButtons(!1),!0):(this.resultItems=[],this.view.updateResultsNumber(void 0,0),this.hideResults(),this.view.disableReplaceButtons(!0),this._state.currentResult=0,this._state.resultsNumber=0,this.view.disableNavButtons(),Common.NotificationCenter.trigger("search:updateresults"),!1)},onQueryReplace:function(t,e){var i,n,o;""!==t&&((n=(i=this).api.asc_GetErrorForReplaceString(e))?setTimeout(function(){Common.UI.warning({title:i.notcriticalErrorTitle,msg:Common.Utils.String.format(i.warnReplaceString,n),buttons:["ok"],callback:function(){i.view.focus("replace")}})},1):((o=new AscCommon.CSearchSettings).put_Text(t),o.put_MatchCase(this._state.matchCase),o.put_WholeWords(this._state.matchWord),this.api.asc_replaceText(o,e,!1)||this.removeResultItems()))},onQueryReplaceAll:function(t,e){var i,n,o;""!==t&&((n=(i=this).api.asc_GetErrorForReplaceString(e))?setTimeout(function(){Common.UI.warning({title:i.notcriticalErrorTitle,msg:Common.Utils.String.format(i.warnReplaceString,n),buttons:["ok"],callback:function(){i.view.focus("replace")}})},1):((o=new AscCommon.CSearchSettings).put_Text(t),o.put_MatchCase(this._state.matchCase),o.put_WholeWords(this._state.matchWord),this.api.asc_replaceText(o,e,!0),this.removeResultItems("replace-all")))},removeResultItems:function(t){this.resultItems=[],"replace-all"!==t&&this.view.updateResultsNumber(t,0),this.hideResults(),this.view.disableReplaceButtons(!0),this._state.currentResult=0,this._state.resultsNumber=0,this.view.disableNavButtons()},onUpdateSearchCurrent:function(t,e){-1!==t&&(this._state.currentResult=t,this._state.resultsNumber=e,this.view&&(this.view.updateResultsNumber(t,e),this.view.disableNavButtons(t,e),this.resultItems&&0<this.resultItems.length&&(this.resultItems.forEach(function(t){t.selected=!1}),this.resultItems[t]&&(this.resultItems[t].selected=!0,$("#search-results").find(".item").removeClass("selected"),$(this.resultItems[t].el).addClass("selected"),this.scrollToSelectedResult(t)))),Common.NotificationCenter.trigger("search:updateresults",t,e))},scrollToSelectedResult:function(t){var e,i,n,o,t=void 0!==t?t:_.findIndex(this.resultItems,{selected:!0});-1!==t&&(e=(t=this.resultItems[t].$el).outerHeight(),t=t.position().top,n=(i=this.view.$resultsContainer).outerHeight(),o=i.scrollTop(),t<0||0===o&&n<t?i.scroller.scrollTop(o+t-12):n<t+e&&i.scroller.scrollTop(o+e))},onStartTextAroundSearch:function(){this.view&&(this._state.isStartedAddingResults=!0)},onEndTextAroundSearch:function(){this.view&&this.view.updateScrollers()},onApiGetTextAroundSearch:function(t){var l,r;this.view&&this._state.isStartedAddingResults&&(this._state.isStartedAddingResults=!1,300<t.length||!t.length||((l=this).resultItems=[],t.forEach(function(i,t){for(var e=document.createElement("div"),n=t===l._state.currentResult,o=(e.className="item",""),s=0,a=i[1].length;s<a;++s)o+=1==s?"<b>"+Common.Utils.String.htmlEncode(i[1][s])+"</b>":Common.Utils.String.htmlEncode(i[1][s]);e.innerHTML=o.trim(),l.view.$resultsContainer.append(e),n&&($(e).addClass("selected"),r=t);t={id:i[0],$el:$(e),el:e,selected:n};l.resultItems.push(t),$(e).on("click",_.bind(function(t){var e;l._state.isContentChanged?l.onQuerySearch():(e=i[0],l.api.asc_SelectSearchElement(e))},l))}),this.view.$resultsContainer.show(),this.scrollToSelectedResult(r)))},onApiRemoveTextAroundSearch:function(t){var e=this;t.forEach(function(t){t=_.findIndex(e.resultItems,{id:t});-1!==t&&(e.resultItems[t].$el.remove(),e.resultItems.splice(t,1))})},hideResults:function(){this.view&&(0===this.view.$resultsContainer.find(".many-results").length&&this.view.$resultsContainer.hide(),this.view.$resultsContainer.find(".item").remove())},onShowAfterSearch:function(t){var e=this.getApplication().getController("Viewport"),e=(e.isSearchBarVisible()&&e.searchBar.hide(),this.api.asc_GetSelectedText()),t="string"==typeof t?t:e&&e.trim()||this._state.searchText;this.checkPunctuation(t),this.resultItems&&0<this.resultItems.length&&(!this._state.matchCase&&t&&t.toLowerCase()===this.view.inputText.getValue().toLowerCase()||this._state.matchCase&&t===this.view.inputText.getValue())||(t?this.view.setFindText(t):void 0!==t&&(this.view.setFindText(""),this._state.searchText=void 0),this.hideResults(),t&&""!==t&&t===this._state.searchText?(this.view.disableReplaceButtons(!1),0===this.view.$resultsContainer.find(".many-results").length&&this.api.asc_StartTextAroundSearch()):t&&""!==t?this.onInputSearchChange(t):(this.resultItems=[],this.view.disableReplaceButtons(!0),this.view.clearResultsNumber()),this.view.disableNavButtons(this._state.currentResult,this._state.resultsNumber))},onShowPanel:function(){var i;this.onSelectSearchingResults(!0),this.resultItems&&0<this.resultItems.length&&!this._state.isStartedAddingResults&&((i=this).view.$resultsContainer.show(),this.resultItems.forEach(function(e){i.view.$resultsContainer.append(e.el),$(e.el)[e.selected?"addClass":"removeClass"]("selected"),$(e.el).on("click",function(t){i.api.asc_SelectSearchElement(e.id),$("#search-results").find(".item").removeClass("selected"),$(t.currentTarget).addClass("selected")})}),this.scrollToSelectedResult())},onHidePanel:function(){this.hideResults(),this.onSelectSearchingResults(!1)},onSelectSearchingResults:function(t){!t&&this.getApplication().getController("LeftMenu").isSearchPanelVisible()||this._state.isHighlightedResults!==t&&(this.api.asc_selectSearchingResults(t),this._state.isHighlightedResults=t)},onApiSearchEnd:function(){this._state.isContentChanged||(this._state.isContentChanged=!0,this.view.updateResultsNumber("content-changed"),this.view.disableReplaceButtons(!0))},onApiTextReplaced:function(t,e){t?0<t-e?this.view.updateResultsNumber("replace",[e,t,t-e]):this.view.updateResultsNumber("replace-all",e):Common.UI.info({msg:this.textNoTextFound})},getSearchText:function(){return this._state.searchText},getResultsNumber:function(){return[this._state.currentResult,this._state.resultsNumber]}},DE.Controllers.Search||{}))}),void 0===Common&&(Common={}),Common.Views=Common.Views||{},define("common/main/lib/view/Protection",["common/main/lib/util/utils","common/main/lib/component/BaseView","common/main/lib/component/Layout","common/main/lib/component/Window"],function(t){"use strict";Common.Views.Protection=Common.UI.BaseView.extend(_.extend({options:{},initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t),this.appConfig=t.mode,this.btnsInvisibleSignature=[],this.btnsAddPwd=[],this.btnsDelPwd=[],this.btnsChangePwd=[],this._state={disabled:!1,hasPassword:!1,disabledPassword:!1,invisibleSignDisabled:!1};t=Common.localStorage.getKeysFilter();this.appPrefix=t&&t.length?t.split(",")[0]:"",this.appConfig.isPasswordSupport&&(this.btnAddPwd=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-ic-protect",caption:this.txtEncrypt,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.btnsAddPwd.push(this.btnAddPwd),this.btnPwd=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-ic-protect",caption:this.txtEncrypt,split:!0,enableToggle:!0,menu:!0,visible:!1,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"})),this.appConfig.isSignatureSupport&&(this.btnSignature=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-ic-signature",caption:this.txtSignature,menu:"pe-"!==this.appPrefix,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.btnSignature.menu||this.btnsInvisibleSignature.push(this.btnSignature)),Common.NotificationCenter.on("app:ready",this.onAppReady.bind(this))},render:function(t){return this.boxSdk=$("#editor_sdk"),t&&t.html(this.getPanel()),this},onAppReady:function(t){var e=this;new Promise(function(t,e){t()}).then(function(){t.canProtect&&(t.isPasswordSupport&&(e.btnAddPwd.updateHint(e.hintAddPwd),e.btnPwd.updateHint([e.hintDelPwd,e.hintPwd]),e.btnPwd.setMenu(new Common.UI.Menu({items:[{caption:e.txtChangePwd,value:"add"},{caption:e.txtDeletePwd,value:"delete"}]}))),e.btnSignature&&(e.btnSignature.updateHint(e.btnSignature.menu?e.hintSignature:e.txtInvisibleSignature),e.btnSignature.menu&&e.btnSignature.setMenu(new Common.UI.Menu({items:[{caption:e.txtInvisibleSignature,value:"invisible"},{caption:e.txtSignatureLine,value:"visible",disabled:e._state.disabled}]}))),Common.NotificationCenter.trigger("tab:visible","protect",Common.UI.LayoutManager.isElementVisible("toolbar-protect"))),function(){var n=this;n.appConfig.isPasswordSupport&&(this.btnsAddPwd.concat(this.btnsChangePwd).forEach(function(t){t.on("click",function(t,e){n.fireEvent("protect:password",[t,"add"])})}),this.btnsDelPwd.forEach(function(t){t.on("click",function(t,e){n.fireEvent("protect:password",[t,"delete"])})}),this.btnPwd.on("click",function(t,e){t.pressed||n.fireEvent("protect:password",[t,"delete"])}),this.btnPwd.menu.on("item:click",function(t,e,i){n.fireEvent("protect:password",[t,e.value])})),n.appConfig.isSignatureSupport&&(this.btnSignature.menu&&(this.btnSignature.menu.on("item:click",function(t,e,i){n.fireEvent("protect:signature",[e.value,!1])}),this.btnSignature.menu.on("show:after",function(t,e){var i;n._state&&(i=!!n._state.docProtection&&(n._state.docProtection.isReadOnly||n._state.docProtection.isFormsOnly||n._state.docProtection.isCommentsOnly),t.items&&t.items[1].setDisabled(i||n._state.disabled))})),this.btnsInvisibleSignature.forEach(function(t){t.on("click",function(t,e){n.fireEvent("protect:signature",["invisible"])})})),n._isSetEvents=!0}.call(e)})},getPanel:function(){return this.$el=$(_.template('<section id="protection-panel" class="panel" data-tab="protect"><div class="group"><span id="slot-btn-add-password" class="btn-slot text x-huge"></span><span id="slot-btn-change-password" class="btn-slot text x-huge"></span><span id="slot-btn-signature" class="btn-slot text x-huge"></span></div></section>')({})),this.appConfig.canProtect&&(this.btnAddPwd&&this.btnAddPwd.render(this.$el.find("#slot-btn-add-password")),this.btnPwd&&this.btnPwd.render(this.$el.find("#slot-btn-change-password")),this.btnSignature&&this.btnSignature.render(this.$el.find("#slot-btn-signature"))),this.$el},show:function(){Common.UI.BaseView.prototype.show.call(this),this.fireEvent("show",this)},getButton:function(t,e){var i,n=this;return"signature"==t?(i=new Common.UI.Button({cls:"btn-text-default auto",caption:this.txtInvisibleSignature,disabled:this._state.invisibleSignDisabled,dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"medium"}),this.btnsInvisibleSignature.push(i),this._isSetEvents&&i.on("click",function(t,e){n.fireEvent("protect:signature",["invisible"])}),i):"add-password"==t?(i=new Common.UI.Button({cls:"btn-text-default auto",caption:this.txtAddPwd,disabled:this._state.disabled||this._state.disabledPassword,visible:!this._state.hasPassword,dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"medium"}),this.btnsAddPwd.push(i),this._isSetEvents&&i.on("click",function(t,e){n.fireEvent("protect:password",[t,"add"])}),i):"del-password"==t?(i=new Common.UI.Button({cls:"btn-text-default auto",caption:this.txtDeletePwd,disabled:this._state.disabled||this._state.disabledPassword,visible:this._state.hasPassword,dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"medium"}),this.btnsDelPwd.push(i),this._isSetEvents&&i.on("click",function(t,e){n.fireEvent("protect:password",[t,"delete"])}),i):"change-password"==t?(i=new Common.UI.Button({cls:"btn-text-default auto",caption:this.txtChangePwd,disabled:this._state.disabled||this._state.disabledPassword,visible:this._state.hasPassword,dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"medium"}),this.btnsChangePwd.push(i),this._isSetEvents&&i.on("click",function(t,e){n.fireEvent("protect:password",[t,"add"])}),i):void 0},SetDisabled:function(e,i){this._state.disabled=e,this._state.invisibleSignDisabled=e&&!i;var t=!!this._state.docProtection&&(this._state.docProtection.isReadOnly||this._state.docProtection.isFormsOnly||this._state.docProtection.isCommentsOnly);this.btnsInvisibleSignature&&this.btnsInvisibleSignature.forEach(function(t){t&&t.setDisabled(e&&!i)},this),this.btnSignature&&this.btnSignature.menu&&(this.btnSignature.menu.items&&this.btnSignature.menu.items[1].setDisabled(e||t),this.btnSignature.setDisabled(e&&!i)),this.btnsAddPwd.concat(this.btnsDelPwd,this.btnsChangePwd).forEach(function(t){t&&t.setDisabled(e||this._state.disabledPassword)},this)},onDocumentPassword:function(e,t){this._state.hasPassword=e,this._state.disabledPassword=!!t;var i=this._state.disabledPassword||this._state.disabled;this.btnsAddPwd&&this.btnsAddPwd.forEach(function(t){t&&(t.setVisible(!e),t.setDisabled(i))},this),this.btnsDelPwd.concat(this.btnsChangePwd).forEach(function(t){t&&(t.setVisible(e),t.setDisabled(i))},this),this.btnPwd.setVisible(e),this.btnPwd.toggle(e,!0)}},Common.Views.Protection||{}))}),define("documenteditor/main/app/view/DocProtection",["common/main/lib/util/utils","common/main/lib/component/BaseView","common/main/lib/component/Layout","common/main/lib/component/Window"],function(t){"use strict";DE.Views.DocProtection=Common.UI.BaseView.extend(_.extend({options:{},initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t),this.appConfig=t.mode;t=Common.enumLock;this.lockedControls=[],this._state={disabled:!1,currentProtectHint:this.hintProtectDoc},this.btnProtectDoc=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-restrict-editing",enableToggle:!0,caption:this.txtProtectDoc,lock:[t.lostConnect,t.coAuth,t.previewReviewMode,t.viewFormMode,t.protectLock],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.lockedControls.push(this.btnProtectDoc),Common.NotificationCenter.on("app:ready",this.onAppReady.bind(this))},render:function(t){return this},onAppReady:function(t){var e=this;new Promise(function(t,e){t()}).then(function(){e.btnProtectDoc.updateHint(e._state.currentProtectHint,!0),function(){var i=this;this.btnProtectDoc.on("click",function(t,e){i.fireEvent("protect:document",[t.pressed])}),i._isSetEvents=!0}.call(e)})},getPanel:function(){return this.$el=$(_.template('<div class="group"><span id="slot-btn-protect-doc" class="btn-slot text x-huge"></span></div>')({})),this.btnProtectDoc.render(this.$el.find("#slot-btn-protect-doc")),this.$el},getButtons:function(t){return void 0===t?this.lockedControls:[]},show:function(){Common.UI.BaseView.prototype.show.call(this),this.fireEvent("show",this)},updateProtectionTips:function(t){var e=this.txtProtectDoc;t===Asc.c_oAscEDocProtect.ReadOnly?e=this.txtDocProtectedView:t===Asc.c_oAscEDocProtect.Comments?e=this.txtDocProtectedComment:t===Asc.c_oAscEDocProtect.Forms?e=this.txtDocProtectedForms:t===Asc.c_oAscEDocProtect.TrackedChanges&&(e=this.txtDocProtectedTrack),this.btnProtectDoc.updateHint(e,!0),this._state.currentProtectHint=e}},DE.Views.DocProtection||{}))}),define("documenteditor/main/app/view/ProtectDialog",["common/main/lib/component/Window"],function(){"use strict";DE.Views.ProtectDialog=Common.UI.Window.extend(_.extend({initialize:function(t){var e={};_.extend(e,{title:t.title||this.txtTitle,cls:"modal-dlg",width:350,height:"auto",buttons:t.buttons||[{value:"ok",caption:this.txtProtect},"cancel"]},t),this.handler=t.handler,this.props=t.props,this.template=t.template||['<div class="box">','<div class="input-row">',"<label>"+this.txtPassword+" ("+this.txtOptional+")</label>","</div>",'<div id="id-protect-password-txt" class="input-row" style="margin-bottom: 5px;"></div>','<div class="input-row">',"<label>"+this.txtRepeat+"</label>","</div>",'<div id="id-protect-repeat-txt" class="input-row" style="margin-bottom: 10px;"></div>','<div class="" style="margin-bottom: 5px;">','<label class="font-weight-bold" style="margin-bottom: 5px;">'+this.txtAllow+"</label>","</div>",'<div id="id-protect-radio-view" style="margin-bottom: 8px;"></div>','<div id="id-protect-radio-forms" style="margin-bottom: 8px;"></div>','<div id="id-protect-radio-review" style="margin-bottom: 8px;"></div>','<div id="id-protect-radio-comment" style="margin-bottom: 8px;"></div>',"<label>"+this.txtWarning+"</label>","</div>"].join(""),e.tpl=_.template(this.template)(e),Common.UI.Window.prototype.initialize.call(this,e)},render:function(){Common.UI.Window.prototype.render.call(this);var e=this;this.$window.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.repeatPwd=new Common.UI.InputField({el:this.$window.find("#id-protect-repeat-txt"),type:"password",allowBlank:!0,style:"width: 100%;",maxLength:15,validateOnBlur:!1,validation:function(t){return e.txtIncorrectPwd}}),this.inputPwd=new Common.UI.InputFieldBtnPassword({el:this.$window.find("#id-protect-password-txt"),type:"password",allowBlank:!0,style:"width: 100%;",maxLength:15,validateOnBlur:!1,repeatInput:this.repeatPwd,showPwdOnClick:!0,validation:function(t){return!(15<t.length)||e.txtLimit}}),this.rbView=new Common.UI.RadioBox({el:this.$window.find("#id-protect-radio-view"),labelText:this.textView,name:"asc-radio-protect-mode",value:Asc.c_oAscEDocProtect.ReadOnly,checked:!0}),this.rbForms=new Common.UI.RadioBox({el:this.$window.find("#id-protect-radio-forms"),labelText:this.textForms,name:"asc-radio-protect-mode",value:Asc.c_oAscEDocProtect.Forms}),this.rbReview=new Common.UI.RadioBox({el:this.$window.find("#id-protect-radio-review"),labelText:this.textReview,name:"asc-radio-protect-mode",value:Asc.c_oAscEDocProtect.TrackedChanges}),this.rbComments=new Common.UI.RadioBox({el:this.$window.find("#id-protect-radio-comment"),labelText:this.textComments,name:"asc-radio-protect-mode",value:Asc.c_oAscEDocProtect.Comments}),this.btnOk=new Common.UI.Button({el:this.$window.find(".primary")}),this.afterRender()},getFocusedComponents:function(){return[this.inputPwd,this.repeatPwd,this.rbView,this.rbForms,this.rbReview,this.rbComments]},getDefaultFocusableComponent:function(){return this.inputPwd},afterRender:function(){this._setDefaults(this.props)},onPrimary:function(t){return this._handleInput("ok"),!1},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},_handleInput:function(t){if("ok"!==t||!this.btnOk.isDisabled()){if(this.handler){if("ok"===t){if(!0!==this.inputPwd.checkValidate())return void this.inputPwd.focus();if(this.inputPwd.getValue()!==this.repeatPwd.getValue())return this.repeatPwd.checkValidate(),void this.repeatPwd.focus()}this.handler.call(this,t,this.inputPwd.getValue(),"ok"==t?this.getSettings():void 0)}this.close()}},_setDefaults:function(t){},getSettings:function(){return this.rbView.getValue()?Asc.c_oAscEDocProtect.ReadOnly:this.rbForms.getValue()?Asc.c_oAscEDocProtect.Forms:this.rbReview.getValue()?Asc.c_oAscEDocProtect.TrackedChanges:this.rbComments.getValue()?Asc.c_oAscEDocProtect.Comments:void 0},SetDisabled:function(t){this.btnOk.setDisabled(t)}},DE.Views.ProtectDialog||{}))}),define("documenteditor/main/app/controller/DocProtection",["core","common/main/lib/view/Protection","documenteditor/main/app/view/DocProtection","documenteditor/main/app/view/ProtectDialog"],function(){"use strict";Common.enumLock||(Common.enumLock={});var t,e={docLockView:"lock-mode-view",docLockForms:"lock-mode-forms",docLockReview:"lock-mode-review",docLockComments:"lock-mode-comments",protectLock:"protect-lock"};for(t in e)e.hasOwnProperty(t)&&(Common.enumLock[t]=e[t]);DE.Controllers.DocProtection=Backbone.Controller.extend(_.extend({models:[],collections:[],views:["DocProtection"],initialize:function(){this.addListeners({DocProtection:{"protect:document":_.bind(this.onProtectDocClick,this)}})},onLaunch:function(){this._state={},Common.NotificationCenter.on("app:ready",this.onAppReady.bind(this))},setConfig:function(t,e){this.setApi(e)},setApi:function(t){this.userCollection=this.getApplication().getCollection("Common.Collections.Users"),t&&(this.api=t,this.api.asc_registerCallback("asc_onChangeDocumentProtection",_.bind(this.onChangeProtectDocument,this)),this.api.asc_registerCallback("asc_onLockDocumentProtection",_.bind(this.onLockDocumentProtection,this)))},setMode:function(t){return this.appConfig=t,this.currentUserId=t.user.id,this.appConfig.isEdit&&this.appConfig.canProtect&&(this.view=this.createView("DocProtection",{mode:t})),this},createToolbarPanel:function(){if(this.view)return this.view.getPanel()},getView:function(t){return!t&&this.view?this.view:Backbone.Controller.prototype.getView.call(this,t)},onProtectDocClick:function(t){var n,i;this.view.btnProtectDoc.toggle(!t,!0),t?((n=this)._docProtectDlg=new DE.Views.ProtectDialog({props:n.appConfig,handler:function(t,e,i){"ok"==t&&((t=n.api.asc_getDocumentProtection()||new AscCommonWord.CDocProtect).asc_setEditType(i),t.asc_setPassword(e),n.api.asc_setDocumentProtection(t)),Common.NotificationCenter.trigger("edit:complete")}}).on("close",function(){n._docProtectDlg=void 0}),n._docProtectDlg.show()):(i=(n=this).api.asc_getDocumentProtection())&&i.asc_getIsPassword()?new Common.Views.OpenDialog({title:n.view.txtUnlockTitle,closable:!0,type:Common.Utils.importTextType.DRM,txtOpenFile:n.view.txtDocUnlockDescription,validatePwd:!1,maxPasswordLength:15,handler:function(t,e){"ok"==t&&(n.api&&(i.asc_setEditType(Asc.c_oAscEDocProtect.None),e&&e.drmOptions&&i.asc_setPassword(e.drmOptions.asc_getPassword()),n.api.asc_setDocumentProtection(i)),Common.NotificationCenter.trigger("edit:complete"))}}).on("close",function(){}).show():((i=i||new AscCommonWord.CDocProtect).asc_setEditType(Asc.c_oAscEDocProtect.None),n.api.asc_setDocumentProtection(i))},onAppReady:function(t){var o;this.api&&(o=this,new Promise(function(t){t()}).then(function(){var t,e=o.api.asc_getDocumentProtection(),i=e?e.asc_getEditType():Asc.c_oAscEDocProtect.None,n=i===Asc.c_oAscEDocProtect.ReadOnly||i===Asc.c_oAscEDocProtect.Comments||i===Asc.c_oAscEDocProtect.TrackedChanges||i===Asc.c_oAscEDocProtect.Forms;if(o.view&&o.view.btnProtectDoc.toggle(!!n,!0),n){switch(i){case Asc.c_oAscEDocProtect.ReadOnly:t=o.txtIsProtectedView;break;case Asc.c_oAscEDocProtect.Comments:t=o.txtIsProtectedComment;break;case Asc.c_oAscEDocProtect.Forms:t=o.txtIsProtectedForms;break;case Asc.c_oAscEDocProtect.TrackedChanges:t=o.txtIsProtectedTrack}o._protectionTip=new Common.UI.SynchronizeTip({extCls:"no-arrow",placement:"bottom",target:$(".toolbar"),text:t,showLink:!1,style:"max-width: 400px;"}),o._protectionTip.on("closeclick",function(){this.close()}).show()}e&&o.applyRestrictions(i)}))},onChangeProtectDocument:function(t){this._protectionTip&&this._protectionTip.isVisible()&&(this._protectionTip.close(),this._protectionTip=void 0);var e,i=this.getDocProps(!0),n=i&&(i.isReadOnly||i.isCommentsOnly||i.isFormsOnly||i.isReviewOnly),o=(this.view&&this.view.btnProtectDoc.toggle(n,!0),this.getApplication().getController("FormsTab")),o=(o&&o.changeViewFormMode(!1),this.getApplication().getController("Common.Controllers.ReviewChanges"));if(o&&o.isPreviewChangesMode()&&(e=Common.Utils.InternalSettings.get("de-review-mode-editor")||"markup",o.turnDisplayMode(e),o.view&&o.view.turnDisplayMode(e)),i&&this.applyRestrictions(i.type),this._docProtectDlg&&this._docProtectDlg.isVisible()&&this._docProtectDlg.SetDisabled(!!this._state.lockDocProtect||n),Common.NotificationCenter.trigger("protect:doclock",i),t&&this.userCollection){o=this.userCollection.findOriginalUser(t);if(o&&o.get("idOriginal")!==this.currentUserId){var s=this.txtWasUnprotected;switch(this._state.docProtection.type){case Asc.c_oAscEDocProtect.ReadOnly:s=this.txtWasProtectedView;break;case Asc.c_oAscEDocProtect.Comments:s=this.txtWasProtectedComment;break;case Asc.c_oAscEDocProtect.Forms:s=this.txtWasProtectedForms;break;case Asc.c_oAscEDocProtect.TrackedChanges:s=this.txtWasProtectedTrack}s&&Common.NotificationCenter.trigger("showmessage",{msg:s},{timeout:5e3,hideCloseTip:!0})}}},getDocProps:function(t){if(this.appConfig&&(this.appConfig.isEdit||this.appConfig.isRestrictedEdit))return!t&&this._state.docProtection||(t=(t=this.api.asc_getDocumentProtection())?t.asc_getEditType():Asc.c_oAscEDocProtect.None,this._state.docProtection={type:t,isReadOnly:t===Asc.c_oAscEDocProtect.ReadOnly,isCommentsOnly:t===Asc.c_oAscEDocProtect.Comments,isReviewOnly:t===Asc.c_oAscEDocProtect.TrackedChanges,isFormsOnly:t===Asc.c_oAscEDocProtect.Forms}),this._state.docProtection},applyRestrictions:function(t){t===Asc.c_oAscEDocProtect.ReadOnly?this.api.asc_setRestriction(Asc.c_oAscRestrictionType.View):t===Asc.c_oAscEDocProtect.Comments?this.api.asc_setRestriction(this.appConfig.canComments?Asc.c_oAscRestrictionType.OnlyComments:Asc.c_oAscRestrictionType.View):t===Asc.c_oAscEDocProtect.Forms?this.api.asc_setRestriction(this.appConfig.canFillForms?Asc.c_oAscRestrictionType.OnlyForms:Asc.c_oAscRestrictionType.View):this.appConfig.isRestrictedEdit?(this.appConfig.canComments&&this.api.asc_setRestriction(Asc.c_oAscRestrictionType.OnlyComments),this.appConfig.canFillForms&&this.api.asc_setRestriction(Asc.c_oAscRestrictionType.OnlyForms)):this.api.asc_setRestriction(Asc.c_oAscRestrictionType.None),this.view&&this.view.updateProtectionTips(t)},onLockDocumentProtection:function(t){this._state.lockDocProtect=t,this.view&&Common.Utils.lockControls(Common.enumLock.protectLock,t,{array:[this.view.btnProtectDoc]}),this._docProtectDlg&&this._docProtectDlg.isVisible()&&this._docProtectDlg.SetDisabled(t||this._state.docProtection&&(this._state.docProtection.isReadOnly||this._state.docProtection.isFormsOnly||this._state.docProtection.isCommentsOnly||this._state.docProtection.isReviewOnly))}},DE.Controllers.DocProtection||{}))}),define("common/main/lib/view/DocumentAccessDialog",["common/main/lib/component/Window","common/main/lib/component/LoadMask"],function(){"use strict";Common.Views.DocumentAccessDialog=Common.UI.Window.extend(_.extend({initialize:function(t){var e={};_.extend(e,{title:this.textTitle,width:600,height:536,header:!0},t),this.template=['<div id="id-sharing-placeholder"></div>'].join(""),e.tpl=_.template(this.template)(e),this.settingsurl=t.settingsurl||"",Common.UI.Window.prototype.initialize.call(this,e)},render:function(){Common.UI.Window.prototype.render.call(this),this.$window.find("> .body").css({height:"auto",overflow:"hidden"});var t=document.createElement("iframe"),e=(t.width="100%",t.height=500,t.align="top",t.frameBorder=0,t.scrolling="no",t.onload=_.bind(this._onLoad,this),$("#id-sharing-placeholder").append(t),this.loadMask=new Common.UI.LoadMask({owner:$("#id-sharing-placeholder")}),this.loadMask.setTitle(this.textLoading),this.loadMask.show(),t.src=this.settingsurl,this);this._eventfunc=function(t){e._onWindowMessage(t)},this._bindWindowEvents.call(this),this.on("close",function(t){e._unbindWindowEvents()})},_bindWindowEvents:function(){window.addEventListener?window.addEventListener("message",this._eventfunc,!1):window.attachEvent&&window.attachEvent("onmessage",this._eventfunc)},_unbindWindowEvents:function(){window.removeEventListener?window.removeEventListener("message",this._eventfunc):window.detachEvent&&window.detachEvent("onmessage",this._eventfunc)},_onWindowMessage:function(t){if(t&&window.JSON)try{this._onMessage.call(this,window.JSON.parse(t.data))}catch(t){}},_onMessage:function(t){t&&"onlyoffice"==t.Referer&&(t.needUpdate&&this.trigger("accessrights",this,t.sharingSettings),Common.NotificationCenter.trigger("window:close",this))},_onLoad:function(){this.loadMask&&this.loadMask.hide()}},Common.Views.DocumentAccessDialog||{}))}),define("text!common/main/lib/template/AutoCorrectDialog.template",[],function(){return'<div id="id-autocorrect-dialog-settings-math" class="settings-panel active">\n    <div class="inner-content">\n        <table cols="1" style="width: 100%;">\n        <tr>\n            <td style="padding-bottom: 8px;">\n                <div id="auto-correct-chb-replace-type"></div>\n            </td>\n        </tr>\n        <tr>\n            <td>\n                <label style="width: 117px;"><%= scope.textReplace %>:</label>\n                <label><%= scope.textBy %>:</label>\n                </td>\n            </tr>\n        <tr>\n            <td>\n                <div id="auto-correct-replace" class="margin-right-2" style="height:22px;width: 115px;display: inline-block;"></div>\n                <div id="auto-correct-by" style="height:22px;width: 234px;display: inline-block;"></div>\n                </td>\n            </tr>\n        <tr>\n            <td style="padding-bottom: 8px;">\n                <div id="auto-correct-math-list" class="" style="width:100%; height: 208px;"></div>\n                </td>\n            </tr>\n        <tr>\n            <td style="padding-bottom: 8px;">\n                <button type="button" class="btn btn-text-default auto" id="auto-correct-btn-reset" style="min-width: 86px;"><%= scope.textResetAll %></button>\n                <button type="button" class="btn btn-text-default auto float-right" id="auto-correct-btn-delete" style="min-width: 86px;"><%= scope.textDelete %></button>\n                <button type="button" class="btn btn-text-default auto float-right margin-right-5" id="auto-correct-btn-edit" style="min-width: 86px;"><%= scope.textAdd %></button>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-autocorrect-dialog-settings-recognized" class="settings-panel">\n    <div class="inner-content">\n        <table cols="1" style="width: 100%;">\n            <tr>\n                <td style="padding-bottom: 8px;">\n                    <label><%= scope.textRecognizedDesc %></label>\n                </td>\n            </tr>\n            <tr>\n                <td>\n                    <div id="auto-correct-rec-find" style="height:22px;width: 100%;margin-bottom: 4px;"></div>\n                </td>\n            </tr>\n            <tr>\n                <td style="padding-bottom: 8px;">\n                    <div id="auto-correct-recognized-list" class="" style="width:100%; height: 208px;"></div>\n                </td>\n            </tr>\n            <tr>\n                <td style="padding-bottom: 8px;">\n                    <button type="button" class="btn btn-text-default auto" id="auto-correct-btn-rec-reset" style="min-width: 86px;"><%= scope.textResetAll %></button>\n                    <button type="button" class="btn btn-text-default auto float-right" id="auto-correct-btn-rec-delete" style="min-width: 86px;"><%= scope.textDelete %></button>\n                    <button type="button" class="btn btn-text-default auto float-right margin-right-5" id="auto-correct-btn-rec-edit" style="min-width: 86px;"><%= scope.textAdd %></button>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-autocorrect-dialog-settings-de-autoformat" class="settings-panel">\n    <div class="inner-content" style="width: 100%;">\n        <div class="padding-small">\n            <label class="header"><%= scope.textReplaceText %></label>\n        </div>\n        <div class="padding-small">\n            <div class="padding-small" id="id-autocorrect-dialog-chk-quotes"></div>\n            <div class="padding-small" id="id-autocorrect-dialog-chk-hyphens"></div>\n            <div class="padding-small"  id="id-autocorrect-dialog-chk-hyperlink"></div>\n            <div class="padding-small" id="id-autocorrect-dialog-chk-double-space"></div>\n        </div>\n        <div class="padding-small">\n            <label class="header"><%= scope.textApplyText %></label>\n        </div>\n        <div class="padding-small">\n            <div class="padding-small" id="id-autocorrect-dialog-chk-bulleted"></div>\n            <div class="padding-small" id="id-autocorrect-dialog-chk-numbered"></div>\n        </div>\n    </div>\n</div>\n<div id="id-autocorrect-dialog-settings-sse-autoformat" class="settings-panel">\n    <div class="inner-content" style="width: 100%;">\n        <div class="padding-small">\n            <label class="header"><%= scope.textReplaceText %></label>\n        </div>\n        <div class="padding-small">\n            <div class="padding-small" id="id-autocorrect-dialog-chk-hyperlink"></div>\n        </div>\n        <div class="padding-small">\n            <label class="header"><%= scope.textApplyAsWork %></label>\n        </div>\n        <div class="padding-small">\n            <div class="padding-small" id="id-autocorrect-dialog-chk-new-rows"></div>\n        </div>\n    </div>\n</div>\n<div id="id-autocorrect-dialog-settings-exceptions" class="settings-panel">\n    <div class="inner-content">\n        <table cols="1" style="width: 100%;">\n            <tr>\n                <td style="padding-bottom: 12px;">\n                    <div id="auto-correct-exceptions-chk-sentence" style="padding-bottom: 8px;"></div>\n                    <div id="auto-correct-exceptions-chk-cells"></div>\n                </td>\n            </tr>\n            <tr>\n                <td>\n                    <label><%= scope.textForLangFL %></label>\n                </td>\n            </tr>\n            <tr>\n                <td style="padding-bottom: 12px;">\n                    <div id="auto-correct-exceptions-lang" style="display: inline-block;vertical-align: middle;"></div>\n                </td>\n            </tr>\n            <tr>\n                <td>\n                    <label><%= scope.textFLDont %></label>\n                    <div id="auto-correct-exceptions-find" style="height:22px;width: 100%;margin-bottom: 4px;"></div>\n                </td>\n            </tr>\n            <tr>\n                <td style="padding-bottom: 8px;">\n                    <div id="auto-correct-exceptions-list" class="" style="width:100%; height: 139px;"></div>\n                </td>\n            </tr>\n            <tr>\n                <td style="padding-bottom: 18px;">\n                    <button type="button" class="btn btn-text-default auto" id="auto-correct-btn-exceptions-reset" style="min-width: 86px;"><%= scope.textResetAll %></button>\n                    <button type="button" class="btn btn-text-default auto float-right" id="auto-correct-btn-exceptions-delete" style="min-width: 86px;"><%= scope.textDelete %></button>\n                    <button type="button" class="btn btn-text-default auto float-right margin-right-5" id="auto-correct-btn-exceptions-edit" style="min-width: 86px;"><%= scope.textAdd %></button>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n'}),void 0===Common&&(Common={}),define("common/main/lib/view/AutoCorrectDialog",["text!common/main/lib/template/AutoCorrectDialog.template","common/main/lib/component/ListView","common/main/lib/component/Window","common/main/lib/component/CheckBox"],function(s){"use strict";var r=new Common.UI.DataViewStore,a=new Common.UI.DataViewStore,l=new Common.UI.DataViewStore,c=[1033,1049];Common.Views.AutoCorrectDialog=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:375,height:430,buttons:null,toggleGroup:"autocorrect-dialog-group"},initialize:function(t){var e=Common.localStorage.getKeysFilter(),i=this,e=(this.appPrefix=e&&e.length?e.split(",")[0]:"",[{panelId:"id-autocorrect-dialog-settings-math",panelCaption:this.textMathCorrect},{panelId:"id-autocorrect-dialog-settings-recognized",panelCaption:this.textRecognized}]),n=("de-"==this.appPrefix||"pe-"==this.appPrefix?(e.push({panelId:"id-autocorrect-dialog-settings-de-autoformat",panelCaption:this.textAutoFormat}),e.push({panelId:"id-autocorrect-dialog-settings-exceptions",panelCaption:this.textAutoCorrect})):"sse-"==this.appPrefix&&e.push({panelId:"id-autocorrect-dialog-settings-sse-autoformat",panelCaption:this.textAutoFormat}),_.extend(this.options,{title:this.textTitle,storageName:this.appPrefix+"autocorrect-dialog-category",items:e,template:['<div class="box" style="height:'+(this.options.height-85)+'px;">','<div class="menu-panel" style="overflow: hidden;">',"<% _.each(items, function(item) { %>",'<button class="btn btn-category" content-target="<%= item.panelId %>"><span class=""><%= item.panelCaption %></span></button>',"<% }); %>","</div>",'<div class="separator"></div>','<div class="content-panel">'+_.template(s)({scope:this})+"</div>","</div>",'<div class="separator horizontal"></div>','<div class="footer center">','<button class="btn normal dlg-btn" result="cancel" style="width: 86px;">'+this.closeButtonText+"</button>","</div>"].join("")},t||{}),this.api=this.options.api,this.appPrefix+"settings-math-correct"),o=Common.Utils.InternalSettings.get(n+"-add");this.arrAdd=o?JSON.parse(o):[],o=Common.Utils.InternalSettings.get(n+"-rem"),this.arrRem=o?JSON.parse(o):[],n=this.appPrefix+"settings-rec-functions",o=Common.Utils.InternalSettings.get(n+"-add"),this.arrAddRec=o?JSON.parse(o):[],o=Common.Utils.InternalSettings.get(n+"-rem"),this.arrRemRec=o?JSON.parse(o):[],this.arrAddExceptions={},this.arrRemExceptions={},c.forEach(function(t){n=i.appPrefix+"settings-letter-exception",o=Common.Utils.InternalSettings.get(n+"-add-"+t),i.arrAddExceptions[t]=o?JSON.parse(o):[],o=Common.Utils.InternalSettings.get(n+"-rem-"+t),i.arrRemExceptions[t]=o?JSON.parse(o):[]}),Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var i,e,t,n=this.getChild(),o=this,s=n.find("#id-autocorrect-dialog-settings-"+("pe-"==this.appPrefix?"de-":this.appPrefix)+"autoformat");this.chReplaceType=new Common.UI.CheckBox({el:n.find("#auto-correct-chb-replace-type"),labelText:this.textReplaceType,value:Common.Utils.InternalSettings.get(this.appPrefix+"settings-math-correct-replace-type")}).on("change",function(t,e,i,n){t="checked"===t.getValue();Common.localStorage.setBool(o.appPrefix+"settings-math-correct-replace-type",t),Common.Utils.InternalSettings.set(o.appPrefix+"settings-math-correct-replace-type",t),o.api.asc_updateFlagAutoCorrectMathSymbols(t)}),this.onInitList(),this.mathList=new Common.UI.ListView({el:n.find("#auto-correct-math-list"),store:new Common.UI.DataViewStore(r.slice(0,9)),simpleAddMode:!1,template:_.template(['<div class="listview inner" style=""></div>'].join("")),itemTemplate:_.template(['<div id="<%= id %>" class="list-item" style="pointer-events:none;width: 100%;display:flex;">','<div class="padding-right-5" style="width:110px;overflow: hidden;text-overflow: ellipsis;<% if (defaultDisabled) { %> font-style:italic; opacity: 0.5;<% } %>"><%= replaced %></div>','<div style="width:230px;overflow-x: clip;overflow-y:visible;text-overflow: ellipsis;flex-grow:1;font-family: Cambria Math;font-size:13px;white-space: nowrap;<% if (defaultDisabled) { %> font-style:italic; opacity: 0.5;<% } %>"><%= by %></div>',"</div>"].join("")),scrollAlwaysVisible:!0,tabindex:1}),this.mathList.on("item:select",_.bind(this.onSelectMathItem,this)),this.inputReplace=new Common.UI.InputField({el:n.find("#auto-correct-replace"),allowBlank:!0,validateOnChange:!0,maxLength:31,validation:function(){return!0}}).on("changing",function(t,e){var i;e.length&&(i=o.mathList.store.find(function(t){if(0==t.get("replaced").indexOf(e))return!0}))&&(o.mathList.scrollToRecord(i,!0),i.get("replaced")==e?o.mathList.selectRecord(i,!0):i=null),i||o.mathList.deselectAll(),o.updateControls(i)}),this.inputReplace.cmpEl.find("input").on("keydown",function(t){"ArrowDown"==t.key&&((t=o.mathList.getSelectedRec()||o.mathList.store.at(0))&&(o.mathList.selectRecord(t),o.mathList.scrollToRecord(t)),_.delay(function(){o.mathList.focus()},10))}),this.inputBy=new Common.UI.InputField({el:n.find("#auto-correct-by"),allowBlank:!0,validateOnChange:!0,maxLength:255,validation:function(){return!0}}).on("changing",function(t,e){o.updateControls()}),this.btnReset=new Common.UI.Button({el:n.find("#auto-correct-btn-reset")}),this.btnReset.on("click",_.bind(this.onResetToDefault,this)),this.btnEdit=new Common.UI.Button({el:n.find("#auto-correct-btn-edit")}),this.btnEdit.on("click",_.bind(this.onEdit,this,!1)),this.btnDelete=new Common.UI.Button({el:n.find("#auto-correct-btn-delete")}),this.btnDelete.on("click",_.bind(this.onDelete,this,!1)),this.onInitRecList(),this.mathRecList=new Common.UI.ListView({el:n.find("#auto-correct-recognized-list"),store:new Common.UI.DataViewStore(a.slice(0,9)),simpleAddMode:!1,template:_.template(['<div class="listview inner" style=""></div>'].join("")),itemTemplate:_.template(['<div id="<%= id %>" class="list-item" style="width: 340px;text-overflow: ellipsis;overflow: hidden;<% if (defaultDisabled) { %> font-style:italic; opacity: 0.5;<% } %>"><%= value %></div>'].join("")),scrollAlwaysVisible:!0,tabindex:1}),this.mathRecList.on("item:select",_.bind(this.onSelectRecItem,this)),this.inputRecFind=new Common.UI.InputField({el:n.find("#auto-correct-rec-find"),allowBlank:!0,validateOnChange:!0,maxLength:255,validation:function(){return!0}}).on("changing",function(t,e){var i;e.length&&(i=o.mathRecList.store.find(function(t){if(0==t.get("value").indexOf(e))return!0}))&&(o.mathRecList.scrollToRecord(i,!0),i.get("value")==e?o.mathRecList.selectRecord(i,!0):i=null),i||o.mathRecList.deselectAll(),o.updateRecControls(i)}),this.inputRecFind.cmpEl.find("input").on("keydown",function(t){"ArrowDown"==t.key&&((t=o.mathRecList.getSelectedRec()||o.mathRecList.store.at(0))&&(o.mathRecList.selectRecord(t),o.mathRecList.scrollToRecord(t)),_.delay(function(){o.mathRecList.focus()},10))}),this.btnResetRec=new Common.UI.Button({el:n.find("#auto-correct-btn-rec-reset")}),this.btnResetRec.on("click",_.bind(this.onResetRecToDefault,this)),this.btnAddRec=new Common.UI.Button({el:n.find("#auto-correct-btn-rec-edit")}),this.btnAddRec.on("click",_.bind(this.onAddRec,this,!1)),this.btnDeleteRec=new Common.UI.Button({el:n.find("#auto-correct-btn-rec-delete")}),this.btnDeleteRec.on("click",_.bind(this.onDeleteRec,this,!1)),"de-"==this.appPrefix||"pe-"==this.appPrefix?(this.chQuotes=new Common.UI.CheckBox({el:n.find("#id-autocorrect-dialog-chk-quotes"),labelText:this.textQuotes,value:Common.Utils.InternalSettings.get(this.appPrefix+"settings-autoformat-smart-quotes")}).on("change",function(t,e,i,n){t="checked"===t.getValue();Common.localStorage.setBool(o.appPrefix+"settings-autoformat-smart-quotes",t),Common.Utils.InternalSettings.set(o.appPrefix+"settings-autoformat-smart-quotes",t),o.api.asc_SetAutoCorrectSmartQuotes(t)}),this.chHyphens=new Common.UI.CheckBox({el:n.find("#id-autocorrect-dialog-chk-hyphens"),labelText:this.textHyphens,value:Common.Utils.InternalSettings.get(this.appPrefix+"settings-autoformat-hyphens")}).on("change",function(t,e,i,n){t="checked"===t.getValue();Common.localStorage.setBool(o.appPrefix+"settings-autoformat-hyphens",t),Common.Utils.InternalSettings.set(o.appPrefix+"settings-autoformat-hyphens",t),o.api.asc_SetAutoCorrectHyphensWithDash(t)}),this.chBulleted=new Common.UI.CheckBox({el:n.find("#id-autocorrect-dialog-chk-bulleted"),labelText:this.textBulleted,value:Common.Utils.InternalSettings.get(this.appPrefix+"settings-autoformat-bulleted")}).on("change",function(t,e,i,n){t="checked"===t.getValue();Common.localStorage.setBool(o.appPrefix+"settings-autoformat-bulleted",t),Common.Utils.InternalSettings.set(o.appPrefix+"settings-autoformat-bulleted",t),o.api.asc_SetAutomaticBulletedLists(t)}),this.chNumbered=new Common.UI.CheckBox({el:n.find("#id-autocorrect-dialog-chk-numbered"),labelText:this.textNumbered,value:Common.Utils.InternalSettings.get(this.appPrefix+"settings-autoformat-numbered")}).on("change",function(t,e,i,n){t="checked"===t.getValue();Common.localStorage.setBool(o.appPrefix+"settings-autoformat-numbered",t),Common.Utils.InternalSettings.set(o.appPrefix+"settings-autoformat-numbered",t),o.api.asc_SetAutomaticNumberedLists(t)}),this.chDoubleSpaces=new Common.UI.CheckBox({el:s.find("#id-autocorrect-dialog-chk-double-space"),labelText:this.textDoubleSpaces,value:Common.Utils.InternalSettings.get(this.appPrefix+"settings-autoformat-double-space")}).on("change",function(t,e,i,n){t="checked"===t.getValue();Common.localStorage.setBool(o.appPrefix+"settings-autoformat-double-space",t),Common.Utils.InternalSettings.set(o.appPrefix+"settings-autoformat-double-space",t),o.api.asc_SetAutoCorrectDoubleSpaceWithPeriod(t)}),i=Common.Utils.InternalSettings.get("settings-letter-exception-lang"),this.exceptionsLangCmb=new Common.UI.ComboBox({el:n.find("#auto-correct-exceptions-lang"),style:"width: 145px;",menuStyle:"min-width:100%;",editable:!1,takeFocusOnClose:!0,menuCls:"menu-aligned",cls:"input-group-nr",dataHintDirection:"bottom",data:c.map(function(t){var e=Common.util.LanguageInfo.getLocalLanguageName(t);return{displayValue:e[1],shortName:e[0],value:t}})}).on("selected",function(t,e){i!=e.value&&(i=e.value,Common.Utils.InternalSettings.set("settings-letter-exception-lang",i),o.onInitExceptionsList(!0),o.onChangeInputException(o.exceptionsFindInput,o.exceptionsFindInput.getValue()))}),i||((t=this.exceptionsLangCmb.store.findWhere({value:this.api.asc_getDefaultLanguage()}))||(e=Common.util.LanguageInfo.getLocalLanguageName(this.api.asc_getDefaultLanguage())[0].split(/[\-\_]/)[0],t=this.exceptionsLangCmb.store.find(function(t){return 0==t.get("shortName").indexOf(e)})),t&&(i=t.get("value"))),this.exceptionsLangCmb.setValue(i||c[0]),this.onInitExceptionsList(!0),this.exceptionsList=new Common.UI.ListView({el:n.find("#auto-correct-exceptions-list"),store:new Common.UI.DataViewStore(l.slice(0,6)),simpleAddMode:!1,template:_.template(['<div class="listview inner" style=""></div>'].join("")),itemTemplate:_.template(['<div id="<%= id %>" class="list-item" style="width: 340px;text-overflow: ellipsis;overflow: hidden;<% if (defaultDisabled) { %> font-style:italic; opacity: 0.5;<% } %>"><%= value + "."%></div>'].join("")),scrollAlwaysVisible:!0,tabindex:1}),this.exceptionsList.on("item:select",_.bind(this.onSelectExceptionItem,this)),this.exceptionsFindInput=new Common.UI.InputField({el:n.find("#auto-correct-exceptions-find"),allowBlank:!0,validateOnChange:!0,maxLength:255,validation:function(){return!0}}).on("changing",_.bind(this.onChangeInputException,this)),this.exceptionsFindInput.cmpEl.find("input").on("keydown",function(t){"ArrowDown"==t.key&&((t=o.exceptionsList.getSelectedRec()||o.exceptionsList.store.at(0))&&(o.exceptionsList.selectRecord(t),o.exceptionsList.scrollToRecord(t)),_.delay(function(){o.exceptionsList.focus()},10))}),this.btnResetExceptions=new Common.UI.Button({el:n.find("#auto-correct-btn-exceptions-reset")}),this.btnResetExceptions.on("click",_.bind(this.onResetExceptionsToDefault,this)),this.btnAddExceptions=new Common.UI.Button({el:n.find("#auto-correct-btn-exceptions-edit")}),this.btnAddExceptions.on("click",_.bind(this.onAddException,this,!1)),this.btnDeleteExceptions=new Common.UI.Button({el:n.find("#auto-correct-btn-exceptions-delete")}),this.btnDeleteExceptions.on("click",_.bind(this.onDeleteException,this,!1)),this.chkSentenceExceptions=new Common.UI.CheckBox({el:n.find("#auto-correct-exceptions-chk-sentence"),labelText:this.textFLSentence,value:Common.Utils.InternalSettings.get(this.appPrefix+"settings-letter-exception-sentence")}).on("change",function(t,e,i,n){t="checked"===t.getValue();Common.localStorage.setBool(o.appPrefix+"settings-letter-exception-sentence",t),Common.Utils.InternalSettings.set(o.appPrefix+"settings-letter-exception-sentence",t),o.api.asc_SetAutoCorrectFirstLetterOfSentences&&o.api.asc_SetAutoCorrectFirstLetterOfSentences(t)}),this.chkSentenceCells=new Common.UI.CheckBox({el:n.find("#auto-correct-exceptions-chk-cells"),labelText:this.textFLCells,value:Common.Utils.InternalSettings.get(this.appPrefix+"settings-letter-exception-cells")}).on("change",function(t,e,i,n){t="checked"===t.getValue();Common.localStorage.setBool(o.appPrefix+"settings-letter-exception-cells",t),Common.Utils.InternalSettings.set(o.appPrefix+"settings-letter-exception-cells",t),o.api.asc_SetAutoCorrectFirstLetterOfSentences&&o.api.asc_SetAutoCorrectFirstLetterOfSentences(t)}),this.btnsCategory[3].on("click",_.bind(this.onAutocorrectCategoryClick,this,!1))):"sse-"==this.appPrefix&&(this.chNewRows=new Common.UI.CheckBox({el:n.find("#id-autocorrect-dialog-chk-new-rows"),labelText:this.textNewRowCol,value:Common.Utils.InternalSettings.get(this.appPrefix+"settings-autoformat-new-rows")}).on("change",function(t,e,i,n){t="checked"===t.getValue();Common.localStorage.setBool(o.appPrefix+"settings-autoformat-new-rows",t),Common.Utils.InternalSettings.set(o.appPrefix+"settings-autoformat-new-rows",t),o.api.asc_setIncludeNewRowColTable(t)})),this.chHyperlink=new Common.UI.CheckBox({el:s.find("#id-autocorrect-dialog-chk-hyperlink"),labelText:this.textHyperlink,value:Common.Utils.InternalSettings.get(this.appPrefix+"settings-autoformat-hyperlink")}).on("change",function(t,e,i,n){t="checked"===t.getValue();Common.localStorage.setBool(o.appPrefix+"settings-autoformat-hyperlink",t),Common.Utils.InternalSettings.set(o.appPrefix+"settings-autoformat-hyperlink",t),o.api.asc_SetAutoCorrectHyperlinks(t)}),this.btnsCategory[0].on("click",_.bind(this.onMathCategoryClick,this,!1)),this.btnsCategory[1].on("click",_.bind(this.onRecCategoryClick,this,!1)),this.btnsCategory[2].on("click",_.bind(this.onAutoformatCategoryClick,this,!1)),this.afterRender()},afterRender:function(){var t;this.updateControls(),this.updateRecControls(),this.updateExceptionsControls(),this.storageName&&(t=Common.localStorage.getItem(this.storageName),this.setActiveCategory(null!==t?parseInt(t):0))},getFocusedComponents:function(){var t=[this.chReplaceType,this.inputReplace,this.inputBy,this.mathList,this.btnReset,this.btnEdit,this.btnDelete,this.inputRecFind,this.mathRecList,this.btnResetRec,this.btnAddRec,this.btnDeleteRec];return t=(t=t.concat(this.chNewRows?[this.chHyperlink,this.chNewRows]:[this.chQuotes,this.chHyphens,this.chHyperlink,this.chDoubleSpaces,this.chBulleted,this.chNumbered])).concat(this.chkSentenceExceptions?[this.chkSentenceExceptions,this.chkSentenceCells,this.exceptionsLangCmb,this.exceptionsFindInput,this.exceptionsList,this.btnResetExceptions,this.btnAddExceptions,this.btnDeleteExceptions]:[])},getSettings:function(){},onSelectMathItem:function(t,e,i){i&&(this.inputReplace.setValue(i.get("replaced")),this.inputBy.setValue(i.get("by"))),this.updateControls(i)},updateControls:function(t){var e,i,n,o;this.mathList&&(t=t||this.mathList.getSelectedRec(),e=this.inputBy.getValue(),i=this.inputReplace.getValue(),t?(n=t.get("defaultDisabled"),o=t.get("defaultValue")&&t.get("defaultValueStr")!==t.get("by"),this.btnDelete.setCaption(n?this.textRestore:this.textDelete),this.btnEdit.setDisabled(n||e===t.get("by")&&!o||!e||!i),this.btnEdit.setCaption(o&&e===t.get("by")?this.textReset:this.textReplace)):(this.btnDelete.setCaption(this.textDelete),this.btnEdit.setDisabled(!e||!i),this.btnEdit.setCaption(this.textAdd)),this.btnDelete.setDisabled(!t))},show:function(){Common.Views.AdvancedSettingsWindow.prototype.show.apply(this,arguments);var t=this.getActiveCategory();0==t?this.onMathCategoryClick(!0):1==t?this.onRecCategoryClick(!0):2==t?this.onAutoformatCategoryClick(!0):3==t&&this.onAutocorrectCategoryClick(!0)},close:function(){Common.Views.AdvancedSettingsWindow.prototype.close.apply(this,arguments),this.mathList&&this.mathList.deselectAll(),this.mathRecList&&this.mathRecList.deselectAll()},onMathCategoryClick:function(t){var e=this;_.delay(function(){$("input",e.inputReplace.cmpEl).select().focus()},t?50:0),e.mathList.store.length<r.length&&_.delay(function(){e.mathList.setStore(r),e.mathList.onResetItems()},t?100:10)},onAutoformatCategoryClick:function(t){var e=this;_.delay(function(){("sse-"==e.appPrefix?e.chHyperlink:e.chQuotes).focus()},t?50:0)},onAutocorrectCategoryClick:function(t){var e=this;_.delay(function(){$("input",e.exceptionsFindInput.cmpEl).select().focus()},t?50:0),e.exceptionsList.store.length<l.length&&_.delay(function(){e.exceptionsList.setStore(l),e.exceptionsList.onResetItems()},t?100:10)},onDelete:function(){var t,e,i=this.mathList.getSelectedRec(),n="";i&&(i.get("defaultValue")?(n=this.appPrefix+"settings-math-correct-rem",e=!i.get("defaultDisabled"),i.set("defaultDisabled",e),e?this.arrRem.push(i.get("replaced")):this.arrRem.splice(this.arrRem.indexOf(i.get("replaced")),1),t=JSON.stringify(this.arrRem),Common.Utils.InternalSettings.set(n,t),Common.localStorage.setItem(n,t),this.btnDelete.setCaption(e?this.textRestore:this.textDelete),e?this.api.asc_deleteFromAutoCorrectMathSymbols(i.get("replaced")):this.api.asc_AddOrEditFromAutoCorrectMathSymbols(i.get("replaced"),i.get("defaultValue"))):(r.remove(i),this.arrAdd.splice(this.arrAdd.indexOf(i.get("replaced")),1),n=this.appPrefix+"settings-math-correct-add",t=JSON.stringify(this.arrAdd),Common.Utils.InternalSettings.set(n,t),Common.localStorage.setItem(n,t),this.mathList.scroller&&this.mathList.scroller.update({}),this.api.asc_deleteFromAutoCorrectMathSymbols(i.get("replaced"))),this.updateControls())},onEdit:function(){function i(t,e){var i=l.appPrefix+"settings-math-correct-add",n=JSON.stringify(l.arrAdd);Common.Utils.InternalSettings.set(i,n),Common.localStorage.setItem(i,n),l.api.asc_AddOrEditFromAutoCorrectMathSymbols(t.get("replaced"),e),l.mathList.selectRecord(t),l.mathList.scrollToRecord(t)}var n,o,s=this.mathList.getSelectedRec(),a="",l=this;(s=s||r.findWhere({replaced:this.inputReplace.getValue()}))?(n=_.findIndex(this.arrAdd,function(t){return t[0]==s.get("replaced")}),o=s.get("defaultValue")&&s.get("defaultValueStr")!==s.get("by")&&this.inputBy.getValue()===s.get("by"),Common.UI.warning({maxwidth:500,msg:(o?this.warnRestore:this.warnReplace).replace("%1",s.get("replaced")),buttons:["yes","no"],primary:"yes",callback:_.bind(function(t,e){"yes"==t&&(o?(a=s.get("defaultValue"),s.set("by",s.get("defaultValueStr")),0<=n&&this.arrAdd.splice(n,1)):(a=this.inputBy.getValue(),s.set("by",a),n<0?this.arrAdd.push([s.get("replaced"),a]):this.arrAdd[n][1]=a),i(s,a))},this)})):(s=r.add({replaced:this.inputReplace.getValue(),by:this.inputBy.getValue(),defaultDisabled:!1}),a=s.get("by"),this.arrAdd.push([s.get("replaced"),a]),i(s,a))},onResetToDefault:function(){Common.UI.warning({maxwidth:500,msg:this.warnReset,buttons:["yes","no"],primary:"yes",callback:_.bind(function(t,e){"yes"==t&&(this.api.asc_resetToDefaultAutoCorrectMathSymbols(),this.onResetList())},this)})},onResetList:function(){var t=this.appPrefix+"settings-math-correct",e=JSON.stringify([]);Common.Utils.InternalSettings.set(t+"-add",e),Common.localStorage.setItem(t+"-add",e),Common.Utils.InternalSettings.set(t+"-rem",e),Common.localStorage.setItem(t+"-rem",e),this.arrAdd=[],this.arrRem=[],r.remove(r.where({defaultValue:void 0})),r.each(function(t,e){t.set("by",t.get("defaultValueStr")),t.set("defaultDisabled",!1)}),this.mathList.deselectAll(),this.mathList.scroller&&(this.mathList.scroller.update(),this.mathList.scroller.scrollTop(0)),this.updateControls()},onInitList:function(){var t,n,e,o,s;0<r.length||(r.comparator=function(t,e){t=t.get("replaced").toLowerCase(),e=e.get("replaced").toLowerCase();return t==e?0:t<e?-1:1},t=this.arrAdd,n=this.arrRem,e=this.api?this.api.asc_getAutoCorrectMathSymbols():[],o=[],_.each(e,function(t,e){var i={replaced:t[0],defaultValue:t[1],defaultDisabled:-1<n.indexOf(t[0])};"object"==typeof t[1]?(i.defaultValueStr="",_.each(t[1],function(t){i.defaultValueStr+=Common.Utils.String.encodeSurrogateChar(t)}),i.by=i.defaultValueStr):i.by=i.defaultValueStr=Common.Utils.String.encodeSurrogateChar(t[1]),o.push(i)}),s=[],_.each(t,function(t,e){var i=_.findIndex(o,{replaced:t[0]});i<0?s.push({replaced:t[0],by:t[1],defaultDisabled:!1}):o[i].by=t[1]}),r.reset(o.concat(s)),this.updateControls())},onInitRecList:function(){var t,i,e,n,o;0<a.length||(a.comparator=function(t,e){t=t.get("value").toLowerCase(),e=e.get("value").toLowerCase();return t==e?0:t<e?-1:1},t=this.arrAddRec,i=this.arrRemRec,e=this.api?this.api.asc_getAutoCorrectMathFunctions():[],n=[],_.each(e,function(t,e){n.push({value:t,defaultValue:!0,defaultDisabled:-1<i.indexOf(t)})}),o=[],_.each(t,function(t,e){_.findIndex(n,{value:t})<0&&o.push({value:t,defaultValue:!1,defaultDisabled:!1})}),a.reset(n.concat(o)),this.updateRecControls())},onResetRecToDefault:function(){Common.UI.warning({maxwidth:500,msg:this.textWarnResetRec,buttons:["yes","no"],primary:"yes",callback:_.bind(function(t,e){"yes"==t&&(this.api.asc_resetToDefaultAutoCorrectMathFunctions(),this.onResetRecList())},this)})},onResetRecList:function(){var t=this.appPrefix+"settings-rec-functions",e=JSON.stringify([]);Common.Utils.InternalSettings.set(t+"-add",e),Common.localStorage.setItem(t+"-add",e),Common.Utils.InternalSettings.set(t+"-rem",e),Common.localStorage.setItem(t+"-rem",e),this.arrAddRec=[],this.arrRemRec=[],a.remove(a.where({defaultValue:!1})),a.each(function(t,e){t.set("defaultDisabled",!1)}),this.mathRecList.deselectAll(),this.mathRecList.scroller&&(this.mathRecList.scroller.update(),this.mathRecList.scroller.scrollTop(0)),this.updateRecControls()},onRecCategoryClick:function(t){var e=this;_.delay(function(){$("input",e.inputRecFind.cmpEl).select().focus()},t?50:0),e.mathRecList.store.length<a.length&&_.delay(function(){e.mathRecList.setStore(a),e.mathRecList.onResetItems()},t?100:10)},onDeleteRec:function(){var t,e,i,n=this.mathRecList.getSelectedRec();n&&(n.get("defaultValue")?(e=this.appPrefix+"settings-rec-functions-rem",i=!n.get("defaultDisabled"),n.set("defaultDisabled",i),i?this.arrRemRec.push(n.get("value")):this.arrRemRec.splice(this.arrRemRec.indexOf(n.get("value")),1),t=JSON.stringify(this.arrRemRec),Common.Utils.InternalSettings.set(e,t),Common.localStorage.setItem(e,t),this.btnDeleteRec.setCaption(i?this.textRestore:this.textDelete),i?this.api.asc_deleteFromAutoCorrectMathFunctions(n.get("value")):this.api.asc_AddFromAutoCorrectMathFunctions(n.get("value"))):(a.remove(n),this.arrAddRec.splice(this.arrAddRec.indexOf(n.get("value")),1),e=this.appPrefix+"settings-rec-functions-add",t=JSON.stringify(this.arrAddRec),Common.Utils.InternalSettings.set(e,t),Common.localStorage.setItem(e,t),this.mathRecList.scroller&&this.mathRecList.scroller.update({}),this.api.asc_deleteFromAutoCorrectMathFunctions(n.get("value"))),this.updateRecControls())},onAddRec:function(){var t,e,i=this.mathRecList.getSelectedRec(),n=this;(i=i||a.findWhere({value:this.inputRecFind.getValue()}))?(n.mathRecList.selectRecord(i),n.mathRecList.scrollToRecord(i)):/^[A-Z]+$/i.test(this.inputRecFind.getValue())?(i=a.add({value:this.inputRecFind.getValue(),defaultValue:!1,defaultDisabled:!1}),this.arrAddRec.push(i.get("value")),i=i,t=n.appPrefix+"settings-rec-functions-add",e=JSON.stringify(n.arrAddRec),Common.Utils.InternalSettings.set(t,e),Common.localStorage.setItem(t,e),n.api.asc_AddFromAutoCorrectMathFunctions(i.get("value")),n.mathRecList.selectRecord(i),n.mathRecList.scrollToRecord(i)):Common.UI.warning({maxwidth:500,msg:this.textWarnAddRec})},onSelectRecItem:function(t,e,i){i&&this.inputRecFind.setValue(i.get("value")),this.updateRecControls(i)},updateRecControls:function(t){var e;this.mathRecList&&(t=t||this.mathRecList.getSelectedRec(),e=this.inputRecFind.getValue(),this.btnDeleteRec.setCaption(t&&t.get("defaultDisabled")?this.textRestore:this.textDelete),this.btnDeleteRec.setDisabled(!t),this.btnAddRec.setDisabled(!!t||!e))},onInitExceptionsList:function(t){var e,i,n,o;0<l.length&&!t||(l.comparator=function(t,e){t=t.get("value").toLowerCase(),e=e.get("value").toLowerCase();return t==e?0:t<e?-1:1},t=this.exceptionsLangCmb.getValue(),e=this.arrAddExceptions[t]||[],i=this.arrRemExceptions[t]||[],t=this.api?this.api.asc_GetAutoCorrectSettings().get_FirstLetterExceptionManager().get_DefaultExceptions(t):[],n=[],_.each(t,function(t,e){n.push({value:t,defaultValue:!0,defaultDisabled:-1<i.indexOf(t)})}),o=[],_.each(e,function(t,e){_.findIndex(n,{value:t})<0&&o.push({value:t,defaultValue:!1,defaultDisabled:!1})}),l.reset(n.concat(o)),this.updateExceptionsControls())},onResetExceptionsToDefault:function(){var i=this.api.asc_GetAutoCorrectSettings().get_FirstLetterExceptionManager(),n=this.exceptionsLangCmb.getValue();Common.UI.warning({maxwidth:500,msg:this.textWarnResetFL,buttons:["yes","no"],primary:"yes",callback:_.bind(function(t,e){"yes"==t&&(i.put_Exceptions(i.get_DefaultExceptions(n),n),this.onResetExceptionsList())},this)})},onResetExceptionsList:function(){var t=this.appPrefix+"settings-letter-exception",e=this.exceptionsLangCmb.getValue(),i=JSON.stringify([]);Common.Utils.InternalSettings.set(t+"-add-"+e,i),Common.localStorage.setItem(t+"-add-"+e,i),Common.Utils.InternalSettings.set(t+"-rem-"+e,i),Common.localStorage.setItem(t+"-rem-"+e,i),this.arrAddExceptions[e]=[],this.arrRemExceptions[e]=[],l.remove(l.where({defaultValue:!1})),l.each(function(t,e){t.set("defaultDisabled",!1)}),this.exceptionsList.deselectAll(),this.exceptionsList.scroller&&(this.exceptionsList.scroller.update(),this.exceptionsList.scroller.scrollTop(0)),this.updateExceptionsControls()},onDeleteException:function(){var t,e,i,n=this.exceptionsList.getSelectedRec(),o=this.api.asc_GetAutoCorrectSettings().get_FirstLetterExceptionManager(),s=this.exceptionsLangCmb.getValue();n&&(i="",n.get("defaultValue")?(e=!n.get("defaultDisabled"),i=this.appPrefix+"settings-letter-exception-rem-"+s,n.set("defaultDisabled",e),e?this.arrRemExceptions[s].push(n.get("value")):this.arrRemExceptions[s].splice(this.arrRemExceptions[s].indexOf(n.get("value")),1),t=JSON.stringify(this.arrRemExceptions[s]),Common.Utils.InternalSettings.set(i,t),Common.localStorage.setItem(i,t),this.btnDeleteExceptions.setCaption(e?this.textRestore:this.textDelete),e?o.remove_Exception(n.get("value"),s):o.add_Exception(n.get("value"),s)):(l.remove(n),this.arrAddExceptions[s].splice(this.arrAddExceptions[s].indexOf(n.get("value")),1),i=this.appPrefix+"settings-letter-exception-add-"+s,t=JSON.stringify(this.arrAddExceptions[s]),Common.Utils.InternalSettings.set(i,t),Common.localStorage.setItem(i,t),this.exceptionsList.scroller&&this.exceptionsList.scroller.update({}),o.remove_Exception(n.get("value"),s)),this.updateExceptionsControls())},onAddException:function(){var t,e=this.exceptionsList.getSelectedRec(),i=this.exceptionsLangCmb.getValue(),n=this,o=this.exceptionsFindInput.getValue().trim();(e=e||l.findWhere({value:o}))?(n.exceptionsList.selectRecord(e),n.exceptionsList.scrollToRecord(e)):("."===o[o.length-1]&&(o=o.slice(0,-1)),/^[^\%/\\&\?\,\.\s\d\'\;:!-+!@#\$\^*)(]{1,20}$/.test(o)?(e=l.add({value:o,defaultValue:!1,defaultDisabled:!1}),this.arrAddExceptions[i].push(e.get("value")),o=e,e=n.appPrefix+"settings-letter-exception-add-"+i,t=JSON.stringify(n.arrAddExceptions[i]),Common.Utils.InternalSettings.set(e,t),Common.localStorage.setItem(e,t),n.api.asc_GetAutoCorrectSettings().get_FirstLetterExceptionManager().add_Exception(o.get("value"),i),n.exceptionsList.selectRecord(o),n.exceptionsList.scrollToRecord(o)):Common.UI.warning({maxwidth:500,msg:this.textWarnAddFL}))},onSelectExceptionItem:function(t,e,i){i&&this.exceptionsFindInput.setValue(i.get("value")),this.updateExceptionsControls(i)},onChangeInputException:function(t,e){var i;(e=e.trim()).length&&("."===e[e.length-1]&&(e=e.slice(0,-1)),(i=this.exceptionsList.store.find(function(t){if(0==t.get("value").indexOf(e))return!0}))&&(this.exceptionsList.scrollToRecord(i,!0),i.get("value")==e?this.exceptionsList.selectRecord(i,!0):i=null)),i||this.exceptionsList.deselectAll(),this.updateExceptionsControls(i)},updateExceptionsControls:function(t){var e;this.exceptionsList&&(t=t||this.exceptionsList.getSelectedRec(),e=this.exceptionsFindInput.getValue(),this.btnDeleteExceptions.setCaption(t&&t.get("defaultDisabled")?this.textRestore:this.textDelete),this.btnDeleteExceptions.setDisabled(!t),this.btnAddExceptions.setDisabled(!!t||!e))}},Common.Views.AutoCorrectDialog||{}))}),define("documenteditor/main/app/view/FileMenuPanels",["common/main/lib/view/DocumentAccessDialog","common/main/lib/view/AutoCorrectDialog"],function(){"use strict";DE.Views.FileMenuPanels||(DE.Views.FileMenuPanels={}),DE.Views.FileMenuPanels.ViewSaveAs=Common.UI.BaseView.extend({el:"#panel-saveas",menu:void 0,formats:[[{name:"DOCX",imgCls:"docx",type:Asc.c_oAscFileType.DOCX},{name:"PDF",imgCls:"pdf",type:Asc.c_oAscFileType.PDF}],[{name:"DOTX",imgCls:"dotx",type:Asc.c_oAscFileType.DOTX}],[{name:"RTF",imgCls:"rtf",type:Asc.c_oAscFileType.RTF},{name:"TXT",imgCls:"txt",type:Asc.c_oAscFileType.TXT},{name:"EPUB",imgCls:"epub",type:Asc.c_oAscFileType.EPUB},{name:"HTML (Zipped)",imgCls:"html",type:Asc.c_oAscFileType.HTML}],[]],template:_.template(['<div class="content-container">','<div class="header"><%= header %></div>','<div class="format-items">',"<% _.each(rows, function(row) { %>","<% _.each(row, function(item) { %>",'<% if (item.type!==Asc.c_oAscFileType.DOCM || fileType=="docm") { %>','<div class="format-item float-left"><div class="btn-doc-format" format="<%= item.type %>" data-hint="2" data-hint-direction="left-top" data-hint-offset="4, 4">','<div class ="svg-format-<%= item.imgCls %>"></div>',"</div></div>","<% } %>","<% }) %>",'<div class="divider"></div>',"<% }) %>","</div>","</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.menu=t.menu,this.fileType=t.fileType,this.mode=t.mode,Common.NotificationCenter.on({"window:resize":_.bind(function(){var t=Common.Utils.innerWidth()>=this.maxWidth;this.isDivided!==t&&(this.$el.find(".divider").css("width",t?"100%":"0"),this.isDivided=t)},this)})},render:function(){/^pdf$/.test(this.fileType)?(this.formats[0].splice(1,1,{name:"PDF",imgCls:"pdf",type:""}),this.formats[1].splice(2,1)):/^xps|oxps$/.test(this.fileType)?this.formats[0].push({name:this.fileType.toUpperCase(),imgCls:this.fileType,type:""}):/^djvu$/.test(this.fileType)&&(this.formats=[[{name:"DJVU",imgCls:"djvu",type:""},{name:"PDF",imgCls:"pdf",type:Asc.c_oAscFileType.PDF}]]),this.mode&&!this.mode.canFeatureForms&&2<this.formats.length&&this.formats[0].splice(3,2),this.$el.html(this.template({rows:this.formats,fileType:(this.fileType||"docx").toLowerCase(),header:Common.Locale.get("btnDownloadCaption",{name:"DE.Views.FileMenu",default:this.textDownloadAs})})),$(".btn-doc-format",this.el).on("click",_.bind(this.onFormatClick,this)),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:this.$el,suppressScrollX:!0,alwaysVisibleY:!0}));var i=0;return this.formats.forEach(_.bind(function(t,e){t=t.length;i<t&&(i=t)},this)),this.maxWidth=$("#file-menu-panel .panel-menu").outerWidth()+20+10+94*i,Common.Utils.innerWidth()>=this.maxWidth&&(this.$el.find(".divider").css("width","100%"),this.isDivided=!0),this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this.scroller&&this.scroller.update()},onFormatClick:function(t){t=t.currentTarget.attributes.format;!_.isUndefined(t)&&this.menu&&this.menu.fireEvent("saveas:format",[this.menu,t.value?parseInt(t.value):void 0])},textDownloadAs:"Download as"}),DE.Views.FileMenuPanels.ViewSaveCopy=Common.UI.BaseView.extend({el:"#panel-savecopy",menu:void 0,formats:[[{name:"DOCX",imgCls:"docx",type:Asc.c_oAscFileType.DOCX,ext:".docx"},{name:"PDF",imgCls:"pdf",type:Asc.c_oAscFileType.PDF,ext:".pdf"},{name:"ODT",imgCls:"odt",type:Asc.c_oAscFileType.ODT,ext:".odt"},{name:"DOCXF",imgCls:"docxf",type:Asc.c_oAscFileType.DOCXF,ext:".docxf"},{name:"OFORM",imgCls:"oform",type:Asc.c_oAscFileType.OFORM,ext:".oform"}],[{name:"DOTX",imgCls:"dotx",type:Asc.c_oAscFileType.DOTX,ext:".dotx"},{name:"DOCM",imgCls:"docm",type:Asc.c_oAscFileType.DOCM,ext:".docm"},{name:"PDFA",imgCls:"pdfa",type:Asc.c_oAscFileType.PDFA,ext:".pdf"},{name:"OTT",imgCls:"ott",type:Asc.c_oAscFileType.OTT,ext:".ott"}],[{name:"RTF",imgCls:"rtf",type:Asc.c_oAscFileType.RTF,ext:".rtf"},{name:"TXT",imgCls:"txt",type:Asc.c_oAscFileType.TXT,ext:".txt"},{name:"FB2",imgCls:"fb2",type:Asc.c_oAscFileType.FB2,ext:".fb2"},{name:"EPUB",imgCls:"epub",type:Asc.c_oAscFileType.EPUB,ext:".epub"},{name:"HTML (Zipped)",imgCls:"html",type:Asc.c_oAscFileType.HTML,ext:".html"}],[{name:"JPG",imgCls:"jpg",type:Asc.c_oAscFileType.JPG,ext:".zip"},{name:"PNG",imgCls:"png",type:Asc.c_oAscFileType.PNG,ext:".zip"}]],template:_.template(['<div class="content-container">','<div class="header"><%= header %></div>','<div class="format-items">',"<% _.each(rows, function(row) { %>","<% _.each(row, function(item) { %>",'<% if (item.type!==Asc.c_oAscFileType.DOCM || fileType=="docm") { %>','<div class="format-item float-left"><div class="btn-doc-format" format="<%= item.type %>" format-ext="<%= item.ext %>" data-hint="2" data-hint-direction="left-top" data-hint-offset="4, 4">','<div class ="svg-format-<%= item.imgCls %>"></div>',"</div></div>","<% } %>","<% }) %>",'<div class="divider"></div>',"<% }) %>","</div>","</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.menu=t.menu,this.fileType=t.fileType,this.mode=t.mode,Common.NotificationCenter.on({"window:resize":_.bind(function(){var t=Common.Utils.innerWidth()>=this.maxWidth;this.isDivided!==t&&(this.$el.find(".divider").css("width",t?"100%":"0"),this.isDivided=t)},this)})},render:function(){/^pdf$/.test(this.fileType)?(this.formats[0].splice(1,1,{name:"PDF",imgCls:"pdf",type:"",ext:!0}),this.formats[1].splice(2,1)):/^xps|oxps$/.test(this.fileType)?this.formats[0].push({name:this.fileType.toUpperCase(),imgCls:this.fileType,type:"",ext:!0}):/^djvu$/.test(this.fileType)&&(this.formats=[[{name:"DJVU",imgCls:"djvu",type:"",ext:!0},{name:"PDF",imgCls:"pdf",type:Asc.c_oAscFileType.PDF,ext:".pdf"}]]),this.mode&&!this.mode.canFeatureForms&&2<this.formats.length&&this.formats[0].splice(3,2),this.$el.html(this.template({rows:this.formats,fileType:(this.fileType||"docx").toLowerCase(),header:Common.Locale.get("btnSaveCopyAsCaption",{name:"DE.Views.FileMenu",default:this.textSaveCopyAs})})),$(".btn-doc-format",this.el).on("click",_.bind(this.onFormatClick,this)),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:this.$el,suppressScrollX:!0,alwaysVisibleY:!0}));var i=0;return this.formats.forEach(_.bind(function(t,e){t=t.length;i<t&&(i=t)},this)),this.maxWidth=$("#file-menu-panel .panel-menu").outerWidth()+20+10+94*i,Common.Utils.innerWidth()>=this.maxWidth&&(this.$el.find(".divider").css("width","100%"),this.isDivided=!0),this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this.scroller&&this.scroller.update()},onFormatClick:function(t){var e=t.currentTarget.attributes.format,t=t.currentTarget.attributes["format-ext"];_.isUndefined(e)||_.isUndefined(t)||!this.menu||this.menu.fireEvent("saveas:format",[this.menu,e.value?parseInt(e.value):void 0,t.value])},textSaveCopyAs:"Save Copy as"}),DE.Views.FileMenuPanels.Settings=Common.UI.BaseView.extend(_.extend({el:"#panel-settings",menu:void 0,template:_.template(['<div class="flex-settings">','<div class="header"><%= scope.txtAdvancedSettings %></div>',"<table><tbody>",'<tr class="editsave">','<td colspan="2" class="group-name top"><label><%= scope.txtEditingSaving %></label></td>',"</tr>",'<tr class="autosave">','<td colspan="2"><span id="fms-chb-autosave"></span></td>',"</tr>",'<tr class="forcesave">','<td colspan="2"><span id="fms-chb-forcesave"></span></td>',"</tr>",'<tr class="edit">','<td colspan="2"><div id="fms-chb-paste-settings"></div></td>',"</tr>",'<tr class="edit">','<td colspan="2"><div id="fms-chb-smart-selection"></div></td>',"</tr>",'<tr class="edit">','<td colspan="2"><span id="fms-chb-compatible"></span></td>',"</tr>",'<tr class="coauth changes-mode">','<td colspan="2" class="subgroup-name"><label><%= scope.strCoAuthMode %></label></td>',"</tr>",'<tr class="coauth changes-mode">','<td colspan="2"><div style="display: flex;"><div id="fms-rb-coauth-mode-fast"></div>','<span style ="display: flex; flex-direction: column;"><label><%= scope.strFast %></label>','<label class="comment-text"><%= scope.txtFastTip %></label></span></div>',"</td>","</tr>",'<tr class="coauth changes-mode">','<td colspan="2"><div style="display: flex;"><div id="fms-rb-coauth-mode-strict"></div>','<span style ="display: flex; flex-direction: column;"><label><%= scope.strStrict %></label>','<label class="comment-text"><%= scope.txtStrictTip %></label></span>',"</div></td>","</tr>",'<tr class ="divider-subgroup coauth changes-mode"></tr>','<tr class ="divider-subgroup  view-review"></tr>','<tr class="coauth changes-show">','<td colspan="2" class="subgroup-name"><label><%= scope.strShowChanges %></label></td>',"</tr>",'<tr class="coauth changes-show">','<td colspan="2"><div id="fms-rb-show-changes-none"></div></td>',"</tr>",'<tr class="coauth changes-show">','<td colspan="2"><div id="fms-rb-show-changes-all"></div></td>',"</tr>",'<tr class="coauth changes-show">','<td colspan="2"><div id="fms-rb-show-changes-last"></div></td>',"</tr>",'<tr class="divider coauth changes-show"></tr>','<tr class="live-viewer">','<td colspan="2"><div id="fms-chb-live-viewer"></div></td>',"</tr>",'<tr class="divider live-viewer"></tr>','<tr class="comments">','<td colspan="2"><div id="fms-chb-live-comment"></div></td>',"</tr>",'<tr class="comments">','<td colspan="2"><div id="fms-chb-resolved-comment"></div></td>',"</tr>",'<tr class ="collaboration divider-group"></tr>','<tr class ="edit">','<td colspan="2" class="group-name proofing"><label><%= scope.txtProofing %></label></td>',"</tr>",'<tr class="edit spellcheck">','<td colspan="2"><div id="fms-chb-spell-check"></div></td>',"</tr>",'<tr class="edit spellcheck">','<td colspan="2"><span id="fms-chb-ignore-uppercase-words"></span></td>',"</tr>",'<tr class="edit spellcheck">','<td colspan="2"><span id="fms-chb-ignore-numbers-words"></span></td>',"</tr>",'<tr class="edit">','<td colspan="2"><button type="button" class="btn btn-text-default" id="fms-btn-auto-correct" style="width:auto; display: inline-block;padding-right: 10px;padding-left: 10px;" data-hint="2" data-hint-direction="bottom" data-hint-offset="medium"><%= scope.txtAutoCorrect %></button></div></td>',"</tr>",'<tr class ="edit divider-group"></tr>',"<tr>",'<td colspan="2" class="group-name"><label><%= scope.txtWorkspace %></label></td>',"</tr>",'<tr class="edit">','<td colspan="2"><span id="fms-chb-align-guides"></span></td>',"</tr>","<tr>",'<td colspan="2"><div id="fms-chb-use-alt-key"></div></td>',"</tr>",'<tr class="ui-rtl">','<td colspan="2"><div id="fms-chb-rtl-ui"></div></td>',"</tr>",'<tr class="quick-print">','<td colspan="2"><div style="display: flex;"><div id="fms-chb-quick-print"></div>','<span style ="display: flex; flex-direction: column;"><label><%= scope.txtQuickPrint %></label>','<label class="comment-text"><%= scope.txtQuickPrintTip %></label></span></div>',"</td>","</tr>",'<tr class="themes">',"<td><label><%= scope.strTheme %></label></td>","<td>",'<div><div id="fms-cmb-theme"></div>','<div id="fms-chb-dark-mode"></div></div></td>',"</tr>",'<tr class="edit">',"<td><label><%= scope.strUnit %></label></td>",'<td><span id="fms-cmb-unit"></span></td>',"</tr>","<tr>","<td><label><%= scope.strZoom %></label></td>",'<td><div id="fms-cmb-zoom" class="input-group-nr"></div></td>',"</tr>","<tr>","<td><label><%= scope.strFontRender %></label></td>",'<td><span id="fms-cmb-font-render"></span></td>',"</tr>",'<tr class="macros">',"<td><label><%= scope.strMacrosSettings %></label></td>","<td>",'<div><div id="fms-cmb-macros"></div>',"</tr>",'<tr class ="divider-group"></tr>','<tr class="fms-btn-apply">','<td style="padding-top:15px; padding-bottom: 15px;"><button class="btn normal dlg-btn primary" data-hint="2" data-hint-direction="bottom" data-hint-offset="medium"><%= scope.okButtonText %></button></td>',"<td></td>","</tr>","</tbody></table>","</div>",'<div class="fms-flex-apply hidden">','<table style="margin: 10px 20px;"><tbody>',"<tr>",'<td><button class="btn normal dlg-btn primary" data-hint="2" data-hint-direction="bottom" data-hint-offset="big"><%= scope.okButtonText %></button></td>',"<td></td>","</tr>","</tbody></table>","</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.menu=t.menu},render:function(t){var o=this,e=$(this.template({scope:this})),i=(this.chUseAltKey=new Common.UI.CheckBox({el:e.findById("#fms-chb-use-alt-key"),labelText:Common.Utils.isMac?this.txtUseOptionKey:this.txtUseAltKey,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),(Common.Utils.isIE||Common.Utils.isMac&&Common.Utils.isGecko)&&this.chUseAltKey.$el.parent().parent().hide(),this.chLiveComment=new Common.UI.CheckBox({el:e.findById("#fms-chb-live-comment"),labelText:this.strShowComments,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}).on("change",function(t,e,i,n){o.chResolvedComment.setDisabled("checked"!==t.getValue())}),this.chResolvedComment=new Common.UI.CheckBox({el:e.findById("#fms-chb-resolved-comment"),labelText:this.strShowResolvedComments,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.chSpell=new Common.UI.CheckBox({el:e.findById("#fms-chb-spell-check"),labelText:this.txtSpellCheck,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}).on("change",function(t,e,i,n){o.chIgnoreUppercase.setDisabled("checked"!==t.getValue()),o.chIgnoreNumbers.setDisabled("checked"!==t.getValue())}),this.chIgnoreUppercase=new Common.UI.CheckBox({el:e.findById("#fms-chb-ignore-uppercase-words"),labelText:this.strIgnoreWordsInUPPERCASE,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.chIgnoreNumbers=new Common.UI.CheckBox({el:e.findById("#fms-chb-ignore-numbers-words"),labelText:this.strIgnoreWordsWithNumbers,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.chCompatible=new Common.UI.CheckBox({el:e.findById("#fms-chb-compatible"),labelText:this.textOldVersions,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.chSmartSelection=new Common.UI.CheckBox({el:e.findById("#fms-chb-smart-selection"),labelText:this.textSmartSelection,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.chAutosave=new Common.UI.CheckBox({el:e.findById("#fms-chb-autosave"),labelText:this.textAutoSave,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}).on("change",function(t,e,i,n){"checked"!==t.getValue()&&o.rbCoAuthModeFast.getValue()&&(o.rbCoAuthModeStrict.setValue(!0),o.onChangeCoAuthMode(o.rbCoAuthModeFast.getValue()?1:0))}),this.chForcesave=new Common.UI.CheckBox({el:e.findById("#fms-chb-forcesave"),labelText:this.textForceSave,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.chAlignGuides=new Common.UI.CheckBox({el:e.findById("#fms-chb-align-guides"),labelText:this.textAlignGuides,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.cmbZoom=new Common.UI.ComboBox({el:e.findById("#fms-cmb-zoom"),style:"width: 160px;",editable:!1,menuCls:"menu-aligned",cls:"input-group-nr",menuStyle:"min-width:100%; max-height: 157px;",data:[{value:-3,displayValue:this.txtLastUsed},{value:-1,displayValue:this.txtFitPage},{value:-2,displayValue:this.txtFitWidth},{value:50,displayValue:"50%"},{value:60,displayValue:"60%"},{value:70,displayValue:"70%"},{value:80,displayValue:"80%"},{value:90,displayValue:"90%"},{value:100,displayValue:"100%"},{value:110,displayValue:"110%"},{value:120,displayValue:"120%"},{value:150,displayValue:"150%"},{value:175,displayValue:"175%"},{value:200,displayValue:"200%"},{value:300,displayValue:"300%"},{value:400,displayValue:"400%"},{value:500,displayValue:"500%"}],dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.rbCoAuthModeFast=new Common.UI.RadioBox({el:e.findById("#fms-rb-coauth-mode-fast"),name:"coauth-mode",dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.rbCoAuthModeFast.on("change",function(){o.chAutosave.setValue(1),o.onChangeCoAuthMode(1)}),this.rbCoAuthModeFast.$el.parent().on("click",function(){o.rbCoAuthModeFast.setValue(!0)}),this.rbCoAuthModeStrict=new Common.UI.RadioBox({el:e.findById("#fms-rb-coauth-mode-strict"),name:"coauth-mode",dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.rbCoAuthModeStrict.on("change",_.bind(this.onChangeCoAuthMode,this,0)),this.rbCoAuthModeStrict.$el.parent().on("click",function(){o.rbCoAuthModeStrict.setValue(!0)}),this.rbChangesBallons=new Common.UI.RadioBox({el:e.findById("#fms-rb-show-track-ballons"),name:"show-track-changes",labelText:this.txtChangesBalloons,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.rbChangesTip=new Common.UI.RadioBox({el:e.findById("#fms-rb-show-track-tooltips"),name:"show-track-changes",labelText:this.txtChangesTip,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.rbShowChangesNone=new Common.UI.RadioBox({el:e.findById("#fms-rb-show-changes-none"),name:"show-changes",labelText:this.txtNone,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.rbShowChangesAll=new Common.UI.RadioBox({el:e.findById("#fms-rb-show-changes-all"),name:"show-changes",labelText:this.txtAll,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.rbShowChangesLast=new Common.UI.RadioBox({el:e.findById("#fms-rb-show-changes-last"),name:"show-changes",labelText:this.txtLast,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.chLiveViewer=new Common.UI.CheckBox({el:e.findById("#fms-chb-live-viewer"),labelText:this.strShowOthersChanges,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),_.template(["<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%= item.value %>" <% if (item.value === "custom") { %> class="border-top" style="margin-top: 5px;padding-top: 5px;" <% } %> ><a tabindex="-1" type="menuitem" <% if (typeof(item.checked) !== "undefined" && item.checked) { %> class="checked" <% } %> ><%= scope.getDisplayValue(item) %></a></li>',"<% }); %>"].join("")));return this.cmbFontRender=new Common.UI.ComboBox({el:e.find("#fms-cmb-font-render"),style:"width: 160px;",editable:!1,menuCls:"menu-aligned",menuStyle:"min-width:100%;",cls:"input-group-nr",itemsTemplate:i,data:[{value:0,displayValue:this.txtWin},{value:1,displayValue:this.txtMac},{value:2,displayValue:this.txtNative},{value:"custom",displayValue:this.txtCacheMode}],dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbFontRender.on("selected",_.bind(this.onFontRenderSelected,this)),this.cmbUnit=new Common.UI.ComboBox({el:e.findById("#fms-cmb-unit"),style:"width: 160px;",menuCls:"menu-aligned",menuStyle:"min-width:100%;",editable:!1,cls:"input-group-nr",data:[{value:Common.Utils.Metric.c_MetricUnits.cm,displayValue:this.txtCm},{value:Common.Utils.Metric.c_MetricUnits.pt,displayValue:this.txtPt},{value:Common.Utils.Metric.c_MetricUnits.inch,displayValue:this.txtInch}],dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbMacros=new Common.UI.ComboBox({el:e.findById("#fms-cmb-macros"),style:"width: 160px;",editable:!1,menuCls:"menu-aligned",menuStyle:"min-width:100%;",cls:"input-group-nr",data:[{value:2,displayValue:this.txtStopMacros,descValue:this.txtStopMacrosDesc},{value:0,displayValue:this.txtWarnMacros,descValue:this.txtWarnMacrosDesc},{value:1,displayValue:this.txtRunMacros,descValue:this.txtRunMacrosDesc}],itemsTemplate:_.template(["<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%- item.value %>"><a tabindex="-1" type="menuitem" style ="display: flex; flex-direction: column;">','<label class="font-weight-bold"><%= scope.getDisplayValue(item) %></label><label><%= item.descValue %></label></a></li>',"<% }); %>"].join("")),dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.chPaste=new Common.UI.CheckBox({el:e.findById("#fms-chb-paste-settings"),labelText:this.strPasteButton,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.btnAutoCorrect=new Common.UI.Button({el:e.findById("#fms-btn-auto-correct")}),this.btnAutoCorrect.on("click",_.bind(this.autoCorrect,this)),this.cmbTheme=new Common.UI.ComboBox({el:e.findById("#fms-cmb-theme"),style:"width: 160px;",menuStyle:"min-width:100%;",editable:!1,menuCls:"menu-aligned",cls:"input-group-nr",dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}).on("selected",function(t,e){o.chDarkMode.setDisabled(!Common.UI.Themes.isDarkTheme(e.value))}),this.chDarkMode=new Common.UI.CheckBox({el:e.findById("#fms-chb-dark-mode"),labelText:this.txtDarkMode,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),e.find(".btn.primary").each(function(t,e){new Common.UI.Button({el:$(e)}).on("click",_.bind(o.applySettings,o))}),this.chRTL=new Common.UI.CheckBox({el:e.findById("#fms-chb-rtl-ui"),labelText:this.strRTLSupport,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.chQuickPrint=new Common.UI.CheckBox({el:e.findById("#fms-chb-quick-print"),labelText:"",dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.chQuickPrint.$el.parent().on("click",function(){o.chQuickPrint.setValue(!o.chQuickPrint.isChecked())}),this.pnlSettings=e.find(".flex-settings").addBack().filter(".flex-settings"),this.pnlApply=e.find(".fms-flex-apply").addBack().filter(".fms-flex-apply"),this.pnlTable=this.pnlSettings.find("table"),this.trApply=e.find(".fms-btn-apply"),this.$el=$(t).html(e),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:this.pnlSettings,suppressScrollX:!0,alwaysVisibleY:!0})),Common.NotificationCenter.on({"window:resize":function(){o.isVisible()&&o.updateScroller()}}),this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this.updateSettings(),this.updateScroller()},updateScroller:function(){var t;this.scroller&&(Common.UI.Menu.Manager.hideAll(),t=this.$el.height()<this.pnlTable.parent().height()+25+this.pnlApply.height(),this.pnlApply.toggleClass("hidden",!t),this.trApply.toggleClass("hidden",t),this.pnlSettings.css("overflow",t?"hidden":"visible"),this.scroller.update(),this.pnlSettings.toggleClass("bordered",this.scroller.isVisible()))},setMode:function(t){this.mode=t;var e=Common.Utils.InternalSettings.get("de-settings-coauthmode");$("tr.edit",this.el)[t.isEdit?"show":"hide"](),$("tr.autosave",this.el)[!t.isEdit||!t.canChangeCoAuthoring&&e?"hide":"show"](),$("tr.forcesave",this.el)[t.canForcesave?"show":"hide"](),$("tr.editsave",this.el)[t.isEdit||t.canForcesave?"show":"hide"](),this.mode.isDesktopApp&&this.mode.isOffline&&this.chAutosave.setCaption(this.textAutoRecover),$("tr.collaboration",this.el)[t.canCoAuthoring||t.canViewReview?"show":"hide"](),$("tr.coauth",this.el)[t.isEdit&&t.canCoAuthoring?"show":"hide"](),$("tr.coauth.changes-mode",this.el)[t.isEdit&&!t.isOffline&&t.canCoAuthoring&&t.canChangeCoAuthoring?"show":"hide"](),$("tr.coauth.changes-show",this.el)[t.isEdit&&!t.isOffline&&t.canCoAuthoring?"show":"hide"](),$("tr.live-viewer",this.el)[t.canLiveView&&!t.isOffline&&t.canChangeCoAuthoring?"show":"hide"](),$("tr.view-review",this.el)[t.canViewReview?"show":"hide"](),$("tr.spellcheck",this.el)[t.isEdit&&Common.UI.FeaturesManager.canChange("spellcheck")?"show":"hide"](),$("tr.comments",this.el)[t.canCoAuthoring?"show":"hide"](),$("tr.ui-rtl",this.el)[t.uiRtl?"show":"hide"](),$("tr.quick-print",this.el)[!t.canQuickPrint||t.customization&&t.customization.compactHeader&&t.isEdit?"hide":"show"](),$("tr.macros",this.el)[t.customization&&!1===t.customization.macros?"hide":"show"](),Common.UI.Themes.available()||$("tr.themes, tr.themes + tr.divider",this.el).hide()},setApi:function(t){return this.api=t,this},updateSettings:function(){this.chUseAltKey.setValue(Common.Utils.InternalSettings.get("de-settings-show-alt-hints"));var t,e=null!==(e=Common.Utils.InternalSettings.get("de-settings-zoom"))?parseInt(e):this.mode.customization&&this.mode.customization.zoom?parseInt(this.mode.customization.zoom):100,i=this.cmbZoom.store.findWhere({value:e}),n=(this.cmbZoom.setValue(i?parseInt(i.get("value")):0<e?e+"%":100),this.chLiveComment.setValue(Common.Utils.InternalSettings.get("de-settings-livecomment")),this.chResolvedComment.setValue(Common.Utils.InternalSettings.get("de-settings-resolvedcomment")),Common.Utils.InternalSettings.get("de-settings-coauthmode")),o=(this.rbCoAuthModeFast.setValue(n),this.rbCoAuthModeStrict.setValue(!n),this.fillShowChanges(n),this.chLiveViewer.setValue(Common.Utils.InternalSettings.get("de-settings-coauthmode")),e=Common.Utils.InternalSettings.get(n?"de-settings-showchanges-fast":"de-settings-showchanges-strict"),this.rbShowChangesNone.setValue("none"==e),this.rbShowChangesLast.setValue("last"==e),this.rbShowChangesAll.setValue("all"==e),e=Common.Utils.InternalSettings.get("de-settings-fontrender"),i=this.cmbFontRender.store.findWhere({value:parseInt(e)}),this.cmbFontRender.setValue(i?i.get("value"):0),this._fontRender=this.cmbFontRender.getValue(),e=Common.Utils.InternalSettings.get("de-settings-cachemode"),(i=this.cmbFontRender.store.findWhere({value:"custom"}))&&e&&i.set("checked",!!e),i&&e&&this.cmbFontRender.cmpEl.find("#"+i.get("id")+" a").addClass("checked"),e=Common.Utils.InternalSettings.get("de-settings-unit"),i=this.cmbUnit.store.findWhere({value:e}),this.cmbUnit.setValue(i?parseInt(i.get("value")):Common.Utils.Metric.getDefaultMetric()),this._oldUnits=this.cmbUnit.getValue(),e=Common.Utils.InternalSettings.get("de-settings-autosave"),this.chAutosave.setValue(1==e),this.mode.canForcesave&&this.chForcesave.setValue(Common.Utils.InternalSettings.get("de-settings-forcesave")),Common.UI.FeaturesManager.canChange("spellcheck")&&(this.chSpell.setValue(Common.Utils.InternalSettings.get("de-settings-spellcheck")),this.chIgnoreUppercase.setValue(Common.Utils.InternalSettings.get("de-spellcheck-ignore-uppercase-words")),this.chIgnoreNumbers.setValue(Common.Utils.InternalSettings.get("de-spellcheck-ignore-numbers-words"))),this.chAlignGuides.setValue(Common.Utils.InternalSettings.get("de-settings-showsnaplines")),this.chCompatible.setValue(Common.Utils.InternalSettings.get("de-settings-compatible")),i=this.cmbMacros.store.findWhere({value:Common.Utils.InternalSettings.get("de-macros-mode")}),this.cmbMacros.setValue(i?i.get("value"):0),this.chPaste.setValue(Common.Utils.InternalSettings.get("de-settings-paste-button")),this.chQuickPrint.setValue(Common.Utils.InternalSettings.get("de-settings-quick-print-button")),this.chSmartSelection.setValue(Common.Utils.InternalSettings.get("de-settings-smart-selection")),[]);for(t in Common.UI.Themes.map())o.push({value:t,displayValue:Common.UI.Themes.get(t).text,themeType:Common.UI.Themes.get(t).type});o.length&&(this.cmbTheme.setData(o),i=this.cmbTheme.store.findWhere({value:Common.UI.Themes.currentThemeId()}),this.cmbTheme.setValue(i?i.get("value"):Common.UI.Themes.defaultThemeId())),this.chDarkMode.setValue(Common.UI.Themes.isContentThemeDark()),this.chDarkMode.setDisabled(!Common.UI.Themes.isDarkTheme()),this.chRTL.setValue(Common.localStorage.getBool("ui-rtl")),this.mode.canViewReview&&(e=Common.Utils.InternalSettings.get("de-settings-review-hover-mode"),this.rbChangesTip.setValue(e),this.rbChangesBallons.setValue(!e))},applySettings:function(){Common.UI.Themes.setTheme(this.cmbTheme.getValue()),this.chDarkMode.isDisabled()||this.chDarkMode.isChecked()===Common.UI.Themes.isContentThemeDark()||Common.UI.Themes.toggleContentTheme(),Common.localStorage.setItem("de-settings-show-alt-hints",this.chUseAltKey.isChecked()?1:0),Common.Utils.InternalSettings.set("de-settings-show-alt-hints",Common.localStorage.getBool("de-settings-show-alt-hints")),Common.localStorage.setItem("de-settings-zoom",this.cmbZoom.getValue()),Common.Utils.InternalSettings.set("de-settings-zoom",Common.localStorage.getItem("de-settings-zoom")),Common.localStorage.setItem("de-settings-livecomment",this.chLiveComment.isChecked()?1:0),Common.localStorage.setItem("de-settings-resolvedcomment",this.chResolvedComment.isChecked()?1:0),this.mode.isEdit&&!this.mode.isOffline&&this.mode.canCoAuthoring?(this.mode.canChangeCoAuthoring&&Common.localStorage.setItem("de-settings-coauthmode",this.rbCoAuthModeFast.getValue()?1:0),Common.localStorage.setItem(this.rbCoAuthModeFast.getValue()?"de-settings-showchanges-fast":"de-settings-showchanges-strict",this.rbShowChangesNone.getValue()?"none":this.rbShowChangesLast.getValue()?"last":"all")):this.mode.canLiveView&&!this.mode.isOffline&&this.mode.canChangeCoAuthoring&&Common.localStorage.setItem("de-settings-view-coauthmode",this.chLiveViewer.isChecked()?1:0),Common.localStorage.setItem("de-settings-fontrender",this.cmbFontRender.getValue());var t=this.cmbFontRender.store.findWhere({value:"custom"}),t=(Common.localStorage.setItem("de-settings-cachemode",t&&!t.get("checked")?0:1),Common.localStorage.setItem("de-settings-unit",this.cmbUnit.getValue()),!this.mode.isEdit||!this.mode.canChangeCoAuthoring&&Common.Utils.InternalSettings.get("de-settings-coauthmode")||Common.localStorage.setItem("de-settings-autosave",this.chAutosave.isChecked()?1:0),this.mode.canForcesave&&Common.localStorage.setItem("de-settings-forcesave",this.chForcesave.isChecked()?1:0),Common.UI.FeaturesManager.canChange("spellcheck")&&this.mode.isEdit&&(Common.localStorage.setItem("de-settings-spellcheck",this.chSpell.isChecked()?1:0),Common.localStorage.setBool("de-spellcheck-ignore-uppercase-words",this.chIgnoreUppercase.isChecked()),Common.localStorage.setBool("de-spellcheck-ignore-numbers-words",this.chIgnoreNumbers.isChecked())),Common.localStorage.setItem("de-settings-compatible",this.chCompatible.isChecked()?1:0),Common.Utils.InternalSettings.set("de-settings-compatible",this.chCompatible.isChecked()?1:0),Common.Utils.InternalSettings.set("de-settings-showsnaplines",this.chAlignGuides.isChecked()),Common.localStorage.setItem("de-macros-mode",this.cmbMacros.getValue()),Common.Utils.InternalSettings.set("de-macros-mode",this.cmbMacros.getValue()),this.mode.canViewReview&&(t=this.rbChangesTip.getValue(),Common.localStorage.setBool("de-settings-review-hover-mode",t),Common.Utils.InternalSettings.set("de-settings-review-hover-mode",t),this.mode.reviewHoverMode=t),Common.localStorage.setItem("de-settings-paste-button",this.chPaste.isChecked()?1:0),Common.localStorage.setItem("de-settings-smart-selection",this.chSmartSelection.isChecked()?1:0),this.chRTL.$el.is(":visible")&&Common.localStorage.getBool("ui-rtl")!==this.chRTL.isChecked());Common.localStorage.setBool("ui-rtl",this.chRTL.isChecked()),Common.localStorage.setBool("de-settings-quick-print-button",this.chQuickPrint.isChecked()),Common.localStorage.save(),this.menu&&(this.menu.fireEvent("settings:apply",[this.menu]),this._oldUnits!==this.cmbUnit.getValue()&&Common.NotificationCenter.trigger("settings:unitschanged",this)),t&&(t={title:this.txtWorkspaceSettingChange,msg:this.txtRestartEditor,iconCls:"warn",buttons:["ok"]},Common.UI.alert(t))},fillShowChanges:function(t){t?this.rbShowChangesLast.$el.parent().hide():this.rbShowChangesLast.$el.parent().show()},onChangeCoAuthMode:function(t){this.fillShowChanges(1==t),this.rbShowChangesNone.setValue(1==t),this.rbShowChangesLast.setValue(0==t)},onFontRenderSelected:function(t,e){var i;"custom"==e.value&&((i=t.store.findWhere({value:"custom"}))&&i.set("checked",!e.checked),t.cmpEl.find("#"+e.id+" a").toggleClass("checked",!e.checked),t.setValue(this._fontRender)),this._fontRender=t.getValue()},autoCorrect:function(){this.dlgAutoCorrect&&this.dlgAutoCorrect.isVisible()||(this.dlgAutoCorrect=new Common.Views.AutoCorrectDialog({api:this.api}),this.dlgAutoCorrect.show())}},DE.Views.FileMenuPanels.Settings||{})),DE.Views.FileMenuPanels.CreateNew=Common.UI.BaseView.extend(_.extend({el:"#panel-createnew",menu:void 0,events:function(){return{"click .blank-document-btn":_.bind(this._onBlankDocument,this),"click .thumb-list .thumb-wrap":_.bind(this._onDocumentTemplate,this)}},template:_.template(['<div class="header"><%= scope.txtCreateNew %></div>','<div class="thumb-list">',"<% if (blank) { %> ",'<div class="blank-document">','<div class="blank-document-btn" data-hint="2" data-hint-direction="left-top" data-hint-offset="2, 10">','<div class="btn-blank-format"><div class ="svg-format-blank"></div></div>',"</div>",'<div class="title"><%= scope.txtBlank %></div>',"</div>","<% } %>","<% _.each(docs, function(item, index) { %>",'<div class="thumb-wrap" template="<%= item.url %>" data-hint="2" data-hint-direction="left-top" data-hint-offset="14, 22">','<div class="thumb" ',"<% if (!_.isEmpty(item.image)) {%> ",' style="background-image: url(<%= item.image %>);">'," <%} else {print(\"><div class='btn-blank-format'><div class='svg-file-template'></div></div>\") } %>","</div>",'<div class="title"><%= Common.Utils.String.htmlEncode(item.title || item.name || "") %></div>',"</div>","<% }) %>","</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.menu=t.menu,this.docs=t.docs,this.blank=!!t.blank},render:function(){this.$el.html(this.template({scope:this,docs:this.docs,blank:this.blank}));var i=(this.blank?[{title:this.txtBlank}]:[]).concat(this.docs),t=this.$el.find(".thumb-wrap, .blank-document");return _.each(t,function(t,e){$(t).find(".title").tooltip({title:i[e].title,placement:"cursor"})}),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:this.$el,suppressScrollX:!0,alwaysVisibleY:!0})),this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this.scroller&&this.scroller.update()},_onBlankDocument:function(){this.menu&&this.menu.fireEvent("create:new",[this.menu,"blank"])},_onDocumentTemplate:function(t){this.menu&&this.menu.fireEvent("create:new",[this.menu,t.currentTarget.attributes.template.value])},txtBlank:"Blank document",txtCreateNew:"Create New"},DE.Views.FileMenuPanels.CreateNew||{})),DE.Views.FileMenuPanels.DocumentInfo=Common.UI.BaseView.extend(_.extend({el:"#panel-info",menu:void 0,initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.rendered=!1,this.template=_.template(['<div class="flex-settings">','<div class="header">'+this.txtDocumentInfo+"</div>",'<table class="main">',"<tr>",'<td class="left"><label>'+this.txtPlacement+"</label></td>",'<td class="right"><label id="id-info-placement">-</label></td>',"</tr>","<tr>",'<td class="left"><label>'+this.txtOwner+"</label></td>",'<td class="right"><label id="id-info-owner">-</label></td>',"</tr>","<tr>",'<td class="left"><label>'+this.txtUploaded+"</label></td>",'<td class="right"><label id="id-info-uploaded">-</label></td>',"</tr>",'<tr class="divider general"></tr>','<tr class="divider general"></tr>',"<tr>",'<td class="left"><label>'+this.txtPages+"</label></td>",'<td class="right"><label id="id-info-pages"></label></td>',"</tr>","<tr>",'<td class="left"><label>'+this.txtParagraphs+"</label></td>",'<td class="right"><label id="id-info-paragraphs"></label></td>',"</tr>","<tr>",'<td class="left"><label>'+this.txtWords+"</label></td>",'<td class="right"><label id="id-info-words"></label></td>',"</tr>","<tr>",'<td class="left"><label>'+this.txtSymbols+"</label></td>",'<td class="right"><label id="id-info-symbols"></label></td>',"</tr>","<tr>",'<td class="left"><label>'+this.txtSpaces+"</label></td>",'<td class="right"><label id="id-info-spaces"></label></td>',"</tr>",'<tr class="pdf-info">','<td class="left"><label>'+this.txtPageSize+"</label></td>",'<td class="right"><label id="id-info-page-size"></label></td>',"</tr>",'<tr class="divider"></tr>','<tr class="divider"></tr>','<tr class="docx-info">','<td class="left"><label>'+this.txtTitle+"</label></td>",'<td class="right"><div id="id-info-title"></div></td>',"</tr>",'<tr class="docx-info">','<td class="left"><label>'+this.txtTags+"</label></td>",'<td class="right"><div id="id-info-tags"></div></td>',"</tr>",'<tr class="docx-info">','<td class="left"><label>'+this.txtSubject+"</label></td>",'<td class="right"><div id="id-info-subject"></div></td>',"</tr>",'<tr class="docx-info">','<td class="left"><label>'+this.txtComment+"</label></td>",'<td class="right"><div id="id-info-comment"></div></td>',"</tr>",'<tr class="divider docx-info"></tr>','<tr class="divider docx-info"></tr>','<tr class="pdf-info">','<td class="left"><label>'+this.txtTitle+"</label></td>",'<td class="right"><label id="id-lbl-info-title"></label></td>',"</tr>",'<tr class="pdf-info">','<td class="left"><label>'+this.txtSubject+"</label></td>",'<td class="right"><label id="id-lbl-info-subject"></label></td>',"</tr>",'<tr class="divider pdf-info pdf-title"></tr>','<tr class="divider pdf-info pdf-title"></tr>',"<tr>",'<td class="left"><label>'+this.txtModifyDate+"</label></td>",'<td class="right"><label id="id-info-modify-date"></label></td>',"</tr>","<tr>",'<td class="left"><label>'+this.txtModifyBy+"</label></td>",'<td class="right"><label id="id-info-modify-by"></label></td>',"</tr>",'<tr class="divider modify"></tr>','<tr class="divider modify"></tr>',"<tr>",'<td class="left"><label>'+this.txtCreated+"</label></td>",'<td class="right"><label id="id-info-date"></label></td>',"</tr>",'<tr class="pdf-info">','<td class="left"><label>'+this.txtAuthor+"</label></td>",'<td class="right"><label id="id-lbl-info-author"></label></td>',"</tr>",'<tr class="divider pdf-info"></tr>','<tr class="pdf-info">','<td class="left"><label>'+this.txtPdfProducer+"</label></td>",'<td class="right"><label id="id-info-pdf-produce"></label></td>',"</tr>",'<tr class="pdf-info">','<td class="left"><label>'+this.txtPdfVer+"</label></td>",'<td class="right"><label id="id-info-pdf-ver"></label></td>',"</tr>",'<tr class="pdf-info">','<td class="left"><label>'+this.txtPdfTagged+"</label></td>",'<td class="right"><label id="id-info-pdf-tagged"></label></td>',"</tr>",'<tr class="pdf-info">','<td class="left"><label>'+this.txtFastWV+"</label></td>",'<td class="right"><label id="id-info-fast-wv"></label></td>',"</tr>",'<tr class="docx-info">','<td class="left" style="vertical-align: top;"><label style="margin-top: 3px;">'+this.txtAuthor+"</label></td>",'<td class="right" style="vertical-align: top;"><div id="id-info-author">',"<table>","<tr>",'<td><div id="id-info-add-author"><input type="text" spellcheck="false" class="form-control" placeholder="'+this.txtAddAuthor+'"></div></td>',"</tr>","</table>","</div></td>","</tr>",'<tr style="height: 5px;"></tr>',"</table>","</div>",'<div id="fms-flex-apply">','<table class="main">',"<tr>",'<td class="left"></td>','<td class="right"><button id="fminfo-btn-apply" class="btn normal dlg-btn primary" data-hint="2" data-hint-direction="bottom" data-hint-offset="big"><%= scope.okButtonText %></button></td>',"</tr>","</table>","</div>"].join("")),this.infoObj={PageCount:0,WordsCount:0,ParagraphCount:0,SymbolsCount:0,SymbolsWSCount:0},this.menu=t.menu,this.coreProps=null,this.authors=[],this._state={_locked:!1,docProtection:{isReadOnly:!1,isReviewOnly:!1,isFormsOnly:!1,isCommentsOnly:!1},disableEditing:!1}},render:function(t){function e(t,e){var i;e.keyCode===Common.UI.Keys.ESC&&t._input.val()!==(i=t.getValue())&&(t.setValue(i),e.stopPropagation())}var s=this,i=$(s.template({scope:s}));this.lblPlacement=i.findById("#id-info-placement"),this.lblOwner=i.findById("#id-info-owner"),this.lblUploaded=i.findById("#id-info-uploaded"),this.lblStatPages=i.findById("#id-info-pages"),this.lblStatWords=i.findById("#id-info-words"),this.lblStatParagraphs=i.findById("#id-info-paragraphs"),this.lblStatSymbols=i.findById("#id-info-symbols"),this.lblStatSpaces=i.findById("#id-info-spaces"),this.lblPageSize=i.findById("#id-info-pages-size");return this.inputTitle=new Common.UI.InputField({el:i.findById("#id-info-title"),style:"width: 200px;",placeHolder:this.txtAddText,validateOnBlur:!1,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}).on("keydown:before",e),this.inputTags=new Common.UI.InputField({el:i.findById("#id-info-tags"),style:"width: 200px;",placeHolder:this.txtAddText,validateOnBlur:!1,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}).on("keydown:before",e),this.inputSubject=new Common.UI.InputField({el:i.findById("#id-info-subject"),style:"width: 200px;",placeHolder:this.txtAddText,validateOnBlur:!1,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}).on("keydown:before",e),this.inputComment=new Common.UI.InputField({el:i.findById("#id-info-comment"),style:"width: 200px;",placeHolder:this.txtAddText,validateOnBlur:!1,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}).on("keydown:before",e),this.lblModifyDate=i.findById("#id-info-modify-date"),this.lblModifyBy=i.findById("#id-info-modify-by"),this.lblDate=i.findById("#id-info-date"),this.lblApplication=i.findById("#id-info-appname"),this.tblAuthor=i.findById("#id-info-author table"),this.trAuthor=i.findById("#id-info-add-author").closest("tr"),this.authorTpl='<tr><td><div style="display: inline-block;width: 200px;"><input type="text" spellcheck="false" class="form-control" readonly="true" value="{0}"></div><div class="tool close img-commonctrl img-colored" data-hint="2" data-hint-direction="right" data-hint-offset="small"></div></td></tr>',this.tblAuthor.on("click",function(t){var e,t=i.find(t.target);t.hasClass("close")&&!t.hasClass("disabled")&&(t=t.closest("tr"),e=s.tblAuthor.find("tr").index(t),t.remove(),s.authors.splice(e,1),s.updateScroller(!0))}),this.inputAuthor=new Common.UI.InputField({el:i.findById("#id-info-add-author"),style:"width: 200px;",validateOnBlur:!1,placeHolder:this.txtAddAuthor,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}).on("changed:after",function(t,e,i,n){var o;e!=i&&(e=e.trim())&&e!==i.trim()&&(o=n&&n.relatedTarget&&"fminfo-btn-apply"==n.relatedTarget.id,e.split(/\s*[,;]\s*/).forEach(function(t){var e=t.trim();e&&(s.authors.push(t),o||(t=$(Common.Utils.String.format(s.authorTpl,Common.Utils.String.htmlEncode(e))),s.trAuthor.before(t),s.updateScroller()))}),o||s.inputAuthor.setValue(""))}).on("keydown:before",e),this.lblPageSize=i.findById("#id-info-page-size"),this.lblPdfTitle=i.findById("#id-lbl-info-title"),this.lblPdfSubject=i.findById("#id-lbl-info-subject"),this.lblPdfAuthor=i.findById("#id-lbl-info-author"),this.lblPdfVer=i.findById("#id-info-pdf-ver"),this.lblPdfTagged=i.findById("#id-info-pdf-tagged"),this.lblPdfProducer=i.findById("#id-info-pdf-produce"),this.lblFastWV=i.findById("#id-info-fast-wv"),this.btnApply=new Common.UI.Button({el:i.findById("#fminfo-btn-apply")}),this.btnApply.on("click",_.bind(this.applySettings,this)),this.pnlInfo=i.find(".flex-settings").addBack().filter(".flex-settings"),this.pnlApply=i.findById("#fms-flex-apply"),this.rendered=!0,this.updateInfo(this.doc),this.$el=$(t).html(i),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:this.pnlInfo,suppressScrollX:!0,alwaysVisibleY:!0})),Common.NotificationCenter.on({"window:resize":function(){s.isVisible()&&s.updateScroller()}}),this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this.updateStatisticInfo(),this.updateFileInfo(),this.scroller&&this.scroller.scrollTop(0),this.updateScroller()},hide:function(){Common.UI.BaseView.prototype.hide.call(this,arguments),this.stopUpdatingStatisticInfo()},updateScroller:function(t){this.scroller&&(this.scroller.update(t?{}:void 0),this.pnlInfo.toggleClass("bordered",this.scroller.isVisible()))},updateInfo:function(t){if(this.doc=t,this.rendered){var e,i=!1,t=((t=t||{}).info?(t.info.folder&&this.lblPlacement.text(t.info.folder),i=this._ShowHideInfoItem(this.lblPlacement,void 0!==t.info.folder&&null!==t.info.folder)||i,(e=t.info.owner)&&this.lblOwner.text(e),i=this._ShowHideInfoItem(this.lblOwner,!!e)||i,(e=t.info.uploaded)&&this.lblUploaded.text(e),i=this._ShowHideInfoItem(this.lblUploaded,!!e)||i):this._ShowHideDocInfo(!1),$("tr.divider.general",this.el)[i?"show":"hide"](),this.api?this.api.asc_getPdfProps():null),i=this.api?this.api.asc_getAppProps():null;if(i?($(".pdf-info",this.el).hide(),i=(i.asc_getApplication()||"")+(i.asc_getAppVersion()?" ":"")+(i.asc_getAppVersion()||""),this.lblApplication.text(i)):t&&($(".docx-info",this.el).hide(),i=t&&t.Creator||"",this.lblApplication.text(i)),this._ShowHideInfoItem(this.lblApplication,!!i),this.coreProps=this.api?this.api.asc_getCoreProps():null,this.coreProps){if(e=this.coreProps.asc_getCreated()){i=(this.mode.lang||"en").replace("_","-").toLowerCase();try{this.lblDate.text(e.toLocaleString(i,{year:"numeric",month:"2-digit",day:"2-digit"})+" "+e.toLocaleString(i,{timeStyle:"short"}))}catch(t){this.lblDate.text(e.toLocaleString("en",{year:"numeric",month:"2-digit",day:"2-digit"})+" "+e.toLocaleString("en",{timeStyle:"short"}))}}this._ShowHideInfoItem(this.lblDate,!!e)}else t&&this.updatePdfInfo(t)}},updateFileInfo:function(){if(this.rendered){var i=this,t=this.api?this.api.asc_getCoreProps():null;if(this.coreProps=t){var e;if(e=t.asc_getModified()){var n=(this.mode.lang||"en").replace("_","-").toLowerCase();try{this.lblModifyDate.text(e.toLocaleString(n,{year:"numeric",month:"2-digit",day:"2-digit"})+" "+e.toLocaleString(n,{timeStyle:"short"}))}catch(t){this.lblModifyDate.text(e.toLocaleString("en",{year:"numeric",month:"2-digit",day:"2-digit"})+" "+e.toLocaleString("en",{timeStyle:"short"}))}}n=this._ShowHideInfoItem(this.lblModifyDate,!!e)||!1,(e=t.asc_getLastModifiedBy())&&this.lblModifyBy.text(AscCommon.UserInfoParser.getParsedName(e)),n=this._ShowHideInfoItem(this.lblModifyBy,!!e)||n,$("tr.divider.modify",this.el)[n?"show":"hide"](),e=t.asc_getTitle(),this.inputTitle.setValue(e||""),e=t.asc_getKeywords(),this.inputTags.setValue(e||""),e=t.asc_getSubject(),this.inputSubject.setValue(e||""),e=t.asc_getDescription(),this.inputComment.setValue(e||""),this.inputAuthor.setValue(""),this.tblAuthor.find("tr:not(:last-of-type)").remove(),this.authors=[],(e=t.asc_getCreator())&&e.split(/\s*[,;]\s*/).forEach(function(t){var e=$(Common.Utils.String.format(i.authorTpl,Common.Utils.String.htmlEncode(t)));i.trAuthor.before(e),i.authors.push(t)}),this.tblAuthor.find(".close").toggleClass("hidden",!this.mode.isEdit),this._ShowHideInfoItem(this.tblAuthor,this.mode.isEdit||!!this.authors.length)}this.SetDisabled()}},updatePdfInfo:function(t){if(this.rendered)if(t){if(e=t.CreationDate){var e=new Date(e),i=(this.mode.lang||"en").replace("_","-").toLowerCase();try{this.lblDate.text(e.toLocaleString(i,{year:"numeric",month:"2-digit",day:"2-digit"})+" "+e.toLocaleString(i,{timeStyle:"short"}))}catch(t){this.lblDate.text(e.toLocaleString(i="en",{year:"numeric",month:"2-digit",day:"2-digit"})+" "+e.toLocaleString(i,{timeStyle:"short"}))}}this._ShowHideInfoItem(this.lblDate,!!e);if(e=t.ModDate){e=new Date(e);i=(this.mode.lang||"en").replace("_","-").toLowerCase();try{this.lblModifyDate.text(e.toLocaleString(i,{year:"numeric",month:"2-digit",day:"2-digit"})+" "+e.toLocaleString(i,{timeStyle:"short"}))}catch(t){this.lblModifyDate.text(e.toLocaleString(i="en",{year:"numeric",month:"2-digit",day:"2-digit"})+" "+e.toLocaleString(i,{timeStyle:"short"}))}}if(i=this._ShowHideInfoItem(this.lblModifyDate,!!e)||!1,i=this._ShowHideInfoItem(this.lblModifyBy,!1)||i,$("tr.divider.modify",this.el)[i?"show":"hide"](),t.PageWidth&&t.PageHeight&&"number"==typeof t.PageWidth&&"number"==typeof t.PageHeight){var n=t.PageWidth,o=t.PageHeight;switch(Common.Utils.Metric.getCurrentMetric()){case Common.Utils.Metric.c_MetricUnits.cm:n=parseFloat((25.4*n/72e3).toFixed(2)),o=parseFloat((25.4*o/72e3).toFixed(2));break;case Common.Utils.Metric.c_MetricUnits.pt:n=parseFloat((n/100).toFixed(2)),o=parseFloat((o/100).toFixed(2));break;case Common.Utils.Metric.c_MetricUnits.inch:n=parseFloat((n/7200).toFixed(2)),o=parseFloat((o/7200).toFixed(2))}this.lblPageSize.text(n+" "+Common.Utils.Metric.getCurrentMetricName()+" x "+o+" "+Common.Utils.Metric.getCurrentMetricName()),this._ShowHideInfoItem(this.lblPageSize,!0)}else this._ShowHideInfoItem(this.lblPageSize,!1);(e=t.Title)&&this.lblPdfTitle.text(e),i=this._ShowHideInfoItem(this.lblPdfTitle,!!e),(e=t.Subject)&&this.lblPdfSubject.text(e),i=this._ShowHideInfoItem(this.lblPdfSubject,!!e)||i,$("tr.divider.pdf-title",this.el)[i?"show":"hide"](),(e=t.Author)&&this.lblPdfAuthor.text(e),this._ShowHideInfoItem(this.lblPdfAuthor,!!e),(e=t.Version)&&this.lblPdfVer.text(e),this._ShowHideInfoItem(this.lblPdfVer,!!e),void 0!==(e=t.Tagged)&&this.lblPdfTagged.text(!0===e?this.txtYes:this.txtNo),this._ShowHideInfoItem(this.lblPdfTagged,void 0!==e),(e=t.Producer)&&this.lblPdfProducer.text(e),this._ShowHideInfoItem(this.lblPdfProducer,!!e),void 0!==(e=t.FastWebView)&&this.lblFastWV.text(!0===e?this.txtYes:this.txtNo),this._ShowHideInfoItem(this.lblFastWV,void 0!==e)}},_ShowHideInfoItem:function(t,e){return t.closest("tr")[e?"show":"hide"](),e},_ShowHideDocInfo:function(t){this._ShowHideInfoItem(this.lblPlacement,t),this._ShowHideInfoItem(this.lblOwner,t),this._ShowHideInfoItem(this.lblUploaded,t)},updateStatisticInfo:function(){this.api&&this.doc&&this.api.startGetDocInfo()},stopUpdatingStatisticInfo:function(){this.api&&this.api.stopGetDocInfo()},setApi:function(t){return this.api=t,this.api.asc_registerCallback("asc_onGetDocInfoStart",_.bind(this._onGetDocInfoStart,this)),this.api.asc_registerCallback("asc_onGetDocInfoStop",_.bind(this._onGetDocInfoEnd,this)),this.api.asc_registerCallback("asc_onDocInfo",_.bind(this._onDocInfo,this)),this.api.asc_registerCallback("asc_onGetDocInfoEnd",_.bind(this._onGetDocInfoEnd,this)),this.api.asc_registerCallback("asc_onLockCore",_.bind(this.onLockCore,this)),Common.NotificationCenter.on("protect:doclock",_.bind(this.onChangeProtectDocument,this)),this.onChangeProtectDocument(),this.updateInfo(this.doc),this},setMode:function(t){return this.mode=t,this.inputAuthor.setVisible(t.isEdit),this.pnlApply.toggleClass("hidden",!t.isEdit),this.tblAuthor.find(".close").toggleClass("hidden",!t.isEdit),this.inputTitle._input.attr("placeholder",t.isEdit?this.txtAddText:""),this.inputTags._input.attr("placeholder",t.isEdit?this.txtAddText:""),this.inputSubject._input.attr("placeholder",t.isEdit?this.txtAddText:""),this.inputComment._input.attr("placeholder",t.isEdit?this.txtAddText:""),this.inputAuthor._input.attr("placeholder",t.isEdit?this.txtAddAuthor:""),this.SetDisabled(),this},setPreviewMode:function(t){this._state.disableEditing=t},_onGetDocInfoStart:function(){var t=this;this.infoObj={PageCount:0,WordsCount:0,ParagraphCount:0,SymbolsCount:0,SymbolsWSCount:0},this.timerLoading=setTimeout(function(){t.lblStatPages.text(t.txtLoading),t.lblStatWords.text(t.txtLoading),t.lblStatParagraphs.text(t.txtLoading),t.lblStatSymbols.text(t.txtLoading),t.lblStatSpaces.text(t.txtLoading)},2e3)},_onDocInfo:function(t){var e;t&&(clearTimeout(this.timerLoading),-1<t.get_PageCount()&&(this.infoObj.PageCount=t.get_PageCount()),-1<t.get_WordsCount()&&(this.infoObj.WordsCount=t.get_WordsCount()),-1<t.get_ParagraphCount()&&(this.infoObj.ParagraphCount=t.get_ParagraphCount()),-1<t.get_SymbolsCount()&&(this.infoObj.SymbolsCount=t.get_SymbolsCount()),-1<t.get_SymbolsWSCount()&&(this.infoObj.SymbolsWSCount=t.get_SymbolsWSCount()),this.timerDocInfo||((e=this).timerDocInfo=setInterval(function(){e.fillDocInfo()},300),this.fillDocInfo()))},_onGetDocInfoEnd:function(){clearTimeout(this.timerLoading),clearInterval(this.timerDocInfo),this.timerLoading=this.timerDocInfo=void 0,this.fillDocInfo()},fillDocInfo:function(){this.lblStatPages.text(this.infoObj.PageCount),this.lblStatWords.text(this.infoObj.WordsCount),this.lblStatParagraphs.text(this.infoObj.ParagraphCount),this.lblStatSymbols.text(this.infoObj.SymbolsCount),this.lblStatSpaces.text(this.infoObj.SymbolsWSCount)},onDocumentName:function(t){},onLockCore:function(t){this._state._locked=t,this.updateFileInfo()},onChangeProtectDocument:function(t){var e;(t=t?t:(e=DE.getController("DocProtection"))?e.getDocProps():null)&&(this._state.docProtection=t)},SetDisabled:function(){var t=this._state.docProtection.isReadOnly||this._state.docProtection.isFormsOnly||this._state.docProtection.isCommentsOnly,t=!this.mode.isEdit||this._state._locked||t||this._state.disableEditing;this.inputTitle.setDisabled(t),this.inputTags.setDisabled(t),this.inputSubject.setDisabled(t),this.inputComment.setDisabled(t),this.inputAuthor.setDisabled(t),this.tblAuthor.find(".close").toggleClass("disabled",this._state._locked),this.tblAuthor.toggleClass("disabled",t),this.btnApply.setDisabled(this._state._locked)},applySettings:function(){this.coreProps&&this.api&&(this.coreProps.asc_putTitle(this.inputTitle.getValue()),this.coreProps.asc_putKeywords(this.inputTags.getValue()),this.coreProps.asc_putSubject(this.inputSubject.getValue()),this.coreProps.asc_putDescription(this.inputComment.getValue()),this.coreProps.asc_putCreator(this.authors.join(";")),this.api.asc_setCoreProps(this.coreProps)),this.menu.hide()}},DE.Views.FileMenuPanels.DocumentInfo||{})),DE.Views.FileMenuPanels.DocumentRights=Common.UI.BaseView.extend(_.extend({el:"#panel-rights",menu:void 0,initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.rendered=!1,this.template=_.template(['<div class="header">'+this.txtAccessRights+"</div>",'<table class="main">','<tr class="rights">','<td class="left" style="vertical-align: top;"><label>'+this.txtRights+"</label></td>",'<td class="right"><div id="id-info-rights"></div></td>',"</tr>",'<tr class="edit-rights">','<td class="left"></td><td class="right"><button id="id-info-btn-edit" class="btn normal dlg-btn primary custom margin-right-10">'+this.txtBtnAccessRights+"</button></td>","</tr>","</table>"].join("")),this.templateRights=_.template(["<table>","<% _.each(users, function(item) { %>","<tr>",'<td><span class="userLink img-commonctrl  <% if (item.isLink) { %>sharedLink<% } %>"></span><span><%= Common.Utils.String.htmlEncode(item.user) %></span></td>',"<td><%= Common.Utils.String.htmlEncode(item.permissions) %></td>","</tr>","<% }); %>","</table>"].join("")),this.menu=t.menu},render:function(t){var e=$(this.template());return this.cntRights=e.findById("#id-info-rights"),this.btnEditRights=new Common.UI.Button({el:e.elementById("#id-info-btn-edit")}),this.btnEditRights.on("click",_.bind(this.changeAccessRights,this)),this.rendered=!0,this.updateInfo(this.doc),Common.NotificationCenter.on("collaboration:sharingupdate",this.updateSharingSettings.bind(this)),Common.NotificationCenter.on("collaboration:sharingdeny",this.onLostEditRights.bind(this)),this.$el=$(t).html(e),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:this.$el,suppressScrollX:!0,alwaysVisibleY:!0})),this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this.scroller&&this.scroller.update()},hide:function(){Common.UI.BaseView.prototype.hide.call(this,arguments)},updateInfo:function(t){this.doc=t,this.rendered&&((t=t||{}).info?(t.info.sharingSettings&&this.cntRights.html(this.templateRights({users:t.info.sharingSettings})),this._ShowHideInfoItem("rights",void 0!==t.info.sharingSettings&&null!==t.info.sharingSettings&&0<t.info.sharingSettings.length),this._ShowHideInfoItem("edit-rights",(!!this.sharingSettingsUrl&&this.sharingSettingsUrl.length||this.mode.canRequestSharingSettings)&&!0!==this._readonlyRights)):this._ShowHideDocInfo(!1))},_ShowHideInfoItem:function(t,e){$("tr."+t,this.el)[e?"show":"hide"]()},_ShowHideDocInfo:function(t){this._ShowHideInfoItem("rights",t),this._ShowHideInfoItem("edit-rights",t)},setApi:function(t){return this.api=t,this},setMode:function(t){return this.mode=t,this.sharingSettingsUrl=t.sharingSettingsUrl,this},changeAccessRights:function(t,e,i){Common.NotificationCenter.trigger("collaboration:sharing")},updateSharingSettings:function(t){this._ShowHideInfoItem("rights",void 0!==this.doc.info.sharingSettings&&null!==this.doc.info.sharingSettings&&0<this.doc.info.sharingSettings.length),this.cntRights.html(this.templateRights({users:this.doc.info.sharingSettings}))},onLostEditRights:function(){this._readonlyRights=!0,this.rendered&&this._ShowHideInfoItem("edit-rights",!1)},txtRights:"Persons who have rights",txtBtnAccessRights:"Change access rights",txtAccessRights:"Access Rights"},DE.Views.FileMenuPanels.DocumentRights||{})),DE.Views.FileMenuPanels.Help=Common.UI.BaseView.extend({el:"#panel-help",menu:void 0,template:_.template(['<div style="width:100%; height:100%; position: relative;">','<div id="id-help-contents" style="position: absolute; width:220px; top: 0; bottom: 0;" class="no-padding"></div>','<div id="id-help-frame" class="no-padding"></div>',"</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.menu=t.menu,this.urlPref="resources/help/zh/",this.openUrl=null,this.en_data=[{src:"ProgramInterface/ProgramInterface.htm",name:"Introducing Document Editor user interface",headername:"Program Interface"},{src:"ProgramInterface/FileTab.htm",name:"File tab"},{src:"ProgramInterface/HomeTab.htm",name:"Home Tab"},{src:"ProgramInterface/InsertTab.htm",name:"Insert tab"},{src:"ProgramInterface/LayoutTab.htm",name:"Layout tab"},{src:"ProgramInterface/ReviewTab.htm",name:"Review tab"},{src:"ProgramInterface/PluginsTab.htm",name:"Plugins tab"},{src:"UsageInstructions/ChangeColorScheme.htm",name:"Change color scheme",headername:"Basic operations"},{src:"UsageInstructions/CopyPasteUndoRedo.htm",name:"Copy/paste text passages, undo/redo your actions"},{src:"UsageInstructions/OpenCreateNew.htm",name:"Create a new document or open an existing one"},{src:"UsageInstructions/SetPageParameters.htm",name:"Set page parameters",headername:"Page formatting"},{src:"UsageInstructions/NonprintingCharacters.htm",name:"Show/hide nonprinting characters"},{src:"UsageInstructions/SectionBreaks.htm",name:"Insert section breaks"},{src:"UsageInstructions/InsertHeadersFooters.htm",name:"Insert headers and footers"},{src:"UsageInstructions/InsertPageNumbers.htm",name:"Insert page numbers"},{src:"UsageInstructions/InsertFootnotes.htm",name:"Insert footnotes"},{src:"UsageInstructions/AlignText.htm",name:"Align your text in a paragraph",headername:"Paragraph formatting"},{src:"UsageInstructions/BackgroundColor.htm",name:"Select background color for a paragraph"},{src:"UsageInstructions/ParagraphIndents.htm",name:"Change paragraph indents"},{src:"UsageInstructions/LineSpacing.htm",name:"Set paragraph line spacing"},{src:"UsageInstructions/PageBreaks.htm",name:"Insert page breaks"},{src:"UsageInstructions/AddBorders.htm",name:"Add borders"},{src:"UsageInstructions/SetTabStops.htm",name:"Set tab stops"},{src:"UsageInstructions/CreateLists.htm",name:"Create lists"},{src:"UsageInstructions/FormattingPresets.htm",name:"Apply formatting styles",headername:"Text formatting"},{src:"UsageInstructions/FontTypeSizeColor.htm",name:"Set font type, size, and color"},{src:"UsageInstructions/DecorationStyles.htm",name:"Apply font decoration styles"},{src:"UsageInstructions/CopyClearFormatting.htm",name:"Copy/clear text formatting"},{src:"UsageInstructions/AddHyperlinks.htm",name:"Add hyperlinks"},{src:"UsageInstructions/InsertDropCap.htm",name:"Insert a drop cap"},{src:"UsageInstructions/InsertTables.htm",name:"Insert tables",headername:"Operations on objects"},{src:"UsageInstructions/InsertImages.htm",name:"Insert images"},{src:"UsageInstructions/InsertAutoshapes.htm",name:"Insert autoshapes"},{src:"UsageInstructions/InsertCharts.htm",name:"Insert charts"},{src:"UsageInstructions/InsertTextObjects.htm",name:"Insert text objects"},{src:"UsageInstructions/AlignArrangeObjects.htm",name:"Align and arrange objects on a page"},{src:"UsageInstructions/ChangeWrappingStyle.htm",name:"Change wrapping style"},{src:"UsageInstructions/UseMailMerge.htm",name:"Use mail merge",headername:"Mail Merge"},{src:"UsageInstructions/InsertEquation.htm",name:"Insert equations",headername:"Math equations"},{src:"HelpfulHints/CollaborativeEditing.htm",name:"Collaborative document editing",headername:"Document co-editing"},{src:"HelpfulHints/Review.htm",name:"Document Review"},{src:"UsageInstructions/ViewDocInfo.htm",name:"View document information",headername:"Tools and settings"},{src:"UsageInstructions/SavePrintDownload.htm",name:"Save/download/print your document"},{src:"HelpfulHints/AdvancedSettings.htm",name:"Advanced settings of Document Editor"},{src:"HelpfulHints/Navigation.htm",name:"View settings and navigation tools"},{src:"HelpfulHints/Search.htm",name:"Search and replace function"},{src:"HelpfulHints/SpellChecking.htm",name:"Spell-checking"},{src:"HelpfulHints/About.htm",name:"About Document Editor",headername:"Helpful hints"},{src:"HelpfulHints/SupportedFormats.htm",name:"Supported formats of electronic documents"},{src:"HelpfulHints/KeyboardShortcuts.htm",name:"Keyboard shortcuts"}],Common.Utils.isIE&&(window.onhelp=function(){return!1})},render:function(){var n=this;return this.$el.html(this.template()),this.viewHelpPicker=new Common.UI.DataView({el:$("#id-help-contents"),store:new Common.UI.DataViewStore([]),keyMoveDirection:"vertical",itemTemplate:_.template(['<div id="<%= id %>" class="help-item-wrap">','<div class="caption"><%= name %></div>',"</div>"].join(""))}),this.viewHelpPicker.on("item:add",function(t,e,i){i.has("headername")&&$(e.el).before('<div class="header-name">'+i.get("headername")+"</div>")}),this.viewHelpPicker.on("item:select",function(t,e,i){n.onSelectItem(i.get("src"))}),this.iFrame=document.createElement("iframe"),this.iFrame.src="",this.iFrame.align="top",this.iFrame.frameBorder="0",this.iFrame.width="100%",this.iFrame.height="100%",(Common.Utils.isChrome||Common.Utils.isOpera||Common.Utils.isGecko&&86<Common.Utils.firefoxVersion)&&(this.iFrame.onload=function(){try{n.findUrl(n.iFrame.contentWindow.location.href)}catch(t){}}),Common.Gateway.on("internalcommand",function(t){"help:hyperlink"==t.type&&n.findUrl(t.data)}),$("#id-help-frame").append(this.iFrame),this},setLangConfig:function(t){var e,i=this,n=this.viewHelpPicker.store;t&&(t=t.split(/[\-\_]/)[0],e={dataType:"json",error:function(){i.urlPref.indexOf("resources/help/zh/")<0?(i.urlPref="resources/help/zh/",n.url="resources/help/zh/Contents.json",n.fetch(e)):(i.urlPref="resources/help/zh/",n.reset(i.en_data))},success:function(){var t=i.openUrl?n.find(function(t){return 0<=i.openUrl.indexOf(t.get("src"))}):n.at(0);t&&(i.viewHelpPicker.selectRecord(t,!0),i.viewHelpPicker.scrollToRecord(t)),i.onSelectItem(i.openUrl||t.get("src"))}},n.url="resources/help/"+t+"/Contents.json",n.fetch(e),this.urlPref="resources/help/"+t+"/")},show:function(t){Common.UI.BaseView.prototype.show.call(this),this._scrollerInited||(this.viewHelpPicker.scroller.update(),this._scrollerInited=!0),t&&(0<this.viewHelpPicker.store.length?(this.findUrl(t),this.onSelectItem(t)):this.openUrl=t)},onSelectItem:function(t){this.iFrame.src=this.urlPref+t},findUrl:function(e){var t=this.viewHelpPicker.store.find(function(t){return 0<=e.indexOf(t.get("src"))});t&&(this.viewHelpPicker.selectRecord(t,!0),this.viewHelpPicker.scrollToRecord(t))}}),DE.Views.FileMenuPanels.ProtectDoc=Common.UI.BaseView.extend(_.extend({el:"#panel-protect",menu:void 0,template:_.template(['<label id="id-fms-lbl-protect-header"><%= scope.strProtect %></label>','<div id="id-fms-password">','<label class="header"><%= scope.strEncrypt %></label>','<div class="encrypt-block">','<div class="description"><%= scope.txtProtectDocument %></div>','<div id="fms-btn-add-pwd"></div>',"</div>",'<div class="encrypted-block">','<div class="description"><%= scope.txtEncrypted %></div>','<div class="buttons">','<div id="fms-btn-change-pwd"></div>','<div id="fms-btn-delete-pwd" class="margin-left-16"></div>',"</div>","</div>","</div>",'<div id="id-fms-signature">','<label class="header"><%= scope.strSignature %></label>','<div class="add-signature-block">','<div class="description"><%= scope.txtAddSignature %></div>','<div id="fms-btn-invisible-sign"></div>',"</div>",'<div class="added-signature-block">','<div class="description"><%= scope.txtAddedSignature %></div>',"</div>",'<div id="id-fms-signature-view"></div>',"</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.menu=t.menu;this.templateSignature=_.template(['<div class="<% if (!hasRequested && !hasSigned) { %>hidden<% } %>">','<div class="signature-tip"><%= tipText %></div>','<div class="buttons">','<label class="link signature-view-link margin-right-20" data-hint="2" data-hint-direction="bottom" data-hint-offset="medium">'+this.txtView+"</label>",'<label class="link signature-edit-link <% if (!hasSigned) { %>hidden<% } %>" data-hint="2" data-hint-direction="bottom" data-hint-offset="medium">'+this.txtEdit+"</label>","</tr>","</div>"].join(""))},render:function(){this.$el.html(this.template({scope:this}));var t=DE.getController("Common.Controllers.Protection").getView();return this.btnAddPwd=t.getButton("add-password"),this.btnAddPwd.render(this.$el.find("#fms-btn-add-pwd")),this.btnAddPwd.on("click",_.bind(this.closeMenu,this)),this.btnChangePwd=t.getButton("change-password"),this.btnChangePwd.render(this.$el.find("#fms-btn-change-pwd")),this.btnChangePwd.on("click",_.bind(this.closeMenu,this)),this.btnDeletePwd=t.getButton("del-password"),this.btnDeletePwd.render(this.$el.find("#fms-btn-delete-pwd")),this.btnDeletePwd.on("click",_.bind(this.closeMenu,this)),this.cntPassword=$("#id-fms-password"),this.cntEncryptBlock=this.$el.find(".encrypt-block"),this.cntEncryptedBlock=this.$el.find(".encrypted-block"),this.btnAddInvisibleSign=t.getButton("signature"),this.btnAddInvisibleSign.render(this.$el.find("#fms-btn-invisible-sign")),this.btnAddInvisibleSign.on("click",_.bind(this.closeMenu,this)),this.cntSignature=$("#id-fms-signature"),this.cntSignatureView=$("#id-fms-signature-view"),this.cntAddSignature=this.$el.find(".add-signature-block"),this.cntAddedSignature=this.$el.find(".added-signature-block"),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:this.$el,suppressScrollX:!0,alwaysVisibleY:!0})),this.$el.on("click",".signature-edit-link",_.bind(this.onEdit,this)),this.$el.on("click",".signature-view-link",_.bind(this.onView,this)),this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this.updateSignatures(),this.updateEncrypt(),this.scroller&&this.scroller.update()},setMode:function(t){this.mode=t,this.cntSignature.toggleClass("hidden",!this.mode.isSignatureSupport),this.cntPassword.toggleClass("hidden",!this.mode.isPasswordSupport)},setApi:function(t){return this.api=t,this},closeMenu:function(){this.menu&&this.menu.hide()},onEdit:function(){this.menu&&this.menu.hide();var e=this;Common.UI.warning({title:this.notcriticalErrorTitle,msg:this.txtEditWarning,buttons:["ok","cancel"],primary:"ok",callback:function(t){"ok"==t&&e.api.asc_RemoveAllSignatures()}})},onView:function(){this.menu&&this.menu.hide(),DE.getController("RightMenu").rightmenu.SetActivePane(Common.Utils.documentSettingsType.Signature,!0)},updateSignatures:function(){var t=this.api.asc_getRequestSignatures(),e=this.api.asc_getSignatures(),t=t&&0<t.length,i=!1,n=!1,e=(_.each(e,function(t,e){0==t.asc_getValid()?i=!0:n=!0}),n?this.txtSignedInvalid:i?this.txtSigned:""),e=(t&&(e=this.txtRequestedSignatures+(""!=e?"<br><br>":"")+e),this.cntSignatureView.html(this.templateSignature({tipText:e,hasSigned:i||n,hasRequested:t})),this.btnAddInvisibleSign.$el.find("button").hasClass("hidden"));this.cntAddSignature.toggleClass("hidden",e),this.cntAddedSignature.toggleClass("hidden",!e)},updateEncrypt:function(){var t=this.btnAddPwd.$el.find("button").hasClass("hidden");this.cntEncryptBlock.toggleClass("hidden",t),this.cntEncryptedBlock.toggleClass("hidden",!t)}},DE.Views.FileMenuPanels.ProtectDoc||{})),DE.Views.PrintWithPreview=Common.UI.BaseView.extend(_.extend({el:"#panel-print",menu:void 0,template:_.template(['<div style="width:100%; height:100%; position: relative;">','<div id="id-print-settings" class="no-padding">','<div class="print-settings">','<div class="flex-settings ps-container oo settings-container">','<div class="main-header"><%= scope.txtPrint %></div>','<table style="width: 100%;">',"<tbody>",'<tr><td><label class="font-weight-bold"><%= scope.txtPrintRange %></label></td></tr>','<tr><td class="padding-large"><div id="print-combo-range" style="width: 248px;"></div></td></tr>','<tr><td class="padding-large">','<table style="width: 100%;"><tbody>','<tr><td class="padding-large"><%= scope.txtPages %>:</td><td class="padding-large" style="width: 100%;"><div id="print-txt-pages" class="padding-left-5" style="width: 100%;"></div></td></tr>','<tr><td><%= scope.txtCopies %>:</td><td style="width: 100%;"><div id="print-txt-copies" class="padding-left-5" style="width: 60px;"></div></td></tr>',"</tbody></table>","</td></tr>",'<tr><td><label class="font-weight-bold"><%= scope.txtPrintSides %></label></td></tr>','<tr><td class="padding-large"><div id="print-combo-sides" style="width: 248px;"></div></td></tr>','<tr><td><label class="font-weight-bold"><%= scope.txtPageSize %></label></td></tr>','<tr><td class="padding-large"><div id="print-combo-pages" style="width: 248px;"></div></td></tr>','<tr><td><label class="font-weight-bold"><%= scope.txtPageOrientation %></label></td></tr>','<tr><td class="padding-large"><div id="print-combo-orient" style="width: 150px;"></div></td></tr>','<tr><td><label class="font-weight-bold"><%= scope.txtMargins %></label></td></tr>','<tr><td class="padding-large"><div id="print-combo-margins" style="width: 248px;"></div></td></tr>','<tr class="fms-btn-apply"><td>','<div class="footer justify">','<button id="print-btn-print" class="btn normal dlg-btn primary margin-right-8" result="print" style="width: 96px;" data-hint="2" data-hint-direction="bottom" data-hint-offset="big"><%= scope.txtPrint %></button>','<button id="print-btn-print-pdf" class="btn normal dlg-btn" result="pdf" style="min-width: 96px;width: auto;" data-hint="2" data-hint-direction="bottom" data-hint-offset="big"><%= scope.txtPrintPdf %></button>',"</div>","</td></tr>","</tbody>","</table>","</div>","</div>","</div>",'<div id="print-preview-box" class="no-padding">','<div id="print-preview"></div>','<div id="print-navigation">',"<% if (!isRTL) { %>",'<div id="print-prev-page"></div>','<div id="print-next-page"></div>',"<% } else { %>",'<div id="print-next-page"></div>','<div id="print-prev-page"></div>',"<% } %>",'<div class="page-number margin-left-10">',"<label><%= scope.txtPage %></label>",'<div id="print-number-page" class="margin-left-4"></div>','<label id="print-count-page" class="margin-left-4"><%= scope.txtOf %></label>',"</div>","</div>","</div>","</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.menu=t.menu,this._initSettings=!0},render:function(t){var e=this,i=$(this.template({scope:this,isRTL:Common.UI.isRTL()}));return this.cmbRange=new Common.UI.ComboBox({el:i.findById("#print-combo-range"),menuStyle:"min-width: 248px;max-height: 280px;",editable:!1,takeFocusOnClose:!0,cls:"input-group-nr",data:[{value:"all",displayValue:this.txtAllPages},{value:"current",displayValue:this.txtCurrentPage},{value:-1,displayValue:this.txtCustomPages}],dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbRange.setValue("all"),this.inputPages=new Common.UI.InputField({el:i.findById("#print-txt-pages"),allowBlank:!0,validateOnChange:!0,validateOnBlur:!1,maskExp:/[0-9,\-]/,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.spnCopies=new Common.UI.MetricSpinner({el:i.findById("#print-txt-copies"),step:1,width:60,defaultUnit:"",value:1,maxValue:32767,minValue:1,allowDecimal:!1,maskExp:/[0-9]/,dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbSides=new Common.UI.ComboBox({el:i.findById("#print-combo-sides"),menuStyle:"width:100%;",editable:!1,takeFocusOnClose:!0,cls:"input-group-nr",data:[{value:"one",displayValue:this.txtOneSide,descValue:this.txtOneSideDesc},{value:"both-long",displayValue:this.txtBothSides,descValue:this.txtBothSidesLongDesc},{value:"both-short",displayValue:this.txtBothSides,descValue:this.txtBothSidesShortDesc}],itemsTemplate:_.template(["<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%- item.value %>"><a tabindex="-1" type="menuitem" style ="display: flex; flex-direction: column;">','<label class="font-weight-bold"><%= scope.getDisplayValue(item) %></label><label class="comment-text"><%= item.descValue %></label></a></li>',"<% }); %>"].join("")),dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbSides.setValue("one"),this.cmbPaperSize=new Common.UI.ComboBox({el:i.findById("#print-combo-pages"),menuStyle:"max-height: 280px; min-width: 248px;",editable:!1,takeFocusOnClose:!0,cls:"input-group-nr",data:[{value:0,displayValue:"US Letter (21,59 cm x 27,94 cm)",caption:"US Letter",size:[215.9,279.4]},{value:1,displayValue:"US Legal (21,59 cm x 35,56 cm)",caption:"US Legal",size:[215.9,355.6]},{value:2,displayValue:"A4 (21 cm x 29,7 cm)",caption:"A4",size:[210,297]},{value:3,displayValue:"A5 (14,8 cm x 21 cm)",caption:"A5",size:[148,210]},{value:4,displayValue:"B5 (17,6 cm x 25 cm)",caption:"B5",size:[176,250]},{value:5,displayValue:"Envelope #10 (10,48 cm x 24,13 cm)",caption:"Envelope #10",size:[104.8,241.3]},{value:6,displayValue:"Envelope DL (11 cm x 22 cm)",caption:"Envelope DL",size:[110,220]},{value:7,displayValue:"Tabloid (27,94 cm x 43,18 cm)",caption:"Tabloid",size:[279.4,431.8]},{value:8,displayValue:"A3 (29,7 cm x 42 cm)",caption:"A3",size:[297,420]},{value:9,displayValue:"Tabloid Oversize (30,48 cm x 45,71 cm)",caption:"Tabloid Oversize",size:[304.8,457.1]},{value:10,displayValue:"ROC 16K (19,68 cm x 27,3 cm)",caption:"ROC 16K",size:[196.8,273]},{value:11,displayValue:"Envelope Choukei 3 (11,99 cm x 23,49 cm)",caption:"Envelope Choukei 3",size:[119.9,234.9]},{value:12,displayValue:"Super B/A3 (33,02 cm x 48,25 cm)",caption:"Super B/A3",size:[330.2,482.5]},{value:13,displayValue:"A4 (84,1 cm x 118,9 cm)",caption:"A0",size:[841,1189]},{value:14,displayValue:"A4 (59,4 cm x 84,1 cm)",caption:"A1",size:[594,841]},{value:16,displayValue:"A4 (42 cm x 59,4 cm)",caption:"A2",size:[420,594]},{value:17,displayValue:"A4 (10,5 cm x 14,8 cm)",caption:"A6",size:[105,148]},{value:-1,displayValue:this.txtCustom,caption:this.txtCustom,size:[]}],dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbPaperOrientation=new Common.UI.ComboBox({el:i.findById("#print-combo-orient"),menuStyle:"min-width: 150px;",editable:!1,takeFocusOnClose:!0,cls:"input-group-nr",data:[{value:Asc.c_oAscPageOrientation.PagePortrait,displayValue:this.txtPortrait},{value:Asc.c_oAscPageOrientation.PageLandscape,displayValue:this.txtLandscape}],dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbPaperMargins=new Common.UI.ComboBox({el:i.findById("#print-combo-margins"),menuStyle:"max-height: 280px; min-width: 248px;",editable:!1,takeFocusOnClose:!0,cls:"input-group-nr",data:[{value:0,displayValue:this.textMarginsNormal,size:[20,30,20,15]},{value:1,displayValue:this.textMarginsUsNormal,size:[25.4,25.4,25.4,25.4]},{value:2,displayValue:this.textMarginsNarrow,size:[12.7,12.7,12.7,12.7]},{value:3,displayValue:this.textMarginsModerate,size:[25.4,19.1,25.4,19.1]},{value:4,displayValue:this.textMarginsWide,size:[25.4,50.8,25.4,50.8]},{value:-1,displayValue:this.txtCustom,size:null}],itemsTemplate:_.template(["<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%- item.value %>"><a tabindex="-1" type="menuitem">',"<div><b><%= scope.getDisplayValue(item) %></b></div>",'<% if (item.size !== null) { %><div class="margin-right-20" style="display: inline-block;min-width: 80px;"><label style="display: block;">'+this.txtTop+': <%= parseFloat(Common.Utils.Metric.fnRecalcFromMM(item.size[0]).toFixed(2)) %> <%= Common.Utils.Metric.getCurrentMetricName() %></label><label style="display: block;">'+this.txtLeft+': <%= parseFloat(Common.Utils.Metric.fnRecalcFromMM(item.size[1]).toFixed(2)) %> <%= Common.Utils.Metric.getCurrentMetricName() %></label></div><div style="display: inline-block;"><label style="display: block;">'+this.txtBottom+': <%= parseFloat(Common.Utils.Metric.fnRecalcFromMM(item.size[2]).toFixed(2)) %> <%= Common.Utils.Metric.getCurrentMetricName() %></label><label style="display: block;">'+this.txtRight+": <%= parseFloat(Common.Utils.Metric.fnRecalcFromMM(item.size[3]).toFixed(2)) %> <%= Common.Utils.Metric.getCurrentMetricName() %></label></div><% } %>","<% }); %>"].join("")),dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.pnlSettings=i.find(".flex-settings").addBack().filter(".flex-settings"),this.pnlTable=$(this.pnlSettings.find("table")[0]),this.trApply=i.find(".fms-btn-apply"),this.btnPrint=new Common.UI.Button({el:i.findById("#print-btn-print")}),this.btnPrintPdf=new Common.UI.Button({el:i.findById("#print-btn-print-pdf")}),this.btnPrevPage=new Common.UI.Button({parentEl:i.findById("#print-prev-page"),cls:"btn-prev-page",iconCls:"arrow",scaling:!1,dataHint:"2",dataHintDirection:"top"}),this.btnNextPage=new Common.UI.Button({parentEl:i.findById("#print-next-page"),cls:"btn-next-page",iconCls:"arrow",scaling:!1,dataHint:"2",dataHintDirection:"top"}),this.countOfPages=i.findById("#print-count-page"),this.txtNumberPage=new Common.UI.InputField({el:i.findById("#print-number-page"),allowBlank:!0,validateOnChange:!0,style:"width: 50px;",maskExp:/[0-9]/,validation:function(t){return!!(/(^[0-9]+$)/.test(t)&&void 0!==(t=parseInt(t))&&0<t&&t<=e.pageCount)||e.txtPageNumInvalid},dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.$el=$(t).html(i),this.$previewBox=$("#print-preview-box"),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:this.pnlSettings,suppressScrollX:!0,alwaysVisibleY:!0})),Common.NotificationCenter.on({"window:resize":function(){e.isVisible()&&e.updateScroller()}}),this.updateMetricUnit(),this.fireEvent("render:after",this),this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this._initSettings&&(this.updateMetricUnit(),this._initSettings=!1),this.updateScroller(),this.fireEvent("show",this)},updateScroller:function(){var t;this.scroller&&(Common.UI.Menu.Manager.hideAll(),t=this.$el.height()<this.pnlTable.height()+25+this.$el.find(".main-header").outerHeight(!0),this.pnlSettings.css("overflow",t?"hidden":"visible"),this.scroller.update())},setMode:function(t){this.mode=t},setApi:function(t){},updateMetricUnit:function(){if(this.cmbPaperSize){for(var t=this.cmbPaperSize.store,e=0;e<t.length-1;e++){var i=t.at(e),n=i.get("size"),o=n[0],n=n[1];i.set("displayValue",i.get("caption")+" ("+parseFloat(Common.Utils.Metric.fnRecalcFromMM(o).toFixed(2))+" "+Common.Utils.Metric.getCurrentMetricName()+" x "+parseFloat(Common.Utils.Metric.fnRecalcFromMM(n).toFixed(2))+" "+Common.Utils.Metric.getCurrentMetricName()+")")}this.cmbPaperSize.onResetItems(),this.cmbPaperMargins.onResetItems()}},isVisible:function(){return(this.$el||$(this.el)).is(":visible")},setRange:function(t){this.cmbRange.setValue(t)},getRange:function(){return this.cmbRange.getValue()},updateCountOfPages:function(t){this.countOfPages.text(Common.Utils.String.format(this.txtOf,t)),this.pageCount=t},updateCurrentPage:function(t){this.txtNumberPage.setValue(t+1)}},DE.Views.PrintWithPreview||{}))}),define("documenteditor/main/app/controller/Print",["core","documenteditor/main/app/view/FileMenuPanels"],function(){"use strict";DE.Controllers.Print=Backbone.Controller.extend(_.extend({views:["PrintWithPreview"],initialize:function(){this.adjPrintParams=new Asc.asc_CAdjustPrint,this._state={lock_doc:!1,firstPrintPage:0},this._navigationPreview={pageCount:!1,currentPage:0,currentPreviewPage:0},this._isPreviewVisible=!1,this.addListeners({PrintWithPreview:{show:_.bind(this.onShowMainSettingsPrint,this),"render:after":_.bind(this.onAfterRender,this)}})},onLaunch:function(){this.printSettings=this.createView("PrintWithPreview")},onAfterRender:function(t){var d=this,e=(this.printSettings.menu.on("menu:hide",_.bind(this.onHidePrintMenu,this)),this.printSettings.btnPrint.on("click",_.bind(this.onBtnPrint,this,!0)),this.printSettings.btnPrintPdf.on("click",_.bind(this.onBtnPrint,this,!1)),this.printSettings.btnPrevPage.on("click",_.bind(this.onChangePreviewPage,this,!1)),this.printSettings.btnNextPage.on("click",_.bind(this.onChangePreviewPage,this,!0)),this.printSettings.txtNumberPage.on({"keypress:after":_.bind(this.onKeypressPageNumber,this),"keyup:after":_.bind(this.onKeyupPageNumber,this)}),this.printSettings.txtNumberPage.cmpEl.find("input").on("blur",_.bind(this.onBlurPageNumber,this)),this.printSettings.cmbPaperSize.on("selected",_.bind(this.onPaperSizeSelect,this)),this.printSettings.cmbPaperOrientation.on("selected",_.bind(this.onPaperOrientSelect,this)),this.printSettings.cmbPaperMargins.on("selected",_.bind(this.onPaperMarginsSelect,this)),this.printSettings.cmbRange.on("selected",_.bind(this.comboRangeChange,this)),this.printSettings.inputPages.on("changing",_.bind(this.inputPagesChanging,this)),this.printSettings.inputPages.validation=function(t){if(!_.isEmpty(t)&&/[0-9,\-]/.test(t)){var e=[],i=t.split(",");if(d._isPrint&&1<i.length)return d.txtPrintRangeSingleRange;for(var n=0;n<i.length;n++){var o=i[n];if(!o)return d.txtPrintRangeInvalid;var s=o.match(/\-/g);if(s&&1<s.length)return d.txtPrintRangeInvalid;if(s){var a,s=o.split("-"),l=s[0]?parseInt(s[0])-1:0,r=s[1]?parseInt(s[1])-1:d._navigationPreview.pageCount-1;r<l&&(a=l,l=r,r=a);for(var c=l;c<=r;c++)0<=c&&e.push(c)}else 0<=(a=parseInt(o)-1)&&e.push(a)}if(0<e.length)return d._state.firstPrintPage=e[0],!0}return d.txtPrintRangeInvalid},Common.NotificationCenter.on("window:resize",_.bind(function(){this._isPreviewVisible&&this.api.asc_drawPrintPreview(this._navigationPreview.currentPreviewPage)},this)),Common.NotificationCenter.on("margins:update",_.bind(this.onUpdateLastCustomMargins,this)),/Firefox/i.test(navigator.userAgent)?"DOMMouseScroll":"mousewheel");this.printSettings.$previewBox.on(e,_.bind(this.onPreviewWheel,this))},setMode:function(t){this.mode=t,this.printSettings&&this.printSettings.setMode(t)},setApi:function(t){return this.api=t,this.api.asc_registerCallback("asc_onDocSize",_.bind(this.onApiPageSize,this)),this.api.asc_registerCallback("asc_onPageOrient",_.bind(this.onApiPageOrient,this)),this.api.asc_registerCallback("asc_onSectionProps",_.bind(this.onSectionProps,this)),this.api.asc_registerCallback("asc_onCountPages",_.bind(this.onCountPages,this)),this.api.asc_registerCallback("asc_onCurrentPage",_.bind(this.onCurrentPage,this)),this.api.asc_registerCallback("asc_onLockDocumentProps",_.bind(this.onApiLockDocumentProps,this)),this.api.asc_registerCallback("asc_onUnLockDocumentProps",_.bind(this.onApiUnLockDocumentProps,this)),this},findPagePreset:function(t,e){for(var i=t<e?t:e,n=t<e?e:t,o=this.printSettings.cmbPaperSize.store,s=null,a=0;a<o.length-1;a++){var l=o.at(a),r=l.get("size"),c=r[0],r=r[1];if(Math.abs(c-i)<.1&&Math.abs(r-n)<.1){s=l;break}}return s?s.get("caption"):void 0},onApiPageSize:function(t,e){if(this._state.pgsize=[t,e],this.printSettings.isVisible()){for(var i=this._state.pgorient?t:e,n=this._state.pgorient?e:t,e=this.printSettings,o=e.cmbPaperSize.store,s=null,a=0;a<o.length-1;a++){var l=o.at(a),r=l.get("size"),c=r[0],r=r[1];if(Math.abs(c-i)<.1&&Math.abs(r-n)<.1){s=l;break}}s?e.cmbPaperSize.setValue(s.get("value")):e.cmbPaperSize.setValue(this.txtCustom+" ("+parseFloat(Common.Utils.Metric.fnRecalcFromMM(i).toFixed(2))+Common.Utils.Metric.getCurrentMetricName()+" x "+parseFloat(Common.Utils.Metric.fnRecalcFromMM(n).toFixed(2))+Common.Utils.Metric.getCurrentMetricName()+")")}else this.isFillProps=!1},onApiPageOrient:function(t){this._state.pgorient=!!t,this.printSettings.isVisible()&&(t=this.printSettings.cmbPaperOrientation.store.findWhere({value:this._state.pgorient?Asc.c_oAscPageOrientation.PagePortrait:Asc.c_oAscPageOrientation.PageLandscape}))&&this.printSettings.cmbPaperOrientation.setValue(t.get("value"))},onSectionProps:function(t){if(t&&(this._state.sectionprops=t,this.printSettings.isVisible())){for(var e=t.get_LeftMargin(),i=t.get_TopMargin(),n=t.get_RightMargin(),o=t.get_BottomMargin(),s=(this._state.pgmargins=[i,e,o,n],this.printSettings.cmbPaperMargins.store),a=null,l=0;l<s.length-1;l++){var r=s.at(l),c=r.get("size");"object"==typeof c&&Math.abs(c[0]-i)<.1&&Math.abs(c[1]-e)<.1&&Math.abs(c[2]-o)<.1&&Math.abs(c[3]-n)<.1&&(a=r)}a?this.printSettings.cmbPaperMargins.setValue(a.get("value")):this.printSettings.cmbPaperMargins.setValue(this.txtCustom)}},comboRangeChange:function(t,e){var i;-1===e.value?(i=this,setTimeout(function(){i.printSettings.inputPages.focus()},50)):this.printSettings.inputPages.setValue(""),this.printSettings.inputPages.showError()},onCountPages:function(t){this._navigationPreview.pageCount=t,this._navigationPreview.currentPreviewPage>t-1&&(this._navigationPreview.currentPreviewPage=Math.max(0,t-1),this.printSettings.isVisible()&&(this.api.asc_drawPrintPreview(this._navigationPreview.currentPreviewPage),this.updateNavigationButtons(this._navigationPreview.currentPreviewPage,t)))},onCurrentPage:function(t){this._navigationPreview.currentPreviewPage=t,this.printSettings.isVisible()&&(this.api.asc_drawPrintPreview(this._navigationPreview.currentPreviewPage),this.updateNavigationButtons(this._navigationPreview.currentPreviewPage,this._navigationPreview.pageCount))},onShowMainSettingsPrint:function(){this.printSettings.$previewBox.removeClass("hidden"),this.onUpdateLastCustomMargins(this._state.lastmargins),this._state.pgsize&&this.onApiPageSize(this._state.pgsize[0],this._state.pgsize[1]),this.onApiPageOrient(this._state.pgorient),this._state.sectionprops&&this.onSectionProps(this._state.sectionprops);var t=new Asc.asc_CDownloadOptions(null,Common.Utils.isChrome||Common.Utils.isOpera||Common.Utils.isGecko&&86<Common.Utils.firefoxVersion);t.asc_setAdvancedOptions(this.adjPrintParams),this.api.asc_initPrintPreview("print-preview",t),this._navigationPreview.currentPreviewPage=this._navigationPreview.currentPage=this.api.getCurrentPage(),this.api.asc_drawPrintPreview(this._navigationPreview.currentPreviewPage),this.updateNavigationButtons(this._navigationPreview.currentPreviewPage,this._navigationPreview.pageCount),this.SetDisabled(),this._isPreviewVisible=!0},onPaperSizeSelect:function(t,e){if(this._state.pgsize=[0,0],-1!==e.value){if(this.checkPageSize(e.size[0],e.size[1]))return o=this.api.asc_GetSectionProps(),void this.onApiPageSize(o.get_W(),o.get_H());this.api.change_DocSize(e.size[0],e.size[1])}else{var i,n=this,o=new DE.Views.PageSizeDialog({checkPageSize:_.bind(this.checkPageSize,this),handler:function(t,e){"ok"==e&&(i=t.getSettings(),n.api.change_DocSize(i[0],i[1]),Common.NotificationCenter.trigger("edit:complete"))}});o.show(),o.setSettings(n.api.asc_GetSectionProps())}Common.NotificationCenter.trigger("edit:complete")},onPaperMarginsSelect:function(t,e){if(this._state.pgmargins=void 0,-1!==e.value){if(this.checkPageSize(void 0,void 0,e.size[1],e.size[3],e.size[0],e.size[2]))return void this.onSectionProps(this.api.asc_GetSectionProps());(i=new Asc.CDocumentSectionProps).put_TopMargin(e.size[0]),i.put_LeftMargin(e.size[1]),i.put_BottomMargin(e.size[2]),i.put_RightMargin(e.size[3]),this.api.asc_SetSectionProps(i)}else{var i,n=this,e=new DE.Views.PageMarginsDialog({api:n.api,handler:function(t,e){"ok"==e&&(i=t.getSettings(),Common.localStorage.setItem("de-pgmargins-top",i.get_TopMargin()),Common.localStorage.setItem("de-pgmargins-left",i.get_LeftMargin()),Common.localStorage.setItem("de-pgmargins-bottom",i.get_BottomMargin()),Common.localStorage.setItem("de-pgmargins-right",i.get_RightMargin()),Common.NotificationCenter.trigger("margins:update",i),n.api.asc_SetSectionProps(i),Common.NotificationCenter.trigger("edit:complete"))}});e.show(),e.setSettings(n.api.asc_GetSectionProps())}Common.NotificationCenter.trigger("edit:complete")},onUpdateLastCustomMargins:function(t){var e,i,n,o;this._state.lastmargins=t,this.printSettings.isVisible()&&(e=t?t.get_TopMargin():Common.localStorage.getItem("de-pgmargins-top"),i=t?t.get_LeftMargin():Common.localStorage.getItem("de-pgmargins-left"),n=t?t.get_BottomMargin():Common.localStorage.getItem("de-pgmargins-bottom"),t=t?t.get_RightMargin():Common.localStorage.getItem("de-pgmargins-right"),null!==e&&null!==i&&null!==n&&null!==t&&(-2===(o=this.printSettings.cmbPaperMargins.store.at(0)).get("value")?o.set("size",[parseFloat(e),parseFloat(i),parseFloat(n),parseFloat(t)]):this.printSettings.cmbPaperMargins.store.unshift({value:-2,displayValue:this.textMarginsLast,size:[parseFloat(e),parseFloat(i),parseFloat(n),parseFloat(t)]}),this.printSettings.cmbPaperMargins.onResetItems()))},onPaperOrientSelect:function(t,e){this._state.pgorient=void 0,this.api&&this.api.change_PageOrient(e.value===Asc.c_oAscPageOrientation.PagePortrait),Common.NotificationCenter.trigger("edit:complete")},checkPageSize:function(t,e,i,n,o,s){var a=this.api.asc_GetSectionProps(),l=(void 0===t&&(t=parseFloat(a.get_W().toFixed(4))),void 0===e&&(e=parseFloat(a.get_H().toFixed(4))),void 0===i&&(i=parseFloat(a.get_LeftMargin().toFixed(4))),void 0===n&&(n=parseFloat(a.get_RightMargin().toFixed(4))),void 0===o&&(o=parseFloat(a.get_TopMargin().toFixed(4))),void 0===s&&(s=parseFloat(a.get_BottomMargin().toFixed(4))),a.get_GutterAtTop()?0:parseFloat(a.get_Gutter().toFixed(4))),a=a.get_GutterAtTop()?parseFloat(a.get_Gutter().toFixed(4)):0,r=null;if(t-12.7<i+n+l?r=this.txtMarginsW:e-2.6<o+s+a&&(r=this.txtMarginsH),r)return Common.UI.warning({title:this.notcriticalErrorTitle,msg:r,callback:function(){Common.NotificationCenter.trigger("edit:complete")}}),!0},getPrintParams:function(){return this.adjPrintParams},onHidePrintMenu:function(){this._isPreviewVisible&&(this.api.asc_closePrintPreview&&this.api.asc_closePrintPreview(),this._isPreviewVisible=!1)},onChangePreviewPage:function(t){var e=this._navigationPreview.currentPreviewPage,e=t?(e++,Math.min(e,this._navigationPreview.pageCount-1)):(e--,Math.max(e,0));this.api.goToPage(e)},onKeypressPageNumber:function(t,e){var i,n;if(e.keyCode===Common.UI.Keys.RETURN)return i=(e=this.printSettings.$el.find("#print-number-page")).find("input[type=text]"),!(n=parseInt(i.val()))||n>this._navigationPreview.pageCount||n<0?(i.select(),this.printSettings.txtNumberPage.setValue(this._navigationPreview.currentPreviewPage+1),this.printSettings.txtNumberPage.checkValidate()):(e.focus(),this.api.goToPage(n-1)),!1},onKeyupPageNumber:function(t,e){if(e.keyCode===Common.UI.Keys.ESC)return this.printSettings.$el.find("#print-number-page").focus(),this.api.asc_enableKeyEvents(!0),!1},onBlurPageNumber:function(){this.printSettings.txtNumberPage.getValue()!=this._navigationPreview.currentPreviewPage+1&&(this.printSettings.txtNumberPage.setValue(this._navigationPreview.currentPreviewPage+1),this.printSettings.txtNumberPage.checkValidate())},onPreviewWheel:function(t){t.ctrlKey&&(t.preventDefault(),t.stopImmediatePropagation());t=(t.deltaY||t.detail&&-t.detail||t.wheelDelta)<0;this.onChangePreviewPage(t)},updateNavigationButtons:function(t,e){this._navigationPreview.currentPage=t,this.printSettings.updateCurrentPage(t),this._navigationPreview.pageCount=e,this.printSettings.updateCountOfPages(e),this.disableNavButtons()},disableNavButtons:function(t){var e;t?(this.printSettings.btnPrevPage.setDisabled(!0),this.printSettings.btnNextPage.setDisabled(!0)):(t=this._navigationPreview.currentPage,e=this._navigationPreview.pageCount,this.printSettings.btnPrevPage.setDisabled(t<1),this.printSettings.btnNextPage.setDisabled(e-2<t))},onBtnPrint:function(t){var e,i;this._isPrint=t,-1===this.printSettings.cmbRange.getValue()&&!0!==this.printSettings.inputPages.checkValidate()?(this.printSettings.inputPages.focus(),this.isInputFirstChange=!0):("all"===this.printSettings.cmbRange.getValue()?this._state.firstPrintPage=0:"current"===this.printSettings.cmbRange.getValue()&&(this._state.firstPrintPage=this._navigationPreview.currentPage),e=this.api.asc_getPageSize(this._state.firstPrintPage),this.adjPrintParams.asc_setNativeOptions({pages:(-1===this.printSettings.cmbRange.getValue()?this.printSettings.inputPages:this.printSettings.cmbRange).getValue(),paperSize:{w:e?e.W:void 0,h:e?e.H:void 0,preset:e?this.findPagePreset(e.W,e.H):void 0},paperOrientation:e?e.H>e.W?"portrait":"landscape":null,copies:this.printSettings.spnCopies.getNumberValue()||1,sides:this.printSettings.cmbSides.getValue()}),this.printSettings.menu.hide(),t?((i=new Asc.asc_CDownloadOptions(null,Common.Utils.isChrome||Common.Utils.isOpera||Common.Utils.isGecko&&86<Common.Utils.firefoxVersion)).asc_setAdvancedOptions(this.adjPrintParams),this.api.asc_Print(i)):((i=new Asc.asc_CDownloadOptions(Asc.c_oAscFileType.PDF)).asc_setAdvancedOptions(this.adjPrintParams),this.api.asc_DownloadAs(i)))},inputPagesChanging:function(t,e){this.isInputFirstChange&&this.printSettings.inputPages.showError(),this.isInputFirstChange=!1,e.length<1?this.printSettings.cmbRange.setValue("all"):-1!==this.printSettings.cmbRange.getValue()&&this.printSettings.cmbRange.setValue(-1)},onApiLockDocumentProps:function(){this._state.lock_doc=!0,this.SetDisabled()},onApiUnLockDocumentProps:function(){this._state.lock_doc=!1,this.SetDisabled()},SetDisabled:function(){var t;this.printSettings.isVisible()&&(t=!this.mode.isEdit||this._state.lock_doc,this.printSettings.cmbPaperSize.setDisabled(t),this.printSettings.cmbPaperMargins.setDisabled(t),this.printSettings.cmbPaperOrientation.setDisabled(t))}},DE.Controllers.Print||{}))}),void 0===Common&&(Common={}),Common.Models=Common.Models||{},define("common/main/lib/model/HistoryVersion",["underscore","backbone","common/main/lib/component/BaseView"],function(t,e){"use strict";Common.Models.HistoryVersion=e.Model.extend({defaults:function(){return{version:0,revision:0,changeid:void 0,userid:void 0,username:"Guest",usercolor:"#ff0000",created:void 0,id:Common.UI.getId(),url:"",urlDiff:"",urlGetTime:"",docId:"",docIdPrev:"",token:"",arrColors:[],markedAsVersion:!1,canRestore:!1,isRevision:!0,hasChanges:!1,isExpanded:!0,isVisible:!0,allowSelected:!0,selected:!1,serverVersion:0,fileType:"docx"}}})}),void 0===Common&&(Common={}),Common.Collections=Common.Collections||{},define("common/main/lib/collection/HistoryVersions",["underscore","backbone","common/main/lib/model/HistoryVersion"],function(t,e){"use strict";Common.Collections.HistoryVersions=e.Collection.extend({model:Common.Models.HistoryVersion,findRevision:function(t){return this.findWhere({revision:t})},findRevisions:function(t){return this.where({revision:t})},hasChanges:function(){return!!this.findWhere({isRevision:!1})},hasCollapsed:function(){return!!this.findWhere({isRevision:!0,hasChanges:!0,isExpanded:!1})}})}),void 0===Common&&(Common={}),Common.Views=Common.Views||{},define("common/main/lib/view/History",["common/main/lib/util/utils","common/main/lib/component/BaseView","common/main/lib/component/Layout"],function(t){"use strict";Common.Views.History=Common.UI.BaseView.extend(_.extend({el:"#left-panel-history",storeHistory:void 0,template:_.template(['<div id="history-box" class="layout-ct vbox">','<div id="history-header" class="">','<div id="history-btn-back"><%=scope.textCloseHistory%></div>',"</div>",'<div id="history-list" class="">',"</div>",'<div id="history-expand-changes" class="">','<div id="history-btn-expand"><%=scope.textHideAll%></div>',"</div>","</div>"].join("")),initialize:function(t){_.extend(this,t),Common.UI.BaseView.prototype.initialize.call(this,arguments);t=Common.localStorage.getKeysFilter();this.appPrefix=t&&t.length?t.split(",")[0]:""},render:function(t){t=t||this.el,$(t).html(this.template({scope:this})).width((parseInt(Common.localStorage.getItem(this.appPrefix+"mainmenu-width"))||MENU_SCALE_PART)-SCALE_MIN),this.viewHistoryList=new Common.UI.DataView({el:$("#history-list"),store:this.storeHistory,enableKeyEvents:!1,itemTemplate:_.template(['<div id="<%= id %>" class="history-item-wrap <% if (!isVisible) { %>hidden<% } %>" ','style="display: block; <% if (!isRevision) { %>'+(Common.UI.isRTL()?"padding-right: 40px;":"padding-left: 40px;")+'<% } %><% if (canRestore && selected) { %>padding-bottom: 6px;<% } %>">','<div class="user-date"><%= created %></div>',"<% if (markedAsVersion) { %>",'<div class="user-version">'+this.textVer+"<%=version%></div>","<% } %>","<% if (isRevision && hasChanges) { %>",'<div class="revision-expand  <% if (isExpanded) { %>up<% } %>"></div>',"<% } %>",'<div class="user-name">','<div class="color" style="display: inline-block; background-color:<%=usercolor%>;" >',"</div><%= Common.Utils.String.htmlEncode(AscCommon.UserInfoParser.getParsedName(username)) %>","</div>","<% if (canRestore && selected) { %>",'<label class="revision-restore" role="presentation" tabindex="-1">'+this.textRestore+"</label>","<% } %>","</div>"].join(""))});function e(t,e,i){i.get("isRevision")&&(e.btnTip&&(e.btnTip.dontShow=!0,e.btnTip.tip().remove(),e.btnTip=null),0<(i=$(e.el).find(".revision-expand").tooltip({title:i.get("isExpanded")?l.textHide:l.textShow,placement:"cursor"})).length&&(e.btnTip=i.data("bs.tooltip")))}var l=this;this.viewHistoryList.onClickItem=function(t,e,i){var n=$(i.target);if(n&&n.hasClass("revision-expand")){var o=!e.get("isExpanded");e.set("isExpanded",o);var s=l.storeHistory.findRevisions(e.get("revision"));if(s&&1<s.length)for(var a=1;a<s.length;a++)s[a].set("isVisible",o);this.scroller.update({minScrollbarLength:this.minScrollbarLength})}else Common.UI.DataView.prototype.onClickItem.call(this,t,e,i);l.btnExpand.cmpEl.text(l.storeHistory.hasCollapsed()?l.textShowAll:l.textHideAll)};return this.viewHistoryList.on("item:add",e),this.viewHistoryList.on("item:change",e),this.btnBackToDocument=new Common.UI.Button({el:$("#history-btn-back"),enableToggle:!1}),this.btnExpand=new Common.UI.Button({el:$("#history-btn-expand"),enableToggle:!1}),this.trigger("render:after",this),this}},Common.Views.History||{}))}),define("common/main/lib/controller/History",["core","common/main/lib/collection/HistoryVersions","common/main/lib/view/History"],function(){"use strict";Common.Controllers.History=Backbone.Controller.extend(_.extend({models:[],collections:["Common.Collections.HistoryVersions"],views:["Common.Views.History"],initialize:function(){this.currentChangeId=-1,this.currentArrColors=[],this.currentDocId="",this.currentDocIdPrev="",this.currentRev=0,this.currentServerVersion=0,this.currentUserId="",this.currentUserName="",this.currentUserColor="",this.currentDateCreated=""},events:{},onLaunch:function(){this.panelHistory=this.createView("Common.Views.History",{storeHistory:this.getApplication().getCollection("Common.Collections.HistoryVersions")}),this.panelHistory.storeHistory.on("reset",_.bind(this.onResetStore,this)),this.panelHistory.on("render:after",_.bind(this.onAfterRender,this)),Common.Gateway.on("sethistorydata",_.bind(this.onSetHistoryData,this))},setApi:function(t){return this.api=t,this.api.asc_registerCallback("asc_onDownloadUrl",_.bind(this.onDownloadUrl,this)),this.api.asc_registerCallback("asc_onExpiredToken",_.bind(this.onExpiredToken,this)),this},setMode:function(t){(this.mode=t).canHistoryClose||(this.panelHistory.$el.find("#history-header").hide(),this.panelHistory.$el.find("#history-list").css("padding-top",0))},onAfterRender:function(t){t.viewHistoryList.on("item:click",_.bind(this.onSelectRevision,this)),t.btnBackToDocument.on("click",_.bind(this.onClickBackToDocument,this)),t.btnExpand.on("click",_.bind(this.onClickExpand,this))},onResetStore:function(){var t=this.panelHistory.storeHistory.hasChanges();this.panelHistory.$el.find("#history-expand-changes")[t?"show":"hide"](),this.panelHistory.$el.find("#history-list").css("padding-bottom",t?"45px":0)},onDownloadUrl:function(t,e){void 0!==this.isFromSelectRevision&&Common.Gateway.requestRestore(this.isFromSelectRevision,t,e),this.isFromSelectRevision=void 0},onSelectRevision:function(t,e,i,n){if(n){var n=$(n.target);if(n&&n.hasClass("revision-restore"))return void(i.get("isRevision")?Common.Gateway.requestRestore(i.get("revision"),void 0,i.get("fileType")):(this.isFromSelectRevision=i.get("revision"),n=Asc.c_oAscFileType[(i.get("fileType")||"").toUpperCase()]||Asc.c_oAscFileType.DOCX,this.api.asc_DownloadAs(new Asc.asc_CDownloadOptions(n,!0))))}!t&&i&&this.panelHistory.viewHistoryList.scrollToRecord(i);var o,s,n=i.get("url"),a=i.get("revision"),t=new Date;this.currentChangeId=i.get("changeid"),this.currentArrColors=i.get("arrColors"),this.currentDocId=i.get("docId"),this.currentDocIdPrev=i.get("docIdPrev"),this.currentRev=a,this.currentServerVersion=i.get("serverVersion"),this.currentUserId=i.get("userid"),this.currentUserName=i.get("username"),this.currentUserColor=i.get("usercolor"),this.currentDateCreated=i.get("created"),_.isEmpty(n)||3e5<t-i.get("urlGetTime")?(o=this).timerId||(o.timerId=setTimeout(function(){o.timerId=0},3e4),_.delay(function(){Common.Gateway.requestHistoryData(a)},10)):((t=this.getApplication().getController("Common.Controllers.Comments"))&&(t.onApiHideComment(),t.clearCollections()),t=i.get("urlDiff"),i=i.get("token"),(s=new Asc.asc_CVersionHistory).asc_setDocId(_.isEmpty(t)?this.currentDocId:this.currentDocIdPrev),s.asc_setUrl(n),s.asc_setUrlChanges(t),s.asc_setCurrentChangeId(this.currentChangeId),s.asc_setArrColors(this.currentArrColors),s.asc_setToken(i),s.asc_setIsRequested(!1),s.asc_setServerVersion(this.currentServerVersion),s.asc_SetUserId(this.currentUserId),s.asc_SetUserName(this.currentUserName),s.asc_SetUserColor(this.currentUserColor),s.asc_SetDateOfRevision(this.currentDateCreated),this.api.asc_showRevision(s),(n=this.getApplication().getController("Common.Controllers.ReviewChanges"))&&n.onApiShowChange())},onSetHistoryData:function(t){if(this.mode.canUseHistory)if(this.timerId&&(clearTimeout(this.timerId),this.timerId=0),t.data.error){var e={title:this.notcriticalErrorTitle,msg:t.data.error,iconCls:"warn",buttons:["ok"]};Common.UI.alert(e)}else{var e=this.getApplication().getController("Common.Controllers.Comments"),e=(e&&(e.onApiHideComment(),e.clearCollections()),t.data),i=this.getApplication().getCollection("Common.Collections.HistoryVersions");if(i&&null!==e){var n,o=i.findRevisions(e.version),s=new Date,a=t.data.previous&&void 0!==this.currentChangeId?t.data.changesUrl:null,l=(!_.isEmpty(a)&&t.data.previous?t.data.previous:t.data).url,r=(!_.isEmpty(a)&&t.data.previous?t.data.previous:t.data).fileType,c=t.data.key||this.currentDocId,d=t.data.previous&&t.data.previous.key?t.data.previous.key:this.currentDocIdPrev,h=t.data.token;if(o&&0<o.length)for(var m=0;m<o.length;m++)(n=o[m]).set("url",l,{silent:!0}),n.set("urlDiff",a,{silent:!0}),n.set("urlGetTime",s,{silent:!0}),t.data.key&&(n.set("docId",c,{silent:!0}),n.set("docIdPrev",d,{silent:!0})),n.set("token",h,{silent:!0}),r&&n.set("fileType",r,{silent:!0});i=new Asc.asc_CVersionHistory,i=(i.asc_setUrl(l),i.asc_setUrlChanges(a),i.asc_setDocId(_.isEmpty(a)?c:d),i.asc_setCurrentChangeId(this.currentChangeId),i.asc_setArrColors(this.currentArrColors),i.asc_setToken(h),i.asc_setIsRequested(!0),i.asc_setServerVersion(this.currentServerVersion),i.asc_SetUserId(this.currentUserId),i.asc_SetUserName(this.currentUserName),i.asc_SetUserColor(this.currentUserColor),i.asc_SetDateOfRevision(this.currentDateCreated),this.api.asc_showRevision(i),this.currentRev=e.version,this.getApplication().getController("Common.Controllers.ReviewChanges"));i&&i.onApiShowChange()}}},onExpiredToken:function(){var t=this;_.delay(function(){Common.Gateway.requestHistoryData(t.currentRev)},10)},onClickBackToDocument:function(){Common.Gateway.requestHistoryClose()},onClickExpand:function(){var t=this.panelHistory.storeHistory,e=t.hasCollapsed();t.where({isRevision:!0,hasChanges:!0,isExpanded:!e}).forEach(function(t){t.set("isExpanded",e)}),t.where({isRevision:!1}).forEach(function(t){t.set("isVisible",e)}),this.panelHistory.viewHistoryList.scroller.update({minScrollbarLength:this.panelHistory.viewHistoryList.minScrollbarLength}),this.panelHistory.btnExpand.cmpEl.text(e?this.panelHistory.textHideAll:this.panelHistory.textShowAll)}},Common.Controllers.History||{}))}),void 0===Common&&(Common={}),Common.Models=Common.Models||{},define("common/main/lib/model/User",["underscore","backbone","common/main/lib/component/BaseView"],function(t,e){"use strict";Common.Models.User=e.Model.extend({defaults:function(){return{iid:Common.UI.getId(),id:void 0,idOriginal:void 0,username:"Guest",color:"#fff",colorval:null,online:!1,view:!1,hidden:!1}}})}),define("common/main/lib/collection/Users",["backbone","common/main/lib/model/User"],function(t){"use strict";Common.Collections=Common.Collections||{},Common.Collections.Users=t.Collection.extend({model:Common.Models.User,getOnlineCount:function(){var e=0;return this.each(function(t){t.get("online")&&++e}),e},getEditingCount:function(){return this.filter(function(t){return t.get("online")&&!t.get("view")}).length},getVisibleEditingCount:function(){return this.filter(function(t){return t.get("online")&&!t.get("view")&&!t.get("hidden")}).length},getEditingOriginalCount:function(){return this.chain().filter(function(t){return t.get("online")&&!t.get("view")}).groupBy(function(t){return t.get("idOriginal")}).size().value()},getVisibleEditingOriginalCount:function(){return this.chain().filter(function(t){return t.get("online")&&!t.get("view")&&!t.get("hidden")}).groupBy(function(t){return t.get("idOriginal")}).size().value()},findUser:function(e){return this.find(function(t){return t.get("id")==e})},findOriginalUser:function(e){return this.find(function(t){return t.get("idOriginal")==e})}}),Common.Collections.HistoryUsers=t.Collection.extend({model:Common.Models.User,findUser:function(e){return this.find(function(t){return t.get("id")==e})}})}),void 0===Common&&(Common={}),Common.Models=Common.Models||{},define("common/main/lib/model/Comment",["underscore","backbone","common/main/lib/component/BaseView"],function(t,e){"use strict";Common.Models.Comment=e.Model.extend({defaults:{uid:0,guid:"",userid:0,username:"Guest",parsedName:"Guest",parsedGroups:void 0,usercolor:null,date:void 0,quote:"",comment:"",resolved:!1,lock:!1,lockuserid:"",unattached:!1,userdata:"",position:-1,id:Common.UI.getId(),time:0,showReply:!1,showReplyInPopover:!1,editText:!1,editTextInPopover:!1,last:void 0,replys:[],hideAddReply:!1,scope:null,hide:!1,filtered:!1,hint:!1,fullInfoInHint:!1,dummy:void 0,editable:!0,removable:!0}}),Common.Models.Reply=e.Model.extend({defaults:{time:0,userid:0,username:"Guest",parsedName:"Guest",usercolor:null,reply:"",date:void 0,userdata:"",id:Common.UI.getId(),editText:!1,editTextInPopover:!1,scope:null,editable:!0,removable:!0,hide:!1}})}),void 0===Common&&(Common={}),Common.Collections=Common.Collections||{},define("common/main/lib/collection/Comments",["underscore","backbone","common/main/lib/model/Comment"],function(t,e){"use strict";Common.Collections.Comments=e.Collection.extend({model:Common.Models.Comment,groups:null,clearEditing:function(){this.each(function(t){t.set("editText",!1),t.set("editTextInPopover",!1),t.set("showReply",!1),t.set("showReplyInPopover",!1),t.set("hideAddReply",!1)})},getCommentsReplysCount:function(e){var i=0;return this.each(function(t){t.get("userid")==e&&i++;t=t.get("replys");t&&0<t.length&&t.forEach(function(t){t.get("userid")==e&&i++})}),i}})}),define("text!common/main/lib/template/Comments.template",[],function(){return'<% if (!hide && !filtered) { %>\n    <div id="<%= id %>" class="user-comment-item">\n\n        \x3c!-- comment block --\x3e\n\n        <div class="user-name">\n            <div class="color" style="display: inline-block; background-color: <% if (usercolor!==null) { %><%=usercolor%><% } else { %> #cfcfcf <% } %>; " ></div><%= scope.getEncodedName(parsedName) %>\n        </div>\n        <div class="user-date"><%=date%></div>\n        <% if (quote!==null && quote!==\'\') { %>\n        <div class="user-quote"><%=scope.getFixedQuote(quote)%></div>\n        <% } %>\n        <% if (!editText || scope.viewmode) { %>\n            <div oo_editor_input="true" tabindex="-1" class="user-message user-select"><%=scope.pickLink(comment)%></div>\n        <% } else { %>\n            <div class="inner-edit-ct">\n                <textarea class="msg-reply user-select textarea-control" maxlength="maxCommLength"><%=comment%></textarea>\n                <button class="btn normal dlg-btn primary btn-inner-edit" id="id-comments-change">textEdit</button>\n                <button class="btn normal dlg-btn btn-inner-close">textCancel</button>\n            </div>\n        <% } %>\n\n        \x3c!-- replys elements --\x3e\n\n        <% var add_arrow = true; %>\n        <% if (replys.length) { %>\n            <% _.each(replys, function (item, index) { %>\n                <% if (!item.get("hide")) { %>\n                <% if (add_arrow) { add_arrow = false; %>\n                    <div class="reply-arrow img-commonctrl"></div>\n                <% } %>\n                <div class="reply-item-ct" <% if (scope.viewmode && index==replys.length-1) { %>style="padding-bottom: 0;" <% } %>;>\n                    <div class="user-name">\n                        <div class="color" style="display: inline-block; background-color: <% if (item.get("usercolor")!==null) { %><%=item.get("usercolor")%><% } else { %> #cfcfcf <% } %>; " ></div><%= scope.getEncodedName(item.get("parsedName")) %>\n                    </div>\n                    <div class="user-date"><%=item.get("date")%></div>\n                    <% if (!item.get("editText")) { %>\n                        <div oo_editor_input="true" tabindex="-1" class="user-message user-select"><%=scope.pickLink(item.get("reply"))%></div>\n                        <% if (!scope.viewmode) { %>\n                            <div class="btns-reply-ct">\n                            <% if (item.get("editable")) { %>\n                                <div class="btn-edit img-commonctrl" data-value="<%=item.get("id")%>"></div>\n                            <% } %>\n                            <% if (item.get("removable")) { %>\n                                <div class="btn-delete img-commonctrl" data-value="<%=item.get("id")%>"></div>\n                            <% } %>\n                            </div>\n                        <%}%>\n                    <% } else { %>\n                        <div class="inner-edit-ct">\n                            <textarea class="msg-reply textarea-fix user-select textarea-control" maxlength="maxCommLength"><%=item.get("reply")%></textarea>\n                            <button class="btn normal dlg-btn primary btn-inner-edit btn-fix" id="id-comments-change">textEdit</button>\n                            <button class="btn normal dlg-btn btn-inner-close">textClose</button>\n                        </div>\n                    <% } %>\n                </div>\n                <% } %>\n            <% }); %>\n        <% } %>\n\n        \x3c!-- add reply button --\x3e\n\n        <% if (!showReply && !scope.viewmode) { %>\n            <% if (replys.length && !add_arrow) { %>\n                <label class="user-reply with-reply" role="presentation" tabindex="-1">textAddReply</label>\n            <% } else { %>\n                <label class="user-reply" role="presentation" tabindex="-1">textAddReply</label>\n            <% } %>\n        <% } %>\n\n        \x3c!-- edit buttons --\x3e\n\n        <% if (!editText && !lock) { %>\n            <div class="edit-ct">\n                <% if (!scope.viewmode) { %>\n                    <% if (editable) { %>\n                        <div class="btn-edit img-commonctrl"></div>\n                    <% } %>\n                    <% if (removable) { %>\n                        <div class="btn-delete img-commonctrl"></div>\n                    <% } %>\n                <% } %>\n                <% if (editable && !scope.viewmode) { %>\n                    <div class="btn-resolve <% if (resolved) print(\'comment-resolved\') %>" data-toggle="tooltip"></div>\n                <% } else if ((!editable || scope.viewmode) && resolved) { %>\n                    <div class="icon-resolve i-comment-resolved" data-toggle="tooltip"></div>\n                <% } %>\n            </div>\n        <% } %>\n\n        \x3c!-- reply --\x3e\n\n        <% if (showReply) { %>\n            <div class="reply-ct">\n                <textarea class="msg-reply user-select textarea-control" placeholder="textAddReply" maxlength="maxCommLength"></textarea>\n                <button class="btn normal dlg-btn primary btn-reply" id="id-comments-change">textReply</button>\n                <button class="btn normal dlg-btn btn-close">textClose</button>\n            </div>\n        <% } %>\n        <% if (lock) { %>\n            <div class="lock-area"></div>\n            <div class="lock-author"><%=lockuserid%></div>\n        <% } %>\n        <% if (!last) { %>\n            <div class="separator-cmt"></div>\n        <% } %>\n    </div>\n<% } %>\n'}),define("text!common/main/lib/template/CommentsPanel.template",[],function(){return'<div id="comments-box" class="layout-ct vbox">\n    <div class="layout-item messages-ct"></div>\n    <div class="layout-item add-link-ct">\n        <label id="add-comment-doc" class="btn new" data-hint="1" data-hint-direction="bottom" data-hint-offset="medium"><%=textAddCommentToDoc%></label>\n    </div>\n    <div style="display: none;" class="layout-item new-comment-ct">\n        <div class="inner-ct">\n            <textarea id="comment-msg-new" class="user-select textarea-control" placeholder="<%=textEnterCommentHint%>" maxlength="<%=maxCommLength%>" data-hint="1" data-hint-direction="left-top"></textarea>\n        </div>\n        <button class="btn add normal dlg-btn primary" data-hint="1" data-hint-direction="bottom" data-hint-offset="big" style="width: auto;min-width: 86px;"><%=textAddComment%></button>\n        <button class="btn cancel normal dlg-btn" data-hint="1" data-hint-direction="bottom" data-hint-offset="big" style="width: auto;min-width: 86px;"><%=textCancel%></button>\n    </div>\n    <div id="comments-header" class="">\n        <label><%=textComments%></label>\n        <div id="comments-btn-close" class="float-right margin-left-4"></div>\n        <div id="comments-btn-sort" class="float-right"></div>\n    </div>\n</div>\n'}),void 0===Common&&(Common={}),Common.Views=Common.Views||{},define("common/main/lib/view/Comments",["text!common/main/lib/template/Comments.template","text!common/main/lib/template/CommentsPanel.template","common/main/lib/util/utils","common/main/lib/component/Button","common/main/lib/component/ComboBox","common/main/lib/component/DataView","common/main/lib/component/Layout","common/main/lib/component/Window"],function(e,t){"use strict";var i=Common.UI.DataView.extend({options:{handleSelect:!1,scrollable:!0,listenStoreEvents:!1,template:_.template('<div class="dataview-ct inner"></div>')},getTextBox:function(){var t=$(this.el).find("textarea");return t&&t.length?t:void 0},setFocusToTextBox:function(){var t,e=$(this.el).find("textarea");e&&e.length&&(t=e.val(),e.focus(),e.val(""),e.val(t))},getActiveTextBoxVal:function(){var t=$(this.el).find("textarea");return t&&t.length?t.val().trim():""},disableTextBoxButton:function(t){var e=$(t.siblings("#id-comments-change")[0]);0<t.val().trim().length?(e.removeAttr("disabled"),e.removeClass("disabled")):(e.attr("disabled",!0),e.addClass("disabled"))},autoHeightTextBox:function(){var e=this,t=$(this.el).find("textarea"),i=null,n=55,o=0,s=0,a=0;function l(){i.scrollHeight>i.clientHeight?t.css({height:i.scrollHeight+o+"px"}):(s=i.clientHeight,n<=s&&(t.css({height:n+"px"}),i.scrollHeight>i.clientHeight&&(a=Math.max(i.scrollHeight+o,n),t.css({height:a+"px"})))),e.autoScrollToEditButtons()}t&&t.length&&(i=t.get(0),e.disableTextBoxButton(t),i&&(o=.25*parseInt(t.css("lineHeight"),10),l(),t.bind("input propertychange",function(t){l(),e.disableTextBoxButton($(t.target))}))),this.textBox=t},clearTextBoxBind:function(){this.textBox&&(this.textBox.unbind("input propertychange"),this.textBox=void 0)},autoScrollToEditButtons:function(){var t=$("#id-comments-change"),e=this.el.getBoundingClientRect();t.length&&(t=t.get(0).getBoundingClientRect())&&e&&(e=e.bottom-(t.bottom+7))<0&&this.scroller.scrollTop(this.scroller.getScrollTop()-e)}});Common.Views.Comments=Common.UI.BaseView.extend(_.extend({el:"#left-panel-comments",template:_.template(t),addCommentHeight:45,newCommentHeight:110,textBoxAutoSizeLocked:void 0,viewmode:!1,_commentsViewOnItemClick:function(t,e,i,n){var o,s,a,l,r=this;function c(){r.update()}(n=$(n.target))&&(o=i.get("editText"),s=i.get("showReply"),a=i.get("uid"),l=n.attr("data-value"),n.hasClass("btn-edit")?_.isUndefined(l)?o||(r.fireEvent("comment:closeEditing"),i.set("editText",!0),t.autoHeightTextBox(),c(),t.setFocusToTextBox(),r.hookTextBox()):(r.fireEvent("comment:closeEditing",[a]),r.fireEvent("comment:editReply",[a,l]),r.commentsView.reply=l,t.autoHeightTextBox(),c(),r.hookTextBox(),t.autoScrollToEditButtons(),t.setFocusToTextBox()):n.hasClass("btn-delete")?(_.isUndefined(l)?(r.fireEvent("comment:remove",[a]),Common.NotificationCenter.trigger("edit:complete",r)):r.fireEvent("comment:removeReply",[a,l]),r.fireEvent("comment:closeEditing"),c()):n.hasClass("user-reply")?(r.fireEvent("comment:closeEditing"),i.set("showReply",!0),c(),t.autoHeightTextBox(),r.hookTextBox(),t.autoScrollToEditButtons(),t.setFocusToTextBox()):n.hasClass("btn-reply",!1)?s&&(r.fireEvent("comment:addReply",[a,t.getActiveTextBoxVal()]),r.fireEvent("comment:closeEditing"),c()):n.hasClass("btn-close",!1)?r.fireEvent("comment:closeEditing",[a]):n.hasClass("btn-inner-edit",!1)?(_.isUndefined(r.commentsView.reply)?o&&r.fireEvent("comment:change",[a,t.getActiveTextBoxVal()]):(r.fireEvent("comment:changeReply",[a,r.commentsView.reply,t.getActiveTextBoxVal()]),r.commentsView.reply=void 0),r.fireEvent("comment:closeEditing"),c()):n.hasClass("btn-inner-close",!1)?(r.fireEvent("comment:closeEditing"),r.commentsView.reply=void 0,c()):n.hasClass("btn-resolve",!1)?((l=n.data("bs.tooltip"))&&(l.dontShow=!0),r.fireEvent("comment:resolve",[a]),c()):n.hasClass("msg-reply")||n.hasClass("btn-resolve")||(i=!1,n.hasClass("user-message")&&(window.getSelection?i=""!==window.getSelection().toString():document.selection&&(i=document.selection)),r.fireEvent("comment:show",[a,!1,i])))},initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t),this.store=this.options.store;t=Common.localStorage.getKeysFilter();this.appPrefix=t&&t.length?t.split(",")[0]:""},render:function(){var t,s=this;return this.rendered||(this.$el.html(this.template({textAddCommentToDoc:s.textAddCommentToDoc,textAddComment:s.textAddComment,textCancel:s.textCancel,textEnterCommentHint:s.textEnterCommentHint,maxCommLength:Asc.c_oAscMaxCellOrCommentLength,textComments:s.textComments})),this.buttonAddCommentToDoc=new Common.UI.Button({el:$(".btn.new",this.$el),enableToggle:!1}),this.buttonAdd=new Common.UI.Button({action:"add",el:$(".btn.add",this.$el),enableToggle:!1}),this.buttonCancel=new Common.UI.Button({el:$(".btn.cancel",this.$el),enableToggle:!1}),this.buttonSort=new Common.UI.Button({parentEl:$("#comments-btn-sort",this.$el),cls:"btn-toolbar",iconCls:"toolbar__icon btn-sorting",hint:this.textSort,menu:new Common.UI.Menu({menuAlign:"tr-br",style:"min-width: auto;",items:[{caption:this.mniDateDesc,value:"date-desc",checkable:!0,checked:"date-desc"===(Common.localStorage.getItem(this.appPrefix+"comments-sort")||"date-desc"),toggleGroup:"sortcomments"},{caption:this.mniDateAsc,value:"date-asc",checkable:!0,checked:"date-asc"===(Common.localStorage.getItem(this.appPrefix+"comments-sort")||"date-desc"),toggleGroup:"sortcomments"},{caption:this.mniAuthorAsc,value:"author-asc",checkable:!0,checked:"author-asc"===Common.localStorage.getItem(this.appPrefix+"comments-sort"),toggleGroup:"sortcomments"},{caption:this.mniAuthorDesc,value:"author-desc",checkable:!0,checked:"author-desc"===Common.localStorage.getItem(this.appPrefix+"comments-sort"),toggleGroup:"sortcomments"},{caption:this.mniPositionAsc,value:"position-asc",checkable:!0,visible:"de-"===this.appPrefix,checked:"position-asc"===Common.localStorage.getItem(this.appPrefix+"comments-sort"),toggleGroup:"sortcomments"},{caption:this.mniPositionDesc,value:"position-desc",checkable:!0,visible:"de-"===this.appPrefix,checked:"position-desc"===Common.localStorage.getItem(this.appPrefix+"comments-sort"),toggleGroup:"sortcomments"},{caption:"--",visible:!1},this.menuFilterGroups=new Common.UI.MenuItem({caption:this.mniFilterGroups,checkable:!1,visible:!1,menu:new Common.UI.Menu({menuAlign:"tl-tr",style:"min-width: auto;",items:[]})})]})}),this.buttonClose=new Common.UI.Button({parentEl:$("#comments-btn-close",this.$el),cls:"btn-toolbar",iconCls:"toolbar__icon btn-close",hint:this.textClosePanel}),this.buttonAddCommentToDoc.on("click",_.bind(this.onClickShowBoxDocumentComment,this)),this.buttonAdd.on("click",_.bind(this.onClickAddDocumentComment,this)),this.buttonCancel.on("click",_.bind(this.onClickCancelDocumentComment,this)),this.buttonClose.on("click",_.bind(this.onClickClosePanel,this)),this.buttonSort.menu.on("item:toggle",_.bind(this.onSortClick,this)),this.menuFilterGroups.menu.on("item:toggle",_.bind(this.onFilterGroupsClick,this)),this.txtComment=$("#comment-msg-new",this.el),this.scrollerNewCommet=new Common.UI.Scroller({el:$(".new-comment-ct")}),this.txtComment.keydown(function(t){var e,i,n;!t.ctrlKey&&!t.metaKey||t.altKey||t.keyCode!=Common.UI.Keys.RETURN?t.keyCode===Common.UI.Keys.TAB&&(e=this.selectionStart,i=this.selectionEnd,(n=$(this)).val(n.val().substring(0,e)+"\t"+n.val().substring(i)),this.selectionStart=this.selectionEnd=e+1,t.stopImmediatePropagation(),t.preventDefault()):(s.onClickAddDocumentComment(),t.stopImmediatePropagation())})),this.commentsView?this.commentsView.onResetItems():(this.commentsView=new i({el:$(".messages-ct",s.el),store:s.store,itemTemplate:_.template(function(t,e){var i,n,o=t;for(i in e)void 0!==i&&(n=e[i],o=o.replace(new RegExp(i,"g"),n));return o}(e,{textAddReply:s.textAddReply,textAdd:s.textAdd,textCancel:s.textCancel,textEdit:s.textEdit,textReply:s.textReply,textClose:s.textClose,maxCommLength:Asc.c_oAscMaxCellOrCommentLength})),emptyText:s.txtEmpty}),this.commentsView.on({"item:add":t=function(t,e,i){e.tipsArray&&e.tipsArray.forEach(function(t){t.remove()});var n=[],o=$(e.el).find(".btn-resolve:not(.comment-resolved)");o.tooltip({title:s.textResolve,placement:"cursor"}),o.each(function(t,e){n.push($(e).data("bs.tooltip").tip())}),(o=$(e.el).find(".comment-resolved")).tooltip({title:s.textOpenAgain,placement:"cursor"}),o.each(function(t,e){n.push($(e).data("bs.tooltip").tip())}),(o=$(e.el).find(".i-comment-resolved")).tooltip({title:s.textViewResolved,placement:"cursor"}),o.each(function(t,e){n.push($(e).data("bs.tooltip").tip())}),e.tipsArray=n},"item:remove":t,"item:change":t,"item:click":this._commentsViewOnItemClick.bind(this)})),this.rendered||this.setupLayout(),this.update(),this.rendered=!0,this},update:function(){this.updateLayout(),this.updateScrolls()},updateScrolls:function(){this.commentsView&&this.commentsView.scroller&&this.commentsView.scroller.update({minScrollbarLength:this.commentsView.minScrollbarLength,alwaysVisibleY:!0})},showEditContainer:function(t){var e=$(".add-link-ct",this.el),i=$(".new-comment-ct",this.el);$(".messages-ct",this.el),$("#comments-box",this.el);this.layout.freezePanels(!t),t?(e.css({display:"none"}),i.css({display:"table-row"}),this.txtComment.val(""),this.txtComment.focus(),this.textBoxAutoSizeLocked=void 0):(e.css({display:"table-row"}),i.css({display:"none"})),this.updateLayout(),this.updateScrolls()},onClickShowBoxDocumentComment:function(){this.fireEvent("comment:closeEditing"),this.showEditContainer(!0)},onClickAddDocumentComment:function(){this.fireEvent("comment:add",[this,this.txtComment.val().trim(),void 0,!1,!0]),this.txtComment.val("")},onClickCancelDocumentComment:function(){this.showEditContainer(!1)},saveText:function(t){this.commentsView&&this.commentsView.cmpEl.find(".lock-area").length<1&&(this.textVal=void 0,t?this.commentsView.clearTextBoxBind():this.textVal=this.commentsView.getActiveTextBoxVal())},loadText:function(){var t;this.textVal&&this.commentsView&&((t=this.commentsView.getTextBox())&&t.val(this.textVal))},hookTextBox:function(){var t=this.commentsView.getTextBox();t&&t.keydown(function(t){var e,i,n;!t.ctrlKey&&!t.metaKey||t.altKey||t.keyCode!=Common.UI.Keys.RETURN?t.keyCode===Common.UI.Keys.TAB&&(e=this.selectionStart,i=this.selectionEnd,(n=$(this)).val(n.val().substring(0,e)+"\t"+n.val().substring(i)),this.selectionStart=this.selectionEnd=e+1,t.stopImmediatePropagation(),t.preventDefault()):((n=$("#id-comments-change"))&&n.length&&n.click(),t.stopImmediatePropagation())})},setupLayout:function(){var n=this,o=n.$el,e=$(".new-comment-ct",n.el),i=($(".add-link-ct",n.el),$("#comments-box",n.el)),t=i.find(" > .layout-item");n.layout=new Common.UI.VBoxLayout({box:i,freeze:!0,items:[{el:t[0],rely:!0,resize:{hidden:!1,autohide:!1,fmin:function(){var t=i.height();return"none"!==e.css("display")&&.5*t<n.newCommentHeight?t-n.newCommentHeight:.5*t},fmax:function(){return"none"!==e.css("display")?i.height()-n.newCommentHeight:i.height()-n.addCommentHeight}}},{el:t[1],stretch:!0},{el:t[2],stretch:!0}]}),n.layout.on("layout:resizedrag",function(){n.updateScrolls(),n.textBoxAutoSizeLocked=!0},this),$(window).on("resize",function(){var t,e,i;"none"!==o.css("display")&&(t=$("#comments-box",n.el).height(),e=$(".new-comment-ct",n.el),i=$(".add-link-ct",n.el),"none"!==e.css("display")?n.layout.setResizeValue(0,Math.max(-n.newCommentHeight,Math.min(t-(e.height()+4),t-n.newCommentHeight))):n.layout.setResizeValue(0,Math.max(-n.addCommentHeight,Math.min(t-i.height(),t-n.addCommentHeight))),n.updateScrolls())}),this.autoHeightTextBox()},changeLayout:function(t){var e,i=this,n=$(".new-comment-ct",this.el),o=$(".add-link-ct",this.el),s=$(".messages-ct",this.el);s.toggleClass("stretch",!t.canComments||t.compatibleFeatures),!t.canComments||t.compatibleFeatures?(t.compatibleFeatures?(n.remove(),o.remove()):(n.hide(),o.hide()),this.layout.changeLayout([{el:s[0],rely:!1,stretch:!0}])):(t=(e=$("#comments-box",this.el)).find(" > .layout-item"),o.show(),this.layout.changeLayout([{el:t[0],rely:!0,resize:{hidden:!1,autohide:!1,fmin:function(){var t=e.height();return"none"!==n.css("display")&&.5*t<i.newCommentHeight?t-i.newCommentHeight:.5*t},fmax:function(){return"none"!==n.css("display")?e.height()-i.newCommentHeight:e.height()-i.addCommentHeight}}},{el:t[1],stretch:!0},{el:t[2],stretch:!0}]))},updateLayout:function(){var t=$("#comments-box",this.el);"none"!==$(".new-comment-ct",this.el).css("display")?this.layout.setResizeValue(0,t.height()-this.newCommentHeight):this.layout.setResizeValue(0,t.height()-this.addCommentHeight)},disableTextBoxButton:function(t){var e=$(t.parent().siblings(".add")[0]);0<t.val().trim().length?(e.removeAttr("disabled"),e.removeClass("disabled")):(e.attr("disabled",!0),e.addClass("disabled"))},autoHeightTextBox:function(){var n=this,o=0,s=44,t=$("#comment-msg-new",this.el);function e(){var t,e=$("#comment-msg-new",n.el),i=$("#comments-box",n.el).height();0==e.val().length?(n.layout.setResizeValue(0,Math.max(-n.newCommentHeight,i-n.newCommentHeight)),n.textBoxAutoSizeLocked=void 0):_.isUndefined(n.textBoxAutoSizeLocked)&&(e.height(),e.get(0).scrollHeight,e.css({height:s+"px"}),e.height(),t=Math.max(e.get(0).scrollHeight+o,48),e.css({height:"100%"}),i=$("#comments-box",n.el).height(),n.layout.setResizeValue(0,Math.max(-n.newCommentHeight,Math.min(i-t-48,i-n.newCommentHeight))))}t.length<1||(n.disableTextBoxButton(t),o=.25*parseInt(t.css("lineHeight"),10),e(),t.bind("input propertychange",function(t){e(),n.disableTextBoxButton($(t.target))}),this.textBox=t)},getFixedQuote:function(t){return Common.Utils.String.ellipsis(Common.Utils.String.htmlEncode(t),120,!0)},getUserName:function(t){return Common.Utils.String.htmlEncode(AscCommon.UserInfoParser.getParsedName(t))},getEncodedName:function(t){return Common.Utils.String.htmlEncode(t)},pickLink:function(t){for(var i,n,o=[],e=(t.replace(Common.Utils.ipStrongRe,function(t){var e=/[\.,\?\+;:=!\(\)]+$/.exec(t);return e&&(t=t.substring(0,e.index)),i=arguments[arguments.length-2],o.push({start:i,end:t.length+i,str:'<a href="'+t+'" target="_blank" data-can-copy="true">'+t+"</a>"}),""}),(t.length<1e3||t.search(/\S{255,}/)<0)&&t.replace(Common.Utils.hostnameStrongRe,function(t){var e=/[\.,\?\+;:=!\(\)]+$/.exec(t),e=(e&&(t=t.substring(0,e.index)),/(((^https?)|(^ftp)):\/\/)/i.test(t)?t:"http://"+t);return i=arguments[arguments.length-2],n=t.length,_.find(o,function(t){return i>=t.start&&i<t.end||i<=t.start&&i+n>t.start})||o.push({start:i,end:n+i,str:'<a href="'+e+'" target="_blank" data-can-copy="true">'+t+"</a>"}),""}),t.replace(Common.Utils.emailStrongRe,function(t){var e=/((^mailto:)\/\/)/i.test(t)?t:"mailto:"+t;return i=arguments[arguments.length-2],n=t.length,_.find(o,function(t){return i>=t.start&&i<t.end||i<=t.start&&i+n>t.start})||o.push({start:i,end:n+i,str:'<a href="'+e+'">'+t+"</a>"}),""}),0<(o=_.sortBy(o,function(t){return t.start})).length?Common.Utils.String.htmlEncode(t.substring(0,o[0].start))+o[0].str:Common.Utils.String.htmlEncode(t)),s=1;s<o.length;s++)e+=Common.Utils.String.htmlEncode(t.substring(o[s-1].end,o[s].start))+o[s].str;return 0<o.length&&(e+=Common.Utils.String.htmlEncode(t.substring(o[s-1].end,t.length))),e},pickEMail:function(t,e,i){var n=[],i=(i&&(n=Common.Utils.String.htmlEncode(i).match(/\B[@+][A-Z0-9._%+-]+@[A-Z0-9._-]+\.[A-Z]+\b/gi),n=_.map(n,function(t){return t.slice(1,t.length)})),Common.Utils.String.htmlEncode(e).match(/\B[@+][A-Z0-9._%+-]+@[A-Z0-9._-]+\.[A-Z]+\b/gi)),i=_.map(i,function(t){return t.slice(1,t.length)});0<(i=_.difference(i,n)).length&&Common.Gateway.requestSendNotify({emails:i,actionId:t,actionLink:{action:{type:"comment",data:t}},message:e})},onSortClick:function(t,e,i){i&&this.fireEvent("comment:sort",[e.value])},onFilterGroupsClick:function(t,e,i){i&&this.fireEvent("comment:filtergroups",[e.value])},onClickClosePanel:function(){Common.NotificationCenter.trigger("leftmenu:change","hide")}},Common.Views.Comments||{}))}),define("text!common/main/lib/template/CommentsPopover.template",[],function(){return'<% if (!hide) { %>\n<div id="<%=id%>" class="user-comment-item">\n\n    \x3c!-- comment block --\x3e\n\n    <div class="user-name">\n        <div class="color" style="display: inline-block; background-color: <% if (usercolor!==null) { %><%=usercolor%><% } else { %> #cfcfcf <% } %>; " ></div><%= scope.getEncodedName(parsedName) %>\n    </div>\n    <div class="user-date"><%=date%></div>\n    <% if (!editTextInPopover || (hint && !fullInfoInHint) || scope.viewmode) { %>\n        <div oo_editor_input="true" tabindex="-1" class="user-message user-select"><%=scope.pickLink(comment)%></div>\n    <% } else { %>\n        <div class="inner-edit-ct">\n            <textarea class="msg-reply user-select" maxlength="maxCommLength" spellcheck="false" <% if (!!dummy) { %> placeholder="textMentionComment"<% } %>><%=comment%></textarea>\n            <% if (hideAddReply) { %>\n                <button class="btn normal dlg-btn primary btn-inner-edit" id="id-comments-change-popover">textAdd</button>\n            <% } else { %>\n                <button class="btn normal dlg-btn primary btn-inner-edit" id="id-comments-change-popover">textEdit</button>\n            <% } %>\n            <button class="btn normal dlg-btn btn-inner-close">textCancel</button>\n        </div>\n    <% } %>\n\n    \x3c!-- replys elements --\x3e\n\n    <% var add_arrow = true; %>\n    <% if (replys.length) { %>\n        <% _.each(replys, function (item) { %>\n            <% if (!item.get("hide")) { %>\n            <% if (add_arrow) { add_arrow = false; %>\n                <div class="reply-arrow img-commonctrl"></div>\n            <% } %>\n            <div class="reply-item-ct">\n                <div class="user-name">\n                    <div class="color" style="display: inline-block; background-color: <% if (item.get("usercolor")!==null) { %><%=item.get("usercolor")%><% } else { %> #cfcfcf <% } %>; " ></div><%= scope.getEncodedName(item.get("parsedName")) %>\n                </div>\n                <div class="user-date"><%=item.get("date")%></div>\n                <% if (!item.get("editTextInPopover")) { %>\n                    <div oo_editor_input="true" tabindex="-1" class="user-message user-select"><%=scope.pickLink(item.get("reply"))%></div>\n                    <% if ((fullInfoInHint || !hint) && !scope.viewmode) { %>\n                        <div class="btns-reply-ct">\n                            <% if (item.get("editable")) { %>\n                                <div class="btn-edit img-commonctrl" data-value="<%=item.get("id")%>"></div>\n                            <%}%>\n                            <% if (item.get("removable")) { %>\n                               <div class="btn-delete img-commonctrl" data-value="<%=item.get("id")%>"></div>\n                            <%}%>\n                        </div>\n                    <%}%>\n                <% } else { %>\n                    <div class="inner-edit-ct">\n                        <textarea class="msg-reply textarea-fix user-select" maxlength="maxCommLength" spellcheck="false"><%=item.get("reply")%></textarea>\n                        <button class="btn normal dlg-btn primary btn-inner-edit btn-fix" id="id-comments-change-popover">textEdit</button>\n                        <button class="btn normal dlg-btn btn-inner-close">textClose</button>\n                    </div>\n                <% } %>\n            </div>\n            <% } %>\n        <% }); %>\n    <% } %>\n\n    \x3c!-- add reply button --\x3e\n\n    <% if (!showReplyInPopover && !hideAddReply && (fullInfoInHint || !hint) && !scope.viewmode) { %>\n        <% if (replys.length && !add_arrow) { %>\n            <label class="user-reply with-reply" role="presentation" tabindex="-1">textAddReply</label>\n        <% } else { %>\n            <label class="user-reply" role="presentation" tabindex="-1">textAddReply</label>\n        <% } %>\n    <% } %>\n\n    \x3c!-- edit buttons --\x3e\n\n    <% if (!editTextInPopover && !lock) { %>\n        <div class="edit-ct">\n            <% if ((fullInfoInHint || !hint) && !scope.viewmode) { %>\n                <% if (editable) { %>\n                    <div class="btn-edit img-commonctrl"></div>\n                <% } %>\n                <% if (removable) { %>\n                    <div class="btn-delete img-commonctrl"></div>\n                <% } %>\n            <% } %>\n            <% if (editable && (fullInfoInHint || !hint) && !scope.viewmode) { %>\n                <div class="btn-resolve <% if (resolved) print(\'comment-resolved\') %>" data-toggle="tooltip"></div>\n            <% } else if ((fullInfoInHint || !hint) && (!editable || scope.viewmode) && resolved) { %>\n                <div class="icon-resolve i-comment-resolved" data-toggle="tooltip"></div>\n            <% } %>\n        </div>\n    <% } %>\n\n    \x3c!-- reply --\x3e\n\n    <% if (showReplyInPopover) { %>\n        <div class="reply-ct">\n            <textarea class="msg-reply user-select" placeholder="textMentionReply" maxlength="maxCommLength" spellcheck="false"></textarea>\n            <button class="btn normal dlg-btn primary btn-reply" id="id-comments-change-popover">textReply</button>\n            <button class="btn normal dlg-btn btn-close">textClose</button>\n        </div>\n    <% } %>\n\n    \x3c!-- locked user --\x3e\n\n    <% if (lock) { %>\n        <div class="lock-area" style="cursor: default;"></div>\n        <div class="lock-author" style="cursor: default;"><%=lockuserid%></div>\n    <% } %>\n\n</div>\n<% } %>'}),define("text!common/main/lib/template/ReviewChangesPopover.template",[],function(){return'<div id="<%=id%>" class="user-comment-item">\n    <div class="user-name">\n        <div class="color" style="display: inline-block; background-color: <% if (usercolor!==null) { %><%=usercolor%><% } else { %> #cfcfcf <% } %>; " ></div><%= scope.getUserName(username) %>\n    </div>\n    <div class="user-date"><%=date%></div>\n    <div class="user-message limit-height"><%=changetext%></div>\n    <div class="edit-ct">\n        <% if (goto) { %>\n        <div class="btn-goto img-commonctrl"></div>\n        <% } %>\n        <% if (!hint) { %>\n            <% if (scope.appConfig.isReviewOnly || docProtection.isReviewOnly) { %>\n                <% if (editable) { %>\n                <div class="btn-delete img-commonctrl"></div>\n                <% } %>\n            <% } else if (editable) { %>\n            <div class="btn-accept"></div>\n            <div class="btn-reject tool "></div>\n            <% } %>\n        <% } %>\n    </div>\n    <% if (!hint && lock) { %>\n    <div class="lock-area" style="cursor: default;"></div>\n    <div class="lock-author" style="cursor: default;"><%=lockuser%></div>\n    <% } %>\n</div>'}),void 0===Common&&(Common={}),Common.Views=Common.Views||{},define("common/main/lib/view/ReviewPopover",["text!common/main/lib/template/CommentsPopover.template","text!common/main/lib/template/ReviewChangesPopover.template","common/main/lib/util/utils","common/main/lib/component/Button","common/main/lib/component/ComboBox","common/main/lib/component/DataView","common/main/lib/component/Layout","common/main/lib/component/Window"],function(s,a){"use strict";Common.Views.ReviewPopover=Common.UI.Window.extend(_.extend({initialize:function(t){var e={};return _.extend(e,{closable:!1,width:265,height:120,header:!1,modal:!1,automove:!1,alias:"Common.Views.ReviewPopover"},t),this.template=t.template||['<div class="box">','<div id="id-popover" class="comments-popover" style="overflow-y: hidden;position: relative;">','<div id="id-review-popover"></div>','<div id="id-comments-popover"></div>',"</div>",'<div id="id-comments-arrow" class="comments-arrow"></div>',"</div>"].join(""),this.commentsStore=t.commentsStore,this.reviewStore=t.reviewStore,this.canRequestUsers=t.canRequestUsers,this.canRequestSendNotify=t.canRequestSendNotify,this.mentionShare=t.mentionShare,this.api=t.api,this._state={commentsVisible:!1,reviewVisible:!1},e.tpl=_.template(this.template)(e),this.arrow={margin:20,width:10,height:30},this.sdkBounds={width:0,height:0,padding:10,paddingTop:20},Common.UI.Window.prototype.initialize.call(this,e),this.canRequestUsers&&Common.NotificationCenter.on("mentions:setusers",_.bind(this.onEmailListMenuCallback,this)),this},render:function(t,e){Common.UI.Window.prototype.render.call(this);var c,i,m=this,n=this.$window,o=(n.css({height:"",minHeight:"",overflow:"hidden",position:"absolute",zIndex:"990"}),n.find(".body")),o=(o&&o.css("position","relative"),Common.UI.DataView.extend((c=m,{options:{handleSelect:!1,allowScrollbar:!1,template:_.template('<div class="dataview-ct inner" style="overflow-y: visible;"></div>')},getTextBox:function(){var t=$(this.el).find("textarea");return t&&t.length?t:void 0},setFocusToTextBox:function(t){var e=$(this.el).find("textarea");t?e.blur():e&&e.length&&(t=e.val(),e.focus(),e.val(""),e.val(t))},getActiveTextBoxVal:function(){var t=$(this.el).find("textarea");return t&&t.length?t.val().trim():""},disableTextBoxButton:function(t){var e=$(t.siblings("#id-comments-change-popover")[0]);0<t.val().trim().length?(e.removeAttr("disabled"),e.removeClass("disabled")):(e.attr("disabled",!0),e.addClass("disabled"))},autoHeightTextBox:function(){var e=this,t=this.$el.find("textarea"),i=null,n=55,o=0,s=0,a=0,l=0;function r(){s=c.scroller.getScrollTop(),i.scrollHeight>i.clientHeight?i.clientHeight+2<parseInt($(i).css("max-height"))&&(t.css({height:i.scrollHeight+o+"px"}),c.calculateSizeOfContent()):(a=i.clientHeight,n<=a&&(t.css({height:n+"px"}),i.scrollHeight>i.clientHeight&&(l=Math.max(i.scrollHeight+o,n),t.css({height:l+"px"})),c.calculateSizeOfContent(),c.setLeftTop(m.arrowPosX,m.arrowPosY,m.leftX),c.calculateSizeOfContent())),c.scroller.scrollTop(s),c.autoScrollToEditButtons()}t&&t.length&&c.scroller&&(i=t.get(0),e.disableTextBoxButton(t),i&&(o=.25*parseInt(t.css("lineHeight"),10),r(),t.bind("input propertychange",function(t){r(),e.disableTextBoxButton($(t.target))}))),this.textBox=t},clearTextBoxBind:function(){this.textBox&&(this.textBox.unbind("input propertychange"),this.textBox=void 0)}}))),o=(o&&(this.commentsView?(this.commentsView.render($("#id-comments-popover")),this.commentsView.onResetItems()):(this.commentsView=new o({el:$("#id-comments-popover"),itemTemplate:_.template(function(t,e){var i,n,o=t;for(i in e)void 0!==i&&(n=e[i],o=o.replace(new RegExp(i,"g"),n));return o}(s,{textAddReply:m.textAddReply,textMentionReply:m.canRequestSendNotify?m.mentionShare?m.textMention:m.textMentionNotify:m.textAddReply,textAdd:m.textAdd,textCancel:m.textCancel,textEdit:m.textEdit,textReply:m.textReply,textClose:m.textClose,maxCommLength:Asc.c_oAscMaxCellOrCommentLength,textMentionComment:m.canRequestSendNotify?m.mentionShare?m.textMention:m.textMentionNotify:m.textEnterComment}))}),this.commentsView.on("item:add",i=function(t,e,i){e.tipsArray&&e.tipsArray.forEach(function(t){t.remove()});var n=[],o=$(e.el).find(".btn-resolve:not(.comment-resolved)");o.tooltip({title:m.textResolve,placement:"cursor"}),o.each(function(t,e){n.push($(e).data("bs.tooltip").tip())}),(o=$(e.el).find(".comment-resolved")).tooltip({title:m.textOpenAgain,placement:"cursor"}),o.each(function(t,e){n.push($(e).data("bs.tooltip").tip())}),(o=$(e.el).find(".i-comment-resolved")).tooltip({title:m.textViewResolved,placement:"cursor"}),o.each(function(t,e){n.push($(e).data("bs.tooltip").tip())}),(o=$(e.el).find(".btn-edit")).tooltip({title:m.txtEditTip,placement:"cursor"}),o.each(function(t,e){n.push($(e).data("bs.tooltip").tip())}),(o=$(e.el).find(".btn-delete")).tooltip({title:m.txtDeleteTip,placement:"cursor"}),o.each(function(t,e){n.push($(e).data("bs.tooltip").tip())}),e.tipsArray=n,this.autoHeightTextBox()}),this.commentsView.on("item:remove",i),this.commentsView.on("item:change",i),this.commentsView.cmpEl.on("mouseover",function(){m._isMouseOver=!0}).on("mouseout",function(){m._isMouseOver=!1}),this.commentsView.setStore(m.commentsStore),this.commentsView.onResetItems(),this.commentsView.on("item:click",function(t,e,i,n){var o,s,a,l,r,c,d;function h(){m.update()}(n=$(n.target))&&(a=i.get("editTextInPopover"),l=i.get("showReplyInPopover"),r=i.get("hideAddReply"),c=i.get("uid"),d=n.attr("data-value"),i.get("hint")&&(m.fireEvent("comment:disableHint",[i]),!i.get("fullInfoInHint"))||(n.hasClass("btn-edit")?((s=n.data("bs.tooltip"))&&(s.dontShow=!0),_.isUndefined(d)?a||(m.fireEvent("comment:closeEditing"),i.set("editTextInPopover",!0),m.fireEvent("comment:show",[c]),this.autoHeightTextBox(),m.calculateSizeOfContent(),m.setLeftTop(m.arrowPosX,m.arrowPosY,m.leftX),m.calculateSizeOfContent(),h(),m.hookTextBox(),m.autoScrollToEditButtons(),this.setFocusToTextBox()):(m.fireEvent("comment:closeEditing",[c]),m.fireEvent("comment:editReply",[c,d,!0]),this.replyId=d,this.autoHeightTextBox(),m.calculateSizeOfContent(),m.setLeftTop(m.arrowPosX,m.arrowPosY,m.leftX),m.calculateSizeOfContent(),h(),m.hookTextBox(),m.autoScrollToEditButtons(),this.setFocusToTextBox())):n.hasClass("btn-delete")?((s=n.data("bs.tooltip"))&&(s.dontShow=!0),_.isUndefined(d)?m.fireEvent("comment:remove",[c]):(m.fireEvent("comment:removeReply",[c,d]),m.calculateSizeOfContent(),m.setLeftTop(m.arrowPosX,m.arrowPosY,m.leftX),m.calculateSizeOfContent()),m.fireEvent("comment:closeEditing"),h()):n.hasClass("user-reply")?(m.fireEvent("comment:closeEditing"),i.set("showReplyInPopover",!0),m.calculateSizeOfContent(),m.setLeftTop(m.arrowPosX,m.arrowPosY,m.leftX),m.calculateSizeOfContent(),h(),this.autoHeightTextBox(),m.hookTextBox(),m.autoScrollToEditButtons(),this.setFocusToTextBox()):n.hasClass("btn-reply",!1)?l&&(this.clearTextBoxBind(),m.fireEvent("comment:addReply",[c,this.getActiveTextBoxVal()]),m.fireEvent("comment:closeEditing"),m.calculateSizeOfContent(),h()):n.hasClass("btn-close",!1)?(m.fireEvent("comment:closeEditing",[c]),m.calculateSizeOfContent(),m.fireEvent("comment:show",[c]),h()):n.hasClass("btn-inner-edit",!1)?i.get("dummy")?(d=this.getActiveTextBoxVal(),m.clearDummyText(),0<d.length?m.fireEvent("comment:addDummyComment",[d]):(o=m.$window.find("textarea:not(.user-message)"))&&o.length&&setTimeout(function(){o.focus()},10)):(this.clearTextBoxBind(),_.isUndefined(this.replyId)?a&&(m.fireEvent("comment:change",[c,this.getActiveTextBoxVal()]),m.fireEvent("comment:closeEditing"),m.calculateSizeOfContent()):(m.fireEvent("comment:changeReply",[c,this.replyId,this.getActiveTextBoxVal()]),this.replyId=void 0,m.fireEvent("comment:closeEditing")),h()):n.hasClass("btn-inner-close",!1)?i.get("dummy")?(m.clearDummyText(),m.hide()):(r&&0<this.getActiveTextBoxVal().length?(m.saveText(),i.set("hideAddReply",!1),this.getTextBox().val(m.textVal),this.autoHeightTextBox()):(this.clearTextBoxBind(),m.fireEvent("comment:closeEditing",[c])),this.replyId=void 0,m.calculateSizeOfContent(),m.setLeftTop(m.arrowPosX,m.arrowPosY,m.leftX),m.calculateSizeOfContent(),h()):n.hasClass("btn-resolve")&&((s=n.data("bs.tooltip"))&&(s.dontShow=!0),m.fireEvent("comment:resolve",[c]),h())))}),this.emailMenu=new Common.UI.Menu({maxHeight:200,cyclic:!1,cls:"font-size-medium",items:[]}).on("render:after",function(t){this.scroller=new Common.UI.Scroller({el:$(this.el).find(".dropdown-menu "),useKeyboard:this.enableKeyEvents&&!this.handleSelect,minScrollbarLength:40,alwaysVisibleY:!0})}).on("show:after",function(){this.scroller.update({alwaysVisibleY:!0}),m.$window.css({zIndex:"1001"})}).on("hide:after",function(){m.$window.css({zIndex:"990"})}),m.on({show:function(){m.commentsView.autoHeightTextBox(),m.$window.find("textarea").keydown(function(t){t.keyCode==Common.UI.Keys.ESC&&m.hide(!0)})},"animate:before":function(){var t=m.$window.find("textarea");t&&t.length&&(t.focus(),m.commentsView.disableTextBoxButton(t))}}))),Common.UI.DataView.extend({options:{handleSelect:!1,scrollable:!0,template:_.template('<div class="dataview-ct inner" style="overflow-y: visible;"></div>')}}));o&&(this.reviewChangesView?this.reviewChangesView.render($("#id-review-popover")):(this.reviewChangesView=new o({el:$("#id-review-popover"),itemTemplate:_.template(a)}),this.reviewChangesView.on("item:add",i=function(t,e,i){e.tipsArray&&e.tipsArray.forEach(function(t){t.remove()});var n=[],o=$(e.el).find(".btn-goto");o.tooltip({title:m.textFollowMove,placement:"cursor"}),o.each(function(t,e){n.push($(e).data("bs.tooltip").tip())}),(o=$(e.el).find(".btn-accept")).tooltip({title:m.txtAccept,placement:"cursor"}),o.each(function(t,e){n.push($(e).data("bs.tooltip").tip())}),(o=$(e.el).find(".btn-reject")).tooltip({title:m.txtReject,placement:"cursor"}),o.each(function(t,e){n.push($(e).data("bs.tooltip").tip())}),e.tipsArray=n}),this.reviewChangesView.on("item:remove",i),this.reviewChangesView.on("item:change",i),this.reviewChangesView.on("item:click",function(t,e,i,n){var o,n=$(n.target);n&&(n.hasClass("btn-accept")?((o=n.data("bs.tooltip"))&&(o.dontShow=!0),m.fireEvent("reviewchange:accept",[i.get("changedata")])):n.hasClass("btn-reject")?((o=n.data("bs.tooltip"))&&(o.dontShow=!0),m.fireEvent("reviewchange:reject",[i.get("changedata")])):n.hasClass("btn-delete")?m.fireEvent("reviewchange:delete",[i.get("changedata")]):n.hasClass("btn-goto")&&((o=n.data("bs.tooltip"))&&(o.dontShow=!0),m.fireEvent("reviewchange:goto",[i.get("changedata")])))}),this.reviewChangesView.setStore(m.reviewStore)),this.reviewChangesView.onResetItems()),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:n.find("#id-popover"),minScrollbarLength:40,wheelSpeed:10,alwaysVisibleY:!0}))},showComments:function(t,e,i,n){this.options.animate=t;var o=this.commentsView.getTextBox();e&&this.textVal&&o&&o.val(this.textVal),n&&n.length&&o&&o.val(n),this.show(t),this.hookTextBox(),this._state.commentsVisible=!0},showReview:function(t,e,i){this.show(t),this._state.reviewVisible=!0},show:function(t,e,i,n){this.options.animate=t,Common.UI.Window.prototype.show.call(this),this.scroller&&this.scroller.update({minScrollbarLength:40,alwaysVisibleY:!0})},hideComments:function(){this.handlerHide&&this.handlerHide(),this.hideTips(),this._state.commentsVisible=!1,this._state.reviewVisible?this.calculateSizeOfContent():this.hide()},hideReview:function(){this.handlerHide&&this.handlerHide(),this.hideTips(),this._state.reviewVisible=!1,this._state.commentsVisible?this.calculateSizeOfContent():this.hide()},hide:function(){this.handlerHide&&this.handlerHide.apply(this,arguments),this.hideTips(),Common.UI.Window.prototype.hide.call(this),_.isUndefined(this.e)||this.e.keyCode!=Common.UI.Keys.ESC||(this.e.preventDefault(),this.e.stopImmediatePropagation(),this.e=void 0)},update:function(t){this.commentsView&&t&&this.commentsView.onResetItems(),this.scroller&&this.scroller.update({minScrollbarLength:40,alwaysVisibleY:!0})},isVisible:function(){return this.$window&&this.$window.is(":visible")},setLeftTop:function(t,e,i,n,o){var s,a,l,r,c,d,h,m,p,u,g,b,C,f,v,w,y;this.$window||this.render(),n&&(t=this.arrowPosX,e=this.arrowPosY,i=this.leftX),_.isUndefined(t)&&_.isUndefined(e)||(this.arrowPosX=t,this.arrowPosY=e,this.leftX=i,n=$("#id-popover"),s=$("#id-comments-arrow"),a=$("#editor_sdk"),l=null,g=p=h=c="",y=w=v=f=C=b=u=m=d=r=0,n&&s&&a&&a.get(0)&&(l=a.get(0).getBoundingClientRect())&&(r=l.height-2*this.sdkBounds.padding,this.$window.css({maxHeight:r+"px"}),this.sdkBounds.width=l.width,this.sdkBounds.height=l.height,_.isUndefined(t)||(((c=$("#id_vertical_scroll")).length||(c=$("#ws-v-scrollbar")).length)&&(d="none"!==c.css("display")?c.width():0),this.sdkBounds.width-=d,(h=$("#id_panel_left")).length&&(m="none"!==h.css("display")?h.width():0),(p=$("#id_panel_thumbnails")).length&&(u="none"!==p.css("display")?p.width():0,this.sdkBounds.width-=u),C=Common.UI.isRTL()?(C=Math.max(0+m+25,0+this.sdkBounds.width-this.$window.outerWidth()-t+7),Math.min(0+this.sdkBounds.width-this.$window.outerWidth()-25,C)):(C=Math.min(0+t+this.arrow.width,0+this.sdkBounds.width-this.$window.outerWidth()-25),Math.max(0+m+this.arrow.width,C)),s.removeClass("right top bottom").addClass("left"),s.css({left:""}),_.isUndefined(i)||(f=this.$window.outerWidth())&&(t+f>this.sdkBounds.width-this.arrow.width+5&&this.leftX>f||Common.UI.isRTL()&&0+this.leftX>f+this.arrow.width?(C=0+this.leftX-f-this.arrow.width,s.removeClass("left").addClass("right")):C=0+t+this.arrow.width),this.$window.css("left",C+"px")),_.isUndefined(e)||(y=0,(g=$("#id_panel_top")).length?(b="none"!==g.css("display")?g.height():0,y+=this.sdkBounds.paddingTop):(g=$("#ws-h-scrollbar")).length&&(b="none"!==g.css("display")?g.height():0),this.sdkBounds.height-=b,v=this.$window.outerHeight(),w=Math.min(0+r-v,this.arrowPosY+0-this.arrow.height),w=Math.max(w,y),parseInt(s.css("top"))+this.arrow.height>v&&s.css({top:v-this.arrow.height+"px"}),this.$window.css("top",w+"px"))),o&&!this.isOverCursor()||this.calculateSizeOfContent())},calculateSizeOfContent:function(t){var e,i,n,o,s,a,l,r,c,d,h,m,p,u,g,b,C,f;t&&!this.$window.is(":visible")||(this.$window.css({overflow:"hidden"}),t=$("#id-comments-arrow"),C=f=i=null,m="",c=r=h=l=a=s=o=n=0,(e=$("#id-popover"))&&t&&e.get(0)&&(d=this.scroller.getScrollTop(),e.css({height:"100%"}),(i=e.get(0).getBoundingClientRect())&&(f=$("#editor_sdk"))&&f.get(0)&&(C=f.get(0).getBoundingClientRect())&&(n=C.height-2*this.sdkBounds.padding,c=0,l=this.$window.outerHeight(),(m=$("#id_panel_top")).length?(o="none"!==m.css("display")?m.height():0,c+=this.sdkBounds.paddingTop):(m=$("#ws-h-scrollbar")).length&&(o="none"!==m.css("display")?m.height():0),h=Math.max(e.outerHeight(),this.$window.outerHeight()),(f=this.isOverCursor())?(C=parseInt(this.$window.css("left"))-this.arrow.width,m=f[1][1]+o+this.arrow.width,p=f[0][1]+o-this.arrow.width,u=!1,0+n<m+h?(g=0+n-m,p-h<0?g<.9*(b=p)?(this.$window.css({maxHeight:b+"px",top:"0px"}),e.css({height:b-3+"px"})):(this.$window.css({maxHeight:g+"px",top:m+"px"}),u=!0,e.css({height:g-3+"px"})):this.$window.css("top",p-h+"px")):(u=!0,this.$window.css("top",m+"px")),C-=this.arrow.height,this.$window.css("left",C+"px"),a=f[u?1:0][0],a=Math.max(0,a-C-this.arrow.height/2),a=Math.min(a,this.$window.outerWidth()-this.arrow.height),t.css({top:"",left:a+"px"}),t.toggleClass("top",u),t.toggleClass("bottom",!u),t.removeClass("left right")):n<=h?(this.$window.css({maxHeight:n-o+"px",top:0+o+"px"}),e.css({height:n-o-3+"px"}),s=Math.min(s,n-(o+this.arrow.margin+this.arrow.height)),t.css({top:s+"px",left:""}),t.removeClass("top bottom right"),t.addClass("left"),this.scroller.scrollTop(d)):(0<(h=l)&&(i.top+h>0+n||0===i.height)&&(r=Math.min(0+n-h,this.arrowPosY+0-this.arrow.height),r=Math.max(r,c),this.$window.css({top:r+"px"})),s=Math.max(this.arrow.margin,this.arrowPosY-(n-h)-this.arrow.height),s=Math.min(s,h-this.arrow.margin-this.arrow.height),t.css({top:s+"px",left:""}),t.removeClass("top bottom right"),t.addClass("left")))),this.$window.css({overflow:""}),this.scroller&&this.scroller.update({minScrollbarLength:40,alwaysVisibleY:!0}))},isOverCursor:function(){var t,e,i,n,o,s,a,l;if(this.api.asc_GetSelectionBounds)return n=this.api.asc_GetSelectionBounds(),o=Math.abs(n[0][0]-n[1][0])<.1&&Math.abs(n[0][1]-n[1][1])<.1&&Math.abs(n[2][0]-n[3][0])<.1&&Math.abs(n[2][1]-n[3][1])<.1,i=0,(t=$("#id_panel_left")).length&&(i="none"!==t.css("display")?t.width():0),t=n[0][0]+i,e=n[0][1],i=n[o?2:1][0]+i,n=n[o?2:1][1],o=parseInt(this.$window.css("left"))-this.arrow.width,s=this.$window.outerWidth()+this.arrow.width,a=parseInt(this.$window.css("top")),l=this.$window.outerHeight(),o<t&&t<o+s&&a<e&&e<a+l||o<i&&i<o+s&&a<n&&n<a+l?[e<n?[t,e]:[i,n],n<e?[t,e]:[i,n]]:void 0},saveText:function(t){this.commentsView&&this.commentsView.cmpEl.find(".lock-area").length<1&&(this.textVal=void 0,t?this.commentsView.clearTextBoxBind():this.textVal=this.commentsView.getActiveTextBoxVal())},loadText:function(){var t;this.textVal&&this.commentsView&&((t=this.commentsView.getTextBox())&&t.val(this.textVal))},getEditText:function(){if(this.commentsView)return this.commentsView.getActiveTextBoxVal()},saveDummyText:function(){this.commentsView&&this.commentsView.cmpEl.find(".lock-area").length<1&&(this.textDummyVal=this.commentsView.getActiveTextBoxVal())},clearDummyText:function(){var t;this.commentsView&&this.commentsView.cmpEl.find(".lock-area").length<1&&(this.textDummyVal=void 0,(t=this.commentsView.getTextBox())&&t.val(""),this.commentsView.clearTextBoxBind())},getDummyText:function(){return this.textDummyVal||""},hookTextBox:function(){var l=this,t=this.commentsView.getTextBox();t&&t.keydown(function(t){var e,i,n;!t.ctrlKey&&!t.metaKey||t.altKey||t.keyCode!==Common.UI.Keys.RETURN?t.keyCode===Common.UI.Keys.TAB&&(e=this.selectionStart,i=this.selectionEnd,(n=$(this)).val(n.val().substring(0,e)+"\t"+n.val().substring(i)),this.selectionStart=this.selectionEnd=e+1,t.preventDefault()):((n=$("#id-comments-change-popover"))&&n.length&&n.click(),t.stopImmediatePropagation()),l.e=t}),this.canRequestUsers&&(t&&t.keydown(function(t){t.keyCode==Common.UI.Keys.SPACE||t.keyCode===Common.UI.Keys.TAB||t.keyCode==Common.UI.Keys.HOME||t.keyCode==Common.UI.Keys.END||t.keyCode==Common.UI.Keys.RIGHT||t.keyCode==Common.UI.Keys.LEFT||t.keyCode==Common.UI.Keys.UP?l.onEmailListMenu():t.keyCode==Common.UI.Keys.DOWN&&l.emailMenu&&l.emailMenu.rendered&&l.emailMenu.isVisible()&&(_.delay(function(){l.emailMenu.cmpEl.find("li:not(.divider):first").find("a").focus()},10),t.preventDefault()),l.e=t}),t&&t.on("input",function(t){for(var e=$(this),i=this.selectionStart,n=e.val(),o=0,s=n.length-1,a=i-1;0<=a;a--)if(32==n.charCodeAt(a)||13==n.charCodeAt(a)||10==n.charCodeAt(a)||9==n.charCodeAt(a)){o=a+1;break}for(a=i;a<=s;a++)if(32==n.charCodeAt(a)||13==n.charCodeAt(a)||10==n.charCodeAt(a)||9==n.charCodeAt(a)){s=a-1;break}e=n.substring(o,s+1),i=e.match(/^(?:[@]|[+](?!1))(\S*)/);i&&1<i.length?(e=i[1],l.onEmailListMenu(e,o,s)):l.onEmailListMenu()}))},hideTips:function(){this.commentsView&&_.each(this.commentsView.dataViewItems,function(t){t.tipsArray&&t.tipsArray.forEach(function(t){t.hide()})},this),this.reviewChangesView&&_.each(this.reviewChangesView.dataViewItems,function(t){t.tipsArray&&t.tipsArray.forEach(function(t){t.hide()})},this),this.emailMenu&&this.emailMenu.rendered&&this.emailMenu.cmpEl.css("display","none")},isCommentsViewMouseOver:function(){return this._isMouseOver},setReviewStore:function(t){this.reviewStore=t,this.reviewChangesView&&this.reviewChangesView.setStore(this.reviewStore)},setCommentsStore:function(t){this.commentsStore=t,this.commentsView&&this.commentsView.setStore(this.commentsStore)},getPopover:function(t){return this.popover||(this.popover=new Common.Views.ReviewPopover(t)),this.popover},autoScrollToEditButtons:function(){var t=$("#id-comments-change-popover"),e=this.$window[0].getBoundingClientRect();t.length&&(t=t.get(0).getBoundingClientRect())&&e&&(e=e.bottom-(t.bottom+7))<0&&this.scroller.scrollTop(this.scroller.getScrollTop()-e)},onEmailListMenu:function(t,e,i){"string"==typeof t?(this._state.emailSearch={str:t,left:e,right:i},Common.UI.ExternalUsers.get("mention")):(this._state.emailSearch=null,this.emailMenu.rendered&&this.emailMenu.cmpEl.css("display","none"))},onEmailListMenuCallback:function(t,e){if(!(!this._state.emailSearch||e.length<1||t&&"mention"!==t)){var n=this,o=n.emailMenu,i=this._state.emailSearch.str,s=this._state.emailSearch.left,a=this._state.emailSearch.right,t=(this._state.emailSearch=null,n.$window.find(Common.Utils.String.format("#menu-container-{0}",o.id))),l=this.commentsView.getTextBox(),r=l?l[0]:null,c=r?[r.offsetLeft,r.offsetTop+r.clientHeight+3]:[0,0];o.rendered||(t.length<1&&(t=$(Common.Utils.String.format('<div id="menu-container-{0}" style="position: absolute; z-index: 10000;"><div class="dropdown-toggle" data-toggle="dropdown"></div></div>',o.id)),n.$window.append(t)),o.render(t),o.cmpEl.css("min-width",r?r.clientWidth:220),o.cmpEl.attr({tabindex:"-1"}),o.on("hide:after",function(){setTimeout(function(){var t=n.commentsView.getTextBox();t&&t.focus()},10)}));for(var d,h,m=0;m<o.items.length;m++)o.removeItem(o.items[m]),m--;0<e.length&&(0<(i=i.toLowerCase()).length&&(e=_.filter(e,function(t){return t.email&&0===t.email.toLowerCase().indexOf(i)||t.name&&0===t.name.toLowerCase().indexOf(i)})),d=_.template('<a id="<%= id %>" tabindex="-1" type="menuitem"><div style="overflow: hidden; text-overflow: ellipsis; max-width: 195px;"><%= Common.Utils.String.htmlEncode(caption) %></div><div style="overflow: hidden; text-overflow: ellipsis; max-width: 195px; color: #909090;"><%= Common.Utils.String.htmlEncode(options.value) %></div></a>'),h=!1,_.each(e,function(t,e){var i;h&&!t.hasAccess&&(h=!1,o.addItem(new Common.UI.MenuItem({caption:"--"}))),t.email&&t.name&&(i=new Common.UI.MenuItem({caption:t.name,value:t.email,template:d}).on("click",function(t,e){n.insertEmailToTextbox(t.options.value,s,a)}),o.addItem(i),t.hasAccess&&(h=!0))})),0<o.items.length?(t.css({left:c[0],top:c[1]}),o.menuAlignEl=l,o.show(),o.cmpEl.css("display",""),o.alignPosition("bl-tl",-5),o.scroller.update({alwaysVisibleY:!0})):o.rendered&&o.cmpEl.css("display","none")}},insertEmailToTextbox:function(t,e,i){var n,o=this.commentsView.getTextBox();o&&(n=o.val(),o.val(n.substring(0,e)+"+"+t+" "+n.substring(i+1,n.length)),setTimeout(function(){o[0].selectionStart=o[0].selectionEnd=e+t.length+2},10))}},Common.Views.ReviewPopover||{}))}),void 0===Common&&(Common={}),Common.Controllers=Common.Controllers||{},define("common/main/lib/controller/Comments",["core","common/main/lib/model/Comment","common/main/lib/collection/Comments","common/main/lib/view/Comments","common/main/lib/view/ReviewPopover"],function(){"use strict";function c(){return new(void 0!==Asc.asc_CCommentDataWord?Asc.asc_CCommentDataWord:Asc.asc_CCommentData)(null)}Common.Controllers.Comments=Backbone.Controller.extend(_.extend({models:[],collections:["Common.Collections.Comments"],views:["Common.Views.Comments","Common.Views.ReviewPopover"],sdkViewName:"#id_main",subEditStrings:{},filter:void 0,hintmode:!1,fullInfoHintMode:!1,viewmode:!1,isSelectedComment:!1,uids:[],oldUids:[],isDummyComment:!1,initialize:function(){this.addListeners({"Common.Views.Comments":{"comment:add":_.bind(this.onCreateComment,this),"comment:change":_.bind(this.onChangeComment,this),"comment:remove":_.bind(this.onRemoveComment,this),"comment:resolve":_.bind(this.onResolveComment,this),"comment:show":_.bind(this.onShowComment,this),"comment:addReply":_.bind(this.onAddReplyComment,this),"comment:changeReply":_.bind(this.onChangeReplyComment,this),"comment:removeReply":_.bind(this.onRemoveReplyComment,this),"comment:editReply":_.bind(this.onShowEditReplyComment,this),"comment:closeEditing":_.bind(this.closeEditing,this),"comment:sort":_.bind(this.setComparator,this),"comment:filtergroups":_.bind(this.setFilterGroups,this)},"Common.Views.ReviewPopover":{"comment:change":_.bind(this.onChangeComment,this),"comment:remove":_.bind(this.onRemoveComment,this),"comment:resolve":_.bind(this.onResolveComment,this),"comment:show":_.bind(this.onShowComment,this),"comment:addReply":_.bind(this.onAddReplyComment,this),"comment:changeReply":_.bind(this.onChangeReplyComment,this),"comment:removeReply":_.bind(this.onRemoveReplyComment,this),"comment:editReply":_.bind(this.onShowEditReplyComment,this),"comment:closeEditing":_.bind(this.closeEditing,this),"comment:disableHint":_.bind(this.disableHint,this),"comment:addDummyComment":_.bind(this.onAddDummyComment,this)},"Common.Views.ReviewChanges":{"comment:removeComments":_.bind(this.onRemoveComments,this),"comment:resolveComments":_.bind(this.onResolveComments,this)}}),Common.NotificationCenter.on("comments:updatefilter",_.bind(this.onUpdateFilter,this)),Common.NotificationCenter.on("app:comment:add",_.bind(this.onAppAddComment,this)),Common.NotificationCenter.on("layout:changed",function(t){Common.Utils.asyncCall(function(t){"toolbar"!=t&&"status"!=t||!this.view.$el.is(":visible")||this.onAfterShow()},this,t)}.bind(this)),Common.NotificationCenter.on("app:ready",this.onAppReady.bind(this))},onLaunch:function(){var t=Common.localStorage.getKeysFilter();this.appPrefix=t&&t.length?t.split(",")[0]:"",this._state={disableEditing:!1,docProtection:{isReadOnly:!1,isReviewOnly:!1,isFormsOnly:!1,isCommentsOnly:!1}},this.collection=this.getApplication().getCollection("Common.Collections.Comments"),this.setComparator(),this.popoverComments=new Common.Collections.Comments,this.popoverComments&&(this.popoverComments.comparator=function(t){return t.get("time")}),this.groupCollection=[],this.userGroups=[],this.view=this.createView("Common.Views.Comments",{store:this.collection}),this.view.render(),this.userCollection=this.getApplication().getCollection("Common.Collections.Users"),this.userCollection.on("reset",_.bind(this.onUpdateUsers,this)),this.userCollection.on("add",_.bind(this.onUpdateUsers,this)),this.bindViewEvents(this.view,this.events)},setConfig:function(t,e){this.setApi(e),t&&(this.currentUserId=t.config.user.id,this.sdkViewName=t.sdkviewname||this.sdkViewName,this.hintmode=t.hintmode||!1,this.fullInfoHintMode=t.fullInfoHintMode||!1,this.viewmode=t.viewmode||!1)},setApi:function(t){t&&(this.api=t,this.api.asc_registerCallback("asc_onAddComment",_.bind(this.onApiAddComment,this)),this.api.asc_registerCallback("asc_onAddComments",_.bind(this.onApiAddComments,this)),this.api.asc_registerCallback("asc_onRemoveComment",_.bind(this.onApiRemoveComment,this)),this.api.asc_registerCallback("asc_onChangeComments",_.bind(this.onChangeComments,this)),this.api.asc_registerCallback("asc_onRemoveComments",_.bind(this.onApiRemoveComments,this)),this.api.asc_registerCallback("asc_onChangeCommentData",_.bind(this.onApiChangeCommentData,this)),this.api.asc_registerCallback("asc_onLockComment",_.bind(this.onApiLockComment,this)),this.api.asc_registerCallback("asc_onUnLockComment",_.bind(this.onApiUnLockComment,this)),this.api.asc_registerCallback("asc_onShowComment",_.bind(this.onApiShowComment,this)),this.api.asc_registerCallback("asc_onHideComment",_.bind(this.onApiHideComment,this)),this.api.asc_registerCallback("asc_onUpdateCommentPosition",_.bind(this.onApiUpdateCommentPosition,this)),this.api.asc_registerCallback("asc_onDocumentPlaceChanged",_.bind(this.onDocumentPlaceChanged,this)),this.api.asc_registerCallback("asc_onDeleteComment",_.bind(this.onDeleteComment,this)),this.api.asc_registerCallback("asc_onChangeCommentLogicalPosition",_.bind(this.onApiChangeCommentLogicalPosition,this)))},setMode:function(t){return this.mode=t,this.isModeChanged=!0,this.view.viewmode=!this.mode.canComments,this.view.changeLayout(t),this},setComparator:function(t){var e,i;this.collection&&(e=void 0!==t,void 0===t&&(t=Common.localStorage.getItem(this.appPrefix+"comments-sort")||"date-desc"),Common.localStorage.setItem(this.appPrefix+"comments-sort",t),Common.Utils.InternalSettings.set(this.appPrefix+"comments-sort",t),"position-asc"==t||"position-desc"==t?(i="position-asc"==t?1:-1,this.collection.comparator=function(t){return i*t.get("position")}):"author-asc"==t||"author-desc"==t?(i="author-asc"==t?1:-1,this.collection.comparator=function(t,e){t=t.get("parsedName").toLowerCase(),e=e.get("parsedName").toLowerCase();return t==e?0:t<e?-i:i}):(i="date-asc"==t?1:-1,this.collection.comparator=function(t){return i*t.get("time")}),e&&this.updateComments(!0))},getComparator:function(){return Common.Utils.InternalSettings.get(this.appPrefix+"comments-sort")||"date"},onCreateComment:function(t,e,i,n,o){var s;this.api&&e&&0<e.length&&((s=c())&&(this.showPopover=!0,this.editPopover=!!i,this.hidereply=n,this.isSelectedComment=!1,this.uids=[],s.asc_putText(e),s.asc_putTime(this.utcDateToString(new Date)),s.asc_putOnlyOfficeTime(this.ooDateToString(new Date)),s.asc_putUserId(this.currentUserId),s.asc_putUserName(AscCommon.UserInfoParser.getCurrentName()),s.asc_putSolved(!1),_.isUndefined(s.asc_putDocumentFlag)||s.asc_putDocumentFlag(o),this.api.asc_addComment(s),this.view.showEditContainer(!1))),this.view.txtComment.focus()},onRemoveComment:function(t){this.api&&t&&this.api.asc_removeComment(t)},onRemoveComments:function(t){this.api&&this.api.asc_RemoveAllComments("my"==t||!this.mode.canDeleteComments,"current"==t)},onResolveComments:function(t){this.api&&this.api.asc_ResolveAllComments("my"==t||!this.mode.canEditComments,"current"==t)},onResolveComment:function(t){var e=this,i=null,n=null,o=c(),s=e.findComment(t);return _.isUndefined(t)&&(t=s.get("uid")),!(!o||!s)&&(o.asc_putText(s.get("comment")),o.asc_putQuoteText(s.get("quote")),o.asc_putTime(e.utcDateToString(new Date(s.get("time")))),o.asc_putOnlyOfficeTime(e.ooDateToString(new Date(s.get("time")))),o.asc_putUserId(s.get("userid")),o.asc_putUserName(s.get("username")),o.asc_putSolved(!s.get("resolved")),o.asc_putGuid(s.get("guid")),o.asc_putUserData(s.get("userdata")),_.isUndefined(o.asc_putDocumentFlag)||o.asc_putDocumentFlag(s.get("unattached")),(i=s.get("replys"))&&i.length&&i.forEach(function(t){(n=c())&&(n.asc_putText(t.get("reply")),n.asc_putTime(e.utcDateToString(new Date(t.get("time")))),n.asc_putOnlyOfficeTime(e.ooDateToString(new Date(t.get("time")))),n.asc_putUserId(t.get("userid")),n.asc_putUserName(t.get("username")),n.asc_putUserData(t.get("userdata")),o.asc_addReply(n))}),e.api.asc_changeComment(t,o),!0)},onShowComment:function(t,e,i){var n=this.findComment(t);if(n)if(null!==n.get("quote")){if(this.api){if(this.hintmode){if(this.animate=!0,n.get("unattached")&&this.getPopover())return void this.getPopover().hideComments()}else if(this.popoverComments.findWhere({uid:t})&&!this.getPopover().isVisible())return this.getPopover().showComments(!0),void this.api.asc_selectComment(t);!_.isUndefined(e)&&this.hintmode&&(this.isSelectedComment=e),i&&0===_.difference(this.uids,[t]).length&&0===_.difference([t],this.uids).length||(this.api.asc_selectComment(t),this._dontScrollToComment=!0,this.api.asc_showComment(t,!1))}}else this.hintmode&&this.api.asc_selectComment(t),this.getPopover()&&this.getPopover().hideComments(),this.isSelectedComment=!1,this.uids=[]},onChangeComment:function(t,e){if(e&&0<e.length){var i,n=this,o=null,s=null,a=null,l=c(),r=n.findComment(t);if(r&&l)return i=r.get("comment"),l.asc_putText(e),l.asc_putQuoteText(r.get("quote")),l.asc_putTime(n.utcDateToString(new Date(r.get("time")))),l.asc_putOnlyOfficeTime(n.ooDateToString(new Date(r.get("time")))),l.asc_putUserId(n.currentUserId),l.asc_putUserName(AscCommon.UserInfoParser.getCurrentName()),l.asc_putSolved(r.get("resolved")),l.asc_putGuid(r.get("guid")),l.asc_putUserData(r.get("userdata")),_.isUndefined(l.asc_putDocumentFlag)||l.asc_putDocumentFlag(r.get("unattached")),r.set("editTextInPopover",!1),(o=n.findPopupComment(t))&&o.set("editTextInPopover",!1),n.subEditStrings[t]&&delete n.subEditStrings[t],n.subEditStrings[t+"-R"]&&delete n.subEditStrings[t+"-R"],(s=r.get("replys"))&&s.length&&s.forEach(function(t){(a=c())&&(a.asc_putText(t.get("reply")),a.asc_putTime(n.utcDateToString(new Date(t.get("time")))),a.asc_putOnlyOfficeTime(n.ooDateToString(new Date(t.get("time")))),a.asc_putUserId(t.get("userid")),a.asc_putUserName(t.get("username")),a.asc_putUserData(t.get("userdata")),l.asc_addReply(a))}),n.api.asc_changeComment(t,l),n.mode&&n.mode.canRequestSendNotify&&n.view.pickEMail(l.asc_getGuid(),e,i),!0}return!1},onChangeReplyComment:function(t,e,i){if(i&&0<i.length){var n=this,o=null,s=null,a=c(),l=n.findComment(t),r="";if(a&&l)return a.asc_putText(l.get("comment")),a.asc_putQuoteText(l.get("quote")),a.asc_putTime(n.utcDateToString(new Date(l.get("time")))),a.asc_putOnlyOfficeTime(n.ooDateToString(new Date(l.get("time")))),a.asc_putUserId(l.get("userid")),a.asc_putUserName(l.get("username")),a.asc_putSolved(l.get("resolved")),a.asc_putGuid(l.get("guid")),a.asc_putUserData(l.get("userdata")),_.isUndefined(a.asc_putDocumentFlag)||a.asc_putDocumentFlag(l.get("unattached")),(o=l.get("replys"))&&o.length&&o.forEach(function(t){(s=c())&&(t.get("id")!==e||_.isUndefined(i)?(s.asc_putText(t.get("reply")),s.asc_putUserId(t.get("userid")),s.asc_putUserName(t.get("username"))):(r=t.get("reply"),s.asc_putText(i),s.asc_putUserId(n.currentUserId),s.asc_putUserName(AscCommon.UserInfoParser.getCurrentName())),s.asc_putTime(n.utcDateToString(new Date(t.get("time")))),s.asc_putOnlyOfficeTime(n.ooDateToString(new Date(t.get("time")))),s.asc_putUserData(t.get("userdata")),a.asc_addReply(s))}),n.api.asc_changeComment(t,a),n.mode&&n.mode.canRequestSendNotify&&n.view.pickEMail(a.asc_getGuid(),i,r),!0}return!1},onAddReplyComment:function(t,e){if(0<e.length){var i,n=this,o=null,s=null,a=c(),l=n.findComment(t);if(a&&l&&((i=l.get("uid"))&&(n.subEditStrings[i]&&delete n.subEditStrings[i],n.subEditStrings[i+"-R"]&&delete n.subEditStrings[i+"-R"],l.set("showReplyInPopover",!1)),a.asc_putText(l.get("comment")),a.asc_putQuoteText(l.get("quote")),a.asc_putTime(n.utcDateToString(new Date(l.get("time")))),a.asc_putOnlyOfficeTime(n.ooDateToString(new Date(l.get("time")))),a.asc_putUserId(l.get("userid")),a.asc_putUserName(l.get("username")),a.asc_putSolved(l.get("resolved")),a.asc_putGuid(l.get("guid")),a.asc_putUserData(l.get("userdata")),_.isUndefined(a.asc_putDocumentFlag)||a.asc_putDocumentFlag(l.get("unattached")),(o=l.get("replys"))&&o.length&&o.forEach(function(t){(s=c())&&(s.asc_putText(t.get("reply")),s.asc_putTime(n.utcDateToString(new Date(t.get("time")))),s.asc_putOnlyOfficeTime(n.ooDateToString(new Date(t.get("time")))),s.asc_putUserId(t.get("userid")),s.asc_putUserName(t.get("username")),s.asc_putUserData(t.get("userdata")),a.asc_addReply(s))}),s=c()))return s.asc_putText(e),s.asc_putTime(n.utcDateToString(new Date)),s.asc_putOnlyOfficeTime(n.ooDateToString(new Date)),s.asc_putUserId(n.currentUserId),s.asc_putUserName(AscCommon.UserInfoParser.getCurrentName()),a.asc_addReply(s),n.api.asc_changeComment(t,a),n.mode&&n.mode.canRequestSendNotify&&n.view.pickEMail(a.asc_getGuid(),e),!0}return!1},onRemoveReplyComment:function(t,e){if(!_.isUndefined(t)&&!_.isUndefined(e)){var i=this,n=null,o=null,s=c(),a=i.findComment(t);if(s&&a)return s.asc_putText(a.get("comment")),s.asc_putQuoteText(a.get("quote")),s.asc_putTime(i.utcDateToString(new Date(a.get("time")))),s.asc_putOnlyOfficeTime(i.ooDateToString(new Date(a.get("time")))),s.asc_putUserId(a.get("userid")),s.asc_putUserName(a.get("username")),s.asc_putSolved(a.get("resolved")),s.asc_putGuid(a.get("guid")),s.asc_putUserData(a.get("userdata")),_.isUndefined(s.asc_putDocumentFlag)||s.asc_putDocumentFlag(a.get("unattached")),(n=a.get("replys"))&&n.length&&n.forEach(function(t){t.get("id")!==e&&(o=c())&&(o.asc_putText(t.get("reply")),o.asc_putTime(i.utcDateToString(new Date(t.get("time")))),o.asc_putOnlyOfficeTime(i.ooDateToString(new Date(t.get("time")))),o.asc_putUserId(t.get("userid")),o.asc_putUserName(t.get("username")),o.asc_putUserData(t.get("userdata")),s.asc_addReply(o))}),i.api.asc_changeComment(t,s),!0}return!1},onShowEditReplyComment:function(t,e,i){var n,o,s,a;if(!_.isUndefined(t)&&!_.isUndefined(e))if(i){if((o=this.popoverComments.findWhere({uid:t}))&&(s=o.get("replys"),a=_.clone(o.get("replys"))))for(n=0;n<a.length;++n)if(e===a[n].get("id"))return a[n].set("editTextInPopover",!0),s.length=0,o.set("replys",a),!0}else if((o=this.collection.findWhere({uid:t}))&&(s=o.get("replys"),a=_.clone(o.get("replys"))))for(n=0;n<a.length;++n)if(e===a[n].get("id"))return a[n].set("editText",!0),s.length=0,o.set("replys",a),!0;return!1},onUpdateFilter:function(t,e){if(t){this.view.isVisible()||(this.view.needUpdateFilter=t,e=!0),this.filter=t;var i=this,n=[];if(this.filter.forEach(function(t){i.groupCollection[t]||(i.groupCollection[t]=new Backbone.Collection([],{model:Common.Models.Comment})),n=n.concat(i.groupCollection[t].models)}),this.collection.reset(n),this.collection.groups=this.filter,!e){this.getPopover()&&this.getPopover().hide();for(var o=!(this.view.needUpdateFilter=!1),s=this.collection.length-1;0<=s;--s){var a=this.collection.at(s);!o||a.get("hide")||a.get("filtered")?a.get("last")&&a.set("last",!1,{silent:!0}):(a.set("last",!0,{silent:!0}),o=!1)}this.view.render(),this.view.update()}}},onAppAddComment:function(t,e){this.api.can_AddQuotedComment&&!1===this.api.can_AddQuotedComment()||e||this.addDummyComment()},addCommentToGroupCollection:function(t){var e=t.get("groupName");this.groupCollection[e]||(this.groupCollection[e]=new Backbone.Collection([],{model:Common.Models.Comment})),this.groupCollection[e].push(t)},onApiAddComment:function(t,e){var i=this.readSDKComment(t,e);i&&((!i.get("groupName")||(this.addCommentToGroupCollection(i),-1<_.indexOf(this.collection.groups,i.get("groupName"))))&&this.collection.push(i),this.updateComments(!0,"position-asc"===this.getComparator()||"position-desc"===this.getComparator()),this.showPopover&&(null!==e.asc_getQuoteText()&&(this.api.asc_selectComment(t),this._dontScrollToComment=!0,this.api.asc_showComment(t,!0)),this.showPopover=void 0,this.editPopover=!1))},onApiAddComments:function(t){for(var e=0;e<t.length;++e){var i=this.readSDKComment(t[e].asc_getId(),t[e]);i.get("groupName")?this.addCommentToGroupCollection(i):this.collection.push(i)}this.updateComments(!0,"position-asc"===this.getComparator()||"position-desc"===this.getComparator())},onApiRemoveComment:function(t,e){for(var i in this.groupCollection){i=this.groupCollection[i];if(n=i.findWhere({uid:t})){i.remove(n);break}}var n;this.collection.length&&((n=this.collection.findWhere({uid:t}))&&(this.collection.remove(n),e||this.updateComments(!0)),this.popoverComments.length&&(n=this.popoverComments.findWhere({uid:t}))&&(this.popoverComments.remove(n),0===this.popoverComments.length&&this.getPopover()&&this.getPopover().hideComments()))},onChangeComments:function(t){for(var e=0;e<t.length;++e)this.onApiChangeCommentData(t[e].Comment.Id,t[e].Comment,!0);this.updateComments(!0)},onApiRemoveComments:function(t){for(var e=0;e<t.length;++e)this.onApiRemoveComment(t[e],!0);this.updateComments(!0)},onApiChangeCommentData:function(t,e,i){var n,o=0,s=null,a=null,l=null,t=this.findComment(t)||this.findCommentInGroup(t);if(t){var r,c=this,s=e.asc_getOnlyOfficeTime()?new Date(this.stringOOToLocalDate(e.asc_getOnlyOfficeTime())):""==e.asc_getTime()?new Date:new Date(this.stringUtcToLocalDate(e.asc_getTime())),d=this.userCollection.findOriginalUser(e.asc_getUserId()),h=("author-asc"==this.getComparator()||"author-desc"==this.getComparator())&&e.asc_getUserName()!==t.get("username");for(t.set("comment",e.asc_getText()),t.set("userid",e.asc_getUserId()),t.set("username",e.asc_getUserName()),t.set("parsedName",AscCommon.UserInfoParser.getParsedName(e.asc_getUserName())),t.set("parsedGroups",AscCommon.UserInfoParser.getParsedGroups(e.asc_getUserName())),t.set("usercolor",d?d.get("color"):null),t.set("resolved",e.asc_getSolved()),t.set("quote",e.asc_getQuoteText()),t.set("userdata",e.asc_getUserData()),t.set("time",s.getTime()),t.set("date",c.dateToLocaleTimeString(s)),t.set("editable",(c.mode.canEditComments||e.asc_getUserId()==c.currentUserId)&&AscCommon.UserInfoParser.canEditComment(e.asc_getUserName())),t.set("removable",(c.mode.canDeleteComments||e.asc_getUserId()==c.currentUserId)&&AscCommon.UserInfoParser.canDeleteComment(e.asc_getUserName())),t.set("hide",!AscCommon.UserInfoParser.canViewComment(e.asc_getUserName())),t.get("hide")||(s=t.get("parsedGroups"),c.fillUserGroups(s),s=!!(r=Common.Utils.InternalSettings.get(c.appPrefix+"comments-filtergroups"))&&-1!==r&&(!s||s.length<1||s.indexOf(r)<0),t.set("filtered",s)),(a=_.clone(t.get("replys"))).length=0,n=e.asc_getRepliesCount(),o=0;o<n;++o)l=e.asc_getReply(o).asc_getOnlyOfficeTime()?new Date(this.stringOOToLocalDate(e.asc_getReply(o).asc_getOnlyOfficeTime())):""==e.asc_getReply(o).asc_getTime()?new Date:new Date(this.stringUtcToLocalDate(e.asc_getReply(o).asc_getTime())),d=this.userCollection.findOriginalUser(e.asc_getReply(o).asc_getUserId()),a.push(new Common.Models.Reply({id:Common.UI.getId(),userid:e.asc_getReply(o).asc_getUserId(),username:e.asc_getReply(o).asc_getUserName(),parsedName:AscCommon.UserInfoParser.getParsedName(e.asc_getReply(o).asc_getUserName()),usercolor:d?d.get("color"):null,date:c.dateToLocaleTimeString(l),reply:e.asc_getReply(o).asc_getText(),userdata:e.asc_getReply(o).asc_getUserData(),time:l.getTime(),editText:!1,editTextInPopover:!1,showReplyInPopover:!1,scope:c.view,editable:(c.mode.canEditComments||e.asc_getReply(o).asc_getUserId()==c.currentUserId)&&AscCommon.UserInfoParser.canEditComment(e.asc_getReply(o).asc_getUserName()),removable:(c.mode.canDeleteComments||e.asc_getReply(o).asc_getUserId()==c.currentUserId)&&AscCommon.UserInfoParser.canDeleteComment(e.asc_getReply(o).asc_getUserName())}));t.set("replys",a),this.popoverComments.findWhere({hide:!1})||this.getPopover()&&this.getPopover().hideComments(),i||this.updateComments(h,!h)}},onApiLockComment:function(t,e){var t=this.findComment(t)||this.findCommentInGroup(t),i=null;t&&this.userCollection&&(i=this.userCollection.findUser(e))&&(this.getPopover()&&this.getPopover().saveText(),this.view.saveText(),t.set("lock",!0),t.set("lockuserid",this.view.getUserName(i.get("username"))))},onApiUnLockComment:function(t){t=this.findComment(t)||this.findCommentInGroup(t);t&&(t.set("lock",!1),this.getPopover()&&this.getPopover().loadText(),this.view.loadText())},onApiShowComment:function(t,e,i,n,o,s){var a=s,l=0===_.difference(this.uids,t).length&&0===_.difference(t,this.uids).length;if(!(s&&this.isSelectedComment&&l)||this.isModeChanged){var r=this.getPopover();if(r){if(this.clearDummyComment(),this.isSelectedComment&&l&&!this.isModeChanged)return void(this.api&&(r.commentsView&&r.commentsView.setFocusToTextBox(!0),this.api.asc_enableKeyEvents(!0)));for(var c,d,h=0,m=null,p="",u=!0,g=[],h=0;h<t.length;++h)c=t[h],d=t[h]+"-R",(m=this.findComment(c))&&(!this.subEditStrings[c]||!m.get("fullInfoInHint")&&s?!this.subEditStrings[d]||!m.get("fullInfoInHint")&&s||(m.set("showReplyInPopover",!0),p=this.subEditStrings[d]):(m.set("editTextInPopover",!0),p=this.subEditStrings[c]),m.set("hint",!_.isUndefined(s)&&s),!s&&this.hintmode&&(l&&(u=!1),this.oldUids.length&&0===_.difference(this.oldUids,t).length&&0===_.difference(t,this.oldUids).length&&(u=!1,this.oldUids=[]),!l||a||this.isModeChanged||this.api.asc_selectComment(m.get("uid"))),this.animate&&(u=this.animate,this.animate=!1),this.isSelectedComment=!a||!this.hintmode,this.uids=_.clone(t),g.push(m),this._dontScrollToComment||this.view.commentsView.scrollToRecord(m),this._dontScrollToComment=!1);g.sort(function(t,e){return t.get("time")-e.get("time")}),this.popoverComments.reset(g),this.popoverComments.findWhere({hide:!1})?(!r.isVisible()||l&&!this.isModeChanged||r.hide(),r.setLeftTop(e,i,n),r.showComments(u,!1,!0,p)):r.hideComments()}this.isModeChanged=!1}},onApiHideComment:function(t){var e=this;!this.getPopover()||this.isSelectedComment&&t||t&&this.getPopover().isCommentsViewMouseOver()||(this.popoverComments.each(function(t){t.get("editTextInPopover")&&(e.subEditStrings[t.get("uid")]=e.getPopover().getEditText()),t.get("showReplyInPopover")&&(e.subEditStrings[t.get("uid")+"-R"]=e.getPopover().getEditText())}),this.getPopover().saveText(!0),this.getPopover().hideComments(),this.collection.clearEditing(),this.popoverComments.clearEditing(),this.oldUids=_.clone(this.uids),this.isSelectedComment=!1,this.uids=[],this.popoverComments.reset())},onApiUpdateCommentPosition:function(t,e,i,n){var o,s,a=null,l=void 0;if(this.getPopover())if(this.getPopover().saveText(),this.getPopover().hideTips(),i<0||this.getPopover().sdkBounds.height<i||!_.isUndefined(n)&&this.getPopover().sdkBounds.width<n)this.getPopover().hide();else{if(this.isModeChanged&&this.onApiShowComment(t,e,i,n),0===this.popoverComments.length){for(var r=[],c=0;c<t.length;++c)o=t[c],s=t[c]+"-R",(a=this.findComment(o))&&(this.subEditStrings[o]?(a.set("editTextInPopover",!0),l=this.subEditStrings[o]):this.subEditStrings[s]&&(a.set("showReplyInPopover",!0),l=this.subEditStrings[s]),r.push(a));r.sort(function(t,e){return t.get("time")-e.get("time")}),this.popoverComments.reset(r),this.popoverComments.findWhere({hide:!1})?this.getPopover().showComments(!0,void 0,void 0,l):this.getPopover().hideComments()}else!this.getPopover().isVisible()&&this.popoverComments.findWhere({hide:!1})&&this.getPopover().showComments(!1,void 0,void 0,l);this.getPopover().setLeftTop(e,i,n,void 0,!0)}},onDocumentPlaceChanged:function(){var t;this.isDummyComment&&this.getPopover()&&this.getPopover().isVisible()&&(t=this.api.asc_getAnchorPosition())&&this.getPopover().setLeftTop(t.asc_getX()+t.asc_getWidth(),t.asc_getY(),this.hintmode?t.asc_getX():void 0)},onDeleteComment:function(t,e){this.api&&this.api.asc_RemoveAllComments(!this.mode.canDeleteComments,!0)},onApiChangeCommentLogicalPosition:function(t){for(var e in t){var i;!t.hasOwnProperty(e)||(i=this.findComment(e)||this.findCommentInGroup(e))&&i.set("position",t[e])}"position-asc"!==this.getComparator()&&"position-desc"!==this.getComparator()||this.updateComments(!0)},updateComments:function(t,e,i){var n=this;n.updateCommentsTime=new Date,n.disableSort=!!e,void 0===n.timerUpdateComments&&(n.timerUpdateComments=setInterval(function(){100<new Date-n.updateCommentsTime&&(clearInterval(n.timerUpdateComments),n.timerUpdateComments=void 0,n.updateCommentsView(t,n.disableSort,i))},25))},updateCommentsView:function(t,e,i){if(t&&!this.view.isVisible())this.view.needRender=t,this.onUpdateFilter(this.filter,!0);else{var n,o=!0;if(e||this.collection.sort(),t){for(this.onUpdateFilter(this.filter,!0),n=this.collection.length-1;0<=n;--n){var s=this.collection.at(n);!o||s.get("hide")||s.get("filtered")?s.get("last")&&s.set("last",!1,{silent:!0}):(s.set("last",!0,{silent:!0}),o=!1)}this.view.render(),this.view.needRender=!1}this.view.update(),i&&this.view.loadText()}},findComment:function(t){return this.collection.findWhere({uid:t})},findPopupComment:function(t){return this.popoverComments.findWhere({id:t})},findCommentInGroup:function(t){for(var e in this.groupCollection){e=this.groupCollection[e].findWhere({uid:t});if(e)return e}},closeEditing:function(t){var e;_.isUndefined(t)||((e=this.findPopupComment(t))&&(e.set("editTextInPopover",!1),e.set("showReplyInPopover",!1)),this.subEditStrings[t]&&delete this.subEditStrings[t],this.subEditStrings[t+"-R"]&&delete this.subEditStrings[t+"-R"]),this.collection.clearEditing(),this.collection.each(function(t){var e=_.clone(t.get("replys"));t.get("replys").length=0,e.forEach(function(t){t.get("editText")&&t.set("editText",!1),t.get("editTextInPopover")&&t.set("editTextInPopover",!1)}),t.set("replys",e)}),this.view.showEditContainer(!1),this.view.update()},disableHint:function(t){t&&this.mode.canComments&&(t.set("hint",!1),this.api.asc_showComment(t.get("uid"),!1),this.isSelectedComment=!0)},blockPopover:function(t){(this.isSelectedComment=t)&&this.getPopover().isVisible()&&this.getPopover().hide()},getPopover:function(){return _.isUndefined(this.popover)&&(this.popover=Common.Views.ReviewPopover.prototype.getPopover({commentsStore:this.popoverComments,renderTo:this.sdkViewName,canRequestUsers:this.mode?this.mode.canRequestUsers:void 0,canRequestSendNotify:this.mode?this.mode.canRequestSendNotify:void 0,mentionShare:!this.mode||this.mode.mentionShare,api:this.api}),this.popover.setCommentsStore(this.popoverComments)),this.popover},onUpdateUsers:function(){var t,o=this.userCollection,e=!1;for(t in this.groupCollection)e=!0,this.groupCollection[t].each(function(t){var e=o.findOriginalUser(t.get("userid")),i=e?e.get("color"):null,n=!1;i!==t.get("usercolor")&&(n=!0,t.set("usercolor",i,{silent:!0})),t.get("replys").forEach(function(t){e=o.findOriginalUser(t.get("userid")),(i=e?e.get("color"):null)!==t.get("usercolor")&&(n=!0,t.set("usercolor",i,{silent:!0}))}),n&&t.trigger("change")});e||this.collection.each(function(t){var e=o.findOriginalUser(t.get("userid")),i=e?e.get("color"):null,n=!1;i!==t.get("usercolor")&&(n=!0,t.set("usercolor",i,{silent:!0})),t.get("replys").forEach(function(t){e=o.findOriginalUser(t.get("userid")),(i=e?e.get("color"):null)!==t.get("usercolor")&&(n=!0,t.set("usercolor",i,{silent:!0}))}),n&&t.trigger("change")})},readSDKComment:function(t,e){var i=e.asc_getOnlyOfficeTime()?new Date(this.stringOOToLocalDate(e.asc_getOnlyOfficeTime())):""==e.asc_getTime()?new Date:new Date(this.stringUtcToLocalDate(e.asc_getTime())),n=this.userCollection.findOriginalUser(e.asc_getUserId()),o=t.substr(0,t.lastIndexOf("_")+1).match(/^(doc|sheet[0-9_]+)_/),t=new Common.Models.Comment({uid:t,guid:e.asc_getGuid(),userid:e.asc_getUserId(),username:e.asc_getUserName(),parsedName:AscCommon.UserInfoParser.getParsedName(e.asc_getUserName()),parsedGroups:AscCommon.UserInfoParser.getParsedGroups(e.asc_getUserName()),usercolor:n?n.get("color"):null,date:this.dateToLocaleTimeString(i),quote:e.asc_getQuoteText(),comment:e.asc_getText(),resolved:e.asc_getSolved(),unattached:!_.isUndefined(e.asc_getDocumentFlag)&&e.asc_getDocumentFlag(),userdata:e.asc_getUserData(),id:Common.UI.getId(),time:i.getTime(),showReply:!1,editText:!1,last:void 0,editTextInPopover:!!this.editPopover,showReplyInPopover:!1,hideAddReply:_.isUndefined(this.hidereply)?!!this.showPopover:this.hidereply,scope:this.view,editable:(this.mode.canEditComments||e.asc_getUserId()==this.currentUserId)&&AscCommon.UserInfoParser.canEditComment(e.asc_getUserName()),removable:(this.mode.canDeleteComments||e.asc_getUserId()==this.currentUserId)&&AscCommon.UserInfoParser.canDeleteComment(e.asc_getUserName()),hide:!AscCommon.UserInfoParser.canViewComment(e.asc_getUserName()),hint:!this.mode.canComments,fullInfoInHint:this.fullInfoHintMode,groupName:o&&1<o.length?o[1]:null});return t&&(t.get("hide")||(n=t.get("parsedGroups"),this.fillUserGroups(n),o=!!(i=Common.Utils.InternalSettings.get(this.appPrefix+"comments-filtergroups"))&&-1!==i&&(!n||n.length<1||n.indexOf(i)<0),t.set("filtered",o)),(n=this.readSDKReplies(e)).length&&t.set("replys",n)),t},readSDKReplies:function(t){var e=0,i=[],n=null,o=t.asc_getRepliesCount();if(o)for(e=0;e<o;++e){var n=t.asc_getReply(e).asc_getOnlyOfficeTime()?new Date(this.stringOOToLocalDate(t.asc_getReply(e).asc_getOnlyOfficeTime())):""==t.asc_getReply(e).asc_getTime()?new Date:new Date(this.stringUtcToLocalDate(t.asc_getReply(e).asc_getTime())),s=this.userCollection.findOriginalUser(t.asc_getReply(e).asc_getUserId());i.push(new Common.Models.Reply({id:Common.UI.getId(),userid:t.asc_getReply(e).asc_getUserId(),username:t.asc_getReply(e).asc_getUserName(),parsedName:AscCommon.UserInfoParser.getParsedName(t.asc_getReply(e).asc_getUserName()),usercolor:s?s.get("color"):null,date:this.dateToLocaleTimeString(n),reply:t.asc_getReply(e).asc_getText(),userdata:t.asc_getReply(e).asc_getUserData(),time:n.getTime(),editText:!1,editTextInPopover:!1,showReplyInPopover:!1,scope:this.view,editable:(this.mode.canEditComments||t.asc_getReply(e).asc_getUserId()==this.currentUserId)&&AscCommon.UserInfoParser.canEditComment(t.asc_getReply(e).asc_getUserName()),removable:(this.mode.canDeleteComments||t.asc_getReply(e).asc_getUserId()==this.currentUserId)&&AscCommon.UserInfoParser.canDeleteComment(t.asc_getReply(e).asc_getUserName())}))}return i},addDummyComment:function(){if(this.api){var e=this,t=null,i=new Date,n=this.getPopover();if(n){if(this.popoverComments.length){if(this.isDummyComment)return void _.delay(function(){n.commentsView.setFocusToTextBox()},200);this.closeEditing()}var o=this.userCollection.findOriginalUser(this.currentUserId),i=new Common.Models.Comment({id:-1,time:i.getTime(),date:this.dateToLocaleTimeString(i),userid:this.currentUserId,username:AscCommon.UserInfoParser.getCurrentName(),parsedName:AscCommon.UserInfoParser.getParsedName(AscCommon.UserInfoParser.getCurrentName()),usercolor:o?o.get("color"):null,editTextInPopover:!0,showReplyInPopover:!1,hideAddReply:!0,scope:this.view,dummy:!0});this.popoverComments.reset(),this.popoverComments.push(i),this.uids=[],this.isSelectedComment=!0,this.isDummyComment=!0,_.isUndefined(this.api.asc_SetDocumentPlaceChangedEnabled)||e.api.asc_SetDocumentPlaceChangedEnabled(!0),n.handlerHide=function(){},n.isVisible()&&n.hide(),n.handlerHide=function(t){e.clearDummyComment(t)},(t=this.api.asc_getAnchorPosition())&&(n.setLeftTop(t.asc_getX()+t.asc_getWidth(),t.asc_getY(),this.hintmode?t.asc_getX():void 0),Common.NotificationCenter.trigger("comments:showdummy"),n.showComments(!0,!1,!0,n.getDummyText()))}}},onAddDummyComment:function(t){var e;this.api&&t&&0<t.length&&((e=c())&&(this.showPopover=!0,this.editPopover=!1,this.hidereply=!1,this.isSelectedComment=!1,this.uids=[],this.popoverComments.reset(),this.getPopover().isVisible()&&this.getPopover().hideComments(),this.isDummyComment=!1,e.asc_putText(t),e.asc_putTime(this.utcDateToString(new Date)),e.asc_putOnlyOfficeTime(this.ooDateToString(new Date)),e.asc_putUserId(this.currentUserId),e.asc_putUserName(AscCommon.UserInfoParser.getCurrentName()),e.asc_putSolved(!1),_.isUndefined(e.asc_putDocumentFlag)||e.asc_putDocumentFlag(!1),this.api.asc_addComment(e),this.view.showEditContainer(!1),this.mode&&this.mode.canRequestSendNotify&&this.view.pickEMail(e.asc_getGuid(),t),_.isUndefined(this.api.asc_SetDocumentPlaceChangedEnabled)||this.api.asc_SetDocumentPlaceChangedEnabled(!1)))},clearDummyComment:function(t){var e;this.isDummyComment&&(this.isDummyComment=!1,this.showPopover=!0,this.editPopover=!1,this.hidereply=!1,this.isSelectedComment=!1,this.uids=[],(e=this.getPopover())&&(t&&e.clearDummyText(),e.saveDummyText(),e.handlerHide=function(){},e.isVisible()&&e.hideComments()),this.popoverComments.reset(),_.isUndefined(this.api.asc_SetDocumentPlaceChangedEnabled)||this.api.asc_SetDocumentPlaceChangedEnabled(!1),Common.NotificationCenter.trigger("comments:cleardummy"))},onEditComments:function(t){if(this.api){var e=0,i=null,n=this.api.asc_getAnchorPosition();if(n){for(this.isSelectedComment=!0,this.popoverComments.reset(),e=0;e<t.length;++e)(i=this.findComment(t[e].asc_getId()))&&(i.set("editTextInPopover",this.mode.canEditComments&&AscCommon.UserInfoParser.canEditComment(i.username)),i.set("hint",!1),this.popoverComments.push(i));this.getPopover()&&0<this.popoverComments.length&&this.popoverComments.findWhere({hide:!1})&&(this.getPopover().isVisible()&&this.getPopover().hide(),this.getPopover().setLeftTop(n.asc_getX()+n.asc_getWidth(),n.asc_getY(),this.hintmode?n.asc_getX():void 0),this.getPopover().showComments(!0,!1,!0))}}},onAfterShow:function(){var t;this.view&&this.api&&((t=$(".new-comment-ct",this.view.el))&&t.length&&"none"!==t.css("display")&&this.view.txtComment.focus(),this.view.needRender?this.updateComments(!0):this.view.needUpdateFilter&&this.onUpdateFilter(this.view.needUpdateFilter),this.view.update())},onBeforeHide:function(){this.view&&this.view.showEditContainer(!1)},timeZoneOffsetInMs:6e4*(new Date).getTimezoneOffset(),stringOOToLocalDate:function(t){return"string"==typeof t?parseInt(t):0},ooDateToString:function(t){return"[object Date]"===Object.prototype.toString.call(t)?t.getTime().toString():""},stringUtcToLocalDate:function(t){return"string"==typeof t?parseInt(t)+this.timeZoneOffsetInMs:0},utcDateToString:function(t){return"[object Date]"===Object.prototype.toString.call(t)?(t.getTime()-this.timeZoneOffsetInMs).toString():""},dateToLocaleTimeString:function(e){var t,i=(this.mode&&this.mode.lang||"en").replace("_","-").toLowerCase();try{return e.toLocaleString(i,{dateStyle:"short",timeStyle:"short"})}catch(t){return e.toLocaleString("en",{dateStyle:"short",timeStyle:"short"})}return e.getMonth()+1+"/"+e.getDate()+"/"+e.getFullYear()+" "+(e=(i=e).getHours(),i=i.getMinutes(),t=12<=e?"pm":"am",(e=(e%=12)||12)+":"+(i<10?"0"+i:i)+" "+t)},getView:function(t){return!t&&this.view?this.view:Backbone.Controller.prototype.getView.call(this,t)},setPreviewMode:function(t){this._state.disableEditing=t,this.updatePreviewMode()},updatePreviewMode:function(){var t=this._state.docProtection,t=this._state.disableEditing||t.isReadOnly||t.isFormsOnly;this.viewmode!==t&&((this.viewmode=t)&&(this.prevcanComments=this.mode.canComments),this.mode.canComments=!t&&this.prevcanComments,this.closeEditing(),this.setMode(this.mode),this.updateComments(!0),this.getPopover()&&(t?this.getPopover().hide():this.getPopover().update(!0)))},clearCollections:function(){this.collection.reset(),this.groupCollection=[]},fillUserGroups:function(t){var e,i,n;this.mode.canUseCommentPermissions&&(e=AscCommon.UserInfoParser.getCommentPermissions("view"),t&&0<t.length&&(e&&(t=_.intersection(t,e)),t=_.uniq(this.userGroups.concat(t))),this.view&&this.view.buttonSort&&0<_.difference(t,this.userGroups).length&&(this.userGroups=t,(i=this.view.buttonSort.menu).items[i.items.length-1].setVisible(0<this.userGroups.length),i.items[i.items.length-2].setVisible(0<this.userGroups.length),(i=i.items[i.items.length-1].menu).removeAll(),n=Common.Utils.InternalSettings.get(this.appPrefix+"comments-filtergroups"),i.addItem(new Common.UI.MenuItem({checkable:!0,checked:-1===n||void 0===n,toggleGroup:"filtercomments",caption:this.view.textAll,value:-1})),this.userGroups.forEach(function(t){i.addItem(new Common.UI.MenuItem({checkable:!0,checked:n===t,toggleGroup:"filtercomments",caption:Common.Utils.String.htmlEncode(t),value:t}))})))},setFilterGroups:function(t){Common.Utils.InternalSettings.set(this.appPrefix+"comments-filtergroups",t);for(var e=!0,i=this.collection.length-1;0<=i;--i){var n,o=this.collection.at(i);o.get("hide")||(n=o.get("parsedGroups"),o.set("filtered",!!t&&-1!==t&&(!n||n.length<1||n.indexOf(t)<0),{silent:!0})),!e||o.get("hide")||o.get("filtered")?o.get("last")&&o.set("last",!1,{silent:!0}):(o.set("last",!0,{silent:!0}),e=!1)}this.updateComments(!0)},onAppReady:function(t){var e=this;new Promise(function(t,e){t()}).then(function(){e.onChangeProtectDocument(),Common.NotificationCenter.on("protect:doclock",_.bind(e.onChangeProtectDocument,e))})},onChangeProtectDocument:function(t){var e;(t=t?t:(e=this.getApplication().getController("DocProtection"))?e.getDocProps():null)&&(this._state.docProtection=t,this.updatePreviewMode())}},Common.Controllers.Comments||{}))}),define("common/main/lib/model/ChatMessage",["backbone"],function(t){"use strict";Common.Models=Common.Models||{},Common.Models.ChatMessage=t.Model.extend({defaults:{type:0,userid:null,username:"",message:""}})}),define("common/main/lib/collection/ChatMessages",["backbone","common/main/lib/model/ChatMessage"],function(t){"use strict";Common.Collections||(Common.Collections={}),Common.Collections.ChatMessages=t.Collection.extend({model:Common.Models.ChatMessage})}),define("text!common/main/lib/template/Chat.template",[],function(){return'<div id="chat-box" class="layout-ct vbox">\n    <div id="chat-users" class="layout-item area">\n        <div id="chat-user-ct"></div>\n    </div>\n    <div id="chat-messages" class="layout-item area">\n        <div id="chat-message-ct"></div>\n    </div>\n    <div id="chat-options" class="layout-item">\n        <div id="chat-options-ct">\n            <textarea id="chat-msg-text" class="user-select textarea-control" maxlength="<%=maxMsgLength%>" data-hint="1" data-hint-direction="left-top"></textarea>\n            <button id="chat-msg-btn-add" class="btn normal dlg-btn primary" data-hint="1" data-hint-direction="bottom" data-hint-offset="big"><%=scope.textSend%></button>\n        </div>\n    </div>\n</div>'}),void 0===Common&&(Common={}),Common.Views=Common.Views||{},define("common/main/lib/view/Chat",["text!common/main/lib/template/Chat.template","common/main/lib/util/utils","common/main/lib/component/BaseView","common/main/lib/component/Layout"],function(t){"use strict";Common.Views.Chat=Common.UI.BaseView.extend(_.extend({el:"#left-panel-chat",template:_.template(t),storeUsers:void 0,storeMessages:void 0,tplUser:['<li id="<%= user.get("iid") %>"<% if (!user.get("online")) { %> class="offline"<% } %>>','<div class="name"><div class="color" style="background-color: <%= user.get("color") %>;" ></div><%= scope.getUserName(user.get("username")) %>',"</div>","</li>"].join(""),templateUserList:_.template("<ul><% for (originalId in users) { %><%= _.template(usertpl)({user: users[originalId][0], scope: scope}) %><% } %></ul>"),tplMsg:["<li>",'<% if (msg.get("type")==1) { %>','<div class="message service" data-can-copy="true"><%= msg.get("message") %></div>',"<% } else { %>",'<div class="user-name" data-can-copy="true">','<div class="color" style="display: inline-block; background-color: <% if (msg.get("usercolor")!==null) { %><%=msg.get("usercolor")%><% } else { %> #cfcfcf <% } %>; " ></div><%= scope.getUserName(msg.get("username")) %>',"</div>",'<label class="message user-select" data-can-copy="true" tabindex="-1" oo_editor_input="true"><%= msg.get("message") %></label>',"<% } %>","</li>"].join(""),templateMsgList:_.template("<ul><% _.each(messages, function(item) { %><%= _.template(msgtpl)({msg: item, scope: scope}) %><% }); %></ul>"),events:{},usersBoxHeight:72,messageBoxHeight:70,addMessageBoxHeight:110,initialize:function(t){_.extend(this,t),Common.UI.BaseView.prototype.initialize.call(this,arguments),this.storeUsers.bind({add:_.bind(this._onResetUsers,this),change:_.bind(this._onResetUsers,this),reset:_.bind(this._onResetUsers,this)}),this.storeMessages.bind({add:_.bind(this._onAddMessage,this),reset:_.bind(this._onResetMessages,this)})},render:function(t){return t=t||this.el,$(t).html(this.template({scope:this,maxMsgLength:Asc.c_oAscMaxCellOrCommentLength})),this.panelBox=$("#chat-box",this.el),this.panelUsers=$("#chat-users",this.el),this.panelMessages=$("#chat-messages",this.el),this.txtMessage=$("#chat-msg-text",this.el),this.panelOptions=$("#chat-options",this.el),this.panelUsers.scroller=new Common.UI.Scroller({el:$("#chat-users"),useKeyboard:!0,minScrollbarLength:25}),this.panelMessages.scroller=new Common.UI.Scroller({el:$("#chat-messages"),includePadding:!0,useKeyboard:!0,minScrollbarLength:40}),this.panelOptions.scroller=new Common.UI.Scroller({el:$("#chat-options")}),$("#chat-msg-btn-add",this.el).on("click",_.bind(this._onBtnAddMessage,this)),this.txtMessage.on("keydown",_.bind(this._onKeyDown,this)),this.setupLayout(),this.trigger("render:after",this),this},focus:function(){var t=this;_.defer(function(){t.txtMessage.focus()},100),this.updateLayout(!0),this.setupAutoSizingTextBox()},_onKeyDown:function(t){t.keyCode==Common.UI.Keys.RETURN?!t.ctrlKey&&!t.metaKey||t.altKey||this._onBtnAddMessage(t):t.keyCode!=Common.UI.Keys.ESC||Common.UI.HintManager.isHintVisible()||this.hide()},_onResetUsers:function(t,e){this.panelUsers&&(this.panelUsers.html(this.templateUserList({users:this.storeUsers.chain().filter(function(t){return t.get("online")}).groupBy(function(t){return t.get("idOriginal")}).value(),usertpl:this.tplUser,scope:this})),this.panelUsers.scroller.update({minScrollbarLength:25,alwaysVisibleY:!0}))},_onAddMessage:function(t,e,i){var n;this.panelMessages&&(n=this.panelMessages.find("ul"))&&n.length&&(this._prepareMessage(t),n.append(_.template(this.tplMsg)({msg:t,scope:this})),this.panelMessages.scroller.update({minScrollbarLength:40,alwaysVisibleY:!0}),this.panelMessages.scroller.scrollTop(n.get(0).getBoundingClientRect().height))},_onResetMessages:function(t,e){this.panelMessages&&(t.each(function(t){this._prepareMessage(t)},this),this.panelMessages.html(this.templateMsgList({messages:t.models,msgtpl:this.tplMsg,scope:this})),this.panelMessages.scroller.update({minScrollbarLength:40,alwaysVisibleY:!0}))},_onBtnAddMessage:function(t){this.txtMessage&&(this.fireEvent("message:add",[this,this.txtMessage.val().trim()]),this.txtMessage.val(""),this.focus())},_prepareMessage:function(t){var e=this.storeUsers.findOriginalUser(t.get("userid"));t.set({usercolor:e?e.get("color"):null,message:this._pickLink(t.get("message"))},{silent:!0})},_pickLink:function(t){for(var i,n,o=[],e=(t.replace(Common.Utils.ipStrongRe,function(t){var e=/[\.,\?\+;:=!\(\)]+$/.exec(t);return e&&(t=t.substring(0,e.index)),i=arguments[arguments.length-2],o.push({start:i,end:t.length+i,str:'<a href="'+t+'" target="_blank" data-can-copy="true">'+t+"</a>"}),""}),(t.length<1e3||t.search(/\S{255,}/)<0)&&t.replace(Common.Utils.hostnameStrongRe,function(t){var e=/[\.,\?\+;:=!\(\)]+$/.exec(t),e=(e&&(t=t.substring(0,e.index)),/(((^https?)|(^ftp)):\/\/)/i.test(t)?t:"http://"+t);return i=arguments[arguments.length-2],n=t.length,_.find(o,function(t){return i>=t.start&&i<t.end||i<=t.start&&i+n>t.start})||o.push({start:i,end:n+i,str:'<a href="'+e+'" target="_blank" data-can-copy="true">'+t+"</a>"}),""}),t.replace(Common.Utils.emailStrongRe,function(t){var e=/((^mailto:)\/\/)/i.test(t)?t:"mailto:"+t;return i=arguments[arguments.length-2],n=t.length,_.find(o,function(t){return i>=t.start&&i<t.end||i<=t.start&&i+n>t.start})||o.push({start:i,end:n+i,str:'<a href="'+e+'">'+t+"</a>"}),""}),0<(o=_.sortBy(o,function(t){return t.start})).length?Common.Utils.String.htmlEncode(t.substring(0,o[0].start))+o[0].str:Common.Utils.String.htmlEncode(t)),s=1;s<o.length;s++)e+=Common.Utils.String.htmlEncode(t.substring(o[s-1].end,o[s].start))+o[s].str;return 0<o.length&&(e+=Common.Utils.String.htmlEncode(t.substring(o[s-1].end,t.length))),e},getUserName:function(t){return Common.Utils.String.htmlEncode(AscCommon.UserInfoParser.getParsedName(t))},hide:function(){Common.UI.BaseView.prototype.hide.call(this,arguments),this.fireEvent("hide",this),this.textBoxAutoSizeLocked=void 0},setupLayout:function(){var e=this,t=$(e.el),i=this.panelBox.find(" > .layout-item"),i=(e.layout=new Common.UI.VBoxLayout({box:this.panelBox,items:[{el:i[0],rely:!0,behaviour:"splitter",resize:{hidden:!1,autohide:!1,fmin:function(){return e.usersBoxHeight},fmax:function(){return.5*e.panelBox.height()-e.messageBoxHeight}}},{el:i[1],rely:!0,behaviour:"splitter",resize:{hidden:!1,autohide:!1,fmin:function(){return Math.max(e.messageBoxHeight+e.usersBoxHeight,.5*e.panelBox.height())},fmax:function(){return e.panelBox.height()-e.addMessageBoxHeight}}},{el:i[2],stretch:!0}]}),e.layout.on("layout:resizedrag",function(t){e.updateScrolls(),e.usersCachedHeigt=e.panelUsers.height()+8+1,t.index||(e.textBoxAutoSizeLocked=!0)},this),$(window).on("resize",function(){"none"!==t.css("display")&&e.updateLayout()}),this.updateLayout(),this.panelBox.height());this.layout.setResizeValue(0,this.usersBoxHeight),this.layout.setResizeValue(1,Math.max(this.addMessageBoxHeight,Math.max(.5*i,i-e.panelOptions.height()-4))),this.setupAutoSizingTextBox(),this.disableTextBoxButton($(this.txtMessage)),this.txtMessage.bind("input propertychange",_.bind(this.onTextareaInput,this))},onTextareaInput:function(t){this.updateHeightTextBox(t),this.disableTextBoxButton($(t.target))},disableTextBoxButton:function(t){var e=$(t.siblings("#chat-msg-btn-add")[0]);0<t.val().trim().length?(e.removeAttr("disabled"),e.removeClass("disabled")):(e.attr("disabled",!0),e.addClass("disabled"))},updateLayout:function(t){var e=this,i=this.panelBox.height();e.layout.setResizeValue(1,Math.max(e.addMessageBoxHeight,Math.max(.5*i,i-e.panelOptions.height()-4))),t?(this.panelUsers.css("height"),this.panelUsers.css("height","1px"),t=this.panelUsers.get(0).scrollHeight,e.layout.setResizeValue(0,Math.max(e.usersBoxHeight,Math.min(t+2,Math.floor(.5*i)-e.messageBoxHeight)))):e.layout.setResizeValue(0,Math.max(e.usersBoxHeight,Math.min(e.usersCachedHeigt+2,Math.floor(.5*i)-e.messageBoxHeight))),e.updateScrolls(),e.updateHeightTextBox(null)},setupAutoSizingTextBox:function(){this.lineHeight=0,this.minHeight=44,this.lineHeight=1.25*parseInt(this.txtMessage.css("lineHeight"),10),this.updateHeightTextBox(!0)},updateHeightTextBox:function(t){var e=this.txtMessage,i=this.panelBox.height();t&&0==e.val().length?(this.layout.setResizeValue(1,Math.max(this.addMessageBoxHeight,i-this.addMessageBoxHeight)),this.textBoxAutoSizeLocked=void 0,this.updateScrolls()):_.isUndefined(this.textBoxAutoSizeLocked)&&(e.height(),e.get(0).scrollHeight,e.css({height:this.minHeight+"px"}),e.height(),t=Math.max(e.get(0).scrollHeight+this.lineHeight,1),e.css({height:"100%"}),i=this.panelBox.height(),this.layout.setResizeValue(1,Math.max(this.addMessageBoxHeight,Math.min(i-t-40,i-this.addMessageBoxHeight)))&&this.updateScrolls())},updateScrolls:function(){this.panelUsers&&this.panelUsers.scroller&&this.panelMessages&&this.panelMessages.scroller&&(this.panelUsers.scroller.update({minScrollbarLength:25,alwaysVisibleY:!0}),this.panelMessages.scroller.update({minScrollbarLength:40,alwaysVisibleY:!0}))}},Common.Views.Chat||{}))}),define("common/main/lib/controller/Chat",["core","common/main/lib/collection/Users","common/main/lib/collection/ChatMessages","common/main/lib/view/Chat"],function(){"use strict";Common.Controllers.Chat=Backbone.Controller.extend(_.extend({models:[],collections:["Common.Collections.Users","Common.Collections.ChatMessages"],views:["Common.Views.Chat"],initialize:function(){this.addListeners({"Common.Views.Chat":{"message:add":_.bind(this.onSendMessage,this)}});var e=this;Common.NotificationCenter.on("layout:changed",function(t){Common.Utils.asyncCall(function(t){"toolbar"!=t&&"status"!=t||!e.panelChat.$el.is(":visible")||(e.panelChat.updateLayout(!0),e.panelChat.setupAutoSizingTextBox())},this,t)})},events:{},onLaunch:function(){this.panelChat=this.createView("Common.Views.Chat",{storeUsers:this.getApplication().getCollection("Common.Collections.Users"),storeMessages:this.getApplication().getCollection("Common.Collections.ChatMessages")}),this.panelChat.on("render:after",_.bind(this.onAfterRender,this))},onAfterRender:function(t){this.getApplication().getController("Viewport").getView("Viewport").hlayout.on("layout:resizedrag",_.bind(function(){t&&t.updateScrolls()},this))},setMode:function(t){return this.mode=t,this.currentUserId=t.user.id,this.api&&(this.mode.canCoAuthoring&&this.mode.canChat&&this.api.asc_registerCallback("asc_onCoAuthoringChatReceiveMessage",_.bind(this.onReceiveMessage,this)),this.mode.isEditDiagram||this.mode.isEditMailMerge||this.mode.isEditOle||(this.api.asc_registerCallback("asc_onAuthParticipantsChanged",_.bind(this.onUsersChanged,this)),this.api.asc_registerCallback("asc_onConnectionStateChanged",_.bind(this.onUserConnection,this)),this.api.asc_coAuthoringGetUsers()),this.mode.canCoAuthoring&&this.mode.canChat&&this.api.asc_coAuthoringChatGetMessages()),this},setApi:function(t){return this.api=t,this},onUsersChanged:function(t,e){if(!this.mode.canLicense||!this.mode.canCoAuthoring){var i=0;for(o in t)void 0!==o&&i++;if(1<i&&null==this._isCoAuthoringStopped)return this._isCoAuthoringStopped=!0,this.api.asc_coAuthoringDisconnect(),void Common.NotificationCenter.trigger("api:disconnect")}var n=this.getApplication().getCollection("Common.Collections.Users");if(n){var o,s,a,l=[];for(o in t)void 0!==o&&(a=t[o])&&(s=new Common.Models.User({id:a.asc_getId(),idOriginal:a.asc_getIdOriginal(),username:a.asc_getUserName(),online:!0,color:a.asc_getColor(),view:a.asc_getView(),hidden:!(a.asc_getIdOriginal()===this.currentUserId||AscCommon.UserInfoParser.isUserVisible(a.asc_getUserName()))}),l[a.asc_getId()==e?"unshift":"push"](s));n[0<n.size()?"add":"reset"](l)}},onUserConnection:function(t){var e,i=this.getApplication().getCollection("Common.Collections.Users");i&&((e=i.findUser(t.asc_getId()))?(e.set({online:t.asc_getState()}),e.set({username:t.asc_getUserName()})):i.add(new Common.Models.User({id:t.asc_getId(),idOriginal:t.asc_getIdOriginal(),username:t.asc_getUserName(),online:t.asc_getState(),color:t.asc_getColor(),view:t.asc_getView(),hidden:!(t.asc_getIdOriginal()===this.currentUserId||AscCommon.UserInfoParser.isUserVisible(t.asc_getUserName()))})))},onReceiveMessage:function(t,e){var i,n=this.getApplication().getCollection("Common.Collections.ChatMessages");n&&(i=[],t.forEach(function(t){i.push(new Common.Models.ChatMessage({userid:t.useridoriginal,message:t.message,username:t.username}))}),n[n.size()<1||e?"reset":"add"](i))},onSendMessage:function(t,e){var i;0<e.length&&(i=this,function(t,e){for(var i=[];t;){if(t.length<e){i.push(t);break}i.push(t.substr(0,e)),t=t.substr(e)}return i}(e,2048).forEach(function(t){i.api.asc_coAuthoringChatSendMessage(t)}))}},Common.Controllers.Chat||{}))}),void 0===Common&&(Common={}),Common.Models=Common.Models||{},define("common/main/lib/model/Plugin",["underscore","backbone","common/main/lib/component/BaseView"],function(t,e){"use strict";Common.Models.PluginVariation=e.Model.extend({defaults:function(){return{description:"",url:"",index:0,icons:void 0,isSystem:!1,isViewer:!1,isDisplayedInViewer:!0,EditorsSupport:["word","cell","slide"],isVisual:!1,isCustomWindow:!1,isModal:!0,isInsideMode:!1,initDataType:0,initData:"",isUpdateOleOnResize:!1,buttons:[],size:[800,600],initOnSelectionChanged:!1,visible:!0}}}),Common.Models.Plugin=e.Model.extend({defaults:function(){return{id:Common.UI.getId(),name:"",baseUrl:"",guid:Common.UI.getId(),variations:[],currentVariation:0,pluginObj:void 0,allowSelected:!1,selected:!1,visible:!0,groupName:"",groupRank:0}}})}),void 0===Common&&(Common={}),Common.Collections=Common.Collections||{},define("common/main/lib/collection/Plugins",["underscore","backbone","common/main/lib/model/Plugin"],function(t,e){"use strict";Common.Collections.Plugins=e.Collection.extend({model:Common.Models.Plugin,hasVisible:function(){return!!this.findWhere({visible:!0})}})}),void 0===Common&&(Common={}),Common.Views=Common.Views||{},define("common/main/lib/view/Plugins",["common/main/lib/util/utils","common/main/lib/component/BaseView","common/main/lib/component/Layout","common/main/lib/component/Window"],function(t){"use strict";Common.Views.Plugins=Common.UI.BaseView.extend(_.extend({el:"#left-panel-plugins",storePlugins:void 0,template:_.template(['<div id="plugins-box" class="layout-ct vbox">','<label id="plugins-header"><%= scope.strPlugins %></label>','<div id="plugins-list" class="">',"</div>","</div>",'<div id="current-plugin-box" class="layout-ct vbox hidden">','<div id="current-plugin-frame" class="">',"</div>",'<div id="current-plugin-header">',"<label></label>",'<div id="id-plugin-close" class="close"></div>',"</div>","</div>",'<div id="plugins-mask" style="display: none;">'].join("")),initialize:function(t){_.extend(this,t),this._locked=!1,this._state={DisabledControls:!1,docProtection:{isReadOnly:!1,isReviewOnly:!1,isFormsOnly:!1,isCommentsOnly:!1}},this.lockedControls=[],Common.UI.BaseView.prototype.initialize.call(this,arguments)},render:function(t){return t&&(this.$el=$(t)),this.$el.html(this.template({scope:this})),this.pluginName=$("#current-plugin-header label"),this.pluginsPanel=$("#plugins-box"),this.pluginsMask=$("#plugins-mask",this.$el),this.currentPluginPanel=$("#current-plugin-box"),this.currentPluginFrame=$("#current-plugin-frame"),this.pluginClose=new Common.UI.Button({parentEl:$("#id-plugin-close"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-close",hint:this.textClosePanel}),this.pluginMenu=new Common.UI.Menu({menuAlign:"tr-br",items:[]}),this.trigger("render:after",this),this},getPanel:function(){var t=$('<section id="plugins-panel" class="panel" data-tab="plugins"></section>'),e=$('<div class="group"></div>');return this.storePlugins.isEmpty()||this.storePlugins.each(function(t){}),e.appendTo(t),t},renderTo:function(t){var o,s,a,e;this.storePlugins.isEmpty()||(o=this,s=$('<div class="group"></div>'),a=Common.enumLock,this.storePlugins.each(function(t){var e,i,n;t.get("visible")&&(n=t.get("variations"),e=t.get("guid"),i=n[t.get("currentVariation")].get("icons"),i=t.get("baseUrl")+o.parseIcons(i),i=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconImg:i,caption:t.get("name"),menu:n&&1<n.length,split:n&&1<n.length,value:e,hint:t.get("name"),lock:t.get("isDisplayedInViewer")?[a.viewMode,a.previewReviewMode,a.viewFormMode,a.selRangeEdit,a.editFormula]:[a.viewMode,a.previewReviewMode,a.viewFormMode,a.lostConnect,a.docLockView,a.docLockForms,a.docLockComments,a.selRangeEdit,a.editFormula],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),n=$('<span class="btn-slot text x-huge"></span>').appendTo(s),i.render(n),t.set("button",i),o.lockedControls.push(i))}),e=o._state.docProtection,Common.Utils.lockControls(Common.enumLock.docLockView,e.isReadOnly,{array:o.lockedControls}),Common.Utils.lockControls(Common.enumLock.docLockForms,e.isFormsOnly,{array:o.lockedControls}),Common.Utils.lockControls(Common.enumLock.docLockComments,e.isCommentsOnly,{array:o.lockedControls}),t.html(s),$('<div class="separator long"></div>').prependTo(t))},setLocked:function(t){this._locked=t},ChangeSettings:function(t){this.disableControls(this._locked)},disableControls:function(e){this._state.DisabledControls!==e&&(this._state.DisabledControls=e,_.each(this.lockedControls,function(t){t.setDisabled(e)}),this.pluginsMask&&this.pluginsMask.css("display",e?"block":"none"))},SetDisabled:function(t,e,i){e?Common.Utils.lockControls(Common.enumLock.previewReviewMode,t,{array:this.lockedControls}):i?Common.Utils.lockControls(Common.enumLock.viewFormMode,t,{array:this.lockedControls}):Common.Utils.lockControls(Common.enumLock.viewMode,t,{array:this.lockedControls})},openInsideMode:function(t,e,i,n){return!!this.pluginsPanel&&(this.pluginsPanel.toggleClass("hidden",!0),this.currentPluginPanel.toggleClass("hidden",!1),this.pluginName.text(t),this.iframePlugin||(this.iframePlugin=document.createElement("iframe"),this.iframePlugin.id=void 0===i?"plugin_iframe":i,this.iframePlugin.name="pluginFrameEditor",this.iframePlugin.width="100%",this.iframePlugin.height="100%",this.iframePlugin.align="top",this.iframePlugin.frameBorder=0,this.iframePlugin.scrolling="no",this.iframePlugin.allow="camera; microphone; display-capture",this.iframePlugin.onload=_.bind(this._onLoad,this),this.currentPluginFrame.append(this.iframePlugin),this.loadMask||(this.loadMask=new Common.UI.LoadMask({owner:this.currentPluginFrame})),this.loadMask.setTitle(this.textLoading),this.loadMask.show(),this.iframePlugin.src=e),this._state.insidePlugin=n,this.fireEvent("plugin:open",[this,"onboard","open"]),!0)},closeInsideMode:function(){this.pluginsPanel&&(this.iframePlugin&&(this.currentPluginFrame.empty(),this.iframePlugin=null),this.currentPluginPanel.toggleClass("hidden",!0),this._state.insidePlugin=void 0,this.fireEvent("plugin:open",[this,"onboard","close"]))},openedPluginMode:function(t){var e,t=this.storePlugins.findWhere({guid:t});t&&(e=t.get("button"))&&(e.toggle(!0),this.updatePluginButton(t),e.menu&&0<e.menu.items.length&&e.menu.items[0].setCaption(this.textStop))},closedPluginMode:function(t){var e,t=this.storePlugins.findWhere({guid:t});t&&(e=t.get("button"))&&(e.toggle(!1),this.updatePluginButton(t),e.menu&&0<e.menu.items.length&&e.menu.items[0].setCaption(this.textStart))},_onLoad:function(){this.loadMask&&this.loadMask.hide()},parseIcons:function(t){var e;if(t.length&&"string"!=typeof t[0]){for(var i=Common.UI.Themes.currentThemeId().toLowerCase(),n=Common.UI.Themes.isDarkTheme()?"dark":"light",o=-1,s=0;s<t.length;s++)if(t[s].theme&&t[s].theme.toLowerCase()==i){o=s;break}if(o<0)for(s=0;s<t.length;s++)if(t[s].style&&t[s].style.toLowerCase()==n){o=s;break}o<0&&(o=0);var a,l,r,c,d=100*Common.Utils.applicationPixelRatio(),h=t[o],m=1e4;for(c in h)h.hasOwnProperty(c)&&("default"==c?l=h[c]:isNaN(parseInt(c))||(a=Math.abs(d-parseInt(c)))<m-.01&&(m=a,r=h[c]));return{normal:(r=.01<m&&l?l:r).normal,hover:r.hover||r.normal,active:r.active||r.normal}}return{normal:e=t[(1<Common.Utils.applicationPixelRatio()?1:0)+(2<t.length?2:0)],hover:e,active:e}},updatePluginIcons:function(t){if(!t.get("visible"))return null;var e=t.get("variations")[t.get("currentVariation")].get("icons");t.set("parsedIcons",this.parseIcons(e)),this.updatePluginButton(t)},updatePluginButton:function(t){if(!t.get("visible"))return null;var e=t.get("button");e&&e.cmpEl&&e.cmpEl.find(".inner-box-icon img").attr("src",t.get("baseUrl")+t.get("parsedIcons")[e.isActive()?"active":"normal"])},createPluginButton:function(t){var n,e,i,o,s;return t.get("visible")?(n=this,o=t.get("variations"),e=t.get("guid"),o=o[t.get("currentVariation")].get("icons"),o=this.parseIcons(o),s=t.get("baseUrl")+o.normal,t.set("parsedIcons",o),i=[],_.each(t.get("variations"),function(t,e){t.get("visible")&&i.push({caption:0<e?t.get("description"):n.textStart,value:parseInt(t.get("index"))})}),o=Common.enumLock,(s=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconImg:s,caption:t.get("name"),menu:1<i.length,split:1<i.length,value:e,hint:t.get("name"),lock:t.get("isDisplayedInViewer")?[o.viewMode,o.previewReviewMode,o.viewFormMode,o.selRangeEdit,o.editFormula]:[o.viewMode,o.previewReviewMode,o.viewFormMode,o.docLockView,o.docLockForms,o.docLockComments,o.selRangeEdit,o.editFormula],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"})).split&&(s.setMenu(new Common.UI.Menu({items:i,pluginGuid:t.get("guid")})),s.menu.on("item:click",function(t,e,i){n.fireEvent("plugin:select",[t.options.pluginGuid,e.value])})),s.on("click",function(t,e){n.fireEvent("plugin:select",[t.options.value,0])}),t.set("button",s),n.lockedControls.push(s),s):null},hide:function(){Common.UI.BaseView.prototype.hide.call(this,arguments),this.fireEvent("hide",this)}},Common.Views.Plugins||{}))}),void 0===Common&&(Common={}),Common.Views=Common.Views||{},define("common/main/lib/view/PluginDlg",["common/main/lib/util/utils","common/main/lib/component/BaseView","common/main/lib/component/Layout","common/main/lib/component/Window"],function(t){"use strict";Common.Views.PluginDlg=Common.UI.Window.extend(_.extend({initialize:function(t){var e={},i=(_.extend(e,{header:!0,enableKeyEvents:!1,automove:!1},t),e.buttons&&0<_.size(e.buttons)?85:34);e.header||(i-=34),this.bordersOffset=40,e.width=Common.Utils.innerWidth()-2*this.bordersOffset-e.width<0?Common.Utils.innerWidth()-2*this.bordersOffset:e.width,e.height+=i,e.height=Common.Utils.innerHeight()-2*this.bordersOffset-e.height<0?Common.Utils.innerHeight()-2*this.bordersOffset:e.height,e.cls+=" advanced-settings-dlg invisible-borders",this.template=['<div id="id-plugin-container" class="box" style="height:'+(e.height-i)+'px;">','<div id="id-plugin-placeholder" style="width: 100%;height: 100%;"></div>',"</div>",'<% if ((typeof buttons !== "undefined") && _.size(buttons) > 0) { %>','<div class="separator horizontal"></div>',"<% } %>"].join(""),e.tpl=_.template(this.template)(e),this.url=t.url||"",this.loader=void 0===t.loader||t.loader,this.frameId=t.frameId||"plugin_iframe",Common.UI.Window.prototype.initialize.call(this,e)},render:function(){Common.UI.Window.prototype.render.call(this),this.$window.find("> .body").css({height:"auto",overflow:"hidden"}),this.boxEl=this.$window.find(".body > .box"),this._headerFooterHeight=this.options.buttons&&0<_.size(this.options.buttons)?85:34,this.options.header||(this._headerFooterHeight-=34),this._headerFooterHeight+=parseInt(this.$window.css("border-top-width"))+parseInt(this.$window.css("border-bottom-width")),this.$window.find(".header").prepend($('<div class="tools left hidden"></div>'));function t(){i.onWindowResize()}var e=document.createElement("iframe"),i=(e.id=this.frameId,e.name="pluginFrameEditor",e.width="100%",e.height="100%",e.align="top",e.frameBorder=0,e.scrolling="no",e.allow="camera; microphone; display-capture",e.onload=_.bind(this._onLoad,this),this),n=this.$window.find("#id-plugin-placeholder");this.loader&&setTimeout(function(){i.isLoaded||(i.loadMask=new Common.UI.LoadMask({owner:n}),i.loadMask.setTitle(i.textLoading),i.loadMask.show(),i.isLoaded&&i.loadMask.hide())},500),e.src=this.url,n.append(e),this.on("resizing",function(t){i.boxEl.css("height",parseInt(i.$window.css("height"))-i._headerFooterHeight)});$(window).on("resize",t),this.on("close",function(){$(window).off("resize",t)})},_onLoad:function(){this.isLoaded=!0,this.loadMask&&this.loadMask.hide()},setInnerSize:function(t,e){var i=Common.Utils.innerHeight(),n=Common.Utils.innerWidth(),o=parseInt(this.$window.css("border-left-width"))+parseInt(this.$window.css("border-right-width")),s=2*this.bordersOffset;i-s<e+this._headerFooterHeight&&(e=i-s-this._headerFooterHeight),n-s<t+o&&(t=n-s-o),this.boxEl.css("height",e),Common.UI.Window.prototype.setHeight.call(this,e+this._headerFooterHeight),Common.UI.Window.prototype.setWidth.call(this,t+o),this.$window.css("left",(n-t-o)/2),this.$window.css("top",(i-e-this._headerFooterHeight)/2),this._restoreHeight=this._restoreWidth=void 0},onWindowResize:function(){var t,e=Common.Utils.innerWidth(),i=Common.Utils.innerHeight(),n=this.getWidth(),o=this.getHeight(),s=this.resizable?0:this.bordersOffset;o<i-2*s+.1?(!this.resizable&&0<this._restoreHeight&&o<this._restoreHeight&&(t=Math.max(Math.min(this._restoreHeight,i-2*s),this.initConfig.minheight),this.setHeight(t),this.boxEl.css("height",t-this._headerFooterHeight)),(t=this.getTop())<s?this.$window.css("top",s):i-s<t+o&&this.$window.css("top",i-s-o)):(void 0===this._restoreHeight&&(this._restoreHeight=o),this.setHeight(Math.max(i-2*s,this.initConfig.minheight)),this.boxEl.css("height",Math.max(i-2*s,this.initConfig.minheight)-this._headerFooterHeight),this.$window.css("top",s)),n<e-2*s+.1?(!this.resizable&&0<this._restoreWidth&&n<this._restoreWidth&&this.setWidth(Math.max(Math.min(this._restoreWidth,e-2*s),this.initConfig.minwidth)),(t=this.getLeft())<s?this.$window.css("left",s):e-s<t+n&&this.$window.css("left",e-s-n)):(void 0===this._restoreWidth&&(this._restoreWidth=n),this.setWidth(Math.max(e-2*s,this.initConfig.minwidth)),this.$window.css("left",s))},showButton:function(t,e){var i,e=this.$window.find(e?".header .tools:not(.left)":".header .tools.left"),n=e.find("#id-plugindlg-"+t);n.length<1&&(i="back"===t?"btn-promote":"btn-"+Common.Utils.String.htmlEncode(t),(n=$('<div id="id-plugindlg-'+t+'" class="tool custom toolbar__icon '+i+'"></div>')).on("click",_.bind(function(){this.fireEvent("header:click",t)},this)),e.append(n)),n.show(),e.removeClass("hidden")},hideButton:function(t){t=this.$window.find(".header #id-plugindlg-"+t);0<t.length&&t.hide()}},Common.Views.PluginDlg||{}))}),define("common/main/lib/controller/Plugins",["core","common/main/lib/collection/Plugins","common/main/lib/view/Plugins","common/main/lib/view/PluginDlg"],function(){"use strict";Common.Controllers.Plugins=Backbone.Controller.extend(_.extend({models:[],appOptions:{},configPlugins:{autostart:[]},serverPlugins:{autostart:[]},collections:["Common.Collections.Plugins"],views:["Common.Views.Plugins"],initialize:function(){var i=this;this.addListeners({Toolbar:{"render:before":function(t){var e=i.getApplication().getController("Main").appOptions;e.isEditMailMerge||e.isEditDiagram||e.isEditOle||(e={action:"plugins",caption:i.panelPlugins.groupCaption,dataHintTitle:"E",layoutname:"toolbar-plugins"},i.$toolbarPanelPlugins=i.panelPlugins.getPanel(),(i.toolbar=t).addTab(e,i.$toolbarPanelPlugins,10))}},"Common.Views.Plugins":{"plugin:select":function(t,e){i.api.asc_pluginRun(t,e,"")}}})},events:function(){return{"click #id-plugin-close":_.bind(this.onToolClose,this)}},onLaunch:function(){var t=this.getApplication().getCollection("Common.Collections.Plugins");this.panelPlugins=this.createView("Common.Views.Plugins",{storePlugins:t}),this.panelPlugins.on("render:after",_.bind(this.onAfterRender,this)),t.on({add:this.onAddPlugin.bind(this),reset:this.onResetPlugins.bind(this)}),this._moveOffset={x:0,y:0},this.autostart=[],this.customPluginsDlg=[],Common.Gateway.on("init",this.loadConfig.bind(this)),Common.NotificationCenter.on("app:face",this.onAppShowed.bind(this)),Common.NotificationCenter.on("uitheme:changed",this.updatePluginsButtons.bind(this)),Common.NotificationCenter.on("window:resize",this.updatePluginsButtons.bind(this)),Common.NotificationCenter.on("app:ready",this.onAppReady.bind(this))},loadConfig:function(t){this.configPlugins.config=t.config.plugins,this.editor=window.DE||window.PDFE?"word":window.PE?"slide":"cell",this.isPDFEditor=!!window.PDFE},loadPlugins:function(){var e;this.configPlugins.plugins=this.serverPlugins.plugins=!1,this.configPlugins.config&&this.getPlugins(this.configPlugins.config.pluginsData).then(function(t){e.configPlugins.plugins=t,e.mergePlugins()}).catch(function(t){e.configPlugins.plugins=!1}),Common.Controllers.Desktop.isActive()&&Common.Controllers.Desktop.isOffline()||(e=this,Common.Utils.loadConfig("../../../../plugins.json",function(t){"error"!=t&&(e.serverPlugins.config=t,e.getPlugins(e.serverPlugins.config.pluginsData).then(function(t){e.serverPlugins.plugins=t,e.mergePlugins()}).catch(function(t){e.serverPlugins.plugins=!1}))}))},onAppShowed:function(t){},onAppReady:function(t){var e=this;new Promise(function(t,e){t()}).then(function(){e.onChangeProtectDocument(),Common.NotificationCenter.on("protect:doclock",_.bind(e.onChangeProtectDocument,e))})},setApi:function(t){return this.api=t,this.appOptions.customization&&!1===this.appOptions.customization.plugins||(this.api.asc_registerCallback("asc_onPluginShow",_.bind(this.onPluginShow,this)),this.api.asc_registerCallback("asc_onPluginClose",_.bind(this.onPluginClose,this)),this.api.asc_registerCallback("asc_onPluginResize",_.bind(this.onPluginResize,this)),this.api.asc_registerCallback("asc_onPluginMouseUp",_.bind(this.onPluginMouseUp,this)),this.api.asc_registerCallback("asc_onPluginMouseMove",_.bind(this.onPluginMouseMove,this)),this.api.asc_registerCallback("asc_onPluginsReset",_.bind(this.resetPluginsList,this)),this.api.asc_registerCallback("asc_onPluginsInit",_.bind(this.onPluginsInit,this)),this.api.asc_registerCallback("asc_onPluginShowButton",_.bind(this.onPluginShowButton,this)),this.api.asc_registerCallback("asc_onPluginHideButton",_.bind(this.onPluginHideButton,this)),this.api.asc_registerCallback("asc_onPluginWindowShow",_.bind(this.onPluginWindowShow,this)),this.api.asc_registerCallback("asc_onPluginWindowClose",_.bind(this.onPluginWindowClose,this)),this.api.asc_registerCallback("asc_onPluginWindowResize",_.bind(this.onPluginWindowResize,this)),this.api.asc_registerCallback("asc_onPluginWindowMouseUp",_.bind(this.onPluginWindowMouseUp,this)),this.api.asc_registerCallback("asc_onPluginWindowMouseMove",_.bind(this.onPluginWindowMouseMove,this))),this},setMode:function(t,e){return this.appOptions=t,this.api=e,this.customPluginsComplete=!this.appOptions.canBrandingExt,this.appOptions.canBrandingExt&&this.getAppCustomPlugins(this.configPlugins),this},onAfterRender:function(t){t.viewPluginsList&&t.viewPluginsList.on("item:click",_.bind(this.onSelectPlugin,this)),this.bindViewEvents(this.panelPlugins,this.events);var i=this;Common.NotificationCenter.on({"layout:resizestart":function(t){var e;i.panelPlugins.isVisible()&&(e=i.panelPlugins.currentPluginFrame.offset(),i._moveOffset={x:e.left+parseInt(i.panelPlugins.currentPluginFrame.css("padding-left")),y:e.top+parseInt(i.panelPlugins.currentPluginFrame.css("padding-top"))},i.api.asc_pluginEnableMouseEvents(!0))},"layout:resizestop":function(t){i.panelPlugins.isVisible()&&i.api.asc_pluginEnableMouseEvents(!1)}})},refreshPluginsList:function(){var t=this.getApplication().getCollection("Common.Collections.Plugins"),i=[];t.each(function(t){var e=new Asc.CPlugin;e.deserialize(t.get("original")),t.set("pluginObj",e),i.push(e)}),this.api.asc_pluginsRegister("",i),t.hasVisible()&&Common.NotificationCenter.trigger("tab:visible","plugins",Common.UI.LayoutManager.isElementVisible("toolbar-plugins")),Common.Gateway.pluginsReady()},onAddPlugin:function(t){var e;this.$toolbarPanelPlugins&&(t=this.panelPlugins.createPluginButton(t))&&(e=$("> .group",this.$toolbarPanelPlugins),e=$('<span class="btn-slot text x-huge"></span>').appendTo(e),t.render(e),e=this.panelPlugins._state.docProtection,Common.Utils.lockControls(Common.enumLock.docLockView,e.isReadOnly,{array:t}),Common.Utils.lockControls(Common.enumLock.docLockForms,e.isFormsOnly,{array:t}),Common.Utils.lockControls(Common.enumLock.docLockComments,e.isCommentsOnly,{array:t}))},onResetPlugins:function(t){var n,o,s,a=this;a.appOptions.canPlugins=!t.isEmpty(),a.$toolbarPanelPlugins&&(a.$toolbarPanelPlugins.empty(),a.toolbar&&a.toolbar.clearMoreButton("plugins"),n=$('<div class="group"></div>'),o=-1,s=0,t.each(function(t){var e,i=t.get("groupRank"),t=(i!==o&&-1<o&&0<s?(n.appendTo(a.$toolbarPanelPlugins),$('<div class="separator long"></div>').appendTo(a.$toolbarPanelPlugins),n=$('<div class="group"></div>'),s=0):(n.appendTo(a.$toolbarPanelPlugins),$('<div class="separator long invisible"></div>').appendTo(a.$toolbarPanelPlugins),n=$('<div class="group" style="'+(Common.UI.isRTL()?"padding-right: 0;":"padding-left: 0;")+'"></div>')),a.panelPlugins.createPluginButton(t));t&&(e=$('<span class="btn-slot text x-huge"></span>').appendTo(n),t.render(e),s++),o=i}),n.appendTo(a.$toolbarPanelPlugins),a.toolbar&&a.toolbar.isTabActive("plugins")&&a.toolbar.processPanelVisible(null,!0,!0),t=a.panelPlugins._state.docProtection,Common.Utils.lockControls(Common.enumLock.docLockView,t.isReadOnly,{array:a.panelPlugins.lockedControls}),Common.Utils.lockControls(Common.enumLock.docLockForms,t.isFormsOnly,{array:a.panelPlugins.lockedControls}),Common.Utils.lockControls(Common.enumLock.docLockComments,t.isCommentsOnly,{array:a.panelPlugins.lockedControls}))},updatePluginsButtons:function(){var t=this.getApplication().getCollection("Common.Collections.Plugins"),e=this;t.each(function(t){e.panelPlugins.updatePluginIcons(t)})},onSelectPlugin:function(t,e,i,n){var o=$(n.target);if(o&&o.hasClass("plugin-caret")){var s=this.panelPlugins.pluginMenu;if(s.isVisible())s.hide();else{var a=this,o=$(n.currentTarget),l=$(this.panelPlugins.el),r=o.offset(),c=l.offset(),r=[r.left-c.left+o.width(),r.top-c.top+o.height()/2];if(null!=i){for(var d=0;d<s.items.length;d++)s.removeItem(s.items[d]),d--;s.removeAll();for(var h=i.get("variations"),d=0;d<h.length;d++){var m=h[d],m=new Common.UI.MenuItem({caption:0<d?m.get("description"):a.panelPlugins.textStart,value:parseInt(m.get("index"))}).on("click",function(t,e){a.api&&a.api.asc_pluginRun(i.get("guid"),t.value,"")});s.addItem(m)}}c=l.find("#menu-plugin-container");s.rendered||(c.length<1&&(c=$('<div id="menu-plugin-container" style="position: absolute; z-index: 10000;"><div class="dropdown-toggle" data-toggle="dropdown"></div></div>',s.id),l.append(c)),s.render(c),s.cmpEl.attr({tabindex:"-1"}),s.on({"show:after":function(t){t&&t.menuAlignEl&&t.menuAlignEl.toggleClass("over",!0)},"hide:after":function(t){t&&t.menuAlignEl&&t.menuAlignEl.toggleClass("over",!1)}})),c.css({left:r[0],top:r[1]}),s.menuAlignEl=o,s.setOffset(-20,-o.height()/2-3),s.show(),_.delay(function(){s.cmpEl.focus()},10),n.stopPropagation(),n.preventDefault()}}else this.api.asc_pluginRun(i.get("guid"),0,"")},onPluginShow:function(e,t,i,n){var o,s,a,l,r,c,d,h,t=e.get_Variations()[t];t.get_Visual()&&(o=this.appOptions&&this.appOptions.lang?this.appOptions.lang.split(/[\-_]/)[0]:"en",h=t.get_Url(),h=(0==e.get_BaseUrl().length?h:e.get_BaseUrl())+h,n&&(h+=n),t.get_InsideMode()?this.panelPlugins.openInsideMode(e.get_Name(o),h,i,e.get_Guid())||this.api.asc_pluginButtonClick(-1,e.get_Guid()):(s=this,n=t.get_CustomWindow(),a=t.get_Buttons(),l=[],r=t.get_Size(),c=t.get_Modal(),(!r||r.length<2)&&(r=[800,600]),_.isArray(a)&&_.each(a,function(t,e){t.visible&&(l[e]={caption:t.text,value:e,primary:t.primary})}),d=t.get_Help(),s.pluginDlg=new Common.Views.PluginDlg({cls:n?"plain":"",header:!n,title:e.get_Name(o),width:r[0],height:r[1],url:h,frameId:i,buttons:n?void 0:l,toolcallback:function(t){s.api.asc_pluginButtonClick(-1,e.get_Guid())},help:!!d,loader:e.get_Loader(),modal:void 0===c||c}),s.pluginDlg.on({"render:after":function(t){t.getChild(".footer .dlg-btn").on("click",function(t){s.api.asc_pluginButtonClick(parseInt(t.currentTarget.attributes.result.value),e.get_Guid())}),s.pluginContainer=s.pluginDlg.$window.find("#id-plugin-container")},close:function(t){s.pluginDlg=void 0},drag:function(t){s.api.asc_pluginEnableMouseEvents("start"==t[1])},resize:function(t){s.api.asc_pluginEnableMouseEvents("start"==t[1])},help:function(){d&&window.open(d,"_blank")},"header:click":function(t){s.api.asc_pluginButtonClick(t,e.get_Guid())}}),s.pluginDlg.show())),this.panelPlugins.openedPluginMode(e.get_Guid())},onPluginClose:function(t){this.pluginDlg?this.pluginDlg.close():this.panelPlugins.iframePlugin&&this.panelPlugins.closeInsideMode(),this.panelPlugins.closedPluginMode(t.get_Guid()),this.runAutoStartPlugins()},onPluginResize:function(t,e,i,n){var o;this.pluginDlg&&(o=e&&1<e.length&&i&&1<i.length&&(i[0]>e[0]||i[1]>e[1]||0==i[0]||0==i[1]),this.pluginDlg.setResizable(o,e,i),this.pluginDlg.setInnerSize(t[0],t[1]),n&&n.call())},onToolClose:function(){this.api.asc_pluginButtonClick(-1,this.panelPlugins?this.panelPlugins._state.insidePlugin:void 0)},onPluginMouseUp:function(t,e){this.pluginDlg?(this.pluginDlg.binding.dragStop&&this.pluginDlg.binding.dragStop(),this.pluginDlg.binding.resizeStop&&this.pluginDlg.binding.resizeStop()):Common.NotificationCenter.trigger("frame:mouseup",{pageX:t*Common.Utils.zoom()+this._moveOffset.x,pageY:e*Common.Utils.zoom()+this._moveOffset.y})},onPluginMouseMove:function(t,e){var i;this.pluginDlg?(i=this.pluginContainer.offset(),this.pluginDlg.binding.drag&&this.pluginDlg.binding.drag({pageX:t*Common.Utils.zoom()+i.left,pageY:e*Common.Utils.zoom()+i.top}),this.pluginDlg.binding.resize&&this.pluginDlg.binding.resize({pageX:t*Common.Utils.zoom()+i.left,pageY:e*Common.Utils.zoom()+i.top})):Common.NotificationCenter.trigger("frame:mousemove",{pageX:t*Common.Utils.zoom()+this._moveOffset.x,pageY:e*Common.Utils.zoom()+this._moveOffset.y})},onPluginsInit:function(t){t instanceof Array||(t=t.pluginsData),this.parsePlugins(t,!1,!0)},onPluginShowButton:function(t,e){this.pluginDlg&&this.pluginDlg.showButton(t,e)},onPluginHideButton:function(t){this.pluginDlg&&this.pluginDlg.hideButton(t)},runAutoStartPlugins:function(){this.autostart&&0<this.autostart.length&&this.api.asc_pluginRun(this.autostart.shift(),0,"")},resetPluginsList:function(){this.getApplication().getCollection("Common.Collections.Plugins").reset()},applyUICustomization:function(){var me=this;return new Promise(function(resolve,reject){var timer_sl=setInterval(function(){if(me.customPluginsComplete){clearInterval(timer_sl);try{me.configPlugins.UIplugins&&me.configPlugins.UIplugins.forEach(function(c){c.code&&eval(c.code)})}catch(e){}resolve()}},10)})},parsePlugins:function(t,e,i){var n,r,c,d=this,h=this.getApplication().getCollection("Common.Collections.Plugins"),m=d.appOptions.isEdit&&!d.isPDFEditor,p=d.editor,u=d.api?d.api.GetVersion():void 0;t instanceof Array?(n=[],r=[],c=d.appOptions.lang.split(/[\-_]/)[0],t.forEach(function(o){var t;if(i)t=(t=(t=n.find(function(t){return t.get("baseUrl")==o.baseUrl||t.get("guid")==o.guid}))||h.findWhere({baseUrl:o.baseUrl}))||h.findWhere({guid:o.guid});else if(n.some(function(t){return t.get("baseUrl")==o.baseUrl||t.get("guid")==o.guid})||h.findWhere({baseUrl:o.baseUrl})||h.findWhere({guid:o.guid}))return;var e,s=[],a=!1,l=!1;o.variations.forEach(function(t){var e,i,n=!0===t.isSystem||"system"===t.type,n=(m||t.isViewer&&!1!==t.isDisplayedInViewer)&&_.contains(t.EditorsSupport,p)&&!n;n&&(a=!0),t.isViewer&&!1!==t.isDisplayedInViewer&&(l=!0),o.isUICustomizer?n&&r.push({url:o.baseUrl+t.url}):(e=new Common.Models.PluginVariation(t),i=t.description,"object"==typeof t.descriptionLocale&&(i=t.descriptionLocale[c]||t.descriptionLocale.en||i||""),_.each(t.buttons,function(t,e){"object"==typeof t.textLocale&&(t.text=t.textLocale[c]||t.textLocale.en||t.text||""),t.visible=m||!1!==t.isViewer}),e.set({description:i,index:s.length,url:t.url,icons:t.icons2||t.icons,buttons:t.buttons,visible:n,help:t.help}),s.push(e))}),0<s.length&&!o.isUICustomizer&&(e=o.name,"object"==typeof o.nameLocale&&(e=o.nameLocale[c]||o.nameLocale.en||e||""),a=a&&d.checkPluginVersion(u,o.minVersion),e={name:e,guid:o.guid,baseUrl:o.baseUrl,variations:s,currentVariation:0,visible:a,groupName:o.group?o.group.name:"",groupRank:o.group?o.group.rank:0,minVersion:o.minVersion,original:o,isDisplayedInViewer:l},t?t.set(e):n.push(new Common.Models.Plugin(e)))}),!1!==e&&(d.configPlugins.UIplugins=r),!e&&h&&((n=h.models.concat(n)).sort(function(t,e){t=t.get("groupRank"),e=e.get("groupRank");return t<e?0==t?1:-1:e<t?0==e?-1:1:0}),h.reset(n),this.appOptions.canPlugins=!h.isEmpty())):e||(this.appOptions.canPlugins=!1),e||this.getApplication().getController("LeftMenu").enablePlugins(),this.appOptions.canPlugins&&(this.refreshPluginsList(),this.runAutoStartPlugins())},checkPluginVersion:function(t,e){if(t&&"develop"!==t&&e&&"string"==typeof e){var i=e.match(/^([0-9]+)(?:.([0-9]+))?(?:.([0-9]+))?$/),n=t.match(/^([0-9]+)(?:.([0-9]+))?(?:.([0-9]+))?$/);if(i&&1<i.length&&n&&1<n.length)for(var o=0;o<3;o++){var s=i[o+1]?parseInt(i[o+1]):0,a=n[o+1]?parseInt(n[o+1]):0;if(a<s)return!1;if(s<a)return!0}}return!0},getPlugins:function(t,e){var i;return!t||t.length<1?Promise.resolve([]):(i=[],t.map(e=e||function(e){return fetch(e).then(function(t){return t.ok?t.json():Promise.reject(e)}).then(function(t){return t.baseUrl=e.substring(0,e.lastIndexOf("config.json")),t})}).reduce(function(t,e){return t.then(function(){return e}).then(function(t){return i.push(t),Promise.resolve(t)}).catch(function(t){return Promise.resolve(t)})},Promise.resolve()).then(function(){return Promise.resolve(i)}))},mergePlugins:function(){var t,e,i,n,o;void 0!==this.serverPlugins.plugins&&void 0!==this.configPlugins.plugins&&(o=[],n=!(t=[]),(e=this.configPlugins).plugins&&0<e.plugins.length&&(t=e.plugins),e&&e.config&&(i=e.config.autostart||e.config.autoStartGuid,n=!!e.config.autoStartGuid,o=(i="string"==typeof i?[i]:i)||[]),(e=this.serverPlugins).plugins&&0<e.plugins.length&&(t=t.concat(e.plugins)),e&&e.config&&(i=e.config.autostart||e.config.autoStartGuid,n||e.config.autoStartGuid,o=o.concat((i="string"==typeof i?[i]:i)||[])),this.autostart=o,this.parsePlugins(t,!1))},getAppCustomPlugins:function(e){function i(){n.customPluginsComplete=!0}var n=this;e.config?this.getPlugins(e.config.UIpluginsData).then(function(t){n.parsePlugins(t,!0),n.getPlugins(e.UIplugins,function(e){return fetch(e.url).then(function(t){return t.ok?t.text():Promise.reject()}).then(function(t){return e.code=t})}).then(i,i)},i):i()},onChangeProtectDocument:function(t){var e;(t=t?t:(e=this.getApplication().getController("DocProtection"))?e.getDocProps():null)&&this.panelPlugins&&(this.panelPlugins._state.docProtection=t,Common.Utils.lockControls(Common.enumLock.docLockView,t.isReadOnly,{array:this.panelPlugins.lockedControls}),Common.Utils.lockControls(Common.enumLock.docLockForms,t.isFormsOnly,{array:this.panelPlugins.lockedControls}),Common.Utils.lockControls(Common.enumLock.docLockComments,t.isCommentsOnly,{array:this.panelPlugins.lockedControls}))},onPluginWindowShow:function(i,e){var n,t,o,s,a,l,r,c,d,h;e.isVisual&&!this.customPluginsDlg[i]&&(n=this.appOptions&&this.appOptions.lang?this.appOptions.lang.split(/[\-_]/)[0]:"en",t=e.url,s=!0===e.isSystem||"system"===e.type,(this.appOptions.isEdit||e.isViewer&&!1!==e.isDisplayedInViewer)&&_.contains(e.EditorsSupport,this.editor)&&!s&&!e.isInsideMode&&(o=this,s=e.isCustomWindow,a=e.buttons,l=[],r=e.size,c=e.isModal,(!r||r.length<2)&&(r=[800,600]),d=e.description,"object"==typeof e.descriptionLocale&&(d=e.descriptionLocale[n]||e.descriptionLocale.en||d||""),_.isArray(a)&&_.each(a,function(t,e){"object"==typeof t.textLocale&&(t.text=t.textLocale[n]||t.textLocale.en||t.text||""),(o.appOptions.isEdit&&!o.isPDFEditor||!1!==t.isViewer)&&(l[e]={caption:t.text,value:e,primary:t.primary,frameId:i})}),h=e.help,o.customPluginsDlg[i]=new Common.Views.PluginDlg({cls:s?"plain":"",header:!s,title:d,width:r[0],height:r[1],url:t,frameId:i,buttons:s?void 0:l,toolcallback:function(t){o.api.asc_pluginButtonClick(-1,e.guid,i)},help:!!h,modal:void 0===c||c}),o.customPluginsDlg[i].on({"render:after":function(t){t.getChild(".footer .dlg-btn").on("click",function(t){o.api.asc_pluginButtonClick(parseInt(t.currentTarget.attributes.result.value),e.guid,i)}),o.customPluginsDlg[i].options.pluginContainer=o.customPluginsDlg[i].$window.find("#id-plugin-container")},close:function(t){o.customPluginsDlg[i]=void 0},drag:function(t){o.api.asc_pluginEnableMouseEvents("start"==t[1],i)},resize:function(t){o.api.asc_pluginEnableMouseEvents("start"==t[1],i)},help:function(){h&&window.open(h,"_blank")},"header:click":function(t){o.api.asc_pluginButtonClick(t,e.guid,i)}}),o.customPluginsDlg[i].show()))},onPluginWindowClose:function(t){this.customPluginsDlg[t]&&this.customPluginsDlg[t].close()},onPluginWindowResize:function(t,e,i,n,o){var s;this.customPluginsDlg[t]&&(s=i&&1<i.length&&n&&1<n.length&&(n[0]>i[0]||n[1]>i[1]||0==n[0]||0==n[1]),this.customPluginsDlg[t].setResizable(s,i,n),this.customPluginsDlg[t].setInnerSize(e[0],e[1]),o&&o.call())},onPluginWindowMouseUp:function(t,e,i){this.customPluginsDlg[t]?(this.customPluginsDlg[t].binding.dragStop&&this.customPluginsDlg[t].binding.dragStop(),this.customPluginsDlg[t].binding.resizeStop&&this.customPluginsDlg[t].binding.resizeStop()):Common.NotificationCenter.trigger("frame:mouseup",{pageX:e*Common.Utils.zoom()+this._moveOffset.x,pageY:i*Common.Utils.zoom()+this._moveOffset.y})},onPluginWindowMouseMove:function(t,e,i){var n;this.customPluginsDlg[t]?(n=this.customPluginsDlg[t].options.pluginContainer.offset(),this.customPluginsDlg[t].binding.drag&&this.customPluginsDlg[t].binding.drag({pageX:e*Common.Utils.zoom()+n.left,pageY:i*Common.Utils.zoom()+n.top}),this.customPluginsDlg[t].binding.resize&&this.customPluginsDlg[t].binding.resize({pageX:e*Common.Utils.zoom()+n.left,pageY:i*Common.Utils.zoom()+n.top})):Common.NotificationCenter.trigger("frame:mousemove",{pageX:e*Common.Utils.zoom()+this._moveOffset.x,pageY:i*Common.Utils.zoom()+this._moveOffset.y})}},Common.Controllers.Plugins||{}))}),define("common/main/lib/view/ExternalEditor",["common/main/lib/component/Window"],function(){"use strict";Common.Views.ExternalEditor=Common.UI.Window.extend(_.extend({initialize:function(t){var e=Common.localStorage.getKeysFilter(),e=e&&e.length?e.split(",")[0]:"",e=(this.storageName=e+(t.storageName||"external-editor"),{}),i=t.initwidth||900,n=t.initheight||700,o=Common.localStorage.getItem(this.storageName+"-width"),o=(o&&(i=parseInt(o)),(o=Common.localStorage.getItem(this.storageName+"-height"))&&(n=parseInt(o)),Common.Utils.innerHeight()-Common.Utils.InternalSettings.get("window-inactive-area-top"));_.extend(e,{width:i,height:o-n<0?o:n,cls:"advanced-settings-dlg",header:!0,toolclose:"hide",toolcallback:_.bind(this.onToolClose,this),resizable:!0},t),this._headerFooterHeight=85,this.template=['<div id="id-editor-container" class="box" style="height:'+(e.height-this._headerFooterHeight)+'px; padding: 0 5px;">','<div id="'+(e.sdkplaceholder||"")+'" style="width: 100%;height: 100%;"></div>',"</div>",'<div class="separator horizontal"></div>','<div class="footer" style="text-align: center;">','<button id="id-btn-editor-apply" class="btn normal dlg-btn primary custom" result="ok" data-hint="1" data-hint-direction="bottom" data-hint-offset="big">'+this.textSave+"</button>",'<button id="id-btn-editor-cancel" class="btn normal dlg-btn" result="cancel" data-hint="1" data-hint-direction="bottom" data-hint-offset="big">'+this.textClose+"</button>","</div>"].join(""),e.tpl=_.template(this.template)(e),this.handler=e.handler,this._isNewObject=!0,this.on("resize",_.bind(this.onWindowResize,this)),Common.UI.Window.prototype.initialize.call(this,e)},render:function(){Common.UI.Window.prototype.render.call(this),this.boxEl=this.$window.find(".body > .box"),this.btnSave=new Common.UI.Button({el:this.$window.find("#id-btn-editor-apply"),disabled:!0}),this.btnCancel=new Common.UI.Button({el:this.$window.find("#id-btn-editor-cancel")}),this.$window.find(".dlg-btn").on("click",_.bind(this.onDlgBtnClick,this))},show:function(){Common.UI.Window.prototype.show.apply(this,arguments)},setEditMode:function(t){this._isNewObject=!t},isEditMode:function(){return!this._isNewObject},setControlsDisabled:function(t){this.btnSave.setDisabled(t),this.btnCancel.setDisabled(t),t?this.$window.find(".tool.close").addClass("disabled"):this.$window.find(".tool.close").removeClass("disabled")},onDlgBtnClick:function(t){this.handler?this.handler.call(this,t.currentTarget.attributes.result.value):this.hide()},onToolClose:function(){this.handler?this.handler.call(this,"cancel"):this.hide()},setHeight:function(t){var e;0<=t&&(e=parseInt(this.$window.css("min-height")),this.$window.height(t=t<e?e:t),e=this.initConfig.header?parseInt(this.$window.find("> .header").css("height")):0,this.$window.find("> .body").css("height",t-e),this.$window.find("> .body > .box").css("height",t-this._headerFooterHeight))},setInCenter:function(){var t=this.$window.height(),t=(Common.Utils.innerHeight()-Common.Utils.InternalSettings.get("window-inactive-area-top")-parseInt(t))/2,e=(Common.Utils.innerWidth()-parseInt(this.initConfig.width))/2;this.$window.css("left",e),this.$window.css("top",Common.Utils.InternalSettings.get("window-inactive-area-top")+t)},setInnerSize:function(t,e){var i=Common.Utils.innerHeight(),n=Common.Utils.innerWidth(),o=parseInt(this.$window.css("border-left-width"))+parseInt(this.$window.css("border-right-width")),s=parseInt(this.boxEl.css("padding-left"))+parseInt(this.boxEl.css("padding-right"));i<(e+=90)+this._headerFooterHeight&&(e=i-this._headerFooterHeight),n<t+s+o&&(t=n-s-o),this.boxEl.css("height",e),this.setHeight(e+this._headerFooterHeight),this.setWidth(t+s+o),this.getLeft()<0&&this.$window.css("left",0),this.getTop()<Common.Utils.InternalSettings.get("window-inactive-area-top")&&this.$window.css("top",Common.Utils.InternalSettings.get("window-inactive-area-top"))},onWindowResize:function(t){t&&"end"==t[1]&&(t=this.getSize(),Common.localStorage.setItem(this.storageName+"-width",t[0]),Common.localStorage.setItem(this.storageName+"-height",t[1]))}},Common.Views.ExternalEditor||{}))}),define("common/main/lib/view/ExternalDiagramEditor",["common/main/lib/view/ExternalEditor"],function(){"use strict";Common.Views.ExternalDiagramEditor=Common.Views.ExternalEditor.extend(_.extend({initialize:function(t){var e={};_.extend(e,{id:"id-external-diagram-editor",title:this.textTitle,storageName:"diagram-editor",sdkplaceholder:"id-diagram-editor-placeholder",initwidth:900,initheight:700,minwidth:730,minheight:275},t),this._chartData=null,Common.Views.ExternalEditor.prototype.initialize.call(this,e)},show:function(){this.setPlaceholder(),Common.Views.ExternalEditor.prototype.show.apply(this,arguments)},setChartData:function(t){this._chartData=t,this._isExternalDocReady&&this.fireEvent("setchartdata",this)},setPlaceholder:function(t){this._placeholder=t},getPlaceholder:function(){return this._placeholder}},Common.Views.ExternalDiagramEditor||{}))}),void 0===Common&&(Common={}),Common.Controllers=Common.Controllers||{},define("common/main/lib/controller/ExternalDiagramEditor",["core","common/main/lib/view/ExternalDiagramEditor"],function(){"use strict";var n,o,s,a,l;Common.Controllers.ExternalDiagramEditor=Backbone.Controller.extend(_.extend((n="zh",o=void 0,s="",l=!(a=null),{views:["Common.Views.ExternalDiagramEditor"],initialize:function(){this.addListeners({"Common.Views.ExternalDiagramEditor":{setchartdata:_.bind(this.setChartData,this),drag:_.bind(function(t,e){a&&a.serviceCommand("window:drag","start"==e)},this),resize:_.bind(function(t,e){a&&a.serviceCommand("window:resize","start"==e)},this),show:_.bind(function(t){var e=this.diagramEditorView.getHeight(),i=Common.Utils.innerHeight()-Common.Utils.InternalSettings.get("window-inactive-area-top");i<e&&this.diagramEditorView.setHeight(i),a?(a.serviceCommand("setAppDisabled",!1),l&&this.diagramEditorView._isExternalDocReady&&(l=!1,this.diagramEditorView._chartData&&this.setChartData()),this.needDisableEditing&&this.diagramEditorView._isExternalDocReady&&this.onDiagrammEditingDisabled(),a.attachMouseEvents()):require(["api"],function(){!function(){Common.UI.HintManager.setInternalEditorLoading(!0),o&&(o.uiTheme=Common.localStorage.getItem("ui-theme-id","theme-light")),a=new DocsAPI.DocEditor("id-diagram-editor-placeholder",{width:"100%",height:"100%",documentType:"cell",document:{url:"_chart_",permissions:{edit:!0,download:!1}},editorConfig:{mode:"editdiagram",targetApp:s,lang:n,canCoAuthoring:!1,canBackToFolder:!1,canCreateNew:!1,customization:o,user:{id:"uid-"+Date.now()}},events:{onAppReady:function(){},onDocumentStateChange:function(){},onError:function(){},onInternalMessage:_.bind(this.onInternalMessage,this)}}),Common.Gateway.on("processmouse",_.bind(this.onProcessMouse,this))}.apply(this)}.bind(this)),this.isExternalEditorVisible=!0,this.isHandlerCalled=!1},this),hide:_.bind(function(t){a&&(a.detachMouseEvents(),this.isExternalEditorVisible=!1),Common.UI.HintManager.setInternalEditorLoading(!1)},this)}})},onLaunch:function(){this.diagramEditorView=this.createView("Common.Views.ExternalDiagramEditor",{handler:_.bind(this.handler,this)})},setApi:function(t){return this.api=t,this.api.asc_registerCallback("asc_onCloseChartEditor",_.bind(this.onDiagrammEditingDisabled,this)),this.api.asc_registerCallback("asc_sendFromGeneralToFrameEditor",_.bind(this.onSendFromGeneralToFrameEditor,this)),this},handler:function(t,e){this.isHandlerCalled||(this.isHandlerCalled=!0,this.diagramEditorView._isExternalDocReady?a&&a.serviceCommand("queryClose",{mr:t}):(this.diagramEditorView.hide(),this.isHandlerCalled=!1))},setChartData:function(){l||(a&&a.serviceCommand("setChartData",this.diagramEditorView._chartData),this.diagramEditorView._chartData=null)},loadConfig:function(t){t&&t.config&&(t.config.lang&&(n=t.config.lang),t.config.customization&&(o=t.config.customization),t.config.targetApp&&(s=t.config.targetApp))},onDiagrammEditingDisabled:function(){this.diagramEditorView.isVisible()&&this.diagramEditorView._isExternalDocReady?(this.diagramEditorView.setControlsDisabled(!0),Common.UI.alert({title:this.warningTitle,msg:this.warningText,iconCls:"warn",buttons:["ok"],callback:_.bind(function(t){this.diagramEditorView.setControlsDisabled(!1),this.diagramEditorView.hide()},this)}),this.needDisableEditing=!1):this.needDisableEditing=!0},onInternalMessage:function(t){var e,i,t=t.data;this.diagramEditorView&&("documentReady"==t.type?(this.diagramEditorView._isExternalDocReady=!0,this.isExternalEditorVisible&&(l=!1),this.diagramEditorView._chartData&&this.setChartData(),this.needDisableEditing&&this.onDiagrammEditingDisabled()):"chartDataReady"==t.type?void 0===this.needDisableEditing&&this.diagramEditorView.setControlsDisabled(!1):"shortcut"==t.type?"escape"==t.data.key&&this.diagramEditorView.hide():"canClose"==t.type?(!0===t.data.answer&&(a&&(a.serviceCommand("setAppDisabled",!0),a.serviceCommand("ok"==t.data.mr?"getChartData":"clearChartData")),this.diagramEditorView.hide()),this.isHandlerCalled=!1):"processMouse"==t.type?"mouse:up"==t.data.event?(this.diagramEditorView.binding.dragStop(),this.diagramEditorView.binding.resizeStop&&this.diagramEditorView.binding.resizeStop()):"mouse:move"==t.data.event&&(e=parseInt(this.diagramEditorView.$window.css("left"))+t.data.pagex,i=parseInt(this.diagramEditorView.$window.css("top"))+t.data.pagey+34,this.diagramEditorView.binding.drag({pageX:e,pageY:i}),this.diagramEditorView.binding.resize&&this.diagramEditorView.binding.resize({pageX:e,pageY:i})):"resize"==t.type?(e=t.data.width,i=t.data.height,0<e&&0<i&&this.diagramEditorView.setInnerSize(e,i)):"frameToGeneralData"==t.type?this.api&&this.api.asc_getInformationBetweenFrameAndGeneralEditor(t.data):this.diagramEditorView.fireEvent("internalmessage",this.diagramEditorView,t))},onProcessMouse:function(t){"mouseup"==t.type&&this.isExternalEditorVisible&&a&&a.serviceCommand("processmouse",t)},onSendFromGeneralToFrameEditor:function(t){a&&a.serviceCommand("generalToFrameData",t)}}),Common.Controllers.ExternalDiagramEditor||{}))}),define("common/main/lib/view/ExternalMergeEditor",["common/main/lib/view/ExternalEditor"],function(){"use strict";Common.Views.ExternalMergeEditor=Common.Views.ExternalEditor.extend(_.extend({initialize:function(t){var e={};_.extend(e,{id:"id-external-merge-editor",title:this.textTitle,storageName:"merge-editor",sdkplaceholder:"id-merge-editor-placeholder",initwidth:900,initheight:700,minwidth:370,minheight:275},t),this._mergeData=null,Common.Views.ExternalEditor.prototype.initialize.call(this,e)},setMergeData:function(t){this._mergeData=t,this._isExternalDocReady&&this.fireEvent("setmergedata",this)}},Common.Views.ExternalMergeEditor||{}))}),void 0===Common&&(Common={}),Common.Controllers=Common.Controllers||{},define("common/main/lib/controller/ExternalMergeEditor",["core","common/main/lib/view/ExternalMergeEditor"],function(){"use strict";var n,o,s,a,l;Common.Controllers.ExternalMergeEditor=Backbone.Controller.extend(_.extend((n="zh",o=void 0,s="",l=!(a=null),{views:["Common.Views.ExternalMergeEditor"],initialize:function(){this.addListeners({"Common.Views.ExternalMergeEditor":{setmergedata:_.bind(this.setMergeData,this),drag:_.bind(function(t,e){a&&a.serviceCommand("window:drag","start"==e)},this),resize:_.bind(function(t,e){a&&a.serviceCommand("window:resize","start"==e)},this),show:_.bind(function(t){var e=this.mergeEditorView.getHeight(),i=Common.Utils.innerHeight();i<e&&this.mergeEditorView.setHeight(i),a?(a.serviceCommand("setAppDisabled",!1),l&&this.mergeEditorView._isExternalDocReady&&(l=!1,this.mergeEditorView._mergeData&&this.setMergeData()),this.needDisableEditing&&this.mergeEditorView._isExternalDocReady&&this.onMergeEditingDisabled(),a.attachMouseEvents()):require(["api"],function(){!function(){Common.UI.HintManager.setInternalEditorLoading(!0),a=new DocsAPI.DocEditor("id-merge-editor-placeholder",{width:"100%",height:"100%",documentType:"cell",document:{url:"_chart_",permissions:{edit:!0,download:!1}},editorConfig:{mode:"editmerge",targetApp:s,lang:n,canCoAuthoring:!1,canBackToFolder:!1,canCreateNew:!1,customization:o,user:{id:"uid-"+Date.now()}},events:{onAppReady:function(){},onDocumentStateChange:function(){},onError:function(){},onInternalMessage:_.bind(this.onInternalMessage,this)}}),Common.Gateway.on("processmouse",_.bind(this.onProcessMouse,this))}.apply(this)}.bind(this)),this.isExternalEditorVisible=!0,this.isHandlerCalled=!1},this),hide:_.bind(function(t){a&&(a.detachMouseEvents(),this.isExternalEditorVisible=!1),Common.UI.HintManager.setInternalEditorLoading(!1)},this)}})},onLaunch:function(){this.mergeEditorView=this.createView("Common.Views.ExternalMergeEditor",{handler:_.bind(this.handler,this)})},setApi:function(t){return this.api=t,this.api.asc_registerCallback("asc_onCloseMergeEditor",_.bind(this.onMergeEditingDisabled,this)),this.api.asc_registerCallback("asc_sendFromGeneralToFrameEditor",_.bind(this.onSendFromGeneralToFrameEditor,this)),this},handler:function(t,e){this.isHandlerCalled||(this.isHandlerCalled=!0,this.mergeEditorView._isExternalDocReady?a&&a.serviceCommand("queryClose",{mr:t}):(this.mergeEditorView.hide(),this.isHandlerCalled=!1))},setMergeData:function(){l||(a&&a.serviceCommand("setMergeData",this.mergeEditorView._mergeData),this.mergeEditorView.setEditMode(!0),this.mergeEditorView._mergeData=null)},loadConfig:function(t){t&&t.config&&(t.config.lang&&(n=t.config.lang),t.config.customization&&(o=t.config.customization),t.config.targetApp&&(s=t.config.targetApp))},onMergeEditingDisabled:function(){this.mergeEditorView.isVisible()&&this.mergeEditorView._isExternalDocReady?(this.mergeEditorView.setControlsDisabled(!0),Common.UI.alert({title:this.warningTitle,msg:this.warningText,iconCls:"warn",buttons:["ok"],callback:_.bind(function(t){this.mergeEditorView.setControlsDisabled(!1),this.mergeEditorView.hide()},this)}),this.needDisableEditing=!1):this.needDisableEditing=!0},onInternalMessage:function(t){var e,i,t=t.data;this.mergeEditorView&&("documentReady"==t.type?(this.mergeEditorView._isExternalDocReady=!0,this.isExternalEditorVisible&&(l=!1),this.mergeEditorView.setControlsDisabled(!1),this.mergeEditorView._mergeData&&(a&&a.serviceCommand("setMergeData",this.mergeEditorView._mergeData),this.mergeEditorView._mergeData=null),this.needDisableEditing&&this.onMergeEditingDisabled()):"shortcut"==t.type?"escape"==t.data.key&&this.mergeEditorView.hide():"canClose"==t.type?(!0===t.data.answer&&(a&&(a.serviceCommand("setAppDisabled",!0),"ok"==t.data.mr&&a.serviceCommand("getMergeData")),this.mergeEditorView.hide()),this.isHandlerCalled=!1):"processMouse"==t.type?"mouse:up"==t.data.event?(this.mergeEditorView.binding.dragStop(),this.mergeEditorView.binding.resizeStop&&this.mergeEditorView.binding.resizeStop()):"mouse:move"==t.data.event&&(e=parseInt(this.mergeEditorView.$window.css("left"))+t.data.pagex,i=parseInt(this.mergeEditorView.$window.css("top"))+t.data.pagey+34,this.mergeEditorView.binding.drag({pageX:e,pageY:i}),this.mergeEditorView.binding.resize&&this.mergeEditorView.binding.resize({pageX:e,pageY:i})):"resize"==t.type?(e=t.data.width,i=t.data.height,0<e&&0<i&&this.mergeEditorView.setInnerSize(e,i)):"frameToGeneralData"==t.type?this.api&&this.api.asc_getInformationBetweenFrameAndGeneralEditor(t.data):this.mergeEditorView.fireEvent("internalmessage",this.mergeEditorView,t))},onProcessMouse:function(t){"mouseup"==t.type&&this.isExternalEditorVisible&&a&&a.serviceCommand("processmouse",t)},onSendFromGeneralToFrameEditor:function(t){a&&a.serviceCommand("generalToFrameData",t)}}),Common.Controllers.ExternalMergeEditor||{}))}),define("common/main/lib/view/ExternalOleEditor",["common/main/lib/view/ExternalEditor"],function(){"use strict";Common.Views.ExternalOleEditor=Common.Views.ExternalEditor.extend(_.extend({initialize:function(t){var e={};_.extend(e,{id:"id-external-ole-editor",title:this.textTitle,storageName:"ole-editor",sdkplaceholder:"id-ole-editor-placeholder",initwidth:900,initheight:700,minwidth:875,minheight:275},t),this._oleData=null,Common.Views.ExternalEditor.prototype.initialize.call(this,e)},setOleData:function(t){this._oleData=t,this._isExternalDocReady&&this.fireEvent("setoledata",this)}},Common.Views.ExternalOleEditor||{}))}),void 0===Common&&(Common={}),Common.Controllers=Common.Controllers||{},define("common/main/lib/controller/ExternalOleEditor",["core","common/main/lib/view/ExternalOleEditor"],function(){"use strict";var n,o,s,a,l;Common.Controllers.ExternalOleEditor=Backbone.Controller.extend(_.extend((n="zh",o=void 0,s="",l=!(a=null),{views:["Common.Views.ExternalOleEditor"],initialize:function(){this.addListeners({"Common.Views.ExternalOleEditor":{setoledata:_.bind(this.setOleData,this),drag:_.bind(function(t,e){a&&a.serviceCommand("window:drag","start"==e)},this),resize:_.bind(function(t,e){a&&a.serviceCommand("window:resize","start"==e)},this),show:_.bind(function(t){var e=this.oleEditorView.getHeight(),i=Common.Utils.innerHeight()-Common.Utils.InternalSettings.get("window-inactive-area-top");i<e&&this.oleEditorView.setHeight(i),a?(a.serviceCommand("setAppDisabled",!1),l&&this.oleEditorView._isExternalDocReady&&(l=!1,this.oleEditorView._oleData&&this.setOleData()),this.needDisableEditing&&this.oleEditorView._isExternalDocReady&&this.onOleEditingDisabled(),a.attachMouseEvents()):require(["api"],function(){!function(){Common.UI.HintManager.setInternalEditorLoading(!0),o&&(o.uiTheme=Common.localStorage.getItem("ui-theme-id","theme-light")),a=new DocsAPI.DocEditor("id-ole-editor-placeholder",{width:"100%",height:"100%",documentType:"cell",document:{url:"_chart_",permissions:{edit:!0,download:!1}},editorConfig:{mode:"editole",targetApp:s,lang:n,canCoAuthoring:!1,canBackToFolder:!1,canCreateNew:!1,customization:o,user:{id:"uid-"+Date.now()}},events:{onAppReady:function(){},onDocumentStateChange:function(){},onError:function(){},onInternalMessage:_.bind(this.onInternalMessage,this)}}),Common.Gateway.on("processmouse",_.bind(this.onProcessMouse,this))}.apply(this)}.bind(this)),this.isExternalEditorVisible=!0,this.isHandlerCalled=!1},this),hide:_.bind(function(t){a&&(a.detachMouseEvents(),this.isExternalEditorVisible=!1),Common.UI.HintManager.setInternalEditorLoading(!1)},this)}})},onLaunch:function(){this.oleEditorView=this.createView("Common.Views.ExternalOleEditor",{handler:_.bind(this.handler,this)})},setApi:function(t){return this.api=t,this.api.asc_registerCallback("asc_onCloseOleEditor",_.bind(this.onOleEditingDisabled,this)),this.api.asc_registerCallback("asc_sendFromGeneralToFrameEditor",_.bind(this.onSendFromGeneralToFrameEditor,this)),this},handler:function(t,e){this.isHandlerCalled||(this.isHandlerCalled=!0,this.oleEditorView._isExternalDocReady?a&&a.serviceCommand("queryClose",{mr:t}):(this.oleEditorView.hide(),this.isHandlerCalled=!1))},setOleData:function(){l||(a&&a.serviceCommand("setOleData",this.oleEditorView._oleData),this.oleEditorView._oleData=null)},loadConfig:function(t){t&&t.config&&(t.config.lang&&(n=t.config.lang),t.config.customization&&(o=t.config.customization),t.config.targetApp&&(s=t.config.targetApp))},onOleEditingDisabled:function(){this.oleEditorView.isVisible()&&this.oleEditorView._isExternalDocReady?(this.oleEditorView.setControlsDisabled(!0),Common.UI.alert({title:this.warningTitle,msg:this.warningText,iconCls:"warn",buttons:["ok"],callback:_.bind(function(t){this.oleEditorView.setControlsDisabled(!1),this.oleEditorView.hide()},this)}),this.needDisableEditing=!1):this.needDisableEditing=!0},onInternalMessage:function(t){var e,i,t=t.data;this.oleEditorView&&("documentReady"==t.type?(this.oleEditorView._isExternalDocReady=!0,this.isExternalEditorVisible&&(l=!1),this.oleEditorView._oleData&&this.setOleData(),this.needDisableEditing&&this.onOleEditingDisabled()):"oleEditorReady"==t.type?void 0===this.needDisableEditing&&this.oleEditorView.setControlsDisabled(!1):"shortcut"==t.type?"escape"==t.data.key&&this.oleEditorView.hide():"canClose"==t.type?(!0===t.data.answer&&(a&&(a.serviceCommand("setAppDisabled",!0),"ok"==t.data.mr&&a.serviceCommand("getOleData")),this.oleEditorView.hide()),this.isHandlerCalled=!1):"processMouse"==t.type?"mouse:up"==t.data.event?(this.oleEditorView.binding.dragStop(),this.oleEditorView.binding.resizeStop&&this.oleEditorView.binding.resizeStop()):"mouse:move"==t.data.event&&(e=parseInt(this.oleEditorView.$window.css("left"))+t.data.pagex,i=parseInt(this.oleEditorView.$window.css("top"))+t.data.pagey+34,this.oleEditorView.binding.drag({pageX:e,pageY:i}),this.oleEditorView.binding.resize&&this.oleEditorView.binding.resize({pageX:e,pageY:i})):"resize"==t.type?(e=t.data.width,i=t.data.height,0<e&&0<i&&this.oleEditorView.setInnerSize(e,i)):"frameToGeneralData"==t.type?this.api&&this.api.asc_getInformationBetweenFrameAndGeneralEditor(t.data):this.oleEditorView.fireEvent("internalmessage",this.oleEditorView,t))},onProcessMouse:function(t){"mouseup"==t.type&&this.isExternalEditorVisible&&a&&a.serviceCommand("processmouse",t)},onSendFromGeneralToFrameEditor:function(t){a&&a.serviceCommand("generalToFrameData",t)}}),Common.Controllers.ExternalOleEditor||{}))}),void 0===Common&&(Common={}),Common.Models=Common.Models||{},define("common/main/lib/model/ReviewChange",["underscore","backbone","common/main/lib/component/BaseView"],function(t,e){"use strict";Common.Models.ReviewChange=e.Model.extend({defaults:{uid:0,userid:0,username:"Guest",usercolor:null,date:void 0,changetext:"",lock:!1,lockuser:"",type:0,changedata:null,hint:!1,editable:!1,id:Common.UI.getId(),scope:null}})}),void 0===Common&&(Common={}),Common.Collections=Common.Collections||{},define("common/main/lib/collection/ReviewChanges",["underscore","backbone","common/main/lib/model/ReviewChange"],function(t,e){"use strict";Common.Collections.ReviewChanges=e.Collection.extend({model:Common.Models.ReviewChange})}),void 0===Common&&(Common={}),Common.Views=Common.Views||{},define("common/main/lib/view/ReviewChanges",["common/main/lib/util/utils","common/main/lib/component/Button","common/main/lib/component/DataView","common/main/lib/component/Layout","common/main/lib/component/Window"],function(){"use strict";Common.enumLock||(Common.enumLock={});var t,e={noSpellcheckLangs:"no-spellcheck-langs",isReviewOnly:"review-only",reviewChangelock:"review-change-lock",hasCoeditingUsers:"has-coediting-users",previewReviewMode:"preview-review-mode",viewFormMode:"view-form-mode",viewMode:"view-mode",hideComments:"hide-comments",cantShare:"cant-share"};for(t in e)e.hasOwnProperty(t)&&(Common.enumLock[t]=e[t]);Common.Views.ReviewChanges=Common.UI.BaseView.extend(_.extend({options:{},initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t),this.appConfig=t.mode,this.lockedControls=[];var e,t=Common.localStorage.getKeysFilter(),t=(this.appPrefix=t&&t.length?t.split(",")[0]:"",Common.enumLock);this.appConfig.canReview&&(this.btnAccept=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",caption:this.txtAccept,split:!this.appConfig.canUseReviewPermissions,iconCls:"toolbar__icon btn-review-save",lock:[t.reviewChangelock,t.isReviewOnly,t.previewReviewMode,t.viewFormMode,t.lostConnect,t.docLockView,t.docLockForms,t.docLockComments,t.docLockReview],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.lockedControls.push(this.btnAccept),this.btnReject=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",caption:this.txtReject,split:!this.appConfig.canUseReviewPermissions,iconCls:"toolbar__icon btn-review-deny",lock:[t.reviewChangelock,t.isReviewOnly,t.previewReviewMode,t.viewFormMode,t.lostConnect,t.docLockView,t.docLockForms,t.docLockComments,t.docLockReview],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.lockedControls.push(this.btnReject),this.appConfig.canFeatureComparison&&(this.btnCompare=new Common.UI.Button({cls:"btn-toolbar  x-huge icon-top",caption:this.txtCompare,split:!0,iconCls:"toolbar__icon btn-compare",lock:[t.hasCoeditingUsers,t.previewReviewMode,t.viewFormMode,t.lostConnect,t.docLockView,t.docLockForms,t.docLockComments],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.lockedControls.push(this.btnCompare),this.btnCombine=new Common.UI.Button({cls:"btn-toolbar  x-huge icon-top",caption:this.txtCombine,split:!0,iconCls:"toolbar__icon btn-combine",lock:[t.hasCoeditingUsers,t.previewReviewMode,t.viewFormMode,t.lostConnect,t.docLockView,t.docLockForms,t.docLockComments],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.lockedControls.push(this.btnCombine)),this.btnTurnOn=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-big-ic-review",lock:[t.previewReviewMode,t.viewFormMode,t.lostConnect,t.docLockView,t.docLockForms,t.docLockComments,t.docLockReview],caption:this.txtTurnon,split:!this.appConfig.isReviewOnly,enableToggle:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.btnsTurnReview=[this.btnTurnOn],this.lockedControls.push(this.btnTurnOn)),this.appConfig.canViewReview&&(this.btnPrev=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-review-prev",lock:[t.previewReviewMode,t.viewFormMode,t.lostConnect,t.docLockView,t.docLockForms,t.docLockComments],caption:this.txtPrev,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.lockedControls.push(this.btnPrev),this.btnNext=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-review-next",lock:[t.previewReviewMode,t.viewFormMode,t.lostConnect,t.docLockView,t.docLockForms,t.docLockComments],caption:this.txtNext,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.lockedControls.push(this.btnNext),this.appConfig.isRestrictedEdit||this.appConfig.customization&&this.appConfig.customization.review&&this.appConfig.customization.review.hideReviewDisplay||(e=_.template('<a id="<%= id %>" tabindex="-1" type="menuitem"><div><b><%= caption %></b></div><% if (options.description !== null) { %><label class="description"><%= options.description %></label><% } %></a>'),this.btnReviewView=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-ic-reviewview",lock:[t.viewFormMode,t.lostConnect,t.docLockView,t.docLockForms,t.docLockComments],caption:this.txtView,menu:new Common.UI.Menu({cls:"ppm-toolbar",items:[{caption:this.txtMarkupCap,checkable:!0,toggleGroup:"menuReviewView",checked:!0,value:"markup",template:e,description:Common.Utils.String.format(this.txtMarkup,this.appConfig.isEdit||this.appConfig.isRestrictedEdit?"("+this.txtEditing+")":"")},{caption:this.txtMarkupSimpleCap,checkable:!0,toggleGroup:"menuReviewView",checked:!1,value:"simple",template:e,description:Common.Utils.String.format(this.txtMarkupSimple,this.appConfig.isEdit||this.appConfig.isRestrictedEdit?"("+this.txtEditing+")":"")},{caption:this.txtFinalCap,checkable:!0,toggleGroup:"menuReviewView",checked:!1,template:e,description:Common.Utils.String.format(this.txtFinal,this.appConfig.isEdit||this.appConfig.isRestrictedEdit?"("+this.txtPreview+")":""),value:"final"},{caption:this.txtOriginalCap,checkable:!0,toggleGroup:"menuReviewView",checked:!1,template:e,description:Common.Utils.String.format(this.txtOriginal,this.appConfig.isEdit||this.appConfig.isRestrictedEdit?"("+this.txtPreview+")":""),value:"original"}]}),dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.lockedControls.push(this.btnReviewView))),(this.appConfig.sharingSettingsUrl&&this.appConfig.sharingSettingsUrl.length||this.appConfig.canRequestSharingSettings)&&!0!==this._readonlyRights&&(this.btnSharing=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-ic-sharing",lock:[t.viewFormMode,t.cantShare,t.lostConnect],caption:this.txtSharing,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.lockedControls.push(this.btnSharing)),this.appConfig.isEdit&&!this.appConfig.isOffline&&this.appConfig.canCoAuthoring&&this.appConfig.canChangeCoAuthoring&&(this.btnCoAuthMode=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-ic-coedit",lock:[t.viewFormMode,t.lostConnect,t.docLockView],caption:this.txtCoAuthMode,menu:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.lockedControls.push(this.btnCoAuthMode)),this.btnsSpelling=[],this.btnsDocLang=[],this.appConfig.canUseHistory&&!this.appConfig.isDisconnected&&(this.btnHistory=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-ic-history",lock:[t.lostConnect],caption:this.txtHistory,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.lockedControls.push(this.btnHistory)),this.appConfig.canCoAuthoring&&this.appConfig.canChat&&(this.btnChat=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-ic-chat",lock:[t.lostConnect],caption:this.txtChat,enableToggle:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.lockedControls.push(this.btnChat)),this.appConfig.canCoAuthoring&&this.appConfig.canComments&&(this.canComments=!0,this.btnCommentRemove=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",caption:this.txtCommentRemove,split:!0,iconCls:"toolbar__icon btn-rem-comment",lock:[t.previewReviewMode,t.viewFormMode,t.hideComments,t.Objects,t.lostConnect,t.docLockView,t.docLockForms],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.lockedControls.push(this.btnCommentRemove),this.btnCommentResolve=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",caption:this.txtCommentResolve,split:!0,iconCls:"toolbar__icon btn-resolve-all",lock:[t.previewReviewMode,t.viewFormMode,t.hideComments,t.Objects,t.lostConnect,t.docLockView,t.docLockForms],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.lockedControls.push(this.btnCommentResolve))},render:function(t){return this.boxSdk=$("#editor_sdk"),t&&t.html(this.getPanel()),this},onAppReady:function(a){var l=this;new Promise(function(t,e){t()}).then(function(){var t,e=_.template('<a id="<%= id %>" tabindex="-1" type="menuitem"><div><b><%= caption %></b></div><% if (options.description !== null) { %><label class="description"><%= options.description %></label><% } %></a>'),i=(a.canReview&&(i=Common.Utils.InternalSettings.get(l.appPrefix+"track-changes"),a.isReviewOnly||l.btnTurnOn.setMenu(new Common.UI.Menu({items:[{caption:l.txtOn,value:0,checkable:!0,checked:0==i,toggleGroup:"menuTurnReviewTlb"},{caption:l.txtOff,value:1,checkable:!0,checked:1==i,toggleGroup:"menuTurnReviewTlb"},{caption:l.txtOnGlobal,value:2,checkable:!0,checked:2==i,toggleGroup:"menuTurnReviewTlb"},{caption:l.txtOffGlobal,value:3,checkable:!0,checked:3==i,toggleGroup:"menuTurnReviewTlb"}]})),l.btnTurnOn.updateHint(l.tipReview),l.appConfig.canUseReviewPermissions||(l.btnAccept.setMenu(new Common.UI.Menu({items:[{caption:l.txtAcceptCurrent,value:"current"},{caption:l.txtAcceptAll,value:"all"}]})),l.btnReject.setMenu(new Common.UI.Menu({items:[{caption:l.txtRejectCurrent,value:"current"},{caption:l.txtRejectAll,value:"all"}]}))),l.btnAccept.updateHint([l.tipAcceptCurrent,l.txtAcceptChanges]),l.btnReject.updateHint([l.tipRejectCurrent,l.txtRejectChanges]),a.canFeatureComparison&&(l.btnCompare.setMenu(new Common.UI.Menu({items:[{caption:l.mniFromFile,value:"file"},{caption:l.mniFromUrl,value:"url"},{caption:l.mniFromStorage,value:"storage"}]})),l.btnCompare.menu.items[2].setVisible(l.appConfig.canRequestSelectDocument||l.appConfig.canRequestCompareFile||l.appConfig.fileChoiceUrl&&-1<l.appConfig.fileChoiceUrl.indexOf("{documentType}")),l.btnCompare.menu.items[1].setDisabled(l.appConfig.disableNetworkFunctionality),l.btnCompare.menu.items[2].setDisabled(l.appConfig.disableNetworkFunctionality),l.btnCompare.updateHint(l.tipCompare),l.btnCombine.setMenu(new Common.UI.Menu({items:[{caption:l.mniFromFile,value:"file"},{caption:l.mniFromUrl,value:"url"},{caption:l.mniFromStorage,value:"storage"}]})),l.btnCombine.menu.items[2].setVisible(l.appConfig.canRequestSelectDocument||l.appConfig.fileChoiceUrl&&-1<l.appConfig.fileChoiceUrl.indexOf("{documentType}")),l.btnCombine.menu.items[1].setDisabled(l.appConfig.disableNetworkFunctionality),l.btnCombine.menu.items[2].setDisabled(l.appConfig.disableNetworkFunctionality),l.btnCombine.updateHint(l.tipCombine)),Common.Utils.lockControls(Common.enumLock.isReviewOnly,a.isReviewOnly,{array:[l.btnAccept,l.btnReject]})),l.appConfig.canViewReview&&(l.btnPrev.updateHint(l.hintPrev),l.btnNext.updateHint(l.hintNext),l.btnReviewView&&l.btnReviewView.updateHint(l.tipReviewView)),l.btnSharing&&l.btnSharing.updateHint(l.tipSharing),l.btnHistory&&l.btnHistory.updateHint(l.tipHistory),l.btnChat&&l.btnChat.updateHint(l.txtChat+Common.Utils.String.platformKey("Alt+Q"," ("+(Common.Utils.isMac?Common.Utils.String.textCtrl+"+":"")+"{0})")),l.btnCoAuthMode&&(l.btnCoAuthMode.setMenu(new Common.UI.Menu({cls:"ppm-toolbar",style:"max-width: 220px;",items:[{caption:l.strFast,checkable:!0,toggleGroup:"menuCoauthMode",checked:!0,template:e,description:l.strFastDesc,value:1},{caption:l.strStrict,checkable:!0,toggleGroup:"menuCoauthMode",checked:!1,template:e,description:l.strStrictDesc,value:0}]})),l.btnCoAuthMode.updateHint(l.tipCoAuthMode),l.turnCoAuthMode(Common.Utils.InternalSettings.get(l.appPrefix+"settings-coauthmode"))),l.btnCommentRemove&&(n=[{caption:a.canDeleteComments?l.txtCommentRemCurrent:l.txtCommentRemMyCurrent,value:"current"},{caption:l.txtCommentRemMy,value:"my"}],a.canDeleteComments&&n.push({caption:l.txtCommentRemAll,value:"all"}),l.btnCommentRemove.setMenu(new Common.UI.Menu({items:n})),l.btnCommentRemove.updateHint([l.tipCommentRemCurrent,l.tipCommentRem])),l.btnCommentResolve&&(n=[{caption:a.canEditComments?l.txtCommentResolveCurrent:l.txtCommentResolveMyCurrent,value:"current"},{caption:l.txtCommentResolveMy,value:"my"}],a.canEditComments&&n.push({caption:l.txtCommentResolveAll,value:"all"}),l.btnCommentResolve.setMenu(new Common.UI.Menu({items:n})),l.btnCommentResolve.updateHint([l.tipCommentResolveCurrent,l.tipCommentResolve])),l.btnSharing||l.btnCoAuthMode?".separator.sharing":l.$el.find(".separator.sharing")),e=l.btnCommentRemove||l.btnCommentResolve?".separator.comments":l.$el.find(".separator.comments"),n=a.canReview||a.canViewReview?".separator.review":l.$el.find(".separator.review"),o=a.canReview&&a.canFeatureComparison?".separator.compare":l.$el.find(".separator.compare"),s=l.btnChat?".separator.chat":l.$el.find(".separator.chat");"object"==typeof i?i.hide().prev(".group").hide():t=i,"object"==typeof e?e.hide().prev(".group").hide():t=e,"object"==typeof n?n.hide().prevUntil(".separator.comments").hide():t=n,"object"==typeof o?o.hide().prev(".group").hide():t=o,"object"==typeof s?s.hide().prev(".group").hide():t=s,!l.btnHistory&&t&&l.$el.find(t).hide(),Common.NotificationCenter.trigger("tab:visible","review",(a.isEdit||a.canViewReview||l.canComments)&&Common.UI.LayoutManager.isElementVisible("toolbar-collaboration")),function(){var o=this;o.appConfig.canReview&&(this.btnAccept.on("click",function(t){o.fireEvent("reviewchange:accept",[o.btnAccept,"current"])}),this.btnAccept.menu&&this.btnAccept.menu.on("item:click",function(t,e,i){o.fireEvent("reviewchange:accept",[t,e])}),this.btnReject.on("click",function(t){o.fireEvent("reviewchange:reject",[o.btnReject,"current"])}),this.btnReject.menu&&this.btnReject.menu.on("item:click",function(t,e,i){o.fireEvent("reviewchange:reject",[t,e])}),o.appConfig.canFeatureComparison&&(this.btnCompare.on("click",function(t){o.fireEvent("reviewchange:compare",["file"])}),this.btnCompare.menu.on("item:click",function(t,e,i){o.fireEvent("reviewchange:compare",[e.value])}),this.btnCombine.on("click",function(t){o.fireEvent("reviewchange:combine",["file"])}),this.btnCombine.menu.on("item:click",function(t,e,i){o.fireEvent("reviewchange:combine",[e.value])})),this.btnsTurnReview.forEach(function(t){t.on("click",function(t,e){Common.NotificationCenter.trigger("reviewchanges:turn",t.pressed),Common.NotificationCenter.trigger("edit:complete")}),o.appConfig.isReviewOnly||t.menu.on("item:toggle",function(t,e,i,n){i&&(2==e.value?Common.UI.warning({title:o.textWarnTrackChangesTitle,msg:o.textWarnTrackChanges,maxwidth:600,buttons:[{value:"enable",caption:o.textEnable},"cancel"],primary:"enable",callback:function(t){"enable"==t?Common.NotificationCenter.trigger("reviewchanges:turn",0==e.value||2==e.value,1<e.value):(t=Common.Utils.InternalSettings.get(o.appPrefix+"track-changes"),o.turnChanges(0==t||2==t,1<t)),Common.NotificationCenter.trigger("edit:complete")}}):Common.NotificationCenter.trigger("reviewchanges:turn",0==e.value||2==e.value,1<e.value))})})),this.appConfig.canViewReview&&(this.btnPrev.on("click",function(t){o.fireEvent("reviewchange:preview",[o.btnPrev,"prev"])}),this.btnNext.on("click",function(t){o.fireEvent("reviewchange:preview",[o.btnNext,"next"])}),this.btnReviewView&&this.btnReviewView.menu.on("item:click",function(t,e,i){o.fireEvent("reviewchange:view",[t,e])})),this.btnsSpelling.forEach(function(t){t.on("click",function(t,e){Common.NotificationCenter.trigger("spelling:turn",t.pressed?"on":"off"),Common.NotificationCenter.trigger("edit:complete",o)})}),this.btnsDocLang.forEach(function(t){t.on("click",function(t,e){o.fireEvent("lang:document",this)})}),this.btnSharing&&this.btnSharing.on("click",function(t,e){Common.NotificationCenter.trigger("collaboration:sharing")}),this.btnCoAuthMode&&this.btnCoAuthMode.menu.on("item:click",function(t,e,i){o.fireEvent("collaboration:coauthmode",[t,e])}),this.btnHistory&&this.btnHistory.on("click",function(t,e){Common.NotificationCenter.trigger("collaboration:history")}),this.btnChat&&this.btnChat.on("click",function(t,e){o.fireEvent("collaboration:chat",[t.pressed])}),this.btnCommentRemove&&(this.btnCommentRemove.on("click",function(t){o.fireEvent("comment:removeComments",["current"])}),this.btnCommentRemove.menu.on("item:click",function(t,e,i){o.fireEvent("comment:removeComments",[e.value])})),this.btnCommentResolve&&(this.btnCommentResolve.on("click",function(t){o.fireEvent("comment:resolveComments",["current"])}),this.btnCommentResolve.menu.on("item:click",function(t,e,i){o.fireEvent("comment:resolveComments",[e.value])})),Common.NotificationCenter.on("protect:doclock",function(t){o.fireEvent("protect:update")}),o.fireEvent("protect:update")}.call(l)})},getPanel:function(){return this.$el=$(_.template('<section id="review-changes-panel" class="panel" data-tab="review"><div class="group no-group-mask review"><span id="slot-btn-sharing" class="btn-slot text x-huge"></span><span id="slot-btn-coauthmode" class="btn-slot text x-huge"></span></div><div class="separator long sharing"></div><div class="group"><span class="btn-slot text x-huge slot-comment"></span><span class="btn-slot text x-huge" id="slot-comment-remove"></span><span class="btn-slot text x-huge" id="slot-comment-resolve"></span></div><div class="separator long comments"></div><div class="group"><span id="btn-review-on" class="btn-slot text x-huge"></span></div><div class="group no-group-mask review" style="padding-left: 0;padding-right:0;"><span id="btn-review-view" class="btn-slot text x-huge"></span></div><div class="group move-changes" style="padding-left: 0;padding-right:0;"><span id="btn-change-prev" class="btn-slot text x-huge"></span><span id="btn-change-next" class="btn-slot text x-huge"></span><span id="btn-change-accept" class="btn-slot text x-huge"></span><span id="btn-change-reject" class="btn-slot text x-huge"></span></div><div class="separator long review"></div><div class="group"><span id="slot-btn-compare" class="btn-slot text x-huge"></span><span id="slot-btn-combine" class="btn-slot text x-huge"></span></div><div class="separator long compare"></div><div class="group no-group-mask review form-view"><span id="slot-btn-chat" class="btn-slot text x-huge"></span></div><div class="separator long chat"></div><div class="group no-group-mask review form-view"><span id="slot-btn-history" class="btn-slot text x-huge"></span></div></section>')({})),this.appConfig.canReview&&(this.btnAccept.render(this.$el.find("#btn-change-accept")),this.btnReject.render(this.$el.find("#btn-change-reject")),this.appConfig.canFeatureComparison&&this.btnCompare.render(this.$el.find("#slot-btn-compare")),this.appConfig.canFeatureComparison&&this.btnCombine.render(this.$el.find("#slot-btn-combine")),this.btnTurnOn.render(this.$el.find("#btn-review-on"))),this.btnPrev&&this.btnPrev.render(this.$el.find("#btn-change-prev")),this.btnNext&&this.btnNext.render(this.$el.find("#btn-change-next")),this.btnReviewView&&this.btnReviewView.render(this.$el.find("#btn-review-view")),this.btnSharing&&this.btnSharing.render(this.$el.find("#slot-btn-sharing")),this.btnCoAuthMode&&this.btnCoAuthMode.render(this.$el.find("#slot-btn-coauthmode")),this.btnHistory&&this.btnHistory.render(this.$el.find("#slot-btn-history")),this.btnChat&&this.btnChat.render(this.$el.find("#slot-btn-chat")),this.btnCommentRemove&&this.btnCommentRemove.render(this.$el.find("#slot-comment-remove")),this.btnCommentResolve&&this.btnCommentResolve.render(this.$el.find("#slot-comment-resolve")),this.$el},show:function(){Common.UI.BaseView.prototype.show.call(this),this.fireEvent("show",this)},getButton:function(t,e){var i;return"turn"==t&&"statusbar"==e?(i=new Common.UI.Button({cls:"btn-toolbar",iconCls:"toolbar__icon btn-ic-review",lock:[Common.enumLock.viewMode,Common.enumLock.previewReviewMode,Common.enumLock.viewFormMode,Common.enumLock.lostConnect,Common.enumLock.docLockView,Common.enumLock.docLockForms,Common.enumLock.docLockComments,Common.enumLock.docLockReview],hintAnchor:"top",hint:this.tipReview,split:!this.appConfig.isReviewOnly,enableToggle:!0,menu:!this.appConfig.isReviewOnly&&new Common.UI.Menu({menuAlign:"bl-tl",style:"margin-top:-5px;",items:[{caption:this.txtOn,value:0,checkable:!0,toggleGroup:"menuTurnReviewStb"},{caption:this.txtOff,value:1,checkable:!0,toggleGroup:"menuTurnReviewStb"},{caption:this.txtOnGlobal,value:2,checkable:!0,toggleGroup:"menuTurnReviewStb"},{caption:this.txtOffGlobal,value:3,checkable:!0,toggleGroup:"menuTurnReviewStb"}]}),dataHint:"0",dataHintDirection:"top",dataHintOffset:"2, -16"}),this.btnsTurnReview.push(i),this.lockedControls.push(i),i):"spelling"==t?(i=new Common.UI.Button({cls:"btn-toolbar",iconCls:"toolbar__icon btn-ic-docspell",lock:[Common.enumLock.viewMode,Common.enumLock.viewFormMode,Common.enumLock.previewReviewMode,Common.enumLock.docLockView,Common.enumLock.docLockForms,Common.enumLock.docLockComments],hintAnchor:"top",hint:this.tipSetSpelling,enableToggle:!0,dataHint:"0",dataHintDirection:"top",dataHintOffset:"small",visible:Common.UI.FeaturesManager.canChange("spellcheck")}),this.btnsSpelling.push(i),this.lockedControls.push(i),i):"doclang"==t&&"statusbar"==e?(i=new Common.UI.Button({cls:"btn-toolbar",iconCls:"toolbar__icon btn-ic-doclang",lock:[Common.enumLock.viewMode,Common.enumLock.previewReviewMode,Common.enumLock.viewFormMode,Common.enumLock.noSpellcheckLangs,Common.enumLock.lostConnect,Common.enumLock.docLockView,Common.enumLock.docLockForms,Common.enumLock.docLockComments],hintAnchor:"top",hint:this.tipSetDocLang,dataHint:"0",dataHintDirection:"top",dataHintOffset:"small"}),this.btnsDocLang.push(i),this.lockedControls.push(i),Common.Utils.lockControls(Common.enumLock.noSpellcheckLangs,!0,{array:[i]}),i):void 0},getButtons:function(){return this.lockedControls},getUserName:function(t){return Common.Utils.String.htmlEncode(AscCommon.UserInfoParser.getParsedName(t))},turnChanges:function(e,i){this.btnsTurnReview.forEach(function(t){t&&t.pressed!=e&&t.toggle(e,!0),t.menu&&(t.menu.items[0].setChecked(e&&!i,!0),t.menu.items[1].setChecked(!e&&!i,!0),t.menu.items[2].setChecked(e&&!!i,!0),t.menu.items[3].setChecked(!e&&!!i,!0))},this)},markChanges:function(e){this.btnsTurnReview.forEach(function(t){t&&$(".icon",t.cmpEl)[e?"addClass":"removeClass"]("btn-ic-changes")},this)},turnSpelling:function(e){this.btnsSpelling&&this.btnsSpelling.forEach(function(t){t&&t.pressed!=e&&t.toggle(e,!0)},this)},turnCoAuthMode:function(t){this.btnCoAuthMode&&(this.btnCoAuthMode.menu.items[0].setChecked(t,!0),this.btnCoAuthMode.menu.items[1].setChecked(!t,!0))},turnChat:function(t){this.btnChat&&this.btnChat.toggle(t,!0)},turnDisplayMode:function(t){this.btnReviewView&&(this.btnReviewView.menu.items[0].setChecked("markup"==t,!0),this.btnReviewView.menu.items[1].setChecked("simple"==t,!0),this.btnReviewView.menu.items[2].setChecked("final"==t,!0),this.btnReviewView.menu.items[3].setChecked("original"==t,!0))},onLostEditRights:function(){this._readonlyRights=!0}},Common.Views.ReviewChanges||{})),Common.Views.ReviewChangesDialog=Common.UI.Window.extend(_.extend({options:{width:330,height:90,title:"Review Changes",modal:!1,cls:"review-changes modal-dlg",alias:"Common.Views.ReviewChangesDialog"},initialize:function(t){_.extend(this.options,{title:this.textTitle},t||{}),this.template=['<div class="box">','<div class="input-row">','<div id="id-review-button-prev" style=""></div>','<div id="id-review-button-next" style=""></div>','<div id="id-review-button-accept" style=""></div>','<div id="id-review-button-reject" style="margin-right: 0;"></div>',"</div>","</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),this.popoverChanges=this.options.popoverChanges,this.mode=this.options.mode,this.docProtection=this.options.docProtection;t=Common.localStorage.getKeysFilter();this.appPrefix=t&&t.length?t.split(",")[0]:"",Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var t=Common.enumLock,t=(this.btnPrev=new Common.UI.Button({cls:"dlg-btn iconic",iconCls:"img-commonctrl prev",hint:this.txtPrev,hintAnchor:"top"}),this.btnPrev.render(this.$window.find("#id-review-button-prev")),this.btnNext=new Common.UI.Button({cls:" dlg-btn iconic",iconCls:"img-commonctrl next",hint:this.txtNext,hintAnchor:"top"}),this.btnNext.render(this.$window.find("#id-review-button-next")),this.btnAccept=new Common.UI.Button({cls:"btn-toolbar",caption:this.txtAccept,split:!0,disabled:this.mode.isReviewOnly||this.docProtection.isReviewOnly||!!Common.Utils.InternalSettings.get(this.appPrefix+"accept-reject-lock"),lock:[t.reviewChangelock,t.isReviewOnly,t.previewReviewMode,t.viewFormMode,t.lostConnect,t.docLockView,t.docLockForms,t.docLockComments,t.docLockReview],menu:!this.mode.canUseReviewPermissions&&new Common.UI.Menu({items:[this.mnuAcceptCurrent=new Common.UI.MenuItem({caption:this.txtAcceptCurrent,value:"current"}),this.mnuAcceptAll=new Common.UI.MenuItem({caption:this.txtAcceptAll,value:"all"})]})}),this.btnAccept.render(this.$window.find("#id-review-button-accept")),this.btnReject=new Common.UI.Button({cls:"btn-toolbar",caption:this.txtReject,split:!0,lock:[t.reviewChangelock,t.isReviewOnly,t.previewReviewMode,t.viewFormMode,t.lostConnect,t.docLockView,t.docLockForms,t.docLockComments,t.docLockReview],menu:!this.mode.canUseReviewPermissions&&new Common.UI.Menu({items:[this.mnuRejectCurrent=new Common.UI.MenuItem({caption:this.txtRejectCurrent,value:"current"}),this.mnuRejectAll=new Common.UI.MenuItem({caption:this.txtRejectAll,value:"all"})]})}),this.btnReject.render(this.$window.find("#id-review-button-reject")),[this.btnAccept,this.btnReject]),n=(Common.Utils.lockControls(Common.enumLock.isReviewOnly,this.mode.isReviewOnly,{array:t}),Common.Utils.lockControls(Common.enumLock.docLockView,this.docProtection.isReadOnly,{array:t}),Common.Utils.lockControls(Common.enumLock.docLockForms,this.docProtection.isFormsOnly,{array:t}),Common.Utils.lockControls(Common.enumLock.docLockReview,this.docProtection.isReviewOnly,{array:t}),Common.Utils.lockControls(Common.enumLock.docLockComments,this.docProtection.isCommentsOnly,{array:t}),Common.Utils.lockControls(Common.enumLock.reviewChangelock,!!Common.Utils.InternalSettings.get(this.appPrefix+"accept-reject-lock"),{array:t}),this);return this.btnPrev.on("click",function(t){n.fireEvent("reviewchange:preview",[n.btnPrev,"prev"])}),this.btnNext.on("click",function(t){n.fireEvent("reviewchange:preview",[n.btnNext,"next"])}),this.btnAccept.on("click",function(t){n.fireEvent("reviewchange:accept",[n.btnAccept,"current"])}),this.btnAccept.menu&&this.btnAccept.menu.on("item:click",function(t,e,i){n.fireEvent("reviewchange:accept",[t,e])}),this.btnReject.on("click",function(t){n.fireEvent("reviewchange:reject",[n.btnReject,"current"])}),this.btnReject.menu&&this.btnReject.menu.on("item:click",function(t,e,i){n.fireEvent("reviewchange:reject",[t,e])}),this}},Common.Views.ReviewChangesDialog||{}))}),void 0===Common&&(Common={}),define("common/main/lib/view/LanguageDialog",["common/main/lib/component/Window"],function(){"use strict";Common.Views.LanguageDialog=Common.UI.Window.extend(_.extend({options:{header:!1,width:350,cls:"modal-dlg",buttons:["ok","cancel"]},template:'<div class="box"><div class="input-row"><label><%= label %></label></div><div class="input-row" id="id-document-language"></div></div>',initialize:function(t){_.extend(this.options,t||{},{label:this.labelSelect}),this.options.tpl=_.template(this.template)(this.options),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this.getChild(),t=(t.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.cmbLanguage=new Common.UI.ComboBox({el:t.find("#id-document-language"),cls:"input-group-nr",menuStyle:"min-width: 318px; max-height: 285px;",editable:!1,template:_.template(['<span class="input-group combobox <%= cls %> combo-langs" id="<%= id %>" style="<%= style %>">','<input type="text" class="form-control">','<span class="icon input-icon spellcheck-lang toolbar__icon btn-ic-docspell"></span>','<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">','<span class="caret" />',"</button>",'<ul class="dropdown-menu <%= menuCls %>" style="<%= menuStyle %>" role="menu">',"<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%= item.value %>">','<a tabindex="-1" type="menuitem" langval="<%= item.value %>">','<i class="icon <% if (item.spellcheck) { %> toolbar__icon btn-ic-docspell spellcheck-lang <% } %>"></i>',"<%= scope.getDisplayValue(item) %>","</a>","</li>","<% }); %>","</ul>","</span>"].join("")),data:this.options.languages,takeFocusOnClose:!0,search:!0,scrollAlwaysVisible:!0}),this.cmbLanguage.scroller&&this.cmbLanguage.scroller.update({alwaysVisibleY:!0}),this.cmbLanguage.on("selected",_.bind(this.onLangSelect,this)),Common.util.LanguageInfo.getLocalLanguageName(this.options.current)),e=(this.cmbLanguage.setValue(t[0],t[1]),this.onLangSelect(this.cmbLanguage,this.cmbLanguage.getSelectedRecord()),this);setTimeout(function(){e.cmbLanguage.focus()},100)},close:function(t){this.getChild().find(".combobox.open").length||Common.UI.Window.prototype.close.call(this,arguments)},onBtnClick:function(t){this.options.handler&&this.options.handler.call(this,t.currentTarget.attributes.result.value,this.cmbLanguage.getValue()),this.close()},onLangSelect:function(t,e,i){t.$el.find(".input-icon").toggleClass("spellcheck-lang",e&&e.spellcheck),t._input.css(Common.UI.isRTL()?"padding-right":"padding-left",e&&e.spellcheck?25:3)},onPrimary:function(){return this.options.handler&&this.options.handler.call(this,"ok",this.cmbLanguage.getValue()),this.close(),!1}},Common.Views.LanguageDialog||{}))}),void 0===Common&&(Common={}),Common.Controllers=Common.Controllers||{},define("common/main/lib/controller/ReviewChanges",["core","common/main/lib/model/ReviewChange","common/main/lib/collection/ReviewChanges","common/main/lib/view/ReviewChanges","common/main/lib/view/ReviewPopover","common/main/lib/view/LanguageDialog","common/main/lib/view/OptionsDialog"],function(){"use strict";Common.Controllers.ReviewChanges=Backbone.Controller.extend(_.extend({models:[],collections:["Common.Collections.ReviewChanges"],views:["Common.Views.ReviewChanges","Common.Views.ReviewPopover"],sdkViewName:"#id_main",initialize:function(){this.addListeners({FileMenu:{"settings:apply":this.applySettings.bind(this)},LeftMenu:{"comments:show":_.bind(this.commentsShowHide,this,"show"),"comments:hide":_.bind(this.commentsShowHide,this,"hide")},"Common.Views.ReviewChanges":{"reviewchange:accept":_.bind(this.onAcceptClick,this),"reviewchange:reject":_.bind(this.onRejectClick,this),"reviewchange:delete":_.bind(this.onDeleteClick,this),"reviewchange:preview":_.bind(this.onBtnPreviewClick,this),"reviewchange:view":_.bind(this.onReviewViewClick,this),"reviewchange:compare":_.bind(this.onCompareClick,this),"reviewchange:combine":_.bind(this.onCombineClick,this),"lang:document":_.bind(this.onDocLanguage,this),"collaboration:coauthmode":_.bind(this.onCoAuthMode,this),"protect:update":_.bind(this.onChangeProtectDocument,this)},"Common.Views.ReviewChangesDialog":{"reviewchange:accept":_.bind(this.onAcceptClick,this),"reviewchange:reject":_.bind(this.onRejectClick,this),"reviewchange:preview":_.bind(this.onBtnPreviewClick,this)},"Common.Views.ReviewPopover":{"reviewchange:accept":_.bind(this.onAcceptClick,this),"reviewchange:reject":_.bind(this.onRejectClick,this),"reviewchange:delete":_.bind(this.onDeleteClick,this),"reviewchange:goto":_.bind(this.onGotoClick,this)}})},onLaunch:function(){this.collection=this.getApplication().getCollection("Common.Collections.ReviewChanges"),this.userCollection=this.getApplication().getCollection("Common.Collections.Users"),this.viewmode=!1;var t=Common.localStorage.getKeysFilter();this.appPrefix=t&&t.length?t.split(",")[0]:"",this._state={posx:-1e3,posy:-1e3,popoverVisible:!1,previewMode:!1,compareSettings:null,wsLock:!1,wsProps:[],disableEditing:!1,docProtection:{isReadOnly:!1,isReviewOnly:!1,isFormsOnly:!1,isCommentsOnly:!1}},Common.NotificationCenter.on("reviewchanges:turn",this.onTurnPreview.bind(this)),Common.NotificationCenter.on("spelling:turn",this.onTurnSpelling.bind(this)),Common.NotificationCenter.on("app:ready",this.onAppReady.bind(this)),Common.NotificationCenter.on("api:disconnect",_.bind(this.onCoAuthoringDisconnect,this)),Common.NotificationCenter.on("collaboration:sharing",this.changeAccessRights.bind(this)),Common.NotificationCenter.on("collaboration:sharingdeny",this.onLostEditRights.bind(this)),Common.NotificationCenter.on("protect:wslock",_.bind(this.onChangeProtectSheet,this)),this.userCollection.on("reset",_.bind(this.onUpdateUsers,this)),this.userCollection.on("add",_.bind(this.onUpdateUsers,this))},setConfig:function(t,e){return this.setApi(e),t&&(this.currentUserId=t.config.user.id,this.sdkViewName=t.sdkviewname||this.sdkViewName),this},setApi:function(t){t&&(this.api=t,(this.appConfig.canReview||this.appConfig.canViewReview)&&(this.api.asc_registerCallback("asc_onShowRevisionsChange",_.bind(this.onApiShowChange,this)),this.api.asc_registerCallback("asc_onUpdateRevisionsChangesPosition",_.bind(this.onApiUpdateChangePosition,this)),this.api.asc_registerCallback("asc_onAuthParticipantsChanged",_.bind(this.onAuthParticipantsChanged,this)),this.api.asc_registerCallback("asc_onParticipantsChanged",_.bind(this.onAuthParticipantsChanged,this)),this.api.asc_registerCallback("asc_onChangeDisplayModeInReview",_.bind(this.onChangeDisplayModeInReview,this))),this.appConfig.canReview&&this.api.asc_registerCallback("asc_onOnTrackRevisionsChange",_.bind(this.onApiTrackRevisionsChange,this)),this.api.asc_registerCallback("asc_onAcceptChangesBeforeCompare",_.bind(this.onAcceptChangesBeforeCompare,this)),this.api.asc_registerCallback("asc_onCoAuthoringDisconnect",_.bind(this.onCoAuthoringDisconnect,this)),Common.Gateway.on("setrevisedfile",_.bind(this.setRevisedFile,this)),this.appConfig.canFeatureComparison&&(Common.NotificationCenter.on("storage:document-load",_.bind(this.openDocumentFromStorage,this)),Common.NotificationCenter.on("storage:document-insert",_.bind(this.insertDocumentFromStorage,this)),Common.Gateway.on("setrequesteddocument",_.bind(this.setRequestedDocument,this))))},setMode:function(t){return this.appConfig=t,this.popoverChanges=new Common.Collections.ReviewChanges,this.view=this.createView("Common.Views.ReviewChanges",{mode:t}),(this.appConfig.sharingSettingsUrl&&this.appConfig.sharingSettingsUrl.length||this.appConfig.canRequestSharingSettings)&&(Common.Gateway.on("showsharingsettings",_.bind(this.changeAccessRights,this)),Common.Gateway.on("setsharingsettings",_.bind(this.setSharingSettings,this))),this},loadDocument:function(t){this.document=t.doc},SetDisabled:function(t,e,i){this.dlgChanges&&this.dlgChanges.close(),e?(this.lockToolbar(Common.enumLock.previewReviewMode,t),this.dlgChanges&&Common.Utils.lockControls(Common.enumLock.previewReviewMode,t,{array:[this.dlgChanges.btnAccept,this.dlgChanges.btnReject]})):i?(this.lockToolbar(Common.enumLock.viewFormMode,t),this.dlgChanges&&Common.Utils.lockControls(Common.enumLock.viewFormMode,t,{array:[this.dlgChanges.btnAccept,this.dlgChanges.btnReject]})):this.lockToolbar(Common.enumLock.viewMode,t),this.setPreviewMode(t)},lockToolbar:function(t,e,i){this.view&&Common.Utils.lockControls(t,e,i,this.view.getButtons())},setPreviewMode:function(t){this._state.disableEditing=t,this.updatePreviewMode()},updatePreviewMode:function(){var e,t=this._state.disableEditing||this._state.docProtection.isReadOnly||this._state.docProtection.isFormsOnly||this._state.docProtection.isCommentsOnly;this.viewmode!==t&&((this.viewmode=t)&&(this.prevcanReview=this.appConfig.canReview),this.appConfig.canReview=!t&&this.prevcanReview,(e=this).popoverChanges&&this.popoverChanges.each(function(t){t.set("hint",!e.appConfig.canReview)}))},isSelectedChangesLocked:function(t,e){if(!t||t.length<1)return!0;if(e)return t[0].get("lock")||!t[0].get("editable");for(var i=0;i<t.length;i++){var n=t[i];if(n.get("lock")||!n.get("editable"))return!0}return!1},onApiShowChange:function(t,e){var i,n,o,s,a=!0;!this.appConfig.canReview||this.appConfig.isReviewOnly||this._state.docProtection.isReviewOnly||(t&&0<t.length&&(i=this.readSDKChange(t),a=this.isSelectedChangesLocked(i,e)),this._state.lock!==a&&(Common.Utils.lockControls(Common.enumLock.reviewChangelock,a,{array:[this.view.btnAccept,this.view.btnReject]}),this.dlgChanges&&Common.Utils.lockControls(Common.enumLock.reviewChangelock,a,{array:[this.dlgChanges.btnAccept,this.dlgChanges.btnReject]}),this._state.lock=a,Common.Utils.InternalSettings.set(this.appPrefix+"accept-reject-lock",a))),this.getPopover()&&(!this.appConfig.reviewHoverMode&&t&&0<t.length&&e?(a=t[0].get_X(),e=t[0].get_Y(),n=.001<Math.abs(this._state.posx-a)||.001<Math.abs(this._state.posy-e)||t.length!==this._state.changes_length,o=null!==t[0].get_LockUserId(),s=this.getUserName(t[0].get_LockUserId()),this.getPopover().hideTips(),this.popoverChanges.reset(i||this.readSDKChange(t)),n&&(this.getPopover().isVisible()&&this.getPopover().hide(),this.getPopover().setLeftTop(a,e)),this.getPopover().showReview(n,o,s),this._state.posx=a,this._state.posy=e,this._state.changes_length=t.length,this._state.popoverVisible=!0):this._state.popoverVisible&&(this._state.posx=this._state.posy=-1e3,this._state.changes_length=0,this._state.popoverVisible=!1,this.getPopover().hideTips(),this.popoverChanges.reset(),this.getPopover().hideReview()))},onApiUpdateChangePosition:function(t,e){this.getPopover()&&(e<0||this.getPopover().sdkBounds.height<e?this.getPopover().hide():0<this.popoverChanges.length&&(this.getPopover().isVisible()||this.getPopover().show(!1),this.getPopover().setLeftTop(t,e)))},findChange:function(t,e){return _.isUndefined(t)?this.collection.findWhere({id:e}):this.collection.findWhere({uid:t})},getPopover:function(){return(this.appConfig.canReview||this.appConfig.canViewReview)&&_.isUndefined(this.popover)&&(this.popover=Common.Views.ReviewPopover.prototype.getPopover({reviewStore:this.popoverChanges,renderTo:this.sdkViewName,canRequestUsers:this.appConfig?this.appConfig.canRequestUsers:void 0,canRequestSendNotify:this.appConfig?this.appConfig.canRequestSendNotify:void 0,mentionShare:!this.appConfig||this.appConfig.mentionShare,api:this.api}),this.popover.setReviewStore(this.popoverChanges)),this.popover},readSDKChange:function(t){var c=this,d=[];return _.each(t,function(t){var e,i="",n="",o=t.get_Value(),s=t.get_MoveType();switch(t.get_Type()){case Asc.c_oAscRevisionsChangeType.TextAdd:i=s==Asc.c_oAscRevisionsMove.NoMove?c.textInserted:c.textParaMoveTo,"object"==typeof o?_.each(o,function(t){if("string"==typeof t)i+=" "+Common.Utils.String.htmlEncode(t);else switch(t){case 0:i+=" &lt;"+c.textImage+"&gt;";break;case 1:i+=" &lt;"+c.textShape+"&gt;";break;case 2:i+=" &lt;"+c.textChart+"&gt;";break;case 3:i+=" &lt;"+c.textEquation+"&gt;"}}):"string"==typeof o&&(i+=" "+Common.Utils.String.htmlEncode(o));break;case Asc.c_oAscRevisionsChangeType.TextRem:i=s==Asc.c_oAscRevisionsMove.NoMove?c.textDeleted:t.is_MovedDown()?c.textParaMoveFromDown:c.textParaMoveFromUp,"object"==typeof o?_.each(o,function(t){if("string"==typeof t)i+=" "+Common.Utils.String.htmlEncode(t);else switch(t){case 0:i+=" &lt;"+c.textImage+"&gt;";break;case 1:i+=" &lt;"+c.textShape+"&gt;";break;case 2:i+=" &lt;"+c.textChart+"&gt;";break;case 3:i+=" &lt;"+c.textEquation+"&gt;"}}):"string"==typeof o&&(i+=" "+Common.Utils.String.htmlEncode(o));break;case Asc.c_oAscRevisionsChangeType.ParaAdd:i=c.textParaInserted;break;case Asc.c_oAscRevisionsChangeType.ParaRem:i=c.textParaDeleted;break;case Asc.c_oAscRevisionsChangeType.TextPr:i="<b>"+c.textFormatted,void 0!==o.Get_Bold()&&(n+=(o.Get_Bold()?"":c.textNot)+c.textBold+", "),void 0!==o.Get_Italic()&&(n+=(o.Get_Italic()?"":c.textNot)+c.textItalic+", "),void 0!==o.Get_Underline()&&(n+=(o.Get_Underline()?"":c.textNot)+c.textUnderline+", "),void 0!==o.Get_Strikeout()&&(n+=(o.Get_Strikeout()?"":c.textNot)+c.textStrikeout+", "),void 0!==o.Get_DStrikeout()&&(n+=(o.Get_DStrikeout()?"":c.textNot)+c.textDStrikeout+", "),void 0!==o.Get_Caps()&&(n+=(o.Get_Caps()?"":c.textNot)+c.textCaps+", "),void 0!==o.Get_SmallCaps()&&(n+=(o.Get_SmallCaps()?"":c.textNot)+c.textSmallCaps+", "),void 0!==o.Get_VertAlign()&&(n+=(o.Get_VertAlign()===Asc.vertalign_SuperScript?c.textSuperScript:o.Get_VertAlign()===Asc.vertalign_SubScript?c.textSubScript:c.textBaseline)+", "),void 0!==o.Get_Color()&&(n+=c.textColor+", "),void 0!==o.Get_Highlight()&&(n+=c.textHighlight+", "),void 0!==o.Get_Shd()&&(n+=c.textShd+", "),void 0!==o.Get_FontFamily()&&(n+=o.Get_FontFamily()+", "),void 0!==o.Get_FontSize()&&(n+=o.Get_FontSize()+", "),void 0!==o.Get_Spacing()&&(n+=c.textSpacing+" "+Common.Utils.Metric.fnRecalcFromMM(o.Get_Spacing()).toFixed(2)+" "+Common.Utils.Metric.getCurrentMetricName()+", "),void 0!==o.Get_Position()&&(n+=c.textPosition+" "+Common.Utils.Metric.fnRecalcFromMM(o.Get_Position()).toFixed(2)+" "+Common.Utils.Metric.getCurrentMetricName()+", "),void 0!==o.Get_Lang()&&(n+=Common.util.LanguageInfo.getLocalLanguageName(o.Get_Lang())[1]+", "),_.isEmpty(n)||(i+=": ",n=n.substring(0,n.length-2)),i=i+"</b>"+n;break;case Asc.c_oAscRevisionsChangeType.ParaPr:if(i="<b>"+c.textParaFormatted,o.Get_ContextualSpacing()&&(n+=(o.Get_ContextualSpacing()?c.textContextual:c.textNoContextual)+", "),void 0!==o.Get_IndLeft()&&(n+=c.textIndentLeft+" "+Common.Utils.Metric.fnRecalcFromMM(o.Get_IndLeft()).toFixed(2)+" "+Common.Utils.Metric.getCurrentMetricName()+", "),void 0!==o.Get_IndRight()&&(n+=c.textIndentRight+" "+Common.Utils.Metric.fnRecalcFromMM(o.Get_IndRight()).toFixed(2)+" "+Common.Utils.Metric.getCurrentMetricName()+", "),void 0!==o.Get_IndFirstLine()&&(n+=c.textFirstLine+" "+Common.Utils.Metric.fnRecalcFromMM(o.Get_IndFirstLine()).toFixed(2)+" "+Common.Utils.Metric.getCurrentMetricName()+", "),void 0!==o.Get_Jc())switch(o.Get_Jc()){case 0:n+=c.textRight+", ";break;case 1:n+=c.textLeft+", ";break;case 2:n+=c.textCenter+", ";break;case 3:n+=c.textJustify+", "}void 0!==o.Get_KeepLines()&&(n+=(o.Get_KeepLines()?c.textKeepLines:c.textNoKeepLines)+", "),o.Get_KeepNext()&&(n+=(o.Get_KeepNext()?c.textKeepNext:c.textNoKeepNext)+", "),o.Get_PageBreakBefore()&&(n+=(o.Get_PageBreakBefore()?c.textBreakBefore:c.textNoBreakBefore)+", "),void 0!==o.Get_SpacingLineRule()&&void 0!==o.Get_SpacingLine()&&(n=(n=(n+=c.textLineSpacing)+((o.Get_SpacingLineRule()==c_paragraphLinerule.LINERULE_LEAST?c.textAtLeast:o.Get_SpacingLineRule()==c_paragraphLinerule.LINERULE_AUTO?c.textMultiple:c.textExact)+" "))+(o.Get_SpacingLineRule()==c_paragraphLinerule.LINERULE_AUTO?o.Get_SpacingLine():Common.Utils.Metric.fnRecalcFromMM(o.Get_SpacingLine()).toFixed(2)+" "+Common.Utils.Metric.getCurrentMetricName())+", "),o.Get_SpacingBeforeAutoSpacing()?n+=c.textSpacingBefore+" "+c.textAuto+", ":void 0!==o.Get_SpacingBefore()&&(n+=c.textSpacingBefore+" "+Common.Utils.Metric.fnRecalcFromMM(o.Get_SpacingBefore()).toFixed(2)+" "+Common.Utils.Metric.getCurrentMetricName()+", "),o.Get_SpacingAfterAutoSpacing()?n+=c.textSpacingAfter+" "+c.textAuto+", ":void 0!==o.Get_SpacingAfter()&&(n+=c.textSpacingAfter+" "+Common.Utils.Metric.fnRecalcFromMM(o.Get_SpacingAfter()).toFixed(2)+" "+Common.Utils.Metric.getCurrentMetricName()+", "),o.Get_WidowControl()&&(n+=(o.Get_WidowControl()?c.textWidow:c.textNoWidow)+", "),void 0!==o.Get_Tabs()&&(n+=c.textTabs+", "),void 0!==o.Get_NumPr()&&(n+=c.textNum+", "),void 0!==o.Get_PStyle()&&(e=c.api.asc_GetStyleNameById(o.Get_PStyle()),_.isEmpty(e)||(n+=e+", ")),_.isEmpty(n)||(i+=": ",n=n.substring(0,n.length-2)),i=i+"</b>"+n;break;case Asc.c_oAscRevisionsChangeType.TablePr:i=c.textTableChanged;break;case Asc.c_oAscRevisionsChangeType.RowsAdd:i=c.textTableRowsAdd;break;case Asc.c_oAscRevisionsChangeType.RowsRem:i=c.textTableRowsDel}var a=""==t.get_DateTime()?new Date:new Date(t.get_DateTime()),l=c.userCollection.findOriginalUser(t.get_UserId()),r=c._state.docProtection.isReviewOnly,l=new Common.Models.ReviewChange({uid:Common.UI.getId(),userid:t.get_UserId(),username:t.get_UserName(),usercolor:l?l.get("color"):null,date:c.dateToLocaleTimeString(a),changetext:i,id:Common.UI.getId(),lock:null!==t.get_LockUserId(),lockuser:c.getUserName(t.get_LockUserId()),type:t.get_Type(),changedata:t,scope:c.view,hint:!c.appConfig.canReview,docProtection:c._state.docProtection,goto:t.get_MoveType()==Asc.c_oAscRevisionsMove.MoveTo||t.get_MoveType()==Asc.c_oAscRevisionsMove.MoveFrom,editable:(c.appConfig.isReviewOnly||r)&&t.get_UserId()==c.currentUserId||!(c.appConfig.isReviewOnly||r)&&(!c.appConfig.canUseReviewPermissions||AscCommon.UserInfoParser.canEditReview(t.get_UserName()))});d.push(l)}),d},getUserName:function(t){if(this.userCollection&&null!==t){t=this.userCollection.findUser(t);if(t)return AscCommon.UserInfoParser.getParsedName(t.get("username"))}return""},dateToLocaleTimeString:function(e){var t,i=(this.appConfig&&this.appConfig.lang||"en").replace("_","-").toLowerCase();try{return e.toLocaleString(i,{dateStyle:"short",timeStyle:"short"})}catch(t){return e.toLocaleString("en",{dateStyle:"short",timeStyle:"short"})}return e.getMonth()+1+"/"+e.getDate()+"/"+e.getFullYear()+" "+(e=(i=e).getHours(),i=i.getMinutes(),t=12<=e?"pm":"am",(e=(e%=12)||12)+":"+(i<10?"0"+i:i)+" "+t)},onBtnPreviewClick:function(t,e){switch(e){case"prev":this.api.asc_GetPrevRevisionsChange();break;case"next":this.api.asc_GetNextRevisionsChange()}Common.NotificationCenter.trigger("edit:complete",this.view)},onAcceptClick:function(t,e,i){this.api&&(e?"all"===e.value?this.api.asc_AcceptAllChanges():this._state.lock?this.api.asc_GetNextRevisionsChange():this.api.asc_AcceptChangesBySelection(!0):this.api.asc_AcceptChanges(t)),Common.NotificationCenter.trigger("edit:complete",this.view)},onRejectClick:function(t,e,i){this.api&&(e?"all"===e.value?this.api.asc_RejectAllChanges():this._state.lock?this.api.asc_GetNextRevisionsChange():this.api.asc_RejectChangesBySelection(!0):this.api.asc_RejectChanges(t)),Common.NotificationCenter.trigger("edit:complete",this.view)},onDeleteClick:function(t){this.api&&this.api.asc_RejectChanges(t),Common.NotificationCenter.trigger("edit:complete",this.view)},onGotoClick:function(t){this.api&&this.api.asc_FollowRevisionMove(t),Common.NotificationCenter.trigger("edit:complete",this.view)},onTurnPreview:function(t,e,i){this.appConfig.isReviewOnly?this.view.turnChanges(!0):this.appConfig.canReview&&(t="off"!=t&&t,e?(this.api.asc_SetLocalTrackRevisions(null),this.api.asc_SetGlobalTrackRevisions(!!t)):this.api.asc_SetLocalTrackRevisions(!!t))},onApiTrackRevisionsChange:function(t,e,i){var n;this.appConfig.isReviewOnly||this._state.docProtection.isReviewOnly?this.view.turnChanges(!0):this.appConfig.canReview&&(Common.Utils.InternalSettings.set(this.appPrefix+"track-changes",((t=(n=null===t)?e:t)?0:1)+(n?2:0)),this.view.turnChanges(t,n),i&&this.userCollection&&((t=this.userCollection.findOriginalUser(i))&&Common.NotificationCenter.trigger("showmessage",{msg:Common.Utils.String.format(e?this.textOnGlobal:this.textOffGlobal,AscCommon.UserInfoParser.getParsedName(t.get("username")))},{timeout:5e3,hideCloseTip:!0})))},onTurnSpelling:function(t,e){t="on"==t,this.view&&this.view.turnSpelling(t),Common.UI.FeaturesManager.canChange("spellcheck")&&!e&&(Common.localStorage.setItem(this.appPrefix+"settings-spellcheck",t?1:0),this.api.asc_setSpellCheck(t),Common.Utils.InternalSettings.set(this.appPrefix+"settings-spellcheck",t))},onReviewViewClick:function(t,e,i){this.turnDisplayMode(e.value),this.appConfig.isEdit||this.appConfig.isRestrictedEdit?"markup"!=e.value&&"simple"!=e.value||(Common.localStorage.setItem(this.appPrefix+"review-mode-editor",e.value),Common.Utils.InternalSettings.set(this.appPrefix+"review-mode-editor",e.value)):Common.localStorage.setItem(this.appPrefix+"review-mode",e.value),Common.NotificationCenter.trigger("edit:complete",this.view)},onCompareClick:function(t){var i;this.api&&((i=this)._state.compareSettings||(this._state.compareSettings=new AscCommonWord.ComparisonOptions,this._state.compareSettings.putWords(!Common.localStorage.getBool("de-compare-char"))),"file"===t?(this.api&&setTimeout(function(){i.api.asc_CompareDocumentFile(i._state.compareSettings)},1),Common.NotificationCenter.trigger("edit:complete",this.view)):"url"===t?new Common.Views.ImageFromUrlDialog({title:i.textUrl,handler:function(t,e){"ok"==t&&(i.api&&(t=e.replace(/ /g,""),_.isEmpty(t)||i.api.asc_CompareDocumentUrl(t,i._state.compareSettings)),Common.NotificationCenter.trigger("edit:complete",i.view))}}).show():"storage"===t?Common.NotificationCenter.trigger("storage:document-load","compare"):"settings"===t&&(t=!i._state.compareSettings||i._state.compareSettings.getWords(),new Common.Views.OptionsDialog({title:i.textTitleComparison,items:[{caption:i.textChar,value:!1,checked:!1===t},{caption:i.textWord,value:!0,checked:!1!==t}],label:i.textShow,handler:function(t,e){"ok"==e&&(i._state.compareSettings=new AscCommonWord.ComparisonOptions,i._state.compareSettings.putWords(t.getSettings())),Common.NotificationCenter.trigger("edit:complete",i.toolbar)}}).show())),Common.NotificationCenter.trigger("edit:complete",this.view)},onCombineClick:function(t){var i;this.api&&((i=this)._state.compareSettings||(this._state.compareSettings=new AscCommonWord.ComparisonOptions,this._state.compareSettings.putWords(!Common.localStorage.getBool("de-compare-char"))),"file"===t?(setTimeout(function(){i.api.asc_MergeDocumentFile(i._state.compareSettings)},1),Common.NotificationCenter.trigger("edit:complete",this.view)):"url"===t?new Common.Views.ImageFromUrlDialog({title:i.textUrl,handler:function(t,e){"ok"==t&&(i.api&&(t=e.replace(/ /g,""),_.isEmpty(t)||i.api.asc_MergeDocumentUrl(t,i._state.compareSettings)),Common.NotificationCenter.trigger("edit:complete",i.view))}}).show():"storage"===t&&Common.NotificationCenter.trigger("storage:document-load","combine")),Common.NotificationCenter.trigger("edit:complete",this.view)},setRevisedFile:function(t){t&&(t.c="compare"),this.setRequestedDocument(t)},onAcceptChangesBeforeCompare:function(e){Common.UI.warning({width:550,msg:this.textAcceptBeforeCompare,buttons:["yes","no"],primary:"yes",callback:function(t){_.defer(function(){e&&e("yes"==t)}),Common.NotificationCenter.trigger("edit:complete",this.view)}})},openDocumentFromStorage:function(i){var n=this;this.appConfig.canRequestSelectDocument?Common.Gateway.requestSelectDocument(i):this.appConfig.canRequestCompareFile?Common.Gateway.requestCompareFile():new Common.Views.SelectFileDlg({fileChoiceUrl:this.appConfig.fileChoiceUrl.replace("{fileExt}","").replace("{documentType}","DocumentsOnly")}).on("selectfile",function(t,e){e&&(e.c=i),n.setRequestedDocument(e)}).show()},setRequestedDocument:function(t){Common.NotificationCenter.trigger("storage:document-insert",t)},insertDocumentFromStorage:function(t){t&&t.url&&("compare"===t.c||"combine"===t.c)&&(this._state.compareSettings||(this._state.compareSettings=new AscCommonWord.ComparisonOptions,this._state.compareSettings.putWords(!Common.localStorage.getBool("de-compare-char"))),"compare"===t.c&&this.api.asc_CompareDocumentUrl(t.url,this._state.compareSettings,t.token),"combine"===t.c&&this.api.asc_MergeDocumentUrl(t.url,this._state.compareSettings,t.token))},turnDisplayMode:function(t){if(this.api){var e=Asc.c_oAscDisplayModeInReview.Edit;switch(t){case"final":e=Asc.c_oAscDisplayModeInReview.Final;break;case"original":e=Asc.c_oAscDisplayModeInReview.Original;break;case"simple":e=Asc.c_oAscDisplayModeInReview.Simple}this.api.asc_SetDisplayModeInReview(e)}this.disableEditing("final"==t||"original"==t),this._state.previewMode="final"==t||"original"==t},onChangeDisplayModeInReview:function(t){this.disableEditing(t===Asc.c_oAscDisplayModeInReview.Final||t===Asc.c_oAscDisplayModeInReview.Original);var e="markup";switch(t){case Asc.c_oAscDisplayModeInReview.Final:e="final";break;case Asc.c_oAscDisplayModeInReview.Original:e="original";break;case Asc.c_oAscDisplayModeInReview.Simple:e="simple"}this.view&&this.view.turnDisplayMode(e),this._state.previewMode=t===Asc.c_oAscDisplayModeInReview.Final||t===Asc.c_oAscDisplayModeInReview.Original},isPreviewChangesMode:function(){return this._state.previewMode},onCoAuthMode:function(t,e,i){var n;Common.localStorage.setItem(this.appPrefix+"settings-coauthmode",e.value),Common.Utils.InternalSettings.set(this.appPrefix+"settings-coauthmode",e.value),this.api&&(this.api.asc_SetFastCollaborative(1==e.value),this.api.SetCollaborativeMarksShowType&&(null!==(n=Common.localStorage.getItem(e.value?this.appPrefix+"settings-showchanges-fast":this.appPrefix+"settings-showchanges-strict"))?this.api.SetCollaborativeMarksShowType("all"==n?Asc.c_oAscCollaborativeMarksShowType.All:"none"==n?Asc.c_oAscCollaborativeMarksShowType.None:Asc.c_oAscCollaborativeMarksShowType.LastChanges):this.api.SetCollaborativeMarksShowType(e.value?Asc.c_oAscCollaborativeMarksShowType.None:Asc.c_oAscCollaborativeMarksShowType.LastChanges)),null===(n=Common.localStorage.getItem(this.appPrefix+"settings-autosave"))&&this.appConfig.customization&&!1===this.appConfig.customization.autosave&&(n=0),n=e.value||null===n?1:parseInt(n),Common.localStorage.setItem(this.appPrefix+"settings-autosave",n),Common.Utils.InternalSettings.set(this.appPrefix+"settings-autosave",n),this.api.asc_setAutoSaveGap(n)),Common.NotificationCenter.trigger("edit:complete",this.view),this.view.fireEvent("settings:apply",[this])},disableEditing:function(t){Common.NotificationCenter.trigger("editing:disable",t,{viewMode:!1,reviewMode:!0,fillFormMode:!1,allowMerge:!1,allowSignature:!1,allowProtect:!1,rightMenu:{clear:t,disable:!0},statusBar:!0,leftMenu:{disable:!1,previewMode:!0},fileMenu:{protect:!0,info:!0},navigation:{disable:!1,previewMode:!0},comments:{disable:!1,previewMode:!0},chat:!1,review:!0,viewport:!1,documentHolder:{clear:!1,disable:!0},toolbar:!0,plugins:!0,protect:!0},"review")},createToolbarPanel:function(){return this.view.getPanel()},getView:function(t){return!t&&this.view?this.view:Backbone.Controller.prototype.getView.call(this,t)},onAppReady:function(n){var o=this;new Promise(function(t){t()}).then(function(){n.canReview?(void 0===(i=o.appConfig.customization&&o.appConfig.customization.review?o.appConfig.customization.review.trackChanges:void 0)&&(i=o.appConfig.customization?o.appConfig.customization.trackChanges:void 0),n.isReviewOnly||void 0!==i?o.api.asc_SetLocalTrackRevisions(n.isReviewOnly||!0===i):o.onApiTrackRevisionsChange(o.api.asc_GetLocalTrackRevisions(),o.api.asc_GetGlobalTrackRevisions()),o.api.asc_HaveRevisionsChanges()&&o.view.markChanges(!0),null===(i=Common.localStorage.getItem(o.appPrefix+"review-mode-editor"))&&(i=(i=o.appConfig.customization&&o.appConfig.customization.review?o.appConfig.customization.review.reviewDisplay:void 0)||(o.appConfig.customization?o.appConfig.customization.reviewDisplay:void 0),i=/^(original|final|markup|simple)$/i.test(i)?i.toLocaleLowerCase():"markup"),Common.Utils.InternalSettings.set(o.appPrefix+"review-mode-editor",i),o.turnDisplayMode(i),o.view.turnDisplayMode(i),"object"==typeof o.appConfig.customization&&(o.appConfig.customization.review&&1==o.appConfig.customization.review.showReviewChanges||(!o.appConfig.customization.review||void 0===o.appConfig.customization.review.showReviewChanges)&&1==o.appConfig.customization.showReviewChanges)&&(o.dlgChanges=new Common.Views.ReviewChangesDialog({popoverChanges:o.popoverChanges,mode:o.appConfig,docProtection:o._state.docProtection}),e=(t=$("#editor_sdk")).offset(),o.dlgChanges.show(Math.max(10,e.left+t.width()-300),Math.max(10,e.top+t.height()-150)))):n.canViewReview&&(n.canViewReview=n.isEdit||o.api.asc_HaveRevisionsChanges(!0),n.canViewReview&&(null===(i=Common.localStorage.getItem(o.appPrefix+(n.isEdit||n.isRestrictedEdit?"review-mode-editor":"review-mode")))&&(i=(i=o.appConfig.customization&&o.appConfig.customization.review?o.appConfig.customization.review.reviewDisplay:void 0)||(o.appConfig.customization?o.appConfig.customization.reviewDisplay:void 0),i=/^(original|final|markup|simple)$/i.test(i)?i.toLocaleLowerCase():n.isEdit||n.isRestrictedEdit?"markup":"original"),o.turnDisplayMode(i),o.view.turnDisplayMode(i))),o.view&&o.view.btnChat&&o.getApplication().getController("LeftMenu").leftMenu.btnChat.on("toggle",function(t,e){e!==o.view.btnChat.pressed&&o.view.turnChat(e)}),o.onChangeProtectSheet(),o.view&&(o.lockToolbar(Common.enumLock.hideComments,!Common.localStorage.getBool(o.appPrefix+"settings-livecomment",!0),{array:[o.view.btnCommentRemove,o.view.btnCommentResolve]}),o.lockToolbar(Common.enumLock.Objects,!!o._state.wsProps.Objects,{array:[o.view.btnCommentRemove,o.view.btnCommentResolve]}));var t,e,i=Common.localStorage.getItem(o.appPrefix+"settings-review-hover-mode");i=null===i?!(!o.appConfig.customization||!o.appConfig.customization.review)&&!!o.appConfig.customization.review.hoverMode:!!parseInt(i),Common.Utils.InternalSettings.set(o.appPrefix+"settings-review-hover-mode",i),o.appConfig.reviewHoverMode=i,o.view&&o.view.onAppReady(n)})},applySettings:function(t){this.view&&this.view.turnSpelling(Common.localStorage.getBool(this.appPrefix+"settings-spellcheck",!0)),this.view&&this.view.turnCoAuthMode(Common.localStorage.getBool(this.appPrefix+"settings-coauthmode",!0)),(this.appConfig.canReview||this.appConfig.canViewReview)&&this.appConfig.reviewHoverMode&&this.onApiShowChange()},synchronizeChanges:function(){this.appConfig&&this.appConfig.canReview&&this.view.markChanges(this.api.asc_HaveRevisionsChanges())},setLanguages:function(t){this.langs=t,this.lockToolbar(Common.enumLock.noSpellcheckLangs,this.langs.length<1,{array:this.view.btnsDocLang})},onDocLanguage:function(){var i=this;new Common.Views.LanguageDialog({languages:i.langs,current:i.api.asc_getDefaultLanguage(),handler:function(t,e){"ok"==t&&(t=_.findWhere(i.langs,{value:e}))&&i.api.asc_setDefaultLanguage(t.code)}}).show()},onLostEditRights:function(){this._readonlyRights=!0,this.view&&this.view.onLostEditRights(),this.view&&this.lockToolbar(Common.enumLock.cantShare,!0,{array:[this.view.btnSharing]})},changeAccessRights:function(t,e,i){var n;this._docAccessDlg||this._readonlyRights||(this.appConfig.canRequestSharingSettings?Common.Gateway.requestSharingSettings():((n=this)._docAccessDlg=new Common.Views.DocumentAccessDialog({settingsurl:this.appConfig.sharingSettingsUrl}),n._docAccessDlg.on("accessrights",function(t,e){n.setSharingSettings({sharingSettings:e})}).on("close",function(t){n._docAccessDlg=void 0}),n._docAccessDlg.show()))},setSharingSettings:function(t){t&&(this.document.info.sharingSettings=t.sharingSettings,Common.NotificationCenter.trigger("collaboration:sharingupdate",t.sharingSettings),Common.NotificationCenter.trigger("mentions:clearusers",this))},onCoAuthoringDisconnect:function(){this.lockToolbar(Common.enumLock.lostConnect,!0),this.dlgChanges&&Common.Utils.lockControls(Common.enumLock.lostConnect,!0,{array:[this.dlgChanges.btnAccept,this.dlgChanges.btnReject]})},onUpdateUsers:function(){var i=this.userCollection;this.popoverChanges&&this.popoverChanges.each(function(t){var e=i.findOriginalUser(t.get("userid"));t.set("usercolor",e?e.get("color"):null)})},onAuthParticipantsChanged:function(t){var e;this.view&&this.view.btnCompare&&(e=0,_.each(t,function(t){t.asc_getView()||e++}),Common.Utils.lockControls(Common.enumLock.hasCoeditingUsers,1<e,{array:[this.view.btnCompare,this.view.btnCombine]}))},commentsShowHide:function(t){var e;!this.view||void 0!==(e=Common.Utils.InternalSettings.get(this.appPrefix+"settings-livecomment"))&&this.lockToolbar(Common.enumLock.hideComments,"show"!=t&&!e,{array:[this.view.btnCommentRemove,this.view.btnCommentResolve]})},onChangeProtectSheet:function(t){var e;t||(t=(e=this.getApplication().getController("WBProtection"))?e.getWSProps():null),this._state.wsProps=t?t.wsProps:[],this._state.wsLock=!!t&&t.wsLock,this.view&&this.lockToolbar(Common.enumLock.Objects,!!this._state.wsProps.Objects,{array:[this.view.btnCommentRemove,this.view.btnCommentResolve]})},onChangeProtectDocument:function(t){var e;(t=t?t:(e=this.getApplication().getController("DocProtection"))?e.getDocProps():null)&&(this._state.docProtection=t,this.lockToolbar(Common.enumLock.docLockView,t.isReadOnly),this.lockToolbar(Common.enumLock.docLockForms,t.isFormsOnly),this.lockToolbar(Common.enumLock.docLockReview,t.isReviewOnly),this.lockToolbar(Common.enumLock.docLockComments,t.isCommentsOnly),this.dlgChanges&&(Common.Utils.lockControls(Common.enumLock.docLockView,t.isReadOnly,{array:[this.dlgChanges.btnAccept,this.dlgChanges.btnReject]}),Common.Utils.lockControls(Common.enumLock.docLockForms,t.isFormsOnly,{array:[this.dlgChanges.btnAccept,this.dlgChanges.btnReject]}),Common.Utils.lockControls(Common.enumLock.docLockReview,t.isReviewOnly,{array:[this.dlgChanges.btnAccept,this.dlgChanges.btnReject]}),Common.Utils.lockControls(Common.enumLock.docLockComments,t.isCommentsOnly,{array:[this.dlgChanges.btnAccept,this.dlgChanges.btnReject]})),this.appConfig.isReviewOnly||(t.isReviewOnly?(this.api.asc_SetLocalTrackRevisions(!0),this.onApiShowChange()):this._state.prevReviewProtected&&(this.api.asc_SetLocalTrackRevisions(!1),this.onApiShowChange()),this._state.prevReviewProtected=t.isReviewOnly),this.updatePreviewMode())}},Common.Controllers.ReviewChanges||{}))}),define("common/main/lib/view/PasswordDialog",["common/main/lib/component/Window"],function(){"use strict";Common.Views.PasswordDialog=Common.UI.Window.extend(_.extend({applyFunction:void 0,initialize:function(t){var e={};_.extend(e,{width:395,height:270,header:!0,cls:"modal-dlg",contentTemplate:"",title:this.txtTitle,buttons:["ok","cancel"]},t),this.handler=t.handler,this.template=t.template||['<div class="box">','<div class="input-row" style="margin-bottom: 10px;">',"<label>"+this.txtDescription+"</label>","</div>",'<div class="input-row">',"<label>"+this.txtPassword+(this.passwordOptional?" ("+this.txtOptional+")":"")+"</label>","</div>",'<div id="id-password-txt" class="input-row" style="margin-bottom: 5px;"></div>','<div class="input-row">',"<label>"+this.txtRepeat+"</label>","</div>",'<div id="id-repeat-txt" class="input-row" style="margin-bottom: 10px;"></div>',"<label>"+this.txtWarning+"</label>","</div>"].join(""),e.tpl=_.template(this.template)(e),Common.UI.Window.prototype.initialize.call(this,e)},render:function(){var e;Common.UI.Window.prototype.render.call(this),this.$window&&((e=this).$window.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.repeatPwd=new Common.UI.InputField({el:$("#id-repeat-txt"),type:"password",allowBlank:!1,style:"width: 100%;",maxLength:255,validateOnBlur:!1,validation:function(t){return e.txtIncorrectPwd}}),this.inputPwd=new Common.UI.InputFieldBtnPassword({el:$("#id-password-txt"),type:"password",allowBlank:!1,style:"width: 100%;",maxLength:255,validateOnBlur:!1,repeatInput:this.repeatPwd}))},getFocusedComponents:function(){return[this.inputPwd,this.repeatPwd]},getDefaultFocusableComponent:function(){return this.inputPwd},onPrimary:function(t){return this._handleInput("ok"),!1},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},_handleInput:function(t){if(this.handler){if("ok"==t){if(!0!==this.inputPwd.checkValidate())return void this.inputPwd.focus();if(this.inputPwd.getValue()!==this.repeatPwd.getValue())return this.repeatPwd.checkValidate(),void this.repeatPwd.focus()}this.handler.call(this,t,this.inputPwd.getValue())}this.close()}},Common.Views.PasswordDialog||{}))}),void 0===Common&&(Common={}),define("common/main/lib/view/SignDialog",["common/main/lib/util/utils","common/main/lib/component/InputField","common/main/lib/component/Window","common/main/lib/component/ComboBoxFonts"],function(){"use strict";Common.Views.SignDialog=Common.UI.Window.extend(_.extend({options:{width:370,style:"min-width: 350px;",cls:"modal-dlg",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:this.textTitle},t||{}),this.api=this.options.api,this.signType=this.options.signType||"invisible",this.signSize=this.options.signSize||{width:0,height:0},this.certificateId=null,this.signObject=null,this.fontStore=this.options.fontStore,this.font={size:11,name:"Arial",bold:!1,italic:!1};t=Common.localStorage.getKeysFilter();this.appPrefix=t&&t.length?t.split(",")[0]:"",this.template=['<div class="box" style="height: '+("invisible"==this.signType?"132px;":"300px;")+'">','<div id="id-dlg-sign-invisible">','<div class="input-row">',"<label>"+this.textPurpose+"</label>","</div>",'<div id="id-dlg-sign-purpose" class="input-row"></div>',"</div>",'<div id="id-dlg-sign-visible">','<div class="input-row">',"<label>"+this.textInputName+"</label>","</div>",'<div id="id-dlg-sign-name" class="input-row" style="margin-bottom: 5px;"></div>','<div id="id-dlg-sign-fonts" class="input-row" style="display: inline-block;"></div>','<div id="id-dlg-sign-font-size" class="input-row margin-left-3" style="display: inline-block;"></div>','<div id="id-dlg-sign-bold" class="margin-left-3" style="display: inline-block;"></div>','<div id="id-dlg-sign-italic" class="margin-left-3" style="display: inline-block;"></div>','<div style="margin: 10px 0 5px 0;">',"<label>"+this.textUseImage+"</label>","</div>",'<button id="id-dlg-sign-image" class="btn btn-text-default auto">'+this.textSelectImage+"</button>",'<div class="input-row" style="margin-top: 10px;">','<label class="font-weight-bold">'+this.textSignature+"</label>","</div>",'<div style="border: 1px solid #cbcbcb;"><div id="signature-preview-img" style="width: 100%; height: 50px;position: relative;"></div></div>',"</div>",'<table style="margin-top: 30px;">',"<tr>",'<td><label class="font-weight-bold" style="margin-bottom: 3px;">'+this.textCertificate+'</label></td><td rowspan="2" class="padding-left-20" style="vertical-align: top;"><button id="id-dlg-sign-change" class="btn btn-text-default float-right">'+this.textSelect+"</button></td>","</tr>",'<tr><td><div id="id-dlg-sign-certificate" class="hidden" style="max-width: 240px;overflow: hidden;white-space: nowrap;"></td></tr>',"</table>","</div>"].join(""),this.templateCertificate=_.template(['<label style="display: block;margin-bottom: 3px;overflow: hidden;text-overflow: ellipsis;"><%= Common.Utils.String.htmlEncode(name) %></label>','<label style="display: block;"><%= Common.Utils.String.htmlEncode(valid) %></label>'].join("")),this.options.tpl=_.template(this.template)(this.options),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var i=this,t=this.getChild();i.inputPurpose=new Common.UI.InputField({el:$("#id-dlg-sign-purpose"),style:"width: 100%;"}),i.inputName=new Common.UI.InputField({el:$("#id-dlg-sign-name"),style:"width: 100%;",validateOnChange:!0}).on("changing",_.bind(i.onChangeName,i)),i.cmbFonts=new Common.UI.ComboBoxFonts({el:$("#id-dlg-sign-fonts"),cls:"input-group-nr",style:"width: 234px;",menuCls:"scrollable-menu",menuStyle:"min-width: 234px;max-height: 270px;",store:new Common.Collections.Fonts,recent:0,takeFocusOnClose:!0,hint:i.tipFontName}).on("selected",function(t,e){i.signObject&&i.signObject.setText(i.inputName.getValue(),e.name,i.font.size,i.font.italic,i.font.bold),i.font.name=e.name}),this.cmbFontSize=new Common.UI.ComboBox({el:$("#id-dlg-sign-font-size"),cls:"input-group-nr",style:"width: 55px;",menuCls:"scrollable-menu",menuStyle:"min-width: 55px;max-height: 270px;",hint:this.tipFontSize,takeFocusOnClose:!0,data:[{value:8,displayValue:"8"},{value:9,displayValue:"9"},{value:10,displayValue:"10"},{value:11,displayValue:"11"},{value:12,displayValue:"12"},{value:14,displayValue:"14"},{value:16,displayValue:"16"},{value:18,displayValue:"18"},{value:20,displayValue:"20"},{value:22,displayValue:"22"},{value:24,displayValue:"24"},{value:26,displayValue:"26"},{value:28,displayValue:"28"},{value:36,displayValue:"36"},{value:48,displayValue:"48"},{value:72,displayValue:"72"},{value:96,displayValue:"96"}]}).on("selected",function(t,e){i.signObject&&i.signObject.setText(i.inputName.getValue(),i.font.name,e.value,i.font.italic,i.font.bold),i.font.size=e.value}),this.cmbFontSize.setValue(this.font.size),this.cmbFontSize.on("changed:before",_.bind(this.onFontSizeChanged,this,!0)),this.cmbFontSize.on("changed:after",_.bind(this.onFontSizeChanged,this,!1)),i.btnBold=new Common.UI.Button({parentEl:$("#id-dlg-sign-bold"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-bold",enableToggle:!0,hint:i.textBold}),i.btnBold.on("click",function(t,e){i.signObject&&i.signObject.setText(i.inputName.getValue(),i.font.name,i.font.size,i.font.italic,t.pressed),i.font.bold=t.pressed}),i.btnItalic=new Common.UI.Button({parentEl:$("#id-dlg-sign-italic"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-italic",enableToggle:!0,hint:i.textItalic}),i.btnItalic.on("click",function(t,e){i.signObject&&i.signObject.setText(i.inputName.getValue(),i.font.name,i.font.size,t.pressed,i.font.bold),i.font.italic=t.pressed}),i.btnSelectImage=new Common.UI.Button({el:"#id-dlg-sign-image"}),i.btnSelectImage.on("click",_.bind(i.onSelectImage,i)),i.btnChangeCertificate=new Common.UI.Button({el:"#id-dlg-sign-change"}),i.btnChangeCertificate.on("click",_.bind(i.onChangeCertificate,i)),i.btnOk=new Common.UI.Button({el:t.find(".primary"),disabled:!0}),i.cntCertificate=$("#id-dlg-sign-certificate"),i.cntVisibleSign=$("#id-dlg-sign-visible"),i.cntInvisibleSign=$("#id-dlg-sign-invisible"),("visible"==i.signType?i.cntInvisibleSign:i.cntVisibleSign).addClass("hidden"),t.find(".dlg-btn").on("click",_.bind(i.onBtnClick,i)),i.afterRender()},getFocusedComponents:function(){return[this.inputPurpose,this.inputName,this.cmbFonts,this.cmbFontSize,this.btnBold,this.btnItalic,this.btnSelectImage,this.btnChangeCertificate]},show:function(){Common.UI.Window.prototype.show.apply(this,arguments);var t=this;_.delay(function(){("visible"==t.signType?t.inputName:t.inputPurpose).cmpEl.find("input").focus()},500)},close:function(){this.api.asc_unregisterCallback("on_signature_defaultcertificate_ret",this.binding.certificateChanged),this.api.asc_unregisterCallback("on_signature_selectsertificate_ret",this.binding.certificateChanged),Common.UI.Window.prototype.close.apply(this,arguments),this.signObject&&this.signObject.destroy()},afterRender:function(){this.api&&(this.binding||(this.binding={}),this.binding.certificateChanged=_.bind(this.onCertificateChanged,this),this.api.asc_registerCallback("on_signature_defaultcertificate_ret",this.binding.certificateChanged),this.api.asc_registerCallback("on_signature_selectsertificate_ret",this.binding.certificateChanged),this.api.asc_GetDefaultCertificate()),"visible"==this.signType&&(this.cmbFonts.fillFonts(this.fontStore),this.cmbFonts.selectRecord(this.fontStore.findWhere({name:this.font.name})||this.fontStore.at(0)),this.signObject=new AscCommon.CSignatureDrawer("signature-preview-img",this.api,this.signSize.width,this.signSize.height))},getSettings:function(){var t={};return t.certificateId=this.certificateId,"invisible"==this.signType?t.purpose=this.inputPurpose.getValue():t.images=this.signObject?this.signObject.getImages():[null,null],t},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onPrimary:function(t){return this._handleInput("ok"),!1},_handleInput:function(t){if(this.options.handler){if("ok"==t&&(this.btnOk.isDisabled()||this.signObject&&!this.signObject.isValid()))return void(this.btnOk.isDisabled()||(this.inputName.showError([this.textNameError]),this.inputName.focus()));this.options.handler.call(this,this,t)}this.close()},onChangeCertificate:function(){this.api.asc_SelectCertificate()},onCertificateChanged:function(t){this.certificateId=t.id;var e=t.date,e="string"==typeof e?e.split(" - "):["",""];this.cntCertificate.html(this.templateCertificate({name:t.name,valid:this.textValid.replace("%1",e[0]).replace("%2",e[1])})),this.cntCertificate.toggleClass("hidden",_.isEmpty(this.certificateId)||this.certificateId<0),this.btnChangeCertificate.setCaption(_.isEmpty(this.certificateId)||this.certificateId<0?this.textSelect:this.textChange),this.btnOk.setDisabled(_.isEmpty(this.certificateId)||this.certificateId<0)},onSelectImage:function(){this.signObject&&(this.signObject.selectImage(),this.inputName.setValue(""))},onChangeName:function(t,e){this.signObject&&this.signObject.setText(e,this.font.name,this.font.size,this.font.italic,this.font.bold)},onFontSizeChanged:function(t,e,i,n){if(t){t=e.store.findWhere({displayValue:i.value});if(!t&&!(o=/^\+?(\d*(\.|,)?\d+)$|^\+?(\d+(\.|,)?\d*)$/.exec(i.value)))return o=e.getValue(),e.setRawValue(o),n.preventDefault(),!1}else{var o,t="sse-"==this.appPrefix?409:300;o=t<(o=Common.Utils.String.parseFloat(i.value))?t:o<1?1:Math.floor(2*(o+.4))/2,e.setRawValue(o),this.signObject&&this.signObject.setText(this.inputName.getValue(),this.font.name,o,this.font.italic,this.font.bold),this.font.size=o}}},Common.Views.SignDialog||{}))}),void 0===Common&&(Common={}),define("common/main/lib/view/SignSettingsDialog",["common/main/lib/util/utils","common/main/lib/component/InputField","common/main/lib/component/CheckBox","common/main/lib/component/Window"],function(){"use strict";Common.Views.SignSettingsDialog=Common.UI.Window.extend(_.extend({options:{width:350,style:"min-width: 350px;",cls:"modal-dlg",type:"edit"},initialize:function(t){_.extend(this.options,{title:this.textTitle},t||{}),this.template=['<div class="box" style="height: 250px;">','<div class="input-row">',"<label>"+this.textInfoName+"</label>","</div>",'<div id="id-dlg-sign-settings-name" class="input-row" style="margin-bottom: 5px;"></div>','<div class="input-row">',"<label>"+this.textInfoTitle+"</label>","</div>",'<div id="id-dlg-sign-settings-title" class="input-row" style="margin-bottom: 5px;"></div>','<div class="input-row">',"<label>"+this.textInfoEmail+"</label>","</div>",'<div id="id-dlg-sign-settings-email" class="input-row" style="margin-bottom: 10px;"></div>','<div class="input-row">',"<label>"+this.textInstructions+"</label>","</div>",'<div id="id-dlg-sign-settings-instructions"></div>','<div id="id-dlg-sign-settings-date"></div>',"</div>",'<div class="footer center">','<button class="btn normal dlg-btn primary" result="ok">'+this.okButtonText+"</button>",'<% if (type == "edit") { %>','<button class="btn normal dlg-btn" result="cancel">'+this.cancelButtonText+"</button>","<% } %>","</div>"].join(""),this.api=this.options.api,this.type=this.options.type||"edit",this.options.tpl=_.template(this.template)(this.options),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this.getChild();this.inputName=new Common.UI.InputField({el:$("#id-dlg-sign-settings-name"),style:"width: 100%;",disabled:"view"==this.type}),this.inputTitle=new Common.UI.InputField({el:$("#id-dlg-sign-settings-title"),style:"width: 100%;",disabled:"view"==this.type}),this.inputEmail=new Common.UI.InputField({el:$("#id-dlg-sign-settings-email"),style:"width: 100%;",disabled:"view"==this.type}),this.textareaInstructions=new Common.UI.TextareaField({el:t.find("#id-dlg-sign-settings-instructions"),style:"width: 100%; height: 35px;margin-bottom: 10px;",value:this.textDefInstruction,disabled:"view"==this.type}),this.chDate=new Common.UI.CheckBox({el:$("#id-dlg-sign-settings-date"),labelText:this.textShowDate,disabled:"view"==this.type,value:"checked"}),t.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this))},getFocusedComponents:function(){return[this.inputName,this.inputTitle,this.inputEmail,this.textareaInstructions,this.chDate]},getDefaultFocusableComponent:function(){return this.inputName},setSettings:function(t){var e;t&&(e=t.asc_getSigner1(),this.inputName.setValue(e||""),e=t.asc_getSigner2(),this.inputTitle.setValue(e||""),e=t.asc_getEmail(),this.inputEmail.setValue(e||""),e=t.asc_getInstructions(),this.textareaInstructions.setValue(e||""),this.chDate.setValue(t.asc_getShowDate()),this._currentGuid=t.asc_getGuid())},getSettings:function(){var t=new AscCommon.asc_CSignatureLine;return t.asc_setSigner1(this.inputName.getValue()),t.asc_setSigner2(this.inputTitle.getValue()),t.asc_setEmail(this.inputEmail.getValue()),t.asc_setInstructions(this.textareaInstructions.getValue()),t.asc_setShowDate("checked"==this.chDate.getValue()),void 0!==this._currentGuid&&t.asc_setGuid(this._currentGuid),t},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onPrimary:function(t){return this._handleInput("ok"),!1},_handleInput:function(t){this.options.handler&&this.options.handler.call(this,this,t),this.close()}},Common.Views.SignSettingsDialog||{}))}),void 0===Common&&(Common={}),Common.Controllers=Common.Controllers||{},define("common/main/lib/controller/Protection",["core","common/main/lib/view/Protection","common/main/lib/view/PasswordDialog","common/main/lib/view/SignDialog","common/main/lib/view/SignSettingsDialog"],function(){"use strict";Common.Controllers.Protection=Backbone.Controller.extend(_.extend({models:[],collections:[],views:["Common.Views.Protection"],sdkViewName:"#id_main",initialize:function(){this.addListeners({"Common.Views.Protection":{"protect:password":_.bind(this.onPasswordClick,this),"protect:signature":_.bind(this.onSignatureClick,this)}})},onLaunch:function(){this._state={},Common.NotificationCenter.on("app:ready",this.onAppReady.bind(this)),Common.NotificationCenter.on("api:disconnect",_.bind(this.onCoAuthoringDisconnect,this))},setConfig:function(t,e){this.setApi(e),t&&(this.sdkViewName=t.sdkviewname||this.sdkViewName)},setApi:function(t){t&&(this.api=t,this.appConfig.isPasswordSupport&&this.api.asc_registerCallback("asc_onDocumentPassword",_.bind(this.onDocumentPassword,this)),this.appConfig.isSignatureSupport&&(Common.NotificationCenter.on("protect:sign",_.bind(this.onSignatureRequest,this)),Common.NotificationCenter.on("protect:signature",_.bind(this.onSignatureClick,this)),this.api.asc_registerCallback("asc_onSignatureClick",_.bind(this.onSignatureSign,this)),this.api.asc_registerCallback("asc_onUpdateSignatures",_.bind(this.onApiUpdateSignatures,this))),this.api.asc_registerCallback("asc_onCoAuthoringDisconnect",_.bind(this.onCoAuthoringDisconnect,this)))},setMode:function(t){return this.appConfig=t,this.view=this.createView("Common.Views.Protection",{mode:t}),this},onDocumentPassword:function(t,e){this.view&&this.view.onDocumentPassword(t,e)},SetDisabled:function(t,e){this.view&&this.view.SetDisabled(t,e)},onPasswordClick:function(t,e){switch(e){case"add":this.addPassword();break;case"delete":this.deletePassword()}Common.NotificationCenter.trigger("edit:complete",this.view)},onSignatureRequest:function(t){this.api.asc_RequestSign(t)},onSignatureClick:function(t,e,i){switch(t){case"invisible":this.onSignatureRequest("unvisibleAdd");break;case"visible":this.addVisibleSignature(e,i)}},createToolbarPanel:function(){return this.view.getPanel()},getView:function(t){return!t&&this.view?this.view:Backbone.Controller.prototype.getView.call(this,t)},onAppReady:function(t){var e=this;new Promise(function(t,e){t()}).then(function(){e.onChangeProtectDocument(),Common.NotificationCenter.on("protect:doclock",_.bind(e.onChangeProtectDocument,e))})},onChangeProtectDocument:function(t){var e;(t=t?t:(e=this.getApplication().getController("DocProtection"))?e.getDocProps():null)&&this.view&&(this.view._state.docProtection=t)},addPassword:function(){var i=this;new Common.Views.PasswordDialog({api:i.api,handler:function(t,e){"ok"==t&&i.api.asc_setCurrentPassword(e),Common.NotificationCenter.trigger("edit:complete")}}).show()},deletePassword:function(){this.api.asc_resetPassword()},addInvisibleSignature:function(){var i=this;new Common.Views.SignDialog({api:i.api,signType:"invisible",handler:function(t,e){"ok"==e&&(e=t.getSettings(),i.api.asc_Sign(e.certificateId)),Common.NotificationCenter.trigger("edit:complete")}}).show()},addVisibleSignature:function(i,t){var n=this,e=new Common.Views.SignSettingsDialog({type:i?"view":"edit",handler:function(t,e){i||"ok"!=e||n.api.asc_AddSignatureLine2(t.getSettings()),Common.NotificationCenter.trigger("edit:complete")}});e.show(),t&&e.setSettings(this.api.asc_getSignatureSetup(t))},signVisibleSignature:function(i,t,e){var n,o,s=this;_.isUndefined(s.fontStore)&&(s.fontStore=new Common.Collections.Fonts,n=s.getApplication().getController("Toolbar").getView("Toolbar").cmbFontName.store.toJSON(),o=[],_.each(n,function(t,e){t.cloneid||o.push(_.clone(t))}),s.fontStore.add(o)),new Common.Views.SignDialog({api:s.api,signType:"visible",fontStore:s.fontStore,signSize:{width:t||0,height:e||0},handler:function(t,e){"ok"==e&&(e=t.getSettings(),s.api.asc_Sign(e.certificateId,i,e.images[0],e.images[1])),Common.NotificationCenter.trigger("edit:complete")}}).show()},onSignatureSign:function(t,e,i,n){n?this.signVisibleSignature(t,e,i):this.addInvisibleSignature()},onApiUpdateSignatures:function(t,e){this.SetDisabled(t&&0<t.length,!0)},onCoAuthoringDisconnect:function(){this.SetDisabled(!0)}},Common.Controllers.Protection||{}))}),void 0===Common&&(Common={}),define("common/main/lib/component/UpDownPicker",["common/main/lib/component/BaseView"],function(){"use strict";Common.UI.UpDownPicker=Common.UI.BaseView.extend({options:{caption:"",iconUpCls:"btn-zoomup",iconDownCls:"btn-zoomdown",minWidth:40},disabled:!1,template:_.template(['<label class="title float-left"><%= options.caption %></label>','<button type="button" class="btn small btn-toolbar updown-picker-button-up float-right"><i class="icon menu__icon <%= options.iconUpCls %>">&nbsp;</i></button>','<label class="updown-picker-value float-right" style="min-width: <%= options.minWidth %>px;"></label>','<button type="button" class="btn small btn-toolbar updown-picker-button-down float-right"><i class="icon menu__icon <%= options.iconDownCls %>">&nbsp;</i></button>'].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t),this.render(),this.cmpEl=this.$el||$(this.el),this.btnUp=new Common.UI.Button({el:this.cmpEl.find(".updown-picker-button-up")}).on("click",_.bind(function(){this.trigger("click","up")},this)),this.btnDown=new Common.UI.Button({el:this.cmpEl.find(".updown-picker-button-down")}).on("click",_.bind(function(){this.trigger("click","down")},this)),this.displayValue=this.cmpEl.find(".updown-picker-value"),this.options.disabled&&this.setDisabled(this.options.disabled)},render:function(){return(this.$el||$(this.el)).html($(this.template({options:this.options}))),this.rendered=!0,this},setValue:function(t){this.displayValue.html(t||"")},setDisabled:function(t){this.rendered&&((t=!0===t)!==this.disabled&&(this.btnUp.setDisabled(t),this.btnDown.setDisabled(t)),this.disabled=t)}})}),void 0===Common&&(Common={}),Common.Views=Common.Views||{},define("common/main/lib/view/Draw",["common/main/lib/util/utils","common/main/lib/component/BaseView","common/main/lib/component/Layout","common/main/lib/component/Window","common/main/lib/component/UpDownPicker"],function(t){"use strict";var e;Common.Views.Draw=Common.UI.BaseView.extend(_.extend((e='<div class="group"><span id="slot-btn-draw-select" class="btn-slot text x-huge"></span><span id="slot-btn-draw-pen-0" class="btn-slot text x-huge emptycaption"></span><span id="slot-btn-draw-pen-1" class="btn-slot text x-huge emptycaption"></span><span id="slot-btn-draw-pen-2" class="btn-slot text x-huge emptycaption"></span><span id="slot-btn-draw-eraser" class="btn-slot text x-huge"></span></div>',{options:{},initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t),this.appConfig=t.mode,this._state={disabled:!1},this.lockedControls=[],this.btnsPen=[],this.isPDFEditor=!!window.PDFE;var t=Common.localStorage.getKeysFilter(),t=(this.appPrefix=t&&t.length?t.split(",")[0]:"",Common.enumLock),e=[{hint:this.txtPen,color:"3D8A44",opacity:100,size:{arr:[.25,.5,1,2,3.5],idx:2},iconCls:"btn-pen-tool",idx:0},{hint:this.txtPen,color:"D43230",opacity:100,size:{arr:[.25,.5,1,2,3.5],idx:2},iconCls:"btn-pen-tool",idx:1},{hint:this.txtHighlighter,color:"FFFC54",opacity:50,size:{arr:[2,4,6,8,10],idx:2},iconCls:"btn-highlighter-tool",idx:2,colors:["FFFC54","72F54A","74F9FD","EB51F7","A900F9","EF8B3A","7272FF","FF63A4","1DFF92","03DA18","249B01","C504D2","0633D1","FFF7A0","FF0303","FFFFFF","D3D3D4","969696","606060","000000"]}],i="de-"===this.appPrefix?[t.headerLock,t.previewReviewMode,t.viewFormMode,t.lostConnect,t.docLockView,t.docLockForms,t.docLockComments]:"pe-"===this.appPrefix?[t.slideDeleted,t.lostConnect,t.noSlides]:[t.editCell,t.lostConnect,t.coAuth,t.Objects],n=this;e.forEach(function(t){t=new Common.UI.ButtonColored({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon "+t.iconCls,caption:" ",menu:!0,split:!0,enableToggle:!0,allowDepress:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small",penOptions:t,lock:i});n.btnsPen.push(t),n.lockedControls.push(t)}),this.btnEraser=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-eraser",caption:this.txtEraser,enableToggle:!0,allowDepress:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small",lock:i}),this.lockedControls.push(this.btnEraser),this.btnSelect=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-select",caption:this.txtSelect,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small",lock:i,visible:!this.isPDFEditor}),this.lockedControls.push(this.btnSelect),Common.NotificationCenter.on("app:ready",this.onAppReady.bind(this))},render:function(t){return this.boxSdk=$("#editor_sdk"),t&&t.html(this.getPanel()),this},updateButtonHint:function(t){var e=t.options.penOptions;t.updateHint(e.hint+": "+Common.Utils.ThemeColor.getTranslation(Common.Utils.ThemeColor.getRgbColor(e.color).asc_getName())+", "+e.size.arr[e.size.idx]+" "+this.txtMM),t.sizePicker&&t.sizePicker.setValue(e.size.arr[e.size.idx]+" "+this.txtMM)},createPen:function(i){var t=i.options.penOptions,n=Common.UI.getId(),o=this,e=(this.updateButtonHint(i),i.setMenu(new Common.UI.Menu({cls:"shifted-left",style:"min-width: 100px;",items:[{template:_.template('<div id="id-toolbar-menu-draw-pen-'+n+'" style="width: 174px; display: inline-block;" class="palette-large"></div>'),stopPropagation:!0},{id:n+"-color-new",template:_.template('<a tabindex="-1" type="menuitem" style="">'+i.textNewColor+"</a>")},{caption:"--"},{template:_.template('<div id="id-toolbar-draw-updownpicker-'+n+'" class="custom-scale" data-stopPropagation="true"></div>'),stopPropagation:!0}]}),!0),i.currentColor=t.color,i.setColor(i.currentColor),new Common.UI.ThemeColorPalette({el:$("#id-toolbar-menu-draw-pen-"+n),colors:t.colors||["1755A0","D43230","F5C346","EA3368","12A489","552F8B","9D1F87","BB2765","479ED2","67C9FA","3D8A44","80CA3D","1C19B4","7F4B0F","FF7E07","FFFFFF","D3D3D4","879397","575757","000000"],value:i.currentColor,dynamiccolors:5,themecolors:0,effects:0,columns:5,outerMenu:{menu:i.menu,index:0,focusOnShow:!0},storageSuffix:"-draw"})),s=(i.setPicker(e),e.on("select",_.bind(i.onColorSelect,i)),i.menu.setInnerMenu([{menu:e,index:0}]),i.menu.cmpEl.find("#"+n+"-color-new").on("click",function(){e.addNewColor(i.currentColor)}),function(t){var e=new Common.UI.UpDownPicker({el:$("#id-toolbar-draw-updownpicker-"+n),caption:o.txtSize,minWidth:50});e.on("click",function(t){o.fireEvent("draw:size",[i,t])}),e.setValue(i.options.penOptions.size.arr[i.options.penOptions.size.idx]+" "+o.txtMM),i.sizePicker=e,t.off("show:after",s)});i.menu.on("show:after",s)},onAppReady:function(t){var e=this;new Promise(function(t,e){t()}).then(function(){e.btnsPen.forEach(function(t){e.createPen(t)}),e.btnEraser.updateHint(e.hintEraser),e.btnSelect.updateHint(e.hintSelect),Common.NotificationCenter.trigger("tab:visible","draw",Common.UI.LayoutManager.isElementVisible("toolbar-draw")),function(){var i=this;i.btnEraser.on("click",function(t){i.fireEvent("draw:eraser",[t])}),i.btnsPen.forEach(function(t){t.on("click",function(t,e){i.fireEvent("draw:pen",[t])}),t.on("color:select",function(t,e){i.fireEvent("draw:color",[t,e])})}),i.btnSelect.on("click",function(t){i.fireEvent("draw:select",[t])}),i._isSetEvents=!0}.call(e)})},getPanel:function(t){this.$el=$(_.template(t?e:'<section id="draw-ink-panel" class="panel" data-tab="draw"><div class="group"><span id="slot-btn-draw-select" class="btn-slot text x-huge"></span><span id="slot-btn-draw-pen-0" class="btn-slot text x-huge emptycaption"></span><span id="slot-btn-draw-pen-1" class="btn-slot text x-huge emptycaption"></span><span id="slot-btn-draw-pen-2" class="btn-slot text x-huge emptycaption"></span><span id="slot-btn-draw-eraser" class="btn-slot text x-huge"></span></div></section>')({}));var i=this;return this.btnsPen.forEach(function(t,e){t.render(i.$el.find("#slot-btn-draw-pen-"+e))}),this.btnEraser&&this.btnEraser.render(this.$el.find("#slot-btn-draw-eraser")),this.btnSelect&&this.btnSelect.render(this.$el.find("#slot-btn-draw-select")),this.$el},show:function(){Common.UI.BaseView.prototype.show.call(this),this.fireEvent("show",this)},getButtons:function(){return this.lockedControls},depressButtons:function(e){this.btnsPen.forEach(function(t){t!==e&&t.toggle(!1,!0)}),this.btnEraser!==e&&this.btnEraser.toggle(!1,!0)},SetDisabled:function(t){this._state.disabled=t}}),Common.Views.Draw||{}))}),void 0===Common&&(Common={}),Common.Controllers=Common.Controllers||{},define("common/main/lib/controller/Draw",["core","common/main/lib/view/Draw","common/main/lib/view/PasswordDialog","common/main/lib/view/SignDialog","common/main/lib/view/SignSettingsDialog"],function(){"use strict";Common.Controllers.Draw=Backbone.Controller.extend(_.extend({models:[],collections:[],views:["Common.Views.Draw"],sdkViewName:"#id_main",initialize:function(){this.addListeners({"Common.Views.Draw":{"draw:select":_.bind(this.onSelect,this),"draw:eraser":_.bind(this.onEraser,this),"draw:pen":_.bind(this.onDrawPen,this),"draw:size":_.bind(this.onDrawSizeClick,this),"draw:color":_.bind(this.onDrawColorClick,this)}})},onLaunch:function(){this._state={},Common.NotificationCenter.on("app:ready",this.onAppReady.bind(this)),Common.NotificationCenter.on("api:disconnect",_.bind(this.onCoAuthoringDisconnect,this))},setConfig:function(t,e){this.setApi(e),t&&(this.sdkViewName=t.sdkviewname||this.sdkViewName)},setApi:function(t){return t&&(this.api=t,this.api.asc_registerCallback("asc_onInkDrawerStop",_.bind(this.onInkDrawerStop,this)),this.api.asc_registerCallback("asc_onCoAuthoringDisconnect",_.bind(this.onCoAuthoringDisconnect,this))),this},setMode:function(t){return this.appConfig=t,this.view=this.createView("Common.Views.Draw",{mode:t}),this},SetDisabled:function(t){this.view&&this.view.SetDisabled(t)},onInkDrawerStop:function(){this.view&&this.view.depressButtons()},onSelect:function(t){this.api&&this.api.asc_StopInkDrawer(),Common.NotificationCenter.trigger("edit:complete",this.view)},onEraser:function(t){this.api&&(t.pressed?(this.view.depressButtons(t),this.api.asc_StartInkEraser(),Common.NotificationCenter.trigger("draw:start",this.view)):this.api.asc_StopInkDrawer())},onDrawPen:function(t){var e;this.api&&(t.pressed?(this.view.depressButtons(t),t=t.options.penOptions,(e=new Asc.asc_CStroke).put_type(Asc.c_oAscStrokeType.STROKE_COLOR),e.put_color(Common.Utils.ThemeColor.getRgbColor(t.color)),e.asc_putPrstDash(Asc.c_oDashType.solid),e.put_width(t.size.arr[t.size.idx]),e.put_transparent(2.55*t.opacity),this.api.asc_StartDrawInk(e,t.idx),Common.NotificationCenter.trigger("draw:start",this.view)):this.api.asc_StopInkDrawer())},onDrawSizeClick:function(t,e){t.pressed||(t.toggle(!0,!0),this.view&&this.view.depressButtons(t));var i=t.options.penOptions;i.size.idx="up"===e?Math.min(i.size.idx+1,i.size.arr.length-1):Math.max(i.size.idx-1,0),this.view&&this.view.updateButtonHint(t),this.onDrawPen(t)},onDrawColorClick:function(t,e){t.pressed||(t.toggle(!0,!0),this.view&&this.view.depressButtons(t)),t.options.penOptions.color=e,this.view&&this.view.updateButtonHint(t),this.onDrawPen(t)},createToolbarPanel:function(t){return this.view.getPanel(t)},getView:function(t){return!t&&this.view?this.view:Backbone.Controller.prototype.getView.call(this,t)},onAppReady:function(t){new Promise(function(t,e){t()}).then(function(){})},onCoAuthoringDisconnect:function(){this.SetDisabled(!0)}},Common.Controllers.Draw||{}))}),require.config({baseUrl:"../../",paths:{jquery:"../vendor/jquery/jquery",underscore:"../vendor/underscore/underscore",backbone:"../vendor/backbone/backbone",bootstrap:"../vendor/bootstrap/dist/js/bootstrap",text:"../vendor/requirejs-text/text",perfectscrollbar:"common/main/lib/mods/perfect-scrollbar",jmousewheel:"../vendor/perfect-scrollbar/src/jquery.mousewheel",xregexp:"../vendor/xregexp/xregexp-all-min",socketio:"../vendor/socketio/socket.io.min",allfonts:"../../sdkjs/common/AllFonts",sdk:"../../sdkjs/word/sdk-all-min",api:"api/documents/api",core:"common/main/lib/core/application",notification:"common/main/lib/core/NotificationCenter",keymaster:"common/main/lib/core/keymaster",tip:"common/main/lib/util/Tip",localstorage:"common/main/lib/util/LocalStorage",analytics:"common/Analytics",gateway:"common/Gateway",locale:"common/locale",irregularstack:"common/IrregularStack"},shim:{underscore:{exports:"_"},backbone:{deps:["underscore","jquery"],exports:"Backbone"},bootstrap:{deps:["jquery"]},perfectscrollbar:{deps:["jmousewheel"]},notification:{deps:["backbone"]},core:{deps:["backbone","notification","irregularstack"]},sdk:{deps:["jquery","allfonts","xregexp"]},gateway:{deps:["jquery"]},analytics:{deps:["jquery"]}}}),require(["documenteditor/main/locale/zh.json","themeinit","htmlutils","backbone","bootstrap","core","analytics","gateway","locale","device_scale"],function(t,e,i,n,o,s){var a;n.History&&n.History.started||(n.history.start(),a=new n.Application({nameSpace:"DE",autoCreate:!1,controllers:["Viewport","DocumentHolder","Toolbar","Statusbar","Links","FormsTab","Navigation","PageThumbnails","RightMenu","LeftMenu","Main","ViewTab","Search","DocProtection","Print","Common.Controllers.Fonts","Common.Controllers.History","Common.Controllers.Chat","Common.Controllers.Comments","Common.Controllers.Draw","Common.Controllers.Plugins","Common.Controllers.ExternalDiagramEditor","Common.Controllers.ExternalMergeEditor","Common.Controllers.ExternalOleEditor","Common.Controllers.ReviewChanges","Common.Controllers.Protection"]}),Common.Locale.apply(function(){require(["common/main/lib/util/LocalStorage","common/main/lib/controller/Scaling","common/main/lib/controller/Themes","common/main/lib/controller/Desktop","documenteditor/main/app/controller/Viewport","documenteditor/main/app/controller/DocumentHolder","documenteditor/main/app/controller/Toolbar","documenteditor/main/app/controller/Statusbar","documenteditor/main/app/controller/FormsTab","documenteditor/main/app/controller/Links","documenteditor/main/app/controller/Navigation","documenteditor/main/app/controller/PageThumbnails","documenteditor/main/app/controller/RightMenu","documenteditor/main/app/controller/LeftMenu","documenteditor/main/app/controller/Main","documenteditor/main/app/controller/ViewTab","documenteditor/main/app/controller/Search","documenteditor/main/app/controller/DocProtection","documenteditor/main/app/controller/Print","documenteditor/main/app/view/FileMenuPanels","documenteditor/main/app/view/ParagraphSettings","documenteditor/main/app/view/HeaderFooterSettings","documenteditor/main/app/view/ImageSettings","documenteditor/main/app/view/TableSettings","documenteditor/main/app/view/ShapeSettings","documenteditor/main/app/view/TextArtSettings","documenteditor/main/app/view/SignatureSettings","common/main/lib/util/utils","common/main/lib/controller/Fonts","common/main/lib/controller/History","common/main/lib/collection/Users","common/main/lib/controller/Comments","common/main/lib/controller/Chat","common/main/lib/controller/Plugins","common/main/lib/controller/ExternalDiagramEditor","common/main/lib/controller/ExternalMergeEditor","common/main/lib/controller/ExternalOleEditor","common/main/lib/controller/ReviewChanges","common/main/lib/controller/Protection","common/main/lib/controller/Draw"],function(){a.start()})},t))},function(t){"timeout"==t.requireType&&!reqerr&&window.requireTimeourError&&(reqerr=window.requireTimeourError(),window.alert(reqerr),window.location.reload())}),define("../apps/documenteditor/main/app.js",function(){});